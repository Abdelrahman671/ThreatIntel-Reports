<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">

<title>In-depth analysis of the new Team9 malware family &#8211; Fox-IT International blog</title>
<script type="text/javascript">
  WebFontConfig = {"google":{"families":["Open+Sans:600:latin,latin-ext","Open+Sans:r,i,b,bi:latin,latin-ext"]},"api_url":"https:\/\/fonts-api.wp.com\/css"};
  (function() {
    var wf = document.createElement('script');
    wf.src = 'https://blog.fox-it.com/wp-content/mu-plugins/wpcomsh/vendor/automattic/custom-fonts/js/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
	})();
</script><style id="jetpack-custom-fonts-css">.wf-active code, .wf-active kbd, .wf-active pre, .wf-active samp{font-family:"Open Sans",sans-serif}.wf-active body{font-family:"Open Sans",sans-serif}.wf-active button, .wf-active input, .wf-active select{font-family:"Open Sans",sans-serif}.wf-active textarea{font-family:"Open Sans",sans-serif}.wf-active blockquote{font-family:"Open Sans",sans-serif}.wf-active code, .wf-active kbd, .wf-active pre, .wf-active tt, .wf-active var{font-family:"Open Sans",sans-serif}.wf-active .button, .wf-active .more-link, .wf-active button:not(.menu-toggle), .wf-active input[type="button"], .wf-active input[type="reset"], .wf-active input[type="submit"], .wf-active .posts-navigation .nav-links a, .wf-active #content #infinite-handle span button{font-family:"Open Sans",sans-serif}.wf-active input[type="email"], .wf-active input[type="password"], .wf-active input[type="search"], .wf-active input[type="text"], .wf-active input[type="url"], .wf-active textarea{font-family:"Open Sans",sans-serif}.wf-active .post-navigation{font-family:"Open Sans",sans-serif}.wf-active .main-navigation{font-family:"Open Sans",sans-serif}.wf-active .entry-content, .wf-active .entry-summary, .wf-active .page-content{font-family:"Open Sans",sans-serif}.wf-active .entry-content .subtitle{font-family:"Open Sans",sans-serif}.wf-active #comments{font-family:"Open Sans",sans-serif}.wf-active .comment-form label{font-family:"Open Sans",sans-serif}.wf-active .comment-form span.required{font-family:"Open Sans",sans-serif}.wf-active .widget_recent_entries span.post-date{font-family:"Open Sans",sans-serif}.wf-active .site-description{font-family:"Open Sans",sans-serif}.wf-active .site-posted-on time{font-family:"Open Sans",sans-serif}.wf-active .page-header:not(.page-header-light) .taxonomy-description{font-family:"Open Sans",sans-serif}.wf-active .light-text{font-family:"Open Sans",sans-serif}.wf-active .site-info{font-family:"Open Sans",sans-serif}.wf-active .sticky-label{font-family:"Open Sans",sans-serif}.wf-active .post-details, .wf-active .post-details a{font-family:"Open Sans",sans-serif}.wf-active .page-links{font-family:"Open Sans",sans-serif}.wf-active .post-edit-link{font-family:"Open Sans",sans-serif}.wf-active .post-author-card .author-description{font-family:"Open Sans",sans-serif}.wf-active #tinymce h1, .wf-active #tinymce h2, .wf-active #tinymce h3, .wf-active #tinymce h4, .wf-active #tinymce h5, .wf-active #tinymce h6, .wf-active .comment-content h1, .wf-active .comment-content h2, .wf-active .comment-content h3, .wf-active .comment-content h4, .wf-active .comment-content h5, .wf-active .comment-content h6, .wf-active .entry-content h1, .wf-active .entry-content h2, .wf-active .entry-content h3, .wf-active .entry-content h4, .wf-active .entry-content h5, .wf-active .entry-content h6, .wf-active .entry-summary h1, .wf-active .entry-summary h2, .wf-active .entry-summary h3, .wf-active .entry-summary h4, .wf-active .entry-summary h5, .wf-active .entry-summary h6, .wf-active .widget_text h1, .wf-active .widget_text h2, .wf-active .widget_text h3, .wf-active .widget_text h4, .wf-active .widget_text h5, .wf-active .widget_text h6{font-family:"Open Sans",sans-serif;font-style:normal;font-weight:600}.wf-active h1{font-style:normal;font-weight:600}.wf-active h2{font-style:normal;font-weight:600}.wf-active h3{font-style:normal;font-weight:600}.wf-active h4{font-style:normal;font-weight:600}.wf-active h5{font-style:normal;font-weight:600}.wf-active h6{font-style:normal;font-weight:600}.wf-active blockquote h1, .wf-active blockquote h2, .wf-active blockquote h3, .wf-active blockquote h4{font-family:"Open Sans",sans-serif;font-weight:600;font-style:normal}.wf-active div#jp-relatedposts h3.jp-relatedposts-headline em{font-family:"Open Sans",sans-serif;font-style:normal;font-weight:600}.wf-active .comment-reply-title, .wf-active .comments-title{font-family:"Open Sans",sans-serif;font-weight:600;font-style:normal}.wf-active .image-post-title{font-family:"Open Sans",sans-serif;font-weight:600;font-style:normal}.wf-active .page-header:not(.page-header-light) h1{font-style:normal;font-weight:600}.wf-active .entry-title{font-family:"Open Sans",sans-serif;font-style:normal;font-weight:600}.wf-active #post-cover-image .cover-meta .single-post-title{font-family:"Open Sans",sans-serif;font-style:normal;font-weight:600}.wf-active #hero-header .site-title{font-family:"Open Sans",sans-serif;font-style:normal;font-weight:600}.wf-active .site-header .site-title{font-style:normal;font-weight:600}.wf-active .site-header .site-description{font-style:normal;font-weight:600}</style>
<meta name='robots' content='max-image-preview:large' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//widgets.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//0.gravatar.com' />
<link rel='dns-prefetch' href='//1.gravatar.com' />
<link rel='dns-prefetch' href='//2.gravatar.com' />
<link rel='preconnect' href='//i0.wp.com' />
<link rel='preconnect' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Fox-IT International blog &raquo; Feed" href="https://blog.fox-it.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Fox-IT International blog &raquo; Comments Feed" href="https://blog.fox-it.com/comments/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blog.fox-it.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel='stylesheet' id='all-css-18accdc1dd081a41e7033576dbd33938' href='https://blog.fox-it.com/_static/??-eJyVUltOAzEMvBCp1VLgC/FTiQNwAJRNTDat81CcUO3t8S4taivKlo+VbMUz4xnvPiuTYsVYIVNzPjK4Jm2HxUHXPFnoKJmdIt8VXQbgOhAuDPPd/r/Q2mO4CiU9pFaVK96ea/hoqFlk2DIEtF4jCY0gT5sscCyK0GkzLIKPs2h5O+1PMXOuTAo5RZngv9MwafLP8LPEBjNGi9F4aV7TRls7wNvIwQdu0hW5XmPcYs3a7OBdGMFhxOJlhH8vL0lCU0eefRYP3MOnbJMK6FZT0LV6c1RQMjwNARcDH6hrK7KjaSyTSojPSvk60nF3qTgdfLRvD76ryq0jz73canXAjQnN+Q3JtjEj8ju8EvqM1hjYhPu2dasg97qgnc40lj66m07DyXhNipJLfNYcf7OX8Lx8ul+vH1cP98svJb9YmA==' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<style id='independent-publisher-2-style-inline-css'>
.cat-links, .post-tags, .tags-links, .byline { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<style id='wp-emoji-styles-inline-css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<style id='jetpack-sharing-buttons-style-inline-css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #fff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--medium-blue: #0087be;--wp--preset--color--bright-blue: #00aadc;--wp--preset--color--dark-gray: #4d4d4b;--wp--preset--color--light-gray: #b3b3b1;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-family--albert-sans: 'Albert Sans', sans-serif;--wp--preset--font-family--alegreya: Alegreya, serif;--wp--preset--font-family--arvo: Arvo, serif;--wp--preset--font-family--bodoni-moda: 'Bodoni Moda', serif;--wp--preset--font-family--bricolage-grotesque: 'Bricolage Grotesque', sans-serif;--wp--preset--font-family--cabin: Cabin, sans-serif;--wp--preset--font-family--chivo: Chivo, sans-serif;--wp--preset--font-family--commissioner: Commissioner, sans-serif;--wp--preset--font-family--cormorant: Cormorant, serif;--wp--preset--font-family--courier-prime: 'Courier Prime', monospace;--wp--preset--font-family--crimson-pro: 'Crimson Pro', serif;--wp--preset--font-family--dm-mono: 'DM Mono', monospace;--wp--preset--font-family--dm-sans: 'DM Sans', sans-serif;--wp--preset--font-family--dm-serif-display: 'DM Serif Display', serif;--wp--preset--font-family--domine: Domine, serif;--wp--preset--font-family--eb-garamond: 'EB Garamond', serif;--wp--preset--font-family--epilogue: Epilogue, sans-serif;--wp--preset--font-family--fahkwang: Fahkwang, sans-serif;--wp--preset--font-family--figtree: Figtree, sans-serif;--wp--preset--font-family--fira-sans: 'Fira Sans', sans-serif;--wp--preset--font-family--fjalla-one: 'Fjalla One', sans-serif;--wp--preset--font-family--fraunces: Fraunces, serif;--wp--preset--font-family--gabarito: Gabarito, system-ui;--wp--preset--font-family--ibm-plex-mono: 'IBM Plex Mono', monospace;--wp--preset--font-family--ibm-plex-sans: 'IBM Plex Sans', sans-serif;--wp--preset--font-family--ibarra-real-nova: 'Ibarra Real Nova', serif;--wp--preset--font-family--instrument-serif: 'Instrument Serif', serif;--wp--preset--font-family--inter: Inter, sans-serif;--wp--preset--font-family--josefin-sans: 'Josefin Sans', sans-serif;--wp--preset--font-family--jost: Jost, sans-serif;--wp--preset--font-family--libre-baskerville: 'Libre Baskerville', serif;--wp--preset--font-family--libre-franklin: 'Libre Franklin', sans-serif;--wp--preset--font-family--literata: Literata, serif;--wp--preset--font-family--lora: Lora, serif;--wp--preset--font-family--merriweather: Merriweather, serif;--wp--preset--font-family--montserrat: Montserrat, sans-serif;--wp--preset--font-family--newsreader: Newsreader, serif;--wp--preset--font-family--noto-sans-mono: 'Noto Sans Mono', sans-serif;--wp--preset--font-family--nunito: Nunito, sans-serif;--wp--preset--font-family--open-sans: 'Open Sans', sans-serif;--wp--preset--font-family--overpass: Overpass, sans-serif;--wp--preset--font-family--pt-serif: 'PT Serif', serif;--wp--preset--font-family--petrona: Petrona, serif;--wp--preset--font-family--piazzolla: Piazzolla, serif;--wp--preset--font-family--playfair-display: 'Playfair Display', serif;--wp--preset--font-family--plus-jakarta-sans: 'Plus Jakarta Sans', sans-serif;--wp--preset--font-family--poppins: Poppins, sans-serif;--wp--preset--font-family--raleway: Raleway, sans-serif;--wp--preset--font-family--roboto: Roboto, sans-serif;--wp--preset--font-family--roboto-slab: 'Roboto Slab', serif;--wp--preset--font-family--rubik: Rubik, sans-serif;--wp--preset--font-family--rufina: Rufina, serif;--wp--preset--font-family--sora: Sora, sans-serif;--wp--preset--font-family--source-sans-3: 'Source Sans 3', sans-serif;--wp--preset--font-family--source-serif-4: 'Source Serif 4', serif;--wp--preset--font-family--space-mono: 'Space Mono', monospace;--wp--preset--font-family--syne: Syne, sans-serif;--wp--preset--font-family--texturina: Texturina, serif;--wp--preset--font-family--urbanist: Urbanist, sans-serif;--wp--preset--font-family--work-sans: 'Work Sans', sans-serif;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}.has-albert-sans-font-family{font-family: var(--wp--preset--font-family--albert-sans) !important;}.has-alegreya-font-family{font-family: var(--wp--preset--font-family--alegreya) !important;}.has-arvo-font-family{font-family: var(--wp--preset--font-family--arvo) !important;}.has-bodoni-moda-font-family{font-family: var(--wp--preset--font-family--bodoni-moda) !important;}.has-bricolage-grotesque-font-family{font-family: var(--wp--preset--font-family--bricolage-grotesque) !important;}.has-cabin-font-family{font-family: var(--wp--preset--font-family--cabin) !important;}.has-chivo-font-family{font-family: var(--wp--preset--font-family--chivo) !important;}.has-commissioner-font-family{font-family: var(--wp--preset--font-family--commissioner) !important;}.has-cormorant-font-family{font-family: var(--wp--preset--font-family--cormorant) !important;}.has-courier-prime-font-family{font-family: var(--wp--preset--font-family--courier-prime) !important;}.has-crimson-pro-font-family{font-family: var(--wp--preset--font-family--crimson-pro) !important;}.has-dm-mono-font-family{font-family: var(--wp--preset--font-family--dm-mono) !important;}.has-dm-sans-font-family{font-family: var(--wp--preset--font-family--dm-sans) !important;}.has-dm-serif-display-font-family{font-family: var(--wp--preset--font-family--dm-serif-display) !important;}.has-domine-font-family{font-family: var(--wp--preset--font-family--domine) !important;}.has-eb-garamond-font-family{font-family: var(--wp--preset--font-family--eb-garamond) !important;}.has-epilogue-font-family{font-family: var(--wp--preset--font-family--epilogue) !important;}.has-fahkwang-font-family{font-family: var(--wp--preset--font-family--fahkwang) !important;}.has-figtree-font-family{font-family: var(--wp--preset--font-family--figtree) !important;}.has-fira-sans-font-family{font-family: var(--wp--preset--font-family--fira-sans) !important;}.has-fjalla-one-font-family{font-family: var(--wp--preset--font-family--fjalla-one) !important;}.has-fraunces-font-family{font-family: var(--wp--preset--font-family--fraunces) !important;}.has-gabarito-font-family{font-family: var(--wp--preset--font-family--gabarito) !important;}.has-ibm-plex-mono-font-family{font-family: var(--wp--preset--font-family--ibm-plex-mono) !important;}.has-ibm-plex-sans-font-family{font-family: var(--wp--preset--font-family--ibm-plex-sans) !important;}.has-ibarra-real-nova-font-family{font-family: var(--wp--preset--font-family--ibarra-real-nova) !important;}.has-instrument-serif-font-family{font-family: var(--wp--preset--font-family--instrument-serif) !important;}.has-inter-font-family{font-family: var(--wp--preset--font-family--inter) !important;}.has-josefin-sans-font-family{font-family: var(--wp--preset--font-family--josefin-sans) !important;}.has-jost-font-family{font-family: var(--wp--preset--font-family--jost) !important;}.has-libre-baskerville-font-family{font-family: var(--wp--preset--font-family--libre-baskerville) !important;}.has-libre-franklin-font-family{font-family: var(--wp--preset--font-family--libre-franklin) !important;}.has-literata-font-family{font-family: var(--wp--preset--font-family--literata) !important;}.has-lora-font-family{font-family: var(--wp--preset--font-family--lora) !important;}.has-merriweather-font-family{font-family: var(--wp--preset--font-family--merriweather) !important;}.has-montserrat-font-family{font-family: var(--wp--preset--font-family--montserrat) !important;}.has-newsreader-font-family{font-family: var(--wp--preset--font-family--newsreader) !important;}.has-noto-sans-mono-font-family{font-family: var(--wp--preset--font-family--noto-sans-mono) !important;}.has-nunito-font-family{font-family: var(--wp--preset--font-family--nunito) !important;}.has-open-sans-font-family{font-family: var(--wp--preset--font-family--open-sans) !important;}.has-overpass-font-family{font-family: var(--wp--preset--font-family--overpass) !important;}.has-pt-serif-font-family{font-family: var(--wp--preset--font-family--pt-serif) !important;}.has-petrona-font-family{font-family: var(--wp--preset--font-family--petrona) !important;}.has-piazzolla-font-family{font-family: var(--wp--preset--font-family--piazzolla) !important;}.has-playfair-display-font-family{font-family: var(--wp--preset--font-family--playfair-display) !important;}.has-plus-jakarta-sans-font-family{font-family: var(--wp--preset--font-family--plus-jakarta-sans) !important;}.has-poppins-font-family{font-family: var(--wp--preset--font-family--poppins) !important;}.has-raleway-font-family{font-family: var(--wp--preset--font-family--raleway) !important;}.has-roboto-font-family{font-family: var(--wp--preset--font-family--roboto) !important;}.has-roboto-slab-font-family{font-family: var(--wp--preset--font-family--roboto-slab) !important;}.has-rubik-font-family{font-family: var(--wp--preset--font-family--rubik) !important;}.has-rufina-font-family{font-family: var(--wp--preset--font-family--rufina) !important;}.has-sora-font-family{font-family: var(--wp--preset--font-family--sora) !important;}.has-source-sans-3-font-family{font-family: var(--wp--preset--font-family--source-sans-3) !important;}.has-source-serif-4-font-family{font-family: var(--wp--preset--font-family--source-serif-4) !important;}.has-space-mono-font-family{font-family: var(--wp--preset--font-family--space-mono) !important;}.has-syne-font-family{font-family: var(--wp--preset--font-family--syne) !important;}.has-texturina-font-family{font-family: var(--wp--preset--font-family--texturina) !important;}.has-urbanist-font-family{font-family: var(--wp--preset--font-family--urbanist) !important;}.has-work-sans-font-family{font-family: var(--wp--preset--font-family--work-sans) !important;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
</style>
<link rel='stylesheet' id='dashicons-css' href='https://blog.fox-it.com/wp-includes/css/dashicons.min.css?ver=6.7.1' media='all' />
<style id='jetpack-global-styles-frontend-style-inline-css'>
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<script type="text/javascript" id="jetpack-mu-wpcom-settings-js-before">
/* <![CDATA[ */
var JETPACK_MU_WPCOM_SETTINGS = {"assetsUrl":"https:\/\/blog.fox-it.com\/wp-content\/mu-plugins\/wpcomsh\/vendor\/automattic\/jetpack-mu-wpcom\/src\/build\/"};
/* ]]> */
</script>
<link rel="https://api.w.org/" href="https://blog.fox-it.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://blog.fox-it.com/wp-json/wp/v2/posts/2613" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.fox-it.com/xmlrpc.php?rsd" />

<link rel="canonical" href="https://blog.fox-it.com/2020/06/02/in-depth-analysis-of-the-new-team9-malware-family/" />
<link rel='shortlink' href='https://wp.me/pWykx-G9' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://blog.fox-it.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.fox-it.com%2F2020%2F06%2F02%2Fin-depth-analysis-of-the-new-team9-malware-family%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://blog.fox-it.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.fox-it.com%2F2020%2F06%2F02%2Fin-depth-analysis-of-the-new-team9-malware-family%2F&#038;format=xml" />
	<style>img#wpstats{display:none}</style>
				<style type="text/css">
			.recentcomments a {
				display: inline !important;
				padding: 0 !important;
				margin: 0 !important;
			}

			table.recentcommentsavatartop img.avatar, table.recentcommentsavatarend img.avatar {
				border: 0px;
				margin: 0;
			}

			table.recentcommentsavatartop a, table.recentcommentsavatarend a {
				border: 0px !important;
				background-color: transparent !important;
			}

			td.recentcommentsavatarend, td.recentcommentsavatartop {
				padding: 0px 0px 1px 0px;
				margin: 0px;
			}

			td.recentcommentstextend {
				border: none !important;
				padding: 0px 0px 2px 10px;
			}

			.rtl td.recentcommentstextend {
				padding: 0px 10px 2px 0px;
			}

			td.recentcommentstexttop {
				border: none;
				padding: 0px 0px 0px 10px;
			}

			.rtl td.recentcommentstexttop {
				padding: 0px 10px 0px 0px;
			}
		</style>
		<meta name="description" content="Author: Nikolaos Pantazopoulos Co-author: Stefano Antenucci (@Antelox) And in close collaboration with NCC&#039;s RIFT. 1. Introduction Publicly discovered in late April 2020, the Team9 malware family (also known as ‘Bazar [1]’) appears to be a new malware being developed by the group behind Trickbot. Even though the development of the malware appears to be recent,&hellip;" />
	<style id="independent-publisher-2-custom-header-css" type="text/css">
			.site-title,
		.site-description,
		#hero-header #hero-social-navigation {
			clip: rect(1px, 1px, 1px, 1px);
			position: absolute;
		}
		</style>
	<link rel="amphtml" href="https://blog.fox-it.com/2020/06/02/in-depth-analysis-of-the-new-team9-malware-family/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="In-depth analysis of the new Team9 malware family" />
<meta property="og:url" content="https://blog.fox-it.com/2020/06/02/in-depth-analysis-of-the-new-team9-malware-family/" />
<meta property="og:description" content="Author: Nikolaos Pantazopoulos Co-author: Stefano Antenucci (@Antelox) And in close collaboration with NCC&#8217;s RIFT. 1. Introduction Publicly discovered in late April 2020, the Team9 malware fa…" />
<meta property="article:published_time" content="2020-06-02T14:00:23+00:00" />
<meta property="article:modified_time" content="2021-02-16T12:45:30+00:00" />
<meta property="og:site_name" content="Fox-IT International blog" />
<meta property="og:image" content="https://blog.fox-it.com/wp-content/uploads/2020/06/figure2.png" />
<meta property="og:image:width" content="899" />
<meta property="og:image:height" content="214" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="In-depth analysis of the new Team9 malware family" />
<meta name="twitter:image" content="https://blog.fox-it.com/wp-content/uploads/2020/06/figure4.png?w=144" />
<meta name="twitter:card" content="summary" />

<!-- End Jetpack Open Graph Tags -->
<style type="text/css" id="custom-colors-css">.has-header-image .site-title a,.has-header-image .site-title a:visited{color:#fff}@media screen and (max-width:32.374em){.main-navigation ul ul{background:0 0 !important}.main-navigation ul ul a{color:inherit !important}}.widget_recent_comments a,.widget_recent_entries a,body,input,select,textarea,.menu-toggle{color:#383838}#infinite-footer .blog-info a:hover,#infinite-footer .blog-credits a:hover{color:#383838}.posts-navigation .nav-links a,.main-navigation ul ul a,.main-navigation>div>ul>li.current-menu-item>ul>li a,.main-navigation>div>ul>li.current_page_item>ul>li a{color:#303030}input[type=button],input[type=button]:hover,input[type=reset],input[type=reset]:hover,input[type=submit],input[type=submit]:hover,button,.button,.button:hover,#content #infinite-handle span button,#content #infinite-handle span button:hover,.more-link,.more-link:hover,.more-link:visited{color:#303030}.site-main>.hentry:nth-child(n+2),.site .infinite-wrap>.hentry:nth-child(n+2),.entry-author-wrapper,.post-navigation,.comment,.page-links a:hover,.main-navigation li{border-color:#ddd}.site-main>.hentry:nth-child(n+2),.site .infinite-wrap>.hentry:nth-child(n+2),.entry-author-wrapper,.post-navigation,.comment,.page-links a:hover,.main-navigation li{border-color:rgba(221,221,221,0)}#infinite-footer .blog-info a,#infinite-footer .blog-credits,#infinite-footer .blog-credits a{color:#6d6d6d}.post-details,.post-details a,.post-details a:visited,.post-edit-link a,.post-edit-link a:visited{color:#6e6e6c}.post-tags li:first-child,.jetpack-social-navigation li a:hover,.widget_wpcom_social_media_icons_widget li a:hover,.jetpack-social-navigation li a:focus,.widget_wpcom_social_media_icons_widget li a:focus,.jetpack-social-navigation li a:active,.widget_wpcom_social_media_icons_widget li a:active{color:#515151}.jetpack-social-navigation li a,.widget_wpcom_social_media_icons_widget li a{color:#6d6d6d}.post-navigation .nav-links a:hover,.post-navigation .nav-links a:focus,.post-navigation .nav-links a:active,.entry-author .author-bio,.site-posted-on time,.site-description{color:#6d6d6d}.comment .comment-meta,.comment-form label,.light-text,.light-text a,.light-text a:visited,.widget_rss .rss-date,.widget_rss li>cite{color:#6e6e6c}.light-text a:hover{color:#6e6e6c}body{background-color:#fff}#infinite-footer .container{background-color:#fff}#infinite-footer .container{background-color:rgba(255,255,255,0)}.post-edit-link a{background-color:#f9f9f9}.entry-author .author-title,.entry-title,.entry-title a,.entry-title a:visited,.site-posted-on strong,.site-title,.site-title a,.site-title a:visited,.entry-title a:hover,.site-title a:hover,h1,h2,h3,h4,h5,h6,.page-header:not(.page-header-light) h1,.comment .comment-meta .comment-author .fn{color:#00284d}.comment-form input[type=email]:active,.comment-form input[type=email]:focus,.comment-form input[type=password]:active,.comment-form input[type=password]:focus,.comment-form input[type=search]:active,.comment-form input[type=search]:focus,.comment-form input[type=text]:active,.comment-form input[type=text]:focus,.comment-form input[type=url]:active,.comment-form input[type=url]:focus,.comment-form textarea:active,.comment-form textarea:focus,blockquote,input[type=email]:focus,input[type=password]:focus,input[type=search]:focus,input[type=text]:focus,input[type=url]:focus,textarea:focus{border-color:#1cabe5}.comment .comment-meta .comment-metadata a:hover,.comment-form span.required,.pingback:before,.post-details a:hover,.post-edit-link a:active,.post-edit-link a:focus,.post-edit-link a:hover,.site-info a:hover,.trackback:before,a,a:visited{color:#0b77a2}.main-navigation>div>ul>li.current-menu-item>a,.main-navigation>div>ul>li.current_page_item>a,a:active,a:focus,a:hover,.page-links a:hover{color:#1cabe5}.posts-navigation .nav-links a,.main-navigation ul ul{background-color:#1cabe5}button,input[type=button],input[type=reset],input[type=submit],.button,#content #infinite-handle span button,.more-link{background-color:#1cabe5}button:not(".components-button"):hover,input[type=button]:hover,input[type=reset]:hover,input[type=submit]:hover,.button:hover,#content #infinite-handle span button:hover,.more-link:hover{background-color:#1588b6}</style>
<link rel="icon" href="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2022/01/cropped-fox-favicon.png?fit=32%2C32&#038;ssl=1" sizes="32x32" />
<link rel="icon" href="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2022/01/cropped-fox-favicon.png?fit=192%2C192&#038;ssl=1" sizes="192x192" />
<link rel="apple-touch-icon" href="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2022/01/cropped-fox-favicon.png?fit=180%2C180&#038;ssl=1" />
<meta name="msapplication-TileImage" content="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2022/01/cropped-fox-favicon.png?fit=270%2C270&#038;ssl=1" />
<link rel="stylesheet" type="text/css" id="wp-custom-css" href="https://blog.fox-it.com/?custom-css=a785352500" /><!-- Jetpack Google Analytics -->
			<script type='text/javascript'>
				var _gaq = _gaq || [];
				_gaq.push(['_setAccount', 'UA-7750533-3']);
_gaq.push(['_trackPageview']);
				(function() {
					var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
					ga.src = ('https:' === document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
					var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
				})();
			</script>
			<!-- End Jetpack Google Analytics -->
</head>

<body class="post-template-default single single-post postid-2613 single-format-standard wp-custom-logo wp-embed-responsive group-blog custom-colors categories-hidden tags-hidden author-hidden">

<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<div id="hero-header" class="site-hero-section">
		<header id="masthead" class="site-header" role="banner">
			<div class="inner">
				<div class="site-branding">
					<a href="https://blog.fox-it.com/" class="custom-logo-link" rel="home"><img width="180" height="49" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2019/02/fox-it-logo.png?fit=180%2C49&amp;ssl=1" class="custom-logo" alt="Fox-IT International blog" decoding="async" data-attachment-id="2375" data-permalink="https://blog.fox-it.com/fox-it-logo-2/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2019/02/fox-it-logo.png?fit=180%2C49&amp;ssl=1" data-orig-size="180,49" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="fox-it-logo" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2019/02/fox-it-logo.png?fit=180%2C49&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2019/02/fox-it-logo.png?fit=180%2C49&amp;ssl=1" /></a>
												<p class="site-title"><a href="https://blog.fox-it.com/" rel="home">Fox-IT International blog</a></p>
													<p class="site-description">News and opinions from Fox-IT</p>
									</div><!-- .site-branding -->

				
									<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false" id="primary-menu-button">
						Menu					</button><!-- .menu-toggle -->
				
			</div><!-- .inner -->
		</header><!-- #masthead -->
	</div>

				<nav id="site-navigation" class="main-navigation" role="navigation">
			<div class="menu-main-menu-container"><ul id="primary-menu" class="menu"><li id="menu-item-247" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-247"><a href="http://blog.fox-it.com/">Home</a></li>
<li id="menu-item-2346" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2346"><a href="https://blog.fox-it.com/archive/">Archive</a></li>
<li id="menu-item-246" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-246"><a href="http://www.fox-it.com">Back to Fox-IT</a></li>
</ul></div>		</nav><!-- .main-navigation -->
	
	
	
	<div id="content-wrapper" class="content-wrapper">
		<div id="content" class="site-content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-2613" class="post-2613 post type-post status-publish format-standard hentry category-threat-intelligence">
			<header class="entry-header">
			<h1 class="entry-title">In-depth analysis of the new Team9 malware family</h1>		</header><!-- .entry-header -->		<div class="entry-meta">
			<span class="byline">
				<a href="https://blog.fox-it.com/author/krijndemik/" title="Posts by krijndemik" rel="author">krijndemik</a>			</span>
							<span class="cat-links">
					<a href="https://blog.fox-it.com/category/threat-intelligence/" rel="category tag">Threat Intelligence</a>				</span><!-- .cat-links -->
			
			
			<span class="published-on">
				<time class="entry-date published" datetime="2020-06-02T16:00:23+02:00">June 2, 2020</time><time class="updated" datetime="2021-02-16T14:45:30+02:00">February 16, 2021</time>			</span>

			<span class="word-count">16 Minutes</span>		</div><!-- .entry-meta -->
	
	<div class="entry-content">
		<p><em>Author: Nikolaos Pantazopoulos<br />
Co-author: Stefano Antenucci (<a href="https://twitter.com/antelox">@</a><a href="https://twitter.com/antelox" target="_blank" rel="noreferrer noopener">Antelox</a>)<br />
</em><em>And in close collaboration with NCC&#8217;s RIFT.</em></p>
<h2>1. Introduction</h2>
<p>Publicly discovered in late April 2020, the Team9 malware family (also known as ‘Bazar [<a href="https://www.bleepingcomputer.com/news/security/bazarbackdoor-trickbot-gang-s-new-stealthy-network-hacking-malware/" target="_blank" rel="noopener">1</a>]’) appears to be a new malware being developed by the group behind Trickbot. Even though the development of the malware appears to be recent, the developers have already developed two components with rich functionality. The purpose of this blog post is to describe the functionality of the two components, the loader and the backdoor.</p>
<table>
<tbody>
<tr>
<td width="472"><em>About the Research and Intelligence Fusion Team (RIFT):</em></p>
<p>RIFT leverages our strategic analysis, data science, and threat hunting capabilities to create actionable threat intelligence, ranging from IOCs and detection rules to strategic reports on tomorrow&#8217;s threat landscape. Cyber security is an arms race where both attackers and defenders continually update and improve their tools and ways of working. To ensure that our managed services remain effective against the latest threats, NCC Group operates a Global Fusion Center with Fox-IT at its core. This multidisciplinary team converts our leading cyber threat intelligence into powerful detection strategies.</td>
</tr>
</tbody>
</table>
<h2>2. Early variant of Team9 loader</h2>
<p>We assess that this is an earlier variant of the Team9 loader (35B3FE2331A4A7D83D203E75ECE5189B7D6D06AF4ABAC8906348C0720B6278A4) because of its simplicity and the compilation timestamp. The other variant was compiled more recently and has additional functionality. It should be noted that in very early versions of the loader binaries (2342C736572AB7448EF8DA2540CDBF0BAE72625E41DAB8FFF58866413854CA5C), the developers were using the Windows BITS functionality in order to download the backdoor. However, we believe that this functionality has been dropped.</p>
<p>Before proceeding to the technical analysis part, it is worth mentioning that the strings are not encrypted. Similarly, the majority of the Windows API functions are not loaded dynamically.</p>
<p>When the loader starts its execution, it checks if another instance of itself has infected the host already by attempting to read the value ‘BackUp Mgr’ in the ‘Run’ registry key ‘Software\Microsoft\Windows\CurrentVersion\Run’ (Figure 1). If it exists, it validates if the current loaders file path is the same as the one that has already been set in the registry value’s data (BackUp Mgr). Assuming that all of the above checks were successful, the loader proceeds to its core functionality.</p>
<p><img data-recalc-dims="1" fetchpriority="high" decoding="async" data-attachment-id="2618" data-permalink="https://blog.fox-it.com/2020/06/02/in-depth-analysis-of-the-new-team9-malware-family/figure1/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure1.png?fit=791%2C176&amp;ssl=1" data-orig-size="791,176" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="figure1" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure1.png?fit=300%2C67&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure1.png?fit=791%2C176&amp;ssl=1" class=" size-full wp-image-2618 aligncenter" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure1.png?resize=791%2C176&#038;ssl=1" alt="figure1" width="791" height="176" /></p>
<p style="text-align: center;"><strong>Figure 1</strong> – Loader verifies if it has already infect the host</p>
<p>However, if any of the above checks do not meet the requirements then the loader does one of the following actions:</p>
<ol>
<li>Copy itself to the %APPDATA%\Microsoft folder, add this file path in the registry ‘Run’ key under the value ‘BackUp Mgr’ and then execute the loader from the copied location.</li>
<li>If the loader cannot access the %APPDATA% location or if the loader is running from this location already, then it adds the current file path in the ‘Run’ registry key under the value ‘BackUp Mgr’ and executes the loader again from this location.</li>
</ol>
<p>When the persistence operation finishes, the loader deletes itself by writing a batch file in the Windows temporary folder with the file name prefix ‘tmp’ followed by random digits. The batch file content:</p>
<pre>@echo off
set Module=%1
:Repeat
del %Module%
if exist %Module% goto Repeat
del %0</pre>
<p>Next, the loader fingerprints the Windows architecture. This is a crucial step because the loader needs to know what version of the backdoor to download (32-bit or 64-bit). Once the Windows architecture has been identified, the loader carries out the download.</p>
<p>The core functionality of the loader is to download the Team9 backdoor component. The loader contains two ‘.bazar’ top-level domains which point to the Team9 backdoor. Each domain hosts two versions of the Team9 backdoor on different URIs, one for each Windows architecture (32-bit and 64-bit), the use of two domains is highly likely to be a backup method.</p>
<p>Any received files from the command and control server are sent in an encrypted format. In order to decrypt a file, the loader uses a bitwise XOR decryption with the key being based on the infected host’s system time (Year/Month/Day) (Figure 2).</p>
<p><img data-recalc-dims="1" decoding="async" data-attachment-id="2621" data-permalink="https://blog.fox-it.com/2020/06/02/in-depth-analysis-of-the-new-team9-malware-family/figure2/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure2.png?fit=899%2C214&amp;ssl=1" data-orig-size="899,214" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="figure2" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure2.png?fit=300%2C71&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure2.png?fit=800%2C190&amp;ssl=1" class=" size-full wp-image-2621 aligncenter" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure2.png?resize=800%2C190&#038;ssl=1" alt="figure2" width="800" height="190" /></p>
<p style="text-align: center;"><strong>Figure 2</strong> – Generate XOR key based on infected host’s time</p>
<p>As a last step, the loader verifies that the executable file was decrypted successfully by validating the PE headers. If the Windows architecture is 32-bit, the loader injects the received executable file into ‘calc.exe’ (Windows calculator) using the ‘Process Hollowing’ technique. Otherwise, it writes the executable file to disk and executes it.</p>
<p>The following tables summarises the identified bazar domains and their URIs found in the early variants of the loader.</p>
<table>
<tbody>
<tr>
<td width="181"><strong>URI</strong></td>
<td width="291"><strong>Description</strong></td>
</tr>
<tr>
<td width="181">/api/v108</td>
<td width="291">Possibly downloads the 64-bit version of the Team9 backdoor</td>
</tr>
<tr>
<td width="181">/api/v107</td>
<td width="291">Possibly downloads the 32-bit version of the Team9 backdoor</td>
</tr>
<tr>
<td width="181">/api/v5</td>
<td width="291">Possibly downloads an updated 32-bit version of the Team9 loader</td>
</tr>
<tr>
<td width="181">/api/v6</td>
<td width="291">Possibly downloads an updated 64-bit version of the Team9 loader</td>
</tr>
<tr>
<td width="181">/api/v7</td>
<td width="291">Possibly downloads the 32-bit version of the Team9 backdoor</td>
</tr>
<tr>
<td width="181">/api/v8</td>
<td width="291">Possibly downloads the 64-bit version of the Team9 backdoor</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><strong>Table 1</strong> &#8211; Bazar URIs found in early variants of the loader</p>
<p>The table below (table 2) summarises the identified domains found in the early variants of the loader.</p>
<table>
<tbody>
<tr>
<td width="160"><strong>Bazar domains</strong></td>
</tr>
<tr>
<td width="160">bestgame[.]bazar</td>
</tr>
<tr>
<td width="160">forgame[.]bazar</td>
</tr>
<tr>
<td width="160">zirabuo[.]bazar</td>
</tr>
<tr>
<td width="160">tallcareful[.]bazar</td>
</tr>
<tr>
<td width="160">coastdeny[.]bazar</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><strong>Table 2</strong> &#8211; Bazar domains found in early variants of the loader</p>
<p>Lastly, another interesting observation is the log functionality in the binary file that reveals the following project file path:</p>
<pre><em>d:\\development\\team9\\team9_restart_loader\\team9_restart_loader</em></pre>
<h2>3. Latest variant of Team9 loader</h2>
<p>In this section, we describe the functionality of a second loader that we believe to be the latest variant of the aforementioned Team9 loader. This assessment is based on three factors:</p>
<ol>
<li>Similar URIs in the backdoor requests</li>
<li>Similar payload decryption technique</li>
<li>Similar code blocks</li>
</ol>
<p>Unlike its previous version, the strings are encrypted and the majority of Windows API functions are loaded dynamically by using the Windows API hashing technique.</p>
<p>Once executed, the loader uses a timer in order to delay the execution. This is likely used as an anti-sandbox method. After the delayed time has passed, the loader starts executing its core functionality.</p>
<p>Before the malware starts interacting with the command and control server, it ensures that any other related files produced by a previous instance of the loader will not cause any issues. As a result the loader appends the string ‘_lyrt’ to its current file path and deletes any file with this name. Next, the loader searches for the parameter ‘-p’ in the command line and if found, it deletes the scheduled task ‘StartDT’. The loader creates this scheduled task later for persistence during execution. The loader also attempts to execute hijacked shortcut files, which will eventually execute an instance of Team9 loader. This functionality is described later.</p>
<p>The loader performs a last check to ensure that the operating systems keyboard and language settings are not set to Russian and creates a mutex with a hardcoded name &#8216;ld_201127&#8217;. The latter is to avoid double execution of its own instance.</p>
<p>As mentioned previously, the majority of Windows API functions are loaded dynamically. However, in an attempt to bypass any API hooks set by security products, the loader manually loads ‘ntdll’ from disk, reads the opcodes from each API function and compares them with the ones in memory (Figure 3). If the opcodes are different, the loader assumes a hook has been applied and removes it. This applies only to 64-bit samples reviewed to date.</p>
<p><img data-recalc-dims="1" decoding="async" data-attachment-id="2625" data-permalink="https://blog.fox-it.com/2020/06/02/in-depth-analysis-of-the-new-team9-malware-family/figure3/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure3.png?fit=584%2C139&amp;ssl=1" data-orig-size="584,139" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="figure3" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure3.png?fit=300%2C71&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure3.png?fit=584%2C139&amp;ssl=1" class=" size-full wp-image-2625 aligncenter" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure3.png?resize=584%2C139&#038;ssl=1" alt="figure3" width="584" height="139" /></p>
<p style="text-align: center;"><strong>Figure 3</strong> – Scan for hooks in Windows API functions</p>
<p>The next stage downloads from the command and control server either the backdoor or an updated version of the loader. It is interesting to note that there are minor differences in the loader’s execution based on the identified Windows architecture and if the ‘-p’ parameter has been passed into the command line.</p>
<p>Assuming that the ‘-p’ parameter has not been passed into the command line, the loader has two loops. One for 32-bit and the other for 64-bit, which download an updated version of the loader. The main difference between the two loops is that in case of a Windows x64 infection, there is no check of the loader’s version.</p>
<p>The download process is the same with the previous variant, the loader resolves the command and control server IP address using a hardcoded list of DNS servers and then downloads the corresponding file. An interesting addition, in the latest samples, is the use of an alternative command and control server IP address, in case the primary one fails. The alternative IP address is generated by applying a bitwise XOR operation to each byte of the resolved command and control IP address with the byte 0xFE. In addition, as a possible anti-behaviour method, the loader verifies that the command and control server IP address is not ‘127.0.0.1’. Both of these methods are also present in the latest Team9 backdoor variants.</p>
<p>As with the previous Team9 loader variant, the command and control server sends back the binary files in an encrypted format. The decryption process is similar with its previous variant but with a minor change in the XOR key generation, the character ‘3’ is added between each hex digit of the day format (Figure 4). For example:</p>
<pre>332330332330330335331338 (ASCII format, host date: 2020-05-18)</pre>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="2627" data-permalink="https://blog.fox-it.com/2020/06/02/in-depth-analysis-of-the-new-team9-malware-family/figure4/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure4.png?fit=249%2C187&amp;ssl=1" data-orig-size="249,187" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="figure4" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure4.png?fit=249%2C187&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure4.png?fit=249%2C187&amp;ssl=1" class=" size-full wp-image-2627 aligncenter" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure4.png?resize=249%2C187&#038;ssl=1" alt="figure4" width="249" height="187" /></p>
<p style="text-align: center;"><strong>Figure 4</strong> – Add the character ‘3’ in the generated XOR key</p>
<p>If the ‘-p’ parameter has been passed into the command line, the loader proceeds to download the Team9 backdoor directly from the command and control server. One notable addition is the process injection (hollow process injection) when the backdoor has been successfully downloaded and decrypted. The loader injects the backdoor to one of the following processes:</p>
<ol>
<li>Svchost</li>
<li>Explorer</li>
<li>cmd</li>
</ol>
<p>Whenever a binary file is successfully downloaded and properly decrypted, the loader adds or updates its persistence in the infected host. The persistence methods are available in table 3.</p>
<table>
<tbody>
<tr>
<td width="234"><strong>Persistence Method</strong></td>
<td width="238"><strong>Persistence Method Description</strong></td>
</tr>
<tr>
<td width="234">Scheduled task</td>
<td width="238">The loader creates two scheduled tasks, one for the updated loader (if any) and one for the downloaded backdoor. The scheduled task names and timers are different.</td>
</tr>
<tr>
<td width="234">Winlogon hijack</td>
<td width="238">Add the malware’s file path in the ‘Userinit’ registry value. As a result, whenever the user logs in the malware is also executed.</td>
</tr>
<tr>
<td width="234">Shortcut in the Startup folder</td>
<td width="238">The loaders creates a shortcut, which points to the malware file, in the Startup folder. The name of the shortcut is ‘adobe’.</td>
</tr>
<tr>
<td width="234">Hijack already existing shortcuts</td>
<td width="238">The loader searches for shortcut files in Desktop and its subfolders. If it finds one then it copies the malware into the shortcut’s target location with the application’s file name and appends the string ‘__’ at the end of the original binary file name. Furthermore, the loader creates a ‘.bin’ file which stores the file path, file location and parameters. The ‘.bin’ file structure can be found in the Appendix section. When this structure is filled in with all required information, It is encrypted with the XOR key 0x61.</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><strong>Table 3</strong> &#8211; Persistence methods loader</p>
<p>The following tables summarises the identified bazar domains and their URIs for this Team9 loader variant.</p>
<table>
<tbody>
<tr>
<td width="181"><strong>URI</strong></td>
<td width="291"><strong>Description</strong></td>
</tr>
<tr>
<td width="181">/api/v117</td>
<td width="291">Possibly downloads the 32-bit version of the Team9 loader</td>
</tr>
<tr>
<td width="181">/api/v118</td>
<td width="291">Possibly downloads the 64-bit version of the Team9 loader</td>
</tr>
<tr>
<td width="181">/api/v119</td>
<td width="291">Possibly downloads the 32-bit version of the Team9 backdoor</td>
</tr>
<tr>
<td width="181">/api/v120</td>
<td width="291">Possibly downloads the 64-bit version of the Team9 backdoor</td>
</tr>
<tr>
<td width="181">/api/v85</td>
<td width="291">Possibly downloads the 32-bit version of the Team9 loader</td>
</tr>
<tr>
<td width="181">/api/v86</td>
<td width="291">Possibly downloads the 64-bit version of the Team9 loader</td>
</tr>
<tr>
<td width="181">/api/v87</td>
<td width="291">Possibly downloads the 32-bit version of the Team9 backdoor</td>
</tr>
<tr>
<td width="181">/api/v88</td>
<td width="291">Possibly downloads the 64-bit version of the Team9 backdoor</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><strong>Table 4</strong> &#8211; Identified URIs for Team9 loader variant</p>
<table>
<tbody>
<tr>
<td width="160"><strong>Bazar domain</strong></td>
</tr>
<tr>
<td width="160">bestgame[.]bazar</td>
</tr>
<tr>
<td width="160">forgame[.]bazar</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><strong>Table 5</strong> &#8211; Identified domains for Team9 loader variant</p>
<h2>4. Team9 backdoor</h2>
<p>We are confident that this is the backdoor which the loader installs onto the compromised host. In addition, we believe that the first variants of the Team9 backdoor started appearing in the wild in late March 2020. Each variant does not appear to have major changes and the core of the backdoor remains the same.</p>
<p>During analysis, we identified the following similarities between the backdoor and its loader:</p>
<ol>
<li>Creates a mutex with a hardcoded name in order to avoid multiple instances running at the same time (So far the mutex names which we have identified are ‘mn_185445’ and ‘{589b7a4a-3776-4e82-8e7d-435471a6c03c}’)</li>
<li>Verifies that the keyboard and the operating system language is not Russian</li>
<li>Use of Emercoin domains with a similarity in the domain name choice</li>
</ol>
<p>Furthermore, the backdoor generates a unique ID for the infected host. The process that it follows is:</p>
<ol>
<li>Find the creation date of ‘C:\Windows’ (Windows FILETIME structure format). The result is then converted from a hex format to an ASCII representation. An example is shown in figures 5 (before conversion) and 6 (after conversion).</li>
<li>Repeat the same process but for the folder ‘C:\Windows\System32’</li>
<li>Append the second string to the first with a bullet point as a delimiter. For example, 01d3d1d8 b10c2916.01d3d1d8 b5b1e079</li>
<li>Get the NETBIOS name and append it to the previous string from step 3 along with a bullet point as a delimiter. For example: 01d3d1d8 b10c2916.01d3d1d8 b5b1e079.DESKTOP-4123EEB.</li>
<li>Read the volume serial number of C: drive and append it to the previous string. For example: 01d3d1d8 b10c2916.01d3d1d8 b5b1e079.DESKTOP-SKCF8VA.609fbbd5</li>
<li>Hash the string from step 5 using the MD5 algorithm. The output hash is the bot ID.</li>
</ol>
<p>Note: In a few samples, the above algorithm is different. The developers use hard-coded dates, the Windows directory file paths in a string format (‘C:\Windows’ and ‘C:\Windows\system32’) and the NETBIOS name. Based on the samples’ functionality, there are many indications that these binary files were created for debugging purposes.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="2632" data-permalink="https://blog.fox-it.com/2020/06/02/in-depth-analysis-of-the-new-team9-malware-family/figure5/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure5.png?fit=373%2C15&amp;ssl=1" data-orig-size="373,15" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="figure5" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure5.png?fit=300%2C12&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure5.png?fit=373%2C15&amp;ssl=1" class=" size-full wp-image-2632 aligncenter" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure5.png?resize=373%2C15&#038;ssl=1" alt="figure5" width="373" height="15" /></p>
<p style="text-align: center;"><strong>Figure 5</strong> – Before conversion</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="2633" data-permalink="https://blog.fox-it.com/2020/06/02/in-depth-analysis-of-the-new-team9-malware-family/figure6/" data-orig-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure6.png?fit=454%2C24&amp;ssl=1" data-orig-size="454,24" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="figure6" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure6.png?fit=300%2C16&amp;ssl=1" data-large-file="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure6.png?fit=454%2C24&amp;ssl=1" class=" size-full wp-image-2633 aligncenter" src="https://i0.wp.com/blog.fox-it.com/wp-content/uploads/2020/06/figure6.png?resize=454%2C24&#038;ssl=1" alt="figure6" width="454" height="24" /></p>
<p style="text-align: center;"><strong>Figure 6</strong> – After conversion</p>
<h3>4.1 Network communication</h3>
<p>The backdoor appears to support network communication over ports 80 (HTTP) and 443(HTTPS). In recent samples, a certificate is issued from the infected host for communication over HTTPS. Each request to the command and control server includes at least the following information:</p>
<ol>
<li>A URI path for requesting tasks (/2) or sending results (/3).</li>
<li>Group ID. This is added in the ‘Cookie’ header.</li>
</ol>
<p>Lastly, unlike the loader which decrypts received network replies from the command and control server using the host’s date as the key, the Team9 backdoor uses the bot ID as the key.</p>
<h3>4.2 Bot commands</h3>
<p>The backdoor supports a variety of commands. These are summarised in the table below.</p>
<table width="0">
<tbody>
<tr>
<td width="205"><strong>Command ID</strong></td>
<td width="217"><strong>Description</strong></td>
<td width="258"><strong>Parameters</strong></td>
</tr>
<tr>
<td width="205">0</td>
<td width="217">Set delay time for the command and control server requests</td>
<td width="258">
<ul>
<li>Time to delay the requests</li>
</ul>
</td>
</tr>
<tr>
<td width="205">1</td>
<td width="217">Collect infected host information</td>
<td width="258">
<ul>
<li> Memory buffer to fill in the collected data</li>
</ul>
</td>
</tr>
<tr>
<td width="205">10</td>
<td width="217">Download file from an address and inject into a process using either hollowing process injection or Doppelgänging process injection</td>
<td width="258">
<ul>
<li>DWORD value that represents the corresponding execution method. This includes:
<ul>
<li>Process hollowing injection</li>
<li>Process Doppelgänging injection</li>
<li>Write the file into disk and execute it</li>
</ul>
</li>
<li>Process mask – DWORD value that represents the process name to inject the payload. This can be one of the following:
<ol>
<li>Explorer</li>
<li>Cmd</li>
<li>Calc (Not used in all variants)</li>
<li>Svchost</li>
<li>notepad</li>
</ol>
</li>
<li>Address from which the file is downloaded</li>
<li>Command line</li>
</ul>
</td>
</tr>
<tr>
<td width="205">11</td>
<td width="217">Download a DLL file and execute it</td>
<td width="258">
<ul>
<li>Timeout value</li>
<li>Address to download the DLL</li>
<li>Command line</li>
<li>Timeout time</li>
</ul>
</td>
</tr>
<tr>
<td width="205">12</td>
<td width="217">Execute a batch file received from the command and control server</td>
<td width="258">
<ul>
<li>DWORD value to determine if the batch script is to be stored into a Windows pipe (run from memory) or in a file into disk</li>
<li>Timeout value.</li>
<li>Batch file content</li>
</ul>
</td>
</tr>
<tr>
<td width="205">13</td>
<td width="217">Execute a PowerShell script received from the command and control server</td>
<td width="258">
<ul>
<li>DWORD value to determine if the PowerShell script is to be stored into a Windows pipe (run from memory) or in a file into disk</li>
<li>Timeout value.</li>
<li>PowerShell script content</li>
</ul>
</td>
</tr>
<tr>
<td width="205">14</td>
<td width="217">Reports back to the command and control server and terminates any handled tasks</td>
<td width="258">None</td>
</tr>
<tr>
<td width="205">15</td>
<td width="217">Terminate a process</td>
<td width="258">
<ul>
<li>PID of the process to terminate</li>
</ul>
</td>
</tr>
<tr>
<td width="205">16</td>
<td width="217">Upload a file to the command and control server. Note: Each variant of the backdoor has a set file size they can handle.</td>
<td width="258">
<ul>
<li>Path of the file to read and upload to the command and control server.</li>
</ul>
</td>
</tr>
<tr>
<td width="205">100</td>
<td width="217">Remove itself</td>
<td width="258">None</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><strong>Table 6</strong> &#8211; Supported backdoor commands</p>
<p>Table 7 summarises the report structure of each command when it reports back (POST request) to the command and control server. Note: In a few samples, the backdoor reports the results to an additional IP address (185.64.106[.]73) If it cannot communicate with the Bazar domains.</p>
<table>
<tbody>
<tr>
<td width="216"><strong>Command ID/Description</strong></td>
<td width="255"><strong>Command execution results structure</strong></td>
</tr>
<tr>
<td width="216">1/ Collect infected host information</td>
<td width="255">The POST request includes the following information:</p>
<ul>
<li>Operating system information</li>
<li>Operating system architecture</li>
<li>NETBIOS name of the infected host</li>
<li>Username of the infected user</li>
<li>Backdoor’s file path</li>
<li>Infected host time zone</li>
<li>Processes list</li>
<li>Keyboard language</li>
<li>Antivirus name and installed applications</li>
<li>Infected host’s external IP</li>
<li>Shared drives</li>
<li>Shared drives in the domain</li>
<li>Trust domains</li>
<li>Infected host administrators</li>
<li>Domain admins</li>
</ul>
</td>
</tr>
<tr>
<td width="216">11/ Download a DLL file and execute it</td>
<td width="255">The POST request includes the following parameters:</p>
<ul>
<li>Command execution errors (Passed in the parameter ‘err’)</li>
<li>Process identifier (Passed in the ‘pid’ parameter)</li>
<li>Command execution output (Passed in the parameter ‘stdout’, if any)</li>
<li>Additional information from the command execution (Passed in the parameter ‘msg’, if any)</li>
</ul>
</td>
</tr>
<tr>
<td width="216">12/ Execute a batch file received from the command and control server</td>
<td width="255">Same as the previous command (11/ Download a DLL file and execute it)</td>
</tr>
<tr>
<td width="216">13/ Execute a PowerShell script received from the command and control server</td>
<td width="255">Same as the previous command (11/ Download a DLL file and execute it)</td>
</tr>
<tr>
<td width="216">14/ Reports back to the command and control server and terminate any handled tasks</td>
<td width="255">POST request with the string ‘ok’</td>
</tr>
<tr>
<td width="216">15/ Terminate a process</td>
<td width="255">Same as the previous command (11/ Download a DLL file and execute it)</td>
</tr>
<tr>
<td width="216">16/ Upload a file to the command and control server</td>
<td width="255">No parameters. The file’s content is sent in a POST request.</td>
</tr>
<tr>
<td width="216">100/ Remove itself</td>
<td width="255">POST request with the string ‘ok’ or ‘process termination error’</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><strong>Table 7</strong> &#8211; Report structure</p>
<h2>5. Appendix</h2>
<h3>5.1 struct shortcut_bin</h3>
<pre>struct shortcut_bin 

{ 
BYTE junk_data[434];
BYTE file_path[520];
BYTE filepath_dir[520];
BYTE file_loader_parameters[1024];
};</pre>
<h3>5.2 IOCs</h3>
<p><strong>File hashes</strong></p>
<table>
<tbody>
<tr>
<td width="84"><strong>Description</strong></td>
<td width="525"><strong>SHA-256 Hash</strong></td>
</tr>
<tr>
<td width="84">Team9 backdoor (x64)</td>
<td width="525">4F258184D5462F64C3A752EC25FB5C193352C34206022C0755E48774592B7707</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x64)</td>
<td width="525">B10DCEC77E00B1F9B1F2E8E327A536987CA84BCB6B0C7327C292F87ED603837D</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x64)</td>
<td width="525">363B6E0BC8873A6A522FE9485C7D8B4CBCFFA1DA61787930341F94557487C5A8</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x64)</td>
<td width="525">F4A5FE23E21B6B7D63FA2D2C96A4BC4A34B40FD40A921B237A50A5976FE16001</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x64)</td>
<td width="525">A0D0CFA8BF0BC5B8F769D8B64EAB22D308B108DD8A4D59872946D69C3F8C58A5</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x64)</td>
<td width="525">059519E03772D6EEEA9498625AE8B8B7CF2F01FC8179CA5D33D6BCF29D07C9F4</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x64)</td>
<td width="525">0F94B77892F22D0A0E7095B985F30B5EDBE17AB5B8D41F798EF0C708709636F4</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x64)</td>
<td width="525">2F0F0956628D7787C62F892E1BD9EDDA8B4C478CF8F1E65851052C7AD493DC28</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x64)</td>
<td width="525">37D713860D529CBE4EAB958419FFD7EBB3DC53BB6909F8BD360ADAA84700FAF2</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x64)</td>
<td width="525">3400A7DF9EC3DC8283D5AC7ACCB6935691E93FEDA066CC46C6C04D67F7F87B2B</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x64)</td>
<td width="525">5974D938BC3BBFC69F68C979A6DC9C412970FC527500735385C33377AB30373A</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x64)</td>
<td width="525">C55F8979995DF82555D66F6B197B0FBCB8FE30B431FF9760DEAE6927A584B9E3</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x86)</td>
<td width="525">94DCAA51E792D1FA266CAE508C2C62A2CA45B94E2FDFBCA7EA126B6CD7BC5B21</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x86)</td>
<td width="525">4EE0857D475E67945AF2C5E04BE4DEC3D6D3EB7C78700F007A7FF6F8C14D4CB3</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x86)</td>
<td width="525">8F552E9CA2BEDD90CE9935A665758D5DE2E86B6FDA32D98918534A8A5881F91A</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x86)</td>
<td width="525">AE7DAA7CE3188CCFE4069BA14C486631EEA9505B7A107A17DDEE29061B0EDE99</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x86)</td>
<td width="525">F3C6D7309F00CC7009BEA4BE6128F0AF2EA6B87AB7A687D14092F85CCD35C1F5</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x86)</td>
<td width="525">6CBF7795618FB5472C5277000D1C1DE92B77724D77873B88AF3819E431251F00</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x86)</td>
<td width="525">B0B758E680E652144A78A7DDECC027D4868C1DC3D8D7D611EC4D3798358B0CE5</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x86)</td>
<td width="525">959BA7923992386ABF2E27357164672F29AAC17DDD4EE1A8AD4C691A1C566568</td>
</tr>
<tr>
<td width="84">Team9 backdoor (x86)</td>
<td width="525">3FE61D87C9454554B0CE9101F95E18ABAD8AC6C62DCC88DC651DDFB20568E060</td>
</tr>
<tr>
<td width="84">Team9 loader (x64)</td>
<td width="525">B3764EF42D526A1AE1A4C3B0FE198F35C6BC5C07D5F155D15060B94F8F6DC695</td>
</tr>
<tr>
<td width="84">Team9 loader (x64)</td>
<td width="525">210C51AAB6FC6C52326ECE9DBD3DDAB5F58E98432EF70C46936672C79542FBD0</td>
</tr>
<tr>
<td width="84">Team9 loader (x64)</td>
<td width="525">11B5ADAEFD04FFDACEB9539F95647B1F51AEC2117D71ECE061F15A2621F1ECE9</td>
</tr>
<tr>
<td width="84">Team9 loader (x64)</td>
<td width="525">534D60392E0202B24D3FDAF992F299EF1AF1FB5EFEF0096DD835FE5C4E30B0FA</td>
</tr>
<tr>
<td width="84">Team9 loader (x64)</td>
<td width="525">9D3A265688C1A098DD37FE77C139442A8EB02011DA81972CEDDC0CF4730F67CF</td>
</tr>
<tr>
<td width="84">Team9 loader (x64)</td>
<td width="525">CE478FDBD03573076394AC0275F0F7027F44A62A306E378FE52BEB0658D0B273</td>
</tr>
<tr>
<td width="84">Team9 loader (x64)</td>
<td width="525">5A888D05804D06190F7FC408BEDE9DA0423678C8F6ECA37ECCE83791DE4DF83D</td>
</tr>
<tr>
<td width="84">Team9 loader (x64)</td>
<td width="525">EB62AD35C613A73B0BD28C1779ACE80E2BA587A7F8DBFEC16CF5BF520CAA71EE</td>
</tr>
<tr>
<td width="84">Team9 loader (x64)</td>
<td width="525">A76426E269A2DEFABCF7AEF9486FF521C6110B64952267CFE3B77039D1414A41</td>
</tr>
<tr>
<td width="84">Team9 loader (x64)</td>
<td width="525">65CDBDD03391744BE87AC8189E6CD105485AB754FED0B069A1378DCA3E819F28</td>
</tr>
<tr>
<td width="84">Team9 loader (x64)</td>
<td width="525">38C9C3800DEA2761B7FAEC078E4BBD2794B93A251513B3F683AE166D7F186D19</td>
</tr>
<tr>
<td width="84">Team9 loader (x64)</td>
<td width="525">8F8673E6C6353187DBB460088ADC3099C2F35AD868966B257AFA1DF782E48875</td>
</tr>
<tr>
<td width="84">Team9 loader (x86)</td>
<td width="525">35B3FE2331A4A7D83D203E75ECE5189B7D6D06AF4ABAC8906348C0720B6278A4</td>
</tr>
<tr>
<td width="84">Team9 loader (x86)</td>
<td width="525">65E44FC8527204E88E38AB320B3E82694D1548639565FDAEE53B7E0F963D3A92</td>
</tr>
<tr>
<td width="84">Team9 loader (x86)</td>
<td width="525">F53509AF91159C3432C6FAF4B4BE2AE741A20ADA05406F9D4E9DDBD48C91EBF9</td>
</tr>
<tr>
<td width="84">Team9 loader (x86)</td>
<td width="525">73339C130BB0FAAD27C852F925AA1A487EADF45DF667DB543F913DB73080CD5D</td>
</tr>
<tr>
<td width="84">Team9 loader (x86)</td>
<td width="525">2342C736572AB7448EF8DA2540CDBF0BAE72625E41DAB8FFF58866413854CA5C</td>
</tr>
<tr>
<td width="84">Team9 loader (x86)</td>
<td width="525">079A99B696CC984375D7A3228232C44153A167C1936C604ED553AC7BE91DD982</td>
</tr>
<tr>
<td width="84">Team9 loader (x86)</td>
<td width="525">0D8AEACF4EBF227BA7412F8F057A8CDDC54021846092B635C8D674B2E28052C6</td>
</tr>
<tr>
<td width="84">Team9 loader (x86)</td>
<td width="525">F83A815CE0457B50321706957C23CE8875318CFE5A6F983A0D0C580EBE359295</td>
</tr>
<tr>
<td width="84">Team9 loader (x86)</td>
<td width="525">3FA209CD62BACC0C2737A832E5F0D5FD1D874BE94A206A29B3A10FA60CEB187D</td>
</tr>
<tr>
<td width="84">Team9 loader (x86)</td>
<td width="525">05ABD7F33DE873E9630F9E4F02DBD0CBC16DD254F305FC8F636DAFBA02A549B3</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><strong>Table 8</strong> &#8211; File hashes</p>
<p><strong>Identified Emercoin domains</strong></p>
<table>
<tbody>
<tr>
<td width="189"><strong>Domains</strong></td>
</tr>
<tr>
<td width="189">newgame[.]bazar</td>
</tr>
<tr>
<td width="189">thegame[.]bazar</td>
</tr>
<tr>
<td width="189">portgame[.]bazar</td>
</tr>
<tr>
<td width="189">workrepair[.]bazar</td>
</tr>
<tr>
<td width="189">realfish[.]bazar</td>
</tr>
<tr>
<td width="189">eventmoult[.]bazar</td>
</tr>
<tr>
<td width="189">bestgame[.]bazar</td>
</tr>
<tr>
<td width="189">forgame[.]bazar</td>
</tr>
<tr>
<td width="189">Zirabuo[.]bazar</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><strong>Table 9</strong> &#8211; Identified Emercoin domains</p>
<p><strong>Command and Control IPs</strong></p>
<table>
<tbody>
<tr>
<td width="471"><strong>C&amp;C IPs</strong></td>
</tr>
<tr>
<td width="471">34.222.222[.]126</td>
</tr>
<tr>
<td width="471">71.191.52[.]192</td>
</tr>
<tr>
<td width="471">77.213.120[.]90</td>
</tr>
<tr>
<td width="471">179[.]43.134.164</td>
</tr>
<tr>
<td width="471">185[.]65.202.62</td>
</tr>
<tr>
<td width="471">220[.]32.32.128</td>
</tr>
<tr>
<td width="471">34[.]222.222.126</td>
</tr>
<tr>
<td width="471">51[.]81.113.26</td>
</tr>
<tr>
<td width="471">71[.]191.52.192</td>
</tr>
<tr>
<td width="471">77[.]213.120.90</td>
</tr>
<tr>
<td width="471">85[.]204.116.58</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><strong>Table 10</strong> &#8211; Command and Control IPs</p>
<p><strong>Identified DNS IPs</strong></p>
<table width="72">
<tbody>
<tr>
<td width="72"><strong>DNS IPs</strong></td>
</tr>
<tr>
<td width="72">51[.]254.25.115</td>
</tr>
<tr>
<td width="72">193[.]183.98.66</td>
</tr>
<tr>
<td width="72">91[.]217.137.37</td>
</tr>
<tr>
<td width="72">87[.]98.175.85</td>
</tr>
<tr>
<td width="72">185[.]121.177.177</td>
</tr>
<tr>
<td width="72">169[.]239.202.202</td>
</tr>
<tr>
<td width="72">198[.]251.90.143</td>
</tr>
<tr>
<td width="72">5[.]132.191.104</td>
</tr>
<tr>
<td width="72">111[.]67.20.8</td>
</tr>
<tr>
<td width="72">163[.]53.248.170</td>
</tr>
<tr>
<td width="72">142[.]4.204.111</td>
</tr>
<tr>
<td width="72">142[.]4.205.47</td>
</tr>
<tr>
<td width="72">158[.]69.239.167</td>
</tr>
<tr>
<td width="72">104[.]37.195.178</td>
</tr>
<tr>
<td width="72">192[.]99.85.244</td>
</tr>
<tr>
<td width="72">158[.]69.160.164</td>
</tr>
<tr>
<td width="72">46[.]28.207.199</td>
</tr>
<tr>
<td width="72">31[.]171.251.118</td>
</tr>
<tr>
<td width="72">81[.]2.241.148</td>
</tr>
<tr>
<td width="72">82[.]141.39.32</td>
</tr>
<tr>
<td width="72">50[.]3.82.215</td>
</tr>
<tr>
<td width="72">46[.]101.70.183</td>
</tr>
<tr>
<td width="72">5[.]45.97.127</td>
</tr>
<tr>
<td width="72">130[.]255.78.223</td>
</tr>
<tr>
<td width="72">144[.]76.133.38</td>
</tr>
<tr>
<td width="72">139[.]59.208.246</td>
</tr>
<tr>
<td width="72">172[.]104.136.243</td>
</tr>
<tr>
<td width="72">45[.]71.112.70</td>
</tr>
<tr>
<td width="72">163[.]172.185.51</td>
</tr>
<tr>
<td width="72">5[.]135.183.146</td>
</tr>
<tr>
<td width="72">51[.]255.48.78</td>
</tr>
<tr>
<td width="72">188[.]165.200.156</td>
</tr>
<tr>
<td width="72">147[.]135.185.78</td>
</tr>
<tr>
<td width="72">92[.]222.97.145</td>
</tr>
<tr>
<td width="72">51[.]255.211.146</td>
</tr>
<tr>
<td width="72">159[.]89.249.249</td>
</tr>
<tr>
<td width="72">104[.]238.186.189</td>
</tr>
<tr>
<td width="72">139[.]59.23.241</td>
</tr>
<tr>
<td width="72">94[.]177.171.127</td>
</tr>
<tr>
<td width="72">45[.]63.124.65</td>
</tr>
<tr>
<td width="72">212[.]24.98.54</td>
</tr>
<tr>
<td width="72">178[.]17.170.179</td>
</tr>
<tr>
<td width="72">185[.]208.208.141</td>
</tr>
<tr>
<td width="72">82[.]196.9.45</td>
</tr>
<tr>
<td width="72">146[.]185.176.36</td>
</tr>
<tr>
<td width="72">89[.]35.39.64</td>
</tr>
<tr>
<td width="72">89[.]18.27.167</td>
</tr>
<tr>
<td width="72">77[.]73.68.161</td>
</tr>
<tr>
<td width="72">185[.]117.154.144</td>
</tr>
<tr>
<td width="72">176[.]126.70.119</td>
</tr>
<tr>
<td width="72">139[.]99.96.146</td>
</tr>
<tr>
<td width="72">217[.]12.210.54</td>
</tr>
<tr>
<td width="72">185[.]164.136.225</td>
</tr>
<tr>
<td width="72">192[.]52.166.110</td>
</tr>
<tr>
<td width="72">63[.]231.92.27</td>
</tr>
<tr>
<td width="72">66[.]70.211.246</td>
</tr>
<tr>
<td width="72">96[.]47.228.108</td>
</tr>
<tr>
<td width="72">45[.]32.160.206</td>
</tr>
<tr>
<td width="72">128[.]52.130.209</td>
</tr>
<tr>
<td width="72">35[.]196.105.24</td>
</tr>
<tr>
<td width="72">172[.]98.193.42</td>
</tr>
<tr>
<td width="72">162[.]248.241.94</td>
</tr>
<tr>
<td width="72">107[.]172.42.186</td>
</tr>
<tr>
<td width="72">167[.]99.153.82</td>
</tr>
<tr>
<td width="72">138[.]197.25.214</td>
</tr>
<tr>
<td width="72">69[.]164.196.21</td>
</tr>
<tr>
<td width="72">94[.]247.43.254</td>
</tr>
<tr>
<td width="72">94[.]16.114.254</td>
</tr>
<tr>
<td width="72">151[.]80.222.79</td>
</tr>
<tr>
<td width="72">176[.]9.37.132</td>
</tr>
<tr>
<td width="72">192[.]71.245.208</td>
</tr>
<tr>
<td width="72">195[.]10.195.195</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><strong>Table 11</strong> &#8211; Identified DNS IPs</p>
<p><strong>Mutexes</strong></p>
<table>
<tbody>
<tr>
<td width="233"><strong>Component</strong></td>
<td width="238"><strong>Mutex name</strong></td>
</tr>
<tr>
<td width="233">Team9 backdoor</td>
<td width="238">mn_185445</td>
</tr>
<tr>
<td width="233">Team9 backdoor</td>
<td width="238">{589b7a4a-3776-4e82-8e7d-435471a6c03c}</td>
</tr>
<tr>
<td width="233">Team9 loader</td>
<td width="238">ld_201127</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><strong>Table 12</strong> &#8211; Mutex names Team9 components</p>
<p><strong>Host IOCs</strong></p>
<ol id="block-8d4ba531-0ca6-4c04-92cd-62b5949c48e1" class="block-editor-block-list__block is-selected rich-text block-editor-rich-text__editable wp-block" role="textbox" aria-label="Write list…" aria-multiline="true">
<li>Files ending with the string ‘_lyrt’</li>
<li>Scheduled tasks with names ‘StartAT’ and ‘StartDT’</li>
<li>Shortcut with file name ‘adobe’ in the Windows ‘StartUp’ folder</li>
<li>Registry value name ‘BackUp Mgr’ in the ‘Run’ registry key</li>
</ol>
<p><strong>Network detection</strong></p>
<div>
<table>
<tbody>
<tr>
<td width="689">alert dns $HOME_NET any -&gt; any 53 (msg:&#8221;FOX-SRT &#8211; Suspicious &#8211; Team9 Emercoin DNS Query Observed&#8221;; dns_query; content:&#8221;.bazar&#8221;; nocase; dns_query; pcre:&#8221;/(newgame|thegame|portgame|workrepair|realfish|eventmoult|bestgame|forgame|zirabuo)\.bazar/i&#8221;; threshold:type limit, track by_src, count 1, seconds 3600; classtype:trojan-activity; metadata:created_at 2020-05-28; metadata:ids suricata; sid:21003029; rev:3;)</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Source(s):</strong></p>
<p>[1] <a href="https://www.bleepingcomputer.com/news/security/bazarbackdoor-trickbot-gang-s-new-stealthy-network-hacking-malware/" rel="nofollow">https://www.bleepingcomputer.com/news/security/bazarbackdoor-trickbot-gang-s-new-stealthy-network-hacking-malware/</a></p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-email"><a rel="nofollow noopener noreferrer" data-shared="" class="share-email sd-button share-icon" href="mailto:?subject=%5BShared%20Post%5D%20In-depth%20analysis%20of%20the%20new%20Team9%20malware%20family&body=https%3A%2F%2Fblog.fox-it.com%2F2020%2F06%2F02%2Fin-depth-analysis-of-the-new-team9-malware-family%2F&share=email" target="_blank" title="Click to email a link to a friend" data-email-share-error-title="Do you have email set up?" data-email-share-error-text="If you&#039;re having problems sharing via email, you might not have email set up for your browser. You may need to create a new email yourself." data-email-share-nonce="06d86fcbf2" data-email-share-track-url="https://blog.fox-it.com/2020/06/02/in-depth-analysis-of-the-new-team9-malware-family/?share=email"><span>Email</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-2613" class="share-facebook sd-button share-icon" href="https://blog.fox-it.com/2020/06/02/in-depth-analysis-of-the-new-team9-malware-family/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-2613" class="share-linkedin sd-button share-icon" href="https://blog.fox-it.com/2020/06/02/in-depth-analysis-of-the-new-team9-malware-family/?share=linkedin" target="_blank" title="Click to share on LinkedIn" ><span>LinkedIn</span></a></li><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-2613" class="share-twitter sd-button share-icon" href="https://blog.fox-it.com/2020/06/02/in-depth-analysis-of-the-new-team9-malware-family/?share=twitter" target="_blank" title="Click to share on Twitter" ><span>Twitter</span></a></li><li class="share-pocket"><a rel="nofollow noopener noreferrer" data-shared="" class="share-pocket sd-button share-icon" href="https://blog.fox-it.com/2020/06/02/in-depth-analysis-of-the-new-team9-malware-family/?share=pocket" target="_blank" title="Click to share on Pocket" ><span>Pocket</span></a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-13954993-2613-67621d84df0d3' data-src='https://widgets.wp.com/likes/?ver=14.2-a.3#blog_id=13954993&amp;post_id=2613&amp;origin=blog.fox-it.com&amp;obj_id=13954993-2613-67621d84df0d3&amp;n=1' data-name='like-post-frame-13954993-2613-67621d84df0d3' data-title='Like or Reblog'><h3 class="sd-title">Like this:</h3><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height: 55px;'><span class='button'><span>Like</span></span> <span class="loading">Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>	</div><!-- .entry-content -->

	<div class="entry-footer">
			</div><!-- .entry-footer -->

	<div class="entry-author-wrapper">
				<div class="site-posted-on">
			<strong>Published</strong>
			<time class="entry-date published" datetime="2020-06-02T16:00:23+02:00">June 2, 2020</time><time class="updated" datetime="2021-02-16T14:45:30+02:00">February 16, 2021</time>		</div><!-- .site-posted-on -->
	</div>
</article><!-- #post-## -->

			
	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://blog.fox-it.com/2020/03/19/ldapfragger-command-and-control-over-ldap-attributes/" rel="prev"><span class="meta-nav screen-reader-text">Previous Post</span> LDAPFragger: Command and Control over LDAP attributes</a></div><div class="nav-next"><a href="https://blog.fox-it.com/2020/06/23/wastedlocker-a-new-ransomware-variant-developed-by-the-evil-corp-group/" rel="next"><span class="meta-nav screen-reader-text">Next Post</span> WastedLocker: A New Ransomware Variant Developed By The Evil Corp Group</a></div></div>
	</nav>
			
		
		</main><!-- #main -->
	</div><!-- #primary -->

		</div><!-- #content -->

		<footer id="colophon" class="site-footer" role="contentinfo">
						<div class="site-info">
				
				
							</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #content-wrapper -->
</div><!-- #page -->

<!--  -->
<script defer id="bilmur" data-customproperties="{&quot;woo_active&quot;:&quot;0&quot;}" data-provider="wordpress.com" data-service="atomic"  src="https://s0.wp.com/wp-content/js/bilmur.min.js?m=202451"></script>
		<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div
				class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions"
				itemscope
				itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"/>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"/>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"/>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"/>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea
													name="comment"
													class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea"
													id="jp-carousel-comment-form-comment-field"
													placeholder="Write a Comment..."
												></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field" />
															</fieldset>
																											</div>
													<input
														type="submit"
														name="submit"
														class="jp-carousel-comment-form-button"
														id="jp-carousel-comment-form-button-submit"
														value="Post Comment" />
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" href="#" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"/>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/blog.fox-it.com\/2020\/06\/02\/in-depth-analysis-of-the-new-team9-malware-family\/":2613};
	</script>
				<link rel='stylesheet' id='all-css-6a27d52917a03aef636928d0d671f91d' href='https://blog.fox-it.com/_static/??-eJyVjFsKgCAQAC+ULQaZP9FZTJewfOG6eP0I6gD9zjDTi7A5NUwNSuDDJ4ITWzH2gpgdBySwpmYmDEDdF6xi5+QCjpZo6D/qV4gPPIMtrlItk5y1VvoGzj40MA==' type='text/css' media='all' />
<script type="text/javascript" id="coblocks-tinyswiper-initializer-js-extra">
/* <![CDATA[ */
var coblocksTinyswiper = {"carouselPrevButtonAriaLabel":"Previous","carouselNextButtonAriaLabel":"Next","sliderImageAriaLabel":"Image"};
/* ]]> */
</script>
<script type='text/javascript'  src='https://blog.fox-it.com/_static/??-eJyVzsEOgjAQBNAfcq2QKPFg/BYoBQbKtmELqF9vjYke1AjX2byZnT1px8FwUN6ONViUdoV1uhNVQoJq3wHljD4PcLxtZTMvkJPh0g2iAvhKMsObYSl9jT7skxIYAbnF7aMmNKY3osCl8XEzRuTHwkKayNJHH+cT6m/P/6c/Tqt7pIMnC+6ocnoUqnBZ1wHWSvQAH2j22vVRn/tTkiXHNDvsd+kdQCeuig=='></script>
<script type="text/javascript" src="https://stats.wp.com/e-202451.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"13954993\",\"post\":\"2613\",\"tz\":\"2\",\"srv\":\"blog.fox-it.com\",\"hp\":\"atomic\",\"ac\":\"2\",\"amp\":\"0\",\"j\":\"1:14.2-a.3\"}") ]);
_stq.push([ "clickTrackerInit", "13954993", "2613" ]);
/* ]]> */
</script>
<script type="text/javascript" id="jetpack-carousel-js-extra">
/* <![CDATA[ */
var jetpackSwiperLibraryPath = {"url":"https:\/\/blog.fox-it.com\/wp-content\/plugins\/jetpack\/_inc\/build\/carousel\/swiper-bundle.min.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/blog.fox-it.com\/wp-admin\/admin-ajax.php","nonce":"0e64344cb9","display_exif":"1","display_comments":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","image_label":"Open image in full-screen.","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"0","login_url":"https:\/\/blog.fox-it.com\/wp-login.php?redirect_to=https%3A%2F%2Fblog.fox-it.com%2F2020%2F06%2F02%2Fin-depth-analysis-of-the-new-team9-malware-family%2F","blog_id":"1","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"]};
/* ]]> */
</script>
<script type='text/javascript'  src='https://blog.fox-it.com/_static/??-eJyNjMsOQDAQAH8IG/E+iE+Rqg3LWtV24/dduLvOZOZ2qT0lokRwrAtJgA2jM3aHkcTCpMQzWONPDcifSz+QHSTZFpL714ZpxwCXouJqZGb0bz8cfd4UZVG1XV4/UII2cQ=='></script>
<script type="text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="https://blog.fox-it.com/wp-content/plugins/jetpack/_inc/build/sharedaddy/sharing.min.js?ver=14.2-a.3" id="sharing-js-js"></script>
<script type="text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-pocket' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-pocket' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcompocket', 'menubar=1,resizable=1,width=450,height=450' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>
	<iframe src='https://widgets.wp.com/likes/master.html?ver=20241218#ver=20241218&#038;n=1' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
	<div id='likes-other-gravatars' class='wpl-new-layout' role="dialog" aria-hidden="true" tabindex="-1"><div class="likes-text"><span>%d</span></div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
	
</body>
</html>
