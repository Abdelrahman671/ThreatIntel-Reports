<!doctype html>
<html lang="en">

<head>
    <title>Threat actors using MacroPack to deploy Brute Ratel, Havoc and PhantomCore payloads</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/bootstrap.min.css?v=d7eb88ed59">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/navigation.css?v=d7eb88ed59">
    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/footer.css?v=d7eb88ed59">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/pagination.css?v=d7eb88ed59">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/banners.css?v=d7eb88ed59">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/style.css?v=d7eb88ed59">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/prism.css?v=d7eb88ed59">
    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/prism-vsc-dark-plus.css?v=d7eb88ed59">
    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/prism-talos.css?v=d7eb88ed59">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/landing-page.css?v=d7eb88ed59">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;1,100;1,300;1,400&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;1,100;1,300;1,400&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/ghost-theme-utils@latest/dist/css/style.min.css" rel="stylesheet">


    <meta name="description" content="The threat of VBA macros has diminished since Microsoft prevented the execution of macros in Microsoft Office documents downloaded from the internet, but not all users are using the latest up-to-date Office versions and can still be vulnerable.">
    <link rel="icon" href="https://blog.talosintelligence.com/content/images/size/w256h256/2022/07/talos_o_square.png" type="image/png">
    <link rel="canonical" href="https://blog.talosintelligence.com/threat-actors-using-macropack/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="Cisco Talos Blog">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Threat actors using MacroPack to deploy Brute Ratel, Havoc and PhantomCore payloads">
    <meta property="og:description" content="The threat of VBA macros has diminished since Microsoft prevented the execution of macros in Microsoft Office documents downloaded from the internet, but not all users are using the latest up-to-date Office versions and can still be vulnerable.">
    <meta property="og:url" content="https://blog.talosintelligence.com/threat-actors-using-macropack/">
    <meta property="og:image" content="https://blog.talosintelligence.com/content/images/size/w1200/2024/09/threat-spotlight.png">
    <meta property="article:published_time" content="2024-09-03T12:00:25.000Z">
    <meta property="article:modified_time" content="2024-09-03T13:14:40.000Z">
    <meta property="article:tag" content="Threats">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Threat actors using MacroPack to deploy Brute Ratel, Havoc and PhantomCore payloads">
    <meta name="twitter:description" content="The threat of VBA macros has diminished since Microsoft prevented the execution of macros in Microsoft Office documents downloaded from the internet, but not all users are using the latest up-to-date Office versions and can still be vulnerable.">
    <meta name="twitter:url" content="https://blog.talosintelligence.com/threat-actors-using-macropack/">
    <meta name="twitter:image" content="https://blog.talosintelligence.com/content/images/size/w1200/2024/09/threat-spotlight.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Vanja Svajcer">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Threats">
    <meta name="twitter:site" content="@TalosSecurity">
    <meta name="twitter:creator" content="@vanjasvajcer">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="600">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Cisco Talos Blog",
        "url": "https://blog.talosintelligence.com/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog.talosintelligence.com/content/images/2022/11/TalosBrand_ukraine.svg"
        }
    },
    "author": {
        "@type": "Person",
        "name": "Vanja Svajcer",
        "url": "https://blog.talosintelligence.com/author/vanja-svajcer/",
        "sameAs": [
            "https://twitter.com/vanjasvajcer"
        ]
    },
    "headline": "Threat actors using MacroPack to deploy Brute Ratel, Havoc and PhantomCore payloads",
    "url": "https://blog.talosintelligence.com/threat-actors-using-macropack/",
    "datePublished": "2024-09-03T12:00:25.000Z",
    "dateModified": "2024-09-03T13:14:40.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://blog.talosintelligence.com/content/images/size/w1200/2024/09/threat-spotlight.png",
        "width": 1200,
        "height": 600
    },
    "keywords": "Threats",
    "description": "The threat of VBA macros has diminished since Microsoft prevented the execution of macros in Microsoft Office documents downloaded from the internet, but not all users are using the latest up-to-date Office versions and can still be vulnerable.Â ",
    "mainEntityOfPage": "https://blog.talosintelligence.com/threat-actors-using-macropack/"
}
    </script>

    <meta name="generator" content="Ghost 5.97">
    <link rel="alternate" type="application/rss+xml" title="Cisco Talos Blog" href="https://blog.talosintelligence.com/rss/">
    
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.3/umd/sodo-search.min.js" data-key="4ffb0139d74ada998f4b141e4d" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.3/umd/main.css" data-sodo-search="https://cisco-talos-blog.ghost.io/" data-locale="en" crossorigin="anonymous"></script>
    
    <link href="https://blog.talosintelligence.com/webmentions/receive/" rel="webmention">
    <script defer src="/public/cards.min.js?v=d7eb88ed59"></script><style>:root {--ghost-accent-color: #006db6;}</style>
    <link rel="stylesheet" type="text/css" href="/public/cards.min.css?v=d7eb88ed59">
    <style type='text/css'>
    img[src*="icon_check_white.svg"] { width: 20px; margin-left: 0px; margin-right: auto; }
    
    #ghost-portal-root { display: none; }
</style>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-F45RVJG3BK"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-F45RVJG3BK');
</script>
</head>

<body class="post-template tag-threats">

    <div id="mobile-page-header" class="desktop-hide">
    <h1>Cisco Talos Blog</h1>
</div>

<nav id="nav">
    <input id="nav-trigger" class="nav-trigger" type="checkbox"/>
    <label for="nav-trigger">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22px" height="16px" viewBox="0 0 22 16">
            <g id="menu-icon">
                <path fill="#FFFFFF" d="M20.5,3h-19C0.672,3,0,2.329,0,1.5S0.672,0,1.5,0h19C21.328,0,22,0.671,22,1.5S21.328,3,20.5,3z"></path>
                <path fill="#FFFFFF" d="M20.5,9.5h-19C0.672,9.5,0,8.828,0,8c0-0.829,0.672-1.5,1.5-1.5h19C21.328,6.5,22,7.171,22,8   C22,8.828,21.328,9.5,20.5,9.5z"></path>
                <path fill="#FFFFFF" d="M20.5,16h-19C0.672,16,0,15.328,0,14.5S0.672,13,1.5,13h19c0.828,0,1.5,0.672,1.5,1.5S21.328,16,20.5,16z"></path>
            </g>
        </svg>
    </label>
    <div id="top-nav-bar">
    </div>

    <div id="navigation">
        <div class="navigation-logos-wrapper">
            <div id="talos-logo-wrapper">
                <a class="navbar-brand" href="https://talosintelligence.com">
                </a>
            </div>
        </div>
        <div class="navigation-links-wrapper">
            <ul class="main-nav-list">
                <li class="nav-item">
                    <div class="primary-link-wrapper">
                        <a class="primary_nav_link" href="https://talosintelligence.com/reputation">
                            <div class="mobile-nav-icon"><!-- Generator: Adobe Illustrator 24.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" height="20px" width="20px" style="enable-background:new 0 0 20 20;" xml:space="preserve">
                            <style type="text/css">
                                .white{fill:#FFFFFF;}
                            </style>
                            <g>
                                <path class="white" d="M19.5,9.5h-1.1c-0.3-4.2-3.6-7.6-7.8-7.8V0.5C10.5,0.2,10.3,0,10,0l0,0C9.7,0,9.5,0.2,9.5,0.5l0,0v1.1   C5.3,1.9,1.9,5.3,1.6,9.5H0.5C0.2,9.5,0,9.7,0,10s0.2,0.5,0.5,0.5l0,0h1.1c0.3,4.2,3.6,7.6,7.8,7.8v1.1c0,0.3,0.2,0.5,0.5,0.5l0,0   c0.3,0,0.5-0.2,0.5-0.5l0,0v-1.1c4.2-0.3,7.6-3.6,7.8-7.8h1.1c0.3,0,0.5-0.2,0.5-0.5C20,9.7,19.8,9.5,19.5,9.5 M16.6,10.5h0.7   c-0.3,3.6-3.2,6.5-6.8,6.8v-0.8c0-0.3-0.2-0.5-0.5-0.5l0,0c-0.3,0-0.5,0.2-0.5,0.5v0.8C5.8,17,3,14.2,2.7,10.5h0.8   C3.8,10.5,4,10.3,4,10S3.8,9.5,3.5,9.5l0,0H2.7C3,5.8,5.8,3,9.5,2.7v0.8C9.5,3.7,9.7,4,10,4l0,0c0.3,0,0.5-0.2,0.5-0.5V2.7   C14.2,3,17,5.8,17.3,9.5h-0.7c-0.3,0-0.5,0.2-0.5,0.5C16.1,10.3,16.3,10.5,16.6,10.5L16.6,10.5"></path>
                                                            <circle class="white" cx="10" cy="10" r="3.2"></circle>
                            </g>
                            </svg>
                            </div>
                            <span class="top-nav-link-text">
                                Intelligence Center
                            </span>
                        </a>
                    </div>
                    <input class="sub-nav-trigger" id="intelligence-sub-trigger" type="checkbox">
                    <label class="sub-nav-trigger-label" for="intelligence-sub-trigger">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                            <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                            <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                            </g>
                        </svg>

                    </label>
                    <ul class="sub-nav sub-nav-single-list">
                        <li class="desktop-hide">
                            <a class="mobile_nav_link" href="https://talosintelligence.com/reputation"><h1>Intelligence Center</h1>
                            </a></li>
                        <li class="desktop-hide">
                            <label class="subnav-back-button" for="intelligence-sub-trigger">BACK</label>
                        </li>
                        <li><a class="secondary_nav_link" href="https://talosintelligence.com/reputation_center">Intelligence Search</a></li>
                        <li><a class="secondary_nav_link" href="https://talosintelligence.com/reputation_center/email_rep">Email &amp; Spam Trends</a></li>
                    </ul>
                    <div class="desktop-hide subnav-overlay"><!-- Generator: Adobe Illustrator 24.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" height="20px" width="20px" style="enable-background:new 0 0 20 20;" xml:space="preserve">
                        <style type="text/css">
                            .white{fill:#FFFFFF;}
                        </style>
                                                <g>
                            <path class="white" d="M19.5,9.5h-1.1c-0.3-4.2-3.6-7.6-7.8-7.8V0.5C10.5,0.2,10.3,0,10,0l0,0C9.7,0,9.5,0.2,9.5,0.5l0,0v1.1   C5.3,1.9,1.9,5.3,1.6,9.5H0.5C0.2,9.5,0,9.7,0,10s0.2,0.5,0.5,0.5l0,0h1.1c0.3,4.2,3.6,7.6,7.8,7.8v1.1c0,0.3,0.2,0.5,0.5,0.5l0,0   c0.3,0,0.5-0.2,0.5-0.5l0,0v-1.1c4.2-0.3,7.6-3.6,7.8-7.8h1.1c0.3,0,0.5-0.2,0.5-0.5C20,9.7,19.8,9.5,19.5,9.5 M16.6,10.5h0.7   c-0.3,3.6-3.2,6.5-6.8,6.8v-0.8c0-0.3-0.2-0.5-0.5-0.5l0,0c-0.3,0-0.5,0.2-0.5,0.5v0.8C5.8,17,3,14.2,2.7,10.5h0.8   C3.8,10.5,4,10.3,4,10S3.8,9.5,3.5,9.5l0,0H2.7C3,5.8,5.8,3,9.5,2.7v0.8C9.5,3.7,9.7,4,10,4l0,0c0.3,0,0.5-0.2,0.5-0.5V2.7   C14.2,3,17,5.8,17.3,9.5h-0.7c-0.3,0-0.5,0.2-0.5,0.5C16.1,10.3,16.3,10.5,16.6,10.5L16.6,10.5"></path>
                                                    <circle class="white" cx="10" cy="10" r="3.2"></circle>
                        </g>
                        </svg>
                    </div>
                </li>
                <li class="nav-item">
                    <div class="primary-link-wrapper">
                        <a class="primary_nav_link" href="https://talosintelligence.com/vulnerability_info"><div class="mobile-nav-icon"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="26px" height="20px" viewBox="0 0 26 20">
                            <g id="vuln-icon" class="nav-icon">
                                <path fill="#FFFFFF" d="M24.256,18.49L13.872,0.503C13.692,0.192,13.36,0,13,0c-0.359,0-0.692,0.192-0.872,0.503L1.744,18.49  c-0.18,0.312-0.18,0.695,0,1.006C1.924,19.809,2.257,20,2.616,20h20.769c0.359,0,0.691-0.191,0.871-0.504  C24.436,19.186,24.436,18.803,24.256,18.49 M14.268,18.215h-2.533v-1.85h2.533V18.215z M14.268,15.441h-2.533L10.89,6.515h4.222  L14.268,15.441z"></path>
                            </g>
                        </svg>
                        </div>
                            <span class="top-nav-link-text">
                            Vulnerability Research
                            </span>
                        </a></div>
                    <input class="sub-nav-trigger" id="vuln-sub-trigger" type="checkbox">
                    <label class="sub-nav-trigger-label" for="vuln-sub-trigger">
                        <div class="mobile-nav-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                            <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                            <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                            </g>
                        </svg>
                        </div>
                    </label>
                    <ul class="sub-nav sub-nav-single-list">
                        <li class="desktop-hide">
                            <a href="https://talosintelligence.com/vulnerability_info"><h1>Vulnerability Information</h1>
                            </a></li>
                        <li class="desktop-hide">
                            <label class="subnav-back-button" for="vuln-sub-trigger">BACK</label>
                        </li>
                        <li><a class="vulnerabilty-info-nav-link" href="https://talosintelligence.com/vulnerability_reports">Vulnerability Reports</a></li>
                        <li><a class="vulnerabilty-info-nav-link" href="https://talosintelligence.com/ms_advisories">Microsoft Advisories</a></li>
                    </ul>
                    <div class="desktop-hide subnav-overlay">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="26px" height="20px" viewBox="0 0 26 20">
                        <g id="vuln-icon" class="nav-icon">
                            <path fill="#FFFFFF" d="M24.256,18.49L13.872,0.503C13.692,0.192,13.36,0,13,0c-0.359,0-0.692,0.192-0.872,0.503L1.744,18.49  c-0.18,0.312-0.18,0.695,0,1.006C1.924,19.809,2.257,20,2.616,20h20.769c0.359,0,0.691-0.191,0.871-0.504  C24.436,19.186,24.436,18.803,24.256,18.49 M14.268,18.215h-2.533v-1.85h2.533V18.215z M14.268,15.441h-2.533L10.89,6.515h4.222  L14.268,15.441z"></path>
                        </g>
                        </svg>
                    </div>
                </li>
                <li class="nav-item">
                    <a class="primary_nav_link" href="https://talosintelligence.com/incident_response">
                        <div class="mobile-nav-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="111.588" height="148.311" viewBox="0 0 111.588 148.311">
                            <path d="M1.181,128.446v15.7a4.167,4.167,0,0,0,4.167,4.167h100.9a4.167,4.167,0,0,0,4.167-4.167v-15.7a4.167,4.167,0,0,0-4.167-4.167H5.348a4.167,4.167,0,0,0-4.167,4.166M55.8,63.109a3.277,3.277,0,1,1,0,6.553c-10.344,0-20.755,8.578-20.755,18.57a3.277,3.277,0,1,1-6.554,0C28.489,73.947,41.93,63.109,55.8,63.109Zm0-12.016c-21.787,0-39.325,17.81-39.325,39.937v26.7H95.122V91.03c0-22.128-17.537-39.937-39.324-39.937m52.365-38.3a3.291,3.291,0,0,0-2.254,1.024L88.432,31.294a3.283,3.283,0,0,0,4.642,4.644l17.478-17.479a3.278,3.278,0,0,0-2.389-5.666m-105.138,0a3.276,3.276,0,0,0-1.98,5.666L18.522,35.938a3.283,3.283,0,0,0,4.643-4.644L5.687,13.817A3.255,3.255,0,0,0,3.025,12.793ZM55.389.026a3.276,3.276,0,0,0-2.867,3.345V19.642a3.277,3.277,0,1,0,6.554,0V3.371A3.283,3.283,0,0,0,55.389.026Z" fill="#fff"></path>
                            </svg>
                        </div>
                        <span class="top-nav-link-text">
                        Incident Response
                        </span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="primary_nav_link" href="https://blog.talosintelligence.com">
                        <div class="mobile-nav-icon">
                        <!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" width="260px" height="296.5px" viewBox="0 0 260 296.5" enable-background="new 0 0 260 296.5" xml:space="preserve">
                        <path fill="#FFFFFF" d="M243.586,42.404h-14.448c-0.943-4.513-3.143-8.813-6.616-12.33L201.793,9.098  c-4.7-4.757-10.972-7.377-17.66-7.377c-6.578,0-12.777,2.547-17.457,7.173l-33.875,33.511H17.586c-6.6,0-12,5.399-12,12V226.28  c0,6.6,5.4,12,12,12H153.83l84.21,56.278l-27.448-56.278h32.994c6.6,0,12-5.4,12-12V54.404  C255.586,47.804,250.186,42.404,243.586,42.404z M214.662,48.045c-0.01,0.2-0.021,0.399-0.044,0.599  c-0.008,0.069-0.021,0.139-0.031,0.207c-0.046,0.345-0.113,0.688-0.196,1.026c-0.034,0.137-0.063,0.273-0.103,0.408  c-0.039,0.135-0.087,0.267-0.133,0.399c-0.051,0.151-0.102,0.302-0.16,0.45c-0.049,0.126-0.105,0.249-0.16,0.373  c-0.068,0.153-0.139,0.307-0.216,0.457c-0.059,0.116-0.12,0.23-0.184,0.345c-0.088,0.157-0.181,0.312-0.278,0.465  c-0.065,0.104-0.13,0.206-0.2,0.308c-0.115,0.168-0.239,0.33-0.366,0.492c-0.064,0.081-0.124,0.165-0.19,0.244  c-0.199,0.238-0.409,0.472-0.635,0.694L82.458,182.308l-47.932,12.871l13.427-47.74L177.223,19.561  c1.917-1.895,4.414-2.84,6.911-2.84c2.534,0,5.068,0.975,6.99,2.92l20.726,20.974c0.545,0.552,1.002,1.156,1.39,1.79  c0.574,0.938,0.975,1.951,1.206,2.993c0.004,0.021,0.01,0.04,0.014,0.06c0.049,0.226,0.086,0.453,0.119,0.682  c0.008,0.06,0.017,0.118,0.024,0.178c0.026,0.211,0.045,0.424,0.058,0.636c0.004,0.077,0.007,0.153,0.009,0.23  c0.007,0.203,0.011,0.407,0.005,0.61C214.673,47.877,214.666,47.961,214.662,48.045z"></path>
                        </svg>
                    </div>
                        <span class="top-nav-link-text">Blog</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="primary_nav_link" href="https://support.talosintelligence.com">
                        <div class="mobile-nav-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="26px" height="20px" viewBox="0 0 123.17 159.292">
                            <path d="M61.59,0,0,17.069v85.32c0,23.472,61.59,56.9,61.59,56.9s61.58-36.288,61.58-56.9V17.069Zm-.433,149.746C38.314,136.662,8.128,114.3,8.128,102.389V23.239l53.029-14.7Z" fill="#fff"></path>
                        </svg>
                        </div>
                        <span class="top-nav-link-text">Support</span>
                    </a>
                </li>
            </ul>


<!--                <li class="nav-item desktop-hide">-->
<!--                    <button class="search-button" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg> <span>Search Blog</span></button>-->
<!--                </li>-->

            <ul class="secondary-nav-list">
                <div class="more-desktop-link">
                    <div class="more-link-wrapper">
                        <span class="more-nav-link">
                            <div class="desktop-nav-icon more-menu-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22px" height="16px" viewBox="0 0 22 16">
                                <g id="menu-icon">
                                    <path fill="#FFFFFF" d="M20.5,3h-19C0.672,3,0,2.329,0,1.5S0.672,0,1.5,0h19C21.328,0,22,0.671,22,1.5S21.328,3,20.5,3z"></path>
                                    <path fill="#FFFFFF" d="M20.5,9.5h-19C0.672,9.5,0,8.828,0,8c0-0.829,0.672-1.5,1.5-1.5h19C21.328,6.5,22,7.171,22,8   C22,8.828,21.328,9.5,20.5,9.5z"></path>
                                    <path fill="#FFFFFF" d="M20.5,16h-19C0.672,16,0,15.328,0,14.5S0.672,13,1.5,13h19c0.828,0,1.5,0.672,1.5,1.5S21.328,16,20.5,16z"></path>
                                </g>
                                </svg>
                            </div>
                            <span class="top-nav-link-text top-nav-more-text">
                            More
                            </span>
                        </span>
                    </div>
                </div>
                <li class="nav-item more-text-link">
                    <div class="more-link-wrapper more-link-wrapper-mobile">
                        <span class="more-nav-link">
                            <div class="mobile-nav-icon"><!-- Generator: Adobe Illustrator 24.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" style="enable-background:new 0 0 20 20;" width="25px" height="25px" xml:space="preserve">
                                <style type="text/css">
                                    .white{fill:#FFFFFF;}
                                </style>
                                <path class="white" d="M19.4,17.1c0,0.1-0.1,0-0.2,0c0,0-1.3-0.9-2-1.4c-0.2-0.1-0.5-0.1-0.6,0.1c-0.3,0.3-0.6,0.8-0.9,1.3  c-0.1,0.2-0.1,0.5,0.1,0.6l2,1.5c0.1,0,0,0.1,0.1,0.2c0,0.1,0,0.1-0.1,0.2c-1.2,0.5-2.6,0.2-3.5-0.7c-0.8-0.9-1-2-0.7-3.1L4.5,6.5  c-1,0.3-2.3,0-3-0.9c-0.8-0.9-1.1-1.7-1-2.7c0-0.1,0-0.1,0.1-0.2c0.1,0,0.2,0.1,0.2,0.1l2,1.5C3,4.4,3.3,4.5,3.4,4.2  c0,0,0.5-0.8,0.9-1.3c0.1-0.2,0.1-0.5-0.1-0.6L2.3,0.9c-0.1,0,0-0.1-0.1-0.3c0-0.1,0-0.1,0.1-0.2C3.5-0.1,5,0.2,5.8,1.1  c0.8,0.9,1,2,0.7,3.1l9.1,9.3c1-0.3,2.3,0,3,0.9c0.7,0.7,0.9,1.5,0.9,2.5C19.5,16.9,19.5,17,19.4,17.1z"></path>
                                </svg>
                            </div>
                            <span class="top-nav-link-text top-nav-more-text">
                            Security Resources
                            </span>
                        </span>
                    </div>
                    <input class="sub-nav-trigger" id="security-resources-sub-trigger" type="checkbox">
                    <label class="sub-nav-trigger-label" for="security-resources-sub-trigger">
                        <div class="mobile-nav-icon"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                            <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                            <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                            </g>
                        </svg>
                        </div>
                    </label>
                    <div class="sub-nav sub-nav-multiple-list sub-nav-multiple-list-left">
                        <div class="sub-nav-multiple-wrapper">
                            <div class="sub-nav-list-top-of-mobile-wrapper">
                                <h1 class="sub-nav-list-header sub-nav-list-top-of-mobile">Security Resources</h1>
                                <ul class="sub-nav-list">
                                    <li class="desktop-hide">
                                        <label class="subnav-back-button" for="security-resources-sub-trigger">BACK</label>
                                    </li>
                                </ul>
                            </div>
                            <div class="sub-nav-list-item-wrapper">
                                <span class="sub-nav-desktop-header uppercase">Security Resources</span>
                                <ul class="sub-nav-list">
                                    <li>
                                        <a href="https://talosintelligence.com/software"><span>Open Source Security Tools</span>
                                        </a></li>
                                    <li>
                                        <a href="https://talosintelligence.com/categories"><span>Intelligence Categories Reference</span>
                                        </a></li>
                                    <li>
                                        <a href="https://talosintelligence.com/secure-endpoint-naming"><span>Secure Endpoint Naming Reference</span>
                                        </a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="desktop-hide subnav-overlay"><!-- Generator: Adobe Illustrator 24.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" style="enable-background:new 0 0 20 20;" width="25px" height="25px" xml:space="preserve">
                        <style type="text/css">
                            .white{fill:#FFFFFF;}
                        </style>
                                                <path class="white" d="M19.4,17.1c0,0.1-0.1,0-0.2,0c0,0-1.3-0.9-2-1.4c-0.2-0.1-0.5-0.1-0.6,0.1c-0.3,0.3-0.6,0.8-0.9,1.3  c-0.1,0.2-0.1,0.5,0.1,0.6l2,1.5c0.1,0,0,0.1,0.1,0.2c0,0.1,0,0.1-0.1,0.2c-1.2,0.5-2.6,0.2-3.5-0.7c-0.8-0.9-1-2-0.7-3.1L4.5,6.5  c-1,0.3-2.3,0-3-0.9c-0.8-0.9-1.1-1.7-1-2.7c0-0.1,0-0.1,0.1-0.2c0.1,0,0.2,0.1,0.2,0.1l2,1.5C3,4.4,3.3,4.5,3.4,4.2  c0,0,0.5-0.8,0.9-1.3c0.1-0.2,0.1-0.5-0.1-0.6L2.3,0.9c-0.1,0,0-0.1-0.1-0.3c0-0.1,0-0.1,0.1-0.2C3.5-0.1,5,0.2,5.8,1.1  c0.8,0.9,1,2,0.7,3.1l9.1,9.3c1-0.3,2.3,0,3,0.9c0.7,0.7,0.9,1.5,0.9,2.5C19.5,16.9,19.5,17,19.4,17.1z"></path>
                        </svg>
                    </div>
                </li>
                <li class="nav-item">
                    <div class="more-link-wrapper more-link-wrapper-mobile">
                        <span class="more-nav-link">
                            <div class="mobile-nav-icon"><!-- Generator: Adobe Illustrator 24.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" width="25px" height="25px" style="enable-background:new 0 0 20 20;" xml:space="preserve">
                                <style type="text/css">
                                    .sticoncomment{fill-rule:evenodd;clip-rule:evenodd;fill:#FFFFFF;}
                                </style>
                                <path class="sticoncomment" d="M13.6,7.1H6.4c-0.3,0-0.6-0.3-0.6-0.6c0-0.3,0.3-0.6,0.6-0.6l7.2,0c0.3,0,0.6,0.3,0.6,0.6  C14.2,6.8,13.9,7.1,13.6,7.1L13.6,7.1z M13.6,9.4H6.4c-0.3,0-0.6-0.3-0.6-0.6s0.3-0.6,0.6-0.6l7.2,0c0.3,0,0.6,0.3,0.6,0.6  C14.2,9.2,13.9,9.4,13.6,9.4L13.6,9.4z M11.5,11.7H6.4c-0.3,0-0.6-0.3-0.6-0.6c0-0.3,0.3-0.6,0.6-0.6h5.1c0.3,0,0.6,0.3,0.6,0.6  C12.1,11.5,11.8,11.7,11.5,11.7z M15.8,3H4.2C3.5,3,3,3.5,3,4.2V17l2.8-2.3h10c0.6,0,1.2-0.5,1.2-1.2V4.2C17,3.5,16.5,3,15.8,3  L15.8,3z"></path>
                                </svg>
                            </div>
                            <span class="top-nav-link-text top-nav-more-text">
                            Media
                            </span>
                        </span>
                    </div>
                    <input class="sub-nav-trigger" id="media-sub-trigger" type="checkbox">
                    <label class="sub-nav-trigger-label" for="media-sub-trigger">
                        <div class="mobile-nav-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                            <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                            <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                            </g>
                            </svg>
                        </div>
                    </label>
                    <div class="sub-nav sub-nav-multiple-list sub-nav-multiple-list-middle">
                        <div class="sub-nav-multiple-wrapper">
                            <div class="sub-nav-list-top-of-mobile-wrapper">
                                <h1 class="sub-nav-list-header sub-nav-list-top-of-mobile">Media</h1>
                                <ul class="sub-nav-list">
                                    <li class="desktop-hide">
                                        <label class="subnav-back-button" for="media-sub-trigger">BACK</label>
                                    </li>
                                </ul>
                            </div>
                            <div class="sub-nav-list-item-wrapper">
                                <span class="sub-nav-desktop-header uppercase">Media</span>
                                <ul class="sub-nav-list">
                                    <li>
                                        <a href="https://blog.talosintelligence.com"><span>Talos Intelligence Blog</span>
                                        </a></li>
                                    <li>
                                        <a href="https://blog.talosintelligence.com/category/threat-source-newsletter/"><span>Threat Source Newsletter</span>
                                        </a></li>
                                    <li>
                                        <a href="https://talosintelligence.com/podcasts/shows/beers_with_talos"><span>Beers with Talos Podcast</span>
                                        </a></li>
                                    <li>
                                        <a href="https://talosintelligence.com/podcasts/shows/talos_takes"><span>Talos Takes Podcast</span>
                                        </a></li>
                                    <li>
                                        <a target="_blank" href="https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured"><span>Talos Videos</span>
                                        </a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="desktop-hide subnav-overlay"><!-- Generator: Adobe Illustrator 24.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" width="25px" height="25px" style="enable-background:new 0 0 20 20;" xml:space="preserve">
                        <style type="text/css">
                            .sticoncomment{fill-rule:evenodd;clip-rule:evenodd;fill:#FFFFFF;}
                        </style>
                        <path class="sticoncomment" d="M13.6,7.1H6.4c-0.3,0-0.6-0.3-0.6-0.6c0-0.3,0.3-0.6,0.6-0.6l7.2,0c0.3,0,0.6,0.3,0.6,0.6  C14.2,6.8,13.9,7.1,13.6,7.1L13.6,7.1z M13.6,9.4H6.4c-0.3,0-0.6-0.3-0.6-0.6s0.3-0.6,0.6-0.6l7.2,0c0.3,0,0.6,0.3,0.6,0.6  C14.2,9.2,13.9,9.4,13.6,9.4L13.6,9.4z M11.5,11.7H6.4c-0.3,0-0.6-0.3-0.6-0.6c0-0.3,0.3-0.6,0.6-0.6h5.1c0.3,0,0.6,0.3,0.6,0.6  C12.1,11.5,11.8,11.7,11.5,11.7z M15.8,3H4.2C3.5,3,3,3.5,3,4.2V17l2.8-2.3h10c0.6,0,1.2-0.5,1.2-1.2V4.2C17,3.5,16.5,3,15.8,3  L15.8,3z"></path>
                        </svg>
                    </div>
                </li>
                <li class="nav-item">
                    <div class="more-link-wrapper more-link-wrapper-mobile">
                        <span class="more-nav-link">
                            <div class="mobile-nav-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25px" height="25px" viewBox="0 0 55 55">
                                <g>
                                    <g class="mobile-nav-home">
                                        <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M45.201,12.343c0.378,0.48,0.758,0.925,1.096,1.401    c2.975,4.207,4.543,8.876,4.494,14.044c-0.05,5.452-1.643,10.386-5.186,14.593c-3.484,4.133-7.929,6.73-13.182,7.895    c-6.313,1.398-12.216,0.275-17.695-3.131c-0.441-0.273-0.847-0.6-1.266-0.904c-0.11-0.078-0.208-0.174-0.337-0.287    c0.127-0.141,0.246-0.27,0.366-0.398c0.887-0.949,1.765-1.904,2.663-2.844c0.114-0.119,0.321-0.217,0.485-0.217    c3.658-0.006,7.318,0,10.975,0.008c3.458,0.006,6.913,0.02,10.369,0.02c0.957,0,1.871-0.193,2.62-0.844    c0.797-0.693,1.157-1.596,1.157-2.643c0.001-7.533,0.003-15.067-0.005-22.601c-0.002-0.309,0.088-0.524,0.3-0.743    C43.098,14.598,44.127,13.49,45.201,12.343"></path>
                                        <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M41.402,8.822c-0.99,1.027-1.994,2.021-2.935,3.072    c-0.312,0.35-0.616,0.416-1.036,0.415c-6.98-0.009-13.957-0.007-20.938-0.007c-2.039,0-3.561,1.514-3.561,3.557    c0,6.504,0.002,13.008,0.006,19.512c0.002,0.973,0.011,1.943,0.004,2.914c0,0.133-0.04,0.301-0.127,0.393    c-1.069,1.162-2.15,2.314-3.229,3.469c-0.021,0.023-0.052,0.039-0.109,0.08c-0.159-0.188-0.323-0.369-0.471-0.562    c-2.535-3.348-4.119-7.102-4.605-11.268c-0.61-5.229,0.194-10.229,2.835-14.839c2.669-4.664,6.655-7.805,11.618-9.75    c3.205-1.257,6.533-1.852,9.977-1.621c4.478,0.298,8.553,1.754,12.227,4.325c0.101,0.072,0.197,0.151,0.291,0.229    C41.364,8.755,41.374,8.778,41.402,8.822"></path>
                                        <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M39.799,12.47c0.873-0.911,1.749-1.829,2.676-2.797    c0.605,0.564,1.195,1.112,1.816,1.691c-0.941,0.985-1.817,1.903-2.703,2.83c-0.276-0.339-0.511-0.688-0.807-0.975    C40.492,12.941,40.145,12.728,39.799,12.47"></path>
                                        <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M10.35,43.279c0.969-1.016,1.885-1.977,2.76-2.893    c0.213,0.369,0.376,0.762,0.639,1.072c0.265,0.312,0.627,0.539,0.98,0.832c-0.853,0.891-1.713,1.791-2.624,2.746    C11.513,44.445,10.939,43.869,10.35,43.279"></path>
                                    </g>
                                </g>
                                </svg>
                            </div>
                            <span class="top-nav-link-text top-nav-more-text">
                            Company
                            </span>
                        </span>
                    </div>
                    <input class="sub-nav-trigger" id="company-sub-trigger" type="checkbox">
                    <label class="sub-nav-trigger-label" for="company-sub-trigger">
                        <div class="mobile-nav-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                            <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                            <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                            </g>
                        </svg>
                        </div>
                    </label>
                    <div class="sub-nav sub-nav-multiple-list sub-nav-multiple-list-right">
                        <div class="sub-nav-multiple-wrapper">
                            <div class="sub-nav-list-top-of-mobile-wrapper">
                                <h1 class="sub-nav-list-header sub-nav-list-top-of-mobile">Company</h1>
                                <ul class="sub-nav-list">
                                    <li class="desktop-hide">
                                        <label class="subnav-back-button" for="company-sub-trigger">BACK</label>
                                    </li>
                                </ul>
                            </div>
                            <div class="sub-nav-list-item-wrapper">
                                <span class="sub-nav-desktop-header uppercase">Company</span>
                                <ul class="sub-nav-list">
                                    <li>
                                        <a href="https://talosintelligence.com/about"><span>About Talos</span>
                                        </a></li>
                                    <li>
                                        <a href="https://talosintelligence.com/careers"><span>Careers</span>
                                        </a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="desktop-hide subnav-overlay"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25px" height="25px" viewBox="0 0 55 55">
                        <g>
                            <g class="mobile-nav-home">
                                <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M45.201,12.343c0.378,0.48,0.758,0.925,1.096,1.401    c2.975,4.207,4.543,8.876,4.494,14.044c-0.05,5.452-1.643,10.386-5.186,14.593c-3.484,4.133-7.929,6.73-13.182,7.895    c-6.313,1.398-12.216,0.275-17.695-3.131c-0.441-0.273-0.847-0.6-1.266-0.904c-0.11-0.078-0.208-0.174-0.337-0.287    c0.127-0.141,0.246-0.27,0.366-0.398c0.887-0.949,1.765-1.904,2.663-2.844c0.114-0.119,0.321-0.217,0.485-0.217    c3.658-0.006,7.318,0,10.975,0.008c3.458,0.006,6.913,0.02,10.369,0.02c0.957,0,1.871-0.193,2.62-0.844    c0.797-0.693,1.157-1.596,1.157-2.643c0.001-7.533,0.003-15.067-0.005-22.601c-0.002-0.309,0.088-0.524,0.3-0.743    C43.098,14.598,44.127,13.49,45.201,12.343"></path>
                                <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M41.402,8.822c-0.99,1.027-1.994,2.021-2.935,3.072    c-0.312,0.35-0.616,0.416-1.036,0.415c-6.98-0.009-13.957-0.007-20.938-0.007c-2.039,0-3.561,1.514-3.561,3.557    c0,6.504,0.002,13.008,0.006,19.512c0.002,0.973,0.011,1.943,0.004,2.914c0,0.133-0.04,0.301-0.127,0.393    c-1.069,1.162-2.15,2.314-3.229,3.469c-0.021,0.023-0.052,0.039-0.109,0.08c-0.159-0.188-0.323-0.369-0.471-0.562    c-2.535-3.348-4.119-7.102-4.605-11.268c-0.61-5.229,0.194-10.229,2.835-14.839c2.669-4.664,6.655-7.805,11.618-9.75    c3.205-1.257,6.533-1.852,9.977-1.621c4.478,0.298,8.553,1.754,12.227,4.325c0.101,0.072,0.197,0.151,0.291,0.229    C41.364,8.755,41.374,8.778,41.402,8.822"></path>
                                <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M39.799,12.47c0.873-0.911,1.749-1.829,2.676-2.797    c0.605,0.564,1.195,1.112,1.816,1.691c-0.941,0.985-1.817,1.903-2.703,2.83c-0.276-0.339-0.511-0.688-0.807-0.975    C40.492,12.941,40.145,12.728,39.799,12.47"></path>
                                <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M10.35,43.279c0.969-1.016,1.885-1.977,2.76-2.893    c0.213,0.369,0.376,0.762,0.639,1.072c0.265,0.312,0.627,0.539,0.98,0.832c-0.853,0.891-1.713,1.791-2.624,2.746    C11.513,44.445,10.939,43.869,10.35,43.279"></path>
                            </g>
                        </g>
                    </svg>
                    </div>
                </li>
            </ul>
            <div class="nav-search-wrapper">
                <button class="search-button" data-ghost-search>
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                </button>
            </div>
        </div>



    </div>
</nav>

    

    <main id="site-main">
        <div class="container-fluid">
            <div class="row main-content-row">
                <div class="col">
                    <div class="post-full-content">
                        
<article class="post tag-threats ">
        <div class="feature-image-wrapper my-5">
            <figure>
                <img src="/content/images/2024/09/threat-spotlight.png" alt="" class="img-fluid" />
            </figure>
        </div>

    <h1 class="text-center">Threat actors using MacroPack to deploy Brute Ratel, Havoc and PhantomCore payloads</h1>

    <div class="text-center m-1">
        <div class="post-author">
            <span>By </span>
                <a href="https://blog.talosintelligence.com/author/vanja-svajcer/">Vanja Svajcer</a>
        </div>

        <br/>
        <time class="post-datetime" datetime="September 3, 2024 08:00">
            Tuesday, September 3, 2024 08:00
        </time>

        <div class="m-3">
                            <a href="/category/threats/" class="category primary-category">
                                Threats
                            </a>
                                </div>
    </div>

    <section class="post-content-wrapper mt-5">
        <div class="post-content">
            <ul><li>Cisco Talos recently discovered several related Microsoft Office documents uploaded to VirusTotal by various actors between May and July 2024 that were all generated by a version of a payload generator framework called âMacroPack.â</li><li>MacroPack is a framework designated for Red Team exercises, but we assess, with moderate confidence, that malicious actors are also using it to deploy malicious payloads.</li><li>Talos analyzed the most recent documents uploaded to VirusTotal from different sources and countries, including China, Pakistan, Russia and the U.S., uncovering connections between the payloads and motivations for creating these documents.</li><li>These malicious files deliver multiple payloads, including the Havoc and Brute Ratel post-exploitation frameworks and a new variant of the PhantomCore remote access trojan (RAT).</li><li>Talos was not able to attribute these activities to a single actor despite some similarities in tactics, techniques and procedures (TTPs). No Talos customers were affected by these attacks and there are no related activities&nbsp; in any Cisco product telemetry.</li></ul><p>The threat of VBA macros has diminished since Microsoft prevented the execution of macros in Microsoft Office documents downloaded from the internet, but not all users are using the latest up-to-date Office versions and can still be vulnerable.&nbsp;</p><p>As a part of regular hunting exercises for malicious documents similar to the ones used by <a href="https://blog.talosintelligence.com/malicious-campaigns-target-entities-in-ukraine-poland/"><u>UNC1151</u></a>, we discovered several suspicious documents using VBA macros that were similar but could not be attributed to the same threat actor.</p><p>Although the VBA code was similar â using obfuscated variable and function names and one or more layers of obfuscated code in their following stages â the lure themes were different, ranging from generic topics that instruct users to enable VBA macros, to official-looking documents and letters that appear to come from military organizations, pointing to various distinct threat actors.&nbsp;</p><h2 id="common-characteristics-of-macropack-vba-code">Common characteristics of MacroPack VBA code</h2><p>The VBA code in all the documents had similar characteristics, which we traced to the MacroPack framework. MacroPack can generate several types of payloads packaged into different file types, including popular Office-supported formats, scripting files and shortcuts.&nbsp;</p><p>The code generated by the framework has the following characteristics, making it more difficult to detect using file content signatures:</p><ul><li>Function renaming.</li><li>Variable renaming.</li><li>Removal of surplus space characters.</li><li>Removal of comments.</li><li>Strings encoding.</li><li>Payload obfuscation.</li></ul><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXetI7X00OCZ7LlC8sPdVVrLPUmSuxY43n0hYh5NLP2SGTqkjrBPePrKwK-Frh8EIPAIDYBMueJSBedmsExONRa4DUvBdOrOO-26c3olhd-fKTvluYDJk7sC-z6orDExvs1D9Xjy0iT6BvnnyqDPo-8idLdl?key=2U1SLKATkzYvUNWGq241rw" class="kg-image" alt="" loading="lazy" width="714" height="479"><figcaption><span style="white-space: pre-wrap;">A payload string deobfuscation function generated by MacroPack.</span></figcaption></figure><p>MacroPack is designed to be easy to use and quickly generate various payloads allowing users to build working implants with a single command line.&nbsp;</p><p>MacroPack also exists in a professional, supported version, which contains additional functionality to make payloads more resilient and has some more advanced features such as anti-malware bypass, more advanced payloads, anti-reversing and additional payloads. The author states that the tool is intended to be used by Red Team members and not for malicious purposes, although there is no control over who uses the free version of the tool.&nbsp;</p><h3 id="inclusion-of-non-malicious-code">Inclusion of non-malicious code</h3><p>A common feature in all the malicious documents we dissected that caught our attention is the existence of four non-malicious VBA subroutines. These subroutines appeared in all the samples and were not obfuscated. They also had never been used by any other malicious subroutines or anywhere else in any documents.&nbsp;</p><p>At the beginning of the investigation, we suspected all the documents containing these unusual non-malicious subroutines were created by a single threat actor. But the different document lures and countries from where the documents were uploaded lead us to conclude that those subroutines were included by the professional version of MacroPack, which we confirmed via reliable, high-fidelity sources.&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXeE5DI2N0sjfVz8HB9yGrwX0HNBdd_6ENKpmhJqUz3ilY6qrlCSR_chvxqX9R7Hgtw5g47U3CPvS3galhlsB1f_6_gjmJobyUv10iErByefb6zQQMSCBYgKjfTz7vUqxT9fOeEeFaqLKR2xfiJZ_CCln_49?key=2U1SLKATkzYvUNWGq241rw" class="kg-image" alt="" loading="lazy" width="721" height="405"><figcaption><span style="white-space: pre-wrap;">Snippet of code taken from a Word programming book.</span></figcaption></figure><p>We traced the origin of the two functions to a website hosting various <a href="https://www.automateexcel.com/vba/word/macro-examples"><u>VBA examples</u></a> and one to a French Microsoft Word programming book <a href="https://archive.org/details/RedigezFacilementDesDocumentsAvecWord"><u>âRÃ©digez Facilement Des Documents Avec Wordâ</u></a> (âEasily Writing Documents with Wordâ) by Michel Martin.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXcmT8_SqZyZR4oHmo-_IZ9tT6TMmapBISeD1gPPXsfQKYbaeIpWnRyMFrYusIUONFqv2hmvQrvQPX0g8-8fjh5YJYLhTIR56xWy6sg8XSfOPScA2c_cWb5ofl11GtksxV6vqjIOq6ferUNsX1HJtzs7IGxz?key=2U1SLKATkzYvUNWGq241rw" class="kg-image" alt="" loading="lazy" width="562" height="411"><figcaption><span style="white-space: pre-wrap;">Non-malicious functions common for all discovered documents from the VBA examples website.</span></figcaption></figure><p>The inclusion of the benign code is likely to lower the level of suspicion of the code generated by MacroPack. Some anti-malware engines may be able to detect code as suspicious if the entropy of the code is high to indicate pseudo-randomly named variables, functions and obfuscated strings and the inclusion of non-malicious functions with low entropy may be used to lower the overall entropy of the generated code.&nbsp;</p><p>Some documents containing the non-malicious code, attributed to MacroPack, also used a different technique for generating code. Instead of completely pseudo-randomly generated variable and function names, they consisted of combinations of randomly chosen real words.&nbsp;</p><p>The MacroPack author indicated that he worked on a feature to generate names using <a href="https://www.samcodes.co.uk/project/markov-namegen/"><u>Markov chains</u></a> to create seemingly meaningful function and variable names.&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXdbs9euE2ESXabKp62BzNlbIRyft8ZeFsHMU7zsYPKc2BgWhBQaGU81Iq4-25YtsjyhQ0M_3Shyz0MvaGanAGK05jqcf5V126AovjHuDDKQfupN-mgGq6IlH1BLp7Ny4NzO5qWzGYp09FoW5PhMS02eLOI?key=2U1SLKATkzYvUNWGq241rw" class="kg-image" alt="" loading="lazy" width="1178" height="666"><figcaption><span style="white-space: pre-wrap;">MacroPack author announced the random name generator based on valid English words on X (Twitter).&nbsp;</span></figcaption></figure><p>This functionality was included by the MacroPack author to improve the bypassing of anti-malware heuristic detections. We discovered a few samples using this technique to obfuscate the functionality of the code with meaningful-looking function and variable names.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXdvbOxClrgbU3DgGvxKJdR3pEeiXdtJwgBAWo9qdrNHqFCEYVX7ikeNtMrYJ_H7kidWe8xj0wXnFkCNtlyby6x1PvTz7C-xwOgI5o5Nq2VR8_dUlt2aSl0KMugNfbWIvvDPxu3PZrLSY8vvAmIhmWqlJ-m1?key=2U1SLKATkzYvUNWGq241rw" class="kg-image" alt="" loading="lazy" width="639" height="280"><figcaption><span style="white-space: pre-wrap;">Function and variable names generated by a Markov chain.</span></figcaption></figure><h2 id="macropack-documents-uploaded-to-virustotal">MacroPack documents uploaded to VirusTotal</h2><p>Although the TTPs in the discovered samples seem malicious and the lure themes indicate that they are, we were unable to trace the actors to a particular group, which also leaves a possibility that they were part of red teaming exercises. However, it is still important to document the samples as blue teams may also encounter them in their own detection tests.&nbsp;</p><p>For some discovered samples, we confirmed they were part of some Red Team activities and they are not included in the list of IOCs. A description of a few interesting clusters of documents follows.&nbsp;</p><p>All the documents have a similar flow, being generated by the framework and consist of at least three stages of code before connecting to the C2 server, to allow infected systems to be controlled by the threat actors.&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXeLW7k6AUAthnb4jMcYlNhZSfj9T1X2WYZCccEErpKR6kvKfzZOfOWlS6buJm4VJisLZIzr2G7oi6wAjXatYXNyklS1tFAg1Om1VNtyFaJzp7wlmCBw420g5GHkDlnIKvtQltsXdrNDKpfPGedLTG5Mo4fX?key=2U1SLKATkzYvUNWGq241rw" class="kg-image" alt="" loading="lazy" width="1600" height="1011"><figcaption><span style="white-space: pre-wrap;">Stages of execution for discovered MacroPack-generated documents.</span></figcaption></figure><h3 id="theme-1-lures-uploaded-from-china">Theme 1: Lures uploaded from China</h3><p>The first cluster of three documents were uploaded to VirusTotal from IP addresses residing in China, Taiwan and Pakistan in May and July 2024, and feature three similar lures with a generic Word document content that instructs the users to âenable content,â which would allow a VBA macro code to execute. The beginning of the document contains this text either in Chinese or English.&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXe7pjmxubvPg8Ah7I3W_pIIRV1BS1R09oORlovdDv5BmRjlGUw5b_PmdFEEbqou3veuRAFTQUEvzmGyPeow17kPIFpjjohN5MH-98Lob0tCzBu5Ajdu2gjN4F7EHcuqD83N3GyDx2tl_6AnYQFOeIEE8Yj0?key=2U1SLKATkzYvUNWGq241rw" class="kg-image" alt="" loading="lazy" width="1217" height="458"><figcaption><i><em class="italic" style="white-space: pre-wrap;">Chinese version of the lure.</em></i></figcaption></figure><p>All C2 IP addresses for the payloads of the generic template campaign reside in the address space of the same autonomous system, AS4837, located in the Henan province in China, which, together with the usage of similar lure themes and MacroPack, enable us to cluster them as originating from a single actor.&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXeiGlsgqk2LReMrt46qb2Al4Dfpwl9DKufvlKcNLht4wCzOvD9b7hFPqjyUnejf6Qv7vS0dkh9c-SyfOj47Fj6uqeiv3-DWXEBS6A6_WDPl7P9ERIs6sYZzg4NZOSgCUo1j2jRXcvXgfnnvJxemVraB1r0K?key=2U1SLKATkzYvUNWGq241rw" class="kg-image" alt="" loading="lazy" width="813" height="488"><figcaption><i><em class="italic" style="white-space: pre-wrap;">English variant of the lure.</em></i></figcaption></figure><h4 id="theme-1-payloads">Theme 1 payloads</h4><p>Two of the three documents, the ones with lures in Chinese, have the Havoc demon (implant) as the final payload. <a href="https://havocframework.com/"><u>Havoc</u></a> is a post-exploitation command and control (C2) framework made for penetration testers, Red Teams and Blue Teams. It's free and open-source on GitHub, written and maintained by Paul Ungur. The Havoc Framework is split into two components â the teamserver and the agent. The Teamserver handles connected operators, tasking agents and parsing the callbacks, results of commands, uploaded files and screenshots. The agents or implants are called demons, in Havoc terminology, and are installed by the operator to the systems that should be controlled.The agents allow the operators to remotely control affected systems.&nbsp;</p><p>The difference between the two variants are that they have different IP addresses for C2, and one lure is compiled for 64-bit Windows, while the other is for 32-bit Windows. Both lures are likely related, as they share similar lure themes, have the same AS for C2 addresses and have C2 URLs that appear as if cloud email communication is attempted, together with appropriate referrers set up in HTTP headers.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXefKQ81iq_h4xjMBudNvJRspBU889tkXsnKMU0xVWo2XQK6zvN9o9HAyUjD6AhKifJGx7Y8isnMDYDZNeog8eyfcXdrZU3mO7OQ70gMLbWCgKjdnxtkfu8FS0g_xkiZxzknAsddYAgbtUyzPGoJQtljzC0?key=2U1SLKATkzYvUNWGq241rw" class="kg-image" alt="" loading="lazy" width="848" height="277"><figcaption><span style="white-space: pre-wrap;">First Havoc demon communication to C2, with appropriate HTTP headers specified in its configuration buffer.</span></figcaption></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXd4t2f4ZQIcCfhZ3T0whIR8jrV2FH2FWKz7TutuslJQum-OJ2Sesy1j8G06AtHn1UBXArb0bwOtMj0fd94hhnSKnUYJa8AejGvznnesxzO-xt54XnUDX4G6xbwznTHKlhFwrhPgWmc-vYvXy0fYXpfRAVLo?key=2U1SLKATkzYvUNWGq241rw" class="kg-image" alt="" loading="lazy" width="736" height="408"><figcaption><span style="white-space: pre-wrap;">After the shellcode loads the Havoc demon, the DLL reads its configuration hosts from a plain text structure.</span></figcaption></figure><p>The second payload is a Brute Ratel implant (badger) loaded from a shellcode loader as a DLL.&nbsp; Brute Ratel is a C2 framework primarily used for Red Teaming and adversary simulation, although it was also abused by real threat actors.&nbsp;</p><p>Brute Ratel is a very popular framework similar to Cobalt Strike and enables its users to:</p><ul><li>Deploy agents (called badgers) onto target systems.</li><li>Execute commands remotely.</li><li>Perform lateral movement within a network.</li><li>Establish persistence.</li><li>Evade detection by endpoint security solutions.</li></ul><p>The configuration for the badger is stored in the shellcode body (approximately 250KB long) and the DLL decrypts it using RC4 decryption with the decryption key hardcoded in the badger executable.&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXctEjCTvnPWjj6zVsGFL08tRkgOJ3KO7r_KsynCe6NUP7hP4Lf3LtWojHYdPRY1N9CWCYTqTZu1DsTpBg-zc9pv1FcCFWunYD9xi0yBTNmAWmazkUavC1Ir2XZ_COPdyX2wVUDFH9_gHVQavKSizitgAbbZ?key=2U1SLKATkzYvUNWGq241rw" class="kg-image" alt="" loading="lazy" width="791" height="700"><figcaption><span style="white-space: pre-wrap;">Brute Ratel configuration is decrypted by a RC4 decryption routine in the DLL badger.</span></figcaption></figure><h3 id="theme-2-pakistani-military-lures">Theme 2: Pakistani military lures</h3><p>The second cluster of documents, with Pakistani military-related themes, were uploaded to VirusTotal from two different locations in Pakistan. We have elected to classify them together based on the military-related themes and a Brute Ratel DLL badger as the final payload.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXdMBUHNciA2GpEnceAUjkWncG3NY4O5mwTbAAkNDw8qL8MNXE5--AO4-sXjtRvf7Ha5GYOeCYaanrsQ89pYTDn5WRzJ_KY1Uw-pLgtFnZQ_TetgcL2UuQ8sEjzTIcjff873lPYAvWwLTyPlfDy_ZjE6SYQ?key=2U1SLKATkzYvUNWGq241rw" class="kg-image" alt="" loading="lazy" width="787" height="342"><figcaption><span style="white-space: pre-wrap;">Pakistani military-themed document lure uploaded to VirusTotal in January 2024.&nbsp;</span></figcaption></figure><p>The first document contains an embedded image of a document masquerading as a circular claiming to announce new awards for certain officer ranks in the Pakistan Air Force, with land plots as a reward for their services. When the document is opened and VBA code allowed to run, the MacroPack-generated code will create a Brute Ratel shellcode loader in memory and execute it to load a badger DLL. The configuration for all DLL implants is contained in the shellcode and is used by the badger after decryption using RC4-based decryption.&nbsp;</p><p>The implant in the first document is configured to use DNS over HTTPs with dns[.]google and cloudflare-dns[.]com servers to tunnel the data over DNS for hosts dns1[.]s-logistics[.]net and dns2[.]s-logistics[.]net.</p><p>The second lure purports to be a confidential document sent to a specific recipient containing an employment confirmation letter for a civilian member of Pakistanâs Air Force Cyber Team. The payload for this document is also a DLL-based Brute Ratel badger, but this time using several Amazon Cloudfront CDN servers for the C2 rotation.&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXc_Pgf0ypWdRuKzt0zphcl722FSod23IaUQBVQpVhqGNlKv0tJYI1piOeKN2ERi34FcTnjIVbfc3dWTZzln8rl3y0wBFUHok7u6q3W8Pq868BpjzPVbrvvAvto4xvLok-LWdtKuo8zRcOyMG5GaD77rVb4?key=2U1SLKATkzYvUNWGq241rw" class="kg-image" alt="" loading="lazy" width="955" height="478"><figcaption><span style="white-space: pre-wrap;">Pakistani military-themed document lure uploaded to VirusTotal in February 2024.&nbsp;</span></figcaption></figure><p>One interesting characteristic of the second documentâs Brute Ratel payload is the inclusion of a base64-encoded blob containing a JSON object created to be used with the Adobe Experience Cloud ecosystem for tracking marketing activities. One possible reason for this is that the document was part of a Red Team exercise and Adobe Experience Cloud was used to track the targetâs engagement.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXfyKdi7QMTkHLqL_yAcPh6x0-KIOtAta8-yVMYSzB96HcWzRw3DcezObA7dSMGRqRdCLJ4YJBeCEyMjqPTogTGGsHoCilo2qDMKOTgIaptQ-WXp2MOhYRfQvhPv_CiDxGcD_2-BEW_0nRqlD7a_Yo6E7Nb4?key=2U1SLKATkzYvUNWGq241rw" class="kg-image" alt="" loading="lazy" width="881" height="279"><figcaption><span style="white-space: pre-wrap;">Adobe Experience Cloud requests details from the second document.</span></figcaption></figure><h3 id="theme-3-lure-uploaded-from-russia">Theme 3: Lure uploaded from Russia</h3><p>A few things stood out when we observed a file created with MacroPack uploaded to VirusTotal from a Russian IP address at the beginning of July 2024. While most of the other files we analyzed were Word documents, this one is an Excel workbook. The lure also is completely void of content, and when the workbook is opened, there is nothing to see.&nbsp;</p><p>The VBA code was also a bit different from the ones discovered earlier. Instead of creating a byte array containing shellcode and loading it into the host process, this one had more VBA code for the next stage, and the way it was executed was also quite unusual.&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXfKoAEh9GuD7ch4VWoYOikiq69evLFNb4oEEC-oHd6Y3bDb7HyIKBzVZ0mF-n9C4yXdOrY3wPD9AtZaDX9ACEdtSO8aZVgk-O1X2alPzbHR7xeJKqqjh6SMwzUO6y-5Kd1RbCvfCLZYeGzY_DgJj_YpeXw?key=2U1SLKATkzYvUNWGq241rw" class="kg-image" alt="" loading="lazy" width="777" height="233"><figcaption><i><em class="italic" style="white-space: pre-wrap;">Partially deobfuscated second stage attempt to download and execute a file from a URL</em></i></figcaption></figure><p><em>.</em>The first-stage code generates the second VBA layer, launches a new instance of Excel and creates a new workbook that is the target for the injection of the second stage, similar to VBA virus infection.&nbsp;</p><p>When the second stage is executed, it attempts to download, load and execute a file from the URL hxxp[://]td[.]tula-steel[.]ru/en/image[.]jpg. We have no indication that this TTP was successful.&nbsp;</p><h4 id="theme-3-payload">Theme 3 payload</h4><p>At the time of writing this post, the target URL contained a sample of a Golang-based backdoor PhantomCore, which is attributed by researchers from Kaspersky to the Ukrainian hacktivist <a href="https://x.com/head_mare"><u>Head Mare</u></a>, allegedly targeting government organizations and companies in Russia with the goal of cyber espionage.&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXfBDAagm2YLcZNUnw319fp9fr72EMpZcAWHHgq5fQzZm0USbDyg0_u9vbNVIbmFk1WG674CceV1Igw7t8K49N3AhYy9hBj7osjOEfhl7DVQ9AWTrBkpI6vrHcivl_VNZ5Ha94lhsmmLBX2x91v8PX31cETS?key=2U1SLKATkzYvUNWGq241rw" class="kg-image" alt="" loading="lazy" width="692" height="202"><figcaption><i><em class="italic" style="white-space: pre-wrap;">Before connecting to listen for commands, the C2 host and port are retrieved from PhantomCore data.</em></i></figcaption></figure><p>Some PhantomCore variants are obfuscated with the Golang obfuscator, garble, which makes them more challenging for the analyst, but the core functionality is similar â to connect to a C2 server using the <a href="https://rsocket.io/"><u>rsocket protocol</u></a> and listen for commands that allows it to install additional modules, upload data or execute a command.&nbsp;</p><h3 id="theme-4-uploaded-from-the-us">Theme 4: Uploaded from the U.S.</h3><p>&nbsp;This final theme was uploaded to VirusTotal much earlier than the previous examples (March 2023) and it purports to be an encrypted NMLS (U.S. Nationwide Multistate Licensing System &amp; Registry) renewal form. We chose this document lure to demonstrate MacroPackâs usage of a Markov Chain-based name generator. This document, similar to the lure uploaded from Russia, has multiple VBA stages.&nbsp;</p><figure class="kg-card kg-image-card"><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXcvMmRfUZDCE5vGCPI2XRV07z3YeakK3IXazXK8-UHWjQ4SicND55BcYfGL6iuOraNEIYrBErLQC_pOmbBVK65tThuNUm2nMNxlCb_THZT5v1EnbJTutltucoAl9GhXpGYg7IH3iTlVZVUI9GaD8715fodH?key=2U1SLKATkzYvUNWGq241rw" class="kg-image" alt="" loading="lazy" width="751" height="290"></figure><p>The first stage decodes the second and launches another Word instance to run it. Before launching the final payload, the second stage checks for the presence of the analysis environment, such as sandboxes and test systems.&nbsp;</p><p>The second stage code will exit any the following conditions are satisfied:</p><ul><li>Number of logical CPUs in the system is 1.</li><li>The User name is âUSERâ.</li><li>One of the following processes are active: fiddler, vxstream, vboxservice, tcpview, vmware, procexp, wmtools, processexplorer, processhacker, vbox, autoit, wireshark, procmon, idaq, autoruns, apatedns or windbg.</li><li>The overall disk size is smaller than 60GB.</li><li>Total memory size is smaller than 1GB.</li><li>Word Application recent files count is smaller than three.</li></ul><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXfgDhZGluiP9F6Gmm7JiJXq7815PYc62lFsvPLfXvvJcwbp_lp5FToRh1_ZfwhMEYs0cXV79pKZNsXChx4WygFcn4RRcpgc1va1E6jgP4xGc0y7xEqp8SzPQDBy-Cp0DH38E87ImPDd7-Q--4BknP9vN-4?key=2U1SLKATkzYvUNWGq241rw" class="kg-image" alt="" loading="lazy" width="763" height="598"><figcaption><i><em class="italic" style="white-space: pre-wrap;">Obfuscated function is checking for presence of analysis environment before downloading the payload.</em></i></figcaption></figure><p>The final payload was likely supposed to be an HTML application as the download and launch was attempted by executing the command line âmshta.exe hxxps[://]share[.]dedesignanddev[.]com:443/datadocâ. At the time of writing, Talos has not been able to retrieve and identify the final payload.&nbsp;</p><h2 id="coverage">Coverage</h2><p>Ways our customers can detect and block this threat are listed below.</p><figure class="kg-card kg-image-card"><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXck-xrAOnn_Qi5poamksKYWSGZA9THlemmPkgn028PVe6t9DMPDarDlwn5E8-QGdUj0jn5_VKE8pi8qMzzDGp5yGFmAh9RSOjkKbl7DhVEWE6HegqERiRtUR93vyXnR70ll1O0Zo_Z1ZbTReQd4sgMLQ7A?key=2U1SLKATkzYvUNWGq241rw" class="kg-image" alt="" loading="lazy" width="1600" height="323"></figure><p><a href="https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/index.html"><u>Cisco Secure Endpoint</u></a> (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free <a href="https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/free-trial.html?utm_medium=web-referral?utm_source=cisco&amp;utm_campaign=amp-free-trial&amp;utm_term=pgm-talos-trial&amp;utm_content=amp-free-trial"><u>here.</u></a></p><p><a href="https://www.cisco.com/c/en/us/products/security/email-security/index.html"><u>Cisco Secure Email</u></a> (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign. You can try Secure Email for free <a href="https://www.cisco.com/c/en/us/products/security/cloud-mailbox-defense?utm_medium=web-referral&amp;utm_source=cisco&amp;utm_campaign=cmd-free-trial-request&amp;utm_term=pgm-talos-trial"><u>here</u></a>.</p><p><a href="https://www.cisco.com/c/en/us/products/security/firewalls/index.html"><u>Cisco Secure Firewall</u></a> (formerly Next-Generation Firewall and Firepower NGFW) appliances such as <a href="https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw-virtual/datasheet-c78-742858.html"><u>Threat Defense Virtual</u></a>, <a href="https://www.cisco.com/c/en/us/products/security/adaptive-security-appliance-asa-software/index.html"><u>Adaptive Security Appliance</u></a> and <a href="https://meraki.cisco.com/products/appliances"><u>Meraki MX</u></a> can detect malicious activity associated with this threat.</p><p><a href="https://www.cisco.com/c/en/us/products/security/stealthwatch/index.html"><u>Cisco Secure Network/Cloud Analytics</u></a> (Stealthwatch/Stealthwatch Cloud) analyzes network traffic automatically and alerts users of potentially unwanted activity on every connected device.</p><p><a href="https://www.cisco.com/c/en/us/products/security/threat-grid/index.html"><u>Cisco Secure Malware Analytics</u></a> (formerly Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products.</p><p><a href="https://umbrella.cisco.com/"><u>Umbrella</u></a>, Ciscoâs secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella <a href="https://signup.umbrella.com/?utm_medium=web-referral?utm_source=cisco&amp;utm_campaign=umbrella-free-trial&amp;utm_term=pgm-talos-trial&amp;utm_content=automated-free-trial"><u>here</u></a>.</p><p><a href="https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html"><u>Cisco Secure Web Appliance</u></a> (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them.&nbsp;</p><p>Additional protections with context to your specific environment and threat data are available from the <a href="https://www.cisco.com/c/en/us/products/security/firepower-management-center/index.html"><u>Firewall Management Center</u></a>.</p><p><a href="https://signup.duo.com/?utm_source=talos&amp;utm_medium=referral&amp;utm_campaign=duo-free-trial"><u>Cisco Duo</u></a> provides multi-factor authentication for users to ensure only those authorized are accessing your network.&nbsp;</p><p>Open-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on <a href="https://www.snort.org/products"><u>Snort.org</u></a>. Snort SIDs for this threat are 63942.</p><h2 id="iocs">IOCs&nbsp;</h2><p>IOCs for this research can also be found at our GitHub repository <a href="https://raw.githubusercontent.com/Cisco-Talos/IOCs/main/2024/09/threat-actors-using-macropack.txt" rel="noreferrer"><u>here</u></a>.&nbsp;</p><p><strong>Theme 1</strong></p><p>0cf1e59bae9dba7fbbf6ee6a36ca6bdb8fa0ac002b8cf824bd0888789a981c57 -64 bit Havoc demon</p><p>hxxps[://]122[.]114[.]141[.]214/qq[.]com/ab735a258a90e8e1f3e3dcf231bf53a9/mail/ - Havoc C2</p><p>93df1d60edd6b656b08e0fc0d31b330fd275f5e1a9069dfbb769e7ba217fcb6e - Brute Ratel loader</p><p>hxxp[://]122[.]114[.]10[.]239/qazxsw -Brute Ratel C2</p><p>hxxp[://]122[.]114[.]10[.]239/edcvfr</p><p>2131de0cb705afa52f88ef70a87ee6c8662d38db0138efc4940218ee62d8a296 - 32 bit Havoc demon</p><p>hxxp[://]122[.]114[.]166[.]92/Collectors/3[.]0/settings/mail/ - Havoc C2</p><p><strong>Theme 2</strong></p><p>cbafcf65b40d95e4699859a523ef4d300c57f93de6fbc6e194d1b922e9f3aba6 - PAF cyber team lure</p><p>b5608e73eb460944d9b523a940d94c95d3eb66d6a8efe82462e2589ccfaadb82 - allotment of plots, Pakistan military</p><p>dns1[.]s-logistics[.]net - Brute Ratel C2 - DNS</p><p>dns2[.]s-logistics[.]net - Brute Ratel C2 - DNS</p><p>hxxps[://]d3qrqtfazjdt5i[.]cloudfront[.]net/HubsExtension/Resource/Type/c8d984[.]php - Brute Ratel C2</p><p>hxxps[://]d3qrqtfazjdt5i[.]cloudfront[.]net/HubsExtension/Browse/resourceType/id[.]php</p><p>hxxps[://]d2wpc9lcvgj680[.]cloudfront[.]net//HubsExtension/Resource/Type/c8d984[.]php</p><p>hxxps[://]d2wpc9lcvgj680[.]cloudfront[.]net/HubsExtension/Browse/resourceType/id[.]php</p><p>hxxps[://]d1209brpqetpa4[.]cloudfront[.]net/HubsExtension/Resource/Type/c8d984[.]php</p><p>hxxps[://]d1209brpqetpa4[.]cloudfront[.]net/HubsExtension/Browse/resourceType/id[.]php</p><p>hxxps[://]d2v6ycjbdzo6ui[.]cloudfront[.]net/HubsExtension/Browse/resourceType/id[.]php</p><p>hxxps[://]d2v6ycjbdzo6ui[.]cloudfront[.]net/HubsExtension/Resource/Type/c8d984[.]php</p><p>hxxps[://]d2z6sfzo660xrm[.]cloudfront[.]net/HubsExtension/Browse/resourceType/id[.]php</p><p>hxxps[://]d2z6sfzo660xrm[.]cloudfront[.]net/HubsExtension/Resource/Type/c8d984[.]php</p><p><strong>Theme 3</strong></p><p>e1ee389b2af2d3a0eff4aa14f2ac3de6cdd4a73de80b5d450a44ec69cd332dbf - Excel malicious workbook</p><p>80731db97c33b50cd3d8727decec7e6a12bbf5f671527648c4cbb559fabc3074 - payload PhantomCore RAT</p><p>api.wilbderreis[.]ru - PhantomCore C2, using rsocket protocol on port 80</p><p>hxxp[://]td[.]tula-steel[.]ru/en/image[.]jpg</p><p><strong>Theme 4</strong></p><p>2c0a66c6370b4aa88ab3805d520e868cbc513b43119958257a72c9ff58ef241c - NMLS renewal theme maldoc</p><p>hxxps[://]share[.]dedesignanddev[.]com:443/datadoc</p>
        </div>
    </section>
    <div class="social-media-wrapper">
    <h5>Share this post</h5>
    <ul class="social-media-share-list">
        <li>
            <a class="share-facebook" title="Share this on Facebook" data-text="Threat actors using MacroPack to deploy Brute Ratel, Havoc and PhantomCore payloads" data-href="https://blog.talosintelligence.com/threat-actors-using-macropack/" rel="nofollow" target="_blank" href="https://www.facebook.com/sharer.php?u=https://blog.talosintelligence.com/threat-actors-using-macropack/"></a>
        </li>
        <li>
            <a class="share-x" title="Post This" data-text="Threat actors using MacroPack to deploy Brute Ratel, Havoc and PhantomCore payloads" data-href="https://blog.talosintelligence.com/threat-actors-using-macropack/" rel="nofollow" target="_blank" href="https://x.com/share?url=https://blog.talosintelligence.com/threat-actors-using-macropack/"></a>
        </li>
        <li>
            <a class="share-linkedin" title="Share this on LinkedIn" data-text="Threat actors using MacroPack to deploy Brute Ratel, Havoc and PhantomCore payloads" data-href="https://blog.talosintelligence.com/threat-actors-using-macropack/" rel="nofollow" target="_blank" href="https://www.linkedin.com/sharing/share-offsite/?url=https://blog.talosintelligence.com/threat-actors-using-macropack/"></a>
        </li>
        <li>
            <a class="share-reddit" title="Reddit This" data-text="Threat actors using MacroPack to deploy Brute Ratel, Havoc and PhantomCore payloads" data-href="https://blog.talosintelligence.com/threat-actors-using-macropack/" rel="nofollow" target="_blank" href="https://www.reddit/submit?url=https://blog.talosintelligence.com/threat-actors-using-macropack/"></a>
        </li>
        <li>
            <a class="share-email" title="Email This" href="mailto:?body=Threat actors using MacroPack to deploy Brute Ratel, Havoc and PhantomCore payloadshttps://blog.talosintelligence.com/threat-actors-using-macropack/"></a>
        </li>
    </ul>
</div></article>
                    </div>
                </div>
                <div class="col-lg alt-layout-row-dk sidebar" id="side-bar">
                            <h4>Related Content</h4>

                                <div class="sidebar-snippet-wrapper">
                                    <a href="/gophish-powerrat-dcrat/">
                                        <h3>Threat actor abuses Gophish to deliver new PowerRAT and DCRAT</h3>
                                        <span  class="preview-attributes">October 22, 2024 06:00</span>
                                        <p>Cisco Talos recently discovered a phishing campaign using an open-source phishing toolkit called Gophish by an unknown threat actor.</p>
                                    </a>
                                </div>
                                <div class="sidebar-snippet-wrapper">
                                    <a href="/threat-actor-believed-to-be-spreading-new-medusalocker-variant-since-2022/">
                                        <h3>Threat actor believed to be spreading new MedusaLocker variant since 2022</h3>
                                        <span  class="preview-attributes">October 3, 2024 06:00</span>
                                        <p>The malware, called &quot;BabyLockerKZ,&quot; has primarily affected users in Europe and South America.</p>
                                    </a>
                                </div>
                                <div class="sidebar-snippet-wrapper">
                                    <a href="/simple-mail-transfer-pirates/">
                                        <h3>Simple Mail Transfer Pirates:   How threat actors are abusing third-party infrastructure to send spam</h3>
                                        <span  class="preview-attributes">September 26, 2024 09:00</span>
                                        <p>Many spammers have elected to attack web pages and mail servers of legitimate organizations, so they may use these âpiratedâ resources to send unsolicited email.</p>
                                    </a>
                                </div>
                </div>
            </div>
        </div>
    </main>


    <footer id="footer">
    <div class="row footer_nav_wrapper">
        <div class="col-xl-10 col-12">
            <div class="multi-col-list-wrapper">
                <ul class="footer-parent-list">
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6>Intelligence Center</h6>
                            </li>
                            <li><a href="https://talosintelligence.com/reputation_center">Intelligence Search</a></li>
                            <li><a href="https://talosintelligence.com/reputation_center/email_rep">Email &amp; Spam Trends</a></li>
                        </ul>
                    </li>
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6>Vulnerability Research</h6>
                            </li>
                            <li><a href="https://talosintelligence.com/vulnerability_info">Vulnerability Reports</a></li>
                            <li><a href="https://talosintelligence.com/ms_advisories">Microsoft Advisories</a></li>
                        </ul>
                    </li>
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6>Incident Response</h6>
                            </li>
                            <li>
                                <a href="https://talosintelligence.com/incident_response">Talos IR Capabilities</a></li>
                            <li>
                                <a href="https://talosintelligence.com/incident_response">Emergency Support</a>
                            </li>

                        </ul>
                    </li>
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6>Security Resources</h6>
                            </li>
                            <li><a href="https://talosintelligence.com/software">Open Source Security Tools</a></li>
                            <li><a href="https://talosintelligence.com/categories">Intelligence Categories Reference</a></li>
                            <li><a href="https://talosintelligence.com/secure-endpoint-naming">Secure Endpoint Naming Reference</a></li>
                        </ul>
                    </li>
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6>Media</h6>
                            </li>
                            <li><a href="https://blog.talosintelligence.com">Talos Intelligence Blog</a></li>
                            <li><a href="https://blog.talosintelligence.com/category/threat-source-newsletter/">Threat Source Newsletter</a></li>
                            <li><a href="https://talosintelligence.com/podcasts/shows/beers_with_talos">Beers with Talos Podcast</a></li>
                            <li><a href="https://talosintelligence.com/podcasts/shows/talos_takes">Talos Takes Podcast</a></li>
                            <li><a target="_blank" href="https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured">Talos Videos</a></li>
                        </ul>
                    </li>
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6>Support</h6>
                            </li>
                            <li><a href="https://support.talosintelligence.com">Support Documentation</a></li>
                        </ul>
                    </li>
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6>Company</h6>
                            </li>
                            <li><a href="https://talosintelligence.com/about">About Talos</a></li>
                            <li><a href="https://talosintelligence.com/careers">Careers</a></li>
                            <li><a target="_blank" href="https://www.cisco.com/c/en/us/products/security/product-listing.html">Cisco Security</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
        <div class="col-xl-2 col-12 connect_social">
            <div class="connect-footer-section-wrapper">
                <h6>Follow us</h6>
                <ul>
                    <li>
                        <a target="_blank" href="https://x.com/talossecurity"><div class="footer-media-icon" id="footer-media-icon-x"></div>
                        </a></li>
                    <li>
                        <a target="_blank" href="https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured"><div class="footer-media-icon" id="footer-media-icon-youtube"></div>
                        </a></li>
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/company/cisco-talos-intelligence-group/"><div class="footer-media-icon" id="footer-media-icon-linkedin"></div>
                        </a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-12 footer_corporate">
            <a target="_blank" href="http://tools.cisco.com/security/center/home.x"><img alt="Cisco" src="../assets/images/logo_cisco_white.svg">
            </a><p class="copyright">
            Â©
            2024
            Cisco Systems, Inc. and/or its affiliates. All rights
            reserved. View our
            <a target="_blank" class="underline" href="http://www.cisco.com/web/siteassets/legal/privacy_full.html">Privacy Policy.</a>
        </p>
        </div>
    </div>
</footer>
    


<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://blog.talosintelligence.com/assets/js/jquery-3.6.0.min.js?v=d7eb88ed59"></script>
<script src="https://blog.talosintelligence.com/assets/js/popper.min.js?v=d7eb88ed59"></script>
<script src="https://blog.talosintelligence.com/assets/js/bootstrap.bundle.min.js?v=d7eb88ed59"></script>
<script src="https://blog.talosintelligence.com/assets/js/date.js?v=d7eb88ed59"></script>
<script src="https://blog.talosintelligence.com/assets/js/prism.js?v=d7eb88ed59"></script>
<script src="https://cdn.jsdelivr.net/npm/ghost-theme-utils@latest/dist/js/ghost-theme-utils.min.js" async defer></script>


</body>

</html>