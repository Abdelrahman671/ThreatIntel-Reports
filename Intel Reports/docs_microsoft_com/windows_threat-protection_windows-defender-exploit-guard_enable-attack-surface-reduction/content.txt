<!DOCTYPE html><html
	class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus theme-light"
	lang="en-us"
	dir="ltr"
	data-authenticated="false"
	data-auth-status-determined="false"
	data-target="docs"
	x-ms-format-detection="none">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="og:title" content="Enable attack surface reduction rules - Microsoft Defender for Endpoint" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://learn.microsoft.com/en-us/defender-endpoint/enable-attack-surface-reduction" /><meta property="og:description" content="Enable attack surface reduction rules to protect your devices from attacks that use macros, scripts, and common injection techniques." /><meta property="og:image" content="https://learn.microsoft.com/en-us/media/open-graph-image.png" />

	<meta property="og:image:alt" content="Microsoft Learn" />

	<meta name="twitter:card" content="summary_large_image" />

	<meta name="twitter:site" content="@MicrosoftLearn" />

	<meta name="color-scheme" content="light dark"><meta name="audience" content="ITPro" />
<meta name="author" content="denisebmsft" />
<meta name="breadcrumb_path" content="/defender-endpoint/breadcrumb/toc.json" />
<meta name="depot_name" content="Learn.defender-endpoint" />
<meta name="description" content="Enable attack surface reduction rules to protect your devices from attacks that use macros, scripts, and common injection techniques." />
<meta name="document_id" content="11c751dd-df46-0722-8a7e-eb8fe8ce6446" />
<meta name="document_version_independent_id" content="11c751dd-df46-0722-8a7e-eb8fe8ce6446" />
<meta name="feedback_help_link_type" content="" />
<meta name="feedback_help_link_url" content="" />
<meta name="feedback_product_url" content="https://techcommunity.microsoft.com/t5/security-compliance-and-identity/ct-p/MicrosoftSecurityandCompliance" />
<meta name="feedback_system" content="Standard" />
<meta name="git_commit_id" content="2f4e8f1602b526662f6e777de057606b0d295f58" />
<meta name="gitcommit" content="https://github.com/MicrosoftDocs/defender-docs-pr/blob/2f4e8f1602b526662f6e777de057606b0d295f58/defender-endpoint/enable-attack-surface-reduction.md" />
<meta name="locale" content="en-us" />
<meta name="manager" content="deniseb" />
<meta name="ms.author" content="deniseb" />
<meta name="ms.collection" content="m365-security" />
<meta name="ms.collection" content="tier2" />
<meta name="ms.collection" content="mde-asr" />
<meta name="ms.custom" content="admindeeplinkDEFENDER" />
<meta name="ms.date" content="02/12/2024" />
<meta name="ms.localizationpriority" content="medium" />
<meta name="ms.service" content="defender-endpoint" />
<meta name="ms.subservice" content="asr" />
<meta name="ms.topic" content="how-to" />
<meta name="original_content_git_url" content="https://github.com/MicrosoftDocs/defender-docs-pr/blob/live/defender-endpoint/enable-attack-surface-reduction.md" />
<meta name="page_type" content="conceptual" />
<meta name="permissioned-type" content="public" />
<meta name="schema" content="Conceptual" />
<meta name="search.appverid" content="met150" />
<meta name="site_name" content="Docs" />
<meta name="toc_rel" content="toc.json" />
<meta name="uhfHeaderId" content="MSDocsHeader-MicrosoftDefender" />
<meta name="updated_at" content="2024-09-21 12:22 AM" />
<meta name="word_count" content="2644" />
<meta name="persistent_id" content="60acf9a5-da12-a89c-5e91-a0258fac370b" />
	
	<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/e1d61e2b-ff2d-4d2c-8dae-6cda8a241aba" data-source="generated" />
	<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/bcbcbad5-4208-4783-8035-8481272c98b8" data-source="generated" />
	
	<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/17d3b3f6-a66e-4c69-9774-14a73c38e669" data-source="generated" />
	<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/43b2e5aa-8a6d-4de2-a252-692232e5edc8" data-source="generated" />
	<meta name="scope" content="Microsoft Defender Endpoint" /><meta name="github_feedback_content_git_url" content="https://github.com/MicrosoftDocs/defender-docs/blob/public/defender-endpoint/enable-attack-surface-reduction.md" /><link href="https://learn.microsoft.com/en-us/defender-endpoint/enable-attack-surface-reduction" rel="canonical"><title>Enable attack surface reduction rules - Microsoft Defender for Endpoint | Microsoft Learn</title><link rel="stylesheet" href="/static/assets/0.4.028516059/styles/site-ltr.css">

	<script id="msdocs-script">
	var msDocs = {environment: {
			supportLevel: 'production',
			accessLevel: 'online',
			reviewFeatures: false,
			systemContent: true,
			azurePortalHostname: 'portal.azure.com',
			legacyHosting: false,
			siteName: 'learn',
		},data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {},
			hasBinaryRating: true,
			feedbackHelpLinkType:'',
			feedbackHelpLinkUrl:'',
			standardFeedback: true,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'Standard',
			feedbackGitHubRepo: '',
			feedbackProductUrl: 'https://techcommunity.microsoft.com/t5/security-compliance-and-identity/ct-p/MicrosoftSecurityandCompliance',extendBreadcrumb: false,isEditDisplayable: true,
			hideViewSource: false,
			hasPageActions: true,
			hasPrintButton: true,
			hasBookmark: true,
			hasShare: true,
			isPermissioned: false,
			isPrivateUnauthorized: false,hasRecommendations: true,contributors: [{ name: "denisebmsft", url: "https://github.com/denisebmsft" },{ name: "v-mathavale", url: "https://github.com/v-mathavale" }],},
		functions:{}
	};
	</script><script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
	<script src="https://js.monitor.azure.com/scripts/c/ms.jsll-4.min.js"></script><script src="/static/assets/0.4.028516059/global/deprecation.js"></script><script src="/static/assets/0.4.028516059/scripts/en-us/index-docs.js"></script></head>

<body lang="en-us" dir="ltr">
	<div class="header-holder has-default-focus">
		<a href="#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused position-fixed has-inner-focus focus-visible top-0 left-0 right-0 padding-xs has-text-centered has-body-background" tabindex="1">Skip to main content</a><div hidden id="cookie-consent-holder" data-test-id="cookie-consent-container"></div>

		<div id="unsupported-browser" style="
			background-color: white;
			color: black;
			padding: 16px;
			border-bottom: 1px solid grey;"
			hidden
		>
			<div style="max-width: 800px; margin: 0 auto;">
				<p style="font-size: 24px">This browser is no longer supported.</p>
				<p style="font-size: 16px; margin-top: 16px;">Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.</p>
				<div style="margin-top: 12px;">
					<a href="https://go.microsoft.com/fwlink/p/?LinkID=2092881 "
						style="
						background-color: #0078d4;
						border: 1px solid #0078d4;
						color: white;
						padding: 6px 12px;
						border-radius: 2px;
						display: inline-block;
						">Download Microsoft Edge</a>
					<a href="https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge"
						style="
							background-color: white;
							padding: 6px 12px;
							border: 1px solid #505050;
							color: #171717;
							border-radius: 2px;
							display: inline-block;
							">More info about Internet Explorer and Microsoft Edge</a>
				</div>
			</div>
		</div>
		<!-- liquid-tag banners global -->

		<!-- site header -->
		<header id="ms--site-header" data-test-id="site-header-wrapper" role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization">
			<div id="ms--mobile-nav" class="site-header display-none-tablet padding-inline-none gap-none" data-bi-name="mobile-header" data-test-id="mobile-header"></div>
			<div id="ms--primary-nav" class="site-header display-none display-flex-tablet" data-bi-name="L1-header" data-test-id="primary-header"></div>
			<div id="ms--secondary-nav" class="site-header display-none display-flex-tablet" data-bi-name="L2-header" data-test-id="secondary-header"></div>
		</header><div id="content-header" class="content-header uhf-container has-padding has-default-focus border-bottom-none" data-bi-name="content-header">
				<div class="content-header-controls margin-xxs margin-inline-sm-tablet">
					<button type="button" class="contents-button button button-sm margin-right-xxs" data-bi-name="contents-expand" aria-haspopup="true" data-contents-button>
						<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
						<span class="contents-expand-title">Table of contents</span>
					</button>
					<button type="button" class="ap-collapse-behavior ap-expanded button button-sm" data-bi-name="ap-collapse" aria-controls="action-panel">
						<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
						<span>Exit focus mode</span>
					</button>
				</div>
			</div><div id="disclaimer-holder" class="has-overflow-hidden has-default-focus">
			<!-- liquid-tag banners sectional -->
		</div>
	</div>

	<div class="mainContainer  uhf-container has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile "><div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="margin-top-sm-tablet position-sticky display-flex flex-direction-column" aria-label="Primary"></nav>
			</div><!-- .primary-holder -->
			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<!--div.columns -->
				<div class="columns is-gapless-mobile has-large-gaps "><div id="main-column" class="column  is-full is-8-desktop">

						<main id="main" class="" role="main" data-bi-name="content" lang="en-us" dir="ltr"><!-- article-header -->
							<div id="article-header" class="background-color-body margin-top-sm-tablet margin-bottom-xs display-none-print">
								<div class="display-flex align-items-center "><details id="article-header-breadcrumbs-overflow-popover" class="popover" data-for="article-header-breadcrumbs">
										<summary class="button button-clear button-primary button-sm inner-focus" aria-label="All breadcrumbs">
											<span class="icon">
												<span class="docon docon-more"></span>
											</span>
										</summary>
										<div id="article-header-breadcrumbs-overflow" class="popover-content padding-none">

										</div>
									</details>

									<bread-crumbs id="article-header-breadcrumbs" data-test-id="article-header-breadcrumbs" class="overflow-hidden flex-grow-1 margin-right-sm margin-right-md-tablet margin-right-lg-desktop margin-left-negative-xxs padding-left-xxs"></bread-crumbs><div id="article-header-page-actions"  class="opacity-none margin-left-auto display-flex flex-wrap-no-wrap align-items-stretch"><a
											id="lang-link-tablet"
											class="button button-primary button-clear button-sm display-none display-inline-flex-tablet"
											title="Read in English" data-bi-name="language-toggle"
											data-read-in-link
											hidden>
											<span class="icon margin-none" aria-hidden="true" data-read-in-link-icon>
												<span class="docon docon-locale-globe"></span>
											</span>
											<span class="is-visually-hidden" data-read-in-link-text>Read in English</span>
										</a><button
												type="button"
												class="collection button button-clear button-sm button-primary display-none display-inline-flex-tablet"
												data-list-type="collection"
												data-bi-name="collection"
												title="Add to collection">
												<span class="icon margin-none" aria-hidden="true">
													<span class="docon docon-circle-addition"></span>
												</span>
												<span class="collection-status is-visually-hidden">Save</span>
											</button><a	data-contenteditbtn
												class="button button-clear button-sm text-decoration-none button-primary display-none display-inline-flex-tablet"
												aria-label="Edit"
												title="Edit This Document"
												data-bi-name="edit"
														href="https://github.com/MicrosoftDocs/defender-docs/blob/public/defender-endpoint/enable-attack-surface-reduction.md"
														data-original_content_git_url="https://github.com/MicrosoftDocs/defender-docs-pr/blob/live/defender-endpoint/enable-attack-surface-reduction.md"
														data-original_content_git_url_template="{repo}/blob/{branch}/defender-endpoint/enable-attack-surface-reduction.md"
														data-pr_repo=""
														data-pr_branch="">
												<span class="icon margin-none" aria-hidden="true">
													<span class="docon docon-edit-outline"></span>
												</span>
											</a>
										<details class="popover popover-right" id="article-header-page-actions-overflow">
											<summary class="justify-content-flex-start button button-clear button-sm button-primary" aria-label="More actions" title="More actions">
												<span class="icon" aria-hidden="true">
													<span class="docon docon-more-vertical"></span>
												</span>
											</summary>
											<div class="popover-content padding-xs"><button
														data-page-action-item="overflow-mobile"
														type="button"
														class="justify-content-flex-start button-block button-sm has-inner-focus button button-clear display-none-tablet"
														data-bi-name="contents-expand"
														data-contents-button
														data-popover-close>
														<span class="icon">
															<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
														</span><span class="contents-expand-title">Table of contents</span></button><a
													id="lang-link-overflow"
													class="justify-content-flex-start button-sm has-inner-focus button button-clear button-block display-none-tablet"
													title="Read in English" data-bi-name="language-toggle"
													data-page-action-item="overflow-mobile"
													data-check-hidden="true"
													data-read-in-link
													hidden
													>
													<span class="icon" aria-hidden="true" data-read-in-link-icon>
														<span class="docon docon-locale-globe"></span>
													</span>
													<span data-read-in-link-text>Read in English</span>
												</a><button
														type="button"
														class="collection justify-content-flex-start button button-clear button-sm has-inner-focus button-block display-none-tablet"
														data-list-type="collection"
														data-bi-name="collection"
														title="Save"
														data-page-action-item="overflow-mobile"
														data-check-hidden="true"
														data-popover-close>
														<span class="icon" aria-hidden="true">
															<span class="docon docon-circle-addition"></span>
														</span>
														<span class="collection-status">Save</span>
													</button>

			 										
													<button
													 	type="button"
														class="collection justify-content-flex-start button button-clear button-sm has-inner-focus button-block display-none-tablet"
														data-list-type="plan"
														data-bi-name="plan"
														title="Add to Plan"
														data-page-action-item="overflow-mobile"
														data-check-hidden="true"
														data-popover-close
														hidden>
														<span class="icon" aria-hidden="true">
															<span class="docon docon-circle-addition"></span>
														</span>
														<span class="plan-status">Add to Plan</span>
													</button><a	data-contenteditbtn
														class="button button-clear button-block button-sm has-inner-focus justify-content-flex-start text-decoration-none display-none-tablet"
														aria-label="Edit"
														title="Edit This Document"
														data-bi-name="edit"
																href="https://github.com/MicrosoftDocs/defender-docs/blob/public/defender-endpoint/enable-attack-surface-reduction.md"
																data-original_content_git_url="https://github.com/MicrosoftDocs/defender-docs-pr/blob/live/defender-endpoint/enable-attack-surface-reduction.md"
																data-original_content_git_url_template="{repo}/blob/{branch}/defender-endpoint/enable-attack-surface-reduction.md"
																data-pr_repo=""
																data-pr_branch="">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-edit-outline"></span>
														</span>
														<span>Edit</span>
													</a><div aria-hidden="true" class="margin-none" data-page-action-item="overflow-all"></div>
														<hr class="display-none-tablet margin-bottom-xxs margin-top-xxs" />
														<h4 class="font-size-sm padding-left-xxs">Share via</h4>

													<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start share-facebook" data-bi-name="facebook" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-facebook-share font-size-md color-primary"></span>
															</span>
															<span class="margin-left-xxs">Facebook</span>
														</a>
														<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-twitter" data-bi-name="twitter" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-xlogo-share font-size-xxs"></span>
															</span>
															<span class="margin-left-xxs">x.com</span>
														</a>
														<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-linkedin" data-bi-name="linkedin" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-linked-in-logo font-size-sm color-primary"></span>
															</span>
															<span class="margin-left-xxs">LinkedIn</span>
														</a>
														<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start margin-bottom-xxs share-email" data-bi-name="email" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-mail-message font-size-sm color-primary"></span>
															</span>
															<span class="margin-left-xxs">Email</span>
														</a><hr />
													<button
														class="button button-block button-clear button-sm justify-content-flex-start has-inner-focus margin-top-xxs"
														title="Print"
														type="button"
														aria-label="Print"
														data-bi-name="print"
														data-page-action-item="overflow-all"
														data-popover-close
														data-print-page
														data-check-hidden="true">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-print font-size-sm color-primary"></span>
														</span>
														<span class="margin-left-xxs">Print</span>
													</button>
											</div>
										</details>
										
									</div></div>
							</div>
							<!-- end article-header --><div>
								<button type="button" class="border contents-button button button-clear button-sm is-hidden-tablet has-inner-focus" data-bi-name="contents-expand" data-contents-button hidden>
									<span class="icon">
										<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
									</span><span class="contents-expand-title">Table of contents</span></button>
							</div><!-- end mobile-contents button  -->

							<div class="content "><h1 id="enable-attack-surface-reduction-rules">Enable attack surface reduction rules</h1><div class="display-flex justify-content-space-between align-items-center flex-wrap-wrap page-metadata-container">
										<div class="margin-right-xxs">
											<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr"><li>Article</li><li class="visibility-hidden-visual-diff"><time class="is-invisible" data-article-date aria-label="Article review date" datetime="2024-04-24T19:20:00Z" data-article-date-source="calculated">04/24/2024</time>
															</li><li class="contributors-holder display-none-print">
															<button aria-label="View all contributors" class="contributors-button link-button" data-bi-name="contributors" title="View all contributors">2 contributors</button>
														</li></ul>
										</div>
<div id="user-feedback" class="margin-block-xxs display-none-print" data-hide-on-archived>
	<button
		id="user-feedback-button"
		data-test-id="conceptual-feedback-button"
		class="button button-sm button-clear button-primary"
		type="button"
		data-bi-name="user-feedback-button"
		data-user-feedback-button
	>
		<span class="icon" aria-hidden="true">
			<span class="docon docon-like"></span>
		</span>
		<span>Feedback</span>
	</button>
</div></div><nav id="center-doc-outline" class="doc-outline is-hidden-desktop display-none-print margin-bottom-sm" data-bi-name="intopic toc" aria-label="In this article">
											<h2 id="ms--in-this-article" class="title is-6 margin-block-xs">In this article</h2>
										</nav><!-- <content> --><p><strong>Applies to:</strong></p>
<ul>
<li><a href="microsoft-defender-endpoint" data-linktype="relative-path">Microsoft Defender for Endpoint Plan 1</a></li>
<li><a href="microsoft-defender-endpoint" data-linktype="relative-path">Microsoft Defender for Endpoint Plan 2</a></li>
<li><a href="/en-us/defender-xdr" data-linktype="absolute-path">Microsoft Defender XDR</a></li>
<li>Microsoft Defender Antivirus</li>
</ul>
<p><strong>Platforms</strong></p>
<ul>
<li>Windows</li>
</ul>
<div class="TIP">
<p>Tip</p>
<p>Want to experience Defender for Endpoint? <a href="https://signup.microsoft.com/create-account/signup?products=7f379fee-c4f9-4278-b0a1-e4c8c2fcdf7e&amp;ru=https://aka.ms/MDEp2OpenTrial?ocid=docs-wdatp-assignaccess-abovefoldlink" data-linktype="external">Sign up for a free trial.</a></p>
</div>
<p><a href="attack-surface-reduction" data-linktype="relative-path">Attack surface reduction rules</a> help prevent actions that malware often abuses to compromise devices and networks.</p>
<h2 id="requirements">Requirements</h2>
<p>Attack surface reduction features across Windows versions</p>
<p>You can set attack surface reduction rules for devices that are running any of the following editions and versions of Windows:</p>
<ul>
<li><a href="/en-us/windows/whats-new/windows-11-overview" data-linktype="absolute-path">Windows 11 Pro</a></li>
<li><a href="https://www.microsoft.com/microsoft-365/windows/windows-11-enterprise" data-linktype="external">Windows 11 Enterprise</a></li>
<li>Windows 10 Pro, <a href="/en-us/windows/whats-new/whats-new-windows-10-version-1709" data-linktype="absolute-path">version 1709</a> or later</li>
<li>Windows 10 Enterprise, <a href="/en-us/windows/whats-new/whats-new-windows-10-version-1709" data-linktype="absolute-path">version 1709</a> or later</li>
<li>Windows Server, <a href="/en-us/windows-server/get-started/whats-new-in-windows-server-1803" data-linktype="absolute-path">version 1803 (Semi-Annual Channel)</a> or later</li>
<li><a href="/en-us/windows/win32/srvnodes/what-s-new-for-windows-server-2012-r2" data-linktype="absolute-path">Windows Server 2012 R2</a></li>
<li><a href="/en-us/windows-server/get-started/whats-new-in-windows-server-2016" data-linktype="absolute-path">Windows Server 2016</a></li>
<li><a href="/en-us/windows-server/get-started-19/whats-new-19" data-linktype="absolute-path">Windows Server 2019</a></li>
<li><a href="/en-us/windows-server/get-started/whats-new-in-windows-server-2022" data-linktype="absolute-path">Windows Server 2022</a></li>
</ul>
<p>To use the entire feature-set of attack surface reduction rules, you need:</p>
<ul>
<li>Microsoft Defender Antivirus as primary AV (real-time protection on)</li>
<li><a href="/en-us/windows/security/threat-protection/microsoft-defender-antivirus/enable-cloud-protection-microsoft-defender-antivirus" data-linktype="absolute-path">Cloud-Delivery Protection</a> on (some rules require that)</li>
<li>Windows 10 Enterprise E5 or E3 License</li>
</ul>
<p>Although attack surface reduction rules don't require a <a href="/en-us/windows/deployment/deploy-enterprise-licenses" data-linktype="absolute-path">Windows E5 license</a>, with a Windows E5 license, you get advanced management capabilities including monitoring, analytics, and workflows available in Defender for Endpoint, as well as reporting and configuration capabilities in the <a href="https://go.microsoft.com/fwlink/p/?linkid=2077139" data-linktype="external">Microsoft Defender XDR</a> portal. These advanced capabilities aren't available with an E3 license, but you can still use Event Viewer to review attack surface reduction rule events.</p>
<p>Each attack surface reduction rule contains one of four settings:</p>
<ul>
<li><strong>Not configured</strong> | <strong>Disabled</strong>: Disable the attack surface reduction rule</li>
<li><strong>Block</strong>: Enable the attack surface reduction rule</li>
<li><strong>Audit</strong>: Evaluate how the attack surface reduction rule would impact your organization if enabled</li>
<li><strong>Warn</strong>: Enable the attack surface reduction rule but allow the end user to bypass the block</li>
</ul>
<p>We recommend using attack surface reduction rules with a Windows E5 license (or similar licensing SKU) to take advantage of the advanced monitoring and reporting capabilities available in <a href="microsoft-defender-endpoint" data-linktype="relative-path">Microsoft Defender for Endpoint</a> (Defender for Endpoint). However, if you have another license, such as Windows Professional or Windows E3 that doesn't include advanced monitoring and reporting capabilities, you can develop your own monitoring and reporting tools on top of the events that are generated at each endpoint when attack surface reduction rules are triggered (for example, Event Forwarding).</p>
<div class="TIP">
<p>Tip</p>
<p>To learn more about Windows licensing, see <a href="https://www.microsoft.com/licensing/product-licensing/windows10?activetab=windows10-pivot:primaryr5" data-linktype="external">Windows 10 Licensing</a> and get the <a href="https://www.microsoft.com/en-us/download/details.aspx?id=11091" data-linktype="external">Volume Licensing guide for Windows 10</a>.</p>
</div>
<p>You can enable attack surface reduction rules by using any of these methods:</p>
<ul>
<li><a href="#intune" data-linktype="self-bookmark">Microsoft Intune</a></li>
<li><a href="#mdm" data-linktype="self-bookmark">Mobile Device Management (MDM)</a></li>
<li><a href="#microsoft-configuration-manager" data-linktype="self-bookmark">Microsoft Configuration Manager</a></li>
<li><a href="#group-policy" data-linktype="self-bookmark">Group Policy</a></li>
<li><a href="#powershell" data-linktype="self-bookmark">PowerShell</a></li>
</ul>
<p>Enterprise-level management such as Intune or Microsoft Configuration Manager is recommended. Enterprise-level management overwrites any conflicting Group Policy or PowerShell settings on startup.</p>
<h2 id="exclude-files-and-folders-from-attack-surface-reduction-rules">Exclude files and folders from attack surface reduction rules</h2>
<p>You can exclude files and folders from being evaluated by most attack surface reduction rules. This means that even if an attack surface reduction rule determines the file or folder contains malicious behavior, it doesn't block the file from running.</p>
<div class="IMPORTANT">
<p>Important</p>
<p>Excluding files or folders can severely reduce the protection provided by attack surface reduction rules. Excluded files will be allowed to run, and no report or event will be recorded. If attack surface reduction rules are detecting files that you believe shouldn't be detected, you should <a href="attack-surface-reduction-rules-deployment-test#step-1-test-attack-surface-reduction-rules-using-audit" data-linktype="relative-path">use audit mode first to test the rule</a>.
An exclusion is applied only when the excluded application or service starts. For example, if you add an exclusion for an update service that is already running, the update service continues to trigger events until the service is stopped and restarted.</p>
</div>
<p>When adding exclusions, keep these points in mind:</p>
<ul>
<li>Exclusions are typically based on individual files or folders (using folder paths or the full path of the file to be excluded).</li>
<li>Exclusion paths can use environment variables and wildcards. See <a href="configure-extension-file-exclusions-microsoft-defender-antivirus#use-wildcards-in-the-file-name-and-folder-path-or-extension-exclusion-lists" data-linktype="relative-path">Use wildcards in the file name and folder path or extension exclusion lists</a></li>
<li>When deployed through Group Policy or PowerShell, exclusions apply to all attack surface reduction rules. Using Intune, it is possible to configure an exclusion for a specific attack surface reduction rule. See <a href="attack-surface-reduction-rules-deployment-test#configure-attack-surface-reduction-per-rule-exclusions" data-linktype="relative-path">Configure attack surface reduction rules per-rule exclusions</a></li>
<li>Exclusions can be added based on certificate and file hashes, by allowing specified Defender for Endpoint file and certificate indicators. See <a href="manage-indicators" data-linktype="relative-path">Manage indicators</a>.</li>
</ul>
<h2 id="policy-conflict">Policy Conflict</h2>
<ol>
<li><p>If a conflicting policy is applied via MDM and GP, the setting applied from GP takes precedence.</p>
</li>
<li><p>Attack surface reduction rules for managed devices now support behavior for merger of settings from different policies, to create a superset of policy for each device. Only the settings that aren't in conflict are merged, while those that are in conflict aren't added to the superset of rules. Previously, if two policies included conflicts for a single setting, both policies were flagged as being in conflict, and no settings from either profile would be deployed. Attack surface reduction rule merge behavior is as follows:</p>
<ul>
<li>Attack surface reduction rules from the following profiles are evaluated for each device to which the rules apply:
<ul>
<li>Devices &gt; Configuration profiles &gt; Endpoint protection profile &gt; <strong>Microsoft Defender Exploit Guard</strong> &gt; <a href="/en-us/mem/intune/protect/endpoint-protection-windows-10#attack-surface-reduction-rules" data-linktype="absolute-path">Attack Surface Reduction</a>.</li>
<li>Endpoint security &gt; <strong>Attack surface reduction policy</strong> &gt; <a href="/en-us/mem/intune/protect/endpoint-security-asr-policy#devices-managed-by-intune" data-linktype="absolute-path">Attack surface reduction rules</a>.</li>
<li>Endpoint security &gt; Security baselines &gt; <strong>Microsoft Defender ATP Baseline</strong> &gt; <a href="/en-us/mem/intune/protect/security-baseline-settings-defender-atp#attack-surface-reduction-rules" data-linktype="absolute-path">Attack Surface Reduction Rules</a>.</li>
</ul>
</li>
<li>Settings that don't have conflicts are added to a superset of policy for the device.</li>
<li>When two or more policies have conflicting settings, the conflicting settings aren't added to the combined policy, while settings that don't conflict are added to the superset policy that applies to a device.</li>
<li>Only the configurations for conflicting settings are held back.</li>
</ul>
</li>
</ol>
<h2 id="configuration-methods">Configuration methods</h2>
<p>This section provides configuration details for the following configuration methods:</p>
<ul>
<li><a href="#intune" data-linktype="self-bookmark">Intune</a></li>
<li><a href="#custom-profile-in-intune" data-linktype="self-bookmark">Custom profile in Intune</a></li>
<li><a href="#mdm" data-linktype="self-bookmark">MDM</a></li>
<li><a href="#microsoft-configuration-manager" data-linktype="self-bookmark">Microsoft Configuration Manager</a></li>
<li><a href="#group-policy" data-linktype="self-bookmark">Group Policy</a></li>
<li><a href="#powershell" data-linktype="self-bookmark">PowerShell</a></li>
</ul>
<p>The following procedures for enabling attack surface reduction rules include instructions for how to exclude files and folders.</p>
<h3 id="intune">Intune</h3>
<h4 id="device-configuration-profiles">Device Configuration Profiles</h4>
<ol>
<li><p>Select <strong>Device configuration</strong> &gt; <strong>Profiles</strong>. Choose an existing endpoint protection profile or create a new one. To create a new one, select <strong>Create profile</strong> and enter information for this profile. For <strong>Profile type</strong>, select <strong>Endpoint protection</strong>. If you've chosen an existing profile, select <strong>Properties</strong> and then select <strong>Settings</strong>.</p>
</li>
<li><p>In the <strong>Endpoint protection</strong> pane, select <strong>Windows Defender Exploit Guard</strong>, then select <strong>Attack Surface Reduction</strong>. Select the desired setting for each attack surface reduction rule.</p>
</li>
<li><p>Under <strong>Attack Surface Reduction exceptions</strong>, enter individual files and folders. You can also select <strong>Import</strong> to import a CSV file that contains files and folders to exclude from attack surface reduction rules. Each line in the CSV file should be formatted as follows:</p>
<p><code>C:\folder</code>, <code>%ProgramFiles%\folder\file</code>, <code>C:\path</code></p>
</li>
<li><p>Select <strong>OK</strong> on the three configuration panes. Then select <strong>Create</strong> if you're creating a new endpoint protection file or <strong>Save</strong> if you're editing an existing one.</p>
</li>
</ol>
<h4 id="endpoint-security-policy">Endpoint security policy</h4>
<ol>
<li><p>Select <strong>Endpoint Security</strong> &gt; <strong>Attack surface reduction</strong>. Choose an existing attack surface reduction rule or create a new one. To create a new one, select <strong>Create Policy</strong> and enter information for this profile. For <strong>Profile type</strong>, select <strong>Attack surface reduction rules</strong>. If you've chosen an existing profile, select <strong>Properties</strong> and then select <strong>Settings</strong>.</p>
</li>
<li><p>In the <strong>Configuration settings</strong> pane, select <strong>Attack Surface Reduction</strong> and then select the desired setting for each attack surface reduction rule.</p>
</li>
<li><p>Under <strong>List of additional folders that need to be protected</strong>, <strong>List of apps that have access to protected folders</strong>, and <strong>Exclude files and paths from attack surface reduction rules</strong>, enter individual files and folders. You can also select <strong>Import</strong> to import a CSV file that contains files and folders to exclude from attack surface reduction rules. Each line in the CSV file should be formatted as follows:</p>
<p><code>C:\folder</code>, <code>%ProgramFiles%\folder\file</code>, <code>C:\path</code></p>
</li>
<li><p>Select <strong>Next</strong> on the three configuration panes, then select <strong>Create</strong> if you're creating a new policy or <strong>Save</strong> if you're editing an existing policy.</p>
</li>
</ol>
<h3 id="custom-profile-in-intune">Custom profile in Intune</h3>
<p>You can use Microsoft Intune OMA-URI to configure custom attack surface reduction rules. The following procedure uses the rule <a href="attack-surface-reduction-rules-reference#block-abuse-of-exploited-vulnerable-signed-drivers" data-linktype="relative-path">Block abuse of exploited vulnerable signed drivers</a> for the example.</p>
<ol>
<li><p>Open the Microsoft Intune admin center. In the <strong>Home</strong> menu, click  <strong>Devices</strong>, select <strong>Configuration profiles</strong>, and then click <strong>Create profile</strong>.</p>
<p><span class="mx-imgBorder">
<a href="media/mem01-create-profile.png#lightbox" data-linktype="relative-path">
<img src="media/mem01-create-profile.png" alt="The Create profile page in the Microsoft Intune admin center portal." data-linktype="relative-path">
</a>
</span>
</p>
</li>
<li><p>In <strong>Create a profile</strong>, in the following two drop-down lists, select the following:</p>
<ul>
<li>In <strong>Platform</strong>, select <strong>Windows 10 and later</strong></li>
<li>In <strong>Profile type</strong>, select <strong>Templates</strong></li>
<li>If attack surface reduction rules are already set through Endpoint security, in <strong>Profile type</strong>, select <strong>Settings Catalog</strong>.</li>
</ul>
<p>Select <strong>Custom</strong>, and then select <strong>Create</strong>.</p>
<p><span class="mx-imgBorder">
<a href="media/mem02-profile-attributes.png#lightbox" data-linktype="relative-path">
<img src="media/mem02-profile-attributes.png" alt="The rule profile attributes in the Microsoft Intune admin center portal." data-linktype="relative-path">
</a>
</span>
</p>
</li>
<li><p>The Custom template tool opens to step <strong>1 Basics</strong>. In <strong>1 Basics</strong>, in <strong>Name</strong>, type a name for your template, and in <strong>Description</strong> you can type a description (optional).</p>
<p><span class="mx-imgBorder">
<a href="media/mem03-1-basics.png#lightbox" data-linktype="relative-path">
<img src="media/mem03-1-basics.png" alt="The basic attributes in the Microsoft Intune admin center portal" data-linktype="relative-path">
</a>
</span>
</p>
</li>
<li><p>Click <strong>Next</strong>. Step <strong>2 Configuration settings</strong> opens. For OMA-URI Settings, click <strong>Add</strong>. Two options now appear: <strong>Add</strong> and <strong>Export</strong>.</p>
<p><span class="mx-imgBorder">
<a href="media/mem04-2-configuration-settings.png#lightbox" data-linktype="relative-path">
<img src="media/mem04-2-configuration-settings.png" alt="The configuration settings in the Microsoft Intune admin center portal." data-linktype="relative-path">
</a>
</span>
</p>
</li>
<li><p>Click <strong>Add</strong> again. The <strong>Add Row OMA-URI Settings</strong> opens. In <strong>Add Row</strong>, do the following:</p>
<ul>
<li><p>In <strong>Name</strong>, type a name for the rule.</p>
</li>
<li><p>In <strong>Description</strong>, type a brief description.</p>
</li>
<li><p>In <strong>OMA-URI</strong>, type or paste the specific OMA-URI link for the rule that you're adding. Refer to the MDM section in this article for the OMA-URI to use for this example rule. For attack surface reduction rule GUIDS, see <a href="attack-surface-reduction-rules-reference#per-rule-descriptions" data-linktype="relative-path">Per rule descriptions</a> in the article: Attack surface reduction rules.</p>
</li>
<li><p>In <strong>Data type</strong>, select <strong>String</strong>.</p>
</li>
<li><p>In <strong>Value</strong>, type or paste the GUID value, the = sign and the State value with no spaces (<em>GUID=StateValue</em>). Where:</p>
<ul>
<li>0: Disable (Disable the attack surface reduction rule)</li>
<li>1: Block (Enable the attack surface reduction rule)</li>
<li>2: Audit (Evaluate how the attack surface reduction rule would impact your organization if enabled)</li>
<li>6: Warn (Enable the attack surface reduction rule but allow the end-user to bypass the block)</li>
</ul>
</li>
</ul>
<p><span class="mx-imgBorder">
<a href="media/mem05-add-row-oma-uri.png#lightbox" data-linktype="relative-path">
<img src="media/mem05-add-row-oma-uri.png" alt="The OMA URI configuration in the Microsoft Intune admin center portal" data-linktype="relative-path">
</a>
</span>
</p>
</li>
<li><p>Select <strong>Save</strong>. <strong>Add Row</strong> closes. In <strong>Custom</strong>, select <strong>Next</strong>. In step <strong>3 Scope tags</strong>, scope tags are optional. Do one of the following:</p>
<ul>
<li>Select <strong>Select Scope tags</strong>, select the scope tag (optional) and then select <strong>Next</strong>.</li>
<li>Or select <strong>Next</strong></li>
</ul>
</li>
<li><p>In step <strong>4 Assignments</strong>, in <strong>Included Groups</strong>, for the groups that you want this rule to apply, select from the following options:</p>
<ul>
<li><strong>Add groups</strong></li>
<li><strong>Add all users</strong></li>
<li><strong>Add all devices</strong></li>
</ul>
<p><span class="mx-imgBorder">
<a href="media/mem06-4-assignments.png#lightbox" data-linktype="relative-path">
<img src="media/mem06-4-assignments.png" alt="The assignments in the Microsoft Intune admin center portal" data-linktype="relative-path">
</a>
</span>
</p>
</li>
<li><p>In <strong>Excluded groups</strong>, select any groups that you want to exclude from this rule, and then select <strong>Next</strong>.</p>
</li>
<li><p>In step <strong>5 Applicability Rules</strong> for the following settings, do the following:</p>
<ul>
<li><p>In <strong>Rule</strong>, select either <strong>Assign profile if</strong>, or <strong>Don't assign profile if</strong></p>
</li>
<li><p>In <strong>Property</strong>, select the property to which you want this rule to apply</p>
</li>
<li><p>In <strong>Value</strong>, enter the applicable value or value range</p>
</li>
</ul>
<p><span class="mx-imgBorder">
<a href="media/mem07-5-applicability-rules.png#lightbox" data-linktype="relative-path">
<img src="media/mem07-5-applicability-rules.png" alt="The applicability rules in the Microsoft Intune admin center portal" data-linktype="relative-path">
</a>
</span>
</p>
</li>
<li><p>Select <strong>Next</strong>. In step <strong>6 Review + create</strong>, review the settings and information you've selected and entered, and then select <strong>Create</strong>.</p>
<p><span class="mx-imgBorder">
<a href="media/mem08-6-review-create.png#lightbox" data-linktype="relative-path">
<img src="media/mem08-6-review-create.png" alt="The Review and create option in the Microsoft Intune admin center portal" data-linktype="relative-path">
</a>
</span>
</p>
<p>Rules are active and live within minutes.</p>
</li>
</ol>
<div class="NOTE">
<p>Note</p>
<p>Conflict handling:</p>
<p>If you assign a device two different attack surface reduction policies, potential policy conflicts can occur, depending on whether rules are assigned different states, whether conflict management is in place, and whether the result is an error. Nonconflicting rules do not result in an error, and such rules are applied correctly. The first rule is applied, and subsequent nonconflicting rules are merged into the policy.</p>
</div>
<h3 id="mdm">MDM</h3>
<p>Use the <a href="/en-us/windows/client-management/mdm/policy-csp-defender#defender-attacksurfacereductionrules" data-linktype="absolute-path">./Vendor/MSFT/Policy/Config/Defender/AttackSurfaceReductionRules</a> configuration service provider (CSP) to individually enable and set the mode for each rule.</p>
<p>The following is a sample for reference, using GUID values for <a href="attack-surface-reduction-rules-reference" data-linktype="relative-path">Attack surface reduction rules reference</a>.</p>
<p><code>OMA-URI path: ./Vendor/MSFT/Policy/Config/Defender/AttackSurfaceReductionRules</code></p>
<p><code>Value: 75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84=2|3b576869-a4ec-4529-8536-b80a7769e899=1|d4f940ab-401b-4efc-aadc-ad5f3c50688a=2|d3e037e1-3eb8-44c8-a917-57927947596d=1|5beb7efe-fd9a-4556-801d-275e5ffc04cc=0|be9ba2d9-53ea-4cdc-84e5-9b1eeee46550=1</code></p>
<p>The values to enable (Block), disable, warn, or enable in audit mode are:</p>
<ul>
<li>0: Disable (Disable the attack surface reduction rule)</li>
<li>1: Block (Enable the attack surface reduction rule)</li>
<li>2: Audit (Evaluate how the attack surface reduction rule would impact your organization if enabled)</li>
<li>6: Warn  (Enable the attack surface reduction rule but allow the end-user to bypass the block). Warn mode is available for most of the attack surface reduction rules.</li>
</ul>
<p>Use the <a href="/en-us/windows/client-management/mdm/policy-csp-defender#defender-attacksurfacereductiononlyexclusions" data-linktype="absolute-path">./Vendor/MSFT/Policy/Config/Defender/AttackSurfaceReductionOnlyExclusions</a> configuration service provider (CSP) to add exclusions.</p>
<p>Example:</p>
<p><code>OMA-URI path: ./Vendor/MSFT/Policy/Config/Defender/AttackSurfaceReductionOnlyExclusions</code></p>
<p><code>Value: c:\path|e:\path|c:\Exclusions.exe</code></p>
<div class="NOTE">
<p>Note</p>
<p>Be sure to enter OMA-URI values without spaces.</p>
</div>
<h3 id="microsoft-configuration-manager">Microsoft Configuration Manager</h3>
<ol>
<li><p>In Microsoft Configuration Manager, go to <strong>Assets and Compliance</strong> &gt; <strong>Endpoint Protection</strong> &gt; <strong>Windows Defender Exploit Guard</strong>.</p>
</li>
<li><p>Select <strong>Home</strong> &gt; <strong>Create Exploit Guard Policy</strong>.</p>
</li>
<li><p>Enter a name and a description, select <strong>Attack Surface Reduction</strong>, and select <strong>Next</strong>.</p>
</li>
<li><p>Choose which rules will block or audit actions and select <strong>Next</strong>.</p>
</li>
<li><p>Review the settings and select <strong>Next</strong> to create the policy.</p>
</li>
<li><p>After the policy is created, select <strong>Close</strong>.</p>
</li>
</ol>
<div class="WARNING">
<p>Warning</p>
<p>There is a known issue with the applicability of Attack Surface Reduction on Server OS versions which is marked as compliant without any actual enforcement. Currently, there is no ETA for when this will be fixed.</p>
</div>
<h3 id="group-policy">Group Policy</h3>
<div class="WARNING">
<p>Warning</p>
<p>If you manage your computers and devices with Intune, Configuration Manager, or other enterprise-level management platform, the management software will overwrite any conflicting Group Policy settings on startup.</p>
</div>
<ol>
<li><p>On your Group Policy management computer, open the <a href="https://technet.microsoft.com/library/cc731212.aspx" data-linktype="external">Group Policy Management Console</a>, right-click the Group Policy Object you want to configure and select <strong>Edit</strong>.</p>
</li>
<li><p>In the <strong>Group Policy Management Editor</strong>, go to <strong>Computer configuration</strong> and select <strong>Administrative templates</strong>.</p>
</li>
<li><p>Expand the tree to <strong>Windows components</strong> &gt; <strong>Microsoft Defender Antivirus</strong> &gt; <strong>Microsoft Defender Exploit Guard</strong> &gt; <strong>Attack surface reduction</strong>.</p>
</li>
<li><p>Select <strong>Configure Attack surface reduction rules</strong> and select <strong>Enabled</strong>. You can then set the individual state for each rule in the options section. Select <strong>Show...</strong> and enter the rule ID in the <strong>Value name</strong> column and your chosen state in the <strong>Value</strong> column as follows:</p>
<ul>
<li><p>0: Disable (Disable the attack surface reduction rule)</p>
</li>
<li><p>1: Block (Enable the attack surface reduction rule)</p>
</li>
<li><p>2: Audit (Evaluate how the attack surface reduction rule would impact your organization if enabled)</p>
</li>
<li><p>6: Warn  (Enable the attack surface reduction rule but allow the end-user to bypass the block)</p>
<p><span class="mx-imgBorder">
<a href="media/asr-rules-gp.png#lightbox" data-linktype="relative-path">
<img src="media/asr-rules-gp.png" alt="attack surface reduction rules in Group Policy" data-linktype="relative-path">
</a>
</span>
</p>
</li>
</ul>
</li>
<li><p>To exclude files and folders from attack surface reduction rules, select the <strong>Exclude files and paths from Attack surface reduction rules</strong> setting and set the option to <strong>Enabled</strong>. Select <strong>Show</strong> and enter each file or folder in the <strong>Value name</strong> column. Enter <strong>0</strong> in the <strong>Value</strong> column for each item.</p>
<div class="WARNING">
<p>Warning</p>
<p>Do not use quotes as they are not supported for either the <strong>Value name</strong> column or the <strong>Value</strong> column.
The rule ID should not have any leading or trailing spaces.</p>
</div>
</li>
</ol>
<h3 id="powershell">PowerShell</h3>
<div class="WARNING">
<p>Warning</p>
<p>If you manage your computers and devices with Intune, Configuration Manager, or another enterprise-level management platform, the management software overwrites any conflicting PowerShell settings on startup.</p>
</div>
<ol>
<li><p>Type <strong>powershell</strong> in the Start menu, right-click <strong>Windows PowerShell</strong> and select <strong>Run as administrator</strong>.</p>
</li>
<li><p>Type one of the following cmdlets. (For more information, such as rule ID, refer to <a href="attack-surface-reduction-rules-reference" data-linktype="relative-path">Attack surface reduction rules reference</a>.)</p>
<table>
<thead>
<tr>
<th>Task</th>
<th>PowerShell cmdlet</th>
</tr>
</thead>
<tbody>
<tr>
<td>Enable attack surface reduction rules</td>
<td><code>Set-MpPreference -AttackSurfaceReductionRules_Ids &lt;rule ID&gt; -AttackSurfaceReductionRules_Actions Enabled</code></td>
</tr>
<tr>
<td>Enable attack surface reduction rules in audit mode</td>
<td><code>Add-MpPreference -AttackSurfaceReductionRules_Ids &lt;rule ID&gt; -AttackSurfaceReductionRules_Actions AuditMode</code></td>
</tr>
<tr>
<td>Enable attack surface reduction rules in warn mode</td>
<td><code>Add-MpPreference -AttackSurfaceReductionRules_Ids &lt;rule ID&gt; -AttackSurfaceReductionRules_Actions Warn</code></td>
</tr>
<tr>
<td>Enable attack surface reduction Block abuse of exploited vulnerable signed drivers</td>
<td><code>Add-MpPreference -AttackSurfaceReductionRules_Ids 56a863a9-875e-4185-98a7-b882c64b5ce5 -AttackSurfaceReductionRules_Actions Enabled</code></td>
</tr>
<tr>
<td>Turn off attack surface reduction rules</td>
<td><code>Add-MpPreference -AttackSurfaceReductionRules_Ids &lt;rule ID&gt; -AttackSurfaceReductionRules_Actions Disabled</code></td>
</tr>
</tbody>
</table>
<div class="IMPORTANT">
<p>Important</p>
<p>You must specify the state individually for each rule, but you can combine rules and states in a comma-separated list.</p>
<p>In the following example, the first two rules are enabled, the third rule is disabled, and the fourth rule is enabled in audit mode: <code>Set-MpPreference -AttackSurfaceReductionRules_Ids &lt;rule ID 1&gt;,&lt;rule ID 2&gt;,&lt;rule ID 3&gt;,&lt;rule ID 4&gt; -AttackSurfaceReductionRules_Actions Enabled, Enabled, Disabled, AuditMode</code></p>
</div>
<p>You can also use the <code>Add-MpPreference</code> PowerShell verb to add new rules to the existing list.</p>
<div class="WARNING">
<p>Warning</p>
<p><code>Set-MpPreference</code> overwrites the existing set of rules. If you want to add to the existing set, use <code>Add-MpPreference</code> instead. You can obtain a list of rules and their current state by using <code>Get-MpPreference</code>.</p>
</div>
</li>
<li><p>To exclude files and folders from attack surface reduction rules, use the following cmdlet:</p>
<p><code>Add-MpPreference -AttackSurfaceReductionOnlyExclusions "&lt;fully qualified path or resource&gt;"</code></p>
<p>Continue to use <code>Add-MpPreference -AttackSurfaceReductionOnlyExclusions</code> to add more files and folders to the list.</p>
<div class="IMPORTANT">
<p>Important</p>
<p>Use <code>Add-MpPreference</code> to append or add apps to the list. Using the <code>Set-MpPreference</code> cmdlet will overwrite the existing list.</p>
</div>
</li>
</ol>
<h2 id="related-articles">Related articles</h2>
<ul>
<li><a href="attack-surface-reduction-rules-reference" data-linktype="relative-path">Attack surface reduction rules reference</a></li>
<li><a href="attack-surface-reduction-rules-deployment-test" data-linktype="relative-path">Evaluate attack surface reduction</a></li>
<li><a href="attack-surface-reduction" data-linktype="relative-path">Attack surface reduction FAQ</a></li>
</ul>
<div class="TIP">
<p>Tip</p>
<p>Do you want to learn more? Engage with the Microsoft Security community in our Tech Community:  <a href="https://techcommunity.microsoft.com/t5/microsoft-defender-for-endpoint/bd-p/MicrosoftDefenderATP" data-linktype="external">Microsoft Defender for Endpoint Tech Community</a>.</p>
</div>
</div><div id="ms--inline-notifications" class="margin-block-xs" data-bi-name="inline-notification"></div><div id="assertive-live-region" role="alert" aria-live="assertive" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
							<div id="polite-live-region" role="status" aria-live="polite" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
							<!-- </content> -->

						</main><!-- recommendations section --><!-- end recommendations section -->

						<!-- feedback section --><section id="site-user-feedback-footer" class="font-size-sm margin-top-md" data-test-id="site-user-feedback-footer" data-bi-name="site-feedback-section">
	<hr class="hr" />
	<h2 id="feedback" class="title is-3">Feedback</h2>
	<div class="display-flex flex-wrap-wrap align-items-center">
		<p class="font-weight-semibold margin-xxs margin-left-none">Was this page helpful?</p>
		<div class="buttons">
			<button
				class="thumb-rating-button like button button-primary button-sm"
				data-test-id="footer-rating-yes"
				data-binary-rating-response="rating-yes"
				type="button"
				title="This article is helpful"
				data-bi-name="button-rating-yes"
				aria-pressed="false"
			>
				<span class="icon" aria-hidden="true">
					<span class="docon docon-like"></span>
				</span>
				<span>Yes</span>
			</button>
			<button
				class="thumb-rating-button dislike button button-primary button-sm"
				data-test-id="footer-rating-no"
				data-binary-rating-response="rating-no"
				type="button"
				title="This article is not helpful"
				data-bi-name="button-rating-no"
				aria-pressed="false"
			>
				<span class="icon" aria-hidden="true">
					<span class="docon docon-dislike"></span>
				</span>
				<span>No</span>
			</button>
		</div>
	</div><div class="display-flex flex-wrap-wrap margin-top-xxs"><div>
			<a
				data-bi-name="provide-feedback-cta"
				class="has-external-link-indicator"
				href="https://techcommunity.microsoft.com/t5/security-compliance-and-identity/ct-p/MicrosoftSecurityandCompliance"
				data-bi-name="product-feedback"
			>
				<span>Provide product feedback</span>
			</a></div></div>

</section><!-- end feedback section -->

						<!-- feedback report section --><!-- end feedback report section --><aside
								id="ms--additional-resources-mobile"
								aria-label="Additional resources"
								class="display-none-desktop display-none-print"
							>
								<hr class="hr" hidden />
								<h2 id="ms--additional-resources-mobile-heading" class="title is-3" hidden>Additional resources</h2>
								<section id="right-rail-recommendations-mobile" data-bi-name="recommendations" hidden></section>
								<section id="right-rail-training-mobile" data-bi-name="learning-resources-card" hidden></section>
								<section id="right-rail-events-mobile" data-bi-name="events-card" hidden></section>
								<section id="right-rail-qna-mobile" data-bi-name="qna-link-card" hidden></section>
							</aside><div class="border-top is-visible-interactive has-default-focus margin-top-sm "><footer id="footer-interactive" data-bi-name="footer" class="footer-layout"><div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop"><a
				data-mscc-ic="false"
				class="locale-selector-link button button-sm button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a><div class="ccpa-privacy-link" data-ccpa-privacy-link hidden>
<a
	href="https://aka.ms/yourcaliforniaprivacychoices"
	class="button button-sm button-clear flex-shrink-0"
	data-mscc-ic="false"
	data-bi-name="your-privacy-choices"
>
	<svg
		role="img"
		aria-label="California Consumer Privacy Act (CCPA) Opt-Out Icon"
		xmlns="http://www.w3.org/2000/svg"
		viewBox="0 0 30 14"
		xml:space="preserve"
		height="16"
		width="43"
		focusable="false"
	>
		<title>California Consumer Privacy Act (CCPA) Opt-Out Icon</title>
		<path d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"></path>
		<path d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"></path>
		<path d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z" style="fill:#fff"></path>
		<path d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z" style="fill:#06f"></path>
	</svg>
	<span>Your Privacy Choices</span>
</a>

		</div>
		<div class="flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu-interactive" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
		<span class="icon expanded-indicator" aria-hidden="true">
			<span class="docon docon-chevron-down-light"></span>
		</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector padding-xxs" role="none">
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light margin-right-xxs">
						<span
							class="theme-selector-icon border display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Light</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Dark</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>High contrast</span>
				</button>
			</li>
		</ul>
	</div>
</div>

		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/previous-versions/" data-bi-name="archivelink">Previous Versions</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog" data-bi-name="bloglink">Blog</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/contribute/" data-bi-name="contributorGuide">Contribute</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/" data-bi-name="trademarks">Trademarks</a></li><li>&copy; Microsoft 2024</li>
	</ul>
</footer></div></div><div
							id="ms--additional-resources"
							class="right-container column is-4-desktop display-none display-block-desktop"
							data-bi-name="pageactions"
							role="complementary"
							aria-label="Additional resources"
						>
							<div id="affixed-right-container" class="margin-top-sm-tablet" data-bi-name="right-column">
								<h2 id="ms--additional-resources-heading" class="title is-6 margin-top-md" hidden>Additional resources</h2>
								<section id="right-rail-events" data-bi-name="events-card" hidden></section>
								<section id="right-rail-training" data-bi-name="learning-resources-card" hidden></section>
								<section id="right-rail-recommendations" data-bi-name="recommendations" hidden></section>
								<nav id="side-doc-outline" class="doc-outline" data-bi-name="intopic toc" aria-label="In this article">
									<h3>In this article</h3>
								</nav>
								<section id="right-rail-qna" class="margin-top-xxs" data-bi-name="qna-link-card" hidden></section>
							</div>
						</div></div>
				<!--end of div.columns -->

			</section>
			<!--end of .primary-holder -->

			<!-- interactive container -->
			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
			<!-- end of interactive container -->
		</div>

	</div>
	<!--end of .mainContainer -->

	<section class="border-top has-default-focus is-hidden-interactive margin-top-sm "><footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo"><div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop"><a
				data-mscc-ic="false"
				class="locale-selector-link button button-sm button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a><div class="ccpa-privacy-link" data-ccpa-privacy-link hidden>
<a
	href="https://aka.ms/yourcaliforniaprivacychoices"
	class="button button-sm button-clear flex-shrink-0"
	data-mscc-ic="false"
	data-bi-name="your-privacy-choices"
>
	<svg
		role="img"
		aria-label="California Consumer Privacy Act (CCPA) Opt-Out Icon"
		xmlns="http://www.w3.org/2000/svg"
		viewBox="0 0 30 14"
		xml:space="preserve"
		height="16"
		width="43"
		focusable="false"
	>
		<title>California Consumer Privacy Act (CCPA) Opt-Out Icon</title>
		<path d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"></path>
		<path d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"></path>
		<path d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z" style="fill:#fff"></path>
		<path d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z" style="fill:#06f"></path>
	</svg>
	<span>Your Privacy Choices</span>
</a>

		</div>
		<div class="flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
		<span class="icon expanded-indicator" aria-hidden="true">
			<span class="docon docon-chevron-down-light"></span>
		</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector padding-xxs" role="none">
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light margin-right-xxs">
						<span
							class="theme-selector-icon border display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Light</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Dark</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>High contrast</span>
				</button>
			</li>
		</ul>
	</div>
</div>

		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/previous-versions/" data-bi-name="archivelink">Previous Versions</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog" data-bi-name="bloglink">Blog</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/contribute/" data-bi-name="contributorGuide">Contribute</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/" data-bi-name="trademarks">Trademarks</a></li><li>&copy; Microsoft 2024</li>
	</ul>
</footer>

	</section>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>
</body>
</html>