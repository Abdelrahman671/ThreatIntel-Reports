<!doctype html><html lang="en"><head><title data-rh="true">Android/BianLian payload. In the previous article, we discussed… | by @cryptax | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2022-01-17T17:14:21.887Z"/><meta data-rh="true" name="title" content="Android/BianLian payload. In the previous article, we discussed… | by @cryptax | Medium"/><meta data-rh="true" property="og:title" content="Android/BianLian payload"/><meta data-rh="true" property="al:android:url" content="medium://p/61febabed00a"/><meta data-rh="true" property="al:ios:url" content="medium://p/61febabed00a"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="In the previous article, we discussed the packing mechanism of a Bian Lian sample, and how to unpack. This article reverse engineers the payload of the malware. It explains: This reverse engineering…"/><meta data-rh="true" property="og:description" content="In the previous article, we discussed the packing mechanism of a Bian Lian sample, and how to unpack. This article reverse engineers the…"/><meta data-rh="true" property="og:url" content="https://cryptax.medium.com/android-bianlian-payload-61febabed00a"/><meta data-rh="true" property="al:web:url" content="https://cryptax.medium.com/android-bianlian-payload-61febabed00a"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:300/1*mWbQxUmD6ktdKBD3xHaaqg.png"/><meta data-rh="true" property="article:author" content="https://cryptax.medium.com"/><meta data-rh="true" name="author" content="@cryptax"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Android/BianLian payload"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/61febabed00a"/><meta data-rh="true" property="twitter:description" content="In the previous article, we discussed the packing mechanism of a Bian Lian sample, and how to unpack. This article reverse engineers the…"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:300/1*mWbQxUmD6ktdKBD3xHaaqg.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:creator" content="@cryptax"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="9 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://cryptax.medium.com"/><link data-rh="true" rel="canonical" href="https://cryptax.medium.com/android-bianlian-payload-61febabed00a"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/61febabed00a"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*mWbQxUmD6ktdKBD3xHaaqg.png"],"url":"https:\u002F\u002Fcryptax.medium.com\u002Fandroid-bianlian-payload-61febabed00a","dateCreated":"2022-01-17T17:14:21.887Z","datePublished":"2022-01-17T17:14:21.887Z","dateModified":"2022-01-22T02:32:08.846Z","headline":"Android\u002FBianLian payload - @cryptax - Medium","name":"Android\u002FBianLian payload - @cryptax - Medium","description":"In the previous article, we discussed the packing mechanism of a Bian Lian sample, and how to unpack. This article reverse engineers the payload of the malware. It explains: This reverse engineering…","identifier":"61febabed00a","author":{"@type":"Person","name":"@cryptax","url":"https:\u002F\u002Fcryptax.medium.com"},"creator":["@cryptax"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fcryptax.medium.com\u002F","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fcryptax.medium.com\u002Fandroid-bianlian-payload-61febabed00a"}</script><style type="text/css" data-fela-rehydration="560" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="560" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="560" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:#1A8917}.es{border-color:#1A8917}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:#1A8917}.ez:disabled:hover{border-color:#1A8917}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-bottom:2px}.ii{flex-wrap:nowrap}.ij{font-size:16px}.ik{line-height:24px}.im{margin:0 8px}.in{display:inline}.io{color:#1A8917}.ip{fill:#1A8917}.is{flex:0 0 auto}.iv{flex-wrap:wrap}.iw{padding-left:8px}.ix{padding-right:8px}.jy> *{flex-shrink:0}.jz{overflow-x:scroll}.ka::-webkit-scrollbar{display:none}.kb{scrollbar-width:none}.kc{-ms-overflow-style:none}.kd{width:74px}.ke{flex-direction:row}.kf{z-index:2}.kg{margin-right:4px}.kj{-webkit-user-select:none}.kk{border:0}.kl{fill:rgba(117, 117, 117, 1)}.ko{outline:0}.kp{user-select:none}.kq> svg{pointer-events:none}.kz{cursor:progress}.la{opacity:1}.lb{padding:4px 0}.le{margin-top:0px}.lf{width:16px}.lh{display:inline-flex}.ln{max-width:100%}.lo{padding:8px 2px}.lp svg{color:#6B6B6B}.mg{line-height:1.58}.mh{letter-spacing:-0.004em}.mi{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nd{margin-bottom:-0.46em}.ne{list-style-type:disc}.nf{margin-left:30px}.ng{padding-left:0px}.nm{line-height:1.12}.nn{letter-spacing:-0.022em}.no{font-weight:600}.oj{margin-bottom:-0.28em}.op{list-style-type:decimal}.oq{padding:2px 4px}.or{font-size:75%}.os> strong{font-family:inherit}.ot{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.ou{font-style:italic}.ov{text-decoration:underline}.ow{margin-left:auto}.ox{margin-right:auto}.oy{max-width:1773px}.pe{clear:both}.pg{cursor:zoom-in}.ph{z-index:auto}.pj{height:auto}.pk{margin-top:10px}.pl{max-width:728px}.po{max-width:822px}.pp{max-width:1427px}.pq{max-width:1413px}.pr{max-width:1425px}.ps{max-width:1678px}.pt{max-width:595px}.pu{max-width:1154px}.pv{max-width:400px}.pw{max-width:1571px}.px{max-width:300px}.py{max-width:1595px}.pz{overflow-x:auto}.qa{padding:20px}.qb{border-radius:0}.qc{background:#F2F2F2}.qd{line-height:1.18}.qe{margin-top:-0.09em}.qf{margin-bottom:-0.09em}.qg{white-space:pre-wrap}.qh{min-width:fit-content}.qi{margin-top:0.91em}.qj{max-width:1822px}.qk{max-width:1416px}.ql{max-width:1405px}.qm{max-width:1384px}.qn{max-width:1382px}.qo{max-width:1630px}.qp{max-width:1370px}.qq{max-width:2099px}.qr{margin-bottom:26px}.qs{margin-top:6px}.qt{margin-top:8px}.qu{margin-right:8px}.qv{padding:8px 16px}.qw{border-radius:100px}.qx{transition:background 300ms ease}.qz{white-space:nowrap}.ra{border-top:none}.rb{margin-bottom:14px}.rc{height:52px}.rd{max-height:52px}.re{box-sizing:content-box}.rf{position:static}.rg{z-index:1}.ri{max-width:155px}.ro{margin-right:20px}.ru{height:0px}.rv{margin-bottom:40px}.sk{height:64px}.sl{width:64px}.sm{align-self:flex-end}.sn{color:rgba(255, 255, 255, 1)}.so{fill:rgba(255, 255, 255, 1)}.sp{background:rgba(25, 25, 25, 1)}.sq{border-color:rgba(25, 25, 25, 1)}.st:disabled{opacity:0.1}.su:disabled:hover{background:rgba(25, 25, 25, 1)}.sv:disabled:hover{border-color:rgba(25, 25, 25, 1)}.sw{flex:1 1 auto}.tc{padding-right:4px}.td{font-weight:500}.tq{margin-top:16px}.tr{margin-bottom:54px}.tx{gap:18px}.ty{fill:rgba(61, 61, 61, 1)}.uk{border-bottom:solid 1px #E5E5E5}.ul{margin-top:72px}.um{padding:24px 0}.un{margin-bottom:0px}.uo{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:#156D12}.eu:hover{border-color:#156D12}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.il:hover{text-decoration:underline}.iq:hover:not(:disabled){color:#156D12}.ir:hover:not(:disabled){fill:#156D12}.kn:hover{fill:rgba(8, 8, 8, 1)}.lc:hover{fill:#000000}.ld:hover p{color:#000000}.lg:hover{color:#000000}.lq:hover svg{color:#000000}.qy:hover{background-color:#F2F2F2}.sj:hover{background-color:none}.sr:hover{background:#000000}.ss:hover{border-color:#242424}.tz:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.km:focus{fill:rgba(8, 8, 8, 1)}.lr:focus svg{color:#000000}.pi:focus{transform:scale(1.01)}.kr:active{border-style:none}</style><style type="text/css" data-fela-rehydration="560" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.jk{border-top:solid 1px #F2F2F2}.jl{border-bottom:solid 1px #F2F2F2}.jm{margin:32px 0 0}.jn{padding:3px 8px}.jw> *{margin-right:24px}.jx> :last-child{margin-right:0}.ky{margin-top:0px}.lm{margin:0}.mz{font-size:20px}.na{margin-top:2.14em}.nb{line-height:32px}.nc{letter-spacing:-0.003em}.nl{margin-top:1.14em}.of{font-size:24px}.og{margin-top:1.95em}.oh{line-height:30px}.oi{letter-spacing:-0.016em}.oo{margin-top:0.94em}.pd{margin-top:56px}.rn{display:inline-block}.rt{margin-bottom:104px}.rw{flex-direction:row}.rz{margin-bottom:0}.sa{margin-right:20px}.sx{max-width:500px}.to{line-height:24px}.tp{letter-spacing:0}.tw{margin-bottom:72px}.ue{margin:40px 0 0}.uj{padding-top:72px}</style><style type="text/css" data-fela-rehydration="560" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.kx{margin-top:0px}.pm{margin-left:auto}.pn{text-align:center}.rm{display:inline-block}</style><style type="text/css" data-fela-rehydration="560" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.kw{margin-top:0px}.rl{display:inline-block}</style><style type="text/css" data-fela-rehydration="560" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ku{margin-top:0px}.kv{margin-right:0px}.rk{display:inline-block}</style><style type="text/css" data-fela-rehydration="560" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.it{flex-direction:column}.iy{margin:24px -24px 0}.iz{padding:0}.jo> *{margin-right:8px}.jp> :last-child{margin-right:24px}.kh{margin-left:0px}.ks{margin-top:0px}.kt{margin-right:0px}.li{margin:0}.ls{border:1px solid #F2F2F2}.lt{border-radius:99em}.lu{padding:0px 16px 0px 12px}.lv{height:38px}.lw{align-items:center}.ly svg{margin-right:8px}.mj{font-size:18px}.mk{margin-top:1.56em}.ml{line-height:28px}.mm{letter-spacing:-0.003em}.nh{margin-top:1.34em}.np{font-size:20px}.nq{margin-top:1.2em}.nr{line-height:24px}.ns{letter-spacing:0}.ok{margin-top:0.67em}.oz{margin-top:40px}.rj{display:inline-block}.rp{margin-bottom:96px}.sh{margin-bottom:20px}.si{margin-right:0}.tb{max-width:100%}.te{font-size:24px}.tf{line-height:30px}.tg{letter-spacing:-0.016em}.ts{margin-bottom:64px}.ua{margin:32px 0 0}.uf{padding-top:48px}.lx:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="560" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jg{border-top:solid 1px #F2F2F2}.jh{border-bottom:solid 1px #F2F2F2}.ji{margin:32px 0 0}.jj{padding:3px 8px}.ju> *{margin-right:24px}.jv> :last-child{margin-right:0}.ll{margin:0}.mv{font-size:20px}.mw{margin-top:2.14em}.mx{line-height:32px}.my{letter-spacing:-0.003em}.nk{margin-top:1.14em}.ob{font-size:24px}.oc{margin-top:1.95em}.od{line-height:30px}.oe{letter-spacing:-0.016em}.on{margin-top:0.94em}.pc{margin-top:56px}.rs{margin-bottom:104px}.rx{flex-direction:row}.sb{margin-bottom:0}.sc{margin-right:20px}.sy{max-width:500px}.tm{line-height:24px}.tn{letter-spacing:0}.tv{margin-bottom:72px}.ud{margin:40px 0 0}.ui{padding-top:72px}</style><style type="text/css" data-fela-rehydration="560" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jc{border-top:solid 1px #F2F2F2}.jd{border-bottom:solid 1px #F2F2F2}.je{margin:32px 0 0}.jf{padding:3px 8px}.js> *{margin-right:24px}.jt> :last-child{margin-right:0}.lk{margin:0}.mr{font-size:20px}.ms{margin-top:2.14em}.mt{line-height:32px}.mu{letter-spacing:-0.003em}.nj{margin-top:1.14em}.nx{font-size:24px}.ny{margin-top:1.95em}.nz{line-height:30px}.oa{letter-spacing:-0.016em}.om{margin-top:0.94em}.pb{margin-top:56px}.rr{margin-bottom:104px}.ry{flex-direction:row}.sd{margin-bottom:0}.se{margin-right:20px}.sz{max-width:500px}.tk{line-height:24px}.tl{letter-spacing:0}.tu{margin-bottom:72px}.uc{margin:40px 0 0}.uh{padding-top:72px}</style><style type="text/css" data-fela-rehydration="560" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iu{flex-direction:column}.ja{margin:24px 0 0}.jb{padding:0}.jq> *{margin-right:8px}.jr> :last-child{margin-right:8px}.ki{margin-left:0px}.lj{margin:0}.lz{border:1px solid #F2F2F2}.ma{border-radius:99em}.mb{padding:0px 16px 0px 12px}.mc{height:38px}.md{align-items:center}.mf svg{margin-right:8px}.mn{font-size:18px}.mo{margin-top:1.56em}.mp{line-height:28px}.mq{letter-spacing:-0.003em}.ni{margin-top:1.34em}.nt{font-size:20px}.nu{margin-top:1.2em}.nv{line-height:24px}.nw{letter-spacing:0}.ol{margin-top:0.67em}.pa{margin-top:40px}.rq{margin-bottom:96px}.sf{margin-bottom:20px}.sg{margin-right:0}.ta{max-width:100%}.th{font-size:24px}.ti{line-height:30px}.tj{letter-spacing:-0.016em}.tt{margin-bottom:64px}.ub{margin:32px 0 0}.ug{padding-top:48px}.me:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="560" data-fela-type="RULE" media="print">.rh{display:none}</style><style type="text/css" data-fela-rehydration="560" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.pf{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F61febabed00a&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fcryptax.medium.com%2Fandroid-bianlian-payload-61febabed00a&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fcryptax.medium.com%2Fandroid-bianlian-payload-61febabed00a&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="c014" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">Android/BianLian payload</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/?source=post_page---byline--61febabed00a--------------------------------"><div class="l ib ic by id ie"><div class="l fj"><img alt="@cryptax" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/2*iP0un-qdsQTJBsjGeUfyqg.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="ih ab q"><div class="ab q ii"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ij ik bk"><a class="af ag ah ai aj ak al am an ao ap aq ar il" data-testid="authorName" rel="noopener follow" href="/?source=post_page---byline--61febabed00a--------------------------------">@cryptax</a></p></div></div></div><span class="im in" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b ij ik du"><span><a class="io ip ah ai aj ak al am an ao ap aq ar ex iq ir" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fa035bab39b50&amp;operation=register&amp;redirect=https%3A%2F%2Fcryptax.medium.com%2Fandroid-bianlian-payload-61febabed00a&amp;user=%40cryptax&amp;userId=a035bab39b50&amp;source=post_page-a035bab39b50--byline--61febabed00a---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l is"><span class="bf b bg z du"><div class="ab cn it iu iv"><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">9 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Jan 17, 2022</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w fg fh q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F61febabed00a&amp;operation=register&amp;redirect=https%3A%2F%2Fcryptax.medium.com%2Fandroid-bianlian-payload-61febabed00a&amp;user=%40cryptax&amp;userId=a035bab39b50&amp;source=---header_actions--61febabed00a---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F61febabed00a&amp;operation=register&amp;redirect=https%3A%2F%2Fcryptax.medium.com%2Fandroid-bianlian-payload-61febabed00a&amp;source=---header_actions--61febabed00a---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lh cn"><div class="l ae"><div class="ab cb"><div class="li lj lk ll lm ln ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr ls lt lu lv s lw lx ly lz ma mb mc u md me mf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr ls lt lu lv s lw lx ly lz ma mb mc u md me mf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="ffdd" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">In the previous article, we discussed the packing mechanism of a Bian Lian sample, and how to unpack. This article reverse engineers the payload of the malware. It explains:</p><ul class=""><li id="b203" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng bk">The malicious components the bot implements. Those components can be seen as <strong class="mi gv">independent modules</strong>, and they are launched at the beginning. Each of them do their job, handle accessibility events which concern and notifies or responds to the C&amp;C. The implementation is clearly organized to easily welcome future modules.</li><li id="c1ca" class="mg mh gu mi b mj nh ml mm mn ni mp mq mr nj mt mu mv nk mx my mz nl nb nc nd ne nf ng bk">The <strong class="mi gv">communication between the C&amp;C and the bot</strong>. The bot understands and responds to several commands. The commands are implemented in the relevant component. The communication protocol is fairly simple: over HTTP (not HTTPS), with a plaintext JSON object as data (no encryption).</li><li id="6304" class="mg mh gu mi b mj nh ml mm mn ni mp mq mr nj mt mu mv nk mx my mz nl nb nc nd ne nf ng bk">The <strong class="mi gv">implementation</strong> of each major component.</li></ul><h1 id="e419" class="nm nn gu bf no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj bk">Three DEXes</h1><p id="dc2a" class="pw-post-body-paragraph mg mh gu mi b mj ok ml mm mn ol mp mq mr om mt mu mv on mx my mz oo nb nc nd gn bk">To be precise, note the Bian Lian we discuss uses three different DEX:</p><ol class=""><li id="485d" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd op nf ng bk">The main APK’s DEX — which is responsible for decrypting and loading via multidex the second DEX. For reminder, the APK’s sha256 is <code class="cx oq or os ot b">5b9049c392eaf83b12b98419f14ece1b00042592b003a17e4e6f0fb466281368</code></li><li id="ed8a" class="mg mh gu mi b mj nh ml mm mn ni mp mq mr nj mt mu mv nk mx my mz nl nb nc nd op nf ng bk">The second DEX — which implements the malicious payload of the bot. This is what we discuss in this article. Its sha256 is <code class="cx oq or os ot b">d0d704ace35b0190174c11efa3fef292e026391677ff9dc10d2783b4cfe7f961</code></li><li id="10a4" class="mg mh gu mi b mj nh ml mm mn ni mp mq mr nj mt mu mv nk mx my mz nl nb nc nd op nf ng bk">A third DEX. It is downloaded by the second DEX from the remote C&amp;C, but is not interesting for the analysis of the malware because it only contains non-malicious utility functions. Its package name is <code class="cx oq or os ot b">com.fbdev.payload</code>.</li></ol><h1 id="2e21" class="nm nn gu bf no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj bk">Reverse engineer is loooong</h1><p id="2c7f" class="pw-post-body-paragraph mg mh gu mi b mj ok ml mm mn ol mp mq mr om mt mu mv on mx my mz oo nb nc nd gn bk">This reverse engineering took me <strong class="mi gv">several days</strong>. Actually, between unpacking, reverse engineering and writing the blog, it approximately took me <em class="ou">2 weeks</em>! I am not particularly proud about it, but I often get the question “whow, how long did it take you?” and although I’d love to appear extremely skilled, the reality is that reverse engineering is a long process. It can be compared to puzzles or a plate of spaghetti: at first, you don’t know where to start, you follow a path and often get lost in the middle and soon don’t exactly know what you were searching for 😄</p><p id="e2a9" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Consequently, I am sharing my JEB project (which contains all the functions I renamed, my comments etc): <a class="af ov" href="https://my.owndrive.com/s/zz48eoiePNoKKYW" rel="noopener ugc nofollow" target="_blank">you can download it here</a>.</p><p id="10c0" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Also, the article ends with a few remaining <strong class="mi gv">questions</strong> on the reverse engineering of the sample. You are welcome to interact if you have an idea.</p><p id="8df6" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Now, let’s start!</p><h1 id="4d3a" class="nm nn gu bf no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj bk">Overview of malicious components</h1><p id="a4ab" class="pw-post-body-paragraph mg mh gu mi b mj ok ml mm mn ol mp mq mr om mt mu mv on mx my mz oo nb nc nd gn bk">This malware is a <em class="ou">bot</em>, which reports and receives commands from a remote server (C&amp;C). It implements several malicious components:</p><ul class=""><li id="ea23" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng bk">Bulk SMS. The attacker specifies the body of a SMS to send, and it is sent to all contacts of the victim’s smartphone.</li><li id="5ce3" class="mg mh gu mi b mj nh ml mm mn ni mp mq mr nj mt mu mv nk mx my mz nl nb nc nd ne nf ng bk">Inject. The attacker provides an image to download from the web and inject (overlay) on a given list of apps.</li><li id="f3a3" class="mg mh gu mi b mj nh ml mm mn ni mp mq mr nj mt mu mv nk mx my mz nl nb nc nd ne nf ng bk">Install Apps. The attacker specifies a list of applications to install on the phone.</li><li id="5f2b" class="mg mh gu mi b mj nh ml mm mn ni mp mq mr nj mt mu mv nk mx my mz nl nb nc nd ne nf ng bk">Locker. This disables the ringer, and displays a text taken randomly from a pool of possible messages.</li><li id="8a64" class="mg mh gu mi b mj nh ml mm mn ni mp mq mr nj mt mu mv nk mx my mz nl nb nc nd ne nf ng bk">Notification Disabler. Disables notifications of given applications.</li><li id="2050" class="mg mh gu mi b mj nh ml mm mn ni mp mq mr nj mt mu mv nk mx my mz nl nb nc nd ne nf ng bk">PIN code. Steals the lock PIN code for some phone brands. The sample we analyze supports Samsung and Huawei.</li><li id="a669" class="mg mh gu mi b mj nh ml mm mn ni mp mq mr nj mt mu mv nk mx my mz nl nb nc nd ne nf ng bk">SMS. This is to send specific SMS messages. The attacker specifies the body and phone number to send to.</li><li id="e72a" class="mg mh gu mi b mj nh ml mm mn ni mp mq mr nj mt mu mv nk mx my mz nl nb nc nd ne nf ng bk">Screencast. Takes screenshots of given applications.</li><li id="ffa0" class="mg mh gu mi b mj nh ml mm mn ni mp mq mr nj mt mu mv nk mx my mz nl nb nc nd ne nf ng bk">Sound switch. Turn ringer on or off.</li><li id="47a7" class="mg mh gu mi b mj nh ml mm mn ni mp mq mr nj mt mu mv nk mx my mz nl nb nc nd ne nf ng bk">Team viewer. The <a class="af ov" href="https://play.google.com/store/apps/details?id=com.teamviewer.host.market" rel="noopener ugc nofollow" target="_blank">Team Viewer app</a> is a well known non-malicious app to access your smartphone from any other computer. Here, the attacker uses it to access the victim’s smartphone remotely.</li><li id="05b1" class="mg mh gu mi b mj nh ml mm mn ni mp mq mr nj mt mu mv nk mx my mz nl nb nc nd ne nf ng bk">USSD. The attacker specifies the premium phone number to call. For the victim, this may result in extra cost, depending on his/her subscription.</li></ul><h1 id="0427" class="nm nn gu bf no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj bk">Communication with the C&amp;C</h1><p id="d8c4" class="pw-post-body-paragraph mg mh gu mi b mj ok ml mm mn ol mp mq mr om mt mu mv on mx my mz oo nb nc nd gn bk">The URL to the remote C&amp;C is found encrypted in the shared preferences file <code class="cx oq or os ot b">pref_name_setting.xml</code>. The algorithm uses slightly modified XOR algorithm with a hard-coded key derived from the string <code class="cx oq or os ot b">sorry!need8money[for`food</code>.</p><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div role="button" tabindex="0" class="pf pg fj ph bh pi"><div class="ow ox oy"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*nsVxbv9Ox91J-ZH0VCnBvw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*nsVxbv9Ox91J-ZH0VCnBvw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*nsVxbv9Ox91J-ZH0VCnBvw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*nsVxbv9Ox91J-ZH0VCnBvw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*nsVxbv9Ox91J-ZH0VCnBvw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*nsVxbv9Ox91J-ZH0VCnBvw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nsVxbv9Ox91J-ZH0VCnBvw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*nsVxbv9Ox91J-ZH0VCnBvw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*nsVxbv9Ox91J-ZH0VCnBvw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*nsVxbv9Ox91J-ZH0VCnBvw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*nsVxbv9Ox91J-ZH0VCnBvw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*nsVxbv9Ox91J-ZH0VCnBvw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*nsVxbv9Ox91J-ZH0VCnBvw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*nsVxbv9Ox91J-ZH0VCnBvw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pj c" width="700" height="55" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pk ff pl ow ox pm pn bf b bg z du">Decrypting the preferences entry “admin_panel_url_”</figcaption></figure><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div role="button" tabindex="0" class="pf pg fj ph bh pi"><div class="ow ox po"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*wkknoCQVGdCgH-Qh6MYPhg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*wkknoCQVGdCgH-Qh6MYPhg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*wkknoCQVGdCgH-Qh6MYPhg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*wkknoCQVGdCgH-Qh6MYPhg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*wkknoCQVGdCgH-Qh6MYPhg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*wkknoCQVGdCgH-Qh6MYPhg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wkknoCQVGdCgH-Qh6MYPhg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*wkknoCQVGdCgH-Qh6MYPhg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*wkknoCQVGdCgH-Qh6MYPhg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*wkknoCQVGdCgH-Qh6MYPhg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*wkknoCQVGdCgH-Qh6MYPhg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*wkknoCQVGdCgH-Qh6MYPhg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*wkknoCQVGdCgH-Qh6MYPhg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*wkknoCQVGdCgH-Qh6MYPhg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pj c" width="700" height="689" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pk ff pl ow ox pm pn bf b bg z du">The XOR key is composed of characters !8[`. For example “IL/p:/trI]:cNT7iDJhQ53iNV]9sHL&amp;gt;” decrypts to <a class="af ov" href="http://rheacollier31532.websit" rel="noopener ugc nofollow" target="_blank">hxxp://rheacollier31532.websit</a>e</figcaption></figure><p id="973e" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The remote attacker and the bot exchange a JSON string, where JSON keys specify actions (or responses) to conduct.</p><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div role="button" tabindex="0" class="pf pg fj ph bh pi"><div class="ow ox pp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*XUQLZc73T6KkwtvqK7avnA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*XUQLZc73T6KkwtvqK7avnA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*XUQLZc73T6KkwtvqK7avnA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*XUQLZc73T6KkwtvqK7avnA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*XUQLZc73T6KkwtvqK7avnA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*XUQLZc73T6KkwtvqK7avnA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XUQLZc73T6KkwtvqK7avnA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*XUQLZc73T6KkwtvqK7avnA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*XUQLZc73T6KkwtvqK7avnA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*XUQLZc73T6KkwtvqK7avnA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*XUQLZc73T6KkwtvqK7avnA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*XUQLZc73T6KkwtvqK7avnA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*XUQLZc73T6KkwtvqK7avnA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*XUQLZc73T6KkwtvqK7avnA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pj c" width="700" height="792" loading="lazy" role="presentation"/></picture></div></div></figure><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div role="button" tabindex="0" class="pf pg fj ph bh pi"><div class="ow ox pq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8kDsQShTfjwF9lpq6BN3jQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8kDsQShTfjwF9lpq6BN3jQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8kDsQShTfjwF9lpq6BN3jQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8kDsQShTfjwF9lpq6BN3jQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8kDsQShTfjwF9lpq6BN3jQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8kDsQShTfjwF9lpq6BN3jQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8kDsQShTfjwF9lpq6BN3jQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*8kDsQShTfjwF9lpq6BN3jQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8kDsQShTfjwF9lpq6BN3jQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8kDsQShTfjwF9lpq6BN3jQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8kDsQShTfjwF9lpq6BN3jQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8kDsQShTfjwF9lpq6BN3jQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8kDsQShTfjwF9lpq6BN3jQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*8kDsQShTfjwF9lpq6BN3jQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pj c" width="700" height="155" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pk ff pl ow ox pm pn bf b bg z du">List of commands understood by the BianLian bot. The commands are keys within a JSON object, and values specify command arguments. The JSON object is sent or received from the C&amp;C.</figcaption></figure><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div role="button" tabindex="0" class="pf pg fj ph bh pi"><div class="ow ox pr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*iH5cTMvzDd7I9FAlsvYPDw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*iH5cTMvzDd7I9FAlsvYPDw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*iH5cTMvzDd7I9FAlsvYPDw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*iH5cTMvzDd7I9FAlsvYPDw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*iH5cTMvzDd7I9FAlsvYPDw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*iH5cTMvzDd7I9FAlsvYPDw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iH5cTMvzDd7I9FAlsvYPDw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*iH5cTMvzDd7I9FAlsvYPDw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*iH5cTMvzDd7I9FAlsvYPDw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*iH5cTMvzDd7I9FAlsvYPDw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*iH5cTMvzDd7I9FAlsvYPDw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*iH5cTMvzDd7I9FAlsvYPDw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*iH5cTMvzDd7I9FAlsvYPDw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*iH5cTMvzDd7I9FAlsvYPDw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pj c" width="700" height="618" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pk ff pl ow ox pm pn bf b bg z du">List of Bian Lian bot responses to commands.</figcaption></figure><h1 id="a507" class="nm nn gu bf no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj bk">Malicious injections</h1><p id="a0d1" class="pw-post-body-paragraph mg mh gu mi b mj ok ml mm mn ol mp mq mr om mt mu mv on mx my mz oo nb nc nd gn bk">The bot implements an injection module which overlays attacker chosen images on top of target applications.</p><p id="64e9" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">First, the bot reports its activity to the C&amp;C. The attacker answers back to the bot with a list of applications it is interested to inject into (see “stockInjects” key):</p><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div role="button" tabindex="0" class="pf pg fj ph bh pi"><div class="ow ox ps"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*59B3rFNz_T6d5HZraF5Xaw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*59B3rFNz_T6d5HZraF5Xaw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*59B3rFNz_T6d5HZraF5Xaw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*59B3rFNz_T6d5HZraF5Xaw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*59B3rFNz_T6d5HZraF5Xaw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*59B3rFNz_T6d5HZraF5Xaw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*59B3rFNz_T6d5HZraF5Xaw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*59B3rFNz_T6d5HZraF5Xaw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*59B3rFNz_T6d5HZraF5Xaw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*59B3rFNz_T6d5HZraF5Xaw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*59B3rFNz_T6d5HZraF5Xaw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*59B3rFNz_T6d5HZraF5Xaw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*59B3rFNz_T6d5HZraF5Xaw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*59B3rFNz_T6d5HZraF5Xaw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pj c" width="700" height="302" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pk ff pl ow ox pm pn bf b bg z du">In this case, the C&amp;C was interested in many mobile turkish bank apps.</figcaption></figure><p id="262c" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The bot searches which of these apps are installed on the victim’s phone and reports the information back to the C&amp;C (see “app_list” key).</p><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div class="ow ox pt"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*dWmVnBDWzjM673XPgceZqQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*dWmVnBDWzjM673XPgceZqQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*dWmVnBDWzjM673XPgceZqQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*dWmVnBDWzjM673XPgceZqQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*dWmVnBDWzjM673XPgceZqQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*dWmVnBDWzjM673XPgceZqQ.png 1100w, https://miro.medium.com/v2/resize:fit:1190/format:webp/1*dWmVnBDWzjM673XPgceZqQ.png 1190w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 595px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*dWmVnBDWzjM673XPgceZqQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*dWmVnBDWzjM673XPgceZqQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*dWmVnBDWzjM673XPgceZqQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*dWmVnBDWzjM673XPgceZqQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*dWmVnBDWzjM673XPgceZqQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*dWmVnBDWzjM673XPgceZqQ.png 1100w, https://miro.medium.com/v2/resize:fit:1190/1*dWmVnBDWzjM673XPgceZqQ.png 1190w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 595px"/><img alt="" class="bh ln pj c" width="595" height="196" loading="lazy" role="presentation"/></picture></div><figcaption class="pk ff pl ow ox pm pn bf b bg z du">For example, in this case, the bot notifies the C&amp;C 3 interesting mobile apps are installed.</figcaption></figure><p id="7cba" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">When an app among this list is launched, the bot requests the C&amp;C an HTML page to overlay.</p><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div role="button" tabindex="0" class="pf pg fj ph bh pi"><div class="ow ox pu"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*z3rM_QFjQqoNCqDRtXOa-g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*z3rM_QFjQqoNCqDRtXOa-g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*z3rM_QFjQqoNCqDRtXOa-g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*z3rM_QFjQqoNCqDRtXOa-g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*z3rM_QFjQqoNCqDRtXOa-g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*z3rM_QFjQqoNCqDRtXOa-g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z3rM_QFjQqoNCqDRtXOa-g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*z3rM_QFjQqoNCqDRtXOa-g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*z3rM_QFjQqoNCqDRtXOa-g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*z3rM_QFjQqoNCqDRtXOa-g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*z3rM_QFjQqoNCqDRtXOa-g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*z3rM_QFjQqoNCqDRtXOa-g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*z3rM_QFjQqoNCqDRtXOa-g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*z3rM_QFjQqoNCqDRtXOa-g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pj c" width="700" height="551" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pk ff pl ow ox pm pn bf b bg z du">In this network capture, the bot requests an HTML page to display above the bank’s application.</figcaption></figure><p id="3448" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">From victim’s point of view, everything happens fast and it is not easy to detect something fishy is happening: the victim opens his/her mobile banking app. S/he will perhaps notice a quick screen flickering: this occurs when the bot has downloaded the attacker’s HTML and overlays it on top of the real app. See below an example of overlay.</p><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div class="ow ox pv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*S8CQ8Yoda5-0RJ17ytORqA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*S8CQ8Yoda5-0RJ17ytORqA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*S8CQ8Yoda5-0RJ17ytORqA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*S8CQ8Yoda5-0RJ17ytORqA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*S8CQ8Yoda5-0RJ17ytORqA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*S8CQ8Yoda5-0RJ17ytORqA.png 1100w, https://miro.medium.com/v2/resize:fit:800/format:webp/1*S8CQ8Yoda5-0RJ17ytORqA.png 800w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 400px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*S8CQ8Yoda5-0RJ17ytORqA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*S8CQ8Yoda5-0RJ17ytORqA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*S8CQ8Yoda5-0RJ17ytORqA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*S8CQ8Yoda5-0RJ17ytORqA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*S8CQ8Yoda5-0RJ17ytORqA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*S8CQ8Yoda5-0RJ17ytORqA.png 1100w, https://miro.medium.com/v2/resize:fit:800/1*S8CQ8Yoda5-0RJ17ytORqA.png 800w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 400px"/><img alt="" class="bh ln pj c" width="400" height="711" loading="lazy" role="presentation"/></picture></div><figcaption class="pk ff pl ow ox pm pn bf b bg z du">Beware the malicious overlay! This screenshot was taken on an infected Android emulator. If we are cautious, we can spot the trick here because the overlay is not perfect: the real app is running behind (we see the real logo at the top) and the malicious page is overlaid in front. This is actually not an image but an entire HTML page, with hard-coded embedded logo images, layout and JavaScript. The card number, expiration date &amp; CVV are sent back to the C&amp;C.</figcaption></figure><h1 id="2db0" class="nm nn gu bf no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj bk">Team Viewer component</h1><p id="f483" class="pw-post-body-paragraph mg mh gu mi b mj ok ml mm mn ol mp mq mr om mt mu mv on mx my mz oo nb nc nd gn bk">The bot support “teamViewerOptions” command which triggers the Team Viewer app to remotely access and control the victim’s smartphone. The C&amp;C sends a username and password, and the bot (1) launches the Team Viewer app (if necessary), (2) accepts the EULA displayed by KLMS Agent on Samsung devices (security framework), (3) enters username and password in Team Viewer and (4) finally connects to the remote end.</p><p id="5add" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">This functionality heavily relies on using (abusing) the Accessibility Service.</p><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div role="button" tabindex="0" class="pf pg fj ph bh pi"><div class="ow ox pw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*1T7n1pVusmuny73__QKU9w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*1T7n1pVusmuny73__QKU9w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*1T7n1pVusmuny73__QKU9w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*1T7n1pVusmuny73__QKU9w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*1T7n1pVusmuny73__QKU9w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*1T7n1pVusmuny73__QKU9w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1T7n1pVusmuny73__QKU9w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*1T7n1pVusmuny73__QKU9w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*1T7n1pVusmuny73__QKU9w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*1T7n1pVusmuny73__QKU9w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*1T7n1pVusmuny73__QKU9w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*1T7n1pVusmuny73__QKU9w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*1T7n1pVusmuny73__QKU9w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*1T7n1pVusmuny73__QKU9w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pj c" width="700" height="461" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pk ff pl ow ox pm pn bf b bg z du">Decompiled code of the malware’s team viewer component. The Accessibility Service is used to see which node/view is currently displayed, locate the relevant button and automatically click on it. Team Viewer is automatically configured by automatically entering username/password inside the right text views of the application.</figcaption></figure><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div class="ow ox px"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*mWbQxUmD6ktdKBD3xHaaqg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*mWbQxUmD6ktdKBD3xHaaqg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*mWbQxUmD6ktdKBD3xHaaqg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*mWbQxUmD6ktdKBD3xHaaqg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*mWbQxUmD6ktdKBD3xHaaqg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*mWbQxUmD6ktdKBD3xHaaqg.png 1100w, https://miro.medium.com/v2/resize:fit:600/format:webp/1*mWbQxUmD6ktdKBD3xHaaqg.png 600w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 300px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*mWbQxUmD6ktdKBD3xHaaqg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*mWbQxUmD6ktdKBD3xHaaqg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*mWbQxUmD6ktdKBD3xHaaqg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*mWbQxUmD6ktdKBD3xHaaqg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*mWbQxUmD6ktdKBD3xHaaqg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*mWbQxUmD6ktdKBD3xHaaqg.png 1100w, https://miro.medium.com/v2/resize:fit:600/1*mWbQxUmD6ktdKBD3xHaaqg.png 600w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 300px"/><img alt="" class="bh ln pj c" width="300" height="533" loading="lazy" role="presentation"/></picture></div><figcaption class="pk ff pl ow ox pm pn bf b bg z du">To abuse Accessibility Services, the malware requests initial permissions. Yes, in theory, an end-user should not click “OK” to such a request, but let’s be honest, there are many pop-ups on a smartphone &amp; it’s not always clear to the end-user what they are authorizing. That’s how we end up with an infected smartphone…</figcaption></figure><h1 id="420b" class="nm nn gu bf no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj bk">Disabling notifications</h1><p id="04f8" class="pw-post-body-paragraph mg mh gu mi b mj ok ml mm mn ol mp mq mr om mt mu mv on mx my mz oo nb nc nd gn bk">The C&amp;C sends a command “disabledPackages” with a list of package names to disable notifications for. The bot processes those packages one by one, launches the notification settings panel and uses the Accessibility Service API to ensure the notification switch for the app is turned off.</p><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div role="button" tabindex="0" class="pf pg fj ph bh pi"><div class="ow ox py"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*iekTdr62Ut44oyD-U--BdA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*iekTdr62Ut44oyD-U--BdA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*iekTdr62Ut44oyD-U--BdA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*iekTdr62Ut44oyD-U--BdA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*iekTdr62Ut44oyD-U--BdA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*iekTdr62Ut44oyD-U--BdA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iekTdr62Ut44oyD-U--BdA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*iekTdr62Ut44oyD-U--BdA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*iekTdr62Ut44oyD-U--BdA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*iekTdr62Ut44oyD-U--BdA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*iekTdr62Ut44oyD-U--BdA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*iekTdr62Ut44oyD-U--BdA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*iekTdr62Ut44oyD-U--BdA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*iekTdr62Ut44oyD-U--BdA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pj c" width="700" height="356" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pk ff pl ow ox pm pn bf b bg z du">This is the part of the bot’s code that disables notification for an app. The bot opens the notification settings for a given app. At this point, the method above gets called. It checks whether the notification switch is already checked or not. If checked, it unchecks it. If not checked, it leaves it unchecked and continues to the next app.</figcaption></figure><h1 id="ec34" class="nm nn gu bf no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj bk">Screencast component</h1><p id="8e1e" class="pw-post-body-paragraph mg mh gu mi b mj ok ml mm mn ol mp mq mr om mt mu mv on mx my mz oo nb nc nd gn bk">The C&amp;C may also send a “showScreen” which is implemented by the Screencast component of the bot.</p><p id="3660" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">First of all, if the device is locked, the bot broadcasts a swipe action to unlock.</p><pre class="oz pa pb pc pd pz ot qa qb ay qc bk"><span id="4377" class="qd nn gu ot b ij qe qf l qg qh">Intent intent = new Intent(InjAccessibilityService.broadcast_swipe_unlock);  // &quot;broadcast_swipe_to_unlock_action&quot;<br/>intent.putExtra(&quot;task&quot;, 669);<br/>Context.this.sendBroadcast(intent);<br/></span></pre><p id="0256" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Then, it starts an activity that initiates screen capture.</p><pre class="oz pa pb pc pd pz ot qa qb ay qc bk"><span id="5e6f" class="qd nn gu ot b ij qe qf l qg qh">if(!this.active &amp;&amp; this.mediaprojectmgr != null) {   activity.startActivityForResult(this.mediaprojectmgr.createScreenCaptureIntent(), 0x1E240);  </span><span id="bbc6" class="qd nn gu ot b ij qi qf l qg qh">}</span></pre><p id="8ef5" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">This should normally prompt the end user if s/he accepts screen capture: the bot handles this and automatically accepts it on user’s behalf.</p><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div role="button" tabindex="0" class="pf pg fj ph bh pi"><div class="ow ox qj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*y8R7SBaRYsNcX0e80tVNNQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*y8R7SBaRYsNcX0e80tVNNQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*y8R7SBaRYsNcX0e80tVNNQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*y8R7SBaRYsNcX0e80tVNNQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*y8R7SBaRYsNcX0e80tVNNQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*y8R7SBaRYsNcX0e80tVNNQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y8R7SBaRYsNcX0e80tVNNQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*y8R7SBaRYsNcX0e80tVNNQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*y8R7SBaRYsNcX0e80tVNNQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*y8R7SBaRYsNcX0e80tVNNQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*y8R7SBaRYsNcX0e80tVNNQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*y8R7SBaRYsNcX0e80tVNNQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*y8R7SBaRYsNcX0e80tVNNQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*y8R7SBaRYsNcX0e80tVNNQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pj c" width="700" height="230" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pk ff pl ow ox pm pn bf b bg z du">When a screen capture is requested, the system normally displays a system UI pop-up asking for confirmation. The code above checks this is the confirmation pop-up, that it requests screen capture for the Video Player (the sample poses as a Video Player app) and automatically confirms &amp; remembers the choice.</figcaption></figure><p id="d3d3" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">When a screenshot is ready, it is sent to the C&amp;C in base64 format.</p><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div role="button" tabindex="0" class="pf pg fj ph bh pi"><div class="ow ox qk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*qLfLtnmB13hVQDQzXOcbPA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*qLfLtnmB13hVQDQzXOcbPA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*qLfLtnmB13hVQDQzXOcbPA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*qLfLtnmB13hVQDQzXOcbPA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*qLfLtnmB13hVQDQzXOcbPA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*qLfLtnmB13hVQDQzXOcbPA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qLfLtnmB13hVQDQzXOcbPA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*qLfLtnmB13hVQDQzXOcbPA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*qLfLtnmB13hVQDQzXOcbPA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*qLfLtnmB13hVQDQzXOcbPA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*qLfLtnmB13hVQDQzXOcbPA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*qLfLtnmB13hVQDQzXOcbPA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*qLfLtnmB13hVQDQzXOcbPA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*qLfLtnmB13hVQDQzXOcbPA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pj c" width="700" height="197" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pk ff pl ow ox pm pn bf b bg z du">Encode bitmap in Base64 and send it to C&amp;C. If upload fails, stop screen cast service.</figcaption></figure><p id="44f7" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Unless an error occurs, a new screenshot will be taken in a second. This can get pretty intensive and slow down the phone, which probably explains why the bot displays a fake notification saying the phone is currently updating Google Play!</p><pre class="oz pa pb pc pd pz ot qa qb ay qc bk"><span id="a109" class="qd nn gu ot b ij qe qf l qg qh">this.startForeground(0x74A, new Notification.Builder(this.getApplicationContext()).setContentTitle(&quot;Google&quot;).setContentText(&quot;Update Google Play Service&quot;).setSmallIcon(0x7F050001).setProgress(0, 100, true).build());</span></pre><h1 id="2d61" class="nm nn gu bf no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj bk">Locker component</h1><p id="596b" class="pw-post-body-paragraph mg mh gu mi b mj ok ml mm mn ol mp mq mr om mt mu mv on mx my mz oo nb nc nd gn bk">When the bot receives the “locked” command with a flag set to True, it sets the ringer to silent mode and displays an activity meant to have the victim believe a recovery is under progress. The displayed messages are initially the following:</p><pre class="oz pa pb pc pd pz ot qa qb ay qc bk"><span id="4d32" class="qd nn gu ot b ij qe qf l qg qh">Android system corrupted files recovery &lt;3e&gt;<br/>Kernel version 2.1.0.3<br/>DO NOT TURN THE SYSTEM OFF</span></pre><p id="9f9c" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The mechanism to lock the device is simple: the message is displayed <em class="ou">full screen</em>, without navigation buttons, and the<em class="ou"> bot prevents any window focus change</em>. This results in the user being locked on the given screen.</p><pre class="oz pa pb pc pd pz ot qa qb ay qc bk"><span id="1897" class="qd nn gu ot b ij qe qf l qg qh">private void fullScreen() {<br/>  this.getWindow().getDecorView().setSystemUiVisibility(0xF06); // SYSTEM_UI_FLAG_FULLSCREEN=4 | SYSTEM_UI_FLAG_HIDE_NAVIGATION=2<br/>}</span><span id="d93a" class="qd nn gu ot b ij qi qf l qg qh">public void onWindowFocusChanged(boolean arg5) {      <br/>  super.onWindowFocusChanged(arg5);<br/>  if(arg5) {<br/>    this.fullScreen();<br/>  }<br/>}</span></pre><p id="0bac" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">When the C&amp;C sends a “locked” command with flag to False, the bot simply kills the locking activity and the victim may resume its usage of the phone.</p><h1 id="844b" class="nm nn gu bf no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj bk">PIN code component</h1><p id="234a" class="pw-post-body-paragraph mg mh gu mi b mj ok ml mm mn ol mp mq mr om mt mu mv on mx my mz oo nb nc nd gn bk">When the bot receives a “action_request_pin” command, it tries to steal the victim’s PIN. Depending on the device, it asks the victim to set a new password and steals it by monitoring the Accessibility API, or it steals the current PIN by overlaying a fake PIN code request window.</p><p id="ebe4" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">If the C&amp;C provides a “approvedPin” command, the bot will additionally try to modify the current PIN with the new value selected by the C&amp;C.</p><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div role="button" tabindex="0" class="pf pg fj ph bh pi"><div class="ow ox ql"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ggEP1Yw3lLFoU_looJtYpw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ggEP1Yw3lLFoU_looJtYpw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ggEP1Yw3lLFoU_looJtYpw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ggEP1Yw3lLFoU_looJtYpw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ggEP1Yw3lLFoU_looJtYpw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ggEP1Yw3lLFoU_looJtYpw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ggEP1Yw3lLFoU_looJtYpw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ggEP1Yw3lLFoU_looJtYpw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ggEP1Yw3lLFoU_looJtYpw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ggEP1Yw3lLFoU_looJtYpw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ggEP1Yw3lLFoU_looJtYpw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ggEP1Yw3lLFoU_looJtYpw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ggEP1Yw3lLFoU_looJtYpw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ggEP1Yw3lLFoU_looJtYpw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pj c" width="700" height="385" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pk ff pl ow ox pm pn bf b bg z du">Task of the PIN code component</figcaption></figure><h1 id="7951" class="nm nn gu bf no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj bk">Install component</h1><p id="db44" class="pw-post-body-paragraph mg mh gu mi b mj ok ml mm mn ol mp mq mr om mt mu mv on mx my mz oo nb nc nd gn bk">The C&amp;C may send a list of apps to install via command “apks”. The applications are downloaded from a URL specified in the command. The installation is performed by abusing the Accessibility API. The code is quite lengthy because there are many cases: check the event occurs in the system installer, if the app installer occurs in an alert dialog then automatically click to install. If the system is requesting permission to install from an external source, authorize it etc.</p><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div role="button" tabindex="0" class="pf pg fj ph bh pi"><div class="ow ox qm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*kqNxKS7jGNh_9_lfsCG3BQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*kqNxKS7jGNh_9_lfsCG3BQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*kqNxKS7jGNh_9_lfsCG3BQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*kqNxKS7jGNh_9_lfsCG3BQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*kqNxKS7jGNh_9_lfsCG3BQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kqNxKS7jGNh_9_lfsCG3BQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kqNxKS7jGNh_9_lfsCG3BQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*kqNxKS7jGNh_9_lfsCG3BQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*kqNxKS7jGNh_9_lfsCG3BQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*kqNxKS7jGNh_9_lfsCG3BQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*kqNxKS7jGNh_9_lfsCG3BQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*kqNxKS7jGNh_9_lfsCG3BQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*kqNxKS7jGNh_9_lfsCG3BQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*kqNxKS7jGNh_9_lfsCG3BQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pj c" width="700" height="169" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pk ff pl ow ox pm pn bf b bg z du">Automatically authorizing install of APKs from external sources</figcaption></figure><p id="af14" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The same component also deals with removal of applications. The command names are misleading “remove_all” uninstalls only Team Viewer, and “remove_by_id” removes a specified app. If the package name is “bot”, then the bot removes itself. A self “cleaning” command!</p><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div role="button" tabindex="0" class="pf pg fj ph bh pi"><div class="ow ox qn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*s8bdiFa5y9UMMc_7HfsFEg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*s8bdiFa5y9UMMc_7HfsFEg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*s8bdiFa5y9UMMc_7HfsFEg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*s8bdiFa5y9UMMc_7HfsFEg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*s8bdiFa5y9UMMc_7HfsFEg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*s8bdiFa5y9UMMc_7HfsFEg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s8bdiFa5y9UMMc_7HfsFEg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*s8bdiFa5y9UMMc_7HfsFEg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*s8bdiFa5y9UMMc_7HfsFEg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*s8bdiFa5y9UMMc_7HfsFEg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*s8bdiFa5y9UMMc_7HfsFEg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*s8bdiFa5y9UMMc_7HfsFEg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*s8bdiFa5y9UMMc_7HfsFEg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*s8bdiFa5y9UMMc_7HfsFEg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pj c" width="700" height="310" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pk ff pl ow ox pm pn bf b bg z du">Processing C&amp;C commands to delete applications</figcaption></figure><h1 id="c03e" class="nm nn gu bf no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj bk">Sound component</h1><p id="1efd" class="pw-post-body-paragraph mg mh gu mi b mj ok ml mm mn ol mp mq mr om mt mu mv on mx my mz oo nb nc nd gn bk">The C&amp;C may turn on or off the ringer via command “soundEnabled” followed by a boolean. Turning the ringer on / off is performed simply by a call to <code class="cx oq or os ot b">setRingerMode</code>.</p><h1 id="313b" class="nm nn gu bf no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj bk">USSD component</h1><p id="eba9" class="pw-post-body-paragraph mg mh gu mi b mj ok ml mm mn ol mp mq mr om mt mu mv on mx my mz oo nb nc nd gn bk">The bot may be instructed to call USSD (quick codes). For instance, we see it requests *101# which returns the current subscription rate.</p><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div role="button" tabindex="0" class="pf pg fj ph bh pi"><div class="ow ox qo"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*iuYH5LpKOjWY0WuKrBVpXw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*iuYH5LpKOjWY0WuKrBVpXw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*iuYH5LpKOjWY0WuKrBVpXw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*iuYH5LpKOjWY0WuKrBVpXw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*iuYH5LpKOjWY0WuKrBVpXw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*iuYH5LpKOjWY0WuKrBVpXw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iuYH5LpKOjWY0WuKrBVpXw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*iuYH5LpKOjWY0WuKrBVpXw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*iuYH5LpKOjWY0WuKrBVpXw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*iuYH5LpKOjWY0WuKrBVpXw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*iuYH5LpKOjWY0WuKrBVpXw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*iuYH5LpKOjWY0WuKrBVpXw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*iuYH5LpKOjWY0WuKrBVpXw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*iuYH5LpKOjWY0WuKrBVpXw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pj c" width="700" height="115" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pk ff pl ow ox pm pn bf b bg z du">Code calling a given phone number (USSD)</figcaption></figure><h1 id="23f5" class="nm nn gu bf no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj bk">SMS component</h1><p id="c5ae" class="pw-post-body-paragraph mg mh gu mi b mj ok ml mm mn ol mp mq mr om mt mu mv on mx my mz oo nb nc nd gn bk">The bot has the capability to spy on incoming SMS and report the messages to the C&amp;C. This feature is quite common in malware, and performed by reading the incoming PDU — as usual.</p><p id="2e2f" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The bot can also be instructed to send SMS specified by the “sms” command. The SMS is sent using the common <code class="cx oq or os ot b">sendTextMessage</code> API.</p><pre class="oz pa pb pc pd pz ot qa qb ay qc bk"><span id="88be" class="qd nn gu ot b ij qe qf l qg qh">this.sendSms(command.get(&quot;id&quot;).toString(), command.get(&quot;phone_number&quot;).getString(), command.get(&quot;message&quot;).getString()); // calls sendTextMessage</span></pre><h1 id="6d1a" class="nm nn gu bf no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj bk">Unsure / Do you know why? Contact me!</h1><p id="c6ec" class="pw-post-body-paragraph mg mh gu mi b mj ok ml mm mn ol mp mq mr om mt mu mv on mx my mz oo nb nc nd gn bk">When <code class="cx oq or os ot b">prem_flag</code> is set, the bot sends a SMS to notify a new victim has “registered” to the botnet. The SMS is sent to phone number “0001”, which is strange because it should not correspond to anything. Unless there is a trick with SMS filtering.</p><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div role="button" tabindex="0" class="pf pg fj ph bh pi"><div class="ow ox qp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*XNOmfBpKxTKaIN5cNpRqBw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*XNOmfBpKxTKaIN5cNpRqBw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*XNOmfBpKxTKaIN5cNpRqBw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*XNOmfBpKxTKaIN5cNpRqBw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*XNOmfBpKxTKaIN5cNpRqBw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*XNOmfBpKxTKaIN5cNpRqBw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XNOmfBpKxTKaIN5cNpRqBw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*XNOmfBpKxTKaIN5cNpRqBw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*XNOmfBpKxTKaIN5cNpRqBw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*XNOmfBpKxTKaIN5cNpRqBw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*XNOmfBpKxTKaIN5cNpRqBw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*XNOmfBpKxTKaIN5cNpRqBw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*XNOmfBpKxTKaIN5cNpRqBw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*XNOmfBpKxTKaIN5cNpRqBw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pj c" width="700" height="37" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pk ff pl ow ox pm pn bf b bg z du">Code in com.pmmynubv.nommztx.bot.components.h.k</figcaption></figure><p id="2f21" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The sound component implements a lengthy <code class="cx oq or os ot b">onAccessibilityEvent()</code> method which handles events on settings, policy and sound. I have not understood why this is necessary when <code class="cx oq or os ot b">setRingerMode</code> does the job.</p><figure class="oz pa pb pc pd pe ow ox paragraph-image"><div role="button" tabindex="0" class="pf pg fj ph bh pi"><div class="ow ox qq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JmH_MmNMho2oIF7--SRBDQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JmH_MmNMho2oIF7--SRBDQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JmH_MmNMho2oIF7--SRBDQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JmH_MmNMho2oIF7--SRBDQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JmH_MmNMho2oIF7--SRBDQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JmH_MmNMho2oIF7--SRBDQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JmH_MmNMho2oIF7--SRBDQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*JmH_MmNMho2oIF7--SRBDQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JmH_MmNMho2oIF7--SRBDQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JmH_MmNMho2oIF7--SRBDQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JmH_MmNMho2oIF7--SRBDQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JmH_MmNMho2oIF7--SRBDQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JmH_MmNMho2oIF7--SRBDQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*JmH_MmNMho2oIF7--SRBDQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pj c" width="700" height="388" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pk ff pl ow ox pm pn bf b bg z du">Code in com.pmmynubv.nommztx.bot.components.g.a</figcaption></figure><p id="5f79" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Finally, in the SMS component (<code class="cx oq or os ot b">com.pmmynubv.nommztx.bot.components.h.a</code>), it is not clear why the bot also implements sending SMS by abusing the SMS application and automatically clicking through the nodes — when <code class="cx oq or os ot b">sendTextMessage</code> does the job in far less lines of code 😏</p><p id="0441" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">— the Crypto Girl</p></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="qr qs ab iv"><div class="qt ab"><a class="qu ay am ao" href="https://medium.com/tag/android-malware?source=post_page-----61febabed00a--------------------------------" rel="noopener follow"><div class="qv fj cx qw ge qx qy bf b bg z bk qz">Android Malware</div></a></div><div class="qt ab"><a class="qu ay am ao" href="https://medium.com/tag/reverse-engineering?source=post_page-----61febabed00a--------------------------------" rel="noopener follow"><div class="qv fj cx qw ge qx qy bf b bg z bk qz">Reverse Engineering</div></a></div><div class="qt ab"><a class="qu ay am ao" href="https://medium.com/tag/botnet?source=post_page-----61febabed00a--------------------------------" rel="noopener follow"><div class="qv fj cx qw ge qx qy bf b bg z bk qz">Botnet</div></a></div></div></div></div><div class="l"></div><footer class="ra rb rc rd re ab q rf rg c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp rh"><div class="ab q ke"><div class="ri l"><span class="l rj rk rl e d"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F61febabed00a&amp;operation=register&amp;redirect=https%3A%2F%2Fcryptax.medium.com%2Fandroid-bianlian-payload-61febabed00a&amp;user=%40cryptax&amp;userId=a035bab39b50&amp;source=---footer_actions--61febabed00a---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span><span class="l h g f rm rn"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F61febabed00a&amp;operation=register&amp;redirect=https%3A%2F%2Fcryptax.medium.com%2Fandroid-bianlian-payload-61febabed00a&amp;user=%40cryptax&amp;userId=a035bab39b50&amp;source=---footer_actions--61febabed00a---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="ro l is"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F61febabed00a&amp;operation=register&amp;redirect=https%3A%2F%2Fcryptax.medium.com%2Fandroid-bianlian-payload-61febabed00a&amp;source=---footer_actions--61febabed00a---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="ro l is"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="rp rq rr rs rt l"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ru bh r rv"></div><div class="ab rw rx ry iu it"><div class="rz sa sb sc sd se sf sg sh si ab cp"><div class="h k"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--61febabed00a--------------------------------"><div class="l fj"><img alt="@cryptax" class="l fd by ic ib cx" src="https://miro.medium.com/v2/resize:fill:96:96/2*iP0un-qdsQTJBsjGeUfyqg.png" width="48" height="48" loading="lazy"/><div class="fr by l ic ib fs n ay sj"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--61febabed00a--------------------------------"><div class="l fj"><img alt="@cryptax" class="l fd by sk sl cx" src="https://miro.medium.com/v2/resize:fill:128:128/2*iP0un-qdsQTJBsjGeUfyqg.png" width="64" height="64" loading="lazy"/><div class="fr by l sk sl fs n ay sj"></div></div></a></div><div class="j i d sm is"><div class="ab"><span><button class="bf b bg z sn qv so sp sq sr ss ev ew st su sv fa fb fc fd bm fe ff">Follow</button></span></div></div></div><div class="ab co sw"><div class="sx sy sz ta tb l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/?source=post_page---post_author_info--61febabed00a--------------------------------"><h2 class="pw-author-name bf td te tf tg th ti tj mr tk tl mv tm tn mz to tp bk"><span class="gn tc">Written by <!-- -->@cryptax</span></h2></a><div class="qt ab ia"><div class="l is"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/followers?source=post_page---post_author_info--61febabed00a--------------------------------">335 Followers</a></span></div><div class="bf b bg z du ab qg"><span class="im l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/following?source=post_page---post_author_info--61febabed00a--------------------------------">6 Following</a></div></div><div class="tq l"><p class="bf b bg z bk"><span class="gn">Mobile and IoT malware researcher. The postings on this account are solely my own opinion and do not represent my employer.</span></p></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z sn qv so sp sq sr ss ev ew st su sv fa fb fc fd bm fe ff">Follow</button></span></div></div></div></div></div></div><div class="tr l"><div class="ru bh r ts tt tu tv tw"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab q cp"><h2 class="bf td np nr ns nt nv nw nx nz oa ob od oe of oh oi bk">No responses yet</h2><div class="ab tx"><div><div class="bm" aria-hidden="false"><a class="ty tz" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--61febabed00a--------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="ua ub uc ud ue l"></div></div></div></div><div class="uf ug uh ui uj l bx"><div class="h k j"><div class="ru bh uk ul"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="um ab ke iv"><div class="un uo l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----61febabed00a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="un uo l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----61febabed00a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="un uo l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----61febabed00a--------------------------------" rel="noopener follow"><p class="bf b dv z du">About</p></a></div><div class="un uo l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----61febabed00a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Careers</p></a></div><div class="un uo l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----61febabed00a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="un uo l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----61febabed00a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="un uo l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----61febabed00a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="un uo l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----61febabed00a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="un uo l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----61febabed00a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="un l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----61febabed00a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241216-164309-0d4958d8a6"</script><script>window.__GRAPHQL_URI__ = "https://cryptax.medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-61febabed00a","user-a035bab39b50"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"USER","id":"a035bab39b50","explicit":true},"viewerIsBot":false},"debug":{"requestId":"ec691a3d-3c12-4b91-999d-e741f3a643bb","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-dac4f36338485797915b95eca9160451-9c807f2848b3ccf6-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fcryptax.medium.com\u002Fandroid-bianlian-payload-61febabed00a","host":"cryptax.medium.com","hostname":"cryptax.medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20241216-164309-0d4958d8a6","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241216-164309-0d4958d8a6","commit":"0d4958d8a6e728d0bc7ba6245eaad002411a6eb7"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"cryptax.medium.com\"})":null,"postResult({\"id\":\"61febabed00a\"})":{"__ref":"Post:61febabed00a"}},"LinkedAccounts:a035bab39b50":{"__typename":"LinkedAccounts","mastodon":null,"id":"a035bab39b50"},"User:a035bab39b50":{"__typename":"User","id":"a035bab39b50","linkedAccounts":{"__ref":"LinkedAccounts:a035bab39b50"},"isSuspended":false,"name":"@cryptax","imageId":"2*iP0un-qdsQTJBsjGeUfyqg.png","customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"cryptax.medium.com"}},"hasSubdomain":true,"username":"cryptax","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":335,"followingCount":6,"collectionFollowingCount":0},"bio":"Mobile and IoT malware researcher. The postings on this account are solely my own opinion and do not represent my employer.","membership":null,"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:a035bab39b50-viewerId:lo_a5038fb17b58"},"twitterScreenName":"cryptax"},"Topic:d4e7f4144ac5":{"__typename":"Topic","slug":"cybersecurity","id":"d4e7f4144ac5","name":"Cybersecurity"},"Paragraph:3ab4ac19a3f6_0":{"__typename":"Paragraph","id":"3ab4ac19a3f6_0","name":"c014","type":"H3","href":null,"layout":null,"metadata":null,"text":"Android\u002FBianLian payload","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_1":{"__typename":"Paragraph","id":"3ab4ac19a3f6_1","name":"ffdd","type":"P","href":null,"layout":null,"metadata":null,"text":"In the previous article, we discussed the packing mechanism of a Bian Lian sample, and how to unpack. This article reverse engineers the payload of the malware. It explains:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_2":{"__typename":"Paragraph","id":"3ab4ac19a3f6_2","name":"b203","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The malicious components the bot implements. Those components can be seen as independent modules, and they are launched at the beginning. Each of them do their job, handle accessibility events which concern and notifies or responds to the C&C. The implementation is clearly organized to easily welcome future modules.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":77,"end":96,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_3":{"__typename":"Paragraph","id":"3ab4ac19a3f6_3","name":"c1ca","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The communication between the C&C and the bot. The bot understands and responds to several commands. The commands are implemented in the relevant component. The communication protocol is fairly simple: over HTTP (not HTTPS), with a plaintext JSON object as data (no encryption).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":4,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_4":{"__typename":"Paragraph","id":"3ab4ac19a3f6_4","name":"6304","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The implementation of each major component.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":4,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_5":{"__typename":"Paragraph","id":"3ab4ac19a3f6_5","name":"e419","type":"H3","href":null,"layout":null,"metadata":null,"text":"Three DEXes","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_6":{"__typename":"Paragraph","id":"3ab4ac19a3f6_6","name":"dc2a","type":"P","href":null,"layout":null,"metadata":null,"text":"To be precise, note the Bian Lian we discuss uses three different DEX:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_7":{"__typename":"Paragraph","id":"3ab4ac19a3f6_7","name":"485d","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The main APK’s DEX — which is responsible for decrypting and loading via multidex the second DEX. For reminder, the APK’s sha256 is 5b9049c392eaf83b12b98419f14ece1b00042592b003a17e4e6f0fb466281368","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":132,"end":196,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_8":{"__typename":"Paragraph","id":"3ab4ac19a3f6_8","name":"ed8a","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The second DEX — which implements the malicious payload of the bot. This is what we discuss in this article. Its sha256 is d0d704ace35b0190174c11efa3fef292e026391677ff9dc10d2783b4cfe7f961","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":123,"end":187,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_9":{"__typename":"Paragraph","id":"3ab4ac19a3f6_9","name":"10a4","type":"OLI","href":null,"layout":null,"metadata":null,"text":"A third DEX. It is downloaded by the second DEX from the remote C&C, but is not interesting for the analysis of the malware because it only contains non-malicious utility functions. Its package name is com.fbdev.payload.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":202,"end":219,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_10":{"__typename":"Paragraph","id":"3ab4ac19a3f6_10","name":"2e21","type":"H3","href":null,"layout":null,"metadata":null,"text":"Reverse engineer is loooong","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_11":{"__typename":"Paragraph","id":"3ab4ac19a3f6_11","name":"2c7f","type":"P","href":null,"layout":null,"metadata":null,"text":"This reverse engineering took me several days. Actually, between unpacking, reverse engineering and writing the blog, it approximately took me 2 weeks! I am not particularly proud about it, but I often get the question “whow, how long did it take you?” and although I’d love to appear extremely skilled, the reality is that reverse engineering is a long process. It can be compared to puzzles or a plate of spaghetti: at first, you don’t know where to start, you follow a path and often get lost in the middle and soon don’t exactly know what you were searching for 😄","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":33,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":143,"end":150,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_12":{"__typename":"Paragraph","id":"3ab4ac19a3f6_12","name":"e2a9","type":"P","href":null,"layout":null,"metadata":null,"text":"Consequently, I am sharing my JEB project (which contains all the functions I renamed, my comments etc): you can download it here.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":105,"end":129,"href":"https:\u002F\u002Fmy.owndrive.com\u002Fs\u002Fzz48eoiePNoKKYW","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_13":{"__typename":"Paragraph","id":"3ab4ac19a3f6_13","name":"10c0","type":"P","href":null,"layout":null,"metadata":null,"text":"Also, the article ends with a few remaining questions on the reverse engineering of the sample. You are welcome to interact if you have an idea.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":44,"end":53,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_14":{"__typename":"Paragraph","id":"3ab4ac19a3f6_14","name":"8df6","type":"P","href":null,"layout":null,"metadata":null,"text":"Now, let’s start!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_15":{"__typename":"Paragraph","id":"3ab4ac19a3f6_15","name":"4d3a","type":"H3","href":null,"layout":null,"metadata":null,"text":"Overview of malicious components","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_16":{"__typename":"Paragraph","id":"3ab4ac19a3f6_16","name":"a4ab","type":"P","href":null,"layout":null,"metadata":null,"text":"This malware is a bot, which reports and receives commands from a remote server (C&C). It implements several malicious components:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":18,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_17":{"__typename":"Paragraph","id":"3ab4ac19a3f6_17","name":"ea23","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Bulk SMS. The attacker specifies the body of a SMS to send, and it is sent to all contacts of the victim’s smartphone.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_18":{"__typename":"Paragraph","id":"3ab4ac19a3f6_18","name":"5ce3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Inject. The attacker provides an image to download from the web and inject (overlay) on a given list of apps.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_19":{"__typename":"Paragraph","id":"3ab4ac19a3f6_19","name":"f3a3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Install Apps. The attacker specifies a list of applications to install on the phone.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_20":{"__typename":"Paragraph","id":"3ab4ac19a3f6_20","name":"5f2b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Locker. This disables the ringer, and displays a text taken randomly from a pool of possible messages.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_21":{"__typename":"Paragraph","id":"3ab4ac19a3f6_21","name":"8a64","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Notification Disabler. Disables notifications of given applications.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_22":{"__typename":"Paragraph","id":"3ab4ac19a3f6_22","name":"2050","type":"ULI","href":null,"layout":null,"metadata":null,"text":"PIN code. Steals the lock PIN code for some phone brands. The sample we analyze supports Samsung and Huawei.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_23":{"__typename":"Paragraph","id":"3ab4ac19a3f6_23","name":"a669","type":"ULI","href":null,"layout":null,"metadata":null,"text":"SMS. This is to send specific SMS messages. The attacker specifies the body and phone number to send to.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_24":{"__typename":"Paragraph","id":"3ab4ac19a3f6_24","name":"e72a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Screencast. Takes screenshots of given applications.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_25":{"__typename":"Paragraph","id":"3ab4ac19a3f6_25","name":"ffa0","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Sound switch. Turn ringer on or off.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_26":{"__typename":"Paragraph","id":"3ab4ac19a3f6_26","name":"47a7","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Team viewer. The Team Viewer app is a well known non-malicious app to access your smartphone from any other computer. Here, the attacker uses it to access the victim’s smartphone remotely.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":17,"end":32,"href":"https:\u002F\u002Fplay.google.com\u002Fstore\u002Fapps\u002Fdetails?id=com.teamviewer.host.market","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_27":{"__typename":"Paragraph","id":"3ab4ac19a3f6_27","name":"05b1","type":"ULI","href":null,"layout":null,"metadata":null,"text":"USSD. The attacker specifies the premium phone number to call. For the victim, this may result in extra cost, depending on his\u002Fher subscription.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_28":{"__typename":"Paragraph","id":"3ab4ac19a3f6_28","name":"0427","type":"H3","href":null,"layout":null,"metadata":null,"text":"Communication with the C&C","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_29":{"__typename":"Paragraph","id":"3ab4ac19a3f6_29","name":"d8c4","type":"P","href":null,"layout":null,"metadata":null,"text":"The URL to the remote C&C is found encrypted in the shared preferences file pref_name_setting.xml. The algorithm uses slightly modified XOR algorithm with a hard-coded key derived from the string sorry!need8money[for`food.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":76,"end":97,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":196,"end":221,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*nsVxbv9Ox91J-ZH0VCnBvw.png":{"__typename":"ImageMetadata","id":"1*nsVxbv9Ox91J-ZH0VCnBvw.png","originalHeight":138,"originalWidth":1773,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_30":{"__typename":"Paragraph","id":"3ab4ac19a3f6_30","name":"557d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*nsVxbv9Ox91J-ZH0VCnBvw.png"},"text":"Decrypting the preferences entry “admin_panel_url_”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*wkknoCQVGdCgH-Qh6MYPhg.png":{"__typename":"ImageMetadata","id":"1*wkknoCQVGdCgH-Qh6MYPhg.png","originalHeight":808,"originalWidth":822,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_31":{"__typename":"Paragraph","id":"3ab4ac19a3f6_31","name":"9805","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*wkknoCQVGdCgH-Qh6MYPhg.png"},"text":"The XOR key is composed of characters !8[`. For example “IL\u002Fp:\u002FtrI]:cNT7iDJhQ53iNV]9sHL&gt;” decrypts to hxxp:\u002F\u002Frheacollier31532.website","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":105,"end":135,"href":"http:\u002F\u002Frheacollier31532.websit","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_32":{"__typename":"Paragraph","id":"3ab4ac19a3f6_32","name":"973e","type":"P","href":null,"layout":null,"metadata":null,"text":"The remote attacker and the bot exchange a JSON string, where JSON keys specify actions (or responses) to conduct.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*XUQLZc73T6KkwtvqK7avnA.png":{"__typename":"ImageMetadata","id":"1*XUQLZc73T6KkwtvqK7avnA.png","originalHeight":1613,"originalWidth":1427,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_33":{"__typename":"Paragraph","id":"3ab4ac19a3f6_33","name":"c446","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*XUQLZc73T6KkwtvqK7avnA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*8kDsQShTfjwF9lpq6BN3jQ.png":{"__typename":"ImageMetadata","id":"1*8kDsQShTfjwF9lpq6BN3jQ.png","originalHeight":312,"originalWidth":1413,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_34":{"__typename":"Paragraph","id":"3ab4ac19a3f6_34","name":"dc5c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*8kDsQShTfjwF9lpq6BN3jQ.png"},"text":"List of commands understood by the BianLian bot. The commands are keys within a JSON object, and values specify command arguments. The JSON object is sent or received from the C&C.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*iH5cTMvzDd7I9FAlsvYPDw.png":{"__typename":"ImageMetadata","id":"1*iH5cTMvzDd7I9FAlsvYPDw.png","originalHeight":1258,"originalWidth":1425,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_35":{"__typename":"Paragraph","id":"3ab4ac19a3f6_35","name":"3094","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*iH5cTMvzDd7I9FAlsvYPDw.png"},"text":"List of Bian Lian bot responses to commands.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_36":{"__typename":"Paragraph","id":"3ab4ac19a3f6_36","name":"a507","type":"H3","href":null,"layout":null,"metadata":null,"text":"Malicious injections","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_37":{"__typename":"Paragraph","id":"3ab4ac19a3f6_37","name":"a0d1","type":"P","href":null,"layout":null,"metadata":null,"text":"The bot implements an injection module which overlays attacker chosen images on top of target applications.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_38":{"__typename":"Paragraph","id":"3ab4ac19a3f6_38","name":"64e9","type":"P","href":null,"layout":null,"metadata":null,"text":"First, the bot reports its activity to the C&C. The attacker answers back to the bot with a list of applications it is interested to inject into (see “stockInjects” key):","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*59B3rFNz_T6d5HZraF5Xaw.png":{"__typename":"ImageMetadata","id":"1*59B3rFNz_T6d5HZraF5Xaw.png","originalHeight":723,"originalWidth":1678,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_39":{"__typename":"Paragraph","id":"3ab4ac19a3f6_39","name":"4b64","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*59B3rFNz_T6d5HZraF5Xaw.png"},"text":"In this case, the C&C was interested in many mobile turkish bank apps.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_40":{"__typename":"Paragraph","id":"3ab4ac19a3f6_40","name":"262c","type":"P","href":null,"layout":null,"metadata":null,"text":"The bot searches which of these apps are installed on the victim’s phone and reports the information back to the C&C (see “app_list” key).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*dWmVnBDWzjM673XPgceZqQ.png":{"__typename":"ImageMetadata","id":"1*dWmVnBDWzjM673XPgceZqQ.png","originalHeight":196,"originalWidth":595,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_41":{"__typename":"Paragraph","id":"3ab4ac19a3f6_41","name":"6c27","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*dWmVnBDWzjM673XPgceZqQ.png"},"text":"For example, in this case, the bot notifies the C&C 3 interesting mobile apps are installed.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_42":{"__typename":"Paragraph","id":"3ab4ac19a3f6_42","name":"7cba","type":"P","href":null,"layout":null,"metadata":null,"text":"When an app among this list is launched, the bot requests the C&C an HTML page to overlay.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*z3rM_QFjQqoNCqDRtXOa-g.png":{"__typename":"ImageMetadata","id":"1*z3rM_QFjQqoNCqDRtXOa-g.png","originalHeight":907,"originalWidth":1154,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_43":{"__typename":"Paragraph","id":"3ab4ac19a3f6_43","name":"2919","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*z3rM_QFjQqoNCqDRtXOa-g.png"},"text":"In this network capture, the bot requests an HTML page to display above the bank’s application.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_44":{"__typename":"Paragraph","id":"3ab4ac19a3f6_44","name":"3448","type":"P","href":null,"layout":null,"metadata":null,"text":"From victim’s point of view, everything happens fast and it is not easy to detect something fishy is happening: the victim opens his\u002Fher mobile banking app. S\u002Fhe will perhaps notice a quick screen flickering: this occurs when the bot has downloaded the attacker’s HTML and overlays it on top of the real app. See below an example of overlay.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*S8CQ8Yoda5-0RJ17ytORqA.png":{"__typename":"ImageMetadata","id":"1*S8CQ8Yoda5-0RJ17ytORqA.png","originalHeight":711,"originalWidth":400,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_45":{"__typename":"Paragraph","id":"3ab4ac19a3f6_45","name":"40cb","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*S8CQ8Yoda5-0RJ17ytORqA.png"},"text":"Beware the malicious overlay! This screenshot was taken on an infected Android emulator. If we are cautious, we can spot the trick here because the overlay is not perfect: the real app is running behind (we see the real logo at the top) and the malicious page is overlaid in front. This is actually not an image but an entire HTML page, with hard-coded embedded logo images, layout and JavaScript. The card number, expiration date & CVV are sent back to the C&C.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_46":{"__typename":"Paragraph","id":"3ab4ac19a3f6_46","name":"2db0","type":"H3","href":null,"layout":null,"metadata":null,"text":"Team Viewer component","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_47":{"__typename":"Paragraph","id":"3ab4ac19a3f6_47","name":"f483","type":"P","href":null,"layout":null,"metadata":null,"text":"The bot support “teamViewerOptions” command which triggers the Team Viewer app to remotely access and control the victim’s smartphone. The C&C sends a username and password, and the bot (1) launches the Team Viewer app (if necessary), (2) accepts the EULA displayed by KLMS Agent on Samsung devices (security framework), (3) enters username and password in Team Viewer and (4) finally connects to the remote end.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_48":{"__typename":"Paragraph","id":"3ab4ac19a3f6_48","name":"5add","type":"P","href":null,"layout":null,"metadata":null,"text":"This functionality heavily relies on using (abusing) the Accessibility Service.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*1T7n1pVusmuny73__QKU9w.png":{"__typename":"ImageMetadata","id":"1*1T7n1pVusmuny73__QKU9w.png","originalHeight":1033,"originalWidth":1571,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_49":{"__typename":"Paragraph","id":"3ab4ac19a3f6_49","name":"6228","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*1T7n1pVusmuny73__QKU9w.png"},"text":"Decompiled code of the malware’s team viewer component. The Accessibility Service is used to see which node\u002Fview is currently displayed, locate the relevant button and automatically click on it. Team Viewer is automatically configured by automatically entering username\u002Fpassword inside the right text views of the application.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*mWbQxUmD6ktdKBD3xHaaqg.png":{"__typename":"ImageMetadata","id":"1*mWbQxUmD6ktdKBD3xHaaqg.png","originalHeight":533,"originalWidth":300,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_50":{"__typename":"Paragraph","id":"3ab4ac19a3f6_50","name":"304d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*mWbQxUmD6ktdKBD3xHaaqg.png"},"text":"To abuse Accessibility Services, the malware requests initial permissions. Yes, in theory, an end-user should not click “OK” to such a request, but let’s be honest, there are many pop-ups on a smartphone & it’s not always clear to the end-user what they are authorizing. That’s how we end up with an infected smartphone…","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_51":{"__typename":"Paragraph","id":"3ab4ac19a3f6_51","name":"420b","type":"H3","href":null,"layout":null,"metadata":null,"text":"Disabling notifications","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_52":{"__typename":"Paragraph","id":"3ab4ac19a3f6_52","name":"04f8","type":"P","href":null,"layout":null,"metadata":null,"text":"The C&C sends a command “disabledPackages” with a list of package names to disable notifications for. The bot processes those packages one by one, launches the notification settings panel and uses the Accessibility Service API to ensure the notification switch for the app is turned off.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*iekTdr62Ut44oyD-U--BdA.png":{"__typename":"ImageMetadata","id":"1*iekTdr62Ut44oyD-U--BdA.png","originalHeight":809,"originalWidth":1595,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_53":{"__typename":"Paragraph","id":"3ab4ac19a3f6_53","name":"374e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*iekTdr62Ut44oyD-U--BdA.png"},"text":"This is the part of the bot’s code that disables notification for an app. The bot opens the notification settings for a given app. At this point, the method above gets called. It checks whether the notification switch is already checked or not. If checked, it unchecks it. If not checked, it leaves it unchecked and continues to the next app.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_54":{"__typename":"Paragraph","id":"3ab4ac19a3f6_54","name":"ec34","type":"H3","href":null,"layout":null,"metadata":null,"text":"Screencast component","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_55":{"__typename":"Paragraph","id":"3ab4ac19a3f6_55","name":"8e1e","type":"P","href":null,"layout":null,"metadata":null,"text":"The C&C may also send a “showScreen” which is implemented by the Screencast component of the bot.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_56":{"__typename":"Paragraph","id":"3ab4ac19a3f6_56","name":"3660","type":"P","href":null,"layout":null,"metadata":null,"text":"First of all, if the device is locked, the bot broadcasts a swipe action to unlock.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_57":{"__typename":"Paragraph","id":"3ab4ac19a3f6_57","name":"4377","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Intent intent = new Intent(InjAccessibilityService.broadcast_swipe_unlock);  \u002F\u002F \"broadcast_swipe_to_unlock_action\"\nintent.putExtra(\"task\", 669);\nContext.this.sendBroadcast(intent);\n","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_58":{"__typename":"Paragraph","id":"3ab4ac19a3f6_58","name":"0256","type":"P","href":null,"layout":null,"metadata":null,"text":"Then, it starts an activity that initiates screen capture.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_59":{"__typename":"Paragraph","id":"3ab4ac19a3f6_59","name":"5e6f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"if(!this.active && this.mediaprojectmgr != null) {   activity.startActivityForResult(this.mediaprojectmgr.createScreenCaptureIntent(), 0x1E240);  ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_60":{"__typename":"Paragraph","id":"3ab4ac19a3f6_60","name":"bbc6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_61":{"__typename":"Paragraph","id":"3ab4ac19a3f6_61","name":"8ef5","type":"P","href":null,"layout":null,"metadata":null,"text":"This should normally prompt the end user if s\u002Fhe accepts screen capture: the bot handles this and automatically accepts it on user’s behalf.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*y8R7SBaRYsNcX0e80tVNNQ.png":{"__typename":"ImageMetadata","id":"1*y8R7SBaRYsNcX0e80tVNNQ.png","originalHeight":598,"originalWidth":1822,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_62":{"__typename":"Paragraph","id":"3ab4ac19a3f6_62","name":"5008","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*y8R7SBaRYsNcX0e80tVNNQ.png"},"text":"When a screen capture is requested, the system normally displays a system UI pop-up asking for confirmation. The code above checks this is the confirmation pop-up, that it requests screen capture for the Video Player (the sample poses as a Video Player app) and automatically confirms & remembers the choice.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_63":{"__typename":"Paragraph","id":"3ab4ac19a3f6_63","name":"d3d3","type":"P","href":null,"layout":null,"metadata":null,"text":"When a screenshot is ready, it is sent to the C&C in base64 format.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*qLfLtnmB13hVQDQzXOcbPA.png":{"__typename":"ImageMetadata","id":"1*qLfLtnmB13hVQDQzXOcbPA.png","originalHeight":397,"originalWidth":1416,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_64":{"__typename":"Paragraph","id":"3ab4ac19a3f6_64","name":"a3df","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*qLfLtnmB13hVQDQzXOcbPA.png"},"text":"Encode bitmap in Base64 and send it to C&C. If upload fails, stop screen cast service.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_65":{"__typename":"Paragraph","id":"3ab4ac19a3f6_65","name":"44f7","type":"P","href":null,"layout":null,"metadata":null,"text":"Unless an error occurs, a new screenshot will be taken in a second. This can get pretty intensive and slow down the phone, which probably explains why the bot displays a fake notification saying the phone is currently updating Google Play!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_66":{"__typename":"Paragraph","id":"3ab4ac19a3f6_66","name":"a109","type":"PRE","href":null,"layout":null,"metadata":null,"text":"this.startForeground(0x74A, new Notification.Builder(this.getApplicationContext()).setContentTitle(\"Google\").setContentText(\"Update Google Play Service\").setSmallIcon(0x7F050001).setProgress(0, 100, true).build());","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_67":{"__typename":"Paragraph","id":"3ab4ac19a3f6_67","name":"2d61","type":"H3","href":null,"layout":null,"metadata":null,"text":"Locker component","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_68":{"__typename":"Paragraph","id":"3ab4ac19a3f6_68","name":"596b","type":"P","href":null,"layout":null,"metadata":null,"text":"When the bot receives the “locked” command with a flag set to True, it sets the ringer to silent mode and displays an activity meant to have the victim believe a recovery is under progress. The displayed messages are initially the following:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_69":{"__typename":"Paragraph","id":"3ab4ac19a3f6_69","name":"4d32","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Android system corrupted files recovery \u003C3e\u003E\nKernel version 2.1.0.3\nDO NOT TURN THE SYSTEM OFF","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_70":{"__typename":"Paragraph","id":"3ab4ac19a3f6_70","name":"9f9c","type":"P","href":null,"layout":null,"metadata":null,"text":"The mechanism to lock the device is simple: the message is displayed full screen, without navigation buttons, and the bot prevents any window focus change. This results in the user being locked on the given screen.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":69,"end":80,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":117,"end":154,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_71":{"__typename":"Paragraph","id":"3ab4ac19a3f6_71","name":"1897","type":"PRE","href":null,"layout":null,"metadata":null,"text":"private void fullScreen() {\n  this.getWindow().getDecorView().setSystemUiVisibility(0xF06); \u002F\u002F SYSTEM_UI_FLAG_FULLSCREEN=4 | SYSTEM_UI_FLAG_HIDE_NAVIGATION=2\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_72":{"__typename":"Paragraph","id":"3ab4ac19a3f6_72","name":"d93a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"public void onWindowFocusChanged(boolean arg5) {      \n  super.onWindowFocusChanged(arg5);\n  if(arg5) {\n    this.fullScreen();\n  }\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_73":{"__typename":"Paragraph","id":"3ab4ac19a3f6_73","name":"0bac","type":"P","href":null,"layout":null,"metadata":null,"text":"When the C&C sends a “locked” command with flag to False, the bot simply kills the locking activity and the victim may resume its usage of the phone.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_74":{"__typename":"Paragraph","id":"3ab4ac19a3f6_74","name":"844b","type":"H3","href":null,"layout":null,"metadata":null,"text":"PIN code component","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_75":{"__typename":"Paragraph","id":"3ab4ac19a3f6_75","name":"234a","type":"P","href":null,"layout":null,"metadata":null,"text":"When the bot receives a “action_request_pin” command, it tries to steal the victim’s PIN. Depending on the device, it asks the victim to set a new password and steals it by monitoring the Accessibility API, or it steals the current PIN by overlaying a fake PIN code request window.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_76":{"__typename":"Paragraph","id":"3ab4ac19a3f6_76","name":"ebe4","type":"P","href":null,"layout":null,"metadata":null,"text":"If the C&C provides a “approvedPin” command, the bot will additionally try to modify the current PIN with the new value selected by the C&C.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ggEP1Yw3lLFoU_looJtYpw.png":{"__typename":"ImageMetadata","id":"1*ggEP1Yw3lLFoU_looJtYpw.png","originalHeight":772,"originalWidth":1405,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_77":{"__typename":"Paragraph","id":"3ab4ac19a3f6_77","name":"b624","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ggEP1Yw3lLFoU_looJtYpw.png"},"text":"Task of the PIN code component","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_78":{"__typename":"Paragraph","id":"3ab4ac19a3f6_78","name":"7951","type":"H3","href":null,"layout":null,"metadata":null,"text":"Install component","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_79":{"__typename":"Paragraph","id":"3ab4ac19a3f6_79","name":"db44","type":"P","href":null,"layout":null,"metadata":null,"text":"The C&C may send a list of apps to install via command “apks”. The applications are downloaded from a URL specified in the command. The installation is performed by abusing the Accessibility API. The code is quite lengthy because there are many cases: check the event occurs in the system installer, if the app installer occurs in an alert dialog then automatically click to install. If the system is requesting permission to install from an external source, authorize it etc.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*kqNxKS7jGNh_9_lfsCG3BQ.png":{"__typename":"ImageMetadata","id":"1*kqNxKS7jGNh_9_lfsCG3BQ.png","originalHeight":334,"originalWidth":1384,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_80":{"__typename":"Paragraph","id":"3ab4ac19a3f6_80","name":"c47d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*kqNxKS7jGNh_9_lfsCG3BQ.png"},"text":"Automatically authorizing install of APKs from external sources","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_81":{"__typename":"Paragraph","id":"3ab4ac19a3f6_81","name":"af14","type":"P","href":null,"layout":null,"metadata":null,"text":"The same component also deals with removal of applications. The command names are misleading “remove_all” uninstalls only Team Viewer, and “remove_by_id” removes a specified app. If the package name is “bot”, then the bot removes itself. A self “cleaning” command!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*s8bdiFa5y9UMMc_7HfsFEg.png":{"__typename":"ImageMetadata","id":"1*s8bdiFa5y9UMMc_7HfsFEg.png","originalHeight":612,"originalWidth":1382,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_82":{"__typename":"Paragraph","id":"3ab4ac19a3f6_82","name":"c89e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*s8bdiFa5y9UMMc_7HfsFEg.png"},"text":"Processing C&C commands to delete applications","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_83":{"__typename":"Paragraph","id":"3ab4ac19a3f6_83","name":"c03e","type":"H3","href":null,"layout":null,"metadata":null,"text":"Sound component","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_84":{"__typename":"Paragraph","id":"3ab4ac19a3f6_84","name":"1efd","type":"P","href":null,"layout":null,"metadata":null,"text":"The C&C may turn on or off the ringer via command “soundEnabled” followed by a boolean. Turning the ringer on \u002F off is performed simply by a call to setRingerMode.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":149,"end":162,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_85":{"__typename":"Paragraph","id":"3ab4ac19a3f6_85","name":"313b","type":"H3","href":null,"layout":null,"metadata":null,"text":"USSD component","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_86":{"__typename":"Paragraph","id":"3ab4ac19a3f6_86","name":"eba9","type":"P","href":null,"layout":null,"metadata":null,"text":"The bot may be instructed to call USSD (quick codes). For instance, we see it requests *101# which returns the current subscription rate.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*iuYH5LpKOjWY0WuKrBVpXw.png":{"__typename":"ImageMetadata","id":"1*iuYH5LpKOjWY0WuKrBVpXw.png","originalHeight":267,"originalWidth":1630,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_87":{"__typename":"Paragraph","id":"3ab4ac19a3f6_87","name":"ee61","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*iuYH5LpKOjWY0WuKrBVpXw.png"},"text":"Code calling a given phone number (USSD)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_88":{"__typename":"Paragraph","id":"3ab4ac19a3f6_88","name":"23f5","type":"H3","href":null,"layout":null,"metadata":null,"text":"SMS component","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_89":{"__typename":"Paragraph","id":"3ab4ac19a3f6_89","name":"c5ae","type":"P","href":null,"layout":null,"metadata":null,"text":"The bot has the capability to spy on incoming SMS and report the messages to the C&C. This feature is quite common in malware, and performed by reading the incoming PDU — as usual.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_90":{"__typename":"Paragraph","id":"3ab4ac19a3f6_90","name":"2e2f","type":"P","href":null,"layout":null,"metadata":null,"text":"The bot can also be instructed to send SMS specified by the “sms” command. The SMS is sent using the common sendTextMessage API.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":108,"end":123,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_91":{"__typename":"Paragraph","id":"3ab4ac19a3f6_91","name":"88be","type":"PRE","href":null,"layout":null,"metadata":null,"text":"this.sendSms(command.get(\"id\").toString(), command.get(\"phone_number\").getString(), command.get(\"message\").getString()); \u002F\u002F calls sendTextMessage","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_92":{"__typename":"Paragraph","id":"3ab4ac19a3f6_92","name":"6d1a","type":"H3","href":null,"layout":null,"metadata":null,"text":"Unsure \u002F Do you know why? Contact me!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_93":{"__typename":"Paragraph","id":"3ab4ac19a3f6_93","name":"c6ec","type":"P","href":null,"layout":null,"metadata":null,"text":"When prem_flag is set, the bot sends a SMS to notify a new victim has “registered” to the botnet. The SMS is sent to phone number “0001”, which is strange because it should not correspond to anything. Unless there is a trick with SMS filtering.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":5,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*XNOmfBpKxTKaIN5cNpRqBw.png":{"__typename":"ImageMetadata","id":"1*XNOmfBpKxTKaIN5cNpRqBw.png","originalHeight":72,"originalWidth":1370,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_94":{"__typename":"Paragraph","id":"3ab4ac19a3f6_94","name":"d922","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*XNOmfBpKxTKaIN5cNpRqBw.png"},"text":"Code in com.pmmynubv.nommztx.bot.components.h.k","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_95":{"__typename":"Paragraph","id":"3ab4ac19a3f6_95","name":"2f21","type":"P","href":null,"layout":null,"metadata":null,"text":"The sound component implements a lengthy onAccessibilityEvent() method which handles events on settings, policy and sound. I have not understood why this is necessary when setRingerMode does the job.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":41,"end":63,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":172,"end":185,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*JmH_MmNMho2oIF7--SRBDQ.png":{"__typename":"ImageMetadata","id":"1*JmH_MmNMho2oIF7--SRBDQ.png","originalHeight":1162,"originalWidth":2099,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:3ab4ac19a3f6_96":{"__typename":"Paragraph","id":"3ab4ac19a3f6_96","name":"fa8c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*JmH_MmNMho2oIF7--SRBDQ.png"},"text":"Code in com.pmmynubv.nommztx.bot.components.g.a","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_97":{"__typename":"Paragraph","id":"3ab4ac19a3f6_97","name":"5f79","type":"P","href":null,"layout":null,"metadata":null,"text":"Finally, in the SMS component (com.pmmynubv.nommztx.bot.components.h.a), it is not clear why the bot also implements sending SMS by abusing the SMS application and automatically clicking through the nodes — when sendTextMessage does the job in far less lines of code 😏","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":31,"end":70,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":212,"end":227,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:3ab4ac19a3f6_98":{"__typename":"Paragraph","id":"3ab4ac19a3f6_98","name":"0441","type":"P","href":null,"layout":null,"metadata":null,"text":"— the Crypto Girl","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"UserViewerEdge:userId:a035bab39b50-viewerId:lo_a5038fb17b58":{"__typename":"UserViewerEdge","id":"userId:a035bab39b50-viewerId:lo_a5038fb17b58","isMuting":false},"PostViewerEdge:postId:61febabed00a-viewerId:lo_a5038fb17b58":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:61febabed00a-viewerId:lo_a5038fb17b58"},"Tag:android-malware":{"__typename":"Tag","id":"android-malware","displayTitle":"Android Malware","normalizedTagSlug":"android-malware"},"Tag:reverse-engineering":{"__typename":"Tag","id":"reverse-engineering","displayTitle":"Reverse Engineering","normalizedTagSlug":"reverse-engineering"},"Tag:botnet":{"__typename":"Tag","id":"botnet","displayTitle":"Botnet","normalizedTagSlug":"botnet"},"Post:61febabed00a":{"__typename":"Post","id":"61febabed00a","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"468e","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:3ab4ac19a3f6_0"},{"__ref":"Paragraph:3ab4ac19a3f6_1"},{"__ref":"Paragraph:3ab4ac19a3f6_2"},{"__ref":"Paragraph:3ab4ac19a3f6_3"},{"__ref":"Paragraph:3ab4ac19a3f6_4"},{"__ref":"Paragraph:3ab4ac19a3f6_5"},{"__ref":"Paragraph:3ab4ac19a3f6_6"},{"__ref":"Paragraph:3ab4ac19a3f6_7"},{"__ref":"Paragraph:3ab4ac19a3f6_8"},{"__ref":"Paragraph:3ab4ac19a3f6_9"},{"__ref":"Paragraph:3ab4ac19a3f6_10"},{"__ref":"Paragraph:3ab4ac19a3f6_11"},{"__ref":"Paragraph:3ab4ac19a3f6_12"},{"__ref":"Paragraph:3ab4ac19a3f6_13"},{"__ref":"Paragraph:3ab4ac19a3f6_14"},{"__ref":"Paragraph:3ab4ac19a3f6_15"},{"__ref":"Paragraph:3ab4ac19a3f6_16"},{"__ref":"Paragraph:3ab4ac19a3f6_17"},{"__ref":"Paragraph:3ab4ac19a3f6_18"},{"__ref":"Paragraph:3ab4ac19a3f6_19"},{"__ref":"Paragraph:3ab4ac19a3f6_20"},{"__ref":"Paragraph:3ab4ac19a3f6_21"},{"__ref":"Paragraph:3ab4ac19a3f6_22"},{"__ref":"Paragraph:3ab4ac19a3f6_23"},{"__ref":"Paragraph:3ab4ac19a3f6_24"},{"__ref":"Paragraph:3ab4ac19a3f6_25"},{"__ref":"Paragraph:3ab4ac19a3f6_26"},{"__ref":"Paragraph:3ab4ac19a3f6_27"},{"__ref":"Paragraph:3ab4ac19a3f6_28"},{"__ref":"Paragraph:3ab4ac19a3f6_29"},{"__ref":"Paragraph:3ab4ac19a3f6_30"},{"__ref":"Paragraph:3ab4ac19a3f6_31"},{"__ref":"Paragraph:3ab4ac19a3f6_32"},{"__ref":"Paragraph:3ab4ac19a3f6_33"},{"__ref":"Paragraph:3ab4ac19a3f6_34"},{"__ref":"Paragraph:3ab4ac19a3f6_35"},{"__ref":"Paragraph:3ab4ac19a3f6_36"},{"__ref":"Paragraph:3ab4ac19a3f6_37"},{"__ref":"Paragraph:3ab4ac19a3f6_38"},{"__ref":"Paragraph:3ab4ac19a3f6_39"},{"__ref":"Paragraph:3ab4ac19a3f6_40"},{"__ref":"Paragraph:3ab4ac19a3f6_41"},{"__ref":"Paragraph:3ab4ac19a3f6_42"},{"__ref":"Paragraph:3ab4ac19a3f6_43"},{"__ref":"Paragraph:3ab4ac19a3f6_44"},{"__ref":"Paragraph:3ab4ac19a3f6_45"},{"__ref":"Paragraph:3ab4ac19a3f6_46"},{"__ref":"Paragraph:3ab4ac19a3f6_47"},{"__ref":"Paragraph:3ab4ac19a3f6_48"},{"__ref":"Paragraph:3ab4ac19a3f6_49"},{"__ref":"Paragraph:3ab4ac19a3f6_50"},{"__ref":"Paragraph:3ab4ac19a3f6_51"},{"__ref":"Paragraph:3ab4ac19a3f6_52"},{"__ref":"Paragraph:3ab4ac19a3f6_53"},{"__ref":"Paragraph:3ab4ac19a3f6_54"},{"__ref":"Paragraph:3ab4ac19a3f6_55"},{"__ref":"Paragraph:3ab4ac19a3f6_56"},{"__ref":"Paragraph:3ab4ac19a3f6_57"},{"__ref":"Paragraph:3ab4ac19a3f6_58"},{"__ref":"Paragraph:3ab4ac19a3f6_59"},{"__ref":"Paragraph:3ab4ac19a3f6_60"},{"__ref":"Paragraph:3ab4ac19a3f6_61"},{"__ref":"Paragraph:3ab4ac19a3f6_62"},{"__ref":"Paragraph:3ab4ac19a3f6_63"},{"__ref":"Paragraph:3ab4ac19a3f6_64"},{"__ref":"Paragraph:3ab4ac19a3f6_65"},{"__ref":"Paragraph:3ab4ac19a3f6_66"},{"__ref":"Paragraph:3ab4ac19a3f6_67"},{"__ref":"Paragraph:3ab4ac19a3f6_68"},{"__ref":"Paragraph:3ab4ac19a3f6_69"},{"__ref":"Paragraph:3ab4ac19a3f6_70"},{"__ref":"Paragraph:3ab4ac19a3f6_71"},{"__ref":"Paragraph:3ab4ac19a3f6_72"},{"__ref":"Paragraph:3ab4ac19a3f6_73"},{"__ref":"Paragraph:3ab4ac19a3f6_74"},{"__ref":"Paragraph:3ab4ac19a3f6_75"},{"__ref":"Paragraph:3ab4ac19a3f6_76"},{"__ref":"Paragraph:3ab4ac19a3f6_77"},{"__ref":"Paragraph:3ab4ac19a3f6_78"},{"__ref":"Paragraph:3ab4ac19a3f6_79"},{"__ref":"Paragraph:3ab4ac19a3f6_80"},{"__ref":"Paragraph:3ab4ac19a3f6_81"},{"__ref":"Paragraph:3ab4ac19a3f6_82"},{"__ref":"Paragraph:3ab4ac19a3f6_83"},{"__ref":"Paragraph:3ab4ac19a3f6_84"},{"__ref":"Paragraph:3ab4ac19a3f6_85"},{"__ref":"Paragraph:3ab4ac19a3f6_86"},{"__ref":"Paragraph:3ab4ac19a3f6_87"},{"__ref":"Paragraph:3ab4ac19a3f6_88"},{"__ref":"Paragraph:3ab4ac19a3f6_89"},{"__ref":"Paragraph:3ab4ac19a3f6_90"},{"__ref":"Paragraph:3ab4ac19a3f6_91"},{"__ref":"Paragraph:3ab4ac19a3f6_92"},{"__ref":"Paragraph:3ab4ac19a3f6_93"},{"__ref":"Paragraph:3ab4ac19a3f6_94"},{"__ref":"Paragraph:3ab4ac19a3f6_95"},{"__ref":"Paragraph:3ab4ac19a3f6_96"},{"__ref":"Paragraph:3ab4ac19a3f6_97"},{"__ref":"Paragraph:3ab4ac19a3f6_98"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:a035bab39b50"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fcryptax.medium.com\u002Fandroid-bianlian-payload-61febabed00a","primaryTopic":{"__ref":"Topic:d4e7f4144ac5"},"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isPublished":true,"latestPublishedVersion":"3ab4ac19a3f6","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":1,"allowResponses":true,"isLimitedState":false,"title":"Android\u002FBianLian payload","isSeries":false,"sequence":null,"uniqueSlug":"android-bianlian-payload-61febabed00a","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1642439661887,"readingTime":8.044339622641509,"previewContent":{"__typename":"PreviewContent","subtitle":"In the previous article, we discussed the packing mechanism of a Bian Lian sample, and how to unpack. This article reverse engineers the…"},"previewImage":{"__ref":"ImageMetadata:1*mWbQxUmD6ktdKBD3xHaaqg.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1642439661887,"updatedAt":1642818728846,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:61febabed00a-viewerId:lo_a5038fb17b58"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:android-malware"},{"__ref":"Tag:reverse-engineering"},{"__ref":"Tag:botnet"}],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":1668,"layerCake":3,"responsesLocked":false}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.48bdf878.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.872afbe3.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.a4e221ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.933c1c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.73cb8339.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9898.d9e26c5e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4863.28ab43f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6589.247b1d02.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.0f82ef97.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.8aa8d357.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.2a5e2d95.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.1c286b32.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.60bcefe8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.0350840b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.73a57633.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5794.9e8ff5dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.7749bc66.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.2dc8b1c6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.6565ad5f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.d5e0c2f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.7ad7ca92.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.5a11f4da.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8f3e19496d9464eb',t:'MTczNDUxMzg1NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8f3e19496d9464eb","version":"2024.10.5","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>