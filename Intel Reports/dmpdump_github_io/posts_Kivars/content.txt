<!doctype html><html lang="en" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="China-nexus Kivars Backdoor Uploaded from Taiwan" /><meta property="og:locale" content="en" /><meta name="description" content="On February 22, 2025, MalwareHunterTeam shared a DLL uploaded from Taiwan with hash 1286aa5c73cf2c8058c52271869a5727d71ca5bd4dd0854be970d2a25cb52bf8" /><meta property="og:description" content="On February 22, 2025, MalwareHunterTeam shared a DLL uploaded from Taiwan with hash 1286aa5c73cf2c8058c52271869a5727d71ca5bd4dd0854be970d2a25cb52bf8" /><link rel="canonical" href="https://dmpdump.github.io/posts/Kivars/" /><meta property="og:url" content="https://dmpdump.github.io/posts/Kivars/" /><meta property="og:site_name" content="dmpdump" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-02-24T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="China-nexus Kivars Backdoor Uploaded from Taiwan" /><meta name="twitter:site" content="@G60930953" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-03-01T13:34:52+00:00","datePublished":"2025-02-24T00:00:00+00:00","description":"On February 22, 2025, MalwareHunterTeam shared a DLL uploaded from Taiwan with hash 1286aa5c73cf2c8058c52271869a5727d71ca5bd4dd0854be970d2a25cb52bf8","headline":"China-nexus Kivars Backdoor Uploaded from Taiwan","mainEntityOfPage":{"@type":"WebPage","@id":"https://dmpdump.github.io/posts/Kivars/"},"url":"https://dmpdump.github.io/posts/Kivars/"}</script><title>China-nexus Kivars Backdoor Uploaded from Taiwan | dmpdump</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="dmpdump"><meta name="application-name" content="dmpdump"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/avatar.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">dmpdump</a></h1><p class="site-subtitle fst-italic mb-0">CTI, RE, Programming</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/dmpdump" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/G60930953" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['dmpdump','tuta.io'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>China-nexus Kivars Backdoor Uploaded from Taiwan</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>China-nexus Kivars Backdoor Uploaded from Taiwan</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1740355200" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Feb 24, 2025 </time> </span> <span> Updated <time data-ts="1740836092" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Mar 1, 2025 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/dmpdump">dmpdump</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="915 words" > <em>5 min</em> read</span></div></div></div></header><div class="content"><p>On February 22, 2025, <a href="https://x.com/malwrhunterteam/status/1893295404575297665">MalwareHunterTeam</a> shared a DLL uploaded from Taiwan with hash <code class="language-plaintext highlighter-rouge">1286aa5c73cf2c8058c52271869a5727d71ca5bd4dd0854be970d2a25cb52bf8</code></p><p><a href="/assets/images/kivars/mht.png" class="popup img-link shimmer"><img src="/assets/images/kivars/mht.png" alt="sshot" loading="lazy"></a></p><p>The DLL was uploaded from Taiwan on February 20, 2025:</p><p><a href="/assets/images/kivars/vt.png" class="popup img-link shimmer"><img src="/assets/images/kivars/vt.png" alt="sshot" loading="lazy"></a></p><p>The DLL is a Service DLL that decrypts and loads a backdoor from a .dat file. This loader implements a custom RC4 algorithm to decrypt strings, the payload, and the data sent/received from the command and control. The <code class="language-plaintext highlighter-rouge">ServiceMain</code> function implements the following actions:</p><ul><li>Uses the custom RC4 algorithm to decrypt a key (<code class="language-plaintext highlighter-rouge">026254b890ee4f2c46d3ce6d8d279aef</code>), which is subsequently used to decrypt other strings<li>Decrypts mutex <code class="language-plaintext highlighter-rouge">uni-web-4e9621f</code><li>Initializes the service<li>Creates a new thread to decrypt and load the payload</ul><p><a href="/assets/images/kivars/servicemain.png" class="popup img-link shimmer"><img src="/assets/images/kivars/servicemain.png" alt="sshot" loading="lazy"></a></p><p>The new thread performs the following actions:</p><ul><li>Decrypts the same key as before, with the same custom RC4 algorithm<li>Decrypts the name of the file that contains the encrypted payload: <code class="language-plaintext highlighter-rouge">Windows.damingvUI.GameBar.dat</code><li>Allocates executable memory<li>Reads the .dat file into the newly-allocated memory<li>Decrypts the payload with the custom RC4 algorithm<li>Executes decrypted payload passing pointers to LoadLibrary/GetProcAddress</ul><p><a href="/assets/images/kivars/loader_decryptor.png" class="popup img-link shimmer"><img src="/assets/images/kivars/loader_decryptor.png" alt="sshot" loading="lazy"></a></p><p>Searching for the encrypted payload, I found that a file with that name was uploaded to VirusTotal from Taiwan, also on February 20, 2025:</p><ul><li>File name:<code class="language-plaintext highlighter-rouge">Windows.damingvUI.GameBar.dat</code><li>SHA2: <code class="language-plaintext highlighter-rouge">a0d1e9f6bf6b60c61a381575b319e9e219240200875f434f95320ba139c87be8</code></ul><p><a href="/assets/images/kivars/encfile.png" class="popup img-link shimmer"><img src="/assets/images/kivars/encfile.png" alt="sshot" loading="lazy"></a></p><h1 id="modified-rc4-algorithm">Modified RC4 Algorithm</h1><p>The loader (and the subsequent backdoor) use a slightly modified RC4 algorithm. This modified version of the algorithm uses an additional argument (<code class="language-plaintext highlighter-rouge">a5</code>) that modifies the Pseudo-Random Generation Algorithm (PRGA). This argument changes with each function call.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
</pre><td class="rouge-code"><pre><span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="kr">__fastcall</span> <span class="nf">fn_custom_RC4</span><span class="p">(</span>
        <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="n">encrypted_buff</span><span class="p">,</span>
        <span class="kt">int</span> <span class="n">buff_len</span><span class="p">,</span>
        <span class="n">__int64</span> <span class="n">key</span><span class="p">,</span>
        <span class="kt">int</span> <span class="n">key_len</span><span class="p">,</span>
        <span class="kt">int</span> <span class="n">a5</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">v7</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
  <span class="n">__int64</span> <span class="n">v9</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">v10</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">v11</span><span class="p">;</span> 
  <span class="kt">char</span> <span class="n">v12</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">v13</span><span class="p">;</span> 
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">result</span><span class="p">;</span>
  <span class="n">__int64</span> <span class="n">v15</span><span class="p">;</span>
  <span class="n">__int64</span> <span class="n">v16</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">v17</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">v18</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">v19</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">v20</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
  <span class="kt">uintptr_t</span> <span class="n">StackCookie</span><span class="p">;</span>

  <span class="n">StackCookie</span> <span class="o">=</span> <span class="n">qword_100033E0</span><span class="p">;</span>
  <span class="n">v7</span> <span class="o">=</span> <span class="n">v20</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">256</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
    <span class="o">*</span><span class="n">v7</span><span class="o">++</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
  <span class="n">LOBYTE</span><span class="p">(</span><span class="n">v9</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v10</span> <span class="o">=</span> <span class="n">v20</span><span class="p">;</span>
  <span class="n">v11</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">do</span>
  <span class="p">{</span>
    <span class="n">v12</span> <span class="o">=</span> <span class="o">*</span><span class="n">v10</span><span class="p">;</span>
    <span class="n">v13</span> <span class="o">=</span> <span class="n">v11</span><span class="o">++</span><span class="p">;</span>
    <span class="n">v9</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)(</span><span class="n">v9</span> <span class="o">+</span> <span class="o">*</span><span class="n">v10</span> <span class="o">+</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v13</span> <span class="o">%</span> <span class="n">key_len</span> <span class="o">+</span> <span class="n">key</span><span class="p">));</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">v20</span><span class="p">[</span><span class="n">v9</span><span class="p">];</span>
    <span class="o">*</span><span class="n">v10</span><span class="o">++</span> <span class="o">=</span> <span class="n">result</span><span class="p">;</span>
    <span class="n">v20</span><span class="p">[</span><span class="n">v9</span><span class="p">]</span> <span class="o">=</span> <span class="n">v12</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">while</span> <span class="p">(</span> <span class="n">v11</span> <span class="o">&lt;</span> <span class="mi">256</span> <span class="p">);</span>
  <span class="n">LOBYTE</span><span class="p">(</span><span class="n">v15</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">buff_len</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v16</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">buff_len</span><span class="p">;</span>
    <span class="n">v17</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">_BYTE</span><span class="p">)</span><span class="n">encrypted_buff</span><span class="p">;</span>
    <span class="k">do</span>
    <span class="p">{</span>
      <span class="n">v18</span> <span class="o">=</span> <span class="n">v20</span><span class="p">[(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)((</span><span class="n">_BYTE</span><span class="p">)</span><span class="n">encrypted_buff</span> <span class="o">+</span> <span class="n">v17</span><span class="p">)];</span>
      <span class="n">v15</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)(</span><span class="n">v18</span> <span class="o">+</span> <span class="n">v15</span><span class="p">);</span>
      <span class="n">v20</span><span class="p">[(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)((</span><span class="n">_BYTE</span><span class="p">)</span><span class="n">encrypted_buff</span> <span class="o">+</span> <span class="n">v17</span><span class="p">)]</span> <span class="o">=</span> <span class="n">v20</span><span class="p">[</span><span class="n">v15</span><span class="p">];</span>
      <span class="n">v20</span><span class="p">[</span><span class="n">v15</span><span class="p">]</span> <span class="o">=</span> <span class="n">v18</span><span class="p">;</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">v18</span> <span class="o">+</span> <span class="n">v20</span><span class="p">[(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)((</span><span class="n">_BYTE</span><span class="p">)</span><span class="n">encrypted_buff</span> <span class="o">+</span> <span class="n">v17</span><span class="p">)];</span>
      <span class="n">v19</span> <span class="o">=</span> <span class="n">v20</span><span class="p">[</span><span class="n">result</span><span class="p">];</span>
      <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">a5</span> <span class="o">&amp;</span> <span class="mh">0x80</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span>
      <span class="p">{</span>
        <span class="o">*</span><span class="n">encrypted_buff</span> <span class="o">=</span> <span class="n">a5</span> <span class="o">+</span> <span class="p">(</span><span class="o">*</span><span class="n">encrypted_buff</span> <span class="o">^</span> <span class="n">v19</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span>
      <span class="p">{</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">v19</span> <span class="o">^</span> <span class="p">(</span><span class="o">*</span><span class="n">encrypted_buff</span> <span class="o">+</span> <span class="n">a5</span><span class="p">);</span>
        <span class="o">*</span><span class="n">encrypted_buff</span> <span class="o">=</span> <span class="n">result</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="o">++</span><span class="n">encrypted_buff</span><span class="p">;</span>
      <span class="o">--</span><span class="n">v16</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">while</span> <span class="p">(</span> <span class="n">v16</span> <span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><h1 id="kivars-backdoor">Kivars Backdoor</h1><p>The payload decrypted from <code class="language-plaintext highlighter-rouge">Windows.damingvUI.GameBar.dat</code> is a backdoor written in C known as <code class="language-plaintext highlighter-rouge">Kivars</code>, previously attributed to a China-nexus threat actor. The backdoor:</p><ul><li>Seems to have encrypted configuration in the registry, specifically in the value <code class="language-plaintext highlighter-rouge">appLoading</code> in the key <code class="language-plaintext highlighter-rouge">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows</code>. I could not retrieve that configuration - it is possibly set at an earlier stage, but that is unknown.<li>Checks again for the presence of mutex <code class="language-plaintext highlighter-rouge">uni-web-4e9621f</code><li>Checks if certain security processes are are running as a parent process (TCPVIEW, ICESWORD, CPORT, WIRESHARK, NETSTAT, ETHERAL, XECPROBELOADER, RFSCANNER)</ul><p><a href="/assets/images/kivars/proccheck.png" class="popup img-link shimmer"><img src="/assets/images/kivars/proccheck.png" alt="sshot" loading="lazy"></a></p><ul><li>Initializes a socket to connect to the command and control: <code class="language-plaintext highlighter-rouge">212.115.54[.]194</code><li>Has a callback message with the following potential message: <code class="language-plaintext highlighter-rouge">&lt;IP_ADDRESS&gt;|default_zz|&gt;&lt;COMPUTER_NAME&gt;|&lt;USERNAME&gt;|20.0.1||1|-1|0|&lt;PROCESS_ID&gt;|1|1|0|0| | | |&lt;LOCALE_INFO&gt;|&lt;LOCALE_INFO&gt;|</code>.<li>Has code that potentially allows the backdoor to operate at specific hours of the day. This is possibly set in in the registry configuration.</ul><p><a href="/assets/images/kivars/time_check.png" class="popup img-link shimmer"><img src="/assets/images/kivars/time_check.png" alt="sshot" loading="lazy"></a></p><ul><li>Receives commands from the C2, decrypting them with the same custom RC4 algorithm.</ul><p>The flow of the backdoor is as follows:</p><p><a href="/assets/images/kivars/flow.png" class="popup img-link shimmer"><img src="/assets/images/kivars/flow.png" alt="sshot" loading="lazy"></a></p><p>The following commands could be retrieved:</p><ul><li>Rename files</ul><p><a href="/assets/images/kivars/rename.png" class="popup img-link shimmer"><img src="/assets/images/kivars/rename.png" alt="sshot" loading="lazy"></a></p><ul><li>Delete files</ul><p><a href="/assets/images/kivars/delete.png" class="popup img-link shimmer"><img src="/assets/images/kivars/delete.png" alt="sshot" loading="lazy"></a></p><ul><li>Create directories</ul><p><a href="/assets/images/kivars/createdir.png" class="popup img-link shimmer"><img src="/assets/images/kivars/createdir.png" alt="sshot" loading="lazy"></a></p><ul><li>Execute a process</ul><p><a href="/assets/images/kivars/createprocess.png" class="popup img-link shimmer"><img src="/assets/images/kivars/createprocess.png" alt="sshot" loading="lazy"></a></p><ul><li>Likely checks if a file exists, and gets its size</ul><p><a href="/assets/images/kivars/getfilesize.png" class="popup img-link shimmer"><img src="/assets/images/kivars/getfilesize.png" alt="sshot" loading="lazy"></a></p><ul><li>Create a file</ul><p><a href="/assets/images/kivars/createfile.png" class="popup img-link shimmer"><img src="/assets/images/kivars/createfile.png" alt="sshot" loading="lazy"></a></p><ul><li>Directory enumeration</ul><p><a href="/assets/images/kivars/direnum1.png" class="popup img-link shimmer"><img src="/assets/images/kivars/direnum1.png" alt="sshot" loading="lazy"></a> <a href="/assets/images/kivars/direnum2.png" class="popup img-link shimmer"><img src="/assets/images/kivars/direnum2.png" alt="sshot" loading="lazy"></a></p><ul><li>Drive enumeration</ul><p><a href="/assets/images/kivars/driveenum.png" class="popup img-link shimmer"><img src="/assets/images/kivars/driveenum.png" alt="sshot" loading="lazy"></a></p><ul><li>Retrieve idle time</ul><p><a href="/assets/images/kivars/idle.png" class="popup img-link shimmer"><img src="/assets/images/kivars/idle.png" alt="sshot" loading="lazy"></a></p><ul><li>Enumerate running processes</ul><p><a href="/assets/images/kivars/enumproc.png" class="popup img-link shimmer"><img src="/assets/images/kivars/enumproc.png" alt="sshot" loading="lazy"></a></p><ul><li>Terminate a process</ul><p><a href="/assets/images/kivars/termproc.png" class="popup img-link shimmer"><img src="/assets/images/kivars/termproc.png" alt="sshot" loading="lazy"></a></p><ul><li>Clean up artifacts, suggesting the name of the service is <code class="language-plaintext highlighter-rouge">Ntmssvc</code> and the name of the DLL is <code class="language-plaintext highlighter-rouge">cxmctcm2.dll</code></ul><p><a href="/assets/images/kivars/cleanup.png" class="popup img-link shimmer"><img src="/assets/images/kivars/cleanup.png" alt="sshot" loading="lazy"></a></p><ul><li>Retrieve/update settings from the registry</ul><p><a href="/assets/images/kivars/regconfig.png" class="popup img-link shimmer"><img src="/assets/images/kivars/regconfig.png" alt="sshot" loading="lazy"></a></p><ul><li>Command execution using <code class="language-plaintext highlighter-rouge">cmd.exe</code> via an anonymous pipe</ul><p><a href="/assets/images/kivars/anonpipe.png" class="popup img-link shimmer"><img src="/assets/images/kivars/anonpipe.png" alt="sshot" loading="lazy"></a></p><h1 id="timestamp-and-previous-reports">Timestamp and previous reports</h1><p>The date/timestamp in the loader DLL is December 25, 2019, suggesting this is an old sample. The fact that it was uploaded to VirusTotal for the first time in 2025 suggests that it may have been part of an old intrusion that was potentially identified recently. The upload from Taiwan is consistent with the public attribution of this backdoor to a China-nexus threat actor. The timestamp of December 25 is also interesting, as this day is a holiday in many Western countries, but it is not in China.</p><p><a href="/assets/images/kivars/metaloader.png" class="popup img-link shimmer"><img src="/assets/images/kivars/metaloader.png" alt="sshot" loading="lazy"></a></p><p>The Kivars backdoor was previously covered by Trend Micro in the following <a href="https://www.trendmicro.com/en_us/research/17/f/following-trail-blacktech-cyber-espionage-campaigns.html">report</a> from 2020. The date of this report is aligned with the timestamp of the backdoor reviewed here. An older <a href="https://web.archive.org/web/20210921032629/https://blog.trendmicro.com/trendlabs-security-intelligence/new-targeted-attack-group-buys-bifrose-code-works-in-teams/">article</a>, also by Trend Micro, suggests some versions of Kivars have been around since 2010.</p><p>It is unclear if this is a long-standing intrusion that was identified in 2025 or if this was just a fortuitous upload of an old sample.</p><h1 id="iocs">IOCs</h1><ul><li>Service DLL: 1286aa5c73cf2c8058c52271869a5727d71ca5bd4dd0854be970d2a25cb52bf8<li>Encrypted payload (.dat file): a0d1e9f6bf6b60c61a381575b319e9e219240200875f434f95320ba139c87be8<li>Decrypted payload: ed0ecc33b01672523cc17b887fcd79210d5658e7a7e70dc0d9cd213762899f76<li>Mutex: uni-web-4e9621f<li>C2: 212.115.54[.]194:443</ul></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/cti/" class="post-tag no-text-decoration" >cti</a> <a href="/tags/malware/" class="post-tag no-text-decoration" >malware</a> <a href="/tags/apt/" class="post-tag no-text-decoration" >apt</a> <a href="/tags/china/" class="post-tag no-text-decoration" >china</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=China-nexus%20Kivars%20Backdoor%20Uploaded%20from%20Taiwan%20-%20dmpdump&url=https%3A%2F%2Fdmpdump.github.io%2Fposts%2FKivars%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=China-nexus%20Kivars%20Backdoor%20Uploaded%20from%20Taiwan%20-%20dmpdump&u=https%3A%2F%2Fdmpdump.github.io%2Fposts%2FKivars%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fdmpdump.github.io%2Fposts%2FKivars%2F&text=China-nexus%20Kivars%20Backdoor%20Uploaded%20from%20Taiwan%20-%20dmpdump" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/Kivars/">China-nexus Kivars Backdoor Uploaded from Taiwan</a><li class="text-truncate lh-lg"> <a href="/posts/Lazarus-Backdoor-ITLure/">Lazarus Backdoor with IT Lure</a><li class="text-truncate lh-lg"> <a href="/posts/PUBLOAD_GrimResource/">PUBLOAD Likely Delivered to Thailand via GrimResource MSC</a><li class="text-truncate lh-lg"> <a href="/posts/Havoc/">Targeted Campaign Delivering Havoc</a><li class="text-truncate lh-lg"> <a href="/posts/NorthKorea_Backdoor_Stealer/">North Korea-nexus Golang Backdoor/Stealer from Contagious Interview campaign</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/malware/">malware</a> <a class="post-tag btn btn-outline-primary" href="/tags/apt/">apt</a> <a class="post-tag btn btn-outline-primary" href="/tags/cti/">cti</a> <a class="post-tag btn btn-outline-primary" href="/tags/chrome/">chrome</a> <a class="post-tag btn btn-outline-primary" href="/tags/re/">RE</a> <a class="post-tag btn btn-outline-primary" href="/tags/china/">china</a> <a class="post-tag btn btn-outline-primary" href="/tags/cn/">cn</a> <a class="post-tag btn btn-outline-primary" href="/tags/cti/">CTI</a> <a class="post-tag btn btn-outline-primary" href="/tags/dprk/">dprk</a> <a class="post-tag btn btn-outline-primary" href="/tags/golang/">golang</a></div></section></div></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/Lazarus-Backdoor-ITLure/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1739059200" data-df="ll" > Feb 9, 2025 </time><h4 class="pt-0 my-2">Lazarus Backdoor with IT Lure</h4><div class="text-muted"><p>On January 27, 2025, @smica83 shared a sample on X indicating that it looked like Lazarus malware. I reviewed the sample and concluded that, indeed, it is a North Korean backdoor, likely the latest...</p></div></div></a></article><article class="col"> <a href="/posts/PUBLOAD_GrimResource/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1735257600" data-df="ll" > Dec 27, 2024 </time><h4 class="pt-0 my-2">PUBLOAD Likely Delivered to Thailand via GrimResource MSC</h4><div class="text-muted"><p>On December 20, 2024, a Microsoft Management Console (MSC) file named “Invitation Letter.msc” was uploaded from Thailand to VirusTotal. File name: Invitation Letter.msc Hash: 5b18f8b379cb3294...</p></div></div></a></article><article class="col"> <a href="/posts/Havoc/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1736985600" data-df="ll" > Jan 16, 2025 </time><h4 class="pt-0 my-2">Targeted Campaign Delivering Havoc</h4><div class="text-muted"><p>On January 15, 2025, a file named DH-Report76.pdf.lnk was uploaded to VirusTotal. The LNK file was likely being delivered to victims from army-mil[.]zapto.org. Parsing the LNK file, we can see t...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/Lazarus-Backdoor-ITLure/" class="btn btn-outline-primary" aria-label="Older" ><p>Lazarus Backdoor with IT Lure</p></a><div class="btn btn-outline-primary disabled" aria-label="Newer"><p>-</p></div></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://github.com/dmpdump">dmpdump</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.1.0" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/malware/">malware</a> <a class="post-tag btn btn-outline-primary" href="/tags/apt/">apt</a> <a class="post-tag btn btn-outline-primary" href="/tags/cti/">cti</a> <a class="post-tag btn btn-outline-primary" href="/tags/chrome/">chrome</a> <a class="post-tag btn btn-outline-primary" href="/tags/re/">RE</a> <a class="post-tag btn btn-outline-primary" href="/tags/china/">china</a> <a class="post-tag btn btn-outline-primary" href="/tags/cn/">cn</a> <a class="post-tag btn btn-outline-primary" href="/tags/cti/">CTI</a> <a class="post-tag btn btn-outline-primary" href="/tags/dprk/">dprk</a> <a class="post-tag btn btn-outline-primary" href="/tags/golang/">golang</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js"></script> <script src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js"></script> <script>SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
