<!DOCTYPE html>
<html class='v2' dir='ltr' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/3566091532-css_bundle_v2.css' rel='stylesheet' type='text/css'/>
<meta content='IE=EmulateIE7' http-equiv='X-UA-Compatible'/>
<meta content='width=1100' name='viewport'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='https://blog.malwaremustdie.org/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='https://blog.malwaremustdie.org/2014/08/another-country-sponsored-malware.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="Malware Must Die! - Atom" href="https://blog.malwaremustdie.org/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="Malware Must Die! - RSS" href="https://blog.malwaremustdie.org/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="Malware Must Die! - Atom" href="https://www.blogger.com/feeds/8268358095554400245/posts/default" />

<link rel="alternate" type="application/atom+xml" title="Malware Must Die! - Atom" href="https://blog.malwaremustdie.org/feeds/7751444935632191567/comments/default" />
<!--Can't find substitution for tag [blog.ieCssRetrofitLinks]-->
<link href='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgqI3NNDYZ9Yyy4IRBSmkLwOt8fm9V0jUnXWxRbiV1zTQnskV00Bhbt3WDb7FoBrb4rKfK65-DplMqi3anvGwN0KRtFS-wpGRVkrylTlKHA98RppfTOMkqcEs2LyOfbdotuB0vdEZ48XOg/s555/000.png' rel='image_src'/>
<meta content='https://blog.malwaremustdie.org/2014/08/another-country-sponsored-malware.html' property='og:url'/>
<meta content='Another country-sponsored #malware: Vietnam APT Campaign' property='og:title'/>
<meta content='MalwareMustDie (MMD) is a whitehat workgroup to reduce malware, this blog advocates research on new malware threats &amp; Linux malware.' property='og:description'/>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgqI3NNDYZ9Yyy4IRBSmkLwOt8fm9V0jUnXWxRbiV1zTQnskV00Bhbt3WDb7FoBrb4rKfK65-DplMqi3anvGwN0KRtFS-wpGRVkrylTlKHA98RppfTOMkqcEs2LyOfbdotuB0vdEZ48XOg/w1200-h630-p-k-no-nu/000.png' property='og:image'/>
<title>Malware Must Die!: Another country-sponsored #malware: Vietnam APT Campaign</title>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async='async' src='https://www.googletagmanager.com/gtag/js?id=UA-180537376-1'></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-180537376-1');
</script>
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Awesome Inc.
Designer: Tina Chen
----------------------------------------------- */
/* Variable definitions
====================
<Variable name="keycolor" description="Main Color" type="color" default="#ffffff"/>
<Group description="Page" selector="body">
<Variable name="body.font" description="Font" type="font"
default="normal normal 13px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="body.background.color" description="Background Color" type="color" default="#000000"/>
<Variable name="body.text.color" description="Text Color" type="color" default="#ffffff"/>
</Group>
<Group description="Links" selector=".main-inner">
<Variable name="link.color" description="Link Color" type="color" default="#888888"/>
<Variable name="link.visited.color" description="Visited Color" type="color" default="#444444"/>
<Variable name="link.hover.color" description="Hover Color" type="color" default="#cccccc"/>
</Group>
<Group description="Blog Title" selector=".header h1">
<Variable name="header.font" description="Title Font" type="font"
default="normal bold 40px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="header.text.color" description="Title Color" type="color" default="#ffffff" />
<Variable name="header.background.color" description="Header Background" type="color" default="transparent" />
</Group>
<Group description="Blog Description" selector=".header .description">
<Variable name="description.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="description.text.color" description="Text Color" type="color"
default="#ffffff" />
</Group>
<Group description="Tabs Text" selector=".tabs-inner .widget li a">
<Variable name="tabs.font" description="Font" type="font"
default="normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="tabs.text.color" description="Text Color" type="color" default="#ffffff"/>
<Variable name="tabs.selected.text.color" description="Selected Color" type="color" default="#ffffff"/>
</Group>
<Group description="Tabs Background" selector=".tabs-outer .PageList">
<Variable name="tabs.background.color" description="Background Color" type="color" default="#141414"/>
<Variable name="tabs.selected.background.color" description="Selected Color" type="color" default="#444444"/>
<Variable name="tabs.border.color" description="Border Color" type="color" default="#222222"/>
</Group>
<Group description="Date Header" selector=".main-inner .widget h2.date-header, .main-inner .widget h2.date-header span">
<Variable name="date.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="date.text.color" description="Text Color" type="color" default="#666666"/>
<Variable name="date.border.color" description="Border Color" type="color" default="#222222"/>
</Group>
<Group description="Post Title" selector="h3.post-title, h4, h3.post-title a">
<Variable name="post.title.font" description="Font" type="font"
default="normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="post.title.text.color" description="Text Color" type="color" default="#ffffff"/>
</Group>
<Group description="Post Background" selector=".post">
<Variable name="post.background.color" description="Background Color" type="color" default="#141414" />
<Variable name="post.border.color" description="Border Color" type="color" default="#222222" />
<Variable name="post.border.bevel.color" description="Bevel Color" type="color" default="#222222"/>
</Group>
<Group description="Gadget Title" selector="h2">
<Variable name="widget.title.font" description="Font" type="font"
default="normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="widget.title.text.color" description="Text Color" type="color" default="#ffffff"/>
</Group>
<Group description="Gadget Text" selector=".sidebar .widget">
<Variable name="widget.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="widget.text.color" description="Text Color" type="color" default="#ffffff"/>
<Variable name="widget.alternate.text.color" description="Alternate Color" type="color" default="#666666"/>
</Group>
<Group description="Gadget Links" selector=".sidebar .widget">
<Variable name="widget.link.color" description="Link Color" type="color" default="#888888"/>
<Variable name="widget.link.visited.color" description="Visited Color" type="color" default="#444444"/>
<Variable name="widget.link.hover.color" description="Hover Color" type="color" default="#cccccc"/>
</Group>
<Group description="Gadget Background" selector=".sidebar .widget">
<Variable name="widget.background.color" description="Background Color" type="color" default="#141414"/>
<Variable name="widget.border.color" description="Border Color" type="color" default="#222222"/>
<Variable name="widget.border.bevel.color" description="Bevel Color" type="color" default="#000000"/>
</Group>
<Group description="Sidebar Background" selector=".column-left-inner .column-right-inner">
<Variable name="widget.outer.background.color" description="Background Color" type="color" default="transparent" />
</Group>
<Group description="Images" selector=".main-inner">
<Variable name="image.background.color" description="Background Color" type="color" default="transparent"/>
<Variable name="image.border.color" description="Border Color" type="color" default="transparent"/>
</Group>
<Group description="Feed" selector=".blog-feeds">
<Variable name="feed.text.color" description="Text Color" type="color" default="#ffffff"/>
</Group>
<Group description="Feed Links" selector=".blog-feeds">
<Variable name="feed.link.color" description="Link Color" type="color" default="#888888"/>
<Variable name="feed.link.visited.color" description="Visited Color" type="color" default="#444444"/>
<Variable name="feed.link.hover.color" description="Hover Color" type="color" default="#cccccc"/>
</Group>
<Group description="Pager" selector=".blog-pager">
<Variable name="pager.background.color" description="Background Color" type="color" default="#141414" />
</Group>
<Group description="Footer" selector=".footer-outer">
<Variable name="footer.background.color" description="Background Color" type="color" default="#141414" />
<Variable name="footer.text.color" description="Text Color" type="color" default="#ffffff" />
</Group>
<Variable name="title.shadow.spread" description="Title Shadow" type="length" default="-1px" min="-1px" max="100px"/>
<Variable name="body.background" description="Body Background" type="background"
color="#000000"
default="$(color) none repeat scroll top left"/>
<Variable name="body.background.gradient.cap" description="Body Gradient Cap" type="url"
default="none"/>
<Variable name="body.background.size" description="Body Background Size" type="string" default="auto"/>
<Variable name="tabs.background.gradient" description="Tabs Background Gradient" type="url"
default="none"/>
<Variable name="header.background.gradient" description="Header Background Gradient" type="url" default="none" />
<Variable name="header.padding.top" description="Header Top Padding" type="length" default="22px" min="0" max="100px"/>
<Variable name="header.margin.top" description="Header Top Margin" type="length" default="0" min="0" max="100px"/>
<Variable name="header.margin.bottom" description="Header Bottom Margin" type="length" default="0" min="0" max="100px"/>
<Variable name="widget.padding.top" description="Widget Padding Top" type="length" default="8px" min="0" max="20px"/>
<Variable name="widget.padding.side" description="Widget Padding Side" type="length" default="15px" min="0" max="100px"/>
<Variable name="widget.outer.margin.top" description="Widget Top Margin" type="length" default="0" min="0" max="100px"/>
<Variable name="widget.outer.background.gradient" description="Gradient" type="url" default="none" />
<Variable name="widget.border.radius" description="Gadget Border Radius" type="length" default="0" min="0" max="100px"/>
<Variable name="outer.shadow.spread" description="Outer Shadow Size" type="length" default="0" min="0" max="100px"/>
<Variable name="date.header.border.radius.top" description="Date Header Border Radius Top" type="length" default="0" min="0" max="100px"/>
<Variable name="date.header.position" description="Date Header Position" type="length" default="15px" min="0" max="100px"/>
<Variable name="date.space" description="Date Space" type="length" default="30px" min="0" max="100px"/>
<Variable name="date.position" description="Date Float" type="string" default="static" />
<Variable name="date.padding.bottom" description="Date Padding Bottom" type="length" default="0" min="0" max="100px"/>
<Variable name="date.border.size" description="Date Border Size" type="length" default="0" min="0" max="10px"/>
<Variable name="date.background" description="Date Background" type="background" color="transparent"
default="$(color) none no-repeat scroll top left" />
<Variable name="date.first.border.radius.top" description="Date First top radius" type="length" default="0" min="0" max="100px"/>
<Variable name="date.last.space.bottom" description="Date Last Space Bottom" type="length"
default="20px" min="0" max="100px"/>
<Variable name="date.last.border.radius.bottom" description="Date Last bottom radius" type="length" default="0" min="0" max="100px"/>
<Variable name="post.first.padding.top" description="First Post Padding Top" type="length" default="0" min="0" max="100px"/>
<Variable name="image.shadow.spread" description="Image Shadow Size" type="length" default="0" min="0" max="100px"/>
<Variable name="image.border.radius" description="Image Border Radius" type="length" default="0" min="0" max="100px"/>
<Variable name="separator.outdent" description="Separator Outdent" type="length" default="15px" min="0" max="100px"/>
<Variable name="title.separator.border.size" description="Widget Title Border Size" type="length" default="1px" min="0" max="10px"/>
<Variable name="list.separator.border.size" description="List Separator Border Size" type="length" default="1px" min="0" max="10px"/>
<Variable name="shadow.spread" description="Shadow Size" type="length" default="0" min="0" max="100px"/>
<Variable name="startSide" description="Side where text starts in blog language" type="automatic" default="left"/>
<Variable name="endSide" description="Side where text ends in blog language" type="automatic" default="right"/>
<Variable name="date.side" description="Side where date header is placed" type="string" default="right"/>
<Variable name="pager.border.radius.top" description="Pager Border Top Radius" type="length" default="0" min="0" max="100px"/>
<Variable name="pager.space.top" description="Pager Top Space" type="length" default="1em" min="0" max="20em"/>
<Variable name="footer.background.gradient" description="Background Gradient" type="url" default="none" />
<Variable name="mobile.background.size" description="Mobile Background Size" type="string"
default="auto"/>
<Variable name="mobile.background.overlay" description="Mobile Background Overlay" type="string"
default="transparent none repeat scroll top left"/>
<Variable name="mobile.button.color" description="Mobile Button Color" type="color" default="#ffffff" />
*/
/* Content
----------------------------------------------- */
body {
font: normal normal 13px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
background: #000000 none no-repeat scroll center center;
}
html body .content-outer {
min-width: 0;
max-width: 100%;
width: 100%;
}
a:link {
text-decoration: none;
color: #888888;
}
a:visited {
text-decoration: none;
color: #444444;
}
a:hover {
text-decoration: underline;
color: #cccccc;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 276px;
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
/* Columns
----------------------------------------------- */
.content-inner {
padding: 0;
}
.header-inner .section {
margin: 0 16px;
}
.tabs-inner .section {
margin: 0 16px;
}
.main-inner {
padding-top: 30px;
}
.main-inner .column-center-inner,
.main-inner .column-left-inner,
.main-inner .column-right-inner {
padding: 0 5px;
}
*+html body .main-inner .column-center-inner {
margin-top: -30px;
}
#layout .main-inner .column-center-inner {
margin-top: 0;
}
/* Header
----------------------------------------------- */
.header-outer {
margin: 0 0 0 0;
background: transparent none repeat scroll 0 0;
}
.Header h1 {
font: normal bold 40px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
text-shadow: 0 0 -1px #000000;
}
.Header h1 a {
color: #ffffff;
}
.Header .description {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
}
.header-inner .Header .titlewrapper,
.header-inner .Header .descriptionwrapper {
padding-left: 0;
padding-right: 0;
margin-bottom: 0;
}
.header-inner .Header .titlewrapper {
padding-top: 22px;
}
/* Tabs
----------------------------------------------- */
.tabs-outer {
overflow: hidden;
position: relative;
background: #141414 none repeat scroll 0 0;
}
#layout .tabs-outer {
overflow: visible;
}
.tabs-cap-top, .tabs-cap-bottom {
position: absolute;
width: 100%;
border-top: 1px solid #222222;
}
.tabs-cap-bottom {
bottom: 0;
}
.tabs-inner .widget li a {
display: inline-block;
margin: 0;
padding: .6em 1.5em;
font: normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
border-top: 1px solid #222222;
border-bottom: 1px solid #222222;
border-left: 1px solid #222222;
height: 16px;
line-height: 16px;
}
.tabs-inner .widget li:last-child a {
border-right: 1px solid #222222;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
background: #444444 none repeat-x scroll 0 -100px;
color: #ffffff;
}
/* Headings
----------------------------------------------- */
h2 {
font: normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
}
/* Widgets
----------------------------------------------- */
.main-inner .section {
margin: 0 27px;
padding: 0;
}
.main-inner .column-left-outer,
.main-inner .column-right-outer {
margin-top: 0;
}
#layout .main-inner .column-left-outer,
#layout .main-inner .column-right-outer {
margin-top: 0;
}
.main-inner .column-left-inner,
.main-inner .column-right-inner {
background: transparent none repeat 0 0;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
#layout .main-inner .column-left-inner,
#layout .main-inner .column-right-inner {
margin-top: 0;
}
.sidebar .widget {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
}
.sidebar .widget a:link {
color: #888888;
}
.sidebar .widget a:visited {
color: #444444;
}
.sidebar .widget a:hover {
color: #cccccc;
}
.sidebar .widget h2 {
text-shadow: 0 0 -1px #000000;
}
.main-inner .widget {
background-color: #141414;
border: 1px solid #222222;
padding: 0 15px 15px;
margin: 20px -16px;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
.main-inner .widget h2 {
margin: 0 -15px;
padding: .6em 15px .5em;
border-bottom: 1px solid #000000;
}
.footer-inner .widget h2 {
padding: 0 0 .4em;
border-bottom: 1px solid #000000;
}
.main-inner .widget h2 + div, .footer-inner .widget h2 + div {
border-top: 1px solid #222222;
padding-top: 8px;
}
.main-inner .widget .widget-content {
margin: 0 -15px;
padding: 7px 15px 0;
}
.main-inner .widget ul, .main-inner .widget #ArchiveList ul.flat {
margin: -8px -15px 0;
padding: 0;
list-style: none;
}
.main-inner .widget #ArchiveList {
margin: -8px 0 0;
}
.main-inner .widget ul li, .main-inner .widget #ArchiveList ul.flat li {
padding: .5em 15px;
text-indent: 0;
color: #666666;
border-top: 1px solid #222222;
border-bottom: 1px solid #000000;
}
.main-inner .widget #ArchiveList ul li {
padding-top: .25em;
padding-bottom: .25em;
}
.main-inner .widget ul li:first-child, .main-inner .widget #ArchiveList ul.flat li:first-child {
border-top: none;
}
.main-inner .widget ul li:last-child, .main-inner .widget #ArchiveList ul.flat li:last-child {
border-bottom: none;
}
.post-body {
position: relative;
}
.main-inner .widget .post-body ul {
padding: 0 2.5em;
margin: .5em 0;
list-style: disc;
}
.main-inner .widget .post-body ul li {
padding: 0.25em 0;
margin-bottom: .25em;
color: #ffffff;
border: none;
}
.footer-inner .widget ul {
padding: 0;
list-style: none;
}
.widget .zippy {
color: #666666;
}
/* Posts
----------------------------------------------- */
body .main-inner .Blog {
padding: 0;
margin-bottom: 1em;
background-color: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
box-shadow: 0 0 0 rgba(0, 0, 0, 0);
}
.main-inner .section:last-child .Blog:last-child {
padding: 0;
margin-bottom: 1em;
}
.main-inner .widget h2.date-header {
margin: 0 -15px 1px;
padding: 0 0 0 0;
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #666666;
background: transparent none no-repeat scroll top left;
border-top: 0 solid #222222;
border-bottom: 1px solid #000000;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius: 0;
position: static;
bottom: 100%;
right: 15px;
text-shadow: 0 0 -1px #000000;
}
.main-inner .widget h2.date-header span {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
display: block;
padding: .5em 15px;
border-left: 0 solid #222222;
border-right: 0 solid #222222;
}
.date-outer {
position: relative;
margin: 30px 0 20px;
padding: 0 15px;
background-color: #141414;
border: 1px solid #222222;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
.date-outer:first-child {
margin-top: 0;
}
.date-outer:last-child {
margin-bottom: 20px;
-moz-border-radius-bottomleft: 0;
-moz-border-radius-bottomright: 0;
-webkit-border-bottom-left-radius: 0;
-webkit-border-bottom-right-radius: 0;
-goog-ms-border-bottom-left-radius: 0;
-goog-ms-border-bottom-right-radius: 0;
border-bottom-left-radius: 0;
border-bottom-right-radius: 0;
}
.date-posts {
margin: 0 -15px;
padding: 0 15px;
clear: both;
}
.post-outer, .inline-ad {
border-top: 1px solid #222222;
margin: 0 -15px;
padding: 15px 15px;
}
.post-outer {
padding-bottom: 10px;
}
.post-outer:first-child {
padding-top: 0;
border-top: none;
}
.post-outer:last-child, .inline-ad:last-child {
border-bottom: none;
}
.post-body {
position: relative;
}
.post-body img {
padding: 8px;
background: #222222;
border: 1px solid transparent;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
border-radius: 0;
}
h3.post-title, h4 {
font: normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
}
h3.post-title a {
font: normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
}
h3.post-title a:hover {
color: #cccccc;
text-decoration: underline;
}
.post-header {
margin: 0 0 1em;
}
.post-body {
line-height: 1.4;
}
.post-outer h2 {
color: #ffffff;
}
.post-footer {
margin: 1.5em 0 0;
}
#blog-pager {
padding: 15px;
font-size: 120%;
background-color: #141414;
border: 1px solid #222222;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
-goog-ms-border-top-left-radius: 0;
-goog-ms-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius-topright: 0;
margin-top: 1em;
}
.blog-feeds, .post-feeds {
margin: 1em 0;
text-align: center;
color: #ffffff;
}
.blog-feeds a, .post-feeds a {
color: #888888;
}
.blog-feeds a:visited, .post-feeds a:visited {
color: #444444;
}
.blog-feeds a:hover, .post-feeds a:hover {
color: #cccccc;
}
.post-outer .comments {
margin-top: 2em;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #222222;
border-bottom: 1px solid #222222;
}
.comments .continue {
border-top: 2px solid #222222;
}
/* Footer
----------------------------------------------- */
.footer-outer {
margin: -0 0 -1px;
padding: 0 0 0;
color: #ffffff;
overflow: hidden;
}
.footer-fauxborder-left {
border-top: 1px solid #222222;
background: #141414 none repeat scroll 0 0;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
margin: 0 -0;
}
/* Mobile
----------------------------------------------- */
body.mobile {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
*+html body.mobile .main-inner .column-center-inner {
margin-top: 0;
}
.mobile .main-inner .widget {
padding: 0 0 15px;
}
.mobile .main-inner .widget h2 + div,
.mobile .footer-inner .widget h2 + div {
border-top: none;
padding-top: 0;
}
.mobile .footer-inner .widget h2 {
padding: 0.5em 0;
border-bottom: none;
}
.mobile .main-inner .widget .widget-content {
margin: 0;
padding: 7px 0 0;
}
.mobile .main-inner .widget ul,
.mobile .main-inner .widget #ArchiveList ul.flat {
margin: 0 -15px 0;
}
.mobile .main-inner .widget h2.date-header {
right: 0;
}
.mobile .date-header span {
padding: 0.4em 0;
}
.mobile .date-outer:first-child {
margin-bottom: 0;
border: 1px solid #222222;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
-goog-ms-border-top-left-radius: 0;
-goog-ms-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius: 0;
}
.mobile .date-outer {
border-color: #222222;
border-width: 0 1px 1px;
}
.mobile .date-outer:last-child {
margin-bottom: 0;
}
.mobile .main-inner {
padding: 0;
}
.mobile .header-inner .section {
margin: 0;
}
.mobile .post-outer, .mobile .inline-ad {
padding: 5px 0;
}
.mobile .tabs-inner .section {
margin: 0 10px;
}
.mobile .main-inner .widget h2 {
margin: 0;
padding: 0;
}
.mobile .main-inner .widget h2.date-header span {
padding: 0;
}
.mobile .main-inner .widget .widget-content {
margin: 0;
padding: 7px 0 0;
}
.mobile #blog-pager {
border: 1px solid transparent;
background: #141414 none repeat scroll 0 0;
}
.mobile .main-inner .column-left-inner,
.mobile .main-inner .column-right-inner {
background: transparent none repeat 0 0;
-moz-box-shadow: none;
-webkit-box-shadow: none;
-goog-ms-box-shadow: none;
box-shadow: none;
}
.mobile .date-posts {
margin: 0;
padding: 0;
}
.mobile .footer-fauxborder-left {
margin: 0;
border-top: inherit;
}
.mobile .main-inner .section:last-child .Blog:last-child {
margin-bottom: 0;
}
.mobile-index-contents {
color: #ffffff;
}
.mobile .mobile-link-button {
background: #888888 none repeat scroll 0 0;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .PageList .widget-content {
background: transparent;
border-top: 1px solid;
border-color: #222222;
color: #ffffff;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #222222;
}

--></style>
<style id='template-skin-1' type='text/css'><!--
body {
min-width: 960px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 960px;
max-width: 960px;
_width: 960px;
}
.main-inner .columns {
padding-left: 0px;
padding-right: 310px;
}
.main-inner .fauxcolumn-center-outer {
left: 0px;
right: 310px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0px") -
parseInt("310px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0px;
}
.main-inner .fauxcolumn-right-outer {
width: 310px;
}
.main-inner .column-left-outer {
width: 0px;
right: 100%;
margin-left: -0px;
}
.main-inner .column-right-outer {
width: 310px;
margin-right: -310px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
--></style>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async='async' src='https://www.googletagmanager.com/gtag/js?id=G-GGYD63MC07'></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-GGYD63MC07');
</script>
<link href='https://unixfreaxjp.github.io/styles/shCore.css' rel='stylesheet' type='text/css'/>
<link href='https://unixfreaxjp.github.io/styles/shThemeRDark.css' rel='stylesheet' type='text/css'/>
<script src='https://unixfreaxjp.github.io/scripts/shCore.js' type='text/javascript'></script>
<script src='https://unixfreaxjp.github.io/scripts/shBrushCpp.js' type='text/javascript'></script>
<script src='https://unixfreaxjp.github.io/scripts/shBrushCss.js' type='text/javascript'></script>
<script src='https://unixfreaxjp.github.io/scripts/shBrushJava.js' type='text/javascript'></script>
<script src='https://unixfreaxjp.github.io/scripts/shBrushJScript.js' type='text/javascript'></script>
<script src='https://unixfreaxjp.github.io/scripts/shBrushPhp.js' type='text/javascript'></script>
<script src='https://unixfreaxjp.github.io/scripts/shBrushPython.js' type='text/javascript'></script>
<script src='https://unixfreaxjp.github.io/scripts/shBrushRuby.js' type='text/javascript'></script>
<script src='https://unixfreaxjp.github.io/scripts/shBrushSql.js' type='text/javascript'></script>
<script src='https://unixfreaxjp.github.io/scripts/shBrushVb.js' type='text/javascript'></script>
<script src='https://unixfreaxjp.github.io/scripts/shBrushXml.js' type='text/javascript'></script>
<script src='https://unixfreaxjp.github.io/scripts/shBrushPerl.js' type='text/javascript'></script>
<script src='https://unixfreaxjp.github.io/scripts/shBrushPlain.js' type='text/javascript'></script>
<script src='https://unixfreaxjp.github.io/scripts/shBrushBash.js' type='text/javascript'></script>
<script src='https://unixfreaxjp.github.io/scripts/shBrushAsm.js' type='text/javascript'></script>
<script language='javascript'> 
// SyntaxHighlighter.config.bloggerMode = true;
SyntaxHighlighter.all();
</script>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=8268358095554400245&amp;zx=2b8e6193-3d9d-4f89-85d4-67e839c29eee' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=8268358095554400245&amp;zx=2b8e6193-3d9d-4f89-85d4-67e839c29eee' rel='stylesheet'/></noscript>
<meta name='google-adsense-platform-account' content='ca-host-pub-1556223355139109'/>
<meta name='google-adsense-platform-domain' content='blogspot.com'/>

</head>
<body class='loading'>
<div class='navbar section' id='navbar'><div class='widget Navbar' data-version='1' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/platform.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d8268358095554400245\x26blogName\x3dMalware+Must+Die!\x26publishMode\x3dPUBLISH_MODE_HOSTED\x26navbarType\x3dLIGHT\x26layoutType\x3dLAYOUTS\x26searchRoot\x3dhttps://blog.malwaremustdie.org/search\x26blogLocale\x3den\x26v\x3d2\x26homepageUrl\x3dhttps://blog.malwaremustdie.org/\x26targetPostID\x3d7751444935632191567\x26blogPostOrPageUrl\x3dhttps://blog.malwaremustdie.org/2014/08/another-country-sponsored-malware.html\x26vt\x3d-4975702267532676307',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe",
              messageHandlersFilter: gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER,
              messageHandlers: {
                'blogger-ping': function() {}
              }
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class='body-fauxcolumns'>
<div class='fauxcolumn-outer body-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content'>
<div class='content-fauxcolumns'>
<div class='fauxcolumn-outer content-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content-outer'>
<div class='content-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left content-fauxborder-left'>
<div class='fauxborder-right content-fauxborder-right'></div>
<div class='content-inner'>
<header>
<div class='header-outer'>
<div class='header-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left header-fauxborder-left'>
<div class='fauxborder-right header-fauxborder-right'></div>
<div class='region-inner header-inner'>
<div class='header section' id='header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<a href='https://blog.malwaremustdie.org/' style='display: block'>
<img alt='Malware Must Die!' height='77px; ' id='Header1_headerimg' src='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEicWzkGiSZuTdDTbJ2dIYNrHP0cgqkdJPpSiO8QiX8etjBQqXsJrYQgs6Qt3x2UmgWo4nvXPOkxj8XIaeqtmQ1iTcUJNJ0SlJ13x4EabhBVX0jRm2w6upseKV8uhUsu7gajVju0UPkkBbo/s1600/MMD.JPG' style='display: block' width='395px; '/>
</a>
<div class='descriptionwrapper'>
<p class='description'><span>The MalwareMustDie Blog (blog.malwaremustdie.org)</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class='header-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</header>
<div class='tabs-outer'>
<div class='tabs-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left tabs-fauxborder-left'>
<div class='fauxborder-right tabs-fauxborder-right'></div>
<div class='region-inner tabs-inner'>
<div class='tabs no-items section' id='crosscol'></div>
<div class='tabs no-items section' id='crosscol-overflow'></div>
</div>
</div>
<div class='tabs-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='main-outer'>
<div class='main-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left main-fauxborder-left'>
<div class='fauxborder-right main-fauxborder-right'></div>
<div class='region-inner main-inner'>
<div class='columns fauxcolumns'>
<div class='fauxcolumn-outer fauxcolumn-center-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-left-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class='columns-inner'>
<div class='column-center-outer'>
<div class='column-center-inner'>
<div class='main section' id='main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>

          <div class="date-outer">
        
<h2 class='date-header'><span>Sunday, August 24, 2014</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry' itemscope='itemscope' itemtype='https://schema.org/BlogPosting'>
<a name='7751444935632191567'></a>
<h3 class='post-title entry-title' itemprop='name'>
Another country-sponsored #malware: Vietnam APT Campaign
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-7751444935632191567' itemprop='description articleBody'>
<p><h2>The background</h2>

This is a team work analysis, we have at least 5 (five) members involved with this investigation. <br>
The case that is about to be explained here is an APT case. Until now, we were (actually) avoiding APT cases for publicity in Malware Must Die! posts. But due to recent progress in <i>"public privacy violation or power-abuse/bullying"</i> malware cases, we improved our policy, so for several cases fit to <i>"a certain condition"</i>, i.e. malware developed by <i>"powerful actors with budget"</i> aiming weak victims including the APT method, or, intimidation for public privacy cases using a crafted-malware, are going to be disclosed and reported here <b><i>"ala MMD"</i></b>, along w/public criminal threat too. So don't use malware if you don't want to look BAD :-)

<p>This case is NOT a new threat, for the background this threat was written in the Infosec Island blog, written by By Eva Galperin and Morgan Marquis-Boire in the good report of article: "Vietnamese Malware Gets Very Personal" which is posted several months ago, access is in here-->[<a href="http://www.infosecisland.com/blogview/23567-Vietnamese-Malware-Gets-Very-Personal.html">LINK</a>], the post was very well written as heads up for this threat. Also, there are similar article supported to this threat and worth reading beforehand like:<br>
<li><a href="https://www.hostragon.com/shadowy-pro-government-hacking-squad-spying-vietnamese-bloggers/">https://www.hostragon.com/shadowy-pro-government-hacking-squad-spying-vietnamese-bloggers/</a><br>
<li><a href="http://english.vietnamnet.vn/fms/science-it/102484/chinese-hackers-set-malware-to-trap-vietnamese-internet-users.html">http://english.vietnamnet.vn/fms/science-it/102484/chinese-hackers-set-malware-to-trap-vietnamese-internet-users.html</a><br>
<li><a href="http://www.nytimes.com/aponline/2014/01/20/world/asia/ap-as-vietnam-online-wars.html">http://www.nytimes.com/aponline/2014/01/20/world/asia/ap-as-vietnam-online-wars.html</a><br>
<p>You can consider this post is made as additional for the previous writings, to disclose deeper of what public and the victims actually SHOULD know in-depth about the malicious activity detail, that is performed by this malware. To be more preventive in the future for the similar attack that is possibly occurred.

<p>We suspect a group with good budget is in behind of this malware, aiming and bullying privacy of specific individuals who against one country's political method. In a glimpse, the malware, which is trying hard to look like a common-threat, looks like a simple backdoor & connecting/sending some stuffs to CNC. But if you see it closely to the way it works, you will be amazed of the technique used to fulfill its purpose, and SPYING is the right word for that purpose. 

<p>The sample we analyzed in this post was received from the victims side, we picked the one file called "Thu moi.7z" which contains the "Thu moi.hta" snipped below:<br><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgqI3NNDYZ9Yyy4IRBSmkLwOt8fm9V0jUnXWxRbiV1zTQnskV00Bhbt3WDb7FoBrb4rKfK65-DplMqi3anvGwN0KRtFS-wpGRVkrylTlKHA98RppfTOMkqcEs2LyOfbdotuB0vdEZ48XOg/s1555/000.png"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgqI3NNDYZ9Yyy4IRBSmkLwOt8fm9V0jUnXWxRbiV1zTQnskV00Bhbt3WDb7FoBrb4rKfK65-DplMqi3anvGwN0KRtFS-wpGRVkrylTlKHA98RppfTOMkqcEs2LyOfbdotuB0vdEZ48XOg/s555/000.png"></a><br>..which was reported as the latest of this series.

<p>From the surface, if "Thu moi.hta" file is being executed (double clicked), it will extract (drop) and opening a Microsoft Word DOC file, to camouflage the victim to make them believe that they are opening an archived document file, while what had actually happened is, in the background a series of infection activities happened in the victim's PC.

<p><h2>Malware installer scheme</h2>

<p>How the file was extracted from "Thu moi.hta" is by utilizing a simple embedded VB Script, you can see it started in the line 307 (of that .hta sample file) as per shown below in any text editor you pick:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhWtNjegMLQBRYYwds3_0ZcMdwukskqgNBXOGbpqO0yXPgN7gdZby9CKPSjDey8xlwX83rZXmHcrEtWm3TISRmopfe46ykz1-DOQAFVpOta6DUVUtkYv1XhwoQ3a8odPhcS3seWDAFKx8c/s928/000a.PNG"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhWtNjegMLQBRYYwds3_0ZcMdwukskqgNBXOGbpqO0yXPgN7gdZby9CKPSjDey8xlwX83rZXmHcrEtWm3TISRmopfe46ykz1-DOQAFVpOta6DUVUtkYv1XhwoQ3a8odPhcS3seWDAFKx8c/s580/000a.PNG"></a><br>
At the starting part of this script. you can see three points was used to camouflage, which are : (1) The usage of the long white space to cover the evil script start tag from the eye-sight, (2) the effort to minimize the "window" for the shell used to run this evil VB Script, and (3) the effort to NOT showing the window taskbar during the script running.

<p>I will try to peel the evil script used, with the explanation I commented within the lines, as per below:<br><br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhnMKctMSrGGjYKhreepJHSBFHpX49ubX3HRJ_fMdBokWaSjm0Ztv9aQfslKpKYAZhn43oK04ntSU1OYJREFd9LcGZQMAO22Bb-oOXGmoTZmINfkfIznANkT-b-aNUFo-ZWW0fwr-_e6NM/s1880/001.PNG"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhnMKctMSrGGjYKhreepJHSBFHpX49ubX3HRJ_fMdBokWaSjm0Ztv9aQfslKpKYAZhn43oK04ntSU1OYJREFd9LcGZQMAO22Bb-oOXGmoTZmINfkfIznANkT-b-aNUFo-ZWW0fwr-_e6NM/s880/001.PNG"></a><br>
So, the script was design to keep on running in any run time error. You will meet the function forming the randomized strings for an "exe" filename. You can see how this script generate the <i>"random seed"</i> to be used for randomizing the strings used for filename, and how it merged <i>filename </i>with the <i>".exe"</i> extension afterwards. Then the script is obfuscating the WScript's (the Windows OS interpreter engine for running a VB Script) commands to form an object of file system, and the shell for execution a windows command/executable file(s).

<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjlUkNrZwl_9Z1NTY-8cGmu_XLjQzOHwVubfvkHsaZ3OsuXoPfNCdoG3ceg2SpyDOiiBdqDwZEix42qd_oXFmepRGEheFOdAuNZbCybTjCL1xUX7-4OO7c6iG8cMT4ZlqwaGrB4m5up0Gw/s1580/002.PNG"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjlUkNrZwl_9Z1NTY-8cGmu_XLjQzOHwVubfvkHsaZ3OsuXoPfNCdoG3ceg2SpyDOiiBdqDwZEix42qd_oXFmepRGEheFOdAuNZbCybTjCL1xUX7-4OO7c6iG8cMT4ZlqwaGrB4m5up0Gw/s580/002.PNG"></a><br>
The line 48 & 49 of the script is to declare the file object & shell mentioned above in the variable <b>"os"</b> and <b>"ws"</b>. And following by defining the windows temporary folder as file's path added by the function's generated randomized name as filename+extension. To make sure of what these variables generated values, I am using break points formed by Wscript.Echo trick to burp its value in a pop-up. 

<p>The VB Script is creating the EXE file as per previously described above, declared it as an object <b>"p1"</b>. Then you can see blob of binary codes to be written as HEX to form a file, by using the combination of commands in VB script. This method is commonly used as technique to write a malware binary in VB Script. But this one is a well-thought one. <br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgByB4xwLi6CE7DYf6fkIsMEhGVVG91WjzAWEhI5LVlPVbMbAVYAjGdFuiW4tbcU_pZ4B6auVFY3zbkx4oAF_uMAZEIoqo4i_IBwLVTont7S2OznGARi9fhND26sVxIqDKjcLyZ14R0Ydg/s1580/003.PNG"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgByB4xwLi6CE7DYf6fkIsMEhGVVG91WjzAWEhI5LVlPVbMbAVYAjGdFuiW4tbcU_pZ4B6auVFY3zbkx4oAF_uMAZEIoqo4i_IBwLVTont7S2OznGARi9fhND26sVxIqDKjcLyZ14R0Ydg/s580/003.PNG"></a>
<p>The next lines is explaining the same method used for HEX file-writing. Yes, it wrote another file, and declaring it as object <b>"p"</b>, but this one is using the static variable name "Doc Loi.doc" which is using the %Temp% path too (noted: GetSpecialFolder(x) where x=2 means %Temp%). 
<p>Here's the punchline, the last part of codes (lines 116 and 117) you will see the script is performing execution of object "p" (the .doc file) and without waiting it just run the "p1" (the .exe malware).

<p>We recheck the run result of any decoding method we did. In this case I just commented the line 116 and 117 and..as per expected, this script runs and minimizing the window w/o taskbar title:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgawPhhjEAwEKRiqmIS2rJiFobAtXCE3zjgp6_hHqkw_-X2D6EmYbw4lmKMO0U_CwKr2DFO-eE1yqsKclIVCZ1IuFOsvDA5uerg1USyViCUUf7bw4Ay7DezC8QujrMG06pmVG08rubw6kc/s1569/004.PNG"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgawPhhjEAwEKRiqmIS2rJiFobAtXCE3zjgp6_hHqkw_-X2D6EmYbw4lmKMO0U_CwKr2DFO-eE1yqsKclIVCZ1IuFOsvDA5uerg1USyViCUUf7bw4Ay7DezC8QujrMG06pmVG08rubw6kc/s569/004.PNG"></a><br>
And it creates those two files (before execution). I run it many times for fun..NO!" ..for "analysis" (Uhm!), so I can extract randomized injected files to check is it polymorphic or not (and..of course..it is not, NOT with this plain Hex writing crap).<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgp4OdGYld88pNi1RaoqJY2xZutKoA4XuLT1h7FdwuuJA6RNWsq_B3WWFM-w8CprroPUyz-0mc5-Tdk68BImbULeeaRa83IL5i84O-atbr78YLIwcizq-KcyMuCCN0Si0UdcmjCYR_fR8c/s1700/005.PNG"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgp4OdGYld88pNi1RaoqJY2xZutKoA4XuLT1h7FdwuuJA6RNWsq_B3WWFM-w8CprroPUyz-0mc5-Tdk68BImbULeeaRa83IL5i84O-atbr78YLIwcizq-KcyMuCCN0Si0UdcmjCYR_fR8c/s700/005.PNG"></a>

<p>Further, we also formed the binary file-injecting itself from hex-strings directly from the script as per snipped below, to study the possibility of a miss-writing that can happened during forming the PE extraction, the test was done with the same result. A snip of scratch used (thanks to MMD DE team):<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEig5DjMqdJRb78_Wfih3QoMC0YjG6KLlZU5Yt5ss2LpGRY9q_RV6ORHgzhIWlfN-h0pgGvVBVJlujTK_lVihwiyIHZrJP589GDybreQWmcO66aArEUjyoerUVTzKBJmCf6Fymht79VS28M/s940/006.PNG"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEig5DjMqdJRb78_Wfih3QoMC0YjG6KLlZU5Yt5ss2LpGRY9q_RV6ORHgzhIWlfN-h0pgGvVBVJlujTK_lVihwiyIHZrJP589GDybreQWmcO66aArEUjyoerUVTzKBJmCf6Fymht79VS28M/s580/006.PNG"></a>
<br>We also check bit-by-bit to make sure which samples belong to which installers, since this malware looks hit some victims / more than one time.

<p>So what does this ".exe" malware do? 

<p><h2>Polymorphic self-copy & new process spawner</h2>

<p>I picked the .exe file dropped by this .hta installer with the MD5 hash f38d0fb4f1ac3571f07006fb85130a0d, this malware was uploaded to VT about 7 months ago.

<p>The malware is the one was dropped by the installer, you can see the same last bits before blobs of "00" hex were written in the malware binary as per snipped and red-marked color in the VB script mentioned in the previous section:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEguy7kVikKDbpNWzenx9pFyitFNmgbNzoU95w2yXgugB51fo0PyQMcy-OybVqWmn99TEHWJdTzgtrIoJGxCrtDQdOoAbaSZyu8FJTuvf_tqwwMeSh1sFIO9MTubo-ww_2wzJVangQs1h1o/s1644/007.PNG"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEguy7kVikKDbpNWzenx9pFyitFNmgbNzoU95w2yXgugB51fo0PyQMcy-OybVqWmn99TEHWJdTzgtrIoJGxCrtDQdOoAbaSZyu8FJTuvf_tqwwMeSh1sFIO9MTubo-ww_2wzJVangQs1h1o/s644/007.PNG"></a>

<p>This binary is having an interesting functionality. There's so much to write from it..but I will go to important highlights, or this post is going to be a book. Among all usual malicious tricks for evasion & "reverse/debug checking" tricks used, it was designed to detect the way it was called. When it was initially executed as the form of the dropped .exe from the .hta installer it will delete the original file and rewrite itself to the %Temp% folder using the random Hex-filename with ".tmp" extension, below is the partial writing codes snipped for it:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgi9hT6tYqpox0wknpoDB88suwETJuyDY2ZNNaqDPC4Nb-Kw8TBUqTBGr1HwZxPYfB76GUl81r-C8iIMRUJBzaMoCr6xQ03LTb1IPbf_z50NFF3V4JASHu9u91JbqvOSi8cv2or07Q0ot0/s1539/008.PNG"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgi9hT6tYqpox0wknpoDB88suwETJuyDY2ZNNaqDPC4Nb-Kw8TBUqTBGr1HwZxPYfB76GUl81r-C8iIMRUJBzaMoCr6xQ03LTb1IPbf_z50NFF3V4JASHu9u91JbqvOSi8cv2or07Q0ot0/s539/008.PNG"></a><br>
The self-copied files are polymorphic, below some PoC, one AV evasion detection designed:<br>
<pre class="brush: js">Size   Exec Date    Filename MD5
-------------------------------------------------------------
438272 Aug 23 01:28 10.tmp*  577237bfd9c40e7419d27b7b884f95d3
438272 Aug 23 07:22 17.tmp*  9451a18db0c70960ace7d714ac0bc2d2
438272 Aug 23 07:36 18.tmp*  53d57a45d1b05dce56dd139fc985c55e
438272 Aug 23 07:39 19.tmp*  387321416ed21f31ab497a774663b400
438272 Aug 23 07:43 1A.tmp*  0a65ecc21f16797594c53b1423749909
438272 Aug 23 07:44 1B.tmp*  91a49ed76f52d5b6921f783748edab01
438272 Aug 23 07:44 1C.tmp*  f89571efe231f9a05f9288db84dcb006
438272 Aug 23 07:45 1D.tmp*  7ca95b52ed43d71e2d6a3bc2543b4ee1
438272 Aug 23 07:46 1E.tmp*  faec9c62f091dc2163a38867c28c224d
438272 Aug 23 07:47 1F.tmp*  4b02063c848181e3e846b59cbb6b3a46
438272 Aug 23 08:14 20.tmp*  5c8f2f581f75beff1316eee0b5eb5f6d
438272 Aug 23 01:19 F.tmp*   b466cb01558101d934673f56067f63aa 
      :              :</pre>
It'll then create the process (with the command line API), which will be executed at the function reversed below, I put default IDA commented information since it is important for all of us (not only reverser) to understand flow used below, pls bear the length, just please scroll down to skip these assembly explanation (unless you interest to know how it works):
<pre class="brush: asm">0x40BF20 sub_40BF20 proc near
0x40BF20
0x40BF20 StartupInfo= _STARTUPINFOW ptr -8508h
0x40BF20 ProcessInformation= _PROCESS_INFORMATION ptr -84C4h
0x40BF20 var_84B4= dword ptr -84B4h
0x40BF20 CommandLine= word ptr -84B0h
0x40BF20 FileName= word ptr -4B0h
0x40BF20 ApplicationName= dword ptr -2A8h
0x40BF20 var_A0= dword ptr -0A0h
0x40BF20 var_1C= dword ptr -1Ch
0x40BF20 var_18= dword ptr -18h
0x40BF20 var_10= dword ptr -10h
0x40BF20 var_8= dword ptr -8
0x40BF20 var_4= dword ptr -4
0x40BF20 arg_8= dword ptr  10h
0x40BF20
0x40BF20 push    ebp
0x40BF21 mov     ebp, esp
0x40BF23 push    0FFFFFFFEh
0x40BF25 push    offset unk_4284D0
0x40BF2A push    offset sub_416480
0x40BF2F mov     eax, large fs:0
0x40BF35 push    eax
0x40BF36 sub     esp, 8          ; Integer Subtraction
0x40BF39 mov     eax, 84F0h
0x40BF3E call    sub_4207F0      ; Call Procedure
0x40BF43 mov     eax, dword_42A520
0x40BF48 xor     [ebp+var_8], eax
0x40BF4B xor     eax, ebp  
0x40BF4D mov     [ebp+var_1C], eax
0x40BF50 push    ebx
0x40BF51 push    esi
0x40BF52 push    edi
0x40BF53 push    eax
0x40BF54 lea     eax, [ebp+var_10] 
0x40BF57 mov     large fs:0, eax
0x40BF5D mov     [ebp+var_18], esp
0x40BF60 mov     esi, [ebp+arg_8]
0x40BF63 xor     ebx, ebx      
0x40BF65 push    ebx     
0x40BF66 call    ds:CoInitialize ; CoInitialize@OLE32.DLL (Import, LPVOID, pvReserved)
0x40BF6C mov     [ebp+var_4], ebx ; Initializes COM lib
0x40BF6F push    6               ; push 0x06h
0x40BF71 push    offset aHelp    ; is a UTF-16 "--help" for params
0x40BF76 push    esi
0x40BF77 call    sub_41196F      ; func to comp & add chars
0x40BF7C add     esp, 0Ch  
0x40BF7F test    eax, eax     
0x40BF81 jz      loc_40C13E  
  :
0x40BF87 call    sub_409740      ; func to control svc manager, grab db (info)
0x40BF8C xor     eax, eax   
0x40BF8E mov     [ebp+FileName], ax
0x40BF95 push    206h
0x40BF9A push    ebx
0x40BF9B lea     ecx, [ebp-4AEh] ; Load addr  to ECX w/Filename
0x40BFA1 push    ecx
0x40BFA2 call    sub_412510      ; func to check+strings operation (XOR, shift right)
0x40BFA7 add     esp, 0Ch        ; 12 (0x0c) to be added to the stack
0x40BFAA push    104h    
0x40BFAF lea     edx, [ebp+FileName] ; filename
0x40BFB5 push    edx             ; push it to stack
0x40BFB6 push    ebx             ; arg; hModule
0x40BFB7 call    ds:GetModuleFileNameW ; grab process filename
0x40BFBD test    eax, eax   
0x40BFBF jz      loc_40C15D  
  :
0x40BFC5 xor     eax, eax   
0x40BFC7 mov     word ptr [ebp+ApplicationName], ax
0x40BFCE push    206h
0x40BFD3 push    ebx
0x40BFD4 lea     ecx, [ebp+ApplicationName+2] ; Load this appname
0x40BFDA push    ecx             ; pushing appname to the stack
0x40BFDB call    sub_412510      ; check+strings operation (XOR, shift right)
0x40BFE0 add     esp, 0Ch        ; 12 (0x0c)to be added to the stack
0x40BFE3 lea     edx, [ebp+ApplicationName] ; stored appname
0x40BFE9 push    edx             ; push arg lpBuffer
0x40BFEA push    104h            ; and its length (nBufferLength)
0x40BFEF call    ds:GetTempPathW ; grab %Temp% path
0x40BFF5 test    eax, eax       
0x40BFF7 jz      loc_40C15D     
  :
0x40BFFD lea     eax, [ebp+ApplicationName] 
0x40C003 push    eax             ; to stack, arg; lpTempFileName
0x40C004 push    ebx             ; to stack, arg; uUnique
0x40C005 push    ebx             ; to stack, arg; lpPrefixString
0x40C006 mov     ecx, eax
0x40C008 push    ecx             ; lpPathName / push Path..
0x40C009 call    ds:GetTempFileNameW ; grab %Temp%+%Filename%
0x40C00F test    eax, eax    
0x40C011 jz      loc_40C15D  
  :
0x40C017 call    sub_4079C0      ; To func CryptAcquireContextW..CryptRelease OP.
0x40C01C test    eax, eax       
0x40C01E jz      loc_40C15D     
  :
0x40C024 mov     byte ptr [ebp+var_A0], bl ; reserved pointer data to var
0x40C02A push    80h             ; push WritePrivateProfileString to stack
0x40C02F push    ebx             ; push lpPrefixString to stack
0x40C030 lea     edx, [ebp+var_A0+1] ; load rsv pointer address
0x40C036 push    edx             ; push rsv pointer to stack
0x40C037 call    sub_412510      ; to func to check+strings operation (XOR, shift right)
0x40C03C add     esp, 0Ch        ; 12 (0x0c) has to be added to the stack
0x40C03F mov     [ebp+var_84B4], 81h ; EBP to WritePrivateProfileString
0x40C049 lea     edx, [ebp+var_84B4] ; load EBP
0x40C04F lea     eax, [ebp+var_A0] ; load EAX
0x40C055 call    sub_40A300      ; to fnc OP Shift right+4 etc..
0x40C05A test    eax, eax    
0x40C05C jz      loc_40C15D  
  :
0x40C07B xor     eax, eax        ; cleanu
0x40C07D mov     [ebp+CommandLine], ax ; prep exec/command line
0x40C084 push    7FFEh
0x40C089 push    ebx             ; push lpPrefixString
0x40C08A lea     ecx, [ebp-84AEh] ; Load eff addr of ECX
0x40C090 push    ecx             ; push eff adr into stack
0x40C091 call    sub_412510      ; check+strings operation (XOR, shift right)
0x40C096 lea     edx, [ebp+var_A0] ; load eff addr lpFileName
0x40C09C push    edx             ; psh lpFileName to stack
0x40C09D lea     eax, [ebp+FileName] ; load eff addr fur filename
0x40C0A3 push    eax             ; push into stack
0x40C0A4 lea     ecx, [ebp+ApplicationName] ; load eff addr appname
0x40C0AA push    ecx             ; push appname to stack
0x40C0AB push    offset aSHelpSS ; get "\"%s\" --help%s\t%S" command executed template into stack
                                 ; started from the above written path/filename, this file's path+name 
                                 ; and %S strings from encryption result
0x40C0B0 push    4000h
0x40C0B5 lea     edx, [ebp+CommandLine] ; load eff addr exec/cmd line
0x40C0BB push    edx             ; push cmd/exec to stack
0x40C0BC call    sub_411448      ; goto 0x0410A42, obfuscation
0x40C0C1 mov     [ebp+StartupInfo.cb], ebx ; transfer the startup info
0x40C0C7 push    40h             ; AccessResource
0x40C0C9 push    ebx             ; push to stack
0x40C0CA lea     eax, [ebp+StartupInfo.lpReserved] ; load eff addr for StartupInfo+IpReserved
0x40C0D0 push    eax             ; push that into stack
0x40C0D1 call    sub_412510      ; deobfuscation shif -1 is here
0x40C0D6 add     esp, 30h        ; Add ESP w/30h
0x40C0D9 mov     [ebp+StartupInfo.cb], 44h ; transfer startups to EBP
0x40C0E3 xor     ecx, ecx        ; cleanup ECX
0x40C0E5 mov     [ebp+StartupInfo.wShowWindow], cx ;  forming startups info here..
0x40C0EC mov     [ebp+StartupInfo.dwFlags], 1
0x40C0F6 mov     [ebp+ProcessInformation.hProcess], ebx
0x40C0FC xor     eax, eax        ; cleanup prep EAX
0x40C0FE mov     [ebp+ProcessInformation.hThread], eax ; forming process-info here..
0x40C104 mov     [ebp+ProcessInformation.dwProcessId], eax
0x40C10A mov     [ebp+ProcessInformation.dwThreadId], eax
0x40C110 lea     edx, [ebp+ProcessInformation] ; Load Effective Address
0x40C116 push    edx             ; Push all info to stack as lpProcessInformation
0x40C117 lea     eax, [ebp+StartupInfo] ; assemble startinfo into EAX
0x40C11D push    eax             ; lpStartupInfo
0x40C11E push    ebx             ; lpCurrentDirectory
0x40C11F push    ebx             ; lpEnvironment
0x40C120 push    8000000h        ; dwCreationFlags
0x40C125 push    ebx             ; bInheritHandles
0x40C126 push    ebx             ; lpThreadAttributes
0x40C127 push    ebx             ; lpProcessAttributes
0x40C128 lea     ecx, [ebp+CommandLine] ; startupinfo+cmd
0x40C12E push    ecx             ; lpCommandLine
0x40C12F lea     edx, [ebp+ApplicationName] ; process info loaded
0x40C135 push    edx             ; lpApplicationName pushed to stack
0x40C136 call    ds:CreateProcessW ; stdcall to start process w/flags
0x40C13C jmp     short loc_40C15D </pre>if the .hta dropped malware named "sample.exe", new process will be started by launching command line contains parameters described below:
<pre class="brush: asm">"CreateProcessW","C:\DOCUME~1\...\LOCALS~1\Temp\RANDOM[0-9A-F]{1,2}.tmp","SUCCESS|FAIL","PID: xxx, 
Command line: ""C:\DOCUME~1\...\LOCALS~1\Temp\RANDOM[0-9A-F]{1,2}.tmp"" \n
--helpC:\DOCUME~1\...\LOCALS~1\Temp\sample.exe \n
BCE6D32D8CD4F1E6A1064F66D561FDA47E0CD5F8F330C4856A250BB104BC18320FF75E6E56A1741C6770AD238DCFD23DD8A82DDF332FDC8110972549B4FE6D37"</pre>The decryption function used is as per below:<br>
<center><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgMlPGMZ4-h64jbTL8QkqFal7JvUwNUVNiqBrhSvZaRL7EEMgtxXfR_Eb5nVS_MzlQMvofs-seZOJzpw8KTJVzaDEvTp4MIaesJ-u3-9yAyRTmzlcO32A8PYa-bsNGl3lUTFJ7Thn55RD8/s1152/011.png"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgMlPGMZ4-h64jbTL8QkqFal7JvUwNUVNiqBrhSvZaRL7EEMgtxXfR_Eb5nVS_MzlQMvofs-seZOJzpw8KTJVzaDEvTp4MIaesJ-u3-9yAyRTmzlcO32A8PYa-bsNGl3lUTFJ7Thn55RD8/s400/011.png"></a></center>
And this malware will end its process here, raising new process that has just been executed..

<p><h2>More drops & payload installation</h2>

<p>The process RANDOM[0-9A-F]{1,2}.tmp started by allocated memory, loading rpcss.dll, uxtheme.dll, MSCTF.dll before it self deleting the dropper .exe. The snip code for the deletion is as per below, this isn't also an easy operation, it checks whether the file is really there, if not it makes sure it is there..
<pre class="brush: asm">0x40A648 push    edi             ; push pszPath into stack
0x40A649 call    ds:PathFileExistsW ; get the path
  :
0x40A657 push    0Ah             ; lpType
0x40A659 push    65h             ; lpName
0x40A65B push    ebx             ; hModule (for the FindResourceW)
0x40A65C call    ds:FindResourceW ; Indirect Call to get resouce
0x40A662 mov     esi, eax        ; feed esi w/eax
0x40A664 cmp     esi, ebx        ; condition to check if ESI contains file data
0x40A666 jz      loc_0x40A7CB      ; then goto file deletion below:
  :
0x40A7CB loc_0x40A7CB:             ; lpFileName
0x40A7CB push    edi             ; push path+filename to stack
0x40A7CC call    ds:DeleteFileW  ; call API DeleteFileW@KERNEL32.DLL (Import, 1 Params)
0x40A7D2 mov     [ebp+var_18], 1 ; Execution, note: mov dword ptr [ebp-18h], 0x01h

;; ..OR fill the ESI and make sure it was executed..

0x40A779 mov     ecx, [ebp+lpFile]
0x40A77C mov     edx, [ebp+lpExistingFileName]
0x40A77F push    ecx             ; lpNewFileName
0x40A780 push    edx             ; lpExistingFileName
  :
0x40A78B mov     eax, [ebp+lpFile] ; eax < file opeation info
0x40A78E push    1               ; nShowCmd
0x40A790 push    ebx             ; lpDirectory
0x40A791 push    ebx             ; lpParameters
0x40A792 push    eax             ; lpFile
0x40A793 push    ebx             ; lpOperation
0x40A794 push    ebx             ; hwnd
0x40A795 call    ds:ShellExecuteW ; prep shell to exec/open file
0x40A79B mov     [ebp+var_18], 1
  :</pre>..up to this point I know that we're dealing with a tailored-made malware.

<p>Back to the highlights, RANDOM[0-9A-F]{1,2}.tmp executed with the right condition will drop payloads of this threat, the first drop is the real deal payload, following by the second drop as the its driver. The file creation of first payload is handled in function 0x41FC90, with the related snip below:
<pre class="brush: asm">0x41FEAF mov     eax, [ebp+arg_0]
0x41FEB2 mov     edi, ds:CreateFileW ; prep API CreateFileW@KERNEL32.DLL (import, 7 attribs at 0x41FED0)
0x41FEB8 push    0               ; prepare hTemplateFile to stack
0x41FEBA push    [ebp+dwFlagsAndAttributes] ; to stack: dwFlagsAndAttributes
0x41FEBD mov     dword ptr [eax], 1
0x41FEC3 push    [ebp+dwCreationDisposition] ; dwCreationDisposition
0x41FEC6 lea     eax, [ebp+SecurityAttributes] ; load w/add sec-attrib
0x41FEC9 push    eax             ; lpSecurityAttributes to stack
0x41FECA push    [ebp+dwShareMode] ; dwShareMode
0x41FECD push    [ebp+dwDesiredAccess] ; dwDesiredAccess
0x41FED0 push    [ebp+lpFileName] ; push EBP with lpFileName & its data assembled:
0x41FED0                         ; C:\Documents and Settings\...\Application Data\Common Files\defrag.exe
0x41FED0                         ; "SUCCESS|FAIL",
0x41FED0                         ; "Desired Access: Read Attributes,
0x41FED0                         ; Disposition: Open,
0x41FED0                         ; Options: Open Reparse Point,
0x41FED0                         ; Attributes: n/a,
0x41FED0                         ; ShareMode: Read, Write, Delete,
0x41FED0                         ; AllocationSize: n/a,
0x41FED0                         ; OpenResult: Open|Fail"
0x41FED3 call    edi ; CreateFileW ; Call API 
0x41FED5 mov     [ebp+hHandle], eax ; Boom! File create execution..</pre>And the writing this file is written in function 0x418EC2 after deobfuscating data part, as per snipped here:
<pre class="brush: asm">0x418FB9 mov     eax, [eax+6Ch]
0x418FBC xor     ecx, ecx        ; cleanup ECX
0x418FBE cmp     [eax+14h], ecx  ; Compare Two Operands
0x418FC1 lea     eax, [ebp+CodePage] ; Load Effective Address
0x418FC7 setz    cl              ; Set Byte if Zero (ZF=1)
0x418FCA push    eax             ; lpMode
0x418FCB mov     eax, [ebx]
0x418FCD push    dword ptr [edi+eax] ; hConsoleHandle, val=0x01(write)
0x418FD0 mov     esi, ecx
0x418FD2 call    ds:GetConsoleMode ; in this case is output mode console screen buffer.
  : (etc etc)
0x4194F0 push    ecx             ; lpOverlapped
0x4194F1 lea     ecx, [ebp+var_1AD8] ; load eff addr lpNumberOfBytesWritten
0x4194F7 push    ecx             ; push lpNumberOfBytesWritten to stack
0x4194F8 push    [ebp+nNumberOfBytesToWrite] ; length, value (dec) 4,096 why??
0x4194FB push    [ebp+lpBuffer]  ; lpBuffer
0x419501 push    dword ptr [eax+edi] ; hFile (the defrag.exe)
0x419504 call    ds:WriteFile    ; Indirect Call Near Procedure
0x41950A test    eax, eax        ; Execution to write...
0x41950C jz      short loc_0x419523 ; Jump if Zero (ZF=1)
  :
0x419523 call    ds:GetLastError
0x419529 mov     dword ptr [ebp+WideCharStr], </pre>we recorded this drop operation in the forensics way too, as per below as evidence:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhI2FnSAzmehIyr_Xc2YGJjK0q-NhycbRpqGWI4wdqBbsCt4VT7hLHuy0QK3-yDExVyQdWZJTRHIEZukyMSgvIHbuE1q-BGIAEyCFuX3C89-CVH49FMMatwvu88A3a8ekM1BATtQebZ69k/s1152/2004.png"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhI2FnSAzmehIyr_Xc2YGJjK0q-NhycbRpqGWI4wdqBbsCt4VT7hLHuy0QK3-yDExVyQdWZJTRHIEZukyMSgvIHbuE1q-BGIAEyCFuX3C89-CVH49FMMatwvu88A3a8ekM1BATtQebZ69k/s400/2004.png"></a><br>As you can see the wiring method is in redundancy per 4096 bytes.

<p>This first drop called defrag.exe looks pretty much like Windows harddisk defragmentation tool, down to its property, a perfectly crafted evil file:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjNTPDzXMtUdEmfIN8di5jkQfr-iTghr-5aaa5g9v8b872Pf_sLZDoWgjP-iR1WS4RVPyEI59LUhRpTqd5V818BFoUTSE8eFxDVwfaXfTfSxd3lpc2G6o8GaO8atowgR4GoYWTJzlMSLrg/s1401/2001.png"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjNTPDzXMtUdEmfIN8di5jkQfr-iTghr-5aaa5g9v8b872Pf_sLZDoWgjP-iR1WS4RVPyEI59LUhRpTqd5V818BFoUTSE8eFxDVwfaXfTfSxd3lpc2G6o8GaO8atowgR4GoYWTJzlMSLrg/s401/2001.png"></a>

<p>Only by using good analysis binary static analysis tool like PEStudio (<a href="http://winitor.com/">maker</a>: Marc Oschenmeier), we can spot and focus investigation to the badness indicators right away:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiP_-YdLPIkINkc9-vJfIsYeXngapnY7F_Y6nst3ouhQdEpHKTdAKx7XcAtuTz7kpI6HBkIirxLrqZJaenPhCBsb9gboIJXj3bk0FEgpeQN3JHjI1FFBXCrkmBAMbQgW2z5JL5Sye_yoVg/s1769/2003.png"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiP_-YdLPIkINkc9-vJfIsYeXngapnY7F_Y6nst3ouhQdEpHKTdAKx7XcAtuTz7kpI6HBkIirxLrqZJaenPhCBsb9gboIJXj3bk0FEgpeQN3JHjI1FFBXCrkmBAMbQgW2z5JL5Sye_yoVg/s400/2003.png"></a>
<blockquote class="twitter-tweet" data-conversation="none" lang="en"><p><a href="https://twitter.com/MalwareMustDie">@MalwareMustDie</a> Thx for using PEStudio for your investigation. In that case, PEStudio indicating that the image is a fake Microsoft EXE! :-)</p>&mdash; Marc Ochsenmeier (@ochsenmeier) <a href="https://twitter.com/ochsenmeier/statuses/503855648866832384">August 25, 2014</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>The next drop is the next task of this binary, noted that none of these drops were fetched from internet instead the data is already included in .hta or .[random].exe or [random.tmp].<br>Using the exactly the same functions described above, 0x41FC90 for creation and 0x418EC2 for writing, the second drop operation were also performed. The file name is formed as per below strings:
<pre class="brush: js">"%USERPROFILE%\AppData\Identities\{RANDOM-ID}\disk1.img"
like:
"C:\Documents and Settings\MMD\Application Data\Identities\{116380ff-9f6a-4a90-9319-89ee4f513542}\disk1.img"
</pre>the forensics PoC is:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgb1vKca-IBHVHT8B-dwGXBOKvptJkEy7SZo-7R5ZsDtY_JsEpSia2w59eAOgaiQrG7Wahyphenhyphenxgqsd7NmhkP6JwGdLxfznBiCStIU8M4eMgODMTnVHmLPqdmd0hWrTkNsFry7ZTMAPpP5mHA/s1552/2005.png"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgb1vKca-IBHVHT8B-dwGXBOKvptJkEy7SZo-7R5ZsDtY_JsEpSia2w59eAOgaiQrG7Wahyphenhyphenxgqsd7NmhkP6JwGdLxfznBiCStIU8M4eMgODMTnVHmLPqdmd0hWrTkNsFry7ZTMAPpP5mHA/s400/2005.png"></a>
<br>This file is actually a DLL file, here's some peframe:
<pre class="brush: js">File Name:      disk1.img
PE32 executable for MS Windows (DLL) (GUI) Intel 80386 32-bit
File Size:      249344 byte
Compile Time:   2010-08-14 17:16:08
"DLL:            True"
Entry Point: 0x0001BBD1
Sections:       4
MD5   hash:     62646ea0a4ce1e6d955cbaef8c4a510d
SHA-1 hash:     10116a65e19a7ebc6702250cc1caabf755ce8e7f
Anti Debug:     Yes
Anti VM:        None</pre>And Virus Total showing the good infection info:
<pre class="brush: js">First submission 2013-03-11 10:38:19 UTC ( 1 year, 5 months ago )
Last submission 2014-01-21 12:49:00 UTC ( 7 months ago )
File names disk1.dl, disk1.img</pre>

<p>This file is then performing registry query and writing operations, I will skip some assembly for this, so shortly, these are the 8 keys added, below data I snip from forensics result:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEge2hB63o4bcGKFzDo-0VUJnCqn6W15j1oGdOF45Rg4OnRMo3TDnB5riILmdxSpe7u-AmSvLbLoLiEQfxl0qE6iatnWeTCdXFVhPX6fwUv2r0fQoMgIemdsZAs_3H82CjNSgSwdMbIOZas/s1500/2006.png"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEge2hB63o4bcGKFzDo-0VUJnCqn6W15j1oGdOF45Rg4OnRMo3TDnB5riILmdxSpe7u-AmSvLbLoLiEQfxl0qE6iatnWeTCdXFVhPX6fwUv2r0fQoMgIemdsZAs_3H82CjNSgSwdMbIOZas/s400/2006.png"></a><br><br>
We can see the autostart, and the way it camouflage malicious data in registry using legit scattered softwares and Windows components. Like: Auslogic (RecoveryDataStore), Photo Viewer, Disk Defragment Module, Microsoft Remote Assitance. This all means to hide and prevent the quick notice of this malware in the infected PC, it is a well thought plan.<br>
To be noted that one of the key is used to run the defrag.exe execution via ShellExecuteW by the [Random].tmp file, and also you can see the "key" used for this malware saved, one last thing to be noticed is the the bot ID used.
<p>PS: There are also more drops made which are the Windows task installer for this malware
<pre class="brush: js">C:\Windows\Tasks\ScheduledDefrag.job
C:\Windows\Tasks\ScheduledDefrag_admin.job</pre>It is the Windows scheduler (kinda crond) to execute the EXE payload (defrag.exe). Pic:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhdGURCiX31jtuemRKrVvz_wNUTkleC08ZsjQvb1OyKF-_cjXDpeZKSoSCDLKIWcUe7BwI6YJBrpiwSAb-PZvbrlgjeK5CCNUq6LiSgM0hcYiWA2JMLpHXjn-azqi1YZ7QnI662O1W6rVY/s1800/3008.png"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhdGURCiX31jtuemRKrVvz_wNUTkleC08ZsjQvb1OyKF-_cjXDpeZKSoSCDLKIWcUe7BwI6YJBrpiwSAb-PZvbrlgjeK5CCNUq6LiSgM0hcYiWA2JMLpHXjn-azqi1YZ7QnI662O1W6rVY/s400/3008.png"></a>

<p><h2>What this payload does</h2>

<p>First thing that caught interest and attention is these obfuscation constant variables saved in .rdata section:
<pre class="brush: asm">0x40F3AC ; const WCHAR aTztxpx75Xtdsjq
0x40F3AC aTztxpx75Xtdsjq:
0x40F3AC    unicode 0, <"tztxpx75]xtdsjqu/fyf">,0
0x40F3D6    align 4
0x40F3D8 ; const WCHAR aTztufn43Xtdsjq
0x40F3D8 aTztufn43Xtdsjq:
0x40F3D8    unicode 0, <"tztufn43]xtdsjqu/fyf">,0
0x40F402    align 4
0x40F404 ; const WCHAR a2e6g3ddEmm
0x40F404 a2e6g3ddEmm: 
0x40F404    unicode 0, <"2e6g3dd/emm">,0
0x40F430 ; const WCHAR aQsphsbnGjmftY9
0x40F430 aQsphsbnGjmftY9: 
0x40F430    unicode 0, <"Qsphsbn!Gjmft!)y97*]Joufsofu!Fyqmpsfs]jfmpxvujm/fyf">,0
0x40F498 ; const WCHAR aQsphsbnGjmftNf
0x40F498 aQsphsbnGjmftNf: 
0x40F498    unicode 0, <"Qsphsbn!Gjmft]Nfttfohfs]ntntht/fyf">,0
0x40F4DE    align 10h
0x40F4E0 ; const WCHAR aQsphsbnGjmft_0
0x40F4E0 aQsphsbnGjmft_0:
0x40F4E0    unicode 0, <"Qsphsbn!Gjmft!)y97*]Joufsofu!Fyqmpsfs]jfyqmpsf/fyf">,0
0x40F546    align 4
0x40F548 ; const WCHAR aQsphsbnGjmftJo
0x40F548 aQsphsbnGjmftJo: 
0x40F548    unicode 0, <"Qsphsbn!Gjmft]Joufsofu!Fyqmpsfs]jfyqmpsf/fyf">,0
0x40F5A2    align 4</pre>We have good decoder team in MMD. Soon these data were translated as per below:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi3RsFj0fgkdScA8D_wa0_NP4fHTxxRgLughliOKEExzUnIelrGFfzFQPYEQT9Qpek3eiGJr8rkPThvOkkACKWbDvfl75_ODsOCky6XTCxNEukiLkvz5dOi_AiwHIjQtRPZEM0AfPqO-6g/s1415/2007.png"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi3RsFj0fgkdScA8D_wa0_NP4fHTxxRgLughliOKEExzUnIelrGFfzFQPYEQT9Qpek3eiGJr8rkPThvOkkACKWbDvfl75_ODsOCky6XTCxNEukiLkvz5dOi_AiwHIjQtRPZEM0AfPqO-6g/s400/2007.png"></a><br>
When these data formed in the functions where they were called, we will have better idea of WHY these strings were obfuscated. This time we will take a look at the dump analysis in disassembly, to seek the executed code parts only:
<pre class="brush: asm">;;Loads a malicious DLL "1d5f2cc.dll" (later on known as disk1.img))

0x0C22D37  call 0x0C28720h  target: 0x0C28720
0x0C22D3C  add esp, 0Ch  
0x0C22D3F  push 0x0C2F404h <== UTF-16 "2e6g3dd/emm" ; DECODED "1d5f2cc.dll"
0x0C22D44  lea edx, dword ptr [ebp-00000084h]  
0x0C22D4A  push edx  
0x0C22D4B  call dword ptr [0x0C2D06Ch]  lstrcpyW@KERNEL32.DLL 

;; Strings for "\Software\Auslogics" entry in registry

0xC2207C  lea ecx, dword ptr [ebp-00000802h]  
0xC22082  push ecx  
0xC22083  mov word ptr [ebp-00000804h], ax  
0xC2208A  call 00C28720h  target: 00C28720
0xC2208F  add esp, 0Ch  
0xC22092  push 00C2F278h <== UTF-16 "Tpguxbsf]Bvtmphjdt]|11111111.1111.1111.1111.111111111111~]SfdpwfszEbubTupsf"
         ; DECODED: "Software\Auslogics\{00000000-0000-0000-0000-000000000000}\RecoveryDataStore"

;; Checks path/process iexplorer.exe ..depends on system...
0x0C22A4E  call ebx  PathFileExistsW@SHLWAPI.DLL (Import, 1 Params)
0x0C22A50  test eax, eax  
0x0C22A52  jne 0x0C22AB8h  target: 0x0C22AB8
0x0C22A54  push 0x0C2F4E0h <== UTF-16 "Qsphsbn!Gjmft!)y97*]Joufsofu!Fyqmpsfs]jfyqmpsf/fyf"
           ; DECODED: "Program Files (x86)\Internet Explorer\iexplore.exe"

;; This look bad, why "Skype" is here??

0x0C22625  xor eax, eax  
0x0C22627  push 0000007Eh  
0x0C22629  push eax  
0x0C2262A  lea ecx, dword ptr [ebp-0x000086h]  
0x0C22630  push ecx  
0x0C22631  mov word ptr [ebp-0x000088h], ax  
0x0C22638  call 0x0C28720h  target: 0x0C28720
0x0C2263D  mov esi, dword ptr [0x0C2D06Ch]  lstrcpyW@KERNEL32.DLL
0x0C22643  add esp, 0Ch  
0x0C22646  push 0x0C2F360h <== UTF-16 "//]tlzqf/fyf"
           ; DECODED "..\skype.exe"
0x0C2264B  lea edx, dword ptr [ebp-0x000088h]  
0x0C22651  push edx  
0x0C22652  call esi  lstrcpyW@KERNEL32.DLL

;; And checks for Messenger too.??

0x0C229DB  push edx  
0x0C229DC  call ebx  PathFileExistsW@SHLWAPI.DLL 
0x0C229DE  test eax, eax  
0x0C229E0  jne 0x0C22A46h  target: 0x0C22A46
0x0C229E2  push 0x0C2F498h <== UTF-16 "Qsphsbn!Gjmft]Nfttfohfs]ntntht/fyf" ; 
           ; DECODED: "Program Files\Messenger\msmsgs.exe"
0x0C229E7  lea eax, dword ptr [esp+74h]  
0x0C229EB  push eax  
0x0C229EC  call esi  lstrcpyW@KERNEL32.DLL

;; wscript.exe path..this must be used for something bad..

0x0C22876  call dword ptr [0x0C2D090h]  GetVersion@KERNEL32.DLL (Import, 0 Params)
0x0C2287C  mov esi, dword ptr [0x0C2D06Ch]  lstrcpyW@KERNEL32.DLL (Import, 2 Params)
0x0C22882  push 0x0C2F3ACh <== UTF-16 "tztxpx75]xtdsjqu/fyf"; DECODED: "syswow64\wscript.exe"
0x0C22887  lea eax, dword ptr [esp+74h]  
0x0C2288B  push eax  
0x0C2288C  call esi  lstrcpyW@KERNEL32.DLL (Import, 2 Params)</pre>Found this function is interesting, I found the check for username "Administrator" and SUID "system" are checked:
<pre class="brush: asm"> ;; Getting the current user name....

0x0C21FAB  xor bl, bl  
0x0C21FAD  call dword ptr [0xC2D00Ch]  GetUserNameW@ADVAPI32.DLL (Import, 2 Params)
0x0C21FB3  test eax, eax  
0x0C21FB5  je 0x0C21FCEh  target: 0xC21FCE
0x0C21FB7  push 0x0C2F22Ch  <== UTF-16 "system"
0x0C21FBC  lea ecx, dword ptr [ebp-0x000204h]  
0x0C21FC2  push ecx

 ;; Seek for Administrator account...

0x0C21AC9  call dword ptr [0x0C2D014h]  LookupAccountSidW@ADVAPI32.DLL
0x0C21ACF  test eax, eax  
0x0C21AD1  je 0x0C21AFDh  target: 0x0C21AFD
0x0C21AD3  lea ecx, dword ptr [ebp-0x000204h]  
0x0C21AD9  push ecx  
0x0C21ADA  push 0x0C2F1FCh <== UTF-16 "administrators"
0x0C21ADF  call dword ptr [0x0C2D030h]  lstrcmpiW@KERNEL32.DLL
0x0C21AE5  test eax, eax  </pre>Suspicious isn't it? 
<p>I go back to the binary for understanding the related functions, which is in 0x4027F0. 
I was wondering of what is the part of <b>wscript.exe</b> (not again!??) mentioned by this binary. So I trailed the path of the <b>wscript.</b>exe starting here, assumed that the Windows architecture is x64:
<pre class="brush: asm">0x40286E call    sub_408720      ; Check to fill ECX w/Quad deobfs
0x402873 add     esp, 0Ch        ; reserve ESP w/version info
0x402876 call    ds:GetVersion   ; Get current version number of Windows
0x402876                         ; and information about the operating system platform
0x40287C mov     esi, ds:lstrcpyW
0x402882 push    offset aTztxpx75Xtdsjq <== Push: "tztxpx75]xtdsjqu/fyf" to stack
0x402882                         ; Decoded: "syswow64\wscript.exe"
0x402887 lea     eax, [esp+694h+pMore] ; load EAX
0x40288B push    eax             ; lpString1 (push this to the stack)
0x40288C call    esi ; lstrcpyW  ; Indirect Call Near Procedure
0x40288E mov     dx, [esp+690h+pMore]
0x402893 xor     edi, edi        ; Cleanup EDI
0x402895 xor     ecx, ecx        ; Clenup ECX
0x402897 movzx   eax, dx         ; trail of [esp+69Ch+CommandLine]
0x40289A cmp     di, dx          ; A check to goto Appname/path
</pre>then found the binary wscript.exe is executed in this part:
<pre class="brush: asm">0x402B54 xor     eax, eax
0x402B56 push    40h
0x402B58 push    eax
0x402B59 mov     [esp+698h+ProcessInformation.hThread], eax
0x402B5D mov     [esp+698h+ProcessInformation.dwProcessId], eax
0x402B61 mov     [esp+698h+ProcessInformation.dwThreadId], eax
0x402B65 lea     eax, [esp+698h+StartupInfo.lpReserved] ; Load Effective Address
0x402B69 push    eax
0x402B6A mov     [esp+69Ch+ProcessInformation.hProcess], 0
0x402B72 call    sub_408720      ; deobfs procedure..
0x402B77 add     esp, 0Ch        ; prep ESP
0x402B7A xor     ecx, ecx        ; initiate ECX
0x402B7C lea     edx, [esp+690h+ProcessInformation] ; pump EDX w/process info
0x402B80 push    edx             ; lpProcessInformation
0x402B80                         ; goes to stack
0x402B81 lea     eax, [esp+694h+StartupInfo] ; load eff addr EAX filled w/
0x402B81                         ; startup info
0x402B85 push    eax             ; lpStartupInfo goes to stack
0x402B86 push    offset Buffer   ; lpCurrentDirectory
0x402B8B push    ecx             ; lpEnvironment
0x402B8B                         ; (fill ECX w/ cmd execution flags)
0x402B8C push    ecx             ; dwCreationFlags
0x402B8D push    ecx             ; bInheritHandles
0x402B8E push    ecx             ; lpThreadAttributes
0x402B8F push    ecx             ; lpProcessAttributes
0x402B90 mov     [esp+6B0h+StartupInfo.wShowWindow], cx
0x402B95 lea     ecx, [esp+6B0h+CommandLine] ; load ProcInfo,Thread/ProcID+CmdLine
0x402B9C push    ecx             ; lpCommandLine goes to stack
0x402B9D lea     edx, [esp+6B4h+ApplicationName] ; load appname &..
0x402BA4 push    edx             ; lpApplicationName goes ot stack
0x402BA5 mov     [esp+6B8h+StartupInfo.cb], 44h
0x402BAD mov     [esp+6B8h+StartupInfo.dwFlags], 1
0x402BB5 call    ds:CreateProcessW ; process called
0x402BBB test    eax, eax        ; execution
</pre>So we have the wscript.exe process up and running.

<p>Up to this part our teammate poke me in DM, and he asked me what can he helped, so I asked our friend (Mr. Raashid Bhat) to take over the further analysis of this defrag.exe and disk1.img, while I went to other parts, and after a while he came up straight forward with (1) decoder logic, which is match to our crack team did:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEifgp_zp5R-UZ0qmBae4ci1OgH2gpm-_yDiX7v5RA18SoqmDQumTE80Pgs5iyrb5_PdmrzQpFHCQM4VPnqW2R0-ukbTw0_B-CRUYqvMf9sRTAU2WpvyV3CwUA1Taagl0wrWdiIpVKFYNUI/s1606/3001.png"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEifgp_zp5R-UZ0qmBae4ci1OgH2gpm-_yDiX7v5RA18SoqmDQumTE80Pgs5iyrb5_PdmrzQpFHCQM4VPnqW2R0-ukbTw0_B-CRUYqvMf9sRTAU2WpvyV3CwUA1Taagl0wrWdiIpVKFYNUI/s500/3001.png"></a><br>
And (2) the conclusion of what "defrag.exe" is actually doing, is a loader which patches the executed wsscript.exe's ExitProcess to load the DLL "disk1.img"....Well, it's all starts to make more sense now.

<p>Checking the reported data. I confirmed to find the "process was read" from here:
<pre class="brush: asm">;; begins parameter to read process in memory here..
0x4014BB mov     edx, [ebp+nSize]
0x4014C1 lea     ecx, [ebp+NumberOfBytesRead] 
0x4014C7 push    ecx             ; lpNumberOfBytesRead
0x4014C8 mov     ecx, [ebp+lpAddress]
0x4014CE push    edx             ; nSize
0x4014CF lea     eax, [ebp+Buffer] ; 
0x4014D2 push    eax             ; lpBuffer
0x4014D3 push    ecx             ; lpBaseAddress
0x4014D4 push    esi             ; hProcess
0x4014D5 mov     [ebp+NumberOfBytesRead], ebx
0x4014DB call    ds:ReadProcessMemory ; <=====
                 ;&#8593;Reads data from an area of memory in a specified process.
0x4014E1 test    eax, eax        ; execute
</pre>As for the <i>"Exit Process patching"</i> itself, it is a quite sophisticate technique was used. It used a tiny shellcode that was observed within Mem Loc 1 : 009C0000 to 009D0000 (by Raashid). 

<p>The shellcode then was saved in binary which I received and then I was reversing it deeper, it looks like as per following snips:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj76rG4m0actEWj3iRRc8X26AlnUTQeq4YOeLMJ6bmpxFu1xtQNJBFI-x9LSgpIefEtQQXTjA3F-7sF4XsdnQJpfdpFJ_LXiVSxt-d6RqSN_x56TqSg3EsQEq5sg_bJ2okc_ZU3EC-mrNI/s1253/3002.png"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj76rG4m0actEWj3iRRc8X26AlnUTQeq4YOeLMJ6bmpxFu1xtQNJBFI-x9LSgpIefEtQQXTjA3F-7sF4XsdnQJpfdpFJ_LXiVSxt-d6RqSN_x56TqSg3EsQEq5sg_bJ2okc_ZU3EC-mrNI/s400/3002.png"></a><br>
This shellcode I tweaked a bit, is in a plain assembly, contains three addresses of Windows static API call to (I wrote these API in order of calls from top to bottom) <b>LoadLibraryW@kernel32.dll</b>, <b>RtlGetLastWin32Error@ntdll.dll</b>, <b>Sleep@kernel32.dll</b> which can be shown in assembly code of the code as per snips below:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgdCJVe_Sb1jnWDCmn7-YDB3cbfV-ufphcL7M8L_KacdHr1za9Xay036gEU8PfovMgDy2rc1gPOBkBrbtpyfim4G6ufEAvEFIZ_w4qVF9Uz1zqq3w1m6BsXPOydAmRB2Rp0xEK0Vj4N5V4/s1220/3003.png"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgdCJVe_Sb1jnWDCmn7-YDB3cbfV-ufphcL7M8L_KacdHr1za9Xay036gEU8PfovMgDy2rc1gPOBkBrbtpyfim4G6ufEAvEFIZ_w4qVF9Uz1zqq3w1m6BsXPOydAmRB2Rp0xEK0Vj4N5V4/s400/3003.png"></a><br>
So now we know that defrag.exe is actually hacked wscript.exe, hooks ExitProcess Function of kernel32.dll and patches it with a LoadLibraryW@kernel32.dll and loads a DLL string in local (for further execution), does some error-trapping and gives time for the DLL to be processed (loaded and executed). 

<p>OK. So now we have the idea on how this binary sniffs for account, checks for processes and load and use the DLL (disk1.img). There are many more details for more operation in defrag.exe, like searching the process of Auslogic and that skype/messenger buff (also many registry values sniffed too) , but those will be added later after this main course..

<p><h2>The DLL Payload</h2>

<p>This DLL is the goal of this infection. It has operations for networking functionalitiy, contains the CNC information and the data to be sent to the CNC. If you do forensics, you may never see  disk1.img or the deobfuscated DLL filename in the process, but you will see its operation by the patched wscript.exe (for it was hacked to load this DLL, the wscript.exe process should appear).

<p>Below is the DLL part that in charge for the socket connections...
<pre class="brush: asm">;; In function 10010544

10010593 lea     edx, [ebp+var_8]
10010596 push    edx
10010597 lea     edx, [ebp+var_2C]
1001059A push    edx
1001059B push    ecx
1001059C push    eax
1001059D call    ds:getaddrinfo ; networking info
  :
100105C7 push    dword ptr [esi+0Ch] ; protocol
100105CA push    dword ptr [esi+8] ; type
100105CD push    dword ptr [esi+4] ; af
100105D0 call    ds:socket       ; open the socket
100105D6 mov     edi, eax
  :
100105DD push    dword ptr [esi+10h] ; namelen
100105E0 push    dword ptr [esi+18h] ; name
100105E3 push    edi             ; s
100105E4 call    ds:connect ; connected to socket
  :
10010600 push    [ebp+var_8]
10010603 call    ds:freeaddrinfo
10010609 mov     esi, ds:setsockopt
1001060F push    ebx             ; optlen (length)
10010610 lea     eax, [ebp-1]
10010613 push    eax             ; optval (value)
10010614 push    ebx             ; optname
10010615 push    6               ; level
10010617 push    edi             ; s
10010618 mov     [ebp+var_1], bl
1001061B call    esi ; setsockopt ; pass socket connection parameters
1001061D push    4               ; optlen
1001061F lea     eax, [ebp+optval]
10010622 push    eax             ; optval
10010623 push    1006h           ; optname
10010628 push    0FFFFh          ; level
1001062D push    edi             ; s
1001062E call    esi ; setsoc
</pre>..this will be resulted in some internal socket binding operation we spotted in the debug mode as:
<pre class="brush: js">Bind IP  Port   Status          (n) HookAddr  API Calls
--------------------------------------------------------
0.0.0.0  51902  success  1  100105A3  getaddrinfo
0.0.0.0  52652  success  1  100105A3  getaddrinfo
0.0.0.0  57334  success  1  100105A3  getaddrinfo
0.0.0.0  1209   success  1  100105EA  connect
0.0.0.0  54643  success  1  100105A3  getaddrinfo
0.0.0.0  53539  success  1  100105A3  getaddrinfo
0.0.0.0  54536  success  1  100105A3  getaddrinfo
0.0.0.0  1210   success  1  100105EA  connect
0.0.0.0  51696  success  1  100105A3  getaddrinfo
</pre>Which one of them is successfully established connection to CNC:
<pre class="brush: js">Bind IP  Port   Status          (n) HookAddr  API Calls
--------------------------------------------------------
"91.229.77.179  8008  success" or wait  2  100105EA  connect</pre>

<p>From the further reversing section for this DLL (which was done by Raashid), the domains are encoded using single byte move. and can be seen in the below IDA snapshot:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjw9Y41gszXvg-Ys2S8_DZ-7ffWubuJ7WCTCCD2kaWWv0CxI13Nn323R9te_71TAs_6gn6CwN-LMfdWLwtoG7DAP-yzWf5yH-clT5POVnXN4yfZcA19i8dDCTDNz_i3ymnSUoAXnvsB-So/s1564/333-10614873_696555723758630_1275416909_o.jpg"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjw9Y41gszXvg-Ys2S8_DZ-7ffWubuJ7WCTCCD2kaWWv0CxI13Nn323R9te_71TAs_6gn6CwN-LMfdWLwtoG7DAP-yzWf5yH-clT5POVnXN4yfZcA19i8dDCTDNz_i3ymnSUoAXnvsB-So/s400/333-10614873_696555723758630_1275416909_o.jpg"></a><br>
Which sending the below blobs of binary:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhFusPNyHd_B4jUI5QhFqO1UpDgsjhZ_svQVdMk7lMa8owDraXNaRr68jJ2gjgQVSqUjBhF8puxBN1962RcQMVewIFk2j8YI2YIAkaYvy1anE70jNbz2FCiHzw_ce-IkabIP_h40hOy3U8/s1424/CNCBlogInit.png"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhFusPNyHd_B4jUI5QhFqO1UpDgsjhZ_svQVdMk7lMa8owDraXNaRr68jJ2gjgQVSqUjBhF8puxBN1962RcQMVewIFk2j8YI2YIAkaYvy1anE70jNbz2FCiHzw_ce-IkabIP_h40hOy3U8/s400/CNCBlogInit.png"></a><br>

<p>When I received the result, since I had the report that the CNC was down at the time reversed, I used the local dummy DNS to seek whether the requests was made to those CNC hosts, and is proven:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg53Yaqp0NZSmz0X9f3tC539M1MZ8wJLcWrt10i8KM2N8hyphenhypheno7WZm8Itlznj6gq2i2TmyLxmm-ImuQGVkj3kCur3RDChK3wT132LG2GuzudVGw3nb9HQy6ObLbIATuvFciGJDpQKupCSYBs/s1512/2222-10622169_696555387091997_365075819_n.jpg"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg53Yaqp0NZSmz0X9f3tC539M1MZ8wJLcWrt10i8KM2N8hyphenhypheno7WZm8Itlznj6gq2i2TmyLxmm-ImuQGVkj3kCur3RDChK3wT132LG2GuzudVGw3nb9HQy6ObLbIATuvFciGJDpQKupCSYBs/s400/2222-10622169_696555387091997_365075819_n.jpg"></a><br>
Furthermore, using the different method of networking (I won't explain this for the security purpose), I could find the alive connection to the CNC's IP and PoC'ing the blob binary sent to initiate the connection. Noted, again the data matched, the reversing blob binary is actually the CNC sent data used to initiate the CNC communication, as per captured in the PCAP below, same bits:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgiagMM6DzNVy31Zgeus4-3CV15NdQn3lZJANbwwuBMkiQDHu6AEIzZX2_ouhGi6bsC_X7p4cCXMkOLtsBvUIP4Lset-jXhsyztOPpQnI0HuYlRR0vOFi3d3xxF4-QX6RwzSYBKA0REGHg/s1637/111-10602676_696555790425290_446417809_n.jpg"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgiagMM6DzNVy31Zgeus4-3CV15NdQn3lZJANbwwuBMkiQDHu6AEIzZX2_ouhGi6bsC_X7p4cCXMkOLtsBvUIP4Lset-jXhsyztOPpQnI0HuYlRR0vOFi3d3xxF4-QX6RwzSYBKA0REGHg/s500/111-10602676_696555790425290_446417809_n.jpg"></a><br>Does it means the CNC still alive? <br>
I am not so sure. It was connected. The CNC "allowed" the bot to send the data to them, yet it was not responding back afterward and let the communication becoming in "pending" stage. So, there is many possibility can be happened, like: CNC is gone, or CNC specs has changed, etc.  After all this APT sample is about 6-7months old.<br> 
So please allow me to take a rain check for analysis the blob binary used (still on it..among tons of tasks..). Let's investigate this CNC related network.

<p><h2>The CNC investigation</h2>

<p>Based on the reverse engineering, forensics & behavior analysis we did, we found the CNC is actually 3 (three) hostnames matched to the 6 (six) IP addresses as per listed below:
<pre class="brush: js">static.jg7.org
imaps.qki6.com 
menmin.strezf.com
</pre>Which historically are using the below IP addresses:
<pre class="brush: js">8.5.1.38
64.74.223.38
208.73.211.66
91.229.77.179
124.217.252.186
212.7.198.211
</pre>The first three domains is having a very bad reputation in phishing & malware infection globally. PoC-->[<a href="http://pastebin.com/9Q91JNeC">here</a>]

<p>For the location of these IP are shown in the below details:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjj2DzwSbz5zS1lTT1wrfpgiarbRt44jVkhzk6wSfQ33hhB9finqK5nASJp3Er3SvqOBEaug5dPZNwNF3lpX4wlIMF4hpGZvU7ZvTQpraFeqnNS41ENDaW5wrCY2BkPWNmDZnh9eEE-Loc/s1576/3005.png"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjj2DzwSbz5zS1lTT1wrfpgiarbRt44jVkhzk6wSfQ33hhB9finqK5nASJp3Er3SvqOBEaug5dPZNwNF3lpX4wlIMF4hpGZvU7ZvTQpraFeqnNS41ENDaW5wrCY2BkPWNmDZnh9eEE-Loc/s400/3005.png"></a><br>
And the period time for each CNC's used subdomains VS IP addresses above can be viewed clearly below (Thank you FairSight team):
<pre class="brush: js">first seen 2013-11-01 21:17:45 -0000
last seen 2013-11-04 05:22:20 -0000
static.jg7.org. A 8.5.1.41
 
first seen 2013-10-07 13:10:00 -0000
last seen 2013-11-18 14:38:32 -0000
static.jg7.org. A 64.74.223.41
 
first seen 2013-08-26 10:01:39 -0000
last seen 2013-10-07 12:34:21 -0000
static.jg7.org. A 91.229.77.179
 
first seen 2012-12-17 04:20:19 -0000
last seen 2013-06-20 05:53:03 -0000
static.jg7.org. A 124.217.252.186
 
first seen 2013-06-20 08:00:28 -0000
last seen 2013-08-26 09:00:42 -0000
static.jg7.org. A 212.7.198.211

first seen 2013-11-01 21:22:55 -0000
last seen 2013-11-04 05:24:20 -0000
imaps.qki6.com. A 8.5.1.38
 
first seen 2013-10-07 13:10:18 -0000
last seen 2013-11-18 14:38:38 -0000
imaps.qki6.com. A 64.74.223.38
 
first seen 2013-08-26 10:02:05 -0000
last seen 2013-10-07 12:33:13 -0000
imaps.qki6.com. A 91.229.77.179
 
first seen 2012-12-17 04:19:46 -0000
last seen 2013-06-20 05:52:30 -0000
imaps.qki6.com. A 124.217.252.186
 
first seen 2014-01-06 01:21:07 -0000
last seen 2014-01-11 14:30:44 -0000
imaps.qki6.com. A 208.73.211.66
 
first seen 2013-06-20 07:07:43 -0000
last seen 2013-08-26 09:01:08 -0000
imaps.qki6.com. A 212.7.198.211

first seen 2013-08-26 10:02:31 -0000
last seen 2014-08-22 04:06:36 -0000
menmin.strezf.com. A 91.229.77.179
 
first seen 2013-10-05 11:54:26 -0000
last seen 2013-10-07 13:45:55 -0000
menmin.strezf.com. A 208.91.197.101
 
first seen 2013-06-20 06:26:33 -0000
last seen 2013-08-26 09:01:34 -0000
menmin.strezf.com. A 212.7.198.211
</pre>And below is the DNS queries for these hostname (not IP) recorded in the recent terms, thank's to OpenDNS:<br>
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjy0fh3YZ8pBIhWR_bQjo6Dz0_8XDotDzIJyAIWPtzg69osXeebBCxVRh1nMkEDmo68dH2iQ5rSdznE1aw3m1G1I531Z5_li9Xfx-bL4sEaSbTreQxuGD3r6DblHyWp8WGxocYkp_pFWIU/s1524/3006.png"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjy0fh3YZ8pBIhWR_bQjo6Dz0_8XDotDzIJyAIWPtzg69osXeebBCxVRh1nMkEDmo68dH2iQ5rSdznE1aw3m1G1I531Z5_li9Xfx-bL4sEaSbTreQxuGD3r6DblHyWp8WGxocYkp_pFWIU/s500/3006.png"></a><br>
Cross checking various similar samples with the all recorded domains & IPs for the related CNC we found more possibility related hostnames to the similar series of the threat, suggesting the same actor(s), noted the usage of DDNS domains:
<pre class="brush: js">foursquare.dyndns.tv
neuro.dyndns-at-home.com
tripadvisor.dyndns.info
wowwiki.dynalias.net
yelp.webhop.org
(there are some more but we are not 100% sure of them yet..is a TBA now..)</pre>The bully actor(s) who spread this APT loves to hide their domain behind various of services like:
<pre class="brush: js">nsX.dreamhost.com
nsX.cloudns.net 
nsXX.ixwebhosting.com
nsXX.domaincontrol.com
dnsX.name-services.com
nsXX.dsredirection.com
dnsX.parkpage.foundationapi.com</pre>With noted that these THREE CNC domains used by this sample, are made on this purpose only, and leaving many traceable evidence in the internet that we collected all of those successfully. Trailing every info leaves by this domains: <b><i>jg7.org, qki6.com. strezf.com</i></b> will help you to know who is actually behind this attack. Noted: see the time frame data we disclosed above. If there any malware initiators and coders think they can bully others and hide their ass in internet is a BIG FAIL.

<p>The data is too many to write it all here, by the same method of previous check we can find the relation between results. It is an interesting investigation.

<p><h2>Samples</h2>

<p>What we analyzed is shared only in KernelMode, link-->[<a href="http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3451">here</a>]<br>With thankfully to KM team (rocks!) I am reserving a topic there for the continuation disclosure for same nature of sample and threat.

<p><h2>The epilogue </h2>

<p>This series of APT attack looks come and go, it was reported back then from 2009. This one campaign looks over, but for some reason that we snipped in above writing, there is no way one can be sure whether these networks used are dead. The threat is worth to investigate and monitor deeper. Some posts are suspecting political background supporting a government mission of a certain group is behind this activities, by surveillance to the targeting victims. Avoiding speculation, what we saw is a spyware effort, with a good quality...a hand-made level, suggesting a custom made malware, and I bet is not a cheap work too. We talked and compare results within involved members and having same thought about this.

<p>If you received the sample, or, maybe got infected by these series, I suggest to please take a look at the way it was spread, dropped techniques used binaries, and the many camouflage tricks used. Further, for the researchers involved, we should add that the way to hide the CNC within crook's network is the PoC for a very well-thought & clever tricks. We have enough idea for whom is capable to do this, and now is under investigation.

<p>We are informing to all MMD friends, this investigation is OPEN, please help in gathering information that is related to this threat for the future  time frame too, as much as possible. We are opposing whoever group that is backing up this evil operation, and believe me, the dots are started to connect each other..

<p>We are going to handle the similar threat from now on, so IF you have the abuse case by malware and need the deep investigation of what that malware does, do not hesitate to send us sample, archive the samples and text contains the explanations of how you got the sample and how can we contact you, with the password "infected", and please upload it in this link-->[<a href="http://www.mediafire.com/dropbox/dropbox.html?nocache=0.47243585277827493&sId=a5a850a1408899fff22c77ea31229b6599c2c6c025042a434133192a363185f0#">DropBin</a>].

<p>Don't use malware, we never believe that any usage of malware can achieve any goodness. We will battle the malware initiators and its coders for the sake to support a better humanity and better internet usage.

<p><center><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjNxW311qsSJa6L-KamO7bkQ4V3pzk_4I8LCEKSJK3vh_n-xU9J91IOStOR7ak-86SexkDzdQzUzn1x9X2gDvYPF5QVI4baCjHTl3pzDbRg5yuKtR2GwGQJ_fAn1rUA4Wx4AS9h-Au2Orc/s300/mmd-back.png"></center>
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'><span class='post-author vcard'>
Posted by
<span class='fn'>unixfreaxjp</span>
</span>
<span class='post-timestamp'>
at
<a class='timestamp-link' href='https://blog.malwaremustdie.org/2014/08/another-country-sponsored-malware.html' itemprop='url' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2014-08-24T01:16:00+09:00'>Sunday, August 24, 2014</abbr></a>
</span>
<span class='post-comment-link'>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-1814417508'>
<a href='https://www.blogger.com/post-edit.g?blogID=8268358095554400245&postID=7751444935632191567&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='https://resources.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='https://www.blogger.com/share-post.g?blogID=8268358095554400245&postID=7751444935632191567&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='https://www.blogger.com/share-post.g?blogID=8268358095554400245&postID=7751444935632191567&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='https://www.blogger.com/share-post.g?blogID=8268358095554400245&postID=7751444935632191567&target=twitter' target='_blank' title='Share to X'><span class='share-button-link-text'>Share to X</span></a><a class='goog-inline-block share-button sb-facebook' href='https://www.blogger.com/share-post.g?blogID=8268358095554400245&postID=7751444935632191567&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><a class='goog-inline-block share-button sb-pinterest' href='https://www.blogger.com/share-post.g?blogID=8268358095554400245&postID=7751444935632191567&target=pinterest' target='_blank' title='Share to Pinterest'><span class='share-button-link-text'>Share to Pinterest</span></a>
</div>
</div>
<div class='post-footer-line post-footer-line-2'><span class='post-labels'>
</span>
</div>
<div class='post-footer-line post-footer-line-3'><span class='post-location'>
</span>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
</div>
</div>

        </div></div>
      
</div>
<div class='blog-pager' id='blog-pager'>
<span id='blog-pager-newer-link'>
<a class='blog-pager-newer-link' href='https://blog.malwaremustdie.org/2014/09/reversing-arm-architecture-elf-elknot.html' id='Blog1_blog-pager-newer-link' title='Newer Post'>Newer Post</a>
</span>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='https://blog.malwaremustdie.org/2014/08/what-is-bad-stays-bad-legalized-any.html' id='Blog1_blog-pager-older-link' title='Older Post'>Older Post</a>
</span>
<a class='home-link' href='https://blog.malwaremustdie.org/'>Home</a>
</div>
<div class='clear'></div>
<div class='post-feeds'>
</div>
</div></div>
</div>
</div>
<div class='column-left-outer'>
<div class='column-left-inner'>
<aside>
</aside>
</div>
</div>
<div class='column-right-outer'>
<div class='column-right-inner'>
<aside>
<div class='sidebar section' id='sidebar-right-1'><div class='widget HTML' data-version='1' id='HTML1'>
<h2 class='title'>About #MalwareMustDie!</h2>
<div class='widget-content'>
Launched in August 2012, MalwareMustDie(or MMD), is a registered <span style="font-weight:bold;">Non-profit Whitehat Organization</span>, as a Blue-Teaming media  to form work-flow activities to reduce malware in the internet <a href="https://en.wikipedia.org/wiki/MalwareMustDie">..[Read More]</a>
</div>
<div class='clear'></div>
</div><div class='widget BlogSearch' data-version='1' id='BlogSearch1'>
<h2 class='title'>Search keyword</h2>
<div class='widget-content'>
<div id='BlogSearch1_form'>
<form action='https://blog.malwaremustdie.org/search' class='gsc-search-box' target='_top'>
<table cellpadding='0' cellspacing='0' class='gsc-search-box'>
<tbody>
<tr>
<td class='gsc-input'>
<input autocomplete='off' class='gsc-input' name='q' size='10' title='search' type='text' value=''/>
</td>
<td class='gsc-search-button'>
<input class='gsc-search-button' title='search' type='submit' value='Search'/>
</td>
</tr>
</tbody>
</table>
</form>
</div>
</div>
<div class='clear'></div>
</div><div class='widget LinkList' data-version='1' id='LinkList1'>
<h2>Links</h2>
<div class='widget-content'>
<ul>
<li><a href='https://blog.malwaremustdie.org/feeds/posts/default?alt=rss'>RSS Feed</a></li>
<li><a href='https://www.malwaremustdie.org/'>Home Page</a></li>
<li><a href='https://blog.malwaremustdie.org/p/send-sample.html'>Send Sample</a></li>
<li><a href='https://www.google.com/search?q=malwaremustdie&tbm=nws&start=0'>News Search</a></li>
<li><a href='https://www.google.com/search?q=malwaremustdie&newwindow=1&client=firefox-b&biw=928&bih=462&source=lnt&tbs=cdr%3A1%2Ccd_min%3A7%2F1%2F2012%2Ccd_max%3A6%2F10%2F2016&tbm=#q=malwaremustdie&newwindow=1&tbs=cdr:1,cd_min:7/1/2012,cd_max:6/10/2016,sbd:1&start=10'>Web Search</a></li>
<li><a href='https://blog.malwaremustdie.org/p/linux-malware-research-list-updated.html'>Linux Malware</a></li>
<li><a href='https://unixfreaxjp.github.io/malwaremustdie/'>Github Repository</a></li>
<li><a href='https://www.youtube.com/playlist?list=PLSe6fLFf1YDX-2sog70220BchQmhVqQ75'>Video News, Demo, Reports</a></li>
<li><a href='https://blog.malwaremustdie.org/p/the-mmds-tango-down-project-archive.html'>"Tango down!" project (Archive)</a></li>
<li><a href='https://blog.malwaremustdie.org/p/the-rule-to-share-malicious-codes-we.html'>Disclaimer & Sharing Guide</a></li>
</ul>
<div class='clear'></div>
</div>
</div><div class='widget FeaturedPost' data-version='1' id='FeaturedPost1'>
<h2 class='title'>Recommended reading</h2>
<div class='post-summary'>
<h3><a href='https://blog.malwaremustdie.org/2016/10/mmd-0059-2016-linuxirctelnet-new-ddos.html'>MMD-0059-2016 - Linux/IRCTelnet (new Aidra) - A DDoS botnet aims IoT w/ IPv6 ready</a></h3>
<p>
It&#39;s a Kaiten/Tsunami? No.. STD?? No! It&#39;s a GayFgt/Torlus/Qbot? No!! Is it Mirai?? NO!!  It&#39;s a Linux/IRCTelnet (new Aidra) ! ....
</p>
<img class='image' src='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj5FNwd3CeQvuQ7FwVmQr2j5DvICYWgpGMBSpyhE-EDSqkX93MfdA54aeE7X8XeUlNT06QfjG6_-zFvh6Tm2iP9C_0YxUgMc4mJ3DtA7dUuldfA7MEaUyRiKL9HVXIiFdsSqDlJAfL8g0s/w580-h470-no/'/>
</div>
<style type='text/css'>
    .image {
      width: 100%;
    }
  </style>
<div class='clear'></div>
</div><div class='widget LinkList' data-version='1' id='LinkList2'>
<h2>Malware Analysis / Threat Reports (Indexed)</h2>
<div class='widget-content'>
<ul>
<li><a href='https://blog.malwaremustdie.org/2024/06/mmd-069-2024-old-elf-ransomware-pivoted.html'>MMD-0069-2024 - An old ELF Ransomware pivoted crypto (OpenSSL to PolarSSL) Linux/Encoder.1-2 </a></li>
<li><a href='https://blog.malwaremustdie.org/2024/06/mmd-068-2024-english-report-of-fhappi.html'>MMD-0068-2024 - "FHAPPI Campaign" (APT10) FreeHosting APT "PSploit" Poison Ivy</a></li>
<li><a href='https://blog.malwaremustdie.org/2021/03/mmd-067-2021-recent-talks-on-linux.html'>MMD-0067-2021 - Recent talks on Linux process injection and shellcode analysis series (ROOTCON-2020, R2CON-2020 ++)</a></li>
<li><a href='https://blog.malwaremustdie.org/2020/02/mmd-0065-2021-linuxmirai-fbot-re.html'>MMD-0066-2020 - Linux/Mirai-Fbot - A re-emerged IoT threat </a></li>
<li><a href='https://blog.malwaremustdie.org/2020/01/mmd-0065-2020-linuxmirai-fbot.html'>MMD-0065-2020 - Linux/Mirai-Fbot's new encryption explained</a></li>
<li><a href='https://blog.malwaremustdie.org/2019/09/mmd-0064-2019-linuxairdropbot.html'>MMD-0064-2019 - Linux/AirDropBot</a></li>
<li><a href='https://blog.malwaremustdie.org/2019/09/mmd-0063-2019-summarize-report-of-three.html'>MMD-0063-2019 - Summary of three years research (Sept 2016-Sept 2019)</a></li>
<li><a href='https://blog.malwaremustdie.org/2017/03/mmd-0062-2017-credential-harvesting-by.html'>MMD-0062-2017 - IoT/Studels SSH-TCP Forward Threat</a></li>
<li><a href='https://blog.malwaremustdie.org/2016/12/mmd-0061-2016-energymech-28-overkill-mod.html'>MMD-0061-2016 - EnergyMech 2.8 overkill mod</a></li>
<li><a href='https://blog.malwaremustdie.org/2016/10/mmd-0060-2016-linuxudpfker-and-chinaz.html'>MMD-0060-2016 - Linux/UDPfker and ChinaZ threat today</a></li>
<li><a href='https://blog.malwaremustdie.org/2016/10/mmd-0059-2016-linuxirctelnet-new-ddos.html'>MMD-0059-2016 - Linux/IRCTelnet (new Aidra)</a></li>
<li><a href='https://blog.malwaremustdie.org/2016/10/mmd-0058-2016-elf-linuxnyadrop.html'>MMD-0058-2016 - Linux/NyaDrop - MIPS IoT bad news</a></li>
<li><a href='https://blog.malwaremustdie.org/2016/09/mmd-0057-2016-new-elf-botnet-linuxluabot.html'>MMD-0057-2016 - Linux/LuaBot - IoT botnet as service</a></li>
<li><a href='https://blog.malwaremustdie.org/2016/08/mmd-0056-2016-linuxmirai-just.html'>MMD-0056-2016 - Linux/Mirai, how an old ELF malcode is recycled</a></li>
<li><a href='https://blog.malwaremustdie.org/2016/08/mmd-0054-2016-pnscan-elf-worm-that.html'>MMD-0055-2016 - Linux/PnScan ; A worm that still circles around</a></li>
<li><a href='https://blog.malwaremustdie.org/2016/06/mmd-0054-2016-atmos-botnet-and-facts.html'>MMD-0054-2016 - ATMOS botnet facts you should know</a></li>
<li><a href='https://blog.malwaremustdie.org/2016/04/mmd-0053-2016-bit-about-elfstd-irc-bot.html'>MMD-0053-2016 - Linux/STD IRC Botnet: x00's CBack aka xxx.pokemon.inc</a></li>
<li><a href='https://blog.malwaremustdie.org/2016/02/mmd-0052-2016-skidddos-elf-distribution.html'>MMD-0052-2016 - Overview of Overall "SkidDDoS" Linux Botnet</a></li>
<li><a href='https://blog.malwaremustdie.org/2016/02/mmd-0051-2016-debungking-tiny-elf.html'>MMD-0051-2016 - Debunking a Tiny Shellhock's ELF backdoor</a></li>
<li><a href='https://blog.malwaremustdie.org/2016/01/mmd-0050-2016-incident-report-elf.html'>MMD-0050-2016 - Linux/Torte infection (in Wordpress)</a></li>
<li><a href='https://blog.malwaremustdie.org/2016/01/mmd-0049-2016-case-of-java-trojan.html'>MMD-0049-2016 - Java Trojan Downloader/RCE) for minerd</a></li>
<li><a href='https://blog.malwaremustdie.org/2016/01/mmd-0048-2016-ddostf-new-elf-windows.html'>MMD-0048-2016 - DDOS.TF = ELF & Win32 DDoS service with ASP + PHP/MySQL MOF webshells</a></li>
<li><a href='https://blog.malwaremustdie.org/2015/12/mmd-0047-2015-sshv-ssh-bruter-elf.html'>MMD-0047-2015 - SSHV: SSH bruter Linux botnet w/hidden process rootkit</a></li>
<li><a href='https://blog.malwaremustdie.org/2015/12/mmd-0046-2015-kelihos-cnc-activity-on.html'>MMD-0046-2015 - Kelihos 10 nodes C2 / CNC on NJIIX (US) and its actor(Severa)</a></li>
<li><a href='https://blog.malwaremustdie.org/2015/12/mmd-0045-2015-kdefend-new-elf-threat.html'>MMD-0045-2015 - Linux/KDefend: a new China origin Linux threat w/disclaimer</a></li>
<li><a href='https://blog.malwaremustdie.org/2015/11/mmd-0044-2015-source-code-disclosure.html'>MMD-0044-2015 - Code disclosure of SkiDDoS threat</a></li>
<li><a href='https://blog.malwaremustdie.org/2015/09/mmd-0042-2015-polymorphic-in-elf.html'>MMD-0043-2015 - Linux/Xor.DDOS Polymorphic feature</a></li>
<li><a href='https://blog.malwaremustdie.org/2015/09/mmd-0042-2015-hunting-mr-black-ids-via.html'>MMD-0042-2015 - Geting to Linux/Mr.Black actor via Zegost </a></li>
<li><a href='https://blog.malwaremustdie.org/2015/09/mmd-0041-2015-reversing-pe-mail-grabber.html'>MMD-0041-2015 - PE Mail-grabber Spambot & its C99 WebShell</a></li>
<li><a href='https://blog.malwaremustdie.org/2015/08/mmd-0039-2015-learning-about-vbe.html'>MMD-0040-2015 - VBE Obfuscation & AutoIt Banco Trojan</a></li>
<li><a href='https://blog.malwaremustdie.org/2015/08/mmd-0039-2015-chinaz-made-new-malware.html'>MMD-0039-2015 - ChinaZ  Linux/BillGates.Lite Edition</a></li>
<li><a href='https://blog.malwaremustdie.org/2015/08/mmd-0037-2015-chinaz-and-ddos123xyz.html'>MMD-0038-2015 - ChinaZ's Ddos123.xyz</a></li>
<li><a href='https://blog.malwaremustdie.org/2015/07/mmd-0037-2015-bad-shellshock.html'>MMD-0037-2015 - Shellshock & Linux/XOR.DDoS C2</a></li>
<li><a href='https://blog.malwaremustdie.org/2015/07/mmd-0036-2015-kins-or-zeusvm-v2000.html'>MMD-0036-2015 - KINS (ZeusVM)v2.0.0. builder & panel leaks</a></li>
<li><a href='https://blog.malwaremustdie.org/2015/06/mmd-0035-2015-iptablex-or-iptables-on.html'>MMD-0035-2015 - Linux/.IptabLex or .IptabLes on Shellshock(by: ChinaZ)</a></li>
<li><a href='https://blog.malwaremustdie.org/2015/06/mmd-0034-2015-new-elf.html'>MMD-0034-2015 - Linux/DES.Downloader on Elasticsearch</a></li>
<li><a href='https://blog.malwaremustdie.org/2015/06/mmd-0033-2015-linuxxorddos-infection_23.html'>MMD-0033-2015 - Linux/XorDDoS case CNC:HOSTASA.ORG</a></li>
<li><a href='https://blog.malwaremustdie.org/2015/06/the-elf-chinaz-reloaded.html'>MMD-0032-2015 - The ELF ChinaZ "reloaded"</a></li>
<li><a href='https://blog.malwaremustdie.org/2015/04/mmd-0031-2015-what-is-netwire-rat.html'>MMD-0031-2015 - What is NetWire (multi platform) RAT</a></li>
<li><a href='https://blog.malwaremustdie.org/2015/01/mmd-0030-2015-new-elf-malware-on.html'>MMD-0030-2015 - New malware on Shellshock: Linux/ChinaZ</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/10/mmd-0029-2015-warning-of-mayhem.html'>MMD-0029-2014 - Warning of Linux/Mayhem attack in Shellshock</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/09/mmd-0028-2014-fuzzy-reversing-new-china.html'>MMD-0028-2014 - Linux/XOR.DDoS</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/09/linux-elf-bash-0day-fun-has-only-just.html'>MMD-0027-2014 - Linux/Bashdoor(GafGyt) & Small ELF Backdoor at shellshock</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/09/reversing-arm-architecture-elf-elknot.html'>MMD-0026-2014 - Linux/AES.DDoS: Router Malware</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/06/mmd-0025-2014-itw-infection-of-elf.html'>MMD-0025-2014 - Linux/.IptabLex or .IptabLes - China/PRC origin DDoS bot</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/06/recent-incident-report-of-linux-elf.html'>MMD-0024-2014 - Incident Report of Linux/Mayhem (LD_PRELOAD libworker.so)</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/05/a-payback-to-ssh-bruting-crooks.html'>MMD-0023-2014 - Linux/pscan & Linux/sshscan: SSH bruter malware</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/05/threat-analysis-zendran-elf-ddos-scheme.html'>MMD-0022-2014 - Zendran, multi-arch Linux/Llightaidra - Part 1: background, installation, reversing & C2 access</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/05/linux-reversing-is-fun-toying-with-elf.html'>MMD-0021-2014 - Linux/Elknot: China's origin ELF DDoS+backdoor</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/05/elf-shared-so-dynamic-library-malware.html'>MMD-0020-2014 - Analysis of Linux/Mayhem infection: A shared libs ELF</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/04/when-hacker-gets-hacked-disclosure.html'>MMD-0019-2014 - "Xakep.biz" evil tools</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/04/upatre-downloading-gmo-is-back-to-ssl.html'>MMD-0018-2014 - Analysis note: "Upatre" is back to SSL? </a></li>
<li><a href='https://blog.malwaremustdie.org/2014/03/a-post-to-sting-zeus-p2pgameover-crooks.html'>MMD-0017-2014 - A post to sting Zeus P2P/Gameover</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/02/cyber-intelligence-jackpos-behind-screen.html'>MMD-0016-2014 - The JackPOS Behind the Screen</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/02/one-upn-time-with-american-express.html'>MMD-0015-2014 - One upon the time with Phishing Session..</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/01/threat-intelligence-new-locker-prison.html'>MMD-0014-2014 - New Locker: Prison Locker (aka: Power Locker)</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/01/shadow-logger-new-fud-keylogger-on-mmd.html'>MMD-0013-2014 - "Shadow Logger" - .NET's FUD Keylogger</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/12/arp-spoofing-malware-infection-project.html'>MMD-0012-2013 - ARP Spoofing Malware</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/12/lets-be-more-serious-about-dns-amp-elf.html'>MMD-0011-2013 - Linux/Elknot - Let's be more serious about (mitigating) DNS Amp</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/11/more-wordpress-hack-case-sites.html'>MMD-0010-2013 - Wordpress Hack Case: Site's Credential Stealer</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/11/runforrestrun-dga-is-alive-at.html'>MMD-0009-2013 - JS/RunForrestRun DGA "Comeback" with new obfuscation</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/10/a-disclosure-of-whats-behind-w00tw00t.html'>MMD-0008-2013 - What's Behind the #w00tw00t (PHP) Attack</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/10/kins-source-code-for-view-download.html'>MMD-0007-2013 - KINS? No! PowerZeuS, yes! </a></li>
<li><a href='https://blog.malwaremustdie.org/2013/09/302-redirector-new-cushion-attempt-to.html'>MMD-0006-2013 - Rogue 302-Redirector "Cushion Attack"</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/09/how-greedy-cyber-scums-are-leaked-plan.html'>MMD-0005-2013 - A Leaked Malvertisement, Cutwail+BHEK & Triple Payloads of "Syria Campaign"</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/08/you-hacked-we-cracked-youre-doomed-ir.html'>MMD-0004-2013 - "You hacked.. we cracked" - "WP Super Cache" & Glazunov EK</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/07/the-come-back-of-ru-runforrestruns-dga.html'>MMD-0003-2013 - First "comeback" of the .RU RunForrestRun's DGA</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/07/how-bad-cutwail-and-other-spambot-can.html'>MMD-0002-2013 - How Cutwail and other SpamBot can fool (spoof) us?</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/07/proof-of-concept-of-cookiebomb-attack.html'>MMD-0001-2013 - Proof of Concept of "CookieBomb" code injection attack</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/06/advisory-on-pleskapache-remote-code.html'>MMD-0000-2013 - Malware Infection Alert on Plesk/Apache Remote Code Execution zeroday</a></li>
</ul>
<div class='clear'></div>
</div>
</div><div class='widget LinkList' data-version='1' id='LinkList3'>
<h2>Presentation and Special Threat Reports</h2>
<div class='widget-content'>
<ul>
<li><a href='https://blog.malwaremustdie.org/2021/03/mmd-067-2021-recent-talks-on-linux.html#rootcon2020'>ROOTCON 2020 - Deeper diving into shellcode (advanced users)</a></li>
<li><a href='https://blog.malwaremustdie.org/2021/03/mmd-067-2021-recent-talks-on-linux.html#r2con2020'>R2CON 2020 - So you don't like shellcode too? (for r2 RE beginners)</a></li>
<li><a href='https://blog.malwaremustdie.org/2019/10/more-about-my-2019hacklu-keynote-talk.html'>HACK.LU 2019 Keynote talk: "Fileless Malware Infection and Linux Process Injection"</a></li>
<li><a href='https://blog.malwaremustdie.org/p/new-video-of-this-talk-has-just-been.html'>R2CON 2018 talk of: "Unpacking the non-unpackable ELF malware"</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/02/long-talk-av-tokyo-20135-kelihos.html'>AVTOKYO 2013.5 - Threats of Kelihos, CookieBomb, RedKit's and its Bad Actor</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/12/short-talk-in-botconf-2013-kelihos.html'>BOTCONF 2013 - Kelihos: Botnet, Takedown, Mule Actor</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/02/cve-2013-0634-this-ladyboyle-is-not.html'>CVE-2013-0634 This "Lady" Boyle is not a nice Lady at all</a></li>
<li><a href='https://blog.malwaremustdie.org/2024/06/mmd-068-2024-english-report-of-fhappi.html'>MMD-068-2024 - "FHAPPI Campaign" (APT10) FreeHosting APT PowerSploit Poison Ivy</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/08/another-country-sponsored-malware.html'>APT-32 - The Vietnam Journalist Spy Campaign </a></li>
<li><a href='https://blog.malwaremustdie.org/2014/08/what-is-bad-stays-bad-legalized-any.html'>Targeted attack of "Operation Torpedo"</a></li>
<li><a href='https://old.reddit.com/r/LinuxMalware/comments/5d0jx4/malwaremustdie_closed_blog_usa_access_as_protest/'>Protest against usage of NSA malware spytool PITCHIMPAIR & INNOVATION on friendly countries</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/11/china-elf-botnet-malware-infection.html'>China/PRC origin Linux botnet's malware infection and its distribution scheme unleashed</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/06/full-disclosure-of-309-botbotnet-source.html'>Full disclosure of 309 Bots/Botnet Source Codes Found via Germany Torrent </a></li>
<li><a href='https://blog.malwaremustdie.org/2013/03/the-evil-came-back-darkleechs-apache.html'>The Evil Came Back: Linux/Darkleech's Apache Malware Module</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/06/ddoser-as-service-camouflation-of-legit.html'>DDoS in a Bruter Service - A camouflage of Stresser/Booter</a></li>
<li><a href='https://blog.malwaremustdie.org/2012/10/how-far-phpc99shell-malware-can-go-from.html'>How EVIL the PHP/C99Shell can be? From SQL Dumper, Hacktools, to Trojan Distributor Future? </a></li>
<li><a href='https://blog.malwaremustdie.org/2014/06/a-journey-to-abused-ftp-sites-story-of.html'>A journey to abused FTP sites (story of: Shells, Malware, Bots, DDoS & Spam) - Part 2</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/05/a-journey-to-ftp-abused-sites-story-of.html'>A journey to abused FTP sites (story of: Shells, Malware, Bots, DDoS & Spam) - Part 1</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/02/how-public-services-like-amazon-aws.html'>Case Study: How legitimate internet services like Amazon AWS, DropBox, Google Project/Code & ShortURL got abused to infect malware</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/05/story-of-unix-trojan-tsunami-ircbot-w.html'>Just another story of UNIX Trojan Tsunami/Kaiten.c (IRC/Bot) w/ Flooder, Backdoor at a hacked xBSD case</a></li>
<li><a href='https://blog.malwaremustdie.org/p/mon-mar-24-104232-jst-2014.html'>Discontinuation of "Malware Crusader" public forum</a></li>
<li><a href='https://blog.malwaremustdie.org/p/hall-of-shame.html'>Hall of Shame</a></li>
<li><a href='https://blog.malwaremustdie.org/p/malwaremustdie-blog-archive.html'>more..</a></li>
</ul>
<div class='clear'></div>
</div>
</div><div class='widget LinkList' data-version='1' id='LinkList4'>
<h2>Non-indexed (older) Analysis</h2>
<div class='widget-content'>
<ul>
<li><a href='https://blog.malwaremustdie.org/2013/11/a-step-by-step-decoding-guide-for.html'>Decoding Guide for CookieBomb's (as Front-end) Latest Threat, with Evil ESD.PHP Redirection (as the Back-end)</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/07/a-note-of-modification-of-obfuscation.html'>Some Decoding note(s) on modified #CookieBomb attack's obfuscated injection code</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/07/what-is-behind-cookiebomb-attack-by.html'>What is behind #CookieBomb attack? (by @malm0u53)</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/01/and-another-detonating-method-of-new.html'>..And another "detonating" method of CookieBomb 2.0 - Part 2</a></li>
<li><a href='https://blog.malwaremustdie.org/2014/01/and-another-detonating-method-of-todays.html'>..And another "detonating" method of CookieBomb 2.0 - Part 1</a></li>
<li><a href='https://blog.malwaremustdie.org/2012/10/fuzzy-in-manual-cracking-of.html'>New PseudoRandom (JS/runforestrun?xxx=)</a></li>
<li><a href='https://blog.malwaremustdie.org/2012/12/jsrunforrestrun-infector-comeback-full.html'>JS/RunForrestRun Infection ComeBack</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/04/cnc-analysis-of-citadel-trojan-bot.html'>CNC analysis of Citadel Trojan Bot-Agent - Part 2</a></li>
<li><a href='https://blog.malwaremustdie.org/2013/04/wireshark-analysis-of-citadel-trojan.html'>CNC analysis of Citadel Trojan Bot-Agent - Part 1</a></li>
<li><a href='https://blog.malwaremustdie.org/2012/09/cracking-of-strong-encrypted-phpirc-bot.html'>Cracking of Strong Encrypted PHP / IRC Bot (PBOT) </a></li>
<li><a href='https://blog.malwaremustdie.org/p/malwaremustdie-blog-archive.html'>more..</a></li>
</ul>
<div class='clear'></div>
</div>
</div><div class='widget Feed' data-version='1' id='Feed2'>
<h2>
</h2>
<div class='widget-content' id='Feed2_feedItemListDisplay'>
<span style='filter: alpha(25); opacity: 0.25;'>
<a href='https://blog.0day.jp/feeds/posts/default?alt=rss'>Loading...</a>
</span>
</div>
<div class='clear'></div>
</div><div class='widget Subscribe' data-version='1' id='Subscribe1'>
<div style='white-space:nowrap'>
<h2 class='title'>Subscribe To</h2>
<div class='widget-content'>
<div class='subscribe-wrapper subscribe-type-POST'>
<div class='subscribe expanded subscribe-type-POST' id='SW_READER_LIST_Subscribe1POST' style='display:none;'>
<div class='top'>
<span class='inner' onclick='return(_SW_toggleReaderList(event, "Subscribe1POST"));'>
<img class='subscribe-dropdown-arrow' src='https://resources.blogblog.com/img/widgets/arrow_dropdown.gif'/>
<img align='absmiddle' alt='' border='0' class='feed-icon' src='https://resources.blogblog.com/img/icon_feed12.png'/>
Posts
</span>
<div class='feed-reader-links'>
<a class='feed-reader-link' href='https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fblog.malwaremustdie.org%2Ffeeds%2Fposts%2Fdefault' target='_blank'>
<img src='https://resources.blogblog.com/img/widgets/subscribe-netvibes.png'/>
</a>
<a class='feed-reader-link' href='https://add.my.yahoo.com/content?url=https%3A%2F%2Fblog.malwaremustdie.org%2Ffeeds%2Fposts%2Fdefault' target='_blank'>
<img src='https://resources.blogblog.com/img/widgets/subscribe-yahoo.png'/>
</a>
<a class='feed-reader-link' href='https://blog.malwaremustdie.org/feeds/posts/default' target='_blank'>
<img align='absmiddle' class='feed-icon' src='https://resources.blogblog.com/img/icon_feed12.png'/>
                  Atom
                </a>
</div>
</div>
<div class='bottom'></div>
</div>
<div class='subscribe' id='SW_READER_LIST_CLOSED_Subscribe1POST' onclick='return(_SW_toggleReaderList(event, "Subscribe1POST"));'>
<div class='top'>
<span class='inner'>
<img class='subscribe-dropdown-arrow' src='https://resources.blogblog.com/img/widgets/arrow_dropdown.gif'/>
<span onclick='return(_SW_toggleReaderList(event, "Subscribe1POST"));'>
<img align='absmiddle' alt='' border='0' class='feed-icon' src='https://resources.blogblog.com/img/icon_feed12.png'/>
Posts
</span>
</span>
</div>
<div class='bottom'></div>
</div>
</div>
<div class='subscribe-wrapper subscribe-type-PER_POST'>
<div class='subscribe expanded subscribe-type-PER_POST' id='SW_READER_LIST_Subscribe1PER_POST' style='display:none;'>
<div class='top'>
<span class='inner' onclick='return(_SW_toggleReaderList(event, "Subscribe1PER_POST"));'>
<img class='subscribe-dropdown-arrow' src='https://resources.blogblog.com/img/widgets/arrow_dropdown.gif'/>
<img align='absmiddle' alt='' border='0' class='feed-icon' src='https://resources.blogblog.com/img/icon_feed12.png'/>
Comments
</span>
<div class='feed-reader-links'>
<a class='feed-reader-link' href='https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fblog.malwaremustdie.org%2Ffeeds%2F7751444935632191567%2Fcomments%2Fdefault' target='_blank'>
<img src='https://resources.blogblog.com/img/widgets/subscribe-netvibes.png'/>
</a>
<a class='feed-reader-link' href='https://add.my.yahoo.com/content?url=https%3A%2F%2Fblog.malwaremustdie.org%2Ffeeds%2F7751444935632191567%2Fcomments%2Fdefault' target='_blank'>
<img src='https://resources.blogblog.com/img/widgets/subscribe-yahoo.png'/>
</a>
<a class='feed-reader-link' href='https://blog.malwaremustdie.org/feeds/7751444935632191567/comments/default' target='_blank'>
<img align='absmiddle' class='feed-icon' src='https://resources.blogblog.com/img/icon_feed12.png'/>
                  Atom
                </a>
</div>
</div>
<div class='bottom'></div>
</div>
<div class='subscribe' id='SW_READER_LIST_CLOSED_Subscribe1PER_POST' onclick='return(_SW_toggleReaderList(event, "Subscribe1PER_POST"));'>
<div class='top'>
<span class='inner'>
<img class='subscribe-dropdown-arrow' src='https://resources.blogblog.com/img/widgets/arrow_dropdown.gif'/>
<span onclick='return(_SW_toggleReaderList(event, "Subscribe1PER_POST"));'>
<img align='absmiddle' alt='' border='0' class='feed-icon' src='https://resources.blogblog.com/img/icon_feed12.png'/>
Comments
</span>
</span>
</div>
<div class='bottom'></div>
</div>
</div>
<div style='clear:both'></div>
</div>
</div>
<div class='clear'></div>
</div><div class='widget HTML' data-version='1' id='HTML4'>
<div class='widget-content'>
<img src="https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_st0MzFU5YAW9T8BdvcLnzCWG7kZ6X9YmNdvf3s9rbbDlJUqsBGNP63TerA0NdoJvMZ4amS3zbenO-lQNs37_3jMpDPg0E-AzB-EQ=s0-d" width="0" height="0" border="0">
<!--
&#9769;act free from sins,
&#9769;speak the truth,
&#9769;be just,
&#9769;be brave,
&#9769;have faith,
&#9769;help, support, teach the weaks ,
&#9769;non nobis domine sed nomine tuo da gloriam.
-->
</div>
<div class='clear'></div>
</div></div>
</aside>
</div>
</div>
</div>
<div style='clear: both'></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class='main-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<footer>
<div class='footer-outer'>
<div class='footer-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left footer-fauxborder-left'>
<div class='fauxborder-right footer-fauxborder-right'></div>
<div class='region-inner footer-inner'>
<div class='foot no-items section' id='footer-1'></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='foot no-items section' id='footer-2-1'></div>
</td>
<td class='columns-cell'>
<div class='foot no-items section' id='footer-2-2'></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class='foot section' id='footer-3'><div class='widget Attribution' data-version='1' id='Attribution1'>
<div class='widget-content' style='text-align: center;'>
(c)MalwareMustDie, 2012-2021. Read LEGAL DISCLAIMER before quoting or copying our contents. Powered by <a href='https://www.blogger.com' target='_blank'>Blogger</a>.
</div>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='footer-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class='content-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<script type='text/javascript'>
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>
<script type='text/javascript'>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-180537376-1', 'auto', 'blogger');
        ga('blogger.send', 'pageview');
      </script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/3704019819-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY5Po1tOD3P_Th3qxPqGqwjQq5ickg:1734485093279';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d8268358095554400245','//blog.malwaremustdie.org/2014/08/another-country-sponsored-malware.html','8268358095554400245');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '8268358095554400245', 'title': 'Malware Must Die!', 'url': 'https://blog.malwaremustdie.org/2014/08/another-country-sponsored-malware.html', 'canonicalUrl': 'https://blog.malwaremustdie.org/2014/08/another-country-sponsored-malware.html', 'homepageUrl': 'https://blog.malwaremustdie.org/', 'searchUrl': 'https://blog.malwaremustdie.org/search', 'canonicalHomepageUrl': 'https://blog.malwaremustdie.org/', 'blogspotFaviconUrl': 'https://blog.malwaremustdie.org/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': true, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': 'UA-180537376-1', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Malware Must Die! - Atom\x22 href\x3d\x22https://blog.malwaremustdie.org/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22Malware Must Die! - RSS\x22 href\x3d\x22https://blog.malwaremustdie.org/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Malware Must Die! - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/8268358095554400245/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Malware Must Die! - Atom\x22 href\x3d\x22https://blog.malwaremustdie.org/feeds/7751444935632191567/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'boqCommentIframeForm': true, 'loginRedirectParam': '', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/2dbf2ee4cef330c7', 'plusOneApiSrc': 'https://apis.google.com/js/platform.js', 'disableGComments': true, 'interstitialAccepted': false, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'X', 'key': 'twitter', 'shareMessage': 'Share to X', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '7751444935632191567', 'postImageThumbnailUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgqI3NNDYZ9Yyy4IRBSmkLwOt8fm9V0jUnXWxRbiV1zTQnskV00Bhbt3WDb7FoBrb4rKfK65-DplMqi3anvGwN0KRtFS-wpGRVkrylTlKHA98RppfTOMkqcEs2LyOfbdotuB0vdEZ48XOg/s72-c/000.png', 'postImageUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgqI3NNDYZ9Yyy4IRBSmkLwOt8fm9V0jUnXWxRbiV1zTQnskV00Bhbt3WDb7FoBrb4rKfK65-DplMqi3anvGwN0KRtFS-wpGRVkrylTlKHA98RppfTOMkqcEs2LyOfbdotuB0vdEZ48XOg/s555/000.png', 'pageName': 'Another country-sponsored #malware: Vietnam APT Campaign', 'pageTitle': 'Malware Must Die!: Another country-sponsored #malware: Vietnam APT Campaign', 'metaDescription': ''}}, {'name': 'features', 'data': {}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'custom', 'localizedName': 'Custom', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': true}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Another country-sponsored #malware: Vietnam APT Campaign', 'description': 'MalwareMustDie (MMD) is a whitehat workgroup to reduce malware, this blog advocates research on new malware threats \x26 Linux malware.', 'featuredImage': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgqI3NNDYZ9Yyy4IRBSmkLwOt8fm9V0jUnXWxRbiV1zTQnskV00Bhbt3WDb7FoBrb4rKfK65-DplMqi3anvGwN0KRtFS-wpGRVkrylTlKHA98RppfTOMkqcEs2LyOfbdotuB0vdEZ48XOg/s555/000.png', 'url': 'https://blog.malwaremustdie.org/2014/08/another-country-sponsored-malware.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 7751444935632191567}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/2019811046-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/1964470060-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML1', 'sidebar-right-1', document.getElementById('HTML1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogSearchView', new _WidgetInfo('BlogSearch1', 'sidebar-right-1', document.getElementById('BlogSearch1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_LinkListView', new _WidgetInfo('LinkList1', 'sidebar-right-1', document.getElementById('LinkList1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_FeaturedPostView', new _WidgetInfo('FeaturedPost1', 'sidebar-right-1', document.getElementById('FeaturedPost1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_LinkListView', new _WidgetInfo('LinkList2', 'sidebar-right-1', document.getElementById('LinkList2'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_LinkListView', new _WidgetInfo('LinkList3', 'sidebar-right-1', document.getElementById('LinkList3'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_LinkListView', new _WidgetInfo('LinkList4', 'sidebar-right-1', document.getElementById('LinkList4'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_FeedView', new _WidgetInfo('Feed2', 'sidebar-right-1', document.getElementById('Feed2'), {'title': '', 'showItemDate': true, 'showItemAuthor': false, 'feedUrl': 'https://blog.0day.jp/feeds/posts/default?alt\x3drss', 'numItemsShow': 5, 'loadingMsg': 'Loading...', 'openLinksInNewWindow': false, 'useFeedWidgetServ': 'true'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_SubscribeView', new _WidgetInfo('Subscribe1', 'sidebar-right-1', document.getElementById('Subscribe1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML4', 'sidebar-right-1', document.getElementById('HTML4'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>
</body>
</html>