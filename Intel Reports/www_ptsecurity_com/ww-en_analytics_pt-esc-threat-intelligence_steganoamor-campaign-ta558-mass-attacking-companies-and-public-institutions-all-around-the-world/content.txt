<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><title>SteganoAmor campaign: TA558 mass-attacking companies and public institutions all around the world</title><meta name="description" content="Researchers from the Positive Technologies Expert Security Center discovered more than three hundred attacks worldwide, which they confidently attributed to the well-known TA558 group.

As originally described by researchers at ProofPoint, TA558 is a relatively small financially motivated cybercrime group that has attacked hospitality and tourism organizations mainly in Latin America, but has also been identified behind attacks on North America and Western Europe. According to the researchers, the group has been active since at least 2018.

In the attacks that we studied, the group made extensive use of steganography by sending VBSs, PowerShell code, as well as RTF documents with an embedded exploit, inside images and text files. Interestingly, most of the RTF documents and VBSs have names like greatloverstory.vbs, easytolove.vbs, iaminlovewithsomeoneshecuteandtrulyyoungunluckyshenotundersatnd_howmuchiloveherbutitsallgreatwithtrueloveriamgivingyou.doc, and others, associated with love, which is why we dubbed the campaign &amp;quot;SteganoAmor&amp;quot;."/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="icon" href="/images/favicons/favicon.ico" sizes="any"/><link rel="icon" href="/images/favicons/icon.svg" type="image/svg+xml"/><link rel="apple-touch-icon" href="/images/favicons/apple-touch-icon.png"/><meta name="next-head-count" content="7"/><script type="text/javascript">
                   
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();
    for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
    k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
  
                   ym(93900442, "init", {
                       clickmap: true,
                       trackLinks: true,
                       accurateTrackBounce: true,
                       webvisor: true
                   });
             </script><noscript><div><img src="https://mc.yandex.ru/watch/93900442" style="position:absolute;left:-9999px" alt=""/></div></noscript><script id="mindbox-init">
    mindbox = window.mindbox || function() { mindbox.queue.push(arguments); };
    mindbox.queue = mindbox.queue || [];

    mindbox('create', {
        endpointId: 'ptsec.global',
    });
</script><script async="" src="https://api.mindbox.ru/scripts/v1/tracker.js"></script><script async="" src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" type="text/javascript" data-domain-script="0191d674-840f-7931-a533-9567b38dbd10" data-document-language="true"></script><script type="text/javascript">function OptanonWrapper() { }</script><link rel="preload" href="/_next/static/css/acc47ecb7f28ca71.css" as="style"/><link rel="stylesheet" href="/_next/static/css/acc47ecb7f28ca71.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b12d59401e55e599.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b12d59401e55e599.css" data-n-p=""/><link rel="preload" href="/_next/static/css/4315b2ada75d79ce.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4315b2ada75d79ce.css" data-n-p=""/><link rel="preload" href="/_next/static/css/e997fe3245b69611.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e997fe3245b69611.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-149a9840ee99759d.js" defer=""></script><script src="/_next/static/chunks/framework-ce84985cd166733a.js" defer=""></script><script src="/_next/static/chunks/main-2aa161cc193cdf0e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-2784b74fa600b386.js" defer=""></script><script src="/_next/static/chunks/4b358913-e177b648ea0062d1.js" defer=""></script><script src="/_next/static/chunks/f10e284a-c46ff7024e963ef1.js" defer=""></script><script src="/_next/static/chunks/dff27125-edb64a536e668286.js" defer=""></script><script src="/_next/static/chunks/4322cd96-db9c9cbc97931387.js" defer=""></script><script src="/_next/static/chunks/5300-5d5240edfe5088d0.js" defer=""></script><script src="/_next/static/chunks/1954-12f2cdecebc8919e.js" defer=""></script><script src="/_next/static/chunks/676-2a191cf9e8fce8ff.js" defer=""></script><script src="/_next/static/chunks/2580-447bcccef7567d77.js" defer=""></script><script src="/_next/static/chunks/8407-f765b09e5f9d9e88.js" defer=""></script><script src="/_next/static/chunks/8973-5b086d43f68f9a0f.js" defer=""></script><script src="/_next/static/chunks/9381-02b165248d10c3a6.js" defer=""></script><script src="/_next/static/chunks/9966-46611a17ae99bd7e.js" defer=""></script><script src="/_next/static/chunks/4089-21267ff85ef1a1bd.js" defer=""></script><script src="/_next/static/chunks/4883-5e080e89aa97bea0.js" defer=""></script><script src="/_next/static/chunks/7675-b6078f31b8f7cdd7.js" defer=""></script><script src="/_next/static/chunks/4636-ba4ebbe439f00319.js" defer=""></script><script src="/_next/static/chunks/706-77eec08b70578726.js" defer=""></script><script src="/_next/static/chunks/pages/analytics/pt-esc-threat-intelligence/%5Bslug%5D-301146ceec0052df.js" defer=""></script><script src="/_next/static/fGk60SBlODknG4pBg3RpC/_buildManifest.js" defer=""></script><script src="/_next/static/fGk60SBlODknG4pBg3RpC/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div><header class="Header_header__Hd6K0" id="nav-bar"><div><a class="Logo_logo__3fKo7" href="/"><img alt="" loading="lazy" decoding="async" data-nimg="fill" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent" src="https://pt-global.storage.yandexcloud.net/logo_header_1bd424ccc4.svg"/></a></div><nav role="navigation" class="Nav_nav__kBEMb"><a class="NavItem_nav_item__awGsH" href="/"><div class="Text_base__riB2c Text_type_pM__mE14b"><span>Products</span></div></a><a class="NavItem_nav_item__awGsH" href="/services"><div class="Text_base__riB2c Text_type_pM__mE14b"><span>Services</span></div></a><a class="NavItem_nav_item__awGsH" href="/"><div class="Text_base__riB2c Text_type_pM__mE14b"><span>Education</span></div></a><a class="NavItem_nav_item__awGsH" href="/about/news"><div class="Text_base__riB2c Text_type_pM__mE14b"><span>News & events</span></div></a><a class="NavItem_nav_item__awGsH" href="/"><div class="Text_base__riB2c Text_type_pM__mE14b"><span>Analytics</span></div></a><a class="NavItem_nav_item__awGsH" href="/"><div class="Text_base__riB2c Text_type_pM__mE14b"><span>About us</span></div></a></nav><div class="Controls_list__PN_H7"><a class="Controls_locale__3CfMZ" href="https://www.ptsecurity.com/choose-region/?return_url=/analytics/pt-esc-threat-intelligence/steganoamor-campaign-ta558-mass-attacking-companies-and-public-institutions-all-around-the-world"><img alt="locale" loading="lazy" width="16" height="16" decoding="async" data-nimg="1" style="color:transparent" src="/images/common/language.svg"/><div class="Text_base__riB2c Text_type_pM__mE14b"><span>English</span></div></a><button type="button" class="Button_button__tsTx6 Button_hasBorder__K5Pnv"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13 13L10.1 10.1M11.6667 6.33333C11.6667 9.27885 9.27885 11.6667 6.33333 11.6667C3.38781 11.6667 1 9.27885 1 6.33333C1 3.38781 3.38781 1 6.33333 1C9.27885 1 11.6667 3.38781 11.6667 6.33333Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></header><main id="main" class="PageLayout_main__LUbC0"><div class="ArticleHeader_banner__enm6f"><section class="PageSection_section__GxaaG ArticleHeader_section__sve5w ArticleHeader_withBottomBar__d_wKA"><div class="ArticleHeader_header___PnMn"><div class="ArticleHeader_headerInner__2bYRI"><h2 class="Heading_base__MUnbH Heading_level_2__qXMBH"><span>SteganoAmor campaign: TA558 mass-attacking companies and public institutions all around the world</span></h2></div></div><div class="ArticleHeader_bottomBar__EgyS1"><div class="ArticleHeader_leftSide__gAaId"><div class="ArticleBageLink_container__n25zS"><div class="ArticleBageLink_icon__Z9k9v"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.312 12.1358L8 14.7438L3.688 12.1358C3.1848 11.8491 2.76468 11.4366 2.46878 10.9388C2.17288 10.441 2.01135 9.8748 2 9.29577L2 2.50377C2 2.50377 2.04 2.39977 2.16 2.35177L7.808 1.21577C7.93487 1.19175 8.06513 1.19175 8.192 1.21577L13.84 2.35177C13.96 2.35177 14 2.46377 14 2.50377L14 9.29577C13.9887 9.8748 13.8271 10.441 13.5312 10.9388C13.2353 11.4366 12.8152 11.8491 12.312 12.1358Z" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path><path d="M6.40039 7.1999L8.00039 8.7999L10.4004 6.3999" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg></div><a href="/analytics/pt-esc-threat-intelligence"><div class="Text_base__riB2c Text_type_pS__4RXUf Text_theme_dark__type_pS__jWlgX"><span>PT EXPERT SECURITY CENTER</span></div></a></div><div class="ArticleDate_dark__bQPEn Text_base__riB2c Text_type_pS__4RXUf Text_theme_dark__type_pS__jWlgX"><span>14 APRIL 2024</span></div></div><div class="ArticleHeader_rightSide__zUGU_"><button type="button" class="ButtonShareLink_extraButton__6pf3i ArticleHeader_extraButton__zTZOf Button_button__F7Ulc Button_button_size_s___Bpb6 Button_button_theme_dark__iuu3A"><span>Share<img alt="share" loading="lazy" width="16" height="16" decoding="async" data-nimg="1" style="color:transparent" src="/_next/static/media/sharing.472b5ae7.svg"/></span></button></div></div></section></div><section class="PageSection_section__GxaaG Card_section__QzdVO"><div class="Card_contentWrapper__45uLa Card_mode_light__02f7V Card_zIndex_1__NP_2j"><div class="ArticleLayout_grid__ARjhp"><div class="ArticleLayout_leftColumn___AQb_"><div class="SidebarWidgets_root__EIInZ"><div class="SidebarWidget_root__2qKSt" data-theme="light"><span class="SidebarWidget_badge__tPniR" aria-hidden="true"></span><a href="/analytics"><h4 class="SidebarWidget_link__IFJJP Heading_base__MUnbH Heading_level_4__vTL_m Heading_theme_light__level_4__u4aOM"><span>Analytics articles</span></h4></a><ul class="SidebarWidget_articles__1tx0t"><li class="ArticlesWidget_article__5hn4y"><div class="ArticlesWidget_article_date__LAjT6 ArticleDate_light__n8s4o Text_base__riB2c Text_type_pS__4RXUf Text_theme_light__type_pS__eERKe"><span>22 October 2024</span></div><a target="_blank" href="/analytics/india-cyberthreat-landscape-q3-2023-q3-2024"><div class="ArticlesWidget_article_text__Bx4ya Text_base__riB2c Text_type_pM__mE14b Text_clamp_3__8DSUm Text_theme_light__type_pM__2zLmc"><span>India: cyberthreat landscape Q3 2023-Q3 2024</span></div></a></li><li class="ArticlesWidget_article__5hn4y"><div class="ArticlesWidget_article_date__LAjT6 ArticleDate_light__n8s4o Text_base__riB2c Text_type_pS__4RXUf Text_theme_light__type_pS__eERKe"><span>21 October 2024</span></div><a target="_blank" href="/analytics/trending-vulnerability-digest-september-2024"><div class="ArticlesWidget_article_text__Bx4ya Text_base__riB2c Text_type_pM__mE14b Text_clamp_3__8DSUm Text_theme_light__type_pM__2zLmc"><span>Trending vulnerability digest September 2024</span></div></a></li><li class="ArticlesWidget_article__5hn4y"><div class="ArticlesWidget_article_date__LAjT6 ArticleDate_light__n8s4o Text_base__riB2c Text_type_pS__4RXUf Text_theme_light__type_pS__eERKe"><span>17 October 2024</span></div><a target="_blank" href="/analytics/positive-research-2024"><div class="ArticlesWidget_article_text__Bx4ya Text_base__riB2c Text_type_pM__mE14b Text_clamp_3__8DSUm Text_theme_light__type_pM__2zLmc"><span>Positive Research 2024</span></div></a></li></ul></div><div class="AdBanner_banner__j5zzr"><img alt="" loading="lazy" decoding="async" data-nimg="fill" class="AdBanner_image__gI5SU" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;object-fit:cover;color:transparent" src="https://pt-global.storage.yandexcloud.net/PT_Network_Attack_Discovery_2x_0d8a5793c7.png"/><div class="AdBanner_detail__O_Wq5"><h4 class="Heading_base__MUnbH Heading_level_4__vTL_m Heading_theme_dark__level_4__5RqHy"><span>What are the security threats on your network?</span></h4><div class="Text_base__riB2c Text_type_pM__mE14b Text_theme_dark__type_pM__3GUPK"><span>Check your traffic-for free</span></div><a class="AdBanner_button___qTOt Button_button__F7Ulc Button_button_size_m__cmMD_ Button_button_theme_dark__iuu3A" href="/analytics/pt-esc-threat-intelligence/steganoamor-campaign-ta558-mass-attacking-companies-and-public-institutions-all-around-the-world#contacts"><span><span>Request pilot</span></span><img alt="" loading="lazy" width="20" height="20" decoding="async" data-nimg="1" class="Button_arrow__ZXQXI" style="color:transparent" src="/_next/static/media/arrows-right.1fc87099.svg"/></a></div></div></div></div><div class="ArticleLayout_rightColumn__c8u4z"><div class="HtmlContent_content__ajDaE esiArticle_bitrixContent__PCSBe"><p>By Aleksandr Badaev, Kseniya Naumova</p>

<h2>Key findings:</h2>

<ul>
<li>The group is targeting various countries around the world in addition to its priority region of Latin America.</li>
<li>It uses long chains that incorporate a variety of tools and malware: AgentTesla, FormBook, Remcos, LokiBot, Formbook, Guloader, SnakeKeylogger, XWorm, and others.</li>
<li>The group uses compromised legitimate FTP servers for C2, and SMTP servers, for C2 and phishing.</li>
<li>The group uses legitimate services to store malware strings, and images with embedded malicious code.</li>
</ul>

<p>Researchers from the Positive Technologies Expert Security Center discovered more than three hundred attacks worldwide, which they confidently attributed to the well-known TA558 group.</p>

<p>As originally <a href="https://www.proofpoint.com/us/blog/threat-insight/reservations-requested-ta558-targets-hospitality-and-travel" target="_blank">described by researchers at ProofPoint</a>, TA558 is a relatively small financially motivated cybercrime group that has attacked hospitality and tourism organizations mainly in Latin America, but has also been identified behind attacks on North America and Western Europe. According to the researchers, the group has been active since at least 2018.</p>

<p>In the attacks that we studied, the group made extensive use of steganography by sending VBSs, PowerShell code, as well as RTF documents with an embedded exploit, inside images and text files. Interestingly, most of the RTF documents and VBSs have names like <b>greatloverstory.vbs, easytolove.vbs, iaminlovewithsomeoneshecuteandtrulyyoungunluckyshenotundersatnd_howmuchiloveherbutitsallgreatwithtrueloveriamgivingyou.doc,</b> and others, associated with love, which is why we dubbed the campaign &quot;SteganoAmor&quot;.</p>

<h2>Contents</h2>
<div class="article-nav">
<ul>
        <li><a class="link link_article-nav anchorLink" target="_blank" href="#id0">Victims</a></li>
        <li><a class="link link_article-nav anchorLink" target="_blank" href="#id1">The research begins</a></li>
        <li><a class="link link_article-nav anchorLink" target="_blank" href="#id2">Other infection chains</a></li>
    <ul>
        <li><a class="link link_article-nav anchorLink" target="_blank" href="#id3">1.1 AgentTesla attack: the main scenario involving an Excel document and steganography</a></li>
        <li><a class="link link_article-nav anchorLink" target="_blank" href="#id4">1.2 AgentTesla attack: an alternate scenario involving a Microsoft Word document</a></li>
        <li><a class="link link_article-nav anchorLink" target="_blank" href="#id5">1.3 Remcos attack</a></li>
        <li><a class="link link_article-nav anchorLink" target="_blank" href="#id6">1.4 XWorm attack</a></li>
        <li><a class="link link_article-nav anchorLink" target="_blank" href="#id7">1.5 LokiBot attack</a></li>
        <li><a class="link link_article-nav anchorLink" target="_blank" href="#id8">1.6 Guloader/Formbook attack</a></li>
        <li><a class="link link_article-nav anchorLink" target="_blank" href="#id9">1.7 SnakeKeylogger attack</a></li>
        <li><a class="link link_article-nav anchorLink" target="_blank" href="#id10">1.8 Other attack examples</a></li>
    </ul>
        <li><a class="link link_article-nav anchorLink" target="_blank" href="#id11">The group&#x27;s use of legitimate FTP and SMTP servers</a></li>
        <li><a class="link link_article-nav anchorLink" target="_blank" href="#id12">Attribution to known groups</a></li>
        <li><a class="link link_article-nav anchorLink" target="_blank" href="#id13">Conclusion</a></li>
        <li><a class="link link_article-nav anchorLink" target="_blank" href="#id14">Product detection rules</a></li>
    <ul>
<li><a class="link link_article-nav anchorLink" target="_blank" href="#id15-1">PT Sandbox</a></li>
        <li><a class="link link_article-nav anchorLink" target="_blank" href="#id15">PT NAD</a></li>
        <li><a class="link link_article-nav anchorLink" target="_blank" href="#id16">MaxPatrol SIEM</a></li>
  </ul>
    <li><a class="link link_article-nav anchorLink" target="_blank" href="#id17">IOCs</a></li>
</ul>
</div>

<article>
<h2 id="id0">Victims</h2>

<p>In the course of our research, we discovered numerous samples that targeted various economic sectors and countries. Most of the email messages we came across had been sent to Latin America, but a considerable percentage were addressed to companies in Russia, Romania, Turkey, and some other countries.</p>

<p>Some of the victims that we saw had legitimate FTP and SMTP servers, which the threat actor infected and utilized as C2 servers. They also used the infected SMTP servers to send phishing email.</p>

<p>As our research effort continued, we found servers with public directories in which the group placed files to be used in its attacks.</p>

<figure><img alt="An example of a public directory" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/1.png"/>
<figcaption>Figure 1. An example of a public directory</figcaption>
</figure>

<p>We also found malware logs containing stolen data on the servers with public directories. Thus, data stolen with the help of AgentTesla was stored in the form of HTML files whose names conformed to the following template:</p>

<ul>
<li>PW_*PC_name*_*date of exfiltration*_*time of exfiltration*.html</li>
</ul>

<p>The files contained aggregated credentials for every known browser, email (for example, Outlook and Thunderbird) account credentials, and remote access (VPN or RDP) credentials.</p>

<figure><img alt="A log example" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ww-en/images/esc/article-402709/2-1.png"/>
<figcaption>Figure 2. A log example</figcaption>
</figure>

<p>The logs included data from regular users, public institutions, and various businesses.</p>

<p>We discovered a total of more than 320 attacks targeting the following countries and sectors:</p>

<div class="chart-row">
<div class="chart-row__item chart-row__item_full-width">
<div class="Highchart_chart___hRui"><div></div></div>
<div class="chart-row__caption">
<span>Figure 3. Distribution of attacks by country</span>
</div>
</div>
</div>

<p>In the course of our research, we discovered attacks on specific companies. The number of attacks on specific targets differs significantly from the total number of discovered attacks, as we could not always find out who the victim was.</p>

<div class="chart-row">
<div class="chart-row__item chart-row__item_full-width">
<div class="Highchart_chart___hRui"><div></div></div>
<div class="chart-row__caption">
<span>Figure 4. Distribution of attacks by sectors</span>
</div>
</div>
</div>

<h2 id="id1">The research begins</h2>

<p>While monitoring threats, members of the ESC team discovered a file named &quot;factura 00005111, 005114, 005115.pdf.xlam&quot; SHA-256: 69ffd7a475c64517c9c1c0282fd90c47597e3d4650320158cfb8c189d591db8c. Linked files led them to an email message. The file name &quot;banned-20240117T134543-25672-12″ suggested that the message had reached the recipient but was blocked by security systems. It was ostensibly sent to a Romanian company from another Romanian company:</p>

<figure><img alt="The phishing email with a malicious attachment" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/5.jpg"/>
<figcaption>Figure 5. The phishing email with a malicious attachment</figcaption>
</figure>

<p>The sender&#x27;s IP address, 46.27.49.180, was replaced with another. Our data indicated that the group had sent 22 other messages from that IP address to various organizations starting on June 15, 2023.</p>

<p>When the message is opened, Excel downloads with the help of macros a file named &quot;packedtpodododod.exe&quot; (SHA-256:C42288A5946D2C3EB35E7485DD85936C1FABF49E46B12449C9136FF974A12F91) from the following URL:</p>

<ul>
<li>94.156.65[.]225/packedtpodododod.exe</li>
</ul>

<p>An RTF file could be downloaded from the same IP address via the following URL:</p>

<ul>
<li style="word-break:break-all">94.156.65[.]225/microsoftdecidedtodesignnewproducttoupdateandupgradenewprojectthingsonthepcandsystem.doc</li>
</ul>

<p>This variant contains CVE-2017-11882 and downloads the following file in the chain from the URL:</p>

<ul>
<li>94.156.65[.]225/herewegoxla.exe.</li>
</ul>

<p>Once downloaded, the file runs. The final payload is AgentTesla hiding behind an Excel icon, which uploads data to the C2 via FTP. The C2 itself is a legitimate website that has been compromised.</p>

<h2 id="id2">Other infection chains</h2>

<p>Thanks to internal systems, we discovered dozens of different files linked to the FTP server, which was used as a C2 for AgentTesla. Most of the files linked to the FTP server were used in malicious files that bore Spanish, Portuguese, and Romanian names.</p>

<p>We also used our systems to successfully discover hundreds of different files and dozens of malicious IP addresses used by the group in the campaign at hand. Some of the files were documents with various name extensions and targeting different countries, but sharing one infrastructure and similarities between the attack chains. The files had different names in English, Bulgarian, Croatian, Turkish, Russian, Chinese, and other languages.</p>

<p>Below, you will find examples of chains containing malware that belongs to a variety of families: AgentTesla, Remcos, XWorm, LokiBot, Guloader, Formbook, SnakeKeylogger. We would like to emphasize that one type of malware may be involved in several different chains. A complete list of indicators of compromise is available under IOCs below.</p>

<h3 id="id3">1.1 AgentTesla attack: the main scenario involving an Excel document and steganography</h3>

<p>The main scenario we saw in this campaign and which gave it its name is an attack chain that involves steganography.</p>

<p>A case in point is a file named &quot;Cerere de cotatie.xla&quot; (SHA-256: 64020a7a3f5f6c589272f28d727318eb5eb4eb4d41510679cb8134c0325c8fe2) 
It kicks off the chain. When opened, it exploits CVE-2017-11882, sending a request to the URL:</p>

<ul>
<li style="word-break:break-all">qly[.]ai/08XE5, a shortened link that redirects to 23.95.60.74/weareinlovewithmygirlfriendunderstandhowitistoget___youareverybeautifilformeiloveusoomuchalwaysloveutrulyfromtheheartlove.doc</li>
</ul>

<figure><img alt="Request for the next stage (after opening the document)" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/6.png"/>
<figcaption>Figure 6. Request for the next stage (after opening the document)</figcaption>
</figure>

<p>The file received with the server response (SHA-256: 2c58ca41949aa784dce6a2006162781fe7a7a5453cafb731ee4d512efe718c43) is an RTF document.</p>

<figure><img alt="Receiving an RTF document" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/7.png"/>
<figcaption>Figure 7. Receiving an RTF document</figcaption>
</figure>

<p>When opened, it runs and downloads a VBS script from that same IP address:</p>

<ul>
<li style="word-break:break-all">23[.]95[.]60[.]74/roammamamamam.vbs</li>
</ul>

<figure><img alt="Request for an RTF document to obtain VBS" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/8.png"/>
<figcaption>Figure 8. Request for an RTF document to obtain VBS</figcaption>
</figure>

<p>The VBS script sends a request to paste[.]ee to fetch the next payload:</p>

<ul>
<li>paste[.]ee/d/FZTcX</li>
</ul>

<figure><img alt="Malicious code in the legitimate paste[.]ee service" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/9.png"/>
<figcaption>Figure 9. Malicious code in the legitimate paste[.]ee service</figcaption>
</figure>

<p>It then proceeds to downloading and decoding an encoded malicious string (steganography) embedded in an image from the following URLs:</p>

<ul>
<li style="word-break:break-all">uploaddeimagens[.]com[.]br/images/004/753/714/original/new_image.jpg?1709908350</li>
<li style="word-break:break-all">uploaddeimagens[.]com[.]br/images/004/753/713/original/new_image.jpg?1709908316</li>
</ul>

<p>The images are the same:</p>

<figure><img alt="An image downloaded from the legitimate service" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/10.png"/>
<figcaption>Figure 10. An image downloaded from the legitimate service</figcaption>
</figure>

<ul>
<li style="word-break:break-all">new_image.jpg (SHA-256: 1435aef381b7e31245e2ca66818209a7f8d54daef4d0db25ef78b3a9fec3242b)</li>
</ul>

<p>A Base64-encoded next-stage payload hidden inside the downloaded image:</p>

<figure><img alt="The Base64-encoded payload" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/11.png"/>
<figcaption>Figure 11. The Base64-encoded payload</figcaption>
</figure>

<p>The PowerShell command inside the script:</p>

<figure><img alt="The PowerShell code inside the script" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/12.png"/>
<figcaption>Figure 12. The PowerShell code inside the script</figcaption>
</figure>

<p>The script then decrypts the payload from the image and downloads a further payload from the same URL, written in reverse string format. Its content is notably a Base64-encoded executable, also reversed:</p>

<ul>
<li style="word-break:break-all">23[.]95[.]60[.]74/romamammamamamaa.txt</li>
</ul>

<figure><img alt="Payload with reversed Base64 code" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/13.png"/>
<figcaption>Figure 13. Payload with reversed Base64 code</figcaption>
</figure>

<p>Next, AgentTesla runs. The malware runs a check as a bypass element to make sure that it is not running on a hosting platform, and the victim&#x27;s IP address is real.</p>
<ul>
<li>ip-api[.]com/line/?fields=hosting</li>
</ul>

<p>AgentTesla steals data from browsers, email clients, remote access services, and connects via FTP to a C2 to upload it.</p>

<figure><img alt="Communication with the C2 server" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/14.jpg"/>
<figcaption>Figure 14. Communication with the C2 server</figcaption>
</figure>

<figure><img alt="Exfiltration" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/15.jpg"/>
<figcaption>Figure 15. Exfiltration</figcaption>
</figure>

<h3 id="id4">1.2 AgentTesla attack: an alternate scenario involving a Microsoft Word document</h3>

<p>This is a late-2023 example that we do not see the malicious actor use as much any more, but still find samples of:</p>

<p>&quot;Lista de productos 2.docx&quot; (SHA-256: 54376ee15cca7c6cdecc27b701b85bdd2aa618fe8158a453d65030425154299a)</p>

<figure><img alt="The malicious document with OLE" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/16.png"/>
<figcaption>Figure 16. The malicious document with OLE</figcaption>
</figure>

<p>When run, it sends a request to shlx.us/eO, which redirects to the following URL:</p>

<ul>
<li style="word-break:break-all">23.95.122[.]104/htm/1/HTMLbrowserIEchromeHistoryCleaner.doc</li>
</ul>

<figure><img alt="The next-stage request after opening the document" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/17.png"/>
<figcaption>Figure 17. The next-stage request after opening the document</figcaption>
</figure>

<p>The downloaded document (SHA-256: 6cab2705e5bfe56db1e9a74c8af9dca162de7631dd8dc074685dcb9c1dc7c5a2) is a malicious RTF document containing an exploit:</p>

<figure><img alt="Getting the RTF document" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/18.png"/>
<figcaption>Figure 18. Getting the RTF document</figcaption>
</figure>

<p>The RTF document then downloads &quot;IGCC.exe&quot;, which is AgentTesla.</p>

<figure><img alt="The RTF document fetches the AgentTesla payload" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/19.png"/>
<figcaption>Figure 19. The RTF document fetches the AgentTesla payload</figcaption>
</figure>

<p>As a result, AgentTesla starts communication via FTP with the C2 and proceeds to exfiltrate data:</p>

<figure><img alt="Exfiltrating the victim&#x27;s data" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/20.jpg"/>
<figcaption>Figure 20. Exfiltrating the victim&#x27;s data</figcaption>
</figure>

<h3 id="id5">1.3 Remcos attack</h3>

<p>Remcos, or Remote Control and Surveillance, originally legitimate software, is currently employed by many threat actors as a RAT (Remote Access Trojan) to access a victim&#x27;s computer.</p>

<p>In the course of our research, we found multiple Remcos samples used in attacks by the group.</p>

<p>One of these files is named &quot;ORDER_SPECIFICATIONS_OFFER.xla&quot; (SHA-256: 93946883de3d4074ac4baed60abcc3f2d0c57c8ef6e41ceaedbc5ca0de55dc30):</p>

<figure><img alt="A malicious Excel document with OLE" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/21.png"/>
<figcaption>Figure 21. A malicious Excel document with OLE</figcaption>
</figure>

<p>When the file is opened, the macro inside the Excel file reaches out to the first C2 at the shortened URL qly[.]ai/p5Zpt for additional data:</p>

<figure><img alt="The request to qly[.]ai/p5Zpt" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/22.png"/>
<figcaption>Figure 22. The request to qly[.]ai/p5Zpt</figcaption>
</figure>

<p>The URL redirects the request to an RTF document containing an exploit:</p>

<ul>
<li style="word-break:break-all">147.185.243[.]107/45700/macc/shelovemywifemorethankanyonebutsametimeiloveagirlwholovingmealot_____sheisreallymyloverwhocarewholovedmefromtheheart.doc с cve-2017-11882</li>
</ul>

<figure><img alt="The request after the redirect" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/23.png"/>
<figcaption>Figure 23. The request after the redirect</figcaption>
</figure>

<p>This is followed by a request to the next URL, which responds with an obfuscated VBS script, rather than an image:</p>

<ul>
<li style="word-break:break-all">147.185.243[.]107/45700/beautifulglobe.jpg,</li>
</ul>

<figure><img alt="The VBS script" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/24.png"/>
<figcaption>Figure 24. The VBS script</figcaption>
</figure>

<p>This script contains the embedded address of the next C2 in the chain, which hosts another obfuscated script:</p>

<ul>
<li>paste[.]ee/d/NYO9X</li>
</ul>

<figure><img alt="The VBS script in the legitimate paste.ee service" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/25.png"/>
<figcaption>Figure 25. The VBS script in the legitimate paste.ee service</figcaption>
</figure>

<p>We found deobfuscation of this script to be more interesting than the first one, as it contained more encoding iterations. The result was a piece of code inside, containing a reversed string for the following C2:</p>

<ul>
<li>147.185.243[.]107/45700/MACC.txt:</li>
</ul>

<figure><img alt="The deobfuscation process" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/26.png"/>
<figcaption>Figure 26. The deobfuscation process</figcaption>
</figure>

<p>Once inside the TXT file, we found the final link in the chain: a reversed Base64-encoded piece of code:</p>

<figure><img alt="The MACC.txt code" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/27.png"/>
<figcaption>Figure 27. The MACC.txt code</figcaption>
</figure>

<p>The chain results in infection with the Remcos RAT (SHA-256: bd296301230adac77b09dc91d06ec26adbc49d015ea7d1b4f68b6805c2b5ee55).</p>

<p>Before talking to the remote server, Remcos calls geoplugin[.]net/json.gp to check the IP address, and then contacts the C2 using TLS mimicry to hide the traffic:</p>

<figure><img alt="The conversation between Remcos and the C2 server" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/28.png"/>
<figcaption>Figure 28. The conversation between Remcos and the C2 server</figcaption>
</figure>

<h3 id="id6">1.4 XWorm attack</h3>

<p>XWorm is among the most popular RATs, used by many threat actors including TA 558.</p>

<p>Similarly to the previous case, one of these chains begins with an Excel file containing an embedded link, which redirects requests to another server to download an RTF document with an exploit inside. In this case, we saw the files 7b768394fa0869d92f872eb486f49fabd6469ef3a8fd8bdf9cb49d35b39ea73b and 94bcfc033fd6e445163116ebf73877ef71e22192bef829822314042b31a7281f, which, when run, redirected to a URL to fetch the next stage:</p>

<ul>
<li>107.175.31[.]187/7508/iconimages.jpg</li>
</ul>

<figure><img alt="The RTF request for a VBS script" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/29.png"/>
<figcaption>Figure 29. The RTF request for a VBS script</figcaption>
</figure>

<p>The script contains an embedded URL:</p>

<ul>
<li>paste[.]ee/d/G5J31</li>
</ul>

<p>Its content is an obfuscated VBS script containing two links to images with additional payloads:</p>

<ul>
<li style="word-break:break-all">uploaddeimagens[.]com [.]br/images/004/755/997/original/new_image_r.jpg?1710413993</li>
<li style="word-break:break-all">uploaddeimagens[.]com [.]br/images/004/755/997/original/new_image_r.jpg?1710413993</li>
</ul>

<figure><img alt="The request to fetch the images" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/30.png"/>
<figcaption>Figure 30. The request to fetch the images</figcaption>
</figure>

<p>As with the main case described above, the strings from the images are decoded, and a payload is assembled, which then downloads a TXT file with a reversed Base64-encoded file, which is the final payload: XWorm.</p>

<ul>
<li>107.175.31[.]187/7508/xwo.txt</li>
</ul>

<figure><img alt="The payload with the reversed Base64-encoded file" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/31.png"/>
<figcaption>Figure 31. The payload with the reversed Base64-encoded file</figcaption>
</figure>

<p>Once running, XWorm starts talking to the C2:</p>

<ul>
<li>147.124.212[.]213:6161</li>
</ul>

<figure><img alt="XWorm talking to the C2 server" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/32.png"/>
<figcaption>Figure 32. XWorm talking to the C2 server</figcaption>
</figure>

<h3 id="id7">1.5 LokiBot attack</h3>

<p>LokiBot is a stealer that collects data from various applications used by the victim, such as browsers, email and FTP clients, and so on. One of these files was received from:</p>

<ul>
<li style="word-break:break-all">23.94.239[.]119/_—00_o______---0o0_00_0oo_0-o_o0-__________o0o-__________/ozzwerdfdghjfdggsahfhfghf.doc</li>
</ul>

<figure><img alt="Downloading an RTF file" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/33.png"/>
<figcaption>Figure 33. Downloading an RTF file</figcaption>
</figure>

<p>As in the other instances, the file is an RTF document that downloads a PE file (SHA-256: adc6a50e5985c31f0ed5ea885edd73e787f893f709591e5cf795fd78403d1430) from the following URL:</p>

<ul>
<li>23.94.239[.]119/112/vbc.exe</li>
</ul>

<figure><img alt="Downloading the PE file" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/34.png"/>
<figcaption>Figure 34. Downloading the PE file</figcaption>
</figure>

<p>The file is LokiBot, which starts communicating with the C2, sending information to the following URL:</p>

<ul>
<li>sempersim[.]su/ha1/fre.php</li>
</ul>

<figure><img alt="Communication between LokiBot and the C2 server" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/35.jpg"/>
<figcaption>Figure 35. Communication between LokiBot and the C2 server</figcaption>
</figure>

<h3 id="id8">1.6 Guloader/Formbook attack</h3>

<p>This example begins with the file named &quot;NEW ORDER.xls&quot; (SHA-256: 3688f05556a136fe094de5cb1888eac2a579525f72cd027e19738582ed40c283).</p>

<figure><img alt="The contents of &quot;NEW ORDER.xls&quot;" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/36.png"/>
<figcaption>Figure 36. The contents of &quot;NEW ORDER.xls&quot;</figcaption>
</figure>

<p>The macro inside the Excel file starts the next chain, similar to what we saw earlier. First, it sends a request to:</p>

<ul>
<li>2s[.]gg/3zs</li>
</ul>

<figure><img alt="The request before the redirect" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/37.png"/>
<figcaption>Figure 37. The request before the redirect</figcaption>
</figure>

<p>It then redirects to an RTF document with the previously mentioned CVE:</p>

<ul>
<li style="word-break:break-all">103.237.87[.]56/rew/re/binwecanmaintainthenewthingswithhimbecauseiwasrunningaroundthewroldwithnew____icangofornewthingsfortruestoryuloverbrother.doc</li>
</ul>

<figure><img alt="Downloading the malicious RTF file" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/38.png"/>
<figcaption>Figure 38. Downloading the malicious RTF file</figcaption>
</figure>

<p>Guloader, to be used as the loader for fetching the next piece of malware, is then downloaded from the following IP address:</p>

<ul>
<li>103.237.87[.]56/setup/bin.exe</li>
</ul>

<figure><img alt="Downloading Guloader" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/39.png"/>
<figcaption>Figure 39. Downloading Guloader</figcaption>
</figure>

<p>The Guloader file (SHA-256: bfd50523e4cabf7fe9e6f0afc926b9269708ac80af43a943ebcbc909a9ae0695)accesses a Google Drive to get the malware payload, FormBook:</p>

<ul>
<li style="word-break:break-all">drive.google[.]com/uc?export=download&amp;id=1QJZpYWwA5nTHlXAY5PxXqGvqEBOtjtOi -&gt; drive.usercontent.google[.]com/download?id=1QJZpYWwA5nTHlXAY5PxXqGvqEBOtjtOi&amp;export=download</li>
</ul>

<p>Once running, FormBook (SHA-256: e1259d936c3993e5d8671b8b5e2362eb974984d046871296c50cf51ee1a96e4b) starts talking to the C2:</p>

<ul>
<li style="word-break:break-all">thechurchinkaty[.]com/nrup/?vLwt1tg=a+HLDFsiIkHuV4rn/wjkuvItWj7ch7WMO9xbFOtVeNEzn7JMPDdWHI+pluLOfQ5QTDqWxNNxIGS7LM9UJKf1d/iZERaTVE3Mnox0RAyMAaysT2DaDQ==&amp;tdCpR=qZUxOL60rvw</li>
</ul>

<figure><img alt="The communication between FormBook and the C2 server" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/40.png"/>
<figcaption>Figure 40. The communication between FormBook and the C2 server</figcaption>
</figure>

<h3 id="id9">1.7 SnakeKeylogger attack</h3>

<p>As in most of the cases we have covered so far, the chain begins with an Excel file, such as &quot;Payment_Draft_confirmation.xla&quot; (SHA-256: 9caeaefa5ecb508895fef48764dc689f49dd8ad9f7e4de9e52202f1c1db101e1).</p>

<p>When the file runs, it sends a request to the following URL:</p>

<ul>
<li>qly[.]ai/TZWGK</li>
</ul>

<figure><img alt="The request" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/41.png"/>
<figcaption>Figure 41. The request</figcaption>
</figure>

<p>This is followed by a redirect to the following URL to download an RTF document:</p>

<ul>
<li style="word-break:break-all">207.32.219[.]82/7050/snk/snkisanewthingswhichhelovesornotireallynotknowwhathelookingbutshesloved___alotwiththisnewthingswhathetoldme.doc</li>
</ul>

<figure><img alt="Downloading the RTF document" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/42.png"/>
<figcaption>Figure 42. Downloading the RTF document</figcaption>
</figure>

<p>The RTF document downloads a VBS script from the following URL:</p>

<ul>
<li style="word-break:break-all">207.32.219[.]82/7050/imaginepixelimages.jpg</li>
</ul>

<figure><img alt="Downloading the VBS script" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/43.png"/>
<figcaption>Figure 43. Downloading the VBS script</figcaption>
</figure>

<p>The next stage downloads reversed Base64-encoded strings, which prove to be SnakeKeylogger (SHA-256: 69dffbdcc112b62bfa93e2d6d95de42ef16e01e428b883b9671056ac93bbce8f) when decoded:</p>

<ul>
<li>207.32.219[.]82/7050/SNK.txt</li>
</ul>

<figure><img alt="The payload with the reversed Base64-encoded file" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/44.png"/>
<figcaption>Figure 44. The payload with the reversed Base64-encoded file</figcaption>
</figure>

<p>The first thing SnakeKeylogger does upon starting is running a check:</p>

<ul>
<li>checkip.dyndns[.]org</li>
</ul>

<figure><img alt="The checkip.dyndns.org check" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/45.jpg"/>
<figcaption>Figure 45. The checkip.dyndns.org check</figcaption>
</figure>

<p>It then checks the geographic location according to the IP address:</p>

<ul>
<li>reallyfreegeoip[.]org</li>
</ul>

<figure><img alt="The geographic location check" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/46.jpg"/>
<figcaption>Figure 46. The geographic location check</figcaption>
</figure>

<p>This is followed by a request to get an SMTP server:</p>

<ul>
<li>scratchdreams[.]tk/_send_.php?TS</li>
</ul>

<figure><img alt="The request to get an SMTP server" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/47.png"/>
<figcaption>Figure 47. The request to get an SMTP server</figcaption>
</figure>

<p>Finally, SnakeKeylogger forwards the information it stole to the compromised legitimate SMTP server:</p>

<figure><img alt="Sending data to the compromised legitimate SMTP server" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/48.jpg"/>
<figcaption>Figure 48. Sending data to the compromised legitimate SMTP server</figcaption>
</figure>

<h3 id="id10">1.8 Other attack examples</h3>

<p>We saw other attack chains. For example, here&#x27;s an example of network communication between NjRAT and C2</p>

<figure><img alt="An example of network communication between NjRAT and C2" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/49.jpg"/>
<figcaption>Figure 49. An example of network communication between NjRAT and C2</figcaption>
</figure>

<p>But these differed only insignificantly from the ones described above, essentially being the same attacks with different final payloads.</p>

<p>Thus, as we were examining the threat actor&#x27;s infrastructure, we noticed that the IP addresses used to host RTF files with exploits embedded in them and fake JPG files with embedded VBS scripts were also used as the locations for various RATs. As an example, here is the IP address of the zgRAT C2 server:</p>

<ul>
<li>94.156.69[.]17</li>
</ul>

<figure><img alt="An example of this IP address being involved in the infection chain" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/50.png"/>
<figcaption>Figure 50. An example of this IP address being involved in the infection chain</figcaption>
</figure>

<figure><img alt="An example of this IP address being used for the zgRAT C2 server" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/51.png"/>
<figcaption>Figure 51. An example of this IP address being used for the zgRAT C2 server</figcaption>
</figure>

<h2 id="id11">The group&#x27;s use of legitimate FTP and SMTP servers</h2>

<p>Upon closer inspection, the FTP servers we found turned out to be legitimate services, which the threat actor presumably had infected to use as C2s for exfiltration of victims&#x27; data extracted with the help of the malware described above.</p>

<p>In each case, the legitimate sites belonged to various small companies based in Mexico, Colombia, and Romania.</p>

<p>Here is one such site:</p>

<figure><img alt="A legitimate site" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/52.jpg"/>
<figcaption>Figure 52. A legitimate site</figcaption>
</figure>

<p>The organization has an active social media account with several thousand subscribers and a link to a website:</p>

<figure><img alt="The social media account" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/53.jpg"/>
<figcaption>Figure 53. The social media account</figcaption>
</figure>

<figure><img alt="A legitimate site" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/54.jpg"/>
<figcaption>Figure 54. A legitimate site</figcaption>
</figure>

<p>As in the previous case, this organization has an active social media account with several thousand subscribers and a link to a website:</p>

<figure><img alt="The company&#x27;s Facebook account" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/55.jpg"/>
<figcaption>Figure 55. The company&#x27;s Facebook account</figcaption>
</figure>

<p>When researching the group&#x27;s attacks on Russian companies, we noticed that, besides FTP servers, it used SMTP on compromised servers that hosted legitimate European websites:</p>

<figure><img alt="A legitimate site" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/56.jpg"/>
<figcaption>Figure 56. A legitimate site</figcaption>
</figure>

<p>The group created some of its SMTP domains to make its activities appear legitimate. Thus, one of the SMTP domains it used, itresinc.com, is apparently trying hard to look like the legitimate it-resinc.com.</p>

<p>The threat actor used these legitimate and newly created SMTP servers in two ways:</p>

<ol>
<li>To send phishing email</li>
<li>As a C2 server for spreading malware</li>
</ol>

<p>Interestingly, the group never used the same SMTP server as both a phishing server and a C2 in one attack.</p>

<p>As an example of an attack, here is an email message sent to an organization in Russia from a compromised legitimate SMTP server:</p>

<figure><img alt="The email from the compromised SMTP server" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/57.jpg"/>
<figcaption>Figure 57. The email from the compromised SMTP server</figcaption>
</figure>

<p>The phishing email came with a ZIP archive attached:</p>

<ul>
<li style="word-break:break-all">&quot;loading advice.zip&quot; SHA-256: ca383ef7a0031ff933907be8b038ccc62ac556bdc0f077d7f9c3022952e62efa</li>
</ul>

<p>The archive contained one file that was AgentTesla:</p>

<ul>
<li style="word-break:break-all">&quot;loading advice.exe&quot; SHA-256: 84b2a0360556088e4aad29627d4ed15d53b18aa72d9d98b4b0d1be27916c681e</li>
</ul>

<figure><img alt="The contents of the archive" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/58.png"/>
<figcaption>Figure 58. The contents of the archive</figcaption>
</figure>

<p>When the executable runs, it uploads data to an SMTP server that imitates a legitimate one:</p>

<ul>
<li>mail.itresinc.com</li>
</ul>

<h2 id="id12">Attribution to known groups</h2>

<p>In the course of our research, we found that a part of the campaign <a href="https://cyble.com/blog/threat-actor-employs-powershell-backed-steganography-in-recent-spam-campaigns/" target="_blank">had been described by analysts at Cyble</a>.</p>

<p>Cyble describes the same kill chain that we saw, including the use of steganography, as well as the payload, which may contain various types of malware like AgentTesla, Remcos, and so on.</p>

<p>Researchers at MetabaseQ last October <a href="https://www.metabaseq.com/ta588/" target="_blank">described</a> the same threat actor&#x27;s activity, attributing it to TA558.</p>

<p>Their report takes note of the kill chain, which also employed steganography. Although the researchers said that the victims, as with TA558 earlier, were located in Latin America, the United States, Portugal, and Spain, we have found that while TA558 mainly focuses on Latin America, the number of affected countries is much greater, and TA558 attacks completely different countries.</p>

<p>Last August, researcher Ankit Anubhav <a href="https://twitter.com/ankit_anubhav/status/1689585087267188736" target="_blank">shared</a> on X (formerly Twitter) information about TA558&#x27;s use of steganography with a final chain that resulted in infection with Quasar Rat.</p>

<p>Another Microsoft researcher, Igal Lytzki, referred to Ankit Anubhav in his <a href="https://twitter.com/0xToxin/status/1708722097885679688" target="_blank">description of a similar attack</a>, where he drew attention to steganography samples and AgentTesla on an FTP server containing logs of victims&#x27; data. Igal said he had informed the victims accordingly:</p>

<figure><img alt="Tweet by researcher Igal Lytzki" loading="lazy" width="0" height="0" decoding="async" data-nimg="1" class="HtmlContent_image-next__g1zfK" style="color:transparent" src="https://www.ptsecurity.com/upload/corporate/ru-ru/images/pt-esc/article-402404/59.png"/>
<figcaption>Fig. 59. Tweet by researcher Igal Lytzki</figcaption>
</figure>

<h2 id="id13">Conclusion</h2>

<p>The TA558 attack chains in the SteganoAmor campaign examined here continue to affect users in Latin America and elsewhere in the world. The group continues to exploit the fairly old CVE-2017-11882 in its attack chain. It uses steganography, an obfuscation technique, inside the chains to spread well-known malware used in other attacks in recent years. The phishing may be harder to detect due to the group&#x27;s use of compromised legitimate SMTP servers, so we recommend exercising caution when dealing with email that contains attachments, even if the messages were received from governmental organizations or small local companies. The use of legitimate SMTP and FTP servers, as well as tools like Guloader, may complicate detection of the threat actor&#x27;s presence on the host, so companies are advised to monitor network traffic more closely and investigate suspicious activity linked to legitimate services.</p>
</article>
            
        
    </div><div class="ShareBlock_container__5nb7z"><div class="Text_base__riB2c Text_type_pM__mE14b Text_theme_light__type_pM__2zLmc"><span>Share this article</span><span>:</span></div><div class="ShareBlock_icons__vIJLT"><button type="button" class="Social_icon__pVcgR"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none"><path stroke="currentColor" d="M8.39 10.805a4.024 4.024 0 0 0 4.628 1.36 4.023 4.023 0 0 0 1.44-.925l2.413-2.416A4.029 4.029 0 0 0 14.012 2a4.02 4.02 0 0 0-2.83 1.13L9.8 4.507m1.81 4.688a4.024 4.024 0 0 0-4.627-1.36 4.022 4.022 0 0 0-1.44.925L3.13 11.176A4.029 4.029 0 0 0 5.988 18a4.02 4.02 0 0 0 2.83-1.13l1.375-1.377"></path></svg></button></div></div></div></div><div class="HelpfulFiles_container__v0LFo"><div class="ArticleLayout_grid__ARjhp"><div class="ArticleLayout_rightColumn__c8u4z"><h2 class="HelpfulFiles_title__yUJ0m Heading_base__MUnbH Heading_level_2__qXMBH Heading_theme_light__level_2__6YX8m"><span>Helpful files</span></h2><div class="HelpfulFiles_helpfulFiles__YbVXi"><h3 class="HelpfulFiles_subtitle__WjLVi Heading_base__MUnbH Heading_level_3__MsnTf Heading_theme_light__level_3__UbKaz"><span>Product detection rules</span></h3><div class="HelpfulFiles_attachmentsWrap__l_su0"><a download="" target="_blank" class="DocumentsCard_document__1Usyu HelpfulFiles_card__SprGo" href="https://pt-global.storage.yandexcloud.net/PT_Sandbox_5638aa2b1e.csv"><div class="Text_base__riB2c Text_type_pM__mE14b Text_theme_light__type_pM__2zLmc"><span>PT Sandbox</span></div><div class="DocumentsCard_documentInfo__dTpMi"><img alt="PT Sandbox" loading="lazy" width="12" height="14" decoding="async" data-nimg="1" style="color:transparent" src="/_next/static/media/document.a43d8eb0.svg"/><div class="Text_base__riB2c Text_type_pS__4RXUf Text_theme_light__type_pS__eERKe"><span>CSV, 5 KB</span></div></div></a><a download="" target="_blank" class="DocumentsCard_document__1Usyu HelpfulFiles_card__SprGo" href="https://pt-global.storage.yandexcloud.net/PT_NAD_f234198cc9.csv"><div class="Text_base__riB2c Text_type_pM__mE14b Text_theme_light__type_pM__2zLmc"><span>PT NAD</span></div><div class="DocumentsCard_documentInfo__dTpMi"><img alt="PT NAD" loading="lazy" width="12" height="14" decoding="async" data-nimg="1" style="color:transparent" src="/_next/static/media/document.a43d8eb0.svg"/><div class="Text_base__riB2c Text_type_pS__4RXUf Text_theme_light__type_pS__eERKe"><span>CSV, 1 KB</span></div></div></a><a download="" target="_blank" class="DocumentsCard_document__1Usyu HelpfulFiles_card__SprGo" href="https://pt-global.storage.yandexcloud.net/Max_Patrol_SIEM_f5f2fc147f.csv"><div class="Text_base__riB2c Text_type_pM__mE14b Text_theme_light__type_pM__2zLmc"><span>MaxPatrol SIEM</span></div><div class="DocumentsCard_documentInfo__dTpMi"><img alt="MaxPatrol SIEM" loading="lazy" width="12" height="14" decoding="async" data-nimg="1" style="color:transparent" src="/_next/static/media/document.a43d8eb0.svg"/><div class="Text_base__riB2c Text_type_pS__4RXUf Text_theme_light__type_pS__eERKe"><span>CSV, 0 KB</span></div></div></a></div></div><div class="HelpfulFiles_helpfulFiles__YbVXi"><h3 class="HelpfulFiles_subtitle__WjLVi Heading_base__MUnbH Heading_level_3__MsnTf Heading_theme_light__level_3__UbKaz"><span>IOCs</span></h3><div class="HelpfulFiles_attachmentsWrap__l_su0"><a download="" target="_blank" class="DocumentsCard_document__1Usyu HelpfulFiles_card__SprGo" href="https://pt-global.storage.yandexcloud.net/IO_Cs_f13bba381e.csv"><div class="Text_base__riB2c Text_type_pM__mE14b Text_theme_light__type_pM__2zLmc"><span>IOCs</span></div><div class="DocumentsCard_documentInfo__dTpMi"><img alt="IOCs" loading="lazy" width="12" height="14" decoding="async" data-nimg="1" style="color:transparent" src="/_next/static/media/document.a43d8eb0.svg"/><div class="Text_base__riB2c Text_type_pS__4RXUf Text_theme_light__type_pS__eERKe"><span>CSV, 38 KB</span></div></div></a><a download="" target="_blank" class="DocumentsCard_document__1Usyu HelpfulFiles_card__SprGo" href="https://pt-global.storage.yandexcloud.net/Legitimate_services_used_in_attacks_5255fb700c.csv"><div class="Text_base__riB2c Text_type_pM__mE14b Text_theme_light__type_pM__2zLmc"><span>Legitimate services used in attacks</span></div><div class="DocumentsCard_documentInfo__dTpMi"><img alt="Legitimate services used in attacks" loading="lazy" width="12" height="14" decoding="async" data-nimg="1" style="color:transparent" src="/_next/static/media/document.a43d8eb0.svg"/><div class="Text_base__riB2c Text_type_pS__4RXUf Text_theme_light__type_pS__eERKe"><span>CSV, 0 KB</span></div></div></a><a download="" target="_blank" class="DocumentsCard_document__1Usyu HelpfulFiles_card__SprGo" href="https://pt-global.storage.yandexcloud.net/File_indicators_7ec16dbc83.csv"><div class="Text_base__riB2c Text_type_pM__mE14b Text_theme_light__type_pM__2zLmc"><span>File indicators</span></div><div class="DocumentsCard_documentInfo__dTpMi"><img alt="File indicators" loading="lazy" width="12" height="14" decoding="async" data-nimg="1" style="color:transparent" src="/_next/static/media/document.a43d8eb0.svg"/><div class="Text_base__riB2c Text_type_pS__4RXUf Text_theme_light__type_pS__eERKe"><span>CSV, 71 KB</span></div></div></a></div></div></div></div></div></div></section><section class="PageSection_section__GxaaG Card_section__QzdVO" id="contacts"><div class="Card_contentWrapper__45uLa Card_mode_light__02f7V Card_zIndex_1__NP_2j AnyQuestions_container__KVhzR"><div class="AnyQuestions_heading__pSibU"><h1 class="AnyQuestions_title__ScrF1 Heading_base__MUnbH Heading_level_1__oOibP Heading_theme_light__level_1__7KeY7"><span>Get in touch</span></h1><div class="Text_base__riB2c Text_type_pL__A_h0d Text_theme_light__type_pL___Cab8"><span>Fill in the form and our specialists<br> will contact you shortly</span></div></div><div class="AnyQuestions_content__rdK_e"><div class="CardsSlider_root__4cbz_ AnyQuestions_radioGroupWrapper__WrSuy"><div class="CardsSlider_scrollArea__LArfW AnyQuestions_radioGroup__DBJB4"><label style="--cards-count:3" data-testid="form-tab-feedback" class="CardRadio_mode_light__Fnmg8 CardRadio_container__9oMVF CardRadio_checked__7uYOJ AnyQuestions_cardLayout__p5bqj"><input name="type" type="radio" checked="" value="feedback"/><div class="CardRadio_title__SlAzv Text_base__riB2c Text_type_postscript__I0CC_ Text_theme_light__type_postscript__JvgMb"><span>General<br> questions</span></div><div class="CardRadio_description__rzM_f Text_base__riB2c Text_type_pM__mE14b Text_theme_light__type_pM__2zLmc"><span>We're happy to answer any questions you may have.</span></div></label><label style="--cards-count:3" data-testid="form-tab-partnership" class="CardRadio_mode_light__Fnmg8 CardRadio_container__9oMVF AnyQuestions_cardLayout__p5bqj"><input name="type" type="radio" value="partnership"/><div class="CardRadio_title__SlAzv Text_base__riB2c Text_type_postscript__I0CC_ Text_theme_light__type_postscript__JvgMb"><span>Partnership</span></div><div class="CardRadio_description__rzM_f Text_base__riB2c Text_type_pM__mE14b Text_theme_light__type_pM__2zLmc"><span>Join us in making the world a safer place.</span></div></label><label style="--cards-count:3" data-testid="form-tab-pilotApplication" class="CardRadio_mode_light__Fnmg8 CardRadio_container__9oMVF AnyQuestions_cardLayout__p5bqj"><input name="type" type="radio" value="pilotApplication"/><div class="CardRadio_title__SlAzv Text_base__riB2c Text_type_postscript__I0CC_ Text_theme_light__type_postscript__JvgMb"><span>Pilot<br> application</span></div><div class="CardRadio_description__rzM_f Text_base__riB2c Text_type_pM__mE14b Text_theme_light__type_pM__2zLmc"><span>Test drive our solutions with a customized pilot program.</span></div></label></div></div><form><div class="FeedbackForm_fields__NxBGh"><div class="FeedbackForm_field__GSf0c FeedbackForm_fullWidth__SPrCb"><label class="Input_container__CtV41 Input_mode_light__DDarT"><input class="Input_input__dAKAo" placeholder="Name" type="text" autoComplete="name" maxLength="250" name="fullName" value=""/></label></div><div class="FeedbackForm_field__GSf0c"><label class="Input_container__CtV41 Input_mode_light__DDarT"><input class="Input_input__dAKAo" placeholder="Phone number" type="text" autoComplete="tel" maxLength="20" name="phone" value=""/></label></div><div class="FeedbackForm_field__GSf0c"><label class="Input_container__CtV41 Input_mode_light__DDarT"><input class="Input_input__dAKAo" placeholder="Email" type="text" autoComplete="email" maxLength="250" name="email" value=""/></label></div><div class="FeedbackForm_field__GSf0c FeedbackForm_fullWidth__SPrCb"><div class="Autocomplete_root__of0uL Select_root__qV3jk Select_mode_light__6i67a"><div class="Select_select__Wgg4m"><div class="SearchField_container__r8UBy"><input placeholder="Country" class="Input_input__dAKAo SearchField_input__OhP5T" id="headlessui-combobox-input-:R1d8qkf6:" role="combobox" type="text" aria-expanded="false" aria-autocomplete="list" data-headlessui-state=""/><button class="SearchField_icon__n277G SearchField_icon_second__tgr0q SearchField_icon_action__K_KOk" id="headlessui-combobox-button-:R2d8qkf6:" type="button" tabindex="-1" aria-haspopup="listbox" aria-expanded="false" data-headlessui-state=""></button><button class="SearchField_icon__n277G SearchField_icon_grey__v_ngf" id="headlessui-combobox-button-:R3d8qkf6:" type="button" tabindex="-1" aria-haspopup="listbox" aria-expanded="false" data-headlessui-state=""><svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.7645 11.4123C12.0858 10.3117 12.9268 8.65406 12.9268 6.79999C12.9268 3.48628 10.2405 0.799988 6.92676 0.799988C3.61305 0.799988 0.926758 3.48628 0.926758 6.79999C0.926758 10.1137 3.61305 12.8 6.92676 12.8C8.3864 12.8 9.7243 12.2788 10.7645 11.4123ZM10.7645 11.4123L14.5522 15.2" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div></div></div><div class="FeedbackForm_field__GSf0c FeedbackForm_fullWidth__SPrCb"><label class="Textarea_container__HPtza Textarea_mode_light__E0Y92"><textarea id="comment" class="Textarea_textarea__MapxB" placeholder="How can we help?" maxLength="1000" name="comment"></textarea></label></div></div><div class="FeedbackForm_agrees__062n_"><label class="InputCheckbox_mode_light__1Ed_W"><input class="InputCheckbox_input__x9X51" type="checkbox" name="consentsTerms" value="false"/><div class="InputCheckbox_checkboxLabel__hXRgu Text_base__riB2c Text_type_pS__4RXUf Text_theme_light__type_pS__eERKe"><span>I give <a data-sanitize-target="_blank" href="https://global.ptsecurity.com/policies/consent" target="_blank">my&nbsp;consent to&nbsp;the processing of&nbsp;my&nbsp;personal data</a> in&nbsp;accordance with the terms of&nbsp;the <a data-sanitize-target="_blank" href="https://global.ptsecurity.com/policies/privacy-policy" target="_blank">Privacy Notice</a></span></div></label><label class="InputCheckbox_mode_light__1Ed_W"><input class="InputCheckbox_input__x9X51" type="checkbox" name="subscription" value="false"/><div class="InputCheckbox_checkboxLabel__hXRgu Text_base__riB2c Text_type_pS__4RXUf Text_theme_light__type_pS__eERKe"><span>I&nbsp;give <a data-sanitize-target="_blank" href="https://global.ptsecurity.com/policies/consent-email" target="_blank">my&nbsp;consent to&nbsp;receive marketing and&nbsp;informational messages</a></span></div></label></div><div><div class="smart-captcha"></div><button type="submit" class="Button_button__F7Ulc Button_button_size_m__cmMD_ Button_button_theme_light__W9pGX"><span><span>SEND</span></span><img alt="" loading="lazy" width="20" height="20" decoding="async" data-nimg="1" class="Button_arrow__ZXQXI" style="color:transparent" src="/_next/static/media/arrows-right.1fc87099.svg"/></button></div></form></div></div></section><footer class="Footer_wrapper__igPy4"><div class="Footer_info__BLmy7"><div class="Footer_head__3m28S"><div class="Footer_copyright__JcWnj Text_base__riB2c Text_type_pM__mE14b"><span>Copyright <mark>©</mark> 2002–2024 Positive Technologies. All rights reserved.</span></div><h2 class="Footer_heading__mQ6QG Heading_base__MUnbH Heading_level_2__qXMBH"><span>Cybersecurity market leader</span></h2><div class="Footer_additionalLinks__KyguX"><a class="Footer_additionalLink__5ONRT" target="_blank" href="https://global.ptsecurity.com/policies/terms-of-use">Legal documents</a><a class="Footer_additionalLink__5ONRT" href="https://www.ptsecurity.com/choose-region/?return_url=/analytics/pt-esc-threat-intelligence/steganoamor-campaign-ta558-mass-attacking-companies-and-public-institutions-all-around-the-world">Change region</a></div></div><nav class="Footer_nav__LBYFW"><div class="Footer_nav_col__lYnPU"><div class="NavBlock_title__7sNY5 Text_base__riB2c Text_type_pL__A_h0d"><span>Products</span></div><a class="NavBlock_list_item__wGeXz" href="/products/network-attack-discovery"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT NAD</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/sandbox"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT Sandbox</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/maxpatrol-vm"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>MaxPatrol VM</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/siem"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>MaxPatrol SIEM</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/ai"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT AI</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/blackbox"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT BlackBox</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/isim"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT ISIM</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/mp-o2"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>MaxPatrol O2</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/edr"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>MaxPatrol EDR</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/pt-af"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT Application Firewall</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/cs"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT Container Security</span></div></a><a class="NavBlock_list_item__wGeXz" href="/products/ics"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT Industrial Cybersecurity Suite</span></div></a></div><div class="Footer_nav_col__lYnPU"><div class="NavBlock_title__7sNY5 Text_base__riB2c Text_type_pL__A_h0d"><span>ANALYTICS</span></div><a class="NavBlock_list_item__wGeXz" href="/analytics"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>Analytics articles</span></div></a><a class="NavBlock_list_item__wGeXz" href="/analytics/knowledge-base"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>Knowledge base</span></div></a><a class="NavBlock_list_item__wGeXz" href="/analytics/pt-esc-threat-intelligence"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT ESC threat intelligence</span></div></a><a class="NavBlock_list_item__wGeXz" href="/analytics/threatscape"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>Threatscape</span></div></a><a class="NavBlock_list_item__wGeXz" href="/analytics/hacker-groups"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>Hacker groups</span></div></a></div><div class="Footer_nav_col__lYnPU"><div class="NavBlock_title__7sNY5 Text_base__riB2c Text_type_pL__A_h0d"><span>COMPANY</span></div><a class="NavBlock_list_item__wGeXz" href="/about"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>About us</span></div></a><a class="NavBlock_list_item__wGeXz" href="/about/clients"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>Clients</span></div></a><a class="NavBlock_list_item__wGeXz" href="/about/contacts"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>Contacts</span></div></a><a class="NavBlock_list_item__wGeXz" href="/about/pt-in-the-media"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>PT in the Media</span></div></a><a href="https://edu.ptsecurity.com/learning-space" target="_blank" class="NavBlock_list_item__wGeXz"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>Education</span></div></a><a href="https://www.youtube.com/channel/UC9hnMfdwfLd8V5qEc-6MXXQ" target="_blank" class="NavBlock_list_item__wGeXz"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>YouTube</span></div></a><a href="https://vacancy.global.ptsecurity.com/" target="_blank" class="NavBlock_list_item__wGeXz"><div class="Text_base__riB2c Text_type_pL__A_h0d"><span>Vacancy</span></div></a></div></nav></div><div><img alt="" loading="lazy" width="1200" height="100" decoding="async" data-nimg="1" class="Footer_logo__cDBuS" style="color:transparent" src="https://pt-global.storage.yandexcloud.net/logo_1d137588e3.svg"/></div></footer></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"seo":{"title":"SteganoAmor campaign: TA558 mass-attacking companies and public institutions all around the world","description":"Researchers from the Positive Technologies Expert Security Center discovered more than three hundred attacks worldwide, which they confidently attributed to the well-known TA558 group.\r\n\r\nAs originally described by researchers at ProofPoint, TA558 is a relatively small financially motivated cybercrime group that has attacked hospitality and tourism organizations mainly in Latin America, but has also been identified behind attacks on North America and Western Europe. According to the researchers, the group has been active since at least 2018.\r\n\r\nIn the attacks that we studied, the group made extensive use of steganography by sending VBSs, PowerShell code, as well as RTF documents with an embedded exploit, inside images and text files. Interestingly, most of the RTF documents and VBSs have names like greatloverstory.vbs, easytolove.vbs, iaminlovewithsomeoneshecuteandtrulyyoungunluckyshenotundersatnd_howmuchiloveherbutitsallgreatwithtrueloveriamgivingyou.doc, and others, associated with love, which is why we dubbed the campaign \u0026quot;SteganoAmor\u0026quot;."},"headerData":{"logoImage":{"src":"https://pt-global.storage.yandexcloud.net/logo_header_1bd424ccc4.svg","width":249,"height":22,"alt":""},"nav":[{"type":"product-menu","data":{"title":"Products","button":{"link":"/products","text":"Jump to section","targetBlank":false},"items":[{"description":"NDR system for detecting hidden threats on the perimeter and inside the network","link":"/products/network-attack-discovery","title":"PT NAD"},{"description":"Advanced sandbox with customizable virtual environments","link":"/products/sandbox","title":"PT Sandbox"},{"description":"Next-generation vulnerability management system","link":"/products/maxpatrol-vm","title":"MaxPatrol VM"},{"description":"Pinpoint threat detection solution for your infrastructure","link":"/products/siem","title":"MaxPatrol SIEM"},{"description":"Source-code analysis tool","link":"/products/ai","title":"PT AI"},{"description":"Dynamic application security testing tool","link":"/products/blackbox","title":"PT BlackBox"},{"description":"Cyberthreat detection and incident response in ICS","link":"/products/isim","title":"PT ISIM"},{"description":"Autopilot for result-driven cybersecurity","link":"/products/mp-o2/","title":"MaxPatrol O2"},{"description":"Protects your endpoints","link":"/products/edr","title":"MaxPatrol EDR"},{"description":"A web application firewall","link":"/products/pt-af","title":"PT Application Firewall"},{"description":"Innovative solution for the comprehensive protection","link":"/products/cs","title":"PT Container Security"},{"description":"The first comprehensive platform for cyberthreat detection and response in industrial systems","link":"/products/ics","title":"PT Industrial Cybersecurity Suite"}]}},{"type":"link","data":{"link":"/services","title":"Services"}},{"type":"product-menu","data":{"title":"Education","button":null,"items":[{"description":"","link":"https://edu.ptsecurity.com/learning-space","title":"Positive Education Learning Space"},{"description":"","link":"https://edu.ptsecurity.com/pros-programs","title":"Cybersecurity programs for Professionals"},{"description":"","link":"https://edu.ptsecurity.com/c-level-programs","title":"Cybersecurity programs for Executives"},{"description":"","link":"https://edu.ptsecurity.com/product-courses","title":"Product courses"}]}},{"type":"link","data":{"link":"/about/news/","title":"News \u0026 events"}},{"type":"product-menu","data":{"title":"Analytics","button":{"link":"/analytics","text":"Jump to section","targetBlank":false},"items":[{"description":"","link":"/analytics/knowledge-base","title":"Knowledge base"},{"description":"","link":"/analytics/pt-esc-threat-intelligence","title":"PT ESC threat intelligence"},{"description":"","link":"/analytics/threatscape","title":"Threatscape"},{"description":"","link":"/analytics/hacker-groups","title":"Hacker groups"}]}},{"type":"product-menu","data":{"title":"About us","button":{"link":"/about","text":"Jump to section","targetBlank":false},"items":[{"description":"","link":"/about/clients","title":"Clients"},{"description":"","link":"/about/contacts","title":"Contacts"},{"description":"","link":"/about/pt-in-the-media","title":"PT in the Media"},{"description":"","link":"https://vacancy.global.ptsecurity.com/","title":"Vacancy"}]}}],"searchInputPlaceholder":"Search on ptsecurity.com"},"articleData":{"content":[],"deprecatedDetailText":"\u003cp\u003eBy\u0026nbsp;Aleksandr Badaev, Kseniya Naumova\u003c/p\u003e\n\n\u003ch2\u003eKey findings:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eThe group is\u0026nbsp;targeting various countries around the world in\u0026nbsp;addition to\u0026nbsp;its priority region of\u0026nbsp;Latin America.\u003c/li\u003e\n\u003cli\u003eIt\u0026nbsp;uses long chains that incorporate a\u0026nbsp;variety of\u0026nbsp;tools and malware: AgentTesla, FormBook, Remcos, LokiBot, Formbook, Guloader, SnakeKeylogger, XWorm, and others.\u003c/li\u003e\n\u003cli\u003eThe group uses compromised legitimate FTP servers for\u0026nbsp;C2, and SMTP servers, for C2\u0026nbsp;and phishing.\u003c/li\u003e\n\u003cli\u003eThe group uses legitimate services to\u0026nbsp;store malware strings, and images with embedded malicious code.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eResearchers from the Positive Technologies Expert Security Center discovered more than three hundred attacks worldwide, which they confidently attributed to\u0026nbsp;the well-known TA558\u0026nbsp;group.\u003c/p\u003e\n\n\u003cp\u003eAs\u0026nbsp;originally \u003ca href=\"https://www.proofpoint.com/us/blog/threat-insight/reservations-requested-ta558-targets-hospitality-and-travel\" target=\"_blank\"\u003edescribed by\u0026nbsp;researchers at\u0026nbsp;ProofPoint\u003c/a\u003e, TA558\u0026nbsp;is a\u0026nbsp;relatively small financially motivated cybercrime group that has attacked hospitality and tourism organizations mainly in\u0026nbsp;Latin America, but has also been identified behind attacks on\u0026nbsp;North America and Western Europe. According to\u0026nbsp;the researchers, the group has been active since at\u0026nbsp;least 2018.\u003c/p\u003e\n\n\u003cp\u003eIn\u0026nbsp;the attacks that we\u0026nbsp;studied, the group made extensive use of\u0026nbsp;steganography by\u0026nbsp;sending VBSs, PowerShell code, as\u0026nbsp;well as\u0026nbsp;RTF documents with an\u0026nbsp;embedded exploit, inside images and text files. Interestingly, most of\u0026nbsp;the RTF documents and VBSs have names like \u003cb\u003egreatloverstory.vbs, easytolove.vbs, iaminlovewithsomeoneshecuteandtrulyyoungunluckyshenotundersatnd_howmuchiloveherbutitsallgreatwithtrueloveriamgivingyou.doc,\u003c/b\u003e and others, associated with love, which is\u0026nbsp;why we\u0026nbsp;dubbed the campaign \u0026quot;SteganoAmor\u0026quot;.\u003c/p\u003e\n\n\u003ch2\u003eContents\u003c/h2\u003e\n\u003cdiv class=\"article-nav\"\u003e\n\u003cul\u003e\n        \u003cli\u003e\u003ca class=\"link link_article-nav anchorLink\" target=\"_blank\" href=\"#id0\"\u003eVictims\u003c/a\u003e\u003c/li\u003e\n        \u003cli\u003e\u003ca class=\"link link_article-nav anchorLink\" target=\"_blank\" href=\"#id1\"\u003eThe research begins\u003c/a\u003e\u003c/li\u003e\n        \u003cli\u003e\u003ca class=\"link link_article-nav anchorLink\" target=\"_blank\" href=\"#id2\"\u003eOther infection chains\u003c/a\u003e\u003c/li\u003e\n    \u003cul\u003e\n        \u003cli\u003e\u003ca class=\"link link_article-nav anchorLink\" target=\"_blank\" href=\"#id3\"\u003e1.1 AgentTesla attack: the main scenario involving an\u0026nbsp;Excel document and steganography\u003c/a\u003e\u003c/li\u003e\n        \u003cli\u003e\u003ca class=\"link link_article-nav anchorLink\" target=\"_blank\" href=\"#id4\"\u003e1.2 AgentTesla attack: an\u0026nbsp;alternate scenario involving a\u0026nbsp;Microsoft Word document\u003c/a\u003e\u003c/li\u003e\n        \u003cli\u003e\u003ca class=\"link link_article-nav anchorLink\" target=\"_blank\" href=\"#id5\"\u003e1.3 Remcos attack\u003c/a\u003e\u003c/li\u003e\n        \u003cli\u003e\u003ca class=\"link link_article-nav anchorLink\" target=\"_blank\" href=\"#id6\"\u003e1.4 XWorm attack\u003c/a\u003e\u003c/li\u003e\n        \u003cli\u003e\u003ca class=\"link link_article-nav anchorLink\" target=\"_blank\" href=\"#id7\"\u003e1.5 LokiBot attack\u003c/a\u003e\u003c/li\u003e\n        \u003cli\u003e\u003ca class=\"link link_article-nav anchorLink\" target=\"_blank\" href=\"#id8\"\u003e1.6 Guloader/Formbook attack\u003c/a\u003e\u003c/li\u003e\n        \u003cli\u003e\u003ca class=\"link link_article-nav anchorLink\" target=\"_blank\" href=\"#id9\"\u003e1.7 SnakeKeylogger attack\u003c/a\u003e\u003c/li\u003e\n        \u003cli\u003e\u003ca class=\"link link_article-nav anchorLink\" target=\"_blank\" href=\"#id10\"\u003e1.8 Other attack examples\u003c/a\u003e\u003c/li\u003e\n    \u003c/ul\u003e\n        \u003cli\u003e\u003ca class=\"link link_article-nav anchorLink\" target=\"_blank\" href=\"#id11\"\u003eThe group's use of\u0026nbsp;legitimate FTP and SMTP servers\u003c/a\u003e\u003c/li\u003e\n        \u003cli\u003e\u003ca class=\"link link_article-nav anchorLink\" target=\"_blank\" href=\"#id12\"\u003eAttribution to\u0026nbsp;known groups\u003c/a\u003e\u003c/li\u003e\n        \u003cli\u003e\u003ca class=\"link link_article-nav anchorLink\" target=\"_blank\" href=\"#id13\"\u003eConclusion\u003c/a\u003e\u003c/li\u003e\n        \u003cli\u003e\u003ca class=\"link link_article-nav anchorLink\" target=\"_blank\" href=\"#id14\"\u003eProduct detection rules\u003c/a\u003e\u003c/li\u003e\n    \u003cul\u003e\n\u003cli\u003e\u003ca class=\"link link_article-nav anchorLink\" target=\"_blank\" href=\"#id15-1\"\u003ePT Sandbox\u003c/a\u003e\u003c/li\u003e\n        \u003cli\u003e\u003ca class=\"link link_article-nav anchorLink\" target=\"_blank\" href=\"#id15\"\u003ePT NAD\u003c/a\u003e\u003c/li\u003e\n        \u003cli\u003e\u003ca class=\"link link_article-nav anchorLink\" target=\"_blank\" href=\"#id16\"\u003eMaxPatrol SIEM\u003c/a\u003e\u003c/li\u003e\n  \u003c/ul\u003e\n    \u003cli\u003e\u003ca class=\"link link_article-nav anchorLink\" target=\"_blank\" href=\"#id17\"\u003eIOCs\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\n\u003carticle\u003e\n\u003ch2 id=\"id0\"\u003eVictims\u003c/h2\u003e\n\n\u003cp\u003eIn\u0026nbsp;the course of\u0026nbsp;our research, we\u0026nbsp;discovered numerous samples that targeted various economic sectors and countries. Most of\u0026nbsp;the email messages we\u0026nbsp;came across had been sent to\u0026nbsp;Latin America, but a\u0026nbsp;considerable percentage were addressed to\u0026nbsp;companies in\u0026nbsp;Russia, Romania, Turkey, and some other countries.\u003c/p\u003e\n\n\u003cp\u003eSome of\u0026nbsp;the victims that we\u0026nbsp;saw had legitimate FTP and SMTP servers, which the threat actor infected and utilized as\u0026nbsp;C2\u0026nbsp;servers. They also used the infected SMTP servers to\u0026nbsp;send phishing email.\u003c/p\u003e\n\n\u003cp\u003eAs\u0026nbsp;our research effort continued, we\u0026nbsp;found servers with public directories in\u0026nbsp;which the group placed files to\u0026nbsp;be\u0026nbsp;used in\u0026nbsp;its attacks.\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"An\u0026nbsp;example of\u0026nbsp;a\u0026nbsp;public directory\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/1.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;1. An\u0026nbsp;example of\u0026nbsp;a\u0026nbsp;public directory\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eWe\u0026nbsp;also found malware logs containing stolen data on\u0026nbsp;the servers with public directories. Thus, data stolen with the help of\u0026nbsp;AgentTesla was stored in\u0026nbsp;the form of\u0026nbsp;HTML files whose names conformed to\u0026nbsp;the following template:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ePW_*PC_name*_*date of\u0026nbsp;exfiltration*_*time of\u0026nbsp;exfiltration*.html\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThe files contained aggregated credentials for every known browser, email (for example, Outlook and Thunderbird) account credentials, and remote access (VPN or\u0026nbsp;RDP) credentials.\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"A\u0026nbsp;log example\" src=\"/upload/corporate/ww-en/images/esc/article-402709/2-1.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;2. A\u0026nbsp;log example\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe logs included data from regular users, public institutions, and various businesses.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026nbsp;discovered a\u0026nbsp;total of\u0026nbsp;more than 320 attacks targeting the following countries and sectors:\u003c/p\u003e\n\n\u003cdiv class=\"chart-row\"\u003e\n\u003cdiv class=\"chart-row__item chart-row__item_full-width\"\u003e\n\u003cchart data-options='{\"chart\":{\"polar\":false,\"type\":\"column\",\"height\":400},\"title\":{\"text\":\"\"},\"subtitle\":{\"text\":\"\"},\"legend\":{\"floating\":false,\"enabled\":false,\"layout\":\"horizontal\",\"align\":\"center\",\"verticalAlign\":\"bottom\",\"itemStyle\":\"{ \\\"word-wrap\\\": \\\"break-word\\\"}\",\"reversed\":false},\"xAxis\":{\"reversedStacks\":false,\"gridLineWidth\":false,\"lineWidth\":false,\"title\":{\"text\":\"\"},\"type\":\"linear\",\"categories\":[\"Mexico\",\"Colombia\",\"Chili\",\"Argentina\",\"Romania\",\"Turkey\",\"Brazil\",\"Peru\",\"Russia\",\"Ecuador\",\"Uruguay\",\"Czech Republic\",\"India\",\"Poland\",\"Dominican Republic\",\"Spain\",\"Germany\",\"Pakistan\",\"United States\",\"Costa Rica\",\"Guatemala\",\"Indonesia\",\"Slovenia\",\"South Korea\",\"Bulgaria\",\"Thailand\",\"Sebia\",\"Lebanon\",\"Macedonia\",\"Algeria\",\"Morocco\"],\"reversed\":false,\"opposite\":false,\"crosshair\":true},\"yAxis\":{\"visible\":false,\"reversedStacks\":true,\"gridLineWidth\":true,\"lineWidth\":false,\"title\":{\"text\":\"\"},\"labels\":{\"format\":\"{value:,.0f}\"},\"type\":\"linear\",\"reversed\":false,\"opposite\":false,\"min\":null,\"max\":null},\"plotOptions\":{\"area\":{\"lineColor\":\"#ccc\",\"marker\":{\"lineColor\":\"#ccc\"}},\"pie\":{\"size\":\"100%\",\"innerSize\":\"85%\",\"dataLabels\":{\"format\":\"\u003cspan style=\\\"font-size:px\\\"\u003e{y:,.0f}\u003c/span\u003e\"},\"startAngle\":0,\"center\":[null,null],\"showInLegend\":false},\"column\":{\"colorByPoint\":false},\"bar\":{\"colorByPoint\":false},\"sunburst\":{\"borderColor\":\"white\",\"dataLabels\":{\"format\":\"{point.name}\",\"rotationMode\":\"circular\"},\"levels\":[{\"level\":1,\"levelIsConstant\":false,\"rotationMode\":\"circular\"}]},\"series\":{\"borderRadius\":0,\"dataLabels\":{\"enabled\":true,\"format\":\"\u003cspan style=\\\"font-size:px\\\"\u003e{y:,.0f}\u003c/span\u003e\"}}},\"series\":[{\"name\":\"Number of attacks\",\"color\":\"\",\"marker\":{\"enabled\":true,\"symbol\":\"circle\"},\"dashStyle\":\"Solid\",\"data\":[{\"name\":\"Mexico\",\"y\":45},{\"name\":\"Colombia\",\"y\":38},{\"name\":\"Chili\",\"y\":26},{\"name\":\"Argentina\",\"y\":25},{\"name\":\"Romania\",\"y\":24},{\"name\":\"Turkey\",\"y\":15},{\"name\":\"Brazil\",\"y\":13},{\"name\":\"Peru\",\"y\":13},{\"name\":\"Russia\",\"y\":12},{\"name\":\"Ecuador\",\"y\":12},{\"name\":\"Uruguay\",\"y\":11},{\"name\":\"Czech Republic\",\"y\":9},{\"name\":\"India\",\"y\":8},{\"name\":\"Poland\",\"y\":8},{\"name\":\"Dominican Republic\",\"y\":8},{\"name\":\"Spain\",\"y\":7},{\"name\":\"Germany\",\"y\":7},{\"name\":\"Pakistan\",\"y\":6},{\"name\":\"United States\",\"y\":6},{\"name\":\"Costa Rica\",\"y\":6},{\"name\":\"Guatemala\",\"y\":4},{\"name\":\"Indonesia\",\"y\":4},{\"name\":\"Slovenia\",\"y\":2},{\"name\":\"South Korea\",\"y\":2},{\"name\":\"Bulgaria\",\"y\":2},{\"name\":\"Thailand\",\"y\":2},{\"name\":\"Sebia\",\"y\":1},{\"name\":\"Lebanon\",\"y\":1},{\"name\":\"Macedonia\",\"y\":1},{\"name\":\"Algeria\",\"y\":1},{\"name\":\"Morocco\",\"y\":1}]}],\"colors\":[\"#ff0000\",\"#0060b9\",\"#313695\",\"#993d6b\",\"#00d359\",\"#ffcc00\",\"#f57c00\",\"#ff2d55\",\"#2094ff\",\"#b4aae0\"],\"credits\":{\"enabled\":true,\"position\":{\"verticalAlign\":\"bottom\",\"align\":\"right\",\"x\":-5,\"y\":-5}},\"tooltip\":{\"enabled\":true,\"shared\":true,\"valueSuffix\":\"\"},\"exporting\":{\"enabled\":true,\"buttons\":{\"contextButton\":{\"verticalAlign\":\"bottom\",\"align\":\"right\"}}}}'\u003e\u003c/chart\u003e\n\u003cdiv class=\"chart-row__caption\"\u003e\n\u003cspan\u003eFigure\u0026nbsp;3. Distribution of\u0026nbsp;attacks by\u0026nbsp;country\u003c/span\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eIn\u0026nbsp;the course of\u0026nbsp;our research, we\u0026nbsp;discovered attacks on\u0026nbsp;specific companies. The number of\u0026nbsp;attacks on\u0026nbsp;specific targets differs significantly from the total number of\u0026nbsp;discovered attacks, as\u0026nbsp;we\u0026nbsp;could not always find out who the victim was.\u003c/p\u003e\n\n\u003cdiv class=\"chart-row\"\u003e\n\u003cdiv class=\"chart-row__item chart-row__item_full-width\"\u003e\n\u003cchart data-options='{\"chart\":{\"polar\":false,\"type\":\"pie\",\"height\":400},\"title\":{\"text\":\"\"},\"subtitle\":{\"text\":\"\"},\"legend\":{\"floating\":false,\"enabled\":true,\"layout\":\"horizontal\",\"align\":\"center\",\"verticalAlign\":\"bottom\",\"itemStyle\":\"{ \\\"word-wrap\\\": \\\"break-word\\\"}\",\"reversed\":false},\"xAxis\":{\"reversedStacks\":false,\"gridLineWidth\":false,\"lineWidth\":false,\"title\":{\"text\":\"\"},\"type\":\"linear\",\"categories\":[\"Industrial sector\",\"Service sector\",\"Public sector\",\"Electric power industry\",\"Construction\",\"Transportation companies\",\"Sports\",\"Information technology\",\"Education\",\"Religious organizations\",\"Finance\",\"Pharmaceutical industry\"],\"reversed\":false,\"opposite\":false,\"crosshair\":true},\"yAxis\":{\"visible\":false,\"reversedStacks\":true,\"gridLineWidth\":1,\"lineWidth\":false,\"title\":{\"text\":\"\"},\"labels\":{\"format\":\"{value:,.0f}%\"},\"type\":\"linear\",\"reversed\":false,\"opposite\":false,\"min\":null,\"max\":null},\"plotOptions\":{\"area\":{\"lineColor\":\"#ccc\",\"marker\":{\"lineColor\":\"#ccc\"}},\"pie\":{\"size\":\"100%\",\"innerSize\":\"85%\",\"dataLabels\":{\"format\":\"\u003cspan style=\\\"font-size:px\\\"\u003e{y:,.0f}%\u003c/span\u003e\"},\"startAngle\":0,\"center\":[null,null],\"showInLegend\":true},\"column\":{\"colorByPoint\":false},\"bar\":{\"colorByPoint\":false},\"sunburst\":{\"borderColor\":\"white\",\"dataLabels\":{\"format\":\"{point.name}\",\"rotationMode\":\"circular\"},\"levels\":[{\"level\":1,\"levelIsConstant\":false,\"rotationMode\":\"circular\"}]},\"series\":{\"borderRadius\":0,\"dataLabels\":{\"enabled\":true,\"format\":\"\u003cspan style=\\\"font-size:px\\\"\u003e{y:,.0f}%\u003c/span\u003e\"}}},\"series\":[{\"name\":\"Number of attacks\",\"color\":\"\",\"marker\":{\"enabled\":true,\"symbol\":\"circle\"},\"dashStyle\":\"Solid\",\"data\":[{\"name\":\"Industrial sector\",\"y\":21.62},{\"name\":\"Service sector\",\"y\":16.22},{\"name\":\"Public sector\",\"y\":16.22},{\"name\":\"Electric power industry\",\"y\":8.11},{\"name\":\"Construction\",\"y\":8.11},{\"name\":\"Transportation companies\",\"y\":5.41},{\"name\":\"Sports\",\"y\":5.41},{\"name\":\"Information technology\",\"y\":5.41},{\"name\":\"Education\",\"y\":5.41},{\"name\":\"Religious organizations\",\"y\":2.7},{\"name\":\"Finance\",\"y\":2.7},{\"name\":\"Pharmaceutical industry\",\"y\":2.7}]}],\"colors\":[\"#ff0000\",\"#0060b9\",\"#313695\",\"#993d6b\",\"#00d359\",\"#ffcc00\",\"#f57c00\",\"#ff2d55\",\"#2094ff\",\"#b4aae0\"],\"credits\":{\"enabled\":true,\"position\":{\"verticalAlign\":\"bottom\",\"align\":\"right\",\"x\":-5,\"y\":-5}},\"tooltip\":{\"enabled\":true,\"shared\":true,\"valueSuffix\":\"%\"},\"exporting\":{\"enabled\":true,\"buttons\":{\"contextButton\":{\"verticalAlign\":\"bottom\",\"align\":\"right\"}}}}'\u003e\u003c/chart\u003e\n\u003cdiv class=\"chart-row__caption\"\u003e\n\u003cspan\u003eFigure\u0026nbsp;4. Distribution of\u0026nbsp;attacks by\u0026nbsp;sectors\u003c/span\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2 id=\"id1\"\u003eThe research begins\u003c/h2\u003e\n\n\u003cp\u003eWhile monitoring threats, members of\u0026nbsp;the ESC team discovered a\u0026nbsp;file named \u0026quot;factura 00005111, 005114, 005115.pdf.xlam\u0026quot; SHA-256: 69ffd7a475c64517c9c1c0282fd90c47597e3d4650320158cfb8c189d591db8c. Linked files led them to\u0026nbsp;an\u0026nbsp;email message. The file name \u0026quot;banned-20240117T134543-25672-12\u0026Prime; suggested that the message had reached the recipient but was blocked by\u0026nbsp;security systems. It\u0026nbsp;was ostensibly sent to\u0026nbsp;a\u0026nbsp;Romanian company from another Romanian company:\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The phishing email with a\u0026nbsp;malicious attachment\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/5.jpg\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;5. The phishing email with a\u0026nbsp;malicious attachment\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe sender's IP\u0026nbsp;address, 46.27.49.180, was replaced with another. Our data indicated that the group had sent 22\u0026nbsp;other messages from that\u0026nbsp;IP address to\u0026nbsp;various organizations starting on\u0026nbsp;June\u0026nbsp;15, 2023.\u003c/p\u003e\n\n\u003cp\u003eWhen the message is\u0026nbsp;opened, Excel downloads with the help of\u0026nbsp;macros a\u0026nbsp;file named \u0026quot;packedtpodododod.exe\u0026quot; (SHA-256:C42288A5946D2C3EB35E7485DD85936C1FABF49E46B12449C9136FF974A12F91) from the following URL:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e94.156.65[.]225/packedtpodododod.exe\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAn\u0026nbsp;RTF file could be\u0026nbsp;downloaded from the same\u0026nbsp;IP address via the following URL:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli style=\"word-break: break-all\"\u003e94.156.65[.]225/microsoftdecidedtodesignnewproducttoupdateandupgradenewprojectthingsonthepcandsystem.doc\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThis variant contains CVE-2017-11882 and downloads the following file in\u0026nbsp;the chain from the URL:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e94.156.65[.]225/herewegoxla.exe.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eOnce downloaded, the file runs. The final payload is\u0026nbsp;AgentTesla hiding behind an\u0026nbsp;Excel icon, which uploads data to\u0026nbsp;the C2\u0026nbsp;via FTP. The C2\u0026nbsp;itself is\u0026nbsp;a\u0026nbsp;legitimate website that has been compromised.\u003c/p\u003e\n\n\u003ch2 id=\"id2\"\u003eOther infection chains\u003c/h2\u003e\n\n\u003cp\u003eThanks to\u0026nbsp;internal systems, we\u0026nbsp;discovered dozens of\u0026nbsp;different files linked to\u0026nbsp;the FTP server, which was used as\u0026nbsp;a\u0026nbsp;C2\u0026nbsp;for AgentTesla. Most of\u0026nbsp;the files linked to\u0026nbsp;the FTP server were used in\u0026nbsp;malicious files that bore Spanish, Portuguese, and Romanian names.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026nbsp;also used our systems to\u0026nbsp;successfully discover hundreds of\u0026nbsp;different files and dozens of\u0026nbsp;malicious\u0026nbsp;IP addresses used by\u0026nbsp;the group in\u0026nbsp;the campaign at\u0026nbsp;hand. Some of\u0026nbsp;the files were documents with various name extensions and targeting different countries, but sharing one infrastructure and similarities between the attack chains. The files had different names in\u0026nbsp;English, Bulgarian, Croatian, Turkish, Russian, Chinese, and other languages.\u003c/p\u003e\n\n\u003cp\u003eBelow, you will find examples of\u0026nbsp;chains containing malware that belongs to\u0026nbsp;a\u0026nbsp;variety of\u0026nbsp;families: AgentTesla, Remcos, XWorm, LokiBot, Guloader, Formbook, SnakeKeylogger. We\u0026nbsp;would like to\u0026nbsp;emphasize that one type of\u0026nbsp;malware may be\u0026nbsp;involved in\u0026nbsp;several different chains. A\u0026nbsp;complete list of\u0026nbsp;indicators of\u0026nbsp;compromise is\u0026nbsp;available under IOCs below.\u003c/p\u003e\n\n\u003ch3 id=\"id3\"\u003e1.1 AgentTesla attack: the main scenario involving an\u0026nbsp;Excel document and steganography\u003c/h3\u003e\n\n\u003cp\u003eThe main scenario we\u0026nbsp;saw in\u0026nbsp;this campaign and which gave it\u0026nbsp;its name is\u0026nbsp;an\u0026nbsp;attack chain that involves steganography.\u003c/p\u003e\n\n\u003cp\u003eA\u0026nbsp;case in\u0026nbsp;point is\u0026nbsp;a\u0026nbsp;file named \u0026quot;Cerere de\u0026nbsp;cotatie.xla\u0026quot; (SHA-256: 64020a7a3f5f6c589272f28d727318eb5eb4eb4d41510679cb8134c0325c8fe2) \nIt\u0026nbsp;kicks off the chain. When opened, it\u0026nbsp;exploits CVE-2017-11882, sending a\u0026nbsp;request to\u0026nbsp;the URL:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli style=\"word-break: break-all\"\u003eqly[.]ai/08XE5, a shortened link that redirects to 23.95.60.74/weareinlovewithmygirlfriendunderstandhowitistoget___youareverybeautifilformeiloveusoomuchalwaysloveutrulyfromtheheartlove.doc\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"Request for the next stage (after opening the document)\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/6.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;6. Request for the next stage (after opening the document)\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe file received with the server response (SHA-256: 2c58ca41949aa784dce6a2006162781fe7a7a5453cafb731ee4d512efe718c43) is\u0026nbsp;an\u0026nbsp;RTF document.\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"Receiving an\u0026nbsp;RTF document\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/7.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;7. Receiving an\u0026nbsp;RTF document\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eWhen opened, it\u0026nbsp;runs and downloads a\u0026nbsp;VBS script from that same\u0026nbsp;IP address:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli style=\"word-break: break-all\"\u003e23[.]95[.]60[.]74/roammamamamam.vbs\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"Request for an\u0026nbsp;RTF document to\u0026nbsp;obtain VBS\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/8.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;8. Request for an\u0026nbsp;RTF document to\u0026nbsp;obtain VBS\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe VBS script sends a\u0026nbsp;request to\u0026nbsp;paste[.]ee to\u0026nbsp;fetch the next payload:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003epaste[.]ee/d/FZTcX\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"Malicious code in\u0026nbsp;the legitimate paste[.]ee service\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/9.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;9. Malicious code in\u0026nbsp;the legitimate paste[.]ee service\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eIt\u0026nbsp;then proceeds to\u0026nbsp;downloading and decoding an\u0026nbsp;encoded malicious string (steganography) embedded in\u0026nbsp;an\u0026nbsp;image from the following URLs:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli style=\"word-break: break-all\"\u003euploaddeimagens[.]com[.]br/images/004/753/714/original/new_image.jpg?1709908350\u003c/li\u003e\n\u003cli style=\"word-break: break-all\"\u003euploaddeimagens[.]com[.]br/images/004/753/713/original/new_image.jpg?1709908316\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThe images are the same:\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"An\u0026nbsp;image downloaded from the legitimate service\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/10.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;10. An\u0026nbsp;image downloaded from the legitimate service\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cul\u003e\n\u003cli style=\"word-break: break-all\"\u003enew_image.jpg (SHA-256: 1435aef381b7e31245e2ca66818209a7f8d54daef4d0db25ef78b3a9fec3242b)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eA\u0026nbsp;Base64-encoded next-stage payload hidden inside the downloaded image:\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The Base64-encoded payload\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/11.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;11. The Base64-encoded payload\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe PowerShell command inside the script:\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The PowerShell code inside the script\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/12.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;12. The PowerShell code inside the script\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe script then decrypts the payload from the image and downloads a\u0026nbsp;further payload from the same URL, written in\u0026nbsp;reverse string format. Its content is\u0026nbsp;notably a\u0026nbsp;Base64-encoded executable, also reversed:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli style=\"word-break: break-all\"\u003e23[.]95[.]60[.]74/romamammamamamaa.txt\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"Payload with reversed Base64 code\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/13.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;13. Payload with reversed Base64 code\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eNext, AgentTesla runs. The malware runs a\u0026nbsp;check as\u0026nbsp;a\u0026nbsp;bypass element to\u0026nbsp;make sure that it\u0026nbsp;is\u0026nbsp;not running on\u0026nbsp;a\u0026nbsp;hosting platform, and the victim's IP\u0026nbsp;address is\u0026nbsp;real.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eip-api[.]com/line/?fields=hosting\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAgentTesla steals data from browsers, email clients, remote access services, and connects via FTP to\u0026nbsp;a\u0026nbsp;C2\u0026nbsp;to\u0026nbsp;upload\u0026nbsp;it.\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"Communication with the C2\u0026nbsp;server\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/14.jpg\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;14. Communication with the C2\u0026nbsp;server\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"Exfiltration\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/15.jpg\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;15. Exfiltration\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003ch3 id=\"id4\"\u003e1.2 AgentTesla attack: an\u0026nbsp;alternate scenario involving a\u0026nbsp;Microsoft Word document\u003c/h3\u003e\n\n\u003cp\u003eThis is\u0026nbsp;a\u0026nbsp;late-2023 example that we\u0026nbsp;do\u0026nbsp;not see the malicious actor use as\u0026nbsp;much any more, but still find samples\u0026nbsp;of:\u003c/p\u003e\n\n\u003cp\u003e\u0026quot;Lista de\u0026nbsp;productos 2.docx\u0026quot; (SHA-256: 54376ee15cca7c6cdecc27b701b85bdd2aa618fe8158a453d65030425154299a)\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The malicious document with OLE\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/16.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;16. The malicious document with OLE\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eWhen run, it\u0026nbsp;sends a\u0026nbsp;request to\u0026nbsp;shlx.us/eO, which redirects to\u0026nbsp;the following URL:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli style=\"word-break: break-all\"\u003e23.95.122[.]104/htm/1/HTMLbrowserIEchromeHistoryCleaner.doc\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The next-stage request after opening the document\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/17.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;17. The next-stage request after opening the document\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe downloaded document (SHA-256: 6cab2705e5bfe56db1e9a74c8af9dca162de7631dd8dc074685dcb9c1dc7c5a2) is\u0026nbsp;a\u0026nbsp;malicious RTF document containing an\u0026nbsp;exploit:\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"Getting the RTF document\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/18.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;18. Getting the RTF document\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe RTF document then downloads \u0026quot;IGCC.exe\u0026quot;, which is\u0026nbsp;AgentTesla.\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The RTF document fetches the AgentTesla payload\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/19.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;19. The RTF document fetches the AgentTesla payload\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eAs\u0026nbsp;a\u0026nbsp;result, AgentTesla starts communication via FTP with the C2\u0026nbsp;and proceeds to\u0026nbsp;exfiltrate data:\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"Exfiltrating the victim's data\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/20.jpg\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;20. Exfiltrating the victim's data\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003ch3 id=\"id5\"\u003e1.3 Remcos attack\u003c/h3\u003e\n\n\u003cp\u003eRemcos, or\u0026nbsp;Remote Control and Surveillance, originally legitimate software, is\u0026nbsp;currently employed by\u0026nbsp;many threat actors as\u0026nbsp;a\u0026nbsp;RAT (Remote Access Trojan) to\u0026nbsp;access a\u0026nbsp;victim's computer.\u003c/p\u003e\n\n\u003cp\u003eIn\u0026nbsp;the course of\u0026nbsp;our research, we\u0026nbsp;found multiple Remcos samples used in\u0026nbsp;attacks by\u0026nbsp;the group.\u003c/p\u003e\n\n\u003cp\u003eOne of\u0026nbsp;these files is\u0026nbsp;named \u0026quot;ORDER_SPECIFICATIONS_OFFER.xla\u0026quot; (SHA-256: 93946883de3d4074ac4baed60abcc3f2d0c57c8ef6e41ceaedbc5ca0de55dc30):\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"A\u0026nbsp;malicious Excel document with OLE\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/21.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;21. A\u0026nbsp;malicious Excel document with OLE\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eWhen the file is\u0026nbsp;opened, the macro inside the Excel file reaches out to\u0026nbsp;the first C2\u0026nbsp;at the shortened URL qly[.]ai/p5Zpt for additional data:\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The request to\u0026nbsp;qly[.]ai/p5Zpt\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/22.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;22. The request to\u0026nbsp;qly[.]ai/p5Zpt\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe URL redirects the request to\u0026nbsp;an\u0026nbsp;RTF document containing an\u0026nbsp;exploit:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli style=\"word-break: break-all\"\u003e147.185.243[.]107/45700/macc/shelovemywifemorethankanyonebutsametimeiloveagirlwholovingmealot_____sheisreallymyloverwhocarewholovedmefromtheheart.doc с cve-2017-11882\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The request after the redirect\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/23.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;23. The request after the redirect\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThis is\u0026nbsp;followed by\u0026nbsp;a\u0026nbsp;request to\u0026nbsp;the next URL, which responds with an\u0026nbsp;obfuscated VBS script, rather than an\u0026nbsp;image:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli style=\"word-break: break-all\"\u003e147.185.243[.]107/45700/beautifulglobe.jpg,\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The VBS script\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/24.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;24. The VBS script\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThis script contains the embedded address of\u0026nbsp;the next C2\u0026nbsp;in\u0026nbsp;the chain, which hosts another obfuscated script:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003epaste[.]ee/d/NYO9X\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The VBS script in\u0026nbsp;the legitimate paste.ee service\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/25.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;25. The VBS script in\u0026nbsp;the legitimate paste.ee service\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eWe\u0026nbsp;found deobfuscation of\u0026nbsp;this script to\u0026nbsp;be\u0026nbsp;more interesting than the first one, as\u0026nbsp;it\u0026nbsp;contained more encoding iterations. The result was a\u0026nbsp;piece of\u0026nbsp;code inside, containing a\u0026nbsp;reversed string for the following\u0026nbsp;C2:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e147.185.243[.]107/45700/MACC.txt:\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The deobfuscation process\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/26.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;26. The deobfuscation process\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eOnce inside the TXT file, we\u0026nbsp;found the final link in\u0026nbsp;the chain: a\u0026nbsp;reversed Base64-encoded piece of\u0026nbsp;code:\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The MACC.txt code\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/27.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;27. The MACC.txt code\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe chain results in\u0026nbsp;infection with the Remcos RAT (SHA-256: bd296301230adac77b09dc91d06ec26adbc49d015ea7d1b4f68b6805c2b5ee55).\u003c/p\u003e\n\n\u003cp\u003eBefore talking to\u0026nbsp;the remote server, Remcos calls geoplugin[.]net/json.gp to\u0026nbsp;check the\u0026nbsp;IP address, and then contacts the C2\u0026nbsp;using TLS mimicry to\u0026nbsp;hide the traffic:\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The conversation between Remcos and the C2\u0026nbsp;server\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/28.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;28. The conversation between Remcos and the C2\u0026nbsp;server\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003ch3 id=\"id6\"\u003e1.4 XWorm attack\u003c/h3\u003e\n\n\u003cp\u003eXWorm is\u0026nbsp;among the most popular RATs, used by\u0026nbsp;many threat actors including TA\u0026nbsp;558.\u003c/p\u003e\n\n\u003cp\u003eSimilarly to\u0026nbsp;the previous case, one of\u0026nbsp;these chains begins with an\u0026nbsp;Excel file containing an\u0026nbsp;embedded link, which redirects requests to\u0026nbsp;another server to\u0026nbsp;download an\u0026nbsp;RTF document with an\u0026nbsp;exploit inside. In\u0026nbsp;this case, we\u0026nbsp;saw the files 7b768394fa0869d92f872eb486f49fabd6469ef3a8fd8bdf9cb49d35b39ea73b and 94bcfc033fd6e445163116ebf73877ef71e22192bef829822314042b31a7281f, which, when run, redirected to\u0026nbsp;a\u0026nbsp;URL to\u0026nbsp;fetch the next stage:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e107.175.31[.]187/7508/iconimages.jpg\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The RTF request for a\u0026nbsp;VBS script\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/29.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;29. The RTF request for a\u0026nbsp;VBS script\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe script contains an\u0026nbsp;embedded URL:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003epaste[.]ee/d/G5J31\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eIts content is\u0026nbsp;an\u0026nbsp;obfuscated VBS script containing two links to\u0026nbsp;images with additional payloads:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli style=\"word-break: break-all\"\u003euploaddeimagens[.]com [.]br/images/004/755/997/original/new_image_r.jpg?1710413993\u003c/li\u003e\n\u003cli style=\"word-break: break-all\"\u003euploaddeimagens[.]com [.]br/images/004/755/997/original/new_image_r.jpg?1710413993\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The request to\u0026nbsp;fetch the images\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/30.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;30. The request to\u0026nbsp;fetch the images\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eAs\u0026nbsp;with the main case described above, the strings from the images are decoded, and a\u0026nbsp;payload is\u0026nbsp;assembled, which then downloads a\u0026nbsp;TXT file with a\u0026nbsp;reversed Base64-encoded file, which is\u0026nbsp;the final payload: XWorm.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e107.175.31[.]187/7508/xwo.txt\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The payload with the reversed Base64-encoded file\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/31.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;31. The payload with the reversed Base64-encoded file\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eOnce running, XWorm starts talking to\u0026nbsp;the\u0026nbsp;C2:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e147.124.212[.]213:6161\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"XWorm talking to\u0026nbsp;the C2\u0026nbsp;server\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/32.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;32. XWorm talking to\u0026nbsp;the C2\u0026nbsp;server\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003ch3 id=\"id7\"\u003e1.5 LokiBot attack\u003c/h3\u003e\n\n\u003cp\u003eLokiBot is\u0026nbsp;a\u0026nbsp;stealer that collects data from various applications used by\u0026nbsp;the victim, such as\u0026nbsp;browsers, email and FTP clients, and so\u0026nbsp;on. One of\u0026nbsp;these files was received from:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli style=\"word-break: break-all\"\u003e23.94.239[.]119/_—00_o______---0o0_00_0oo_0-o_o0-__________o0o-__________/ozzwerdfdghjfdggsahfhfghf.doc\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"Downloading an\u0026nbsp;RTF file\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/33.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;33. Downloading an\u0026nbsp;RTF file\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eAs\u0026nbsp;in\u0026nbsp;the other instances, the file is\u0026nbsp;an\u0026nbsp;RTF document that downloads a\u0026nbsp;PE file (SHA-256: adc6a50e5985c31f0ed5ea885edd73e787f893f709591e5cf795fd78403d1430) from the following URL:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e23.94.239[.]119/112/vbc.exe\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"Downloading the\u0026nbsp;PE file\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/34.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;34. Downloading the\u0026nbsp;PE file\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe file is\u0026nbsp;LokiBot, which starts communicating with the\u0026nbsp;C2, sending information to\u0026nbsp;the following URL:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003esempersim[.]su/ha1/fre.php\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"Communication between LokiBot and the C2\u0026nbsp;server\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/35.jpg\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;35. Communication between LokiBot and the C2\u0026nbsp;server\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003ch3 id=\"id8\"\u003e1.6 Guloader/Formbook attack\u003c/h3\u003e\n\n\u003cp\u003eThis example begins with the file named \u0026quot;NEW ORDER.xls\u0026quot; (SHA-256: 3688f05556a136fe094de5cb1888eac2a579525f72cd027e19738582ed40c283).\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The contents of\u0026nbsp;\u0026quot;NEW ORDER.xls\u0026quot;\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/36.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;36. The contents of\u0026nbsp;\u0026quot;NEW ORDER.xls\u0026quot;\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe macro inside the Excel file starts the next chain, similar to\u0026nbsp;what we\u0026nbsp;saw earlier. First, it\u0026nbsp;sends a\u0026nbsp;request\u0026nbsp;to:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e2s[.]gg/3zs\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The request before the redirect\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/37.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;37. The request before the redirect\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eIt\u0026nbsp;then redirects to\u0026nbsp;an\u0026nbsp;RTF document with the previously mentioned CVE:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli style=\"word-break: break-all\"\u003e103.237.87[.]56/rew/re/binwecanmaintainthenewthingswithhimbecauseiwasrunningaroundthewroldwithnew____icangofornewthingsfortruestoryuloverbrother.doc\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"Downloading the malicious RTF file\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/38.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;38. Downloading the malicious RTF file\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eGuloader, to\u0026nbsp;be\u0026nbsp;used as\u0026nbsp;the loader for fetching the next piece of\u0026nbsp;malware, is\u0026nbsp;then downloaded from the following\u0026nbsp;IP address:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e103.237.87[.]56/setup/bin.exe\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"Downloading Guloader\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/39.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;39. Downloading Guloader\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe Guloader file (SHA-256: bfd50523e4cabf7fe9e6f0afc926b9269708ac80af43a943ebcbc909a9ae0695)accesses a Google Drive to get the malware payload, FormBook:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli style=\"word-break: break-all\"\u003edrive.google[.]com/uc?export=download\u0026id=1QJZpYWwA5nTHlXAY5PxXqGvqEBOtjtOi -\u003e drive.usercontent.google[.]com/download?id=1QJZpYWwA5nTHlXAY5PxXqGvqEBOtjtOi\u0026export=download\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eOnce running, FormBook (SHA-256: e1259d936c3993e5d8671b8b5e2362eb974984d046871296c50cf51ee1a96e4b) starts talking to the C2:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli style=\"word-break: break-all\"\u003ethechurchinkaty[.]com/nrup/?vLwt1tg=a+HLDFsiIkHuV4rn/wjkuvItWj7ch7WMO9xbFOtVeNEzn7JMPDdWHI+pluLOfQ5QTDqWxNNxIGS7LM9UJKf1d/iZERaTVE3Mnox0RAyMAaysT2DaDQ==\u0026tdCpR=qZUxOL60rvw\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The communication between FormBook and the C2\u0026nbsp;server\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/40.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;40. The communication between FormBook and the C2\u0026nbsp;server\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003ch3 id=\"id9\"\u003e1.7 SnakeKeylogger attack\u003c/h3\u003e\n\n\u003cp\u003eAs\u0026nbsp;in\u0026nbsp;most of\u0026nbsp;the cases we\u0026nbsp;have covered so\u0026nbsp;far, the chain begins with an\u0026nbsp;Excel file, such as\u0026nbsp;\u0026quot;Payment_Draft_confirmation.xla\u0026quot; (SHA-256: 9caeaefa5ecb508895fef48764dc689f49dd8ad9f7e4de9e52202f1c1db101e1).\u003c/p\u003e\n\n\u003cp\u003eWhen the file runs, it\u0026nbsp;sends a\u0026nbsp;request to\u0026nbsp;the following URL:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eqly[.]ai/TZWGK\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The request\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/41.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;41. The request\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThis is\u0026nbsp;followed by\u0026nbsp;a\u0026nbsp;redirect to\u0026nbsp;the following URL to\u0026nbsp;download an\u0026nbsp;RTF document:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli style=\"word-break: break-all\"\u003e207.32.219[.]82/7050/snk/snkisanewthingswhichhelovesornotireallynotknowwhathelookingbutshesloved___alotwiththisnewthingswhathetoldme.doc\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"Downloading the RTF document\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/42.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;42. Downloading the RTF document\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe RTF document downloads a\u0026nbsp;VBS script from the following URL:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli style=\"word-break: break-all\"\u003e207.32.219[.]82/7050/imaginepixelimages.jpg\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"Downloading the VBS script\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/43.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;43. Downloading the VBS script\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe next stage downloads reversed Base64-encoded strings, which prove to\u0026nbsp;be\u0026nbsp;SnakeKeylogger (SHA-256: 69dffbdcc112b62bfa93e2d6d95de42ef16e01e428b883b9671056ac93bbce8f) when decoded:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e207.32.219[.]82/7050/SNK.txt\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The payload with the reversed Base64-encoded file\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/44.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;44. The payload with the reversed Base64-encoded file\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe first thing SnakeKeylogger does upon starting is\u0026nbsp;running a\u0026nbsp;check:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003echeckip.dyndns[.]org\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The checkip.dyndns.org check\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/45.jpg\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;45. The checkip.dyndns.org check\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eIt\u0026nbsp;then checks the geographic location according to\u0026nbsp;the\u0026nbsp;IP address:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ereallyfreegeoip[.]org\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The geographic location check\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/46.jpg\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;46. The geographic location check\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThis is\u0026nbsp;followed by\u0026nbsp;a\u0026nbsp;request to\u0026nbsp;get an\u0026nbsp;SMTP server:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003escratchdreams[.]tk/_send_.php?TS\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The request to\u0026nbsp;get an\u0026nbsp;SMTP server\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/47.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;47. The request to\u0026nbsp;get an\u0026nbsp;SMTP server\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eFinally, SnakeKeylogger forwards the information it\u0026nbsp;stole to\u0026nbsp;the compromised legitimate SMTP server:\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"Sending data to\u0026nbsp;the compromised legitimate SMTP server\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/48.jpg\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;48. Sending data to\u0026nbsp;the compromised legitimate SMTP server\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003ch3 id=\"id10\"\u003e1.8 Other attack examples\u003c/h3\u003e\n\n\u003cp\u003eWe\u0026nbsp;saw other attack chains. For example, here's an\u0026nbsp;example of\u0026nbsp;network communication between NjRAT and\u0026nbsp;C2\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"An\u0026nbsp;example of\u0026nbsp;network communication between NjRAT and\u0026nbsp;C2\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/49.jpg\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;49. An\u0026nbsp;example of\u0026nbsp;network communication between NjRAT and\u0026nbsp;C2\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eBut these differed only insignificantly from the ones described above, essentially being the same attacks with different final payloads.\u003c/p\u003e\n\n\u003cp\u003eThus, as\u0026nbsp;we\u0026nbsp;were examining the threat actor's infrastructure, we\u0026nbsp;noticed that the\u0026nbsp;IP addresses used to\u0026nbsp;host RTF files with exploits embedded in\u0026nbsp;them and fake JPG files with embedded VBS scripts were also used as\u0026nbsp;the locations for various RATs. As\u0026nbsp;an\u0026nbsp;example, here is\u0026nbsp;the\u0026nbsp;IP address of\u0026nbsp;the zgRAT C2\u0026nbsp;server:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e94.156.69[.]17\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"An\u0026nbsp;example of\u0026nbsp;this\u0026nbsp;IP address being involved in\u0026nbsp;the infection chain\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/50.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;50. An\u0026nbsp;example of\u0026nbsp;this\u0026nbsp;IP address being involved in\u0026nbsp;the infection chain\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"An\u0026nbsp;example of\u0026nbsp;this\u0026nbsp;IP address being used for the zgRAT C2\u0026nbsp;server\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/51.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;51. An\u0026nbsp;example of\u0026nbsp;this\u0026nbsp;IP address being used for the zgRAT C2\u0026nbsp;server\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003ch2 id=\"id11\"\u003eThe group's use of\u0026nbsp;legitimate FTP and SMTP servers\u003c/h2\u003e\n\n\u003cp\u003eUpon closer inspection, the FTP servers we\u0026nbsp;found turned out to\u0026nbsp;be\u0026nbsp;legitimate services, which the threat actor presumably had infected to\u0026nbsp;use as\u0026nbsp;C2s for exfiltration of\u0026nbsp;victims' data extracted with the help of\u0026nbsp;the malware described above.\u003c/p\u003e\n\n\u003cp\u003eIn\u0026nbsp;each case, the legitimate sites belonged to\u0026nbsp;various small companies based in\u0026nbsp;Mexico, Colombia, and Romania.\u003c/p\u003e\n\n\u003cp\u003eHere is\u0026nbsp;one such site:\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"A\u0026nbsp;legitimate site\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/52.jpg\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;52. A\u0026nbsp;legitimate site\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe organization has an\u0026nbsp;active social media account with several thousand subscribers and a\u0026nbsp;link to\u0026nbsp;a\u0026nbsp;website:\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The social media account\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/53.jpg\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;53. The social media account\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"A\u0026nbsp;legitimate site\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/54.jpg\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;54. A\u0026nbsp;legitimate site\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eAs\u0026nbsp;in\u0026nbsp;the previous case, this organization has an\u0026nbsp;active social media account with several thousand subscribers and a\u0026nbsp;link to\u0026nbsp;a\u0026nbsp;website:\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The company's Facebook account\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/55.jpg\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;55. The company's Facebook account\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eWhen researching the group's attacks on\u0026nbsp;Russian companies, we\u0026nbsp;noticed that, besides FTP servers, it\u0026nbsp;used SMTP on\u0026nbsp;compromised servers that hosted legitimate European websites:\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"A\u0026nbsp;legitimate site\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/56.jpg\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;56. A\u0026nbsp;legitimate site\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe group created some of\u0026nbsp;its SMTP domains to\u0026nbsp;make its activities appear legitimate. Thus, one of\u0026nbsp;the SMTP domains it\u0026nbsp;used, itresinc.com, is\u0026nbsp;apparently trying hard to\u0026nbsp;look like the legitimate it-resinc.com.\u003c/p\u003e\n\n\u003cp\u003eThe threat actor used these legitimate and newly created SMTP servers in\u0026nbsp;two ways:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eTo\u0026nbsp;send phishing email\u003c/li\u003e\n\u003cli\u003eAs\u0026nbsp;a\u0026nbsp;C2\u0026nbsp;server for spreading malware\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eInterestingly, the group never used the same SMTP server as\u0026nbsp;both a\u0026nbsp;phishing server and a\u0026nbsp;C2\u0026nbsp;in\u0026nbsp;one attack.\u003c/p\u003e\n\n\u003cp\u003eAs\u0026nbsp;an\u0026nbsp;example of\u0026nbsp;an\u0026nbsp;attack, here is\u0026nbsp;an\u0026nbsp;email message sent to\u0026nbsp;an\u0026nbsp;organization in\u0026nbsp;Russia from a\u0026nbsp;compromised legitimate SMTP server:\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The email from the compromised SMTP server\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/57.jpg\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;57. The email from the compromised SMTP server\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eThe phishing email came with a\u0026nbsp;ZIP archive attached:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli style=\"word-break: break-all\"\u003e\u0026quot;loading advice.zip\u0026quot; SHA-256: ca383ef7a0031ff933907be8b038ccc62ac556bdc0f077d7f9c3022952e62efa\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThe archive contained one file that was AgentTesla:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli style=\"word-break: break-all\"\u003e\u0026quot;loading advice.exe\u0026quot; SHA-256: 84b2a0360556088e4aad29627d4ed15d53b18aa72d9d98b4b0d1be27916c681e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"The contents of\u0026nbsp;the archive\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/58.png\"\u003e\n\u003cfigcaption\u003eFigure\u0026nbsp;58. The contents of\u0026nbsp;the archive\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cp\u003eWhen the executable runs, it\u0026nbsp;uploads data to\u0026nbsp;an\u0026nbsp;SMTP server that imitates a\u0026nbsp;legitimate one:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003email.itresinc.com\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"id12\"\u003eAttribution to known groups\u003c/h2\u003e\n\n\u003cp\u003eIn\u0026nbsp;the course of\u0026nbsp;our research, we\u0026nbsp;found that a\u0026nbsp;part of\u0026nbsp;the campaign \u003ca href=\"https://cyble.com/blog/threat-actor-employs-powershell-backed-steganography-in-recent-spam-campaigns/\" target=\"_blank\"\u003ehad been described by\u0026nbsp;analysts at\u0026nbsp;Cyble\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eCyble describes the same kill chain that we\u0026nbsp;saw, including the use of\u0026nbsp;steganography, as\u0026nbsp;well as\u0026nbsp;the payload, which may contain various types of\u0026nbsp;malware like AgentTesla, Remcos, and so\u0026nbsp;on.\u003c/p\u003e\n\n\u003cp\u003eResearchers at\u0026nbsp;MetabaseQ last October \u003ca href=\"https://www.metabaseq.com/ta588/\" target=\"_blank\"\u003edescribed\u003c/a\u003e the same threat actor's activity, attributing it\u0026nbsp;to\u0026nbsp;TA558.\u003c/p\u003e\n\n\u003cp\u003eTheir report takes note of\u0026nbsp;the kill chain, which also employed steganography. Although the researchers said that the victims, as\u0026nbsp;with TA558\u0026nbsp;earlier, were located in\u0026nbsp;Latin America, the United States, Portugal, and Spain, we\u0026nbsp;have found that while TA558 mainly focuses on\u0026nbsp;Latin America, the number of\u0026nbsp;affected countries is\u0026nbsp;much greater, and TA558 attacks completely different countries.\u003c/p\u003e\n\n\u003cp\u003eLast August, researcher Ankit Anubhav \u003ca href=\"https://twitter.com/ankit_anubhav/status/1689585087267188736\" target=\"_blank\"\u003eshared\u003c/a\u003e on\u0026nbsp;X (formerly Twitter) information about TA558's use of\u0026nbsp;steganography with a\u0026nbsp;final chain that resulted in\u0026nbsp;infection with Quasar Rat.\u003c/p\u003e\n\n\u003cp\u003eAnother Microsoft researcher, Igal Lytzki, referred to\u0026nbsp;Ankit Anubhav in\u0026nbsp;his \u003ca href=\"https://twitter.com/0xToxin/status/1708722097885679688\" target=\"_blank\"\u003edescription of\u0026nbsp;a\u0026nbsp;similar attack\u003c/a\u003e, where he\u0026nbsp;drew attention to\u0026nbsp;steganography samples and AgentTesla on\u0026nbsp;an\u0026nbsp;FTP server containing logs of\u0026nbsp;victims' data. Igal said he\u0026nbsp;had informed the victims accordingly:\u003c/p\u003e\n\n\u003cfigure\u003e\u003cimg alt=\"Tweet by\u0026nbsp;researcher Igal Lytzki\" src=\"/upload/corporate/ru-ru/images/pt-esc/article-402404/59.png\"\u003e\n\u003cfigcaption\u003eFig.\u0026nbsp;59. Tweet by\u0026nbsp;researcher Igal Lytzki\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003ch2 id=\"id13\"\u003eConclusion\u003c/h2\u003e\n\n\u003cp\u003eThe TA558 attack chains in\u0026nbsp;the SteganoAmor campaign examined here continue to\u0026nbsp;affect users in\u0026nbsp;Latin America and elsewhere in\u0026nbsp;the world. The group continues to\u0026nbsp;exploit the fairly old CVE-2017-11882 in\u0026nbsp;its attack chain. It\u0026nbsp;uses steganography, an\u0026nbsp;obfuscation technique, inside the chains to\u0026nbsp;spread well-known malware used in\u0026nbsp;other attacks in\u0026nbsp;recent years. The phishing may be\u0026nbsp;harder to\u0026nbsp;detect due to\u0026nbsp;the group's use of\u0026nbsp;compromised legitimate SMTP servers, so\u0026nbsp;we\u0026nbsp;recommend exercising caution when dealing with email that contains attachments, even if\u0026nbsp;the messages were received from governmental organizations or\u0026nbsp;small local companies. The use of\u0026nbsp;legitimate SMTP and FTP servers, as\u0026nbsp;well as\u0026nbsp;tools like Guloader, may complicate detection of\u0026nbsp;the threat actor's presence on\u0026nbsp;the host, so\u0026nbsp;companies are advised to\u0026nbsp;monitor network traffic more closely and investigate suspicious activity linked to\u0026nbsp;legitimate services.\u003c/p\u003e\n\u003c/article\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e","title":"SteganoAmor campaign: TA558 mass-attacking companies and public institutions all around the world","date":"2024-04-14T21:00:00.000Z","slug":"steganoamor-campaign-ta558-mass-attacking-companies-and-public-institutions-all-around-the-world","file":"","titleOfHelpfulFiles":"","helpfulFiles":[{"title":"Product detection rules","files":[{"file":{"ext":".csv","name":"PT Sandbox.csv","size":"4.95","url":"https://pt-global.storage.yandexcloud.net/PT_Sandbox_5638aa2b1e.csv"},"link":"","title":"PT Sandbox","linkDescription":""},{"file":{"ext":".csv","name":"PT NAD.csv","size":"0.87","url":"https://pt-global.storage.yandexcloud.net/PT_NAD_f234198cc9.csv"},"link":"","title":"PT NAD","linkDescription":""},{"file":{"ext":".csv","name":"MaxPatrol SIEM.csv","size":"0.11","url":"https://pt-global.storage.yandexcloud.net/Max_Patrol_SIEM_f5f2fc147f.csv"},"link":"","title":"MaxPatrol SIEM","linkDescription":""}]},{"title":"IOCs","files":[{"file":{"ext":".csv","name":"IOCs.csv","size":"38.49","url":"https://pt-global.storage.yandexcloud.net/IO_Cs_f13bba381e.csv"},"link":"","title":"IOCs","linkDescription":""},{"file":{"ext":".csv","name":"Legitimate services used in attacks.csv","size":"0.29","url":"https://pt-global.storage.yandexcloud.net/Legitimate_services_used_in_attacks_5255fb700c.csv"},"link":"","title":"Legitimate services used in attacks","linkDescription":""},{"file":{"ext":".csv","name":"File indicators.csv","size":"71.28","url":"https://pt-global.storage.yandexcloud.net/File_indicators_7ec16dbc83.csv"},"link":"","title":"File indicators","linkDescription":""}]}]},"footerData":{"title":"Cybersecurity market leader","copyright":"Copyright \u003cmark\u003e©\u003c/mark\u003e 2002–2024 Positive Technologies. All rights reserved.","products":{"title":"Products","navItems":[{"name":"PT NAD","link":"/products/network-attack-discovery"},{"name":"PT Sandbox","link":"/products/sandbox"},{"name":"MaxPatrol VM","link":"/products/maxpatrol-vm"},{"name":"MaxPatrol SIEM","link":"/products/siem"},{"name":"PT AI","link":"/products/ai"},{"name":"PT BlackBox","link":"/products/blackbox"},{"name":"PT ISIM","link":"/products/isim"},{"name":"MaxPatrol O2","link":"/products/mp-o2"},{"name":"MaxPatrol EDR","link":"/products/edr"},{"name":"PT Application Firewall","link":"/products/pt-af"},{"name":"PT Container Security","link":"/products/cs"},{"name":"PT Industrial Cybersecurity Suite","link":"/products/ics"}]},"company":{"title":"ANALYTICS","navItems":[{"name":"Analytics articles","link":"/analytics"},{"name":"Knowledge base","link":"/analytics/knowledge-base"},{"name":"PT ESC threat intelligence","link":"/analytics/pt-esc-threat-intelligence"},{"name":"Threatscape","link":"/analytics/threatscape"},{"name":"Hacker groups","link":"/analytics/hacker-groups"}]},"social":{"title":"COMPANY","navItems":[{"name":"About us","link":"/about"},{"name":"Clients","link":"/about/clients"},{"name":"Contacts","link":"/about/contacts"},{"name":"PT in the Media","link":"/about/pt-in-the-media"},{"name":"Education","link":"https://edu.ptsecurity.com/learning-space"},{"name":"YouTube","link":"https://www.youtube.com/channel/UC9hnMfdwfLd8V5qEc-6MXXQ"},{"name":"Vacancy","link":"https://vacancy.global.ptsecurity.com/"}]},"logoImage":{"src":"https://pt-global.storage.yandexcloud.net/logo_1d137588e3.svg","width":1200,"height":100,"alt":""},"legalDocsLink":{"id":61,"text":"Legal documents","link":"https://global.ptsecurity.com/policies/terms-of-use","targetBlank":true}},"anyQuestionsData":{"selectProductOptions":[{"value":"network-attack-discovery","label":"PT NAD","crmId":"3212ea27-d047-42f9-9da3-9ef5233634bb"},{"value":"sandbox","label":"PT Sandbox","crmId":"5addae27-2762-4a89-8b58-e247ab1e71dc"},{"value":"maxpatrol-vm","label":"MaxPatrol VM","crmId":"e5ffe330-69bf-4344-b0b0-c228de0f6f83"},{"value":"siem","label":"MaxPatrol SIEM","crmId":"0c54a201-09a7-4dc9-b3ca-1ce61715388b"},{"value":"ai","label":"PT AI","crmId":"4c2c50e6-2b8c-4c1e-a2da-f6423ece496b"},{"value":"blackbox","label":"PT BlackBox","crmId":"081eb4e2-54c2-4ce5-b171-d7dcaecc1c1f"},{"value":"isim","label":"PT ISIM","crmId":"67a72950-2d9c-47a1-8bb8-49540356da8f"},{"value":"mp-o2","label":"MaxPatrol O2","crmId":"29563721-4ec7-4e5b-8a48-f3674ab70749"},{"value":"edr","label":"MaxPatrol EDR","crmId":"c667eb61-0b7a-457c-991c-43b83504a7ed"},{"value":"pt-af","label":"PT Application Firewall","crmId":"b6b16deb-0ceb-4318-b947-fd238d7a9935"},{"value":"cs","label":"PT Container Security","crmId":"2df38b89-5d1f-4a0d-8be4-76ea9f8d2e30"},{"value":"ics","label":"PT Industrial Cybersecurity Suite","crmId":""}],"title":"Get in touch","description":"Fill in the form and our specialists\u003cbr/\u003e will contact you shortly","feedback":{"title":"General\u003cbr/\u003e questions","description":"We're happy to answer any questions you may have.","fieldName":"Name","fieldPhone":"Phone number","fieldEmail":"Email","fieldComment":"How can we help?","fieldCountry":"Country","checkboxConsentsTerms":"I give \u003ca href=\"https://global.ptsecurity.com/policies/consent\" target=\"_blank\"\u003emy consent to the processing of my personal data\u003c/a\u003e in accordance with the terms of the \u003ca href=\"https://global.ptsecurity.com/policies/privacy-policy\" target=\"_blank\"\u003ePrivacy Notice\u003c/a\u003e","checkboxSubscription":"I give \u003ca href=\"https://global.ptsecurity.com/policies/consent-email\" target=\"_blank\"\u003emy consent to receive marketing and informational messages\u003c/a\u003e","buttonSubmit":"SEND","successTitle":"Thank you, your application has been sent","successDescription":"Our specialists will contact you soon."},"partnership":{"title":"Partnership","description":"Join us in making the world a safer place.","fieldName":"Name","fieldCompanyName":"Company name","fieldPhone":"Phone number","fieldEmail":"Email","fieldComment":"How can we help?","fieldAddress":"Address","fieldCountry":"Country","checkboxConsentsTerms":"I give \u003ca href=\"https://global.ptsecurity.com/policies/consent\" target=\"_blank\"\u003emy consent to the processing of my personal data\u003c/a\u003e in accordance with the terms of the \u003ca href=\"https://global.ptsecurity.com/policies/privacy-policy\" target=\"_blank\"\u003ePrivacy Notice\u003c/a\u003e","checkboxSubscription":"I give \u003ca href=\"https://global.ptsecurity.com/policies/consent-email\" target=\"_blank\"\u003emy consent to receive marketing and informational messages\u003c/a\u003e","buttonSubmit":"SEND","successTitle":"Thank you, your application has been sent","successDescription":"Our specialists will contact you shortly."},"pilotApplication":{"title":"Pilot\u003cbr/\u003e application","description":"Test drive our solutions with a customized pilot program.","fieldProduct":"Select a product","fieldName":"Name","fieldCompanyName":"Company name","fieldPhone":"Phone number","fieldEmail":"Email","fieldComment":"How can we help?","fieldCountry":"Country","checkboxConsentsTerms":"I give \u003ca href=\"https://global.ptsecurity.com/policies/consent\" target=\"_blank\"\u003emy consent to the processing of my personal data\u003c/a\u003e in accordance with the terms of the \u003ca href=\"https://global.ptsecurity.com/policies/privacy-policy\" target=\"_blank\"\u003ePrivacy Notice\u003c/a\u003e","checkboxSubscription":"I give \u003ca href=\"https://global.ptsecurity.com/policies/consent-email\" target=\"_blank\"\u003emy consent to receive marketing and informational messages\u003c/a\u003e","buttonSubmit":"SEND","successTitle":"Thank you, your application has been sent","successDescription":"Our specialists will contact you shortly."}},"sidebarData":{"widgets":[{"kind":"analytics-articles","data":{"title":"Analytics articles","link":"/analytics","withFlag":true,"items":[{"text":"India: cyberthreat landscape Q3 2023-Q3 2024","link":"/analytics/india-cyberthreat-landscape-q3-2023-q3-2024","targetBlank":true,"publishedDate":"2024-10-22T00:00:00.000Z"},{"text":"Trending vulnerability digest September 2024","link":"/analytics/trending-vulnerability-digest-september-2024","targetBlank":true,"publishedDate":"2024-10-21T00:00:00.000Z"},{"text":"Positive Research 2024","link":"/analytics/positive-research-2024","targetBlank":true,"publishedDate":"2024-10-17T00:00:00.000Z"}]}},{"kind":"ad-banner","data":{"title":"What are the security threats on your network?","subtitle":"Check your traffic-for free","backgroundColor":null,"image":{"src":"https://pt-global.storage.yandexcloud.net/PT_Network_Attack_Discovery_2x_0d8a5793c7.png","width":542,"height":822,"alt":""},"actionProps":{"label":"Request pilot","href":"#contacts","isExternal":false}}}]}},"__N_SSP":true},"page":"/analytics/pt-esc-threat-intelligence/[slug]","query":{"slug":"steganoamor-campaign-ta558-mass-attacking-companies-and-public-institutions-all-around-the-world"},"buildId":"fGk60SBlODknG4pBg3RpC","isFallback":false,"gssp":true,"locale":"en","locales":["en","es","pt"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>