<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9f33356fc04f46a2ac4a68753ba41658"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc2118b00ed614bbf83f96f25de0beaf8"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffe85f84d0b0c4f9f8743167664735836"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F124e49f43fd041659989deffd90e3b7c"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa59264f69adf4a4cb0092faaf95a5669"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a9064f27e10467cae2ee3bd79beead9"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff043c73bb2de45c6b1102fe11ffebedb"/><link rel="preload" as="image" href="https://cdn.builder.io/api/v1/pixel?apiKey=3eb6f92aedf74f109c7b4b0897ec39a8"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=GTM-TXRTDGW4"></script><script type="text/javascript" async="" defer="" src="/assets/scripts/drift.js"></script><script type="text/javascript" async="" defer="" src="//js.hs-scripts.com/3911692.js"></script><script src="https://fast.wistia.com/embed/medias/lqy5p1741e.jsonp" async=""></script><script src="https://fast.wistia.com/assets/external/E-v1.js" async=""></script><script type="text/javascript" src="https://flackr.github.io/scroll-timeline/dist/scroll-timeline.js" async=""></script><meta property="og:type" content="website"/><meta content="summary_large_image" name="twitter:card"/><title>Ave Maria and the Chambers of Warzone RAT | Huntress</title><meta name="description" content="Helping analysts develop a better understanding of the elastic search syntax."/><meta property="og:title" content="Ave Maria and the Chambers of Warzone RAT | Huntress"/><meta property="og:description" content="Helping analysts develop a better understanding of the elastic search syntax."/><meta property="twitter:title" content="Ave Maria and the Chambers of Warzone RAT | Huntress"/><meta property="twitter:description" content="Helping analysts develop a better understanding of the elastic search syntax."/><link rel="canonical" href="https://www.huntress.com/blog/ave-maria-and-the-chambers-of-warzone-rat"/><link rel="icon" href="/assets/favicon-96x96-CtLNOBqH.png" type="image/png" sizes="96x96"/><link rel="icon" href="/assets/favicon-29P8YngA.svg" type="image/svg+xml"/><link rel="shortcut icon" href="/assets/favicon-C5x0nhzu.ico"/><link rel="apple-touch-icon" href="/assets/apple-touch-icon-DudXUahm.png" sizes="180x180"/><link rel="manifest" href="data:application/manifest+json;base64,ewogICJuYW1lIjogIkh1bnRyZXNzIiwKICAic2hvcnRfbmFtZSI6ICJIdW50cmVzcyIsCiAgImljb25zIjogWwogICAgewogICAgICAic3JjIjogIi93ZWItYXBwLW1hbmlmZXN0LTE5MngxOTIucG5nIiwKICAgICAgInNpemVzIjogIjE5MngxOTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9wbmciLAogICAgICAicHVycG9zZSI6ICJtYXNrYWJsZSIKICAgIH0sCiAgICB7CiAgICAgICJzcmMiOiAiL3dlYi1hcHAtbWFuaWZlc3QtNTEyeDUxMi5wbmciLAogICAgICAic2l6ZXMiOiAiNTEyeDUxMiIsCiAgICAgICJ0eXBlIjogImltYWdlL3BuZyIsCiAgICAgICJwdXJwb3NlIjogIm1hc2thYmxlIgogICAgfQogIF0sCiAgInRoZW1lX2NvbG9yIjogIiNmZmZmZmYiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiNmZmZmZmYiLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiCn0="/><meta name="google-site-verification" content="QZk47k59WXGOBjZRZodH6wC5rKaX9MnmeBFsV5jchE4"/><link rel="modulepreload" href="/assets/entry.client-m4_Zd7NT.js"/><link rel="modulepreload" href="/assets/chunk-HA7DTUK3-BpyMo6tN.js"/><link rel="modulepreload" href="/assets/index-DqyGAN61.js"/><link rel="modulepreload" href="/assets/root-BJQOHjsi.js"/><link rel="modulepreload" href="/assets/with-props-Dkp9k_PK.js"/><link rel="modulepreload" href="/assets/snowplow.tracker-Dy_wB_IJ.js"/><link rel="modulepreload" href="/assets/blog._slug-DmNEJyyc.js"/><link rel="modulepreload" href="/assets/metadata-DUociWgO.js"/><link rel="stylesheet" href="/assets/root-DOhbAGIK.css"/><link rel="stylesheet" href="/assets/snowplow-BwfoH6KX.css"/><link rel="stylesheet" href="/assets/blog-post-CbkYeKVf.css"/><link rel="stylesheet" href="/assets/webflow.styles-qJ3oDT1C.css"/><link rel="stylesheet" href="/assets/webflow.head.styles-rFHjEbAs.css"/><link rel="stylesheet" href="/assets/webflow.supplimental.styles-CAjEq2ro.css"/><link rel="stylesheet" href="/assets/app-DF3E5Rn7.css"/><link rel="stylesheet" href="/assets/metadata-q413g75i.css"/><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=cT3rVWvp_kLHQtcar4fL6A&gtm_preview=env-390&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
                })(window,document,'script','dataLayer','GTM-TXRTDGW4');</script><script src="https://cdn.optimizely.com/js/5179843176824832.js"></script></head><body class="body"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TXRTDGW4&amp;gtm_auth=cT3rVWvp_kLHQtcar4fL6A&amp;gtm_preview=env-390&amp;gtm_cookies_win=x" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2" type="image/webp"/><style data-emotion-css="2qdlcf">.css-2qdlcf{opacity:1;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;object-fit:cover;object-position:center;}</style><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image banner-ellipse desktop css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F6a889f843f1c43a695dc53a813b091e2"/></picture><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff" type="image/webp"/><style data-emotion-css="2qdlcf">.css-2qdlcf{opacity:1;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;object-fit:cover;object-position:center;}</style><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image banner-ellipse mobile css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F494235849aa5452690cabfa164b509ff"/></picture></div><header class="header header-navigation-override" style="will-change:background"><div data-animation="default" class="navbar-logo-left-container shadow-three w-nav" data-easing2="ease" data-easing="ease" data-collapse="medium" role="banner" data-no-scroll="1" data-duration="400" data-doc-height="1"><div class="search-bar navigation-wrapper-top" style="opacity:1;height:40px"><a href="https://huntress.io/" target="_blank" class="top-bar-links">Partner Login</a><div class="search-container nav "><span class="span search ">Search</span><form class="nav-search w-form " data-hs-cf-bound="true" action="/search"><input class="nav-search-input w-input " autoComplete="false" maxLength="256" placeholder="Search..." type="search" id="search" name="query"/><input type="submit" class="nav-search-button w-button" value=""/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1758ef4667574398807a9dd0b08d4990" loading="lazy" alt="close icon" class="nav-search-close "/></form><div class="nav-search-overlay"></div></div></div><div class="navigation-wrapper"><a href="/" class="navigation-brand link w-nav-brand" aria-label="home"><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02" type="image/webp"/><style data-emotion-css="2qdlcf">.css-2qdlcf{opacity:1;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;object-fit:cover;object-position:center;}</style><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image navigation-brand css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F06a4b9203b3a41a382bad4efd601ae02"/></picture></a><nav role="navigation" class="navigation-menu-wrapper w-nav-menu hidden lg:block"><ul role="list" class="nav-menu-main mobile w-list-unstyled"><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu desktop-only w-dropdown"><div class="menu-link-container w-dropdown-toggle " aria-controls="w-dropdown-list-0" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Platform</div></div><nav class="sub-menu-dropdown one w-dropdown-list " aria-labelledby="w-dropdown-toggle-0"><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block">Huntress Managed Security Platform</div><div class="sub-menu-item-main"><a href="/platform/managed-edr" aria-current="page" class="sub-menu-item-2 w-inline-block w--current" tabindex="0"><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916" class="submenu-item-wrapper"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9a581d96024446599c07e34e19c93b07" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed EDR</h6></div><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916" class="submenu-text-block-2">Get full visibility, detection, and response for your endpoints.</div></a><a href="/platform/security-awareness-training" class="sub-menu-item-2 tablet-hide w-inline-block" tabindex="0"><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916" class="submenu-item-wrapper"><div class="submenu-icon-wrapper"><img width="98.5" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0563b097f1c748188681789c23fe204a" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed Security Awareness Training</h6></div><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916" class="submenu-text-block-2">Empower your teams with science-backed security awareness training.</div></a></div><a href="/platform" class="secondary-button hide-tablet w-inline-block" tabindex="0"><div class="secodnary-button-text">Platform Overview</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div><div class="nav-dropdown-column"><div class="sub-menu-item-main"><div class="spacer-52"></div><a href="/platform/managed-itdr" class="sub-menu-item-2 w-inline-block" tabindex="0"><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916" class="submenu-item-wrapper"><div class="submenu-icon-wrapper"><img width="95.5" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffd3a938d7dfc41bdac34c3f46a36afb2" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed ITDR</h6></div><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916" class="submenu-text-block-2">Protect your Microsoft 365 identities and email environments.</div></a><a href="/platform/siem" class="sub-menu-item-2 w-inline-block" tabindex="0"><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916" class="submenu-item-wrapper"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5638ee75bf42433c81332c153db5cb15" alt="" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed SIEM</h6></div><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916" class="submenu-text-block-2">Capture the data that matters while filtering out the noise.</div></a></div><a href="/platform" class="secondary-button hide-desktop w-inline-block" tabindex="0"><div class="secodnary-button-text">Platform Overview</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div><div class="nav-dropdown-column background-color-gray"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F675068d5b65d403cac4485154bb5ca16" loading="lazy" alt="" class="platform-nav-image"/><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">Learn More</h6><div class="submenu-text-block-2">Try Huntress for free and <br/>deploy in minutes to start <br/>fighting threats.</div></div><a href="/demo" class="secondary-button w-inline-block" tabindex="0"><div class="secodnary-button-text">Request a Demo</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></nav></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu desktop-only w-dropdown"><div class="menu-link-container w-dropdown-toggle " aria-controls="w-dropdown-list-1" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Solutions</div></div><nav class="sub-menu-dropdown four w-dropdown-list " aria-labelledby="w-dropdown-toggle-1"><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block">Solutions by Topic</div><div class="sub-menu-item-main"><a href="/solutions/topics/phishing" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd8af97b52a364281ae4ae771eac29f60" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Phishing</h6></div></a></div><div class="sub-menu-item-main"><a href="/solutions/topics/cybersecurity-compliance" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5437345f68ab4fecb25e1bf64d596f05" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Compliance</h6></div></a></div><div class="sub-menu-item-main"><a href="/solutions/topics/business-email-compromise" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe0006e0247a84d538abfdb56270b1971" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Business Email Compromise</h6></div></a></div></div><div class="nav-dropdown-column"><div class="submenu-text-block">Solutions by Industry</div><div class="sub-menu-item-main"><a href="/industries/education" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4951efeb175d46a28d43a56e44f1aaa6" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Education</h6></div></a><a href="/industries/financial-services" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2c6e56c396984defa968946c3305fd5d" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Finance</h6></div></a><a href="/industries/healthcare" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fad40fb4e0e8f4fc3a283928e18d2cb07" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Healthcare</h6></div></a><a href="/industries/manufacturing" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa1a16399f6f94c3da8e42ddbe735c1c1" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Manufacturing</h6></div></a><a href="/industries/state-and-local-government" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdafe6a53f78a407c80691541d7e292b9" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">State &amp; Local Government</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray"><div class="submenu-text-block no-border hide-tablet">Featured Resource</div><a href="/industries/healthcare/healthcare-resource-kit" class="sub-menu-nav w-inline-block" tabindex="0"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F906b12f80f904ae6b4753ee4a19183a7" loading="lazy" alt="" class="platform-nav-image last-column"/></a><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">Healthcare Cybersecurity Success Kit</h6><div class="submenu-text-block-2">Packed with the information, tools, and guidance you need to keep your organization running smoothly and, most importantly, your patients safe.</div></div><a href="/industries/healthcare/healthcare-resource-kit" class="secondary-button w-inline-block" tabindex="0"><div class="secodnary-button-text">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></nav></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu desktop-only w-dropdown"><div class="menu-link-container w-dropdown-toggle " aria-controls="w-dropdown-list-2" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Why Huntress</div></div><nav class="sub-menu-dropdown two w-dropdown-list " aria-labelledby="w-dropdown-toggle-2"><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block">Who We Serve</div><div class="sub-menu-item-main"><a href="/why-huntress/managed-service-providers" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="100" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F721ae206651e4037bf5e134b3d7a7ae6" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Managed Service Providers</h6></div></a><a href="/why-huntress/value-added-resellers" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="98.5" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff0209e5a35e34a25a31075aca24dec96" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Value Added Resellers</h6></div></a><a href="/why-huntress/businesses-it-teams" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff257bebdca1c45cab6259f8436ca7221" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Business &amp; IT Teams</h6></div></a></div></div><div class="nav-dropdown-column"><div class="submenu-text-block no-border">The Huntress Difference</div><div class="sub-menu-item-main"><a href="/why-huntress/24-7-soc" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc7a2dd82c76547b8830a35af9c98a511" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Huntress SOC</h6></div></a><a href="/success-stories" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9f5b67604e284cb9bdf92a9a456fa608" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Case Studies</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray"><div class="submenu-text-block no-border">Compare Huntress</div><div class="tablet-grid"><a href="/comparison/huntress-vs-bitdefender" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Bitdefender</h6></div></a><a href="/comparison/huntress-vs-blackpoint" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Blackpoint</h6></div></a><a href="/comparison/huntress-vs-crowdstrike" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">CrowdStrike</h6></div></a><a href="/comparison/huntress-vs-datto" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Datto</h6></div></a><a href="/comparison/huntress-vs-sentinelone" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">SentinelOne</h6></div></a><a href="/comparison/huntress-vs-sophos" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Sophos</h6></div></a><a href="/comparison/huntress-vs-webroot" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Webroot</h6></div></a><a href="/comparison" class="secondary-button w-inline-block" tabindex="0"><div class="secodnary-button-text">Compare All</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></nav></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu desktop-only w-dropdown"><div class="menu-link-container w-dropdown-toggle " aria-controls="w-dropdown-list-3" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Resources</div></div><nav class="sub-menu-dropdown three w-dropdown-list " aria-labelledby="w-dropdown-toggle-3"><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block">Resource Center</div><div class="sub-menu-item-main"><a href="/resources?assets=Datasheet" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Datasheets</h6></div></a><a href="/resources?assets=eBook" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Ebooks</h6></div></a><a href="/resources?assets=Report" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Reports</h6></div></a><a href="/resources?assets=On-Demand+Webinar" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">On-Demand Webinars</h6></div></a><a href="/resources?assets=Whitepaper" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Whitepapers</h6></div></a><a href="/resources?assets=Video" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Videos</h6></div></a></div><a href="/resources" class="secondary-button w-inline-block" tabindex="0"><div class="secodnary-button-text">View All Resources</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div><div class="nav-dropdown-column"><div class="spacer-24"></div><div class="sub-menu-item-main"><a href="/blog" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F40ee60b01d8d49f09d997eb34a43439c" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Blog</h6></div></a><a href="/upcoming-events" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F125f40690a05440e9089e436d8b31ca5" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Upcoming Events</h6></div></a><a href="https://support.huntress.io/hc/en-us" target="_blank" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F694358fe49614632ad86600a467e9cfe" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Support Documentation</h6></div></a><a href="/integrations" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2b996be85228451f95f093c5387c229a" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Integrations</h6></div></a><a href="https://hub.huntress.com/#/page/login" target="_blank" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4c51b19e07db4998921e15175320f9a7" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Huntress Hub</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray hide-tablet"><div class="submenu-text-block no-border">Produced by Huntress</div><div class="sub-menu-item-main"><a href="/tradecraft-tuesday" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-icon-wrapper large-icon"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe39cd53f6f734c9fb9c75943e16a2f1f" alt="" class="submenu-desktop-icon large-icon"/></div></a><a href="/firesidechat" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-icon-wrapper large-icon"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febc3adfc1175461e8b12d0fd6532ce26" alt="" class="submenu-desktop-icon large-icon"/></div></a><a href="/product-lab-channel" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block" tabindex="0"><div class="submenu-icon-wrapper large-icon"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faed4732478f64b30acfc34fbdf4dd9ff" alt="" class="submenu-desktop-icon large-icon"/></div></a></div></div><div class="nav-dropdown-column background-color-gray show-tablet"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa895b30051794852b24aa18710f517e1" loading="lazy" alt="Huntress teal logo" class="platform-nav-image"/><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">The Huntress Threat Report</h6><div class="submenu-text-block-2">Try Huntress for free and <br/>deploy in minutes to start <br/>fighting threats.</div></div><a href="/demo" class="secondary-button w-inline-block" tabindex="0"><div class="secodnary-button-text">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></nav></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu desktop-only w-dropdown"><div class="menu-link-container w-dropdown-toggle " aria-controls="w-dropdown-list-4" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">About</div></div><nav class="sub-menu-dropdown four w-dropdown-list " aria-labelledby="w-dropdown-toggle-4"><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block">About Huntress</div><div class="sub-menu-item-main"><a href="/company/our-company" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff4de7538b5ec415fa770b6c07fd89d53" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Our Story</h6></div></a><a href="/company/leadership" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa1ba4e8f20634dc2991a67e2470eb39f" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Leadership</h6></div></a><a href="/company/press" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fde237b5630004059a52887d223bd2a83" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Latest News</h6></div></a><a href="/awards-and-accolades" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F107b70abda5841439fca3a13a02929cf" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Awards</h6></div></a></div></div><div class="nav-dropdown-column"><div class="spacer-32"></div><div class="sub-menu-item-main"><a href="/company/careers" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F80b5a5a31d2245e49c4038e433792c22" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Careers</h6></div></a><a href="/upcoming-events" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9f5b67604e284cb9bdf92a9a456fa608" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Upcoming Events</h6></div></a><a href="/contact-us" class="sub-menu-item-2 single-row w-inline-block" tabindex="0"><div class="submenu-icon-wrapper"><img width="51" loading="lazy" alt="SAT icon" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F3324b3cde0b84f3b8749e3f6577c6540" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Contact Us</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray"><div class="submenu-text-block no-border hide-tablet">Featured Success Story</div><a href="https://assets-global.website-files.com/6579dd0b5f9a54376d296939/6598317ed13aaee7ad5b2b9b_CascadeTechnologies-CaseStudy.pdf" target="_blank" class="sub-menu-nav w-inline-block" tabindex="0"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4e90224bce1c415c81faa880b1cad6e6" loading="lazy" alt="" class="platform-nav-image last-column"/></a><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">Cascade Technologies</h6><div class="submenu-text-block-2">See how Cascade Technologies was notified about the presence of a remote access Trojan with the help of Huntress,.</div></div><a href="https://cdn.builder.io/o/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05fe4c70b424477ba87314407b7da543?alt=media&amp;token=6dcf35e4-e4c5-4858-8e97-a8a8c2be3811&amp;apiKey=3eb6f92aedf74f109c7b4b0897ec39a8" target="_blank" class="secondary-button w-inline-block" tabindex="0"><div class="secodnary-button-text">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></nav></div></li><li class="main-menu-button-nav"><a href="/start-trial" class="button-primary navigation-button is-mobile w-button">Free Trial</a></li></ul></nav><div class="menu-button-mobile w-nav-button " data-ix="mobile-menu-open" style="-webkit-user-select:text" aria-label="menu" role="button" tabindex="0" aria-controls="w-nav-overlay-0" aria-haspopup="menu" aria-expanded="false"><div class="top-line" style="transform-style:preserve-3d;transition:all, transform 200ms;transform:translateX(0px) translateY(0px) translateZ(0px) rotateX(0deg) rotateY(0deg) rotateZ(0deg)"></div><div class="middle-line" style="transition:all, opacity 200ms; opacity: 1"></div><div class="bottom-line" style="transform-style:preserve-3d;transition:all, transform 200ms;transform:translateX(0px) translateY(0px) translateZ(0px) rotateX(0deg) rotateY(0deg) rotateZ(0deg)"></div></div></div><div class="w-nav-overlay h-screen hidden"><nav role="navigation" class="navigation-menu-wrapper block" style="transition:all, transform 400ms;transform:translateY(0px)"><ul role="list" class="nav-menu-main mobile w-list-unstyled"><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu w-dropdown w--nav-dropdown-open"><div class="menu-link-container w-dropdown-toggle w--nav-dropdown-toggle-open" aria-controls="w-dropdown-list-0" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Platform</div><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="menu-link-icon"/></div></div><div class="nav-dropdown-main-menu-mobile"><div class="sub-menu-dropdown-mobile "><div class="sub-menu-link-container-mobile back">Back</div><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block first">Huntress Managed Security Platform</div><div class="sub-menu-item-main"><a href="/platform/managed-edr" class="sub-menu-item-2 w-inline-block"><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916" class="submenu-item-wrapper"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F01041f90e1984945aab0dccf0916722e" alt="" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed EDR</h6></div><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916" class="submenu-text-block-2">Get full endpoint visibility, detection, and response.</div></a><a href="/platform/security-awareness-training" class="sub-menu-item-2 w-inline-block"><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916" class="submenu-item-wrapper"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F35aa234381d6427a80d30e63bbfaa09f" alt="HSAT icon white" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed Security Awareness Training</h6></div><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916" class="submenu-text-block-2">Empower your teams with science-backed security awareness training.</div></a></div><a href="/platform" class="secondary-button hide-tablet w-inline-block"><div class="secodnary-button-text">Platform Overview</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div><div class="nav-dropdown-column"><div class="sub-menu-item-main"><div class="spacer-52"></div><a href="/platform/managed-itdr" class="sub-menu-item-2 w-inline-block"><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916" class="submenu-item-wrapper"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffd3a938d7dfc41bdac34c3f46a36afb2" alt="" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed ITDR</h6></div><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916" class="submenu-text-block-2">Protect your Microsoft 365 identities and email environments.</div></a><a href="/platform/siem" class="sub-menu-item-2 w-inline-block"><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b905e-3a6d5916" class="submenu-item-wrapper"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5638ee75bf42433c81332c153db5cb15" alt="" class="submenu-desktop-icon"/></div><h6 class="submenu-title-2">Managed SIEM</h6></div><div id="w-node-f8864d3f-fbc9-1b92-70a4-cb1f0c1b9063-3a6d5916" class="submenu-text-block-2">Capture the data that matter while filtering out the noise.</div></a></div><a href="/platform" class="secondary-button hide-desktop w-inline-block"><div class="secodnary-button-text">Platform Overview</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div><div class="nav-dropdown-column background-color-gray"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F675068d5b65d403cac4485154bb5ca16" loading="lazy" alt="" class="platform-nav-image"/><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">Learn More</h6><div class="submenu-text-block-2">Try Huntress for free and <br/>deploy in minutes to start <br/>fighting threats.</div></div><a href="/demo" class="secondary-button w-inline-block"><div class="secodnary-button-text">Request a Demo</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></div></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu w-dropdown w--nav-dropdown-open"><div class="menu-link-container w-dropdown-toggle w--nav-dropdown-toggle-open" aria-controls="w-dropdown-list-1" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Solutions</div><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="menu-link-icon"/></div></div><div class="nav-dropdown-main-menu-mobile"><div class="sub-menu-dropdown-mobile hidden"><div class="sub-menu-link-container-mobile back js-menu-click-back w-button">Back</div><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block first">Solutions by Topic</div><div class="sub-menu-item-main"><a href="/solutions/topics/phishing" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd8af97b52a364281ae4ae771eac29f60" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Phishing</h6></div></a></div><div class="sub-menu-item-main"><a href="/solutions/topics/cybersecurity-compliance" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5437345f68ab4fecb25e1bf64d596f05" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Compliance</h6></div></a></div><div class="sub-menu-item-main"><a href="/solutions/topics/business-email-compromise" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe0006e0247a84d538abfdb56270b1971" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Business Email Compromise</h6></div></a></div></div><div class="nav-dropdown-column"><div class="submenu-text-block first">Solutions by Industry</div><div class="sub-menu-item-main"><a href="/industries/education" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F4951efeb175d46a28d43a56e44f1aaa6" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Education</h6></div></a><a href="/industries/financial-services" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2c6e56c396984defa968946c3305fd5d" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Finance</h6></div></a><a href="/industries/healthcare" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fad40fb4e0e8f4fc3a283928e18d2cb07" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Healthcare</h6></div></a><a href="/industries/manufacturing" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa1a16399f6f94c3da8e42ddbe735c1c1" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Manufacturing</h6></div></a><a href="/industries/state-and-local-government" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdafe6a53f78a407c80691541d7e292b9" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">State &amp; Local Government</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray"><div class="submenu-text-block no-border hide-tablet">Featured Resource</div><a href="/solutions/topics/phishing" class="sub-menu-nav w-inline-block"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F906b12f80f904ae6b4753ee4a19183a7" loading="lazy" alt="" class="platform-nav-image last-column"/></a><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">Healthcare Cybersecurity Success Kit</h6><div class="submenu-text-block-2">Packed with the information, tools, and guidance you need to keep your organization running smoothly and, most importantly, your patients safe.</div></div><a href="/solutions/topics/phishing" class="secondary-button w-inline-block"><div class="secodnary-button-text">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></div></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu w-dropdown w--nav-dropdown-open"><div class="menu-link-container w-dropdown-toggle w--nav-dropdown-toggle-open" aria-controls="w-dropdown-list-2" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Why Huntress</div><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="menu-link-icon"/></div></div><div class="nav-dropdown-main-menu-mobile"><div class="sub-menu-dropdown-mobile hidden"><div class="sub-menu-link-container-mobile back js-menu-click-back w-button">Back</div><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block first">Who We Serve</div><div class="sub-menu-item-main"><a href="/why-huntress/managed-service-providers" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e7ba690e3594165ae81c6634bd5674b" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Managed Service Providers</h6></div></a><a href="/why-huntress/value-added-resellers" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F88641b569dc740a68238040efc5b4475" alt="EDR icon" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Value Added Resellers</h6></div></a><a href="/why-huntress/businesses-it-teams" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F45741133357a476e828f3fc9eff31134" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Business &amp; IT Teams</h6></div></a></div></div><div class="nav-dropdown-column"><div class="submenu-text-block no-border">The Huntress Difference</div><div class="sub-menu-item-main"><a href="/why-huntress/24-7-soc" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b28c9a9c5474bbfa61c1b00f5f205df" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Huntress SOC</h6></div></a><a href="/success-stories" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc011a5e2c8c444b2bf1276d09d779297" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Case Studies</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray flex-col"><div class="submenu-text-block no-border">Compare Huntress</div><div class="tablet-grid"><a href="/comparison/huntress-vs-bitdefender" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Bitdefender</h6></div></a><a href="/comparison/huntress-vs-blackpoint" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Blackpoint</h6></div></a><a href="/comparison/huntress-vs-crowdstrike" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">CrowdStrike</h6></div></a><a href="/comparison/huntress-vs-datto" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Datto</h6></div></a><a href="/comparison/huntress-vs-sentinelone" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">SentinelOne</h6></div></a><a href="/comparison/huntress-vs-sophos" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Sophos</h6></div></a><a href="/comparison/huntress-vs-webroot" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Webroot</h6></div></a></div><a href="/comparison" class="secondary-button w-inline-block"><div class="secodnary-button-text">Compare All</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu w-dropdown w--nav-dropdown-open"><div class="menu-link-container w-dropdown-toggle w--nav-dropdown-toggle-open" aria-controls="w-dropdown-list-3" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">Resources</div><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="menu-link-icon"/></div></div><div class="nav-dropdown-main-menu-mobile"><div class="sub-menu-dropdown-mobile hidden"><div class="sub-menu-link-container-mobile back js-menu-click-back w-button">Back</div><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block first">Resource Center</div><div class="sub-menu-item-main"><a href="/resources?assets=Datasheet" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Datasheets</h6></div></a><a href="/resources?assets=eBook" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Ebooks</h6></div></a><a href="/resources?assets=Report" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Reports</h6></div></a><a href="/resources?assets=On-Demand+Webinar" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">On-Demand Webinars</h6></div></a><a href="/resources?assets=Whitepaper" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Whitepapers</h6></div></a><a href="/resources?assets=Video" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Videos</h6></div></a></div><a href="/resources" class="secondary-button w-inline-block"><div class="secodnary-button-text">View All Resources</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div><div class="nav-dropdown-column"><div class="spacer-24"></div><div class="sub-menu-item-main"><a href="/blog" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9599aec9aca24cc38ed0787b9cf7af2a" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Blog</h6></div></a><a href="/upcoming-events" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F71184ce1c7ea4e40aeed46b2b1caa956" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Upcoming Events</h6></div></a><a href="https://support.huntress.io/hc/en-us" target="_blank" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd878e498b479437fb17af8599281c501" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Support Documentation</h6></div></a><a href="/integrations" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2b996be85228451f95f093c5387c229a" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Integrations</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray flex-row hide-tablet"><div class="submenu-text-block no-border">Produced by Huntress</div><div class="sub-menu-item-main"><a href="/tradecraft-tuesday" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-icon-wrapper large-icon"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe39cd53f6f734c9fb9c75943e16a2f1f" alt="" class="submenu-desktop-icon large-icon"/></div></a><a href="/firesidechat" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-icon-wrapper large-icon"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febc3adfc1175461e8b12d0fd6532ce26" alt="" class="submenu-desktop-icon large-icon"/></div></a><a href="/product-lab-channel" class="sub-menu-item-2 single-row bottom_spacing_small w-inline-block"><div class="submenu-icon-wrapper large-icon"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Faed4732478f64b30acfc34fbdf4dd9ff" alt="" class="submenu-desktop-icon large-icon"/></div></a></div></div><div class="nav-dropdown-column background-color-gray show-tablet"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa895b30051794852b24aa18710f517e1" loading="lazy" alt="Huntress teal logo" class="platform-nav-image"/><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">The Huntress Threat Report</h6><div class="submenu-text-block-2">Try Huntress for free and <br/>deploy in minutes to start <br/>fighting threats.</div></div><a href="/demo" class="secondary-button w-inline-block"><div class="secodnary-button-text">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></div></div></li><li class="menu-list-item-wrapper"><div data-hover="true" data-delay="0" blocks-name="navbar1_menu-dropdown" class="nav-dropdown-main-menu w-dropdown w--nav-dropdown-open"><div class="menu-link-container w-dropdown-toggle w--nav-dropdown-toggle-open" aria-controls="w-dropdown-list-4" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="menu-link-text underline-hover">About</div><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" alt="Green arrow" class="menu-link-icon"/></div></div><div class="nav-dropdown-main-menu-mobile"><div class="sub-menu-dropdown-mobile hidden"><div class="sub-menu-link-container-mobile back js-menu-click-back w-button">Back</div><div class="nav-dropdown-wrapper"><div class="nav-dropdown-column"><div class="submenu-text-block first">About Huntress</div><div class="sub-menu-item-main"><a href="/company/our-company" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa41cf78d4c9d4d4eb183c881deaa3c17" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Our Story</h6></div></a><a href="/company/leadership" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Feaa35d4f1c7b42c789e587ecd7797b1a" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Leadership</h6></div></a><a href="/company/press" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fde090186c37343fd9e65dc6c6d65b691" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Latest News</h6></div></a><a href="/awards-and-accolades" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F107b70abda5841439fca3a13a02929cf" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Awards</h6></div></a></div></div><div class="nav-dropdown-column"><div class="spacer-32"></div><div class="sub-menu-item-main"><a href="/company/careers" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F8f51f4c3ba104f94921e0584294c9bde" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Careers</h6></div></a><a href="/upcoming-events" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1af4796442c046f58fd94a8e484e6ad1" alt="" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Upcoming Events</h6></div></a><a href="/contact-us" class="sub-menu-item-2 single-row w-inline-block"><div class="submenu-icon-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffae29f3a7d0e45bf9bc1403cb7722f81" alt="SAT icon" class="submenu-desktop-icon"/></div><div class="submenu-item-wrapper"><h6 class="submenu-title-2">Contact Us</h6></div></a></div></div><div class="nav-dropdown-column background-color-gray"><div class="submenu-text-block no-border hide-tablet">Featured Success Story</div><a href="https://cdn.builder.io/o/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05fe4c70b424477ba87314407b7da543?alt=media&amp;token=6dcf35e4-e4c5-4858-8e97-a8a8c2be3811&amp;apiKey=3eb6f92aedf74f109c7b4b0897ec39a8" target="_blank" class="sub-menu-nav w-inline-block"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F78060584ce444ba5a726170f7951a8ec" loading="lazy" alt="Huntress Cybersecurity" class="platform-nav-image last-column"/></a><div class="sub-menu-item-main"><div class="submenu-item-wrapper no-icon"><h6 class="submenu-title-2">Cascade Technologies</h6><div class="submenu-text-block-2">See how Cascade Technologies was notified about the presence of a remote access Trojan with the help of Huntress,.</div></div><a href="https://assets-global.website-files.com/6579dd0b5f9a54376d296939/6598317ed13aaee7ad5b2b9b_CascadeTechnologies-CaseStudy.pdf" target="_blank" class="secondary-button w-inline-block"><div class="secodnary-button-text">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="right arrow" class="secondary-button-icon"/></a></div></div></div></div></div></li><li class="main-menu-button-nav"><a href="/start-trial" class="button-primary navigation-button is-mobile w-button">Free Trial</a></li></ul></nav></div></div></header><div class="page-wrapper"><div class="builder-component builder-component-65f3299e49a461b4b9c729ba" data-name="page" data-source="Rendered by Builder.io"><div class="builder-content" builder-content-id="65f3299e49a461b4b9c729ba" builder-model="page"><div data-builder-component="page" data-builder-content-id="65f3299e49a461b4b9c729ba"><style data-emotion-css="h47494">.css-h47494{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;}</style><div class="builder-blocks css-h47494" builder-type="blocks"><style data-emotion-css="4hp89i">.css-4hp89i.builder-block{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;position:relative;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;box-sizing:border-box;}</style><div class="builder-block builder-ddebc027a2b547be8bb340dc4719efa5 builder-has-component css-4hp89i" builder-id="builder-ddebc027a2b547be8bb340dc4719efa5"><section class="blog-banner-section"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9f33356fc04f46a2ac4a68753ba41658" loading="eager" alt="" class="landing-banner-shape-1 blog-listing-landing-banner-shape-1"/><div class="w-layout-blockcontainer container-width-1143 w-container"><div class="blog-listing-banner-wrapper"><div class="blog-listing-banner-main-breadcrumb-wrap"><div class="breadcrumb contained"><a href="/" class="breadcrumb-link level-1">Home</a><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="breadcrumb-icon"/><a href="/blog" class="breadcrumb-link level-2">Blog</a><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="breadcrumb-icon"/><div class="breadcrumb-text">Ave Maria and the Chambers of Warzone RAT</div></div></div><div class="blog-listing-heading-inner"><div class="landing-banner-heading blog-landing-banner-heading"><div class="breadcrumb blog-date-breadcrumb"><div class="published-text">Last Updated:</div><a href="/" class="breadcrumb-link breadcrumb-link-back">July 5, 2024</a></div><h1 class="landing-banner-heading-h1 blog">Ave Maria and the Chambers of Warzone RAT</h1><div class="attribution-container"><div class="author-container"><div class="author-wrap-text">By: </div><div class="authors-wrapper w-dyn-list"><div fs-cmsnest-collection="authors" fs-cmsnest-element="template-reference" role="list" class="authors-list w-dyn-items"><div role="listitem" class="author-item w-dyn-item"><a href="/authors/chad-hudson" class="author-link w-inline-block"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F833407826677436f8a7753fbb9f0b3ea" loading="lazy" width="40" height="40" alt="" class="author-profile" style="width:40px;height:40px"/><div class="author-name blog-single">Chad Hudson</div></a></div></div></div><div class="author-divider w-condition-invisible">|</div></div><div class="contributors-custom-styles w-embed"></div></div></div></div><div class="blog-listing-inner-image-wrap"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F46469630afee4a6c8931e7cf49d7e4c1" loading="lazy" alt="" class="blog-listing-banner-image"/></div></div></div><div class="social-share-icon-mobile"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe499a4a7ecac4052ab9e5c194b638f16" loading="lazy" alt="Share icon"/></div></section><section class="blog-detail-content-section"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc2118b00ed614bbf83f96f25de0beaf8" loading="eager" alt="Glitch effect" class="landing-banner-shape-8 blog-detail-landing-banner-shape-8"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fc2118b00ed614bbf83f96f25de0beaf8" loading="lazy" alt="Glitch effect" class="landing-banner-shape-8 blog-detail-landing-banner-glitch-2"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0658aac7c84b4f7e9a7c7b2a5b519b28" loading="lazy" alt="Glitch effect" class="landing-banner-shape-8 blog-right-glitch"/><div class="w-layout-blockcontainer container-width-1143 w-container"><div class="blog-detail-content-wrapper"><div class="blog-main-section"><div class="post-wrapper"><div class="blog-post-summary-main"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ffe85f84d0b0c4f9f8743167664735836" loading="eager" alt="Glitch banner" class="blog-post-summary-main-glitch-top medium-zoom-image"/><div fs-richtext-sanitize="true" fs-richtext-element="rich-text" class="blog-post-summary first w-richtext"><p>Friday, September 30, 2022, seemed a day like any other--until a large amount of PowerShell malware came charging through seeking immediate attention. Sparing no time, I jumped right in.</p><p><br/></p><p>At first, this was troubling. Are the detectors working?? Is something broken?? In order to verify our detector &#x27;ExecutionFromEnvironmentVariable&#x27; had triggered correctly for all these autoruns, I did a quick search:</p><p><span class="highlight"><strong>details.path:powershell.exe +details.command:&quot;GetEnvironmentVariable&quot;</strong></span></p><p>This gave the result for <em>40 </em>autoruns.  <strong><em>*cracks knuckles*</em></strong> Time to get down to business.</p><blockquote>Pro Tip: Doing a quick search helps analysts develop a better understanding of the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.6/query-dsl-query-string-query.html#query-string-syntax" target="_blank">Elastic search syntax</a>. This gives analysts a better understanding of common characteristics and could potentially assist in finding additional footholds.</blockquote><p>Now let&#x27;s dive into the autorun we are checking out.</p><p>We can see <span class="highlight"><strong>GetEnvironmentVariable(&#x27;60493fbacedcfbcabe&#x27;, &#x27;User&#x27;)</strong></span> along with the User Run Key <span class="highlight"><strong>Name</strong></span>. They both use a Base-16 (HEX) formatting, which means alphabetic characters of <span class="highlight"><strong>A - F</strong></span> and numbers <span class="highlight"><strong>0 - 9</strong></span> with a <span class="highlight"><strong>length of 12 to 18</strong></span>. Using <a href="https://regexr.com/" target="_blank">regex </a>we can use <span class="highlight"><strong>[a-f0-9]{12,18}</strong></span>.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2386px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2386px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febe39b52044f447f81e7ad3609a77ff3?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febe39b52044f447f81e7ad3609a77ff3?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febe39b52044f447f81e7ad3609a77ff3?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febe39b52044f447f81e7ad3609a77ff3?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febe39b52044f447f81e7ad3609a77ff3?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febe39b52044f447f81e7ad3609a77ff3?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febe39b52044f447f81e7ad3609a77ff3?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febe39b52044f447f81e7ad3609a77ff3" type="image/webp"/><style data-emotion-css="2qdlcf">.css-2qdlcf{opacity:1;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;object-fit:cover;object-position:center;}</style><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febe39b52044f447f81e7ad3609a77ff3" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febe39b52044f447f81e7ad3609a77ff3?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febe39b52044f447f81e7ad3609a77ff3?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febe39b52044f447f81e7ad3609a77ff3?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febe39b52044f447f81e7ad3609a77ff3?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febe39b52044f447f81e7ad3609a77ff3?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febe39b52044f447f81e7ad3609a77ff3?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febe39b52044f447f81e7ad3609a77ff3?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febe39b52044f447f81e7ad3609a77ff3"/></picture></div></figure><p>Now, on to implementing our findings in RIOs data within ELK. We use a similar but modified search query (seen below) which provided six additional hits. This information tells us this is an <em>active threat</em> still present on the host. Read: time is of the essence.</p><p><strong><span class="highlight">+process.command_line.text:&quot;GetEnvironmentVariable&quot; +process.command_line.text:/[a-f0-9]{12,18}/</span></strong></p><p>Reviewing the Foothold Details, we are able to see the persistence created within the Hive Current Users Run Key. <strong class="highlight">(HKU\SID\SOFTWARE\Microsoft\Windows\CurrentVersion\Run)</strong></p><p>The command ran by the Users Run Key launches PowerShell and invokes expressions in the <a href="https://learn.microsoft.com/en-us/previous-versions/windows/desktop/sidebar/system-environment-getenvironmentvariable" target="_blank">host&#x27;s environments registry</a> with the value <strong class="highlight">60493fbacedcfbcabe</strong>.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2232px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2232px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F088a5fa7b74e4efbaa2701cb28fdab8d?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F088a5fa7b74e4efbaa2701cb28fdab8d?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F088a5fa7b74e4efbaa2701cb28fdab8d?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F088a5fa7b74e4efbaa2701cb28fdab8d?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F088a5fa7b74e4efbaa2701cb28fdab8d?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F088a5fa7b74e4efbaa2701cb28fdab8d?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F088a5fa7b74e4efbaa2701cb28fdab8d?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F088a5fa7b74e4efbaa2701cb28fdab8d" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F088a5fa7b74e4efbaa2701cb28fdab8d" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F088a5fa7b74e4efbaa2701cb28fdab8d?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F088a5fa7b74e4efbaa2701cb28fdab8d?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F088a5fa7b74e4efbaa2701cb28fdab8d?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F088a5fa7b74e4efbaa2701cb28fdab8d?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F088a5fa7b74e4efbaa2701cb28fdab8d?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F088a5fa7b74e4efbaa2701cb28fdab8d?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F088a5fa7b74e4efbaa2701cb28fdab8d?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F088a5fa7b74e4efbaa2701cb28fdab8d"/></picture></div></figure><p>From here we will take to tasking the user&#x27;s Hive Current Users Environment: <strong class="highlight">(HKU\SID\Environment)</strong>. We obtain the next stage within the registry location <strong class="highlight">HKU\SID\Software\&lt;value&gt;</strong>. <br/><br/><strong>Its important to note</strong>: <strong>These additional registry keys will be required in the report for the customer to remove.</strong></p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2324px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2324px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F10b1bbd99fdf47199b50cad550c6064c?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F10b1bbd99fdf47199b50cad550c6064c?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F10b1bbd99fdf47199b50cad550c6064c?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F10b1bbd99fdf47199b50cad550c6064c?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F10b1bbd99fdf47199b50cad550c6064c?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F10b1bbd99fdf47199b50cad550c6064c?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F10b1bbd99fdf47199b50cad550c6064c?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F10b1bbd99fdf47199b50cad550c6064c" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F10b1bbd99fdf47199b50cad550c6064c" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F10b1bbd99fdf47199b50cad550c6064c?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F10b1bbd99fdf47199b50cad550c6064c?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F10b1bbd99fdf47199b50cad550c6064c?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F10b1bbd99fdf47199b50cad550c6064c?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F10b1bbd99fdf47199b50cad550c6064c?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F10b1bbd99fdf47199b50cad550c6064c?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F10b1bbd99fdf47199b50cad550c6064c?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F10b1bbd99fdf47199b50cad550c6064c"/></picture></div></figure><p>Viewing the <strong><span class="highlight">HKU\SID\Software\27842badfbdabe</span>,</strong> we see four values (default, 0, 1 and 3) which show PowerShell variables and encoding. Save the values 0, 1 and 3 for later and isolate the script for further analysis.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2348px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2348px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdee16b0ca60b41cc94468cc10f3705bd?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdee16b0ca60b41cc94468cc10f3705bd?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdee16b0ca60b41cc94468cc10f3705bd?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdee16b0ca60b41cc94468cc10f3705bd?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdee16b0ca60b41cc94468cc10f3705bd?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdee16b0ca60b41cc94468cc10f3705bd?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdee16b0ca60b41cc94468cc10f3705bd?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdee16b0ca60b41cc94468cc10f3705bd" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdee16b0ca60b41cc94468cc10f3705bd" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdee16b0ca60b41cc94468cc10f3705bd?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdee16b0ca60b41cc94468cc10f3705bd?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdee16b0ca60b41cc94468cc10f3705bd?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdee16b0ca60b41cc94468cc10f3705bd?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdee16b0ca60b41cc94468cc10f3705bd?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdee16b0ca60b41cc94468cc10f3705bd?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdee16b0ca60b41cc94468cc10f3705bd?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdee16b0ca60b41cc94468cc10f3705bd"/></picture></div></figure><p>Lets start digging further into the script.</p><p>Within the script, it has encoded variables with Base64, a reverse array that joins the data. What could it be hiding? And make no mistake--it&#x27;s always hiding something.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2476px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2476px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F99736daaf35d4df4a3b2b04e23512c6d?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F99736daaf35d4df4a3b2b04e23512c6d?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F99736daaf35d4df4a3b2b04e23512c6d?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F99736daaf35d4df4a3b2b04e23512c6d?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F99736daaf35d4df4a3b2b04e23512c6d?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F99736daaf35d4df4a3b2b04e23512c6d?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F99736daaf35d4df4a3b2b04e23512c6d?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F99736daaf35d4df4a3b2b04e23512c6d" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F99736daaf35d4df4a3b2b04e23512c6d" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F99736daaf35d4df4a3b2b04e23512c6d?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F99736daaf35d4df4a3b2b04e23512c6d?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F99736daaf35d4df4a3b2b04e23512c6d?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F99736daaf35d4df4a3b2b04e23512c6d?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F99736daaf35d4df4a3b2b04e23512c6d?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F99736daaf35d4df4a3b2b04e23512c6d?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F99736daaf35d4df4a3b2b04e23512c6d?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F99736daaf35d4df4a3b2b04e23512c6d"/></picture></div></figure><p>Using Cyberchef, we can attempt to quickly decode the base64 strings with the formula of <strong class="highlight">Subsection </strong>and <strong class="highlight">Frombase64</strong>. This should grab the majority of strings but will still need some manual intervention. This is where analysts come into play.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2294px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2294px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbfac77ca729e402c99b9317746581a5a?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbfac77ca729e402c99b9317746581a5a?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbfac77ca729e402c99b9317746581a5a?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbfac77ca729e402c99b9317746581a5a?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbfac77ca729e402c99b9317746581a5a?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbfac77ca729e402c99b9317746581a5a?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbfac77ca729e402c99b9317746581a5a?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbfac77ca729e402c99b9317746581a5a" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbfac77ca729e402c99b9317746581a5a" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbfac77ca729e402c99b9317746581a5a?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbfac77ca729e402c99b9317746581a5a?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbfac77ca729e402c99b9317746581a5a?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbfac77ca729e402c99b9317746581a5a?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbfac77ca729e402c99b9317746581a5a?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbfac77ca729e402c99b9317746581a5a?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbfac77ca729e402c99b9317746581a5a?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbfac77ca729e402c99b9317746581a5a"/></picture></div></figure><p>After replacing the encoded Base64 script, we quickly see it has a key, padding, IV, and other common encryption functions. Lets replace the variables with the corresponding value to make the functions of the script easier to read, thus attempting to reveal the secret embedded within.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2406px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2406px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F387402091ec0419ba6ba3c58b36984ab?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F387402091ec0419ba6ba3c58b36984ab?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F387402091ec0419ba6ba3c58b36984ab?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F387402091ec0419ba6ba3c58b36984ab?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F387402091ec0419ba6ba3c58b36984ab?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F387402091ec0419ba6ba3c58b36984ab?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F387402091ec0419ba6ba3c58b36984ab?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F387402091ec0419ba6ba3c58b36984ab" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F387402091ec0419ba6ba3c58b36984ab" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F387402091ec0419ba6ba3c58b36984ab?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F387402091ec0419ba6ba3c58b36984ab?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F387402091ec0419ba6ba3c58b36984ab?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F387402091ec0419ba6ba3c58b36984ab?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F387402091ec0419ba6ba3c58b36984ab?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F387402091ec0419ba6ba3c58b36984ab?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F387402091ec0419ba6ba3c58b36984ab?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F387402091ec0419ba6ba3c58b36984ab"/></picture></div></figure><p>Now with the script variables replaced, we can see the payload is using AES Encryption using cipher mode <a href="https://medium.com/asecuritysite-when-bob-met-alice/electronic-code-book-ecb-and-cipher-block-chaining-cbc-e3309d704917" target="_blank">Electronic CodeBook (ECB)</a>, dropping 16 bytes to create the IV, and it has also been compressed.</p><p><strong>Note: Some samples use different cipher modes so make sure to verify this (for example, we have seen ECB and CBC).</strong></p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2414px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2414px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F31d5c5462c2b4123aec618f243c511ff?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F31d5c5462c2b4123aec618f243c511ff?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F31d5c5462c2b4123aec618f243c511ff?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F31d5c5462c2b4123aec618f243c511ff?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F31d5c5462c2b4123aec618f243c511ff?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F31d5c5462c2b4123aec618f243c511ff?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F31d5c5462c2b4123aec618f243c511ff?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F31d5c5462c2b4123aec618f243c511ff" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F31d5c5462c2b4123aec618f243c511ff" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F31d5c5462c2b4123aec618f243c511ff?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F31d5c5462c2b4123aec618f243c511ff?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F31d5c5462c2b4123aec618f243c511ff?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F31d5c5462c2b4123aec618f243c511ff?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F31d5c5462c2b4123aec618f243c511ff?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F31d5c5462c2b4123aec618f243c511ff?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F31d5c5462c2b4123aec618f243c511ff?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F31d5c5462c2b4123aec618f243c511ff"/></picture></div></figure><p>To get the IV for our AES encryption, we need to place the payload in Cyberchef. Since we can see the padding <strong>= </strong>for Base64, we <strong>reverse </strong>the payload. Then we use <strong class="highlight">From Base64</strong> after which we drop the bytes from 16 bytes (start at 16 and a large length). Now we convert the IV back <strong class="highlight">To Base64</strong>. <br/>This results in our IV: <strong class="highlight">duNJnxEFm0/Nw/W34mpGMg==</strong></p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2288px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2288px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea4958deaab34475af16707185a6bcc8?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea4958deaab34475af16707185a6bcc8?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea4958deaab34475af16707185a6bcc8?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea4958deaab34475af16707185a6bcc8?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea4958deaab34475af16707185a6bcc8?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea4958deaab34475af16707185a6bcc8?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea4958deaab34475af16707185a6bcc8?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea4958deaab34475af16707185a6bcc8" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea4958deaab34475af16707185a6bcc8" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea4958deaab34475af16707185a6bcc8?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea4958deaab34475af16707185a6bcc8?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea4958deaab34475af16707185a6bcc8?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea4958deaab34475af16707185a6bcc8?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea4958deaab34475af16707185a6bcc8?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea4958deaab34475af16707185a6bcc8?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea4958deaab34475af16707185a6bcc8?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea4958deaab34475af16707185a6bcc8"/></picture></div></figure><p>Let&#x27;s combine everything together now. Make sure to <strong>reverse </strong>the payload <strong class="highlight">From Base64</strong> and drop the first <strong class="highlight">16 Bytes</strong>. With the <strong class="highlight">AES decrypt </strong>we require the Base64 Key <strong class="highlight">9fJygHL[...]</strong>, an IV that was obtained earlier <strong class="highlight">duNJnx[...]</strong>, then change the <strong>AES cipher mode to ECB</strong>, input as <strong class="highlight">Raw</strong>,and the output as <strong class="highlight">Raw</strong>. Since the payload has also been compressed we will be required to use <strong class="highlight">Raw Inflate</strong> to get our final output.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2300px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2300px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd07047bd02f64a16b68991ae50165518?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd07047bd02f64a16b68991ae50165518?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd07047bd02f64a16b68991ae50165518?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd07047bd02f64a16b68991ae50165518?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd07047bd02f64a16b68991ae50165518?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd07047bd02f64a16b68991ae50165518?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd07047bd02f64a16b68991ae50165518?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd07047bd02f64a16b68991ae50165518" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd07047bd02f64a16b68991ae50165518" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd07047bd02f64a16b68991ae50165518?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd07047bd02f64a16b68991ae50165518?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd07047bd02f64a16b68991ae50165518?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd07047bd02f64a16b68991ae50165518?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd07047bd02f64a16b68991ae50165518?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd07047bd02f64a16b68991ae50165518?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd07047bd02f64a16b68991ae50165518?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd07047bd02f64a16b68991ae50165518"/></picture></div></figure><p>When inspecting the output we can already see the next stage is another script. This script of the payload is identical to the previous one. This is a rinse-and-repeat stage. Hope you weren&#x27;t expecting this to be straightforward; that&#x27;d be too easy!</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2428px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2428px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e9b3723543b47d3ad3fe177c7cdd6de?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e9b3723543b47d3ad3fe177c7cdd6de?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e9b3723543b47d3ad3fe177c7cdd6de?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e9b3723543b47d3ad3fe177c7cdd6de?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e9b3723543b47d3ad3fe177c7cdd6de?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e9b3723543b47d3ad3fe177c7cdd6de?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e9b3723543b47d3ad3fe177c7cdd6de?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e9b3723543b47d3ad3fe177c7cdd6de" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e9b3723543b47d3ad3fe177c7cdd6de" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e9b3723543b47d3ad3fe177c7cdd6de?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e9b3723543b47d3ad3fe177c7cdd6de?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e9b3723543b47d3ad3fe177c7cdd6de?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e9b3723543b47d3ad3fe177c7cdd6de?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e9b3723543b47d3ad3fe177c7cdd6de?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e9b3723543b47d3ad3fe177c7cdd6de?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e9b3723543b47d3ad3fe177c7cdd6de?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e9b3723543b47d3ad3fe177c7cdd6de"/></picture></div></figure><p>After cementing what we just learned, we gain a new output.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2302px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2302px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F379e7d80fbcb441ca4d6d40198dabf0a?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F379e7d80fbcb441ca4d6d40198dabf0a?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F379e7d80fbcb441ca4d6d40198dabf0a?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F379e7d80fbcb441ca4d6d40198dabf0a?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F379e7d80fbcb441ca4d6d40198dabf0a?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F379e7d80fbcb441ca4d6d40198dabf0a?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F379e7d80fbcb441ca4d6d40198dabf0a?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F379e7d80fbcb441ca4d6d40198dabf0a" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F379e7d80fbcb441ca4d6d40198dabf0a" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F379e7d80fbcb441ca4d6d40198dabf0a?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F379e7d80fbcb441ca4d6d40198dabf0a?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F379e7d80fbcb441ca4d6d40198dabf0a?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F379e7d80fbcb441ca4d6d40198dabf0a?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F379e7d80fbcb441ca4d6d40198dabf0a?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F379e7d80fbcb441ca4d6d40198dabf0a?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F379e7d80fbcb441ca4d6d40198dabf0a?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F379e7d80fbcb441ca4d6d40198dabf0a"/></picture></div></figure><p>To go further, its required to download the payload from a Discord link. This comes down to analysts&#x27; choice in how they download malicious samples. <br/><br/><strong>Note: If a script has <span class="highlight">Reflection.Assembly</span> (</strong><a href="https://learn.microsoft.com/en-us/dotnet/api/system.reflection.assembly?view=net-6.0" target="_blank"><strong>assembly</strong></a><strong>), this loads a .NET payload. Therefore anytime we see <span class="highlight">Reflection.Assembly</span> we know were dealing with a .NET malware.</strong></p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2160px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2160px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff23aee3e337e42088a72cb1aa5f9b55d?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff23aee3e337e42088a72cb1aa5f9b55d?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff23aee3e337e42088a72cb1aa5f9b55d?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff23aee3e337e42088a72cb1aa5f9b55d?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff23aee3e337e42088a72cb1aa5f9b55d?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff23aee3e337e42088a72cb1aa5f9b55d?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff23aee3e337e42088a72cb1aa5f9b55d?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff23aee3e337e42088a72cb1aa5f9b55d" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff23aee3e337e42088a72cb1aa5f9b55d" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff23aee3e337e42088a72cb1aa5f9b55d?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff23aee3e337e42088a72cb1aa5f9b55d?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff23aee3e337e42088a72cb1aa5f9b55d?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff23aee3e337e42088a72cb1aa5f9b55d?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff23aee3e337e42088a72cb1aa5f9b55d?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff23aee3e337e42088a72cb1aa5f9b55d?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff23aee3e337e42088a72cb1aa5f9b55d?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff23aee3e337e42088a72cb1aa5f9b55d"/></picture></div></figure><p>After downloading the Discord payload, we will allow the script to do the heavy lifting. We just need to modify parts out of the script after we downloaded and isolated the payload:</p><p><strong class="highlight">[string] $xoredText = Get-Content &quot;C:\\users\\Burgers\\Desktop\\mkv.txt&quot;[io.file]::writeallbytes(&quot;C:\\users\\burgers\\desktop\\mkv_decoded.bin&quot;, $bytes)</strong></p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1914px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1914px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94000212c94345799c1d49aaa8e92546?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94000212c94345799c1d49aaa8e92546?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94000212c94345799c1d49aaa8e92546?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94000212c94345799c1d49aaa8e92546?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94000212c94345799c1d49aaa8e92546?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94000212c94345799c1d49aaa8e92546?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94000212c94345799c1d49aaa8e92546?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94000212c94345799c1d49aaa8e92546" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94000212c94345799c1d49aaa8e92546" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94000212c94345799c1d49aaa8e92546?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94000212c94345799c1d49aaa8e92546?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94000212c94345799c1d49aaa8e92546?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94000212c94345799c1d49aaa8e92546?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94000212c94345799c1d49aaa8e92546?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94000212c94345799c1d49aaa8e92546?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94000212c94345799c1d49aaa8e92546?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94000212c94345799c1d49aaa8e92546"/></picture></div></figure><p>With the decoded <strong>mkv_decoded.bin</strong> its important to still do a quick static analysis of the payload within <a href="https://www.winitor.com/" target="_blank">pestudio</a>. The signature confirms our suspicions of it being .NET. Along with the description and version of the file, it gives us additional information that the payload may be a <strong>netLoaderDll</strong>. We also see the entropy is only 2.980, showing this payload may not be packed.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1434px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1434px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7b284b19dd5d4a9eb44e30999259ad73?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7b284b19dd5d4a9eb44e30999259ad73?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7b284b19dd5d4a9eb44e30999259ad73?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7b284b19dd5d4a9eb44e30999259ad73?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7b284b19dd5d4a9eb44e30999259ad73?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7b284b19dd5d4a9eb44e30999259ad73?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7b284b19dd5d4a9eb44e30999259ad73?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7b284b19dd5d4a9eb44e30999259ad73" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7b284b19dd5d4a9eb44e30999259ad73" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7b284b19dd5d4a9eb44e30999259ad73?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7b284b19dd5d4a9eb44e30999259ad73?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7b284b19dd5d4a9eb44e30999259ad73?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7b284b19dd5d4a9eb44e30999259ad73?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7b284b19dd5d4a9eb44e30999259ad73?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7b284b19dd5d4a9eb44e30999259ad73?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7b284b19dd5d4a9eb44e30999259ad73?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7b284b19dd5d4a9eb44e30999259ad73"/></picture></div></figure><p>Inspecting the netLoaderDll within dnSpy we see a few classes: Main, runPayload and StringToByteArray.</p><p><br/></p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:440px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="440px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F439af2e42764429ab4ad6af2e9c6f5cc?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F439af2e42764429ab4ad6af2e9c6f5cc?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F439af2e42764429ab4ad6af2e9c6f5cc?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F439af2e42764429ab4ad6af2e9c6f5cc?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F439af2e42764429ab4ad6af2e9c6f5cc?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F439af2e42764429ab4ad6af2e9c6f5cc?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F439af2e42764429ab4ad6af2e9c6f5cc?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F439af2e42764429ab4ad6af2e9c6f5cc" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F439af2e42764429ab4ad6af2e9c6f5cc" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F439af2e42764429ab4ad6af2e9c6f5cc?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F439af2e42764429ab4ad6af2e9c6f5cc?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F439af2e42764429ab4ad6af2e9c6f5cc?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F439af2e42764429ab4ad6af2e9c6f5cc?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F439af2e42764429ab4ad6af2e9c6f5cc?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F439af2e42764429ab4ad6af2e9c6f5cc?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F439af2e42764429ab4ad6af2e9c6f5cc?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F439af2e42764429ab4ad6af2e9c6f5cc"/></picture></div></figure><p>This application stores the next stage of the malware within <strong class="highlight">Main()</strong>, which we see has a large byte array within it. The netLoaderDll requires <strong class="highlight">StringToByteArray </strong>to convert the hex to an application and <strong class="highlight">runPayload </strong>will launch the next stage.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2082px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2082px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa27d9de7f22049fdac18485a6a5d403a?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa27d9de7f22049fdac18485a6a5d403a?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa27d9de7f22049fdac18485a6a5d403a?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa27d9de7f22049fdac18485a6a5d403a?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa27d9de7f22049fdac18485a6a5d403a?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa27d9de7f22049fdac18485a6a5d403a?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa27d9de7f22049fdac18485a6a5d403a?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa27d9de7f22049fdac18485a6a5d403a" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa27d9de7f22049fdac18485a6a5d403a" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa27d9de7f22049fdac18485a6a5d403a?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa27d9de7f22049fdac18485a6a5d403a?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa27d9de7f22049fdac18485a6a5d403a?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa27d9de7f22049fdac18485a6a5d403a?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa27d9de7f22049fdac18485a6a5d403a?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa27d9de7f22049fdac18485a6a5d403a?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa27d9de7f22049fdac18485a6a5d403a?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa27d9de7f22049fdac18485a6a5d403a"/></picture></div></figure><p>Extract the hex string from dnSpy and place it within Cyberchef and convert <strong class="highlight">From Hex</strong> to gain our next stage.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1392px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1392px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff66ebdc2dd9c4798bb790e6bd3c7293e?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff66ebdc2dd9c4798bb790e6bd3c7293e?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff66ebdc2dd9c4798bb790e6bd3c7293e?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff66ebdc2dd9c4798bb790e6bd3c7293e?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff66ebdc2dd9c4798bb790e6bd3c7293e?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff66ebdc2dd9c4798bb790e6bd3c7293e?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff66ebdc2dd9c4798bb790e6bd3c7293e?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff66ebdc2dd9c4798bb790e6bd3c7293e" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff66ebdc2dd9c4798bb790e6bd3c7293e" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff66ebdc2dd9c4798bb790e6bd3c7293e?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff66ebdc2dd9c4798bb790e6bd3c7293e?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff66ebdc2dd9c4798bb790e6bd3c7293e?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff66ebdc2dd9c4798bb790e6bd3c7293e?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff66ebdc2dd9c4798bb790e6bd3c7293e?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff66ebdc2dd9c4798bb790e6bd3c7293e?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff66ebdc2dd9c4798bb790e6bd3c7293e?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff66ebdc2dd9c4798bb790e6bd3c7293e"/></picture></div></figure><p><br/></p><p>Once more place the next stage within pestudio for a quick static analysis of the file&#x27;s contents. We can see the original files named RunPE.exe. With a description of SyscallPEloader, we can somewhat safely assume this is potentially a tool to modify the syscall. This file is now packed heavily with an entropy of 7.766.</p><p><br/></p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1436px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1436px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68ce6cc027884ac18765d922d3a33c15?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68ce6cc027884ac18765d922d3a33c15?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68ce6cc027884ac18765d922d3a33c15?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68ce6cc027884ac18765d922d3a33c15?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68ce6cc027884ac18765d922d3a33c15?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68ce6cc027884ac18765d922d3a33c15?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68ce6cc027884ac18765d922d3a33c15?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68ce6cc027884ac18765d922d3a33c15" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68ce6cc027884ac18765d922d3a33c15" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68ce6cc027884ac18765d922d3a33c15?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68ce6cc027884ac18765d922d3a33c15?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68ce6cc027884ac18765d922d3a33c15?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68ce6cc027884ac18765d922d3a33c15?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68ce6cc027884ac18765d922d3a33c15?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68ce6cc027884ac18765d922d3a33c15?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68ce6cc027884ac18765d922d3a33c15?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68ce6cc027884ac18765d922d3a33c15"/></picture></div></figure><p><br/></p><p>Sadly this is not the last stage of the malware, and it appears that it is using a <a href="https://depthsecurity.com/blog/classic-api-unhooking-to-bypass-edr-solutions" target="_blank">common evasion tactic of unhooking APIs</a> within the host and thus spawns a process for Notepad.exe. Needing further insight, we turn to one of our neighborhood experts to finish off this investigation.<br/><br/><strong><em> Big thanks to </em></strong><a href="https://twitter.com/embee_research" target="_blank">@Matthew Brennan</a><strong> <em>for his insight on this next stage</em>.</strong><br/>The following is basically a TL;DR of Matthew&#x27;s findings. Let&#x27;s check it out!</p><p><br/></p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:950px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="950px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22c8c707f2ca42e5a9999edc21c4def7?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22c8c707f2ca42e5a9999edc21c4def7?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22c8c707f2ca42e5a9999edc21c4def7?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22c8c707f2ca42e5a9999edc21c4def7?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22c8c707f2ca42e5a9999edc21c4def7?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22c8c707f2ca42e5a9999edc21c4def7?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22c8c707f2ca42e5a9999edc21c4def7?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22c8c707f2ca42e5a9999edc21c4def7" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22c8c707f2ca42e5a9999edc21c4def7" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22c8c707f2ca42e5a9999edc21c4def7?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22c8c707f2ca42e5a9999edc21c4def7?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22c8c707f2ca42e5a9999edc21c4def7?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22c8c707f2ca42e5a9999edc21c4def7?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22c8c707f2ca42e5a9999edc21c4def7?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22c8c707f2ca42e5a9999edc21c4def7?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22c8c707f2ca42e5a9999edc21c4def7?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22c8c707f2ca42e5a9999edc21c4def7"/></picture></div></figure><p>After the execution of the RunPE.exe, we open ResourceHacker to see available processes on the host.</p><p><br/></p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:828px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="828px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05d383dd738d40d68c6f469f9fc87d17?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05d383dd738d40d68c6f469f9fc87d17?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05d383dd738d40d68c6f469f9fc87d17?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05d383dd738d40d68c6f469f9fc87d17?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05d383dd738d40d68c6f469f9fc87d17?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05d383dd738d40d68c6f469f9fc87d17?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05d383dd738d40d68c6f469f9fc87d17?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05d383dd738d40d68c6f469f9fc87d17" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05d383dd738d40d68c6f469f9fc87d17" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05d383dd738d40d68c6f469f9fc87d17?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05d383dd738d40d68c6f469f9fc87d17?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05d383dd738d40d68c6f469f9fc87d17?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05d383dd738d40d68c6f469f9fc87d17?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05d383dd738d40d68c6f469f9fc87d17?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05d383dd738d40d68c6f469f9fc87d17?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05d383dd738d40d68c6f469f9fc87d17?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05d383dd738d40d68c6f469f9fc87d17"/></picture></div></figure><p><br/></p><p>Within properties, we open the Threads tab. Instantly a TID of <strong>3488 </strong>flashes in front of us and changes its start address from <span class="highlight"><strong>0x1da511e0000</strong> to </span><strong><span class="highlight">0x0</span>.</strong></p><p><br/></p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:528px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="528px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a26f0c086fa41f4bd9d41f2d8513032?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a26f0c086fa41f4bd9d41f2d8513032?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a26f0c086fa41f4bd9d41f2d8513032?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a26f0c086fa41f4bd9d41f2d8513032?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a26f0c086fa41f4bd9d41f2d8513032?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a26f0c086fa41f4bd9d41f2d8513032?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a26f0c086fa41f4bd9d41f2d8513032?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a26f0c086fa41f4bd9d41f2d8513032" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a26f0c086fa41f4bd9d41f2d8513032" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a26f0c086fa41f4bd9d41f2d8513032?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a26f0c086fa41f4bd9d41f2d8513032?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a26f0c086fa41f4bd9d41f2d8513032?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a26f0c086fa41f4bd9d41f2d8513032?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a26f0c086fa41f4bd9d41f2d8513032?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a26f0c086fa41f4bd9d41f2d8513032?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a26f0c086fa41f4bd9d41f2d8513032?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a26f0c086fa41f4bd9d41f2d8513032"/></picture></div></figure><p>Inspect the thread, if you will: here we see <strong>SleepEx+0x9e</strong> which sleeps the host. Also, there is an address of <strong class="highlight">0x1da52c4acdf </strong>that is close to the start address that flashed at the beginning. This could be the decryption piece of the software. Copy the thread <strong class="highlight">0x1da52c4acdf</strong>. Go ahead. It&#x27;s okay.</p><figure class="w-richtext-figure-type-image w-richtext-align-center" data-rt-type="image" data-rt-align="center"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1eacc99ad8e743108510c7d905d0dfff?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1eacc99ad8e743108510c7d905d0dfff?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1eacc99ad8e743108510c7d905d0dfff?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1eacc99ad8e743108510c7d905d0dfff?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1eacc99ad8e743108510c7d905d0dfff?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1eacc99ad8e743108510c7d905d0dfff?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1eacc99ad8e743108510c7d905d0dfff?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1eacc99ad8e743108510c7d905d0dfff" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1eacc99ad8e743108510c7d905d0dfff" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1eacc99ad8e743108510c7d905d0dfff?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1eacc99ad8e743108510c7d905d0dfff?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1eacc99ad8e743108510c7d905d0dfff?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1eacc99ad8e743108510c7d905d0dfff?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1eacc99ad8e743108510c7d905d0dfff?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1eacc99ad8e743108510c7d905d0dfff?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1eacc99ad8e743108510c7d905d0dfff?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1eacc99ad8e743108510c7d905d0dfff"/></picture></div></figure><p>Now attach the Notepad.exe process to x64dbg and <strong class="highlight">Go to Expression</strong> with Ctrl + G. Now paste the thread address <strong class="highlight">0x1da52c4acdf </strong>and set an execution breakpoint. We&#x27;ll wait.</p><p><br/></p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2598px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2598px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fedabd83f07954c8487d95dc7c1bcfbf0?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fedabd83f07954c8487d95dc7c1bcfbf0?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fedabd83f07954c8487d95dc7c1bcfbf0?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fedabd83f07954c8487d95dc7c1bcfbf0?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fedabd83f07954c8487d95dc7c1bcfbf0?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fedabd83f07954c8487d95dc7c1bcfbf0?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fedabd83f07954c8487d95dc7c1bcfbf0?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fedabd83f07954c8487d95dc7c1bcfbf0" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fedabd83f07954c8487d95dc7c1bcfbf0" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fedabd83f07954c8487d95dc7c1bcfbf0?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fedabd83f07954c8487d95dc7c1bcfbf0?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fedabd83f07954c8487d95dc7c1bcfbf0?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fedabd83f07954c8487d95dc7c1bcfbf0?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fedabd83f07954c8487d95dc7c1bcfbf0?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fedabd83f07954c8487d95dc7c1bcfbf0?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fedabd83f07954c8487d95dc7c1bcfbf0?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fedabd83f07954c8487d95dc7c1bcfbf0"/></picture></div></figure><p>Change the thread to the value closest to the address; in this case, it is the thread using <strong class="highlight">000001DA511E0000</strong>.</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:1918px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1918px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9b2a964032d948c68e678f7ed9247894?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9b2a964032d948c68e678f7ed9247894?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9b2a964032d948c68e678f7ed9247894?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9b2a964032d948c68e678f7ed9247894?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9b2a964032d948c68e678f7ed9247894?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9b2a964032d948c68e678f7ed9247894?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9b2a964032d948c68e678f7ed9247894?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9b2a964032d948c68e678f7ed9247894" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9b2a964032d948c68e678f7ed9247894" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9b2a964032d948c68e678f7ed9247894?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9b2a964032d948c68e678f7ed9247894?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9b2a964032d948c68e678f7ed9247894?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9b2a964032d948c68e678f7ed9247894?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9b2a964032d948c68e678f7ed9247894?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9b2a964032d948c68e678f7ed9247894?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9b2a964032d948c68e678f7ed9247894?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9b2a964032d948c68e678f7ed9247894"/></picture></div></figure><p>Now we run the debugger until it hits the Hardware BreakPoint. We hit the key <strong>g</strong> and get a glimpse of what the loops are doing on this host. This is potentially the decryptor algorithm. <br/><br/>We also set a Hardware on Execution breakpoint on the address <strong class="highlight">000001DA52C4AD2B </strong>and run the application.</p><p><br/></p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:940px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="940px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b173cc279ea4cbd8e3b672dcbf625c3?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b173cc279ea4cbd8e3b672dcbf625c3?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b173cc279ea4cbd8e3b672dcbf625c3?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b173cc279ea4cbd8e3b672dcbf625c3?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b173cc279ea4cbd8e3b672dcbf625c3?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b173cc279ea4cbd8e3b672dcbf625c3?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b173cc279ea4cbd8e3b672dcbf625c3?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b173cc279ea4cbd8e3b672dcbf625c3" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b173cc279ea4cbd8e3b672dcbf625c3" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b173cc279ea4cbd8e3b672dcbf625c3?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b173cc279ea4cbd8e3b672dcbf625c3?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b173cc279ea4cbd8e3b672dcbf625c3?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b173cc279ea4cbd8e3b672dcbf625c3?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b173cc279ea4cbd8e3b672dcbf625c3?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b173cc279ea4cbd8e3b672dcbf625c3?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b173cc279ea4cbd8e3b672dcbf625c3?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b173cc279ea4cbd8e3b672dcbf625c3"/></picture></div></figure><p><br/></p><p>Now step in the code a few times and we get our C2 information: <span class="highlight"><strong>organitations[.]com/Preserve/stat/3E8YZFXJ</strong> (<strong>69.28.84.201</strong>)</span>.</p><p><br/></p><figure class="w-richtext-figure-type-image w-richtext-align-center" data-rt-type="image" data-rt-align="center"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd06b7d9e3c2546fc80a27e63727c327e?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd06b7d9e3c2546fc80a27e63727c327e?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd06b7d9e3c2546fc80a27e63727c327e?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd06b7d9e3c2546fc80a27e63727c327e?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd06b7d9e3c2546fc80a27e63727c327e?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd06b7d9e3c2546fc80a27e63727c327e?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd06b7d9e3c2546fc80a27e63727c327e?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd06b7d9e3c2546fc80a27e63727c327e" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd06b7d9e3c2546fc80a27e63727c327e" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd06b7d9e3c2546fc80a27e63727c327e?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd06b7d9e3c2546fc80a27e63727c327e?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd06b7d9e3c2546fc80a27e63727c327e?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd06b7d9e3c2546fc80a27e63727c327e?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd06b7d9e3c2546fc80a27e63727c327e?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd06b7d9e3c2546fc80a27e63727c327e?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd06b7d9e3c2546fc80a27e63727c327e?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd06b7d9e3c2546fc80a27e63727c327e"/></picture></div></figure><p>Review ELK for the process <strong>notepad.exe</strong> that is spawned by the parent process <strong class="highlight">powershell.exe</strong> with the command from the user&#x27;s environment.</p><p><strong>Note: Its important to remove this process from the client as this is a cobalt strike beacon.</strong></p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth" style="max-width:2866px" data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="2866px"><div><picture><source srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb69ab72476554338bd4cb9fa4e193a5a?format=webp&amp;width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb69ab72476554338bd4cb9fa4e193a5a?format=webp&amp;width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb69ab72476554338bd4cb9fa4e193a5a?format=webp&amp;width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb69ab72476554338bd4cb9fa4e193a5a?format=webp&amp;width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb69ab72476554338bd4cb9fa4e193a5a?format=webp&amp;width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb69ab72476554338bd4cb9fa4e193a5a?format=webp&amp;width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb69ab72476554338bd4cb9fa4e193a5a?format=webp&amp;width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb69ab72476554338bd4cb9fa4e193a5a" type="image/webp"/><img role="presentation" loading="lazy" fetchPriority="auto" class="builder-image image-zoomable css-2qdlcf" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb69ab72476554338bd4cb9fa4e193a5a" srcSet="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb69ab72476554338bd4cb9fa4e193a5a?width=100 100w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb69ab72476554338bd4cb9fa4e193a5a?width=200 200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb69ab72476554338bd4cb9fa4e193a5a?width=400 400w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb69ab72476554338bd4cb9fa4e193a5a?width=800 800w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb69ab72476554338bd4cb9fa4e193a5a?width=1200 1200w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb69ab72476554338bd4cb9fa4e193a5a?width=1600 1600w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb69ab72476554338bd4cb9fa4e193a5a?width=2000 2000w, https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb69ab72476554338bd4cb9fa4e193a5a"/></picture></div></figure><p><strong>TLDR:</strong><br/>The Initial payload for this malware is:</p><p>- a user downloads a maldocx from a phishing email</p><p>- they execute the executable which runs an encoded base64 command that disables the firewall and installs environment persistence within the user&#x27;s AutoRun key and creates a process that has RAT capabilities.<br/><br/>Its found some samples that have this form of execution pattern:</p><p>Maldocx  Javascript (Wscript)  Powershell Environment  Cobaltstrike</p><p>Maldocx  Powershell Environment  Cobaltstrike</p><h2>Final Thoughts</h2><p>We hope you found this deconstruction helpful and useful. Below are some additional resources for you to get your hands dirty and gain a deeper understanding of what we did here in this blog today. The more analysts play around with malware in a safe environment, the better they can become at spotting the nastier, greasier, well-hidden activity lurking within environments.</p><p><strong>Discord URLs</strong></p><p>https://cdn[.]discordapp[.]com/attachments/1004902785772441697/1004915801771495495/ppp</p><p>https://cdn[.]discordapp[.]com/attachments/1013559875034415135/1014369421629857882/sdwwcKkjnwsdw.mkv</p><p><br/></p><p><strong>Autorun</strong></p><p>HKU\SID\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</p><p>HKU\SID\Environment</p><p>HKU\SID\Software\&lt;value&gt;</p><p>C:\Users\User\appdata\local\temp\&lt;value&gt;.js - Some Variants</p><p><br/></p><p><strong>Search Queries</strong></p><p>+details.path:powershell.exe +details.command:&quot;GetEnvironmentVariable&quot;</p><p>+process.command_line.text:&quot;GetEnvironmentVariable&quot;+process.command_line.text:/[a-f0-9]{12,18}/</p><p>+process.name:notepad.exe +process.parent.name:powershell.exe +process.parent.args_count:7</p><p>+process.cleartext:(cdn.discordapp.com AND attachments)</p></div><div class="pdf-download w-condition-invisible"><a aria-label="download" href="#" class="primary-button w-condition-invisible w-dyn-bind-empty w-button"></a><a aria-label="download" href="#" class="primary-button w-condition-invisible w-dyn-bind-empty w-button"></a></div></div></div><div class="blog-line-divider mg-40 w-condition-invisible"></div><div class="blog-cta-main w-condition-invisible"><div class="blog-cta w-condition-invisible"><div id="w-node-_31878ec5-f5b2-d418-3dc8-993c0d5db453-b9c729ba" class="blog-cta-image-wrapper"><img loading="lazy" alt="Huntress social logo" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F278d55e06d4843e59195957f97b794b4" class="blog-cta-image"/></div><div id="w-node-b0b97a18-5681-c15e-4d4e-0491357856ef-b9c729ba" class="blog-cta-content"><div class="blog-cta-content-inner"><h2 class="heading-h2 w-dyn-bind-empty"></h2><a href="#" class="primary-button-2 w-button">Call to Action</a></div><div class="gradient-green-dark-blue-black"></div></div></div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdb70cb08b82e4eb6bd5023475d56f8bb" loading="lazy" alt="Blurry glitch effect" class="cta-blog-glitch _01"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd7d3c84c82874bb2b175de0162451f36" loading="lazy" alt="Glitch effect" class="cta-blog-glitch _02"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fda78b25da881485489193909ada5b685" loading="lazy" alt="Glitch effect" class="cta-blog-glitch _03"/></div><div class="blog-line-divider mg-20 w-condition-invisible"></div></div><div class="blog-sidebar"><div class="blog-sidebar-inner"><div class="blog-category-list-wrapper"><div class="category-heading">Categories<br/></div><div class="w-dyn-list"><div role="list" class="blog-category-sidebar-list w-dyn-items"><div role="listitem" class="w-dyn-item"><a href="/blog-categories/threat-analysis" class="category-sidebar-item">Threat Analysis</a></div></div></div></div><div class="sidebar-cta"><h4 class="sidebar-cta-heading w-condition-invisible w-dyn-bind-empty"></h4><h4 class="sidebar-cta-heading">See Huntress in action</h4><div class="sidebar-cta-text w-condition-invisible w-dyn-bind-empty"></div><div class="sidebar-cta-text"><p>Our platform combines a suite of powerful managed detection and response tools for endpoints and Microsoft 365 identities, science-backed security awareness training, and the expertise of our 24/7 Security Operations Center (SOC).</p></div><div class="w-condition-invisible"><a href="#" class="primary-button hero small w-button"></a></div><div><a href="/demo" class="primary-button hero small w-button" rel="  ">Book a Demo</a></div></div><div class="blog-social-icons horizontal"><div class="socials-text">Share</div><div class="social-grid horizontal"><a data-share-facebook="true" href="https://www.facebook.com/sharer/sharer.php?u=https://www.huntress.com/blog/ave-maria-and-the-chambers-of-warzone-rat" class="social-links-icons facebook w-inline-block" target="_blank"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F124e49f43fd041659989deffd90e3b7c" loading="eager" alt="Facebook icon" class="social-links-icons"/></a><a data-share-twitter="true" href="https://twitter.com/share?url=https://www.huntress.com/blog/ave-maria-and-the-chambers-of-warzone-rat" class="social-links-icons twitter w-inline-block" target="_blank"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa59264f69adf4a4cb0092faaf95a5669" loading="eager" alt="Twitter X icon" class="social-links-icons"/></a><a data-share-linkedin="true" href="https://www.linkedin.com/shareArticle?mini=true&amp;amp;url=https://www.huntress.com/blog/ave-maria-and-the-chambers-of-warzone-rat" class="social-links-icons linkedin w-inline-block" target="_blank"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a9064f27e10467cae2ee3bd79beead9" loading="eager" alt="Linkedin icon" class="social-links-icons"/></a><a data-share-reddit="true" href="http://www.reddit.com/submit?url=https://www.huntress.com/blog/ave-maria-and-the-chambers-of-warzone-rat" class="social-links-icons reddit w-inline-block" target="_blank"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff043c73bb2de45c6b1102fe11ffebedb" loading="eager" alt="Download icon" class="social-links-icons"/></a></div></div></div></div></div></div></section></div><div class="builder-block builder-2b27cff7899944738e3b3d18be93d1f3 builder-has-component css-4hp89i" builder-id="builder-2b27cff7899944738e3b3d18be93d1f3"><section class="related-resources-section blog-related-resources-section"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F97d1ebf9f67945c9af2c6341e585bc21" loading="lazy" alt="Glitch effect" class="related-glitch-top-right"/><div class="w-layout-blockcontainer container-1304 w-container"><div class="related-resources-div-block"><h2 class="heading-7">You Might Also Like</h2><p class="paragraph-9"></p></div></div><div class="w-layout-blockcontainer container-1304 w-container"><div><div id="w-node-_4d86426b-a059-499f-3630-0a5865df107c-b9c729ba" class="w-dyn-list"><div role="list" class="related-resources-block-box w-dyn-items"><div role="listitem" class="flex-column w-dyn-item"><a href="/blog/the-hunt-for-redcurl-2" class="br10 blog-listing-box w-inline-block"><div class="related-resources-thumbnail-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F28e05784f2584d25824e4b27c802f97a" alt="Huntress Cybersecurity" class="related-resources-box-image pos-absolute w-condition-invisible"/><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7cec99d221cc47fc945c3f1eadc23962" alt="" class="related-resources-box-image pos-absolute"/></div><div class="related-resources-div-wrap related-resources-block-mini height-100"><h4 class="heading-8 blog-heading">The Hunt for RedCurl</h4><div data-w-id="4d86426b-a059-499f-3630-0a5865df1086" class="secondary-button-4 blog-button"><div class="secodnary-button-text-6">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="secondary-button-icon-2 blog-secondary-button-icon-2" style="transform:translate3d(0px, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg);transform-style:preserve-3d"/></div></div></a></div><div role="listitem" class="flex-column w-dyn-item"><a href="/blog/know-thy-enemy-a-novel-november-case-on-persistent-remote-access" class="br10 blog-listing-box w-inline-block"><div class="related-resources-thumbnail-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F28e05784f2584d25824e4b27c802f97a" alt="Huntress Cybersecurity" class="related-resources-box-image pos-absolute w-condition-invisible"/><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7345981665e34e4780ff76dcd1e1714f" alt="" class="related-resources-box-image pos-absolute"/></div><div class="related-resources-div-wrap related-resources-block-mini height-100"><h4 class="heading-8 blog-heading">Know Thy Enemy: A Novel November Case on Persistent Remote Access</h4><div data-w-id="4d86426b-a059-499f-3630-0a5865df1086" class="secondary-button-4 blog-button"><div class="secodnary-button-text-6">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="secondary-button-icon-2 blog-secondary-button-icon-2" style="transform:translate3d(0px, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg);transform-style:preserve-3d"/></div></div></a></div><div role="listitem" class="flex-column w-dyn-item"><a href="/blog/you-can-run-but-you-cant-hide-defender-exclusions" class="br10 blog-listing-box w-inline-block"><div class="related-resources-thumbnail-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F28e05784f2584d25824e4b27c802f97a" alt="Huntress Cybersecurity" class="related-resources-box-image pos-absolute w-condition-invisible"/><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb4ebc0447fc34db1a4ca274e87f1ca92" alt="" class="related-resources-box-image pos-absolute"/></div><div class="related-resources-div-wrap related-resources-block-mini height-100"><h4 class="heading-8 blog-heading">You Can Run, but You Cant Hide: Defender Exclusions</h4><div data-w-id="4d86426b-a059-499f-3630-0a5865df1086" class="secondary-button-4 blog-button"><div class="secodnary-button-text-6">Learn More</div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F779e332a141048329fb98c924119138a" loading="lazy" alt="" class="secondary-button-icon-2 blog-secondary-button-icon-2" style="transform:translate3d(0px, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg);transform-style:preserve-3d"/></div></div></a></div></div></div></div></div><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fe4c269018ce94700a59e351c5b9edb99" loading="lazy" alt="" class="related-resources-shap-1 desktop blog-related-glitch"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1aa59311842f4ca6bda70300ff181cf9" loading="lazy" alt="" class="related-resources-shap-7"/><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9ad6bcb77d1842b98142269ef70c4f47" loading="lazy" alt="" class="related-resources-shap-6"/></section></div><div class="builder-block builder-0f50d623022042208a513ab79514b79b builder-has-component css-4hp89i" builder-id="builder-0f50d623022042208a513ab79514b79b"><section data-w-id="f6544d89-ec66-1206-8508-b30ad6592c68" style="opacity:1;transform:translate3d(0px, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg);transform-style:preserve-3d" class="call-to-action-section"><div class="w-layout-blockcontainer container-width-1286 bg-container-mobile md-px-20 w-container"><div class="gradient-blue-green-2 cta-gradient-blue-green"><div class="latest-resources-feature-post"><div class="latest-resources-feature-post-description lg:pr-10"><h2 class="latest-resources-sub-heading-2 cta-latest-resources-sub-heading">Sign Up for Huntress Updates</h2><p class="paragraph-large margin-bottom-52">Get insider access to Huntress tradecraft, killer events, and the freshest blog updates.</p><div class="w-full "><div class="_formWrap_qzntk_24"><div class=""><div class="_form_qzntk_1 pt-5 pb-0 px-0"><form id="wf-form-Blog-Signup-Form" name="wf-form-Blog-Signup-Form" data-hs-cf-bound="false" data-hubspot-form-id="5198e52f-a296-4d78-935d-fe864d69a67a" class="_formGrid_qzntk_106"><div class="_formGroup_qzntk_115 _colspan2_qzntk_129"><div class="_wrapper_1ark4_1"><input type="email" class="_input_1ark4_7" aria-invalid="false" id="email" autoComplete="email" data-snowplow-fieldname="email" data-ignore-nb="true" name="email" value=""/><label class="_label_1ark4_28">Work Email*</label></div></div><div class="_formGroup_qzntk_115 _colspan2_qzntk_129"><div class="_submitButtonRow_qzntk_133"><div><div id="cf-turnstile" style="width:300px;height:65px"></div> <div></div></div><button class="_primaryButton_1tx4z_1 _submitButton_qzntk_133 " aria-label="Submit" type="submit" id="submitButton"><div class="_buttonText_1tx4z_83">Submit</div></button></div></div><div class="_formGroup_qzntk_115 _colspan2_qzntk_129"><div class="_privacyPolicy_qzntk_182">By submitting this form, you accept our<!-- --> <a class="_noWrap_qzntk_249" href="/terms-of-use" target="_blank" data-discover="true">Terms of Service</a> <!-- -->&amp;<!-- --> <a class="_noWrap_qzntk_249" href="/privacy-policy" target="_blank" data-discover="true">Privacy Policy</a></div></div><input type="hidden" data-io-platform-fieldname="user[correlation_id]" data-snowplow-fieldname="correlation_id" name="correlation_id" value="403a4d89-5852-48f5-87d4-9cd665522e6b"/><input type="hidden" data-io-platform-fieldname="user[utm_source]" name="utm_source" value=""/><input type="hidden" data-io-platform-fieldname="user[utm_medium]" name="utm_medium" value=""/><input type="hidden" data-io-platform-fieldname="user[utm_campaign]" name="utm_campaign" value=""/><input type="hidden" data-io-platform-fieldname="user[utm_content]" name="utm_content" value=""/><input type="hidden" data-io-platform-fieldname="user[utm_keyword]" name="utm_keyword" value=""/><input type="hidden" name="page_url" value=""/><input type="hidden" name="pageUri" value=""/><input type="hidden" name="hutk" value=""/></form></div></div><div class="text-pretty md:text-balance subscribe-success-state _successState_qzntk_197 " tabindex="-1" role="region" aria-label="Schedule a demo success"><div>Thank you! Your submission has been received!</div></div><div class="text-pretty md:text-balance error-message-alt _errorMessage_qzntk_217 " tabindex="-1" role="region" aria-label="Schedule a demo failure"><div>Oops! Something went wrong while submitting the form.</div></div></div></div></div><div class="latest-resources-feature-post-image-wrapper cta-latest-resources-feature-post-image-wrapper"><img loading="lazy" src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcb5efa5143804ba59d530a903d29fe5f" alt="Huntress at work" class="latest-resources-feature-post-image cta-latest-resources-feature-post-image"/></div></div></div></div></section></div><style data-emotion-css="191e8qc">.css-191e8qc.builder-block{height:0;width:0;display:inline-block;opacity:0;overflow:hidden;pointer-events:none;}</style><img src="https://cdn.builder.io/api/v1/pixel?apiKey=3eb6f92aedf74f109c7b4b0897ec39a8" aria-hidden="true" alt="" role="presentation" width="0" height="0" class="builder-block builder-pixel-g1oymuaar66 css-191e8qc" builder-id="builder-pixel-g1oymuaar66"/></div></div></div></div></div><div><footer class="footer"><div class="w-layout-blockcontainer primary-container w-container"><div class="footer-inner-grid footer-inner-four-grid"><div data-hover="false" data-delay="0" id="w-node-_8db5101a-d165-e0e7-c7a6-e04b30595352-3059534f" data-w-id="8db5101a-d165-e0e7-c7a6-e04b30595352" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-5" aria-controls="w-dropdown-list-5" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">Platform</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-5" aria-labelledby="w-dropdown-toggle-5"><a href="/platform" class="footer-nav-item" tabindex="0">Huntress Managed Security Platform</a><a href="/platform/managed-edr" aria-current="page" class="footer-nav-item w--current" tabindex="0">Managed EDR</a><a href="/platform/managed-edr-for-macos" class="footer-nav-item" tabindex="0">Managed EDR for macOS</a><a href="/platform/managed-itdr" class="footer-nav-item" tabindex="0">Managed ITDR</a><a href="/platform/siem" class="footer-nav-item" tabindex="0">Managed SIEM</a><a href="/platform/security-awareness-training" class="footer-nav-item" tabindex="0">Managed Security Awareness Training</a><a href="/demo" class="footer-nav-item" tabindex="0">Book A Demo</a></nav></div><div data-hover="false" data-delay="0" data-w-id="8db5101a-d165-e0e7-c7a6-e04b3059535b" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-6" aria-controls="w-dropdown-list-6" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">Solutions</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-6" aria-labelledby="w-dropdown-toggle-6"><a href="/solutions/topics/phishing" class="footer-nav-item" tabindex="0">Phishing</a><a href="/solutions/topics/cybersecurity-compliance" class="footer-nav-item" tabindex="0">Compliance</a><a href="/solutions/topics/business-email-compromise" class="footer-nav-item" tabindex="0">Business Email Compromise</a><a href="/industries/education" class="footer-nav-item" tabindex="0">Education</a><a href="/industries/financial-services" class="footer-nav-item" tabindex="0">Finance</a><a href="/industries/healthcare" class="footer-nav-item" tabindex="0">Healthcare</a><a href="/industries/manufacturing" class="footer-nav-item" tabindex="0">Manufacturing</a><a href="/industries/state-and-local-government" class="footer-nav-item" tabindex="0">State &amp; Local Government</a></nav></div><div data-hover="false" data-delay="0" data-w-id="8db5101a-d165-e0e7-c7a6-e04b30595364" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-7" aria-controls="w-dropdown-list-7" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">Why Huntress?</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-7" aria-labelledby="w-dropdown-toggle-7"><a href="/why-huntress/managed-service-providers" class="footer-nav-item" tabindex="0">Managed Service Providers</a><a href="/why-huntress/value-added-resellers" class="footer-nav-item" tabindex="0">Value Added Resellers</a><a href="/why-huntress/businesses-it-teams" class="footer-nav-item" tabindex="0">Business &amp; ITTeams</a><a href="/why-huntress/24-7-soc" class="footer-nav-item" tabindex="0">24/7 SOC</a><a href="/success-stories" class="footer-nav-item" tabindex="0">Case Studies</a></nav></div><div data-hover="false" data-delay="0" data-w-id="8db5101a-d165-e0e7-c7a6-e04b3059536d" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-8" aria-controls="w-dropdown-list-8" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">Resources</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-8" aria-labelledby="w-dropdown-toggle-8"><a href="/resources" class="footer-nav-item" tabindex="0">Resource Center</a><a href="/blog" class="footer-nav-item" tabindex="0">Blog</a><a href="/upcoming-events" class="footer-nav-item" tabindex="0">Upcoming Events</a><a href="https://support.huntress.io/hc/en-us" target="_blank" class="footer-nav-item" tabindex="0">Support Documentation</a></nav></div><div data-hover="false" data-delay="0" data-w-id="8db5101a-d165-e0e7-c7a6-e04b3059537c" class="footer-col w-dropdown"><div class="footer-title-container w-dropdown-toggle " id="w-dropdown-toggle-9" aria-controls="w-dropdown-list-9" aria-haspopup="menu" aria-expanded="true" role="button" tabindex="0"><h5 class="footer-title">About</h5><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fec8c1f5fc9134c75bd9877ca0323392a" loading="lazy" alt="down arrow" class="footer-caret"/></div><nav class="footer-nav-item-container w-dropdown-list footer-column " id="w-dropdown-list-9" aria-labelledby="w-dropdown-toggle-9"><a href="/company/our-company" class="footer-nav-item" tabindex="0">Our Company</a><a href="/company/leadership" class="footer-nav-item" tabindex="0">Leadership</a><a href="/company/press" class="footer-nav-item" tabindex="0">News &amp; Press</a><a href="/company/careers" class="footer-nav-item" tabindex="0">Careers</a><a href="/contact-us" class="footer-nav-item" tabindex="0">Contact Us</a></nav></div></div><div id="w-node-_8db5101a-d165-e0e7-c7a6-e04b3059538b-3059534f" class="footer-gradient-line"></div><div class="footer-copyright-grid"><div id="w-node-_8db5101a-d165-e0e7-c7a6-e04b3059538d-3059534f" class="fcg-col"><a href="/" class="footer-brand w-inline-block"><img src="https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff8b2e3c89b5046b89682ef20ccb7218d" loading="lazy" alt="Hunteress white logo"/></a></div><div id="w-node-_8db5101a-d165-e0e7-c7a6-e04b30595390-3059534f" class="fcg-col md-order-2"><div class="extra-small-paragraph"> 2025 Huntress All Rights Reserved.</div><div class="fcg-cta-group"><a href="/privacy-policy" target="_blank" class="fcg-cta">Privacy Policy</a><div class="fcg-seperator">|</div><a href="/cookie-policy" target="_blank" class="fcg-cta">Cookie Policy</a><div class="fcg-seperator">|</div><a href="/terms-of-use" target="_blank" class="fcg-cta">Terms of Use</a></div></div><div id="w-node-_8db5101a-d165-e0e7-c7a6-e04b3059539a-3059534f" class="fcg-col md-order-3"><a id="free_trial_footer_button" href="/start-trial" class="primary-button footer-cta w-button">Free Trial</a></div></div></div></footer></div><script>((storageKey2, restoreKey) => {
    if (!window.history.state || !window.history.state.key) {
      let key = Math.random().toString(32).slice(2);
      window.history.replaceState({ key }, "");
    }
    try {
      let positions = JSON.parse(sessionStorage.getItem(storageKey2) || "{}");
      let storedY = positions[restoreKey || window.history.state.key];
      if (typeof storedY === "number") {
        window.scrollTo(0, storedY);
      }
    } catch (error) {
      console.error(error);
      sessionStorage.removeItem(storageKey2);
    }
  })("react-router-scroll-positions", null)</script><script>window.__reactRouterContext = {"basename":"/","future":{"unstable_optimizeDeps":false,"unstable_splitRouteModules":false,"unstable_viteEnvironmentApi":false},"ssr":true,"isSpaMode":false};window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());</script><script type="module" async="">;
import * as route0 from "/assets/root-BJQOHjsi.js";
import * as route1 from "/assets/blog._slug-DmNEJyyc.js";
  window.__reactRouterManifest = {
  "entry": {
    "module": "/assets/entry.client-m4_Zd7NT.js",
    "imports": [
      "/assets/chunk-HA7DTUK3-BpyMo6tN.js",
      "/assets/index-DqyGAN61.js"
    ],
    "css": []
  },
  "routes": {
    "root": {
      "id": "root",
      "path": "",
      "hasAction": false,
      "hasLoader": true,
      "hasClientAction": false,
      "hasClientLoader": false,
      "hasErrorBoundary": true,
      "module": "/assets/root-BJQOHjsi.js",
      "imports": [
        "/assets/chunk-HA7DTUK3-BpyMo6tN.js",
        "/assets/index-DqyGAN61.js",
        "/assets/with-props-Dkp9k_PK.js",
        "/assets/snowplow.tracker-Dy_wB_IJ.js"
      ],
      "css": [
        "/assets/root-DOhbAGIK.css",
        "/assets/snowplow-BwfoH6KX.css"
      ]
    },
    "routes/blog.$slug": {
      "id": "routes/blog.$slug",
      "parentId": "root",
      "path": "blog/:slug",
      "hasAction": false,
      "hasLoader": true,
      "hasClientAction": false,
      "hasClientLoader": false,
      "hasErrorBoundary": false,
      "module": "/assets/blog._slug-DmNEJyyc.js",
      "imports": [
        "/assets/with-props-Dkp9k_PK.js",
        "/assets/chunk-HA7DTUK3-BpyMo6tN.js",
        "/assets/snowplow.tracker-Dy_wB_IJ.js",
        "/assets/metadata-DUociWgO.js",
        "/assets/index-DqyGAN61.js"
      ],
      "css": [
        "/assets/snowplow-BwfoH6KX.css",
        "/assets/metadata-q413g75i.css"
      ]
    },
    "routes/($slug)._index": {
      "id": "routes/($slug)._index",
      "parentId": "root",
      "path": ":slug?",
      "index": true,
      "hasAction": false,
      "hasLoader": true,
      "hasClientAction": false,
      "hasClientLoader": false,
      "hasErrorBoundary": false,
      "module": "/assets/(_slug)._index-D8wRYfw3.js",
      "imports": [
        "/assets/with-props-Dkp9k_PK.js",
        "/assets/chunk-HA7DTUK3-BpyMo6tN.js",
        "/assets/snowplow.tracker-Dy_wB_IJ.js",
        "/assets/metadata-DUociWgO.js",
        "/assets/index-DqyGAN61.js"
      ],
      "css": [
        "/assets/snowplow-BwfoH6KX.css",
        "/assets/metadata-q413g75i.css"
      ]
    },
    "routes/blog._index": {
      "id": "routes/blog._index",
      "parentId": "root",
      "path": "blog",
      "index": true,
      "hasAction": false,
      "hasLoader": true,
      "hasClientAction": false,
      "hasClientLoader": false,
      "hasErrorBoundary": false,
      "module": "/assets/blog._index-CcAa_WWh.js",
      "imports": [
        "/assets/with-props-Dkp9k_PK.js",
        "/assets/chunk-HA7DTUK3-BpyMo6tN.js",
        "/assets/snowplow.tracker-Dy_wB_IJ.js",
        "/assets/metadata-DUociWgO.js",
        "/assets/index-DqyGAN61.js"
      ],
      "css": [
        "/assets/snowplow-BwfoH6KX.css",
        "/assets/metadata-q413g75i.css"
      ]
    }
  },
  "url": "/assets/manifest-11957257.js",
  "version": "11957257"
};
  window.__reactRouterRouteModules = {"root":route0,"routes/blog.$slug":route1};

import("/assets/entry.client-m4_Zd7NT.js");</script><!--$?--><template id="B:0"></template><!--/$--><div hidden id="S:0"><script>window.__reactRouterContext.streamController.enqueue("[{\"_1\":2,\"_320\":-5,\"_321\":-5},\"loaderData\",{\"_3\":-7,\"_4\":5},\"root\",\"routes/blog.$slug\",{\"_6\":7,\"_158\":177,\"_298\":299,\"_318\":319},\"page\",{\"_8\":9,\"_10\":11,\"_12\":13,\"_14\":15,\"_16\":17,\"_18\":18,\"_19\":20,\"_34\":35,\"_45\":46,\"_161\":162,\"_163\":164,\"_165\":11,\"_166\":167,\"_168\":169,\"_170\":171,\"_172\":171,\"_173\":174,\"_175\":176},\"folders\",[],\"createdDate\",1737878646725,\"id\",\"65f3299e49a461b4b9c729ba\",\"name\",\"Blog Post\",\"modelId\",\"3fa669f9656b425bbe84446dd9c5a7cd\",\"published\",\"meta\",{\"_21\":6,\"_22\":23,\"_24\":25,\"_32\":33},\"kind\",\"lastPreviewUrl\",\"https://staging.huntress.com/blog/(slug)?builder.space=3eb6f92aedf74f109c7b4b0897ec39a8\u0026builder.user.permissions=read%2Ccreate%2Cpublish%2CeditCode%2CeditDesigns%2Cadmin%2CeditLayouts%2CeditLayers%2CeditContentPriority\u0026builder.user.role.name=Admin\u0026builder.user.role.id=admin\u0026builder.cachebust=true\u0026builder.preview=page\u0026builder.noCache=true\u0026builder.allowTextEdit=true\u0026__builder_editing__=true\u0026builder.overrides.page=65f3299e49a461b4b9c729ba\u0026builder.overrides.65f3299e49a461b4b9c729ba=65f3299e49a461b4b9c729ba\u0026builder.overrides.page:/blog/(slug)=65f3299e49a461b4b9c729ba\u0026builder.options.includeRefs=true\u0026builder.options.enrich=true\",\"breakpoints\",{\"_26\":27,\"_28\":29,\"_30\":31},\"xsmall\",479,\"small\",767,\"medium\",991,\"hasLinks\",false,\"query\",[36],{\"_37\":38,\"_39\":40,\"_41\":42,\"_43\":44},\"@type\",\"@builder.io/core:Query\",\"property\",\"urlPath\",\"operator\",\"is\",\"value\",\"/blog/(slug)\",\"data\",{\"_47\":48,\"_49\":48,\"_50\":51,\"_52\":48,\"_53\":48,\"_54\":44,\"_55\":48,\"_56\":48,\"_57\":48,\"_58\":59,\"_150\":151},\"title\",\"\",\"slug\",\"templateDataModel\",\"blog-posts\",\"description\",\"openGraphDescription\",\"url\",\"titleTag\",\"metaDescription\",\"openGraphTitle\",\"blocks\",[60,94,103,127],{\"_37\":61,\"_62\":63,\"_12\":64,\"_65\":66,\"_80\":81},\"@builder.io/sdk:Element\",\"@version\",2,\"builder-ddebc027a2b547be8bb340dc4719efa5\",\"component\",{\"_14\":67,\"_68\":69},\"BlogBannerSection\",\"options\",{\"_70\":71,\"_72\":73,\"_74\":75,\"_76\":77,\"_78\":79},\"_data\",\"hunting-for-m365-password-spraying\",\"SidebarCtaHeading\",\"See Huntress in action\",\"SidebarCtaText\",\"\u003cp\u003eOur platform combines a suite of powerful managed detection and response tools for endpoints and Microsoft 365 identities, science-backed security awareness training, and the expertise of our 24/7 Security Operations Center (SOC).\u003c/p\u003e\",\"SidebarCtaButtonText\",\"Book a Demo\",\"SidebarCtaButtonUrl\",\"/demo\",\"responsiveStyles\",{\"_82\":83},\"large\",{\"_84\":85,\"_86\":87,\"_88\":89,\"_90\":91,\"_92\":93},\"display\",\"flex\",\"flexDirection\",\"column\",\"position\",\"relative\",\"flexShrink\",\"0\",\"boxSizing\",\"border-box\",{\"_37\":61,\"_62\":63,\"_12\":95,\"_65\":96,\"_80\":101},\"builder-2b27cff7899944738e3b3d18be93d1f3\",{\"_14\":97,\"_68\":98},\"BlogRelatedResourcesSection\",{\"_99\":100},\"heading\",\"You Might Also Like\",{\"_82\":102},{\"_84\":85,\"_86\":87,\"_88\":89,\"_90\":91,\"_92\":93},{\"_37\":61,\"_62\":63,\"_12\":104,\"_65\":105,\"_80\":125},\"builder-0f50d623022042208a513ab79514b79b\",{\"_14\":106,\"_68\":107},\"BlogSignupSection\",{\"_99\":108,\"_109\":110,\"_111\":112,\"_113\":114},\"Sign Up for Huntress Updates\",\"summary\",\"Get insider access to Huntress tradecraft, killer events, and the freshest blog updates.\",\"image\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fcb5efa5143804ba59d530a903d29fe5f\",\"blogSignupForm\",{\"_115\":116,\"_117\":33,\"_118\":119,\"_120\":121,\"_122\":33,\"_123\":33,\"_124\":33},\"formId\",\"wf-form-Blog-Signup-Form\",\"showFormTitle\",\"submitButtonText\",\"Submit\",\"hubspotFormId\",\"5198e52f-a296-4d78-935d-fe864d69a67a\",\"showBlueGreenGradient\",\"showBluePurpleGradient\",\"useNeverBounce\",{\"_82\":126},{\"_84\":85,\"_86\":87,\"_88\":89,\"_90\":91,\"_92\":93},{\"_12\":128,\"_37\":61,\"_129\":130,\"_131\":132,\"_80\":142},\"builder-pixel-g1oymuaar66\",\"tagName\",\"img\",\"properties\",{\"_133\":134,\"_135\":136,\"_137\":48,\"_138\":139,\"_140\":91,\"_141\":91},\"src\",\"https://cdn.builder.io/api/v1/pixel?apiKey=3eb6f92aedf74f109c7b4b0897ec39a8\",\"aria-hidden\",\"true\",\"alt\",\"role\",\"presentation\",\"width\",\"height\",{\"_82\":143},{\"_141\":91,\"_140\":91,\"_84\":144,\"_145\":91,\"_146\":147,\"_148\":149},\"inline-block\",\"opacity\",\"overflow\",\"hidden\",\"pointerEvents\",\"none\",\"state\",{\"_152\":82,\"_153\":154},\"deviceSize\",\"location\",{\"_155\":44,\"_156\":157,\"_34\":160},\"pathname\",\"path\",[158,159],\"blog\",\"(slug)\",{},\"variations\",{},\"lastUpdated\",1741588976692,\"firstPublished\",\"testRatio\",1,\"screenshot\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F42ecb2c04afd4f21884c74eac157f836\",\"createdBy\",\"Kz459QsZDzNpORbTSiA9L6WRQc23\",\"lastUpdatedBy\",\"rev\",\"y7fqe69xig8\",\"template\",\"huntress\",{\"_34\":178,\"_8\":179,\"_10\":180,\"_12\":181,\"_14\":182,\"_16\":183,\"_18\":18,\"_19\":184,\"_45\":186,\"_161\":294,\"_163\":295,\"_165\":180,\"_166\":167,\"_170\":296,\"_172\":296,\"_173\":297},[],[],1742717208144,\"65f3299e49a461b4b9c72d9e\",\"Ave Maria and the Chambers of Warzone RAT\",\"beafe50240af45639f2b59e6aefd89f9\",{\"_22\":48,\"_24\":185,\"_21\":45},{\"_26\":27,\"_28\":29,\"_30\":31},{\"_187\":188,\"_14\":182,\"_259\":260,\"_261\":262,\"_282\":283,\"_284\":33,\"_278\":285,\"_286\":287,\"_202\":288,\"_49\":291,\"_292\":293},\"authors\",[189],{\"_190\":191},\"author\",{\"_37\":192,\"_12\":193,\"_194\":195,\"_43\":196},\"@builder.io/core:Reference\",\"66048bf3351a788121c616ae\",\"model\",\"people\",{\"_12\":193,\"_14\":197,\"_18\":18,\"_10\":198,\"_16\":199,\"_45\":200,\"_173\":258},\"Chad Hudson\",1742719368644,\"d50b5ec346a64579b280b4104dca236e\",{\"_14\":197,\"_49\":201,\"_202\":203,\"_209\":210,\"_211\":-5,\"_212\":213,\"_214\":215,\"_216\":217,\"_218\":219,\"_220\":221,\"_222\":223},\"chad-hudson\",\"metadata\",{\"_47\":204,\"_52\":205,\"_206\":207,\"_208\":207},\"Chad Hudson | Huntress\",\"Read blog posts from Chad Hudson on the Huntress Blog.\",\"noIndex\",true,\"noFollow\",\"profileImage\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F833407826677436f8a7753fbb9f0b3ea\",\"profileImageAltText\",\"jobTitle\",\"Manager, Security Operations Center, AUS\",\"bioDetail\",\"\u003cp id=\\\"\\\"\u003e\u003cstrong id=\\\"\\\"\u003eTurning childhood curiosity into cybersecurity expertise.\u003c/strong\u003e\u003c/p\u003e\u003cp id=\\\"\\\"\u003eChad Hudson's journey into the world of computers began at a young age, inspired by his father's passion for technology. \\\"I had always been around computers while growing up,\\\" Chad recalls. \\\"My dad was an avid hobbyist into computers and tech. Eventually, it rubbed off onto me and I started copying him as a child and got involved with computers.\\\"\u003c/p\u003e\u003cp id=\\\"\\\"\u003eAt Huntress, Chad specializes in the Security Operations Center (SOC) and Hunt \u0026amp; Response. His role involves staying vigilant against cyber threats and responding swiftly to security incidents targeting small and medium-sized businesses. \\\"Working at Huntress gives me all the warm and fuzzies, knowing we're out here being the cyber 'superheroes' for the SMBs,\\\" he says. \\\"It's satisfying waking up each day knowing we're the ones stopping threat actors attempting to punish hardworking companies for a quick buck.\\\"\u003c/p\u003e\u003cp id=\\\"\\\"\u003e\u003cstrong id=\\\"\\\"\u003eWhat's your favorite cybersecurity tip, Chad?\u003c/strong\u003e\u003c/p\u003e\u003cp id=\\\"\\\"\u003e\\\"\u003cstrong id=\\\"\\\"\u003eThink before you click.\u003c/strong\u003e Working in a SOC and contributing to the hunts, a main method I see users falling for is social engineering attacks such as phishing. It's better to take your time when reviewing your emails, going to web pages, and downloading content. In the long run, a few extra seconds of caution can save a world of trouble!\\\"\u003c/p\u003e\u003cp id=\\\"\\\"\u003eGo ahead and give Chad a follow on X: \u003ca href=\\\"https://x.com/0xBurgers\\\"\u003e@0xBurgers\u003c/a\u003e\u003c/p\u003e\u003cp id=\\\"\\\"\u003e\u003c/p\u003e\",\"companyName\",\"Huntress\",\"linkedInUrl\",\"https://www.linkedin.com/in/chadhudsoncybersec/\",\"xTwitterUrl\",\"https://x.com/0xBurgers\",\"groups\",[224,243],{\"_225\":226},\"group\",{\"_37\":192,\"_12\":227,\"_194\":222,\"_43\":228},\"00d1d80145b14a6b87c45567b169a8f4\",{\"_34\":229,\"_8\":230,\"_10\":231,\"_12\":227,\"_14\":232,\"_16\":233,\"_18\":18,\"_19\":234,\"_45\":238,\"_161\":239,\"_163\":240,\"_165\":241,\"_166\":167,\"_170\":171,\"_172\":171,\"_173\":242},[],[],1735687100903,\"Authors\",\"8749400659754b178d5088546f7b2f6f\",{\"_24\":235,\"_21\":45,\"_22\":48},{\"_28\":236,\"_30\":237},478,1023,{\"_14\":232},{},1735687106469,1735687106464,\"8x1hue3o804\",{\"_225\":244},{\"_37\":192,\"_12\":245,\"_194\":222,\"_43\":246},\"babc0d8823f34ab894a4431d5b302dc7\",{\"_34\":247,\"_8\":248,\"_10\":249,\"_12\":245,\"_14\":250,\"_16\":233,\"_18\":18,\"_19\":251,\"_45\":253,\"_161\":254,\"_163\":255,\"_165\":256,\"_166\":167,\"_170\":171,\"_172\":171,\"_173\":257},[],[],1742334085525,\"Speakers\",{\"_24\":252,\"_21\":45,\"_22\":48},{\"_26\":27,\"_28\":29,\"_30\":31},{\"_14\":250},{},1742334347573,1742334347569,\"uxa663jc9u\",\"qo1uy41ihzo\",\"content\",\"\u003cp\u003eFriday, September 30, 2022, seemed a day like any other--until a large amount of PowerShell malware came charging through seeking immediate attention. Sparing no time, I jumped right in.\u003c/p\u003e\u003cp\u003e\u0026nbsp;\u003cbr\u003e\u003c/p\u003e\u003cp\u003eAt first, this was troubling. Are the detectors working?? Is something broken?? In order to verify our detector 'ExecutionFromEnvironmentVariable' had triggered correctly for all these autoruns, I did a quick search:\u003c/p\u003e\u003cp\u003e\u003cspan class=\\\"highlight\\\"\u003e\u003cstrong\u003edetails.path:powershell.exe +details.command:\\\"GetEnvironmentVariable\\\"\u003c/strong\u003e\u003c/span\u003e\u003c/p\u003e\u003cp\u003eThis gave the result for \u003cem\u003e40 \u003c/em\u003eautoruns.  \u003cstrong\u003e\u003cem\u003e*cracks knuckles*\u003c/em\u003e\u003c/strong\u003e\u0026nbsp; Time to get down to business.\u003c/p\u003e\u003cblockquote\u003ePro Tip: Doing a quick search helps analysts develop a better understanding of the \u003ca href=\\\"https://www.elastic.co/guide/en/elasticsearch/reference/5.6/query-dsl-query-string-query.html#query-string-syntax\\\" target=\\\"_blank\\\"\u003eElastic search syntax\u003c/a\u003e. This gives analysts a better understanding of common characteristics and could potentially assist in finding additional footholds.\u0026nbsp;\u003c/blockquote\u003e\u003cp\u003eNow let's dive into the autorun we are checking out.\u0026nbsp;\u003c/p\u003e\u003cp\u003eWe can see \u003cspan class=\\\"highlight\\\"\u003e\u003cstrong\u003eGetEnvironmentVariable('60493fbacedcfbcabe', 'User')\u003c/strong\u003e\u003c/span\u003e along with the User Run Key \u003cspan class=\\\"highlight\\\"\u003e\u003cstrong\u003eName\u003c/strong\u003e\u003c/span\u003e. They both use a Base-16 (HEX) formatting, which means alphabetic characters of \u003cspan class=\\\"highlight\\\"\u003e\u003cstrong\u003eA - F\u003c/strong\u003e\u003c/span\u003e and numbers \u003cspan class=\\\"highlight\\\"\u003e\u003cstrong\u003e0 - 9\u003c/strong\u003e\u003c/span\u003e with a \u003cspan class=\\\"highlight\\\"\u003e\u003cstrong\u003elength of 12 to 18\u003c/strong\u003e\u003c/span\u003e. Using \u003ca href=\\\"https://regexr.com/\\\" target=\\\"_blank\\\"\u003eregex \u003c/a\u003ewe can use \u003cspan class=\\\"highlight\\\"\u003e\u003cstrong\u003e[a-f0-9]{12,18}\u003c/strong\u003e\u003c/span\u003e.\u0026nbsp;\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2386px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2386px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Febe39b52044f447f81e7ad3609a77ff3\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eNow, on to implementing our findings in RIOs data within ELK. We use a similar but modified search query (seen below) which provided six additional hits. This information tells us this is an \u003cem\u003eactive threat\u003c/em\u003e still present on the host. Read: time is of the essence.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003e\u003cspan class=\\\"highlight\\\"\u003e+process.command_line.text:\\\"GetEnvironmentVariable\\\" \u0026nbsp;+process.command_line.text:/[a-f0-9]{12,18}/\u003c/span\u003e\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eReviewing the Foothold Details, we are able to see the persistence created within the Hive Current Users Run Key. \u003cstrong class=\\\"highlight\\\"\u003e(HKU\\\\SID\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run)\u003c/strong\u003e\u003c/p\u003e\u003cp\u003eThe command ran by the Users Run Key launches PowerShell and invokes expressions in the \u003ca href=\\\"https://learn.microsoft.com/en-us/previous-versions/windows/desktop/sidebar/system-environment-getenvironmentvariable\\\" target=\\\"_blank\\\"\u003ehost's environments registry\u003c/a\u003e with the value \u003cstrong class=\\\"highlight\\\"\u003e60493fbacedcfbcabe\u003c/strong\u003e.\u0026nbsp;\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2232px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2232px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F088a5fa7b74e4efbaa2701cb28fdab8d\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eFrom here we will take to tasking the user's Hive Current Users Environment: \u003cstrong class=\\\"highlight\\\"\u003e(HKU\\\\SID\\\\Environment)\u003c/strong\u003e. We obtain the next stage within the registry location \u003cstrong class=\\\"highlight\\\"\u003eHKU\\\\SID\\\\Software\\\\\u0026lt;value\u0026gt;\u003c/strong\u003e. \u003cbr\u003e\u003cbr\u003e\u003cstrong\u003eIts important to note\u003c/strong\u003e: \u003cstrong\u003eThese additional registry keys will be required in the report for the customer to remove.\u003c/strong\u003e\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2324px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2324px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F10b1bbd99fdf47199b50cad550c6064c\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eViewing the \u003cstrong\u003e\u003cspan class=\\\"highlight\\\"\u003eHKU\\\\SID\\\\Software\\\\27842badfbdabe\u003c/span\u003e,\u003c/strong\u003e we see four values (default, 0, 1 and 3) which show PowerShell variables and encoding. Save the values 0, 1 and 3 for later and isolate the script for further analysis.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2348px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2348px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fdee16b0ca60b41cc94468cc10f3705bd\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eLets start digging further into the script.\u003c/p\u003e\u003cp\u003eWithin the script, it has encoded variables with Base64, a reverse array that joins the data. What could it be hiding? And make no mistake--it's always hiding something.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2476px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2476px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F99736daaf35d4df4a3b2b04e23512c6d\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eUsing Cyberchef, we can attempt to quickly decode the base64 strings with the formula of \u003cstrong class=\\\"highlight\\\"\u003eSubsection \u003c/strong\u003eand \u003cstrong class=\\\"highlight\\\"\u003eFrombase64\u003c/strong\u003e. This should grab the majority of strings but will still need some manual intervention. This is where analysts come into play.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2294px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2294px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fbfac77ca729e402c99b9317746581a5a\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eAfter replacing the encoded Base64 script, we quickly see it has a key, padding, IV, and other common encryption functions. Lets replace the variables with the corresponding value to make the functions of the script easier to read, thus attempting to reveal the secret embedded within.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2406px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2406px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F387402091ec0419ba6ba3c58b36984ab\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eNow with the script variables replaced, we can see the payload is using AES Encryption using cipher mode \u003ca href=\\\"https://medium.com/asecuritysite-when-bob-met-alice/electronic-code-book-ecb-and-cipher-block-chaining-cbc-e3309d704917\\\" target=\\\"_blank\\\"\u003eElectronic CodeBook (ECB)\u003c/a\u003e, dropping 16 bytes to create the IV, and it has also been compressed.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eNote: Some samples use different cipher modes so make sure to verify this (for example, we have seen ECB and CBC).\u003c/strong\u003e\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2414px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2414px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F31d5c5462c2b4123aec618f243c511ff\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eTo get the IV for our AES encryption, we need to place the payload in Cyberchef. Since we can see the padding \u003cstrong\u003e= \u003c/strong\u003efor Base64, we \u003cstrong\u003ereverse \u003c/strong\u003ethe payload. Then we use \u003cstrong class=\\\"highlight\\\"\u003eFrom Base64\u003c/strong\u003e after which we drop the bytes from 16 bytes (start at 16 and a large length). Now we convert the IV back \u003cstrong class=\\\"highlight\\\"\u003eTo Base64\u003c/strong\u003e. \u003cbr\u003eThis results in our IV: \u003cstrong class=\\\"highlight\\\"\u003eduNJnxEFm0/Nw/W34mpGMg==\u003c/strong\u003e\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2288px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2288px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fea4958deaab34475af16707185a6bcc8\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eLet's combine everything together now. Make sure to \u003cstrong\u003ereverse \u003c/strong\u003ethe payload \u003cstrong class=\\\"highlight\\\"\u003eFrom Base64\u003c/strong\u003e and drop the first \u003cstrong class=\\\"highlight\\\"\u003e16 Bytes\u003c/strong\u003e. With the \u003cstrong class=\\\"highlight\\\"\u003eAES decrypt \u003c/strong\u003ewe require the Base64 Key \u003cstrong class=\\\"highlight\\\"\u003e9fJygHL[...]\u003c/strong\u003e, an IV that was obtained earlier \u003cstrong class=\\\"highlight\\\"\u003eduNJnx[...]\u003c/strong\u003e, then change the \u003cstrong\u003eAES cipher mode to ECB\u003c/strong\u003e, input as \u003cstrong class=\\\"highlight\\\"\u003eRaw\u003c/strong\u003e,and the output as \u003cstrong class=\\\"highlight\\\"\u003eRaw\u003c/strong\u003e. Since the payload has also been compressed we will be required to use \u003cstrong class=\\\"highlight\\\"\u003eRaw Inflate\u003c/strong\u003e to get our final output.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2300px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2300px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd07047bd02f64a16b68991ae50165518\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eWhen inspecting the output we can already see the next stage is another script. This script of the payload is identical to the previous one. This is a rinse-and-repeat stage. Hope you weren't expecting this to be straightforward; that'd be too easy!\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2428px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2428px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F5e9b3723543b47d3ad3fe177c7cdd6de\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eAfter cementing what we just learned, we gain a new output.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2302px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2302px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F379e7d80fbcb441ca4d6d40198dabf0a\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eTo go further, its required to download the payload from a Discord link. This comes down to analysts' choice in how they download malicious samples. \u003cbr\u003e\u003cbr\u003e\u003cstrong\u003eNote: If a script has \u003cspan class=\\\"highlight\\\"\u003eReflection.Assembly\u003c/span\u003e (\u003c/strong\u003e\u003ca href=\\\"https://learn.microsoft.com/en-us/dotnet/api/system.reflection.assembly?view=net-6.0\\\" target=\\\"_blank\\\"\u003e\u003cstrong\u003eassembly\u003c/strong\u003e\u003c/a\u003e\u003cstrong\u003e), this loads a .NET payload. Therefore anytime we see \u003cspan class=\\\"highlight\\\"\u003eReflection.Assembly\u003c/span\u003e we know were dealing with a .NET malware.\u003c/strong\u003e\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2160px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2160px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff23aee3e337e42088a72cb1aa5f9b55d\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eAfter downloading the Discord payload, we will allow the script to do the heavy lifting. We just need to modify parts out of the script after we downloaded and isolated the payload:\u003c/p\u003e\u003cp\u003e\u003cstrong class=\\\"highlight\\\"\u003e[string] $xoredText = Get-Content \\\"C:\\\\\\\\users\\\\\\\\Burgers\\\\\\\\Desktop\\\\\\\\mkv.txt\\\"[io.file]::writeallbytes(\\\"C:\\\\\\\\users\\\\\\\\burgers\\\\\\\\desktop\\\\\\\\mkv_decoded.bin\\\", $bytes)\u003c/strong\u003e\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1914px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1914px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F94000212c94345799c1d49aaa8e92546\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eWith the decoded \u003cstrong\u003emkv_decoded.bin\u003c/strong\u003e its important to still do a quick static analysis of the payload within \u003ca href=\\\"https://www.winitor.com/\\\" target=\\\"_blank\\\"\u003epestudio\u003c/a\u003e. The signature confirms our suspicions of it being .NET. Along with the description and version of the file, it gives us additional information that the payload may be a \u003cstrong\u003enetLoaderDll\u003c/strong\u003e. We also see the entropy is only 2.980, showing this payload may not be packed.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1434px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1434px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7b284b19dd5d4a9eb44e30999259ad73\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eInspecting the netLoaderDll within dnSpy we see a few classes: Main, runPayload and StringToByteArray.\u003c/p\u003e\u003cp\u003e\u0026nbsp;\u003cbr\u003e\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:440px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"440px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F439af2e42764429ab4ad6af2e9c6f5cc\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eThis application stores the next stage of the malware within \u003cstrong class=\\\"highlight\\\"\u003eMain()\u003c/strong\u003e, which we see has a large byte array within it. The netLoaderDll requires \u003cstrong class=\\\"highlight\\\"\u003eStringToByteArray \u003c/strong\u003eto convert the hex to an application and \u003cstrong class=\\\"highlight\\\"\u003erunPayload \u003c/strong\u003ewill launch the next stage.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2082px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2082px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fa27d9de7f22049fdac18485a6a5d403a\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eExtract the hex string from dnSpy and place it within Cyberchef and convert \u003cstrong class=\\\"highlight\\\"\u003eFrom Hex\u003c/strong\u003e to gain our next stage.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1392px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1392px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Ff66ebdc2dd9c4798bb790e6bd3c7293e\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003e\u0026nbsp;\u003cbr\u003e\u003c/p\u003e\u003cp\u003eOnce more place the next stage within pestudio for a quick static analysis of the file's contents. We can see the original files named RunPE.exe. With a description of SyscallPEloader, we can somewhat safely assume this is potentially a tool to modify the syscall. This file is now packed heavily with an entropy of 7.766.\u003c/p\u003e\u003cp\u003e\u0026nbsp;\u003cbr\u003e\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1436px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1436px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F68ce6cc027884ac18765d922d3a33c15\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003e\u0026nbsp;\u003cbr\u003e\u003c/p\u003e\u003cp\u003eSadly this is not the last stage of the malware, and it appears that it is using a \u003ca href=\\\"https://depthsecurity.com/blog/classic-api-unhooking-to-bypass-edr-solutions\\\" target=\\\"_blank\\\"\u003ecommon evasion tactic of unhooking APIs\u003c/a\u003e within the host and thus spawns a process for Notepad.exe. Needing further insight, we turn to one of our neighborhood experts to finish off this investigation.\u003cbr\u003e\u003cbr\u003e\u003cstrong\u003e\u003cem\u003e Big thanks to \u003c/em\u003e\u003c/strong\u003e\u003ca href=\\\"https://twitter.com/embee_research\\\" target=\\\"_blank\\\"\u003e@Matthew Brennan\u003c/a\u003e\u003cstrong\u003e \u003cem\u003efor his insight on this next stage\u003c/em\u003e.\u003c/strong\u003e\u003cbr\u003eThe following is basically a TL;DR of Matthew's findings. Let's check it out!\u003c/p\u003e\u003cp\u003e\u0026nbsp;\u003cbr\u003e\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:950px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"950px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F22c8c707f2ca42e5a9999edc21c4def7\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eAfter the execution of the RunPE.exe, we open ResourceHacker to see available processes on the host.\u003c/p\u003e\u003cp\u003e\u0026nbsp;\u003cbr\u003e\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:828px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"828px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F05d383dd738d40d68c6f469f9fc87d17\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003e\u0026nbsp;\u003cbr\u003e\u003c/p\u003e\u003cp\u003eWithin properties, we open the Threads tab. Instantly a TID of \u003cstrong\u003e3488 \u003c/strong\u003eflashes in front of us and changes its start address from \u003cspan class=\\\"highlight\\\"\u003e\u003cstrong\u003e0x1da511e0000\u003c/strong\u003e to \u003c/span\u003e\u003cstrong\u003e\u003cspan class=\\\"highlight\\\"\u003e0x0\u003c/span\u003e.\u003c/strong\u003e\u003c/p\u003e\u003cp\u003e\u0026nbsp;\u003cbr\u003e\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:528px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"528px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F2a26f0c086fa41f4bd9d41f2d8513032\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eInspect the thread, if you will: here we see \u003cstrong\u003eSleepEx+0x9e\u003c/strong\u003e which sleeps the host. Also, there is an address of \u003cstrong class=\\\"highlight\\\"\u003e0x1da52c4acdf \u003c/strong\u003ethat is close to the start address that flashed at the beginning. This could be the decryption piece of the software. Copy the thread \u003cstrong class=\\\"highlight\\\"\u003e0x1da52c4acdf\u003c/strong\u003e. Go ahead. It's okay.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-center\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"center\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F1eacc99ad8e743108510c7d905d0dfff\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eNow attach the Notepad.exe process to x64dbg and \u003cstrong class=\\\"highlight\\\"\u003eGo to Expression\u003c/strong\u003e with Ctrl + G. Now paste the thread address \u003cstrong class=\\\"highlight\\\"\u003e0x1da52c4acdf \u003c/strong\u003eand set an execution breakpoint. We'll wait.\u0026nbsp;\u003c/p\u003e\u003cp\u003e\u0026nbsp;\u003cbr\u003e\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2598px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2598px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fedabd83f07954c8487d95dc7c1bcfbf0\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eChange the thread to the value closest to the address; in this case, it is the thread using \u003cstrong class=\\\"highlight\\\"\u003e000001DA511E0000\u003c/strong\u003e.\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:1918px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"1918px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F9b2a964032d948c68e678f7ed9247894\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eNow we run the debugger until it hits the Hardware BreakPoint. We hit the key \u003cstrong\u003eg\u003c/strong\u003e and get a glimpse of what the loops are doing on this host. This is potentially the decryptor algorithm. \u003cbr\u003e\u003cbr\u003eWe also set a Hardware on Execution breakpoint on the address \u003cstrong class=\\\"highlight\\\"\u003e000001DA52C4AD2B \u003c/strong\u003eand run the application.\u003c/p\u003e\u003cp\u003e\u0026nbsp;\u003cbr\u003e\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:940px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"940px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F0b173cc279ea4cbd8e3b672dcbf625c3\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003e\u0026nbsp;\u003cbr\u003e\u003c/p\u003e\u003cp\u003eNow step in the code a few times and we get our C2 information: \u003cspan class=\\\"highlight\\\"\u003e\u003cstrong\u003eorganitations[.]com/Preserve/stat/3E8YZFXJ\u003c/strong\u003e (\u003cstrong\u003e69.28.84.201\u003c/strong\u003e)\u003c/span\u003e.\u003c/p\u003e\u003cp\u003e\u0026nbsp;\u003cbr\u003e\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-center\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"center\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fd06b7d9e3c2546fc80a27e63727c327e\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003eReview ELK for the process \u003cstrong\u003enotepad.exe\u003c/strong\u003e that is spawned by the parent process \u003cstrong class=\\\"highlight\\\"\u003epowershell.exe\u003c/strong\u003e with the command from the user's environment.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eNote: Its important to remove this process from the client as this is a cobalt strike beacon.\u003c/strong\u003e\u003c/p\u003e\u003cfigure class=\\\"w-richtext-figure-type-image w-richtext-align-fullwidth\\\" style=\\\"max-width:2866px\\\" data-rt-type=\\\"image\\\" data-rt-align=\\\"fullwidth\\\" data-rt-max-width=\\\"2866px\\\"\u003e\u003cdiv\u003e\u003cimg data-zoomable src=\\\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb69ab72476554338bd4cb9fa4e193a5a\\\" width=\\\"auto\\\" height=\\\"auto\\\" alt=\\\"\\\" loading=\\\"auto\\\"\u003e\u003c/div\u003e\u003c/figure\u003e\u003cp\u003e\u003cstrong\u003eTLDR:\u003c/strong\u003e\u003cbr\u003eThe Initial payload for this malware is:\u003c/p\u003e\u003cp\u003e- a user downloads a maldocx from a phishing email\u003c/p\u003e\u003cp\u003e- they execute the executable which runs an encoded base64 command that disables the firewall and installs environment persistence within the user's AutoRun key and creates a process that has RAT capabilities.\u003cbr\u003e\u003cbr\u003eIts found some samples that have this form of execution pattern:\u003c/p\u003e\u003cp\u003eMaldocx  Javascript (Wscript)  Powershell Environment  Cobaltstrike\u003c/p\u003e\u003cp\u003eMaldocx  Powershell Environment  Cobaltstrike\u003c/p\u003e\u003ch2\u003eFinal Thoughts\u003c/h2\u003e\u003cp\u003eWe hope you found this deconstruction helpful and useful. Below are some additional resources for you to get your hands dirty and gain a deeper understanding of what we did here in this blog today. The more analysts play around with malware in a safe environment, the better they can become at spotting the nastier, greasier, well-hidden activity lurking within environments.\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eDiscord URLs\u003c/strong\u003e\u0026nbsp;\u003c/p\u003e\u003cp\u003ehttps://cdn[.]discordapp[.]com/attachments/1004902785772441697/1004915801771495495/ppp\u003c/p\u003e\u003cp\u003ehttps://cdn[.]discordapp[.]com/attachments/1013559875034415135/1014369421629857882/sdwwcKkjnwsdw.mkv\u003c/p\u003e\u003cp\u003e\u0026nbsp;\u003cbr\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eAutorun\u003c/strong\u003e\u0026nbsp;\u003c/p\u003e\u003cp\u003eHKU\\\\SID\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\u003c/p\u003e\u003cp\u003eHKU\\\\SID\\\\Environment\u003c/p\u003e\u003cp\u003eHKU\\\\SID\\\\Software\\\\\u0026lt;value\u0026gt;\u003c/p\u003e\u003cp\u003eC:\\\\Users\\\\User\\\\appdata\\\\local\\\\temp\\\\\u0026lt;value\u0026gt;.js - Some Variants\u003c/p\u003e\u003cp\u003e\u0026nbsp;\u003cbr\u003e\u003c/p\u003e\u003cp\u003e\u003cstrong\u003eSearch Queries\u003c/strong\u003e\u0026nbsp;\u003c/p\u003e\u003cp\u003e+details.path:powershell.exe +details.command:\\\"GetEnvironmentVariable\\\"\u003c/p\u003e\u003cp\u003e+process.command_line.text:\\\"GetEnvironmentVariable\\\"\u0026nbsp;+process.command_line.text:/[a-f0-9]{12,18}/\u003c/p\u003e\u003cp\u003e+process.name:notepad.exe +process.parent.name:powershell.exe +process.parent.args_count:7\u003c/p\u003e\u003cp\u003e+process.cleartext:(cdn.discordapp.com AND attachments)\u003c/p\u003e\",\"categories\",[263],{\"_264\":265},\"category\",{\"_37\":192,\"_12\":266,\"_194\":267,\"_43\":268},\"65f3299e49a461b4b9c72e31\",\"blog-categories\",{\"_12\":266,\"_14\":269,\"_18\":18,\"_10\":270,\"_16\":271,\"_45\":272,\"_173\":281},\"Threat Analysis\",1739997400726,\"b7b51689bde4424484bccde4b9ee6d6b\",{\"_14\":269,\"_49\":273,\"_202\":274,\"_277\":275,\"_56\":276,\"_278\":279,\"_52\":280},\"threat-analysis\",{\"_47\":275,\"_52\":276},\"Threat Analysis Blog Posts | Huntress\",\"Read our Threat Analyses in these Huntress blog posts. \",\"metaTitle\",\"canonicalUrl\",\"https://www.huntress.com/blog-categories/threat-analysis\",\"\u003cp\u003eDive in and nerd out with us on current and emerging cybersecurity threats. We cover attack vectors, threat actors, and new vulnerabilities, providing insights to help you understand and counteract these risks.\u003c/p\u003e\",\"996brm3opp\",\"publishDate\",\"January 31, 2023\",\"featured\",\"https://www.huntress.com/blog/ave-maria-and-the-chambers-of-warzone-rat\",\"thumbnail\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F46469630afee4a6c8931e7cf49d7e4c1\",{\"_52\":289,\"_206\":33,\"_208\":33,\"_47\":290},\"Helping analysts develop a better understanding of the elastic search syntax.\",\"Ave Maria and the Chambers of Warzone RAT | Huntress\",\"ave-maria-and-the-chambers-of-warzone-rat\",\"lastUpdatedDate\",\"July 5, 2024\",{},1742860761822,\"XBN8lOXr7QMH6JvQimte3OCtO6c2\",\"ikm1vfsh35s\",\"relatedPosts\",[300,306,312],{\"_12\":301,\"_14\":302,\"_45\":303},\"67644708809124de50fa0e3c\",\"The Hunt for RedCurl\",{\"_49\":304,\"_286\":305},\"the-hunt-for-redcurl-2\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7cec99d221cc47fc945c3f1eadc23962\",{\"_12\":307,\"_14\":308,\"_45\":309},\"6740ad0b03c34fd25906fe8f\",\"Know Thy Enemy: A Novel November Case on Persistent Remote Access\",{\"_49\":310,\"_286\":311},\"know-thy-enemy-a-novel-november-case-on-persistent-remote-access\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2F7345981665e34e4780ff76dcd1e1714f\",{\"_12\":313,\"_14\":314,\"_45\":315},\"673bbadf6ee3cb266361f7ae\",\"You Can Run, but You Cant Hide: Defender Exclusions\",{\"_49\":316,\"_286\":317},\"you-can-run-but-you-cant-hide-defender-exclusions\",\"https://cdn.builder.io/api/v1/image/assets%2F3eb6f92aedf74f109c7b4b0897ec39a8%2Fb4ebc0447fc34db1a4ca274e87f1ca92\",\"builderApiKey\",\"3eb6f92aedf74f109c7b4b0897ec39a8\",\"actionData\",\"errors\"]\n");</script><!--$?--><template id="B:1"></template><!--/$--></div><script>$RC=function(b,c,e){c=document.getElementById(c);c.parentNode.removeChild(c);var a=document.getElementById(b);if(a){b=a.previousSibling;if(e)b.data="$!",a.setAttribute("data-dgst",e);else{e=b.parentNode;a=b.nextSibling;var f=0;do{if(a&&8===a.nodeType){var d=a.data;if("/$"===d)if(0===f)break;else f--;else"$"!==d&&"$?"!==d&&"$!"!==d||f++}d=a.nextSibling;e.removeChild(a);a=d}while(a);for(;c.firstChild;)e.insertBefore(c.firstChild,a);b.data="$"}b._reactRetry&&b._reactRetry()}};$RC("B:0","S:0")</script><div hidden id="S:1"><script>window.__reactRouterContext.streamController.close();</script></div><script>$RC("B:1","S:1")</script></body></html>