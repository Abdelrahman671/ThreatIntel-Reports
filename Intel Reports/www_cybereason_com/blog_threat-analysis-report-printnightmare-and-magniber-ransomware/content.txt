<!doctype html><!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en" > <![endif]--><!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en" >        <![endif]--><!--[if IE 8]>    <html class="no-js lt-ie9" lang="en" >               <![endif]--><!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]--><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="Cybereason Global SOC Team">
    <meta name="description" content="The Cybereason GSOC Team details infections with a recent version of the Magniber ransomware in which the initial attack vector is the exploitation of the notorious PrintNightmare vulnerability...">
    <meta name="generator" content="HubSpot">
    <title>Threat Analysis Report: PrintNightmare and Magniber Ransomware</title>
    <link rel="shortcut icon" href="https://www.cybereason.com/hubfs/cr-favicon-1.png">
    
<meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:description" content="The Cybereason GSOC Team details infections with a recent version of the Magniber ransomware in which the initial attack vector is the exploitation of the notorious PrintNightmare vulnerability...">
    <meta property="og:title" content="Threat Analysis Report: PrintNightmare and Magniber Ransomware">
    <meta name="twitter:description" content="The Cybereason GSOC Team details infections with a recent version of the Magniber ransomware in which the initial attack vector is the exploitation of the notorious PrintNightmare vulnerability...">
    <meta name="twitter:title" content="Threat Analysis Report: PrintNightmare and Magniber Ransomware">

    

    
    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>

<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41681847227/1644941386203/module_41681847227_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41682410610/1644941443237/module_41682410610_CR_-_Malicious_Life_Network_--_Main_Hero.min.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/43300360745/1724042214535/module_43300360745_CR_-_Malicious_Life_Network_--_Related_Posts.min.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/1669911113479/module_86933076631_CR_-_Sticky_CTA_Bar.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/34473990280/1704383554067/module_34473990280_CR_-_Footer_Full__en_US.min.css">
    

    
<!--  Added by GoogleTagManager integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;



var hsLoadGtm = function loadGtm() {
    if(window._hsGtmLoadOnce) {
      return;
    }

    if (useGoogleConsentModeV2) {

      gtag('set','developer_id.dZTQ1Zm',true);

      gtag('consent', 'default', {
      'ad_storage': 'denied',
      'analytics_storage': 'denied',
      'ad_user_data': 'denied',
      'ad_personalization': 'denied',
      'wait_for_update': waitForUpdateMillis
      });

      _hsp.push(['useGoogleConsentModeV2'])
    }

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TJVVB7C');

    window._hsGtmLoadOnce = true;
};

_hsp.push(['addPrivacyConsentListener', function(consent){
  if(consent.allowed || (consent.categories && consent.categories.analytics)){
    hsLoadGtm();
  }
}]);

</script>

<!-- /Added by GoogleTagManager integration -->


<script src="https://use.typekit.net/vyv2ljd.js"></script>
<script>try{Typekit.load({ async: false });}catch(e){}</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link rel="preload" href="/hubfs/__dam/fonts/ionicons.eot" as="font" type="font/otf" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/criteria/Criteria-CF-Regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/criteria/Criteria-CF-Medium.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/peristyle/Peristyle-Black.woff2" as="font" type="font/woff2" crossorigin>
<link rel="amphtml" href="https://www.cybereason.com/blog/threat-analysis-report-printnightmare-and-magniber-ransomware?hs_amp=true">

<meta property="og:image" content="https://www.cybereason.com/hubfs/Threat%20Alert%20template.png">

<meta name="twitter:image" content="https://www.cybereason.com/hubfs/Threat%20Alert%20template.png">


<meta property="og:url" content="https://www.cybereason.com/blog/threat-analysis-report-printnightmare-and-magniber-ransomware">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://www.cybereason.com/blog/threat-analysis-report-printnightmare-and-magniber-ransomware">

<meta property="og:type" content="article">
<link rel="alternate" type="application/rss+xml" href="https://www.cybereason.com/blog/rss.xml">
<meta name="twitter:domain" content="www.cybereason.com">
<script src="//platform.linkedin.com/in.js" type="text/javascript">
    lang: en_US
</script>

<meta http-equiv="content-language" content="en">
<link rel="stylesheet" href="//7052064.fs1.hubspotusercontent-na1.net/hub/7052064/hub_generated/template_assets/1729622897632/hubspot/hubspot_default/shared/responsive/layout.min.css">


<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/34470223313/1696396395659/__CR_Web_Platform/CSS/cr-master__cta.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/34470477360/1710134689941/__CR_Web_Platform/CSS/cr-master__main.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/35275979682/1642096258129/__CR_Web_Platform/CSS/ionicons.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42760289143/1724041950600/__CR_Web_Platform/CSS/cr-mln__build.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/34470224480/1635957556830/__CR_Web_Platform/CSS/bulma/cr-framework__bulma-columns.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/35291999472/1696396871390/__CR_Web_Platform/CSS/bulma/cr-framework__bulma.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42363645447/1635957556555/__CR_Web_Platform/CSS/hamburger-animation.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42507091846/1635957557027/__CR_Web_Platform/CSS/animate.min.css">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap" rel="stylesheet">
<script src="/hubfs/dam/plugins/marker-animation.js"></script>
<script>
$(document).ready(function() {
  $('.highlight').markerAnimation({
    "color":'var(--cr-yellow)',
    "font_weight":'normal',
    "background-size": '200% 1.2em'
  });
});
</script>

    <style>
.cr-mln__blog-post .container-is-blog.cr-mln__blog-post--body .column:nth-of-type(2) img {
    background: #FFFFFF;
    border: 1px solid #CCCCCC;
    border-radius: 5px 5px 5px 5px;
    padding: 10px;
} 
</style>

</head>
<body class="   hs-content-id-55822442330 hs-blog-post hs-blog-id-5272851739" style="">
<!--  Added by GoogleTagManager integration -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJVVB7C" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<!-- /Added by GoogleTagManager integration -->

    <div class="header-container-wrapper">
    <div class="header-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433790649568" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section id="cr-malicious-life-network__tier-one-header" class="position-flex">
  <div class="#">
    <div id="logo"><a href="https://www.cybereason.com"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-logo-inline--primary-black.png"></a></div>
    <div id="back-to">
      <a href="https://www.cybereason.com">Back to <span>Cybereason.com</span></a>
    </div>
    <!-- Hamburger Menu -->
    <button class="hamburger hamburger--collapse" type="button">
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="cr-mln__hamburger-menu--overlay">
      <ul>
        <li><a href="https://www.cybereason.com/blog/all"><span class="underline">All Posts</span></a></li>
        <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
        <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
        <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
        <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
        <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
        <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
      </ul>
      <div class="subscribe">
        <a href="#blog-subscribe">Subscribe</a>
      </div>
    </div>
    <!-- -->
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget mln-homepage" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433785464566" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section class="cr-malicious-life-network__hero-main base">
  <div class="container-is-blog columns hero-content page-center">
    <div class="column is-5-fullhd is-5-desktop is-12-touch">
      <a href="/blog"><img class="cr-mln-logo" src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-malicious-life-logo-v2.png"></a>
    </div>
    <div class="column is-7-fullhd is-7-desktop is-hidden-mobile is-hidden-tablet-only">
      <div class="cr-mln__search-subscribe">
        <div class="cr-mln__search">
          <a href="#cr-search-modal" class="search-btn"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/cr-blog-icon--search-dark-gray.png" alt="Search"></a>
        </div>
        <div class="cr-mln__subscribe">
          <a class="btn-subscribe" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>
      <div class="cr-mln__category-nav">
        <ul>
          <li><a href="/blog/category/all"><span class="underline">All</span></a></li>
          <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
          <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
          <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
          <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
          <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
          <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
        </ul>
      </div>
    </div>
  </div>
      <!-- MOBILE Search and Subscribe -->
      <div class="container-is-blog columns is-gapless is-hidden-desktop cr-mln__search-subscribe--mobile">
        <div class="column">
          <a class="search-btn">Search</a>
        </div>
        <div class="column">
          <a class="#" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>

      <!-- END MOBILE Search and Subscribe -->
  
  <!-- SEARCH Modal Wrap -->

  <div id="cr-search-modal">
        <!--THIS IS IMPORTANT! to close the modal, the class name has to match the name given on the ID -->
        <div id="btn-close-modal" class="close-cr-search-modal"> 
            X
        </div>

        <div class="modal-content">
            <div class="container columns">
              <div class="column">
                <div class="cr-search-modal__search-bar">
                  <h3>Search</h3>
                  <form action="/hs-search-results">
                    <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search...">
                    <input type="hidden" name="type" value="BLOG_POST">
                    <input type="hidden" name="type" value="LISTING_PAGE">
                    <button type="submit" class="arrow"></button>
                  </form>
                  
                </div>

              </div>
          </div>
        </div>
    </div>
  <!-- END Search Modal Wrap -->

</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end header -->
</div><!--end header wrapper -->

<div class="body-container-wrapper">
    <div class="body-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-blog_content " style="" data-widget-type="blog_content" data-x="0" data-w="12">







<div class="cr-mln__blog-post">
  <div class="container-is-blog columns is-multiline page-center">

    <div class="column is-8-fullhd is-8-desktop is-offset-2-fullhd is-offset-2-desktop is-10-tablet is-offset-1-tablet">
      <div class="featured-image"><img src="https://www.cybereason.com/hubfs/Threat%20Alert%20template.png" alt=""></div>
      <h1><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">Threat Analysis Report: PrintNightmare and Magniber Ransomware</span></h1>
      <div class="cr-mln__post-author-share">
      <div id="hubspot-author_data" class="hubspot-editable cr-mln__post-meta" data-hubspot-form-id="author_data" data-hubspot-name="Blog Author">
        
          <span class="descriptor">Written By</span>
          <p><span class="author">Cybereason Global SOC Team</span></p>
         
      </div>
    </div>
     
    </div>
    
    <!-- Sticky Author and Social Box -->
    
    <!-- END Sticky Author and Social Box -->
      <div class="container-is-blog columns is-multiline page-center cr-mln__blog-post--body">
        
        <div class="column is-7-fullhd is-7-desktop is-10-tablet is-10-mobile is-offset-1-fullhd is-offset-1-desktop is-offset-1-tablet is-offset-1-mobile">
          <span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p>The Cybereason Global Security Operations Center (GSOC) issues Cybereason Threat Analysis reports to inform on impacting threats. The Threat Analysis reports investigate these threats and provide practical recommendations for protecting against them.</p>
<!--more-->
<p>In this Threat Analysis Report, the Cybereason GSOC Team investigates infections with a recent version of the Magniber ransomware in which the initial attack vector against the compromised systems is the exploitation of the <a href="/blog/threat-alert-printnightmare-critical-vulnerability-in-windows-print-spooler" rel="noopener" target="_blank">notorious PrintNightmare vulnerability </a>described in&nbsp;<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34527" rel="noopener" target="_blank"><span>CVE-2021-34527</span></a>.</p>
<h2 style="text-align: left;"><strong>Key Findings</strong></h2>
<p><strong>Critical Vulnerabilities</strong>: CVE-2021-34527 and <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34481" rel="noopener" target="_blank"><span>CVE-2021-34481</span></a> are critical, remotely exploitable vulnerabilities in the Windows <em>Print Spooler</em> service that allow attackers to execute arbitrary code with administrative privileges on target systems. The vulnerabilities exist in the <em>Point and Print</em> capability on Windows systems and allow non-privileged users to install or update remote printers. CVE-2021-34527 and CVE-2021-34481 are collectively referred to as PrintNightmare.</p>
<p><strong>Significant Ransomware Threat to Corporate Networks</strong>: Shortly after the public disclosure of PrintNightmare CVE-2021-34527, malicious actors started exploiting this vulnerability. Ransomware groups find PrintNightmare particularly attractive:</p>
<ul>
<li style="list-style-type: none;">
<ul style="font-size: 18px;">
<li aria-level="1">PrintNightmare enables attackers to execute arbitrary code with administrative privileges.</li>
<li aria-level="1">CVE-2021-34527 exists in the <em>Point and Print</em> Windows capability, which many large corporate networks actively use. Ransomware groups typically target large corporate networks. Further, these large corporate networks often have many non-privileged users who use remote printers.</li>
</ul>
</li>
</ul>
<p><strong>The Magniber Ransomware and PrintNightmare</strong>: Malicious actors deploy the Magniber ransomware on compromised systems by exploiting PrintNightmare CVE-2021-34527. The Magniber ransomware is continuously under active development, with frequent significant code changes and improvements to obfuscation features, evasion tactics, and encryption mechanisms.&nbsp;</p>
<p><strong>Detected and Prevented</strong>:<a href="/platform" style="text-decoration: none;" rel="noopener" target="_blank"> The Cybereason Defense Platform</a> detects and prevents the Magniber ransomware.</p>
<p><strong>Cybereason Managed Detection and Response (MDR): </strong>The Cybereason GSOC has zero tolerance towards attacks that involve ransomware groups, such as Magniber, and categorizes such attacks as critical, high-severity incidents. The<a href="/services/managed-detection-response-mdr" rel="noopener" target="_blank"> <span style="text-decoration: underline;">Cybereason GSOC MDR team</span></a> issues a comprehensive report to customers when such an incident occurs. The report provides an in-depth overview of the incident, which helps to scope the extent of compromise and the impact on the customer’s environment. In addition, the report provides attribution information when possible as well as recommendations for mitigating and isolating the threat.</p>
<h2 style="text-align: left;"><strong>Introduction</strong></h2>
<p>PrintNightmare <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34527" rel="noopener" target="_blank"><span>CVE-2021-34527</span></a> is a critical vulnerability in the Windows <em>Print Spooler</em> service that allows attackers to execute arbitrary code with administrative privileges on target systems. An adversary who successfully exploits CVE-2021-34527 could achieve full control over a target system by executing, for example, a dynamic link library (DLL) or a Windows executable with administrative privileges.</p>
<p>The CVE-2021-34527 vulnerability exists in the <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/print/introduction-to-point-and-print" rel="noopener" target="_blank"><em><span>Point and Print</span></em></a> capability of Windows systems, which allows non-privileged users to install or update remote printers, without disks or other installation media, by establishing a connection to a remote printer.&nbsp;</p>
<p>Following the public disclosure of the CVE-2021-34527 vulnerability on July 1, 2021, Microsoft released an <a href="https://msrc-blog.microsoft.com/2021/07/06/out-of-band-oob-security-update-available-for-cve-2021-34527/" rel="noopener" target="_blank"><span>Out-of-Band Security Update</span></a> addressing the vulnerability on July 6, 2021. Then, on July 15, 2021, Microsoft publicly disclosed another critical vulnerability in the <em>Print Spooler</em> service: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34481" rel="noopener" target="_blank"><span>CVE-2021-34481</span></a>. As with CVE-2021-34527, this vulnerability exists in the <em>Point and Print</em> capability and allows non-privileged users to execute arbitrary code with administrative privileges.</p>
<p>Due to their similarities, CVE-2021-34527 and CVE-2021-34481 are now collectively referred to as PrintNightmare. To address the PrintNightmare vulnerabilities, Microsoft released an <a href="https://msrc-blog.microsoft.com/2021/08/10/point-and-print-default-behavior-change/?ranMID=24542&amp;ranEAID=2QzUaswX1as&amp;ranSiteID=2QzUaswX1as-LtjkkE3t8IlsobmMtjQkTQ&amp;epi=2QzUaswX1as-LtjkkE3t8IlsobmMtjQkTQ&amp;irgwc=1&amp;OCID=AID2200057_aff_7593_1243925&amp;tduid=%28ir__dujifp3kgckfqmolkk0sohz31m2xrlv2f3f31l2c00%29%287593%29%281243925%29%282QzUaswX1as-LtjkkE3t8IlsobmMtjQkTQ%29%28%29&amp;irclickid=_dujifp3kgckfqmolkk0sohz31m2xrlv2f3f31l2c00" rel="noopener" target="_blank"><span>update</span></a> on August 10, 2021 that modifies the behavior of <em>Point and Print </em>such that non-privileged users cannot install or update printers.</p>
<p>Shortly after the public disclosure of PrintNightmare CVE-2021-34527, malicious actors <a href="https://www.bleepingcomputer.com/news/security/microsoft-shares-mitigations-for-windows-printnightmare-zero-day-bug/" rel="noopener" target="_blank"><span>started</span></a> exploiting the vulnerability. Ransomware groups find PrintNightmare particularly attractive because this vulnerability enables the execution of arbitrary code with administrative privileges.</p>
<p>In addition, the PrintNightmare vulnerabilities exist in the Windows <em>Point and Print</em> capability, which is actively used in large corporate networks, which are frequent targets of ransomware groups and where the use of remote printers by non-privileged users is common.</p>
<p>For example, the ransomware groups Vice Society and Magniber <a href="https://www.zdnet.com/article/ransomware-now-attackers-are-exploiting-windows-printnightmare-vulnerabilities/" rel="noopener" target="_blank"><span>actively exploited</span></a> CVE-2021-34527 to deploy ransomware shortly after the public disclosure of the vulnerability. Ransomware groups often exploit newly disclosed vulnerabilities to deploy ransomware before vendors publicly release patches.</p>
<p>Threat researchers first observed the Magniber ransomware on compromised systems in <a href="https://www.zdnet.com/article/ransomware-security-researchers-spot-emerging-new-strain-of-malware/" rel="noopener" target="_blank"><span>2017</span></a>. At that time, malicious actors delivered Magniber primarily via the Magnitude exploit kit, which had often been used for delivering the Cerber, Locky, and Cryptowall ransomware.</p>
<p>Early versions of the Magniber ransomware targeted <a href="https://www.fireeye.com/blog/threat-research/2017/10/magniber-ransomware-infects-only-the-right-people.html" rel="noopener" target="_blank"><span>only Korean systems</span></a>, since the ransomware only executed on operating systems where the system language was set to Korean. However, the Magniber ransomware is continuously <a href="https://blog.malwarebytes.com/threat-analysis/2018/07/magniber-ransomware-improves-expands-within-asia/"><span>under active development</span></a>, with frequent significant code changes and improvements to obfuscation features, evasion tactics, and encryption mechanisms.</p>
<p>More recent implementations of the Magniber ransomware do not restrict the ransomware to Korean systems or to any specific geographical region. The Magniber ransomware may be executed on any system, irrespective of the system’s geographical location.</p>
<h2 style="text-align: left;"><strong>PrintNightmare and Magniber Ransomware Analysis</strong></h2>
<p>PrintNightmare CVE-2021-34527 is present in the Windows<em> Print Spooler</em> service, which executes as the <em>spoolsv.exe</em> process in Windows systems. An adversary who successfully exploits CVE-2021-34527 could achieve full control over a target system by executing arbitrary code, such as a dynamic link library (DLL) or a Windows executable, with administrative privileges.</p>
<p>The adversary must be authenticated to the <em>Print Spooler </em>service to take advantage of CVE-2021-34527. The <em>RpcAddPrinterDriverEx</em> function, implemented in the <em>Print Spooler</em> service, allows authenticated users to deploy arbitrary DLLs or Windows executables on systems where the <em>Print Spooler</em> service runs and execute these files with administrative (<em>SYSTEM</em>) privileges. According to the <a href="https://www.kb.cert.org/vuls/id/383432" rel="noopener" target="_blank"><span>CERT Coordination Center at Carnegie Mellon University</span></a>:</p>
<p style="padding-left: 40px;">The <em>RpcAddPrinterDriverEx()</em> function is used to install a printer driver on a system. One of the parameters to this function is the <em>DRIVER_CONTAINER </em>object, which contains information about which driver is to be used by the added printer. The other argument, <em>dwFileCopyFlags</em>, specifies how replacement printer driver files are to be copied. An attacker can take advantage of the fact that any authenticated user can call <em>RpcAddPrinterDriverEx()</em> and specify a driver file that lives on a remote server. This results in the <em>Print Spooler</em> service <em>spoolsv.exe</em> executing code in an arbitrary DLL file with <em>SYSTEM</em> privileges.</p>
<p>When an adversary exploits CVE-2021-34527, the <em>Print Spooler</em> service writes any attacker-provided DLL in the <em>%SYSTEM%\System32\spool\drivers\ </em>directory (for example, in <em>C:\Windows\System32\spool\drivers\x64\3\New</em>). The vulnerable <em>Print Spooler</em> service (<em>spoolsv.exe</em>) then loads and executes the attacker-provided DLL with administrative privileges.</p>
<p>The actors behind the Magniber ransomware distribute the ransomware in the form of a Windows DLL file. They take advantage of CVE-2021-34527 to deploy and execute this DLL file on compromised systems. By exploiting CVE-2021-34527, adversaries write the DLL file of the Magniber ransomware in the <em>%SYSTEM%\System32\spool\drivers\ </em>directory (for example, in <em>C:\Windows\System32\spool\drivers\x64\3\New</em>) and execute it in the context of the <em>Print Spooler</em> service:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-1a.png?width=1074&amp;name=PrintNightmare-Magniber-Ransomware-image-1a.png" alt="PrintNightmare-Magniber-Ransomware-image-1a" width="1074" loading="lazy" style="width: 1074px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-1a.png?width=537&amp;name=PrintNightmare-Magniber-Ransomware-image-1a.png 537w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-1a.png?width=1074&amp;name=PrintNightmare-Magniber-Ransomware-image-1a.png 1074w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-1a.png?width=1611&amp;name=PrintNightmare-Magniber-Ransomware-image-1a.png 1611w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-1a.png?width=2148&amp;name=PrintNightmare-Magniber-Ransomware-image-1a.png 2148w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-1a.png?width=2685&amp;name=PrintNightmare-Magniber-Ransomware-image-1a.png 2685w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-1a.png?width=3222&amp;name=PrintNightmare-Magniber-Ransomware-image-1a.png 3222w" sizes="(max-width: 1074px) 100vw, 1074px"></p>
<p style="text-align: center;"><em><span style="font-size: 16px;">The Print Spooler service writes the attacker-provided calc.dll file (the DLL that implements the Magniber ransomware) when malicious actors exploit CVE-2021-34527</span></em></p>
<p>The following chart provides an overview of the operation of the Magniber ransomware, implemented as a 64-bit DLL, referred to as Magniber DLL:</p>
<p style="line-height: 1;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-2.jpg?width=1999&amp;name=PrintNightmare-Magniber-Ransomware-image-2.jpg" alt="PrintNightmare-Magniber-Ransomware-image-2" width="1999" loading="lazy" style="width: 1999px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-2.jpg?width=1000&amp;name=PrintNightmare-Magniber-Ransomware-image-2.jpg 1000w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-2.jpg?width=1999&amp;name=PrintNightmare-Magniber-Ransomware-image-2.jpg 1999w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-2.jpg?width=2999&amp;name=PrintNightmare-Magniber-Ransomware-image-2.jpg 2999w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-2.jpg?width=3998&amp;name=PrintNightmare-Magniber-Ransomware-image-2.jpg 3998w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-2.jpg?width=4998&amp;name=PrintNightmare-Magniber-Ransomware-image-2.jpg 4998w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-2.jpg?width=5997&amp;name=PrintNightmare-Magniber-Ransomware-image-2.jpg 5997w" sizes="(max-width: 1999px) 100vw, 1999px"></p>
<p style="font-size: 16px; text-align: center;"><em>Overview of the operation of the Magniber ransomware</em></p>
<p>When executed in the context of <em>spoolsv.exe</em>, the Magniber ransomware first unpacks code stored in its <em>data</em> section. The ransomware then enumerates all running processes on the compromised system to identify processes in which the ransomware can inject the unpacked code. Magniber injects the unpacked code into each process that fulfills the following criteria:</p>
<ul>
<li style="list-style-type: none;">
<ul style="font-size: 18px;">
<li aria-level="1">The name of the process is not <em>iexplore.exe</em>.</li>
<li aria-level="1">The process integrity level is less than <em>SYSTEM</em>.</li>
<li aria-level="1">The process is not running in the <em>WoW64</em> environment. WoW64 is a subsystem of the Windows operating system that enables the execution of 32-bit applications on 64-bit Windows operating systems.</li>
</ul>
</li>
</ul>
<p>Magniber also executes the unpacked code in the context of <em>spoolsv.exe</em> itself as a backup mechanism that guarantees the execution of the code if the ransomware cannot inject the code into a process.</p>
<p>To inject the unpacked code into a process, the Magniber ransomware invokes the following sequence of Windows system calls:&nbsp;</p>
<ul>
<li style="list-style-type: none;">
<ul style="font-size: 18px;">
<li aria-level="1"><em>NtCreateSection: </em>The Magniber ransomware creates a new memory section that has <em>RWX</em> (read/write/execute) protection.&nbsp;</li>
<li aria-level="1"><em>NtMapViewOfSection</em>: Magniber maps the memory section in the virtual address space of the process in which the ransomware executes (i.e., <em>spoolsv.exe</em>) with <em>RWX</em> (read/write/execute) protection. The ransomware then writes the unpacked code into the mapped memory section.</li>
<li aria-level="1"><em>NtMapViewOfSection</em>: Magniber maps the memory section in the virtual address space of the process in which the ransomware injects code (for example, <em>sihost.exe</em>) with <em>RWX</em> protection. The code that Magniber has written in the memory section mapped in the virtual address space of <em>spoolsv.exe</em> is now mirrored (i.e., injected) in the memory section mapped in the virtual address space of <em>sihost.exe</em>.&nbsp;</li>
<li aria-level="1"><em>NtCreateThreadEx</em>: Magniber creates a thread in the context of <em>sihost.exe</em>, also known as a remote thread, and then suspends the execution of that thread.</li>
<li aria-level="1"><em>NtGetContextThread</em>: Magniber retrieves the context of the newly created remote thread. Thread context is data related to the operation of the thread, which includes the values of the registers associated with the thread, such as the thread’s instruction pointer register (<em>rip</em>).</li>
<li aria-level="1"><em>NtSetContextThread</em>: Magniber sets the value of the remote thread’s <em>rip</em> to the virtual address at which the memory section is mapped in the virtual address space of <em>sihost.exe</em>. This causes the remote thread to execute the code stored in this memory section when the thread resumes execution.</li>
<li aria-level="1"><em>NtResumeThread</em>: Magniber resumes the execution of the remote thread. This executes the injected code in the context of <em>sihost.exe</em>.</li>
</ul>
</li>
</ul>
<p>The Magniber ransomware does not execute Windows system calls by invoking functions implemented in the DLL file <em>ntdll.dll</em> for that purpose, such as <em>NtCreateSection</em> or <em>NtMapViewOfSection</em>. Instead, the ransomware invokes assembly code that first switches the execution context to the kernel and then executes the system call routines implemented as part of the kernel, a technique known as direct system call execution. This technique is used to avoid detection by security mechanisms that monitor Windows system call execution via hooks in <em>ntdll.dll</em>.&nbsp;</p>
<p>To directly execute a system call, the Magniber ransomware allocates a memory region in its virtual address space and stores in this region the assembly language opcodes that conduct the direct execution of the system call in Windows systems. The ransomware then executes the content of the memory region, therefore directly executing the system call.&nbsp;</p>
<p>On 64-bit Windows systems, direct system call execution involves storing the system call identification number (system call ID, a number that uniquely identifies the system call) in the <em>eax</em> register and then invoking the <em>syscall</em> instruction. The system call ID of a specific system call may differ for different releases and builds of Windows systems.</p>
<p>To use the correct system call ID when directly executing a given system call, the Magniber ransomware differentiates between Windows releases (for example, Windows 10 or pre-Windows 10 systems, such as Windows 7), down to specific build numbers (for example, Windows 10 build 18363 or build 17763):</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-3.jpg?width=1128&amp;name=PrintNightmare-Magniber-Ransomware-image-3.jpg" alt="PrintNightmare-Magniber-Ransomware-image-3" width="1128" loading="lazy" style="width: 1128px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-3.jpg?width=564&amp;name=PrintNightmare-Magniber-Ransomware-image-3.jpg 564w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-3.jpg?width=1128&amp;name=PrintNightmare-Magniber-Ransomware-image-3.jpg 1128w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-3.jpg?width=1692&amp;name=PrintNightmare-Magniber-Ransomware-image-3.jpg 1692w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-3.jpg?width=2256&amp;name=PrintNightmare-Magniber-Ransomware-image-3.jpg 2256w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-3.jpg?width=2820&amp;name=PrintNightmare-Magniber-Ransomware-image-3.jpg 2820w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-3.jpg?width=3384&amp;name=PrintNightmare-Magniber-Ransomware-image-3.jpg 3384w" sizes="(max-width: 1128px) 100vw, 1128px"></p>
<p style="text-align: center;"><em><span style="font-size: 16px;">The Magniber ransomware conducts direct system call execution (direct execution of the NtCreateSection system call)</span></em></p>
<p>Once injected and executed in the context of a remote thread, the code first unpacks itself and then executes a code segment. This code segment, referred to as the Magniber ransomware for simplicity, first creates and locks a mutex object named, for example, <em>zarkzonn</em> or <em>dihlxbl</em>, to ensure that only one instance of the Magniber ransomware runs at a time.</p>
<p>This technique also prevents redundant executions of the same code injected into other processes. The name of the mutex object is different for different versions of the Magniber ransomware.</p>
<p>The Magniber ransomware then builds a string based on the computer name of the compromised system and the serial number of a volume present on the system. The ransomware then appends the name of the mutex object to this string. The resulting string is specific to the compromised system and is called the <em>compromised system identifier</em>.</p>
<p>Magniber then enumerates drives with removable and fixed media that are attached to the compromised system, as well as remote drives. These are drives for which the Windows Application Programming Interface (API) function<a href="https://docs.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-getdrivetypew" style="text-decoration: none;" rel="noopener" target="_blank"> <em>GetDriveTypeW</em></a> returns <em>0x2</em> (<em>DRIVE_REMOVABLE</em>), <em>0x3</em> (<em>DRIVE_FIXED</em>), or <em>0x4</em> (<em>DRIVE_REMOTE</em>), such as hard disks or network shares. For each such drive, the Magniber ransomware conducts file enumeration and encryption in two phases.&nbsp;</p>
<p>In the first phase, Magniber encrypts files that the ransomware considers higher encryption priority. These files have one of 714 file name extensions, and include <em>.doc</em> and <em>.xls</em>. In the second phase, Magniber encrypts files that are of lower encryption priority. These files have one of 33 file name extensions, and include <em>.zip</em> and <em>.swf</em>. As an anti-analysis technique, the Magniber ransomware stores an obfuscated form of the file name extensions of files of higher and lower encryption priority in its context.</p>
<p style="line-height: 1;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-4.jpg?width=618&amp;name=PrintNightmare-Magniber-Ransomware-image-4.jpg" alt="PrintNightmare-Magniber-Ransomware-image-4" width="618" loading="lazy" style="width: 618px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-4.jpg?width=309&amp;name=PrintNightmare-Magniber-Ransomware-image-4.jpg 309w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-4.jpg?width=618&amp;name=PrintNightmare-Magniber-Ransomware-image-4.jpg 618w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-4.jpg?width=927&amp;name=PrintNightmare-Magniber-Ransomware-image-4.jpg 927w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-4.jpg?width=1236&amp;name=PrintNightmare-Magniber-Ransomware-image-4.jpg 1236w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-4.jpg?width=1545&amp;name=PrintNightmare-Magniber-Ransomware-image-4.jpg 1545w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-4.jpg?width=1854&amp;name=PrintNightmare-Magniber-Ransomware-image-4.jpg 1854w" sizes="(max-width: 618px) 100vw, 618px"></p>
<p style="font-size: 16px; text-align: center;"><em>File name extensions in obfuscated form</em></p>
<p>In both phases, the Magniber ransomware encrypts only files that are allowlisted for encryption. Magniber does not encrypt the following files:</p>
<ul>
<li style="list-style-type: none;">
<ul style="font-size: 18px;">
<li aria-level="1">Files that have no file name extensions.</li>
<li aria-level="1">Files stored in the following directories: <em>Documents and Settings</em>, <em>Winnt</em>, <em>AppData</em>, <em>Local Settings</em>, <em>Sample Music</em>, <em>Sample Pictures</em>, <em>Sample Videos</em>, <em>Tor Browser</em>, <em>Recycle</em>, <em>Windows</em>, <em>Boot</em>, <em>Intel</em>, <em>Msocache</em>, <em>Perflogs</em>, <em>Program Files</em>, <em>ProgramData</em>, <em>Recovery</em>, and <em>System Volume Information.</em></li>
<li aria-level="1">Files stored in directories ​for which the Windows API function <a href="https://docs.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-getfileattributesw" rel="noopener" target="_blank"><span>GetFileAttributesW</span></a> returns <em>FILE_ATTRIBUTE_SYSTEM, FILE_ATTRIBUTE_HIDDEN</em>, or <em>FILE_ATTRIBUTE_ENCRYPTED.</em></li>
<li aria-level="1">Files ​​for which the Windows API function <a href="https://docs.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-getfileattributesw" rel="noopener" target="_blank"><span>GetFileAttributesW</span></a> returns <em>FILE_ATTRIBUTE_SYSTEM</em>, <em>FILE_ATTRIBUTE_HIDDEN</em>, <em>FILE_ATTRIBUTE_READONLY</em>, <em>FILE_ATTRIBUTE_TEMPORARY</em>, or <em>FILE_ATTRIBUTE_VIRTUAL</em>.</li>
</ul>
</li>
</ul>
<p>&nbsp;</p>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2;">
<tbody>
<tr>
<td style="background-color: #f1c232; border: 1pt solid #000000;">
<p><strong>File or Directory Attribute</strong></p>
</td>
<td style="background-color: #f1c232; border: 1pt solid #000000;">
<p><strong>Description</strong></p>
</td>
</tr>
<tr>
<td style="border: 1pt solid #000000;">
<p><em>FILE_ATTRIBUTE_SYSTEM</em></p>
</td>
<td style="border: 1pt solid #000000;">
<p>A file or directory that the Windows operating system uses.</p>
</td>
</tr>
<tr>
<td style="border: 1pt solid #000000;">
<p><em>FILE_ATTRIBUTE_HIDDEN</em></p>
</td>
<td style="border: 1pt solid #000000;">
<p>A hidden file or directory.</p>
</td>
</tr>
<tr>
<td style="border: 1pt solid #000000;">
<p><em>FILE_ATTRIBUTE_ENCRYPTED</em></p>
</td>
<td style="border: 1pt solid #000000;">
<p>A file that the Encrypted Filesystem (EFS) encrypts, or a directory in which the EFS encrypts every new file.</p>
</td>
</tr>
<tr>
<td style="border: 1pt solid #000000;">
<p><em>FILE_ATTRIBUTE_READONLY</em></p>
</td>
<td style="border: 1pt solid #000000;">
<p>A read-only file.</p>
</td>
</tr>
<tr>
<td style="border: 1pt solid #000000;">
<p><em>FILE_ATTRIBUTE_TEMPORARY</em></p>
</td>
<td style="border: 1pt solid #000000;">
<p>A file used for temporary storage.</p>
</td>
</tr>
<tr>
<td style="border: 1pt solid #000000;">
<p><em>FILE_ATTRIBUTE_VIRTUAL</em></p>
</td>
<td style="border: 1pt solid #000000;">
<p>A file reserved for system use.</p>
</td>
</tr>
</tbody>
</table>
<p style="text-align: center; font-size: 16px;"><em>Attributes of files and directories that Magniber does not encrypt</em></p>
<p>The Magniber ransomware encrypts files by applying a hybrid encryption approach that combines the use of the Advanced Encryption Standard (AES) and the Rivest, Shamir, Adleman (RSA) encryption algorithms. This approach maximizes both encryption performance and security. The Magniber ransomware first encrypts a file by using the symmetric encryption algorithm AES.</p>
<p>AES is by design more performant but less secure than the RSA encryption algorithm. AES relies on a symmetric encryption key and an initialization vector (IV) for encryption security. To compensate for this disadvantage of AES, the ransomware then encrypts the AES symmetric key and IV by using the RSA encryption algorithm. The Magniber ransomware uses the Microsoft <a href="https://docs.microsoft.com/en-us/windows/win32/seccrypto/cryptoapi-system-architecture" rel="noopener" target="_blank"><span>CryptoAPI</span></a> for encryption.&nbsp;</p>
<p>For each file being encrypted, Magniber first generates two random arrays of 16 bytes. The first byte array is an AES symmetric encryption key and the second is an IV. The Magniber ransomware then encrypts equal-sized data blocks of the file being encrypted using the AES key and IV, such that each data block is 1048576 bytes in size.</p>
<p>After encrypting a data block, the Magniber ransomware writes the encrypted form of the data block in the file, replacing the original data block. This encryption procedure ends in Magniber encrypting the last data block of the file, which may be less than 1048576 bytes in size, by setting the parameter <em>final</em> of the <a href="https://docs.microsoft.com/en-us/windows/win32/api/wincrypt/nf-wincrypt-cryptencrypt" rel="noopener" target="_blank"><span>CryptEncrypt</span></a> CryptoAPI function to 1:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-5.jpg?width=1039&amp;name=PrintNightmare-Magniber-Ransomware-image-5.jpg" alt="PrintNightmare-Magniber-Ransomware-image-5" width="1039" loading="lazy" style="width: 1039px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-5.jpg?width=520&amp;name=PrintNightmare-Magniber-Ransomware-image-5.jpg 520w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-5.jpg?width=1039&amp;name=PrintNightmare-Magniber-Ransomware-image-5.jpg 1039w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-5.jpg?width=1559&amp;name=PrintNightmare-Magniber-Ransomware-image-5.jpg 1559w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-5.jpg?width=2078&amp;name=PrintNightmare-Magniber-Ransomware-image-5.jpg 2078w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-5.jpg?width=2598&amp;name=PrintNightmare-Magniber-Ransomware-image-5.jpg 2598w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-5.jpg?width=3117&amp;name=PrintNightmare-Magniber-Ransomware-image-5.jpg 3117w" sizes="(max-width: 1039px) 100vw, 1039px"></p>
<p style="font-size: 16px; text-align: center;"><em>Unencrypted and encrypted form of a data block, encrypted using an AES key and IV</em></p>
<p>After encrypting all file data blocks, Magniber concatenates the AES key and IV and encrypts the resulting data by using a 2048-bit RSA public key. The file that implements the Magniber ransomware also stores the public key. The ransomware then appends the encrypted form of the concatenated AES key and IV to the end of the file.</p>
<p>Magniber then changes the file name extension of the file being encrypted by appending a file name extension that is the same as the name of the mutex object that the ransomware creates, such as <em>zarkzonn</em> or <em>dihlxbl</em>. The ransomware then proceeds to encrypt the next file designated for encryption.</p>
<p>After it encrypts all files stored in a folder, the Magniber ransomware places a <em>readme.txt</em> file that contains a ransom note in the folder. The ransom note contains Uniform Resource Locators (URLs) unique to the compromised system such that the URL subdomain is the <em>compromised system identifier</em> that the ransomware generates.</p>
<p>According to available open-source intelligence (OSINT), the URLs point to a payment website that instructs users to purchase software called <em>My Decryptor</em> to restore the files that the ransomware has encrypted. The URLs in the ransom note that Magniber left on the systems that the Cybereason GSOC analyzed were unreachable:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-6.jpg?width=1036&amp;name=PrintNightmare-Magniber-Ransomware-image-6.jpg" alt="PrintNightmare-Magniber-Ransomware-image-6" width="1036" loading="lazy" style="width: 1036px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-6.jpg?width=518&amp;name=PrintNightmare-Magniber-Ransomware-image-6.jpg 518w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-6.jpg?width=1036&amp;name=PrintNightmare-Magniber-Ransomware-image-6.jpg 1036w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-6.jpg?width=1554&amp;name=PrintNightmare-Magniber-Ransomware-image-6.jpg 1554w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-6.jpg?width=2072&amp;name=PrintNightmare-Magniber-Ransomware-image-6.jpg 2072w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-6.jpg?width=2590&amp;name=PrintNightmare-Magniber-Ransomware-image-6.jpg 2590w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-6.jpg?width=3108&amp;name=PrintNightmare-Magniber-Ransomware-image-6.jpg 3108w" sizes="(max-width: 1036px) 100vw, 1036px"></p>
<p style="font-size: 16px; text-align: center;"><em>The Magniber ransomware ransom note</em></p>
<p>After finishing the two phases of file enumeration and encryption, if the Magniber ransomware has encrypted more than 1000000 bytes in total, Magniber places the <em>readme.txt</em> file in the <em>%PUBLIC%</em> folder (for example, <em>C:\Users\Public</em>) and displays the file with the Notepad application (<em>notepad.exe</em>). Magniber also opens the default browser on the compromised system to display a payment website.</p>
<p>By doing this, Magniber also exfiltrates information about its operation on the compromised system by storing the following values in URL query parameters:</p>
<ul>
<li style="list-style-type: none;">
<ul style="font-size: 18px;">
<li aria-level="1">The number of drives in which the ransomware has enumerated files.</li>
<li aria-level="1">The total size of encrypted data that the Magniber ransomware has generated (in bytes).</li>
<li aria-level="1">The number of files that the ransomware has encrypted.</li>
<li aria-level="1">The number of files that the ransomware has enumerated; this number includes both files that the ransomware has encrypted and unencrypted files.</li>
<li aria-level="1">The build number of the compromised Windows operating system (e.g., 17763).<br><br></li>
</ul>
</li>
</ul>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-7.jpg?width=900&amp;name=PrintNightmare-Magniber-Ransomware-image-7.jpg" alt="PrintNightmare-Magniber-Ransomware-image-7" width="900" loading="lazy" style="width: 900px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-7.jpg?width=450&amp;name=PrintNightmare-Magniber-Ransomware-image-7.jpg 450w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-7.jpg?width=900&amp;name=PrintNightmare-Magniber-Ransomware-image-7.jpg 900w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-7.jpg?width=1350&amp;name=PrintNightmare-Magniber-Ransomware-image-7.jpg 1350w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-7.jpg?width=1800&amp;name=PrintNightmare-Magniber-Ransomware-image-7.jpg 1800w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-7.jpg?width=2250&amp;name=PrintNightmare-Magniber-Ransomware-image-7.jpg 2250w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-7.jpg?width=2700&amp;name=PrintNightmare-Magniber-Ransomware-image-7.jpg 2700w" sizes="(max-width: 900px) 100vw, 900px"></p>
<p style="font-size: 16px; text-align: center;"><em>The Magniber ransomware exfiltrates information about its operation via URL query parameters</em></p>
<p>The Magniber ransomware then releases and closes the named mutex object it has previously locked, and executes the command <em>vssadmin.exe Delete Shadows /all /quiet </em>to delete shadow copies so that encrypted files cannot be recovered. Magniber executes this command with elevated privileges by bypassing Windows User Account Control (UAC), as follows:</p>
<ul>
<li style="list-style-type: none;">
<ul style="font-size: 18px;">
<li aria-level="1"><em>Magniber writes the command to be executed with elevated privileges in the (Default) registry value under the registry key HKCU\Software\Classses\ms-settings\shell\open\command on Windows 10 systems, or under the registry key HKCU\Software\Classes\mscfile\shell\open\command on earlier Windows releases.</em></li>
<li aria-level="1"><em>On Windows 10 systems, Magniber creates the DelegateExecute registry value under the registry key HKCU\Software\Classes\ms-settings\shell\open\command.</em></li>
<li aria-level="1"><em>Magniber executes computerdefaults.exe on Windows 10 systems, or CompMgmtLauncher.exe on earlier Windows releases, by executing the following command: </em><br><em>cmd.exe /c %SystemRoot%\system32\wbem\wmic process call create “/c computerdefaults.exe” or cmd.exe /c %SystemRoot%\system32\wbem\wmic process call “create /c CompMgmtLauncher.exe”<br>This, in turn, executes the command written in the (Default) registry value with elevated privileges.</em></li>
</ul>
</li>
</ul>
<p>One way in which Magniber deletes shadow copies is by writing the command <em>C:\Windows\System32\wbem\wmic process call create "vssadmin.exe Delete Shadow&nbsp; /all /quiet"</em> in the <em>(Default)</em> registry value under the registry key <em>HKCU\Software\Classes\ms-settings\shell\open\command</em> or <em>HKCU\Software\Classes\mscfile\shell\open\command</em>.</p>
<p>Another way in which Magniber deletes shadow copies on Windows 10 systems is by writing the <em>JScript</em> script depicted below in the <em>%PUBLIC%\readme.txt</em> file, followed by writing the command <em>regsvr32.exe scrobj.dll /s /u /n /i:%PUBLIC%\readme.txt</em> in the <em>(Default)</em> registry value under the registry key <em>HKCU\Software\Classes\ms-settings\shell\open\command</em>. After <em>regsvr32.exe</em> is finished executing, the Magniber ransomware deletes the <em>%PUBLIC%\readme.txt</em> file.</p>
<p>Both approaches result in the execution of <em>vssadmin.exe</em> as a child process of the <em>Windows Management Instrumentation (WMI) Provider Host</em> process (<em>wmiprvse.exe</em>) with elevated privileges:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-8.png?width=927&amp;name=PrintNightmare-Magniber-Ransomware-image-8.png" alt="PrintNightmare-Magniber-Ransomware-image-8" width="927" loading="lazy" style="width: 927px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-8.png?width=464&amp;name=PrintNightmare-Magniber-Ransomware-image-8.png 464w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-8.png?width=927&amp;name=PrintNightmare-Magniber-Ransomware-image-8.png 927w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-8.png?width=1391&amp;name=PrintNightmare-Magniber-Ransomware-image-8.png 1391w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-8.png?width=1854&amp;name=PrintNightmare-Magniber-Ransomware-image-8.png 1854w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-8.png?width=2318&amp;name=PrintNightmare-Magniber-Ransomware-image-8.png 2318w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-8.png?width=2781&amp;name=PrintNightmare-Magniber-Ransomware-image-8.png 2781w" sizes="(max-width: 927px) 100vw, 927px"></p>
<p style="font-size: 16px; text-align: center;"><em>A Jscript script that executes vssadmin.exe</em></p>
<p>The Cybereason platform detects the Magniber ransomware deleting shadow copies. After deleting shadow copies, the Magniber ransomware terminates its operation:&nbsp;</p>
<p style="text-align: left;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-9.png?width=1077&amp;name=PrintNightmare-Magniber-Ransomware-image-9.png" alt="PrintNightmare-Magniber-Ransomware-image-9" width="1077" loading="lazy" style="width: 1077px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-9.png?width=539&amp;name=PrintNightmare-Magniber-Ransomware-image-9.png 539w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-9.png?width=1077&amp;name=PrintNightmare-Magniber-Ransomware-image-9.png 1077w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-9.png?width=1616&amp;name=PrintNightmare-Magniber-Ransomware-image-9.png 1616w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-9.png?width=2154&amp;name=PrintNightmare-Magniber-Ransomware-image-9.png 2154w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-9.png?width=2693&amp;name=PrintNightmare-Magniber-Ransomware-image-9.png 2693w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-9.png?width=3231&amp;name=PrintNightmare-Magniber-Ransomware-image-9.png 3231w" sizes="(max-width: 1077px) 100vw, 1077px"></p>
<p style="font-size: 16px; text-align: center;"><em>The Magniber ransomware deletes shadow copies</em></p>
<h2 style="text-align: left;"><strong>Detection and Prevention</strong></h2>
<h3><strong>PrintNightmare Vulnerabilities</strong></h3>
<p>The Cybereason GSOC recommends the following:</p>
<ul>
<ul style="font-size: 18px;">
<li aria-level="1">Update your systems. Microsoft released an <a href="https://msrc-blog.microsoft.com/2021/08/10/point-and-print-default-behavior-change/?ranMID=24542&amp;ranEAID=2QzUaswX1as&amp;ranSiteID=2QzUaswX1as-LtjkkE3t8IlsobmMtjQkTQ&amp;epi=2QzUaswX1as-LtjkkE3t8IlsobmMtjQkTQ&amp;irgwc=1&amp;OCID=AID2200057_aff_7593_1243925&amp;tduid=%28ir__dujifp3kgckfqmolkk0sohz31m2xrlv2f3f31l2c00%29%287593%29%281243925%29%282QzUaswX1as-LtjkkE3t8IlsobmMtjQkTQ%29%28%29&amp;irclickid=_dujifp3kgckfqmolkk0sohz31m2xrlv2f3f31l2c00" rel="noopener" target="_blank"><span>update</span></a> that addresses the <a href="/blog/threat-alert-printnightmare-critical-vulnerability-in-windows-print-spooler" rel="noopener" target="_blank">PrintNightmare vulnerabilities</a>.&nbsp;</li>
<li aria-level="1">Disable the Windows<em> Print Spooler</em> service if this service is not necessary. To do this, use one of the following methods.</li>
<ul>
<li aria-level="2">Execute the following system command: <em>net stop spooler</em></li>
</ul>
</ul>
</ul>
<ul>
<li style="list-style-type: none;">
<ul style="font-size: 18px;">
<li aria-level="2">Execute the following PowerShell command: <em>Stop-Service -Name Spooler -Force &amp; Set-Service -Name Spooler -StartupType Disabled</em></li>
</ul>
</li>
</ul>
<ul>
<li style="list-style-type: none;">
<ul style="font-size: 18px;">
<li aria-level="1">If you do not want to disable the <em>Print Spooler</em> service, modify the <em>SYSTEM</em> user privileges so that this user cannot write in the <em>%SYSTEM%\System32\spool\drivers\</em> directory. This action effectively blocks the deployment of attacker-provided DLLs or Windows executables by exploiting PrintNightmare CVE-2021-34527. To do this, execute the following PowerShell script:</li>
</ul>
</li>
</ul>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2;">
<tbody>
<tr>
<td style="background-color: #efefef; border: 1pt solid #000000;">
<p>$Path = "C:\Windows\System32\spool\drivers</p>
<p>$Acl = Get-Acl $Path</p>
<p>$Ar = New-Object</p>
<p>System.Security.AccessControl.FileSystemAccessRule("System", "Modify", "ContainerInherit, ObjectInherit", "None", "Deny")</p>
<p>$Acl.AddAccessRule($Ar)</p>
</td>
</tr>
</tbody>
</table>
<ul>
<li style="list-style-type: none;">
<ul style="font-size: 18px;">
<li aria-level="1">Check for potential CVE-2021-34527 exploitation attempts by executing the following PowerShell command: <br><em>Get-WinEvent -LogName 'Microsoft-Windows-PrintService/Admin' | Select-String -InputObject {$_.message} -Pattern 'The print spooler failed to load a plug-in module'. </em>The presence of the following log message indicates that the <em>Print Spooler</em> service has attempted to execute a DLL or a Windows executable, which an attacker may have provided when exploiting PrintNightmare: <em>The print spooler failed to load a plug-in module</em>.</li>
<li aria-level="1">Threat Hunting with Cybereason: The Cybereason MDR team provides its customers with custom hunting queries for detecting specific threats - to find out more about threat hunting and <a href="/platform/managed-detection-response-mdr" rel="noopener" target="_blank">Managed Detection and Response</a> with the Cybereason Defense Platform, <a href="/services/managed-detection-response-mdr#form" rel="noopener" target="_blank">contact a Cybereason Defender here</a>.
<ul style="font-size: 18px;">
<li aria-level="2">For Cybereason customers: More details <a href="https://nest.cybereason.com/knowledgebase/3343711" rel="noopener" target="_blank"><span>available on the NEST</span></a> including custom threat hunting queries for detecting this threat.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3><strong>Magniber Ransomware</strong></h3>
<p>The Cybereason GSOC recommends the following:</p>
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><span style="font-size: 18px;">Enable the <em>Anti-Ransomware</em> feature of the Cybereason platform by setting it to <em>Suspend</em> or <em>Prevent</em>. The <a href="/platform" rel="noopener" target="_blank">Cybereason Defense Platform</a> detects the Magniber ransomware using multi-layer protection that detects and blocks ransomware with threat intelligence, machine learning, and next-gen antivirus (NGAV) capabilities.</span></li>
<li aria-level="1"><span style="font-size: 18px;">Consider additional, proactive ways for detecting the presence of the Magniber ransomware in systems and defending against this threat, such as <a href="https://github.com/VirusTotal/yara/" rel="noopener" target="_blank">YARA</a>-based detection or mutex object locking.</span></li>
<li aria-level="1"><span style="font-size: 18px;">Threat Hunting with Cybereason: The Cybereason MDR team provides its customers with custom hunting queries for detecting specific threats - to find out more about threat hunting and <a href="/platform/managed-detection-response-mdr" rel="noopener" target="_blank">Managed Detection and Response</a> with the Cybereason Defense Platform, <a href="/services/managed-detection-response-mdr#form" rel="noopener" target="_blank">contact a Cybereason Defender here</a>.</span>
<ul>
<li aria-level="2"><span style="font-size: 18px;">For Cybereason customers: More details <a href="https://nest.cybereason.com/knowledgebase/3343711" rel="noopener" target="_blank">available on the NEST</a> including custom threat hunting queries for detecting this threat.</span></li>
</ul>
</li>
</ul>
</li>
</ul>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-10.png?width=939&amp;name=PrintNightmare-Magniber-Ransomware-image-10.png" alt="PrintNightmare-Magniber-Ransomware-image-10" width="939" loading="lazy" style="width: 939px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-10.png?width=470&amp;name=PrintNightmare-Magniber-Ransomware-image-10.png 470w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-10.png?width=939&amp;name=PrintNightmare-Magniber-Ransomware-image-10.png 939w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-10.png?width=1409&amp;name=PrintNightmare-Magniber-Ransomware-image-10.png 1409w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-10.png?width=1878&amp;name=PrintNightmare-Magniber-Ransomware-image-10.png 1878w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-10.png?width=2348&amp;name=PrintNightmare-Magniber-Ransomware-image-10.png 2348w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-10.png?width=2817&amp;name=PrintNightmare-Magniber-Ransomware-image-10.png 2817w" sizes="(max-width: 939px) 100vw, 939px"><em><span style="font-size: 16px;">The Cybereason Defense Platform detects the Magniber ransomware based on threat intelligence</span></em></p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-11.png?width=932&amp;name=PrintNightmare-Magniber-Ransomware-image-11.png" alt="PrintNightmare-Magniber-Ransomware-image-11" width="932" loading="lazy" style="width: 932px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-11.png?width=466&amp;name=PrintNightmare-Magniber-Ransomware-image-11.png 466w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-11.png?width=932&amp;name=PrintNightmare-Magniber-Ransomware-image-11.png 932w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-11.png?width=1398&amp;name=PrintNightmare-Magniber-Ransomware-image-11.png 1398w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-11.png?width=1864&amp;name=PrintNightmare-Magniber-Ransomware-image-11.png 1864w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-11.png?width=2330&amp;name=PrintNightmare-Magniber-Ransomware-image-11.png 2330w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/PrintNightmare-Magniber-Ransomware-image-11.png?width=2796&amp;name=PrintNightmare-Magniber-Ransomware-image-11.png 2796w" sizes="(max-width: 932px) 100vw, 932px"><em><span style="font-size: 16px;">The Anti-Ransomware feature of the Cybereason Defense Platform detects the Magniber ransomware</span></em></p>
<h3><strong>YARA-Based Detection</strong></h3>
<p>The following YARA rule is useful for detecting the presence of the Magniber ransomware in the context of running processes or in the filesystem:</p>
<div data-hs-responsive-table="true" style="overflow-x: auto; max-width: 100%; width: 61%; margin-left: auto; margin-right: auto;">
<table style="width: 100%; border-collapse: collapse; table-layout: fixed; border: 1px solid #99acc2; height: 599.484px;">
<tbody>
<tr style="height: 597.984px;">
<td style="width: 100%; padding: 4px; height: 598px;">
<p style="font-size: 14px; line-height: 1;">rule Magniber_ransomware</p>
<p style="font-size: 14px; line-height: 1;">{</p>
<p style="font-size: 14px; line-height: 1;">meta:</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;description = "YARA rule for identifying the Magniber ransomware."</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;author = "Aleksandar Milenkoski"</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;date = "2021-08"</p>
<br>
<p style="font-size: 14px; line-height: 1;">strings:</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;$code1 = { C7 45 F0 4C 8B D1 B8 C7 45 F4 00 00 00 00 66 C7 45 F8 0F 05 C6 45 FA C3 }</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;$code2 = { 81 F9 39 38 00 00 ?? ?? ?? ?? ?? ?? 81 F9 D7 3A 00 00 ?? ?? ?? ?? ?? ?? 81 F9 AB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;3F 00 00 ?? ?? ?? ?? ?? ?? 81 F9 EE 42 00 00 ?? ?? ?? ?? ?? ?? 81 F9 63 45 00 00 ?? ?? ??</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;??&nbsp; ??&nbsp; ?? 81 F9 BA 47 00 00 }</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;$code3 = { 83 3C 25 6C 02 FE 7F 0A }</p>
<br>
<p style="font-size: 14px; line-height: 1;">condition:</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $code3 and 2 of</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;($code1,$code2)</p>
<p style="font-size: 14px; line-height: 1;">}</p>
</td>
</tr>
</tbody>
</table>
</div>
<p style="text-align: center; font-size: 16px;"><em>YARA rule for identifying the Magniber ransomware</em></p>
<h3><strong>Mutex Object Locking</strong></h3>
<p>Magniber creates and locks a mutex object named, for example, <em>zarkzonn</em> or <em>dihlxbl</em>, such that the name of the mutex is different for different versions of the Magniber ransomware. If this mutex object already exists and is therefore locked, the ransomware terminates without encrypting any data.</p>
<p>This is to the advantage of defenders, as a mutex object named, for example, <em>zarkzonn</em> or <em>dihlxbl</em>, can be locked by a legitimate process on a given system with the intention to stop any potential future execution of the Magniber ransomware on the system.</p>
<p>The PowerShell script below demonstrates this defense technique. The script creates, opens, and locks a mutex object named <em>dihlxbl</em>, and releases the object when the user issues the <em>Ctrl+C</em> command. Users can execute the script by issuing the command <em>powershell.exe ./magniber_mutex_lock.ps1 </em>in the directory where the script file is stored, where <em>magniber_mutex_lock.ps1</em> is the filename of the script file:</p>
<div data-hs-responsive-table="true" style="overflow-x: auto; max-width: 100%; width: 100%; margin-left: auto; margin-right: auto;">
<div aria-roledescription="list item" role="group" id="1632325488.002500" data-qa="virtual-list-item" tabindex="-1">
<div role="presentation" data-qa="message_container" data-qa-unprocessed="false" data-qa-placeholder="false">
<div role="document" aria-roledescription="message" data-qa-hover="true">
<div role="presentation" data-qa="message_content">
<div data-qa="block-kit-renderer">
<div dir="auto">
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2; border-width: 1px; border-style: solid;">
<tbody>
<tr>
<td>
<p style="font-size: 14px; line-height: 1;">function create_mutex</p>
<p style="font-size: 14px; line-height: 1;">{</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;$created = $False</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;$mutex = New-Object -TypeName System.Threading.Mutex($true, "dihlxbl", [ref]$created)</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;Write-Host "Mutex object named dihlxbl created, opened, and locked: $created."</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;return $mutex</p>
<p style="font-size: 14px; line-height: 1;">}</p>
<p style="font-size: 14px; line-height: 1;">function release_mutex</p>
<p style="font-size: 14px; line-height: 1;">{</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;param (</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$mutex</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;)</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;$mutex.ReleaseMutex()</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;$mutex.Dispose()</p>
<p style="font-size: 14px; line-height: 1;">}</p>
<p style="font-size: 14px; line-height: 1;">$mutex = create_mutex</p>
<p style="font-size: 14px; line-height: 1;">try</p>
<p style="font-size: 14px; line-height: 1;">{</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;while($true)</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;{</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Start-Sleep -Seconds 1</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p style="font-size: 14px; line-height: 1;">}</p>
<p style="font-size: 14px; line-height: 1;">finally{</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;release_mutex($mutex)</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;Write-Host "Mutex object released."</p>
<p style="font-size: 14px; line-height: 1;">}</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p style="text-align: center; font-size: 16px;"><em>PowerShell script that locks a mutex object named dihlxbl</em></p>
<h2><strong>General Recommendations</strong></h2>
<p>In addition to specific recommendations for PrintNightmare and the Magniber ransomware, Cybereason offers the following general security recommendations:</p>
<ul>
<li style="list-style-type: none;">
<ul style="font-size: 18px;">
<li aria-level="1">Make sure your systems are timely patched in order to minimise the risk of ransomware infections by vulnerability exploitation.</li>
<li aria-level="1">Use secure passwords, regularly rotate passwords, and use multi-factor authentication where possible.&nbsp;</li>
<li aria-level="1">Regularly backup files to a secured remote location and implement a data recovery plan. Regular data backups ensure that you can restore your data after a ransomware attack.&nbsp;</li>
<li aria-level="1">Securely handle email messages that originate from external sources. This includes disabling hyperlinks and investigating email message content to identify phishing attempts.&nbsp;&nbsp;</li>
</ul>
</li>
</ul>
<p>Cybereason is dedicated to teaming with defenders to end cyber attacks from endpoints to the enterprise to everywhere—including modern ransomware.<a href="/platform/anti-ransomware" style="text-decoration: none;" rel="noopener" target="_blank"> Learn more about ransomware defense here</a> or<a href="/request-a-demo" style="text-decoration: none;" rel="noopener" target="_blank"> schedule a demo today</a> to learn how your organization can benefit from an<a href="/blog/the-cybereason-malop-achieving-operation-centric-security" style="text-decoration: none;" rel="noopener" target="_blank"> operation-centric approach</a> to security.</p>
<h2 style="text-align: left;"><strong>Indicators of Compromise</strong></h2>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2;">
<tbody>
<tr>
<td style="border: 0.99609pt solid #000000;">
<p><strong>Executables</strong></p>
</td>
<td style="border: 0.99609pt solid #000000;">
<p>SHA-256 hash:&nbsp;</p>
<p><em>10B9B1D8F6BAFD9BB57CCFB1DA4A658F10207D566781FA5FB3C4394D283E860E</em></p>
<br>
<p>File size: 21504 bytes</p>
</td>
</tr>
<tr>
<td style="border: 0.99609pt solid #000000;">
<p><strong>Associated files</strong></p>
</td>
<td style="border: 0.99609pt solid #000000;">
<p><em>readme.txt</em></p>
</td>
</tr>
<tr>
<td style="border: 0.99609pt solid #000000;">
<p><strong>Mutex objects</strong></p>
</td>
<td style="border: 0.99609pt solid #000000;">
<p><em>dihlxbl</em></p>
</td>
</tr>
<tr>
<td style="border: 0.99609pt solid #000000;">
<p><strong>File name extensions</strong></p>
</td>
<td style="border: 0.99609pt solid #000000;">
<p><em>dihlxbl</em></p>
</td>
</tr>
<tr>
<td style="border: 0.99609pt solid #000000;">
<p><strong>Domains</strong></p>
</td>
<td style="border: 0.99609pt solid #000000;">
<p><em>l5nmxg2syswnc6s3724evnip5uktj7msy3pgowkbcidbei3nbysi7ead.onion</em></p>
<br>
<p><em>uponmix.xyz</em></p>
<br>
<p><em>flysex.space</em></p>
<br>
<p><em>partscs.site</em></p>
<br>
<p><em>codehes.uno</em></p>
</td>
</tr>
<tr>
<td style="border: 0.99609pt solid #000000;">
<p><strong>Registry keys</strong></p>
</td>
<td style="border: 0.99609pt solid #000000;">
<p><em>HKCU\Software\Classes\ms-settings\shell\open\command\(Default)</em></p>
<br>
<p><em>HKCU\Software\Classes\mscfile\shell\open\command\(Default)</em></p>
<br>
<p><em>HKCU\Software\Classes\ms-settings\shell\open\command\DelegateExecute</em></p>
</td>
</tr>
</tbody>
</table>
<h2><br><br><strong>MITRE ATT&amp;CK Techniques</strong></h2>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2; height: 307.453px;">
<tbody>
<tr style="height: 48.9844px;">
<td style="background-color: #f1c232; border: 1pt solid #000000; height: 49px; width: 120px;">
<p><strong>Execution</strong></p>
</td>
<td style="background-color: #f1c232; border: 1pt solid #000000; height: 49px; width: 246px;">
<p><strong>Privilege Escalation</strong></p>
</td>
<td style="background-color: #f1c232; border: 1pt solid #000000; height: 49px; width: 369px;">
<p><strong>Defense Evasion</strong></p>
</td>
<td style="background-color: #f1c232; border: 1pt solid #000000; height: 49px; width: 126px;">
<p><strong>Discovery</strong></p>
</td>
<td style="background-color: #f1c232; border: 1pt solid #000000; height: 49px; width: 165px;">
<p><strong>Impact</strong></p>
</td>
</tr>
<tr style="height: 103.992px;">
<td style="border: 1pt solid #000000; height: 104px; width: 120px;">
<p><a href="https://attack.mitre.org/techniques/T1106/" rel="noopener" target="_blank"><span>Native API</span></a></p>
</td>
<td style="border: 1pt solid #000000; height: 104px; width: 246px;">
<p><a href="https://attack.mitre.org/techniques/T1548/002/" rel="noopener" target="_blank"><span>Abuse Elevation Control Mechanism: Bypass User Account Control</span></a></p>
</td>
<td style="border: 1pt solid #000000; height: 104px; width: 369px;">
<p><a href="https://attack.mitre.org/techniques/T1070/004/" rel="noopener" target="_blank"><span>Indicator Removal on Host: File Deletion</span></a></p>
</td>
<td style="border: 1pt solid #000000; height: 104px; width: 126px;">
<p><a href="https://attack.mitre.org/techniques/T1083/" rel="noopener" target="_blank"><span>File and Directory Discovery</span></a></p>
</td>
<td style="border: 1pt solid #000000; height: 104px; width: 165px;">
<p><a href="https://attack.mitre.org/techniques/T1486/" rel="noopener" target="_blank"><span>Data Encrypted for Impact</span></a></p>
</td>
</tr>
<tr style="height: 48.9844px;">
<td style="border: 1pt solid #000000; height: 49px; width: 120px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 49px; width: 246px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 49px; width: 369px;">
<p><a href="https://attack.mitre.org/techniques/T1112/" rel="noopener" target="_blank"><span>Modify registry</span></a></p>
</td>
<td style="border: 1pt solid #000000; height: 49px; width: 126px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 49px; width: 165px;">&nbsp;</td>
</tr>
<tr style="height: 103.992px;">
<td style="border: 1pt solid #000000; height: 104px; width: 120px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 104px; width: 246px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 104px; width: 369px;">
<p><a href="https://attack.mitre.org/techniques/T1027/002/" rel="noopener" target="_blank"><span>Obfuscated Files or Information: Software Packing</span></a></p>
</td>
<td style="border: 1pt solid #000000; height: 104px; width: 126px;">&nbsp;</td>
<td style="border: 1pt solid #000000; height: 104px; width: 165px;">&nbsp;</td>
</tr>
</tbody>
</table>
<p><br><br></p>
<h2><strong>About the Researchers:</strong></h2>
<p><strong>Aleksandar Milenkoski, Senior Threat and Malware Analyst, Cybereason Global SOC</strong></p>
<p><img class="no-border" src="https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-53-53-18-PM.png?width=97&amp;name=unnamed-Sep-14-2021-08-53-53-18-PM.png" alt="unnamed-Sep-14-2021-08-53-53-18-PM" width="97" loading="lazy" style="width: 97px; float: left; margin: 0px 7px 1px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-53-53-18-PM.png?width=49&amp;name=unnamed-Sep-14-2021-08-53-53-18-PM.png 49w, https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-53-53-18-PM.png?width=97&amp;name=unnamed-Sep-14-2021-08-53-53-18-PM.png 97w, https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-53-53-18-PM.png?width=146&amp;name=unnamed-Sep-14-2021-08-53-53-18-PM.png 146w, https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-53-53-18-PM.png?width=194&amp;name=unnamed-Sep-14-2021-08-53-53-18-PM.png 194w, https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-53-53-18-PM.png?width=243&amp;name=unnamed-Sep-14-2021-08-53-53-18-PM.png 243w, https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-53-53-18-PM.png?width=291&amp;name=unnamed-Sep-14-2021-08-53-53-18-PM.png 291w" sizes="(max-width: 97px) 100vw, 97px">Aleksandar Milenkoski is a Senior Threat and Malware Analyst with the Cybereason Global SOC team. He is involved primarily in reverse engineering and threat research activities. Aleksandar has a PhD in system security. Prior to Cybereason, his work focussed on research in intrusion detection and reverse engineering security mechanisms of the Windows 10 operating system.</p>
<p><strong>Eli Salem, Senior Security Analyst, Cybereason Global SOC</strong></p>
<p><img class="no-border" src="https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-55-30-03-PM.png?width=85&amp;name=unnamed-Sep-14-2021-08-55-30-03-PM.png" alt="unnamed-Sep-14-2021-08-55-30-03-PM" width="85" loading="lazy" style="width: 85px; float: left; margin: 0px 7px 1px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-55-30-03-PM.png?width=43&amp;name=unnamed-Sep-14-2021-08-55-30-03-PM.png 43w, https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-55-30-03-PM.png?width=85&amp;name=unnamed-Sep-14-2021-08-55-30-03-PM.png 85w, https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-55-30-03-PM.png?width=128&amp;name=unnamed-Sep-14-2021-08-55-30-03-PM.png 128w, https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-55-30-03-PM.png?width=170&amp;name=unnamed-Sep-14-2021-08-55-30-03-PM.png 170w, https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-55-30-03-PM.png?width=213&amp;name=unnamed-Sep-14-2021-08-55-30-03-PM.png 213w, https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-55-30-03-PM.png?width=255&amp;name=unnamed-Sep-14-2021-08-55-30-03-PM.png 255w" sizes="(max-width: 85px) 100vw, 85px">Eli is a lead threat hunter and malware reverse engineer at Cybereason. He has worked in the private sector of the cyber security industry since 2017. In his free time, he publishes articles about malware research and threat hunting.</p></span>
          
          <!-- IOC PopUp Modal -->
          
          
          
          <!-- -->
          
          <!-- Social Share -->
          <div class="cr-blog-post__social-sharing">
            <span>Share</span>
            <div id="hs_cos_wrapper_module_161724375084957" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-social_sharing" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">






<div class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_social_sharing" data-hs-cos-general-type="widget" data-hs-cos-type="social_sharing">
  
	
  
    
    
    
			
		

    <a href="https://twitter.com/intent/tweet?original_referer=https://www.cybereason.com/blog/threat-analysis-report-printnightmare-and-magniber-ransomware&amp;utm_medium=social&amp;utm_source=twitter&amp;url=https://www.cybereason.com/blog/threat-analysis-report-printnightmare-and-magniber-ransomware&amp;utm_medium=social&amp;utm_source=twitter&amp;source=tweetbutton&amp;text=" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/twitter-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on twitter">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.facebook.com/share.php?u=https://www.cybereason.com/blog/threat-analysis-report-printnightmare-and-magniber-ransomware&amp;utm_medium=social&amp;utm_source=facebook" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/facebook-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on facebook">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.cybereason.com/blog/threat-analysis-report-printnightmare-and-magniber-ransomware&amp;utm_medium=social&amp;utm_source=linkedin" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/linkedin-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on linkedin">
    </a>
	

</div></div>
          </div> 
          
          
          <!-- CONDITIONAL Author Box Display -->
            <div class="container columns cr-mln__author-listing-single">
              
                <div class="column headshot is-3-full-hd is-3-desktop is-3-tablet is-12-mobile">
                  <img class="cr-speaker-headshot" src="https://www.cybereason.com/hubfs/Capture-4.png" alt="Cybereason Global SOC Team">
                </div>
              
              <div class="column is-9-full-hd is-9-desktop is-12-mobile">
                <span class="descriptor">About the Author</span>
                <h4>Cybereason Global SOC Team</h4>
                
                
                
                  <p>The Cybereason Global SOC Team delivers 24/7 Managed Detection and Response services to customers on every continent. Led by cybersecurity experts with experience working for government, the military and multiple industry verticals, the Cybereason Global SOC Team continuously hunts for the most sophisticated and pervasive threats to support our mission to end cyberattacks on the endpoint, across the enterprise, and everywhere the battle moves.</p>
                
                
                  <a class="cr-button cr-button__min" href="https://www.cybereason.com/blog/authors/cybereason-global-soc-team">All Posts by Cybereason Global SOC Team</a>
                
              </div>            
            </div>
          
        <!-- CONDITIONAL Post Type Choices -->
        
        <!-- Malicious Life Post -->
        
        
        <!-- CISO Stories -->
        
        <!-- Webinar -->
        
          
        <!-- CONDITIONAL Transcript -->
          
        
         <!-- Related Posts -->
        <div id="hs_cos_wrapper_module_1649342860525315" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<section class="cr-section related-posts__wrapper">
  <div class="container container-is-blog page-center">
     <h3>Related Posts</h3>
     <div class="columns is-multiline">
       
  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/threat-analysis-report-socgholish-and-zloader-from-fake-updates-and-installers-to-owning-your-systems"><img src="https://www.cybereason.com/hubfs/blog-post-text%20%2884%29.png" alt="THREAT ANALYSIS REPORT: SocGholish and Zloader – From Fake Updates and Installers to Owning Your Systems"></a>
    <h4><a href="https://www.cybereason.com/blog/threat-analysis-report-socgholish-and-zloader-from-fake-updates-and-installers-to-owning-your-systems"><span class="underline">THREAT ANALYSIS REPORT: SocGholish and Zloader – From Fake Updates and Installers to Owning Your Systems</span></a></h4>
     <p>This report provides unique insight into SocGholish and Zloader attacks and provides an overview of the common tactics and techniques in SocGholish infections...</p>
   </div>
 </div>


  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/threat-analysis-msi-masquerading-as-software-installer"><img src="https://www.cybereason.com/hubfs/MSI%20Masquerading%20as%20a%20Malicious%20Software%20Installer%20blog.png" alt="Threat Analysis: MSI - Masquerading as a Software Installer"></a>
    <h4><a href="https://www.cybereason.com/blog/threat-analysis-msi-masquerading-as-software-installer"><span class="underline">Threat Analysis: MSI - Masquerading as a Software Installer</span></a></h4>
     <p>Learn how threat actors are embedding malicious binaries and scripts in legitimate Microsoft Windows Installation (.msi) files to take over machines they're targeting with elevated privileges. Find out how to detect this sophisticated attack technique. </p>
   </div>
 </div>



    </div>
  </div>
</section></div>
          
          
      </div>
        
        <!-- Sidebar -->

      <div class="column is-3-fullhd is-3-desktop is-12-mobile cr-malicious-life-network__sidebar">
        <div class="cr-ml-sidebar--group">
        <div class="top-stripe"></div>
        <div class="sidebar-block search-section">
          <form action="/hs-search-results">
            <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search">
            <input type="hidden" name="type" value="BLOG_POST">
            <input type="hidden" name="type" value="LISTING_PAGE">
            <button type="submit" class="arrow"></button>
          </form>
        </div>
        <div class="sidebar-block subscribe">
          <a href="#blog-subscribe">
            <h4>Subscribe</h4>
            <span>Never miss a blog.</span>
          </a>
        </div>

        <div class="sidebar-block recent-posts">
          <h4>Recent Posts</h4>
          
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/malicious-life-podcast-operation-snow-white-part-2" class="post-name"><span class="underline">Malicious Life Podcast: Operation Snow White, Part 2</span></a>
                       
                    </div>
                </div>
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/threat-analysis-beast-ransomware" class="post-name"><span class="underline">THREAT ANALYSIS: Beast Ransomware</span></a>
                       
                    </div>
                </div>
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/cuckoo-spear-pt2-threat-actor-arsenal" class="post-name"><span class="underline">CUCKOO SPEAR Part 2: Threat Actor Arsenal</span></a>
                       
                    </div>
                </div>
            
        </div>

        <div class="sidebar-block category-listing">
          <h4>Categories</h4>
          <ul>
            <li><a href="https://www.cybereason.com/blog/category/research">Research</a></li>
            <li><a href="https://www.cybereason.com/blog/category/podcasts">Podcasts</a></li>
            <li><a href="https://www.cybereason.com/blog/category/webinars">Webinars</a></li>
            <li><a href="https://www.cybereason.com/blog/category/resources">Resources</a></li>
            <li><a href="https://www.cybereason.com/blog/category/videos">Videos</a></li>
            <li><a href="https://www.cybereason.com/blog/category/news">News</a></li>
          </ul>

          <a class="rec-category__single--view-all" href="/blog/category/research">All Posts</a>
        </div>

        
      </div><!-- END .rec-categories__all -->
      
      
      
    </div>
       
    </div>
  </div>
</div></div>

</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="display: none;" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1616011887658867" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<section class="cr-section related-posts__wrapper">
  <div class="container container-is-blog page-center">
     <h3>Related Posts</h3>
     <div class="columns is-multiline">
       
  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/threat-analysis-report-socgholish-and-zloader-from-fake-updates-and-installers-to-owning-your-systems"><img src="https://www.cybereason.com/hubfs/blog-post-text%20%2884%29.png" alt="THREAT ANALYSIS REPORT: SocGholish and Zloader – From Fake Updates and Installers to Owning Your Systems"></a>
    <h4><a href="https://www.cybereason.com/blog/threat-analysis-report-socgholish-and-zloader-from-fake-updates-and-installers-to-owning-your-systems"><span class="underline">THREAT ANALYSIS REPORT: SocGholish and Zloader – From Fake Updates and Installers to Owning Your Systems</span></a></h4>
     <p>This report provides unique insight into SocGholish and Zloader attacks and provides an overview of the common tactics and techniques in SocGholish infections...</p>
   </div>
 </div>


  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/threat-analysis-msi-masquerading-as-software-installer"><img src="https://www.cybereason.com/hubfs/MSI%20Masquerading%20as%20a%20Malicious%20Software%20Installer%20blog.png" alt="Threat Analysis: MSI - Masquerading as a Software Installer"></a>
    <h4><a href="https://www.cybereason.com/blog/threat-analysis-msi-masquerading-as-software-installer"><span class="underline">Threat Analysis: MSI - Masquerading as a Software Installer</span></a></h4>
     <p>Learn how threat actors are embedding malicious binaries and scripts in legitimate Microsoft Windows Installation (.msi) files to take over machines they're targeting with elevated privileges. Find out how to detect this sophisticated attack technique. </p>
   </div>
 </div>



    </div>
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-3 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_161767462015235" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-blog_subscribe" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-mln__blog-listing-page__subscribe-footer">
  <div class="container container-is-blog columns page-center">
    <div class="column is-8-fullhd is-8-desktop is-10-tablet is-12-mobile">
      <span class="tag">NEWSLETTER</span>
      <h3>Never miss a blog</h3>
      <p>Get the latest research, expert insights, and security industry news.</p>
      <a class="cr-button cr-mln__subscribe" href="#blog-subscribe">Subscribe</a>
    </div>
    <!--<div class="column is-5-fullhd is-5-desktop is-half-tablet is-12-mobile is-offset-1-fullhd is-offset-1-desktop">
      <div class="inputs-wrapper">
        
        
      </div>
    </div>-->
  </div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-4 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_166508001252918" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-sticky-cta-bar bg-black" id="sticky-bar">
  <div class="content">
    <span>Want to see the Cybereason Defense Platform in action?</span>
    <a class="cr-button cr-button__fill-yellow" href="https://www.cybereason.com/request-a-demo" target="_blank">Schedule a Demo</a>
  </div>
  <div class="close">X</div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end body -->
</div><!--end body wrapper -->

<div class="footer-container-wrapper">
    <div class="footer-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_16036762394194314" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><!-- FOOTER -->

<footer class="cr-section cr-footer cr-footer__full">
    <div class="container page-center">
      <div class="columns">
          <div class="column is-6-fullhd is-5-desktop cr-footer__col cr-footer__left">
            <div class="cr-footer__Left-logo">
              
                <a href="https://www.cybereason.com">
                  
                <img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-logo-inline--primary-white.png">
              </a>
            </div>
          </div>
          <div class="columns column is-6-fullhd is-6-desktop cr-footer__col cr-footer__right">
            <div class="cr-footer__links-list column">
              <h4>About</h4>
              <ul>
                <li><a href="https://www.cybereason.com/company/who-we-are">Who We Are</a>
                </li><li><a href="https://www.cybereason.com/company/careers">Careers</a>
          <!-- </li><li><a href="https://www.cybereason.com/company/leadership">Leadership</a> --->
                </li><li><a href="https://www.cybereason.com/company/contact-us">Contact</a>
              </li></ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Resources</h4>
              <ul>
                <li><a href="https://www.cybereason.com/blog">Blog</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/case-study">Case Studies</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/webinars">Webinars</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/white-papers">White Papers</a></li>
             </ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Platform</h4>
              <ul>
                
                <li><a href="https://www.cybereason.com/platform">Overview</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-prevention">Endpoint Protection</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-detection-response-edr">EDR</a></li>
                <li><a href="https://www.cybereason.com/platform/managed-detection-response-mdr">MDR</a></li>
              </ul>
            </div>
          </div>
      </div>
    </div>
  
    <div class="container page-center">
      <div class="columns cr-footer__bottom-bar">
        <div class="column">
          <p>©Cybereason 2024. All Rights Reserved.</p>
        </div>
        <div class="column bottom-bar__links">
          <ul>
            <li><a href="https://www.cybereason.com/terms-of-use">Terms of Use</a></li>
            <li><a href="https://www.cybereason.com/privacy-notice">Privacy Notice</a></li>
            <li><a href="https://www.cybereason.com/ccpa-privacy-request">Do Not Sell</a></li>
            <li><a href="https://www.cybereason.com/security">Security</a></li>
            <!--<li><a href="#">Cookie Policy</a></li>-->
          </ul>
        </div>

        <div class="column bottom-bar__social">
          <ul>
            <li><a class="facebook" href="https://www.facebook.com/Cybereason/"></a></li>
            <li><a class="twitter" href="https://twitter.com/cybereason"></a></li>
            <li><a class="youtube" href="https://www.youtube.com/channel/UCOm7AaB0HiNH4Phe66sK0Ew"></a></li>
            <li><a class="linkedin" href="https://www.linkedin.com/company/cybereason"></a></li>
            <li><a class="instagram" href="https://www.instagram.com/cybereason"></a></li>
          </ul>
        </div>
    </div>
  </div>

</footer></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end footer -->
</div><!--end footer wrapper -->

    
<!-- HubSpot performance collection script -->
<script defer src="https://static.hsappstatic.net/content-cwv-embed/static-1.1293/embed.js"></script>
<script src="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42507089303/1644440411417/__CR_Web_Platform/JS/animatedModal/animatedModal.min.js"></script>
<script>
var hsVars = hsVars || {}; hsVars['language'] = 'en';
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.53/bundles/project.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41681847227/1644941386128/module_41681847227_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41682410610/1644941443113/module_41682410610_CR_-_Malicious_Life_Network_--_Main_Hero.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/43300360745/1724042213858/module_43300360745_CR_-_Malicious_Life_Network_--_Related_Posts.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/86933076631/1669911113440/module_86933076631_CR_-_Sticky_CTA_Bar.min.js"></script>

<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "blog-post"]);
_hsq.push(["setCanonicalUrl", "https:\/\/www.cybereason.com\/blog\/threat-analysis-report-printnightmare-and-magniber-ransomware"]);
_hsq.push(["setPageId", "55822442330"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 55822442330,
    "legacyPageId": "55822442330",
    "contentFolderId": null,
    "contentGroupId": 5272851739,
    "abTestId": null,
    "languageVariantId": 55822442330,
    "languageCode": "en",
    
    
}]);
</script>

<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/3354902.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    render_id: "9b72ccdd-8d49-4a7f-8e71-e50f6aecf606",
    ticks: 1729740476886,
    page_id: 55822442330,
    
    content_group_id: 5272851739,
    portal_id: 3354902,
    app_hs_base_url: "https://app.hubspot.com",
    cp_hs_base_url: "https://cp.hubspot.com",
    language: "en",
    analytics_page_type: "blog-post",
    scp_content_type: "",
    analytics_page_id: "55822442330",
    category_id: 3,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.354/js/index.js"></script>

<script>if ($('[id^="hs_form"]').length > 0) {
  var myInterval = setInterval(
  function() {
    var myFields = document.getElementsByClassName('hs-input');
    if (myFields.length > 0) {
      clearInterval(myInterval);
      for (var i = 0; i < myFields.length; i++) {
        var myField = myFields[i];
		var myTagName = myField.tagName.toLowerCase();
        if (myTagName == 'input' || myTagName == 'textarea') {
          if (myField.placeholder != null) {
            myField.placeholder = myField.placeholder.replace('*', '');
          }
        } else if (myTagName == 'select') {
          myField.options[0].innerHTML = myField.options[0].innerHTML.replace('*', '');
        }
      }
    }
  }, 100);
}
</script>

<div id="fb-root"></div>
  <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v3.0";
  fjs.parentNode.insertBefore(js, fjs);
 }(document, 'script', 'facebook-jssdk'));</script> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
 


    <script>
function sticky_relocate() {
  var window_top = $(window).scrollTop();
  var div_top = $('#sticky-anchor').offset().top;
  if (window_top > div_top) {
    $('#sticky').addClass('stick');
  } else {
    $('#sticky').removeClass('stick');
  }
}

$(function() {
  $(window).scroll(sticky_relocate);
  sticky_relocate();
});
</script>
    <!-- Generated by the HubSpot Template Builder - template version 1.03 -->

<script type="text/javascript" src="/_Incapsula_Resource?SWJIYLWA=719d34d31c8e3a6e6fffd425f7e032f3&ns=4&cb=582550319" async></script></body></html>