<!doctype html>

<!--[if lt IE 7]><html lang="en-US" prefix="og: https://ogp.me/ns#"><![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html lang="en-US" prefix="og: https://ogp.me/ns#"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html lang="en-US" prefix="og: https://ogp.me/ns#"><![endif]-->
<!--[if gt IE 8]><!--> <html lang="en-US" prefix="og: https://ogp.me/ns#"><!--<![endif]-->

	<head>
		<meta charset="utf-8">

				<meta http-equiv="X-UA-Compatible" content="IE=edge">

		<title>Familiar Feeling: A Malware Campaign Targeting the Tibetan Diaspora Resurfaces - The Citizen Lab</title>

		<meta name="HandheldFriendly" content="True">
		<meta name="MobileOptimized" content="320">
		<meta name="viewport" content="width=device-width, initial-scale=1"/>

		<link rel="apple-touch-icon" sizes="57x57" href="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/images/apple-icon-57x57.png">
		<link rel="apple-touch-icon" sizes="60x60" href="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/images/apple-icon-60x60.png">
		<link rel="apple-touch-icon" sizes="72x72" href="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/images/apple-icon-72x72.png">
		<link rel="apple-touch-icon" sizes="76x76" href="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/images/apple-icon-76x76.png">
		<link rel="apple-touch-icon" sizes="114x114" href="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/images/apple-icon-114x114.png">
		<link rel="apple-touch-icon" sizes="120x120" href="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/images/apple-icon-120x120.png">
		<link rel="apple-touch-icon" sizes="144x144" href="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/images/apple-icon-144x144.png">
		<link rel="apple-touch-icon" sizes="152x152" href="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/images/apple-icon-152x152.png">
		<link rel="apple-touch-icon" sizes="180x180" href="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/images/apple-icon-180x180.png">
		<link rel="icon" type="image/png" sizes="192x192"  href="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/images/android-icon-192x192.png">
		<link rel="icon" type="image/png" sizes="32x32" href="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/images/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="96x96" href="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/images/favicon-96x96.png">
		<link rel="icon" type="image/png" sizes="16x16" href="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/images/favicon-16x16.png">
		<link rel="manifest" href="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/images/manifest.json">
		<meta name="msapplication-TileColor" content="#ffffff">
		<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
		<meta name="theme-color" content="#ffffff">
		<!--[if IE]>
			<link rel="shortcut icon" href="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/favicon.ico">
		<![endif]-->
		
		<link rel="pingback" href="https://citizenlab.ca/xmlrpc.php">

				
<!-- Search Engine Optimization by Rank Math PRO - https://rankmath.com/ -->
<meta name="description" content="Investigation of a malware campaign targeting the Tibetan community and discussion of the challenges in analyzing closed espionage ecosystems."/>
<meta name="robots" content="follow, index, max-snippet:-1, max-video-preview:-1, max-image-preview:large"/>
<link rel="canonical" href="https://citizenlab.ca/2018/08/familiar-feeling-a-malware-campaign-targeting-the-tibetan-diaspora-resurfaces/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Familiar Feeling: A Malware Campaign Targeting the Tibetan Diaspora Resurfaces - The Citizen Lab" />
<meta property="og:description" content="Investigation of a malware campaign targeting the Tibetan community and discussion of the challenges in analyzing closed espionage ecosystems." />
<meta property="og:url" content="https://citizenlab.ca/2018/08/familiar-feeling-a-malware-campaign-targeting-the-tibetan-diaspora-resurfaces/" />
<meta property="og:site_name" content="The Citizen Lab" />
<meta property="article:tag" content="China" />
<meta property="article:tag" content="Espionage" />
<meta property="article:tag" content="KeyBoy" />
<meta property="article:tag" content="Malware" />
<meta property="article:tag" content="Tibet" />
<meta property="article:tag" content="Tropic Trooper" />
<meta property="article:section" content="Targeted Threats" />
<meta property="og:updated_time" content="2020-06-24T14:18:53-04:00" />
<meta property="og:image" content="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Featured-image.png&amp;nocache=1" />
<meta property="og:image:secure_url" content="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Featured-image.png&amp;nocache=1" />
<meta property="og:image:width" content="605" />
<meta property="og:image:height" content="340" />
<meta property="og:image:alt" content="Tibert" />
<meta property="og:image:type" content="image/png" />
<meta property="article:published_time" content="2018-08-08T09:00:06-04:00" />
<meta property="article:modified_time" content="2020-06-24T14:18:53-04:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Familiar Feeling: A Malware Campaign Targeting the Tibetan Diaspora Resurfaces - The Citizen Lab" />
<meta name="twitter:description" content="Investigation of a malware campaign targeting the Tibetan community and discussion of the challenges in analyzing closed espionage ecosystems." />
<meta name="twitter:site" content="@citizenlab" />
<meta name="twitter:creator" content="@citizenlab" />
<meta name="twitter:image" content="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Featured-image.png&amp;nocache=1" />
<meta name="twitter:label1" content="Written by" />
<meta name="twitter:data1" content="Masashi Crete-Nishihata" />
<meta name="twitter:label2" content="Time to read" />
<meta name="twitter:data2" content="31 minutes" />
<script type="application/ld+json" class="rank-math-schema-pro">{"@context":"https://schema.org","@graph":[{"@type":["CollegeOrUniversity","Organization"],"@id":"https://citizenlab.ca/#organization","name":"The Citizen Lab","url":"https://citizenlab.ca","sameAs":["https://twitter.com/citizenlab"],"logo":{"@type":"ImageObject","@id":"https://citizenlab.ca/#logo","url":"https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2019/02/citlablogo.png&amp;nocache=1","contentUrl":"https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2019/02/citlablogo.png&amp;nocache=1","caption":"The Citizen Lab","inLanguage":"en-US","width":"7824","height":"5216"}},{"@type":"WebSite","@id":"https://citizenlab.ca/#website","url":"https://citizenlab.ca","name":"The Citizen Lab","publisher":{"@id":"https://citizenlab.ca/#organization"},"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Featured-image.png&amp;nocache=1","url":"https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Featured-image.png&amp;nocache=1","width":"605","height":"340","inLanguage":"en-US"},{"@type":"WebPage","@id":"https://citizenlab.ca/2018/08/familiar-feeling-a-malware-campaign-targeting-the-tibetan-diaspora-resurfaces/#webpage","url":"https://citizenlab.ca/2018/08/familiar-feeling-a-malware-campaign-targeting-the-tibetan-diaspora-resurfaces/","name":"Familiar Feeling: A Malware Campaign Targeting the Tibetan Diaspora Resurfaces - The Citizen Lab","datePublished":"2018-08-08T09:00:06-04:00","dateModified":"2020-06-24T14:18:53-04:00","isPartOf":{"@id":"https://citizenlab.ca/#website"},"primaryImageOfPage":{"@id":"https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Featured-image.png&amp;nocache=1"},"inLanguage":"en-US"},{"@type":"Person","@id":"https://citizenlab.ca/author/masashi/","name":"Masashi Crete-Nishihata","url":"https://citizenlab.ca/author/masashi/","image":{"@type":"ImageObject","@id":"https://secure.gravatar.com/avatar/567ae50439a44302c85bedfa00ea7d3c?s=96&amp;d=mm&amp;r=g","url":"https://secure.gravatar.com/avatar/567ae50439a44302c85bedfa00ea7d3c?s=96&amp;d=mm&amp;r=g","caption":"Masashi Crete-Nishihata","inLanguage":"en-US"},"worksFor":{"@id":"https://citizenlab.ca/#organization"}},{"@type":"BlogPosting","headline":"Familiar Feeling: A Malware Campaign Targeting the Tibetan Diaspora Resurfaces - The Citizen Lab","keywords":"Tibert","datePublished":"2018-08-08T09:00:06-04:00","dateModified":"2020-06-24T14:18:53-04:00","author":{"@id":"https://citizenlab.ca/author/masashi/","name":"Masashi Crete-Nishihata"},"publisher":{"@id":"https://citizenlab.ca/#organization"},"description":"Investigation of a malware campaign targeting the Tibetan community and discussion of the challenges in analyzing closed espionage ecosystems.","name":"Familiar Feeling: A Malware Campaign Targeting the Tibetan Diaspora Resurfaces - The Citizen Lab","@id":"https://citizenlab.ca/2018/08/familiar-feeling-a-malware-campaign-targeting-the-tibetan-diaspora-resurfaces/#richSnippet","isPartOf":{"@id":"https://citizenlab.ca/2018/08/familiar-feeling-a-malware-campaign-targeting-the-tibetan-diaspora-resurfaces/#webpage"},"image":{"@id":"https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Featured-image.png&amp;nocache=1"},"inLanguage":"en-US","mainEntityOfPage":{"@id":"https://citizenlab.ca/2018/08/familiar-feeling-a-malware-campaign-targeting-the-tibetan-diaspora-resurfaces/#webpage"}}]}</script>
<!-- /Rank Math WordPress SEO plugin -->

<link rel="alternate" type="application/rss+xml" title="The Citizen Lab &raquo; Feed" href="https://citizenlab.ca/feed/" />
<link rel="alternate" type="application/rss+xml" title="The Citizen Lab &raquo; Comments Feed" href="https://citizenlab.ca/comments/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/citizenlab.ca\/wp-includes\/js\/wp-emoji-release.min.js"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://citizenlab.ca/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='co-authors-plus-coauthors-style-inline-css' type='text/css'>
.wp-block-co-authors-plus-coauthors.is-layout-flow [class*=wp-block-co-authors-plus]{display:inline}

</style>
<style id='co-authors-plus-avatar-style-inline-css' type='text/css'>
.wp-block-co-authors-plus-avatar :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-avatar :where(img){vertical-align:middle}.wp-block-co-authors-plus-avatar:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-avatar.aligncenter{display:table;margin-inline:auto}

</style>
<style id='co-authors-plus-image-style-inline-css' type='text/css'>
.wp-block-co-authors-plus-image{margin-bottom:0}.wp-block-co-authors-plus-image :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-image :where(img){vertical-align:middle}.wp-block-co-authors-plus-image:is(.alignfull,.alignwide) :where(img){width:100%}.wp-block-co-authors-plus-image:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-image.aligncenter{display:table;margin-inline:auto}

</style>
<style id='rank-math-toc-block-style-inline-css' type='text/css'>
.wp-block-rank-math-toc-block nav ol{counter-reset:item}.wp-block-rank-math-toc-block nav ol li{display:block}.wp-block-rank-math-toc-block nav ol li:before{content:counters(item, ".") ". ";counter-increment:item}

</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='bigfoot-number-css' href='https://citizenlab.ca/wp-content/plugins/bigfoot_footnotes/library/bigfoot-number.css' type='text/css' media='all' />
<link rel='stylesheet' id='__EPYT__style-css' href='https://citizenlab.ca/wp-content/plugins/youtube-embed-plus/styles/ytprefs.min.css' type='text/css' media='all' />
<style id='__EPYT__style-inline-css' type='text/css'>

                .epyt-gallery-thumb {
                        width: 33.333%;
                }
                
</style>
<link rel='stylesheet' id='bones-base-stylesheet-css' href='https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/css/tachyons.css' type='text/css' media='all' />
<link rel='stylesheet' id='bones-stylesheet-css' href='https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/css/style.css' type='text/css' media='all' />
<!--[if lt IE 9]>
<link rel='stylesheet' id='bones-ie-only-css' href='https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/css/ie.css' type='text/css' media='all' />
<![endif]-->
<link rel='stylesheet' id='fontawesome-all-css' href='https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/fontawesome/css/all.min.css' type='text/css' media='all' />
<script type="text/javascript" src="https://citizenlab.ca/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="text/javascript" src="https://citizenlab.ca/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="text/javascript" id="__ytprefs__-js-extra">
/* <![CDATA[ */
var _EPYT_ = {"ajaxurl":"https:\/\/citizenlab.ca\/wp-admin\/admin-ajax.php","security":"6f69080839","gallery_scrolloffset":"20","eppathtoscripts":"https:\/\/citizenlab.ca\/wp-content\/plugins\/youtube-embed-plus\/scripts\/","eppath":"https:\/\/citizenlab.ca\/wp-content\/plugins\/youtube-embed-plus\/","epresponsiveselector":"[\"iframe.__youtube_prefs__\",\"iframe[src*='youtube.com']\",\"iframe[src*='youtube-nocookie.com']\",\"iframe[data-ep-src*='youtube.com']\",\"iframe[data-ep-src*='youtube-nocookie.com']\",\"iframe[data-ep-gallerysrc*='youtube.com']\"]","epdovol":"1","version":"14.2.1.2","evselector":"iframe.__youtube_prefs__[src], iframe[src*=\"youtube.com\/embed\/\"], iframe[src*=\"youtube-nocookie.com\/embed\/\"]","ajax_compat":"","maxres_facade":"eager","ytapi_load":"light","pause_others":"","stopMobileBuffer":"1","facade_mode":"","not_live_on_channel":"","vi_active":"","vi_js_posttypes":[]};
/* ]]> */
</script>
<script type="text/javascript" src="https://citizenlab.ca/wp-content/plugins/youtube-embed-plus/scripts/ytprefs.min.js" id="__ytprefs__-js"></script>
<script type="text/javascript" src="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/js/libs/modernizr.custom.min.js" id="bones-modernizr-js"></script>
<link rel='shortlink' href='https://citizenlab.ca/?p=70929' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://citizenlab.ca/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fcitizenlab.ca%2F2018%2F08%2Ffamiliar-feeling-a-malware-campaign-targeting-the-tibetan-diaspora-resurfaces%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://citizenlab.ca/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fcitizenlab.ca%2F2018%2F08%2Ffamiliar-feeling-a-malware-campaign-targeting-the-tibetan-diaspora-resurfaces%2F&#038;format=xml" />
<!-- Related Posts for WP Premium CSS -->
<style type='text/css'>
.rp4wp-related-posts { width:100%; overflow:hidden;}ul.rp4wp-posts-list {width:100%; margin:0 !important; padding:0 !important; list-style:none !important; float:left;}ul.rp4wp-posts-list .rp4wp-col {width:100% !important;margin-bottom:30px !important;list-style:none !important;box-sizing:border-box;overflow:hidden;float:left;}.rp4wp_component_wrapper {width:100% !important;float:left;}.rp4wp_component {width:100% !important;padding:0 0 5% !important;box-sizing:border-box;float:left;overflow:hidden !important;}.rp4wp_component a {border:0 !important;}.rp4wp_component_image a {display:block; height:100% !important;} .rp4wp_component_image img {width:100% !important;height:100% !important;}.rp4wp_component_title a {text-decoration:none !important; font-weight:bold; border:0 !important;}@media (min-width: 768px) {ul.rp4wp-posts-list .rp4wp-col {width:101% !important;padding:0 2% !important;}ul.rp4wp-posts-list .rp4wp-col-first {width:99% !important;padding-left:0 !important;padding-right:2% !important;}ul.rp4wp-posts-list .rp4wp-col-last {width:99% !important;padding-right:0 !important;padding-left:2% !important;}.rp4wp_component_wrapper {width:50% !important;}.rp4wp_component_wrapper_left {padding-right:5% !important;}.rp4wp_component_wrapper_right {padding-left:5% !important;}}.rp4wp_component_2{height:20% !important;}ul.rp4wp-posts-list .rp4wp-col {padding-left:0 !important; margin:0 !important}.rp4wp_component, .rp4wp_component_2 {height:auto !important; padding:0.1rem 0 !important; margin:0}.rp4wp_component_title a {font-weight:normal; text-decoration: underline}.rp4wp-col {float:none; padding:0;}
</style>
<script type="text/javascript" id="google_gtagjs" src="https://www.googletagmanager.com/gtag/js?id=G-RCDQQLPVF0" async="async"></script>
<script type="text/javascript" id="google_gtagjs-inline">
/* <![CDATA[ */
window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-RCDQQLPVF0', {'anonymize_ip': true} );
/* ]]> */
</script>
		
				
	</head>

	<body itemscope itemtype="http://schema.org/WebPage">

		<!-- <div class="mw-12 pv3 ph3 pv3-l ph6-l bg-lab-dark-brown"> -->

			<header id="header" role="banner" itemscope itemtype="http://schema.org/WPHeader">

				<div id="header__inner" class="flex-ns items-center justify-between">

										<div class="v-mid flex justify-between items-center">
						<div class="mr-auto">
							<a href="https://citizenlab.ca" rel="nofollow"							id="logo" itemscope itemtype="http://schema.org/Organization">
								<img src="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/images/CL-logo-3-headed.png" alt="The Citizen Lab"/>
							</a>
							<img src="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/images/MunkSchool-WHT.png" class="munk-logo" alt="Munk School of Global Affairs & Public Policy | University of Toronto" />
						</div>
						<!-- Visible on mobile -->
						<a href="#main-menu" id="homepage" aria-label="Open main menu">
							<span class="fa-solid fa-bars-staggered white dib" title="Open Menu"></span>
							<span class="screen-reader-text">Open main menu</span>
						</a>
					</div>

					<!-- Main navigation menu -->
					<a class="skip-main" href="#main">Skip to main content</a>
					<div class="flex-ns main-menu" id="main-menu">
						
						<a href="#homepage" id="homepage" class="menu-close" aria-label="Close main menu">
							<span class="fa-solid fa-x white dib" title="Close Menu"></span>
							<span class="screen-reader-text">Close main menu</span>
						</a>



						<nav id="nav-main" role="navigation" itemscope itemtype="http://schema.org/SiteNavigationElement" class="tc tl-l">
							<ul id="menu-top-menu" class="list ma0 mt2 mt0-ns pa0 b dib-ns list pa0"><li id="menu-item-29705" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-29705 dib-ns f5-l f4 ttu pv2 "><a href="https://citizenlab.ca/category/research/" class="white no-underline h-underline pr2 ml0">Research</a>
<ul class="sub-menu">
	<li id="menu-item-72358" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-72358 dib-ns f5-l f4 ttu pv2 "><a href="https://citizenlab.ca/category/research/targeted-threats/" class="white no-underline h-underline pr2">Targeted Threats</a></li>
	<li id="menu-item-72357" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-72357 dib-ns f5-l f4 ttu pv2 "><a href="https://citizenlab.ca/category/research/free-expression-online/" class="white no-underline h-underline pr2 mr0">Free Expression Online</a></li>
	<li id="menu-item-72359" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-72359 dib-ns f5-l f4 ttu pv2 "><a href="https://citizenlab.ca/category/research/transparency/" class="white no-underline h-underline pr2">Transparency and Accountability</a></li>
	<li id="menu-item-72360" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-72360 dib-ns f5-l f4 ttu pv2 "><a href="https://citizenlab.ca/category/research/app-privacy-and-security/" class="white no-underline h-underline pr2">App Privacy and Controls</a></li>
	<li id="menu-item-72362" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-72362 dib-ns f5-l f4 ttu pv2 "><a href="https://citizenlab.ca/category/research/global-research-network/" class="white no-underline h-underline pr2">Global Research Network</a></li>
	<li id="menu-item-72385" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-72385 dib-ns f5-l f4 ttu pv2 "><a href="https://citizenlab.ca/category/research/tools-resources/" class="white no-underline h-underline pr2">Tools &amp; Resources</a></li>
	<li id="menu-item-72361" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-72361 dib-ns f5-l f4 ttu pv2 "><a href="https://citizenlab.ca/publications/" class="white no-underline h-underline pr2">Publications</a></li>
</ul>
</li>
<li id="menu-item-29706" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-29706 dib-ns f5-l f4 ttu pv2 "><a href="https://citizenlab.ca/category/lab-news/" class="white no-underline h-underline pr2">News</a>
<ul class="sub-menu">
	<li id="menu-item-72363" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-72363 dib-ns f5-l f4 ttu pv2 "><a href="https://citizenlab.ca/category/lab-news/mentions/" class="white no-underline h-underline pr2">In the Media</a></li>
	<li id="menu-item-72364" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-72364 dib-ns f5-l f4 ttu pv2 "><a href="https://citizenlab.ca/category/lab-news/events/" class="white no-underline h-underline pr2">Events</a></li>
	<li id="menu-item-72365" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-72365 dib-ns f5-l f4 ttu pv2 "><a href="https://citizenlab.ca/category/lab-news/opportunities/" class="white no-underline h-underline pr2">Opportunities</a></li>
</ul>
</li>
<li id="menu-item-29707" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-29707 dib-ns f5-l f4 ttu pv2 "><a href="https://citizenlab.ca/about/" class="white no-underline h-underline pr2">About</a>
<ul class="sub-menu">
	<li id="menu-item-72367" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-72367 dib-ns f5-l f4 ttu pv2 "><a href="https://citizenlab.ca/about/" class="white no-underline h-underline pr2">About The Citizen Lab</a></li>
	<li id="menu-item-72368" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-72368 dib-ns f5-l f4 ttu pv2 "><a href="https://citizenlab.ca/media/" class="white no-underline h-underline pr2">Media Resources</a></li>
	<li id="menu-item-72369" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-72369 dib-ns f5-l f4 ttu pv2 "><a href="https://citizenlab.ca/people/" class="white no-underline h-underline pr2">People</a></li>
	<li id="menu-item-72370" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-72370 dib-ns f5-l f4 ttu pv2 "><a href="https://citizenlab.ca/teaching/" class="white no-underline h-underline pr2">Teaching</a></li>
	<li id="menu-item-72387" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-72387 dib-ns f5-l f4 ttu pv2 "><a href="https://engage.utoronto.ca/site/SPageServer?pagename=donate#/fund/847" class="white no-underline h-underline pr2">Donate</a></li>
	<li id="menu-item-74537" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-74537 dib-ns f5-l f4 ttu pv2 "><a href="https://citizenlab.ca/disclosure-of-security-vulnerabilities/" class="white no-underline h-underline pr2">Security Vulnerabilities</a></li>
</ul>
</li>
</ul>
						</nav>

						<!-- Search bar -->
						<div class="flex items-start justify-center searchbar">
							<form class="db-l ma0 pa0 b0 lh0 f5" role="search" method="get" id="menuSearchform" action="https://citizenlab.ca/">

								<div id="menuSearchContainer" class="ml3 dib w0 transition-width overflow-hidden">
									<input type="search"  id="menuSearch" name="s" value="" class="b--none ma0 pa1 w5" placeholder="Search"/>
								</div> <!--end of menuSearchContainer-->
							</form>
							<div id="menuSearchButton" class="db-l ml3 pointer items-end">
								<span class="fa-solid fa-magnifying-glass white" aria-label="Search" title="Search"></span>
							</div>
						</div> <!--end of searchbar-->

					</div> <!--end of main-menu -->
				</div> <!-- end of header__inner -->
			</header>
    <!-- </div> -->
    <div id="container" class="pa3 pv4-l ph5-l"> <!--TODO move to stylesheet -->
		<main id="main" role="main" itemscope itemprop="mainContentOfPage" itemtype="http://schema.org/Blog">
			<section id="content" class="container">


						
							

     <article id="post-70929" dir="ltr" 70929role="article" itemscope itemprop="blogPost" itemtype="http://schema.org/BlogPosting" class="lh-copy">

        <header>
          <span class="f6 mt0" dir="ltr"><a href="https://citizenlab.ca/category/research/" class="breadcrumbs link"><a href="https://citizenlab.ca/category/research/" class="breadcrumbs link">Research</a><span class="fa-solid fa-chevron-right mh2" aria-hidden="true"></span></a><a href="https://citizenlab.ca/category/research/targeted-threats/" class="breadcrumbs link">Targeted Threats</a></span>
            <h1 itemprop="headline" rel="bookmark" class="ma0 mt5 lh-title">
            	<!-- Title -->
	<span class="db f2 f1-ns black lh-solid">Familiar Feeling</span>
	<!-- Subtitle -->
	<span class="db f4 f2-ns mid-gray mt2 lh-title oswald-regular"> A Malware Campaign Targeting the Tibetan Diaspora Resurfaces</span>
	            </h1>
            <div dir="ltr" class="mt2">
              
            <div class="f5 mr4 b dark-gray dib">By 
            <a href="https://citizenlab.ca/author/geoffreyalexander/" title="Posts by Geoffrey Alexander" class="author url fn" rel="author">Geoffrey Alexander</a>, <a href="https://citizenlab.ca/author/mattbrooks/" title="Posts by Matt Brooks" class="author url fn" rel="author">Matt Brooks</a>, <a href="https://citizenlab.ca/author/masashi/" title="Posts by Masashi Crete-Nishihata" class="author url fn" rel="author">Masashi Crete-Nishihata</a>, <a href="https://citizenlab.ca/author/etiennemaynier/" title="Posts by Etienne Maynier" class="author url fn" rel="author">Etienne Maynier</a>, <a href="https://citizenlab.ca/author/jsrailton/" title="Posts by John Scott-Railton" class="author url fn" rel="author">John Scott-Railton</a>, and <a href="https://citizenlab.ca/author/profd/" title="Posts by Ron Deibert" class="author url fn" rel="author">Ron Deibert</a></div>          

          <time class="dark-gray dib f5 mr4" datetime="2018-08-08" itemprop="datePublished">August 8, 2018</time>
          <!-- Display other versions of the post -->
                      </div>

          <!-- Display the link for the PDF version of the post -->
                          <div>

                   <a class="f6 link br1 ba ph3 pv2 mb2 mt2 dib black hover-bg-lightest-blue hover-black" href="https://tspace.library.utoronto.ca/bitstream/1807/95392/1/Report%23111--familiar%20feeling.pdf" target="" title="Download Download this report">Download this report</a>

                </div>
                
        </header>         
                <section itemprop="articleBody" class="article-body mb4 mt4 pt2 bt b--light-gray">
                  <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><h1 id="key-findings" class=" lh-solid mb3">Key Findings</h1>
<ul class="mt0">
<li class="mt2">This report analyzes a malware campaign active between January to March 2018 that targeted Tibetan activists, journalists, members of the Tibetan Parliament in exile, and the Central Tibetan Administration.</li>
<li class="mt2">We detail a successful intrusion of a Tibetan NGO and provide a brief analysis of the operator&rsquo;s actions post-infection.</li>
<li class="mt2">This recent campaign, as well as a campaign we reported in 2016, both have connections to a wider operation called &ldquo;Tropic Trooper&rdquo;. The strength and meaning of these connections is assessed.</li>
<li class="mt2">We examine the challenges associated with investigating closed espionage ecosystems and the importance of accurately describing the players and the harms they cause.</li>
</ul>
<h1 id="introduction" class=" lh-solid mb3">Introduction</h1>
<p class="mt0">In January 2018, a Tibetan activist received a mundane-looking email purporting to be program updates from a human rights NGO. Attached to the message were a PowerPoint presentation and a document. The activist, like many in the Tibetan diaspora, had grown wary of unsolicited emails with attachments, and instead of opening the documents, shared the files with Citizen Lab researchers.</p>
<p>The suspicion was warranted: the attachments were malicious. If clicked, the files would run recent exploits to infect Windows computers with custom malware. This email was the start of a malware campaign active between January to March 2018 that targeted Tibetan activists, journalists, members of the <a href="https://en.wikipedia.org/wiki/Parliament_of_the_Central_Tibetan_Administration" class="pointer" target="_blank" rel="noopener">Tibetan Parliament in exile</a>, and the <a href="https://en.wikipedia.org/wiki/Central_Tibetan_Administration" class="pointer" target="_blank" rel="noopener">Central Tibetan Administration</a>. We worked closely with the targeted groups to collect the malicious messages, and also engaged in incident response with a compromised organization. This collaboration enabled us to gain further insights into the tactics, techniques, and procedures used by the operators.</p>
<p>The campaign used social engineering to trick targets into opening exploit-laden PowerPoint (<a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882" class="pointer" target="_blank" rel="noopener">CVE-2017-0199</a>) and Microsoft Rich Text Format (RTF) documents (<a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-0199" class="pointer" target="_blank" rel="noopener">CVE-2017-11882</a>) attached to e-mail messages. The malware includes a PowerShell payload we call DMShell++, a backdoor known as <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/" class="pointer" target="_blank" rel="noopener">TSSL</a>, and a post-compromise tool we call DSNGInstaller.</p>
<p>We call this recent campaign the &ldquo;Resurfaced Campaign&rdquo; because of connections to a <a href="https://citizenlab.ca/2016/11/parliament-keyboy/" class="pointer">2016 campaign</a> that targeted Tibetan Parliamentarians (which we refer to as the &ldquo;Parliamentary Campaign&rdquo;). These connections suggest that the same group may be involved or tools and infrastructure are being shared between multiple groups.</p>
<h2 id="tibetan-diaspora-a-highly-targeted-community" class=" lh-solid mb3">Tibetan Diaspora: A Highly Targeted Community</h2>
<p class="mt0">The threat of digital espionage has become a persistent reality for the Tibetan diaspora, which has been targeted by malware campaigns for over a <a href="https://citizenlab.ca/wp-content/uploads/2017/05/ghostnet.pdf" class="pointer">decade</a>. Historically, these operations have relied heavily on malicious attachments that leverage <a href="https://targetedthreats.net/" class="pointer" target="_blank" rel="noopener">known exploits and basic Remote Access Trojans</a> (RATs). This tactic may reflect a basic risk-reward calculation when targeting under-resourced civil society groups: if they are using unpatched systems, why run the risk of exposing more sophisticated technical tools when simple ones will do? The operators instead appear to <a href="https://www.usenix.org/system/files/conference/usenixsecurity14/sec14-paper-hardy.pdf" class="pointer" target="_blank" rel="noopener">focus much of their innovation</a> on clever social engineering paired with a &ldquo;just enough&rdquo; approach to tooling. The limited technical innovation that we observe may be driven by the pragmatic need to continue to achieve access and permanence, rather than more sophisticated goals such as obscuring malware authorship or resisting decompiling.</p>
<h3 id="shifting-tactics" class=" lh-solid mb3">Shifting Tactics?</h3>
<p class="mt0">Since 2016, the number of reported targeted malware campaigns against Tibetan groups has dropped significantly. In place of targeted malware, we have observed a <a href="https://citizenlab.ca/2018/01/spying-on-a-budget-inside-a-phishing-operation-with-targets-in-the-tibetan-community/" class="pointer">shift to phishing</a> designed to harvest credentials from online accounts. A notable exception to this change is the <a href="https://citizenlab.ca/2016/11/parliament-keyboy/" class="pointer">Parliamentary Campaign</a>, which used known and patched exploits to deliver custom malware called KeyBoy. The Resurfaced Campaign is the first targeted malware activity against the Tibetan community we have observed since the Parliamentary Campaign.</p>
<h3 id="familiar-connections" class=" lh-solid mb3">Familiar Connections</h3>
<p class="mt0">The Resurfaced Campaign used different exploits and payloads than the Parliamentary Campaign but shares other connections. The two campaigns used similar spear phishing messages and both targeted Tibetan parliamentarians. One of the e-mail addresses used to send spear phishing messages in the Resurfaced Campaign (<code>tibetanparliarnent[@]yahoo.com</code>) was also used repeatedly during the Parliamentary Campaign.</p>
<p>Based on the use of common tools and code similarities, both campaigns are also connected to a wider operation called &ldquo;Tropic Trooper&rdquo; that has been active since at least 2012 and was first reported by <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/operation-tropic-trooper-old-vulnerabilities-still-pack-a-punch/" class="pointer" target="_blank" rel="noopener">Trend Micro in 2015</a>. Tropic Trooper has targeted governments and companies in Taiwan and the Philippines and is usually identified through the use of specific malware including <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/operation-tropic-trooper-old-vulnerabilities-still-pack-a-punch/" class="pointer" target="_blank" rel="noopener">Yahaoyah</a>, <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/operation-tropic-trooper-old-vulnerabilities-still-pack-a-punch/" class="pointer" target="_blank" rel="noopener">Yahamam</a>, and <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/" class="pointer" target="_blank" rel="noopener">TSSL</a>. The Resurfaced Campaign is linked to Tropic Trooper through its use of TSSL. The Parliamentary Campaign is linked through code similarities between Keyboy and Yahaoyah. <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/operation-tropic-trooper-old-vulnerabilities-still-pack-a-punch/" class="pointer" target="_blank" rel="noopener">Trend Micro</a> noted Yahoyah shared the same algorithm for encoding configuration files as versions of <a href="https://blog.rapid7.com/2013/06/07/keyboy-targeted-attacks-against-vietnam-and-india/" class="pointer" target="_blank" rel="noopener">KeyBoy found in 2013</a>.</p>
<p>If the same threat actor is behind the Resurfaced and Parliamentary Campaigns, the operators appear to have engaged in limited and incremental changes to their tools. Nevertheless, these improvements are minor, and are unlikely to represent significant costs. The exploit code and PowerShell code used in the campaign were publicly available. Proofs of concept of the exploits exist on Github, and DMShell++ (the PowerShell payload) is based on example code posted online.</p>
<h2 id="closed-espionage-ecosystems-an-analytical-challenge" class=" lh-solid mb3">Closed Espionage Ecosystems: An analytical challenge</h2>
<p class="mt0">These types of campaigns use custom built malware that originate from a <em>closed espionage ecosystem</em> in which the parties involved <em>(e.g</em>., developers who write the malware, operators who conduct the campaigns, and intelligence customers who incentivize the activity) are difficult to identify and fully segment. Intelligence customers may be actively managing the development of tools and selection of targets or may be passive consumers who the operators know are interested in and will pay for information from certain targets. The cost and effort put into closed espionage ecosystems is harder to quantify than commoditized malware kits (such as cybercrime tools repurposed for <a href="https://citizenlab.ca/2012/06/syrian-activists-targeted-with-blackshades-spy-software/" class="pointer">espionage</a>) or government exclusive malware (such as products from <a href="https://citizenlab.ca/2016/08/million-dollar-dissident-iphone-zero-day-nso-group-uae/" class="pointer">NSO Group</a>) which have defined prices and markets.</p>
<p>&ldquo;Actors&rdquo; in closed espionage ecosystems are abstractions typically identified by the use of common tools and infrastructure. This level of attribution can help cluster incidents together into recognizable patterns and indicators. However, many burglars can, at different times, use the same crowbar. For example, seemingly disparate campaigns and threat actors may be linked through what FireEye describes as a &ldquo;<a href="https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-malware-supply-chain.pdf" class="pointer" target="_blank" rel="noopener">digital quartermaster</a>&rdquo;, which refers to a resource of malware development and infrastructure that is shared amongst multiple campaigns and groups. Knowing what tools and tactics are leveraged in malware campaigns can provide insight into technical capabilities and allow an analyst to track activities over time, but this knowledge alone does not explain how information collected by the operators is ultimately used by the intelligence customer nor the types of harm that can follow for civil society.</p>
<p>This report is organized into the following sections:</p>
<p><strong>Part 1: Resurfaced Campaign</strong> describes the Resurfaced Campaign that targeted Tibetan groups between January and March 2018.</p>
<p><strong>Part 2: Investigating a Compromise</strong> describes a compromise of a Tibetan NGO and analyzes operator actions post-infection.</p>
<p><strong>Part 3: Familiar Connections</strong> highlights connections between the Parliamentary and Resurfaced Campaigns to an operation called &ldquo;Tropic Trooper&rdquo;.</p>
<p><strong>Part 4: Closed Espionage Ecosystems and Identifying Harm</strong> discusses challenges in analyzing closed espionage ecosystems and situates our investigation within wider trends of digital espionage operations against the Tibetan diaspora.</p>
<h1 id="part-1-resurfaced-campaign" class=" lh-solid mb3">Part 1: Resurfaced Campaign</h1>
<p class="mt0"><em>This section describes the Resurfaced Campaign that targeted Tibetan groups between January and March 2018. </em></p>
<h2 id="campaign-overview" class=" lh-solid mb3">Campaign Overview</h2>
<p class="mt0">We observed the Resurfaced Campaign from January 16 to March 2, 2018 and collected seven spear phishing emails sent to Tibetan activists, journalists, members of the Tibetan Parliament in exile, and the Central Tibetan Administration (CTA).</p>
<p>The messages were sent from email addresses that mimicked staff of Tibetan NGOs or the CTA, and shared content on advocacy activities, cultural events, and administrative announcements. We verified that some of this information was publicly available on social media, whereas other information may have been collected from public correspondence or private messages that could have been previously stolen by the operators. A January 22 spear phishing email was sent from <code>tibetanparliarnent[@]yahoo.com</code>, which was also used to send multiple spear phishing emails in the <a href="https://citizenlab.ca/2016/11/parliament-keyboy/" class="pointer">Parliamentary Campaign</a> (see Figure 1).</p>
<figure class="center mw-100 ba b--light-gray" style="width:989px;"><div class="tc pa2 bg-white"><a href="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-1.png&amp;nocache=1" class="pointer"><img fetchpriority="high" decoding="async" class="size-full wp-image-70939" src="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-1.png&amp;nocache=1" alt="" width="989" height="368" title="Familiar Feeling: A Malware Campaign Targeting the Tibetan Diaspora Resurfaces 1" srcset="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-1.png&amp;nocache=1 989w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-1-300x112.png&amp;nocache=1 300w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-1-768x286.png&amp;nocache=1 768w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-1-180x67.png&amp;nocache=1 180w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-1-605x225.png&amp;nocache=1 605w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-1-297x111.png&amp;nocache=1 297w" sizes="(max-width: 989px) 100vw, 989px" /></a></div><figcaption class="f5-ns f6 black-70 pa2 bg-light-gray">Figure 1: Spear phishing email sent on January 22 2018 that reuses an email address that was used in the 2016 Parliamentary Campaign.</figcaption></figure>
<p>While both the Parliamentary Campaign and the Resurfaced Campaign used similar social engineering tactics and a common email address to send spear phishing messages, the Resurfaced campaign used a different, newer malware toolkit. In six of the eight intrusion attempts, the operator sent a Microsoft PowerPoint file exploiting a vulnerability disclosed in 2017 (<a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-0199" class="pointer" target="_blank" rel="noopener">CVE-2017-0199</a>) designed to drop a payload written in Microsoft&rsquo;s PowerShell scripting language from a remote server. In two early intrusions attempts in January 2018, the operator also used an exploit for RTF documents (<a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882" class="pointer" target="_blank" rel="noopener">CVE-2017-11882</a>).</p>
<p>Figure 2 provides a timeline of the Resurfaced Campaign highlighting when spear phishing emails were sent and the exploits that were used.</p>
<figure class="center mw-100 ba b--light-gray" style="width:788px;"><div class="tc pa2 bg-white"><a href="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-2.png&amp;nocache=1" class="pointer"><img decoding="async" class="size-full wp-image-70940" src="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-2.png&amp;nocache=1" alt="" width="788" height="728" title="Familiar Feeling: A Malware Campaign Targeting the Tibetan Diaspora Resurfaces 2" srcset="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-2.png&amp;nocache=1 788w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-2-300x277.png&amp;nocache=1 300w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-2-768x710.png&amp;nocache=1 768w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-2-180x166.png&amp;nocache=1 180w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-2-368x340.png&amp;nocache=1 368w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-2-215x199.png&amp;nocache=1 215w" sizes="(max-width: 788px) 100vw, 788px" /></a></div><figcaption class="f5-ns f6 black-70 pa2 bg-light-gray">Figure 2: Timeline of spear phishing emails sent in the Resurfaced Campaign.</figcaption></figure>
<h2 id="infection-chain-cve-2017-0199-and-dmshell" class=" lh-solid mb3">Infection Chain: CVE-2017-0199 and DMShell++</h2>
<p class="mt0">The most common infection chain in the campaign was the use of a PowerPoint Open XML Slide Show file (PPSX) exploiting <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-0199" class="pointer" target="_blank" rel="noopener">CVE-2017-0199</a> to load a remote payload we call DMShell++, a basic TCP reverse shell written in Microsoft&rsquo;s PowerShell scripting language. We observed a very similar, albeit more simple, implementation of DMShell++ on a public posting on Wooyun (a Chinese hacker forum<a id="fnref1" class="pointer" href="#fn1"><sup>1</sup></a>) by an author with the username &ldquo;DM_&rdquo;. We refer to the version discovered in our investigation as &ldquo;DMShell++&rdquo; in reference to the Wooyun username combined with the fact that the Wooyun version has been incrementally updated with additional basic commands.</p>
<p>We observed versions of DMShell++ hosted on the domains enumerated in Table 1. However, we did not monitor these domains continuously and therefore it is possible that the operator may have used additional configurations not listed in the table.</p>
<figure class="center mw-100 table-overflow" style="min-width: 50%"><table border="0" cellspacing="0" style="" class=" ba b--light-gray">
<tbody>
<tr class="striped--light-gray">
<th align="left"><strong>Date Observed</strong></th>
<th align="left"><strong>Source</strong></th>
<th align="left"><strong>C2 Configuration</strong></th>
</tr>
<tr class="striped--light-gray">
<td align="left">January 18, 2018</td>
<td align="left"><code>commail[.]co:5453/qqqzqa</code></td>
<td align="left"><code>27.126.186.222:6001</code>
<p><code>27.126.186.222:6002</code></p>
<p><code>27.126.186.222:6003</code></p></td>
</tr>
<tr class="striped--light-gray">
<td align="left">January 22, 2018</td>
<td align="left"><code>tibetnews[.]info:8026/qqqzqa</code></td>
<td align="left"><code>103.55.24.196:80</code>
<p><code>103.55.24.196:443</code></p>
<p><code>45.127.97.222:443</code></p></td>
</tr>
<tr class="striped--light-gray">
<td align="left">February 2, 2018</td>
<td align="left"><code>commail[.]co:5453/qqqzqa</code></td>
<td align="left"><code>27.126.186.222:80</code>
<p><code>27.126.186.222:443</code></p>
<p><code>27.126.186.222:8080</code></p></td>
</tr>
<tr class="striped--light-gray">
<td align="left">March 6, 2018</td>
<td align="left"><code>comemails[.]email:1234/hgf</code></td>
<td align="left"><code>203.189.232.207:80</code>
<p><code>203.189.232.207:443</code></p>
<p><code>103.55.24.196:443</code></p></td>
</tr>
</tbody>
</table></figure>
<p>Table 1: List of C2 configurations observed in different DMShell++ samples</p>
<p>The versions of DMShell++ we observed had the same capabilities but different configurations for command and control. Table 2 provides an overview of capabilities of DMShell++ and how it could be used by an operator (technical details are included in <a href="#appendix-a-dmshell" class="pointer">Appendix A</a>). This basic script gives the remote actor vast control over the victim computer. Initially deploying generic payloads hides true capabilities and intentions from defenders should the attempted intrusion be detected at this stage.</p>
<figure class="center mw-100 table-overflow" style="min-width: 50%"><table border="0" cellspacing="0" style="" class=" ba b--light-gray">
<tbody>
<tr class="striped--light-gray">
<th align="left"><strong>Capability</strong></th>
<th align="left"><strong>Purpose to the Operator</strong></th>
</tr>
<tr class="striped--light-gray">
<td align="left">Collect system information
<ul>
<li class="mt2">Internal IP address</li>
<li class="mt2">Operating system (OS) version</li>
<li class="mt2">User name</li>
</ul>
</td>
<td align="left">Collecting system information helps the operator assess if they have the correct target and learn about potential weaknesses in the computer&rsquo;s OS.</td>
</tr>
<tr class="striped--light-gray">
<td align="left">Execute remote commands</td>
<td align="left">Executing remote commands provides additional reconnaissance information that can help the operator determine their next steps.</td>
</tr>
<tr class="striped--light-gray">
<td align="left">Send additional files</td>
<td align="left">The ability to send additional files means the operator can download additional tools with different capabilities.</td>
</tr>
<tr class="striped--light-gray">
<td align="left">Extract data</td>
<td align="left">Stealing files from the target machine is likely the operator&rsquo;s ultimate goal.</td>
</tr>
</tbody>
</table></figure>
<p>Table 2: Overview of DMShell++ capabilities</p>
<h2 id="infection-chain-cve-2017-11882-and-dmshell" class=" lh-solid mb3">Infection Chain: CVE-2017-11882 and DMShell++</h2>
<p class="mt0">In two spear phishing emails sent early in the campaign, the operator used a second exploit document in addition to the PPSX files described previously to deploy DMShell++. It is unclear why the operator used this secondary method. However, given the amount of time between patches being released for both vulnerabilities, as well as the different methods being used to execute the PowerShell payload, it is possible the operator wanted to maximize success while testing both exploitation methods.</p>
<p>The second document was a RTF document designed to exploit <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882" class="pointer" target="_blank" rel="noopener">CVE-2017-11882</a>. In this case, instead of loading the PowerShell script from a remote location, this exploit document followed a more traditional infection chain by attempting to write an executable (EXE) program to the target computer. The EXE program was designed to create a small PowerShell script on the target computer to decode and execute an encoded version of DMShell++. This version of DMShell++ was configured to use the same C2 infrastructure as the remote version downloaded by the PPSX file sent in the same spear phishing email (<code>27.126.186[.]222</code> on ports <code>6001</code>, <code>6002,</code> and <code>6003</code>; <a href="#appendix-d-server-infrastructure" class="pointer">Appendix D</a> provides a detailed overview of the server infrastructure). Figure 3 shows an overview of the CVE 2017-11822 and DMShell++ infection chain.</p>
<figure class="center mw-100 ba b--light-gray" style="width:710px;"><div class="tc pa2 bg-white"><a href="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-3.png&amp;nocache=1" class="pointer"><img decoding="async" class="size-full wp-image-70944" src="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-3.png&amp;nocache=1" alt="" width="710" height="574" title="Familiar Feeling: A Malware Campaign Targeting the Tibetan Diaspora Resurfaces 3" srcset="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-3.png&amp;nocache=1 710w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-3-300x243.png&amp;nocache=1 300w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-3-180x146.png&amp;nocache=1 180w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-3-421x340.png&amp;nocache=1 421w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-3-246x199.png&amp;nocache=1 246w" sizes="(max-width: 710px) 100vw, 710px" /></a></div><figcaption class="f5-ns f6 black-70 pa2 bg-light-gray">Figure 3: CVE-2017-11882 and DMShell++ Infection Chain.</figcaption></figure>
<h2 id="infection-chain-cve-2017-11882-and-tssl-suite" class=" lh-solid mb3">Infection Chain: CVE-2017-11882 and TSSL Suite</h2>
<p class="mt0">In the spear phishing email sent on January 23 2018, the operator also included a RTF document designed to exploit <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882" class="pointer" target="_blank" rel="noopener">CVE-2017-11882</a> and execute a payload embedded in the file. However, in this instance, the operator deployed an entirely different set of tools.</p>
<p>As we analyzed the files written to disk as part of this infection chain, we observed multiple program database (PDB) strings. When available, PDB strings can be indicative of the malware creator&rsquo;s environment and namings for the developed malware.</p>
<div class="ba b--gray bg-light-gray pa3 f5"><code>D:\Work\Project\VS\house\Apple\Apple_20180115\Release\InstallClient.pdb</code><br>
<code>D:\Work\Project\VS\house\Apple\Apple_20180115\Release\FakeRun.pdb</code></div>
<p>These PDB strings are consistent with a set of tools known as TSSL, which were previously described by <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/" class="pointer" target="_blank" rel="noopener">Trend Micro</a> and <a href="https://www.pwc.co.uk/issues/cyber-security-data-privacy/research/the-keyboys-are-back-in-town.html" class="pointer" target="_blank" rel="noopener">PwC</a> and linked to KeyBoy and Tropic Trooper campaigns. The TSSL suite analysed in these reports includes a loader called FakeRun and a backdoor named TClient. While the samples we analyzed have a few differences from previously reported instances (<em>e.g.</em>, version numbers, storage of configuration data, method for launching payloads) we conclude that they are likely based on the same source code (see <a href="#appendix-b-tssl-code-differences" class="pointer">Appendix B</a> for a detailed comparative analysis of the samples). Figure 4 shows an overview of the CVE 2017-11882 and TSSL suite infection chain.</p>
<figure class="center mw-100 ba b--light-gray" style="width:685px;"><div class="tc pa2 bg-white"><a href="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-4.png&amp;nocache=1" class="pointer"><img loading="lazy" decoding="async" class="size-full wp-image-70945" src="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-4.png&amp;nocache=1" alt="" width="685" height="737" title="Familiar Feeling: A Malware Campaign Targeting the Tibetan Diaspora Resurfaces 4" srcset="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-4.png&amp;nocache=1 685w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-4-279x300.png&amp;nocache=1 279w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-4-180x194.png&amp;nocache=1 180w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-4-316x340.png&amp;nocache=1 316w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-4-185x199.png&amp;nocache=1 185w" sizes="(max-width: 685px) 100vw, 685px" /></a></div><figcaption class="f5-ns f6 black-70 pa2 bg-light-gray">Figure 4: CVE-2017-11882 and TSSL Suite Infection Chain.</figcaption></figure>
<h1 id="part-2-investigating-a-compromise" class=" lh-solid mb3">Part 2: Investigating a Compromise</h1>
<p class="mt0"><em>This section describes a compromise of a Tibetan NGO and analyzes operator actions post-infection. </em></p>
<p>The fourth spear phishing email of the campaign was sent on January 23, 2018 to a range of targets working for Tibetan NGOs, media groups, and the CTA. The message appeared to be sent from the Director of the <a href="http://tibetmuseum.org/" class="pointer" target="_blank" rel="noopener">Tibet Museum<em>,</em></a> which is an official museum of the CTA. Attached to the email were RTF and PPSX messages that claimed to present information about the National Museum of Tibet (see Figure 5). These files contained the CVE-2017-11882 and TSSL Suite infection chain.</p>
<figure class="center mw-100 ba b--light-gray" style="width:957px;"><div class="tc pa2 bg-white"><a href="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familar-Fig-5.png&amp;nocache=1" class="pointer"><img loading="lazy" decoding="async" class="size-full wp-image-70946" src="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familar-Fig-5.png&amp;nocache=1" alt="" width="957" height="501" title="Familiar Feeling: A Malware Campaign Targeting the Tibetan Diaspora Resurfaces 5" srcset="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familar-Fig-5.png&amp;nocache=1 957w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familar-Fig-5-300x157.png&amp;nocache=1 300w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familar-Fig-5-768x402.png&amp;nocache=1 768w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familar-Fig-5-180x94.png&amp;nocache=1 180w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familar-Fig-5-605x317.png&amp;nocache=1 605w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familar-Fig-5-297x155.png&amp;nocache=1 297w" sizes="(max-width: 957px) 100vw, 957px" /></a></div><figcaption class="f5-ns f6 black-70 pa2 bg-light-gray">Figure 5: Spear phishing email sent to Tibetan activists.</figcaption></figure>
<p>One NGO in particular was heavily targeted and had multiple staff members receive the email. A senior staff member of the group opened the attachment from a computer in their office and was compromised. Through incident response on the organization&rsquo;s network, we observed post-infection actions taken by the operator and identified the use of a second backdoor.</p>
<p>Network logs show connections to the IP address <code>115.126.86[.]151</code> on ports <code>6001</code>, <code>8080</code>, and <code>8100</code> matching the configuration file of the TSSL implant. This backdoor was configured to communicate with the C2 server every 20 minutes, but we quickly noticed during the analysis of networks logs that most connections were actually rejected by the C2 server. Based on these patterns, it appears the C2 server was disabled most of the day and active only for short windows.</p>
<p>The TClient sample was used until January 29 when a new backdoor was deployed on the infected system communicating with a new C2 server listed in Table 3. We call the new backdoor &ldquo;DSNGInstaller&rdquo;, a name stemming from the payload&rsquo;s internal name combined with the irony that DSNG is an <a href="https://en.wikipedia.org/wiki/Electronic_news-gathering" class="pointer" target="_blank" rel="noopener">accepted</a> acronym for Digital Satellite News Gathering. Both backdoors were active until February 8 when the TClient sample was removed.</p>
<figure class="center mw-100 table-overflow" style="min-width: 50%"><table border="0" cellspacing="0" style="" class=" ba b--light-gray">
<tbody>
<tr class="striped--light-gray">
<th align="left">Sample</th>
<th align="left">MD5</th>
<th align="left">Domain</th>
<th align="left">IP</th>
</tr>
<tr class="striped--light-gray">
<td align="left">DSNGInstaller</td>
<td align="left"><code>67e866c461c285853b225d2b2c850c4f</code></td>
<td align="left"><code>tibetfrum[.]info</code></td>
<td align="left"><code>27.126.176.169</code></td>
</tr>
</tbody>
</table></figure>
<p>Table 3: C2 configuration for the DSNGInstaller backdoor</p>
<p>Table 4 provides an overview of DSNGInstaller&rsquo;s capabilities (technical details are included in <a href="#appendix-c-dsng-installer" class="pointer">Appendix C</a>). These features are similar to those provided by TClient.</p>
<figure class="center mw-100 table-overflow" style="min-width: 50%"><table border="0" cellspacing="0" style="" class=" ba b--light-gray">
<tbody>
<tr class="striped--light-gray">
<th align="left"><strong>Capability</strong></th>
<th align="left"><strong>Purpose to the Operator</strong></th>
</tr>
<tr class="striped--light-gray">
<td align="left">System Reconnaissance
<ul>
<li class="mt2">List all volumes and drives</li>
<li class="mt2">List running processes</li>
<li class="mt2">List files</li>
</ul>
</td>
<td align="left">Additional reconnaissance information helps the operator determine their next action.</td>
</tr>
<tr class="striped--light-gray">
<td align="left">File System Access
<ul>
<li class="mt2">Create a file or directory</li>
<li class="mt2">Delete a file or directory</li>
</ul>
</td>
<td align="left">Interacting with the file system allows the operator to use new tools and hide evidence of their actions.</td>
</tr>
<tr class="striped--light-gray">
<td align="left">System Control
<ul>
<li class="mt2">Run a process with output</li>
<li class="mt2">Run a process without output</li>
<li class="mt2">Stop currently running processes</li>
</ul>
</td>
<td align="left">Running processes allows the operator to run their tools while stopping processes allows the operator to shutdown programs that may detect their actions.</td>
</tr>
<tr class="striped--light-gray">
<td align="left">Data exfiltration
<ul>
<li class="mt2">Upload a file to the C2 server</li>
</ul>
</td>
<td align="left">Stealing files from the target machine is the ultimate goal of the operator.</td>
</tr>
</tbody>
</table></figure>
<p>Table 4: Capabilities of the DSNGInstaller backdoor</p>
<p>While it is unclear why the operator switched malware after multiple days of undetected success, we consider potential scenarios. It is possible the TSSL malware was detected by other targets where we do not have visibility, which caused the operator to shift to a lesser known tool with a lower detection rate. Another possible scenario is that the operator&rsquo;s interface to the DSNGInstaller tool is more robust and thus preferable for expected long-term access. Finally, it is possible that DSNGIntaller is the tool of choice of another operator. This last scenario would represent a potential handoff of a surveillance victim between multiple remote operators.</p>
<h1 id="part-3-familiar-connections" class=" lh-solid mb3">Part 3: Familiar Connections</h1>
<p class="mt0"><em>This section highlights connections between the Parliamentary and Resurfaced campaigns to an operation called &ldquo;Tropic Trooper.&rdquo;</em></p>
<h2 id="campaign-connections" class=" lh-solid mb3">Campaign Connections</h2>
<p class="mt0">The tactics, techniques, and procedures used in the Resurfaced Campaign link it to the Parliamentary Campaign and to an operation called &ldquo;Tropic Trooper&rdquo;.</p>
<p>Trend Micro released the first <a href="https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/operation-tropic-trooper-infiltrates-secret-keepers?_ga=2.90317978.1889571678.1533612947-1259687102.1533612945" class="pointer" target="_blank" rel="noopener">public report</a> on Tropic Trooper in 2015, describing a malware campaign that targeted government institutions, military agencies, and companies in Taiwan and the Philippines. The campaign exploited old vulnerabilities (<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2010-3333" class="pointer" target="_blank" rel="noopener">CVE-2010-3333</a> and <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0158" class="pointer" target="_blank" rel="noopener">CVE-2012-0158</a>) and used custom malware, which Trend Micro detects as TROJ_YAHOYAH and BKDR_YAHAMAM. Trend Micro noted that the Yahoyah malware used the same algorithm for encoding configuration files as the <a href="https://blog.rapid7.com/2013/06/07/keyboy-targeted-attacks-against-vietnam-and-india/" class="pointer" target="_blank" rel="noopener">2013 versions of KeyBoy</a> analyzed by Rapid7, suggesting a link between these campaigns or at least the developers of the malware.</p>
<p>The KeyBoy samples that were used in the 2016 <a href="https://citizenlab.ca/2016/11/parliament-keyboy/" class="pointer">Parliamentary Campaign</a>&nbsp;had a significant change in the encoding of the configuration file compared to the samples described by <a href="https://blog.rapid7.com/2013/06/07/keyboy-targeted-attacks-against-vietnam-and-india/" class="pointer" target="_blank" rel="noopener">Rapid7</a>. In the 2013 version, the configuration file was encoded using a simplified static-key based algorithm. The newer encoding algorithm removed the use of a static encryption key in favour of a <a href="https://citizenlab.ca/2016/11/parliament-keyboy/" class="pointer">dynamically constructed lookup table</a>. The main connection between the Resurfaced Campaign and the Parliamentary Campaign is the reuse of a Yahoo email address (<code>Tibetanparliarnent[@]yahoo.com</code>) to send spear phishing emails to targets in the Tibetan community.</p>
<p>Most recently, in 2018 Trend Micro published an <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/" class="pointer" target="_blank" rel="noopener">update</a> on Tropic Trooper noting a new infection chain that included different exploits (<a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882" class="pointer" target="_blank" rel="noopener">CVE-2017-11882</a>, <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-0802" class="pointer" target="_blank" rel="noopener">CVE-2018-0802</a>) and the TSSL tool suite. Amongst the C2 servers observed was a domain (<code>tibetnews[.]today</code>), which shares registrant information with the domains used in the Resurfaced campaign.</p>
<p>Figure 6 provides an overview of the connections between these campaigns.</p>
<figure class="center mw-100 ba b--light-gray" style="width:700px;"><div class="tc pa2 bg-white"><a href="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-6.png&amp;nocache=1" class="pointer"><img loading="lazy" decoding="async" class="wp-image-70947" src="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-6-1024x823.png&amp;nocache=1" alt="" width="700" height="563" title="Familiar Feeling: A Malware Campaign Targeting the Tibetan Diaspora Resurfaces 6" srcset="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-6-1024x823.png&amp;nocache=1 1024w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-6-300x241.png&amp;nocache=1 300w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-6-768x617.png&amp;nocache=1 768w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-6-180x145.png&amp;nocache=1 180w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-6-423x340.png&amp;nocache=1 423w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-6-248x199.png&amp;nocache=1 248w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-6.png&amp;nocache=1 1366w" sizes="(max-width: 700px) 100vw, 700px" /></a></div><figcaption class="f5-ns f6 black-70 pa2 bg-light-gray">Figure 6: Connections between Resurfaced, Parliamentary, and Tropic Trooper campaigns.</figcaption></figure>
<h2 id="evaluating-connections" class=" lh-solid mb3">Evaluating Connections</h2>
<p class="mt0">The relationships between campaigns is typically drawn through the use of common technical indicators (<em>e.g.</em>, malware, server infrastructure, etc). In some cases, these links are used to connect multiple campaigns to a &ldquo;threat actor&rdquo; or &ldquo;group&rdquo; which is thought to be carrying out the campaigns. These links can have varying levels of strength, which can lead to different levels of confidence in attributing campaigns to a specific actor (see Table 5).</p>
<figure class="center mw-100 table-overflow" style="min-width: 50%"><table border="0" cellspacing="0" style="" class=" ba b--light-gray">
<tbody>
<tr class="striped--light-gray">
<th align="left"><strong>Connection Type</strong></th>
<th align="left"><strong>Description</strong></th>
</tr>
<tr class="striped--light-gray">
<td align="left">First-order connections</td>
<td align="left">Shared tools and infrastructure that are directly observed being used against targets.
<p>These connections typically form the core indicators or &ldquo;problem set&rdquo; of a campaign.</p></td>
</tr>
<tr class="striped--light-gray">
<td align="left">Second-order connections</td>
<td align="left">Related samples of tools believed to be unique or C2 infrastructure overlaps where neither the tools or infrastructure were directly observed in use.</td>
</tr>
<tr class="striped--light-gray">
<td align="left">Nth-order connections</td>
<td align="left">Unique characteristics of tools and infrastructure such as code reuse, development techniques, or naming conventions.</td>
</tr>
</tbody>
</table></figure>
<p>Table 5: Overview of connection types and level of confidence.</p>
<p>First-order connections typically require direct observation of malicious activity against a target and as a result may not be made public (for example, if a security company obtains the data from a customer). By contrast, second and Nth-order connections can usually be normalized between researchers and used to make connections between campaigns. For example, Kaspersky labelled a reportedly China-based threat group as <a href="https://securelist.com/winnti-more-than-just-a-game/37029/" class="pointer" target="_blank" rel="noopener">Winnti</a> after a tool they used. Over time, different campaigns and tools were grouped under the same name, for instance, Microsoft <a href="https://cloudblogs.microsoft.com/microsoftsecure/2017/01/25/detecting-threat-actors-in-recent-german-industrial-attacks-with-windows-defender-atp/" class="pointer" target="_blank" rel="noopener">associated</a> Winnti with multiple groups they name &ldquo;BARIUM&rdquo; and &ldquo;LEAD&rdquo;. While these differences in groupings stem from differing first-order connections, enough second and Nth-order connections have been identified to reference the collection of indicators as an umbrella of &ldquo;Winnti&rdquo; activities, which ProtectWise recently did in a <a href="https://401trg.com/burning-umbrella/" class="pointer" target="_blank" rel="noopener">report</a>. In these cases, indicators are available, but the strength of the connections may not be readily apparent and can lead to very wide groupings and abstractions.</p>
<p>For Tropic Trooper, multiple security companies have released information that they claim link campaigns to the threat actor. The strength of the evidence behind these claims is not always clear but the majority appear to be second and/or Nth-order connections. Table 6 and Figure 7 detail the connections made in these reports.</p>
<figure class="center mw-100 table-overflow" style="min-width: 50%"><table border="0" cellspacing="0" style="" class=" ba b--light-gray">
<tbody>
<tr class="striped--light-gray">
<th align="left"><strong>Report</strong></th>
<th align="left"><strong>Description</strong></th>
<th align="left"><strong>Tropic Trooper Connection</strong></th>
<th align="left"><strong>Connection Type </strong></th>
</tr>
<tr class="striped--light-gray">
<td align="left"><a href="https://researchcenter.paloaltonetworks.com/2016/11/unit42-tropic-trooper-targets-taiwanese-government-and-fossil-fuel-provider-with-poison-ivy/" class="pointer" target="_blank" rel="noopener">Palo Alto</a> (2016)</td>
<td align="left">Campaign using Yahoyah, PcShare, and Poison Ivy targeting Taiwanese government and fossil fuel provider</td>
<td align="left">
<ul>
<li class="mt2">Use of Yahoyah malware</li>
<li class="mt2">Overlapping C2 infrastructure</li>
</ul>
</td>
<td align="left">
<ul>
<li class="mt2">Second-order, possibly first-order</li>
</ul>
</td>
</tr>
<tr class="striped--light-gray">
<td align="left"><a href="https://blog.lookout.com/titan-mobile-threat" class="pointer" target="_blank" rel="noopener">Lookout</a> (2017)</td>
<td align="left">Description of Android malware called Titan</td>
<td align="left">
<ul>
<li class="mt2">Overlapping C2 infrastructure</li>
</ul>
</td>
<td align="left">
<ul>
<li class="mt2">Second-order</li>
</ul>
</td>
</tr>
<tr class="striped--light-gray">
<td align="left"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/" class="pointer" target="_blank" rel="noopener">Trend Micro</a> (2018)</td>
<td align="left">Campaign using TSSL toolkit targeting government and industry in Taiwan, Philippines, and Hong Kong.</td>
<td align="left">
<ul>
<li class="mt2">TSSL toolkit</li>
</ul>
</td>
<td align="left">
<ul>
<li class="mt2">Unknown<strong>*</strong></li>
</ul>
</td>
</tr>
</tbody>
</table></figure>
<p>Table 6: Overview of reports connecting malware campaigns to Tropic Trooper&nbsp;&nbsp;<strong>*Note</strong>: This report is the first time TSSL toolkit is linked to Tropic Trooper. Trend Micro does not explain how they made the connection.</p>
<figure class="center mw-100 ba b--light-gray" style="width:640px;"><div class="tc pa2 bg-white"><a href="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-7.png&amp;nocache=1" class="pointer"><img loading="lazy" decoding="async" class="size-large wp-image-70948" src="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-7-1024x732.png&amp;nocache=1" alt="" width="640" height="458" title="Familiar Feeling: A Malware Campaign Targeting the Tibetan Diaspora Resurfaces 7" srcset="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-7-1024x732.png&amp;nocache=1 1024w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-7-300x215.png&amp;nocache=1 300w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-7-768x549.png&amp;nocache=1 768w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-7-180x129.png&amp;nocache=1 180w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-7-475x340.png&amp;nocache=1 475w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-7-278x199.png&amp;nocache=1 278w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-7.png&amp;nocache=1 1145w" sizes="(max-width: 640px) 100vw, 640px" /></a></div><figcaption class="f5-ns f6 black-70 pa2 bg-light-gray">Figure 7: Connections between reports linking campaigns and malware to Tropic Trooper.</figcaption></figure>
<h1 id="part-4-challenges-of-analyzing-closed-ecosystems" class=" lh-solid mb3">Part 4: Challenges of Analyzing Closed Ecosystems</h1>
<p class="mt0"><em>This section discusses challenges in investigating closed espionage ecosystems and situates our investigation within wider trends of digital espionage operations against the Tibetan diaspora.</em></p>
<p>The Resurfaced Campaign used a mix of new and previously-observed tools, which share technical characteristics with campaigns previously attributed to Tropic Trooper. However, these links alone do not allow us to conclusively state that the campaigns are run by the <em>same actor</em>. This ambiguity illustrates some of the analytical challenges posed when analyzing connections between campaigns and theorizing about the roles of different actors in closed espionage ecosystems.</p>
<p>Researchers need to use naming schemes and actor grouping to characterize digital espionage operations out of necessity. While names are critical, the process by which they are selected, as <a href="https://medium.com/@cyb3rops/the-newcomers-guide-to-cyber-threat-actor-naming-7428e18ee263" class="pointer" target="_blank" rel="noopener">Florian Roth</a> and others have pointed out, can lead to to multiple names for the same group and potential confusion over what a name refers to. Differentiating between campaigns and the &ldquo;threat actor&rdquo; behind Tropic Trooper shows some of these challenges. Reports on Tropic Trooper have characterized it in varied and sometimes ambiguous ways (see Table 7). This variation points to some of the challenges inherent in consistently using naming: do names refer to campaigns of malware activity, the &ldquo;threat actors&rdquo; behind them, or a common tool set? It is not always clear.</p>
<figure class="center mw-100 table-overflow" style="min-width: 50%"><table border="0" cellspacing="0" style="" class=" ba b--light-gray">
<tbody>
<tr class="striped--light-gray">
<th align="left">Report</th>
<th align="left">Description</th>
</tr>
<tr class="striped--light-gray">
<td align="left"><a href="https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/operation-tropic-trooper-infiltrates-secret-keepers" class="pointer" target="_blank" rel="noopener">Trend Micro</a> (2015)</td>
<td align="left">&ldquo;&lsquo;&hellip;Operation Tropic Trooper,&rsquo; an ongoing campaign&hellip;&rdquo;</td>
</tr>
<tr class="striped--light-gray">
<td align="left"><a href="https://researchcenter.paloaltonetworks.com/2016/11/unit42-tropic-trooper-targets-taiwanese-government-and-fossil-fuel-provider-with-poison-ivy/" class="pointer" target="_blank" rel="noopener">Palo Alto</a> (2016)</td>
<td align="left">&ldquo;&hellip;a campaign called Tropic Trooper,&hellip;&rdquo;</td>
</tr>
<tr class="striped--light-gray">
<td align="left"><a href="https://blog.lookout.com/titan-mobile-threat" class="pointer" target="_blank" rel="noopener">Lookout</a> (2017)</td>
<td align="left">&ldquo;&hellip;linked to the same actors behind Operation Tropic Trooper. Tropic Trooper is a long running campaign&hellip;&rdquo;</td>
</tr>
<tr class="striped--light-gray">
<td align="left"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/" class="pointer" target="_blank" rel="noopener">Trend Micro</a> (2018)</td>
<td align="left">&ldquo;Tropic Trooper (also known as KeyBoy) levels its campaigns against &hellip; targets&rdquo;</td>
</tr>
</tbody>
</table></figure>
<p>Table 7: Descriptions of Tropic Trooper in previous reports.</p>
<p>Part of the complexity of naming stems from the multiple operational roles likely to be present in a major campaign. These roles may include malware developers, campaign operators, and intelligence taskers and consumers. The relationships between these roles may be simple or multi-layered. For example, a developer may double as an operator for a small task for a customer. Malware developers may share tools with multiple operators acting independently from each other. Customers may be active (<em>i.e.</em>, directly involved in tasking operators) or passive (<em>i.e</em>., consuming information brought to them by the operators or brokers representing the operators). Unfortunately, in the case of the Resurfaced Campaign, we lack the visibility into the organizational roles that would help us move from what we have observed to a more conclusive statement about its relationship to Tropic Trooper. Meanwhile, an operator may use the same tools to work on multiple tasks for multiple consumers. These complexities can create challenges when tools and infrastructure are the primary means for identifying and linking campaign activities.</p>
<p>Reviewing the timeline of malware and infrastructure development in the Resurfaced Campaign illustrates these challenges. Figure 8 shows that while the infrastructure was setup months before the first spear phishing messages were sent, the malware builds were all done shortly before the campaign started. The time difference between infrastructure setup and malware build combined with the fact that our identified connections to Tropic Trooper are only code-based suggest that the malware may be a resource that is shared between groups.</p>
<figure class="center mw-100 ba b--light-gray" style="width:650px;"><div class="tc pa2 bg-white"><a href="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-8.png&amp;nocache=1" class="pointer"><img loading="lazy" decoding="async" class="size-full wp-image-70949" src="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-8.png&amp;nocache=1" alt="" width="650" height="301" title="Familiar Feeling: A Malware Campaign Targeting the Tibetan Diaspora Resurfaces 8" srcset="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-8.png&amp;nocache=1 650w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-8-300x139.png&amp;nocache=1 300w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-8-180x83.png&amp;nocache=1 180w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-8-605x280.png&amp;nocache=1 605w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Fig-8-297x138.png&amp;nocache=1 297w" sizes="(max-width: 650px) 100vw, 650px" /></a></div><figcaption class="f5-ns f6 black-70 pa2 bg-light-gray">Figure 8: Resurfaced Campaign Malware and Infrastructure Development Timeline.</figcaption></figure>
<p>The connections between the Resurfaced and Parliamentary Campaigns to Tropic Trooper highlight the difficulties of characterizing threat groups and how they interact with other players in a closed espionage ecosystem. While the campaigns are linked by shared tools and infrastructure (Nth-order connections), based on this information alone we cannot conclusively say that these activities are being conducted by a single group. Campaigns labelled as Tropic Trooper also have targeted a range of government, industry, and civil society targets, which may indicate multiple intelligence consumers.</p>
<h3 id="a-view-into-closed-espionage-ecosystems" class=" lh-solid mb3">A View into Closed Espionage Ecosystems</h3>
<p class="mt0">Although the relationship between developers, operators, and the final intelligence consumer is often unclear, recent indictments issued by the United States Department of Justice (DOJ) against espionage groups based in China provide a glimpse into how these groups interact.</p>
<p>In 2014, the DOJ charged five officers of the People&rsquo;s Liberation Army with economic espionage offences. These officers are allegedly part of a threat group known as APT1, which <a href="https://www.fireeye.com/blog/threat-research/2013/02/mandiant-exposes-apt1-chinas-cyber-espionage-units.html" class="pointer" target="_blank" rel="noopener">Mandiant</a> first identified as part of the 2nd Bureau of the People&rsquo;s Liberation Army General Staff Department&rsquo;s 3rd Department. APT1 targeted numerous government and Fortune 500 companies, but was also found by Citizen Lab to have targeted <a href="https://citizenlab.ca/2013/02/apt1s-glasses-watching-a-human-rights-organization/" class="pointer">Tibetan activists</a> and a <a href="https://targetedthreats.net/" class="pointer" target="_blank" rel="noopener">large international NGO</a>. According to the <a href="https://www.justice.gov/usao-wdpa/pr/us-charges-five-chinese-military-hackers-cyber-espionage-against-us-corporations-and" class="pointer" target="_blank" rel="noopener">indictment</a>, the intelligence consumers that APT1 serviced included the Chinese government and Chinese firms seeking intellectual property and information on competitors.</p>
<p>In another 2014 case, the DOJ <a href="https://www.justice.gov/opa/pr/chinese-national-pleads-guilty-conspiring-hack-us-defense-contractors-systems-steal-sensitive" class="pointer" target="_blank" rel="noopener">charged</a> a Chinese national named Su Bin with participating in a long term conspiracy to compromise major U.S. defense contractors and sell stolen information on technology projects to entities in China. Su Bin worked with two unnamed conspirators who carried out the the intrusions. The <a href="https://www.theglobeandmail.com/news/national/article19704622.ece/BINARY/Su+Bin+1030+complaint.pdf" class="pointer" target="_blank" rel="noopener">indictment</a> identified the conspirators as being located in China and related to &ldquo;multiple organizations and entities in the PRC&rdquo;. The conspirators received 2.2 million RMB (approximately $332,040 USD) to build up their operation, but the total cost of the activity was 6.8 million RMB (approximately $995,400 USD). The conspirators shared a <a href="https://www.theglobeandmail.com/news/national/article19704622.ece/BINARY/Su+Bin+1030+complaint.pdf" class="pointer" target="_blank" rel="noopener">report</a> with each other that detailed targets, objectives, and successes of an intrusion operation against one of their targets. The report included a description of &ldquo;past achievements&rdquo; including stealing files from the &ldquo;democracy movement&rdquo; (a reference to democracy activists in Hong Kong) and the &ldquo;Tibetan independence movement&rdquo;.</p>
<p>These cases offer rare glimpses into the interactions between developers, operators, and intelligence consumers showing that the same million-dollar programs funded to conduct economic espionage operations may also incentivize the targeting of civil society organizations. While the first type of operation may result in loss of intellectual property and financial loss, the second might result in direct harm to targeted individuals or their families.</p>
<h3 id="addressing-the-analytical-challenges" class=" lh-solid mb3">Addressing the analytical challenges</h3>
<p class="mt0">Security researchers typically do not have the level of evidence and visibility cited in the DOJ indictments and have to rely on available technical indicators to track groups and hypothesize their motivations and role within closed espionage ecosystems. A possible area for future work is using formal methods (<em>i.e</em>., mathematical techniques developed in computer science to describe properties of hardware and software systems) to connect technical indicators and link campaigns. Such techniques may provide a more systematic way to link groups together and alleviate ambiguity. However, as we have discussed, identification of operators and malware developers is only one piece of the puzzle. Gaining an understanding of the ultimate harm of digital espionage requires interacting with targeted communities.</p>
<h2 id="showing-harm-perspectives-from-civil-society" class=" lh-solid mb3">Showing Harm: Perspectives from Civil Society</h2>
<p class="mt0">Digital espionage has become a commonplace threat for the Tibetan diaspora. Digital security awareness and best practices for defense are now necessities for the community. Based on this experience, for Tibetans the harm of espionage operations is clear. Lobsang Gyatso Sither, a Tibetan digital security trainer, provides a perspective:</p>
<div class="ba b--gray bg-light-gray pa3 f5">&ldquo;It&rsquo;s important for the community to get away from the mindset of &ldquo;I have nothing to hide&rdquo; and think about the connections between us and how these can lead to harm. Tibetans in Exile are connected to each other through various organizations and contacts. If you are compromised, you become the weakest link, and allow the spies to get information that can be used to target other Tibetans. Tibetans in Exile are also constantly in touch with Tibetans inside Tibet, where the harms can be severe &ndash; including arrest, detention, and imprisonment.&rdquo;</div>
<p>In recent years, we have seen operators shift tactics to basic credential phishing, making the Resurfaced Campaign notable for being the first instance of a malware campaign targeting the community we have seen since 2016. The campaign used familiar tactics of clever social engineering combined with custom malware. In response to the persistent threat of digital espionage, Tibetan groups have launched <a href="http://cybersuperhero.net/" class="pointer" target="_blank" rel="noopener">grassroots efforts</a> to increase digital security education, but changing behaviour and building capacity requires time and patience. At least one organization was compromised by the Resurfaced Campaign, which shows that familiar tactics are still being used because they still work. However, rather than being dissuaded by these threats, Tibetans are continuing the hard and necessary work to empower their community and defend against digital espionage.</p>
<h1 id="acknowledgements" class=" lh-solid mb3">Acknowledgements</h1>
<p class="mt0">Authors listed in alphabetical order. Ron Deibert provided supervision and guidance to the project.</p>
<p>Feature image photo credit: Lhakpa Kyizom</p>
<p>Special thanks to Tibet Action Institute, the participating Tibetan organizations, Lobsang Gyatso Sither, Lhakpa Kyizom, Adam Hulcoop, Jakub Dalek, and TNG.</p>
<h1 id="indicators-of-compromise" class=" lh-solid mb3">Indicators of Compromise</h1>
<p class="mt0">Indicators of compromise are available on <a href="https://github.com/citizenlab/malware-indicators/tree/master/201808_FamiliarFeeling" class="pointer" target="_blank" rel="noopener">GitHub</a> in multiple formats.</p>
<h1 id="appendix-a-dmshell" class=" lh-solid mb3">Appendix A: DMShell++</h1>
<h2 id="loader" class=" lh-solid mb3">Loader</h2>
<p class="mt0">We identified two similar loaders for DMShell++ :</p>
<ol style="list-style-type: decimal;">
<li class="mt2">A PowerShell script created by a Microsoft JScript file in <code>%TEMP%\{541DB837-073A-45F0-8A5D-2650065D1252}.ps1</code> during the exploitation of CVE-2017-0199. This script decodes the base64 encoded DMShell++ script and executes it.</li>
<li class="mt2">A PowerShell script dropped by the binary <code>11e0f3e1c7d8855ed7f1dcfce4b7702a</code> during the execution of <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882" class="pointer" target="_blank" rel="noopener">CVE-2017-11882</a>. This PowerShell script decodes the base64 encoded payload stored in <code>%TEMP%\pfine</code> and executes the DMShell++ payload.</li>
</ol>
<p><a href="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-1.png&amp;nocache=1" class="pointer"><img loading="lazy" decoding="async" class="aligncenter wp-image-70951" src="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-1.png&amp;nocache=1" alt="" width="500" height="176" title="Familiar Feeling: A Malware Campaign Targeting the Tibetan Diaspora Resurfaces 9" srcset="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-1.png&amp;nocache=1 772w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-1-300x105.png&amp;nocache=1 300w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-1-768x270.png&amp;nocache=1 768w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-1-180x63.png&amp;nocache=1 180w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-1-605x212.png&amp;nocache=1 605w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-1-297x104.png&amp;nocache=1 297w" sizes="(max-width: 500px) 100vw, 500px" /></a></p>
<h2 id="payload" class=" lh-solid mb3">Payload</h2>
<p class="mt0">DMShell++ is a reverse TCP backdoor written in PowerShell. It uses PowerShell <code>System.Net.Sockets</code> to create three TCP streams, one to each C2 address hardcoded in a PowerShell object:</p>
<p><a href="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-2.png&amp;nocache=1" class="pointer"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-70952" src="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-2.png&amp;nocache=1" alt="" width="463" height="71" title="Familiar Feeling: A Malware Campaign Targeting the Tibetan Diaspora Resurfaces 10" srcset="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-2.png&amp;nocache=1 463w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-2-300x46.png&amp;nocache=1 300w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-2-180x28.png&amp;nocache=1 180w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-2-297x46.png&amp;nocache=1 297w" sizes="(max-width: 463px) 100vw, 463px" /></a></p>
<p>When a TCP stream is started, it first calls the function SendLoginInfo, which sends information about the system to the C2 server, under the form <code>TOKEN|*|IP ADDRESS|*|WINDOWS VERSION|*|USER NAME</code>. For example, on a virtual machine we used for testing, the following packet was sent to the C2 server:</p>
<p><a href="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-3.png&amp;nocache=1" class="pointer"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-70953" src="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-3.png&amp;nocache=1" alt="" width="597" height="111" title="Familiar Feeling: A Malware Campaign Targeting the Tibetan Diaspora Resurfaces 11" srcset="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-3.png&amp;nocache=1 597w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-3-300x56.png&amp;nocache=1 300w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-3-180x33.png&amp;nocache=1 180w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-3-297x55.png&amp;nocache=1 297w" sizes="(max-width: 597px) 100vw, 597px" /></a></p>
<p>Once this first packet is sent, the script enters into an endless loop waiting for commands from the C2 servers. The same delimiter |*| is again used and the script accepts four different commands:</p>
<ul>
<li class="mt2"><strong>CMD</strong>: executes the shell command and returns the output&lt;</li>
<li class="mt2"><strong>FILERECEIVE</strong>: send the file at the given path</li>
<li class="mt2"><strong>FILEHEAD</strong>: receive information from a file to be downloaded from the C2 server. Data is received under the format <code>FILEHEAD|*|FILENAME|FILEEXTENSION|FILESIZE</code></li>
<li class="mt2"><strong>FILESEND</strong>: receive data stream from the file</li>
</ul>
<h1 id="appendix-b-tssl-code-differences" class=" lh-solid mb3">Appendix B: TSSL Code Differences</h1>
<p class="mt0">During the course of our investigation, we identified malware that is similar to malware in the TSSL suite described by Trend Micro in their 2018 Tropic Trooper <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/" class="pointer" target="_blank" rel="noopener">report<em>.</em></a> This appendix describes the code differences between these two versions for both the FakeRun loader and the TClient payload of the TSSL suite.</p>
<p>Comparing the InstallClient malware samples we found and those described by Trend Micro show slight modifications. Both samples followed the same behavior path to install their payloads and setup persistence with the main difference being the installation of their configuration information. The TrendMicro sample installed its configuration as an encrypted file while our sample stored its configuration as an encrypted and base64 encoded string in a Windows registry key. In addition, the TrendMicro sample dropped its FakeRun sample with the <code>sidebar.exe</code> while our sample dropped the Windows <code>wab32.exe</code> binary to act as the loading program for its FakeRun sample. The FakeRun samples we compared performed the same series of actions to spawn the final payload with differences being made to adjust for the binary names, config locations, etc.</p>
<p>Our TClient sample appeared to be an older, less feature-rich version of the TClient reported by Trend Micro. Both samples appeared to report what seemed to be a version number as part of their initial C2 communication. Trend Micro&rsquo;s sample reported a version number of 3.2.2.5 and our sample reported a version number of 0.1.4. Based on the similarities between the samples, we assess that the two campaigns use malware from the same codebase, possibly forked at some point in the past. Based on the compile times of each sample, we analysed it appears that our samples were compiled approximately two hours after those detailed by Trend Micro.</p>
<p>The list of functionality common to both TClient samples includes:</p>
<ul>
<li class="mt2">Get OS and user information</li>
<li class="mt2">Open a backdoor shell</li>
<li class="mt2">Run commands on an open backdoor shell</li>
<li class="mt2">Restart the machine</li>
<li class="mt2">Uninstall the malware</li>
<li class="mt2">List drives and devices</li>
<li class="mt2">Manipulate files and directories</li>
<li class="mt2">Upload/Download files from the C2 server</li>
<li class="mt2">Report the current configuration settings</li>
</ul>
<p>The Trend Micro TClient sample added the following functionality:</p>
<ul>
<li class="mt2">Lookup the victim&rsquo;s IP address via <code>myip.com[.]tw</code></li>
<li class="mt2">List/Kill running processes</li>
<li class="mt2">List installed programs</li>
<li class="mt2">Modify file timestamps</li>
<li class="mt2">Take screenshots</li>
<li class="mt2">Update the configuration settings</li>
</ul>
<h1 id="appendix-c-dsng-installer" class=" lh-solid mb3">Appendix C: DSNG Installer</h1>
<h2 id="loader-1" class=" lh-solid mb3">Loader</h2>
<p class="mt0">DSNGInstaller was discovered on a compromised system as <code>osun.dll</code>. It maintained persistence via a <code>CurrentVersion\Run</code> registry key. The install location folder also contained a file which had logs from a keylogger. The loader stores configuration information as encrypted data in the binary itself and the final payload as a resource in PPKK. The payload is encrypted with the blowfish cipher in ECB mode while the configuration is dropped and then decrypted by the payload. The loader also contains code to gain persistence via the creation of a Windows service: KCOM Server Security Guard, though this was not used in the sample we discovered.</p>
<h2 id="payload-1" class=" lh-solid mb3">Payload</h2>
<p class="mt0">The payload is a simple RAT that provides a limited number of capabilities to an operator. It can be started in one of two ways: either with or without provided configuration options. The sample we discovered was passed configuration options at start as arguments to one of its exported functions. This configuration information is passed to the RAT in an encrypted form using the following algorithm:</p>
<div class="ba b--gray bg-light-gray pa3 f5"><code><br>
n = 0<br>
while n &lt; data_len:<br>
i = data[n++] ^ 0x5<br>
data[n - 1] = i<br>
if n &gt;= data_len:<br>
break<br>
j = data[n++] ^ 0x27<br>
data[n - 1] = j<br>
</code></div>
<p>A portion of the decrypted configuration used in the sample we discovered can be seen in the figure below:</p>
<p><a href="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-4.png&amp;nocache=1" class="pointer"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-70954" src="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-4.png&amp;nocache=1" alt="" width="610" height="260" title="Familiar Feeling: A Malware Campaign Targeting the Tibetan Diaspora Resurfaces 12" srcset="https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-4.png&amp;nocache=1 610w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-4-300x128.png&amp;nocache=1 300w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-4-180x77.png&amp;nocache=1 180w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-4-605x258.png&amp;nocache=1 605w, https://citizenlab.ca/wp-content/webpc-passthru.php?src=https://citizenlab.ca/wp-content/uploads/2018/08/Familiar-Indicator-4-297x127.png&amp;nocache=1 297w" sizes="(max-width: 610px) 100vw, 610px" /></a></p>
<h2 id="network-communication" class=" lh-solid mb3">Network Communication</h2>
<p class="mt0">DSNGInstaller uses a simple network communication protocol when connecting to its C2 server, which consists of a short header followed by a payload encrypted with the same algorithm used to encrypt and decrypt the RAT&rsquo;s configuration. The header is defined as:</p>
<div class="ba b--gray bg-light-gray pa3 f5"><code>Header {<br>
id: [u8; 16]<br>
uuid: [char, 16]<br>
ipv4: [char, 16]<br>
length: u32<br>
command: u8<br>
command_successful: u8<br>
id: [char; 16]<br>
}</code></div>
<p>The <code>"id&rdquo;</code> is defined in the passed configuration, <code>&ldquo;uuid&rdquo;</code> is a uuid generated using the Windows API function <code>UuidCreateSequential</code>, and <code>&ldquo;ipv4&rdquo;</code> is the IPv4 address of the infected machine. <code>&ldquo;length&rdquo;</code> is the length in bytes of the full message sent to the C2 server. <code>&ldquo;command&rdquo;</code> and <code>&ldquo;command_successful&rdquo;</code> are only used when sending or replying to a command from the C2 server. They correspond to the number used to identify a command and a Boolean value reporting the success or failure of a given command. <code>&ldquo;id&rdquo;</code> is a character string that is <code>"693"</code> for our sample, which leads us to believe this may be a campaign or victim identifier but we do not know for certain what its exact use is. Following the header is the encrypted payload of the C2 communication.</p>
<p>We also discovered code to proxy all of DSNGInstaller network communication over HTTP, with and without user credentials. However, this functionality did not appear to be used anywhere by the malware. It appears to be an artifact of additional development work that was either unused or incomplete when the malware was deployed.</p>
<h1 id="appendix-d-server-infrastructure" class=" lh-solid mb3">Appendix D: Server Infrastructure</h1>
<p class="mt0">The server infrastructure that we observed in the campaign is listed in the table below:</p>
<figure class="center mw-100 table-overflow" style="min-width: 50%"><table border="0" cellspacing="0" style="" class=" ba b--light-gray">
<tbody>
<tr class="striped--light-gray">
<th align="left">Samples</th>
<th align="left">Domains</th>
<th align="left">IPs</th>
</tr>
<tr class="striped--light-gray">
<td align="left"><strong>CVE-2017-0199 </strong></td>
<td align="left">commail[.]co
<p>tibetnews[.]info</p>
<p>comemails[.]email</p></td>
<td align="left">27.126.186.222
<p>103.55.24.196</p>
<p>203.189.232.207</p></td>
</tr>
<tr class="striped--light-gray">
<td align="left"><strong>DMShell++</strong></td>
<td align="left"></td>
<td align="left">27.126.186.222
<p>103.55.24.196</p>
<p>45.127.97.222</p>
<p>203.189.232.207</p>
<p>103.55.24.196</p></td>
</tr>
<tr class="striped--light-gray">
<td align="left"><strong>DMShell++ backdoor</strong></td>
<td align="left"></td>
<td align="left">27.126.186.222</td>
</tr>
<tr class="striped--light-gray">
<td align="left"><strong>TSSL Backdoor</strong></td>
<td align="left">tibetnews[.]today</td>
<td align="left">115.126.86.151</td>
</tr>
</tbody>
</table></figure>
<p>The majority of these domains (with the exception of <code>comemails[.]email</code>) share the same whois registration information:</p>
<div class="ba b--gray bg-light-gray pa3 f5"><code>Name: huang ning<br>
Email: bqfkdrmnhh0623[@]gmail.com<br>
Phone number: 8677687877</code></div>
<p>Further searches on this whois information revealed an additional three domains with the same registration information:</p>
<figure class="center mw-100 table-overflow" style="min-width: 50%"><table border="0" cellspacing="0" style="" class=" ba b--light-gray">
<tbody>
<tr class="striped--light-gray">
<th align="left"><strong>Domain</strong></th>
<th align="left"><strong>Registrar</strong></th>
<th align="left"><strong>Creation Date</strong></th>
</tr>
<tr class="striped--light-gray">
<td align="left">tibethouse[.]info</td>
<td align="left">GoDaddy</td>
<td align="left">2018-01-03</td>
</tr>
<tr class="striped--light-gray">
<td align="left">daynew[.]today</td>
<td align="left">GoDaddy</td>
<td align="left">2017-12-27</td>
</tr>
<tr class="striped--light-gray">
<td align="left">daynews[.]today</td>
<td align="left">GoDaddy</td>
<td align="left">2017-12-27</td>
</tr>
</tbody>
</table></figure>
<p>We found 12 SSL certificates that were created for these domains. Through a search of historical data available on <a href="https://censys.io/" class="pointer" target="_blank" rel="noopener">Censys.io</a>, we found that three of the certificates were deployed between August and December 2018:</p>
<figure class="center mw-100 table-overflow" style="min-width: 50%"><table border="0" cellspacing="0" style="" class=" ba b--light-gray">
<tbody>
<tr class="striped--light-gray">
<th align="left"><strong>IP</strong></th>
<th align="left"><strong>Hosting Provider</strong></th>
<th align="left"><strong>Subdomain</strong></th>
<th align="left"><strong>Certificate</strong></th>
<th align="left"><strong>Dates</strong></th>
</tr>
<tr class="striped--light-gray">
<td align="left">115.126.86.29</td>
<td align="left">Forewin Telecom</td>
<td align="left">google.comemails[.]email</td>
<td align="left"><a href="https://crt.sh/?q=6cc03119f7f046964981941cc4c0c1dce7017d453d88297a5580c54ae36e8bc8" class="pointer" target="_blank" rel="noopener">6A4690F454C91FDC559A223D43F0A77D40B59B2A</a></td>
<td align="left">September 2017</td>
</tr>
<tr class="striped--light-gray">
<td align="left">115.126.98.78</td>
<td align="left">Forewin Telecom</td>
<td align="left">mail.google.commail[.]co</td>
<td align="left"><a href="https://crt.sh/?id=183196014" class="pointer" target="_blank" rel="noopener">E55CEA25ECC118FD798F84EB5395BE0678BDBC51</a></td>
<td align="left">August and December 2017</td>
</tr>
<tr class="striped--light-gray">
<td align="left">118.99.59.214</td>
<td align="left">Forewin Telecom</td>
<td align="left">google.comemail.email</td>
<td align="left"><a href="https://censys.io/certificates/86849575ae8b1eafb4a04a99f8e1c10bc0d3188fa5cac4a14d094bd9c3e97106" class="pointer" target="_blank" rel="noopener">cdd2fd64a4996b7d901d4a899d660cc5ff118e73</a></td>
<td align="left">August and September 2017</td>
</tr>
</tbody>
</table></figure>
<h1 id="section" class=" lh-solid mb3"></h1>
<div class="footnotes">
<hr>
<ol>
<li id="fn1" class="mt2">A mirror of the post is available on <a href="https://github.com/jiji262/wooyun_articles/blob/master/drops/Powershell%20and%20Windows%20RAW%20SOCKET.html" class="pointer" target="_blank" rel="noopener">Github</a><a href="#fnref1" class="pointer">&#8617;</a></li>
</ol>
</div>
</body></html>
                </section>
                                <section id="media_mentions" class="mb4 mt4 bt b--light-gray pt4 pb2">
                    <h2 class="mt0 mb2">Media Mentions</h2>
                    <p><a href="https://www.cyberscoop.com/tibet-malware-campaign-spearphishing-citizen-lab/">CyberScoop</a>, <a href="http://news.boxun.com/news/gb/intl/2018/08/201808092128.shtml">Boxun</a>, <a href="https://securityboulevard.com/2018/08/tibetan-activists-diaspora-hit-by-resurfacing-malware-in-cyberespionage-operation/">Security Boulevard</a>, <a href="https://www.boannews.com/media/view.asp?idx=73563">Boan News</a>, <a href="https://www.cfr.org/blog/eliminating-blind-spot-effect-cyber-conflict-civil-society">Council on Foreign Relations</a></p>
                </section>
                                <footer>



                </footer> 
              </article> 
						
												<aside class="social-sidebar">
				          <aside id="social-sidebar" role="complementary" class="w-100">
	
			<div class="sidebar-section"><div class="sidebar-title">Share this report:</div><div class="social-icons"><span class="fa-brands"><a href="https://twitter.com/intent/tweet?text=Read%20%22Familiar%20Feeling%3A%20A%20Malware%20Campaign%20Targeting%20the%20Tibetan%20Diaspora%20Resurfaces%22%20by%20%40citizenlab%3A%20https%3A%2F%2Fcitizenlab.ca%2F2018%2F08%2Ffamiliar-feeling-a-malware-campaign-targeting-the-tibetan-diaspora-resurfaces%2F" ><span class="f3 w-100 fa-twitter" title="Twitter"></span></a><a href="whatsapp://send?text=Read%20%22Familiar%20Feeling%3A%20A%20Malware%20Campaign%20Targeting%20the%20Tibetan%20Diaspora%20Resurfaces%22%20by%20%3A%20https%3A%2F%2Fcitizenlab.ca%2F2018%2F08%2Ffamiliar-feeling-a-malware-campaign-targeting-the-tibetan-diaspora-resurfaces%2F" data-action="share/whatsapp/share"><span class="f3 w-100 fa-whatsapp" title="WhatsApp"></span></a></span><span class="fa-solid"><a href="/cdn-cgi/l/email-protection#d7e8b5b8b3aeea85b2b6b3f2e5e7f2e5e591b6babebbbeb6a5f2e5e791b2b2bbbeb9b0f2e496f2e5e796f2e5e79ab6bba0b6a5b2f2e5e794b6baa7b6beb0b9f2e5e783b6a5b0b2a3beb9b0f2e5e7a3bfb2f2e5e783beb5b2a3b6b9f2e5e793beb6a4a7b8a5b6f2e5e785b2a4a2a5b1b6b4b2a4f2e5e5f2e5e7b5aef2e5e783bfb2f2e5e794bea3beadb2b9f2e5e79bb6b5f2e496f2e5e7bfa3a3a7a4f2e496f2e591f2e591b4bea3beadb2b9bbb6b5f9b4b6f2e591e5e7e6eff2e591e7eff2e591b1b6babebbbeb6a5fab1b2b2bbbeb9b0fab6fabab6bba0b6a5b2fab4b6baa7b6beb0b9faa3b6a5b0b2a3beb9b0faa3bfb2faa3beb5b2a3b6b9fab3beb6a4a7b8a5b6faa5b2a4a2a5b1b6b4b2a4f2e591f1a4a2b5bdb2b4a3ea85b2b6b3f7a3bfbea4f7b5aef7a3bfb2f794bea3beadb2b9f79bb6b5"><span class="f3 w-100 fa-envelope" title="Email"></span></a></span></div></div><div class="sidebar-section"><span class="sidebar-title">Related Posts</span><div class="rp4wp-related-posts rp4wp-related-post">

		<ul class="rp4wp-posts-list">
		<li class="rp4wp-col rp4wp-col-first rp4wp-col-last">
	<div class="rp4wp_component rp4wp_component_title rp4wp_component_2"><a href='https://citizenlab.ca/2016/11/parliament-keyboy/'>It’s Parliamentary: KeyBoy and the targeting of the Tibetan Community</a></div></li>
<li class="rp4wp-col rp4wp-col-first rp4wp-col-last">
	<div class="rp4wp_component rp4wp_component_title rp4wp_component_2"><a href='https://citizenlab.ca/2017/07/%e5%86%85%e5%b9%95%e6%b6%88%e6%81%af%ef%bc%9a%e4%b8%80%e8%b5%b7%e9%92%88%e5%af%b9%e4%b8%ad%e6%96%87%e6%96%b0%e9%97%bb%e5%aa%92%e4%bd%93%e7%9a%84%e5%85%a5%e4%be%b5%e8%a1%8c%e5%8a%a8/'>“内幕消息”：一起针对中文新闻媒体的入侵行动</a></div></li>
	</ul>
	</div></div>	
	
</aside>			          	</aside>

			</section>
		</main>
			 </div>

<footer role="contentinfo" itemscope itemtype="http://schema.org/WPFooter" class="footer">
	<div class="footer__container">
		<nav role="navigation" class="footer__nav">
			<h2>Research</h2>
			<div class="footer-links cf"><ul id="menu-research" class=" list pa0"><li id="menu-item-29711" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-29711"><a href="https://citizenlab.ca/category/research/targeted-threats/" class="lh-title mb2 db white b no-underline underline-hover">Targeted Threats</a></li>
<li id="menu-item-29709" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-29709"><a href="https://citizenlab.ca/category/research/free-expression-online/" class="lh-title mb2 db white b no-underline underline-hover">Free Expression Online</a></li>
<li id="menu-item-29712" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-29712"><a href="https://citizenlab.ca/category/research/transparency/" class="lh-title mb2 db white b no-underline underline-hover">Transparency and Accountability</a></li>
<li id="menu-item-29708" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-29708"><a href="https://citizenlab.ca/category/research/app-privacy-and-security/" class="lh-title mb2 db white b no-underline underline-hover">App Privacy and Controls</a></li>
<li id="menu-item-29710" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-29710"><a href="https://citizenlab.ca/category/research/global-research-network/" class="lh-title mb2 db white b no-underline underline-hover">Global Research Network</a></li>
<li id="menu-item-72386" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-72386"><a href="https://citizenlab.ca/category/research/tools-resources/" class="lh-title mb2 db white b no-underline underline-hover">Tools &#038; Resources</a></li>
<li id="menu-item-29713" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-29713"><a href="https://citizenlab.ca/publications/" class="lh-title mb2 db white b no-underline underline-hover">All Publications</a></li>
</ul></div>		</nav>
		<nav role="navigation" class="footer__nav">
			<h2>News</h2>
			<div class="footer-links cf"><ul id="menu-news" class=" list pa0"><li id="menu-item-29714" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-29714"><a href="https://citizenlab.ca/category/lab-news/mentions/" class="lh-title mb2 db white b no-underline underline-hover">In the Media</a></li>
<li id="menu-item-29715" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-29715"><a href="https://citizenlab.ca/category/lab-news/events/" class="lh-title mb2 db white b no-underline underline-hover">Events</a></li>
<li id="menu-item-29716" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-29716"><a href="https://citizenlab.ca/category/lab-news/opportunities/" class="lh-title mb2 db white b no-underline underline-hover">Opportunities</a></li>
<li id="menu-item-29717" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-29717"><a href="https://citizenlab.ca/newsletter/archives/" class="lh-title mb2 db white b no-underline underline-hover">Newsletter Archives</a></li>
</ul></div>		</nav>
		<nav role="navigation" class="footer__nav">
			<h2>About</h2>
			<div class="footer-links cf"><ul id="menu-about" class=" list pa0"><li id="menu-item-29718" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-29718"><a href="https://citizenlab.ca/about/" class="lh-title mb2 db white b no-underline underline-hover">About The Citizen Lab</a></li>
<li id="menu-item-29720" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-29720"><a href="https://citizenlab.ca/people/" class="lh-title mb2 db white b no-underline underline-hover">People</a></li>
<li id="menu-item-68022" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-68022"><a href="https://citizenlab.ca/media/" class="lh-title mb2 db white b no-underline underline-hover">Media Resources</a></li>
<li id="menu-item-29721" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-29721"><a href="https://citizenlab.ca/teaching/" class="lh-title mb2 db white b no-underline underline-hover">Teaching</a></li>
<li id="menu-item-68345" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-68345"><a href="https://donate.utoronto.ca/give/show/84" class="lh-title mb2 db white b no-underline underline-hover">Donate</a></li>
</ul></div>
		</nav>
		</div>

		<!-- Social Media & Newletter -->
		<div class="footer__container mt4 relative pt3-ns bt b--gray">
			<div class="flex-ns justify-between w-100">
				<div class="w-30-ns w-100 mb3 mr3-ns pt3">
					<h2 class="ttu mt0 mb2 f4">Connect</h2>
						<div class="social-media">
							<a class="dim" href="https://twitter.com/citizenlab" aria-label="Visit our Twitter account"><span class="fa-brands fa-twitter white" aria-hidden="true"></span></a>

							<a class="dim" rel="me" href="https://mastodon.social/@citizenlab" aria-label="Follow our Mastodon account"><span class="fa-brands fa-mastodon white" aria-hidden="true"></span></a>

							<a class="dim" href="https://www.youtube.com/channel/UCf5Aunw7xvt3lAFrLhiCA5w" aria-label="Visit our Youtube page"><span class="fa-brands fa-youtube white" aria-hidden="true"></span></a>

							<a class="dim" href="/cdn-cgi/l/email-protection#6d04031c18041f04081e2d0e041904170803010c0f430e0c" aria-label="Email us"><span class="fa-solid fa-envelope white" aria-hidden="true"></span></a>

							<a class="dim" href="https://github.com/citizenlab" aria-label="Visit oour Github"><span class="fa-brands fa-github white" aria-hidden="true"></span></a>
						</div>
				</div>
				<div class="w-60-ns f6 w-100 pt3">
											<h2 class="f4 ttu mb2 mt3 mt0-ns">Newsletter</h2>
							
							<div id="text-3">			<div class="textwidget"><script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>(function() {
	window.mc4wp = window.mc4wp || {
		listeners: [],
		forms: {
			on: function(evt, cb) {
				window.mc4wp.listeners.push(
					{
						event   : evt,
						callback: cb
					}
				);
			}
		}
	}
})();
</script><!-- Mailchimp for WordPress v4.9.18 - https://wordpress.org/plugins/mailchimp-for-wp/ --><form id="mc4wp-form-1" class="mc4wp-form mc4wp-form-29703" method="post" data-id="29703" data-name="" ><div class="mc4wp-form-fields"><input type="email" name="EMAIL" placeholder="Your email address" required class="dib pv1 mr2 mv1 lh-solid mw4"/><input type="submit" value="Sign up" class="link br1 b--none lh-solid cta-button-orange b pointer"/></div><label style="display: none !important;">Leave this field empty if you're human: <input type="text" name="_mc4wp_honeypot" value="" tabindex="-1" autocomplete="off" /></label><input type="hidden" name="_mc4wp_timestamp" value="1729724101" /><input type="hidden" name="_mc4wp_form_id" value="29703" /><input type="hidden" name="_mc4wp_form_element_id" value="mc4wp-form-1" /><div class="mc4wp-response"></div></form><!-- / Mailchimp for WordPress Plugin -->
</div>
		</div>						
									</div>		
			</div>
		</div>
		
</footer>
			<div id="privacy-footer">
				
												 <div class="mv0 dib">
							<div id="text-5">			<div class="textwidget"><p><a class="db white dim" href="https://citizenlab.ca/privacy/">Privacy Policy</a></p>
</div>
		</div>							</div>
																	 <div class="mv0 dib ph3-l">
							<div id="text-4">			<div class="textwidget"><p>Unless otherwise noted this site and its contents are licensed under a <a class="white dim" href="https://creativecommons.org/licenses/by/2.5/ca/">Creative Commons Attribution 2.5 Canada</a> license.</p>
</div>
		</div>							</div>
											<div class="dib mv0 mt2 lh0 mw5">
								<a href="http://munkschool.utoronto.ca/" target="blank">
										<img src="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/images/MunkSchool-WHT.png" alt="Munk School of Global Affairs & Public Policy | University of Toronto" />
								</a>
						</div>
				
			</div>

<script>(function() {function maybePrefixUrlField () {
  const value = this.value.trim()
  if (value !== '' && value.indexOf('http') !== 0) {
    this.value = 'http://' + value
  }
}

const urlFields = document.querySelectorAll('.mc4wp-form input[type="url"]')
for (let j = 0; j < urlFields.length; j++) {
  urlFields[j].addEventListener('blur', maybePrefixUrlField)
}
})();</script><script type="text/javascript" src="https://citizenlab.ca/wp-content/plugins/bigfoot_footnotes/library/bigfoot.js" id="bigfoot-js"></script>
<script type="text/javascript" src="https://citizenlab.ca/wp-content/plugins/bigfoot_footnotes/library/bigfoot.min.js" id="bigfoot-min-js"></script>
<script type="text/javascript" src="https://citizenlab.ca/wp-content/plugins/bigfoot_footnotes/library/bigfoot-function.js" id="bigfoot-function-js"></script>
<script type="text/javascript" src="https://citizenlab.ca/wp-content/plugins/youtube-embed-plus/scripts/fitvids.min.js" id="__ytprefsfitvids__-js"></script>
<script type="text/javascript" src="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/js/search-menu.js" id="search-menu-js"></script>
<script type="text/javascript" src="https://citizenlab.ca/wp-content/themes/citizenlab-wp-theme/library/js/jquery-details/jquery.details.min.js" id="jquery-details-js"></script>
<script type="text/javascript" defer src="https://citizenlab.ca/wp-content/plugins/mailchimp-for-wp/assets/js/forms.js" id="mc4wp-forms-api-js"></script>

</body>

</html> <!-- end of site. what a ride! -->
