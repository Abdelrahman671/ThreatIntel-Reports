<!doctype html>
<html xmlns:og="http://opengraphprotocol.org/schema/" xmlns:fb="http://www.facebook.com/2008/fbml" lang="en-US"  class="touch-styles">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <!-- This is Squarespace. --><!-- stratosphere-ips -->
<base href="">
<meta charset="utf-8" />
<title>Dissecting a RAT. Analysis of the AndroRAT. &mdash; Stratosphere IPS</title>
<meta http-equiv="Accept-CH" content="Sec-CH-UA-Platform-Version, Sec-CH-UA-Model" /><link rel="icon" type="image/x-icon" href="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1510076526263-H5676DRO9FLHCI9DST2F/favicon.ico?format=100w"/>
<link rel="canonical" href="https://www.stratosphereips.org/blog/2021/3/29/dissecting-a-rat-analysis-of-the-androrat"/>
<meta property="og:site_name" content="Stratosphere IPS"/>
<meta property="og:title" content="Dissecting a RAT. Analysis of the AndroRAT. &mdash; Stratosphere IPS"/>
<meta property="og:latitude" content="50.0757517"/>
<meta property="og:longitude" content="14.419946699999969"/>
<meta property="og:locality" content=""/>
<meta property="og:url" content="https://www.stratosphereips.org/blog/2021/3/29/dissecting-a-rat-analysis-of-the-androrat"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="This is the fourth blog of a series analyzing the network traffic of Android RATs from our Android Mischief Dataset [  more information here  ], a dataset of network traffic from Android phones infected with Remote Access Trojans (RAT). In this blog post we provide the analysis of the network traffi"/>
<meta property="og:image" content="http://static1.squarespace.com/static/5a01100f692ebe0459a1859f/5a01202be2c48324aeddc117/6061a51de9c30f0939b2fada/1633960199248/rats.jpg?format=1500w"/>
<meta property="og:image:width" content="1484"/>
<meta property="og:image:height" content="834"/>
<meta itemprop="name" content="Dissecting a RAT. Analysis of the AndroRAT. — Stratosphere IPS"/>
<meta itemprop="url" content="https://www.stratosphereips.org/blog/2021/3/29/dissecting-a-rat-analysis-of-the-androrat"/>
<meta itemprop="description" content="This is the fourth blog of a series analyzing the network traffic of Android RATs from our Android Mischief Dataset [  more information here  ], a dataset of network traffic from Android phones infected with Remote Access Trojans (RAT). In this blog post we provide the analysis of the network traffi"/>
<meta itemprop="thumbnailUrl" content="http://static1.squarespace.com/static/5a01100f692ebe0459a1859f/5a01202be2c48324aeddc117/6061a51de9c30f0939b2fada/1633960199248/rats.jpg?format=1500w"/>
<link rel="image_src" href="http://static1.squarespace.com/static/5a01100f692ebe0459a1859f/5a01202be2c48324aeddc117/6061a51de9c30f0939b2fada/1633960199248/rats.jpg?format=1500w" />
<meta itemprop="image" content="http://static1.squarespace.com/static/5a01100f692ebe0459a1859f/5a01202be2c48324aeddc117/6061a51de9c30f0939b2fada/1633960199248/rats.jpg?format=1500w"/>
<meta itemprop="author" content="Stratosphere IPS"/>
<meta itemprop="datePublished" content="2021-03-31T03:04:28-0400"/>
<meta itemprop="dateModified" content="2021-10-11T09:49:59-0400"/>
<meta itemprop="headline" content="Dissecting a RAT. Analysis of the AndroRAT."/>
<meta itemprop="publisher" content="Stratosphere IPS"/>
<meta name="twitter:title" content="Dissecting a RAT. Analysis of the AndroRAT. — Stratosphere IPS"/>
<meta name="twitter:image" content="http://static1.squarespace.com/static/5a01100f692ebe0459a1859f/5a01202be2c48324aeddc117/6061a51de9c30f0939b2fada/1633960199248/rats.jpg?format=1500w"/>
<meta name="twitter:url" content="https://www.stratosphereips.org/blog/2021/3/29/dissecting-a-rat-analysis-of-the-androrat"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:description" content="This is the fourth blog of a series analyzing the network traffic of Android RATs from our Android Mischief Dataset [  more information here  ], a dataset of network traffic from Android phones infected with Remote Access Trojans (RAT). In this blog post we provide the analysis of the network traffi"/>
<meta name="description" content="This is the fourth blog of a series analyzing the network traffic of 
Android RATs from our Android Mischief Dataset [more information here], a 
dataset of network traffic from Android phones infected with Remote Access 
Trojans (RAT). In this blog post we provide the analysis of the network 
traffic of the RAT05-AndroRAT [download here]. The previous blogs analyzed 
Android Tester RAT, DroidJack RAT, and SpyMax RAT." />
<link rel="preconnect" href="https://images.squarespace-cdn.com">
<link rel="preconnect" href="https://use.typekit.net" crossorigin>
<link rel="preconnect" href="https://p.typekit.net" crossorigin>
<script type="text/javascript" src="//use.typekit.net/ik/7S7aiE_3ARNLZHBfVF5QpfYr3D_L04qpJYjAtrEXszqfeCvffFHN4UJLFRbh52jhWDmyw2IUw2gcFRqkZA48w2bu5AIU529oZy7pMPG0SaskjWszSagGZW48OA83SkoDSWmyScmDSeBRZPoRdhXCdeNRjAUGdaFXOYFXScBXdaF3-emkZPuTSYw0SaBujW48Sagyjh90jhNlOYFXScBXdaF3-emkZA83SkozScSCiaiaO1FXScBXdaF3-emkZPuTSYw0SaBujW48Sagyjh90jhNlOYiaikoDiY4yieNDSey8ScmTSYw0da41J6iRjAUCiAoyJ6Z8iW4zSeI7fbKbwgMMeMw6MKG4fwXVIMMjgfMfH6qJD3vbMg6YJMJ7fbRb2UMMegI6MKG4fH8oIMIjMkMfH6qJ71qbMs6IJMJ7fbKGpsMgeMS6MKGHf55eMsMgeMX6MKGHf5PeMsMgeMt6MKGHf5AeMsMgegI6MTMglZptv39.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400;1,700"><script type="text/javascript" crossorigin="anonymous" defer="true" nomodule="nomodule" src="//assets.squarespace.com/@sqs/polyfiller/1.6/legacy.js"></script>
<script type="text/javascript" crossorigin="anonymous" defer="true" src="//assets.squarespace.com/@sqs/polyfiller/1.6/modern.js"></script>
<script type="text/javascript">SQUARESPACE_ROLLUPS = {};</script>
<script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/extract-css-runtime-515ceed1bef6d0ff-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-extract_css_runtime');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/extract-css-runtime-515ceed1bef6d0ff-min.en-US.js" defer ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/extract-css-moment-js-vendor-b60fc53b12f6d6c5-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-extract_css_moment_js_vendor');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/extract-css-moment-js-vendor-b60fc53b12f6d6c5-min.en-US.js" defer ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/cldr-resource-pack-cfcd09cc211142f2-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-cldr_resource_pack');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/cldr-resource-pack-cfcd09cc211142f2-min.en-US.js" defer ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-stable-51880dc0d7a0158c-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors_stable');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-vendors-stable-51880dc0d7a0158c-min.en-US.js" defer ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-df1fd1183d9390fb-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-vendors-df1fd1183d9390fb-min.en-US.js" defer ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-ec180c5432532e1c-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-ec180c5432532e1c-min.en-US.js" defer ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/performance-568466a7a45b7b65-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-performance');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/performance-568466a7a45b7b65-min.en-US.js" defer ></script><script data-name="static-context">Static = window.Static || {}; Static.SQUARESPACE_CONTEXT = {"betaFeatureFlags":["marketing_landing_page","marketing_automations","campaigns_discount_section_in_automations","order_status_page_checkout_landing_enabled","campaigns_import_discounts","contacts_and_campaigns_redesign","campaigns_discount_section_in_blasts","i18n_beta_website_locales","campaigns_thumbnail_layout","campaigns_new_image_layout_picker"],"facebookAppId":"314192535267336","facebookApiVersion":"v6.0","rollups":{"squarespace-announcement-bar":{"js":"//assets.squarespace.com/universal/scripts-compressed/announcement-bar-929d54e21180185e-min.en-US.js"},"squarespace-audio-player":{"css":"//assets.squarespace.com/universal/styles-compressed/audio-player-5d864aadea1060d1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/audio-player-ff1ba4eebaf7b262-min.en-US.js"},"squarespace-blog-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/blog-collection-list-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/blog-collection-list-47a224f34e715983-min.en-US.js"},"squarespace-calendar-block-renderer":{"css":"//assets.squarespace.com/universal/styles-compressed/calendar-block-renderer-b72d08ba4421f5a0-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/calendar-block-renderer-2204db19701b2ebe-min.en-US.js"},"squarespace-chartjs-helpers":{"css":"//assets.squarespace.com/universal/styles-compressed/chartjs-helpers-96b256171ee039c1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/chartjs-helpers-ea68dbda5f388989-min.en-US.js"},"squarespace-comments":{"css":"//assets.squarespace.com/universal/styles-compressed/comments-01eecf660cca1c8d-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/comments-0a38891230aaac9c-min.en-US.js"},"squarespace-custom-css-popup":{"css":"//assets.squarespace.com/universal/styles-compressed/custom-css-popup-01f4ea53f1ef2e01-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/custom-css-popup-2554dff2468c87d7-min.en-US.js"},"squarespace-dialog":{"css":"//assets.squarespace.com/universal/styles-compressed/dialog-f9093f2d526b94df-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/dialog-f6a1d5438a7c7c28-min.en-US.js"},"squarespace-events-collection":{"css":"//assets.squarespace.com/universal/styles-compressed/events-collection-b72d08ba4421f5a0-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/events-collection-a51a0c508870ad93-min.en-US.js"},"squarespace-form-rendering-utils":{"js":"//assets.squarespace.com/universal/scripts-compressed/form-rendering-utils-67db9dfae13a802c-min.en-US.js"},"squarespace-forms":{"css":"//assets.squarespace.com/universal/styles-compressed/forms-0afd3c6ac30bbab1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/forms-96a9c00206ab47a1-min.en-US.js"},"squarespace-gallery-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/gallery-collection-list-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/gallery-collection-list-de0dea92b161a99b-min.en-US.js"},"squarespace-image-zoom":{"css":"//assets.squarespace.com/universal/styles-compressed/image-zoom-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/image-zoom-104246dd5ee81f93-min.en-US.js"},"squarespace-pinterest":{"css":"//assets.squarespace.com/universal/styles-compressed/pinterest-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/pinterest-71b95dc6a65ad0b0-min.en-US.js"},"squarespace-popup-overlay":{"css":"//assets.squarespace.com/universal/styles-compressed/popup-overlay-b742b752f5880972-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/popup-overlay-9f7a8269d25d75a5-min.en-US.js"},"squarespace-product-quick-view":{"css":"//assets.squarespace.com/universal/styles-compressed/product-quick-view-0ba5bac716923b8e-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/product-quick-view-c4e6ba83e5fe6729-min.en-US.js"},"squarespace-products-collection-item-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-item-v2-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-item-v2-d1bdb2ab433d5058-min.en-US.js"},"squarespace-products-collection-list-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-list-v2-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-list-v2-6676ab1a86064e26-min.en-US.js"},"squarespace-search-page":{"css":"//assets.squarespace.com/universal/styles-compressed/search-page-90a67fc09b9b32c6-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/search-page-427f06a82a4c7a3d-min.en-US.js"},"squarespace-search-preview":{"js":"//assets.squarespace.com/universal/scripts-compressed/search-preview-a56885d30b3c3073-min.en-US.js"},"squarespace-simple-liking":{"css":"//assets.squarespace.com/universal/styles-compressed/simple-liking-701bf8bbc05ec6aa-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/simple-liking-b76ae7bcbecc9533-min.en-US.js"},"squarespace-social-buttons":{"css":"//assets.squarespace.com/universal/styles-compressed/social-buttons-95032e5fa98e47a5-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/social-buttons-476538637d19f94c-min.en-US.js"},"squarespace-tourdates":{"css":"//assets.squarespace.com/universal/styles-compressed/tourdates-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/tourdates-58c6d775dcd3c2e1-min.en-US.js"},"squarespace-website-overlays-manager":{"css":"//assets.squarespace.com/universal/styles-compressed/website-overlays-manager-07ea5a4e004e6710-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/website-overlays-manager-0ab5b1476f53fc55-min.en-US.js"}},"pageType":50,"website":{"id":"5a01100f692ebe0459a1859f","identifier":"stratosphere-ips","websiteType":1,"contentModifiedOn":1741599218675,"cloneable":false,"hasBeenCloneable":false,"siteStatus":{},"language":"en-US","timeZone":"America/New_York","machineTimeZoneOffset":-14400000,"timeZoneOffset":-14400000,"timeZoneAbbr":"EDT","siteTitle":"Stratosphere IPS","fullSiteTitle":"Dissecting a RAT. Analysis of the AndroRAT. \u2014 Stratosphere IPS","siteTagLine":"","siteDescription":"<p><span style=\"font-size:16px\">The Stratosphere </span><span style=\"font-size:16px\">IPS</span><span style=\"font-size:16px\">&nbsp;project was born in the </span><span style=\"font-size:16px\">CTU</span><span style=\"font-size:16px\">&nbsp;University of Prague in Czech Republic, as part of the PhD work of Sebastian Garc\u00EDa. Currently the project is being funded by the NLnet Foundation from Netherlands, to whom we are greatly thankful. Sebastian did his PhD in the </span><span style=\"font-size:16px\">ISISTAN</span><span style=\"font-size:16px\">&nbsp;Institute of</span><span style=\"font-size:16px\">UNICEN</span><span style=\"font-size:16px\">&nbsp;University in Argentina.</span></p>","location":{"mapLat":50.0757517,"mapLng":14.419946699999969,"addressTitle":"","addressLine1":"Karlovo n\u00E1m\u011Bst\u00ED","addressLine2":"Praha","addressCountry":"Czech Republic"},"logoImageId":"5a01f28c652dea59e99249e1","socialLogoImageId":"5a0111498165f56ac4a11d93","shareButtonOptions":{"4":true,"1":true},"logoImageUrl":"//images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1510077068933-2L2JCU07QZVDWC0Q7142/Logo-blue-header.png","socialLogoImageUrl":"//images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1510019401957-BZZD6BHIYSZHJO8KSNKG/StratosphereIPS+logo+1.png","authenticUrl":"https://www.stratosphereips.org","internalUrl":"https://stratosphere-ips.squarespace.com","baseUrl":"https://www.stratosphereips.org","primaryDomain":"www.stratosphereips.org","sslSetting":3,"isHstsEnabled":false,"socialAccounts":[{"serviceId":62,"screenname":"Twitter","addedOn":1580913754185,"profileUrl":"https://twitter.com/StratosphereIPS","iconEnabled":true,"serviceName":"twitter-unauth"}],"typekitId":"","statsMigrated":false,"imageMetadataProcessingEnabled":false,"screenshotId":"0a79fb1ba57f3eed2545bd138ee53d4c5132eaa4b6b3957737b03ff5a1628ef3","showOwnerLogin":false},"websiteSettings":{"id":"5a01100f692ebe0459a185a1","websiteId":"5a01100f692ebe0459a1859f","type":"Non-Profit","subjects":[],"country":"CZ","state":"B","simpleLikingEnabled":true,"mobileInfoBarSettings":{"isContactEmailEnabled":false,"isContactPhoneNumberEnabled":false,"isLocationEnabled":false,"isBusinessHoursEnabled":false},"commentLikesAllowed":true,"commentAnonAllowed":true,"commentThreaded":true,"commentApprovalRequired":false,"commentAvatarsOn":true,"commentSortType":2,"commentFlagThreshold":0,"commentFlagsAllowed":true,"commentEnableByDefault":true,"commentDisableAfterDaysDefault":0,"disqusShortname":"","commentsEnabled":true,"contactPhoneNumber":"","businessHours":{"monday":{"text":"","ranges":[{}]},"tuesday":{"text":"","ranges":[{}]},"wednesday":{"text":"","ranges":[{}]},"thursday":{"text":"","ranges":[{}]},"friday":{"text":"","ranges":[{}]},"saturday":{"text":"","ranges":[{}]},"sunday":{"text":"","ranges":[{}]}},"storeSettings":{"returnPolicy":null,"termsOfService":null,"privacyPolicy":null,"expressCheckout":false,"continueShoppingLinkUrl":"/","useLightCart":false,"showNoteField":false,"shippingCountryDefaultValue":"US","billToShippingDefaultValue":false,"showShippingPhoneNumber":true,"isShippingPhoneRequired":false,"showBillingPhoneNumber":true,"isBillingPhoneRequired":false,"currenciesSupported":["CHF","HKD","MXN","EUR","DKK","USD","CAD","MYR","NOK","THB","AUD","SGD","ILS","PLN","GBP","CZK","SEK","NZD","PHP","RUB"],"defaultCurrency":"USD","selectedCurrency":"USD","measurementStandard":2,"showCustomCheckoutForm":false,"checkoutPageMarketingOptInEnabled":false,"enableMailingListOptInByDefault":false,"sameAsRetailLocation":false,"merchandisingSettings":{"scarcityEnabledOnProductItems":false,"scarcityEnabledOnProductBlocks":false,"scarcityMessageType":"DEFAULT_SCARCITY_MESSAGE","scarcityThreshold":10,"multipleQuantityAllowedForServices":true,"restockNotificationsEnabled":false,"restockNotificationsSuccessText":"","restockNotificationsMailingListSignUpEnabled":false,"relatedProductsEnabled":false,"relatedProductsOrdering":"random","soldOutVariantsDropdownDisabled":false,"productComposerOptedIn":false,"productComposerABTestOptedOut":false,"productReviewsEnabled":false,"displayImportedProductReviewsEnabled":false,"hasOptedToCollectNativeReviews":false},"minimumOrderSubtotalEnabled":false,"minimumOrderSubtotal":{"currency":"USD","value":"0.00"},"isLive":false,"multipleQuantityAllowedForServices":true},"useEscapeKeyToLogin":true,"ssBadgeType":1,"ssBadgePosition":4,"ssBadgeVisibility":1,"ssBadgeDevices":1,"pinterestOverlayOptions":{"mode":"disabled"},"userAccountsSettings":{"loginAllowed":false,"signupAllowed":false}},"cookieSettings":{"isCookieBannerEnabled":false,"isRestrictiveCookiePolicyEnabled":false,"cookieBannerText":"","cookieBannerTheme":"","cookieBannerVariant":"","cookieBannerPosition":"","cookieBannerCtaVariant":"","cookieBannerCtaText":"","cookieBannerAcceptType":"OPT_IN","cookieBannerOptOutCtaText":"","cookieBannerHasOptOut":false,"cookieBannerHasManageCookies":true,"cookieBannerManageCookiesLabel":"","cookieBannerSavedPreferencesText":"","cookieBannerSavedPreferencesLayout":"PILL"},"websiteCloneable":false,"collection":{"title":"Stratosphere IPS Research Blog","id":"5a01202be2c48324aeddc117","fullUrl":"/blog","type":1,"permissionType":1},"item":{"title":"Dissecting a RAT. Analysis of the AndroRAT.","id":"6061a51de9c30f0939b2fada","fullUrl":"/blog/2021/3/29/dissecting-a-rat-analysis-of-the-androrat","publicCommentCount":0,"commentState":1,"recordType":1},"subscribed":false,"appDomain":"squarespace.com","templateTweakable":true,"tweakJSON":{"aspect-ratio":"Auto","banner-slideshow-controls":"Arrows","gallery-arrow-style":"No Background","gallery-aspect-ratio":"3:2 Standard","gallery-auto-crop":"true","gallery-autoplay":"false","gallery-design":"Grid","gallery-info-overlay":"Show on Hover","gallery-loop":"false","gallery-navigation":"Bullets","gallery-show-arrows":"true","gallery-transitions":"Fade","galleryArrowBackground":"rgba(34,34,34,1)","galleryArrowColor":"rgba(255,255,255,1)","galleryAutoplaySpeed":"3","galleryCircleColor":"rgba(255,255,255,1)","galleryInfoBackground":"rgba(0, 0, 0, .7)","galleryThumbnailSize":"100px","gridSize":"280px","gridSpacing":"10px","logoContainerWidth":"140px","product-gallery-auto-crop":"false","product-image-auto-crop":"true","siteTitleContainerWidth":"360px","tweak-v1-related-products-title-spacing":"50px"},"templateId":"52a74dafe4b073a80cd253c5","templateVersion":"7","pageFeatures":[1,2,4],"gmRenderKey":"QUl6YVN5Q0JUUk9xNkx1dkZfSUUxcjQ2LVQ0QWVUU1YtMGQ3bXk4","templateScriptsRootUrl":"https://static1.squarespace.com/static/ta/52a74d9ae4b0253945d2aee9/1053/scripts/","impersonatedSession":false,"tzData":{"zones":[[-300,"US","E%sT",null]],"rules":{"US":[[1967,2006,null,"Oct","lastSun","2:00","0","S"],[1987,2006,null,"Apr","Sun>=1","2:00","1:00","D"],[2007,"max",null,"Mar","Sun>=8","2:00","1:00","D"],[2007,"max",null,"Nov","Sun>=1","2:00","0","S"]]}},"showAnnouncementBar":false,"recaptchaEnterpriseContext":{"recaptchaEnterpriseSiteKey":"6LdDFQwjAAAAAPigEvvPgEVbb7QBm-TkVJdDTlAv"},"i18nContext":{"timeZoneData":{"id":"America/New_York","name":"Eastern Time"}},"env":"PRODUCTION"};</script><script type="module">Squarespace.load(window);</script>
<script data-sqs-type="imageloader-bootstrapper" type="module">if(window.ImageLoader) window.ImageLoader.bootstrap({}, document);</script>
<script type="module">Squarespace.afterBodyLoad(Y);</script>
<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://www.stratosphereips.org/blog?format=rss" />
<script type="application/ld+json">{"url":"https://www.stratosphereips.org","name":"Stratosphere IPS","description":"<p><span style=\"font-size:16px\">The Stratosphere </span><span style=\"font-size:16px\">IPS</span><span style=\"font-size:16px\">&nbsp;project was born in the </span><span style=\"font-size:16px\">CTU</span><span style=\"font-size:16px\">&nbsp;University of Prague in Czech Republic, as part of the PhD work of Sebastian Garc\u00EDa. Currently the project is being funded by the NLnet Foundation from Netherlands, to whom we are greatly thankful. Sebastian did his PhD in the </span><span style=\"font-size:16px\">ISISTAN</span><span style=\"font-size:16px\">&nbsp;Institute of</span><span style=\"font-size:16px\">UNICEN</span><span style=\"font-size:16px\">&nbsp;University in Argentina.</span></p>","image":"//images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1510077068933-2L2JCU07QZVDWC0Q7142/Logo-blue-header.png","@context":"http://schema.org","@type":"WebSite"}</script><script type="application/ld+json">{"legalName":"","address":"Karlovo n\u00E1m\u011Bst\u00ED\nPraha\nCzech Republic","email":"stratosphere@aic.fel.cvut.cz","telephone":"","sameAs":["https://twitter.com/StratosphereIPS"],"@context":"http://schema.org","@type":"Organization"}</script><script type="application/ld+json">{"address":"Karlovo n\u00E1m\u011Bst\u00ED\nPraha\nCzech Republic","image":"https://static1.squarespace.com/static/5a01100f692ebe0459a1859f/t/5a01f28c652dea59e99249e1/1741599218675/","name":"","openingHours":", , , , , , ","@context":"http://schema.org","@type":"LocalBusiness"}</script><script type="application/ld+json">{"name":"Dissecting a RAT. Analysis of the AndroRAT. \u2014 Stratosphere IPS","url":"https://www.stratosphereips.org/blog/2021/3/29/dissecting-a-rat-analysis-of-the-androrat","datePublished":"2021-03-31T03:04:28-0400","dateModified":"2021-10-11T09:49:59-0400","headline":"Dissecting a RAT. Analysis of the AndroRAT.","author":"Stratosphere IPS","publisher":{"name":"Stratosphere IPS","logo":{"@type":"ImageObject","url":"https://static1.squarespace.com/static/5a01100f692ebe0459a1859f/t/5a01f28c652dea59e99249e1/1741599218675/"},"@context":"http://schema.org","@type":"Organization"},"image":"http://static1.squarespace.com/static/5a01100f692ebe0459a1859f/5a01202be2c48324aeddc117/6061a51de9c30f0939b2fada/1633960199248/rats.jpg?format=1500w","@context":"http://schema.org","@type":"Article"}</script><link rel="stylesheet" type="text/css" href="https://static1.squarespace.com/static/sitecss/5a01100f692ebe0459a1859f/47/52a74dafe4b073a80cd253c5/5a01100f692ebe0459a185b3/1053/site.css"/><script>Static.COOKIE_BANNER_CAPABLE = true;</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-59793876-1"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('set', 'developer_id.dZjQwMz', true);gtag('config', 'UA-59793876-1');</script><!-- End of Squarespace Headers -->
    <script>/* Must be below squarespace-headers */(function(){var e='ontouchstart'in window||navigator.msMaxTouchPoints;var t=document.documentElement;if(!e&&t){t.className=t.className.replace(/touch-styles/,'')}})()
    </script>
  </head>
  <body id="item-6061a51de9c30f0939b2fada" class="enable-nav-button nav-button-style-solid nav-button-corner-style-square banner-button-style-solid banner-button-corner-style-square banner-slideshow-controls-arrows meta-priority-date  hide-entry-author hide-list-entry-footer    hide-blog-sidebar center-navigation--info     event-thumbnails event-thumbnail-size-32-standard event-date-label event-date-label-time event-list-show-cats event-list-date event-list-time event-list-address   event-icalgcal-links  event-excerpts  event-item-back-link    gallery-design-grid aspect-ratio-auto lightbox-style-light gallery-navigation-bullets gallery-info-overlay-show-on-hover gallery-aspect-ratio-32-standard gallery-arrow-style-no-background gallery-transitions-fade gallery-show-arrows gallery-auto-crop   product-list-titles-under product-list-alignment-center product-item-size-11-square product-image-auto-crop product-gallery-size-11-square  show-product-price show-product-item-nav product-social-sharing tweak-v1-related-products-image-aspect-ratio-11-square tweak-v1-related-products-details-alignment-center newsletter-style-light  opentable-style-light small-button-style-solid small-button-shape-square medium-button-style-solid medium-button-shape-square large-button-style-solid large-button-shape-square image-block-poster-text-alignment-center image-block-card-dynamic-font-sizing image-block-card-content-position-center image-block-card-text-alignment-left image-block-overlap-dynamic-font-sizing image-block-overlap-content-position-center image-block-overlap-text-alignment-left image-block-collage-dynamic-font-sizing image-block-collage-content-position-top image-block-collage-text-alignment-left image-block-stack-dynamic-font-sizing image-block-stack-text-alignment-left button-style-solid button-corner-style-square tweak-product-quick-view-button-style-floating tweak-product-quick-view-button-position-bottom tweak-product-quick-view-lightbox-excerpt-display-truncate tweak-product-quick-view-lightbox-show-arrows tweak-product-quick-view-lightbox-show-close-button tweak-product-quick-view-lightbox-controls-weight-light native-currency-code-usd view-item collection-type-blog collection-layout-default collection-5a01202be2c48324aeddc117 mobile-style-available has-banner-image item-main-image">
    <div class="body-overlay"></div>
    <div class="sqs-announcement-bar-dropzone"></div>
    <div id="sidecarNav">
      

  <div id="mobileNavWrapper" class="nav-wrapper" data-content-field="navigation-mobileNav">
    <nav id="mobileNavigation">
      

      
        
          
          <div class="index homepage">
            <a href="/">
              Home
            </a>
          </div>
          
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/about">About</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/team">
                  Our Team
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/contact">
                  Contact
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/sebastian-garcia">
                  Sebastian Garcia
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/veronica-valeros">
                  Veronica Valeros
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/about-datasets">Datasets</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/datasets-ctu13">
                  CTU-13 Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-iot23">
                  IoT-23 Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/hornet-network-dataset-of-geographically-placed-honeypots">
                  Hornet: Network Dataset of Geographically Placed Honeypots
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-overview">
                  Datasets Overview
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-malware">
                  Malware Captures
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-normal">
                  Normal Captures
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-mixed">
                  Mixed Captures
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-iot">
                  Malware on IoT Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/android-mischief-dataset">
                  Android Mischief Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-faq">
                  F.A.Q.
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/stratosphere-ips">Stratosphere IPS</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/stratosphere-ips-suite">
                  Stratosphere IPS
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/technology">
                  Technology
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/stratosphere-ips-for-linux">
                  Stratosphere IPS for Linux
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/stratosphere-testing-framework">
                  Stratosphere Testing Framework
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/download">
                  Download
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/kalipso">
                  Kalipso
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/projects">Projects</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/ai-dojo">
                  AI Dojo
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/gsoc">
                  GSoC
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/defensive-llms">
                  Defensive LLMs
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/cybercrime-research">
                  Cybercrime Research
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/aposemat">
                  Aposemat Project
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/civilsphere">
                  Civilsphere
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/civilsphere-aivpn">
                  Civilsphere AI-VPN
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/ludus">
                  Project Ludus
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/manati">
                  ManaTI
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/nomad">
                  Nomad
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/thesis-projects">
                  Thesis Projects
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/a-study-of-rats">
                  A Study of RATs
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/a-study-of-iot-malware">
                  A Study of IoT Malware
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/icarus-project">
                  Icarus Project
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/ad-honeypot-game">
                  AD-Honeypot Evasion Game
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/the-blocklist-generation-project">
                  The Blocklist Generation Project
                </a>
              </div>
              
              
            

              
              
              <div class="external">
                <a href="/stratosphere-ips-suite">
                  Stratosphere IPS
                </a>
              </div>
              
            

              
              <div class="collection">
                <a href="/feel-project">
                  FEEL Project
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/tools">Tools</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/should-i-click">
                  Should I Click
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/hexa-payload-decoder">
                  Hexa Payload Decoder
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/zeek-anomaly-detector">
                  Zeek Anomaly Detector
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/zeek-irc-feature-extractor">
                  Zeek IRC Feature Extractor
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/aip-tool">
                  AIP Tool
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/publications-overview">
                Publications
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/job-openings">
                Open Positions
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection active">
              <a href="/blog">
                Research Blog
              </a>
            </div>
            

          
        
        

      
    </nav>
  </div>



    </div>
    <div id="siteWrapper" class="clearfix">

      <div class="sqs-cart-dropzone"></div>

      <header id="header" class="show-on-scroll" data-offset-el=".index-section" data-offset-behavior="bottom" role="banner">
        <div class="header-inner">
          <div id="logoWrapper" class="wrapper" data-content-field="site-title">
            
              <h1 id="logoImage"><a href="/"><img src="//images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1510077068933-2L2JCU07QZVDWC0Q7142/Logo-blue-header.png?format=1500w" alt="Stratosphere IPS" /></a></h1>
            
          </div><!--
          --><div class="mobile-nav-toggle"><div class="top-bar"></div><div class="middle-bar"></div><div class="bottom-bar"></div></div><div class="mobile-nav-toggle fixed-nav-toggle"><div class="top-bar"></div><div class="middle-bar"></div><div class="bottom-bar"></div></div><!--
          --><div id="headerNav">

  <div id="mainNavWrapper" class="nav-wrapper" data-content-field="navigation-mainNav">
    <nav id="mainNavigation" data-content-field="navigation-mainNav">
      

      
        
          
          <div class="index homepage">
            <a href="/">
              Home
            </a>
          </div>
          
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/about">About</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/team">
                  Our Team
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/contact">
                  Contact
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/sebastian-garcia">
                  Sebastian Garcia
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/veronica-valeros">
                  Veronica Valeros
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/about-datasets">Datasets</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/datasets-ctu13">
                  CTU-13 Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-iot23">
                  IoT-23 Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/hornet-network-dataset-of-geographically-placed-honeypots">
                  Hornet: Network Dataset of Geographically Placed Honeypots
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-overview">
                  Datasets Overview
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-malware">
                  Malware Captures
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-normal">
                  Normal Captures
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-mixed">
                  Mixed Captures
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-iot">
                  Malware on IoT Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/android-mischief-dataset">
                  Android Mischief Dataset
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/datasets-faq">
                  F.A.Q.
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/stratosphere-ips">Stratosphere IPS</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/stratosphere-ips-suite">
                  Stratosphere IPS
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/technology">
                  Technology
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/stratosphere-ips-for-linux">
                  Stratosphere IPS for Linux
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/stratosphere-testing-framework">
                  Stratosphere Testing Framework
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/download">
                  Download
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/kalipso">
                  Kalipso
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/projects">Projects</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/ai-dojo">
                  AI Dojo
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/gsoc">
                  GSoC
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/defensive-llms">
                  Defensive LLMs
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/cybercrime-research">
                  Cybercrime Research
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/aposemat">
                  Aposemat Project
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/civilsphere">
                  Civilsphere
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/civilsphere-aivpn">
                  Civilsphere AI-VPN
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/ludus">
                  Project Ludus
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/manati">
                  ManaTI
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/nomad">
                  Nomad
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/thesis-projects">
                  Thesis Projects
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/a-study-of-rats">
                  A Study of RATs
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/a-study-of-iot-malware">
                  A Study of IoT Malware
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/icarus-project">
                  Icarus Project
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/ad-honeypot-game">
                  AD-Honeypot Evasion Game
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/the-blocklist-generation-project">
                  The Blocklist Generation Project
                </a>
              </div>
              
              
            

              
              
              <div class="external">
                <a href="/stratosphere-ips-suite">
                  Stratosphere IPS
                </a>
              </div>
              
            

              
              <div class="collection">
                <a href="/feel-project">
                  FEEL Project
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          
          <div class="folder">
            <div class="folder-toggle" data-href="/tools">Tools</div>
            <div class="subnav">
            

              
              <div class="collection">
                <a href="/should-i-click">
                  Should I Click
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/hexa-payload-decoder">
                  Hexa Payload Decoder
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/zeek-anomaly-detector">
                  Zeek Anomaly Detector
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/zeek-irc-feature-extractor">
                  Zeek IRC Feature Extractor
                </a>
              </div>
              
              
            

              
              <div class="collection">
                <a href="/aip-tool">
                  AIP Tool
                </a>
              </div>
              
              
            
            </div>
          </div>
          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/publications-overview">
                Publications
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection">
              <a href="/job-openings">
                Open Positions
              </a>
            </div>
            

          
        
        

      
        
          

          

            
            <div class="collection active">
              <a href="/blog">
                Research Blog
              </a>
            </div>
            

          
        
        

      
    </nav>
  </div>
  <!-- style below blocks out the mobile nav toggle only when nav is loaded -->
  <style>.mobile-nav-toggle-label { display: inline-block !important; }</style>


</div>
        </div>
      </header>

      
        
          
            
              
                <div class="banner-thumbnail-wrapper" data-content-field="main-image">
                  <div class="color-overlay"></div>
                  <figure id="thumbnail" class="loading content-fill"><img data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617127124323-18TQDXV37MHBSDA1PB0Q/rats.jpg" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617127124323-18TQDXV37MHBSDA1PB0Q/rats.jpg" data-image-dimensions="1484x835" data-image-focal-point="0.5,0.5" alt="Dissecting a RAT. Analysis of the AndroRAT."  /></figure>
                  <div class="blog-item-wrapper">
                    <div class="title-desc-wrapper">
                      <time class="dt-published published post-date" datetime="2021-03-31" pubdate>March 31, 2021</time>
                      <div class="post-category"><a href="/blog?category=Mischief">Mischief</a></div>
                      <div class="post-author"><a href="/blog?author=5a010fd25e0ed880ec22749f">Stratosphere IPS</a></div>
                      <div class="post-title">Dissecting a RAT. Analysis of the AndroRAT.</div>
                    </div>
                  </div>
                </div>
              
            
          
        
      


      
      
      

      <main id="page" role="main">
        
        <!--
        --><!--
        --><div id="content" class="main-content" data-content-field="main-content" data-collection-id="5a01202be2c48324aeddc117" data-edit-main-image="">
         <div class="blog-item">

  
  <article class="entry h-entry hentry category-mischief tag-traffic-analysis tag-network-traffic tag-rat tag-malware author-stratosphere-ips post-type-text has-main-image clear" id="article-6061a51de9c30f0939b2fada" data-item-id="6061a51de9c30f0939b2fada">

    <header class="entry-header">
      <div class="meta-above-title">
        
        <div class="entry-byline">
          <span class="entry-author"><a href="/blog?author=5a010fd25e0ed880ec22749f" class="p-author author entry-byline-link" rel="author">Stratosphere IPS</a></span>
        </div>
        
        <div class="entry-dateline">
          <time class="dt-published published entry-date" datetime="2021-03-31" pubdate><a href="/blog/2021/3/29/dissecting-a-rat-analysis-of-the-androrat" class="entry-dateline-link">March 31, 2021</a></time>
          <time class="dt-updated updated" datetime="2021-10-11"></time>
        </div>
        
        <div class="entry-morefrom">
          <span class="entry-category"><a href="/blog/category/Mischief" class="entry-morefrom-link" rel="tag">Mischief</a></span>
        </div>
        
      </div>
      <h1 data-content-field="title" class="entry-title p-name">
      
        <a href="/blog/2021/3/29/dissecting-a-rat-analysis-of-the-androrat" class="u-url" rel="bookmark">Dissecting a RAT. Analysis of the AndroRAT.</a>
      
      </h1>
      <div class="meta-below-title ">
        
        <div class="entry-byline">
          <span class="entry-author"><a href="/blog?author=5a010fd25e0ed880ec22749f" class="p-author author entry-byline-link" rel="author">Stratosphere IPS</a></span>
        </div>
        
        <div class="entry-dateline">
          <time class="dt-published published entry-date" datetime="2021-03-31" pubdate><a href="/blog/2021/3/29/dissecting-a-rat-analysis-of-the-androrat" class="entry-dateline-link">March 31, 2021</a></time>
          <time class="dt-updated updated" datetime="2021-10-11"></time>
        </div>
        
        <div class="entry-morefrom">
          <span class="entry-category"><a href="/blog/category/Mischief" class="entry-morefrom-link" rel="tag">Mischief</a></span>
        </div>
        
      </div>
    </header>

    <div class="entry-content e-content">
      
        <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Post Body" data-type="item" data-updated-on="1617012009023" id="item-6061a51de9c30f0939b2fada"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-8d1fcc75c505c4ed494f"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p style="text-align:right;white-space:pre-wrap;" class=""><strong><em>This blog post was authored by Kamila Babayeva (@_kamifai_) and Sebastian Garcia (@eldracote).</em></strong></p><p class="" style="white-space:pre-wrap;"><em>The RAT analysis research is part of the Civilsphere Project (</em><a href="https://www.civilsphereproject.org/"><span style="text-decoration:underline"><em>https://www.civilsphereproject.org/</em></span></a><em>), which aims to protect the civil society at risk by understanding how the attacks work and how we can stop them. Check the webpage for more information.</em></p><p class="" style="white-space:pre-wrap;">This is the fourth blog of a series analyzing the network traffic of Android RATs from our Android Mischief Dataset [<a href="https://www.stratosphereips.org/android-mischief-dataset"><span style="text-decoration:underline">more information here</span></a>], a dataset of network traffic from Android phones infected with Remote Access Trojans (RAT). In this blog post we provide the analysis of the network traffic of the RAT05-AndroRAT [<a href="https://mcfp.felk.cvut.cz/publicDatasets/Android-Mischief-Dataset/AndroidMischiefDataset_v1/AndroRat.zip"><span style="text-decoration:underline">download here</span></a>]. The previous blogs analyzed <a href="https://www.stratosphereips.org/blog/2020/12/14/ngwqj0h060yv40w1afp51fg7wo9ijy-pzlhk"><span style="text-decoration:underline">Android Tester RAT</span></a>, <a href="https://www.stratosphereips.org/blog/2021/1/22/analysis-of-droidjack-v44-rat-network-traffic"><span style="text-decoration:underline">DroidJack RAT</span></a>, and <a href="https://www.stratosphereips.org/blog/2021/2/26/dissecting-a-rat-analysis-of-the-spymax"><span style="text-decoration:underline">SpyMax RAT</span></a>.&nbsp;</p><h2 style="white-space:pre-wrap;"><strong>RAT Details and Execution Setup</strong></h2><p class="" style="white-space:pre-wrap;">The goal of each of our RAT experiments is to configure and execute the RAT software and to do every possible action while capturing all traffic and storing all logs. These RAT captures are functional and used as in real attacks.</p><p class="" style="white-space:pre-wrap;">The AndroRAT RAT is a software package that contains the controller software and builder software to create an APK. We executed the builder on a Windows 7 Virtualbox virtual machine with Ubuntu 20.04 as a host. The Android Application Package (APK) built by the RAT builder was installed in an Android virtual emulator called Genymotion with Android version 8.&nbsp;</p><p class="" style="white-space:pre-wrap;">While performing different actions on the RAT controller (e.g. upload a file, get GPS location, monitor files, etc.), we captured the network traffic on the Android virtual emulator.&nbsp;The network traffic from the phone was captured using <a href="https://www.civilsphereproject.org/emergency-vpn">Emergency VPN</a>.</p><p class="" style="white-space:pre-wrap;">The details about the network traffic capture are:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">The controller IP address: 147.32.83.234</p></li><li><p class="" style="white-space:pre-wrap;">The phone IP address: 10.8.0.137</p></li><li><p class="" style="white-space:pre-wrap;">UTC time of the infection in the capture: 2020-09-10 15:18:00 UTС</p></li></ul><h2 style="white-space:pre-wrap;"><strong>Initial Communication and Infection</strong></h2><p class="" style="white-space:pre-wrap;">Once the APK was installed on the phone, it directly tries to establish a TCP connection with the command and control (C&amp;C) server. To connect, the phone uses the IP address and the port of the controller specified in the APK. In our case, the IP address of the controller is 147.32.83.234 and the port is 1337/TCP. The controller IP 147.32.83.234 is the IP address of a Windows 7 virtual machine in our lab computer, meaning that the IP address is not connected to any known indicator of compromise (IoC). Figure 1 shows the initial communication from the phone to the C&amp;C.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617096042722_253860"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure class="sqs-block-image-figure">
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 1. &lt;/em&gt;&lt;/strong&gt;A 3-way handshake to establish the first connection between the phone and the C&amp;amp;C.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
                
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              
            " style="
                position: relative;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122754691-BKQQW897KUHV7U0403M5/image10.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122754691-BKQQW897KUHV7U0403M5/image10.png" data-image-dimensions="" data-image-focal-point="0.5,0.5" alt="Figure 1. A 3-way handshake to establish the first connection between the phone and the C&amp;amp;C." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122754691-BKQQW897KUHV7U0403M5/image10.png" width="0" height="0" alt="" sizes="100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122754691-BKQQW897KUHV7U0403M5/image10.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122754691-BKQQW897KUHV7U0403M5/image10.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122754691-BKQQW897KUHV7U0403M5/image10.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122754691-BKQQW897KUHV7U0403M5/image10.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122754691-BKQQW897KUHV7U0403M5/image10.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122754691-BKQQW897KUHV7U0403M5/image10.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122754691-BKQQW897KUHV7U0403M5/image10.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 1. </em></strong>A 3-way handshake to establish the first connection between the phone and the C&amp;C.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617096042722_254166"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">After establishing the first connection, the phone sends its first packet with some parameters, such as SIM card operator, phone number, SIM card serial number, IMEI, etc. Figure 2 displays the packet data in a structured way. It can be seen that the data is sent in plaintext and the character ‘t’ is used as the delimiters to separate parameters name and values. From the packet structure in Figure 2,it can also be defined that APK uses the Java Hashtable class to store and send parameters.&nbsp;</p><p class="" style="white-space:pre-wrap;">ÿÿ¬ísr<strong>java.util.Hashtable</strong>»%!Jä¸F<br><strong>loadFactorI</strong>	<strong>threshold</strong>xp?@<br>w</p><p style="margin-left:120px;white-space:pre-wrap;" class="">t	Operator		t	Android			<br>t	SimOperator	t	Android	<br>t 	SimSerial		t	8931027000000000007	<br>t 	SimCountry 	t	us				<br>t	PhoneNumber	t	15555218135	<br>t 	Country		t	us	<br>t 	IMEI			t	000000000000000</p><p class="" style="white-space:pre-wrap;">x<br><strong><em>Figure 2. </em></strong>The first data packet sent by the phone and an analysis of its structure. The data is sent in the plain text and the character ‘t’ is used as a field delimiter.&nbsp;</p><p class="" style="white-space:pre-wrap;">After the initial connection by the phone, the command and control server shows the phone in its interface. Figure 3 displays the C&amp;C interface with the initialization parameters that were sent by the phone in the first packet.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617094328552_39376"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure class="sqs-block-image-figure">
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 3. &lt;/em&gt;&lt;/strong&gt;The C&amp;amp;C interface panel displays the parameters of the phone after the infection.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
                
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              
            " style="
                position: relative;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122132957-HNPWJYCIKZA1T5NXQFEN/image4.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122132957-HNPWJYCIKZA1T5NXQFEN/image4.png" data-image-dimensions="" data-image-focal-point="0.5,0.5" alt="Figure 3. The C&amp;amp;C interface panel displays the parameters of the phone after the infection." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122132957-HNPWJYCIKZA1T5NXQFEN/image4.png" width="0" height="0" alt="" sizes="100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122132957-HNPWJYCIKZA1T5NXQFEN/image4.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122132957-HNPWJYCIKZA1T5NXQFEN/image4.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122132957-HNPWJYCIKZA1T5NXQFEN/image4.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122132957-HNPWJYCIKZA1T5NXQFEN/image4.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122132957-HNPWJYCIKZA1T5NXQFEN/image4.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122132957-HNPWJYCIKZA1T5NXQFEN/image4.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122132957-HNPWJYCIKZA1T5NXQFEN/image4.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 3. </em></strong>The C&amp;C interface panel displays the parameters of the phone after the infection.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617094328552_40762"><div class="sqs-block-content">

<div class="sqs-html-content">
  <h2 style="white-space:pre-wrap;"><strong>C&amp;C Command Packet Structure</strong></h2><p class="" style="white-space:pre-wrap;">After the first connection the phone is waiting for the C&amp;C command. To send the command from the C&amp;C, a special panel on the C&amp;C interface should be opened by double-clicking on the infected device. Figure 4 shows the panel in the C&amp;C interface. When the attacker using the C&amp;C interface enters this panel, the C&amp;C server sends two commands to the phone, shown in Figure 5 and Figure 6.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617094328552_42880"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure class="sqs-block-image-figure">
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 4. &lt;/em&gt;&lt;/strong&gt;Panel in the C&amp;amp;C interface used to send commands to the phone.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
                
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              
            " style="
                position: relative;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122233330-SJ4NBA68NW9563V97F7I/image2.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122233330-SJ4NBA68NW9563V97F7I/image2.png" data-image-dimensions="" data-image-focal-point="0.5,0.5" alt="Figure 4. Panel in the C&amp;amp;C interface used to send commands to the phone." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122233330-SJ4NBA68NW9563V97F7I/image2.png" width="0" height="0" alt="" sizes="100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122233330-SJ4NBA68NW9563V97F7I/image2.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122233330-SJ4NBA68NW9563V97F7I/image2.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122233330-SJ4NBA68NW9563V97F7I/image2.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122233330-SJ4NBA68NW9563V97F7I/image2.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122233330-SJ4NBA68NW9563V97F7I/image2.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122233330-SJ4NBA68NW9563V97F7I/image2.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122233330-SJ4NBA68NW9563V97F7I/image2.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 4. </em></strong>Panel in the C&amp;C interface used to send commands to the phone.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617094328552_44442"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;"><strong>0000 &nbsp;      00 00 00 06 00 00 00 06 01 00 00 00 00 00 00 00 &nbsp;                ................<br>0010 &nbsp;       79 00 00 01 67&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;                                                y...g</strong></p><p class="" style="white-space:pre-wrap;"><strong><em>Figure 5. </em></strong>Data of the first packet sent by the C&amp;C when the attacker enters into the panel to control the phone.&nbsp;<br></p><p class="" style="white-space:pre-wrap;"><strong>0000 &nbsp;     00 00 00 06 00 00 00 06 01 00 00 00 00 00 00 00 &nbsp;               ................<br>0010 &nbsp;     15 00 00 02 6e&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;                                                 ....n</strong></p><p class="" style="white-space:pre-wrap;"><strong><em>Figure 6. </em></strong>Data of the second packet sent by the C&amp;C when the attacker enters into the panel to control the phone.</p><p class="" style="white-space:pre-wrap;">Since the structure of these packets is not clear, we tried to understand what these commands mean by reverse engineering the APK that was used to infect the victim’s phone. The analysis shows that each C&amp;C command is mapped to a single character that represents this command. The mapping is shown in Figure 7.&nbsp;&nbsp;</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617096042722_9335"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure class="sqs-block-image-figure">
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 7. &lt;/em&gt;&lt;/strong&gt;The mapping of each C&amp;amp;C commands (in capital letters) into a single character defined by a number. Found by reverse engineering the APK used to infect the victim.&amp;nbsp;&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
                
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              
            " style="
                position: relative;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122601142-6LKT86985KVRC15NOJT3/image15.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122601142-6LKT86985KVRC15NOJT3/image15.png" data-image-dimensions="" data-image-focal-point="0.5,0.5" alt="Figure 7. The mapping of each C&amp;amp;C commands (in capital letters) into a single character defined by a number. Found by reverse engineering the APK used to infect the victim.&amp;nbsp;" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122601142-6LKT86985KVRC15NOJT3/image15.png" width="0" height="0" alt="" sizes="100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122601142-6LKT86985KVRC15NOJT3/image15.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122601142-6LKT86985KVRC15NOJT3/image15.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122601142-6LKT86985KVRC15NOJT3/image15.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122601142-6LKT86985KVRC15NOJT3/image15.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122601142-6LKT86985KVRC15NOJT3/image15.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122601142-6LKT86985KVRC15NOJT3/image15.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122601142-6LKT86985KVRC15NOJT3/image15.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 7. </em></strong>The mapping of each C&amp;C commands (in capital letters) into a single character defined by a number. Found by reverse engineering the APK used to infect the victim.&nbsp;</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617096042722_11183"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">Each C&amp;C command packet has a 15 bytes long header. The header contains:</p><p style="margin-left:240px;white-space:pre-wrap;" class=""><strong>Name				Length<br></strong>byteTotalLength		4 bytes<br>byteLocalLength		4 bytes<br>byteMoreF		 &nbsp; &nbsp; &nbsp; &nbsp;       1 byte<br>bytePointeurData 		2 bytes<br>byteChannel			4 bytes</p><p class="" style="white-space:pre-wrap;">The header structure was learned from the Java code of the APK for the function <em>dataHeaderGenerator</em>, which creates a header for the packet data. This header is used for the packets sent from the C&amp;C and the phone. Figure 8 shows this function.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617096042722_13331"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure class="sqs-block-image-figure">
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 8.&amp;nbsp; &lt;/em&gt;&lt;/strong&gt;Java code from the APK for the function &lt;em&gt;dataHeaderGenerator&lt;/em&gt;. This function generates the header for the C&amp;amp;C and phone packets.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
                
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              
            " style="
                position: relative;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122909133-X1M396LCSGUIFQP2CIWI/image14.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122909133-X1M396LCSGUIFQP2CIWI/image14.png" data-image-dimensions="" data-image-focal-point="0.5,0.5" alt="Figure 8.&amp;nbsp; Java code from the APK for the function dataHeaderGenerator. This function generates the header for the C&amp;amp;C and phone packets." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122909133-X1M396LCSGUIFQP2CIWI/image14.png" width="0" height="0" alt="" sizes="100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122909133-X1M396LCSGUIFQP2CIWI/image14.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122909133-X1M396LCSGUIFQP2CIWI/image14.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122909133-X1M396LCSGUIFQP2CIWI/image14.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122909133-X1M396LCSGUIFQP2CIWI/image14.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122909133-X1M396LCSGUIFQP2CIWI/image14.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122909133-X1M396LCSGUIFQP2CIWI/image14.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617122909133-X1M396LCSGUIFQP2CIWI/image14.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 8.&nbsp; </em></strong>Java code from the APK for the function <em>dataHeaderGenerator</em>. This function generates the header for the C&amp;C and phone packets.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617096042722_15385"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">After the 15 byte long header, the C&amp;C sends commands using the following data structure:</p><p style="margin-left:160px;white-space:pre-wrap;" class=""><strong>Name				         Length<br></strong>command			       2 bytes<br>targetChannel			4 bytes<br>argument			       remaining data packet length</p><p class="" style="white-space:pre-wrap;"><br>This data structure appears to be in the packets sent from the C&amp;C and the packets from the phone. Figure 9 shows the function <em>parse</em> that unwraps the packet data according to the structure mentioned above.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617096042722_18476"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure class="sqs-block-image-figure">
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 9.&amp;nbsp; &lt;/em&gt;&lt;/strong&gt;Java code from the malicious APK for the function &lt;em&gt;parse&lt;/em&gt;. This function unwraps the C&amp;amp;C command.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
                
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              
            " style="
                position: relative;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123002611-HGP9PJEX1YXVP1U2QVGY/image16.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123002611-HGP9PJEX1YXVP1U2QVGY/image16.png" data-image-dimensions="" data-image-focal-point="0.5,0.5" alt="Figure 9.&amp;nbsp; Java code from the malicious APK for the function parse. This function unwraps the C&amp;amp;C command." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123002611-HGP9PJEX1YXVP1U2QVGY/image16.png" width="0" height="0" alt="" sizes="100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123002611-HGP9PJEX1YXVP1U2QVGY/image16.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123002611-HGP9PJEX1YXVP1U2QVGY/image16.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123002611-HGP9PJEX1YXVP1U2QVGY/image16.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123002611-HGP9PJEX1YXVP1U2QVGY/image16.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123002611-HGP9PJEX1YXVP1U2QVGY/image16.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123002611-HGP9PJEX1YXVP1U2QVGY/image16.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123002611-HGP9PJEX1YXVP1U2QVGY/image16.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 9.&nbsp; </em></strong>Java code from the malicious APK for the function <em>parse</em>. This function unwraps the C&amp;C command.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617096042722_20716"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">Considering the analysis above, we can explain the packets sent in Figure 5 and Figure 6. The packet from Figure 5 has the following structure:</p><p style="margin-left:120px;white-space:pre-wrap;" class=""><strong>Header Value			  Hex 			         Decimal representation<br></strong>byteTotalLength		00 00 00 06	      6<br>byteLocalLength		00 00 00 06	      6<br>byteMoreF			       01			             1<br>bytePointeurData		00 00 			      0 0<br>byteChanel 			       00 00 00 00	      0 0 0 0<br>C&amp;C Command		       00 79			      121<br>targetChannel			00 00 01 67		      0 0 1 103			<br>arguments			            -			             -</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617096042722_24284"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure class="sqs-block-image-figure">
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;Figure 10.&lt;/strong&gt; Analysis of the packet structure of the C&amp;amp;C command ‘&lt;em&gt;Advanced Information&lt;/em&gt;’ sent to the phone.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
                
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              
            " style="
                position: relative;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123155649-AM2B1P0SSGRNO2UIH3VD/image20.jpg" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123155649-AM2B1P0SSGRNO2UIH3VD/image20.jpg" data-image-dimensions="" data-image-focal-point="0.5,0.5" alt="Figure 10. Analysis of the packet structure of the C&amp;amp;C command ‘Advanced Information’ sent to the phone." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123155649-AM2B1P0SSGRNO2UIH3VD/image20.jpg" width="0" height="0" alt="" sizes="100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123155649-AM2B1P0SSGRNO2UIH3VD/image20.jpg?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123155649-AM2B1P0SSGRNO2UIH3VD/image20.jpg?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123155649-AM2B1P0SSGRNO2UIH3VD/image20.jpg?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123155649-AM2B1P0SSGRNO2UIH3VD/image20.jpg?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123155649-AM2B1P0SSGRNO2UIH3VD/image20.jpg?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123155649-AM2B1P0SSGRNO2UIH3VD/image20.jpg?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123155649-AM2B1P0SSGRNO2UIH3VD/image20.jpg?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong>Figure 10.</strong> Analysis of the packet structure of the C&amp;C command ‘<em>Advanced Information</em>’ sent to the phone.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617096042722_30279"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">Figure 10 shows an analysis diagram of the meaning of a packet sent to the phone with the command ‘Advanced Information’. This packet has a data length of 6, therefore everything after the field <em>byteChannel</em> (00 79 00 00 01 67) has a length of 6 bytes. The bytes 00 79, which are used to represent C&amp;C command, mean 121 in decimal representation. According to the mapping in Figure 7, the value 121 responds to the command ‘Advanced Information’. Figure 11 shows how. The variable P_INST is 100, and the command GET_ADV_INFORMATIONS is P_INST + 21 = 100 + 21 = 121</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617096042722_33266"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure class="sqs-block-image-figure">
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description=""
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
                
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              
            " style="
                position: relative;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123239327-E6DOJ42XNXDRE5F99TL3/image18.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123239327-E6DOJ42XNXDRE5F99TL3/image18.png" data-image-dimensions="" data-image-focal-point="0.5,0.5" alt="image18.png" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123239327-E6DOJ42XNXDRE5F99TL3/image18.png" width="0" height="0" alt="" sizes="100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123239327-E6DOJ42XNXDRE5F99TL3/image18.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123239327-E6DOJ42XNXDRE5F99TL3/image18.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123239327-E6DOJ42XNXDRE5F99TL3/image18.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123239327-E6DOJ42XNXDRE5F99TL3/image18.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123239327-E6DOJ42XNXDRE5F99TL3/image18.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123239327-E6DOJ42XNXDRE5F99TL3/image18.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123239327-E6DOJ42XNXDRE5F99TL3/image18.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617122737838_49504"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:586px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 11. &lt;/em&gt;&lt;/strong&gt;Mapping value of the C&amp;amp;C command ‘GET_ADV_INFORMATIONS’. The value of this command is 121 in decimal which is 00 79 in hexadecimal.&lt;strong&gt;&lt;em&gt;&amp;nbsp;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:3.071672201156616%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123289641-H5PNRTVE92NRDQRQV40Z/image8.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123289641-H5PNRTVE92NRDQRQV40Z/image8.png" data-image-dimensions="586x18" data-image-focal-point="0.5,0.5" alt="Figure 11. Mapping value of the C&amp;amp;C command ‘GET_ADV_INFORMATIONS’. The value of this command is 121 in decimal which is 00 79 in hexadecimal.&amp;nbsp;" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123289641-H5PNRTVE92NRDQRQV40Z/image8.png" width="586" height="18" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123289641-H5PNRTVE92NRDQRQV40Z/image8.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123289641-H5PNRTVE92NRDQRQV40Z/image8.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123289641-H5PNRTVE92NRDQRQV40Z/image8.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123289641-H5PNRTVE92NRDQRQV40Z/image8.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123289641-H5PNRTVE92NRDQRQV40Z/image8.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123289641-H5PNRTVE92NRDQRQV40Z/image8.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123289641-H5PNRTVE92NRDQRQV40Z/image8.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 11. </em></strong>Mapping value of the C&amp;C command ‘GET_ADV_INFORMATIONS’. The value of this command is 121 in decimal which is 00 79 in hexadecimal.<strong><em>&nbsp;</em></strong></p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617096042722_35776"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">Regarding the second packet shown in Figure 6, it has the following structure:</p><p style="margin-left:120px;white-space:pre-wrap;" class=""><strong>Header Value			  Hex 			           Decimal representation<br></strong>byteTotalLength		00 00 00 06		 6<br>byteLocalLength		00 00 00 06		 6<br>byteMoreF			        01			                1<br>bytePointeurData		00 00 			         0 0<br>byteChanel 		 	       00 00 00 00		  0 0 0 0<br>C&amp;C Command		       00 15			         21<br>targetChannel			00 00 02 6e	 	         0 0 1 103			<br>arguments			       -			                 -   </p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617096042722_38966"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1722px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 12.&lt;/em&gt;&lt;/strong&gt; Analysis of the packet structure of the C&amp;amp;C command ‘Preferences’ sent to the phone.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:33.681766510009766%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123741469-3F8088B4Y7WQXY8T92AR/image6.jpg" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123741469-3F8088B4Y7WQXY8T92AR/image6.jpg" data-image-dimensions="1722x580" data-image-focal-point="0.5,0.5" alt="Figure 12. Analysis of the packet structure of the C&amp;amp;C command ‘Preferences’ sent to the phone." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123741469-3F8088B4Y7WQXY8T92AR/image6.jpg" width="1722" height="580" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123741469-3F8088B4Y7WQXY8T92AR/image6.jpg?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123741469-3F8088B4Y7WQXY8T92AR/image6.jpg?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123741469-3F8088B4Y7WQXY8T92AR/image6.jpg?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123741469-3F8088B4Y7WQXY8T92AR/image6.jpg?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123741469-3F8088B4Y7WQXY8T92AR/image6.jpg?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123741469-3F8088B4Y7WQXY8T92AR/image6.jpg?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123741469-3F8088B4Y7WQXY8T92AR/image6.jpg?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 12.</em></strong> Analysis of the packet structure of the C&amp;C command ‘Preferences’ sent to the phone.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617096042722_43764"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">For this packet, the data length is 6, therefore everything after the field <em>byteChannel</em> (00 15 00 00 02 6e) has a length of 6 bytes. The bytes 00 15, that are used for defining C&amp;C command, mean 21 in decimal representation. According to the mapping in Figure 7, it is the command ‘Preferences’. Figure 13 shows how this command is computed.&nbsp;</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617096042722_47201"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:373px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 13. &lt;/em&gt;&lt;/strong&gt;Mapping of the C&amp;amp;C command GET_PREFERENCE from Figure 7. GET_PREFERNCES is 21 in decimal, and 00 15 in hexadecimal.&amp;nbsp;&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:4.55764102935791%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123760980-CBD6QKHHGTE63GTZRWK2/image7.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123760980-CBD6QKHHGTE63GTZRWK2/image7.png" data-image-dimensions="373x17" data-image-focal-point="0.5,0.5" alt="Figure 13. Mapping of the C&amp;amp;C command GET_PREFERENCE from Figure 7. GET_PREFERNCES is 21 in decimal, and 00 15 in hexadecimal.&amp;nbsp;" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123760980-CBD6QKHHGTE63GTZRWK2/image7.png" width="373" height="17" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123760980-CBD6QKHHGTE63GTZRWK2/image7.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123760980-CBD6QKHHGTE63GTZRWK2/image7.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123760980-CBD6QKHHGTE63GTZRWK2/image7.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123760980-CBD6QKHHGTE63GTZRWK2/image7.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123760980-CBD6QKHHGTE63GTZRWK2/image7.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123760980-CBD6QKHHGTE63GTZRWK2/image7.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123760980-CBD6QKHHGTE63GTZRWK2/image7.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 13. </em></strong>Mapping of the C&amp;C command GET_PREFERENCE from Figure 7. GET_PREFERNCES is 21 in decimal, and 00 15 in hexadecimal.&nbsp;</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617096042722_49990"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">Considering the analysis done on the packet and the APK, the packet structure of the C&amp;C command can be summarized as:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617096042722_53392"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1999px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 14. &lt;/em&gt;&lt;/strong&gt;Summary of the packet structure of the C&amp;amp;C commands.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:16.858428955078125%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123842475-TFXGBWI9S6C0LSJV1FRD/image21.jpg" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123842475-TFXGBWI9S6C0LSJV1FRD/image21.jpg" data-image-dimensions="1999x337" data-image-focal-point="0.5,0.5" alt="Figure 14. Summary of the packet structure of the C&amp;amp;C commands." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123842475-TFXGBWI9S6C0LSJV1FRD/image21.jpg" width="1999" height="337" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123842475-TFXGBWI9S6C0LSJV1FRD/image21.jpg?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123842475-TFXGBWI9S6C0LSJV1FRD/image21.jpg?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123842475-TFXGBWI9S6C0LSJV1FRD/image21.jpg?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123842475-TFXGBWI9S6C0LSJV1FRD/image21.jpg?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123842475-TFXGBWI9S6C0LSJV1FRD/image21.jpg?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123842475-TFXGBWI9S6C0LSJV1FRD/image21.jpg?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123842475-TFXGBWI9S6C0LSJV1FRD/image21.jpg?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 14. </em></strong>Summary of the packet structure of the C&amp;C commands.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617096042722_56181"><div class="sqs-block-content">

<div class="sqs-html-content">
  <h2 style="white-space:pre-wrap;"><strong>Victim Phone Packet Structure</strong></h2><p class="" style="white-space:pre-wrap;">The phone answers to the C&amp;C command ‘getPreferences’ and the command ‘Advanced informations’ with its own packets. The structure of the packets sent from the phone is different from the C&amp;C command packet structure shown in Figure 14. Figure 15 shows the analysis of APK function ‘send’ that sends the packet from the phone with a specific structure. The packet structure the function uses is the following:</p><p style="margin-left:200px;white-space:pre-wrap;" class=""><strong>Name 			Length<br></strong>header 		       15 bytes<br>data		       no more than 2033 bytes</p><p class="" style="white-space:pre-wrap;">The header in that structure uses a substructure:</p><p style="margin-left:200px;white-space:pre-wrap;" class=""><strong>Name				         Length<br></strong>byteTotalLength		4 bytes<br>byteLocalLength		4 bytes<br>byteMoreF			       1 byte<br>bytePointeurData 		2 bytes<br>byteChannel			4 bytes</p><p class="" style="white-space:pre-wrap;">As for the data in the packet, if its length exceeds the limit of 2033 bytes, the data will be fragmented into more packets. Each packet will have a separate 15 bytes long header and will be fragmented with a length of 2033 bytes or less.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617096042722_59850"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1026px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 15. &lt;/em&gt;&lt;/strong&gt;Java code from the APK for the command ‘send’. This function sends the packet from the phone according to the specific structure.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:69.49317169189453%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123970072-KJ3NY2LH3BPH00RBWOL9/image5.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123970072-KJ3NY2LH3BPH00RBWOL9/image5.png" data-image-dimensions="1026x713" data-image-focal-point="0.5,0.5" alt="Figure 15. Java code from the APK for the command ‘send’. This function sends the packet from the phone according to the specific structure." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123970072-KJ3NY2LH3BPH00RBWOL9/image5.png" width="1026" height="713" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123970072-KJ3NY2LH3BPH00RBWOL9/image5.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123970072-KJ3NY2LH3BPH00RBWOL9/image5.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123970072-KJ3NY2LH3BPH00RBWOL9/image5.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123970072-KJ3NY2LH3BPH00RBWOL9/image5.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123970072-KJ3NY2LH3BPH00RBWOL9/image5.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123970072-KJ3NY2LH3BPH00RBWOL9/image5.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617123970072-KJ3NY2LH3BPH00RBWOL9/image5.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 15. </em></strong>Java code from the APK for the command ‘send’. This function sends the packet from the phone according to the specific structure.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617096042722_62993"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">Using this structure we can now interpret the packets sent by the phone. Figure 16 shows the phone answer to the C&amp;C command ‘get Preferences’ and the structure of the packet. The phone sends the 15 byte long header followed by the data. The data in Figure 16 includes the preferred parameters for phonNumberCall, phoneNumberSMS, keywordSMS.&nbsp;</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617096042722_66930"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1274px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 16. &lt;/em&gt;&lt;/strong&gt;Packet sent from the phone as an answer to the C&amp;amp;C command ‘get Preferences’. The packet data and its structure is shown.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:61.5384635925293%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124064855-D5HNJUS2QXV9PIIF8QV0/image3.jpg" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124064855-D5HNJUS2QXV9PIIF8QV0/image3.jpg" data-image-dimensions="1274x784" data-image-focal-point="0.5,0.5" alt="Figure 16. Packet sent from the phone as an answer to the C&amp;amp;C command ‘get Preferences’. The packet data and its structure is shown." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124064855-D5HNJUS2QXV9PIIF8QV0/image3.jpg" width="1274" height="784" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124064855-D5HNJUS2QXV9PIIF8QV0/image3.jpg?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124064855-D5HNJUS2QXV9PIIF8QV0/image3.jpg?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124064855-D5HNJUS2QXV9PIIF8QV0/image3.jpg?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124064855-D5HNJUS2QXV9PIIF8QV0/image3.jpg?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124064855-D5HNJUS2QXV9PIIF8QV0/image3.jpg?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124064855-D5HNJUS2QXV9PIIF8QV0/image3.jpg?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124064855-D5HNJUS2QXV9PIIF8QV0/image3.jpg?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 16. </em></strong>Packet sent from the phone as an answer to the C&amp;C command ‘get Preferences’. The packet data and its structure is shown.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617096042722_70080"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">The phone sends data about the battery status, phone info, and wifi information to answer the C&amp;C command ‘Advanced Information’. The phone uses the same structure of 15 byte long header and the data. Figure 17 shows a raw answer of the phone to the C&amp;C command ‘Advanced Information’.&nbsp;</p><p class="" data-rte-preserve-empty="true" style="white-space:pre-wrap;"></p><pre><code>JJg¬ísr Packet.AdvancedInformationPacketqB®IandroidSdkIbatteryHealthIbatteryLevelIbatteryPluggedZbatteryPresentIbatteryScaleIbatteryStatusIbatteryTemperatureIbatteryVoltageZmobileNetworkAvailableZ"mobileNetworkConnectedOrConnectingZwifiAvailableZwifiConnectedOrConnectingLIMEItLjava/lang/String;LandroidVersionq~LbatteryTechnologyq~LcountryCodeq~LmobileNetworkExtraInfosq~LmobileNetworkNameq~LmobileNetworkReasonq~LoperatorCodeq~LoperatorNameq~LphoneNumberq~LsensorstLjava/util/ArrayList;LsimCountryCodeq~LsimOperatorCodeq~LsimOperatorNameq~L	simSerialq~LsoftwareVersionq~LwifiExtraInfosq~LwifiReasonq~xp$d't000000000000000t7.0tUnknowntuspt3gpt310260tAndroidt15555218135srjava.util.ArrayListxÒÇaIsizexpwtGenymotion AccelerometertGenymotion LighttGenymotion PressuretGenymotion ProximitytGenymotion HumiditytGenymotion Temperaturextust310270tAndroidt8931027000000000007t00t"WiredSSID"p</code></pre><p class="" style="white-space:pre-wrap;"><strong><em>Figure 17. </em></strong>Raw answer as ASCII text sent from the phone to the C&amp;C command ‘Advanced Information’. The packet data and its structure is shown. It is not easy to find the field separators.</p><p class="" style="white-space:pre-wrap;">The summary of the structure of the packets sent from the phone is:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617096042722_74181"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1999px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 18. &lt;/em&gt;&lt;/strong&gt;The structure of the packet sent from the phone.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:16.858428955078125%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124209458-VUSJXBELBGDLX7XTG1FN/image19.jpg" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124209458-VUSJXBELBGDLX7XTG1FN/image19.jpg" data-image-dimensions="1999x337" data-image-focal-point="0.5,0.5" alt="Figure 18. The structure of the packet sent from the phone." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124209458-VUSJXBELBGDLX7XTG1FN/image19.jpg" width="1999" height="337" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124209458-VUSJXBELBGDLX7XTG1FN/image19.jpg?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124209458-VUSJXBELBGDLX7XTG1FN/image19.jpg?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124209458-VUSJXBELBGDLX7XTG1FN/image19.jpg?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124209458-VUSJXBELBGDLX7XTG1FN/image19.jpg?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124209458-VUSJXBELBGDLX7XTG1FN/image19.jpg?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124209458-VUSJXBELBGDLX7XTG1FN/image19.jpg?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124209458-VUSJXBELBGDLX7XTG1FN/image19.jpg?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 18. </em></strong>The structure of the packet sent from the phone.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617096042722_77607"><div class="sqs-block-content">

<div class="sqs-html-content">
  <h2 style="white-space:pre-wrap;"><strong>Example of C&amp;C commands and Phone Answers</strong></h2><p class="" style="white-space:pre-wrap;">The first command sent by the C&amp;C is ‘Toast hello’. Figure 19 shows the packet data of the command and its structure. </p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617096042722_80894"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1722px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 19. &lt;/em&gt;&lt;/strong&gt;&amp;nbsp;Packet data and structure for the C&amp;amp;C command ‘Toast’ with the argument ‘hello’.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:33.681766510009766%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124246979-OS12J9FJ2GFV33VN498D/image17.jpg" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124246979-OS12J9FJ2GFV33VN498D/image17.jpg" data-image-dimensions="1722x580" data-image-focal-point="0.5,0.5" alt="Figure 19. &amp;nbsp;Packet data and structure for the C&amp;amp;C command ‘Toast’ with the argument ‘hello’." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124246979-OS12J9FJ2GFV33VN498D/image17.jpg" width="1722" height="580" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124246979-OS12J9FJ2GFV33VN498D/image17.jpg?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124246979-OS12J9FJ2GFV33VN498D/image17.jpg?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124246979-OS12J9FJ2GFV33VN498D/image17.jpg?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124246979-OS12J9FJ2GFV33VN498D/image17.jpg?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124246979-OS12J9FJ2GFV33VN498D/image17.jpg?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124246979-OS12J9FJ2GFV33VN498D/image17.jpg?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124246979-OS12J9FJ2GFV33VN498D/image17.jpg?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 19. </em></strong>&nbsp;Packet data and structure for the C&amp;C command ‘Toast’ with the argument ‘hello’.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617096042722_84483"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">The C&amp;C command sent has the value 00 6d in hexadecimal or 109 in decimal representation. We can confirm that this mapping responds to the command ‘Toast’ (Figure 20). It is important to notice that the C&amp;C command is mapped to the single character, but its argument ‘hello’ (68 65 6c 6c 6f) is not mapped to anything.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617096042722_88988"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:484px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:3.9256200790405273%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124379655-XQ8NE7EOGQNTTR5HYBVK/image22.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124379655-XQ8NE7EOGQNTTR5HYBVK/image22.png" data-image-dimensions="484x19" data-image-focal-point="0.5,0.5" alt="Figure 20. &amp;nbsp;The mapping of the C&amp;amp;C command ‘Toast’. The value of this command is 109 which is 00 6d in hexadecimal." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124379655-XQ8NE7EOGQNTTR5HYBVK/image22.png" width="484" height="19" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124379655-XQ8NE7EOGQNTTR5HYBVK/image22.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124379655-XQ8NE7EOGQNTTR5HYBVK/image22.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124379655-XQ8NE7EOGQNTTR5HYBVK/image22.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124379655-XQ8NE7EOGQNTTR5HYBVK/image22.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124379655-XQ8NE7EOGQNTTR5HYBVK/image22.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124379655-XQ8NE7EOGQNTTR5HYBVK/image22.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124379655-XQ8NE7EOGQNTTR5HYBVK/image22.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 20. </em></strong>&nbsp;The mapping of the C&amp;C command ‘Toast’. The value of this command is 109 which is 00 6d in hexadecimal.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617096042722_92489"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">‘Toast hello’ was successfully performed on the phone. The phone in return did not send any confirmation of the successful operation. Only for the C&amp;C commands that require the phone to send information (e.g. file, call, sms), the phone sends the packet with the confirmation of receiving the command. Afterwards, it sends the required data.</p><p class="" style="white-space:pre-wrap;">As an example, we took the C&amp;C command ‘Directory List’. The communication gos as follows:</p><ol data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">The C&amp;C sends the command ‘Directory List’ with the directory as an argument. (Figure 21)</p></li><li><p class="" style="white-space:pre-wrap;">The phone sends the confirmation of the command being received. (Figure 22)</p></li><li><p class="" style="white-space:pre-wrap;">The phone send the required data, i.e. file list in the directory. (Figure 23)</p></li></ol>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617096042722_97033"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1722px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 21. &lt;/em&gt;&lt;/strong&gt;The packet data and its structure of the C&amp;amp;C command ‘Directory List’. The command aims to get the list of files in the specified directory (in our case directory ‘/’).&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:33.681766510009766%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124434413-YMSWO6EFADH04EI3ZZTN/image1.jpg" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124434413-YMSWO6EFADH04EI3ZZTN/image1.jpg" data-image-dimensions="1722x580" data-image-focal-point="0.5,0.5" alt="Figure 21. The packet data and its structure of the C&amp;amp;C command ‘Directory List’. The command aims to get the list of files in the specified directory (in our case directory ‘/’)." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124434413-YMSWO6EFADH04EI3ZZTN/image1.jpg" width="1722" height="580" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124434413-YMSWO6EFADH04EI3ZZTN/image1.jpg?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124434413-YMSWO6EFADH04EI3ZZTN/image1.jpg?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124434413-YMSWO6EFADH04EI3ZZTN/image1.jpg?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124434413-YMSWO6EFADH04EI3ZZTN/image1.jpg?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124434413-YMSWO6EFADH04EI3ZZTN/image1.jpg?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124434413-YMSWO6EFADH04EI3ZZTN/image1.jpg?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124434413-YMSWO6EFADH04EI3ZZTN/image1.jpg?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 21. </em></strong>The packet data and its structure of the C&amp;C command ‘Directory List’. The command aims to get the list of files in the specified directory (in our case directory ‘/’).</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617096042722_100633"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1862px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 22. &lt;/em&gt;&lt;/strong&gt;The phone sends the confirmation about the received command ‘Directory List’. The packet data and its structure is shown.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:28.786251068115234%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124457626-MBV66L7LH27LVWNVPSN0/image12.jpg" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124457626-MBV66L7LH27LVWNVPSN0/image12.jpg" data-image-dimensions="1862x536" data-image-focal-point="0.5,0.5" alt="Figure 22. The phone sends the confirmation about the received command ‘Directory List’. The packet data and its structure is shown." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124457626-MBV66L7LH27LVWNVPSN0/image12.jpg" width="1862" height="536" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124457626-MBV66L7LH27LVWNVPSN0/image12.jpg?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124457626-MBV66L7LH27LVWNVPSN0/image12.jpg?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124457626-MBV66L7LH27LVWNVPSN0/image12.jpg?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124457626-MBV66L7LH27LVWNVPSN0/image12.jpg?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124457626-MBV66L7LH27LVWNVPSN0/image12.jpg?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124457626-MBV66L7LH27LVWNVPSN0/image12.jpg?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124457626-MBV66L7LH27LVWNVPSN0/image12.jpg?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 22. </em></strong>The phone sends the confirmation about the received command ‘Directory List’. The packet data and its structure is shown.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617096042722_104229"><div class="sqs-block-content">

<div class="sqs-html-content">
  <pre><code>3ñ¬ísrjava.util.ArrayListxÒÇaIsizexpwsrutils.MyFileëÀÞ¹÷ÓZhiddenZisDirZisFileJ	lastModifJlengthZrZwLlisttLjava/util/ArrayList;LnametLjava/lang/String;Lpathq~xptxyÈsq~wsq~txrlØsq~wxtMusict/storage/emulated/0/Musicsq~txrlØsq~wxtPodcastst/storage/emulated/0/Podcastssq~txrlØsq~wxt	Ringtonest/storage/emulated/0/Ringtonessq~txrlØsq~wxtAlarmst/storage/emulated/0/Alarmssq~txrlØsq~wxtNotificationst!/storage/emulated/0/Notificationssq~txrlØsq~wxtPicturest/storage/emulated/0/Picturessq~txrlØsq~wxtMoviest/storage/emulated/0/Moviessq~txZ sq~wsq~t/7/à?*ßsq~wxt$open_gapps-x86-7.0-pico-20200606.ziptA/storage/emulated/0/Download/open_gapps-x86-7.0-pico-20200606.zipsq~txx®hIsq~wxtopen_gapps_log.txtt//storage/emulated/0/Download/open_gapps_log.txtsq~txx®hº$sq~wxtopen_gapps_debug_logs.tar.gzt9/storage/emulated/0/Download/open_gapps_debug_logs.tar.gzsq~t/ý¨xKÎsq~w</code></pre><p class="" style="white-space:pre-wrap;"><strong><em>Figure 23. </em></strong>The phones send the list of files in a specified directory from the C&amp;C command ‘Directory List’.</p><h2 style="white-space:pre-wrap;"><strong>Long Connections</strong></h2><p class="" style="white-space:pre-wrap;">If we use the Wireshark tool to analyze all the traffic, we can open the menu “Conversations”, then “Statistics”, then “TCP”.&nbsp; There were several connections between the C&amp;C (147.32.83.234) and the phone (10.8.0.37) as shown in Figure 24. The longest connection established between the C&amp;C and the phone is 2611.3454 seconds long (approximately 44 minutes). This indicates that the connections between the phone and the controller are kept for a long period of time in order to answer fast.&nbsp;</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617096042722_151686"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:606px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 24.&amp;nbsp; &lt;/em&gt;&lt;/strong&gt;All the connections in the traffic between the phone and the C&amp;amp;C.&amp;nbsp;&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:9.240923881530762%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124571489-352YEQ1K3EZ7S71THIZ4/image13.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124571489-352YEQ1K3EZ7S71THIZ4/image13.png" data-image-dimensions="606x56" data-image-focal-point="0.5,0.5" alt="Figure 24.&amp;nbsp; All the connections in the traffic between the phone and the C&amp;amp;C.&amp;nbsp;" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124571489-352YEQ1K3EZ7S71THIZ4/image13.png" width="606" height="56" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124571489-352YEQ1K3EZ7S71THIZ4/image13.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124571489-352YEQ1K3EZ7S71THIZ4/image13.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124571489-352YEQ1K3EZ7S71THIZ4/image13.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124571489-352YEQ1K3EZ7S71THIZ4/image13.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124571489-352YEQ1K3EZ7S71THIZ4/image13.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124571489-352YEQ1K3EZ7S71THIZ4/image13.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124571489-352YEQ1K3EZ7S71THIZ4/image13.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 24.&nbsp; </em></strong>All the connections in the traffic between the phone and the C&amp;C.&nbsp;</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617096042722_155570"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">Figure 25 displays all the TCP connections in the phone sorted by the highest connection duration. It is important to notice that there are even longer <em>normal</em> connections with durations of 3576.9112 seconds (approximately 57 minutes). This is the connection from the phone during normal operation to the IP address 157.240.30.11 which belongs to Facebook services.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617096042722_162090"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:602px;"
        >
          
        
        

        
          
            <button
                class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                "
                data-description="&lt;p class=&quot;&quot; style=&quot;white-space:pre-wrap;&quot;&gt;&lt;strong&gt;&lt;em&gt;Figure 25.&lt;/em&gt;&lt;/strong&gt; Top connections from the phone from Wireshark -&amp;gt; Statistics -&amp;gt; Conversations -&amp;gt; TCP.&lt;/p&gt;"
                data-lightbox-theme="light"
            >
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:60.13289260864258%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124599324-D9PI4ESBOMMXA0A2YZ7F/image23.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124599324-D9PI4ESBOMMXA0A2YZ7F/image23.png" data-image-dimensions="602x362" data-image-focal-point="0.5,0.5" alt="Figure 25. Top connections from the phone from Wireshark -&amp;gt; Statistics -&amp;gt; Conversations -&amp;gt; TCP." data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124599324-D9PI4ESBOMMXA0A2YZ7F/image23.png" width="602" height="362" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124599324-D9PI4ESBOMMXA0A2YZ7F/image23.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124599324-D9PI4ESBOMMXA0A2YZ7F/image23.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124599324-D9PI4ESBOMMXA0A2YZ7F/image23.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124599324-D9PI4ESBOMMXA0A2YZ7F/image23.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124599324-D9PI4ESBOMMXA0A2YZ7F/image23.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124599324-D9PI4ESBOMMXA0A2YZ7F/image23.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617124599324-D9PI4ESBOMMXA0A2YZ7F/image23.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
            </button>
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;"><strong><em>Figure 25.</em></strong> Top connections from the phone from Wireshark -&gt; Statistics -&gt; Conversations -&gt; TCP.</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617096042722_169273"><div class="sqs-block-content">

<div class="sqs-html-content">
  <h1 style="white-space:pre-wrap;"><strong>Conclusion&nbsp;</strong></h1><p class="" style="white-space:pre-wrap;">In this blog we have analyzed the network traffic from a phone infected with AndroRAT. We were able to decode its connection. The androRAT does not seem to be complex in its communication protocol and it is not sophisticated in its work.</p><p class="" style="white-space:pre-wrap;">To summarize, the details found in the network traffic of this RAT are:</p><ul data-rte-list="default"><li><p class="" style="white-space:pre-wrap;">The phone connects directly to the IP address and ports specified in APK (default port and custom port).</p></li><li><p class="" style="white-space:pre-wrap;">There is only one long connection, i.e. more than 40 minutes, between the phone and the controller over the port 1337/TCP.</p></li><li><p class="" style="white-space:pre-wrap;">There is no heartbeat between the controller and the phone.</p></li><li><p class="" style="white-space:pre-wrap;">The data is sent in the plain text.</p></li><li><p class="" style="white-space:pre-wrap;">The C&amp;C uses mapping to present the C&amp;C command as a single character.</p></li><li><p class="" style="white-space:pre-wrap;">Packets sent from the phone have a structure of <strong>{byteTotalLength}{byteLocalLength}{byteMoreF}{bytePointeurData}{byteChannel}{data}</strong></p></li><li><p class="" style="white-space:pre-wrap;">Packets sent from the C&amp;C have a structure of <strong>{byteTotalLength}{byteLocalLength}{byteMoreF}{bytePointeurData}{byteChannel}{C&amp;C command}{targetChannel}{arguments}.</strong></p></li></ul><h1 style="white-space:pre-wrap;"><strong>Biographies</strong></h1>
</div>






















</div></div><div class="row sqs-row"><div class="col sqs-col-6 span-6"><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617124682508_149339"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:300px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:100%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125170963-K6TRILX8Q260YXCKSFPJ/image9.jpg" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125170963-K6TRILX8Q260YXCKSFPJ/image9.jpg" data-image-dimensions="300x300" data-image-focal-point="0.5,0.5" alt="KAMILA BABAYEVA" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125170963-K6TRILX8Q260YXCKSFPJ/image9.jpg" width="300" height="300" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 50vw, 50vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125170963-K6TRILX8Q260YXCKSFPJ/image9.jpg?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125170963-K6TRILX8Q260YXCKSFPJ/image9.jpg?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125170963-K6TRILX8Q260YXCKSFPJ/image9.jpg?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125170963-K6TRILX8Q260YXCKSFPJ/image9.jpg?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125170963-K6TRILX8Q260YXCKSFPJ/image9.jpg?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125170963-K6TRILX8Q260YXCKSFPJ/image9.jpg?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125170963-K6TRILX8Q260YXCKSFPJ/image9.jpg?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;">KAMILA BABAYEVA</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block spacer-block sqs-block-spacer" data-aspect-ratio="19.81981981981982" data-block-type="21" id="block-yui_3_17_2_1_1617124682508_198113"><div class="sqs-block-content">&nbsp;</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617124682508_214194"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">Sebastian Garcia is a malware researcher and security teacher with experience in applied machine learning on network traffic. He founded the Stratosphere Lab, aiming to do impactful security research to help others using machine learning. He believes that free software and machine learning tools can help better protect users from abuse of our digital rights. He researches on machine learning for security, honeypots, malware traffic detection, social networks security detection, distributed scanning (dnmap), keystroke dynamics, fake news, Bluetooth analysis, privacy protection, intruder detection, and microphone detection with SDR (Salamandra). He co-founded the MatesLab hackspace in Argentina and co-founded the Independent Fund for Women in Tech. @eldracote. https://www.researchgate.net/profile/Sebastian_Garcia6</p>
</div>






















</div></div></div><div class="col sqs-col-6 span-6"><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1617124682508_164696"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;">Kamila Babayeva is a 20 years old and third-year bachelor student in the Computer Science and Electrical Engineering program at the Czech Technical University in Prague. She is a researcher in the Civilsphere project, a project dedicated to protecting civil organizations and individuals from targeted attacks. Her research focuses on helping people and protecting their digital rights by developing free software based on machine learning. Initially, she worked as a junior Malware Reverser. Currently, Kamila leads the development of the Stratosphere Linux Intrusion Prevent System (Slips), which is used to protect the civil society in the Civilsphere lab.</p>
</div>






















</div></div><div class="sqs-block spacer-block sqs-block-spacer" data-aspect-ratio="10.21021021021021" data-block-type="21" id="block-yui_3_17_2_1_1617124682508_202410"><div class="sqs-block-content">&nbsp;</div></div><div class="sqs-block image-block sqs-block-image" data-block-type="5" id="block-yui_3_17_2_1_1617124682508_209314"><div class="sqs-block-content">










































  

    
  
    <div
        class="
          image-block-outer-wrapper
          layout-caption-below
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        "
        data-test="image-block-inline-outer-wrapper"
    >

      

      
        <figure
            class="
              sqs-block-image-figure
              intrinsic
            "
            style="max-width:1067px;"
        >
          
        
        

        
          
            
          <div
              
              
              class="image-block-wrapper"
              data-animation-role="image"
              
  

          >
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:104.87348175048828%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              "
              >
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125357910-J0CPXIV84B56N3DD96N4/image11.png" data-image="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125357910-J0CPXIV84B56N3DD96N4/image11.png" data-image-dimensions="1067x1119" data-image-focal-point="0.5,0.5" alt="SEBASTIAN GARCIA" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125357910-J0CPXIV84B56N3DD96N4/image11.png" width="1067" height="1119" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 50vw, 50vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125357910-J0CPXIV84B56N3DD96N4/image11.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125357910-J0CPXIV84B56N3DD96N4/image11.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125357910-J0CPXIV84B56N3DD96N4/image11.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125357910-J0CPXIV84B56N3DD96N4/image11.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125357910-J0CPXIV84B56N3DD96N4/image11.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125357910-J0CPXIV84B56N3DD96N4/image11.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617125357910-J0CPXIV84B56N3DD96N4/image11.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </div>
          </div>
        
          
        

        
          
          <figcaption class="image-caption-wrapper">
            <div class="image-caption"><p class="" style="white-space:pre-wrap;">SEBASTIAN GARCIA</p></div>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div></div></div></div></div></div>
      
    </div>

    <footer class="entry-footer clear">
      
      
      <p class="entry-tags">
        Tagged: <a href="/blog/tag/traffic+analysis" rel="tag">traffic analysis</a>, <a href="/blog/tag/network+traffic" rel="tag">network traffic</a>, <a href="/blog/tag/rat" rel="tag">rat</a>, <a href="/blog/tag/Malware" rel="tag">Malware</a>
      </p>
      
      <div class="entry-actions">
        
  <span class="sqs-simple-like" data-item-id="6061a51de9c30f0939b2fada" data-like-count="3">
    <span class="like-icon"></span>
    <span class="like-count"></span>
  </span>
<span class="squarespace-social-buttons inline-style" data-system-data-id="1617127124323-18TQDXV37MHBSDA1PB0Q" data-asset-url="https://images.squarespace-cdn.com/content/v1/5a01100f692ebe0459a1859f/1617127124323-18TQDXV37MHBSDA1PB0Q/rats.jpg" data-record-type="1" data-full-url="/blog/2021/3/29/dissecting-a-rat-analysis-of-the-androrat" data-title="Dissecting a RAT. Analysis of the AndroRAT."></span>
      </div>
    </footer>

    

  </article>

  <div id="comments-6061a51de9c30f0939b2fada" class="p-comment">
    
  <div class="squarespace-comments" id="comments-6061a51de9c30f0939b2fada" data-item-id="6061a51de9c30f0939b2fada" data-public-comment-count="0" data-comment-state="1"></div>

  </div>

  

  
  <nav class="pagination clear">
    <div class="newer"><span class="prev-label">Newer Post</span><a href="/blog/2021/5/6/dissecting-a-rat-analysis-of-the-ahmyth" rel="prev"><span>Dissecting a RAT. Analysis of the AhMyth.</span></a></div><!-- comment the linebreak between these two elements because science
  --><div class="older"><span class="next-label">Older Post</span><a href="/blog/2021/2/26/dissecting-a-rat-analysis-of-the-spymax" rel="next"><span>Dissecting a RAT. Analysis of the SpyMAX.</span></a></div>
  </nav>
  

</div>
        </div><!--
        --><aside id="rightSidebar" role="complementary">
          <div class="sqs-layout sqs-grid-12 columns-12 open-block-field empty" data-layout-label="Blog Sidebar Content" data-type="block-field" id="blogBlocks-5a01202be2c48324aeddc117"><div class="row sqs-row"><div class="col sqs-col-12 span-12"></div></div></div>
        </aside>
        
        
      </main>

      <div id="preFooter">
        <div class="pre-footer-inner">
          <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Pre-Footer Content" data-type="block-field" data-updated-on="1510062674452" id="preFooterBlocks"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1410979096848_3228"><div class="sqs-block-content">

<div class="sqs-html-content">
  <h1 class="text-align-center">Protecting the civil society through high quality research</h1>
</div>






















</div></div></div></div></div>
        </div>
      </div>

      <footer id="footer" role="contentinfo">
        <div class="footer-inner">
          <div class="nav-wrapper back-to-top-nav"><nav><div class="back-to-top"><a href="#header">Back to Top</a></div></nav></div>
          


          <div id="siteInfo"><span class="site-address">Karlovo náměstí, Praha, Czech Republic</span><a href="mailto:stratosphere@aic.fel.cvut.cz" class="site-email"><span>stratosphere@aic.fel.cvut.cz</span></a></div>
          <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Footer Content" data-type="block-field" data-updated-on="1531498156355" id="footerBlocks"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block socialaccountlinks-v2-block sqs-block-socialaccountlinks-v2" data-block-type="54" id="block-yui_3_17_2_4_1519219355521_4463"><div class="sqs-block-content">



<div class="sqs-svg-icon--outer social-icon-alignment-center social-icons-color-white social-icons-size-extra-large social-icons-style-regular " >
  <style>
    #block-yui_3_17_2_4_1519219355521_4463 .social-icons-style-border .sqs-svg-icon--wrapper {
      
        box-shadow: 0 0 0 2px inset;
      
      border: none; 
    }
  </style>
  <nav class="sqs-svg-icon--list">
    <a href="https://twitter.com/StratosphereIPS" target="_blank" class="sqs-svg-icon--wrapper twitter-unauth" aria-label="Twitter">
      <div>
        <svg class="sqs-svg-icon--social" viewBox="0 0 64 64">
          <use class="sqs-use--icon" xlink:href="#twitter-unauth-icon"></use>
          <use class="sqs-use--mask" xlink:href="#twitter-unauth-mask"></use>
        </svg>
      </div>
    </a>
  </nav>
</div>
</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-713fe491a2c303b33937"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="text-align-center">Powered by <a target="_blank" href="http://www.squarespace.com?channel=word_of_mouth&amp;subchannel=customer&amp;source=footer&amp;campaign=4fd1028ee4b02be53c65dfb3">Squarespace</a></p>
</div>






















</div></div></div></div></div>
        </div>
      </footer>

    </div>

    <script defer="true" src="https://static1.squarespace.com/static/ta/52a74d9ae4b0253945d2aee9/1053/scripts/site-bundle.js" type="text/javascript"></script>
    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" style="display:none" data-usage="social-icons-svg"><symbol id="twitter-unauth-icon" viewBox="0 0 64 64"><path d="M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z"/></symbol><symbol id="twitter-unauth-mask" viewBox="0 0 64 64"><path d="M0,0v64h64V0H0z M44.7,25.5c0,0.3,0,0.6,0,0.8C44.7,35,38.1,45,26.1,45c-3.7,0-7.2-1.1-10.1-2.9 c0.5,0.1,1,0.1,1.6,0.1c3.1,0,5.9-1,8.2-2.8c-2.9-0.1-5.3-2-6.1-4.6c0.4,0.1,0.8,0.1,1.2,0.1c0.6,0,1.2-0.1,1.7-0.2 c-3-0.6-5.3-3.3-5.3-6.4c0,0,0-0.1,0-0.1c0.9,0.5,1.9,0.8,3,0.8c-1.8-1.2-2.9-3.2-2.9-5.5c0-1.2,0.3-2.3,0.9-3.3 c3.2,4,8.1,6.6,13.5,6.9c-0.1-0.5-0.2-1-0.2-1.5c0-3.6,2.9-6.6,6.6-6.6c1.9,0,3.6,0.8,4.8,2.1c1.5-0.3,2.9-0.8,4.2-1.6 c-0.5,1.5-1.5,2.8-2.9,3.6c1.3-0.2,2.6-0.5,3.8-1C47.1,23.4,46,24.5,44.7,25.5z"/></symbol></svg>

  </body>
</html>
