<!doctype html>
<html lang="en">

<head>
    <title>Writing a BugSleep C2 server and detecting its traffic with Snort</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/bootstrap.min.css?v=6f57b90176">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/navigation.css?v=6f57b90176">
    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/footer.css?v=6f57b90176">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/pagination.css?v=6f57b90176">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/banners.css?v=6f57b90176">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/style.css?v=6f57b90176">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/prism.css?v=6f57b90176">
    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/prism-vsc-dark-plus.css?v=6f57b90176">
    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/prism-talos.css?v=6f57b90176">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/landing-page.css?v=6f57b90176">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;1,100;1,300;1,400&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;1,100;1,300;1,400&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/ghost-theme-utils@latest/dist/css/style.min.css" rel="stylesheet">


    <meta name="description" content="This blog will demonstrate the practice and methodology of reversing BugSleep’s protocol, writing a functional C2 server, and detecting this traffic with Snort.">
    <link rel="icon" href="https://blog.talosintelligence.com/content/images/size/w256h256/2022/07/talos_o_square.png" type="image/png">
    <link rel="canonical" href="https://blog.talosintelligence.com/writing-a-bugsleep-c2-server/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="Cisco Talos Blog">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Writing a BugSleep C2 server and detecting its traffic with Snort">
    <meta property="og:description" content="This blog will demonstrate the practice and methodology of reversing BugSleep’s protocol, writing a functional C2 server, and detecting this traffic with Snort.">
    <meta property="og:url" content="https://blog.talosintelligence.com/writing-a-bugsleep-c2-server/">
    <meta property="og:image" content="https://blog.talosintelligence.com/content/images/size/w1200/2024/10/NTDR-DeepDive.jpg">
    <meta property="article:published_time" content="2024-10-30T10:00:40.000Z">
    <meta property="article:modified_time" content="2024-10-30T10:00:39.000Z">
    <meta property="article:tag" content="RAT">
    <meta property="article:tag" content="malware">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Writing a BugSleep C2 server and detecting its traffic with Snort">
    <meta name="twitter:description" content="This blog will demonstrate the practice and methodology of reversing BugSleep’s protocol, writing a functional C2 server, and detecting this traffic with Snort.">
    <meta name="twitter:url" content="https://blog.talosintelligence.com/writing-a-bugsleep-c2-server/">
    <meta name="twitter:image" content="https://blog.talosintelligence.com/content/images/size/w1200/2024/10/NTDR-DeepDive.jpg">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Aaron Boyd">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="RAT, malware">
    <meta name="twitter:site" content="@TalosSecurity">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="600">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Cisco Talos Blog",
        "url": "https://blog.talosintelligence.com/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog.talosintelligence.com/content/images/2022/11/TalosBrand_ukraine.svg"
        }
    },
    "author": {
        "@type": "Person",
        "name": "Aaron Boyd",
        "url": "https://blog.talosintelligence.com/author/aaron/",
        "sameAs": []
    },
    "headline": "Writing a BugSleep C2 server and detecting its traffic with Snort",
    "url": "https://blog.talosintelligence.com/writing-a-bugsleep-c2-server/",
    "datePublished": "2024-10-30T10:00:40.000Z",
    "dateModified": "2024-10-30T10:00:39.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://blog.talosintelligence.com/content/images/size/w1200/2024/10/NTDR-DeepDive.jpg",
        "width": 1200,
        "height": 600
    },
    "keywords": "RAT, malware",
    "description": "This blog will demonstrate the practice and methodology of reversing BugSleep’s protocol, writing a functional C2 server, and detecting this traffic with Snort. ",
    "mainEntityOfPage": "https://blog.talosintelligence.com/writing-a-bugsleep-c2-server/"
}
    </script>

    <meta name="generator" content="Ghost 5.98">
    <link rel="alternate" type="application/rss+xml" title="Cisco Talos Blog" href="https://blog.talosintelligence.com/rss/">
    
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.4/umd/sodo-search.min.js" data-key="4ffb0139d74ada998f4b141e4d" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.4/umd/main.css" data-sodo-search="https://cisco-talos-blog.ghost.io/" data-locale="en" crossorigin="anonymous"></script>
    
    <link href="https://blog.talosintelligence.com/webmentions/receive/" rel="webmention">
    <script defer src="/public/cards.min.js?v=6f57b90176"></script><style>:root {--ghost-accent-color: #006db6;}</style>
    <link rel="stylesheet" type="text/css" href="/public/cards.min.css?v=6f57b90176">
    <style type='text/css'>
    img[src*="icon_check_white.svg"] { width: 20px; margin-left: 0px; margin-right: auto; }
    
    #ghost-portal-root { display: none; }
</style>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-F45RVJG3BK"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-F45RVJG3BK');
</script>
</head>

<body class="post-template tag-rat tag-malware">

    <div id="mobile-page-header" class="desktop-hide">
    <h1>Cisco Talos Blog</h1>
</div>

<nav id="nav">
    <input id="nav-trigger" class="nav-trigger" type="checkbox"/>
    <label for="nav-trigger">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22px" height="16px" viewBox="0 0 22 16">
            <g id="menu-icon">
                <path fill="#FFFFFF" d="M20.5,3h-19C0.672,3,0,2.329,0,1.5S0.672,0,1.5,0h19C21.328,0,22,0.671,22,1.5S21.328,3,20.5,3z"></path>
                <path fill="#FFFFFF" d="M20.5,9.5h-19C0.672,9.5,0,8.828,0,8c0-0.829,0.672-1.5,1.5-1.5h19C21.328,6.5,22,7.171,22,8   C22,8.828,21.328,9.5,20.5,9.5z"></path>
                <path fill="#FFFFFF" d="M20.5,16h-19C0.672,16,0,15.328,0,14.5S0.672,13,1.5,13h19c0.828,0,1.5,0.672,1.5,1.5S21.328,16,20.5,16z"></path>
            </g>
        </svg>
    </label>
    <div id="top-nav-bar">
    </div>

    <div id="navigation">
        <div class="navigation-logos-wrapper">
            <div id="talos-logo-wrapper">
                <a class="navbar-brand" href="https://talosintelligence.com">
                </a>
            </div>
        </div>
        <div class="navigation-links-wrapper">
            <ul class="main-nav-list">
                <li class="nav-item">
                    <div class="primary-link-wrapper">
                        <a class="primary_nav_link" href="https://talosintelligence.com/reputation">
                            <div class="mobile-nav-icon"><!-- Generator: Adobe Illustrator 24.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" height="20px" width="20px" style="enable-background:new 0 0 20 20;" xml:space="preserve">
                            <style type="text/css">
                                .white{fill:#FFFFFF;}
                            </style>
                            <g>
                                <path class="white" d="M19.5,9.5h-1.1c-0.3-4.2-3.6-7.6-7.8-7.8V0.5C10.5,0.2,10.3,0,10,0l0,0C9.7,0,9.5,0.2,9.5,0.5l0,0v1.1   C5.3,1.9,1.9,5.3,1.6,9.5H0.5C0.2,9.5,0,9.7,0,10s0.2,0.5,0.5,0.5l0,0h1.1c0.3,4.2,3.6,7.6,7.8,7.8v1.1c0,0.3,0.2,0.5,0.5,0.5l0,0   c0.3,0,0.5-0.2,0.5-0.5l0,0v-1.1c4.2-0.3,7.6-3.6,7.8-7.8h1.1c0.3,0,0.5-0.2,0.5-0.5C20,9.7,19.8,9.5,19.5,9.5 M16.6,10.5h0.7   c-0.3,3.6-3.2,6.5-6.8,6.8v-0.8c0-0.3-0.2-0.5-0.5-0.5l0,0c-0.3,0-0.5,0.2-0.5,0.5v0.8C5.8,17,3,14.2,2.7,10.5h0.8   C3.8,10.5,4,10.3,4,10S3.8,9.5,3.5,9.5l0,0H2.7C3,5.8,5.8,3,9.5,2.7v0.8C9.5,3.7,9.7,4,10,4l0,0c0.3,0,0.5-0.2,0.5-0.5V2.7   C14.2,3,17,5.8,17.3,9.5h-0.7c-0.3,0-0.5,0.2-0.5,0.5C16.1,10.3,16.3,10.5,16.6,10.5L16.6,10.5"></path>
                                                            <circle class="white" cx="10" cy="10" r="3.2"></circle>
                            </g>
                            </svg>
                            </div>
                            <span class="top-nav-link-text">
                                Intelligence Center
                            </span>
                        </a>
                    </div>
                    <input class="sub-nav-trigger" id="intelligence-sub-trigger" type="checkbox">
                    <label class="sub-nav-trigger-label" for="intelligence-sub-trigger">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                            <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                            <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                            </g>
                        </svg>

                    </label>
                    <ul class="sub-nav sub-nav-single-list">
                        <li class="desktop-hide">
                            <a class="mobile_nav_link" href="https://talosintelligence.com/reputation"><h1>Intelligence Center</h1>
                            </a></li>
                        <li class="desktop-hide">
                            <label class="subnav-back-button" for="intelligence-sub-trigger">BACK</label>
                        </li>
                        <li><a class="secondary_nav_link" href="https://talosintelligence.com/reputation_center">Intelligence Search</a></li>
                        <li><a class="secondary_nav_link" href="https://talosintelligence.com/reputation_center/email_rep">Email &amp; Spam Trends</a></li>
                    </ul>
                    <div class="desktop-hide subnav-overlay"><!-- Generator: Adobe Illustrator 24.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" height="20px" width="20px" style="enable-background:new 0 0 20 20;" xml:space="preserve">
                        <style type="text/css">
                            .white{fill:#FFFFFF;}
                        </style>
                                                <g>
                            <path class="white" d="M19.5,9.5h-1.1c-0.3-4.2-3.6-7.6-7.8-7.8V0.5C10.5,0.2,10.3,0,10,0l0,0C9.7,0,9.5,0.2,9.5,0.5l0,0v1.1   C5.3,1.9,1.9,5.3,1.6,9.5H0.5C0.2,9.5,0,9.7,0,10s0.2,0.5,0.5,0.5l0,0h1.1c0.3,4.2,3.6,7.6,7.8,7.8v1.1c0,0.3,0.2,0.5,0.5,0.5l0,0   c0.3,0,0.5-0.2,0.5-0.5l0,0v-1.1c4.2-0.3,7.6-3.6,7.8-7.8h1.1c0.3,0,0.5-0.2,0.5-0.5C20,9.7,19.8,9.5,19.5,9.5 M16.6,10.5h0.7   c-0.3,3.6-3.2,6.5-6.8,6.8v-0.8c0-0.3-0.2-0.5-0.5-0.5l0,0c-0.3,0-0.5,0.2-0.5,0.5v0.8C5.8,17,3,14.2,2.7,10.5h0.8   C3.8,10.5,4,10.3,4,10S3.8,9.5,3.5,9.5l0,0H2.7C3,5.8,5.8,3,9.5,2.7v0.8C9.5,3.7,9.7,4,10,4l0,0c0.3,0,0.5-0.2,0.5-0.5V2.7   C14.2,3,17,5.8,17.3,9.5h-0.7c-0.3,0-0.5,0.2-0.5,0.5C16.1,10.3,16.3,10.5,16.6,10.5L16.6,10.5"></path>
                                                    <circle class="white" cx="10" cy="10" r="3.2"></circle>
                        </g>
                        </svg>
                    </div>
                </li>
                <li class="nav-item">
                    <div class="primary-link-wrapper">
                        <a class="primary_nav_link" href="https://talosintelligence.com/vulnerability_info"><div class="mobile-nav-icon"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="26px" height="20px" viewBox="0 0 26 20">
                            <g id="vuln-icon" class="nav-icon">
                                <path fill="#FFFFFF" d="M24.256,18.49L13.872,0.503C13.692,0.192,13.36,0,13,0c-0.359,0-0.692,0.192-0.872,0.503L1.744,18.49  c-0.18,0.312-0.18,0.695,0,1.006C1.924,19.809,2.257,20,2.616,20h20.769c0.359,0,0.691-0.191,0.871-0.504  C24.436,19.186,24.436,18.803,24.256,18.49 M14.268,18.215h-2.533v-1.85h2.533V18.215z M14.268,15.441h-2.533L10.89,6.515h4.222  L14.268,15.441z"></path>
                            </g>
                        </svg>
                        </div>
                            <span class="top-nav-link-text">
                            Vulnerability Research
                            </span>
                        </a></div>
                    <input class="sub-nav-trigger" id="vuln-sub-trigger" type="checkbox">
                    <label class="sub-nav-trigger-label" for="vuln-sub-trigger">
                        <div class="mobile-nav-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                            <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                            <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                            </g>
                        </svg>
                        </div>
                    </label>
                    <ul class="sub-nav sub-nav-single-list">
                        <li class="desktop-hide">
                            <a href="https://talosintelligence.com/vulnerability_info"><h1>Vulnerability Information</h1>
                            </a></li>
                        <li class="desktop-hide">
                            <label class="subnav-back-button" for="vuln-sub-trigger">BACK</label>
                        </li>
                        <li><a class="vulnerabilty-info-nav-link" href="https://talosintelligence.com/vulnerability_reports">Vulnerability Reports</a></li>
                        <li><a class="vulnerabilty-info-nav-link" href="https://talosintelligence.com/ms_advisories">Microsoft Advisories</a></li>
                    </ul>
                    <div class="desktop-hide subnav-overlay">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="26px" height="20px" viewBox="0 0 26 20">
                        <g id="vuln-icon" class="nav-icon">
                            <path fill="#FFFFFF" d="M24.256,18.49L13.872,0.503C13.692,0.192,13.36,0,13,0c-0.359,0-0.692,0.192-0.872,0.503L1.744,18.49  c-0.18,0.312-0.18,0.695,0,1.006C1.924,19.809,2.257,20,2.616,20h20.769c0.359,0,0.691-0.191,0.871-0.504  C24.436,19.186,24.436,18.803,24.256,18.49 M14.268,18.215h-2.533v-1.85h2.533V18.215z M14.268,15.441h-2.533L10.89,6.515h4.222  L14.268,15.441z"></path>
                        </g>
                        </svg>
                    </div>
                </li>
                <li class="nav-item">
                    <a class="primary_nav_link" href="https://talosintelligence.com/incident_response">
                        <div class="mobile-nav-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="111.588" height="148.311" viewBox="0 0 111.588 148.311">
                            <path d="M1.181,128.446v15.7a4.167,4.167,0,0,0,4.167,4.167h100.9a4.167,4.167,0,0,0,4.167-4.167v-15.7a4.167,4.167,0,0,0-4.167-4.167H5.348a4.167,4.167,0,0,0-4.167,4.166M55.8,63.109a3.277,3.277,0,1,1,0,6.553c-10.344,0-20.755,8.578-20.755,18.57a3.277,3.277,0,1,1-6.554,0C28.489,73.947,41.93,63.109,55.8,63.109Zm0-12.016c-21.787,0-39.325,17.81-39.325,39.937v26.7H95.122V91.03c0-22.128-17.537-39.937-39.324-39.937m52.365-38.3a3.291,3.291,0,0,0-2.254,1.024L88.432,31.294a3.283,3.283,0,0,0,4.642,4.644l17.478-17.479a3.278,3.278,0,0,0-2.389-5.666m-105.138,0a3.276,3.276,0,0,0-1.98,5.666L18.522,35.938a3.283,3.283,0,0,0,4.643-4.644L5.687,13.817A3.255,3.255,0,0,0,3.025,12.793ZM55.389.026a3.276,3.276,0,0,0-2.867,3.345V19.642a3.277,3.277,0,1,0,6.554,0V3.371A3.283,3.283,0,0,0,55.389.026Z" fill="#fff"></path>
                            </svg>
                        </div>
                        <span class="top-nav-link-text">
                        Incident Response
                        </span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="primary_nav_link" href="https://blog.talosintelligence.com">
                        <div class="mobile-nav-icon">
                        <!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" width="260px" height="296.5px" viewBox="0 0 260 296.5" enable-background="new 0 0 260 296.5" xml:space="preserve">
                        <path fill="#FFFFFF" d="M243.586,42.404h-14.448c-0.943-4.513-3.143-8.813-6.616-12.33L201.793,9.098  c-4.7-4.757-10.972-7.377-17.66-7.377c-6.578,0-12.777,2.547-17.457,7.173l-33.875,33.511H17.586c-6.6,0-12,5.399-12,12V226.28  c0,6.6,5.4,12,12,12H153.83l84.21,56.278l-27.448-56.278h32.994c6.6,0,12-5.4,12-12V54.404  C255.586,47.804,250.186,42.404,243.586,42.404z M214.662,48.045c-0.01,0.2-0.021,0.399-0.044,0.599  c-0.008,0.069-0.021,0.139-0.031,0.207c-0.046,0.345-0.113,0.688-0.196,1.026c-0.034,0.137-0.063,0.273-0.103,0.408  c-0.039,0.135-0.087,0.267-0.133,0.399c-0.051,0.151-0.102,0.302-0.16,0.45c-0.049,0.126-0.105,0.249-0.16,0.373  c-0.068,0.153-0.139,0.307-0.216,0.457c-0.059,0.116-0.12,0.23-0.184,0.345c-0.088,0.157-0.181,0.312-0.278,0.465  c-0.065,0.104-0.13,0.206-0.2,0.308c-0.115,0.168-0.239,0.33-0.366,0.492c-0.064,0.081-0.124,0.165-0.19,0.244  c-0.199,0.238-0.409,0.472-0.635,0.694L82.458,182.308l-47.932,12.871l13.427-47.74L177.223,19.561  c1.917-1.895,4.414-2.84,6.911-2.84c2.534,0,5.068,0.975,6.99,2.92l20.726,20.974c0.545,0.552,1.002,1.156,1.39,1.79  c0.574,0.938,0.975,1.951,1.206,2.993c0.004,0.021,0.01,0.04,0.014,0.06c0.049,0.226,0.086,0.453,0.119,0.682  c0.008,0.06,0.017,0.118,0.024,0.178c0.026,0.211,0.045,0.424,0.058,0.636c0.004,0.077,0.007,0.153,0.009,0.23  c0.007,0.203,0.011,0.407,0.005,0.61C214.673,47.877,214.666,47.961,214.662,48.045z"></path>
                        </svg>
                    </div>
                        <span class="top-nav-link-text">Blog</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="primary_nav_link" href="https://support.talosintelligence.com">
                        <div class="mobile-nav-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="26px" height="20px" viewBox="0 0 123.17 159.292">
                            <path d="M61.59,0,0,17.069v85.32c0,23.472,61.59,56.9,61.59,56.9s61.58-36.288,61.58-56.9V17.069Zm-.433,149.746C38.314,136.662,8.128,114.3,8.128,102.389V23.239l53.029-14.7Z" fill="#fff"></path>
                        </svg>
                        </div>
                        <span class="top-nav-link-text">Support</span>
                    </a>
                </li>
            </ul>


<!--                <li class="nav-item desktop-hide">-->
<!--                    <button class="search-button" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg> <span>Search Blog</span></button>-->
<!--                </li>-->

            <ul class="secondary-nav-list">
                <div class="more-desktop-link">
                    <div class="more-link-wrapper">
                        <span class="more-nav-link">
                            <div class="desktop-nav-icon more-menu-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22px" height="16px" viewBox="0 0 22 16">
                                <g id="menu-icon">
                                    <path fill="#FFFFFF" d="M20.5,3h-19C0.672,3,0,2.329,0,1.5S0.672,0,1.5,0h19C21.328,0,22,0.671,22,1.5S21.328,3,20.5,3z"></path>
                                    <path fill="#FFFFFF" d="M20.5,9.5h-19C0.672,9.5,0,8.828,0,8c0-0.829,0.672-1.5,1.5-1.5h19C21.328,6.5,22,7.171,22,8   C22,8.828,21.328,9.5,20.5,9.5z"></path>
                                    <path fill="#FFFFFF" d="M20.5,16h-19C0.672,16,0,15.328,0,14.5S0.672,13,1.5,13h19c0.828,0,1.5,0.672,1.5,1.5S21.328,16,20.5,16z"></path>
                                </g>
                                </svg>
                            </div>
                            <span class="top-nav-link-text top-nav-more-text">
                            More
                            </span>
                        </span>
                    </div>
                </div>
                <li class="nav-item more-text-link">
                    <div class="more-link-wrapper more-link-wrapper-mobile">
                        <span class="more-nav-link">
                            <div class="mobile-nav-icon"><!-- Generator: Adobe Illustrator 24.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" style="enable-background:new 0 0 20 20;" width="25px" height="25px" xml:space="preserve">
                                <style type="text/css">
                                    .white{fill:#FFFFFF;}
                                </style>
                                <path class="white" d="M19.4,17.1c0,0.1-0.1,0-0.2,0c0,0-1.3-0.9-2-1.4c-0.2-0.1-0.5-0.1-0.6,0.1c-0.3,0.3-0.6,0.8-0.9,1.3  c-0.1,0.2-0.1,0.5,0.1,0.6l2,1.5c0.1,0,0,0.1,0.1,0.2c0,0.1,0,0.1-0.1,0.2c-1.2,0.5-2.6,0.2-3.5-0.7c-0.8-0.9-1-2-0.7-3.1L4.5,6.5  c-1,0.3-2.3,0-3-0.9c-0.8-0.9-1.1-1.7-1-2.7c0-0.1,0-0.1,0.1-0.2c0.1,0,0.2,0.1,0.2,0.1l2,1.5C3,4.4,3.3,4.5,3.4,4.2  c0,0,0.5-0.8,0.9-1.3c0.1-0.2,0.1-0.5-0.1-0.6L2.3,0.9c-0.1,0,0-0.1-0.1-0.3c0-0.1,0-0.1,0.1-0.2C3.5-0.1,5,0.2,5.8,1.1  c0.8,0.9,1,2,0.7,3.1l9.1,9.3c1-0.3,2.3,0,3,0.9c0.7,0.7,0.9,1.5,0.9,2.5C19.5,16.9,19.5,17,19.4,17.1z"></path>
                                </svg>
                            </div>
                            <span class="top-nav-link-text top-nav-more-text">
                            Security Resources
                            </span>
                        </span>
                    </div>
                    <input class="sub-nav-trigger" id="security-resources-sub-trigger" type="checkbox">
                    <label class="sub-nav-trigger-label" for="security-resources-sub-trigger">
                        <div class="mobile-nav-icon"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                            <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                            <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                            </g>
                        </svg>
                        </div>
                    </label>
                    <div class="sub-nav sub-nav-multiple-list sub-nav-multiple-list-left">
                        <div class="sub-nav-multiple-wrapper">
                            <div class="sub-nav-list-top-of-mobile-wrapper">
                                <h1 class="sub-nav-list-header sub-nav-list-top-of-mobile">Security Resources</h1>
                                <ul class="sub-nav-list">
                                    <li class="desktop-hide">
                                        <label class="subnav-back-button" for="security-resources-sub-trigger">BACK</label>
                                    </li>
                                </ul>
                            </div>
                            <div class="sub-nav-list-item-wrapper">
                                <span class="sub-nav-desktop-header uppercase">Security Resources</span>
                                <ul class="sub-nav-list">
                                    <li>
                                        <a href="https://talosintelligence.com/software"><span>Open Source Security Tools</span>
                                        </a></li>
                                    <li>
                                        <a href="https://talosintelligence.com/categories"><span>Intelligence Categories Reference</span>
                                        </a></li>
                                    <li>
                                        <a href="https://talosintelligence.com/secure-endpoint-naming"><span>Secure Endpoint Naming Reference</span>
                                        </a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="desktop-hide subnav-overlay"><!-- Generator: Adobe Illustrator 24.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" style="enable-background:new 0 0 20 20;" width="25px" height="25px" xml:space="preserve">
                        <style type="text/css">
                            .white{fill:#FFFFFF;}
                        </style>
                                                <path class="white" d="M19.4,17.1c0,0.1-0.1,0-0.2,0c0,0-1.3-0.9-2-1.4c-0.2-0.1-0.5-0.1-0.6,0.1c-0.3,0.3-0.6,0.8-0.9,1.3  c-0.1,0.2-0.1,0.5,0.1,0.6l2,1.5c0.1,0,0,0.1,0.1,0.2c0,0.1,0,0.1-0.1,0.2c-1.2,0.5-2.6,0.2-3.5-0.7c-0.8-0.9-1-2-0.7-3.1L4.5,6.5  c-1,0.3-2.3,0-3-0.9c-0.8-0.9-1.1-1.7-1-2.7c0-0.1,0-0.1,0.1-0.2c0.1,0,0.2,0.1,0.2,0.1l2,1.5C3,4.4,3.3,4.5,3.4,4.2  c0,0,0.5-0.8,0.9-1.3c0.1-0.2,0.1-0.5-0.1-0.6L2.3,0.9c-0.1,0,0-0.1-0.1-0.3c0-0.1,0-0.1,0.1-0.2C3.5-0.1,5,0.2,5.8,1.1  c0.8,0.9,1,2,0.7,3.1l9.1,9.3c1-0.3,2.3,0,3,0.9c0.7,0.7,0.9,1.5,0.9,2.5C19.5,16.9,19.5,17,19.4,17.1z"></path>
                        </svg>
                    </div>
                </li>
                <li class="nav-item">
                    <div class="more-link-wrapper more-link-wrapper-mobile">
                        <span class="more-nav-link">
                            <div class="mobile-nav-icon"><!-- Generator: Adobe Illustrator 24.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" width="25px" height="25px" style="enable-background:new 0 0 20 20;" xml:space="preserve">
                                <style type="text/css">
                                    .sticoncomment{fill-rule:evenodd;clip-rule:evenodd;fill:#FFFFFF;}
                                </style>
                                <path class="sticoncomment" d="M13.6,7.1H6.4c-0.3,0-0.6-0.3-0.6-0.6c0-0.3,0.3-0.6,0.6-0.6l7.2,0c0.3,0,0.6,0.3,0.6,0.6  C14.2,6.8,13.9,7.1,13.6,7.1L13.6,7.1z M13.6,9.4H6.4c-0.3,0-0.6-0.3-0.6-0.6s0.3-0.6,0.6-0.6l7.2,0c0.3,0,0.6,0.3,0.6,0.6  C14.2,9.2,13.9,9.4,13.6,9.4L13.6,9.4z M11.5,11.7H6.4c-0.3,0-0.6-0.3-0.6-0.6c0-0.3,0.3-0.6,0.6-0.6h5.1c0.3,0,0.6,0.3,0.6,0.6  C12.1,11.5,11.8,11.7,11.5,11.7z M15.8,3H4.2C3.5,3,3,3.5,3,4.2V17l2.8-2.3h10c0.6,0,1.2-0.5,1.2-1.2V4.2C17,3.5,16.5,3,15.8,3  L15.8,3z"></path>
                                </svg>
                            </div>
                            <span class="top-nav-link-text top-nav-more-text">
                            Media
                            </span>
                        </span>
                    </div>
                    <input class="sub-nav-trigger" id="media-sub-trigger" type="checkbox">
                    <label class="sub-nav-trigger-label" for="media-sub-trigger">
                        <div class="mobile-nav-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                            <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                            <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                            </g>
                            </svg>
                        </div>
                    </label>
                    <div class="sub-nav sub-nav-multiple-list sub-nav-multiple-list-middle">
                        <div class="sub-nav-multiple-wrapper">
                            <div class="sub-nav-list-top-of-mobile-wrapper">
                                <h1 class="sub-nav-list-header sub-nav-list-top-of-mobile">Media</h1>
                                <ul class="sub-nav-list">
                                    <li class="desktop-hide">
                                        <label class="subnav-back-button" for="media-sub-trigger">BACK</label>
                                    </li>
                                </ul>
                            </div>
                            <div class="sub-nav-list-item-wrapper">
                                <span class="sub-nav-desktop-header uppercase">Media</span>
                                <ul class="sub-nav-list">
                                    <li>
                                        <a href="https://blog.talosintelligence.com"><span>Talos Intelligence Blog</span>
                                        </a></li>
                                    <li>
                                        <a href="https://blog.talosintelligence.com/category/threat-source-newsletter/"><span>Threat Source Newsletter</span>
                                        </a></li>
                                    <li>
                                        <a href="https://talosintelligence.com/podcasts/shows/beers_with_talos"><span>Beers with Talos Podcast</span>
                                        </a></li>
                                    <li>
                                        <a href="https://talosintelligence.com/podcasts/shows/talos_takes"><span>Talos Takes Podcast</span>
                                        </a></li>
                                    <li>
                                        <a target="_blank" href="https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured"><span>Talos Videos</span>
                                        </a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="desktop-hide subnav-overlay"><!-- Generator: Adobe Illustrator 24.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" width="25px" height="25px" style="enable-background:new 0 0 20 20;" xml:space="preserve">
                        <style type="text/css">
                            .sticoncomment{fill-rule:evenodd;clip-rule:evenodd;fill:#FFFFFF;}
                        </style>
                        <path class="sticoncomment" d="M13.6,7.1H6.4c-0.3,0-0.6-0.3-0.6-0.6c0-0.3,0.3-0.6,0.6-0.6l7.2,0c0.3,0,0.6,0.3,0.6,0.6  C14.2,6.8,13.9,7.1,13.6,7.1L13.6,7.1z M13.6,9.4H6.4c-0.3,0-0.6-0.3-0.6-0.6s0.3-0.6,0.6-0.6l7.2,0c0.3,0,0.6,0.3,0.6,0.6  C14.2,9.2,13.9,9.4,13.6,9.4L13.6,9.4z M11.5,11.7H6.4c-0.3,0-0.6-0.3-0.6-0.6c0-0.3,0.3-0.6,0.6-0.6h5.1c0.3,0,0.6,0.3,0.6,0.6  C12.1,11.5,11.8,11.7,11.5,11.7z M15.8,3H4.2C3.5,3,3,3.5,3,4.2V17l2.8-2.3h10c0.6,0,1.2-0.5,1.2-1.2V4.2C17,3.5,16.5,3,15.8,3  L15.8,3z"></path>
                        </svg>
                    </div>
                </li>
                <li class="nav-item">
                    <div class="more-link-wrapper more-link-wrapper-mobile">
                        <span class="more-nav-link">
                            <div class="mobile-nav-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25px" height="25px" viewBox="0 0 55 55">
                                <g>
                                    <g class="mobile-nav-home">
                                        <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M45.201,12.343c0.378,0.48,0.758,0.925,1.096,1.401    c2.975,4.207,4.543,8.876,4.494,14.044c-0.05,5.452-1.643,10.386-5.186,14.593c-3.484,4.133-7.929,6.73-13.182,7.895    c-6.313,1.398-12.216,0.275-17.695-3.131c-0.441-0.273-0.847-0.6-1.266-0.904c-0.11-0.078-0.208-0.174-0.337-0.287    c0.127-0.141,0.246-0.27,0.366-0.398c0.887-0.949,1.765-1.904,2.663-2.844c0.114-0.119,0.321-0.217,0.485-0.217    c3.658-0.006,7.318,0,10.975,0.008c3.458,0.006,6.913,0.02,10.369,0.02c0.957,0,1.871-0.193,2.62-0.844    c0.797-0.693,1.157-1.596,1.157-2.643c0.001-7.533,0.003-15.067-0.005-22.601c-0.002-0.309,0.088-0.524,0.3-0.743    C43.098,14.598,44.127,13.49,45.201,12.343"></path>
                                        <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M41.402,8.822c-0.99,1.027-1.994,2.021-2.935,3.072    c-0.312,0.35-0.616,0.416-1.036,0.415c-6.98-0.009-13.957-0.007-20.938-0.007c-2.039,0-3.561,1.514-3.561,3.557    c0,6.504,0.002,13.008,0.006,19.512c0.002,0.973,0.011,1.943,0.004,2.914c0,0.133-0.04,0.301-0.127,0.393    c-1.069,1.162-2.15,2.314-3.229,3.469c-0.021,0.023-0.052,0.039-0.109,0.08c-0.159-0.188-0.323-0.369-0.471-0.562    c-2.535-3.348-4.119-7.102-4.605-11.268c-0.61-5.229,0.194-10.229,2.835-14.839c2.669-4.664,6.655-7.805,11.618-9.75    c3.205-1.257,6.533-1.852,9.977-1.621c4.478,0.298,8.553,1.754,12.227,4.325c0.101,0.072,0.197,0.151,0.291,0.229    C41.364,8.755,41.374,8.778,41.402,8.822"></path>
                                        <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M39.799,12.47c0.873-0.911,1.749-1.829,2.676-2.797    c0.605,0.564,1.195,1.112,1.816,1.691c-0.941,0.985-1.817,1.903-2.703,2.83c-0.276-0.339-0.511-0.688-0.807-0.975    C40.492,12.941,40.145,12.728,39.799,12.47"></path>
                                        <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M10.35,43.279c0.969-1.016,1.885-1.977,2.76-2.893    c0.213,0.369,0.376,0.762,0.639,1.072c0.265,0.312,0.627,0.539,0.98,0.832c-0.853,0.891-1.713,1.791-2.624,2.746    C11.513,44.445,10.939,43.869,10.35,43.279"></path>
                                    </g>
                                </g>
                                </svg>
                            </div>
                            <span class="top-nav-link-text top-nav-more-text">
                            Company
                            </span>
                        </span>
                    </div>
                    <input class="sub-nav-trigger" id="company-sub-trigger" type="checkbox">
                    <label class="sub-nav-trigger-label" for="company-sub-trigger">
                        <div class="mobile-nav-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                            <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                            <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                            </g>
                        </svg>
                        </div>
                    </label>
                    <div class="sub-nav sub-nav-multiple-list sub-nav-multiple-list-right">
                        <div class="sub-nav-multiple-wrapper">
                            <div class="sub-nav-list-top-of-mobile-wrapper">
                                <h1 class="sub-nav-list-header sub-nav-list-top-of-mobile">Company</h1>
                                <ul class="sub-nav-list">
                                    <li class="desktop-hide">
                                        <label class="subnav-back-button" for="company-sub-trigger">BACK</label>
                                    </li>
                                </ul>
                            </div>
                            <div class="sub-nav-list-item-wrapper">
                                <span class="sub-nav-desktop-header uppercase">Company</span>
                                <ul class="sub-nav-list">
                                    <li>
                                        <a href="https://talosintelligence.com/about"><span>About Talos</span>
                                        </a></li>
                                    <li>
                                        <a href="https://talosintelligence.com/careers"><span>Careers</span>
                                        </a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="desktop-hide subnav-overlay"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25px" height="25px" viewBox="0 0 55 55">
                        <g>
                            <g class="mobile-nav-home">
                                <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M45.201,12.343c0.378,0.48,0.758,0.925,1.096,1.401    c2.975,4.207,4.543,8.876,4.494,14.044c-0.05,5.452-1.643,10.386-5.186,14.593c-3.484,4.133-7.929,6.73-13.182,7.895    c-6.313,1.398-12.216,0.275-17.695-3.131c-0.441-0.273-0.847-0.6-1.266-0.904c-0.11-0.078-0.208-0.174-0.337-0.287    c0.127-0.141,0.246-0.27,0.366-0.398c0.887-0.949,1.765-1.904,2.663-2.844c0.114-0.119,0.321-0.217,0.485-0.217    c3.658-0.006,7.318,0,10.975,0.008c3.458,0.006,6.913,0.02,10.369,0.02c0.957,0,1.871-0.193,2.62-0.844    c0.797-0.693,1.157-1.596,1.157-2.643c0.001-7.533,0.003-15.067-0.005-22.601c-0.002-0.309,0.088-0.524,0.3-0.743    C43.098,14.598,44.127,13.49,45.201,12.343"></path>
                                <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M41.402,8.822c-0.99,1.027-1.994,2.021-2.935,3.072    c-0.312,0.35-0.616,0.416-1.036,0.415c-6.98-0.009-13.957-0.007-20.938-0.007c-2.039,0-3.561,1.514-3.561,3.557    c0,6.504,0.002,13.008,0.006,19.512c0.002,0.973,0.011,1.943,0.004,2.914c0,0.133-0.04,0.301-0.127,0.393    c-1.069,1.162-2.15,2.314-3.229,3.469c-0.021,0.023-0.052,0.039-0.109,0.08c-0.159-0.188-0.323-0.369-0.471-0.562    c-2.535-3.348-4.119-7.102-4.605-11.268c-0.61-5.229,0.194-10.229,2.835-14.839c2.669-4.664,6.655-7.805,11.618-9.75    c3.205-1.257,6.533-1.852,9.977-1.621c4.478,0.298,8.553,1.754,12.227,4.325c0.101,0.072,0.197,0.151,0.291,0.229    C41.364,8.755,41.374,8.778,41.402,8.822"></path>
                                <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M39.799,12.47c0.873-0.911,1.749-1.829,2.676-2.797    c0.605,0.564,1.195,1.112,1.816,1.691c-0.941,0.985-1.817,1.903-2.703,2.83c-0.276-0.339-0.511-0.688-0.807-0.975    C40.492,12.941,40.145,12.728,39.799,12.47"></path>
                                <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M10.35,43.279c0.969-1.016,1.885-1.977,2.76-2.893    c0.213,0.369,0.376,0.762,0.639,1.072c0.265,0.312,0.627,0.539,0.98,0.832c-0.853,0.891-1.713,1.791-2.624,2.746    C11.513,44.445,10.939,43.869,10.35,43.279"></path>
                            </g>
                        </g>
                    </svg>
                    </div>
                </li>
            </ul>
            <div class="nav-search-wrapper">
                <button class="search-button" data-ghost-search>
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                </button>
            </div>
        </div>



    </div>
</nav>

    

    <main id="site-main">
        <div class="container-fluid">
            <div class="row main-content-row">
                <div class="col">
                    <div class="post-full-content">
                        
<article class="post tag-rat tag-malware ">
        <div class="feature-image-wrapper my-5">
            <figure>
                <img src="/content/images/2024/10/NTDR-DeepDive.jpg" alt="" class="img-fluid" />
            </figure>
        </div>

    <h1 class="text-center">Writing a BugSleep C2 server and detecting its traffic with Snort</h1>

    <div class="text-center m-1">
        <div class="post-author">
            <span>By </span>
                <a href="https://blog.talosintelligence.com/author/aaron/">Aaron Boyd</a>
        </div>

        <br/>
        <time class="post-datetime" datetime="October 30, 2024 06:00">
            Wednesday, October 30, 2024 06:00
        </time>

        <div class="m-3">
                            <a href="/category/rat/" class="category primary-category">
                                RAT
                            </a>
                                                    <a href="/category/malware/" class="category primary-category">
                                malware
                            </a>
                                </div>
    </div>

    <section class="post-content-wrapper mt-5">
        <div class="post-content">
            <p>In June 2024, security researchers published their analysis of a novel implant dubbed “<a href="https://blog.sekoia.io/muddywater-replaces-atera-by-custom-muddyrot-implant-in-a-recent-campaign/" rel="noreferrer noopener"><u>MuddyRot</u></a>”(aka "<a href="https://research.checkpoint.com/2024/new-bugsleep-backdoor-deployed-in-recent-muddywater-campaigns/" rel="noreferrer noopener"><u>BugSleep</u></a>"). This remote access tool (RAT) gives operators reverse shell and file input/output (I/O) capabilities on a victim’s endpoint using a bespoke command and control (C2) protocol. This blog will demonstrate the practice and methodology of reversing BugSleep’s protocol, writing a functional C2 server, and detecting this traffic with Snort.&nbsp;</p><h1 id="key-findings">Key findings&nbsp;</h1><ul><li>BugSleep implant implements a bespoke C2 protocol over plain TCP sockets.&nbsp;</li><li>BugSleep operators have demonstrated multiple file-obfuscation techniques to avoid detection.&nbsp;</li><li>BugSleep implements reverse shell, file I/O, and persistence capabilities on the target system.&nbsp;</li></ul><h1 id="sending-and-receiving-data">Sending and receiving data&nbsp;</h1><p>This blog will use sample b8703744744555ad841f922995cef5dbca11da22565195d05529f5f9095fbfca for analysis. Two of the lowest functions in the C2 stack, referred to as SendSocket (FUN_1400034c0) and ReadSocket (FUN_140003390), are very light wrappers for the send and receive API functions and handle payload encryption. They include some error handling by attempting to send or receive data 10 times before failing.&nbsp;&nbsp;</p><p>This protocol uses a pseudo-TLV (Type Length Value) structure with only two types: integer or string. Integers are sent as little-endian 4- or 8-byte values, and strings are prepended with the 4-byte value of its length. Payloads are then encrypted by subtracting a static value from each byte in the buffer (in this sample it is three).&nbsp;&nbsp;</p>
<!--kg-card-begin: html-->
<table class="Table Ltr TableWordWrap SCXW74274086 BCX0" border="1" data-tablestyle="MsoNormalTable" data-tablelook="1536" aria-rowcount="3" style="-webkit-user-drag: none; margin: 0px; padding: 0px; table-layout: fixed; width: 0px; border-collapse: collapse; empty-cells: show; position: relative; overflow: visible; background: none; border-spacing: 0px;"><tbody class="SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;"><tr class="TableRow SCXW74274086 BCX0" role="row" aria-rowindex="1" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; height: 20px;"><td class="FirstRow FirstCol SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(0, 0, 0); width: 101px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="96918056" paraeid="{000fc558-9473-4620-bd71-c6983449aa39}{243}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: center; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">Type</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:2,&quot;335551620&quot;:2,&quot;335559739&quot;:0,&quot;335559740&quot;:240}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td><td class="FirstRow SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(0, 0, 0); width: 64px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="950791520" paraeid="{000fc558-9473-4620-bd71-c6983449aa39}{250}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: center; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">Value</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:2,&quot;335551620&quot;:2,&quot;335559739&quot;:0,&quot;335559740&quot;:240}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td><td class="FirstRow SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(0, 0, 0); width: 219px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="918438460" paraeid="{d7d56b04-e6c2-498f-aac9-f68fe4d70451}{2}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: center; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">Plain </span><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">t</span><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">ext</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:2,&quot;335551620&quot;:2,&quot;335559739&quot;:0,&quot;335559740&quot;:240}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td><td class="FirstRow LastCol SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(0, 0, 0); width: 229px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="1006616775" paraeid="{d7d56b04-e6c2-498f-aac9-f68fe4d70451}{13}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: center; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">Cipher </span><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">t</span><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">ext</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:2,&quot;335551620&quot;:2,&quot;335559739&quot;:0,&quot;335559740&quot;:240}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td></tr><tr class="TableRow SCXW74274086 BCX0" role="row" aria-rowindex="2" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; height: 20px;"><td class="FirstCol SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(0, 0, 0); width: 101px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="2066705268" paraeid="{d7d56b04-e6c2-498f-aac9-f68fe4d70451}{25}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SpellingErrorV2Themed SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; background-position: 0px 100%; background-repeat: repeat-x; background-image: var(--urlSpellingErrorV2,url(&quot;data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1IiBoZWlnaHQ9IjQiPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggc3Ryb2tlPSIjRUIwMDAwIiBkPSJNMCAzYzEuMjUgMCAxLjI1LTIgMi41LTJTMy43NSAzIDUgMyIvPjxwYXRoIGQ9Ik0wIDBoNXY0SDB6Ii8+PC9nPjwvc3ZnPg==&quot;)); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: transparent;">Integer</span><span class="NormalTextRun SpellingErrorV2Themed SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; background-position: 0px 100%; background-repeat: repeat-x; background-image: var(--urlSpellingErrorV2,url(&quot;data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1IiBoZWlnaHQ9IjQiPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggc3Ryb2tlPSIjRUIwMDAwIiBkPSJNMCAzYzEuMjUgMCAxLjI1LTIgMi41LTJTMy43NSAzIDUgMyIvPjxwYXRoIGQ9Ik0wIDBoNXY0SDB6Ii8+PC9nPjwvc3ZnPg==&quot;)); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: transparent;">Msg</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:240}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td><td data-celllook="4369" class="SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(0, 0, 0); width: 64px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="1698311721" paraeid="{d7d56b04-e6c2-498f-aac9-f68fe4d70451}{34}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">6</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:240}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td><td data-celllook="4369" class="SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(0, 0, 0); width: 219px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="67747796" paraeid="{d7d56b04-e6c2-498f-aac9-f68fe4d70451}{41}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">06 00 00 00</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:240}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td><td class="LastCol SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(0, 0, 0); width: 229px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="84987605" paraeid="{d7d56b04-e6c2-498f-aac9-f68fe4d70451}{48}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">03 FD </span><span class="NormalTextRun SpellingErrorV2Themed SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; background-position: 0px 100%; background-repeat: repeat-x; background-image: var(--urlSpellingErrorV2,url(&quot;data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1IiBoZWlnaHQ9IjQiPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggc3Ryb2tlPSIjRUIwMDAwIiBkPSJNMCAzYzEuMjUgMCAxLjI1LTIgMi41LTJTMy43NSAzIDUgMyIvPjxwYXRoIGQ9Ik0wIDBoNXY0SDB6Ii8+PC9nPjwvc3ZnPg==&quot;)); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: transparent;">FD</span><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;"> </span><span class="NormalTextRun SpellingErrorV2Themed SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; background-position: 0px 100%; background-repeat: repeat-x; background-image: var(--urlSpellingErrorV2,url(&quot;data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1IiBoZWlnaHQ9IjQiPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggc3Ryb2tlPSIjRUIwMDAwIiBkPSJNMCAzYzEuMjUgMCAxLjI1LTIgMi41LTJTMy43NSAzIDUgMyIvPjxwYXRoIGQ9Ik0wIDBoNXY0SDB6Ii8+PC9nPjwvc3ZnPg==&quot;)); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: transparent;">FD</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:240}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td></tr><tr class="TableRow SCXW74274086 BCX0" role="row" aria-rowindex="3" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; height: 20px;"><td class="FirstCol LastRow SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(0, 0, 0); width: 101px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="782434632" paraeid="{d7d56b04-e6c2-498f-aac9-f68fe4d70451}{62}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SpellingErrorV2Themed SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; background-position: 0px 100%; background-repeat: repeat-x; background-image: var(--urlSpellingErrorV2,url(&quot;data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1IiBoZWlnaHQ9IjQiPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggc3Ryb2tlPSIjRUIwMDAwIiBkPSJNMCAzYzEuMjUgMCAxLjI1LTIgMi41LTJTMy43NSAzIDUgMyIvPjxwYXRoIGQ9Ik0wIDBoNXY0SDB6Ii8+PC9nPjwvc3ZnPg==&quot;)); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: transparent;">String</span><span class="NormalTextRun SpellingErrorV2Themed SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; background-position: 0px 100%; background-repeat: repeat-x; background-image: var(--urlSpellingErrorV2,url(&quot;data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1IiBoZWlnaHQ9IjQiPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggc3Ryb2tlPSIjRUIwMDAwIiBkPSJNMCAzYzEuMjUgMCAxLjI1LTIgMi41LTJTMy43NSAzIDUgMyIvPjxwYXRoIGQ9Ik0wIDBoNXY0SDB6Ii8+PC9nPjwvc3ZnPg==&quot;)); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: transparent;">Msg</span></span><span class="TabRun IPSelectionBlob BlobObject DragDrop SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; display: inline-block; font-family: Calibri, sans-serif; font-size: 12pt; font-style: normal; font-weight: 400; position: relative; text-indent: 0px; white-space: nowrap; text-align: left; width: 0px;"><span class="TabChar SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; display: inline-block; white-space: pre !important;">	</span><span class="TabLeaderChars SCXW74274086 BCX0" aria-hidden="true" style="-webkit-user-drag: none; margin: 0px; padding: 0px; display: inline-block; left: 0px; position: absolute; top: 0px; white-space: pre !important;"></span></span><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun EmptyTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:240,&quot;469777462&quot;:[1126],&quot;469777927&quot;:[0],&quot;469777928&quot;:[1]}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td><td class="LastRow SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(0, 0, 0); width: 64px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="1047855819" paraeid="{d7d56b04-e6c2-498f-aac9-f68fe4d70451}{73}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">Talos</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:240}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td><td class="LastRow SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(0, 0, 0); width: 219px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="704185653" paraeid="{d7d56b04-e6c2-498f-aac9-f68fe4d70451}{80}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">05 00 00 00 48 65 6C </span><span class="NormalTextRun SpellingErrorV2Themed SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; background-position: 0px 100%; background-repeat: repeat-x; background-image: var(--urlSpellingErrorV2,url(&quot;data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1IiBoZWlnaHQ9IjQiPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggc3Ryb2tlPSIjRUIwMDAwIiBkPSJNMCAzYzEuMjUgMCAxLjI1LTIgMi41LTJTMy43NSAzIDUgMyIvPjxwYXRoIGQ9Ik0wIDBoNXY0SDB6Ii8+PC9nPjwvc3ZnPg==&quot;)); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: transparent;">6C</span><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;"> 6F</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:240}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td><td class="LastCol LastRow SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(0, 0, 0); width: 229px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="1363772791" paraeid="{d7d56b04-e6c2-498f-aac9-f68fe4d70451}{91}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">02 FD </span><span class="NormalTextRun SpellingErrorV2Themed SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; background-position: 0px 100%; background-repeat: repeat-x; background-image: var(--urlSpellingErrorV2,url(&quot;data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1IiBoZWlnaHQ9IjQiPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggc3Ryb2tlPSIjRUIwMDAwIiBkPSJNMCAzYzEuMjUgMCAxLjI1LTIgMi41LTJTMy43NSAzIDUgMyIvPjxwYXRoIGQ9Ik0wIDBoNXY0SDB6Ii8+PC9nPjwvc3ZnPg==&quot;)); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: transparent;">FD</span><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;"> </span><span class="NormalTextRun SpellingErrorV2Themed SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; background-position: 0px 100%; background-repeat: repeat-x; background-image: var(--urlSpellingErrorV2,url(&quot;data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1IiBoZWlnaHQ9IjQiPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggc3Ryb2tlPSIjRUIwMDAwIiBkPSJNMCAzYzEuMjUgMCAxLjI1LTIgMi41LTJTMy43NSAzIDUgMyIvPjxwYXRoIGQ9Ik0wIDBoNXY0SDB6Ii8+PC9nPjwvc3ZnPg==&quot;)); border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: transparent;">FD</span><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;"> 51 5E 69 6C 70</span></span><span class="EOP CommentStart SCXW74274086 BCX0" data-ccp-props="{&quot;134245417&quot;:false,&quot;201341983&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:240}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 19px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td></tr></tbody></table><br><i><font color=gray>Figure 1: Example of data encryption used by BugSleep</font></i><br><br>
<!--kg-card-end: html-->
<p>There are two main functions for handling C2 communications: C2Loop (FUN_1400012c0) and CommandHandler (FUN_1400028a0). C2Loop is responsible for setting up socket connections with the server and sending a beacon, while CommandHandler is responsible for processing and executing commands from the server.&nbsp;</p><p>After setting up the socket connection, the implant beacons (FUN_140003d80) to the C2 server for a command. The beacon is a StringMsg in the form ComputerName/Username. If the server responds with an IntegerMsg equal to 0x03, BugSleep will terminate itself. We suspect this is remnants of an old kill command or an emergency kill without the overhead of reading the real kill command later.&nbsp;</p><p>Each BugSleep command is sent as an IntegerMsg after the beacon response. The following enumeration defines all the command IDs discovered.&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-a85a7b31-0f66-4555-aaad-68e725e7f73f.png" class="kg-image" alt="" loading="lazy" width="594" height="236"><figcaption><span style="white-space: pre-wrap;">Figure 2: Command IDs used by implant&nbsp;</span></figcaption></figure><h1 id="phoning-home">Phoning home&nbsp;</h1><p>The implant communicates using plain TCP sockets, which can be seen using a Netcat listener and Wireshark.&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-9bba947a-966d-4dbe-9539-3d173a7cfc7c.png" class="kg-image" alt="A screenshot of a computer

Description automatically generated" loading="lazy" width="522" height="122"><figcaption><span style="white-space: pre-wrap;">Figure 3: BugSleep beacon as seen through Wireshark.&nbsp;</span></figcaption></figure><p>Recalling the message encryption demonstrated in Figure 1, the beacon can be decrypted with a little bit of Python (Figure 4). This will be used again when building the rest of the C2 server.&nbsp;&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-24cee908-e7ee-46ac-b7dc-838e765bea60.png" class="kg-image" alt="A computer screen shot of a program code

Description automatically generated" loading="lazy" width="556" height="235"><figcaption><span style="white-space: pre-wrap;">Figure 4: Decoding beacon data&nbsp;</span></figcaption></figure><h1 id="python-c2-server">Python C2 server&nbsp;</h1><p>With an understanding of the protocol basics, it is time to start building the C2 server. Full source code can be found <a href="https://gitlab.vrt.sourcefire.com/aaboyd/bugsleep/-/tree/master/server" rel="noreferrer noopener"><u>here</u></a>.&nbsp;</p><h2 id="beacon">Beacon&nbsp;</h2><p>As mentioned earlier, the BugSleep beacon function sends a StringMsg and reads an IntegerMsg response from the server. Since the IntegerMsg returned can be anything but 0x03, we returned the length of the Computer Name/Username string received by the server.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-14de2c53-4ea3-4527-8f37-bae223cc48a8.png" class="kg-image" alt="A screenshot of a computer program

Description automatically generated" loading="lazy" width="624" height="199" srcset="https://blog.talosintelligence.com/content/images/size/w600/2024/10/data-src-image-14de2c53-4ea3-4527-8f37-bae223cc48a8.png 600w, https://blog.talosintelligence.com/content/images/2024/10/data-src-image-14de2c53-4ea3-4527-8f37-bae223cc48a8.png 624w"><figcaption><span style="white-space: pre-wrap;">Figure 5: Output from C2 server receiving beacon data&nbsp;</span></figcaption></figure><h2 id="ping-command">Ping command&nbsp;</h2><p>The simplest command to implement is the Ping command. It has the command ID of 0x63 (BugSleep subtracts one from whatever ID it receives). The code is simple: send back 4 bytes.&nbsp;&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-dcc3ad4d-4771-4441-b65c-9fecf79a1cc6.png" class="kg-image" alt="" loading="lazy" width="624" height="55" srcset="https://blog.talosintelligence.com/content/images/size/w600/2024/10/data-src-image-dcc3ad4d-4771-4441-b65c-9fecf79a1cc6.png 600w, https://blog.talosintelligence.com/content/images/2024/10/data-src-image-dcc3ad4d-4771-4441-b65c-9fecf79a1cc6.png 624w"><figcaption><span style="white-space: pre-wrap;">Figure 6: Switch case for handling ping command&nbsp;</span></figcaption></figure><p>Once the beacon comes in, the server is responsible for:&nbsp;</p><ol><li>Sending 4 bytes for beacon response&nbsp;</li><li>Sending 4 bytes for Ping command ID&nbsp;</li><li>Reading 4 bytes of Ping data&nbsp;</li></ol><p>The ping command was observed sending back 4 bytes recently allocated on the heap, so it's not guaranteed to know what that data looks like. To validate things are really working, a breakpoint can be set in WinDbg and memory set manually before being sent.&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-8a6e6f35-d744-40c7-abd2-e8f1bd34679d.png" class="kg-image" alt="A screenshot of a computer program

Description automatically generated" loading="lazy" width="624" height="318" srcset="https://blog.talosintelligence.com/content/images/size/w600/2024/10/data-src-image-8a6e6f35-d744-40c7-abd2-e8f1bd34679d.png 600w, https://blog.talosintelligence.com/content/images/2024/10/data-src-image-8a6e6f35-d744-40c7-abd2-e8f1bd34679d.png 624w"><figcaption><span style="white-space: pre-wrap;">Figure 7: Confirming 0xdeadbeef written to memory is received by the server in a Ping command&nbsp;</span></figcaption></figure><h2 id="file-commands">File commands&nbsp;</h2><p>The next set of commands are responsible for downloading files onto the compromised system or uploading files to the C2 server (PutFile and GetFile, respectively). These commands are inverses of each other, so only the GetFile command will be discussed in detail. The methodology was to trace each call to SendSocket or ReadSocket and implement the response for that call in Python. In CommandHandler, the implant reads the length and value off the wire. This is the file to be retrieved.&nbsp;&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-7bf9865d-fa63-41dd-a8ab-e58047cf13aa.png" class="kg-image" alt="A computer code on a black background

Description automatically generated" loading="lazy" width="512" height="112"><figcaption><span style="white-space: pre-wrap;">Figure 8: GetFile reading path string length and path string from socket&nbsp;</span></figcaption></figure><p>The CmdGetFile function opens the target file and chunks it over the socket one page at a time. The list of SendSocket calls is as follows:&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-ca3ca520-e004-487a-bd3f-04c264c42f56.png" class="kg-image" alt="A screenshot of a computer program

Description automatically generated" loading="lazy" width="428" height="138"><figcaption><span style="white-space: pre-wrap;">Figure 9: SendSocket calls made by CmdGetFile function&nbsp;</span></figcaption></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-a78f78f4-b95b-462a-963a-8b6e90e763e6.png" class="kg-image" alt="A screenshot of a computer program

Description automatically generated" loading="lazy" width="624" height="334" srcset="https://blog.talosintelligence.com/content/images/size/w600/2024/10/data-src-image-a78f78f4-b95b-462a-963a-8b6e90e763e6.png 600w, https://blog.talosintelligence.com/content/images/2024/10/data-src-image-a78f78f4-b95b-462a-963a-8b6e90e763e6.png 624w"><figcaption><span style="white-space: pre-wrap;">Figure 10: Example C2 server output from GetFile command&nbsp;</span></figcaption></figure><p>The PutFile command differs slightly from the GetFile command with how it uses pointer math to process incoming pages.&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-41baadf1-4acc-4c8b-ad53-8f89bd79735c.png" class="kg-image" alt="" loading="lazy" width="556" height="38"><figcaption><span style="white-space: pre-wrap;">Figure 11: Tricky file pointer math&nbsp;</span></figcaption></figure><p>This translates to each page starting with a 4-byte page number followed by 1020 bytes (or 0x3fc) of file data, which the GetFile command does not do; it sends full 1024-byte pages of file data without page numbers.&nbsp;</p><h2 id="reverse-shell">Reverse shell&nbsp;</h2><p>The last command is the reverse shell. This is the most complex because it requires many reads and writes over the socket. The disassembly is rather long and difficult to keep track of the socket calls, so we have omitted it. Effectively, the implant spawns a cmd.exe process (FUN_1400016e0) and reads the command to execute from the socket. The shell command and its output are marshaled between the processes via pipes during the session. The complexity of this operation comes from BugSleep incrementally reporting return values from pipe API calls while attempting to read shell output (FUN_140003840). The implant will enter this loop of reading commands and sending output until it receives the string “terminate\n”.&nbsp;&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-de7b283d-4068-47c2-96bf-1ab306101773.png" class="kg-image" alt="A computer screen shot of white text

Description automatically generated" loading="lazy" width="624" height="404" srcset="https://blog.talosintelligence.com/content/images/size/w600/2024/10/data-src-image-de7b283d-4068-47c2-96bf-1ab306101773.png 600w, https://blog.talosintelligence.com/content/images/2024/10/data-src-image-de7b283d-4068-47c2-96bf-1ab306101773.png 624w"><figcaption><span style="white-space: pre-wrap;">Figure 12: Example output from C2 server running the reverse shell command&nbsp;</span></figcaption></figure><p>The rest of the commands are less complex but have been implemented and are viewable <a href="https://gitlab.vrt.sourcefire.com/aaboyd/bugsleep/-/tree/master/server" rel="noreferrer noopener"><u>here</u></a>.&nbsp;</p><p></p><h1 id="snort-detection">Snort detection&nbsp;</h1><p>This server gives Talos the ability to emulate any number of conversations between BugSleep and its operators. This traffic is crucial for writing and validating our detections’ performance in the wild.&nbsp;</p><p>The initial candidate for detection would be the beacon. It is the first opportunity to shut down communications, isolating any BugSleep instance from receiving commands. It was observed that each beacon has the form of &lt;len&gt;&lt;data&gt;, where data is sub_string(COMPUTER_NAME + "/" + USERNAME, 3). This string is not long or static, which makes it a poor candidate for a <a href="https://docs.snort.org/rules/options/payload/fast_pattern" rel="noreferrer noopener"><u>fast_pattern</u></a>; however, recall that each beacon is prepended with a 4-byte length of this string. A Computer Name/Username string from any given victim is unlikely to be longer than 255 characters. This means most length fields are going to look like |XX 00 00 00| or |XX FD FD FD| when encoded. This could be a quick match, early in the stream, at a static offset, making it a decent fast_pattern candidate.&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-f180e453-7a96-48cb-9a7e-6bb192dc994a.png" class="kg-image" alt="" loading="lazy" width="556" height="30"><figcaption><span style="white-space: pre-wrap;">Figure 13: Detecting higher order encoded zero bytes of beacons sent from BugSleep&nbsp;</span></figcaption></figure><p>&nbsp;This will work but is likely to cause false-positives (FP) in the wild. Every sample of BugSleep was seen using port 443. The implant is also reaching outside the network to a C2 server, so traffic to be inspected by this rule can be reduced using the following header:&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-2a1cb264-d0d7-47e9-8e85-133375bad13e.png" class="kg-image" alt="" loading="lazy" width="556" height="26"><figcaption><span style="white-space: pre-wrap;">Figure 14: Restricting rule to inspect traffic leaving the network to port 443&nbsp;</span></figcaption></figure><p>The flow:to_server,established option can be used to restrict Snort to data coming from a client over established TCP streams. The FP-rate on this rule still isn't great. Any TCP traffic leaving the network on port 443 with |FD FD FD| at offset 1 will alert. That might sound unique, but it does not indicate with confidence that the traffic is a BugSleep beacon.&nbsp;</p><p>One powerful tool in Snort to add more logic or state to rules is <a href="https://docs.snort.org/rules/options/non_payload/flowbits" rel="noreferrer noopener"><u>flowbits</u></a>. These allow a writer to have a sense of state within a stream across multiple rules. In this case, the beacons aren't enough to reliably alert on. What if we use flowbits to chain beacons with the commands being sent back? The commands themselves don't provide much content, as they are variable length non-deterministic strings (e.g., get, put, etc.) or a nondeterministic 4-byte integer (e.g., heartbeat, increment timeout, etc.). They do, however, all start with a 4-byte command ID. Setting a flowbit when a beacon leaves the network will allow another rule down the line to alert with higher confidence if it sees a command ID come back in the same stream.&nbsp;</p><h2 id="command-rules">Command rules&nbsp;</h2><p>The <a href="https://docs.snort.org/rules/options/payload/pcre" rel="noreferrer noopener"><u>pcre</u></a> rule option can be used to reduce 11 rules down to one. Like the beacon rule, the three zero bytes, encoded as |03|, can be used as a fast_pattern. Once the rule has entered, the bugsleep_beacon flowbit check can be performed to help the rule exit quickly in the event of a false positive. After the three |03| bytes are confirmed to be at offset five, a PCRE can verify one of the command IDs is present.&nbsp;&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-0e4848e6-a122-4060-a139-891a3fd58476.png" class="kg-image" alt="A computer screen shot of a program code

Description automatically generated" loading="lazy" width="624" height="200" srcset="https://blog.talosintelligence.com/content/images/size/w600/2024/10/data-src-image-0e4848e6-a122-4060-a139-891a3fd58476.png 600w, https://blog.talosintelligence.com/content/images/2024/10/data-src-image-0e4848e6-a122-4060-a139-891a3fd58476.png 624w"><figcaption><span style="white-space: pre-wrap;">Figure 15: Snort rule for detecting BugSleep command sent from C2 server&nbsp;</span></figcaption></figure><h2 id="sharp-edges">Sharp edges&nbsp;</h2><p>Sometimes, we are reminded that Snort can handle or interpret data differently than expected. Conveniently, this sample’s traffic was a perfect example and opportunity to peek under the hood and see what Snort sees. Originally, our beacon rule looked like this, trying to catch the encoded forward-slash that is always present in the Computer Name/Username string (encoded as a comma).&nbsp;&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-aaa11fc0-d44a-4c90-b8dd-20204781e7a2.png" class="kg-image" alt="A screen shot of a computer program

Description automatically generated" loading="lazy" width="556" height="250"><figcaption><span style="white-space: pre-wrap;">Figure 16: Beacon rule attempting to catch forward-slash in Computer Name/Username string&nbsp;</span></figcaption></figure><p>Recall that the implant will:&nbsp;</p><ol><li>Connect to the server&nbsp;</li><li>Send a string length (4 bytes)&nbsp;</li><li>Send the PC/User string N bytes&nbsp;</li><li>Read 4 bytes back to ensure a response&nbsp;</li><li>Read 4-byte command ID and N command data bytes&nbsp;</li><li>Start sending command responses&nbsp;</li></ol><p>As Snort is reading data over the wire, it is interpreting it and sorting it into different buffers (pkt_data, file_data, js_data, http_*, etc.). In this case, as TCP data is being chunked along the wire, Snort is looking at those individual TCP segments. Only after it has enough data will it flush into the larger "TCP stream" buffer so a rule can parse the entire stream sent from a client or server.&nbsp;</p><p>Initially, the get command traffic was alerting while the put command traffic was not. Fortunately, Snort 3 comes with a <a href="https://docs.snort.org/start/tracing#snort-trace-modules" rel="noreferrer noopener"><u>tracing</u></a> module to help debug these issues. The buffer option will print out Snort’s different buffers as they are filled and rule_eval will trace the rule as it is evaluated. The following screenshots are output from individual runs of Snort against each PCAP. “snort.raw” represents an individual packet, while “snort.stream_tcp” represents a reassembled TCP stream.&nbsp;</p><p>At the start of the working GetFile command, the beacon size and data can be seen as two separate packets (Figure 17).&nbsp;&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-bc03d519-34d3-410c-a1a5-fc41153dc45f.png" class="kg-image" alt="A screenshot of a computer program

Description automatically generated" loading="lazy" width="624" height="390" srcset="https://blog.talosintelligence.com/content/images/size/w600/2024/10/data-src-image-bc03d519-34d3-410c-a1a5-fc41153dc45f.png 600w, https://blog.talosintelligence.com/content/images/2024/10/data-src-image-bc03d519-34d3-410c-a1a5-fc41153dc45f.png 624w"><figcaption><span style="white-space: pre-wrap;">Figure 17: Individual beacon packets being processed by Snort&nbsp;</span></figcaption></figure><p>Further down, the reassembled TCP stream can be seen being inspected and alerted on. Moving from the top to bottom in Figure 18, the cursor position and state of the buffer can be observed changing as the rule is evaluated. At the end, the flowbit is set and made available for the command rule.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-b32fcffd-fc68-4017-b909-b98e60f95113.png" class="kg-image" alt="" loading="lazy" width="624" height="575" srcset="https://blog.talosintelligence.com/content/images/size/w600/2024/10/data-src-image-b32fcffd-fc68-4017-b909-b98e60f95113.png 600w, https://blog.talosintelligence.com/content/images/2024/10/data-src-image-b32fcffd-fc68-4017-b909-b98e60f95113.png 624w"><figcaption><span style="white-space: pre-wrap;">Figure 18: Snort trace output setting flowbit for BugSleep beacon&nbsp;</span></figcaption></figure><p>Further down, the TCP stream for the command data is processed. The higher-order zeroes of the command are found, the flowbit checked, the PCRE performed, and the SID alerts as expected.&nbsp;&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-3e3c460b-0cfe-492a-82e1-47bdd32fcb8d.png" class="kg-image" alt="" loading="lazy" width="624" height="584" srcset="https://blog.talosintelligence.com/content/images/size/w600/2024/10/data-src-image-3e3c460b-0cfe-492a-82e1-47bdd32fcb8d.png 600w, https://blog.talosintelligence.com/content/images/2024/10/data-src-image-3e3c460b-0cfe-492a-82e1-47bdd32fcb8d.png 624w"><figcaption><span style="white-space: pre-wrap;">Figure 19: Get file command rule alerts on traffic as expected&nbsp;</span></figcaption></figure><p>When the results of the put file command traffic are inspected, a different behavior is observed. The individual packets for beacon length and beacon data are seen coming in; however, the first reassembled TCP stream that Snort is inspecting is the command being sent back to the implant. Figure 20 shows the command ID being found and then the flowbit check failing.&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-dae2da0e-4f67-4c02-8fea-542b411f2c04.png" class="kg-image" alt="A screenshot of a computer

Description automatically generated" loading="lazy" width="624" height="315" srcset="https://blog.talosintelligence.com/content/images/size/w600/2024/10/data-src-image-dae2da0e-4f67-4c02-8fea-542b411f2c04.png 600w, https://blog.talosintelligence.com/content/images/2024/10/data-src-image-dae2da0e-4f67-4c02-8fea-542b411f2c04.png 624w"><figcaption><span style="white-space: pre-wrap;">Figure 20: Put file command traffic failing flowbit check&nbsp;</span></figcaption></figure><p>Scrolling further in the log reveals the TCP stream for the beacon data is eventually populated and Snort sets the flowbit as expected. The stream for the command ID, however, has already passed and failed analysis because of the unset flowbit, resulting in no alert. The cause of this issue is the raw packets coming from the client not being reassembled into a TCP stream by the time the server packets are reassembled and inspected. This happens because Snort only reassembles when it has enough data, and 20 bytes is not enough yet.&nbsp;</p><h2 id="the-fix">The fix&nbsp;</h2><p>Unfortunately, the beacon rule must be tweaked so it can alert as soon as possible and not rely on the TCP reassembly. Recall that the beacon function invokes SendSocket twice, once for 4-length bytes and again for the beacon data. This means the first packet Snort sees will only be 4 bytes long. Adding “bufferlen:=4” restricts Snort to only look at 4-byte packets, significantly reducing any FP rate. Our solution ended up being this:&nbsp;&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-e48a0384-f063-4b53-bf19-475b0e64f5b3.png" class="kg-image" alt="A screen shot of a computer program

Description automatically generated" loading="lazy" width="556" height="212"><figcaption><span style="white-space: pre-wrap;">Figure 21: Fixed beacon rule looking for 4-byte length segments&nbsp;</span></figcaption></figure><p>&nbsp;Now the rules work as expected!&nbsp;&nbsp;</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.talosintelligence.com/content/images/2024/10/data-src-image-71d02591-a022-4004-aa5a-d87aed4a0415.png" class="kg-image" alt="A screenshot of a computer program

Description automatically generated" loading="lazy" width="438" height="399"><figcaption><span style="white-space: pre-wrap;">Figure 22: Snort output alerting on traffic from all BugSleep commands&nbsp;</span></figcaption></figure><h1 id="conclusion">Conclusion&nbsp;</h1><p>Since BugSleep is a new implant and weekly releases were observed being deployed, this protocol might change and bypass these rules. However, two things have been accomplished:&nbsp;</p><ol><li>This variant will no longer communicate over our customers’ networks.&nbsp;</li><li>Attackers must invest development time and money to use BugSleep again.&nbsp;</li></ol><p>The published Snort SIDs covering this traffic are 63937 and 63938.&nbsp;&nbsp;</p><h1 id="indicators-of-compromise">Indicators of compromise&nbsp;</h1><p>Hosts:&nbsp;</p><ul><li>1[.]235[.]234[.]202&nbsp;</li><li>146[.]19[.]143[.]14&nbsp;</li><li>46[.]19[.]143[.]14&nbsp;</li><li>5[.]239[.]61[.]97&nbsp;</li></ul><p>Hashes&nbsp;</p><p>The following Windows executables were collected during our research. Assuming these have not been manipulated, the compilation time for this set of binaries indicates weekly releases of BugSleep.&nbsp;</p>
<!--kg-card-begin: html-->
<table class="Table Ltr TableWordWrap SCXW74274086 BCX0" border="1" data-tablestyle="MsoNormalTable" data-tablelook="1024" aria-rowcount="6" style="-webkit-user-drag: none; margin: 0px 0px 0px -29px; padding: 0px; table-layout: fixed; width: 0px; border-collapse: collapse; empty-cells: show; position: relative; overflow: visible; background: none; border-spacing: 0px;"><tbody class="SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;"><tr class="TableRow SCXW74274086 BCX0" role="row" aria-rowindex="1" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; height: 19px;"><td class="FirstRow FirstCol SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(132, 226, 145); width: 561px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="1448567348" paraeid="{a787219b-ab87-47d0-af19-551d4f9d7f52}{62}" style="-webkit-user-drag: none; margin: 0px 0px 10.6667px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">SHA256</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td><td class="FirstRow LastCol SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(132, 226, 145); width: 99px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="1103399255" paraeid="{a787219b-ab87-47d0-af19-551d4f9d7f52}{69}" style="-webkit-user-drag: none; margin: 0px 0px 10.6667px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">Compile Time</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td></tr><tr class="TableRow SCXW74274086 BCX0" role="row" aria-rowindex="2" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; height: 19px;"><td class="FirstCol SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(132, 226, 145); width: 561px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="752701999" paraeid="{a787219b-ab87-47d0-af19-551d4f9d7f52}{77}" style="-webkit-user-drag: none; margin: 0px 0px 10.6667px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">b8703744744555ad841f922995cef5dbca11da22565195d05529f5f9095fbfca</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td><td class="LastCol SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(132, 226, 145); width: 99px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="1660691514" paraeid="{a787219b-ab87-47d0-af19-551d4f9d7f52}{84}" style="-webkit-user-drag: none; margin: 0px 0px 10.6667px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">Wed</span><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">.,</span><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;"> May 8 00:55:53 2024 UTC</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td></tr><tr class="TableRow SCXW74274086 BCX0" role="row" aria-rowindex="3" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; height: 19px;"><td class="FirstCol SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(132, 226, 145); width: 561px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="1464000377" paraeid="{a787219b-ab87-47d0-af19-551d4f9d7f52}{96}" style="-webkit-user-drag: none; margin: 0px 0px 10.6667px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">94278fa01900fdbfb58d2e373895c045c69c01915edc5349cd6f3e5b7130c472</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td><td class="LastCol SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(132, 226, 145); width: 99px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="1185633141" paraeid="{a787219b-ab87-47d0-af19-551d4f9d7f52}{103}" style="-webkit-user-drag: none; margin: 0px 0px 10.6667px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">Wed</span><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">.,</span><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;"> May 22 21:56:39 2024 UTC</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td></tr><tr class="TableRow SCXW74274086 BCX0" role="row" aria-rowindex="4" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; height: 19px;"><td class="FirstCol SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(132, 226, 145); width: 561px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="1882963508" paraeid="{a787219b-ab87-47d0-af19-551d4f9d7f52}{115}" style="-webkit-user-drag: none; margin: 0px 0px 10.6667px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">73c677dd3b264e7eb80e26e78ac9df1dba30915b5ce3b1bc1c83db52b9c6b30e</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td><td class="LastCol SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(132, 226, 145); width: 99px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="2114431701" paraeid="{a787219b-ab87-47d0-af19-551d4f9d7f52}{122}" style="-webkit-user-drag: none; margin: 0px 0px 10.6667px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">Fri</span><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">.,</span><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;"> May 31 23:29:21 2024 UTC</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td></tr><tr class="TableRow SCXW74274086 BCX0" role="row" aria-rowindex="5" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; height: 19px;"><td class="FirstCol SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(132, 226, 145); width: 561px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="2008100132" paraeid="{a787219b-ab87-47d0-af19-551d4f9d7f52}{134}" style="-webkit-user-drag: none; margin: 0px 0px 10.6667px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">5df724c220aed7b4878a2a557502a5cefee736406e25ca48ca11a70608f3a1c0</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td><td class="LastCol SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(132, 226, 145); width: 99px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="2016563183" paraeid="{a787219b-ab87-47d0-af19-551d4f9d7f52}{141}" style="-webkit-user-drag: none; margin: 0px 0px 10.6667px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">Sun</span><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">.,</span><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;"> Jul 07 21:09:49 2024 UTC</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td></tr><tr class="TableRow SCXW74274086 BCX0" role="row" aria-rowindex="6" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; height: 3px;"><td class="FirstCol LastRow SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(132, 226, 145); width: 561px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="361693459" paraeid="{a787219b-ab87-47d0-af19-551d4f9d7f52}{153}" style="-webkit-user-drag: none; margin: 0px 0px 10.6667px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">960d4c9e79e751be6cad470e4f8e1d3a2b11f76f47597df8619ae41c96ba5809</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td><td class="LastCol LastRow SCXW74274086 BCX0" data-celllook="4369" style="-webkit-user-drag: none; margin: 0px; padding: 0px; overflow: visible; vertical-align: top; position: relative; background-color: transparent; background-clip: padding-box; border: 1px solid rgb(132, 226, 145); width: 99px;"><div class="TableCellContent SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px 7px; overflow: visible;"><div class="OutlineElement Ltr SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; clear: both; cursor: text; overflow: visible; position: relative; direction: ltr;"><p class="Paragraph SCXW74274086 BCX0" paraid="31013913" paraeid="{a787219b-ab87-47d0-af19-551d4f9d7f52}{160}" style="-webkit-user-drag: none; margin: 0px 0px 10.6667px; padding: 0px; overflow-wrap: break-word; white-space: pre-wrap; font-weight: normal; font-style: normal; vertical-align: baseline; font-kerning: none; background-color: transparent; color: windowtext; text-align: left; text-indent: 0px;"><span data-contrast="auto" xml:lang="EN-US" lang="EN-US" class="TextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif; font-variant-ligatures: none !important;"><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">Sat</span><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;">.,</span><span class="NormalTextRun SCXW74274086 BCX0" style="-webkit-user-drag: none; margin: 0px; padding: 0px;"> Jul 15 09:15:20 2079 UTC</span></span><span class="EOP SCXW74274086 BCX0" data-ccp-props="{}" style="-webkit-user-drag: none; margin: 0px; padding: 0px; font-size: 12pt; line-height: 22.0083px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSCustomFont, Aptos_MSFontService, sans-serif;">&nbsp;</span></p></div></div></td></tr></tbody></table>
<!--kg-card-end: html-->
<p>&nbsp;</p>
        </div>
    </section>
    <div class="social-media-wrapper">
    <h5>Share this post</h5>
    <ul class="social-media-share-list">
        <li>
            <a class="share-facebook" title="Share this on Facebook" data-text="Writing a BugSleep C2 server and detecting its traffic with Snort" data-href="https://blog.talosintelligence.com/writing-a-bugsleep-c2-server/" rel="nofollow" target="_blank" href="https://www.facebook.com/sharer.php?u=https://blog.talosintelligence.com/writing-a-bugsleep-c2-server/"></a>
        </li>
        <li>
            <a class="share-x" title="Post This" data-text="Writing a BugSleep C2 server and detecting its traffic with Snort" data-href="https://blog.talosintelligence.com/writing-a-bugsleep-c2-server/" rel="nofollow" target="_blank" href="https://x.com/share?url=https://blog.talosintelligence.com/writing-a-bugsleep-c2-server/"></a>
        </li>
        <li>
            <a class="share-linkedin" title="Share this on LinkedIn" data-text="Writing a BugSleep C2 server and detecting its traffic with Snort" data-href="https://blog.talosintelligence.com/writing-a-bugsleep-c2-server/" rel="nofollow" target="_blank" href="https://www.linkedin.com/sharing/share-offsite/?url=https://blog.talosintelligence.com/writing-a-bugsleep-c2-server/"></a>
        </li>
        <li>
            <a class="share-reddit" title="Reddit This" data-text="Writing a BugSleep C2 server and detecting its traffic with Snort" data-href="https://blog.talosintelligence.com/writing-a-bugsleep-c2-server/" rel="nofollow" target="_blank" href="https://www.reddit/submit?url=https://blog.talosintelligence.com/writing-a-bugsleep-c2-server/"></a>
        </li>
        <li>
            <a class="share-email" title="Email This" href="mailto:?body=Writing a BugSleep C2 server and detecting its traffic with Snorthttps://blog.talosintelligence.com/writing-a-bugsleep-c2-server/"></a>
        </li>
    </ul>
</div></article>
                    </div>
                </div>
                <div class="col-lg alt-layout-row-dk sidebar" id="side-bar">
                            <h4>Related Content</h4>

                                <div class="sidebar-snippet-wrapper">
                                    <a href="/gophish-powerrat-dcrat/">
                                        <h3>Threat actor abuses Gophish to deliver new PowerRAT and DCRAT</h3>
                                        <span  class="preview-attributes">October 22, 2024 06:00</span>
                                        <p>Cisco Talos recently discovered a phishing campaign using an open-source phishing toolkit called Gophish by an unknown threat actor.</p>
                                    </a>
                                </div>
                                <div class="sidebar-snippet-wrapper">
                                    <a href="/chinese-hacking-group-apt41-compromised-taiwanese-government-affiliated-research-institute-with-shadowpad-and-cobaltstrike-2/">
                                        <h3>APT41 likely compromised Taiwanese government-affiliated research institute with ShadowPad and Cobalt Strike</h3>
                                        <span  class="preview-attributes">August 1, 2024 08:00</span>
                                        <p>ShadowPad, widely considered the successor of PlugX, is a modular remote access trojan (RAT) only seen sold to Chinese hacking groups.</p>
                                    </a>
                                </div>
                                <div class="sidebar-snippet-wrapper">
                                    <a href="/new-spicerat-sneakychef/">
                                        <h3>Unveiling SpiceRAT: SneakyChef&#x27;s latest tool targeting EMEA and Asia</h3>
                                        <span  class="preview-attributes">June 21, 2024 08:00</span>
                                        <p>The new remote access trojan (RAT) dubbed SpiceRAT was used by the threat actor SneakyChef in a recent campaign targeting government agencies in EMEA and Asia.</p>
                                    </a>
                                </div>
                </div>
            </div>
        </div>
    </main>


    <footer id="footer">
    <div class="row footer_nav_wrapper">
        <div class="col-xl-10 col-12">
            <div class="multi-col-list-wrapper">
                <ul class="footer-parent-list">
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6>Intelligence Center</h6>
                            </li>
                            <li><a href="https://talosintelligence.com/reputation_center">Intelligence Search</a></li>
                            <li><a href="https://talosintelligence.com/reputation_center/email_rep">Email &amp; Spam Trends</a></li>
                        </ul>
                    </li>
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6>Vulnerability Research</h6>
                            </li>
                            <li><a href="https://talosintelligence.com/vulnerability_info">Vulnerability Reports</a></li>
                            <li><a href="https://talosintelligence.com/ms_advisories">Microsoft Advisories</a></li>
                        </ul>
                    </li>
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6>Incident Response</h6>
                            </li>
                            <li>
                                <a href="https://talosintelligence.com/incident_response">Talos IR Capabilities</a></li>
                            <li>
                                <a href="https://talosintelligence.com/incident_response">Emergency Support</a>
                            </li>

                        </ul>
                    </li>
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6>Security Resources</h6>
                            </li>
                            <li><a href="https://talosintelligence.com/software">Open Source Security Tools</a></li>
                            <li><a href="https://talosintelligence.com/categories">Intelligence Categories Reference</a></li>
                            <li><a href="https://talosintelligence.com/secure-endpoint-naming">Secure Endpoint Naming Reference</a></li>
                        </ul>
                    </li>
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6>Media</h6>
                            </li>
                            <li><a href="https://blog.talosintelligence.com">Talos Intelligence Blog</a></li>
                            <li><a href="https://blog.talosintelligence.com/category/threat-source-newsletter/">Threat Source Newsletter</a></li>
                            <li><a href="https://talosintelligence.com/podcasts/shows/beers_with_talos">Beers with Talos Podcast</a></li>
                            <li><a href="https://talosintelligence.com/podcasts/shows/talos_takes">Talos Takes Podcast</a></li>
                            <li><a target="_blank" href="https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured">Talos Videos</a></li>
                        </ul>
                    </li>
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6>Support</h6>
                            </li>
                            <li><a href="https://support.talosintelligence.com">Support Documentation</a></li>
                        </ul>
                    </li>
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6>Company</h6>
                            </li>
                            <li><a href="https://talosintelligence.com/about">About Talos</a></li>
                            <li><a href="https://talosintelligence.com/careers">Careers</a></li>
                            <li><a target="_blank" href="https://www.cisco.com/c/en/us/products/security/product-listing.html">Cisco Security</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
        <div class="col-xl-2 col-12 connect_social">
            <div class="connect-footer-section-wrapper">
                <h6>Follow us</h6>
                <ul>
                    <li>
                        <a target="_blank" href="https://x.com/talossecurity"><div class="footer-media-icon" id="footer-media-icon-x"></div>
                        </a></li>
                    <li>
                        <a target="_blank" href="https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured"><div class="footer-media-icon" id="footer-media-icon-youtube"></div>
                        </a></li>
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/company/cisco-talos-intelligence-group/"><div class="footer-media-icon" id="footer-media-icon-linkedin"></div>
                        </a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-12 footer_corporate">
            <a target="_blank" href="http://tools.cisco.com/security/center/home.x"><img alt="Cisco" src="../assets/images/logo_cisco_white.svg">
            </a><p class="copyright">
            ©
            2024
            Cisco Systems, Inc. and/or its affiliates. All rights
            reserved. View our
            <a target="_blank" class="underline" href="http://www.cisco.com/web/siteassets/legal/privacy_full.html">Privacy Policy.</a>
        </p>
        </div>
    </div>
</footer>
    


<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://blog.talosintelligence.com/assets/js/jquery-3.6.0.min.js?v=6f57b90176"></script>
<script src="https://blog.talosintelligence.com/assets/js/popper.min.js?v=6f57b90176"></script>
<script src="https://blog.talosintelligence.com/assets/js/bootstrap.bundle.min.js?v=6f57b90176"></script>
<script src="https://blog.talosintelligence.com/assets/js/date.js?v=6f57b90176"></script>
<script src="https://blog.talosintelligence.com/assets/js/prism.js?v=6f57b90176"></script>
<script src="https://cdn.jsdelivr.net/npm/ghost-theme-utils@latest/dist/js/ghost-theme-utils.min.js" async defer></script>


<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8dab15da2ee8cb1f","version":"2024.10.4","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"35f8ae698f9d471b83b846a751388737","b":1}' crossorigin="anonymous"></script>
</body>

</html>