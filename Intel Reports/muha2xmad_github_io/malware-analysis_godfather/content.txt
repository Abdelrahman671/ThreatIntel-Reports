<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Technical analysis of Godfather android malware - muha2xmad</title>
<meta name="description" content="بسم الله الرحمن الرحيم  ">


  <meta name="author" content="Muhammad Hasan Ali">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="muha2xmad">
<meta property="og:title" content="Technical analysis of Godfather android malware">
<meta property="og:url" content="https://muha2xmad.github.io/malware-analysis/godfather/">


  <meta property="og:description" content="بسم الله الرحمن الرحيم  ">



  <meta property="og:image" content="https://muha2xmad.github.io/assets/images/MA/godfather/ff.jfif">





  <meta property="article:published_time" content="2023-02-08T00:00:00+00:00">





  

  


<link rel="canonical" href="https://muha2xmad.github.io/malware-analysis/godfather/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Muhammad Hasan Ali",
      "url": "https://muha2xmad.github.io/"
    
  }
</script>


  <meta name="google-site-verification" content="yjK5jUGtGuvD9i_1SEaec8FrngezWj1KJqBbPuPRAQM" />





<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="muha2xmad Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

<!-- favicon -->
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/site/lo.png">
<!-- <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/site/lo.png"> -->
<meta name="theme-color" content="#ffffff">

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/site/lo.png" alt=""></a>
        
        <a class="site-title" href="/">
          muha2xmad
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/#Malware-analysis">Malware analysis</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/#Mal-Document">Mal Documents</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/site/ed.jpg" alt="Muhammad Hasan Ali" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Muhammad Hasan Ali</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Malware Analysis</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Egypt</span>
        </li>
      

      
        
          
        
          
            <li><a href="https://twitter.com/muha2xmad" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
        
          
            <li><a href="https://www.linkedin.com/in/muhammadhasanali/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="https://github.com/muha2xmad" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Technical analysis of Godfather android malware">
    <meta itemprop="description" content="بسم الله الرحمن الرحيم">
    <meta itemprop="datePublished" content="2023-02-08T00:00:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Technical analysis of Godfather android malware
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  7 minute read

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu">
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#anti-emulator">Anti-emulator</a></li>
  <li><a href="#collect-vectims-device-info">Collect vectim’s device info</a></li>
  <li><a href="#ussd">USSD</a></li>
  <li><a href="#call-forwarding">Call forwarding</a></li>
  <li><a href="#push-notifications">Push notifications</a></li>
  <li><a href="#smishing">Smishing</a></li>
  <li><a href="#steal-smss">Steal SMSs</a></li>
  <li><a href="#record-the-screen">Record the screen</a></li>
  <li><a href="#vnc">VNC</a></li>
  <li><a href="#overlay-attack">Overlay attack</a></li>
  <li><a href="#startkill-the-malware">Start/Kill the malware</a></li>
  <li><a href="#cache-cleaner">Cache cleaner</a></li>
  <li><a href="#communications">Communications</a></li>
  <li><a href="#iocs">IoCs</a></li>
  <li><a href="#yara-rule">Yara rule</a></li>
  <li><a href="#article-quote">Article quote</a></li>
  <li><a href="#ref">REF</a></li>
</ul>

            </nav>
          </aside>
        
        <p><strong>بسم الله الرحمن الرحيم</strong></p>

<p><strong>FreePalestine</strong></p>

<h1 id="introduction">Introduction</h1>

<p><code class="language-plaintext highlighter-rouge">Godfather</code> is a malware that targets Android devices. It was first discovered in <code class="language-plaintext highlighter-rouge">2020</code> and is known for its sophisticated and aggressive behavior. The malware is designed to steal sensitive information such as banking credentials, passwords, and other personal data from infected devices.</p>

<p>The <code class="language-plaintext highlighter-rouge">Godfather</code> Android banking malware is a threat to users in 16 countries, as it has been designed to steal account credentials from over 400 online banking sites and cryptocurrency exchanges. It accomplishes this by disguising itself as a login screen, overlaying the login forums of banking and cryptocurrency exchange apps.</p>

<h1 id="anti-emulator">Anti-emulator</h1>

<p>After installing The malware on the device, it checks the device if it’s an <strong>emulator</strong> or not. If the malware is installed on the emulator, the malware <strong>will not</strong> run its malicious functions.</p>

<p align="center">
  <img src="/assets/images/MA/godfather/1.png" />
</p>
<center><font size="3"> <u>Figure</u>(1): The method that checks for emulator existence<u></u> </font></center>
<p><br /></p>

<p>The method retrun is <code class="language-plaintext highlighter-rouge">boolean</code>. When the malware checks for the emulator exitance, the return is <strong>0</strong> when there’s no emulator or the return is <strong>1</strong> when there’s an emulator</p>

<h1 id="collect-vectims-device-info">Collect vectim’s device info</h1>

<p>The malware will collect information about the device that’s infected and send the collected information to the <strong>C2 server</strong>. The information which will be sent to the C2 server such as <code class="language-plaintext highlighter-rouge">applist</code> which will collect all the applications installed on the device, <code class="language-plaintext highlighter-rouge">ag</code> to get the user agent, <code class="language-plaintext highlighter-rouge">sim</code> to get the network operator name, <code class="language-plaintext highlighter-rouge">phone</code> to get the phone number of the device, <code class="language-plaintext highlighter-rouge">model</code>, and <code class="language-plaintext highlighter-rouge">ver</code> of the device.</p>

<p align="center">
  <img src="/assets/images/MA/godfather/2.png" />
</p>
<center><font size="3"> <u>Figure</u>(2): The method that collects info about the victim's device<u></u> </font></center>
<p><br /></p>

<h1 id="ussd">USSD</h1>

<p>This method can make the malware transfers meoney using money transfers by making <code class="language-plaintext highlighter-rouge">USSD</code> (Unstructured Supplementary Service Data) calls without even using the dialer user interface.</p>

<p align="center">
  <img src="/assets/images/MA/godfather/3.png" />
</p>
<center><font size="3"> <u>Figure</u>(3): The method that performs USSD<u></u> </font></center>
<p><br /></p>

<p>When the malware communicate withe C2 server and the response from the C2 server contains <code class="language-plaintext highlighter-rouge">startUSSD</code> command, the malware will start this method to transfer money using <code class="language-plaintext highlighter-rouge">USSD</code>.</p>

<p align="center">
  <img src="/assets/images/MA/godfather/4.png" />
</p>
<center><font size="3"> <u>Figure</u>(4): The command that performs USSD<u></u> </font></center>
<p><br /></p>

<h1 id="call-forwarding">Call forwarding</h1>

<p>The malware has the ability to forward incomming calls. This is used to bypass the two factor authintication <code class="language-plaintext highlighter-rouge">2FA</code>.</p>

<p align="center">
  <img src="/assets/images/MA/godfather/5.png" />
</p>
<center><font size="3"> <u>Figure</u>(5): The method that performs call fowrwarding<u></u> </font></center>
<p><br /></p>

<p>When the malware communicate withe C2 server and the response from the C2 server contains <code class="language-plaintext highlighter-rouge">startforward</code> command, the malware will start this method to start call forwarding.</p>

<p align="center">
  <img src="/assets/images/MA/godfather/6.png" />
</p>
<center><font size="3"> <u>Figure</u>(6): The command that performs call forwarding<u></u> </font></center>
<p><br /></p>

<h1 id="push-notifications">Push notifications</h1>

<p>The malware will push fake notifications as if the notification came from ligitmate application. When the user opens the fake notifications, this opens a fake Web page and the user may enter his/her inforamtions such as username, email, or password.</p>

<p align="center">
  <img src="/assets/images/MA/godfather/7.png" />
</p>
<center><font size="3"> <u>Figure</u>(7): The method that performs pushing fake notifications<u></u> </font></center>
<p><br /></p>

<p>When the malware communicate withe C2 server and the response from the C2 server contains <code class="language-plaintext highlighter-rouge">startPush</code> command, the malware will start this method to start pushing fake notifications.</p>

<p align="center">
  <img src="/assets/images/MA/godfather/8.png" />
</p>
<center><font size="3"> <u>Figure</u>(8): The command that performs pushing fake notifications<u></u> </font></center>
<p><br /></p>

<h1 id="smishing">Smishing</h1>

<p>The malware will send message which contains malicous URLs to download malicous applications to victim’s contacts. This message is received from the C2 server and then the malware will send it to all contacts.</p>

<p align="center">
  <img src="/assets/images/MA/godfather/9.png" />
</p>
<center><font size="3"> <u>Figure</u>(9): The method that query contacts<u></u> </font></center>
<p><br /></p>

<p>When the malware communicate withe C2 server and the response from the C2 server contains <code class="language-plaintext highlighter-rouge">BookSMS</code> command, the malware will start this method to start sending SMSs to the victim’s contacts.</p>

<p align="center">
  <img src="/assets/images/MA/godfather/10.png" />
</p>
<center><font size="3"> <u>Figure</u>(10): The command that performs Smishing<u></u> </font></center>
<p><br /></p>

<h1 id="steal-smss">Steal SMSs</h1>

<p>The malware will collect the SMSs on the victim’s device and send the data to the C2 server. This is used to bypass the two factor authintication <code class="language-plaintext highlighter-rouge">2FA</code>.</p>

<p align="center">
  <img src="/assets/images/MA/godfather/11.png" />
</p>
<center><font size="3"> <u>Figure</u>(11): The method that performs collecting SMSs<u></u> </font></center>
<p><br /></p>

<p>When the malware communicate withe C2 server and the response from the C2 server contains <code class="language-plaintext highlighter-rouge">sentSMS</code> command, the malware will start this method to start sending the SMSs to the C2 server.</p>

<p align="center">
  <img src="/assets/images/MA/godfather/12.png" />
</p>
<center><font size="3"> <u>Figure</u>(12): The command that performs stealing SMSs<u></u> </font></center>
<p><br /></p>

<h1 id="record-the-screen">Record the screen</h1>

<p>The malware will record a video of the screen of the victim’s device then sends the video to the C2 server. This technique is used to steal sensitive data as the same as overlay attack. When the user opens a targeted app, the malware send to the C2 server that the user opened a targeted app. The C2 server sends a command to start recording the screen.</p>

<p align="center">
  <img src="/assets/images/MA/godfather/13.png" />
</p>
<center><font size="3"> <u>Figure</u>(13): The method that performs recording a video<u></u> </font></center>
<p><br /></p>

<h1 id="vnc">VNC</h1>

<p><code class="language-plaintext highlighter-rouge">VNC</code>, which stands for Virtual Network Computing, is a protocol for remote control of computers. VNC can be used by the malware to gain remote control over an infected device, allowing the attacker to perform various malicious activities.</p>

<p>For example, a VNC-based Android malware might allow an attacker to remotely access the device’s screen, camera, microphone, and other resources, allowing them to steal sensitive information, carry out phishing attacks, or monitor the user’s activities. The malware may also use the VNC connection to install additional malicious software on the device, making it part of a larger network of compromised devices (known as a botnet).</p>

<p align="center">
  <img src="/assets/images/MA/godfather/14.png" />
</p>
<center><font size="3"> <u>Figure</u>(14): The command that performs starting VNC<u></u> </font></center>
<p><br /></p>

<p>settings_port: The value of the port is <code class="language-plaintext highlighter-rouge">5900</code>.</p>

<p>settings_password: the value of the password is <code class="language-plaintext highlighter-rouge">123</code>.</p>

<p>user: the value of the user is <code class="language-plaintext highlighter-rouge">bluetooth_name</code>.</p>

<p>vnc_host: the value of the host is <code class="language-plaintext highlighter-rouge">5500</code>.</p>

<p>The <code class="language-plaintext highlighter-rouge">settings_port</code>, <code class="language-plaintext highlighter-rouge">settings_password</code> values are saved in the  Shared Preferences.</p>

<h1 id="overlay-attack">Overlay attack</h1>

<p>When the user opens a targeted app, the malware displays a fake or malicious overlay on top of the active window of the targeted app. The opened malicious window is the same as the legitimate app. This allows the attacker to steal sensitive information, such as login credentials, credit card numbers, or other sensitive data, by tricking the user into entering it into the overlay.</p>

<p align="center">
  <img src="/assets/images/MA/godfather/15.png" />
</p>
<center><font size="3"> <u>Figure</u>(15): The method that performs overlay attack<u></u> </font></center>
<p><br /></p>

<h1 id="startkill-the-malware">Start/Kill the malware</h1>

<p>The C2 server sends to the malware to start or terminate itself.</p>

<p align="center">
  <img src="/assets/images/MA/godfather/16.png" />
</p>
<center><font size="3"> <u>Figure</u>(16): The command that starts the malware<u></u> </font></center>
<p><br /></p>

<p align="center">
  <img src="/assets/images/MA/godfather/17.png" />
</p>
<center><font size="3"> <u>Figure</u>(17): The command that performs killing the bot<u></u> </font></center>
<p><br /></p>

<h1 id="cache-cleaner">Cache cleaner</h1>

<p>The malware will clean the cache of an app. The malware will send <code class="language-plaintext highlighter-rouge">cachecleaner</code> command from the C2 server and app name in the command.</p>

<p align="center">
  <img src="/assets/images/MA/godfather/20.png" />
</p>
<center><font size="3"> <u>Figure</u>(18): The command that clear the cache<u></u> </font></center>
<p><br /></p>

<h1 id="communications">Communications</h1>

<p>The malware will get the C2 server URL from description of a Telegram channel. The malware will send an <code class="language-plaintext highlighter-rouge">HTTP</code> reguest To <code class="language-plaintext highlighter-rouge">https://t.me/varezotukomirza</code> to get the encrypted C2 server <code class="language-plaintext highlighter-rouge">zH7cPW3ZEHj5SDEKxFtXcoMXMJmMGlMGCH978whkdfQ</code>. The C2 server is encrypted using <code class="language-plaintext highlighter-rouge">Blowfish</code> algorithm  with <code class="language-plaintext highlighter-rouge">ECB_MODE</code> and  <code class="language-plaintext highlighter-rouge">ABC</code> as a key and encoded using <code class="language-plaintext highlighter-rouge">Base64</code>.</p>

<p align="center">
  <img src="/assets/images/MA/godfather/18.png" />
</p>
<center><font size="3"> <u>Figure</u>(19): The encrypted C2 server<u></u> </font></center>
<p><br /></p>

<p>When we decrypt The C2 server:</p>

<ul>
  <li>
    <p>Decoded the <code class="language-plaintext highlighter-rouge">Base64</code>, then</p>
  </li>
  <li>
    <p>Decrypt the <code class="language-plaintext highlighter-rouge">blowfish</code> with <code class="language-plaintext highlighter-rouge">ECB_MODE</code> using <code class="language-plaintext highlighter-rouge">ABC</code> as a key</p>
  </li>
</ul>

<p>Thanks to <a href="https://twitter.com/pr3wtd">Witold Precikowski</a> for helping to decrypt the C2 server. We use this script to decrypt the encrypted C2 server obtained form the Telegram channel.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">Blowfish</span>
<span class="kn">import</span> <span class="nn">base64</span>

<span class="n">bs</span> <span class="o">=</span> <span class="n">Blowfish</span><span class="p">.</span><span class="n">block_size</span>
<span class="n">key</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'ABC'</span>

<span class="n">data</span> <span class="o">=</span> <span class="s">'zH7cPW3ZEHj5SDEKxFtXcoMXMJmMGlMGCH978whkdfQ='</span>

<span class="c1"># Base64 decode
</span><span class="n">ciphertext</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Decrypt Blowfish in ECB mode
</span><span class="n">cipher</span> <span class="o">=</span> <span class="n">Blowfish</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">Blowfish</span><span class="p">.</span><span class="n">MODE_ECB</span><span class="p">)</span>
<span class="n">msg</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>

<span class="n">last_byte</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[:</span><span class="o">-</span> <span class="p">(</span><span class="n">last_byte</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">last_byte</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="k">else</span> <span class="nb">ord</span><span class="p">(</span><span class="n">last_byte</span><span class="p">))]</span>
<span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div></div>

<p>The decrypted C2 server will be <code class="language-plaintext highlighter-rouge">https://kalopterbomrassa.shop/</code>.</p>

<p>After the malware gets the C2 server the communication between the C2 server and the malware will be decrypted using <code class="language-plaintext highlighter-rouge">AES/CBC/NoPadding</code> with <code class="language-plaintext highlighter-rouge">fedcba9876543210</code> as IV and <code class="language-plaintext highlighter-rouge">0123456789abcdef</code> as a key.</p>

<p align="center">
  <img src="/assets/images/MA/godfather/19.png" />
</p>
<center><font size="3"> <u>Figure</u>(20): Algorithm to decrypt communication between the C2 server and the malware<u></u> </font></center>
<p><br /></p>

<p>Special thanks to <a href="https://twitter.com/pr3wtd">Witold Precikowski</a>, <a href="https://twitter.com/_qaz_qaz">Lasha kh.</a>, and <a href="https://twitter.com/ReBensk">Re-ind</a> for their continuous help and support.</p>

<h1 id="iocs">IoCs</h1>

<p>App name: <code class="language-plaintext highlighter-rouge">MYT Müzik</code></p>

<p>Package name: <code class="language-plaintext highlighter-rouge">com.expressvpn.vpn</code></p>

<p>Sha256: <code class="language-plaintext highlighter-rouge">138551cd967622832f8a816ea1697a5d08ee66c379d32d8a6bd7fca9fdeaecc4</code></p>

<p>Telegram channel: <code class="language-plaintext highlighter-rouge">https://t.me/varezotukomirza</code></p>

<p>C2 server: <code class="language-plaintext highlighter-rouge">https://kalopterbomrassa.shop/</code></p>

<h1 id="yara-rule">Yara rule</h1>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rule</span> <span class="n">Godgather</span> <span class="p">{</span>
  <span class="n">meta</span><span class="p">:</span>
    <span class="n">author</span>      <span class="p">=</span> <span class="s">"@muha2xmad"</span>
    <span class="n">date</span>        <span class="p">=</span> <span class="s">"2023-02-09"</span>
    <span class="n">description</span> <span class="p">=</span> <span class="s">"Godfather android malware"</span>
    <span class="n">version</span>     <span class="p">=</span> <span class="s">"1.0"</span>

  <span class="n">strings</span><span class="p">:</span>
    <span class="err">$</span><span class="n">str00</span>  <span class="p">=</span> <span class="s">"main_wang"</span> <span class="n">nocase</span> 
    <span class="err">$</span><span class="n">str01</span>  <span class="p">=</span> <span class="s">"#21#"</span> <span class="n">nocase</span> 
    <span class="err">$</span><span class="n">str02</span>  <span class="p">=</span> <span class="s">"config"</span> <span class="n">nocase</span> 
    <span class="err">$</span><span class="n">str03</span>  <span class="p">=</span> <span class="s">"godfather"</span> <span class="n">nocase</span> 
    <span class="err">$</span><span class="n">str04</span>  <span class="p">=</span> <span class="s">"fafa.php"</span> <span class="n">nocase</span>
    <span class="err">$</span><span class="n">str05</span>  <span class="p">=</span> <span class="s">"POPTR"</span> <span class="n">nocase</span>
    <span class="err">$</span><span class="n">str06</span>  <span class="p">=</span> <span class="s">"patara.php"</span> <span class="n">nocase</span>
  <span class="n">condition</span><span class="p">:</span>
    <span class="nf">uint32be</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="p">==</span> <span class="m">0x504B0304</span> <span class="c1">// APK file signature</span>
      <span class="nf">and</span> <span class="p">(</span>	<span class="n">all</span> <span class="nf">of</span> <span class="p">(</span><span class="err">$</span><span class="n">str</span><span class="p">*))</span>
      
<span class="p">}</span>


</code></pre></div></div>

<h1 id="article-quote">Article quote</h1>

<blockquote>
  <p>من نبتَ لحمُه من ماء البِرَك كيف يستسيغُ ماء زمزم</p>
</blockquote>

<p align="center">
  <img src="/assets/images/MA/godfather/21.jfif" />
</p>
<p><br /></p>

<h1 id="ref">REF</h1>

<ul>
  <li><a href="https://www.group-ib.com/blog/godfather-trojan/">Godfather: A banking Trojan that is impossible to refuse</a></li>
</ul>


        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#malware-analysis" class="page__taxonomy-item" rel="tag">Malware-analysis</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2023-02-08T00:00:00+00:00">February 8, 2023</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Technical+analysis+of+Godfather+android+malware%20https%3A%2F%2Fmuha2xmad.github.io%2Fmalware-analysis%2Fgodfather%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fmuha2xmad.github.io%2Fmalware-analysis%2Fgodfather%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fmuha2xmad.github.io%2Fmalware-analysis%2Fgodfather%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/malware-analysis/alien/" class="pagination--pager" title="Technical analysis of Alien android malware
">Previous</a>
    
    
      <a href="/malware-analysis/warzonerat/" class="pagination--pager" title="Technical analysis of WarZoneRAT malware
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Muhammad Hasan Ali. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9P532HWLYQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9P532HWLYQ');
</script>








  </body>
</html>
