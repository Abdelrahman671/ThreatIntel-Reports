<!doctype html><html lang="en-US"><head><link href="/assets/fonts/Montserrat-VariableFont_wght.woff2" rel="preload" type="font/woff2" as="font" crossorigin=""><meta charset="utf-8"><meta content="IE=edge" http-equiv="X-UA-Compatible"><title>The Domain Generation Algorithms of SharkBot</title><meta content="SharkBot uses a DGA for communication, which was changed several times during the development of SharkBot. This blogpost shows four versions of the DGA, and their differences." name="description" property="og:description"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="en_US" property="og:locale"><meta content="./assets/img/front/shark-800.jpeg" property="og:image"><meta content="website" property="og:type"><meta content="Binary Reverse Engineering Blog" property="og:site_name"><meta content="The Domain Generation Algorithms of SharkBot" property="og:title"><meta content="summary" name="twitter:card"><meta content="@viql" name="twitter:site"><meta content="@viql" name="twitter:creator"><meta content="The Domain Generation Algorithms of SharkBot" name="twitter:title"><meta content="SharkBot uses a DGA for communication, which was changed several times during the development of SharkBot. This blogpost shows four versions of the DGA, and their differences." name="twitter:description"><meta content="https://bin.re/assets/img/front/shark-800.jpeg" name="twitter:image"><link href="/assets/css/common-ef2fe0.css" rel="stylesheet"><link href="feed.xml" rel="alternate" type="application/atom+xml" title="Atom feed for the Blog"><link href="/assets/css/blog-a83391.css" rel="stylesheet"><link href="/apple-touch-icon-60x60.png" rel="apple-touch-icon" sizes="60x60"><link href="/apple-touch-icon-76x76.png" rel="apple-touch-icon" sizes="76x76"><link href="/apple-touch-icon-120x120.png" rel="apple-touch-icon" sizes="120x120"><link href="/apple-touch-icon-152x152.png" rel="apple-touch-icon" sizes="152x152"><link href="/apple-touch-icon-180x180.png" rel="apple-touch-icon" sizes="180x180"><link href="/apple-touch-icon-192x192.png" rel="apple-touch-icon" sizes="192x192"><link href="/apple-touch-icon-512x512.png" rel="apple-touch-icon" sizes="512x512"><link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"><link href="/favicon-192x192.png" rel="icon" sizes="192x192" type="image/png"><link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"><link href="/favicon.ico" rel="shortcut icon"><noscript><style>img.lazyload {
          display: none;
        }</style></noscript><script defer src="/assets/js/all.min-a1c570.js"></script></head><body class="a b7"><div class="b"><div class="d"><div class="f e"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-close" xlink:href="/assets/svg/icons.svg#icon-close"></use></svg></div><div class="h"><ul class="i j sidebar"><li class="q r"><a href="/">Home</a></li><li class="q"><a href="/publications/">Publications</a></li><li class="q t"><span class="u">Projects<svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-angle-down" xlink:href="/assets/svg/icons.svg#icon-angle-down"></use></svg></span><ul class="v"><li><a href="/projects/risk-battle-outcomes/">Probability of Winning Battles in Risk</a></li><li><a href="/tag/project-euler/">Project Euler</a></li><li><a href="/projects/bazarbackdoor/">BazarBackdoor Tools</a></li></ul></li><li class="q t"><span class="u">Reverse Engineering<svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-angle-down" xlink:href="/assets/svg/icons.svg#icon-angle-down"></use></svg></span><ul class="v"><li><a href="/tag/malware-analysis/">Malware Analysis</a></li><li><a href="/projects/solutions-to-crackmes/">Solutions to Crackmes</a></li><li><a href="/projects/solutions-to-practical-reverse-engineering/">Solutions to "Practical Reverse Engineering"</a></li></ul></li></ul></div></div></div><div id="aw"><div class="w"><header class="y x"><nav class="z a0"><a href="/"><span class="a1"><!-- Generator: Adobe Illustrator 25.0.0, SVG Export Plug-In  --> <svg viewBox="0 0 86.4 20.21" height="20.21px" style="overflow:visible;enable-background:new 0 0 86.4 20.21;" version="1.1" width="86.4px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"><g><path class="a2" d="M28.56,5.13c-1.99,0-2.87-1.12-2.87-2.57c0-1.5,0.9-2.57,2.87-2.57c2.02,0,2.95,1.07,2.95,2.57
    C31.51,4.01,30.58,5.13,28.56,5.13z M25.96,19.94V6.47h5.22v13.46H25.96z"></path><path class="a2" d="M43.69,19.94v-7.92c0-1.23-0.27-1.91-1.59-1.91c-0.6,0-1.53,0.3-2.24,0.76v9.07H34.6V6.45h4.89l0.08,1.31
    l0.16,0.05c1.58-1.12,3.5-1.69,4.78-1.69c3.47,0,4.42,1.91,4.42,4.86v8.96H43.69z"></path><path class="a2" d="M54.33,20.15c-1.83,0-2.62-1.01-2.62-2.37c0-1.37,0.82-2.35,2.62-2.35c1.86,0,2.68,0.98,2.68,2.35
    C57,19.14,56.16,20.15,54.33,20.15z"></path><path class="a2" d="M65.14,9.23c1.58-1.69,3.85-3.17,5.49-3.17c0.63,0,0.79,0.49,0.79,1.09c0,1.45-0.87,4.29-1.58,5.3l-4.51-0.57
    v8.06h-5.21V6.45h5.16c0,0.66-0.14,2.08-0.25,2.7L65.14,9.23z"></path><path class="a2" d="M86.4,12.78v1.2h-8.63c0.03,1.72,1.07,2.4,3.03,2.4c1.34,0,3-0.35,4.34-0.76l0.98,3.2
    c-1.94,1.04-4.34,1.39-6.25,1.39c-5.9,0-7.32-3.33-7.32-6.99c0-3.41,1.58-7.13,7.07-7.13C85.74,6.09,86.4,9.78,86.4,12.78z
     M77.82,11.52h3.9c-0.03-1.31-0.41-2.29-1.83-2.29C78.4,9.23,77.93,10.32,77.82,11.52z"></path><path class="a2" d="M6.92,12.81"></path><path class="a2" d="M17.24,6.06c-0.79,0-2.43,0.29-3.87,1.3c0-0.14-0.06-2.69-0.06-3.07V0.27H8.12v9.28
    c2.71-0.69,4.54-1.87,5.24-2.18v3.06c-0.85,0.55-4.15,2.11-5.24,2.44v5.86c2.62,1.28,6.12,1.48,7.54,1.48
    c5.79,0,7.16-3.33,7.16-7.02C22.82,9.07,21.45,6.06,17.24,6.06z M15.41,16.6c-0.54,0-1.31-0.08-2.05-0.38v-5.79
    c0.66-0.33,1.45-0.65,2.16-0.65c1.01,0,2.1,0.35,2.1,3.47C17.63,16.14,16.59,16.6,15.41,16.6z"></path><path class="a2" d="M8.12,9.55c-1.03,0.23-2.56,0.51-3.66,0.23l0-3.09L0,11.57l4.51,4.88l0-3.13c1.38,0.17,2.69-0.23,3.61-0.45
    V9.55z"></path></g></svg></span></a><div class="a3"><button class="a2 a4" id="ax"><svg height="20px" version="1.1" width="20px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewport="0 0 20 20"><path class="a5" d="M2.28,15.89l1.57-1.61l1.24,1.24l-1.57,1.61L2.28,15.89z M8.86,19.33v-2.61h1.74v2.61H8.86z M9.73,4.35
	c1.46,0,2.71,0.52,3.75,1.55s1.55,2.28,1.55,3.75s-0.52,2.71-1.55,3.75c-1.03,1.03-2.28,1.55-3.75,1.55s-2.71-0.52-3.75-1.55
	s-1.55-2.28-1.55-3.75S4.95,6.93,5.98,5.9S8.26,4.35,9.73,4.35z M16.81,8.77h2.65v1.78h-2.65V8.77z M14.36,15.52l1.24-1.2l1.57,1.57
	l-1.24,1.24L14.36,15.52z M17.18,3.43l-1.57,1.57l-1.24-1.24l1.57-1.57L17.18,3.43z M10.6,0v2.61H8.86V0C8.86,0,10.6,0,10.6,0z
	 M2.65,8.77v1.78H0V8.77H2.65z M5.09,3.77L3.85,5.01L2.28,3.43l1.24-1.24L5.09,3.77z"></path><path class="a6" d="M14.18,14.19c3.31-3.31,3.31-8.67,0-11.97C13.06,1.1,11.7,0.36,10.26,0c2.2,2.88,1.98,7.01-0.65,9.65
	C6.99,12.26,2.88,12.49,0,10.33c0.37,1.41,1.1,2.76,2.21,3.87C5.52,17.5,10.88,17.5,14.18,14.19z M7.1,2.48H6.36l0.52,0.52
	L6.55,3.34L6.03,2.81v0.74H5.56V2.81L5.04,3.34L4.71,3.01l0.52-0.52H4.49V2.02h0.74L4.71,1.49l0.33-0.33l0.52,0.52V0.95h0.47v0.74
	l0.52-0.52l0.33,0.33L6.36,2.02H7.1V2.48z M0.94,3.94c0,0.26-0.21,0.47-0.47,0.47S0,4.2,0,3.94s0.21-0.47,0.47-0.47
	S0.94,3.68,0.94,3.94z M3.88,5.66c0,0.29-0.24,0.53-0.53,0.53S2.83,5.95,2.83,5.66c0-0.29,0.24-0.53,0.53-0.53S3.88,5.36,3.88,5.66z
	"></path></svg></button><ul class="i j a7"><li class="q"><a href="/">Home</a></li><li class="q"><a href="/publications/">Publications</a></li><li class="q t"><span class="u">Projects<svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-angle-down" xlink:href="/assets/svg/icons.svg#icon-angle-down"></use></svg></span><ul class="v"><li><a href="/projects/risk-battle-outcomes/">Probability of Winning Battles in Risk</a></li><li><a href="/tag/project-euler/">Project Euler</a></li><li><a href="/projects/bazarbackdoor/">BazarBackdoor Tools</a></li></ul></li><li class="q t r"><span class="u">Reverse Engineering<svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-angle-down" xlink:href="/assets/svg/icons.svg#icon-angle-down"></use></svg></span><ul class="v"><li><a href="/tag/malware-analysis/">Malware Analysis</a></li><li><a href="/projects/solutions-to-crackmes/">Solutions to Crackmes</a></li><li><a href="/projects/solutions-to-practical-reverse-engineering/">Solutions to "Practical Reverse Engineering"</a></li></ul></li></ul><div class="f a8 a9"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-bars" xlink:href="/assets/svg/icons.svg#icon-bars"></use></svg></div></div></nav></header><div class="b8"><noscript>&lt;img src="/assets/img/header/shark-640.jpeg" class="-minfy-post__title-image"/&gt;</noscript><img alt="cover image for post 'The Domain Generation Algorithms of SharkBot'" class="b9 lazyload" data-src="/assets/img/header/shark-640.jpeg" data-srcset="/assets/img/header/shark-3090.webp 3090w,
/assets/img/header/shark-2376.webp 2376w,
/assets/img/header/shark-1830.webp 1830w,
/assets/img/header/shark-1400.webp 1400w,
/assets/img/header/shark-1080.webp 1080w,
/assets/img/header/shark-830.webp 830w,
/assets/img/header/shark-640.webp 640w" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMDAiIGhlaWdodD0iMjMzIj48cGF0aCBmaWxsPSIjM2M1NDU0IiBkPSJNMCAwaDMwMHYyMzNIMHoiLz48ZyBmaWxsLW9wYWNpdHk9Ii41IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSguNiAuNilzY2FsZSgxLjE3MTg4KSI+PGNpcmNsZSBjeD0iMTI1IiBjeT0iOTUiIHI9IjE3MCIgZmlsbD0iIzAwMmY0NiIvPjxjaXJjbGUgcj0iMSIgZmlsbD0iI2JhZmZmZiIgdHJhbnNmb3JtPSJtYXRyaXgoMjkuNTUyNzUgLTYuODczNzcgMy43OTM2OCAxNi4zMTAzNiAxMTcuOCA5MC44KSIvPjxwYXRoIGZpbGw9IiMwMDBhMTEiIGQ9Im0yNTUgMjE0IDUtMTIxLTI3NiAxMDJ6Ii8+PGNpcmNsZSBjeD0iNzIiIGN5PSIyNyIgcj0iNjciIGZpbGw9IiMwMDZhNzkiLz48cGF0aCBmaWxsPSIjOGZmOWZhIiBkPSJtMTgxIDExOS01OC00OS0zMyAyN3oiLz48Y2lyY2xlIHI9IjEiIGZpbGw9IiMwMDM4NDMiIHRyYW5zZm9ybT0ibWF0cml4KC0xNzEuNjkxMzMgNDQuNzAwNTEgLTEzLjQ1NjY2IC01MS42ODYwNCAxNy44IDE3NC4yKSIvPjxwYXRoIGZpbGw9IiM3MGZmZmYiIGQ9Im0xNzEuNCA5OS40IDI1LjktMTMuNS0zNi41IDQzLjctNS41LTE1LjF6Ii8+PGNpcmNsZSByPSIxIiBmaWxsPSIjMDAyMTJhIiB0cmFuc2Zvcm09InJvdGF0ZSgtMTc2LjUgMTIwLjYgMjkuMSlzY2FsZSg0OC4xNTEwNyAyNTUpIi8+PHBhdGggZmlsbD0iI2ZhZmZmZiIgZD0ibTEyNyA1NiAzIDI3LTMxIDIxeiIvPjxjaXJjbGUgcj0iMSIgZmlsbD0iIzEzYjljOSIgdHJhbnNmb3JtPSJyb3RhdGUoMTczLjYgMjkuNSA1NS4zKXNjYWxlKDM5LjMzMjA4IDQuNjE5MjIpIi8+PGNpcmNsZSByPSIxIiBmaWxsPSIjMDA0NjU3IiB0cmFuc2Zvcm09InJvdGF0ZSgtOTIuOSAxMTIuNyAtNjMuOSlzY2FsZSg1Mi43NDM3OCA1Ny4wNDUwMSkiLz48Y2lyY2xlIHI9IjEiIGZpbGw9IiMwMDFjMjQiIHRyYW5zZm9ybT0icm90YXRlKDQuNiAtMjE5OS41IDQ4OS44KXNjYWxlKDI1NSAyOS4xOTY0MykiLz48Y2lyY2xlIGN4PSI1MiIgY3k9IjIzIiByPSI4MiIgZmlsbD0iIzAwNTQ2MSIvPjxwYXRoIGZpbGw9IiMwMTYwNzEiIGQ9Im03NiAxNTggMTAwLTEzLTEyNi00MXoiLz48cGF0aCBmaWxsPSIjMDA3NjgyIiBkPSJNMTQ4LjQgOTQgMjQyIDcxLjdsLTg5LjkgMzkuOC0zNi42LTE0Ljd6Ii8+PHBhdGggZmlsbD0iI2NiZmZmZiIgZD0iTTE2MCAxMTBoNnYyMWgtNnoiLz48cGF0aCBmaWxsPSIjY2NmY2ZmIiBkPSJNMTI5LjIgODIuNiA4OS4zIDEwNmwtMTUuNS43IDQ2LjYtMzAuNnoiLz48Y2lyY2xlIHI9IjEiIGZpbGw9IiMwMDM4NDciIHRyYW5zZm9ybT0ibWF0cml4KDIuNzY4MjggODcuNjM5MzEgLTMwLjE4NDU4IC45NTM0NSAwIDY0LjgpIi8+PHBhdGggZmlsbD0iIzAwMjQyYyIgZD0ibTE2OSAxMTEgMTAyLTUxLTg2IDE1NHoiLz48cGF0aCBmaWxsPSIjMjU5YWFjIiBkPSJtMTAxLjEgMTI5LjYtMjQuMiAyMC43IDM2LjgtMTYgMS00LjN6Ii8+PHBhdGggZmlsbD0iIzYxZDZkMyIgZD0ibTE5MC40IDg4LjYgMjcuNS0xMC43LTU2LjIgMzUuOC0xLjQtNC4zeiIvPjxlbGxpcHNlIGN4PSIxMjUiIGN5PSI0NSIgZmlsbD0iIzQxZGZlMSIgcng9IjIiIHJ5PSIyNSIvPjxwYXRoIGZpbGw9IiMwMDM1NDQiIGQ9Ik0yNzEgMTUgMTU0LTE2bDEgMTI4eiIvPjxwYXRoIGZpbGw9IiMxNGM1Y2MiIGQ9Im0xNDMgMTA3IDgtMTctMTYtMTR6Ii8+PHBhdGggZmlsbD0iIzAwM2E0YSIgZD0ibS0xNiAxMTcgNzUgNTUgNTAtNjh6Ii8+PGNpcmNsZSByPSIxIiBmaWxsPSIjMDA1MjYxIiB0cmFuc2Zvcm09Im1hdHJpeCgxMi41MDI3OCAtNTkuNTYxNzggMjAuMzgyOTYgNC4yNzg2NCAxNTAuOCAyMS4yKSIvPjxwYXRoIGZpbGw9IiM3MGMxYzUiIGQ9Im0xMzguNyAxMzYuNyA1LjctMi42IDE2LjMgNi4zLTEyLjYtLjN6Ii8+PHBhdGggZmlsbD0iIzAwMmQzOCIgZD0iTTEyMyAxMDhoMzV2MjdoLTM1eiIvPjxlbGxpcHNlIGN4PSI4MyIgY3k9IjExMiIgZmlsbD0iIzAwNjc3NSIgcng9IjQwIiByeT0iNSIvPjxjaXJjbGUgY3g9IjY4IiBjeT0iNTciIHI9IjQ0IiBmaWxsPSIjMDA1NzY1Ii8+PC9nPjwvc3ZnPg=="></div><main class="y aa"><article class="z ae ac ba"><div class="bb"><h1 class="bc">The Domain Generation Algorithms of SharkBot</h1></div><div class="bd"><ul class="i be"><li><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-calendar-o" xlink:href="/assets/svg/icons.svg#icon-calendar-o"></use></svg> <a href="https://bin.re/2022/06">June 4, 2022</a></li><li><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-book" xlink:href="/assets/svg/icons.svg#icon-book"></use></svg> <a href="/category/reverse-engineering">reverse engineering</a></li><li><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-tags" xlink:href="/assets/svg/icons.svg#icon-tags"></use></svg> <span class="bf"><a href="/tag/dga" class="bg">dga</a> <a href="/tag/malware-analysis" class="bg">malware analysis</a> <a href="/tag/sharkbot" class="bg">sharkbot</a> <a href="/tag/android" class="bg">android</a></span></li><li><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-comments-o" xlink:href="/assets/svg/icons.svg#icon-comments-o"></use></svg> no comments</li></ul><div class="bh"><span class="bj">Table of Contents</span><ul class="i bk"><li><a href="#version-000">Version 0.0.0</a></li><li><a href="#version-1633">Version 1.63.3</a></li><li><a href="#version-21">Version 2.1</a></li><li><a href="#version-28">Version 2.8</a></li></ul><div><span class="bj">Disclaimer<svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-exclamation-triangle" xlink:href="/assets/svg/icons.svg#icon-exclamation-triangle"></use></svg></span><p>These are just unpolished notes. The content likely lacks clarity and structure; and the results might not be adequately verified and/or incomplete.</p></div><span class="bj">Changes</span><ul class="i"><li>2022-07-14 17:37:50: fixed the regex for version 1.63</li></ul><div><span class="bj">Malpedia</span><p>For more information about the malware in this blog post see the <a href="https://malpedia.caad.fkie.fraunhofer.de/details/apk.sharkbot" class="bm">Malpedia entry on SharkBot</a>.</p></div><div><span class="bj">Cover Image</span> Photo by <a href="https://unsplash.com/@visuallert">Jonas Allert</a> on <a href="https://unsplash.com/">Unsplash</a></div></div></div><div class="b6 bi"><p>SharkBot is an Android banking malware that steals credentials and banking details <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup><sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup><sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup><sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>. Apart from one or two hard-coded domains, it relies on a fallback domain generation algorithm (DGA) for communication — which is rather rare for Android malware. The DGA was changed several times during the further development of SharkBot. This blogpost shows four versions of this DGA, and how they differ.</p><p>Both <a href="https://github.com/skylot/jadx">jadx</a> and <a href="http://java-decompiler.github.io/">jd-gui</a> were able to decompile almost the entire SharkBot code to great precision, but failed when it came to the DGA function. I therefore used <a href="https://github.com/pxb1988/dex2jar"><code>dex2jar</code></a> to translate the compiled Android application code to a jar file, then ran the unmaintained <a href="http://www.javadecompilers.com/jad"><code>jad</code></a> decompiler on the class that contains the DGA. You can find reimplementations of all four DGAs in Python on <a href="https://github.com/baderj/domain_generation_algorithms/blob/master/sharkbot/dga.py">my GitHub repo</a>.</p><h2 id="version-000">Version 0.0.0</h2><p>The first sample that I found has the version set to <code>0.0.0</code>:</p><dl><dt>MD5</dt><dd>0356f17f28778da7c97dc8b661c0aeb0</dd><dt>SHA1</dt><dd>2c4828f926471ec4f3522fc28dd4d8fdec692c35</dd><dt>SHA256</dt><dd>76b4ee2da4e39677038ea033f25652fb02ed9e84ab829ce212fa1dfbc941df2c</dd><dt>Size</dt><dd>3 MB (4116240 Bytes)</dd><dt>Compile Timestamp</dt><dd>n/a</dd><dt>Links</dt><dd><a href="https://www.virustotal.com/gui/file/76b4ee2da4e39677038ea033f25652fb02ed9e84ab829ce212fa1dfbc941df2c">VirusTotal</a></dd><dt>Package Name</dt><dd><code>com.btfezxwhygk2dw0gaj.eguafyojiqcw7a</code></dd><dt>Detections</dt><dd><strong>Virustotal</strong>: 21/73 as of 2022-04-25 06:01:16 - Android.BankBot.904.origin (DrWeb), Android.Sharkbot.GEN46543 (CAT-QuickHeal), Android.PUA.DebugKey (Trustlook), Trojan ( 0058a5511 ) (K7GW), AndroidOS/SpyAgent.F.gen!Eldorado (Cyren), AppRisk:Generisk (SymantecMobileInsight), a variant of Android/Spy.Agent.BWR (ESET-NOD32), HEUR:Trojan-Banker.AndroidOS.Sharkbot.d (Kaspersky), a.privacy.BankSharkBot (Tencent), Trojan.Agent.Android.340641 (Zillya), Artemis!Trojan (McAfee-GW-Edition), Andr/Banker-HAQ (Sophos), Android:Evo-gen [Trj] (Avast-Mobile), ANDROID/SpyAgent.FKIX.Gen (Avira), HEUR:Trojan-Banker.AndroidOS.Sharkbot.d (ZoneAlarm), Android.Trojan.SharkBot.B (BitDefenderFalx), Trojan/Android.Agent.1071402 (AhnLab-V3), Artemis!0356F17F2877 (McAfee), Trojan-Spy.AndroidOS.SharkBot (Ikarus), Android/Agent.BWR!tr (Fortinet)</dd></dl><p>After some mild deobfuscation of the strings and renaming the variables, the DGA looks as follows:</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">private</span> <span class="n">String</span> <span class="nf">dga</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">StringBuilder</span> <span class="n">urls</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">Calendar</span> <span class="n">calendar</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">String</span> <span class="n">tlds</span><span class="o">[]</span> <span class="o">=</span> <span class="s">".top,.xyz,.cc,.info,.com,.ru,.info,.net"</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">","</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">nrTlds</span> <span class="o">=</span> <span class="n">tlds</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">nrTlds</span><span class="o">)</span> 
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">tld</span> <span class="o">=</span> <span class="n">tlds</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">urls</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">",http://"</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">StringBuilder</span> <span class="n">seed</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">urls</span><span class="o">.</span><span class="na">append</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">Base64</span><span class="o">.</span><span class="na">encodeToString</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">                    <span class="n">seed</span><span class="o">.</span><span class="na">append</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">                        <span class="n">calendar</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Calendar</span><span class="o">.</span><span class="na">WEEK_OF_YEAR</span><span class="o">)</span> 
</span></span><span class="line"><span class="cl">                    <span class="o">)</span> 
</span></span><span class="line"><span class="cl">                    <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"pojBI9LHGFdfgegjjsJ99hvVGHVOjhksdf"</span><span class="o">)</span> 
</span></span><span class="line"><span class="cl">                    <span class="o">.</span><span class="na">toString</span><span class="o">()</span> 
</span></span><span class="line"><span class="cl">                    <span class="o">.</span><span class="na">getBytes</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">                <span class="o">,</span> <span class="n">Base64</span><span class="o">.</span><span class="na">NO_WRAP</span><span class="o">)</span> 
</span></span><span class="line"><span class="cl">                <span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">19</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="o">)</span> 
</span></span><span class="line"><span class="cl">            <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">tld</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">exception</span><span class="o">)</span> <span class="o">{</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span><span class="o">++;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">urls</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">toLowerCase</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>The DGA performs these steps to generate domains:</p><ol><li>Take the current week number (e.g. 12)</li><li>Append the hardcoded string <code>pojBI9LHGFdfgegjjsJ99hvVGHVOjhksdf</code></li><li>Base64 encode the result</li><li>Take the first 19 characters</li><li>Append a TLD from the list <code>.top</code>, <code>.xyz</code>, <code>.cc</code>, <code>.info</code>, <code>.com</code>, <code>.ru</code>, <code>.info</code>, <code>.net</code> in order.</li><li>Convert the domain to lower-case</li></ol><p>This results in domains like these:</p><pre tabindex="0"><code>mnbvakjjouxir0zkzmd.xyz
mnbvakjjouxir0zkzmd.live
mnbvakjjouxir0zkzmd.com
mnbvakjjouxir0zkzmd.store
mnbvakjjouxir0zkzmd.info
mnbvakjjouxir0zkzmd.top
mnbvakjjouxir0zkzmd.net
</code></pre><p>The second level domain (SLD) is the same for all generated domains at a given time. And since the time-dependent portion only affects the first two characters (when the week number is ≤ 9), or the first three characters (when the week number is ≥ 10), all domains will follow either of the two following pattern:</p><pre tabindex="0"><code>[n-o][awgq]bvakjjouxir0zkzmd\.(top|xyz|cc|info|com|ru|info|net)
[nm][dtjz][acegikmquy]wb2pcstlmsedgzgz\.(top|xyz|cc|info|com|ru|info|net)
</code></pre><h2 id="version-1633">Version 1.63.3</h2><p>The second version of the DGA appears in this sample:</p><dl><dt>MD5</dt><dd>48ad4e0478e4d742f51848604d06130e</dd><dt>SHA1</dt><dd>a9ca49ef2201707b7bcf57798fc67e69d238c900</dd><dt>SHA256</dt><dd>c14f413d8ed944ba7e4364e6b17585019fd622feeb4b53f7002a742d7389e08a</dd><dt>Size</dt><dd>7 MB (7345268 Bytes)</dd><dt>Compile Timestamp</dt><dd>1970-02-21 06:07:33 UTC</dd><dt>Links</dt><dd><a href="https://www.virustotal.com/gui/file/c14f413d8ed944ba7e4364e6b17585019fd622feeb4b53f7002a742d7389e08a">VirusTotal</a></dd><dt>Filename</dt><dd>(VirusTotal)</dd><dt>Detections</dt><dd><strong>Virustotal</strong>: 8/72 as of 2022-05-20 04:22:02 - Android.BankBot.958.origin (DrWeb), a variant of Android/Spy.Agent.BWR (ESET-NOD32), HEUR:Trojan-Banker.AndroidOS.Sharkbot.d (Kaspersky), ANDROID/Bankbot.FKWN.Gen (Avira), HEUR:Trojan-Banker.AndroidOS.Sharkbot.d (ZoneAlarm), Trojan/Android.Agent.1111318 (AhnLab-V3)</dd></dl><p>This sample features a small change to the DGA: The seed is now also based on the current year, which prevents the DGA from repeating after a year.</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">private</span> <span class="n">String</span> <span class="nf">dga</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">StringBuilder</span> <span class="n">urls</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">Calendar</span> <span class="n">calendar</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">String</span> <span class="n">tlds</span><span class="o">[]</span> <span class="o">=</span> <span class="s">".top,.xyz,.cc,.info,.com,.ru,.info,.net"</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">","</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">nrTlds</span> <span class="o">=</span> <span class="n">tlds</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">nrTlds</span><span class="o">)</span> 
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">tld</span> <span class="o">=</span> <span class="n">tlds</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">urls</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">",http://"</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">StringBuilder</span> <span class="n">seed</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">urls</span><span class="o">.</span><span class="na">append</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">Base64</span><span class="o">.</span><span class="na">encodeToString</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">                    <span class="n">seed</span><span class="o">.</span><span class="na">append</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">                        <span class="n">calendar</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Calendar</span><span class="o">.</span><span class="na">WEEK_OF_YEAR</span><span class="o">)</span> <span class="o">+</span> 
</span></span><span class="line hl"><span class="cl">                        <span class="n">calendar</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Calendar</span><span class="o">.</span><span class="na">YEAR</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">                    <span class="o">)</span> 
</span></span><span class="line"><span class="cl">                    <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"pojBI9LHGFdfgegjjsJ99hvVGHVOjhksdf"</span><span class="o">)</span> 
</span></span><span class="line"><span class="cl">                    <span class="o">.</span><span class="na">toString</span><span class="o">()</span> 
</span></span><span class="line"><span class="cl">                    <span class="o">.</span><span class="na">getBytes</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">                <span class="o">,</span> <span class="n">Base64</span><span class="o">.</span><span class="na">NO_WRAP</span><span class="o">)</span> 
</span></span><span class="line"><span class="cl">                <span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">19</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="o">)</span> 
</span></span><span class="line"><span class="cl">            <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">tld</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">exception</span><span class="o">)</span> <span class="o">{</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span><span class="o">++;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">urls</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">toLowerCase</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div><p>By adding the year, the time dependent component always exactly affects the first three characters of the domains, which therefore always follow this pattern:</p><pre tabindex="0"><code>mja[xyz0123][mno][hnx3]bvakjjouxir0z.\.(top|xyz|cc|info|com|ru|net)
</code></pre><h2 id="version-21">Version 2.1</h2><p>The next version of the DGA is used in this sample:</p><dl><dt>MD5</dt><dd>92011ba743860567b85f46aedf360661</dd><dt>SHA1</dt><dd>506df2fd2e638ab614eeb4cbc416bd46fdbf6a19</dd><dt>SHA256</dt><dd>70b244a03a0eacd00cc52ea8863af2c459eb8dc2e6bf5887e657b401e0477485</dd><dt>Size</dt><dd>4 MB (4252173 Bytes)</dd><dt>Links</dt><dd><a href="https://www.virustotal.com/gui/file/70b244a03a0eacd00cc52ea8863af2c459eb8dc2e6bf5887e657b401e0477485">VirusTotal</a></dd><dt>Detections</dt><dd><strong>Virustotal</strong>: 19/73 as of 2022-05-18 07:59:42 - Trojan.AndroidOS.Sharkbot.C!c (Lionic), TrojanBanker:Android/Sharkbot.bc773aca (Alibaba), Spyware ( 00592d791 ) (K7GW), AppRisk:Generisk (SymantecMobileInsight), a variant of Android/Spy.Agent.BWR (ESET-NOD32), HEUR:Trojan-Banker.AndroidOS.Sharkbot.e (Kaspersky), Android.Trojan-spy.Agent.Hphh (Tencent), Android.BankBot.977.origin (DrWeb), Artemis!Trojan (McAfee-GW-Edition), Andr/ShrkBot-B (Sophos), Trojan.AndroidOS.Agent (Ikarus), ANDROID/Bankbot.FKWN.Gen (Avira), TrojanSpy:AndroidOS/Sharkbot.B!MTB (Microsoft), Android:Evo-gen [Trj] (Avast-Mobile), Android.Trojan.Banker.ZP (BitDefenderFalx), Artemis!92011BA74386 (McAfee), Android/Agent.BWR!tr.spy (Fortinet)</dd></dl><p>For version 2, SharkBot made some larger changes:</p><ul><li>Switch to md5 instead of base64. This assures that the second level domains (SLDs) will no longer have a substantial portion that never changes.</li><li>Adding the TLD to the seed, which leads to different SLDs for different TLDs.</li><li>Cutting the length of the SLD from 19 to 16 letters.</li><li>Using differnt TLDs</li></ul><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">private</span> <span class="n">String</span> <span class="nf">dga</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">StringBuilder</span> <span class="n">urls</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">Calendar</span> <span class="n">calendar</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
</span></span><span class="line hl"><span class="cl">    <span class="n">String</span> <span class="n">tlds</span><span class="o">[]</span> <span class="o">=</span> <span class="s">".xyz,.live,.com,.store,.info,.top,.net"</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">","</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">nrTlds</span> <span class="o">=</span> <span class="n">tlds</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">nrTlds</span><span class="o">)</span> 
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">tld</span> <span class="o">=</span> <span class="n">tlds</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">urls</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">",http://"</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">StringBuilder</span> <span class="n">seed</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">urls</span><span class="o">.</span><span class="na">append</span><span class="o">(</span>
</span></span><span class="line hl"><span class="cl">                <span class="n">calc_md5</span><span class="o">(</span>
</span></span><span class="line hl"><span class="cl">                    <span class="n">seed</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">tld</span><span class="o">)</span>
</span></span><span class="line hl"><span class="cl">                        <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">calendar</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Calendar</span><span class="o">.</span><span class="na">WEEK_OF_YEAR</span><span class="o">))</span> 
</span></span><span class="line hl"><span class="cl">                        <span class="o">.</span><span class="na">toString</span><span class="o">()</span>
</span></span><span class="line hl"><span class="cl">                <span class="o">)</span>
</span></span><span class="line hl"><span class="cl">                <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">Calendar</span><span class="o">.</span><span class="na">YEAR</span><span class="o">)</span>
</span></span><span class="line hl"><span class="cl">                <span class="o">.</span><span class="na">toString</span><span class="o">()</span>
</span></span><span class="line hl"><span class="cl">                <span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="mi">16</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="o">)</span> 
</span></span><span class="line"><span class="cl">            <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">tld</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">exception</span><span class="o">)</span> <span class="o">{</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span><span class="o">++;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">urls</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">toLowerCase</span><span class="o">();</span></span></span></code></pre></div><p>Strangely, the year is concatenated to the MD5 string instead of also being hashed. Because the resulting string is cut to the first 16 characters, this means that the year once more has no influence on the generated domains.</p><h2 id="version-28">Version 2.8</h2><p>The most recent sample that I investigated is version 2.8:</p><dl><dt>MD5</dt><dd>2dfe83d4d7c0b5e0cfc0537efdbbbb01</dd><dt>SHA1</dt><dd>f1a820369f02a696e8bcaecee464eeaef0847c44</dd><dt>SHA256</dt><dd>dae193b7cac6d048dcc37916c92b0d2b11c56aa3f45e9995c16417e3b0587404</dd><dt>Size</dt><dd>7 MB (7735296 Bytes)</dd><dt>Compile Timestamp</dt><dd>1970-02-24 12:54:57 UTC</dd><dt>Links</dt><dd><a href="https://www.virustotal.com/gui/file/dae193b7cac6d048dcc37916c92b0d2b11c56aa3f45e9995c16417e3b0587404">VirusTotal</a></dd><dt>Filename</dt><dd>(VirusTotal)</dd><dt>Detections</dt><dd><strong>Virustotal</strong>: 4/73 as of 2022-05-12 15:24:09 - a variant of Android/Spy.Agent.CDR (ESET-NOD32), HEUR:Trojan-Banker.AndroidOS.Sharkbot.e (Kaspersky), ANDROID/Bankbot.FKWN.Gen (Avira)</dd></dl><p>In version 2.8 the DGA was fixed. Now the year is part of the input to MD5, so domains will be different for distinct years.</p><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">private</span> <span class="n">String</span> <span class="nf">dga</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">StringBuilder</span> <span class="n">urls</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">Calendar</span> <span class="n">calendar</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">String</span> <span class="n">tlds</span><span class="o">[]</span> <span class="o">=</span> <span class="s">".xyz,.live,.com,.store,.info,.top,.net"</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">","</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">nrTlds</span> <span class="o">=</span> <span class="n">tlds</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">nrTlds</span><span class="o">)</span> 
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">tld</span> <span class="o">=</span> <span class="n">tlds</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">urls</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">",http://"</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">StringBuilder</span> <span class="n">seed</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">urls</span><span class="o">.</span><span class="na">append</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">calc_md5</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">                    <span class="n">seed</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">tld</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">                        <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">calendar</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Calendar</span><span class="o">.</span><span class="na">WEEK_OF_YEAR</span><span class="o">))</span> 
</span></span><span class="line"><span class="cl">                        <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">""</span><span class="o">)</span>
</span></span><span class="line hl"><span class="cl">                        <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">calendar</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Calendar</span><span class="o">.</span><span class="na">YEAR</span><span class="o">))</span>
</span></span><span class="line"><span class="cl">                        <span class="o">.</span><span class="na">toString</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">                <span class="o">)</span>
</span></span><span class="line"><span class="cl">                <span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="mi">16</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="o">)</span> 
</span></span><span class="line"><span class="cl">            <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">tld</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">exception</span><span class="o">)</span> <span class="o">{</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span><span class="o">++;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">urls</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">toLowerCase</span><span class="o">();</span></span></span></code></pre></div><div class="footnotes" role="doc-endnotes"><hr><ol><li id="fn:1"><p><a href="https://malpedia.caad.fkie.fraunhofer.de/details/apk.sharkbot">Malpedia entry for SharkBot</a>&nbsp;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">↩︎</a></p></li><li id="fn:2"><p><a href="https://www.cleafy.com/cleafy-labs/sharkbot-a-new-generation-of-android-trojan-is-targeting-banks-in-europe">SharkBot: a new generation of Android Trojans is targeting banks in Europe</a>&nbsp;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">↩︎</a></p></li><li id="fn:3"><p><a href="https://research.checkpoint.com/2022/google-is-on-guard-sharks-shall-not-pass/">Google is on guard: sharks shall not pass!</a>&nbsp;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">↩︎</a></p></li><li id="fn:4"><p><a href="https://research.nccgroup.com/2022/03/03/sharkbot-a-new-generation-android-banking-trojan-being-distributed-on-google-play-store/">SharkBot: a “new” generation Android banking Trojan being distributed on Google Play Store</a>&nbsp;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">↩︎</a></p></li></ol></div></div></article></main><footer><div><div class="y"><div class="z ae aj"><div class="ag ak al am"><h3>Links</h3><ul class="i an"><li><a href="http://www.twitter.com/viql" rel="me"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-twitter" xlink:href="/assets/svg/icons.svg#icon-twitter"></use></svg> Twitter</a></li><li><a href="http://www.github.com/baderj" rel="me"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-github" xlink:href="/assets/svg/icons.svg#icon-github"></use></svg> GitHub</a></li><li><a href="mailto:hello@bin.re" rel="me"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-envelope-o" xlink:href="/assets/svg/icons.svg#icon-envelope-o"></use></svg> Mail</a></li><li><a href="https://keybase.io/baderj" rel="me"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-keybase" xlink:href="/assets/svg/icons.svg#icon-keybase"></use></svg> Keybase</a></li><li><a href="/feed.xml" rel="me"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-feed" xlink:href="/assets/svg/icons.svg#icon-feed"></use></svg> RSS</a></li><li><a href="https://threatcat.ch" rel="me"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-threatcat" xlink:href="/assets/svg/icons.svg#icon-threatcat"></use></svg> Threatcat.ch</a></li><li><a href="https://infosec.exchange/@viql" rel="me"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-mastodon" xlink:href="/assets/svg/icons.svg#icon-mastodon"></use></svg> Mastodon</a></li><li><a href="https://rosti.bin.re" rel="me"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-rosti" xlink:href="/assets/svg/icons.svg#icon-rosti"></use></svg> Rösti</a></li></ul></div><div class="ag ak al am"><div><h3>Categories</h3><ul class="i"><li><a href="/category/reverse-engineering">reverse-engineering</a> <span class="ao">(81)</span></li><li><a href="/category/tutorial">tutorial</a> <span class="ao">(14)</span></li><li><a href="/category/project-euler">project-euler</a> <span class="ao">(13)</span></li><li><a href="/category/misc">misc</a> <span class="ao">(2)</span></li><li><a href="/category/visualization">visualization</a> <span class="ao">(2)</span></li></ul></div></div><div class="ag ak al am a7"><div><h3>Tags</h3><span class="ap"><a href="/tag/malware-analysis" class="aq">malware-analysis <span class="ao">(42)</span></a><a href="/tag/dga" class="aq">dga <span class="ao">(36)</span></a><a href="/tag/crackmes" class="aq">crackmes <span class="ao">(23)</span></a><a href="/tag/practical-reverse-engineering" class="aq">practical-reverse-engineering <span class="ao">(16)</span></a><a href="/tag/math" class="aq">math <span class="ao">(15)</span></a><a href="/tag/project-euler" class="aq">project-euler <span class="ao">(13)</span></a><a href="/tag/python" class="aq">python <span class="ao">(12)</span></a><a href="/tag/upatre" class="aq">upatre <span class="ao">(4)</span></a><a href="/tag/visualization" class="aq">visualization <span class="ao">(4)</span></a><a href="/tag/d3js" class="aq">d3js <span class="ao">(3)</span></a></span> <a href="/tag/" class="ar">show all</a></div></div><div class="ag ak al am as"><div class="at"><div><h3>Blog Archive</h3><span class="au"><a href="/2013">2013</a><span class="ao">(20)</span></span> <span class="au"><a href="/2014">2014</a><span class="ao">(46)</span></span> <span class="au"><a href="/2015">2015</a><span class="ao">(24)</span></span> <span class="au"><a href="/2016">2016</a><span class="ao">(6)</span></span> <span class="au"><a href="/2018">2018</a><span class="ao">(1)</span></span> <span class="au"><a href="/2019">2019</a><span class="ao">(2)</span></span> <span class="au"><a href="/2020">2020</a><span class="ao">(5)</span></span> <span class="au"><a href="/2021">2021</a><span class="ao">(3)</span></span> <span class="au"><a href="/2022">2022</a><span class="ao">(3)</span></span> <span class="au"><a href="/2023">2023</a><span class="ao">(2)</span></span></div></div></div></div></div><div class="y av"><div class="z"><div class="ag"><p>© 2012 - 2024 Johannes Bader, last updated March 27, 2024</p></div></div></div></div></footer></div></div></body></html>