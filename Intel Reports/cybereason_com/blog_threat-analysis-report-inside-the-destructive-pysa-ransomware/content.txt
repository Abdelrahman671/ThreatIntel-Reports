<!doctype html><!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en" > <![endif]--><!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en" >        <![endif]--><!--[if IE 8]>    <html class="no-js lt-ie9" lang="en" >               <![endif]--><!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]--><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="Cybereason Global SOC Team">
    <meta name="description" content="The PYSA ransomware gang uses tools like Koadic, PsExec, and Mimikatz for credential theft and lateral movement before executing PowerShell scripts that stop or remove system security mechanisms like Windows Defender...">
    <meta name="generator" content="HubSpot">
    <title>Threat Analysis Report: Inside the Destructive PYSA Ransomware</title>
    <link rel="shortcut icon" href="https://www.cybereason.com/hubfs/cr-favicon-1.png">
    
<meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:description" content="The PYSA ransomware gang uses tools like Koadic, PsExec, and Mimikatz for credential theft and lateral movement before executing PowerShell scripts that stop or remove system security mechanisms like Windows Defender...">
    <meta property="og:title" content="Threat Analysis Report: Inside the Destructive PYSA Ransomware">
    <meta name="twitter:description" content="The PYSA ransomware gang uses tools like Koadic, PsExec, and Mimikatz for credential theft and lateral movement before executing PowerShell scripts that stop or remove system security mechanisms like Windows Defender...">
    <meta name="twitter:title" content="Threat Analysis Report: Inside the Destructive PYSA Ransomware">

    

    
    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>

<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/41681847227/1741488491170/module_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/41682410610/1741488492472/module_CR_-_Malicious_Life_Network_--_Main_Hero.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/43300360745/1741488505140/module_CR_-_Malicious_Life_Network_--_Related_Posts.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/86933076631/1741488758324/module_CR_-_Sticky_CTA_Bar.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/34473990280/1740999337265/module_CR_-_Footer_Full__en_US.min.css">
    

    
<!--  Added by GoogleTagManager integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;



var hsLoadGtm = function loadGtm() {
    if(window._hsGtmLoadOnce) {
      return;
    }

    if (useGoogleConsentModeV2) {

      gtag('set','developer_id.dZTQ1Zm',true);

      gtag('consent', 'default', {
      'ad_storage': 'denied',
      'analytics_storage': 'denied',
      'ad_user_data': 'denied',
      'ad_personalization': 'denied',
      'wait_for_update': waitForUpdateMillis
      });

      _hsp.push(['useGoogleConsentModeV2'])
    }

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TJVVB7C');

    window._hsGtmLoadOnce = true;
};

_hsp.push(['addPrivacyConsentListener', function(consent){
  if(consent.allowed || (consent.categories && consent.categories.analytics)){
    hsLoadGtm();
  }
}]);

</script>

<!-- /Added by GoogleTagManager integration -->


<script src="https://use.typekit.net/vyv2ljd.js"></script>
<script>try{Typekit.load({ async: false });}catch(e){}</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link rel="preload" href="/hubfs/__dam/fonts/ionicons.eot" as="font" type="font/otf" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/criteria/Criteria-CF-Regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/criteria/Criteria-CF-Medium.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/peristyle/Peristyle-Black.woff2" as="font" type="font/woff2" crossorigin>
<link rel="amphtml" href="https://www.cybereason.com/blog/research/threat-analysis-report-inside-the-destructive-pysa-ransomware?hs_amp=true">

<meta property="og:image" content="https://www.cybereason.com/hubfs/Threat%20Alert%20template%20%281%29.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">

<meta name="twitter:image" content="https://www.cybereason.com/hubfs/Threat%20Alert%20template%20%281%29.png">


<meta property="og:url" content="https://www.cybereason.com/blog/research/threat-analysis-report-inside-the-destructive-pysa-ransomware">
<meta name="twitter:card" content="summary_large_image">

<link rel="canonical" href="https://www.cybereason.com/blog/research/threat-analysis-report-inside-the-destructive-pysa-ransomware">

<meta property="og:type" content="article">
<link rel="alternate" type="application/rss+xml" href="https://www.cybereason.com/blog/rss.xml">
<meta name="twitter:domain" content="www.cybereason.com">
<script src="//platform.linkedin.com/in.js" type="text/javascript">
    lang: en_US
</script>

<meta http-equiv="content-language" content="en">
<link rel="stylesheet" href="//7052064.fs1.hubspotusercontent-na1.net/hubfs/7052064/hub_generated/template_assets/DEFAULT_ASSET/1741880806594/template_layout.min.css">


<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/template_assets/1/34470223313/1741528336747/template_cr-master__cta.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/template_assets/1/34470477360/1736810313166/template_cr-master__main.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/template_assets/1/35275979682/1741528339661/template_ionicons.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/template_assets/1/42760289143/1741528346957/template_cr-mln__build.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/template_assets/1/34470224480/1741528337131/template_cr-framework__bulma-columns.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/template_assets/1/35291999472/1741528340159/template_cr-framework__bulma.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/template_assets/1/42363645447/1741528345735/template_hamburger-animation.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/template_assets/1/42507091846/1741528346726/template_animate.min.css">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap" rel="stylesheet">
<script src="/hubfs/dam/plugins/marker-animation.js"></script>
<script>
$(document).ready(function() {
  $('.highlight').markerAnimation({
    "color":'var(--cr-yellow)',
    "font_weight":'normal',
    "background-size": '200% 1.2em'
  });
});
</script>

    

</head>
<body class="   hs-content-id-56162205954 hs-blog-post hs-blog-id-5272851739" style="">
<!--  Added by GoogleTagManager integration -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJVVB7C" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<!-- /Added by GoogleTagManager integration -->

    <div class="header-container-wrapper">
    <div class="header-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433790649568" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section id="cr-malicious-life-network__tier-one-header" class="position-flex">
  <div class="#">
    <div id="logo"><a href="https://www.cybereason.com"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-logo-inline--primary-black.png"></a></div>
    <div id="back-to">
      <a href="https://www.cybereason.com">Back to <span>Cybereason.com</span></a>
    </div>
    <!-- Hamburger Menu -->
    <button class="hamburger hamburger--collapse" type="button">
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="cr-mln__hamburger-menu--overlay">
      <ul>
        <li><a href="https://www.cybereason.com/blog/all"><span class="underline">All Posts</span></a></li>
        <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
        <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
        <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
        <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
        <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
        <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
      </ul>
      <div class="subscribe">
        <a href="#blog-subscribe">Subscribe</a>
      </div>
    </div>
    <!-- -->
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget mln-homepage" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433785464566" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section class="cr-malicious-life-network__hero-main base">
  <div class="container-is-blog columns hero-content page-center">
    <div class="column is-5-fullhd is-5-desktop is-12-touch">
      <a href="/blog"><img class="cr-mln-logo" src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-malicious-life-logo-v2.png"></a>
    </div>
    <div class="column is-7-fullhd is-7-desktop is-hidden-mobile is-hidden-tablet-only">
      <div class="cr-mln__search-subscribe">
        <div class="cr-mln__search">
          <a href="#cr-search-modal" class="search-btn"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/cr-blog-icon--search-dark-gray.png" alt="Search"></a>
        </div>
        <div class="cr-mln__subscribe">
          <a class="btn-subscribe" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>
      <div class="cr-mln__category-nav">
        <ul>
          <li><a href="/blog/category/all"><span class="underline">All</span></a></li>
          <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
          <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
          <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
          <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
          <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
          <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
        </ul>
      </div>
    </div>
  </div>
      <!-- MOBILE Search and Subscribe -->
      <div class="container-is-blog columns is-gapless is-hidden-desktop cr-mln__search-subscribe--mobile">
        <div class="column">
          <a class="search-btn">Search</a>
        </div>
        <div class="column">
          <a class="#" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>

      <!-- END MOBILE Search and Subscribe -->
  
  <!-- SEARCH Modal Wrap -->

  <div id="cr-search-modal">
        <!--THIS IS IMPORTANT! to close the modal, the class name has to match the name given on the ID -->
        <div id="btn-close-modal" class="close-cr-search-modal"> 
            X
        </div>

        <div class="modal-content">
            <div class="container columns">
              <div class="column">
                <div class="cr-search-modal__search-bar">
                  <h3>Search</h3>
                  <form action="/hs-search-results">
                    <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search...">
                    <input type="hidden" name="type" value="BLOG_POST">
                    <input type="hidden" name="type" value="LISTING_PAGE">
                    <button type="submit" class="arrow"></button>
                  </form>
                  
                </div>

              </div>
          </div>
        </div>
    </div>
  <!-- END Search Modal Wrap -->

</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end header -->
</div><!--end header wrapper -->

<div class="body-container-wrapper">
    <div class="body-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-blog_content " style="" data-widget-type="blog_content" data-x="0" data-w="12">







<div class="cr-mln__blog-post">
  <div class="container-is-blog columns is-multiline page-center">

    <div class="column is-8-fullhd is-8-desktop is-offset-2-fullhd is-offset-2-desktop is-10-tablet is-offset-1-tablet">
      <div class="featured-image"><img src="https://www.cybereason.com/hubfs/Threat%20Alert%20template%20%281%29.png" alt=""></div>
      <h1><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">Threat Analysis Report: Inside the Destructive PYSA Ransomware</span></h1>
      <div class="cr-mln__post-author-share">
      <div id="hubspot-author_data" class="hubspot-editable cr-mln__post-meta" data-hubspot-form-id="author_data" data-hubspot-name="Blog Author">
        
          <span class="descriptor">Written By</span>
          <p><span class="author">Cybereason Global SOC Team</span></p>
         
      </div>
    </div>
     
    </div>
    
    <!-- Sticky Author and Social Box -->
    
    <!-- END Sticky Author and Social Box -->
      <div class="container-is-blog columns is-multiline page-center cr-mln__blog-post--body">
        
        <div class="column is-7-fullhd is-7-desktop is-10-tablet is-10-mobile is-offset-1-fullhd is-offset-1-desktop is-offset-1-tablet is-offset-1-mobile">
          <span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p>The Cybereason Global Security Operations Center (GSOC) issues Cybereason Threat Analysis reports to inform on impacting threats. The Threat Analysis reports investigate these threats and provide practical recommendations for protecting against them.</p>
<!--more-->
<p>In this Threat Analysis Report, the GSOC investigates the PYSA ransomware. The PYSA ransomware came into awareness earlier this year when the Federal Bureau of Investigation (FBI) reported on the ransomware’s increased activity and high damaging impact.&nbsp;</p>
<p>The threat actors behind PYSA deploy the ransomware as part of attack operations with high-stake targets, such as government authorities, educational institutions, and the healthcare sector. This Threat Analysis report focuses on the implementation of the PYSA ransomware and the ransomware’s internal working principles when deployed on a compromised system.&nbsp;</p>
<h2 style="text-align: left;"><strong>What is PYSA Ransomware?</strong></h2>
<ul>
<li style="list-style-type: none;">
<ul style="font-size: 18px;">
<li><strong>Human-Operated</strong>: PYSA is a human-operated ransomware that does not have self-propagation capabilities. Threat actors manually deploy the PYSA ransomware as part of full attack operations. The PYSA ransomware operators typically gain initial access to target systems by compromising credentials or through phishing emails. Prior to the deployment of the ransomware, the malicious actors use publicly available and/or open-source tools for credential theft, stealthiness, privilege escalation, lateral movement, and more.</li>
<li><strong>Hybrid Encryption Approach: </strong>The PYSA ransomware is implemented in the C++ programming language and uses the open-source CryptoPP C++ library for data encryption. The ransomware encrypts data by combining the use of the Advanced Encryption Standard-Cipher Block Chaining (AES-CBC) and the Rivest, Shamir, Adleman (RSA) encryption algorithms. This is to maximize both encryption performance and security.&nbsp;</li>
<li><strong>Double Extortion</strong>: The PYSA ransomware operators use a <a href="/blog/rise-of-double-extortion-shines-spotlight-on-ransomware-prevention" rel="noopener" target="_blank">double extortion tactic</a> - if the victim refuses to pay for data decryption, the malicious actor threatens to leak the data or sell it for profit.&nbsp;</li>
<li><strong>Detected and Prevented</strong>: <a href="/platform" rel="noopener" target="_blank"><span>The Cybereason Defense Platform</span></a> effectively detects and prevents the PYSA ransomware.</li>
<li><strong>Cybereason Managed Detection and Response (MDR): </strong>The Cybereason GSOC has zero tolerance towards attacks that involve ransomware, such as PYSA, and categorizes such attacks as critical, high-severity incidents. The <a href="/services/managed-detection-response-mdr" rel="noopener" target="_blank"><span>Cybereason GSOC MDR team</span></a> issues a comprehensive report to customers when such an incident occurs. The report provides an in-depth overview of the incident, which helps to scope the extent of compromise and the impact on the customer’s environment. In addition, the report provides attribution information when possible as well as recommendations for mitigating and isolating the threat.</li>
</ul>
</li>
</ul>
<h2 style="text-align: left;"><strong>Introduction</strong></h2>
<p>PYSA is a new variant of the <a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.mespinoza" rel="noopener" target="_blank"><span>Mespinoza</span></a> ransomware that first came to prominence in <a href="https://www.cert.ssi.gouv.fr/uploads/CERTFR-2020-CTI-003.pdf" rel="noopener" target="_blank"><span>October 2019</span></a> when it infected large corporate networks. The French national computer emergency response team (CERT) reported in April 2020 that the PYSA ransomware has also targeted <a href="https://www.cert.ssi.gouv.fr/uploads/CERTFR-2020-CTI-003.pdf" rel="noopener" target="_blank"><span>French local authorities</span></a>. This has significantly raised the profile of this ransomware in the threat landscape. In March 2021, the FBI issued an <a href="https://www.ic3.gov/Media/News/2021/210316.pdf" rel="noopener" target="_blank"><span>alert</span></a> stating that they have observed an increase in the PYSA ransomware targeting education institutions in 12 US states and the United Kingdom.</p>
<p>The operators of the PYSA ransomware have specifically targeted higher education, K-12 schools, and seminaries. In addition, the FBI reports on PYSA ransomware attacks targeting US and foreign government entities, private companies, and the healthcare sector since March 2020. In June 2021, the BlackBerry Threat Research and Intelligence SPEAR Team reported that it had observed the actors behind the PYSA ransomware conducting <a href="https://blogs.blackberry.com/en/2021/06/pysa-loves-chachi-a-new-golang-rat" rel="noopener" target="_blank"><span>fully developed attack operations</span></a> and deploying the ransomware at selected target organizations.</p>
<p>PYSA is a human-operated ransomware that does not have self-propagation capabilities. Threat actors manually deploy the PYSA ransomware as part of full attack operations. The FBI reports that the PYSA ransomware operators typically gain initial access to target systems through phishing email messages or by compromising credentials, such as brute-forcing Active Directory domain credentials or Remote Desktop Protocol (RDP) credentials.&nbsp;</p>
<p>Prior to the deployment of the PYSA ransomware on a compromised system, the malicious actors use publicly available and/or open-source tools for credential theft, stealthiness, privilege escalation, lateral movement, and so on. For example, they use the <a href="https://www.advanced-port-scanner.com/" rel="noopener" target="_blank"><span>Advanced Port Scanner</span></a> and the <a href="https://www.advanced-ip-scanner.com/" rel="noopener" target="_blank"><span>Advanced IP Scanner</span></a> tools developed by Famatech Corp, which are port scanning and information gathering tools that enable users to discover and gather information on services running on network computers.</p>
<p>In addition, the ransomware operators use the tools <a href="https://www.powershellempire.com/" rel="noopener" target="_blank"><span>PowerShell Empire</span></a>, <a href="https://github.com/zerosum0x0/koadic" rel="noopener" target="_blank"><span>Koadic</span></a>, <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psexec"><span>PsExec</span></a>, and <a href="https://github.com/gentilkiwi/mimikatz/wiki" rel="noopener" target="_blank"><span>Mimikatz</span></a> for credential theft and lateral movement. Before deploying the PYSA ransomware, the actors execute PowerShell scripts that stop or remove system security mechanisms, such as Windows Defender. They also delete system restore snapshots and shadow copies so that victims cannot restore data encrypted by the ransomware.</p>
<p>Furthermore, the FBI reports that malicious actors use the <a href="https://winscp.net/eng/index.php" rel="noopener" target="_blank"><span>WinScp</span></a> tool for data exfiltration from victim systems before the data is encrypted. Also, the actors behind the PYSA ransomware use a double extortion tactic - if the victim refuses to pay for data decryption, the malicious actor threatens to leak the data online or sell it for profit:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-1.png?width=1097&amp;name=ta-pysa-image-1.png" alt="ta-pysa-image-1" width="1097" loading="lazy" style="width: 1097px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-1.png?width=549&amp;name=ta-pysa-image-1.png 549w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-1.png?width=1097&amp;name=ta-pysa-image-1.png 1097w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-1.png?width=1646&amp;name=ta-pysa-image-1.png 1646w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-1.png?width=2194&amp;name=ta-pysa-image-1.png 2194w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-1.png?width=2743&amp;name=ta-pysa-image-1.png 2743w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-1.png?width=3291&amp;name=ta-pysa-image-1.png 3291w" sizes="(max-width: 1097px) 100vw, 1097px"></p>
<p style="line-height: 1;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-2.png?width=1177&amp;name=ta-pysa-image-2.png" alt="ta-pysa-image-2" width="1177" loading="lazy" style="width: 1177px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-2.png?width=589&amp;name=ta-pysa-image-2.png 589w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-2.png?width=1177&amp;name=ta-pysa-image-2.png 1177w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-2.png?width=1766&amp;name=ta-pysa-image-2.png 1766w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-2.png?width=2354&amp;name=ta-pysa-image-2.png 2354w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-2.png?width=2943&amp;name=ta-pysa-image-2.png 2943w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-2.png?width=3531&amp;name=ta-pysa-image-2.png 3531w" sizes="(max-width: 1177px) 100vw, 1177px"></p>
<p style="font-size: 16px; text-align: center;"><em>Screenshot of the PYSA data leaks website</em></p>
<p>The operators of the PYSA ransomware communicate with their victims only via email. They refer to victims as “partners” and they do not use mechanisms typical for the currently trending Ransomware-as-a-Service (RaaS) business model, such as a ticketing system for communication with victims or online decryption services.</p>
<p>The PYSA ransomware is implemented in the C++ programming language and uses the open-source <a href="https://www.cryptopp.com/" rel="noopener" target="_blank"><span>CryptoPP</span></a> C++ library for data encryption. The ransomware encrypts data by applying a hybrid encryption approach that combines the use of the Advanced Encryption Standard-Cipher Block Chaining (AES-CBC) and the Rivest, Shamir, Adleman (RSA) encryption algorithms. This is to maximize both encryption performance and security.</p>
<p>The files that are encrypted by PYSA have the <em>.pysa</em> filename extension. The name PYSA may be derived from the <em>Protect your system amigo</em> slogan ​​or from the <a href="https://dissectingmalwa.re/another-one-for-the-collection-mespinoza-pysa-ransomware.html" rel="noopener" target="_blank"><span>Zanzibari coin</span></a> with the same name. The <em>Protect your system amigo</em> slogan can be found in the ransom note that is left by the ransomware on compromised systems.</p>
<h2 style="text-align: left;"><strong>Pysa Ransomware Analysis</strong></h2>
<p>This section discusses the implementation and the operation of the PYSA ransomware. The following chart provides a summarizing overview of the operation of PYSA:</p>
<p style="line-height: 1;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-3.png?width=1910&amp;name=ta-pysa-image-3.png" alt="ta-pysa-image-3" width="1910" loading="lazy" style="width: 1910px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-3.png?width=955&amp;name=ta-pysa-image-3.png 955w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-3.png?width=1910&amp;name=ta-pysa-image-3.png 1910w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-3.png?width=2865&amp;name=ta-pysa-image-3.png 2865w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-3.png?width=3820&amp;name=ta-pysa-image-3.png 3820w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-3.png?width=4775&amp;name=ta-pysa-image-3.png 4775w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-3.png?width=5730&amp;name=ta-pysa-image-3.png 5730w" sizes="(max-width: 1910px) 100vw, 1910px"></p>
<p style="font-size: 16px; text-align: center;"><em>Summarizing overview of the operation of the PYSA ransomware</em></p>
<p>The PYSA ransomware process first detaches itself from the console, which closes the console. This allows the ransomware to operate without the console being a visual indicator of the ransomware’s operation. The PYSA ransomware then creates a mutex object named <em>Pysa</em>. If this mutex object already exists, the ransomware terminates. This is to ensure that only one instance of the PYSA ransomware runs at a time:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-4.png?width=537&amp;name=ta-pysa-image-4.png" alt="ta-pysa-image-4" width="537" loading="lazy" style="width: 537px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-4.png?width=269&amp;name=ta-pysa-image-4.png 269w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-4.png?width=537&amp;name=ta-pysa-image-4.png 537w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-4.png?width=806&amp;name=ta-pysa-image-4.png 806w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-4.png?width=1074&amp;name=ta-pysa-image-4.png 1074w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-4.png?width=1343&amp;name=ta-pysa-image-4.png 1343w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-4.png?width=1611&amp;name=ta-pysa-image-4.png 1611w" sizes="(max-width: 537px) 100vw, 537px"></p>
<p style="font-size: 16px; text-align: center;"><em>Creation of a mutex object named Pysa</em></p>
<p>The PYSA ransomware then enumerates drives with a fixed media attached to the compromised system. These are drives for which the Windows API function <a href="https://docs.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-getdrivetypew" rel="noopener" target="_blank"><em><span>GetDriveTypeW</span></em></a> returns <em>0x3</em> (<em>DRIVE_FIXED</em>), such as hard disks. For each drive with a fixed media, the PYSA ransomware creates a process thread, in whose context the ransomware conducts file enumeration and encryption.</p>
<p>The PYSA ransomware does this in two phases. In the first phase, it encrypts files that are whitelisted for encryption, these are files that have one of the filename extensions that are hardcoded in the file that implements the ransomware. The following table lists the filename extensions of files that are whitelisted for encryption:</p>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2;">
<tbody>
<tr>
<td style="border: 1pt solid #000000;">
<p style="line-height: 1;"><em>.doc</em></p>
<p style="line-height: 1;"><em>.xls</em></p>
<p style="line-height: 1;"><em>.docx</em></p>
<p style="line-height: 1;"><em>.xlsx</em></p>
<p style="line-height: 1;"><em>.pdf</em></p>
<p style="line-height: 1;"><em>.db</em></p>
<p style="line-height: 1;"><em>.db3</em></p>
<p style="line-height: 1;"><em>.frm</em></p>
<p style="line-height: 1;"><em>.ib</em></p>
<p style="line-height: 1;"><em>.mdf</em></p>
<p style="line-height: 1;"><em>.mwb</em></p>
<p style="line-height: 1;"><em>.myd</em></p>
<p style="line-height: 1;"><em>.ndf</em></p>
<p style="line-height: 1;"><em>.sdf</em></p>
<p style="line-height: 1;"><em>.trc</em></p>
<p style="line-height: 1;"><em>.wrk</em></p>
<p style="line-height: 1;"><em>.001</em></p>
<p style="line-height: 1;"><em>.acr</em></p>
<p style="line-height: 1;"><em>.bac</em></p>
<p style="line-height: 1;"><em>.bak</em></p>
</td>
<td style="border: 1pt solid #000000;">
<p style="line-height: 1;"><em>.backupdb</em></p>
<p style="line-height: 1;"><em>.bck</em></p>
<p style="line-height: 1;"><em>.bkf</em></p>
<p style="line-height: 1;"><em>.bkup</em></p>
<p style="line-height: 1;"><em>.bup</em></p>
<p style="line-height: 1;"><em>.fbk</em></p>
<p style="line-height: 1;"><em>.mig</em></p>
<p style="line-height: 1;"><em>.spf</em></p>
<p style="line-height: 1;"><em>.sql</em></p>
<p style="line-height: 1;"><em>.vhdx</em></p>
<p style="line-height: 1;"><em>.vfd</em></p>
<p style="line-height: 1;"><em>.avhdx</em></p>
<p style="line-height: 1;"><em>.vmcx</em></p>
<p style="line-height: 1;"><em>.vmrs</em></p>
<p style="line-height: 1;"><em>.pbf</em></p>
<p style="line-height: 1;"><em>.qic</em></p>
<p style="line-height: 1;"><em>.sqb</em></p>
<p style="line-height: 1;"><em>.tis</em></p>
<p style="line-height: 1;"><em>.vbk</em></p>
<p style="line-height: 1;"><em>.vbm</em></p>
</td>
<td style="border: 1pt solid #000000;">
<p style="line-height: 1;"><em>.vrb</em></p>
<p style="line-height: 1;"><em>.win</em></p>
<p style="line-height: 1;"><em>.pst</em></p>
<p style="line-height: 1;"><em>.mdb</em></p>
<p style="line-height: 1;"><em>.7z</em></p>
<p style="line-height: 1;"><em>.zip</em></p>
<p style="line-height: 1;"><em>.rar</em></p>
<p style="line-height: 1;"><em>.cad</em></p>
<p style="line-height: 1;"><em>.dsd</em></p>
<p style="line-height: 1;"><em>.dwg</em></p>
<p style="line-height: 1;"><em>.pla</em></p>
<p style="line-height: 1;"><em>.pln</em></p>
</td>
</tr>
</tbody>
</table>
<p style="text-align: center; font-size: 16px;"><em>Filename extensions of files that the PYSA ransomware encrypts in the first phase</em></p>
<p>In the second phase, PYSA encrypts the rest of the files stored on the drive and stores a <em>README.README</em> file in each directory on the drive. The <em>README.README</em> file contains the ransom note. The ransom note contains the following:</p>
<ul>
<li style="list-style-type: none;">
<ul style="font-size: 18px;">
<li aria-level="1">The <em>Protect your system amigo</em> slogan, which the name PYSA may be derived from.</li>
<li aria-level="1">Text informing the victims that the malicious actors have exfiltrated data from the compromised system and that they will expose this data to the public, or sell the data, if payment is not made. This is a double extortion tactic.&nbsp;</li>
<li aria-level="1">A link to a data leaks website.</li>
<li aria-level="1">A list of email addresses for communication with the attackers.&nbsp;</li>
</ul>
</li>
</ul>
<p>In both phases, the PYSA ransomware:</p>
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><span style="font-size: 18px;">Encrypts only files that are bigger than 1 KB in size.</span></li>
<li aria-level="1"><span style="font-size: 18px;">Does not encrypt files that are blacklisted for encryption. These are:&nbsp;</span>
<ul style="font-size: 18px;">
<li aria-level="2">system-critical files, such as <em>pagefile.sys</em>, the Windows boot manager and files stored in system-critical directories, for example, <em>Windows</em>, <em>Boot</em>, and <em>System Volume Information</em>;&nbsp;</li>
<li aria-level="2">files that have one of the following filename extensions: <em>.exe</em>, <em>.dll</em>, <em>.search-ms</em>, <em>.sys</em>, <em>.README</em>, or <em>.pysa</em>.&nbsp;</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>PYSA does not encrypt the aforementioned files because encrypting system-critical files and files that have filename extensions typical for executable files (<em>.exe</em>, <em>.dll</em>, and <em>.sys</em>) renders the compromised system unbootable and unusable. In addition, the PYSA ransomware creates files itself with the filename extensions .<em>README</em> and .<em>pysa</em>. The encryption of these files means encrypting the ransom note and encrypting files already encrypted by PYSA:</p>
<p style="line-height: 1;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-5.png?width=918&amp;name=ta-pysa-image-5.png" alt="ta-pysa-image-5" width="918" loading="lazy" style="width: 918px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-5.png?width=459&amp;name=ta-pysa-image-5.png 459w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-5.png?width=918&amp;name=ta-pysa-image-5.png 918w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-5.png?width=1377&amp;name=ta-pysa-image-5.png 1377w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-5.png?width=1836&amp;name=ta-pysa-image-5.png 1836w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-5.png?width=2295&amp;name=ta-pysa-image-5.png 2295w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-5.png?width=2754&amp;name=ta-pysa-image-5.png 2754w" sizes="(max-width: 918px) 100vw, 918px"></p>
<p style="font-size: 16px; text-align: center;"><em>The ransom note left by the PYSA ransomware on compromised systems</em></p>
<p>Before encrypting a file, the PYSA ransomware first renames the file by appending the filename extension <em>.pysa</em> to the filename, for example, <em>test.txt</em> becomes <em>test.txt.pysa</em>. PYSA then encrypts the file by applying a hybrid encryption approach. This approach combines the use of the AES-CBC and the RSA encryption algorithms. This is to maximize both encryption performance and security.</p>
<p>The PYSA ransomware first encrypts a file with the symmetric encryption algorithm AES-CBC. AES-CBC is by design more performant but less secure than the RSA encryption algorithm. This algorithm relies on a symmetric encryption key and an initialization vector (IV) for encryption security. To compensate for this disadvantage of AES-CBC, the ransomware then encrypts the AES-CBC symmetric key and IV with the RSA encryption algorithm. The PYSA ransomware uses the CryptoPP C++ library for encryption.&nbsp;</p>
<p>For each file being encrypted, PYSA first generates two random arrays of 16 bytes. The first byte array is an AES-CBC symmetric encryption key and the second is an initialization vector (IV). PYSA then encrypts the AES-CBC key and the IV using a 4096-bit RSA public key. This public key is Abstract Syntax Notation One (ASN.1)-encoded and is stored in Distinguished Encoding Rules (DER) format in the file that implements the PYSA ransomware:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-6.png?width=566&amp;name=ta-pysa-image-6.png" alt="ta-pysa-image-6" width="566" loading="lazy" style="width: 566px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-6.png?width=283&amp;name=ta-pysa-image-6.png 283w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-6.png?width=566&amp;name=ta-pysa-image-6.png 566w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-6.png?width=849&amp;name=ta-pysa-image-6.png 849w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-6.png?width=1132&amp;name=ta-pysa-image-6.png 1132w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-6.png?width=1415&amp;name=ta-pysa-image-6.png 1415w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-6.png?width=1698&amp;name=ta-pysa-image-6.png 1698w" sizes="(max-width: 566px) 100vw, 566px"></p>
<p style="text-align: center;"><em><span style="font-size: 16px;">The public key that the PYSA ransomware uses to encrypt AES-CBC keys and IVs</span></em></p>
<p>The PYSA ransomware then uses the <em>HexEncoder</em> class of CryptoPP library to encode in strings the data segments that are the encrypted AES-CBC key and IV. This encoding represents the digits of the hexadecimal representation of the bytes of these data segments as uppercase American Standard Code for Information Interchange (ASCII) characters.</p>
<p>The RSA-encrypted form of the AES-CBC key and IV is 512 bytes big due to the 4096-bit RSA key used for encryption. Therefore, the encoding operation results in two strings of 1024 bytes:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-7.png?width=1143&amp;name=ta-pysa-image-7.png" alt="ta-pysa-image-7" width="1143" loading="lazy" style="width: 1143px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-7.png?width=572&amp;name=ta-pysa-image-7.png 572w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-7.png?width=1143&amp;name=ta-pysa-image-7.png 1143w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-7.png?width=1715&amp;name=ta-pysa-image-7.png 1715w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-7.png?width=2286&amp;name=ta-pysa-image-7.png 2286w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-7.png?width=2858&amp;name=ta-pysa-image-7.png 2858w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-7.png?width=3429&amp;name=ta-pysa-image-7.png 3429w" sizes="(max-width: 1143px) 100vw, 1143px"></p>
<p style="font-size: 16px; text-align: center;"><em>The unencrypted and RSA-encrypted form of an AES-CBC key and IV</em></p>
<p>The PYSA ransomware then encrypts 100 equal-sized data blocks of the file being encrypted, starting from the beginning of the file. For encrypting the data blocks, the ransomware uses the AES-CBC encryption algorithm with the previously generated AES-CBC key and IV. The ransomware calculates the size of a single data block for encryption (in bytes) by calculating:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-7b.png?width=291&amp;name=ta-pysa-image-7b.png" alt="ta-pysa-image-7b" width="291" loading="lazy" style="width: 291px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-7b.png?width=146&amp;name=ta-pysa-image-7b.png 146w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-7b.png?width=291&amp;name=ta-pysa-image-7b.png 291w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-7b.png?width=437&amp;name=ta-pysa-image-7b.png 437w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-7b.png?width=582&amp;name=ta-pysa-image-7b.png 582w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-7b.png?width=728&amp;name=ta-pysa-image-7b.png 728w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-7b.png?width=873&amp;name=ta-pysa-image-7b.png 873w" sizes="(max-width: 291px) 100vw, 291px"><span style="background-color: transparent; font-weight: 400;"> </span></p>
<p><span style="background-color: transparent; font-weight: 400;">where ⌊⌋ is the </span><em style="background-color: transparent;">floor</em><span style="background-color: transparent; font-weight: 400;"> function and </span><em style="background-color: transparent;">filesize</em><span style="background-color: transparent; font-weight: 400;"> is the size of the file in bytes.</span></p>
<p>Since AES-CBC operates in a block cipher mode, the encrypted form of the data blocks is equal in size to the data blocks themselves. After encrypting a data block, the PYSA ransomware writes the encrypted form of the data block in the file, replacing the original data block. This encryption procedure normally results in some data at the end of the file being left unencrypted:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-8.jpg?width=1094&amp;name=ta-pysa-image-8.jpg" alt="ta-pysa-image-8" width="1094" loading="lazy" style="width: 1094px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-8.jpg?width=547&amp;name=ta-pysa-image-8.jpg 547w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-8.jpg?width=1094&amp;name=ta-pysa-image-8.jpg 1094w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-8.jpg?width=1641&amp;name=ta-pysa-image-8.jpg 1641w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-8.jpg?width=2188&amp;name=ta-pysa-image-8.jpg 2188w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-8.jpg?width=2735&amp;name=ta-pysa-image-8.jpg 2735w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-8.jpg?width=3282&amp;name=ta-pysa-image-8.jpg 3282w" sizes="(max-width: 1094px) 100vw, 1094px"></p>
<p style="font-size: 16px; text-align: center;"><em>Unencrypted and encrypted form of a file data block (data block size: 7168 bytes)</em></p>
<p>The ransomware then appends to the end of the file the strings that store the encrypted forms of the AES-CBC key and IV. Since each of these strings is 1024 bytes big, the size of the file that PYSA has encrypted is greater by 2 KB than the size of the original, unencrypted file. The ransomware then proceeds to encrypt the next file designated for encryption:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-9.jpg?width=1039&amp;name=ta-pysa-image-9.jpg" alt="ta-pysa-image-9" width="1039" loading="lazy" style="width: 1039px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-9.jpg?width=520&amp;name=ta-pysa-image-9.jpg 520w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-9.jpg?width=1039&amp;name=ta-pysa-image-9.jpg 1039w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-9.jpg?width=1559&amp;name=ta-pysa-image-9.jpg 1559w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-9.jpg?width=2078&amp;name=ta-pysa-image-9.jpg 2078w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-9.jpg?width=2598&amp;name=ta-pysa-image-9.jpg 2598w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-9.jpg?width=3117&amp;name=ta-pysa-image-9.jpg 3117w" sizes="(max-width: 1039px) 100vw, 1039px"></p>
<p style="font-size: 16px; text-align: center;"><em>The encrypted form of an AES-CBC key and IV, appended to the end of a file</em></p>
<p>After it encrypts all files designated for encryption, the PYSA ransomware stores the value <em>PYSA</em> in the registry key <em>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\legalnoticecaption</em> and the ransom note in the registry key <em>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\legalnoticetext</em>. This displays the ransom note to users at system start-up, which effectively brings the users’ attention to it.</p>
<p>The PYSA ransomware then releases the mutex <em>Pysa</em> and writes Windows batch script code into a file named <em>update.bat</em>. PYSA first places this file in the temporary directory of the user in whose context the ransomware executes (for example <em>C:\Users\user\AppData\Local\Temp</em>) and then executes it. <em>update.bat</em> deletes the file that implements the PYSA ransomware and the directory in which this file is stored. <em>update.bat </em>also deletes itself:</p>
<p style="text-align: left;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-10.png?width=624&amp;name=ta-pysa-image-10.png" alt="ta-pysa-image-10" width="624" loading="lazy" style="width: 624px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-10.png?width=312&amp;name=ta-pysa-image-10.png 312w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-10.png?width=624&amp;name=ta-pysa-image-10.png 624w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-10.png?width=936&amp;name=ta-pysa-image-10.png 936w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-10.png?width=1248&amp;name=ta-pysa-image-10.png 1248w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-10.png?width=1560&amp;name=ta-pysa-image-10.png 1560w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-10.png?width=1872&amp;name=ta-pysa-image-10.png 1872w" sizes="(max-width: 624px) 100vw, 624px"></p>
<p style="font-size: 16px; text-align: center;"><em>The content of update.bat</em></p>
<h2 style="text-align: left;"><strong>Detection and Prevention</strong></h2>
<h2><strong>Cybereason Prevents PYSA Ransomware</strong></h2>
<p>The <a href="/platform" rel="noopener" target="_blank"><span>Cybereason Defense Platform</span></a> is able to detect and prevent the execution of the PYSA ransomware using multi-layer protection that detects and blocks ransomware with threat intelligence, machine learning and next-gen antivirus (NGAV) capabilities:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-11.png?width=1061&amp;name=ta-pysa-image-11.png" alt="ta-pysa-image-11" width="1061" loading="lazy" style="width: 1061px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-11.png?width=531&amp;name=ta-pysa-image-11.png 531w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-11.png?width=1061&amp;name=ta-pysa-image-11.png 1061w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-11.png?width=1592&amp;name=ta-pysa-image-11.png 1592w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-11.png?width=2122&amp;name=ta-pysa-image-11.png 2122w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-11.png?width=2653&amp;name=ta-pysa-image-11.png 2653w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-11.png?width=3183&amp;name=ta-pysa-image-11.png 3183w" sizes="(max-width: 1061px) 100vw, 1061px"></p>
<p style="text-align: center; font-size: 16px;"><em>The Cybereason Defense Platform detects the PYSA ransomware based on threat intelligence</em></p>
<p>The <em>Anti-Malware</em> feature of the Cybereason Defense Platform detects and prevents the execution of the PYSA ransomware. Behavioral detection techniques in the platform are able to detect and prevent any attempt to encrypt files and automatically generates a <a href="/blog/the-cybereason-difference-malop-intro" rel="noopener" target="_blank">MalOp</a><span style="font-size: 12px;"><sup>TM</sup></span> for it:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-12.png?width=1304&amp;name=ta-pysa-image-12.png" alt="ta-pysa-image-12" width="1304" loading="lazy" style="width: 1304px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-12.png?width=652&amp;name=ta-pysa-image-12.png 652w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-12.png?width=1304&amp;name=ta-pysa-image-12.png 1304w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-12.png?width=1956&amp;name=ta-pysa-image-12.png 1956w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-12.png?width=2608&amp;name=ta-pysa-image-12.png 2608w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-12.png?width=3260&amp;name=ta-pysa-image-12.png 3260w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/ta-pysa-image-12.png?width=3912&amp;name=ta-pysa-image-12.png 3912w" sizes="(max-width: 1304px) 100vw, 1304px"></p>
<p style="font-size: 16px; text-align: center;"><em>The Anti-Malware feature of the Cybereason Defense Platform detects the PYSA ransomware</em></p>
<h2><strong>Cybereason GSOC MDR</strong></h2>
<p>In this section, the Cybereason GSOC provides additional, proactive ways for detecting the presence of the PYSA ransomware in systems, and defending against this threat.</p>
<h3><strong>YARA-Based Detection</strong></h3>
<p>The following <a href="https://github.com/VirusTotal/yara/"><span>YARA</span></a> rule is useful for detecting the presence of the PYSA ransomware in the context of running processes or in the filesystem:&nbsp;</p>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2;">
<tbody>
<tr>
<td style="background-color: #efefef; border: 1pt solid #000000;">
<p style="font-size: 14px; line-height: 1;">rule Pysa_ransomware</p>
<p style="font-size: 14px; line-height: 1;">{</p>
<p style="font-size: 14px; line-height: 1;">meta:</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;description = "YARA rule for identifying the Pysa ransomware."</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;author = "Aleksandar Milenkoski"</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;date = "2021-07"</p>
<br>
<p style="font-size: 14px; line-height: 1;">strings:</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;$code = { 68 00 04 00 00 ?? ?? E8 7C BD 02 00 ?? ?? E8 A5 C2 02 00 ?? ?? ?? ?? ?? ?? ?? ??&nbsp;</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;DD ?? ?? ?? ?? ?? ?? ?? DD ?? ?? E8 5D 81 03 00 59 ?? E8 B6 BE 02 00 }</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;$s1 = "CryptoPP" ascii wide&nbsp;&nbsp;</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;$s2 = "pysa" ascii wide nocase fullword</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;$s3 = "Protect Your System Amigo" ascii wide nocase</p>
<br>
<p style="font-size: 14px; line-height: 1;">condition:</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $s2 and 2 of ($code,$s1,$s3)</p>
<p style="font-size: 14px; line-height: 1;">}</p>
</td>
</tr>
</tbody>
</table>
<p style="text-align: center; font-size: 16px;"><em>YARA rule for identifying the PYSA ransomware</em></p>
<h3><strong>Mutex Object Locking</strong></h3>
<p>The PYSA ransomware creates a mutex object named <em>Pysa</em>. If this mutex object already exists and is therefore locked, the ransomware terminates without encrypting any data. This is to the advantage of defenders such that a mutex object named <em>Pysa</em> can be locked by a legitimate process on a given system with the intention to stop any potential future execution of the PYSA ransomware on the system.</p>
<p>The PowerShell script below demonstrates this defense technique. The script creates, opens, and therefore locks a mutex object named <em>Pysa</em>, and releases the object when the user issues the <em>Ctrl+C</em> command. Users can execute the script by issuing the command <em>powershell.exe ./pysa_mutex_lock.ps1 </em>in the directory where the script file is stored, where <em>pysa_mutex_lock.ps1</em> is the filename of the script file:</p>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2; width: 620px; height: 914.316px;">
<tbody>
<tr style="height: 912.988px;">
<td style="background-color: #efefef; border: 1pt solid #000000; width: 620px; height: 913px;">
<p style="font-size: 14px; line-height: 1;">function create_pysa_mutex</p>
<p style="font-size: 14px; line-height: 1;">{</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;$created = $False</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;$mutex = New-Object -TypeName System.Threading.Mutex($true, "Pysa", [ref]$created)</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;Write-Host "Mutex object named Pysa created, opened, and locked: $created."</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;return $mutex</p>
<p style="font-size: 14px; line-height: 1;">}</p>
<p style="font-size: 14px; line-height: 1;">function release_pysa_mutex</p>
<p style="font-size: 14px; line-height: 1;">{</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;param (</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$mutex</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;)</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;$mutex.ReleaseMutex()</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;$mutex.Dispose()</p>
<p style="font-size: 14px; line-height: 1;">}</p>
<p style="font-size: 14px; line-height: 1;">$mutex = create_pysa_mutex</p>
<p style="font-size: 14px; line-height: 1;">try</p>
<p style="font-size: 14px; line-height: 1;">{</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;while($true)</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;{</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Start-Sleep -Seconds 1</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p style="font-size: 14px; line-height: 1;">}</p>
<p style="font-size: 14px; line-height: 1;">finally{</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;release_pysa_mutex($mutex)</p>
<p style="font-size: 14px; line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;Write-Host "Mutex object released."</p>
<p style="font-size: 14px; line-height: 1;">}</p>
</td>
</tr>
</tbody>
</table>
<p style="text-align: center; font-size: 16px;"><em>PowerShell script that locks a mutex object named Pysa</em></p>
<h2><strong>General Recommendations</strong></h2>
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><span style="font-size: 18px;">Enable the <em>Anti-Ransomware</em> feature on the Cybereason NGAV and set the <a href="https://nest.cybereason.com/documentation/product-documentation/190/anti-ransomware-settings#set-protection-mode" rel="noopener" target="_blank"><em>Anti-Ransomware</em><span style="text-decoration: underline;"> protection mode</span></a> to <em>Prevent.</em></span></li>
<li aria-level="1"><span style="font-size: 18px;">Enable the <em>Anti-Malware</em> feature on the Cybereason NGAV and enable the <a href="https://nest.cybereason.com/documentation/product-documentation/190/anti-malware-settings" rel="noopener" target="_blank"><em>Detect</em><span style="text-decoration: underline;"> and </span><em><span style="text-decoration: underline;">Prevent</span></em><span style="text-decoration: underline;"> modes</span></a> of this feature.</span></li>
<li aria-level="1"><span style="font-size: 18px;">Make sure your systems are timely patched in order to minimize the risk of ransomware infections by vulnerability exploitation.</span></li>
<li aria-level="1"><span style="font-size: 18px;">Use secure passwords, regularly rotate passwords, and use multi-factor authentication where possible.</span></li>
<li aria-level="1"><span style="font-size: 18px;">Disable unused RDP services, properly secure used RDP services, and regularly monitor RDP log data for bruteforce attempts and other irregular activities.&nbsp;</span></li>
<li aria-level="1"><span style="font-size: 18px;">Regularly backup files to a secured remote location and implement a data recovery plan. Regular data backups ensure that you can restore your data after a ransomware attack.&nbsp;</span></li>
<li aria-level="1"><span style="font-size: 18px;">Securely handle email messages that originate from external sources. This includes disabling hyperlinks and investigating the content of email messages to identify phishing attempts.&nbsp;</span>&nbsp;</li>
</ul>
</li>
</ul>
<p>Cybereason is dedicated to teaming with defenders to end cyber attacks from endpoints to the enterprise to everywhere - including modern ransomware. <a href="/platform/anti-ransomware" rel="noopener" target="_blank"><span>Learn more about ransomware defense here</span></a> or <a href="/request-a-demo" rel="noopener" target="_blank"><span>schedule a demo today</span></a> to learn how your organization can benefit from an <a href="/blog/the-cybereason-malop-achieving-operation-centric-security" rel="noopener" target="_blank"><span>operation-centric approach</span></a> to security.</p>
<h2 style="text-align: left;"><strong>Indicators of Compromise</strong></h2>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2;">
<tbody>
<tr>
<td style="border: 1pt solid #000000;">
<p><strong>Executables</strong></p>
</td>
<td style="border: 1pt solid #000000;">
<p>SHA-256 hash: <em>7FD3000A3AFBF077589C300F90B59864EC1FB716FEBA8E288ED87291C8FDF7C3</em></p>
<br>
<p>File size: 512512 bytes</p>
</td>
</tr>
<tr>
<td style="border: 1pt solid #000000;">
<p><strong>Associated files</strong></p>
</td>
<td style="border: 1pt solid #000000;">
<p><em>Readme.README</em></p>
<p><em>%TEMP%\update.bat</em></p>
</td>
</tr>
<tr>
<td style="border: 1pt solid #000000;">
<p><strong>Mutex objects</strong></p>
</td>
<td style="border: 1pt solid #000000;">
<p><em>Pysa</em></p>
</td>
</tr>
<tr>
<td style="border: 1pt solid #000000;">
<p><strong>Email domains</strong></p>
</td>
<td style="border: 1pt solid #000000;">
<p><em>protonmail.com</em></p>
<p><em>onionmail.org</em></p>
</td>
</tr>
<tr>
<td style="border: 1pt solid #000000;">
<p><strong>Registry keys</strong></p>
</td>
<td style="border: 1pt solid #000000;">
<p><em>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\legalnoticecaption</em></p>
<p><em>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\legalnoticetext</em></p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h2 style="text-align: left;"><strong>MITRE ATT&amp;CK Techniques</strong></h2>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2;">
<tbody>
<tr>
<td style="background-color: #f1c232; border: 0.99609pt solid #000000;">
<p><strong>Execution</strong></p>
</td>
<td style="background-color: #f1c232; border: 0.99609pt solid #000000;">
<p><strong>Defense Evasion</strong></p>
</td>
<td style="background-color: #f1c232; border: 0.99609pt solid #000000;">
<p><strong>Discovery</strong></p>
</td>
<td style="background-color: #f1c232; border: 0.99609pt solid #000000;">
<p><strong>Impact</strong></p>
</td>
</tr>
<tr>
<td style="border: 0.99609pt solid #000000;">
<p><a href="https://attack.mitre.org/techniques/T1106/" rel="noopener" target="_blank"><span>Native API</span></a></p>
</td>
<td style="border: 0.99609pt solid #000000;">
<p><a href="https://attack.mitre.org/techniques/T1070/004/" rel="noopener" target="_blank"><span>Indicator Removal on Host: File Deletion</span></a></p>
</td>
<td style="border: 0.99609pt solid #000000;">
<p><a href="https://attack.mitre.org/techniques/T1083/" rel="noopener" target="_blank"><span>File and Directory Discovery</span></a></p>
</td>
<td style="border: 0.99609pt solid #000000;">
<p><a href="https://attack.mitre.org/techniques/T1486/" rel="noopener" target="_blank"><span>Data Encrypted for Impact</span></a></p>
</td>
</tr>
<tr>
<td style="border: 0.99609pt solid #000000;">&nbsp;</td>
<td style="border: 0.99609pt solid #000000;">
<p><a href="https://attack.mitre.org/techniques/T1112/" rel="noopener" target="_blank">Modify Registry</a></p>
</td>
<td style="border: 0.99609pt solid #000000;">&nbsp;</td>
<td style="border: 0.99609pt solid #000000;">&nbsp;</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h2><strong>About the Researcher:</strong></h2>
<p><strong><img src="https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-53-53-18-PM.png?width=140&amp;name=unnamed-Sep-14-2021-08-53-53-18-PM.png" alt="unnamed-Sep-14-2021-08-53-53-18-PM" width="140" loading="lazy" style="width: 140px; float: left; margin: 0px 7px 1px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-53-53-18-PM.png?width=70&amp;name=unnamed-Sep-14-2021-08-53-53-18-PM.png 70w, https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-53-53-18-PM.png?width=140&amp;name=unnamed-Sep-14-2021-08-53-53-18-PM.png 140w, https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-53-53-18-PM.png?width=210&amp;name=unnamed-Sep-14-2021-08-53-53-18-PM.png 210w, https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-53-53-18-PM.png?width=280&amp;name=unnamed-Sep-14-2021-08-53-53-18-PM.png 280w, https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-53-53-18-PM.png?width=350&amp;name=unnamed-Sep-14-2021-08-53-53-18-PM.png 350w, https://www.cybereason.com/hs-fs/hubfs/unnamed-Sep-14-2021-08-53-53-18-PM.png?width=420&amp;name=unnamed-Sep-14-2021-08-53-53-18-PM.png 420w" sizes="(max-width: 140px) 100vw, 140px">Aleksandar Milenkoski, Senior Threat and Malware Analyst, Cybereason Global SOC</strong></p>
<p>Aleksandar Milenkoski is a Senior Threat and Malware Analyst with the Cybereason Global SOC team. He is involved primarily in reverse engineering and threat research activities. Aleksandar has a PhD in system security. Prior to Cybereason, his work focussed on research in intrusion detection and reverse engineering security mechanisms of the Windows 10 operating system.</p></span>
          
          <!-- IOC PopUp Modal -->
          
          
          
          <!-- -->
          
          <!-- Social Share -->
          <div class="cr-blog-post__social-sharing">
            <span>Share</span>
            <div id="hs_cos_wrapper_module_161724375084957" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-social_sharing" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">






<div class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_social_sharing" data-hs-cos-general-type="widget" data-hs-cos-type="social_sharing">
  
	
  
    
    
    
			
		

    <a href="https://twitter.com/intent/tweet?original_referer=https://www.cybereason.com/blog/research/threat-analysis-report-inside-the-destructive-pysa-ransomware&amp;utm_medium=social&amp;utm_source=twitter&amp;url=https://www.cybereason.com/blog/research/threat-analysis-report-inside-the-destructive-pysa-ransomware&amp;utm_medium=social&amp;utm_source=twitter&amp;source=tweetbutton&amp;text=" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/twitter-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on twitter">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.facebook.com/share.php?u=https://www.cybereason.com/blog/research/threat-analysis-report-inside-the-destructive-pysa-ransomware&amp;utm_medium=social&amp;utm_source=facebook" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/facebook-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on facebook">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.cybereason.com/blog/research/threat-analysis-report-inside-the-destructive-pysa-ransomware&amp;utm_medium=social&amp;utm_source=linkedin" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/linkedin-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on linkedin">
    </a>
	

</div></div>
          </div> 
          
          
          <!-- CONDITIONAL Author Box Display -->
            <div class="container columns cr-mln__author-listing-single">
              
                <div class="column headshot is-3-full-hd is-3-desktop is-3-tablet is-12-mobile">
                  <img class="cr-speaker-headshot" src="https://www.cybereason.com/hubfs/Capture-4.png" alt="Cybereason Global SOC Team">
                </div>
              
              <div class="column is-9-full-hd is-9-desktop is-12-mobile">
                <span class="descriptor">About the Author</span>
                <h4>Cybereason Global SOC Team</h4>
                
                
                
                  <p>The Cybereason Global SOC Team delivers 24/7 Managed Detection and Response services to customers on every continent. Led by cybersecurity experts with experience working for government, the military and multiple industry verticals, the Cybereason Global SOC Team continuously hunts for the most sophisticated and pervasive threats to support our mission to end cyberattacks on the endpoint, across the enterprise, and everywhere the battle moves.</p>
                
                
                  <a class="cr-button cr-button__min" href="https://www.cybereason.com/blog/authors/cybereason-global-soc-team">All Posts by Cybereason Global SOC Team</a>
                
              </div>            
            </div>
          
        <!-- CONDITIONAL Post Type Choices -->
        
        <!-- Malicious Life Post -->
        
        
        <!-- CISO Stories -->
        
        <!-- Webinar -->
        
          
        <!-- CONDITIONAL Transcript -->
          
        
         <!-- Related Posts -->
        <div id="hs_cos_wrapper_module_1649342860525315" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<section class="cr-section related-posts__wrapper">
  <div class="container container-is-blog page-center">
     <h3>Related Posts</h3>
     <div class="columns is-multiline">
       
  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/royal-ransomware-analysis"><img src="https://www.cybereason.com/hubfs/Royal%20Ransomware-1.png" alt="Royal Rumble: Analysis of Royal Ransomware"></a>
    <h4><a href="https://www.cybereason.com/blog/royal-ransomware-analysis"><span class="underline">Royal Rumble: Analysis of Royal Ransomware</span></a></h4>
     <p>Royal ransomware has become one of the most prolific ransomware groups in 2022. Read our threat analysis to learn how Royal ransomware operations work, how they evade anti-ransomware defenses, and how you can outsmart them.  </p>
   </div>
 </div>


  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/threat-analysis-beast-ransomware"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/featured-images/beast-ransomware-blog-featured.png" alt="THREAT ANALYSIS: Beast Ransomware"></a>
    <h4><a href="https://www.cybereason.com/blog/threat-analysis-beast-ransomware"><span class="underline">THREAT ANALYSIS: Beast Ransomware</span></a></h4>
     <p>In this Threat Analysis report, Cybereason investigates the Ransomware-as-a-Service (RaaS) known as Beast and how to defend against it through the Cybereason Defense Platform.</p>
   </div>
 </div>



    </div>
  </div>
</section></div>
          
          
      </div>
        
        <!-- Sidebar -->

      <div class="column is-3-fullhd is-3-desktop is-12-mobile cr-malicious-life-network__sidebar">
        <div class="cr-ml-sidebar--group">
        <div class="top-stripe"></div>
        <div class="sidebar-block search-section">
          <form action="/hs-search-results">
            <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search">
            <input type="hidden" name="type" value="BLOG_POST">
            <input type="hidden" name="type" value="LISTING_PAGE">
            <button type="submit" class="arrow"></button>
          </form>
        </div>
        <div class="sidebar-block subscribe">
          <a href="#blog-subscribe">
            <h4>Subscribe</h4>
            <span>Never miss a blog.</span>
          </a>
        </div>

        <div class="sidebar-block recent-posts">
          <h4>Recent Posts</h4>
          
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/identifying-and-preventing-bin-attacks" class="post-name"><span class="underline">Cracking the Code: How to Identify, Mitigate, and Prevent BIN Attacks</span></a>
                       
                    </div>
                </div>
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/zero-day-vulnerabilities-vmware" class="post-name"><span class="underline">Three Zero-Day Vulnerabilities Discovered in VMware Products</span></a>
                       
                    </div>
                </div>
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/bec-email-signature-technique" class="post-name"><span class="underline">Deceptive Signatures: Advanced Techniques in BEC Attacks</span></a>
                       
                    </div>
                </div>
            
        </div>

        <div class="sidebar-block category-listing">
          <h4>Categories</h4>
          <ul>
            <li><a href="https://www.cybereason.com/blog/category/research">Research</a></li>
            <li><a href="https://www.cybereason.com/blog/category/podcasts">Podcasts</a></li>
            <li><a href="https://www.cybereason.com/blog/category/webinars">Webinars</a></li>
            <li><a href="https://www.cybereason.com/blog/category/resources">Resources</a></li>
            <li><a href="https://www.cybereason.com/blog/category/videos">Videos</a></li>
            <li><a href="https://www.cybereason.com/blog/category/news">News</a></li>
          </ul>

          <a class="rec-category__single--view-all" href="/blog/category/research">All Posts</a>
        </div>

        
      </div><!-- END .rec-categories__all -->
      
      
      
    </div>
       
    </div>
  </div>
</div></div>

</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="display: none;" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1616011887658867" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<section class="cr-section related-posts__wrapper">
  <div class="container container-is-blog page-center">
     <h3>Related Posts</h3>
     <div class="columns is-multiline">
       
  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/royal-ransomware-analysis"><img src="https://www.cybereason.com/hubfs/Royal%20Ransomware-1.png" alt="Royal Rumble: Analysis of Royal Ransomware"></a>
    <h4><a href="https://www.cybereason.com/blog/royal-ransomware-analysis"><span class="underline">Royal Rumble: Analysis of Royal Ransomware</span></a></h4>
     <p>Royal ransomware has become one of the most prolific ransomware groups in 2022. Read our threat analysis to learn how Royal ransomware operations work, how they evade anti-ransomware defenses, and how you can outsmart them.  </p>
   </div>
 </div>


  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/threat-analysis-beast-ransomware"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/featured-images/beast-ransomware-blog-featured.png" alt="THREAT ANALYSIS: Beast Ransomware"></a>
    <h4><a href="https://www.cybereason.com/blog/threat-analysis-beast-ransomware"><span class="underline">THREAT ANALYSIS: Beast Ransomware</span></a></h4>
     <p>In this Threat Analysis report, Cybereason investigates the Ransomware-as-a-Service (RaaS) known as Beast and how to defend against it through the Cybereason Defense Platform.</p>
   </div>
 </div>



    </div>
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-3 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_161767462015235" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-blog_subscribe" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-mln__blog-listing-page__subscribe-footer">
  <div class="container container-is-blog columns page-center">
    <div class="column is-8-fullhd is-8-desktop is-10-tablet is-12-mobile">
      <span class="tag">NEWSLETTER</span>
      <h3>Never miss a blog</h3>
      <p>Get the latest research, expert insights, and security industry news.</p>
      <a class="cr-button cr-mln__subscribe" href="#blog-subscribe">Subscribe</a>
    </div>
    <!--<div class="column is-5-fullhd is-5-desktop is-half-tablet is-12-mobile is-offset-1-fullhd is-offset-1-desktop">
      <div class="inputs-wrapper">
        
        
      </div>
    </div>-->
  </div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-4 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_166508001252918" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-sticky-cta-bar bg-black" id="sticky-bar">
  <div class="content">
    <span>Want to see the Cybereason Defense Platform in action?</span>
    <a class="cr-button cr-button__fill-yellow" href="https://www.cybereason.com/request-a-demo" target="_blank">Schedule a Demo</a>
  </div>
  <div class="close">X</div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end body -->
</div><!--end body wrapper -->

<div class="footer-container-wrapper">
    <div class="footer-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_16036762394194314" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><!-- FOOTER -->

<footer class="cr-section cr-footer cr-footer__full">
    <div class="container page-center">
      <div class="columns">
          <div class="column is-6-fullhd is-5-desktop cr-footer__col cr-footer__left">
            <div class="cr-footer__Left-logo">
              
                <a href="https://www.cybereason.com">
                  
                <img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-logo-inline--primary-white.png">
              </a>
            </div>
          </div>
          <div class="columns column is-6-fullhd is-6-desktop cr-footer__col cr-footer__right">
            <div class="cr-footer__links-list column">
              <h4>About</h4>
              <ul>
                <li><a href="https://www.cybereason.com/company/who-we-are">Who We Are</a>
                </li><li><a href="https://www.cybereason.com/company/careers">Careers</a>
          <!-- </li><li><a href="https://www.cybereason.com/company/leadership">Leadership</a> --->
                </li><li><a href="https://www.cybereason.com/company/contact-us">Contact</a>
              </li></ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Resources</h4>
              <ul>
                <li><a href="https://www.cybereason.com/blog">Blog</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/case-study">Case Studies</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/webinars">Webinars</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/white-papers">White Papers</a></li>
             </ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Platform</h4>
              <ul>
                
                <li><a href="https://www.cybereason.com/platform">Overview</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-prevention">Endpoint Protection</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-detection-response-edr">EDR</a></li>
                <li><a href="https://www.cybereason.com/platform/managed-detection-response-mdr">MDR</a></li>
              </ul>
            </div>
          </div>
      </div>
    </div>
  
    <div class="container page-center">
      <div class="columns cr-footer__bottom-bar">
        <div class="column">
          <p>©Cybereason 2025. All Rights Reserved.</p>
        </div>
        <div class="column bottom-bar__links">
          <ul>
            <li><a href="https://www.cybereason.com/terms-of-use">Terms of Use</a></li>
            <li><a href="https://www.cybereason.com/privacy-notice">Privacy Notice</a></li>
            <li><a href="https://www.cybereason.com/ccpa-privacy-request">Do Not Sell</a></li>
            <li><a href="https://www.cybereason.com/security">Security</a></li>
            <!--<li><a href="#">Cookie Policy</a></li>-->
          </ul>
        </div>

        <div class="column bottom-bar__social">
          <ul>
            <li><a class="facebook" href="https://www.facebook.com/Cybereason/"></a></li>
            <li><a class="twitter" href="https://twitter.com/cybereason"></a></li>
            <li><a class="youtube" href="https://www.youtube.com/channel/UCOm7AaB0HiNH4Phe66sK0Ew"></a></li>
            <li><a class="linkedin" href="https://www.linkedin.com/company/cybereason"></a></li>
            <li><a class="instagram" href="https://www.instagram.com/cybereason"></a></li>
          </ul>
        </div>
    </div>
  </div>

</footer></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end footer -->
</div><!--end footer wrapper -->

    
<!-- HubSpot performance collection script -->
<script defer src="/hs/hsstatic/content-cwv-embed/static-1.1293/embed.js"></script>
<script src="https://www.cybereason.com/hs-fs/hubfs/hub_generated/template_assets/1/42507089303/1741528346196/template_animatedModal.min.js"></script>
<script>
var hsVars = hsVars || {}; hsVars['language'] = 'en';
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.53/bundles/project.js"></script>
<script src="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/41681847227/1741488491170/module_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.js"></script>
<script src="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/41682410610/1741488492472/module_CR_-_Malicious_Life_Network_--_Main_Hero.min.js"></script>
<script src="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/43300360745/1741488505140/module_CR_-_Malicious_Life_Network_--_Related_Posts.min.js"></script>
<script src="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/86933076631/1741488758324/module_CR_-_Sticky_CTA_Bar.min.js"></script>

<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "blog-post"]);
_hsq.push(["setCanonicalUrl", "https:\/\/www.cybereason.com\/blog\/research\/threat-analysis-report-inside-the-destructive-pysa-ransomware"]);
_hsq.push(["setPageId", "56162205954"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 56162205954,
    "legacyPageId": "56162205954",
    "contentFolderId": null,
    "contentGroupId": 5272851739,
    "abTestId": null,
    "languageVariantId": 56162205954,
    "languageCode": "en",
    
    
}]);
</script>

<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/3354902.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    render_id: "b28afe47-4fe1-4420-aa45-fe6223810cf7",
    ticks: 1741894838315,
    page_id: 56162205954,
    
    content_group_id: 5272851739,
    portal_id: 3354902,
    app_hs_base_url: "https://app.hubspot.com",
    cp_hs_base_url: "https://cp.hubspot.com",
    language: "en",
    analytics_page_type: "blog-post",
    scp_content_type: "",
    
    analytics_page_id: "56162205954",
    category_id: 3,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.432/js/index.js"></script>

<script>if ($('[id^="hs_form"]').length > 0) {
  var myInterval = setInterval(
  function() {
    var myFields = document.getElementsByClassName('hs-input');
    if (myFields.length > 0) {
      clearInterval(myInterval);
      for (var i = 0; i < myFields.length; i++) {
        var myField = myFields[i];
		var myTagName = myField.tagName.toLowerCase();
        if (myTagName == 'input' || myTagName == 'textarea') {
          if (myField.placeholder != null) {
            myField.placeholder = myField.placeholder.replace('*', '');
          }
        } else if (myTagName == 'select') {
          myField.options[0].innerHTML = myField.options[0].innerHTML.replace('*', '');
        }
      }
    }
  }, 100);
}
</script>

<div id="fb-root"></div>
  <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v3.0";
  fjs.parentNode.insertBefore(js, fjs);
 }(document, 'script', 'facebook-jssdk'));</script> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
 


    <script>
function sticky_relocate() {
  var window_top = $(window).scrollTop();
  var div_top = $('#sticky-anchor').offset().top;
  if (window_top > div_top) {
    $('#sticky').addClass('stick');
  } else {
    $('#sticky').removeClass('stick');
  }
}

$(function() {
  $(window).scroll(sticky_relocate);
  sticky_relocate();
});
</script>
    <!-- Generated by the HubSpot Template Builder - template version 1.03 -->

<script type="text/javascript" src="/_Incapsula_Resource?SWJIYLWA=719d34d31c8e3a6e6fffd425f7e032f3&ns=6&cb=158890172" async></script></body></html>