<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">
    <link rel="preconnect" href="https://www.paloaltonetworks.com">
    <link rel="preconnect" href="https://cdn.cookielaw.org">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	    <!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
var main_site_url = 'https://www.paloaltonetworks.com';
var maindomain_lang = 'https://www.paloaltonetworks.com';
function getParameterByName(name, url) {
		if(url == null){
		  url = window.location.href;
		}
	    name = name.replace(/[\[\]]/g, '\\$&');
	    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
		results = regex.exec(url);
	    if (!results) return null;
	    if (!results[2]) return '';
	    return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	var container_q = getParameterByName('container');
	var d_lang = 'en';	
</script>

<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css"></noscript>
  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/azure-data-factory-apache-airflow-vulnerabilities/" />
<link rel="alternate" hreflang="x-default" href="https://unit42.paloaltonetworks.com/azure-data-factory-apache-airflow-vulnerabilities/" />

	<!-- This site is optimized with the Yoast SEO Premium plugin v23.7 (Yoast SEO v23.7) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Dirty DAG: New Vulnerabilities in Azure Data Factory’s Apache Airflow Integration</title>
	<meta name="description" content="Vulnerabilities in Microsoft Azure Data Factory&#039;s integration with Apache Airflow can lead to unauthorized access and control over cloud resources." />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/azure-data-factory-apache-airflow-vulnerabilities/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Dirty DAG: New Vulnerabilities in Azure Data Factory’s Apache Airflow Integration" />
	<meta property="og:description" content="Vulnerabilities in Microsoft Azure Data Factory&#039;s integration with Apache Airflow can lead to unauthorized access and control over cloud resources." />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/azure-data-factory-apache-airflow-vulnerabilities/" />
	<meta property="og:site_name" content="Unit 42" />
	<meta property="article:published_time" content="2024-12-16T23:00:37+00:00" />
	<meta property="article:modified_time" content="2024-12-16T19:52:47+00:00" />
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/05_Cloud_cybersecurity_research_Overview_1920x900.jpg" />
	<meta property="og:image:width" content="1920" />
	<meta property="og:image:height" content="900" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="Ofir Balassiano, David Orlovsky" />
	<meta name="twitter:card" content="summary_large_image" />
	<!-- / Yoast SEO Premium plugin. -->


<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Feed" href="https://unit42.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Comments Feed" href="https://unit42.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Dirty DAG: New Vulnerabilities in Azure Data Factory’s Apache Airflow Integration Comments Feed" href="https://unit42.paloaltonetworks.com/azure-data-factory-apache-airflow-vulnerabilities/feed/" />
<script type="text/javascript">
var globalConfig = {};
var webData = {};
webData.channel = "unit42";
webData.property = "unit42.paloaltonetworks.com";
webData.language = "en_us";
webData.pageType = "blogs";
webData.pageName = "unit42:azure-data-factory-apache-airflow-vulnerabilities";
webData.pageURL = "https://unit42.paloaltonetworks.com/azure-data-factory-apache-airflow-vulnerabilities";
webData.article_title = "Dirty DAG: New Vulnerabilities in Azure Data Factory’s Apache Airflow Integration";
webData.author = "Ofir Balassiano,David Orlovsky";
webData.published_time = "2024-12-16T15:00:37-08:00";
webData.description = "Vulnerabilities in Microsoft Azure Data Factory&#039;s integration with Apache Airflow can lead to unauthorized access and control over cloud resources.";
webData.keywords = "Cloud Cybersecurity Research,Threat Research,Apache Airflow,Containers,Kubernetes,Microsoft Azure,Microsoft Azure Data Factory";
webData.resourceAssetID = "1629bbb495fc47375991ea07c8272bc8";
</script>
<script type="text/javascript">
var globalConfig = {};
globalConfig.buildName = "UniqueResourceAssetsID_DEC022022";
</script>
<meta property="og:likes" content="0"/>
<meta property="og:readtime" content="15"/>
<meta property="og:views" content="1,156"/>
<meta property="og:date_created" content="December 16, 2024 at 3:00 PM"/>
<meta property="og:post_length" content="3728"/>
<meta property="og:category" content="Cloud Cybersecurity Research"/>
<meta property="og:category" content="Threat Research"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/cloud-cybersecurity-research/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-research/"/>
<meta property="og:author" content="Ofir Balassiano"/>
<meta property="og:author" content="David Orlovsky"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta name="post_tags" content="Apache Airflow,Containers,Kubernetes,Microsoft Azure,Microsoft Azure Data Factory"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Dirty DAG: New Vulnerabilities in Azure Data Factory\u2019s Apache Airflow Integration","name":"Dirty DAG: New Vulnerabilities in Azure Data Factory\u2019s Apache Airflow Integration","description":"Vulnerabilities in Microsoft Azure Data Factory's integration with Apache Airflow can lead to unauthorized access and control over cloud resources. ","url":"https:\/\/unit42.paloaltonetworks.com\/azure-data-factory-apache-airflow-vulnerabilities\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/azure-data-factory-apache-airflow-vulnerabilities\/","datePublished":"December 16, 2024","articleBody":"Executive Summary\r\nUnit 42 researchers have discovered new security vulnerabilities in the Azure Data Factory Apache Airflow integration. Attackers can exploit these flaws by gaining unauthorized write permissions to a directed acyclic graph (DAG) file or using a compromised service principal.\r\n\r\nWhile classified as low severity vulnerabilities by Microsoft, the risk still carries significant potential impact for organizations that use Azure Data Factory. The vulnerabilities can provide attackers with shadow admin control over Azure infrastructure, which could lead to data exfiltration, malware deployment and unauthorized data access.\r\n\r\nOur research identified multiple vulnerabilities in the Azure Data Factory:\r\n\r\n \tMisconfigured Kubernetes RBAC in Airflow cluster\r\n \tMisconfigured secret handling of the Azure\u2019s internal Geneva service\r\n \tWeak authentication for Geneva\r\n\r\nExploiting these flaws could allow attackers to gain persistent access as shadow administrators over the entire Airflow Azure Kubernetes Service (AKS) cluster. This could enable malicious activities like data exfiltration, malware deployment or covert operations within the cluster.\r\n\r\nOnce inside, attackers can also manipulate Azure\u2019s internal Geneva service, which is responsible for managing critical logs and metrics. This could allow attackers to potentially tamper with log data or access other sensitive Azure resources.\r\n\r\nAlthough the cluster we used was isolated from other clusters, the fact that the managed Airflow instance used default, non-changeable configurations and the cluster admin role is attached to the Airflow runner caused a security issue. Attackers could manipulate this issue to control the Airflow cluster and related infrastructure.\r\n\r\nUnit 42 researchers have shared these vulnerabilities with Azure. This issue highlights the importance of carefully managing service permissions to prevent unauthorized access. It also highlights the importance of monitoring the operations of critical third-party services to prevent such access.\r\n\r\nIn this article, we provide an overview of our findings and outline key mitigation strategies to help safeguard cloud environments from similar threats.\r\n\r\nWe will also examine Azure's internal Geneva service, which was used in an Airflow instance with write permissions to specific shared storage accounts. Figure 1 illustrates the Azure Data Factory Airflow infrastructure and the attack process.\r\n\r\n[caption id=\"attachment_137796\" align=\"alignnone\" width=\"1000\"] Figure 1. Azure Data Factory and airflow cluster architecture overview.[\/caption]\r\n\r\nPalo Alto Networks customers are better protected from the threats discussed in this article through the following products:\r\n\r\n \tCortex XDR and XSIAM\r\n \tAdvanced WildFire\r\n \tNext-Generation Firewall with the Advanced Threat Prevention security subscription\r\n\r\nIf you think you might have been compromised or have an urgent matter, contact the Unit 42 Incident Response team.\r\n\r\n\r\n\r\nRelated Unit 42 Topics\r\nMicrosoft Azure, Containers\r\n\r\n\r\n\r\nBackground: Azure Data Factory and Apache Airflow\r\nBefore we delve into the intricacies of our research on Azure Data Factory and Apache Airflow, it's essential to be aware of the following fundamental concepts.\r\n\r\n \tData Factory service\r\n\r\n \tData Factory is an Azure-based data integration service that enables users to manage data pipelines when moving data between different sources.\r\n\r\n\r\n \tAirflow service\r\n\r\n \tApache Airflow is an open-source platform that facilitates the scheduling and orchestration of complex workflows. This enables users to manage and schedule tasks as Python-coded DAGs.\r\n\r\n\r\n \tAirflow DAG files\r\n\r\n \tDAG files define the workflow structure as Python code. These files specify the sequence in which tasks should be executed, dependencies between tasks and scheduling rules.\r\n\r\n\r\n \tAzure Airflow integration with Data Factory\r\n\r\n \tAzure Data Factory offers a managed Airflow instance integration that is deployed as an AKS cluster managed by Azure.\r\n\r\n\r\n\r\nGaining Initial Access to the Azure Data Factory Airflow Integration\r\nHere's a high-level overview of the flow of an initial attack scenario:\r\n\r\n \tCraft a DAG file that opens a reverse shell to a remote server and runs automatically when imported.\r\n \tUpload the DAG file to a private GitHub repository connected to the Airflow cluster.\r\n\r\nAirflow imports and runs the DAG file automatically from the connected Git repository, opening a reverse shell on an Airflow worker. At this point, we gained cluster admin privileges due to a Kubernetes service account that was attached to an Airflow worker.\r\n\r\nThere are two ways for attackers to gain access to and tamper with DAG files:\r\n\r\n \tGaining write permissions to the storage account containing DAG files by leveraging either a principal account with write permissions or a shared access signature (SAS) token for the files. SAS tokens temporarily grant limited access to DAG files. Once a DAG file is tampered with, it lies dormant until the DAG files are imported by the victim.\r\n \tGaining access to a Git repository by leaked credentials or a misconfigured repository. Once this is obtained, the attacker creates a malicious DAG file or modifies an existing one and the directory containing the malicious DAG file is imported automatically.\r\n\r\nWe chose to use leaked credentials from a Git repository as an attack scenario. In this case, once the attacker manipulates the compromised DAG file, Airflow executes it and the attacker gets a reverse shell.\r\n\r\nFor our research, we crafted a malicious DAG file (shown in Figure 2).\r\n\r\n[caption id=\"attachment_137798\" align=\"alignnone\" width=\"497\"] Figure 2. Reverse shell DAG code.[\/caption]\r\n\r\nThe file ran automatically upon import (as shown in Figure 3) using the schedule_interval and start_date parameters. The file\u2019s purpose was to run a task that initiates a reverse shell to an external server.\r\n\r\n[caption id=\"attachment_137800\" align=\"alignnone\" width=\"900\"] Figure 3. Airflow user interface (UI) showing current DAG files with details.[\/caption]\r\n\r\nUpon running the DAG file, we received the reverse shell connection and could communicate with the instance. The shell we received was running under the context of the Airflow user in a Kubernetes pod shown in Figure 4, which had minimal permissions.\r\n\r\n[caption id=\"attachment_137802\" align=\"alignnone\" width=\"163\"] Figure 4. Whoami shows a non-root user.[\/caption]\r\n\r\nHowever, the pod had public internet access as shown below in Figure 5.\r\n\r\n[caption id=\"attachment_137804\" align=\"alignnone\" width=\"803\"] Figure 5. Curl shows that we have public internet access.[\/caption]\r\n\r\nWhile inspecting the pod, we discovered a secret, which was a service account token mounted into the pod file system. Due to the pod's network connectivity, this new access allowed us to download Kubectl (Kubernetes\u2019 command-line tool) and to test our permissions as shown in Figure 6.\r\n\r\n[caption id=\"attachment_137806\" align=\"alignnone\" width=\"575\"] Figure 6. Worker pod shows Kubernetes cluster admin privileges.[\/caption]\r\n\r\nWe saw that the service account used by the pod had cluster admin permissions, giving us full control over the entire cluster. These permissions included creating pods, accessing Kubernetes secrets (shown in Figure 8) and creating new users. This allowed us to enumerate the cluster environments (shown in Figures 7 and 8) and to gain more insight on how Airflow was deployed.\r\n\r\n[caption id=\"attachment_137808\" align=\"alignnone\" width=\"780\"] Figure 7. Pods inside the cluster.[\/caption]\r\n\r\n[caption id=\"attachment_137810\" align=\"alignnone\" width=\"780\"] Figure 8. Kubernetes cluster secrets relevant to Azure and Airflow.[\/caption]\r\n\r\nWe found secrets related to Airflow, such as the PostgreSQL backend password and TLS certificates to the Airflow domain. Additionally, we observed an API key to an exposed storage account containing DAG files, shown in Figure 9.\r\n\r\n[caption id=\"attachment_137812\" align=\"alignnone\" width=\"314\"] Figure 9. Showing secrets that are stored in the cluster.[\/caption]\r\n\r\nMicrosoft\u2019s response to the underlying security issue that we reported was to underscore that \u201cthe above is isolated to the researcher's cluster alone.\u201d\r\n\r\nAlthough the cluster is isolated from other clusters, the fact that the managed airflow instance used default, non-changeable configurations and the cluster admin role is attached to the Airflow runner caused a security issue. Attackers could manipulate this issue to control the Airflow cluster and related infrastructure.\r\n\r\nWhen enumerating the cluster resources, we understood that a single tenant deployment and the cluster are available only to us. However, to exhaust our options, we further enumerated the cluster and primarily found Airflow pods such as the server backend and web UI, as well as some pods labeled geneva-services. We will delve into the meaning of this label further in a later section (Exploiting Geneva \u2013 Azure Internal Service) to explore the potential impact.\r\nContainer Escape: AKS Gaining Access to Host\r\nOnce we had cluster admin permissions, we could perform escalation and cluster takeover by deploying a privileged pod and breaking out onto the underlying node as shown in Figure 10. The privileged pod had shared host resources and the host\u2019s root file system as a mounted volume.\r\n\r\n[caption id=\"attachment_137865\" align=\"alignnone\" width=\"550\"] Figure 10. Accessing the host disk with a privileged pod.[\/caption]\r\n\r\nAt this point, we gained access to the host virtual machine (VM) with root access.\r\n\r\nFrom the uname command output (shown in Figure 11), we understood that we were running in the scope of a VM scale set (Azure VM scaling solution), and that the Airflow cluster was running on top of that.\r\n\r\n[caption id=\"attachment_137816\" align=\"alignnone\" width=\"550\"] Figure 11. Uname command revealed information about a host.[\/caption]\r\n\r\nFigure 12 depicts the container breakout flow.\r\n\r\n[caption id=\"attachment_137818\" align=\"alignnone\" width=\"1000\"] Figure 12. Chain of events leading to host takeover.[\/caption]\r\nFull Cluster Control Impact\r\nHaving a high-privileged service account connected to the Airflow runner pod enables control to the node itself and presents attackers with multiple opportunities to extend their actions. Here are two examples of such opportunities:\r\n\r\n \tShadow workloads through shadow administrator access: An attacker could create another service account role with cluster admin privileges. The account could have full access to create pods and other resources inside the cluster that could cause damage, such as creating pods that serve malware or cryptomining without the victims\u2019 awareness. Figure 13 illustrates such a scenario.\r\n\r\n[caption id=\"attachment_137820\" align=\"alignnone\" width=\"884\"] Figure 13. An attacker can covertly take over the cluster and steal data sources from Airflow.[\/caption]\r\n\r\n \tData exfiltration: The attacker could gain persistence in the cluster through workload creation, actively leaking data that is connected to the Airflow environment over time as shown in Figure 14. Due to the level of access, the attacker could obtain credential information related to current and future data sources connected to the Airflow environment, such as storage accounts and SQL servers.\r\n\r\n[caption id=\"attachment_137822\" align=\"alignnone\" width=\"884\"] Figure 14. An attacker can hijack the cluster for malicious uses.[\/caption]\r\n\r\nDiscovering Assets in the New Azure Environment\r\nFrom Root to Azure Identity\r\nAfter getting root access on the host, we were able to start with the discovery process of our new environment. First, we used the Instance Metadata Service (IMDS) endpoint to grab the machine authentication token.\r\n\r\nThe IMDS endpoint provides information about currently running virtual machine (VM) instances. This can be used to manage and configure VMs, including getting an authentication token for managed identities assigned to the VM. IMDS is accessed via an exposed endpoint only from the machine itself.\r\nWireServer\r\nAzure\u2019s WireServer is another endpoint that can be accessed from within any Azure VM that in some scenarios exposes sensitive metadata and configuration information. WireServer facilitates communication between Azure VMs and the Azure environment. It does so by enabling the delivery of configuration information and management tasks from Azure to the VMs, ensuring that they operate in accordance with the user's specifications and Azure's infrastructure requirements.\r\n\r\nThe WireServer is accessed via an HTTP endpoint, which uses the IP address 168.63.129[.]16. This endpoint can be queried to retrieve information about VM extensions and sensitive data. By using the IMDS and WireServer endpoints, we discovered that two managed identities were connected to the Virtual Machine Scale Set (VMSS), a group of load-balanced VMs.\r\n\r\nWe used the WireServer to obtain further information regarding the instance.\r\n\r\nThe following activities formed our high-level workflow:\r\n\r\n \tQuerying the WireServer endpoint to discover managed identities\r\n \tQuerying IMDS to get an access token for each identity\r\n \tEnumerating the Azure environment\r\n \tQuerying the Microsoft.Authorization\/roleAssignments API call to discover custom roles\r\n\r\nFirst, we queried the WireServer endpoint to see VM extension information and general information with the command shown in Figure 15.\r\n\r\n[caption id=\"attachment_137868\" align=\"alignnone\" width=\"624\"] Figure 15. WireServer API call.[\/caption]\r\n\r\nFrom this query, we got the following output shown in Figure 16. The output shows the virtual machine state, different configurations and information that can be gathered about the machine.\r\n\r\n[caption id=\"attachment_137870\" align=\"alignnone\" width=\"592\"] Figure 16. WireServer API output.[\/caption]\r\n\r\nAfter that, we did the same for the extension endpoint shown in Figure 17, with the following command:\r\n\r\n \thXXp:\/\/168.63.129[.]16:80\/machine\/&lt;REDACTED&gt;-6f7490f0cc7b\/&lt;REDACTED&gt;-ab78-81795f77ad10._aks-agentpool-30850510-vmss_2?comp=config;type=extensionsConfig;incarnation=2\r\n\r\nWe received the response shown in Figure 17.\r\n\r\n[caption id=\"attachment_137872\" align=\"alignnone\" width=\"624\"] Figure 17. WireServer VM identity information.[\/caption]\r\n\r\nWe can see two user-assigned managed identities that are created for the cluster:\r\n\r\n \thttpapplicationrouting-&lt;CLIENT TENANTID&gt;\r\n \t&lt;CLIENT TENANTID&gt;-agentpool\r\n\r\nFor each identity, there is an attached attribute IdentityClientId that is used when querying the IMDS endpoint to obtain its relevant access token. Figure 18 depicts how to query the IMDS endpoint for a specific user-assigned managed identity token.\r\n\r\n[caption id=\"attachment_137874\" align=\"alignnone\" width=\"600\"] Figure 18. IMDS API call to retrieve specific managed identity credentials.[\/caption]\r\n\r\nFrom our query, we received the token shown in Figure 19.\r\n\r\n[caption id=\"attachment_137876\" align=\"alignnone\" width=\"600\"] Figure 19. Azure access token for relevant identity.[\/caption]\r\nThe Discovery Process in the New Azure Environment\r\nAt this point, we started analyzing the Azure subscription we were running on by using the new identity tokens. We found some resources we could access, and by enumerating them in the environment, we could better understand our options.\r\n\r\nA dedicated resource group for each Airflow deployment is created when the AKS is deployed. A special HTTP application-routing add-on for Kubernetes is added that can create records in the DNS zone resource and enable network routing to the AKS instance. This add-on will soon be retired and it is not suitable for production usage, as described in this article on Azure.AKS.HTTPAppRouting.\r\n\r\nThe add-on creates the HTTPApplicationRouting identity with a Reader role (shown in Figure 20) over the resource group and a Contributor role over the DNS zone, which enabled us to modify the DNS service attached to the cluster.\r\n\r\n[caption id=\"attachment_137834\" align=\"alignnone\" width=\"1000\"] Figure 20. Cloud infrastructure topology of Airflow deployment.[\/caption]\r\n\r\nAt this point, several Azure-managed resources were accessible to us. Initially, this was just the storage account where the DAG files were imported and the DNS zone to which we had contributor access and could modify records.\r\n\r\nAdditionally, custom role definitions inside Azure\u2019s tenant with the keyword Geneva (shown in Figure 21) caught our eye. This was notable because the cluster had pods labeled geneva-service-xxxx (shown previously in Figure 7).\r\n\r\n[caption id=\"attachment_137836\" align=\"alignnone\" width=\"748\"] Figure 21. Custom roles regarding Geneva, each with different permissions.[\/caption]\r\n\r\nThe role definitions prompted questions about the nature of these pods, as well as the purpose of Geneva and its application.\r\n\r\nWhen we inspected the role\u2019s permissions, it showed us what type of capabilities Geneva could have. We found that it was able to manage multiple types of Azure resources, such as event hubs, subscription management and storage.\r\n\r\nPermissions such as Microsoft.Storage\/storageAccounts\/listKeys\/action or Microsoft.Resources\/subscriptions\/read and Microsoft.EventHub\/register\/action (which is used to register an EventHub provider) show Geneva\u2019s potential capabilities.\r\n\r\nThese high-privileged custom roles led us to inspect the pods in our cluster and their runtime behavior.\r\n\r\nDisclosing internal role definition information and enumerating the cluster\u2019s cloud environment could help attackers better understand what they can and can\u2019t do. Furthermore, attackers could use the access tokens to modify the DNS zone resource and access storage accounts related to Airflow.\r\nExploiting Geneva \u2013 Azure Internal Service\r\nUpon encountering Azure resources and pods regarding Geneva in our cluster, we assumed Geneva was related to gathering analytics data. We wanted to explore this to better understand this internal Azure system. Figure 22 shows which pods were in the AKS cluster.\r\n\r\n[caption id=\"attachment_137878\" align=\"alignnone\" width=\"221\"] Figure 22. Geneva pods in the Airflow cluster.[\/caption]\r\n\r\nGeneva service is an internal Azure service that monitors and gathers analytical data from Microsoft\u2019s infrastructure on a large scale. The impact of any security misconfigurations in this service can be detrimental.\r\n\r\nThere isn\u2019t much information online about Geneva, other than on a small number of Microsoft forums for in-house developers. As such, we started analyzing the runtime behavior of the pods to gain a better understanding of the service.\r\n\r\nThe following activities formed our high-level workflow:\r\n\r\n \tInspecting Geneva pods and the attached secrets in our cluster\r\n \tPerforming a runtime and static analysis of pods, as well as the certificate and key in the secrets\r\n \tDiscovering internal API endpoints used by pods\r\n \tLeveraging the API endpoints to disclose multiple Azure resources\r\n \tExploiting read\/write privileges on multi-tenant shared resources\r\n\r\nGeneva Service Pod Inspection\r\nInspecting the pods revealed that they used the secrets azsecpack-auth, mdm-authandmdsm-auth (shown in Figure 23).\r\n\r\n[caption id=\"attachment_137840\" align=\"alignnone\" width=\"995\"] Figure 23. Secret list inside the cluster. Note the auth secrets.[\/caption]\r\n\r\nWe saw processes inside the pod that ran the Azure mdsd monitoring agent (shown in Figure 24).\r\n\r\n[caption id=\"attachment_137842\" align=\"alignnone\" width=\"888\"] Figure 24. Geneva service pods running processes.[\/caption]\r\n\r\nAt this point, we assumed that the mdsd agent collects metrics such as cluster health, pod status and current live processes. It then sends them to the Geneva service.\r\n\r\nMoreover, a binary that we found related to mdsd used a certificate and a key as a type of authentication. Figure 25 shows the different flags the binary used.\r\n\r\n[caption id=\"attachment_137844\" align=\"alignnone\" width=\"947\"] Figure 25. Non-standard mdsd utility binary in the pod that is used for debugging.[\/caption]\r\n\r\nThe azsecpack-auth, mdm-auth and mdsm-auth secrets contained a certificate and a private key shown in Figure 26.\r\n\r\n[caption id=\"attachment_137880\" align=\"alignnone\" width=\"400\"] Figure 26. Certificate that was stored as a secret in the Airflow cluster.[\/caption]\r\n\r\nUsing the OpenSSL command-line interface (CLI), we inspected the certificate with the following command:\r\n\r\n \topenssl x509 -in certificate.crt -text -noout\r\n\r\nFigure 27 shows the details we received.\r\n\r\n[caption id=\"attachment_137882\" align=\"alignnone\" width=\"468\"] Figure 27. OpenSSL information about certificate identity.[\/caption]\r\n\r\nThe decoded certificate in Figure 27 above shows that the subject CN (which is the domain name protected by the certificate) was gcs.svc.datafactory.azure.com. When we inspected the same secrets in other Airflow deployments, we saw the same subject CN used across all deployments.\r\n\r\nIn addition, all Airflow deployments use the same certificate to authenticate to the Geneva service. There is no separation between different Airflow deployments.\r\nDiscovering Internal API Endpoints\r\nAt this point, we wanted to better understand Geneva\u2019s mechanism through the mdsd binary. We reverse engineered the binaries to reveal multiple API endpoints that mdsd monitoring agents used to communicate with Geneva. Figures 28 and Figure 29 show snippets from the reverse engineering process.\r\n\r\n[caption id=\"attachment_137850\" align=\"alignnone\" width=\"864\"] Figure 28. API endpoints in binary strings.[\/caption]\r\n\r\n[caption id=\"attachment_137852\" align=\"alignnone\" width=\"819\"] Figure 29. REST API URL construction inside binary.[\/caption]\r\n\r\nIn the reverse engineering process, we were able to reconstruct API calls to Geneva. And by using the certificate and key that we found earlier, we could authenticate to Geneva and call the API endpoints that we had found.\r\n\r\nThe API endpoints we found disclosed more Azure resources. Some gave us write access to storage accounts, event hubs and other internal Azure systems.\r\n\r\nFigure 30 illustrates the access level we achieved.\r\n\r\n[caption id=\"attachment_137854\" align=\"alignnone\" width=\"1000\"] Figure 30. Geneva service in our cluster with access to different Azure resources.[\/caption]\r\nGeneva's Aftermath: The Impact on Azure\u2019s Ecosystem\r\nInternal Data Assets Exposed\r\nUsing the above endpoints and keys, we found multiple SAS tokens for data assets.\r\nFigures 31 and 32 show examples of the tokens we found.\r\n\r\n[caption id=\"attachment_137885\" align=\"alignnone\" width=\"624\"] Figure 31. Storage accounts keys found.[\/caption]\r\n\r\n[caption id=\"attachment_137887\" align=\"alignnone\" width=\"624\"] Figure 32. Event hub keys found.[\/caption]\r\n\r\nWe also found we weren\u2019t restricted in writing to the datastores.\r\n\r\nAnother notable API call we found disclosed entities such as users or machines that had access to Geneva (shown in Figure 33).\r\n\r\n[caption id=\"attachment_137889\" align=\"alignnone\" width=\"624\"] Figure 33. Information disclosed by an API regarding identities that use Geneva.[\/caption]\r\nLog Manipulation Attack Scenario\r\nBy using the exposed SAS tokens for the event hubs, we could exploit and write arbitrary information to them. This means a sophisticated attacker could modify a vulnerable Airflow environment.\r\n\r\nFor example, an attacker could create new pods and new service accounts. They could also apply changes to the cluster nodes themselves and then send fake logs to Geneva without raising an alarm.\r\n\r\nWe used the code shown in Figure 34 to demonstrate this.\r\n\r\n[caption id=\"attachment_137891\" align=\"alignnone\" width=\"624\"] Figure 34. Proof of concept code that demonstrated the impact of generating and sending crafted logs to Azure\u2019s central log service.[\/caption]\r\nConclusion\r\nOur research identified multiple vulnerabilities in the Azure Data Factory:\r\n\r\n \tMisconfigured Kubernetes RBAC in Airflow cluster\r\n \tMisconfigured secret handling of the Geneva service\r\n \tWeak authentication for Geneva\r\n\r\nThese vulnerabilities could enable attackers to escape from their pods, gain unauthorized administrative control over clusters and access Azure's internal services (Geneva). Attackers could exploit the vulnerabilities through compromised service principals or unauthorized modifications to DAG files. This could enable attackers to become shadow administrators and to gain full control over managed Airflow deployments on a single tenant base.\r\n\r\nWe would like to thank Microsoft MSRC for helping to resolve these issues.\r\n\r\nAdversaries have moved beyond basic tactics to more sophisticated service-specific attacks. Therefore, it is essential to adopt a comprehensive protection strategy that goes beyond simply safeguarding the cluster's perimeter.\r\n\r\nThis strategy should include:\r\n\r\n \tSecuring permissions and configurations within the environment itself, and using policy and audit engines to help detect and prevent future incidents (both within the cluster and in the cloud)\r\n \tSafeguarding sensitive data assets that interact with different services in the cloud, to understand which data is being processed with which data service\r\n\r\nPalo Alto Networks customers are better protected from the threats discussed above through the following products:\r\n\r\n \tAdvanced WildFire cloud-delivered malware analysis service accurately identifies known samples as malicious\r\n \tNext-Generation Firewall with the Advanced Threat Prevention security subscription can help block the attacks with best practices via the following Threat Prevention signature: 54790\r\n \tCortex XDR and XSIAM offer protections relevant to the threat described such as through the reverse shell module for Behavioral Threat Protection.\r\n\r\nIf you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call:\r\n\r\n \tNorth America Toll-Free: 866.486.4842 (866.4.UNIT42)\r\n \tEMEA: +31.20.299.3130\r\n \tAPAC: +65.6983.8730\r\n \tJapan: +81.50.1790.0200\r\n\r\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about the Cyber Threat Alliance.","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2024\/12\/05_Cloud_cybersecurity_research_Overview_1920x900-300x300.jpg","width":300,"height":300},"speakable":{"@type":"SpeakableSpecification","xPath":["\/html\/head\/title","\/html\/head\/meta[@name='description']\/@content"]},"author":[{"@type":"Person","name":"Ofir Balassiano"},{"@type":"Person","name":"David Orlovsky"}]}</script><link rel='stylesheet' id='crayon-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<style id='co-authors-plus-coauthors-style-inline-css'>
.wp-block-co-authors-plus-coauthors.is-layout-flow [class*=wp-block-co-authors-plus]{display:inline}

</style>
<style id='co-authors-plus-avatar-style-inline-css'>
.wp-block-co-authors-plus-avatar :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-avatar :where(img){vertical-align:middle}.wp-block-co-authors-plus-avatar:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-avatar.aligncenter{display:table;margin-inline:auto}

</style>
<style id='co-authors-plus-image-style-inline-css'>
.wp-block-co-authors-plus-image{margin-bottom:0}.wp-block-co-authors-plus-image :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-image :where(img){vertical-align:middle}.wp-block-co-authors-plus-image:is(.alignfull,.alignwide) :where(img){width:100%}.wp-block-co-authors-plus-image:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-image.aligncenter{display:table;margin-inline:auto}

</style>
<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='post-views-counter-frontend-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.min.css?ver=1.4.7' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.min.css?ver=1' media='all' />
<link rel='stylesheet' id='unit42-v6-style-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/style.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-head-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/head-styles.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v5-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-plugin-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/plugin.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main-redesign.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='like-dislike-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/css/ldc-lite.css?ver=1.0.0' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script id="crayon_js-js-extra">
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" id="crayon_js-js"></script>
<script id="post-views-counter-frontend-js-before">
var pvcArgsFrontend = {"mode":"js","postID":137792,"requestURL":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","nonce":"fc41e6e4a8","dataStorage":"cookies","multisite":false,"path":"\/","domain":""};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/js/frontend.min.js?ver=1.4.7" id="post-views-counter-frontend-js"></script>
<script id="wpml-xdomain-data-js-extra">
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en","_nonce":"372441833c"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.6.13" id="wpml-xdomain-data-js" defer data-wp-strategy="defer"></script>
<link rel="https://api.w.org/" href="https://unit42.paloaltonetworks.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://unit42.paloaltonetworks.com/wp-json/wp/v2/posts/137792" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.2" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=137792' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fazure-data-factory-apache-airflow-vulnerabilities%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fazure-data-factory-apache-airflow-vulnerabilities%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.6.13 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
			padding-top:0px;
			padding-bottom:0px;
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>      <link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="32x32" />
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<meta name="msapplication-TileImage" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<script>var $ = jQuery;</script>

    <script type="text/javascript">
    ;(function(win, doc, style, timeout) {
    var STYLE_ID = 'at-body-style';
    function getParent() {
    return doc.getElementsByTagName('head')[0];
    }
    function addStyle(parent, id, def) {
        if (!parent) {
        return;
        }
        var style = doc.createElement('style');
        style.id = id;
        style.innerHTML = def;
        parent.appendChild(style);
    }
    function removeStyle(parent, id) {
        if (!parent) {
            return;
        }
        var style = doc.getElementById(id);
        if (!style) {
            return;
        }
        parent.removeChild(style);
    }
    addStyle(getParent(), STYLE_ID, style);
    setTimeout(function() {
    removeStyle(getParent(), STYLE_ID);
    }, timeout);
    }(window, document, "body {visibility:hidden !important}", 3000));
    </script>

            <script src="https://assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
            <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>


<script type="text/javascript">
var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
if(isIE11){
    var polyfill = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/scripts/polyfill.min.js';
    document.write('<script type="text/javascript" src="'+polyfill+'">\x3C/script>');
}
    /**
 * String.prototype.replaceAll() polyfill
 * https://gomakethings.com/how-to-replace-a-section-of-a-string-with-another-one-with-vanilla-js/
 * @author Chris Ferdinandi
 * @license MIT
 */
if (!String.prototype.replaceAll) {
	String.prototype.replaceAll = function(str, newStr){
		// If a regex pattern
		if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {
			return this.replace(str, newStr);
		}
		// If a string
		return this.replace(new RegExp(str, 'g'), newStr);
	};
}

    /*! lozad.js - v1.16.0 - 2020-09-06 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});

</script>

<!-- <script src="https://www.google.com/recaptcha/api.js"></script>  -->

<!--  End: Scripts Migrated From Unit42-v5 -->

</head>
<body class="post-template-default single single-post postid-137792 single-format-standard no-sidebar">
<header class="haeder py-15 position-relative z-index-2" style="display: none;">
  <div class="container px-sm-30 px-35">
    <div class="row">
        <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                        <a href="https://www.paloaltonetworks.com/">
                <img src="/wp-content/uploads/2021/07/PANW_Parent.png" width="140px" alt="Logo" />
            </a>
        </div>
      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo"  width="150" height="35"/>
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search" aria-label="search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required aria-label="Inner Search">
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10"  style="display: none!important;">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-119884" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-119884"><a target="_blank" rel="noopener" href="https://www.paloaltonetworks.com/unit42">Security Consulting</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
<li id="menu-item-121229" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-121229"><a href="https://start.paloaltonetworks.com/contact-unit42.html"><b style="color:#C84727">Under Attack?</b></a></li>
</ul>  </div>
</nav>
<div class="panClean pan-template-home" id="main-nav-menu-cont" style="display:none;">
    <div class="cleanHeader mainNavigationComp baseComponent parbase">
        <div class="productNav2021Component dark default" id="PAN_2021_NAV_ASYNC">
        </div>
  </div>
<div class="cleanTopHtml htmlComp baseComponent parbase"><div class="base-component-spacer spacer-none  "></div>
</div>
</div>
<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
	function getCookie(cname) {
	 	var name = cname + "=";
  		var decodedCookie = decodeURIComponent(document.cookie);
		var ca = decodedCookie.split(';');
  		for(var i = 0; i <ca.length; i++) {
    			var c = ca[i];
    			while (c.charAt(0) == ' ') {
     				 c = c.substring(1);
    			}
    			if (c.indexOf(name) == 0) {
    				 return c.substring(name.length, c.length);
    			}
  		}
  		return "";
	}

	var referer = "";//sessionStorage.container;
	var pcontainer = sessionStorage.getItem("container");
	var searchResultsPagePath = "";
	if(((pcontainer) && pcontainer.indexOf('Prisma')!=-1)){
	    referer = 'Prisma' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Cortex')!=-1)){
	    referer = 'Cortex' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Sase')!=-1)){
	    referer = 'Sase' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Unit')!=-1)){
	    referer = 'Unit' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Ngfw')!=-1)){
	    referer = 'Ngfw' ;
	}
        var fromRef = document.referrer;
        var nContainer = getCookie("navContainer");
        if(nContainer){//If user is coming from main site, we need to reset the container		
		if(fromRef  && fromRef.indexOf("prismacloud.io")!=-1){
                        referer = 'Prisma' ;
                        sessionStorage.setItem("container","Prisma");
                } else if(fromRef.indexOf("paloaltonetworks.com")!=-1 || fromRef.indexOf("paloaltonetworks.jp")!=-1 ){
                        if(nContainer.indexOf('Prisma') != -1){
                            referer = 'Prisma' ;
                            sessionStorage.setItem("container","Prisma");
                        }
                        if(nContainer.indexOf('Cortex') != -1){
                            referer = 'Cortex' ;
                            sessionStorage.setItem("container","Cortex");
                        }
			if(nContainer.indexOf('Sase') != -1){
                            referer = 'Sase' ;
                            sessionStorage.setItem("container","Sase");
                        }
			if(nContainer.indexOf('Unit') != -1){
                            referer = 'Unit' ;
                            sessionStorage.setItem("container","Unit");
                        }
			if(nContainer.indexOf('Ngfw') != -1){
                            referer = 'Ngfw' ;
                            sessionStorage.setItem("container","Ngfw");
                        }
			document.cookie = 'navContainer=; path=/; domain=.paloaltonetworks.com; expires=' + new Date(0).toUTCString();
		}
	}
if(referer != "Prisma" && referer != "Cortex" && referer != "Sase" && referer != "Unit" && referer != "Ngfw") {
    referer = 'Unit' ;
    sessionStorage.setItem("container","Unit");
}
function callMainSitePrismaNavHTML(){
    
    var referrer_domain = 'https://www.paloaltonetworks.com';
    sessionStorage.setItem("domain",referrer_domain);
    if(referer == 'Prisma'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/prismasearch";
        }
    if(referer == 'Cortex'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderCortex.cortexRenderer.html';	
        searchResultsPagePath = referrer_domain+"/search/cortexsearch";	
    }
    if(referer == 'Sase'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderSase.saseRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/sasesearch";
    }
    if(referer == 'Unit'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/unit-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/content/pan/en_US/search/unit42search";
		    }
    if(referer == 'Ngfw'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/ngfw-cdss-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/search/ngfwcdsssearch";
    }
    httpGet(menu_url,'menu_html');
    document.getElementById('main-nav-menu-cont').removeAttribute("style");
}
function addStyle(styles) {            
    /* Create style document */
    var css = document.createElement('style');
    css.type = 'text/css';

    if (css.styleSheet) 
        css.styleSheet.cssText = styles;
    else 
        css.appendChild(document.createTextNode(styles));

    /* Append style to the tag name */
    document.getElementsByTagName("head")[0].appendChild(css);
}
function httpGet(theUrl,req_type) {
    if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            if(req_type == 'menu_html'){
            var nav_text = xmlhttp.responseText.replaceAll('https://static.cloud.coveo.com/searchui/v2.9159/js/CoveoJsSearch.Lazy.min.js', '');
            nav_text = nav_text.replaceAll('src="/', 'src="'+maindomain_lang+'/');
            nav_text = nav_text.replaceAll("'/content", "'"+maindomain_lang+"/content");
                        
            document.getElementById("PAN_2021_NAV_ASYNC").innerHTML = nav_text.replaceAll('href="/', 'href="'+maindomain_lang+'/');

            var lozad_back = document.getElementsByClassName('lozad-background');
            Array.prototype.forEach.call(lozad_back, function(el) {
            // Do stuff here
            var el_back_img_path = el.getAttribute('data-background-image');
            var first_pos = el_back_img_path.indexOf("'");
            var last_pos = el_back_img_path.indexOf("'",first_pos+1);
            el_back_img_path = el_back_img_path.substring(first_pos+1,last_pos);
            el.setAttribute("data-background-image",main_site_url+el_back_img_path);
            });
            }
            if(req_type == 'head_inline_css'){
            addStyle(xmlhttp.responseText);
            }
        }
    }
    xmlhttp.open("GET", theUrl, true );
    xmlhttp.send();    
}    
    
if(referer == 'Prisma' || referer == 'Cortex' || referer == 'Sase' || referer == 'Unit' || referer == 'Ngfw'){
    const article = document.querySelector('#PAN_2021_NAV_ASYNC');
    if(referer == 'Prisma'){
        article.dataset.type = 'prisma';
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    else if(referer == 'Cortex'){
        article.dataset.type = 'cortex';
    }
    else if(referer == 'Sase'){
        article.dataset.type = 'sase';
    }
    else if(referer == 'Unit'){
        article.dataset.type = 'unit';
    }
    else if(referer == 'Ngfw'){
        article.dataset.type = 'ngfw';
    }
    //set class to default
    if(referer == 'Unit' || referer == 'Ngfw'){
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    callMainSitePrismaNavHTML();        
}
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->



<main class="main">
    <section class="section section--article">
        <div class="pa article-banner" style="background-image:url('https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/05_Cloud_cybersecurity_research_Overview_1920x900.jpg')">
          <div class="l-container"> 
            <div class="l-breadcrumbs"> 
              <ul> <li> <a href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:breadcrumb:Threat Research">Threat Research Center</a></li><li><a href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" title="Threat Research" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:breadcrumb:Threat Research">Threat Research</a></li><li class="is-current"><a href="https://unit42.paloaltonetworks.com/category/cloud-cybersecurity-research/" role="link" title="Cloud Cybersecurity Research" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:breadcrumb:Cloud Cybersecurity Research">Cloud Cybersecurity Research</a></li> </ul>
            </div>            <div class="ab__title">
              <a class="card-category" href="https://unit42.paloaltonetworks.com/category/cloud-cybersecurity-research/" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:Cloud Cybersecurity Research"><span class="ab-title__pre">Cloud Cybersecurity Research</span></a> 
              <h1>Dirty DAG: New Vulnerabilities in Azure Data Factory’s Apache Airflow Integration</h1>
              <div class="ab__video">
              <span class="duration"> 
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-clock.svg" alt="Clock Icon"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 15</span> <span class="rt-label rt-postfix"></span></span> min read              </span>
                              </div>          
              <div class="ab-lc__wrapper">
                <span class="ab-title__pre">Related Products</span><div class="ab__link-cards"><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/advanced-threat-prevention/" style="--card-color: #ffcb06" role="link" title="Advanced Threat Prevention" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:Advanced Threat Prevention"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Advanced Threat Prevention icon">Advanced Threat Prevention</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/advanced-wildfire/" style="--card-color: #ffcb06" role="link" title="Advanced WildFire" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:Advanced WildFire"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Advanced WildFire icon">Advanced WildFire</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cloud-delivered-security-services/" style="--card-color: #ffcb06" role="link" title="Cloud-Delivered Security Services" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:Cloud-Delivered Security Services"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Cloud-Delivered Security Services icon">Cloud-Delivered Security Services</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex/" style="--card-color: #00cc66" role="link" title="Cortex" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:Cortex"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex icon">Cortex</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex-xdr/" style="--card-color: #00cc66" role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:Cortex XDR"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex XDR icon">Cortex XDR</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex-xsiam/" style="--card-color: #00cc66" role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:Cortex XSIAM"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex XSIAM icon">Cortex XSIAM</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/next-generation-firewall/" style="--card-color: #ffcb06" role="link" title="Next-Generation Firewall" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:Next-Generation Firewall"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Next-Generation Firewall icon">Next-Generation Firewall</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/unit-42-incident-response/" style="--card-color: #c94727" role="link" title="Unit 42 Incident Response" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:Unit 42 Incident Response"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42_RGB_logo_Icon_Color.png" alt="Unit 42 Incident Response icon">Unit 42 Incident Response</a></div>              </div>
            </div>
          </div>
          <div class="ab__footer">
            <div class="l-container">
              <div class="ab__footer-wrapper">
                <ul class="ab__features" role="list">
                  <li role="listitem">
				 <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-profile-grey.svg" alt="Profile Icon">
					 <div class="ab__text"><span>By:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:Ofir Balassiano" href="https://unit42.paloaltonetworks.com/author/ofir-balassiano/">Ofir Balassiano</a></li><li><a data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:David Orlovsky" href="https://unit42.paloaltonetworks.com/author/david-orlovsky/">David Orlovsky</a></li></ul></div></li>                  <li role="listitem">
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-calendar-grey.svg" alt="Published Icon">
			<div class="ab__text"><span>Published:</span>December 16, 2024</div></li>					<li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-category.svg" alt="Tags Icon"><div class="ab__text"><span>Categories:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:Cloud Cybersecurity Research" href="https://unit42.paloaltonetworks.com/category/cloud-cybersecurity-research/">Cloud Cybersecurity Research</a></li><li><a data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:Threat Research" href="https://unit42.paloaltonetworks.com/category/threat-research/">Threat Research</a></li></ul></div>
		</li>                  <li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-tags-grey.svg" alt="Tags Icon"><div class="ab__text"><span>Tags:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:Apache Airflow" href="https://unit42.paloaltonetworks.com/tag/apache-airflow/">Apache Airflow</a></li><li><a data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:Containers" href="https://unit42.paloaltonetworks.com/tag/containers/">Containers</a></li><li><a data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:Kubernetes" href="https://unit42.paloaltonetworks.com/tag/kubernetes/">Kubernetes</a></li><li><a data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:Microsoft Azure" href="https://unit42.paloaltonetworks.com/tag/microsoft-azure/">Microsoft Azure</a></li><li><a data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:Microsoft Azure Data Factory" href="https://unit42.paloaltonetworks.com/tag/microsoft-azure-data-factory/">Microsoft Azure Data Factory</a></li></ul></div>
		</li>                </ul>
                <div class="ab__options">
                  <ul role="list">
                                        <li role="listitem"><a href="https://unit42.paloaltonetworks.com/azure-data-factory-apache-airflow-vulnerabilities/?pdf=download&#038;lg=en&#038;_wpnonce=1b4d4e8943" role="link" target="_blank"  title="Click here to download" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:pdfdownload"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-download.svg" alt="Download Icon"></a></li>
                    <li role="listitem"><a href="https://unit42.paloaltonetworks.com/azure-data-factory-apache-airflow-vulnerabilities/?pdf=print&#038;lg=en&#038;_wpnonce=1b4d4e8943" target="_blank" role="link" title="Click here to print" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:hero:pdfprint"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-print.svg" alt="Print Icon"></a></li>
                  </ul>
                  
	<div class="ab__share" id="shareDropdown" role="button" aria-expanded="false">
	<a href="#" role="link" title="Click here to share" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:share" class="">Share<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"></a><ul class="share-dropdown" role="menu">
				<li role="menuitem">
					<a href="#" class="copy-url" id="copyUrl" data-url="https://unit42.paloaltonetworks.com/azure-data-factory-apache-airflow-vulnerabilities/" role="link" title="Copy link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:share:link"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-share-link.svg" alt="Link Icon"></a>
				</li>
				<li role="menuitem">
					<a href="mailto:?subject=Dirty%20DAG:%20New%20Vulnerabilities%20in%20Azure%20Data%20Factory&rsquo;s%20Apache%20Airflow%20Integration&#038;body=Check%20out%20this%20article%20https%3A%2F%2Funit42.paloaltonetworks.com%2Fazure-data-factory-apache-airflow-vulnerabilities%2F" role="link" title="Share in email" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:share:email"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-sms.svg" alt="Link Email"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fazure-data-factory-apache-airflow-vulnerabilities%2F" target="_blank" role="link" title="Share in Facebook" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:share:facebook"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-fb-share.svg" alt="Facebook Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fazure-data-factory-apache-airflow-vulnerabilities%2F&#038;title=Dirty%20DAG:%20New%20Vulnerabilities%20in%20Azure%20Data%20Factory’s%20Apache%20Airflow%20Integration" target="_blank" role="link" title="Share in LinkedIn" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:share:linkedin"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-linkedin-share.svg" alt="LinkedIn Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fazure-data-factory-apache-airflow-vulnerabilities%2F&#038;text=Dirty%20DAG:%20New%20Vulnerabilities%20in%20Azure%20Data%20Factory&rsquo;s%20Apache%20Airflow%20Integration" target="_blank" role="link" title="Share in Twitter" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:share:twitter"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-twitter-share.svg" alt="Twitter Icon"></a>
				</li>
				<li role="menuitem">
					<a href="//www.reddit.com/submit?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fazure-data-factory-apache-airflow-vulnerabilities%2F" target="_blank" role="link" title="Share in Reddit" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:share:reddit"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-reddit-share.svg" alt="Reddit Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://mastodon.social/share?text=Dirty%20DAG:%20New%20Vulnerabilities%20in%20Azure%20Data%20Factory’s%20Apache%20Airflow%20Integration%20https%3A%2F%2Funit42.paloaltonetworks.com%2Fazure-data-factory-apache-airflow-vulnerabilities%2F" target="_blank" role="link" title="Share in Mastodon" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:share:mastodon"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-mastodon-share.svg" alt="Mastodon Icon"></a>
				</li>
	  </ul>
    </div>                </div>
              </div>
            </div>
          </div>
        </div>
      </section> 
    <section class="section blog-contents"> 
      <div class="pa blog-editor">
        <div class="l-container">
          <div class="be__wrapper">
            <div class="be__contents">
              <div class="be__contents-wrapper">
                <h2><a id="post-137792-_4lt92rr5muov"></a>Executive Summary</h2>
<p>Unit 42 researchers have discovered new security vulnerabilities in the Azure Data Factory Apache Airflow integration. Attackers can exploit these flaws by gaining unauthorized write permissions to a directed acyclic graph (DAG) file or using a compromised service principal.</p>
<p>While classified as low severity vulnerabilities by Microsoft, the risk still carries significant potential impact for organizations that use Azure Data Factory. The vulnerabilities can provide attackers with shadow admin control over Azure infrastructure, which could lead to data exfiltration, malware deployment and unauthorized data access.</p>
<p>Our research identified multiple vulnerabilities in the Azure Data Factory:</p>
<ul>
<li>Misconfigured Kubernetes RBAC in Airflow cluster</li>
<li>Misconfigured secret handling of the Azure’s internal Geneva service</li>
<li>Weak authentication for Geneva</li>
</ul>
<p>Exploiting these flaws could allow attackers to gain persistent access as shadow administrators over the entire Airflow Azure Kubernetes Service (AKS) cluster. This could enable malicious activities like data exfiltration, malware deployment or covert operations within the cluster.</p>
<p>Once inside, attackers can also manipulate Azure’s internal Geneva service, which is responsible for managing critical logs and metrics. This could allow attackers to potentially tamper with log data or access other sensitive Azure resources.</p>
<p>Although the cluster we used was isolated from other clusters, the fact that the managed Airflow instance used default, non-changeable configurations and the cluster admin role is attached to the Airflow runner caused a security issue. Attackers could manipulate this issue to control the Airflow cluster and related infrastructure.</p>
<p>Unit 42 researchers have shared these vulnerabilities with Azure. This issue highlights the importance of carefully managing service permissions to prevent unauthorized access. It also highlights the importance of monitoring the operations of critical third-party services to prevent such access.</p>
<p>In this article, we provide an overview of our findings and outline key mitigation strategies to help safeguard cloud environments from similar threats.</p>
<p>We will also examine Azure's internal Geneva service, which was used in an Airflow instance with write permissions to specific shared storage accounts. Figure 1 illustrates the Azure Data Factory Airflow infrastructure and the attack process.</p>
<figure id="attachment_137796" aria-describedby="caption-attachment-137796" style="width: 1000px" class="wp-caption alignnone"><img  class="wp-image-137796 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-407088-137792-1.jpeg" alt="Flowchart demonstrating a cybersecurity attack involving four steps: Step 1 shows pushing a malicious Dag; Step 2 depicts privilege escalation in a Kubernetes system; Step 3 involves data access in a PostgreSQL Server; and Step 4 outlines footprint masquerading in an Azure Tenant scenario." width="1000" height="627" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-407088-137792-1.jpeg 2048w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-407088-137792-1-702x440.jpeg 702w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-407088-137792-1-1117x700.jpeg 1117w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-407088-137792-1-768x482.jpeg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-407088-137792-1-1536x963.jpeg 1536w" sizes="(max-width: 1000px) 100vw, 1000px" /><figcaption id="caption-attachment-137796" class="wp-caption-text">Figure 1. Azure Data Factory and airflow cluster architecture overview.</figcaption></figure>
<p>Palo Alto Networks customers are better protected from the threats discussed in this article through the following products:</p>
<ul>
<li><a href="https://docs-cortex.paloaltonetworks.com/p/XDR" target="_blank" rel="noopener">Cortex XDR</a> and <a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam" target="_blank" rel="noopener">XSIAM</a></li>
<li><a href="https://docs.paloaltonetworks.com/advanced-wildfire" target="_blank" rel="noopener">Advanced WildFire</a></li>
<li><a href="https://docs.paloaltonetworks.com/ngfw" target="_blank" rel="noopener">Next-Generation Firewall</a> with the <a href="https://docs.paloaltonetworks.com/advanced-threat-prevention/administration" target="_blank" rel="noopener">Advanced Threat Prevention</a> security subscription</li>
</ul>
<p>If you think you might have been compromised or have an urgent matter, contact the <a href="https://start.paloaltonetworks.com/contact-unit42.html" target="_blank" rel="noopener">Unit 42 Incident Response team</a>.</p>
<table style="width: 100%;">
<thead>
<tr>
<td style="width: 35%;"><b>Related Unit 42 Topics</b></td>
<td style="width: 100%;"><a href="https://unit42.paloaltonetworks.com/tag/microsoft-azure/" target="_blank" rel="noopener"><b>Microsoft Azure</b></a>, <strong><a href="https://unit42.paloaltonetworks.com/tag/containers/" target="_blank" rel="noopener">Containers</a></strong></td>
</tr>
</thead>
</table>
<h2><a id="post-137792-_9r58j1jn5b9a"></a>Background: Azure Data Factory and Apache Airflow</h2>
<p>Before we delve into the intricacies of our research on Azure Data Factory and Apache Airflow, it's essential to be aware of the following fundamental concepts.</p>
<ul>
<li>Data Factory service
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/data-factory/" target="_blank" rel="noopener">Data Factory</a> is an Azure-based data integration service that enables users to manage data pipelines when moving data between different sources.</li>
</ul>
</li>
<li>Airflow service
<ul>
<li><a href="https://airflow.apache.org/" target="_blank" rel="noopener">Apache Airflow</a> is an open-source platform that facilitates the scheduling and orchestration of complex workflows. This enables users to manage and schedule tasks as Python-coded DAGs.</li>
</ul>
</li>
<li>Airflow DAG files
<ul>
<li>DAG files define the workflow structure as Python code. These files specify the sequence in which tasks should be executed, dependencies between tasks and scheduling rules.</li>
</ul>
</li>
<li>Azure Airflow integration with Data Factory
<ul>
<li>Azure Data Factory offers a <a href="https://learn.microsoft.com/en-us/azure/data-factory/concepts-workflow-orchestration-manager" target="_blank" rel="noopener">managed Airflow instance</a> integration that is deployed as an AKS cluster managed by Azure.</li>
</ul>
</li>
</ul>
<h2><a id="post-137792-_4guvh0vnnrut"></a>Gaining Initial Access to the Azure Data Factory Airflow Integration</h2>
<p>Here's a high-level overview of the flow of an initial attack scenario:</p>
<ul>
<li>Craft a DAG file that opens a reverse shell to a remote server and runs automatically when imported.</li>
<li>Upload the DAG file to a private GitHub repository connected to the Airflow cluster.</li>
</ul>
<p>Airflow imports and runs the DAG file automatically from the connected Git repository, opening a reverse shell on an Airflow worker. At this point, we gained cluster admin privileges due to a Kubernetes service account that was attached to an Airflow worker.</p>
<p>There are two ways for attackers to gain access to and tamper with DAG files:</p>
<ul>
<li>Gaining write permissions to the storage account containing DAG files by leveraging either a principal account with write permissions or a <a href="https://learn.microsoft.com/en-us/azure/storage/common/storage-sas-overview" target="_blank" rel="noopener">shared access signature (SAS)</a> token for the files. SAS tokens temporarily grant limited access to DAG files. Once a DAG file is tampered with, it lies dormant until the DAG files are imported by the victim.</li>
<li>Gaining access to a Git repository by leaked credentials or a misconfigured repository. Once this is obtained, the attacker creates a malicious DAG file or modifies an existing one and the directory containing the malicious DAG file is imported automatically.</li>
</ul>
<p>We chose to use leaked credentials from a Git repository as an attack scenario. In this case, once the attacker manipulates the compromised DAG file, Airflow executes it and the attacker gets a reverse shell.</p>
<p>For our research, we crafted a malicious DAG file (shown in Figure 2).</p>
<figure id="attachment_137798" aria-describedby="caption-attachment-137798" style="width: 497px" class="wp-caption alignnone"><img  class="wp-image-137798 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-410128-137792-2.png" alt="Screenshot of code including import statements and a DAG definition with a bash operator." width="497" height="279" /><figcaption id="caption-attachment-137798" class="wp-caption-text">Figure 2. Reverse shell DAG code.</figcaption></figure>
<p>The file ran automatically upon import (as shown in Figure 3) using the <span style="font-family: 'courier new', courier, monospace;">schedule_interval</span> and <span style="font-family: 'courier new', courier, monospace;">start_date</span> parameters. The file’s purpose was to run a task that initiates a reverse shell to an external server.</p>
<figure id="attachment_137800" aria-describedby="caption-attachment-137800" style="width: 900px" class="wp-caption alignnone"><img  class="wp-image-137800 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-413022-137792-3.png" alt="Screenshot of the Apache Airflow web interface displaying a list of DAGs (Directed Acyclic Graphs) with various statuses indicated by colored circles: green for success and red for failure. The screen shows options for triggering DAGs, refreshing the view, and filtering tasks." width="900" height="234" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-413022-137792-3.png 1889w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-413022-137792-3-786x204.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-413022-137792-3-768x200.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-413022-137792-3-1536x399.png 1536w" sizes="(max-width: 900px) 100vw, 900px" /><figcaption id="caption-attachment-137800" class="wp-caption-text">Figure 3. Airflow user interface (UI) showing current DAG files with details.</figcaption></figure>
<p>Upon running the DAG file, we received the reverse shell connection and could communicate with the instance. The shell we received was running under the context of the Airflow user in a Kubernetes pod shown in Figure 4, which had minimal permissions.</p>
<figure id="attachment_137802" aria-describedby="caption-attachment-137802" style="width: 163px" class="wp-caption alignnone"><img  class="wp-image-137802 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-415656-137792-4.png" alt="A computer screen displaying a command prompt where the command &quot;whoami&quot; has been typed and the response underneath is &quot;airflow&quot;. The text is in white with a black background." width="163" height="44" /><figcaption id="caption-attachment-137802" class="wp-caption-text">Figure 4. Whoami shows a non-root user.</figcaption></figure>
<p>However, the pod had public internet access as shown below in Figure 5.</p>
<figure id="attachment_137804" aria-describedby="caption-attachment-137804" style="width: 803px" class="wp-caption alignnone"><img  class="wp-image-137804 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-418116-137792-5.png" alt="Screenshot curl displaying various metrics such as DNS server IP address, download and upload speeds, total data spent, and current speed." width="803" height="91" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-418116-137792-5.png 803w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-418116-137792-5-786x89.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-418116-137792-5-768x87.png 768w" sizes="(max-width: 803px) 100vw, 803px" /><figcaption id="caption-attachment-137804" class="wp-caption-text">Figure 5. <span style="font-family: 'courier new', courier, monospace;">Curl</span> shows that we have public internet access.</figcaption></figure>
<p>While inspecting the pod, we discovered a secret, which was a service account token mounted into the pod file system. Due to the pod's network connectivity, this new access allowed us to download Kubectl (Kubernetes’ command-line tool) and to test our permissions as shown in Figure 6.</p>
<figure id="attachment_137806" aria-describedby="caption-attachment-137806" style="width: 575px" class="wp-caption alignnone"><img  class="wp-image-137806 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-420672-137792-6.png" alt="Terminal screen showing a command &#96;kubectl auth can-i --list&#96; with the output displaying permissions for Resources and Non-Resource URLs in Kubernetes." width="575" height="91" /><figcaption id="caption-attachment-137806" class="wp-caption-text">Figure 6. Worker pod shows Kubernetes cluster admin privileges.</figcaption></figure>
<p>We saw that the service account used by the pod had cluster admin permissions, giving us <strong>full control </strong>over the entire cluster. These permissions included creating pods, accessing Kubernetes secrets (shown in Figure 8) and creating new users. This allowed us to enumerate the cluster environments (shown in Figures 7 and 8) and to gain more insight on how Airflow was deployed.</p>
<figure id="attachment_137808" aria-describedby="caption-attachment-137808" style="width: 780px" class="wp-caption alignnone"><img  class="wp-image-137808 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-423047-137792-7.png" alt="Screenshot of a computer terminal displaying the output of the Kubernetes command &quot;kubectl get pods -A&quot;, listing several pods and their names. " width="780" height="243" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-423047-137792-7.png 780w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-423047-137792-7-768x239.png 768w" sizes="(max-width: 780px) 100vw, 780px" /><figcaption id="caption-attachment-137808" class="wp-caption-text">Figure 7. Pods inside the cluster.</figcaption></figure>
<figure id="attachment_137810" aria-describedby="caption-attachment-137810" style="width: 780px" class="wp-caption alignnone"><img  class="wp-image-137810 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-425386-137792-8.png" alt="Text-based screenshot depicting the output of a command-line operation to list Kubernetes secrets, showing columns for namespace, name, type, data, and age, with various entries under each heading." width="780" height="166" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-425386-137792-8.png 780w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-425386-137792-8-768x163.png 768w" sizes="(max-width: 780px) 100vw, 780px" /><figcaption id="caption-attachment-137810" class="wp-caption-text">Figure 8. Kubernetes cluster secrets relevant to Azure and Airflow.</figcaption></figure>
<p>We found secrets related to Airflow, such as the <a href="https://airflow.apache.org/docs/apache-airflow/stable/howto/set-up-database.html" target="_blank" rel="noopener">PostgreSQL</a> backend password and TLS certificates to the Airflow domain. Additionally, we observed an API key to an exposed storage account containing DAG files, shown in Figure 9.</p>
<figure id="attachment_137812" aria-describedby="caption-attachment-137812" style="width: 314px" class="wp-caption alignnone"><img  class="wp-image-137812 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-428163-137792-9.png" alt="A terminal screen showing the output of the command &#96;kubectl get secret&#96;, displaying an output snippet including API version and data keys for Azure storage account and a web server secret." width="314" height="120" /><figcaption id="caption-attachment-137812" class="wp-caption-text">Figure 9. Showing secrets that are stored in the cluster.</figcaption></figure>
<p>Microsoft’s response to the underlying security issue that we reported was to underscore that “the above is isolated to the researcher's cluster alone.”</p>
<p>Although the cluster is isolated from other clusters, the fact that the managed airflow instance used default, non-changeable configurations and the cluster admin role is attached to the Airflow runner caused a security issue. Attackers could manipulate this issue to control the Airflow cluster and related infrastructure.</p>
<p>When enumerating the cluster resources, we understood that a single tenant deployment and the cluster are available only to us. However, to exhaust our options, we further enumerated the cluster and primarily found Airflow pods such as the server backend and web UI, as well as some pods labeled <span style="font-family: 'courier new', courier, monospace;">geneva-services</span>. We will delve into the meaning of this label further in a later section (<a href="#post-137792-_tb3lf9qfml6">Exploiting Geneva – Azure Internal Service)</a> to explore the potential impact.</p>
<h2><a id="post-137792-_vqg2qau1azko"></a>Container Escape: AKS Gaining Access to Host</h2>
<p>Once we had cluster admin permissions, we could perform <a href="https://unit42.paloaltonetworks.com/kubernetes-privilege-escalation/" target="_blank" rel="noopener">escalation and cluster takeover</a> by deploying a privileged pod and breaking out onto the underlying node as shown in Figure 10. The privileged pod had shared host resources and the host’s root file system as a mounted volume.</p>
<figure id="attachment_137865" aria-describedby="caption-attachment-137865" style="width: 550px" class="wp-caption alignnone"><img  class="wp-image-137865 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/F10.png" alt="Command line interface displaying Kubernetes commands for a privileged pod test and entering a new root directory." width="550" height="80" /><figcaption id="caption-attachment-137865" class="wp-caption-text">Figure 10. Accessing the host disk with a privileged pod.</figcaption></figure>
<p>At this point, we gained access to the host virtual machine (VM) with <strong>root access.</strong></p>
<p>From the <span style="font-family: 'courier new', courier, monospace;">uname</span> command output (shown in Figure 11), we understood that we were running in the scope of a VM scale set (Azure VM scaling solution), and that the Airflow cluster was running on top of that.</p>
<figure id="attachment_137816" aria-describedby="caption-attachment-137816" style="width: 550px" class="wp-caption alignnone"><img  class="wp-image-137816 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-433365-137792-11.png" alt="A command line interface displaying a Linux kernel version, the text indicates it's running on Microsoft Azure, with specific version and build details." width="550" height="47" /><figcaption id="caption-attachment-137816" class="wp-caption-text">Figure 11. <span style="font-family: 'courier new', courier, monospace;">Uname</span> command revealed information about a host.</figcaption></figure>
<p>Figure 12 depicts the container breakout flow.</p>
<figure id="attachment_137818" aria-describedby="caption-attachment-137818" style="width: 1000px" class="wp-caption alignnone"><img  class="wp-image-137818 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-435825-137792-12.png" alt="Flowchart depicting a cybersecurity attack using containers and pods. From left to right: &quot;Malicious DAG&quot; symbol leads to &quot;Run DAG,&quot; which connects to &quot;Create Pod.&quot; This flows into a symbol labeled &quot;Privileged Pod,&quot; then to &quot;Chroot Host,&quot; and culminates with &quot;Host Takeover.&quot; The symbols are connected by arrows indicating sequence." width="1000" height="367" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-435825-137792-12.png 2048w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-435825-137792-12-786x289.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-435825-137792-12-1906x700.png 1906w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-435825-137792-12-768x282.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-435825-137792-12-1536x564.png 1536w" sizes="(max-width: 1000px) 100vw, 1000px" /><figcaption id="caption-attachment-137818" class="wp-caption-text">Figure 12. Chain of events leading to host takeover.</figcaption></figure>
<h3><a id="post-137792-_cvjohe96i1yz"></a>Full Cluster Control Impact</h3>
<p>Having a high-privileged service account connected to the Airflow runner pod enables control to the node itself and presents attackers with multiple opportunities to extend their actions. Here are two examples of such opportunities:</p>
<ul>
<li><strong>Shadow workloads through shadow administrator access:</strong> An attacker could create another service account role with cluster admin privileges. The account could have full access to create pods and other resources inside the cluster that could cause damage, such as creating pods that serve malware or cryptomining without the victims’ awareness. Figure 13 illustrates such a scenario.</li>
</ul>
<figure id="attachment_137820" aria-describedby="caption-attachment-137820" style="width: 884px" class="wp-caption alignnone"><img  class="wp-image-137820 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-439196-137792-13.png" alt="Diagram of an Airflow AKS Cluster showing various nodes. The nodes are labeled as Cluster Admin, Airflow-1, Airflow-2, Airflow-3, Attacker Cluster Admin, Malicious Workload, and Crypto Miner. Each node type is represented in either blue or red, with distinct icons for administrative and operational roles." width="884" height="639" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-439196-137792-13.png 884w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-439196-137792-13-609x440.png 609w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-439196-137792-13-768x555.png 768w" sizes="(max-width: 884px) 100vw, 884px" /><figcaption id="caption-attachment-137820" class="wp-caption-text">Figure 13. An attacker can covertly take over the cluster and steal data sources from Airflow.</figcaption></figure>
<ul>
<li><strong>Data exfiltration:</strong> The attacker could gain persistence in the cluster through workload creation, actively leaking data that is connected to the Airflow environment over time as shown in Figure 14. Due to the level of access, the attacker could obtain credential information related to current and future data sources connected to the Airflow environment, such as storage accounts and SQL servers.
<p><figure id="attachment_137822" aria-describedby="caption-attachment-137822" style="width: 884px" class="wp-caption alignnone"><img  class="wp-image-137822 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-442137-137792-14.png" alt="Diagram showing an Airflow AKS Cluster with components: Cluster Admin, Cluster Secrets, Airflow-Backend, and their connection to Data Sources, which are being hijacked by an attacker cluster admin. " width="884" height="639" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-442137-137792-14.png 884w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-442137-137792-14-609x440.png 609w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-442137-137792-14-768x555.png 768w" sizes="(max-width: 884px) 100vw, 884px" /><figcaption id="caption-attachment-137822" class="wp-caption-text">Figure 14. An attacker can hijack the cluster for malicious uses.</figcaption></figure></li>
</ul>
<h2><a id="post-137792-_78lkhj3e8gq"></a>Discovering Assets in the New Azure Environment</h2>
<h3><a id="post-137792-_vffaqg51j55r"></a>From Root to Azure Identity</h3>
<p>After getting root access on the host, we were able to start with the discovery process of our new environment. First, we used the Instance Metadata Service (IMDS) endpoint to grab the machine authentication token.</p>
<p>The IMDS endpoint provides information about currently running virtual machine (VM) instances. This can be used to manage and configure VMs, including getting an authentication token for managed identities assigned to the VM. IMDS is accessed via an exposed endpoint only from the machine itself.</p>
<h4><a id="post-137792-_j08yhhbt0wqe"></a>WireServer</h4>
<p>Azure’s WireServer is another endpoint that can be accessed from within any Azure VM that in some scenarios exposes sensitive metadata and configuration information. WireServer facilitates communication between Azure VMs and the Azure environment. It does so by enabling the delivery of configuration information and management tasks from Azure to the VMs, ensuring that they operate in accordance with the user's specifications and Azure's infrastructure requirements.</p>
<p>The WireServer is accessed via an HTTP endpoint, which uses the IP address <span style="font-family: 'courier new', courier, monospace;"><a href="https://learn.microsoft.com/en-us/azure/virtual-network/what-is-ip-address-168-63-129-16" target="_blank" rel="noopener">168.63.129[.]16</a></span><strong>. </strong>This endpoint can be queried to retrieve information about VM extensions and sensitive data. By using the IMDS and WireServer endpoints, we discovered that two managed identities were connected to the Virtual Machine Scale Set (VMSS), a group of load-balanced VMs.</p>
<p>We used the WireServer to obtain further information regarding the instance.</p>
<p>The following activities formed our high-level workflow:</p>
<ul>
<li>Querying the WireServer endpoint to discover managed identities</li>
<li>Querying IMDS to get an access token for each identity</li>
<li>Enumerating the Azure environment</li>
<li>Querying the <span style="font-family: 'courier new', courier, monospace;">Microsoft.Authorization/roleAssignments</span> API call to discover custom roles</li>
</ul>
<p>First, we queried the WireServer endpoint to see VM extension information and general information with the command shown in Figure 15.</p>
<figure id="attachment_137868" aria-describedby="caption-attachment-137868" style="width: 624px" class="wp-caption alignnone"><img  class="size-full wp-image-137868 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/F15.png" alt="Terminal screenshot displaying a curl command with user-agent and version specified in the command." width="624" height="58" /><figcaption id="caption-attachment-137868" class="wp-caption-text">Figure 15. WireServer API call.</figcaption></figure>
<p>From this query, we got the following output shown in Figure 16. The output shows the virtual machine state, different configurations and information that can be gathered about the machine.</p>
<figure id="attachment_137870" aria-describedby="caption-attachment-137870" style="width: 592px" class="wp-caption alignnone"><img  class="size-full wp-image-137870 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/F16.png" alt="Screenshot of a computer screen displaying code. The text includes elements like machine details, host information, and IP addresses. Some of the information has been redacted. " width="592" height="431" /><figcaption id="caption-attachment-137870" class="wp-caption-text">Figure 16. WireServer API output.</figcaption></figure>
<p>After that, we did the same for the extension endpoint shown in Figure 17, with the following command:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">hXXp://168.63.129[.]16:80/machine/&lt;REDACTED&gt;-6f7490f0cc7b/&lt;REDACTED&gt;-ab78-81795f77ad10._aks-agentpool-30850510-vmss_2?comp=config;type=extensionsConfig;incarnation=2</span></li>
</ul>
<p>We received the response shown in Figure 17.</p>
<figure id="attachment_137872" aria-describedby="caption-attachment-137872" style="width: 624px" class="wp-caption alignnone"><img  class="wp-image-137872 size-full lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/F17.png" alt="Screenshot of code with highlighted sections indicating the &quot;ClientId&quot; and &quot;TenantID&quot; values. Two lines are highlighted in green and two in red. " width="624" height="510" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/F17.png 624w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/F17-538x440.png 538w" sizes="(max-width: 624px) 100vw, 624px" /><figcaption id="caption-attachment-137872" class="wp-caption-text">Figure 17. WireServer VM identity information.</figcaption></figure>
<p>We can see two user-assigned managed identities that are created for the cluster:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">httpapplicationrouting-&lt;CLIENT TENANTID&gt;</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">&lt;CLIENT TENANTID&gt;-agentpool</span></li>
</ul>
<p>For each identity, there is an attached attribute <span style="font-family: 'courier new', courier, monospace;">IdentityClientId</span> that is used when querying the IMDS endpoint to obtain its relevant access token. Figure 18 depicts how to query the IMDS endpoint for a specific user-assigned managed identity token.<em><img width="1" height="1"  class="wp-image-137830 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-452007-137792-18.png" /></em></p>
<figure id="attachment_137874" aria-describedby="caption-attachment-137874" style="width: 600px" class="wp-caption alignnone"><img  class="wp-image-137874 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/F18.png" alt="Screenshot of a command line interface using a curl request to the Azure API, including parameters for identity, client ID, resource URL, and metadata settings." width="600" height="122" /><figcaption id="caption-attachment-137874" class="wp-caption-text">Figure 18. IMDS API call to retrieve specific managed identity credentials.</figcaption></figure>
<p>From our query, we received the token shown in Figure 19.</p>
<figure id="attachment_137876" aria-describedby="caption-attachment-137876" style="width: 600px" class="wp-caption alignnone"><img  class="wp-image-137876 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/F19.png" alt="Code snippet displaying an access token response from Microsoft Azure, including keys for client ID, expiration times, and token type." width="600" height="257" /><figcaption id="caption-attachment-137876" class="wp-caption-text">Figure 19. Azure access token for relevant identity.</figcaption></figure>
<h3><a id="post-137792-_azhzybm4jr6t"></a>The Discovery Process in the New Azure Environment</h3>
<p>At this point, we started analyzing the Azure subscription we were running on by using the new identity tokens. We found some resources we could access, and by enumerating them in the environment, we could better understand our options.</p>
<p>A dedicated resource group for each Airflow deployment is created when the AKS is deployed. A special HTTP application-routing add-on for Kubernetes is added that can create records in the DNS zone resource and enable network routing to the AKS instance. This add-on will soon be retired and it is not suitable for production usage, as described in this article on <a href="https://azure.github.io/PSRule.Rules.Azure/en/rules/Azure.AKS.HttpAppRouting/" target="_blank" rel="noopener">Azure.AKS.HTTPAppRouting</a>.</p>
<p>The add-on creates the <span style="font-family: 'courier new', courier, monospace;">HTTPApplicationRouting</span> identity with a <span style="font-family: 'courier new', courier, monospace;">Reader</span> role (shown in Figure 20) over the resource group and a <span style="font-family: 'courier new', courier, monospace;">Contributor</span> role over the DNS zone, which enabled us to modify the DNS service attached to the cluster.</p>
<figure id="attachment_137834" aria-describedby="caption-attachment-137834" style="width: 1000px" class="wp-caption alignnone"><img  class="wp-image-137834 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-457029-137792-20.jpeg" alt="Diagram showing a Microsoft Azure internal subscription, including an HTTPApplicationRouting Managed Zone connected to a Unique Client Resource Group and a VM scale set with several virtual machines labeled VM1 through VMN within an AKS cluster environment. The layout includes icons representing network structures and text annotations that explain the roles and components of the Azure services." width="1000" height="680" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-457029-137792-20.jpeg 2048w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-457029-137792-20-647x440.jpeg 647w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-457029-137792-20-1029x700.jpeg 1029w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-457029-137792-20-768x522.jpeg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-457029-137792-20-1536x1045.jpeg 1536w" sizes="(max-width: 1000px) 100vw, 1000px" /><figcaption id="caption-attachment-137834" class="wp-caption-text">Figure 20. Cloud infrastructure topology of Airflow deployment.</figcaption></figure>
<p>At this point, several Azure-managed resources were accessible to us. Initially, this was just the storage account where the DAG files were imported and the DNS zone to which we had contributor access and could modify records.</p>
<p>Additionally, custom role definitions inside Azure’s tenant with the keyword <span style="font-family: 'courier new', courier, monospace;">Geneva</span> (shown in Figure 21) caught our eye. This was notable because the cluster had pods labeled <span style="font-family: 'courier new', courier, monospace;">geneva-service-xxxx</span> (shown previously in Figure 7).</p>
<figure id="attachment_137836" aria-describedby="caption-attachment-137836" style="width: 748px" class="wp-caption alignnone"><img  class="wp-image-137836 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-460028-137792-21.png" alt="Screenshot of a configuration file for Azure role-based access control, including definitions for role permissions and descriptions." width="748" height="877" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-460028-137792-21.png 748w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-460028-137792-21-375x440.png 375w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-460028-137792-21-597x700.png 597w" sizes="(max-width: 748px) 100vw, 748px" /><figcaption id="caption-attachment-137836" class="wp-caption-text">Figure 21. Custom roles regarding Geneva, each with different permissions.</figcaption></figure>
<p>The role definitions prompted questions about the nature of these pods, as well as the purpose of Geneva and its application.</p>
<p>When we inspected the role’s permissions, it showed us what type of capabilities Geneva could have. We found that it was able to manage multiple types of Azure resources, such as event hubs, subscription management and storage.</p>
<p>Permissions such as <span style="font-family: 'courier new', courier, monospace;">Microsoft.Storage/storageAccounts/listKeys/action</span> or <span style="font-family: 'courier new', courier, monospace;">Microsoft.Resources/subscriptions/read</span> and <span style="font-family: 'courier new', courier, monospace;">Microsoft.EventHub/register/action</span> (which is used to register an EventHub provider) show Geneva’s potential capabilities.</p>
<p>These high-privileged custom roles led us to inspect the pods in our cluster and their runtime behavior.</p>
<p>Disclosing internal role definition information and enumerating the cluster’s cloud environment could help attackers better understand what they can and can’t do. Furthermore, attackers could use the access tokens to modify the DNS zone resource and access storage accounts related to Airflow.</p>
<h2><a id="post-137792-_tb3lf9qfml6"></a>Exploiting Geneva – Azure Internal Service</h2>
<p>Upon encountering Azure resources and pods regarding Geneva in our cluster, we assumed Geneva was related to gathering analytics data. We wanted to explore this to better understand this internal Azure system. Figure 22 shows which pods were in the AKS cluster.</p>
<figure id="attachment_137878" aria-describedby="caption-attachment-137878" style="width: 221px" class="wp-caption alignnone"><img  class="wp-image-137878 size-full lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/F22.png" alt="Text displaying three lines of code, each beginning with &quot;geneva-services&quot; followed by a unique suffix: cw98t, dz6jc, pjd9h." width="221" height="66" /><figcaption id="caption-attachment-137878" class="wp-caption-text">Figure 22. Geneva pods in the Airflow cluster.</figcaption></figure>
<p>Geneva service is an internal Azure service that monitors and gathers analytical data from Microsoft’s infrastructure on a large scale. The impact of any security misconfigurations in this service can be detrimental.</p>
<p>There isn’t much information online about Geneva, other than on a small number of Microsoft forums for in-house developers. As such, we started analyzing the runtime behavior of the pods to gain a better understanding of the service.</p>
<p>The following activities formed our high-level workflow:</p>
<ul>
<li>Inspecting Geneva pods and the attached secrets in our cluster</li>
<li>Performing a runtime and static analysis of pods, as well as the certificate and key in the secrets</li>
<li>Discovering internal API endpoints used by pods</li>
<li>Leveraging the API endpoints to disclose multiple Azure resources</li>
<li>Exploiting read/write privileges on multi-tenant shared resources</li>
</ul>
<h3><a id="post-137792-_gmtbciwiaw20"></a>Geneva Service Pod Inspection</h3>
<p>Inspecting the pods revealed that they used the secrets <span style="font-family: 'courier new', courier, monospace;">azsecpack-auth</span><strong>, </strong><span style="font-family: 'courier new', courier, monospace;">mdm-authandmdsm-auth</span> (shown in Figure 23).</p>
<figure id="attachment_137840" aria-describedby="caption-attachment-137840" style="width: 995px" class="wp-caption alignnone"><img  class="wp-image-137840 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-465270-137792-23.png" alt="Text-based screenshot depicting the output of a command-line operation to list Kubernetes secrets, showing columns for namespace, name, type, data, and age, with various entries under each heading." width="995" height="213" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-465270-137792-23.png 995w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-465270-137792-23-786x168.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-465270-137792-23-768x164.png 768w" sizes="(max-width: 995px) 100vw, 995px" /><figcaption id="caption-attachment-137840" class="wp-caption-text">Figure 23. Secret list inside the cluster. Note the <span style="font-family: 'courier new', courier, monospace;">auth</span> secrets.</figcaption></figure>
<p>We saw processes inside the pod that ran the Azure <span style="font-family: 'courier new', courier, monospace;">mdsd</span> monitoring agent (shown in Figure 24).</p>
<figure id="attachment_137842" aria-describedby="caption-attachment-137842" style="width: 888px" class="wp-caption alignnone"><img  class="wp-image-137842 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-467735-137792-24.png" alt="A screenshot of a terminal with a process list, displayed using the &quot;ps ef&quot; command. The list includes columns for UID, PID, PPID, start time, and more. " width="888" height="127" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-467735-137792-24.png 888w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-467735-137792-24-786x112.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-467735-137792-24-768x110.png 768w" sizes="(max-width: 888px) 100vw, 888px" /><figcaption id="caption-attachment-137842" class="wp-caption-text">Figure 24. Geneva service pods running processes.</figcaption></figure>
<p>At this point, we assumed that the <span style="font-family: 'courier new', courier, monospace;">mdsd</span> agent collects metrics such as cluster health, pod status and current live processes. It then sends them to the Geneva service.</p>
<p>Moreover, a binary that we found related to <span style="font-family: 'courier new', courier, monospace;">mdsd</span> used a certificate and a key as a type of authentication. Figure 25 shows the different flags the binary used.</p>
<figure id="attachment_137844" aria-describedby="caption-attachment-137844" style="width: 947px" class="wp-caption alignnone"><img  class="wp-image-137844 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-470440-137792-25.png" alt="A screenshot of a command-line interface displaying a list of allowed arguments for a utility, which includes commands related to help, monitoring environment, namespace, identity type, and configuration among others, with specific examples provided at the bottom." width="947" height="345" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-470440-137792-25.png 947w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-470440-137792-25-786x286.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-470440-137792-25-768x280.png 768w" sizes="(max-width: 947px) 100vw, 947px" /><figcaption id="caption-attachment-137844" class="wp-caption-text">Figure 25. Non-standard <span style="font-family: 'courier new', courier, monospace;">mdsd</span> utility binary in the pod that is used for debugging.</figcaption></figure>
<p>The <span style="font-family: 'courier new', courier, monospace;">azsecpack-auth</span>, <span style="font-family: 'courier new', courier, monospace;">mdm-auth</span> and <span style="font-family: 'courier new', courier, monospace;">mdsm-auth</span> secrets contained a certificate and a private key shown in Figure 26.<img width="1" height="1"  class="wp-image-137846 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-472897-137792-26.png" /></p>
<figure id="attachment_137880" aria-describedby="caption-attachment-137880" style="width: 400px" class="wp-caption alignnone"><img  class="wp-image-137880 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/F26.png" alt="A screenshot displaying commands and outputs on a computer terminal, including interactions with Kubernetes showing secret management commands. The visible text features keys and metadata. " width="400" height="664" /><figcaption id="caption-attachment-137880" class="wp-caption-text">Figure 26. Certificate that was stored as a secret in the Airflow cluster.</figcaption></figure>
<p>Using the OpenSSL command-line interface (CLI), we inspected the certificate with the following command:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">openssl x509 -in certificate.crt -text -noout</span></li>
</ul>
<p>Figure 27 shows the details we received.</p>
<figure id="attachment_137882" aria-describedby="caption-attachment-137882" style="width: 468px" class="wp-caption alignnone"><img  class="size-full wp-image-137882 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/F27.png" alt="Screenshot of a digital certificate displaying various encryption and authentication details including serial number, issuer, validity dates, and other security algorithms. Some information is redacted. " width="468" height="420" /><figcaption id="caption-attachment-137882" class="wp-caption-text">Figure 27. OpenSSL information about certificate identity.</figcaption></figure>
<p>The decoded certificate in Figure 27 above shows that the subject CN (which is the domain name protected by the certificate) was <span style="font-family: 'courier new', courier, monospace;">gcs.svc.datafactory.azure.com</span>. When we inspected the same secrets in other Airflow deployments, we saw the same subject CN used across all deployments.</p>
<p>In addition, all Airflow deployments use the same certificate to authenticate to the Geneva service. There is no separation between different Airflow deployments.</p>
<h3><a id="post-137792-_ktztzljoklio"></a>Discovering Internal API Endpoints</h3>
<p>At this point, we wanted to better understand Geneva’s mechanism through the <span style="font-family: 'courier new', courier, monospace;">mdsd</span> binary. We reverse engineered the binaries to reveal multiple API endpoints that <span style="font-family: 'courier new', courier, monospace;">mdsd</span> monitoring agents used to communicate with Geneva. Figures 28 and Figure 29 show snippets from the reverse engineering process.</p>
<figure id="attachment_137850" aria-describedby="caption-attachment-137850" style="width: 864px" class="wp-caption alignnone"><img  class="wp-image-137850 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-478259-137792-28.png" alt="Screenshot of a computer screen displaying various lines of coding and configuration paths related to a monitoring account, which are highlighted in red boxes. " width="864" height="311" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-478259-137792-28.png 864w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-478259-137792-28-786x283.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-478259-137792-28-768x276.png 768w" sizes="(max-width: 864px) 100vw, 864px" /><figcaption id="caption-attachment-137850" class="wp-caption-text">Figure 28. API endpoints in binary strings.</figcaption></figure>
<figure id="attachment_137852" aria-describedby="caption-attachment-137852" style="width: 819px" class="wp-caption alignnone"><img  class="wp-image-137852 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-480883-137792-29.png" alt="A screenshot of code from a computer program displayed in color-coded text on a black background. One line in the upper section is highlighted in red. " width="819" height="472" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-480883-137792-29.png 819w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-480883-137792-29-763x440.png 763w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-480883-137792-29-768x443.png 768w" sizes="(max-width: 819px) 100vw, 819px" /><figcaption id="caption-attachment-137852" class="wp-caption-text">Figure 29. REST API URL construction inside binary.</figcaption></figure>
<p>In the reverse engineering process, we were able to reconstruct API calls to Geneva. And by using the certificate and key that we found earlier, we could authenticate to Geneva and call the API endpoints that we had found.</p>
<p>The API endpoints we found disclosed more Azure resources. Some gave us write access to storage accounts, event hubs and other internal Azure systems.</p>
<p>Figure 30 illustrates the access level we achieved.</p>
<figure id="attachment_137854" aria-describedby="caption-attachment-137854" style="width: 1000px" class="wp-caption alignnone"><img  class="wp-image-137854 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-483710-137792-30.jpeg" alt="Illustration of a data involving an Airflow cluster named Geneva, which interacts with Databricks Hub and Storage Accounts through read and write operations using HTTP Rest and Geneva services." width="1000" height="517" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-483710-137792-30.jpeg 2048w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-483710-137792-30-786x406.jpeg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-483710-137792-30-1354x700.jpeg 1354w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-483710-137792-30-768x397.jpeg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/word-image-483710-137792-30-1536x794.jpeg 1536w" sizes="(max-width: 1000px) 100vw, 1000px" /><figcaption id="caption-attachment-137854" class="wp-caption-text">Figure 30. Geneva service in our cluster with access to different Azure resources.</figcaption></figure>
<h2><a id="post-137792-_pb0klmy22wk2"></a>Geneva's Aftermath: The Impact on Azure’s Ecosystem</h2>
<h3><a id="post-137792-_b5rzlgxqk51l"></a>Internal Data Assets Exposed</h3>
<p>Using the above endpoints and keys, we found multiple SAS tokens for data assets.<br />
Figures 31 and 32 show examples of the tokens we found.</p>
<figure id="attachment_137885" aria-describedby="caption-attachment-137885" style="width: 624px" class="wp-caption alignnone"><img  class="size-full wp-image-137885 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/F31.png" alt="Screenshot of code with highlighted sections showing resource names as &quot;BlobService&quot; and &quot;TableService.&quot; Some information has been redacted. " width="624" height="192" /><figcaption id="caption-attachment-137885" class="wp-caption-text">Figure 31. Storage accounts keys found.</figcaption></figure>
<figure id="attachment_137887" aria-describedby="caption-attachment-137887" style="width: 624px" class="wp-caption alignnone"><img  class="size-full wp-image-137887 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/F32.png" alt="Screenshot of a code snippet with some redacted text, mentioning URLs related to 'onedrive.windows.net', and showing key-value pairs for data fields including 'Session' and 'IPAddress'." width="624" height="100" /><figcaption id="caption-attachment-137887" class="wp-caption-text">Figure 32. Event hub keys found.</figcaption></figure>
<p>We also found we weren’t restricted in writing to the datastores.</p>
<p>Another notable API call we found disclosed entities such as users or machines that had access to Geneva (shown in Figure 33).</p>
<figure id="attachment_137889" aria-describedby="caption-attachment-137889" style="width: 624px" class="wp-caption alignnone"><img  class="size-full wp-image-137889 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/F33.png" alt="A screenshot displaying code related to Microsoft Cloud permissions configuration. The repeated line of text includes references to identity, metrics, and user permissions within the Microsoft ecosystem. Some info is redacted. " width="624" height="257" /><figcaption id="caption-attachment-137889" class="wp-caption-text">Figure 33. Information disclosed by an API regarding identities that use Geneva.</figcaption></figure>
<h3><a id="post-137792-_zgvdckszzhak"></a>Log Manipulation Attack Scenario</h3>
<p>By using the exposed SAS tokens for the event hubs, we could exploit and write arbitrary information to them. This means a sophisticated attacker could modify a vulnerable Airflow environment.</p>
<p>For example, an attacker could create new pods and new service accounts. They could also apply changes to the cluster nodes themselves and then send fake logs to Geneva without raising an alarm.</p>
<p>We used the code shown in Figure 34 to demonstrate this.</p>
<figure id="attachment_137891" aria-describedby="caption-attachment-137891" style="width: 624px" class="wp-caption alignnone"><img  class="size-full wp-image-137891 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/F34.png" alt="A screenshot of code in a text editor. Specific AWS services are visible. The code includes function definitions, event handling, and print statements, all written on a dark themed background." width="624" height="256" /><figcaption id="caption-attachment-137891" class="wp-caption-text">Figure 34. Proof of concept code that demonstrated the impact of generating and sending crafted logs to Azure’s central log service.</figcaption></figure>
<h2><a id="post-137792-_8a7c04fzr8o8"></a>Conclusion</h2>
<p>Our research identified multiple vulnerabilities in the Azure Data Factory:</p>
<ul>
<li>Misconfigured Kubernetes RBAC in Airflow cluster</li>
<li>Misconfigured secret handling of the Geneva service</li>
<li>Weak authentication for Geneva</li>
</ul>
<p>These vulnerabilities could enable attackers to escape from their pods, gain unauthorized administrative control over clusters and access Azure's internal services (Geneva). Attackers could exploit the vulnerabilities through compromised service principals or unauthorized modifications to DAG files. This could enable attackers to become shadow administrators and to gain full control over managed Airflow deployments on a single tenant base.</p>
<p>We would like to thank Microsoft MSRC for helping to resolve these issues.</p>
<p>Adversaries have moved beyond basic tactics to more sophisticated service-specific attacks. Therefore, it is essential to adopt a comprehensive protection strategy that goes beyond simply safeguarding the cluster's perimeter.</p>
<p>This strategy should include:</p>
<ul>
<li>Securing permissions and configurations within the environment itself, and using policy and audit engines to help detect and prevent future incidents (both within the cluster and in the cloud)</li>
<li>Safeguarding sensitive data assets that interact with different services in the cloud, to understand which data is being processed with which data service</li>
</ul>
<p>Palo Alto Networks customers are better protected from the threats discussed above through the following products:</p>
<ul>
<li><a href="https://www.paloaltonetworks.com/products/secure-the-network/wildfire" target="_blank" rel="noopener">Advanced WildFire</a> cloud-delivered malware analysis service accurately identifies known samples as malicious</li>
<li><a href="https://docs.paloaltonetworks.com/ngfw" target="_blank" rel="noopener">Next-Generation Firewall</a> with the <a href="https://docs.paloaltonetworks.com/advanced-threat-prevention/administration" target="_blank" rel="noopener">Advanced Threat Prevention</a> security subscription can help block the attacks with best practices via the following Threat Prevention signature: <a href="https://threatvault.paloaltonetworks.com/?query=54790" target="_blank" rel="noopener">54790</a></li>
<li><a href="https://docs-cortex.paloaltonetworks.com/p/XDR" target="_blank" rel="noopener">Cortex XDR</a> and <a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam" target="_blank" rel="noopener">XSIAM</a> offer protections relevant to the threat described such as through the reverse shell module for Behavioral Threat Protection.</li>
</ul>
<p>If you think you may have been compromised or have an urgent matter, get in touch with the<a href="https://start.paloaltonetworks.com/contact-unit42.html" target="_blank" rel="noopener"> Unit 42 Incident Response team</a> or call:</p>
<ul>
<li>North America Toll-Free: 866.486.4842 (866.4.UNIT42)</li>
<li>EMEA: +31.20.299.3130</li>
<li>APAC: +65.6983.8730</li>
<li>Japan: +81.50.1790.0200</li>
</ul>
<p>Palo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about the <a href="https://www.cyberthreatalliance.org" target="_blank" rel="noopener">Cyber Threat Alliance</a>.</p>
      
              </div>
              <!--<span class="post__date">Updated 16 December, 2024 at 11:52 AM PST</span>-->
              <button class="l-btn back-to-top" id="backToTop" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:back to top">Back to top</button>
              
			<div class="be__tags-wrapper"> 
				<h3>Tags</h3><ul role="list"><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/apache-airflow/" role="link" title="Apache Airflow" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:tags:Apache Airflow">Apache Airflow</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/containers/" role="link" title="Containers" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:tags:Containers">Containers</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/kubernetes/" role="link" title="Kubernetes" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:tags:Kubernetes">Kubernetes</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/microsoft-azure/" role="link" title="Microsoft Azure" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:tags:Microsoft Azure">Microsoft Azure</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/microsoft-azure-data-factory/" role="link" title="Microsoft Azure Data Factory" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:tags:Microsoft Azure Data Factory">Microsoft Azure Data Factory</a></li></ul>
			</div> 
              <div class="be__post-nav">
    <a class="prev" href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:article-nav:Threat Research Center"> 
        <span>Threat Research Center</span>
    </a>
            <a class="next" href="https://unit42.paloaltonetworks.com/packer-as-a-service-heartcrypt-malware/" role="link" title="Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:article-nav:Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation"> 
            <span>Next: Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation</span>
        </a>
    </div>
 
            </div>
            <div class="be__nav">
            <div class="be__nav-wrapper">
      <div class="be-table-of-contents" data-toc-track="azure-data-factory-apache-airflow-vulnerabilities:sidebar:table-of-contents">
      <div class="be-title__wrapper">
        <h3>Table of Contents</h3>
      </div> 
            <ul>
        <li></li>
      </ul>
    </div>
   
        <div class="be-related-articles">
        <h3>Related Articles</h3>
        <ul> 
                        <li>
                  <a href="https://unit42.paloaltonetworks.com/privilege-escalation-llm-model-exfil-vertex-ai/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:sidebar:related-articles:ModeLeak: Privilege Escalation to LLM Model Exfiltration in Vertex AI">
                      ModeLeak: Privilege Escalation to LLM Model Exfiltration in Vertex AI                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/container-escape-techniques/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:sidebar:related-articles:Container Breakouts: Escape Techniques in Cloud Environments">
                      Container Breakouts: Escape Techniques in Cloud Environments                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:sidebar:related-articles:Muddled Libra’s Evolution to the Cloud">
                      Muddled Libra’s Evolution to the Cloud                  </a>
              </li>
                      </ul>
      </div>
      </div> 
            </div>
          </div>
        </div>
          <div class="pa related-threat">
    <div class="l-container">
            <h2>Related Cloud Cybersecurity Research Resources</h2>
      <div class="blog-slider" id="blogSlider"> 
                              <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/13_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of vulnerabilities in Vertex AI. A Black woman wearing glasses, looking intently at colorful computer code projected on a screen, highlighting a focus on technology and coding." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/13_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/13_Cloud_cybersecurity_research_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/13_Cloud_cybersecurity_research_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/13_Cloud_cybersecurity_research_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/13_Cloud_cybersecurity_research_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:ModeLeak: Privilege Escalation to LLM Model Exfiltration in Vertex AI:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-11-12T11:00:11+00:00">November 12, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/privilege-escalation-llm-model-exfil-vertex-ai/" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:ModeLeak: Privilege Escalation to LLM Model Exfiltration in Vertex AI">
                    <h4 class="post-title">ModeLeak: Privilege Escalation to LLM Model Exfiltration in Vertex AI</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/data-exfiltration/" title="data exfiltration" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:ModeLeak: Privilege Escalation to LLM Model Exfiltration in Vertex AI:data exfiltration">Data exfiltration</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/google-cloud/" title="Google Cloud" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:ModeLeak: Privilege Escalation to LLM Model Exfiltration in Vertex AI:Google Cloud">Google Cloud</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/kubernetes/" title="Kubernetes" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:ModeLeak: Privilege Escalation to LLM Model Exfiltration in Vertex AI:Kubernetes">Kubernetes</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/privilege-escalation-llm-model-exfil-vertex-ai/" title="ModeLeak: Privilege Escalation to LLM Model Exfiltration in Vertex AI" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:ModeLeak: Privilege Escalation to LLM Model Exfiltration in Vertex AI:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Ransomware_Category_1920x900-786x368.jpg" class="lozad" alt="A pictorial representation of ShinyHunters ransomware. An image showing a laptop with security and financial graphics displayed on the screen, surrounded by stacks of coins and a credit card, set against a dark background illuminated by neon lights." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Ransomware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Ransomware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Ransomware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Ransomware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Ransomware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware:Threat Actor Groups"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                        <span class="post-pub-date"><time datetime="2024-08-23T10:00:21+00:00">August 23, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/shinyhunters-ransomware-extortion/" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware">
                    <h4 class="post-title">Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/mitre/" title="MITRE" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware:MITRE">MITRE</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/extortion/" title="Extortion" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware:Extortion">Extortion</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/container/" title="Container" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware:Container">Container</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/shinyhunters-ransomware-extortion/" title="Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/02_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of an extortion operation in the cloud. Vibrant digital artwork depicting a futuristic cityscape with glowing neon roads weaving through clouds, set against a backdrop of skyscrapers and a vivid sky." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/02_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/02_Cloud_cybersecurity_research_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/02_Cloud_cybersecurity_research_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/02_Cloud_cybersecurity_research_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/02_Cloud_cybersecurity_research_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-08-15T10:00:09+00:00">August 15, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments">
                    <h4 class="post-title">Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/credential-theft/" title="credential theft" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments:credential theft">Credential theft</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/extortion/" title="Extortion" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments:Extortion">Extortion</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/mitre/" title="MITRE" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments:MITRE">MITRE</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/" title="Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Security-Technology_Category_1920x900-786x368.jpg" class="lozad" alt="A pictorial representation of compromised GitHub repositories. A woman focuses intently on a computer in front of her. Overlaid across the screen are lines of code, suggesting a security technology focus." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-08-13T10:00:36+00:00">August 13, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/github-repo-artifacts-leak-tokens/" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts">
                    <h4 class="post-title">ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/artifacts/" title="artifacts" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts:artifacts">Artifacts</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/aws/" title="AWS" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts:AWS">AWS</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/github/" title="GitHub" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts:GitHub">GitHub</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/github-repo-artifacts-leak-tokens/" title="ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg" class="lozad" alt="Illustration of a futuristic city with glowing orange and blue lights, surrounded by clouds and digital elements, conveying a high-tech, cybernetic theme." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Container Breakouts: Escape Techniques in Cloud Environments:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-07-18T10:00:41+00:00">July 18, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/container-escape-techniques/" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Container Breakouts: Escape Techniques in Cloud Environments">
                    <h4 class="post-title">Container Breakouts: Escape Techniques in Cloud Environments</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/containers/" title="Containers" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Container Breakouts: Escape Techniques in Cloud Environments:Containers">Containers</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/docker/" title="Docker" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Container Breakouts: Escape Techniques in Cloud Environments:Docker">Docker</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/container-escape/" title="container escape" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Container Breakouts: Escape Techniques in Cloud Environments:container escape">Container escape</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/container-escape-techniques/" title="Container Breakouts: Escape Techniques in Cloud Environments" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Container Breakouts: Escape Techniques in Cloud Environments:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Vulnerabilities_1920x900-786x368.jpg" class="lozad" alt="Abstract illustration of a network sppread like a spiderweb, connecting covering the globe and symbolizing data or communication links." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Vulnerabilities_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Vulnerabilities_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Vulnerabilities_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Vulnerabilities_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Vulnerabilities_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/top-cyberthreats/" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability:High Profile Threats"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/top-threats.svg" alt=" category icon">High Profile Threats</span></a>                        <span class="post-pub-date"><time datetime="2024-07-02T18:28:47+00:00">July 2, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/threat-brief-cve-2024-6387-openssh/" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability">
                    <h4 class="post-title">Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/openssh/" title="OpenSSH" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability:OpenSSH">OpenSSH</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/remote-code-execution/" title="Remote Code Execution" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability:Remote Code Execution">Remote Code Execution</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/ssh/" title="SSH" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability:SSH">SSH</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/threat-brief-cve-2024-6387-openssh/" title="Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42-cloud-attacks-786x368.jpg" class="lozad" alt="" decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42-cloud-attacks-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42-cloud-attacks-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42-cloud-attacks-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42-cloud-attacks-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42-cloud-attacks.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Attack Paths Into VMs in the Cloud:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-06-18T10:00:23+00:00">June 18, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Attack Paths Into VMs in the Cloud">
                    <h4 class="post-title">Attack Paths Into VMs in the Cloud</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/aws/" title="AWS" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Attack Paths Into VMs in the Cloud:AWS">AWS</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/iaas/" title="IaaS" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Attack Paths Into VMs in the Cloud:IaaS">IaaS</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/virtual-machines/" title="virtual machines" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Attack Paths Into VMs in the Cloud:virtual machines">Virtual machines</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/" title="Attack Paths Into VMs in the Cloud" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Attack Paths Into VMs in the Cloud:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg" class="lozad" alt="Futuristic illustration with glowing neon lights and advanced technology motifs, depicting cloud computing and data flow through interconnected networks. The scene is highlighted by hovering digital clouds and dynamic, illuminated linear structures, set in a dramatic, blue and orange color scheme." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Cloud_cybersecurity_research_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Cloud_cybersecurity_research_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Cloud_cybersecurity_research_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Cloud_cybersecurity_research_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Muddled Libra’s Evolution to the Cloud:Threat Actor Groups"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                        <span class="post-pub-date"><time datetime="2024-04-09T18:00:08+00:00">April 9, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Muddled Libra’s Evolution to the Cloud">
                    <h4 class="post-title">Muddled Libra’s Evolution to the Cloud</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/microsoft-azure/" title="Microsoft Azure" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Muddled Libra’s Evolution to the Cloud:Microsoft Azure">Microsoft Azure</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/muddled-libra/" title="Muddled Libra" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Muddled Libra’s Evolution to the Cloud:Muddled Libra">Muddled Libra</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/" title="Muddled Libra’s Evolution to the Cloud" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Muddled Libra’s Evolution to the Cloud:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/05_Vulnerabilities_1920x900-786x368.jpg" class="lozad" alt="Close-up side profile of a Black woman wearing glasses, focused intently on something out of frame." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/05_Vulnerabilities_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/05_Vulnerabilities_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/05_Vulnerabilities_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/05_Vulnerabilities_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/05_Vulnerabilities_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/top-cyberthreats/" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094):High Profile Threats"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/top-threats.svg" alt=" category icon">High Profile Threats</span></a>                        <span class="post-pub-date"><time datetime="2024-03-31T02:15:55+00:00">March 30, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/threat-brief-xz-utils-cve-2024-3094/" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094)">
                    <h4 class="post-title">Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094)</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/cve-2024-3094/" title="CVE-2024-3094" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094):CVE-2024-3094">CVE-2024-3094</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/linux/" title="Linux" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094):Linux">Linux</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/xz-utils/" title="XZ Utils" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094):XZ Utils">XZ Utils</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/threat-brief-xz-utils-cve-2024-3094/" title="Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094)" role="link" data-page-track="true" data-page-track-value="azure-data-factory-apache-airflow-vulnerabilities:related-resources:Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094):read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                    </div>
    </div>
    <div class="l-container bs__controls">
      <div class="bs__progress"><span></span></div>
      <div class="bs__navigation"> 
        <ul>
          <li> 
            <button id="prevButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
          <li> 
            <button id="nextButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
        </ul>
      </div>
    </div>
  </div>
 
        <div class="be-enlarge-modal" id="enlargedModal">
          <div class="be-enlarge-modal__wrapper"> 
            <figure> 
              <button class="close__modal" id="closeModal"> 
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button"></button>
              <img class="be__enlarged-image" id="enlargedImage" src="" alt="Enlarged Image">
              <figcaption> </figcaption>
            </figure>
          </div>
        </div>

      </div>
    </section>
  </main>
<!--  Start: Footer subscription form -->
<div class="newsletter">
      <div class="l-container">
        <div class="newsletter__wrapper">
          <div class="image__wrapper"> 
            <picture>
			                 <source class="lozad" media="(max-width:400px)" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-mobile.webp">
			  			                  <source class="lozad" media="(max-width:949px)" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-tab.webp">
			  			  			  	<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/Revitalized_newsletter-Image-desktop-copy-1.webp" alt="Newsletter">
			              </picture>
          </div>
          <div class="content__wrapper"> 
		    							<span class="pre-title"> 
				<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/palo-alto-logo-small.svg" alt="UNIT 42 Small Logo">
				Get updates from Unit 42			</span>
						           	 <h2>Peace of mind comes from staying ahead of threats. Contact us today.</h2>
			            <form action="https://www.paloaltonetworks.com/apps/pan/public/formsubmithandler.submitform.json" method="post" novalidate class="subscribe-form" name="Unit42_Subscribe" id="unit42footerSubscription_form">
              <input type="hidden" name="emailFormMask" value="">
              <input type="hidden" value="1086" name="formid">
              <input type="hidden" value="531-OCS-018" name="munchkinId">
              <input type="hidden" value="2141" name="lpId">
              <input type="hidden" value="1203" name="programId">
              <input type="hidden" value="1086" name="formVid">
              <input type="hidden" name="mkto_optinunit42" value="true">
              <input type="hidden" name="mkto_opt-in" value="true">
              <div class="form-group"> 
                <label for="newsletter-email"  id="newsletter-email-label">Your Email</label>
                <input type="emal" placeholder="Your Email" name="Email"  class="subscribe-field" id="newsletter-email" aria-labelledby="newsletter-email-label">
                <p class="error-mail mb-15 text-danger" style="color: #dc3545"></p>
				<p>Subscribe for email updates to all Unit 42 threat research.<br />By submitting this form, you agree to our <a title="Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use" data-page-track="true" data-page-track-value="Get updates from Unit 42:Terms of Use">Terms of Use</a> and acknowledge our <a title="Privacy Statement" href="https://www.paloaltonetworks.com/legal-notices/privacy" data-page-track="true" data-page-track-value="Get updates from Unit 42:Privacy Statement">Privacy Statement.</a></p>
                <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6Lc5EhgTAAAAAJa-DzE7EeWABasWg4LKv-R3ao6o"></div>
                <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Invalid captcha!</p>
                <button class="l-btn is-disabled" data-page-track="true" data-page-track-value="footer:Get updates from Unit 42:Subscribe" id="unit42footerSubscription_form_button"> 
					Subscribe					<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow"  class="arrow">
					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-loader.svg" alt="loader" class="loader">
			   </button>
				<div class="form-success-message"></div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

<script>

(function($) {
	// Migrated from the unit42-v5 + Modifications
	var subscribeSuccess = false;
	var email = document.getElementById('newsletter-email');
	var subscription_form = document.getElementById('unit42footerSubscription_form');
	var subscription_form_button = document.getElementById('unit42footerSubscription_form_button');
	window.captchaComplete = function() {
		subscribeSuccess = true;
		if ($(mail).val() != '' && isEmail($(mail).val())) {
			$(subscription_form_button).removeClass('is-disabled');
		}
		setTimeout(function() {
			$(email).focus();
			$('.g-recaptcha iframe').attr('tabindex', '-1');
		}, 100)
	}
	window.captchaExpires = function() {
		subscribeSuccess = false;
		$(subscription_form_button).addClass('is-disabled', true);
	} 
	$(subscription_form).submit(function(e) {
		e.preventDefault();
		e.stopImmediatePropagation();
		updateEmailMask();
		var success = true;
		var form = $(this);
		var mail = form.find('input[name="Email"]');
		
		if (mail.val() === '') {
			mail.addClass('has-error');
			showError(1);
			success = false;	
		}  else if (!isEmail(mail.val())){
			showError(2);
			success = false;
		}
		else {
			mail.removeClass('has-error');
			$('.error-mail').addClass('d-none');
		}

		if (!subscribeSuccess) {
			$('.error-recaptcha').removeClass('d-none');
		} else {
			$('.error-recaptcha').addClass('d-none');
		}

		if (success && subscribeSuccess) {
			$.ajax({
				type: 'POST',
				url: form.attr('action'),
				data: form.serialize(),
				beforeSend: function() {
                 form.find('button').addClass('is-loading');
    			},
				success: function(msg) {
					form.find('.form-success-message').html('<p class="success-message">You have been successfully subscribed</p>');
					form.find('button').removeClass('is-loading');
					$(email).val('');
					clearError();
				},
				error: function(jqXHR, textStatus, errorThrown) {
					$(subscription_form_button).addClass('is-disabled', true);
					form.find('button').removeClass('is-loading');
					
				}
			});
		}
		return false;
	});
	function showError(error_type){
		if(error_type == 1) {
			$('.error-mail').text("Please enter the email address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		} else if(error_type == 2){
			$('.error-mail').text("Please provide a valid e-mail address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		}	
		$(subscription_form_button).removeClass('is-loading');
	}
	function clearError(){
		$('.error-mail').text("").removeClass('error-show');;
		$(subscription_form_button).removeClass('is-loading');
		$(subscription_form_button).removeClass('is-disabled');
	}
	
	$(email).on('input', function (event) { 
		var email = $(this).val();
		if (isEmail(email) ) {			
			clearError();
		} else if(email == ""){
			clearError();
		} else{
			showError(2);			  
		}
    });

	function isEmail(email) {
		var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
		return re.test(String(email).toLowerCase());
	}
	
	var captcha_loaded = false;
         if(!captcha_loaded){
            // recaptcha on foucs call
            $(document).on('change paste keyup', '#newsletter-email', function () {
               if($('.g-recaptcha').hasClass('d-none')){
                $('.g-recaptcha').removeClass('d-none');
               }
               if(!captcha_loaded ){
                  captcha_loaded  = true;
                  // trigger loading api.js (recaptcha.js) script
                  var head = document.getElementsByTagName('head')[0];
                  var script = document.createElement('script');
                  script.type = 'text/javascript';
                  script.src = 'https://www.google.com/recaptcha/api.js?hl=en_US';
                  head.appendChild(script);
               }
            });
        }
	
	function updateEmailMask() {
		var email = $("#unit42footerSubscription_form input[name='Email']").val();
		if (email && email.trim() != '') {
			var maskedEmail = maskEmailAddress(email);
			$("#unit42footerSubscription_form input[name='emailFormMask']").val(maskedEmail);
		}
	}

	function maskEmailAddress (emailAddress) {
		function mask(str) {
			var strLen = str.length;
			if (strLen > 4) {
				return str.substr(0, 1) + str.substr(1, strLen - 1).replace(/\w/g, '*') + str.substr(-1,1);
			}
			return str.replace(/\w/g, '*');
		}
		return emailAddress.replace(/([\w.]+)@([\w.]+)(\.[\w.]+)/g, function (m, p1, p2, p3) {
			return mask(p1) + '@' + mask(p2) + p3;
		});

		return emailAddress;
	}

}(jQuery));
//# sourceMappingURL=main.js.map
	
</script>
<!--  End: Footer subscription form -->

<footer class="footer"> 
  <div class="footer-menu">
    <div class="l-container">
      <div class="footer-menu__wrapper">
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Products and services</h3>
                                <div class="nav-column__wrapper"> 
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security"   role="link" title="Network Security Platform" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform">Network Security Platform</a>
						</li>    
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/security-subscriptions"   role="link" title="CLOUD DELIVERED SECURITY SERVICES" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES">CLOUD DELIVERED SECURITY SERVICES</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-threat-prevention" target=_blank  role="link" title="Advanced Threat Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention">Advanced Threat Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-dns-security"   role="link" title="DNS Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security">DNS Security</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-data-loss-prevention"   role="link" title="Data Loss Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention">Data Loss Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-iot-security"   role="link" title="IoT Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security">IoT Security</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall"   role="link" title="Next-Generation Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls">Next-Generation Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall-hardware"   role="link" title="Hardware Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls">Hardware Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/strata-cloud-manager"   role="link" title="Strata Cloud Manager" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager">Strata Cloud Manager</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/sase"   role="link" title="SECURE ACCESS SERVICE EDGE" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE">SECURE ACCESS SERVICE EDGE</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/access"   role="link" title="Prisma Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access">Prisma Access</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/sd-wan"   role="link" title="Prisma SD-WAN" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN">Prisma SD-WAN</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/adem"   role="link" title="Autonomous Digital Experience Management" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management">Autonomous Digital Experience Management</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/next-gen-casb"   role="link" title="Cloud Access Security Broker" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker">Cloud Access Security Broker</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/ztna"   role="link" title="Zero Trust Network Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker:Zero Trust Network Access">Zero Trust Network Access</a>
						</li>    
					        
					</ul>
				</nav>
						         
            </div>
            <div class="nav-column">
                          													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/prisma/whyprisma"   role="link" title="Code to Cloud Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform">Code to Cloud Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/prisma/cloud"   role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud">Prisma Cloud</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/content/pan/en_US/prisma/cloud/cloud-native-application-protection-platform"   role="link" title="Cloud-Native Application Protection Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud:Cloud-Native Application Protection Platform">Cloud-Native Application Protection Platform</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/cortex" target=_blank  role="link" title="AI-Driven Security Operations Platform" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform">AI-Driven Security Operations Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xdr"   role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR">Cortex XDR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsoar"   role="link" title="Cortex XSOAR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR">Cortex XSOAR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse"   role="link" title="Cortex Xpanse" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse">Cortex Xpanse</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam"   role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM">Cortex XSIAM</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse/attack-surface-management"   role="link" title="External Attack Surface Protection" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection">External Attack Surface Protection</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/security-operations-automation"   role="link" title="Security Automation" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation">Security Automation</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/detection-and-response"   role="link" title="Threat Prevention, Detection &amp; Response" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation:Threat Prevention, Detection &amp; Response">Threat Prevention, Detection &amp; Response</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/unit42"   role="link" title="Threat Intel and Incident Response Services" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services">Threat Intel and Incident Response Services</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/assess"   role="link" title="Proactive Assessments" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments">Proactive Assessments</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/respond"   role="link" title="Incident Response" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response">Incident Response</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/transform"   role="link" title="Transform Your Security Strategy" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy">Transform Your Security Strategy</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/threat-intelligence-partners"   role="link" title="Discover Threat Intelligence" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy:Discover Threat Intelligence">Discover Threat Intelligence</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Company</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us"   role="link" title="About Us" data-page-track="true" data-page-track-value="footer:Company:About Us">About Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://jobs.paloaltonetworks.com/en/"   role="link" title="Careers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers">Careers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/contact-sales"   role="link" title="Contact Us" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us">Contact Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/corporate-responsibility"   role="link" title="Corporate Responsibility" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility">Corporate Responsibility</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/customers"   role="link" title="Customers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers">Customers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://investors.paloaltonetworks.com/" target=_blank  role="link" title="Investor Relations" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations">Investor Relations</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/locations"   role="link" title="Location" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location">Location</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/newsroom"   role="link" title="Newsroom" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location:Newsroom">Newsroom</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Popular links</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/blog/"   role="link" title="Blog" data-page-track="true" data-page-track-value="footer:Popular links:Blog">Blog</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/communities"   role="link" title="Communities" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities">Communities</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/resources"   role="link" title="Content Library" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library">Content Library</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cyberpedia"   role="link" title="Cyberpedia" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia">Cyberpedia</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://events.paloaltonetworks.com/"   role="link" title="Event Center" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center">Event Center</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://start.paloaltonetworks.com/preference-center"   role="link" title="Manage Email Preferences" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences">Manage Email Preferences</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/products/products-a-z"   role="link" title="Products A-Z" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z">Products A-Z</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/legal-notices/trust-center/tech-certs"   role="link" title="Product Certifications" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications">Product Certifications</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/security-disclosure"   role="link" title="Report a Vulnerability" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability">Report a Vulnerability</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sitemap"   role="link" title="Sitemap" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap">Sitemap</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://docs.paloaltonetworks.com/"   role="link" title="Tech Docs" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs">Tech Docs</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://unit42.paloaltonetworks.com/"   role="link" title="Unit 42" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42">Unit 42</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://panwedd.exterro.net/portal/dsar.htm?target=panwedd" target=_blank  role="link" title="Do Not Sell or Share My Personal Information" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42:Do Not Sell or Share My Personal Information">Do Not Sell or Share My Personal Information</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer-bottom"> 
    <div class="l-container"> 
              <div class="footer-logo">
          <a href="https://www.paloaltonetworks.com/" role="link" title="Footer Nav" data-page-track="true" data-page-track-value="footer:logo:Palo Alto Networks">
            <img width="245" height="46" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/palo-alto-footer-logo.svg" class="attachment-medium size-medium" alt="" decoding="async" loading="lazy" />          </a>
        </div>
            <div class="footer-bottom__wrapper"> 
        <div class="footer-bottom-nav">
                                              <nav>
                <ul class="footer-menu-nav__list"> 
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/privacy"   role="link" title="Privacy" data-page-track="true" data-page-track-value="footer:bottom-menu:Privacy">Privacy</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/trust-center"   role="link" title="Trust Center" data-page-track="true" data-page-track-value="footer:bottom-menu:Trust Center">Trust Center</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use"   role="link" title="Terms of Use" data-page-track="true" data-page-track-value="footer:bottom-menu:Terms of Use">Terms of Use</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal"   role="link" title="Documents" data-page-track="true" data-page-track-value="footer:bottom-menu:Documents">Documents</a>
                  </li>    
                        
                </ul>
              </nav>
                                            <br/><span class="copyright">Copyright © 2024 Palo Alto Networks. All Rights Reserved</span>
                  </div>
        <div class="footer-bottom-social"> 
          <ul> 
			<li>
			<a href="https://www.youtube.com/user/paloaltonetworks" target="_blank" role="link" title="YouTube" data-page-track="true" data-page-track-value="footer:social:Youtube">
				<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/youtube-black.svg" alt="YouTube">
			</a>
		</li>
				<li> 
			<a href="https://twitter.com/Unit42_Intel" target="_blank" role="link" title="X" data-page-track="true" data-page-track-value="footer:social::Twitter">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/x-icon-black.svg" alt="Twitter">
			</a>
		</li>
				<li> 
			<a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank" role="link" title="Facebook" data-page-track="true" data-page-track-value="footer:social:Facebook">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/Facebook_Icon.svg" alt="Facebook">
			</a>
		</li>
				<li> 
			<a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank" role="link" title="LinkedIn" data-page-track="true" data-page-track-value="footer:social:LinkedIn">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/LinkedIn_Icon.svg" alt="LinkedIn">
			</a>
		</li>
	                <li> 
			<a href="https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/" role="link" title="Podcast" data-page-track="true" data-page-track-value="footer:social:Podcast">
                            <img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/Podcast.svg" alt="Podcast">
			</a>
		</li>
</ul>          
	<div class="pa language-dropdown">
			<div class="language-dropdown__wrapper"> 
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/globe-icon.svg" alt="Globe icon">
			<span id="selectedLanguage">EN</span>
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"><ul><li class="title">Select your language</li>
					<li class="selected" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:en" href="https://unit42.paloaltonetworks.com/azure-data-factory-apache-airflow-vulnerabilities/">USA (ENGLISH)</a>
					</li></ul>        </div>
      </div>
    </div>
  </div>
</footer>
<div class="dd-overlay">
</div>
<!--  Start: video modal -->
<div class="modal video__modal" id="videoModal" tabindex="-1">
        <div class="modal__video-wrapper">
          <button class="modal__play-btn is-minimized is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
          <button class="modal__minimize-btn is-minimized">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
          </button>
          <button class="modal__close"> 
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button">
          </button>
          <video class="modal__video" id="customVideo">
            <source src="" type="video/mp4">Your browser does not support the video tag.
          </video>
          <div class="modal__post-details" tabindex="-1">       
              <h3>Default Heading</h3>
              <a class="l-btn" href="#" title="Right Arrow Icon" role="link" data-page-track="true" data-page-track-value="overview:explore reports:View all reports">Read the article
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow">
              </a>
          </div>
          <div class="modal__video-controls">
            <div class="modal__video-seekbar input__wrapper"><span></span>
              <label class="is-hidden" for="modalSeekBar">Seekbar</label>
              <input class="custom-range" id="modalSeekBar" type="range" min="0" max="100" value="1">
              <p class="modal__remaining-time"></p>
            </div>
            <button class="modal__play-btn is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
            <div class="modal__volume-controls">
              <div class="modal__volume__wrapper">
                <button tabindex="0">
                  <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-volume.svg" alt="Volume">
                </button>
                <div class="modal__volume-seekbar"><span></span>
                  <label class="is-hidden" for="volumeBar">Volume</label>
                  <input class="volume__bar" id="volumeBar" type="range" min="0" max="1" step="0.1" value="0.7">
                </div>
              </div>
              <button class="modal__minimize-btn" id="minimizeBtn">
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
              </button>
            </div>
          </div>
        </div>
      </div><!--  End: video modal -->

    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		var like_nonce = jQuery('#_wpnonce').val();
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type+"&ul_nonce="+like_nonce,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=6.6.2' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/js/script.js?ver=1.0.0" id="unit42-v6-navigation-js"></script>

<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
observer_lozad.observe();

window.PAN_Clean_Util = {
        isIE: false
};

(function () {
   // INP Util Fix
    function yieldToMain(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
   window.PAN_Clean_Util.yieldToMain = yieldToMain
})();

if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
  var Coveo_organizationId = "paloaltonetworksintranet";        
  var techDocsPagePath = "https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25";
  var languageFromPath="en_US";
  window.Granite = window.Granite || {};
  Granite.I18n = (function() {
  var self = {};
  self.setLocale = function(locale) { };
  self.get = function(text, snippets, note) {
    var out = "";
    if(text){
      if(text ==="coveo.clear"){
        out = "Clear";
      }else if(text ==="coveo.noresultsfound"){
        out = "No results found for this search term.";
      }
    }
    return out;
  };
  return self
  }());
}

  var main_site_critical_top = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.js';
  var main_site_defered = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/defered.min.js';
  var main_site_criticalTopBase = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopBase.min.js';
  var main_site_criticalTopProductNav = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.js';
window.PAN_MainNavAsyncUrl = maindomain_lang+"/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html";

function loadScript(url, defer){
    var script1 = document.createElement('script');
    script1.setAttribute('type', 'text/javascript');
    script1.setAttribute('src',url);
    if(defer == true){
        script1.setAttribute('defer','defer');
    }
    document.head.appendChild(script1);
}
function loadScript1(url, callback){

    var script = document.createElement("script")
    script.type = "text/javascript";
    if (script.readyState){  //IE
        script.onreadystatechange = function(){
            if (script.readyState == "loaded" || script.readyState == "complete"){
                script.onreadystatechange = null;
                callback();
            }
        };
    } else {  //Others
        script.onload = function(){
            callback();
        };
    }
    script.src = url;
    document.getElementsByTagName("head")[0].appendChild(script);
}
if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
	if(referer == "Unit"){
    setTimeout(function(){
      loadScript(main_site_criticalTopBase, false);
      loadScript1(main_site_criticalTopProductNav, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
	else{
    setTimeout(function(){
      loadScript1(main_site_critical_top, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
}

$(document).ready(function () {
    setTimeout(function(){
      $('.article-banner .ab__options ul li a').each(function(){
          	$(this).attr('target', "_blank");
      });
    }, 4000);
});
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->

</body>
</html>
