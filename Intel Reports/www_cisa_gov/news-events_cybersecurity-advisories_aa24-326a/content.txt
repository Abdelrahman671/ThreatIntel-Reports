

<!DOCTYPE html>
<html lang="en" dir="ltr" prefix="og: https://ogp.me/ns#" class="no-js">
  <head>
    <meta charset="utf-8" />
<link rel="canonical" href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-326a" />
<meta property="og:site_name" content="Cybersecurity and Infrastructure Security Agency CISA" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-326a" />
<meta property="og:title" content="Enhancing Cyber Resilience: Insights from CISA Red Team Assessment of a US Critical Infrastructure Sector Organization | CISA" />
<meta name="Generator" content="Drupal 10 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon" href="/profiles/cisad8_gov/themes/custom/gesso/favicon.png" type="image/png" />

    <title>Enhancing Cyber Resilience: Insights from CISA Red Team Assessment of a US Critical Infrastructure Sector Organization | CISA</title>
    <link rel="stylesheet" media="all" href="/core/modules/system/css/components/align.module.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/fieldgroup.module.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/container-inline.module.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/clearfix.module.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/details.module.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/hidden.module.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/item-list.module.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/js.module.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/nowrap.module.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/position-container.module.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/reset-appearance.module.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/resize.module.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/system-status-counter.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/system-status-report-counters.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/system-status-report-general-info.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/tablesort.module.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/misc/components/progress.module.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/misc/components/ajax-progress.module.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/modules/views/css/views.module.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/modules/contrib/responsive_tables_filter/css/tablesaw-base.css?sn7rxr" />
<link rel="stylesheet" media="screen" href="/modules/contrib/responsive_tables_filter/css/tablesaw-responsive.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/modules/contrib/responsive_tables_filter/css/tables.columntoggle.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/modules/contrib/responsive_tables_filter/css/customizations.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/modules/filter/css/filter.caption.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/core/modules/media/css/filter.caption.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/profiles/cisad8_gov/modules/custom/toolbar_tasks/css/toolbar.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/modules/contrib/extlink/css/extlink.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/modules/contrib/ckeditor_accordion/css/accordion.frontend.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/modules/contrib/better_social_sharing_buttons/css/better_social_sharing_buttons.css?sn7rxr" />
<link rel="stylesheet" media="all" href="/modules/contrib/paragraphs/css/paragraphs.unpublished.css?sn7rxr" />
<link rel="stylesheet" media="all" href="//fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&amp;family=Public+Sans:wght@400;500;600;700&amp;display=swap" />
<link rel="stylesheet" media="all" href="/profiles/cisad8_gov/themes/custom/gesso/dist/css/styles.css?sn7rxr" />

    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","pathPrefix":"","currentPath":"node\/21915","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"gtm":{"tagId":null,"settings":{"data_layer":"dataLayer","include_classes":false,"allowlist_classes":"","blocklist_classes":"","include_environment":false,"environment_id":"","environment_token":""},"tagIds":["GTM-53QLXSL9"]},"gtag":{"tagId":"","consentMode":false,"otherIds":[],"events":[],"additionalConfigInfo":[]},"ajaxPageState":{"libraries":"eJxdj1tywyAMRTeEzZIYATKmlhGDhJ3svqR20ml_NDpXryuPqticcMhATlZouSTnuyoXsaJPGmzChjErNwchcIuZi_1k89K4KJZo8KGje7Ox9Qo032gScyJ0CsmmEf7zDF_w-CvuJnU5o9glE77zROyBzD6cwKswbM8Bqg4LpkKD1KCu8j7-q8y91O4py4rRNJQ6HsvH65QnFHdtshfBOV1s5CmKu_UgaJSZPLQxIZvYm0yXBWPiw93WoQA9NQexxBCnD04hFnNkPMX-xHnn2Am_Aaf3lEA","theme":"guswds","theme_token":null},"ajaxTrustedUrl":[],"data":{"extlink":{"extTarget":false,"extTargetAppendNewWindowLabel":"(opens in a new window)","extTargetNoOverride":false,"extNofollow":false,"extNoreferrer":false,"extFollowNoOverride":false,"extClass":"ext","extLabel":"(link is external)","extImgClass":false,"extSubdomains":true,"extExclude":"(.\\.gov$)|(.\\.mil$)|(.\\.mil\/)|(.\\.gov\/)","extInclude":"","extCssExclude":".c-menu--social,.c-menu--footer,.c-social-links,.c-text-cta--button,.usa-footer__contact-info","extCssInclude":"","extCssExplicit":"","extAlert":true,"extAlertText":"You are now leaving an official website of the United State Government (USG), the Department of Homeland Security (DHS) and the Cybersecurity and Infrastructure Security Agency (CISA). Links to non-USG, non-DHS and non-CISA sites are provided for the visitor\u0027s convenience and do not represent an endorsement by USG, DHS or CISA of any commercial or private issues, products or services. Note that the privacy policy of the linked site may differ from that of USG, DHS and CISA.","extHideIcons":false,"mailtoClass":"mailto","telClass":"","mailtoLabel":"(link sends email)","telLabel":"(link is a phone number)","extUseFontAwesome":false,"extIconPlacement":"append","extFaLinkClasses":"fa fa-external-link","extFaMailtoClasses":"fa fa-envelope-o","extAdditionalLinkClasses":"","extAdditionalMailtoClasses":"","extAdditionalTelClasses":"","extFaTelClasses":"fa fa-phone","whitelistedDomains":[],"extExcludeNoreferrer":""}},"ckeditorAccordion":{"accordionStyle":{"collapseAll":1,"keepRowsOpen":0,"animateAccordionOpenAndClose":1,"openTabsWithHash":1}},"user":{"uid":0,"permissionsHash":"0f75d40308887aebba0d5b0d2671305b73c9431902f86e672380a6dc6ab97d07"}}</script>
<script src="/core/assets/vendor/jquery/jquery.min.js?v=3.7.1"></script>
<script src="/core/assets/vendor/once/once.min.js?v=1.0.1"></script>
<script src="/core/misc/drupalSettingsLoader.js?v=10.3.6"></script>
<script src="/core/misc/drupal.js?v=10.3.6"></script>
<script src="/core/misc/drupal.init.js?v=10.3.6"></script>
<script src="/core/assets/vendor/tabbable/index.umd.min.js?v=6.2.0"></script>
<script src="/modules/contrib/google_tag/js/gtm.js?sn7rxr"></script>
<script src="/modules/contrib/google_tag/js/gtag.js?sn7rxr"></script>
<script src="/core/misc/progress.js?v=10.3.6"></script>
<script src="/core/assets/vendor/loadjs/loadjs.min.js?v=4.3.0"></script>
<script src="/core/misc/debounce.js?v=10.3.6"></script>
<script src="/core/misc/announce.js?v=10.3.6"></script>
<script src="/core/misc/message.js?v=10.3.6"></script>
<script src="/core/misc/ajax.js?v=10.3.6"></script>
<script src="/modules/contrib/google_tag/js/gtag.ajax.js?sn7rxr"></script>

  </head>
  <body  class="path-node not-front node-page node-page--node-type-advisory" id="top">
    
<div  class="c-skiplinks">
  <a href="#main" class="c-skiplinks__link u-visually-hidden u-focusable">Skip to main content</a>
</div>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-53QLXSL9"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

      <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
    

<div  class="l-site-container">
    
      
<section  class="usa-banner" aria-label="Official government website">
  <div class="usa-accordion">  <header class="usa-banner__header">
    <div class="usa-banner__inner">
      <div class="grid-col-auto">
        <img class="usa-banner__header-flag" src="/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png" alt="U.S. flag" />
      </div>
      <div class="grid-col-fill tablet:grid-col-auto">
        <p class="usa-banner__header-text">An official website of the United States government</p>
              <p class="usa-banner__header-action" aria-hidden="true">Here’s how you know</p></div>
        <button class="usa-accordion__button usa-banner__button" aria-expanded="false" aria-controls="gov-banner">
          <span class="usa-banner__button-text">Here’s how you know</span>
        </button>
          </div>
  </header>
      <div class="usa-banner__content usa-accordion__content" id="gov-banner">
      <div class="grid-row grid-gap-lg">
                  <div class="usa-banner__guidance tablet:grid-col-6">
            <img class="usa-banner__icon usa-media-block__img" src="/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg" alt="Dot gov">
            <div class="usa-media-block__body">
              <p>
                <strong>Official websites use .gov</strong>
                <br> A <strong>.gov</strong> website belongs to an official government organization in the United States.
              </p>
            </div>
          </div>
                  <div class="usa-banner__guidance tablet:grid-col-6">
            <img class="usa-banner__icon usa-media-block__img" src="/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg" alt="HTTPS">
            <div class="usa-media-block__body">
              <p>
                <strong>Secure .gov websites use HTTPS</strong>
                <br> A <strong>lock</strong> (<span class="icon-lock"><svg xmlns="http://www.w3.org/2000/svg" width="52" height="64" viewBox="0 0 52 64" class="usa-banner__lock-image" role="img" aria-labelledby="banner-lock-title banner-lock-description"><title id="banner-lock-title">Lock</title><desc id="banner-lock-description">A locked padlock</desc><path fill="#000000" fill-rule="evenodd" d="M26 0c10.493 0 19 8.507 19 19v9h3a4 4 0 0 1 4 4v28a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V32a4 4 0 0 1 4-4h3v-9C7 8.507 15.507 0 26 0zm0 8c-5.979 0-10.843 4.77-10.996 10.712L15 19v9h22v-9c0-6.075-4.925-11-11-11z"/></svg></span>) or <strong>https://</strong> means you’ve safely connected to the .gov website. Share sensitive information only on official, secure websites.
              </p>
            </div>
          </div>
              </div>
    </div>
  </div>
  </section>
  



  <div  class="c-block c-global-header-btns c-global-btns">

      <div  class="l-constrain l-constrain">
  
  
    

      <div  class="c-block__content">
  
      





  <div  id="block-globalbuttons" class="c-block c-block--provider-block-content c-block--id-block-content83069f9f-34fc-4d54-86ec-936a204f8088">

  
  
    

      <div  class="c-block__content">
  
      




<div  class="c-field c-field--name-body c-field--type-text-with-summary c-field--label-hidden">
  <div class="c-field__content"><p><a class="c-button c-button--basic c-button--blue" href="/resources-tools/resources/free-cybersecurity-services-and-tools" title="Free Cyber Services">Free Cyber Services</a><a class="c-button c-button--basic c-button--green60" href="/topics/election-security/election-threat-updates">Election Threat Updates</a><a class="c-button c-button--basic c-button--gray" href="/protect2024">#protect2024</a><a class="c-button c-button--basic c-button--teal" href="/node/18883">Secure Our World</a><a class="c-button c-button--campaign" href="/node/8056">Shields Up</a><a class="c-button c-button--report" href="/report">Report A Cyber Issue</a></p></div></div>

  
      </div>
  
  
  </div>

  
      </div>
  
      </div>
  
  </div>
  
  


<div class="usa-overlay"></div>
<header  class="usa-header usa-header--extended" role="banner">
        
<div  class="usa-navbar">
  <div class="l-constrain">
    <div class="usa-navbar__row">
                                    



  <div  class="c-block c-site-header">

      <div  class="l-constrain">
  
  
    

      <div  class="c-block__content">
  
      





  <div  id="block-guswds-cisaheaderblock" class="c-block c-block--provider-block-content c-block--id-block-contentbc4e6844-86b4-4e20-b163-a73bda3d1d76">

  
  
    

      <div  class="c-block__content">
  
      




<div  class="c-field c-field--name-body c-field--type-text-with-summary c-field--label-hidden">
  <div class="c-field__content"><a href="/"><img src = "/sites/default/files/images/SVG/header_logo_tagline_update.svg" alt="CISA logo image. America's Cyber Defense Agency, National Coordinator for Critical Infrastructure Security and Resilience"/></a></div></div>

  
      </div>
  
  
  </div>

  
      </div>
  
      </div>
  
  </div>

        



  <div  class="c-block c-site-header-mobile">

      <div  class="l-constrain">
  
  
    

      <div  class="c-block__content">
  
      





  <div  id="block-guswds-cisaheaderblockmobile" class="c-block c-block--provider-block-content c-block--id-block-content283396c9-cd36-4ce3-b1e2-9b5576ab4f50">

  
  
    

      <div  class="c-block__content">
  
      




<div  class="c-field c-field--name-body c-field--type-text-with-summary c-field--label-hidden">
  <div class="c-field__content"><a href="/"><img src = "/sites/default/files/images/SVG/mobile_logo_wordmark.svg" alt="CISA Logo"/></a></div></div>

  
      </div>
  
  
  </div>

  
      </div>
  
      </div>
  
  </div>
            <div class="usa-navbar__search">
        <div class="usa-navbar__search-header">
          <p>Search</p>
        </div>
        
<div  class="usa-search">
  <script async src=https://cse.google.com/cse.js?cx=ffc4c79e29d5b3a8c></script>
  <div class="gcse-searchbox-only" data-resultsurl="/search">&nbsp;</div>
</div>
      </div>
      <button class="mobile-menu-button usa-menu-btn">Menu</button>
    </div>
  </div>
</div>
    



  <div  class="c-block c-tagline-mobile">

      <div  class="l-constrain">
  
  
    

      <div  class="c-block__content">
  
      





  <div  id="block-guswds-mobiletaglinecontainer" class="c-block c-block--provider-block-content c-block--id-block-contentc8d12e9d-7e48-4708-90c1-563609c4b566">

  
  
    

      <div  class="c-block__content">
  
      




<div  class="c-field c-field--name-body c-field--type-text-with-summary c-field--label-hidden">
  <div class="c-field__content"><p><center><img src = "/sites/default/files/images/SVG/header_tagline_mobile_update.svg" alt = "America's Cyber Defense Agency" /></center></div></div>

  
      </div>
  
  
  </div>

  
      </div>
  
      </div>
  
  </div>
    

<nav  class="usa-nav" role="navigation" aria-label="Primary navigation">
  <div class="usa-nav__inner l-constrain">
    <div class="usa-nav__row">
      <button class="usa-nav__close">Close</button>
      
<div  class="usa-search">
  <script async src=https://cse.google.com/cse.js?cx=ffc4c79e29d5b3a8c></script>
  <div class="gcse-searchbox-only" data-resultsurl="/search">&nbsp;</div>
</div>
                
  
          <ul class="usa-nav__primary usa-accordion">
    
    
              <li class="usa-nav__primary-item topics">
      
              <button class="usa-accordion__button usa-nav__link " aria-expanded="false" aria-controls="basic-mega-nav-section-1">
          <span>Topics</span>
        </button>
      
                
  
          <div id="basic-mega-nav-section-1" class="usa-nav__submenu usa-megamenu" hidden="">

              <div class="usa-megamenu__parent-link">
          <a href="/topics">Topics</a>
        </div>
              <div class="usa-megamenu__menu-items">
    
    
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/cybersecurity-best-practices">
          <span>Cybersecurity Best Practices</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/cyber-threats-and-advisories">
          <span>Cyber Threats and Advisories</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/critical-infrastructure-security-and-resilience">
          <span>Critical Infrastructure Security and Resilience</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/election-security">
          <span>Election Security</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/emergency-communications">
          <span>Emergency Communications</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/industrial-control-systems">
          <span>Industrial Control Systems</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/information-communications-technology-supply-chain-security">
          <span>Information and Communications Technology Supply Chain Security</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/partnerships-and-collaboration">
          <span>Partnerships and Collaboration</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/physical-security">
          <span>Physical Security</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/risk-management">
          <span>Risk Management</span>
        </a>
                  </div>
              
              </div>
          
            </div>
                          

<div  class="c-menu-feature-links">
      <div class="c-menu-feature-links__title">
      <a href="/audiences">        How can we help?
      </a>    </div>
        <div class="c-menu-feature-links__content"><a href="/topics/government">Government</a><a href="/topics/educational-institutions">Educational Institutions</a><a href="/topics/industry">Industry</a><a href="/topics/state-local-tribal-and-territorial">State, Local, Tribal, and Territorial</a><a href="/topics/individuals-and-families">Individuals and Families</a><a href="/topics/small-and-medium-businesses">Small and Medium Businesses</a><a href="/audiences/find-help-locally">Find Help Locally</a><a href="/audiences/faith-based-community">Faith-Based Community</a><a href="/audiences/executives">Executives</a><a href="/audiences/high-risk-communities">High-Risk Communities</a></div>
  </div>

              </div>
    
  
      
              </li>
          
              <li class="usa-nav__primary-item spotlight">
      
      
                      <a href="/spotlight" class="usa-nav__link" >
          <span>Spotlight</span>
        </a>
              
              </li>
          
              <li class="usa-nav__primary-item resources--tools">
      
              <button class="usa-accordion__button usa-nav__link " aria-expanded="false" aria-controls="basic-mega-nav-section-3">
          <span>Resources &amp; Tools</span>
        </button>
      
                
  
          <div id="basic-mega-nav-section-3" class="usa-nav__submenu usa-megamenu" hidden="">

              <div class="usa-megamenu__parent-link">
          <a href="/resources-tools">Resources &amp; Tools</a>
        </div>
              <div class="usa-megamenu__menu-items">
    
    
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/resources-tools/all-resources-tools">
          <span>All Resources &amp; Tools</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/resources-tools/services">
          <span>Services</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/resources-tools/programs">
          <span>Programs</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/resources-tools/resources">
          <span>Resources</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/resources-tools/training">
          <span>Training</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/resources-tools/groups">
          <span>Groups</span>
        </a>
                  </div>
              
              </div>
          
            </div>
                          
              </div>
    
  
      
              </li>
          
              <li class="usa-nav__primary-item news--events">
      
              <button class="usa-accordion__button usa-nav__link usa-current" aria-expanded="false" aria-controls="basic-mega-nav-section-4">
          <span>News &amp; Events</span>
        </button>
      
                
  
          <div id="basic-mega-nav-section-4" class="usa-nav__submenu usa-megamenu" hidden="">

              <div class="usa-megamenu__parent-link">
          <a href="/news-events">News &amp; Events</a>
        </div>
              <div class="usa-megamenu__menu-items">
    
    
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/news-events/news">
          <span>News</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/news-events/events">
          <span>Events</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/news-events/cybersecurity-advisories">
          <span>Cybersecurity Alerts &amp; Advisories</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/news-events/directives">
          <span>Directives</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/news-events/request-speaker">
          <span>Request a CISA Speaker</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/news-events/congressional-testimony">
          <span>Congressional Testimony</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/cisa-conferences">
          <span>CISA Conferences</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/cisa-live">
          <span>CISA Live!</span>
        </a>
                  </div>
              
              </div>
          
            </div>
                          
              </div>
    
  
      
              </li>
          
              <li class="usa-nav__primary-item careers">
      
              <button class="usa-accordion__button usa-nav__link " aria-expanded="false" aria-controls="basic-mega-nav-section-5">
          <span>Careers</span>
        </button>
      
                
  
          <div id="basic-mega-nav-section-5" class="usa-nav__submenu usa-megamenu" hidden="">

              <div class="usa-megamenu__parent-link">
          <a href="/careers">Careers</a>
        </div>
              <div class="usa-megamenu__menu-items">
    
    
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/careers/benefits-perks">
          <span>Benefits &amp; Perks</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/careers/hirevue-applicant-reasonable-accommodations-process">
          <span>HireVue Applicant Reasonable Accommodations Process</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/general-recruitment-and-hiring-faqs">
          <span>Hiring</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/careers/resume-application-tips">
          <span>Resume &amp; Application Tips</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/students-recent-graduates-employment-opportunities">
          <span>Students &amp; Recent Graduates</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/careers/veteran-and-military-spouse-employment-opportunities">
          <span>Veteran and Military Spouses</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/careers/work-cisa">
          <span>Work @ CISA</span>
        </a>
                  </div>
              
              </div>
          
            </div>
                          
              </div>
    
  
      
              </li>
          
              <li class="usa-nav__primary-item about">
      
              <button class="usa-accordion__button usa-nav__link " aria-expanded="false" aria-controls="basic-mega-nav-section-6">
          <span>About</span>
        </button>
      
                
  
          <div id="basic-mega-nav-section-6" class="usa-nav__submenu usa-megamenu" hidden="">

              <div class="usa-megamenu__parent-link">
          <a href="/about">About</a>
        </div>
              <div class="usa-megamenu__menu-items">
    
    
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/culture">
          <span>Culture</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/divisions-offices">
          <span>Divisions &amp; Offices</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/regions">
          <span>Regions</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/leadership">
          <span>Leadership</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/doing-business-cisa">
          <span>Doing Business with CISA</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/site-links">
          <span>Site Links</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/reporting-employee-and-contractor-misconduct">
          <span>Reporting Employee and Contractor Misconduct</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/cisa-github">
          <span>CISA GitHub</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/cisa-central">
          <span>CISA Central</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/2023YIR">
          <span>2023 Year In Review</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/contact-us">
          <span>Contact Us </span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/contact-us/subscribe-updates-cisa">
          <span>Subscribe</span>
        </a>
                  </div>
              
              </div>
          
            </div>
                          
              </div>
    
  
      
              </li>
          
    
      </ul>
    
  


            



  <div  class="c-block c-global-menu-btns c-global-btns">

  
  
    

      <div  class="c-block__content">
  
      





  <div  id="block-globalbuttons" class="c-block c-block--provider-block-content c-block--id-block-content83069f9f-34fc-4d54-86ec-936a204f8088">

  
  
    

      <div  class="c-block__content">
  
      




<div  class="c-field c-field--name-body c-field--type-text-with-summary c-field--label-hidden">
  <div class="c-field__content"><p><a class="c-button c-button--basic c-button--blue" href="/resources-tools/resources/free-cybersecurity-services-and-tools" title="Free Cyber Services">Free Cyber Services</a><a class="c-button c-button--basic c-button--green60" href="/topics/election-security/election-threat-updates">Election Threat Updates</a><a class="c-button c-button--basic c-button--gray" href="/protect2024">#protect2024</a><a class="c-button c-button--basic c-button--teal" href="/node/18883">Secure Our World</a><a class="c-button c-button--campaign" href="/node/8056">Shields Up</a><a class="c-button c-button--report" href="/report">Report A Cyber Issue</a></p></div></div>

  
      </div>
  
  
  </div>

  
      </div>
  
  
  </div>
    </div>
  </div>
</nav>
    </header>


  
  
  
<div  class="l-breadcrumb">
  <div class="l-constrain">
    <div class="l-breadcrumb__row">
      







  
  
    

  
              


<nav  aria-labelledby="breadcrumb-label" class="c-breadcrumb" role="navigation">
  <div class="l-constrain">
    <div
       id="breadcrumb-label" class="c-breadcrumb__title  u-visually-hidden">Breadcrumb</div>
    <ol class="c-breadcrumb__list">
              <li class="c-breadcrumb__item">
                      <a class="c-breadcrumb__link" href="/">Home</a>
                  </li>
              <li class="c-breadcrumb__item">
                      <a class="c-breadcrumb__link" href="/news-events">News & Events</a>
                  </li>
              <li class="c-breadcrumb__item">
                      <a class="c-breadcrumb__link" href="/news-events/cybersecurity-advisories">Cybersecurity Advisories</a>
                  </li>
              <li class="c-breadcrumb__item">
                      <a class="c-breadcrumb__link" href="/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A94">Cybersecurity Advisory</a>
                  </li>
          </ol>
  </div>
</nav>

  
  
  
  






  <div  id="block-bettersocialsharingbuttons" class="c-block c-block--social-share c-block--provider-better-social-sharing-buttons c-block--id-social-sharing-buttons-block">

  
  
    

      <div  class="c-block__content">
  
      <div class="c-block__row">
      <span>Share:</span>
      

<div style="display: none"><link rel="preload" href="/modules/contrib/better_social_sharing_buttons/assets/dist/sprites/social-icons--no-color.svg" as="image" type="image/svg+xml" crossorigin="anonymous" /></div>

<div class="social-sharing-buttons">
                <a href="https://www.facebook.com/sharer/sharer.php?u=https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-326a&amp;title=Enhancing%20Cyber%20Resilience%3A%20Insights%20from%20CISA%20Red%20Team%20Assessment%20of%20a%20US%20Critical%20Infrastructure%20Sector%20Organization" target="_blank" title="Share to Facebook" aria-label="Share to Facebook" class="social-sharing-buttons__button share-facebook" rel="noopener">
            <svg width="18px" height="18px" style="border-radius:3px;">
                <use href="/modules/contrib/better_social_sharing_buttons/assets/dist/sprites/social-icons--no-color.svg#facebook" />
            </svg>
        </a>
    
                <a href="https://twitter.com/intent/tweet?text=Enhancing%20Cyber%20Resilience%3A%20Insights%20from%20CISA%20Red%20Team%20Assessment%20of%20a%20US%20Critical%20Infrastructure%20Sector%20Organization+https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-326a" target="_blank" title="Share to X" aria-label="Share to X" class="social-sharing-buttons__button share-x" rel="noopener">
            <svg width="18px" height="18px" style="border-radius:3px;">
                <use href="/modules/contrib/better_social_sharing_buttons/assets/dist/sprites/social-icons--no-color.svg#x" />
            </svg>
        </a>
    
        
        
        
                <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-326a" target="_blank" title="Share to Linkedin" aria-label="Share to Linkedin" class="social-sharing-buttons__button share-linkedin" rel="noopener">
            <svg width="18px" height="18px" style="border-radius:3px;">
                <use href="/modules/contrib/better_social_sharing_buttons/assets/dist/sprites/social-icons--no-color.svg#linkedin" />
            </svg>
        </a>
    
        
        
        
        
                <a href="mailto:?subject=Enhancing%20Cyber%20Resilience%3A%20Insights%20from%20CISA%20Red%20Team%20Assessment%20of%20a%20US%20Critical%20Infrastructure%20Sector%20Organization&amp;body=https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-326a" title="Share to Email" aria-label="Share to Email" class="social-sharing-buttons__button share-email" target="_blank" rel="noopener">
            <svg width="18px" height="18px" style="border-radius:3px;">
                <use href="/modules/contrib/better_social_sharing_buttons/assets/dist/sprites/social-icons--no-color.svg#email" />
            </svg>
        </a>
    
        
    </div>

    </div>
  
      </div>
  
  
  </div>

    </div>
  </div>
</div>

  
  

  <main id="main" class="c-main" role="main" tabindex="-1">
        
      
    


<div  class="l-content">
          







  
  
    

  
            






<div  class="is-promoted l-full">
    <div class="l-full__header">
        
<div  class="c-page-title">
  <div class="c-page-title__inner l-constrain">
    <div class="c-page-title__row">
      <div class="c-page-title__content">
                  <div class="c-page-title__meta">Cybersecurity Advisory</div>
                <h1 class="c-page-title__title">
<span>Enhancing Cyber Resilience: Insights from CISA Red Team Assessment of a US Critical Infrastructure Sector Organization</span>
</h1>
                                                          <div class="c-page-title__fields">  




<div  class="c-field c-field--name-field-release-date c-field--type-datetime c-field--label-above">
  <div  class="c-field__label">Release Date</div><div class="c-field__content"><time datetime="2024-11-21T12:00:00Z">November 21, 2024</time></div></div>

  




<div  class="c-field c-field--name-field-alert-code c-field--type-string c-field--label-above">
  <div  class="c-field__label">Alert Code</div><div class="c-field__content">AA24-326A</div></div>

</div>
                        
        
      </div>
          </div>
    <div class="c-page-title__decoration"></div>
  </div>
</div>
    </div>
    <div class="l-full__main">
                      

<div  class="l-page-section l-page-section--rich-text">
      <div class="l-constrain">
  
  
  <div class="l-page-section__content">
          <h2><strong>Executive Summary</strong></h2>
<p>The Cybersecurity and Infrastructure Security Agency (CISA) conducted a red team assessment (RTA) at the request of a critical infrastructure organization. During RTAs, CISA’s red team simulates real-world malicious cyber operations to assess an organization’s cybersecurity detection and response capabilities. In coordination with the assessed organization, CISA is releasing this Cybersecurity Advisory to detail the red team’s activity—including their tactics, techniques, and procedures (TTPs) and associated network defense activity. Additionally, the advisory contains lessons learned and key findings from the assessment to provide recommendations to network defenders and software manufacturers for improving their organizations’ and customers’ cybersecurity posture.</p>
<p>Within this assessment, the red team (also referred to as ‘the team’) gained initial access through a web shell left from a third party’s previous security assessment. The red team proceeded to move through the demilitarized zone (DMZ) and into the network to fully compromise the organization’s domain and several sensitive business system (SBS) targets. The assessed organization discovered evidence of the red team’s initial activity but failed to act promptly regarding the malicious network traffic through its DMZ or challenge much of the red team’s presence in the organization’s Windows environment.</p>
<p>The red team was able to compromise the domain and SBSs of the organization as it lacked sufficient controls to detect and respond to their activities. The red team’s findings illuminate lessons learned for network defenders and software manufacturers about how to respond to and reduce risk.</p>
<ul>
<li><strong>Lesson Learned: The assessed organization had insufficient technical controls to prevent and detect malicious activity.</strong> The organization relied too heavily on host-based endpoint detection and response (EDR) solutions and did not implement sufficient network layer protections.</li>
<li><strong>Lesson Learned: The organization’s staff require continuous training, support, and resources to implement secure software configurations and detect malicious activity.</strong> Staff need to continuously enhance their technical competency, gain additional institutional knowledge of their systems, and ensure they are provided sufficient resources by management to have the conditions to succeed in protecting their networks.</li>
<li><strong>Lesson Learned: The organization’s leadership minimized the business risk of known attack vectors for the organization.</strong> Leadership deprioritized the treatment of a vulnerability their own cybersecurity team identified, and in their risk-based decision-making, miscalculated the potential impact and likelihood of its exploitation.</li>
</ul>
<p>To reduce risk of similar malicious cyber activity, CISA encourages critical infrastructure organizations to apply the recommendations in the <strong>Mitigations</strong> section of this advisory to ensure security processes and procedures are up to date, effective, and enable timely detection and mitigation of malicious activity.</p>
<p>This document illustrates the outsized burden and costs of compensating for insecure software and hardware borne by critical infrastructure owners and operators. The expectation that owners and operators should maintain the requisite sophisticated cyber defense skills creates undue risk. Technology manufacturers must assume responsibility for product security. Recognizing that insecure software contributes to these identified issues, CISA urges software manufacturers to embrace <a href="https://www.cisa.gov/securebydesign">Secure by Design</a> principles and implement the recommendations in the Mitigations section of this advisory, including those listed below:</p>
<ul>
<li><strong>Embed security into product architecture throughout the entire software development lifecycle&nbsp;</strong>(SDLC).</li>
<li><strong>Eliminate default passwords</strong>.</li>
<li><strong>Mandate MFA</strong>, ideally phishing-resistant MFA, for privileged users and make MFA a default, rather than opt-in, feature.</li>
</ul>
<p>Download the PDF version of this report:</p>





<div class="c-file">
    <div class="c-file__download">
    <a href="/sites/default/files/2024-11/aa24-326a-enhancing-cyber-resilience-insights-from-cisa-red-team-assessment_0.pdf" class="c-file__link" target="_blank">AA24-326A Enhancing Cyber Resilience: Insights from CISA Red Team Assessment of a U.S. Critical Infrastructure Sector Organization</a>
    <span class="c-file__size">(PDF,       823.56 KB
  )</span>
  </div>
</div>
<h2><strong>INTRODUCTION</strong></h2>
<p>CISA has authority to—upon request—provide analyses, expertise, and other technical assistance to critical infrastructure owners and operators and provide operational and timely technical assistance to federal and non-federal entities with respect to cybersecurity risks. (See generally 6 U.S.C. §§ 652[c][5], 659[c][6]). The target organization for this assessment was a critical infrastructure organization in the United States. After receiving a request for an RTA from the organization and coordinating the high-level details of the engagement, CISA conducted the RTA over approximately a three-month period.</p>
<p>During RTAs, a CISA red team simulates real-world threat actors to assess an organization’s cybersecurity detection and response capabilities. During Phase I, the red team attempts to gain and maintain persistent access to an organization’s enterprise network, avoid detection, evade defenses, and access SBSs. During Phase II, the red team attempts to trigger a security response from the organization’s people, processes, and/or technology.</p>
<p>Drafted in coordination with the assessed organization, this advisory details the red team’s activity and TTPs, associated network defense activity, and lessons learned to provide network defenders with recommendations for improving an organization’s cybersecurity posture. The advisory also provides recommendations for software manufacturers to harden their customer networks against malicious activity and reduce the likelihood of domain compromise.</p>
<h2><strong>TECHNICAL DETAILS</strong></h2>
<p><strong>Note:</strong>&nbsp;This advisory uses the <a href="https://attack.mitre.org/versions/v16/matrices/enterprise/">MITRE ATT&amp;CK<sup>®</sup></a><a href="https://attack.mitre.org/versions/v16/matrices/enterprise/" title="Enterprise Matrix"> Matrix for Enterprise</a> framework, version 16. See Appendix: MITRE ATT&amp;CK Tactics and Techniques for a table of the red team’s activity mapped to MITRE ATT&amp;CK tactics and techniques.</p>
<h3>Phase I: Red Team Cyber Threat Activity</h3>
<h4><strong>Overview</strong></h4>
<p>The CISA red team operated without prior knowledge of the organization’s technology assets and began the assessment by conducting open source research on the target organization to gain information about its network [<a href="https://attack.mitre.org/versions/v16/techniques/T1590/">T1590</a>], defensive tools [<a href="https://attack.mitre.org/versions/v16/techniques/T1590/006/">T1590.006</a>], and employees [<a href="https://attack.mitre.org/versions/v16/techniques/T1589/003/">T1589.003</a>]. The red team designed spearphishing campaigns [<a href="https://attack.mitre.org/versions/v16/techniques/T1566/">T1566</a>] tailored to employees most likely to communicate with external parties. The phishing attempts were ultimately unsuccessful—targets ran the payloads [<a href="https://attack.mitre.org/versions/v16/techniques/T1204/">T1204</a>], but their execution did not result in the red team gaining access into the network.</p>
<p>After the failed spearphishing campaigns, the red team continued external reconnaissance of the network [<a href="https://attack.mitre.org/versions/v16/techniques/T1595/">T1595</a>] and discovered a web shell [<a href="https://attack.mitre.org/versions/v16/techniques/T1505/003/">T1505.003</a>] left from a previous Vulnerability Disclosure Program (VDP). The red team used this for initial access [<a href="https://attack.mitre.org/versions/v16/tactics/TA0001/">TA0001</a>] and immediately reported it to the organization’s trusted agents (TAs). The red team leveraged that access to escalate privileges [<a href="https://attack.mitre.org/versions/v16/tactics/TA0004/">TA0004</a>] on the host, discover credential material on a misconfigured Network File System (NFS) share [<a href="https://attack.mitre.org/versions/v16/techniques/T1552/001/">T1552.001</a>], and move from a DMZ to the internal network [<a href="https://attack.mitre.org/versions/v16/tactics/TA0008/">TA0008</a>].</p>
<p>With access to the internal network, the red team gained further access to several SBSs. The red team leveraged a certificate for client authentication [<a href="https://attack.mitre.org/versions/v16/techniques/T1649/">T1649</a>] they discovered on the NFS share to compromise a system configured for <code>Unconstrained Delegation</code>. This allowed the red team to acquire a ticket granting ticket (TGT) for a domain controller [<a href="https://attack.mitre.org/versions/v16/techniques/T1558/001">T1558.001</a>], used to further compromise the domain. The red team leveraged this level of access to exploit SBS targets provided by the organization’s TAs.</p>
<p>The assessed organization detected much of the red team’s activity in their Linux infrastructure after CISA alerted them via other channels to the vulnerability the red team used for initial access. Once given an official notification of a vulnerability, the organization’s network defenders began mitigating the vulnerability. Network defenders removed the site hosting the web shell from the public internet but did not take the server itself offline. A week later, network defenders officially declared an incident once they determined the web shell was used to breach the internal network. For several weeks, network defenders terminated much of the red team’s access until the team maintained implants on only four hosts. Network defenders successfully delayed the red team from accessing many SBSs that required additional positioning, forcing the red team to spend time refortifying their access in the network. Despite these actions, the red team was still able to access a subset of SBSs. Eventually, the red team and TAs decided that the network defenders would stand down to allow the red team to continue its operations in a monitoring mode. In monitoring mode, network defenders would report what they observed of the red team’s access, but not continue to block and terminate it.</p>
<p>See <strong>Figure 1</strong> for a timeline of the red team’s activity with key points access. See the following sections for additional details, including the red team’s TTPs.</p>



<figure class="c-figure c-figure--image" role="group">
  
  <div class="c-figure__media">    <img loading="lazy" src="/sites/default/files/styles/large/public/2024-11/Figure%201%20-%20Timeline%20of%20Red%20Team%20Activity%20%28CI%29.png?itok=nzy7agO2" width="1024" height="567" alt="Figure 1 - Timeline of Red Team Activity (CI)">



</div>
      <figcaption class="c-figure__caption"><em>Figure 1: Timeline of Red Team Cyber Threat Activity</em></figcaption>
  </figure>
<h4><strong>Initial Access</strong></h4>
<p>Following an unsuccessful spearphishing campaign, the red team gained initial access to the target by exploiting an internet-facing Linux web server [<a href="https://attack.mitre.org/versions/v16/techniques/T1190/">T1190</a>] discovered through reconnaissance [<a href="https://attack.mitre.org/versions/v16/tactics/TA0043/">TA0043</a>] of the organization’s external internet protocol (IP) space [<a href="https://attack.mitre.org/versions/v16/techniques/T1590/005/">T1590.005</a>].</p>
<p>The red team first conducted open source research [<a href="https://attack.mitre.org/versions/v16/techniques/T1593/">T1593</a>] to identify information about the organization’s network, including the tools used to protect the network and potential targets for spearphishing. The red team looked for email addresses [<a href="https://attack.mitre.org/versions/v16/techniques/T1589/002/">T1589.002</a>] and names to infer email addresses from the organization’s email syntax (discovered during reconnaissance). Following this action, the red team sent tailored spearphishing emails to 13 targets [<a href="https://attack.mitre.org/versions/v16/techniques/T1566/002/">T1566.002</a>]. Of these 13 targets, one user responded and executed two malicious payloads [<a href="https://attack.mitre.org/versions/v16/techniques/T1204/002/">T1204.002</a>]. However, the payloads failed to bypass a previously undiscovered technical control employed by the victim organization, preventing the red team’s first attempt to gain initial access.</p>
<p>To find an alternate pathway for initial access, the red team conducted reconnaissance with several publicly available tools, such as Shodan and Censys, to discover accessible devices and services on the internet [<a href="https://attack.mitre.org/versions/v16/techniques/T1596/005/">T1596.005</a>]. The red team identified an old and unpatched service with a known XML External Entity (XXE) vulnerability and leveraged a public proof of concept to deploy a web shell. The associated product had an exposed endpoint—one that system administrators should typically block from the public internet—that allowed the red team to discover a preexisting web shell on the organization’s Linux web server. The preexisting web shell allowed the red team to run arbitrary commands on the server [<a href="https://attack.mitre.org/versions/v16/techniques/T1059/">T1059</a>] as a user (WEBUSER1). Using the web shell, the red team identified an open internal proxy server [<a href="https://attack.mitre.org/versions/v16/techniques/T1016/">T1016</a>] to send outbound communications to the internet via Hypertext Transfer Protocol Secure (HTTPS). The red team then downloaded [<a href="https://attack.mitre.org/versions/v16/techniques/T1105/">T1105</a>] and executed a Sliver payload that utilized this proxy to establish command and control (C2) over this host, calling back to their infrastructure [<a href="https://attack.mitre.org/versions/v16/tactics/TA0011/">TA0011</a>].</p>
<p><strong>Note:</strong> Because the web shell and unpatched vulnerability allowed actors to easily gain initial access to the organization, the CISA red team determined this was a critical vulnerability. CISA reported both the vulnerability and the web shell to the organization in an official vulnerability notification so the organization could remediate both issues. Following this notification, the victim organization initiated threat hunting activities, detecting some of the red team’s activity. The TAs determined that network defenders had previously identified and reported the vulnerability but did not remediate it. Further, the TAs found that network defenders were unaware of the web shell and believed it was likely leftover from prior VDP activity. See the <strong>Defense Evasion and Victim Network Defense Activities</strong> section for more information.</p>
<h4><strong>Linux Infrastructure Compromise</strong></h4>
<h5><em>Local Privilege Escalation and Credential Access</em></h5>
<p>The red team then moved laterally from the web server to the organization’s internal network using valid accounts [<a href="https://attack.mitre.org/versions/v16/techniques/T1078/">T1078</a>] as the DMZ was not properly segmented from the organization’s internal domain.</p>
<p>The red team acquired credentials [<a href="https://attack.mitre.org/versions/v16/tactics/TA0006/">TA0006</a>] by first escalating privileges on the web server. The team discovered that WEBUSER1 had excessive <code>sudo</code> rights, allowing them to run some commands as root commands without a password. They used these elevated rights to deploy a new callback with root access [<a href="https://attack.mitre.org/versions/v16/techniques/T1548/003/">T1548.003</a>].</p>
<p>With root access to the web server, the team had full access to the organization’s directories and files on a NFS share with <code>no_root_squash</code> enabled. If <code>no_root_squash</code> is used, remote root users can read and change any file on the shared file system and leave a trojan horse [<a href="https://attack.mitre.org/versions/v16/techniques/T1080/">T1080</a>] for other users to inadvertently execute. On Linux operating systems this option is disabled by default, yet the organization enabled it to accommodate several legacy systems. The organization’s decision to enable the <code>no_root_squash</code> option allowed the red team to read all the files on the NFS share once it escalated its privileges on a single host with the NFS share mounted. This NFS share hosted the home directories of hundreds of Linux users—many of which had privileged access to one or more servers—and was auto-mounted when those users logged into Linux hosts in the environment.</p>
<p>The red team used its escalated privileges to search for private certificate files, Secure Shell (SSH) private keys, passwords, bash command histories [<a href="https://attack.mitre.org/versions/v16/techniques/T1552/003/">T1552.003</a>], and other sensitive data across all user files on the NFS share [<a href="https://attack.mitre.org/versions/v16/techniques/T1039/">T1039</a>]. The team initially obtained 61 private SSH keys [<a href="https://attack.mitre.org/versions/v16/techniques/T1552/004/">T1552.004</a>] and a file containing valid cleartext domain credentials (DOMAINUSER1) that the team used to authenticate to the organization’s domain [<a href="https://attack.mitre.org/versions/v16/techniques/T1078/002/">T1078.002</a>].</p>
<h5><em><strong>Linux Command and Control</strong></em></h5>
<p>In the organization’s Linux environment, the red team leveraged HTTPS connections for C2 [<a href="https://attack.mitre.org/versions/v16/techniques/T1071/001/">T1071.001</a>]. Most of the Linux systems could not directly access the internet, but the red team circumvented this by leveraging an open internal HTTPS proxy [<a href="https://attack.mitre.org/versions/v16/techniques/T1090/001/">T1090.001</a>] for their traffic.</p>
<h5><em><strong>Lateral Movement and Persistence</strong></em></h5>
<p>The red team’s acquisition of SSH private keys generated for user and service accounts facilitated unrestricted lateral movement to other Linux hosts [<a href="https://attack.mitre.org/versions/v16/techniques/T1021/004/">T1021.004</a>]. This acquisition included two highly privileged accounts with root access to hundreds of servers. Within one week of initial access, the team moved to multiple Linux servers and established persistence [<a href="https://attack.mitre.org/versions/v16/tactics/TA0003/">TA0003</a>] on four. The team used a different persistence mechanism on each Linux host, so network defenders would be less likely to discover the red team’s presence on all four hosts. The team temporarily backdoored several scripts run at boot time to maintain persistence [<a href="https://attack.mitre.org/versions/v16/techniques/T1037/">T1037</a>], ensuring the original versions of the scripts were re-enabled once the team successfully achieved persistence. Some of the team’s techniques included modifying preexisting scripts run by the <code>cron</code> utility [<a href="https://attack.mitre.org/versions/v16/techniques/T1053/003/">T1053.003</a>] and <code>ifup-post</code> scripts [<a href="https://attack.mitre.org/versions/v16/techniques/T1037/003/">T1037.003</a>].</p>
<p>Of note, the team gained root access to an SBS-adjacent infrastructure management server that ran Ansible Tower. Access to this Ansible Tower system [<a href="https://attack.mitre.org/versions/v16/techniques/T1072/">T1072</a>] provided easy access to multiple SBSs. The team discovered a root SSH private key on the host, which allowed the team to move to six SBSs across six different sensitive IP ranges. A week after the team provided screenshots of root access to the SBSs to the TAs, the TAs deconflicted the red team’s access to the Ansible Tower system that network defenders discovered. The organization detected the compromise by observing abnormal usage of the root SSH private key. The root SSH private key was used to log into multiple hosts at times and for durations outside of preestablished baselines. In a real compromise, the organization would have had to shut down the server, significantly impacting business operations.</p>
<h4><strong>Windows Domain Controller Compromise</strong></h4>
<p>Approximately two weeks after gaining initial access, the red team compromised a Windows domain controller. This compromise allowed the team to move laterally to all domain-joined Windows hosts within the organization.</p>
<p>To first gain situational awareness about the organization’s environment, the red team exfiltrated Active Directory (AD) information [<a href="https://attack.mitre.org/versions/v16/tactics/TA0010/">TA0010</a>] from a compromised Linux host that had network access to a Domain Controller (DC). The team queried Lightweight Directory Access Protocol (Over SSL)—(LDAPS)—to collect information about users [<a href="https://attack.mitre.org/versions/v16/techniques/T1087/002/">T1087.002</a>], computers [T1018], groups [<a href="https://attack.mitre.org/versions/v16/techniques/T1069/002/">T1069.002</a>], access control lists (ACL), organizational units (OU), and group policy objects (GPO) [<a href="https://attack.mitre.org/versions/v16/techniques/T1615/">T1615</a>]. Unfortunately, the organization did not have detections to monitor for anomalous LDAP traffic. A non-privileged user querying LDAP from the organization’s Linux domain should have alerted network defenders.</p>
<p>The red team observed a total of 42 hosts in AD that were not DCs, but had <code>Unconstrained Delegation</code> enabled. Hosts with <code>Unconstrained Delegation</code> enabled store the Kerberos TGTs of any user that authenticates to them. With sufficient privileges, an actor can obtain those tickets and impersonate associated users. A compromise of any of these hosts could lead to the escalation of privileges within the domain. Network defenders should work with system administrators to determine whether <code>Unconstrained Delegation</code> is necessary for their systems and limit the number of systems with <code>Unconstrained Delegation</code> unnecessarily enabled.</p>
<p>The red team observed insufficient network segmentation between the organization’s Linux and Windows domains. This allowed for Server Message Block (SMB) and Kerberos traffic to a DC and a domain server with <code>Unconstrained Delegation</code> enabled (UDHOST). The team discovered an unprotected Personal Information Exchange (<code>.pfx</code>) file on the NFS home share that they believed was for UDHOST based on its naming convention.</p>
<p>Equipped with the <code>.pfx</code> file, the red team used Rubeus—an open source toolset for Kerberos interaction and abuses—to acquire a TGT and New Technology Local Area Network Manager (NTLM) hash for UDHOST from the DC. The team then used the TGT to abuse the Server-for-User-to-Self (S4U2Self) Kerberos extension to gain administrative access to UDHOST.</p>
<p>The red team leveraged this administrative access to upload a modified version of Rubeus in monitor mode to capture incoming tickets [<a href="https://attack.mitre.org/versions/v16/techniques/T1040/">T1040</a>] on UDHOST with Rubeus’ /monitor command. Next, the team ran DFSCoerce.py to force the domain controller to authenticate to UDHOST [<a href="https://attack.mitre.org/versions/v16/techniques/T1187/">T1187</a>]. The team then downloaded the captured tickets from UDHOST.</p>
<p>With the DC’s TGT, the team used Domain Controller Sync (DCSync) through their Linux tunnels to acquire the hash of several privileged accounts—including domain, enterprise, and server administrators—and the critical <code>krbtgt</code> account [<a href="https://attack.mitre.org/versions/v16/techniques/T1003/006/">T1003.006</a>].</p>
<blockquote><h5><em>Gaining access to AD is not unusual for most of CISA’s Red Team engagements, but it is rare to find network defenders who can secure and monitor it quickly and effectively.</em></h5>
</blockquote>
<p>Once the team harvested the credentials needed, they moved laterally to nearly any system in the Windows domain (see <strong>Figure 2</strong>) through the following steps (hereafter, this combination of techniques is referred to as the “Preferred Lateral Movement Technique”):</p>
<ol>
<li>The team either forged a golden ticket using the <code>krbtgt</code> hash or requested a valid TGT using the hashes they exfiltrated for a specific account before loading the ticket into their session for additional authentication.</li>
<li>The team dropped an inflated Dynamic Link Library (DLL) file associated with legitimate scheduled tasks on the organization’s domain.</li>
<li>When the scheduled task executed on its own or through the red team’s prompting, the DLL hijack launched a C2 implant.</li>
</ol>



<figure class="c-figure c-figure--image" role="group">
  
  <div class="c-figure__media">    <img loading="lazy" src="/sites/default/files/styles/large/public/2024-11/Figure%202%20-%20Movement%20to%20Domain%20Controller.png?itok=pJrfOW9i" width="1024" height="535" alt="Figure 2 - Movement to Domain Controller">



</div>
      <figcaption class="c-figure__caption"><em>Figure 2: Movement to Domain Controller</em></figcaption>
  </figure>
<h5><em>Windows Command and Control</em></h5>
<p>The red team initially established C2 on a workstation over HTTPS before connecting to servers over SMB [<a href="https://attack.mitre.org/versions/v16/techniques/T1071/002/">T1071.002</a>] in the organization’s Windows environment. To connect to certain SBSs later in its activity, the team again relied on HTTPS for C2.</p>
<h4><strong>Post-Exploitation Activity: Gaining Access to SBSs</strong></h4>
<p>After the red team gained persistent access to Linux and Windows systems across the organization’s networks, the team began post-exploitation activities and attempted to access SBSs. The TAs provided a scope of the organization’s Classless Inter-Domain Routing (CIDR) ranges that contained SBSs. The team gained root access to multiple Linux servers in these ranges. The TAs then instructed the red team to exploit its list of primary targets: admin workstations and network ranges that included OT networks. The team only achieved access to the first two targets and did not find a path to the OT networks. While the team was able to affect the integrity of data derived from OT devices and applications, it was unable to find and access the organization’s internal network where the OT devices resided.</p>
<p>To gain access to the SBSs, the team first gained access to Microsoft System Center Configuration Manager (SCCM) servers, which managed most of the domain’s Windows systems. To access the SCCM servers, the team leveraged their AD data to identify administrators [<a href="https://attack.mitre.org/versions/v16/techniques/T1087/002/">T1087</a>] of these targets. One of the users they previously acquired credentials for via <code>DCSync</code> was an administrator on the SCCM servers. The red team then used the Preferred Lateral Movement Technique to eventually authenticate to the SCCM servers. See <strong>Figure 3</strong>.</p>



<figure class="c-figure c-figure--image" role="group">
  
  <div class="c-figure__media">    <img loading="lazy" src="/sites/default/files/styles/large/public/2024-11/Figure%203%20-%20Attack%20Path%20to%20SCCM%20Server%20%28Red%20Team%20CI%29.png?itok=WBoWhXa6" width="1024" height="446" alt="Figure 3 - Attack Path to SCCM Server (Red Team CI)">



</div>
      <figcaption class="c-figure__caption"><em>Figure 3: Attack Path to SCCM Server</em></figcaption>
  </figure>
<h5><em>Admin Workstations</em></h5>
<p>The first specific set of SBS targets provided by the TAs were admin workstations. These systems are used across various sensitive networks external to, or inaccessible from, the internal network where the team already had access. Normally, authorized personnel leverage these administrator workstations to perform administrator functions. CISA’s red team targeted these systems in the hopes that an authorized—but unwitting—user would move the tainted system to another network, resulting in a callback from the sensitive target network.</p>
<p>The red team reviewed AD data to identify these administrator systems. Through their review, the team discovered a subset of Windows workstations that could be identified with a prefix and determined a group likely to have administrative rights to the workstations.</p>
<p>With access to the SCCM server, the red team utilized their Preferred Lateral Movement Technique to gain access to each admin workstation target (see <strong>Figure 4</strong>).</p>



<figure class="c-figure c-figure--image" role="group">
  
  <div class="c-figure__media">    <img loading="lazy" src="/sites/default/files/styles/large/public/2024-11/Figure%204%20-%20Attack%20Path%20from%20SCCM%20Server%20%28Red%20Team%20CI%29.png?itok=fh8jwehh" width="1024" height="473" alt="Figure 4 - Attack Path from SCCM Server (Red Team CI)">



</div>
      <figcaption class="c-figure__caption"><em>Figure 4: Attack Path from SCCM Server to Admin Workstations</em></figcaption>
  </figure>
<p>The red team maintained access to these systems for several weeks, periodically checking where they were communicating from to determine if they had moved to another network. Eventually, the team lost access to these systems without a deconfliction. To the best of the red team’s knowledge, these systems either did not move to new networks or, if they did, those systems no longer had the ability to communicate with red team’s C2 infrastructure.</p>
<h5><em>Additional Host and Other Subnets</em></h5>



<figure class="c-figure c-figure--image" role="group">
  
  <div class="c-figure__media">    <img loading="lazy" src="/sites/default/files/styles/large/public/2024-11/Figure%205%20-%20Attack%20Path%20from%20SCCM%20Server%20%28Red%20Team%20CI%29.png?itok=KMzX82YD" width="1024" height="366" alt="Figure 5 - Attack Path from SCCM Server (Red Team CI)">



</div>
      <figcaption class="c-figure__caption"><em>Figure 5: Attack Path from SCCM Server to Host and Other Subnets</em></figcaption>
  </figure>
<p>After compromising admin workstations, the red team requested that the TAs prioritize additional systems or IP ranges. The TAs provided four CIDR ranges to target:</p>
<ul>
<li>A corporate DMZ that contained a mixture of systems and other subnets.</li>
<li>A second subnet.</li>
<li>A third subnet.&nbsp;</li>
<li>An internal network that contained OT devices.</li>
</ul>
<p>Access to the corporate DMZ was necessary to reach the second and third ranges, and the red team hoped that gaining access to these would facilitate access to the fourth range.</p>
<p>The red team followed a familiar playbook to gain access to these SBSs from another SCCM server. First, the team performed reverse DNS lookups [<a href="https://attack.mitre.org/versions/v16/techniques/T1596/001/">T1596.001</a>] on IP addresses within the ranges the TAs provided. They then scanned SMB port <code>445/TCP</code> [<a href="https://attack.mitre.org/versions/v16/techniques/T1046/">T1046</a>] from a previously compromised SCCM server to discover Windows hosts it could access on the corporate DMZ. The team discovered the server could connect to a host within the target IP range and that the system was running an outdated version of Windows Server 2012 R2. The default configuration of Windows Server 2012 R2 allows unprivileged users to query the group membership of local administrator groups. The red team discovered a user account [<a href="https://attack.mitre.org/versions/v16/techniques/T1069/002/">T1069</a>] by querying the Windows Server 2012 R2 target that was in a database administrator group. The team leveraged its Preferred Lateral Movement Technique to authenticate to the target as that user, then repeated that technique to access a database. This database receives information from OT devices used to feed monitoring dashboards, information which factors into the organization’s decision-making process [<a href="https://attack.mitre.org/versions/v16/techniques/T1213/">T1213</a>].</p>
<p>The new host had several active connections to systems in the internal ranges of the second and third subnets. Reverse domain name system (DNS) lookup requests for these hosts failed to return any results. However, the systems were also running Windows Server 2012 R2. The red team used Windows API calls to <code>NetLocalGroupEnum</code> and <code>NetLocalGroupGetMembers</code> to query local groups [<a href="https://attack.mitre.org/versions/v16/techniques/T1069/001/">T1069.001</a>], revealing the system names for these targets as a result. The red team performed their Preferred Lateral Movement Technique to gain access to these hosts in the second and third provided network ranges.</p>
<p>With access to these subnets, the red team began exploring a path to systems on a private subnet where OT devices resided but failed to locate a path to that fourth subnet.</p>
<h4><em><strong>Corporate Workstations of Critical Infrastructure Administrators and Operators</strong></em></h4>
<p>Next, the red team targeted the corporate workstations of the administrators and operators of the organization’s critical infrastructure. Because the team lacked knowledge of the organization’s OT devices and failed to discover a path to the private subnet where they resided, they instead tried to locate users that interacted with human machine interfaces (HMI). Access to such users could enable the team to access the HMI, which serves as a dashboard for OT.</p>
<p>The red team leveraged its AD data once again, combining this data with user information from SCCM to identify targets by job role and their primary workstation. Then the team targeted the desktop of a critical infrastructure administrator, the workstation of another critical infrastructure administrator, and the workstations of three critical infrastructure operators spread across two geographically disparate sites.</p>
<p>The AD data revealed users in a group that were administrators of all the targets. The red team then repeated their Preferred Lateral Movement Technique and identified a logged-in user connected to a “System Status and Alarm Monitoring” interface. The team discovered credentials to the interface in the user’s home directory, proxied through the system, and accessed the HMI interface over HTTP. The team did not pursue further activity involving the interface because their remaining assessment time was limited. Additionally, they did not discover a way to compromise the underlying OT devices.</p>
<h4><strong>Command and Control</strong></h4>
<p>The team used third-party owned and operated infrastructure and services [T1583] throughout its assessment, including in certain cases for command and control (C2). The tools that the red team obtained included [<a href="https://attack.mitre.org/versions/v16/techniques/T1588/002/">T1588.002</a>]:</p>
<ul>
<li>Sliver, Mythic, Cobalt Strike, and other commercial C2 frameworks.
<ul>
<li>The team maintained multiple command and control servers hosted by several cloud vendors. They configured each server with a different domain and used the servers for communication with compromised hosts. These servers retained all assessment data.</li>
</ul>
</li>
<li>Two commercially available cloud-computing platforms.
<ul>
<li>The team used these platforms to create flexible and dynamic redirect servers to send traffic to the team’s servers [<a href="https://attack.mitre.org/versions/v16/techniques/T1090/002/">T1090.002</a>]. Redirecting servers make it difficult for defenders to attribute assessment activities to the backend team servers. The redirectors use HTTPS reverse proxies to redirect C2 traffic between the target organization’s network and the team servers. The team encrypted all data in transit [<a href="https://attack.mitre.org/versions/v16/techniques/T1573/">T1573</a>] and secured all data at rest through a VPN with multifactor authentication.</li>
</ul>
</li>
<li>Content delivery network (CDN) services.
<ul>
<li>This technique leverages CDNs associated with high-reputation domains, causing malicious traffic to appear directed towards a reputational domain. However, it is redirected to red team-controlled servers. This allows the team to obfuscate some of their C2 traffic.</li>
</ul>
</li>
</ul>
<p>The team used domain fronting [<a href="https://attack.mitre.org/versions/v16/techniques/T1090/004/">T1090.004</a>] to disguise outbound traffic, diversifying communications between the domains and the persistent beacons. This technique (which also leverages CDNs) allows the beacon to appear to connect to third-party domains but instead connects to the team’s redirect server.</p>
<h4><strong>Defense Evasion and Victim Network Defense Activities</strong></h4>
<p>Most of the encounters between the red team and network defenders occurred in the organization’s Linux environment. The red team leveraged Linux tradecraft in an attempt to evade network defenses. In response, network defenders’ threat hunting activities identified some of the team’s presence in their Linux environment. To evade defenses, the red team reordered the process identifier (PID) of its executable processes to appear closer to the kernel and minimize the team’s likelihood of detection. The team also modified its processes [<a href="https://attack.mitre.org/versions/v16/techniques/T1055/">T1055</a>] by changing their names in memory and at execution. In addition, they used Python scripts [<a href="https://attack.mitre.org/versions/v16/techniques/T1059/006/">T1059.006</a>] run in memory [<a href="https://attack.mitre.org/versions/v16/techniques/T1620/">T1620</a>] to avoid on-disk detection. Some of the red team’s Linux persistence techniques included modifying preexisting scripts run by the cron utility and creating backdoors through <code>ifup-post</code> scripts and <code>.bashrc</code>. Network defenders ultimately identified the team’s backdoor in <code>.bashrc</code> [<a href="https://attack.mitre.org/versions/v16/techniques/T1546/004/">T1546.004</a>].</p>
<p>Defenders also successfully detected anomalous activity on their Ansible Tower host and other systems in their Linux environment. The defenders actively analyzed NetFlow data, which helped them identify the red team’s persistence and lateral movement. To mitigate the impact of the red team’s tactics, network defenders would have needed to shut down a critical server as part of their incident response activities. A shut down would have resulted in downtime for hundreds of systems, including SBSs.</p>
<p>The organization’s EDR solutions largely failed to protect the organization. EDR detected only a few of the red team’s payloads in the organization’s Windows and Linux environments. In the instance the EDR protected the organization from the initial phishing payload, it generated an alert that network defenders neither read nor responded to. The red team excelled in bypassing EDR solutions by avoiding the use of basic “known-bad” detections the tools would capture. The team also inflated its file sizes above the upload threshold of the organization’s EDR [<a href="https://attack.mitre.org/versions/v16/techniques/T1027/001/">T1027.001</a>]. In addition, the organization completely lacked any EDR solution in a legacy environment. As such, the red team’s persistence there went undetected throughout the assessment.</p>
<p>Network defenders failed to detect red team activity in the organization’s Windows environment due to a lack of proper identity management. Specifically, network defenders failed to detect and respond to the red team’s <code>S4U2Self</code>, <code>asktgs</code>, <code>dcsync</code>, and golden ticket activity. Had the organization monitored for unusual activity involving AD and Kerberos, they would have detected more red team activity.</p>
<p>Lastly, there were significant deficiencies in the organization’s DMZ that should have detected traffic into the organization’s internal network over the ports used by SMB and LDAPS. Network defenders never properly implemented an intrusion detection system (IDS) or intrusion prevention system (IPS) to monitor the DMZ at the network level. This lack of implementation resulted in a failure to detect malicious network traffic through their DMZ. Further, the red team was able to move laterally through the DMZ because there was an open internal proxy with internet access that enabled the team’s C2.</p>
<h4><strong>Phase II: Red Team Measurable Events Activity</strong></h4>
<p>The red team executed 13 measurable events designed to provoke a response from the people, processes, and technology defending the organization’s network. The red team did not have full visibility into the organization’s responses to these events and lacked the support of a white team to help assess the organization’s responses. See <strong>Table 1</strong> for a description of the events, the organization’s actual response, and key takeaways.</p>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table&nbsp;1: Measurable events</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Measurable Event</th>
<th role="columnheader">Description</th>
<th role="columnheader">MITRE ATT&amp;CK Technique(s)</th>
<th role="columnheader">Organization’s Reported Reactions</th>
<th role="columnheader">Key Takeaways</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Internal Port Scan</strong></td>
<td>Launches a scan from inside the network from a previously gained workstation to enumerate ports on target workstation, server, and domain controller system(s).</td>
<td>Network Service Discovery [<a href="https://attack.mitre.org/versions/v16/techniques/T1046/">T1046</a>]</td>
<td>Identified an AD enumeration tool and temporarily blocked access to one C2 domain, which resulted in the red team temporarily losing access to six SCCM servers.</td>
<td>The organization did not report identifying the port scan. In addition, with proper network segmentation, the scan’s target hosts should not have been able to communicate.</td>
</tr>
<tr>
<td><strong>Comprehensive Active Directory and Host Enumeration</strong></td>
<td>Performs AD enumeration by querying all domain objects from the DC and enumerates trust relationships within the AD Forest, user accounts, and current session information from every domain computer (workstation and server).</td>
<td>
<p>Domain Trust Discovery [<a href="https://attack.mitre.org/versions/v16/techniques/T1482/">T1482</a>]</p>
<p>Account Discovery: Domain Account [<a href="https://attack.mitre.org/versions/v16/techniques/T1087/002/">T1087.002</a>]</p>
<p>System Owner/User Discovery [<a href="https://attack.mitre.org/versions/v16/techniques/T1033/">T1033</a>]</p>
<p>Remote System Discovery [<a href="https://attack.mitre.org/versions/v16/techniques/T1018/">T1018</a>]</p>
</td>
<td>Identified an AD enumeration tool and temporarily blocked access to one C2 domain, which resulted in the red team temporarily losing access to six SCCM servers.</td>
<td>The organization did not report identifying the port scan. In addition, with proper network segmentation, the scan’s target hosts should not have been able to communicate.</td>
</tr>
<tr>
<td><strong>Data Exfiltration – 1 GB of Data</strong></td>
<td>Sends a large amount (1GB) of mock sensitive information to an external host.</td>
<td>Exfiltration Over Alternative Protocol [<a href="https://attack.mitre.org/versions/v16/techniques/T1048/">T1048</a>]</td>
<td>A proxy likely blocked 1GB of data exfiltration during the red team’s first attempt. However, the team’s second attempt was successful when they exfiltrated the data in 100MB blocks. Hours after the data exfiltration, the organization blocked the domain used for C2 and removed access to the compromised host.</td>
<td>Organizations should implement web proxies that contain data threshold restrictions. Furthermore, network defenders need to manually analyze proxy data to determine whether there is legitimate outbound traffic or potentially malicious data exfiltration.</td>
</tr>
<tr>
<td><strong>Malicious Traffic Generation- Workstation to External Host</strong></td>
<td>Establishes a session that originates from a target workstation system directly to an external host over a clear text protocol, such as HTTP.</td>
<td>Application Layer Protocol [<a href="https://attack.mitre.org/versions/v16/techniques/T1071/002/">T1071</a>]</td>
<td>The organization blocked access to the host and the C2 domains the red team used.</td>
<td>The organization blocked the malicious traffic at the network level but did not appear to identify the source workstation.</td>
</tr>
<tr>
<td><strong>Active Directory Account Lockout</strong></td>
<td>Locks out several administrative AD accounts in rapid succession.</td>
<td>Account Access Removal [<a href="https://attack.mitre.org/versions/v16/techniques/T1531/">T1531</a>]</td>
<td>The organization’s password policy locked out the AD accounts. However, within minutes the accounts reopened, likely due to a group policy and/or an automated response.</td>
<td>There was no identified active response from the organization. Organizations should monitor AD account activity in Windows event logs against baselines to detect anomalous and potentially malicious activity.</td>
</tr>
<tr>
<td><strong>Local Admin User Account Creation (workstation)</strong></td>
<td>Creates a local administrator account on a target workstation system.</td>
<td>
<p>Create Account: Local Account [<a href="https://attack.mitre.org/versions/v16/techniques/T1136/001/">T1136.001</a>]</p>
<p>Account Manipulation [<a href="https://attack.mitre.org/versions/v16/techniques/T1098/">T1098</a>]</p>
</td>
<td>An automated response removed the account from local administrator’s group but did not delete it.</td>
<td>Despite group policy objects removing the account, there were no detections for the activity.</td>
</tr>
<tr>
<td><strong>Local Admin User Account Creation (server)</strong></td>
<td>Creates a local administrator account on a target server system.</td>
<td>
<p>Create Account: Local Account [<a href="https://attack.mitre.org/versions/v16/techniques/T1136/001/">T1136.001</a>]</p>
<p>Account Manipulation [<a href="https://attack.mitre.org/versions/v16/techniques/T1098/">T1098</a>]</p>
</td>
<td>An automated response removed the account from local Administrator’s group but did not delete it.</td>
<td>Despite group policy objects removing the account, there were no detections for the activity.</td>
</tr>
<tr>
<td><strong>Active Directory Account Creation</strong></td>
<td>Creates AD accounts and add them to domain admins group</td>
<td>
<p>Create Account: Domain Account [<a href="https://attack.mitre.org/versions/v16/techniques/T1136/002">T1136.002</a>]</p>
<p>Account Manipulation [<a href="https://attack.mitre.org/versions/v16/techniques/T1098/">T1098</a>]</p>
</td>
<td>An alert existed for this action but was disabled at the time the original event was triggered, thus it was undetected. After coordination between the TAs and red team revealed this lapse, the alert was enabled, the red team performed the action once again, and this time, TAs provided a screenshot of the alert from their monitoring dashboards.</td>
<td>Detection tools are only useful when network defenders tune them appropriately and effectively monitor alerts. At first, the organization missed an opportunity to respond to a tool that should have produced a true positive alert because it was misconfigured.</td>
</tr>
<tr>
<td><strong>Domain Admin Lateral Movement—Workstation to Domain Controller and Workstation to Workstation</strong></td>
<td>Compromises a Domain Admin account and uses it to run <a href="https://attack.mitre.org/software/S0029/">PSExec</a> on multiple workstations and domain controllers.</td>
<td>
<p>System Services: Service Execution [<a href="https://attack.mitre.org/versions/v16/techniques/T1569/002/">T1569.002</a>]</p>
<p>Remote Services: SMB/Windows Admin Shares [<a href="https://attack.mitre.org/versions/v16/techniques/T1021/002/">T1021.002</a>]</p>
</td>
<td>None identified.</td>
<td>Detect malicious use of standard tools like PSExec that malicious cyber actors may use for lateral movement by monitoring Windows logs for anomalous activity. In addition, organizations should look for abnormal communications between workstations.</td>
</tr>
<tr>
<td><strong>Malicious Traffic Generation- Domain Controller to External Host</strong></td>
<td>Establishes a session that originates from a target domain controller system directly to an external host over a clear text protocol, such as HTTP.</td>
<td>Application Layer Protocol [<a href="https://attack.mitre.org/versions/v16/techniques/T1071/002/">T1071</a>]</td>
<td>None identified.</td>
<td>DCs should never connect directly to an external host over HTTP. The organization failed to detect and respond to this.</td>
</tr>
<tr>
<td><strong>Trigger Host-Based Protection- Domain Controller</strong></td>
<td>Uploads and executes a well-known (e.g., with a signature) malicious file to a target DC system to generate host-based alerts.</td>
<td>Ingress Tool Transfer [<a href="https://attack.mitre.org/versions/v16/techniques/T1105/">T1105</a>]</td>
<td>Malicious file was removed by host-based endpoint protection system.</td>
<td>Host based detection tools can be helpful in detecting known IOCs. However, organizations should focus on detecting anomalous behavior by monitoring their networks and hosts against good baselines. The blocking of this well-known tool on a DC should trigger an urgent investigation.</td>
</tr>
<tr>
<td><strong>Ransomware Simulation</strong></td>
<td>
<p>Executes simulated ransomware on multiple workstation systems to simulate a ransomware attack.</p>
<p><strong>Note:</strong> This technique does not encrypt files on the target system.</p>
</td>
<td>N/A</td>
<td>Two out of nine users reported the event to defensive staff who identified all hosts that executed the ransomware. Five users likely rebooted their systems when observing the ransomware, one logged off and on, one closed the ransomware application repeatedly and continued working, one locked their screen, and another user exited the ransomware process after two hours.</td>
<td>Security awareness training should provide employees effective tools on how to respond to ransomware activity.</td>
</tr>
</tbody>
</table>
</div>
<h2><strong>LESSONS LEARNED AND KEY FINDINGS</strong></h2>
<p>The red team noted the following lessons learned relevant to all organizations generated from the security assessment of the organization’s network. These findings contributed to the team’s ability to gain persistent access across the organization’s network. See the <strong>Mitigations</strong> section for recommendations on how to mitigate these findings.</p>
<h3>Lesson Learned: Insufficient Technical Controls</h3>
<p><strong>The assessed organization had insufficient technical controls to prevent and detect malicious activity.</strong> The organization relied too heavily on host-based EDR solutions and did not implement sufficient network layer protections.</p>
<ul>
<li><strong>Finding #1: The organization’s perimeter network was not adequately firewalled from its internal network</strong>, which allowed the red team a path through the DMZ to internal networks. A properly configured network should block access to a path from the DMZ to other internal networks.</li>
<li><strong>Finding #2: The organization was too reliant on its host-based tools and lacked network layer protections</strong>, such as well-configured web proxies or intrusion prevention systems (IPS). The organization’s EDR solutions also failed to catch all the red team’s payloads. Below is a list of some of the higher risk activities conducted by the team that were opportunities for detection:
<ul>
<li>Phishing;</li>
<li>Kerberoasting;</li>
<li>Generation and use of golden tickets;</li>
<li>S4U2self abuse;</li>
<li>Anomalous LDAP traffic;</li>
<li>Anomalous NFS enumeration;</li>
<li>Unconstrained Delegation server compromise;</li>
<li>DCSync;</li>
<li>Anomalous account usage during lateral movement;</li>
<li>Anomalous outbound network traffic;</li>
<li>Anomalous outbound SSH connections to the team’s cloud servers from workstations; and</li>
<li>Use of proxy servers from hosts intended to be restricted from internet access.</li>
</ul>
</li>
<li><strong>Finding #3: The organization had insufficient host monitoring in a legacy environment.</strong> The organization had hosts with a legacy operating system without a local EDR solution, which allowed the red team to persist for several months on the hosts undetected.</li>
</ul>
<h3>Lesson Learned: Continuous Training, Support, and Resources</h3>
<p><strong>The organization’s staff requires continuous training, support, and resources to implement secure software configurations and detect malicious activity.</strong> Staff need to continuously enhance their technical competency, gain additional institutional knowledge of their systems, and ensure are provided sufficient resources by management to adequately protect their networks.</p>
<ul>
<li><strong>Finding #4: The organization had multiple systems configured insecurely.&nbsp;</strong>This allowed the red team to compromise, maintain persistence, and further exploit those systems (i.e., access credentials, elevate privileges, and move laterally). Insecure system configurations included:
<ul>
<li><strong>Default server configurations.</strong> The organization used default configurations for hosts with Windows Server 2012 R2, which allows unprivileged users to query membership of local administrator groups. This enabled the red team to identify several standard user accounts with administrative access.<br><strong>Note:</strong> By default, NFS shares change the root user to the <code>nfsnobody</code> user, an unprivileged user account. In this way, users with local root access are prevented from gaining root level access over the mounted NFS share. Here, the organization deviated from the secure by default configuration and implemented the <code>no_root_squash</code> option to support a few legacy systems instead. This deviation from the default allowed the red team to escalate their privileges over the domain.</li>
<li><strong>Hosts with&nbsp;</strong><code><strong>Unconstrained Delegation</strong></code> <strong>enabled unnecessarily.</strong> Hosts with <code>Unconstrained Delegation</code> enabled will store the Kerberos TGTs of all users that authenticate to that host. This affords threat actors the opportunity to steal TGTs, including the TGT for a domain controller, and use them to escalate their privileges over the domain.</li>
<li><strong>Insecure Account Configuration.</strong> The organization had an account running a Linux webserver with excessive privileges. The entry for that user in the <code>sudoers</code> file—which controls user rights—contained paths with wildcards where that user had write access, allowing the team to escalate privileges.<br><strong>Note:</strong> This file should only contain specific paths to executable files that a user needs to run as another user or root, and not a wildcard. Users should not have write access over any file in the <code>sudoers</code> entry.</li>
</ul>
</li>
<li><strong>Finding #5: The red team’s activities generated security alerts that network defenders did not review.</strong> In many instances, the organization relied too heavily on known IOCs and their EDR solutions instead of conducting independent analysis of their network activity compared against baselines.</li>
<li><strong>Finding #6: The organization lacked proper identity management.</strong> Because network defenders did not implement a centralized identity management system in their Linux network, they had to manually query every Linux host for artifacts related to the red team’s lateral movement through SSH. Defenders also failed to detect anomalous activity in their organization’s Windows environment because of poor identity management.</li>
</ul>
<h3>Lesson Learned: Business Risk</h3>
<p><strong>The organization’s leadership minimized the business risk of known attack vectors for their organization.</strong> Leadership deprioritized the treatment of a vulnerability their own cybersecurity team identified, and in their risk-based decision-making, miscalculated the potential impact and likelihood of its exploitation.</p>
<ul>
<li><strong>Finding #7: The organization used known insecure and outdated software</strong>. The red team discovered software on one of the organization’s web servers that was outdated.
<ul>
<li>After their operations, the red team learned the insecure and outdated software was a known security concern. The organization’s security team alerted management to the risks associated this software, but management accepted the risk.</li>
<li>Next, the security team implemented a VDP program, which resulted in a participant exploiting the vulnerability for initial access. The VDP program helped the security team gain management support, and they implemented a web application firewall (WAF) as a compensating control. However, they did not adequately mitigate the vulnerability as they configured the WAF to be only in monitoring mode. The security team either did not have processes (or implement them properly) to scan, assess, and test whether they treated the vulnerability effectively.</li>
</ul>
</li>
</ul>
<h3>Additional Findings</h3>
<p>The red team noted the following additional issues relevant to the security of the organization’s network that contributed to their activity.</p>
<ul>
<li><strong>Unsecured Keys and Credentials.</strong> The organization stored many private keys that lacked password protection, allowing the red team to steal the keys and use them for authentication purposes.
<ul>
<li>The private key of a PFX file was not password protected, allowing the red team to use that certificate to authenticate to active directory, access UDHOST, and eventually compromise the DC. In addition, the organization did not require password protection of SSH private keys.<br><strong>Note:</strong> Without a password protected key, an actor can more easily steal the private key and use it to authenticate to a system through SSH.</li>
<li>The organization had files in a home share that contained cleartext passwords. The accounts included, among other accounts, a system administrator.<br><strong>Note:</strong> The organization appeared to store cleartext passwords in the description and user password sections of Active Directory accounts. These passwords were accessible to all domain users.</li>
</ul>
</li>
<li><strong>Email Address Verification.</strong> The active Microsoft Office 365 configuration allows an unauthenticated external user to validate email addresses through observing error messages in the form of <code>HTTP 302</code> versus <code>HTTP 200</code> responses. This misconfiguration helps threat actors verify email addresses before sending phishing emails.</li>
</ul>
<h4><strong>Noted Strengths</strong></h4>
<p>The red team noted the following technical controls or defensive measures that prevented or hampered offensive actions:</p>
<ul>
<li><strong>Network defenders detected the initial compromise and some red team movement.</strong> After being alerted of the web shell, the organization initiated hunt activities, detected initial access, and tracked some of the red team’s Phase I movements. The organization terminated much of the red team’s access to the organization’s internal network. Of note, once the organization’s defenders discovered the red team’s access, the red team spent significant time and resources continuously refortifying their access to the network.</li>
<li><strong>Host-based EDR solutions prevented initial access by phishing.</strong> The EDR stopped the execution of multiple payloads the red team sent to a user of the organization over a week long period. The organization leveraged two products on workstations, one that was publicly discoverable and another the red team did not learn about until gaining initial access. The product the red team was unaware of, and did not test their payload against, was responsible for stopping the execution of their payloads.</li>
<li><strong>Strong domain password policy.</strong> The organization’s domain password policy neutralized the red team’s attempts to crack hashes and spray passwords. The team was unable to crack any hashes of all 115 service accounts it targeted.</li>
<li><strong>Effective separation of privileges.</strong> The organization’s administrative users had separate accounts for performing privileged actions versus routine activities. This makes privilege escalation more difficult for threat actors.</li>
</ul>
<h2><strong>MITIGATIONS</strong></h2>
<h3>Network Defenders</h3>
<p>CISA recommends organizations implement the recommendations in&nbsp;<strong>Table 2</strong> to mitigate the findings listed in the&nbsp;<strong>Lessons Learned and Key Findings</strong> section of this advisory. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. See CISA’s&nbsp;<a href="https://www.cisa.gov/cpg">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.</p>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 2: Recommendations to Mitigate Identified Findings</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Finding</th>
<th role="columnheader">Recommendation</th>
</tr>
</thead>
<tbody>
<tr>
<td>Insufficient Network Segmentation of DMZ</td>
<td>
<ul>
<li><strong>Apply the principle of least privilege</strong> to limit the exposure of systems and services in the DMZ.</li>
<li><strong>Segment the DMZ&nbsp;</strong>based on the sensitivity of systems and services [<a href="https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#NetworkSegmentation2F">CPG 2.F</a>].</li>
<li><strong>Implement firewalls, access control lists, and intrusion prevention systems.</strong></li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient Network Monitoring</td>
<td>
<ul>
<li><strong>Establish a security baseline of normal network traffic and tune network appliances to detect anomalous behavior.</strong> Tune host-based products to detect anomalous binaries, lateral movement, and persistence techniques [<a href="https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A">CPG 3.A</a>].
<ul>
<li>Create alerts for Windows event log authentication codes, especially for the domain controllers. This could help detect some of the pass-the-ticket, DCSync, and other techniques described in this report.</li>
</ul>
</li>
<li><strong>Reduce the attack surface by limiting the use of legitimate administrative pathways and tools</strong> such as PowerShell, PsExec, and WMI, which are often used by malicious actors. Select one tool to administer the network, enable logging, and disable the others.</li>
</ul>
</td>
</tr>
<tr>
<td>Insufficient Host Monitoring in Legacy Environment</td>
<td>
<ul>
<li><strong>Implement an EDR solution to monitor legacy hosts</strong> for suspicious activity and to detect breaches [<a href="https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#DetectingRelevantThreatsandTTPs3A">CPG 3.A</a>].</li>
</ul>
</td>
</tr>
<tr>
<td>Insecure configurations of systems</td>
<td>
<ul>
<li><strong>Do not use the&nbsp;</strong><code><strong>no_root_squash</strong></code><strong> option.</strong></li>
<li><strong>Remove&nbsp;</strong><code><strong>Unconstrained Delegation</strong></code><strong> from all servers.</strong> If <code>Unconstrained Delegation</code> functionality is required, upgrade operating systems and applications to leverage other approaches (e.g., <code>Constrained Delegation</code>) or explore whether systems can be retired or further isolated from the enterprise.</li>
<li><strong>Consider disabling or limiting NTLM and WDigest Authentication</strong> if possible. Instead, use modern federation protocols (SAML, OIDC) or Kerberos for authentication with AES-256 bit encryption.</li>
<li><strong>If NTLM must be enabled, enable Extended Protection for Authentication (EPA)</strong> to prevent NTLM-relay attacks, and implement SMB signing to prevent certain adversary-in-the-middle and pass-the-hash attacks. See Microsoft <a href="https://support.microsoft.com/en-us/topic/kb5005413-mitigating-ntlm-relay-attacks-on-active-directory-certificate-services-ad-cs-3612b773-4043-4aa9-b23d-b87910cd3429">Mitigating NTLM Relay Attacks on Active Directory Certificate Services (AD CS)</a> and Microsoft <a href="https://learn.microsoft.com/en-us/troubleshoot/windows-server/networking/overview-server-message-block-signing">Overview of Server Message Block signing</a> for more information.</li>
<li><strong>Adhere to the principle of least privilege.</strong></li>
<li><strong>Ensure the</strong> <code><strong>sudoers</strong></code><strong> file contains only essential commands, avoids the use of wildcards, and contains password requirements</strong> for command execution.</li>
</ul>
</td>
</tr>
<tr>
<td>Lack centralized identity management and monitoring systems</td>
<td>
<ul>
<li><strong>From a detection standpoint, focus on identity and access management (IAM)</strong> rather than just network traffic or static host alerts.</li>
<li><strong>Examine who is accessing a resource, what is being accessed, where the request originates, and the time of activity.&nbsp;</strong></li>
</ul>
</td>
</tr>
<tr>
<td>Use of known insecure and outdated software</td>
<td>
<ul>
<li><strong>Keep systems and software up to date</strong>. If updates cannot be uniformly installed, update insecure configurations to meet updated standards.</li>
</ul>
</td>
</tr>
<tr>
<td>Insecure Keys and Credentials</td>
<td>
<ul>
<li><strong>Implement a password protection policy for all certificates that contain private keys</strong> that ensures every certificate is encrypted with a strong password. Ensure all certificates are stored in a secure location [<a href="https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SecureSensitiveData2L">CPG 2.L</a>].</li>
<li><strong>Regularly audit network shares</strong> to identify files that contain passwords accessible to multiple users <a href="https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SecureSensitiveData2L">[CPG 2.L</a>].</li>
<li><strong>Provide training on the proper use of password management tools.</strong></li>
<li><strong>Implement a policy that prohibits storing passwords in plaintext</strong>, and regularly review and audit Active Directory for plain text passwords [<a href="https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#SecureSensitiveData2L">CPG 2.L</a>].</li>
<li>If system administrators must store passwords in active directory, <strong>restrict access to only users who require them</strong>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<p>Additionally, CISA recommends organizations implement the mitigations below to improve their cybersecurity posture:</p>
<ul>
<li><strong>Provide users with regular training and exercises</strong>, specifically related to phishing emails. Phishing accounts for majority of initial access intrusion events.</li>
<li><strong>Enforce&nbsp;</strong><a href="https://www.cisa.gov/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf"><strong>phishing-resistant MFA</strong></a><strong>&nbsp;to the greatest extent possible</strong>.</li>
<li><strong>Reduce the risk of credential compromise</strong> via the following:
<ul>
<li><strong>Place domain admin accounts in the protected users group</strong> to prevent caching of password hashes locally; this also forces Kerberos AES authentication as opposed to weaker RC4 or NTLM authentication protocols.</li>
<li><strong>Upgrade to Windows Server 2019 or greater and Windows 10 or greater</strong>. These versions have security features not included in older operating systems.</li>
</ul>
</li>
</ul>
<p>As a long-term effort, CISA recommends organizations <strong>prioritize implementing a more modern,&nbsp;</strong><a href="https://zerotrust.cyber.gov/federal-zero-trust-strategy/"><strong>Zero Trust</strong></a><strong>&nbsp;network architecture&nbsp;</strong>that:</p>
<ul>
<li>Leverages secure cloud services for key enterprise security capabilities (e.g., identity and access management, endpoint detection and response, and policy enforcement).</li>
<li>Upgrades applications and infrastructure to leverage modern identity management and network access practices.</li>
<li>Centralizes and streamlines access to cybersecurity data to drive analytics for identifying and managing cybersecurity risks.</li>
<li>Invests in technology and personnel to achieve these goals.</li>
</ul>
<h3>Software Manufacturers</h3>
<p>The above mitigations apply to critical infrastructure organizations with on-premises or hybrid environments. Recognizing that insecure software is the root cause of many of these flaws and responsibility should not fall on the end user, CISA urges software manufacturers to implement the following:</p>
<ul>
<li><strong>Embed security into product architecture throughout the entire software development lifecycle&nbsp;</strong>(SDLC).</li>
<li><strong>Eliminate default passwords</strong>. Do not provide software with default passwords. To eliminate default passwords, require administrators to set a strong password [<a href="https://www.cisa.gov/cross-sector-cybersecurity-performance-goals#MinimumPasswordStrength2B">CPG 2.B</a>] during installation and configuration.</li>
<li><strong>Design products so that the compromise of a single security control does not result in compromise of the entire system</strong>. For example, narrowly provision user privileges by default and employ ACLs to reduce the impact of a compromised account. This will make it more difficult for a malicious cyber actor to escalate privileges and move laterally.</li>
<li><strong>Mandate MFA</strong>, ideally <a href="https://www.cisa.gov/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf">phishing-resistant MFA</a>, for privileged users and make MFA a default, rather than opt-in, feature.</li>
<li><strong>Reduce hardening guide size</strong>, with a focus on systems being secure by default. In this scenario, the red team noticed default Windows Server 2012 configurations that allowed them to enumerate privileged accounts.</li>
</ul>
<ol>
<li><strong>Important:&nbsp;</strong>Manufacturers need to implement routine nudges that are built into the product rather than relying on administrators to have the time, expertise, and awareness to interpret hardening guides.</li>
</ol>
<p>These mitigations align with principles provided in the joint guide <a href="https://www.cisa.gov/sites/default/files/2023-10/Shifting-the-Balance-of-Cybersecurity-Risk-Principles-and-Approaches-for-Secure-by-Design-Software.pdf">Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software</a>. CISA urges software manufacturers to take ownership of improving security outcomes of their customers by applying these and other secure by design practices. By adhering to secure by design principles, software manufacturers can make their product lines secure out of the box without requiring customers to spend additional resources making configuration changes, purchasing security software and logs, monitoring, and making routine updates.</p>
<p>For more information on secure by design, see CISA’s <a href="https://www.cisa.gov/securebydesign">Secure by Design</a> webpage. For more information on common misconfigurations and guidance on reducing their prevalence, see the joint advisory <a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-278a">NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations</a>.</p>
<h2><strong>VALIDATE SECURITY CONTROLS</strong></h2>
<p>In addition to applying mitigations, CISA recommends exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. CISA recommends testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see <strong>Table 3</strong> to <strong>Table 16</strong>).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>CISA recommends continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h2><strong>RESOURCES</strong></h2>
<ul>
<li>See CISA’s RedEye tool on <a href="https://github.com/cisagov/RedEye/">CISA’s GitHub page</a>. RedEye is an interactive open source analytic tool used to visualize and report red team command and control activities. See CISA’s <a href="https://www.youtube.com/watch?v=b_ARIVl4BkQ">RedEye tool overview video</a> for more information.</li>
<li>See CISA’s <a href="https://www.cisa.gov/resources-tools/resources/phishing-guidance-stopping-attack-cycle-phase-one">Phishing Guidance</a>.</li>
<li>See <a href="https://www.cisa.gov/securebydesign">CISA’s Secure by Design page</a> to learn more about secure by design principles.</li>
</ul>
<h2><strong>APPENDIX: MITRE&nbsp;ATT&amp;CK TACTICS AND TECHNIQUES</strong></h2>
<p>See <strong>Table 3</strong> to <strong>Table 16</strong> for all referenced red team tactics and techniques in this advisory. <strong>Note:</strong> Unless noted, activity took place during Phase I. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href="https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href="https://github.com/cisagov/Decider/">Decider Tool</a>.</p>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table&nbsp;3: Reconnaissance</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Gather Victim Network Information</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1590/">T1590</a></td>
<td>The team conducted open source research on the target organization to gain information about its network.</td>
</tr>
<tr>
<td>Gather Victim Network Information: Network Security Appliances</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1590/006/">T1590.006</a></td>
<td>The team conducted open source research on the target organization to gain information about its defensive tools.</td>
</tr>
<tr>
<td>Gather Victim Identity Information: Employee Names</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1589/003/">T1589.003</a></td>
<td>The team conducted open source research on the target organization to gain information about its employees.</td>
</tr>
<tr>
<td>Active Scanning</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1595/">T1595</a></td>
<td>The team conducted external reconnaissance of the organization’s network.</td>
</tr>
<tr>
<td>Gather Victim Network Information: IP Addresses</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1590/005/">T1590.005</a></td>
<td>The team conducted reconnaissance of the organization’s external IP space.</td>
</tr>
<tr>
<td>Search Open Websites/Domains</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1593/">T1593</a></td>
<td>The team conducted open source research to identify information about the organization’s network.</td>
</tr>
<tr>
<td>Gather Victim Identity Information: Email Addresses</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1589/002/">T1589.002</a></td>
<td>The team looked for email addresses and names to infer email addresses from the organization’s email syntax.</td>
</tr>
<tr>
<td>Search Open Technical Databases: Scan Databases</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1596/005/">T1596.005</a></td>
<td>The team conducted reconnaissance with several publicly available tools, such as Shodan and Censys, to discover accessible devices and services on the internet.</td>
</tr>
<tr>
<td>Search Open Technical Databases: DNS/Passive DNS</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1596/001/">T1596.001</a></td>
<td>The team performed reverse DNS lookups on IP addresses within the ranges the TAs provided.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 4: Resource Development</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Acquire Infrastructure</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1583/">T1583</a></td>
<td>The team used third-party owned and operated infrastructure and services throughout its assessment.</td>
</tr>
<tr>
<td>Obtain Capabilities: Tool</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1588/002/">T1588.002</a></td>
<td>The team obtained tools (i.e., Sliver, Mythic, Cobalt Strike, and other commercial C2 frameworks).</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 5: Initial Access</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Phishing</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1566/">T1566</a></td>
<td>The team designed spearphishing campaigns tailored to employees of the organization most likely to communicate with external parties.</td>
</tr>
<tr>
<td>Exploit Public-Facing Application</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1190/">T1190</a></td>
<td>The team gained initial access to the target by exploiting an internet-facing Linux web server.</td>
</tr>
<tr>
<td>Phishing: Spearphishing Link</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1566/002/">T1566.002</a></td>
<td>The team sent tailored spearphishing emails to 13 targets.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 6: Execution</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>User Execution</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1204/">T1204</a></td>
<td>The team’s phishing attempts were ultimately unsuccessful; targets ran the payloads, but their execution did not result in the red team gaining access into the network.</td>
</tr>
<tr>
<td>User Execution: Malicious File</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1204/002/">T1204.002</a></td>
<td>One user responded and executed two malicious payloads.</td>
</tr>
<tr>
<td>Command and Scripting Interpreter</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1059/">T1059</a></td>
<td>The preexisting web shell allowed the team to run arbitrary commands on the server.</td>
</tr>
<tr>
<td>Command and Scripting Interpreter: Python</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1059/006/">T1059.006</a></td>
<td>The team used python scripts.</td>
</tr>
<tr>
<td>System Services: Service Execution</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1569/002/">T1569.002</a></td>
<td>The team compromised a Domain Admin account and used it to run PSExec on multiple workstations and a domain controller.</td>
</tr>
<tr>
<td>Remote Services: SMB/Windows Admin Shares</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1021/002/">T1021.002</a></td>
<td>The team established a session that originated from a target.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 7: Persistence</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Server Software Component: Web Shell</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1505/003/">T1505.003</a></td>
<td>After the failed spearphishing campaigns, the red team continued external reconnaissance of the network and discovered a web shell left from a previous VDP program.</td>
</tr>
<tr>
<td>Boot or Logon Initialization Scripts</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1037/">T1037</a></td>
<td>The team backdoored several scripts run at boot time for persistence.</td>
</tr>
<tr>
<td>Scheduled Task/Job: Cron</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1053/003/">T1053.003</a></td>
<td>Some of the team’s techniques included modifying preexisting scripts run by the cron utility and ifup-post scripts.</td>
</tr>
<tr>
<td>Boot or Logon Initialization Scripts: Network Logon Script</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1037/003/">T1037.003</a></td>
<td>The team modified preexisting scripts run by the cron utility and ifup-post scripts.</td>
</tr>
<tr>
<td>Event Triggered Execution: Unix Shell Configuration Modification</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1546/004/">T1546.004</a></td>
<td>The team used a backdoor in .bashrc.</td>
</tr>
<tr>
<td>Create Account: Local Account</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1136/001/">T1136.001</a></td>
<td>During Phase II, the team created a local administrator account on a target server system.</td>
</tr>
<tr>
<td>Account Manipulation</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1098/">T1098</a></td>
<td>During Phase II, the team created a local administrator account on a target server system.</td>
</tr>
<tr>
<td>Create Account: Domain Account</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1136/002">T1136.002</a></td>
<td>The team created AD accounts and added them to domain admins group.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 8: Privilege Escalation</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Valid Accounts</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1078/">T1078</a></td>
<td>The team moved laterally from the web server to the organization’s internal network using valid accounts.</td>
</tr>
<tr>
<td>Abuse Elevation Control Mechanism: Sudo and Sudo Caching</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1548/003/">T1548.003</a></td>
<td>The team discovered that WEBUSER1 had excessive sudo rights, allowing them to run some commands as root without a password.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 9: Defense Evasion</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Process Injection</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1055/">T1055</a></td>
<td>The team modified its processes by changing their names in memory and at execution.</td>
</tr>
<tr>
<td>Reflective Code Loading</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1620/">T1620</a></td>
<td>The team used Python scripts run in memory to avoid on-disk detection.</td>
</tr>
<tr>
<td>Obfuscated Files or Information: Binary Padding</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1027/001/">T1027.001</a></td>
<td>The team inflated its file sizes above the upload threshold of the organization’s EDR.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 10: Credential Access</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Unsecured Credentials: Credentials In Files</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1552/001/">T1552.001</a></td>
<td>The team discovered credential material on a misconfigured Network File System.</td>
</tr>
<tr>
<td>Steal or Forge Authentication Certificates</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1649/">T1649</a></td>
<td>The team used a certificate for client authentication discovered on the NFS share to compromise a system configured for Unconstrained Delegation.</td>
</tr>
<tr>
<td>Steal or Forge Kerberos Tickets: Golden Ticket</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1558/001/">T1558.001</a></td>
<td>The team acquired a ticket granting ticket for a domain controller.</td>
</tr>
<tr>
<td>Unsecured Credentials: Bash History</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1552/003/">T1552.003</a></td>
<td>The team used its escalated privileges to search bash command histories.</td>
</tr>
<tr>
<td>Data from Network Shared Drive</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1039/">T1039</a></td>
<td>The team used its escalated privileges to search for private certificate files, Secure Shell (SSH) private keys, passwords, bash command histories, and other sensitive data across all user files on the NFS share.</td>
</tr>
<tr>
<td>Unsecured Credentials: Private Keys</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1552/004/">T1552.004</a></td>
<td>The team initially obtained 61 private SSH keys and a file containing valid cleartext domain credentials.</td>
</tr>
<tr>
<td>Valid Accounts: Domain Accounts</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1078/002/">T1078.002</a></td>
<td>The team initially obtained 61 private SSH keys and a file containing valid cleartext domain credentials.</td>
</tr>
<tr>
<td>Network Sniffing</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1187/">T1187</a></td>
<td>The red team leveraged this administrative access to upload a modified version of Rubeus in monitor mode to capture incoming tickets.</td>
</tr>
<tr>
<td>OS Credential Dumping: DCSync</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1003/006/">T1003.006</a></td>
<td>The team used DCSync through Linux tunnels to acquire the hash of several privileged accounts.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 11: Discovery</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>System Network Configuration Discovery</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1016/">T1016</a></td>
<td>The team leveraged the web shell to identify an open internal proxy server.</td>
</tr>
<tr>
<td>Account Discovery</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1087/">T1087</a></td>
<td>The team leveraged their AD data to identify administrators of the SCCM servers.</td>
</tr>
<tr>
<td>Account Discovery: Domain Account</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1087/002/">T1087.002</a></td>
<td>The team queried LDAPS to collect information about users, computers, groups, access control lists (ACL), organizational units (OU), and group policy objects (GPO). During Phase II, the team performed AD enumeration by querying all domain objects from the DC, as well as enumerating trust relationships within the AD Forest, user accounts, and current session information from every domain computer.</td>
</tr>
<tr>
<td>Remote System Discovery</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1018/">T1018</a></td>
<td>The team queried LDAPS to collect information about users, computers, groups, access control lists (ACL), organizational units (OU), and group policy objects (GPO). During Phase II, the team performed AD enumeration by querying all domain objects from the DC as well as enumerating trust relationships within the AD Forest, user accounts, and current session information from every domain computer.</td>
</tr>
<tr>
<td>Permission Groups Discovery: Domain Groups</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1069/002/">T1069.002</a></td>
<td>The team queried LDAPS to collect information about users, computers, groups, access control lists (ACL), organizational units (OU), and group policy objects (GPO).</td>
</tr>
<tr>
<td>Group Policy Discovery</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1615/">T1615</a></td>
<td>The team queried LDAPS to collect information about users, computers, groups, access control lists (ACL), organizational units (OU), and group policy objects (GPO).</td>
</tr>
<tr>
<td>Network Service Discovery</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1046/">T1046</a></td>
<td>
<p>The team scanned SMB port 445/TCP.</p>
<p>During Phase II, the team launched a scan from inside the network from a previously gained workstation.</p>
</td>
</tr>
<tr>
<td>Permission Groups Discovery</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1069/002/">T1069</a></td>
<td>The team discovered a user account through querying the Windows Server 2012 R2 target.</td>
</tr>
<tr>
<td>Permission Groups Discovery: Local Groups</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1069/001/">T1069.001</a></td>
<td>The team used Windows API calls to NetLocalGroupEnum and NetLocalGroupGetMembers to query local groups.</td>
</tr>
<tr>
<td>Domain Trust Discovery</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1482/">T1482</a></td>
<td>During Phase II, the team enumerated trust relationships within the AD Forest.</td>
</tr>
<tr>
<td>System Owner/User Discovery</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1033/">T1033</a></td>
<td>During Phase II, the team performed AD enumeration by querying all domain objects from the DC, as well as enumerating trust relationships within the AD Forest, user accounts, and current session information from every domain computer.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 12: Lateral Movement</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Taint Shared Content</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1080/">T1080</a></td>
<td>Since no_root_squash was used, the team could read and change any file on the shared file system and leave trojanized applications.</td>
</tr>
<tr>
<td>Remote Services: SSH</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1021/004/">T1021.004</a></td>
<td>The team’s acquisition of SSH private keys of user and service accounts, including two highly privileged accounts with root access to hundreds of servers, facilitated unrestricted lateral movement to other Linux hosts.</td>
</tr>
<tr>
<td>Software Deployment Tools</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1072/">T1072</a></td>
<td>Access to an Ansible Tower system provided the team easy access to multiple SBSs.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 13: Collection</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data from Information Repositories</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1213/">T1213</a></td>
<td>The team accessed a database that received information from OT devices to feed monitoring dashboards, which the organization used to make decisions.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 14: Command and Control</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Ingress Tool Transfer</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1105/">T1105</a></td>
<td>
<p>The team then downloaded and executed a Sliver payload that utilized this proxy to establish command and control.</p>
<p>During Phase II, the team uploaded and executed a well-known malicious file to a target DC system to generate host-based alerts.</p>
</td>
</tr>
<tr>
<td>Application Layer Protocol: Web Protocols</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1071/001/">T1071.001</a></td>
<td>In the organization’s Linux environment, the red team leveraged HTTPS connections for C2.</td>
</tr>
<tr>
<td>Proxy: Internal Proxy</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1090/001/">T1090.001</a></td>
<td>The team leveraged an open internal HTTPS proxy for their traffic.</td>
</tr>
<tr>
<td>Application Layer Protocol: File Transfer Protocols</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1071/002/">T1071.002</a></td>
<td>The team connected to servers over SMB.</td>
</tr>
<tr>
<td>Proxy: External Proxy</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1090/002/">T1090.002</a></td>
<td>The team used cloud platforms to create flexible and dynamic redirect servers to send traffic to the team’s servers.</td>
</tr>
<tr>
<td>Encrypted Channel</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1573/">T1573</a></td>
<td>The team encrypted all data in transit and secured all data at rest through a VPN with multifactor authentication.</td>
</tr>
<tr>
<td>Proxy: Domain Fronting</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1090/004/">T1090.004</a></td>
<td>The team used domain fronting to disguise outbound traffic.</td>
</tr>
<tr>
<td>Application Layer Protocol</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1071/002/">T1071</a></td>
<td>During Phase II, the team established a session that originated from a target Workstation system directly to an external host over a clear text protocol, such as HTTP.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 15: Exfiltration</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exfiltration Over Alternative Protocol</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1048/">T1048</a></td>
<td>During Phase II, the team sent a large amount of mock sensitive information to an external host.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table&nbsp;16: Impact</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Account Access Removal</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1531/">T1531</a></td>
<td>The team locked out several administrative AD accounts in rapid succession.</td>
</tr>
</tbody>
</table>
</div>

      </div>

  
      </div>
  </div>
      <div class="l-constrain l-page-section--rich-text">
        <div class="l-page-section__content">
          




<div  class="c-field c-field--name-body c-field--type-text-with-summary c-field--label-hidden">
  <div class="c-field__content"><p>This product is provided subject to this&nbsp;<a href="/notification" rel="nofollow noopener" target="_blank" title="Follow link">Notification</a>&nbsp;and this&nbsp;<a href="/privacy-policy" rel="nofollow noopener" target="_blank" title="Follow link">Privacy &amp; Use</a>&nbsp;policy.</p></div></div>

        </div>
      </div>
            </div>
        <div class="l-full__footer">
                              
<div class="l-constrain">
  <div class="l-page-section--rich-text">
    <div class="l-page-section__content">
      <div  class="c-product-survey l-page-section--tags l-page-section--rich-text">
        <div class="c-product-survey__top-bar"></div>
        <div class="c-product-survey__content-area">
          <div class="c-product-survey__icon"></div>
          <div class="c-product-survey__text-area">
            <h2>Please share your thoughts</h2>
            <p>We recently updated our anonymous <a href="https://cisasurvey.gov1.qualtrics.com/jfe/form/SV_9n4TtB8uttUPaM6?product=https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-326a" target="_blank">product survey</a>; we’d welcome your feedback.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
          

          </div>
  </div>
  
  
  
  

      </div>

  
  </main>

  
<footer  class="usa-footer usa-footer--slim" role="contentinfo">
    <div class="usa-footer__return-to-top">
    <div class="l-constrain">
      <a href="#">Return to top</a>
    </div>
  </div>
    <div class="usa-footer__upper">
    <div class="l-constrain">
      







  
  
    

  
            

                                <ul  class="c-menu c-menu--footer-main">
        
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/topics" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/7329">Topics</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/spotlight" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/7330">Spotlight</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/resources-tools" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/7331">Resources &amp; Tools</a>
                        </li>
    
                                            
                                                    
      
      
      <li  class="c-menu__item is-active-trail">
                              <a href="/news-events" class="c-menu__link js-top-level is-active-trail" aria-current="false" data-drupal-link-system-path="node/7332">News &amp; Events</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/careers" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/7323">Careers</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/about" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/6944">About</a>
                        </li>
        </ul>
  

  
  
  
  

    </div>
  </div>
    <div class="usa-footer__main">
    <div class="l-constrain">
      <div class="usa-footer__main-row">
        <div class="usa-footer__brand">
          
<a  class="c-site-name c-site-name--footer" href="/" rel="home" title="Go to the Cybersecurity & Infrastructure Security Agency homepage">
  <span class="c-site-name__text">Cybersecurity &amp; Infrastructure Security Agency</span>
</a>        </div>
        <div class="usa-footer__contact">
                      

                                <ul  class="c-menu c-menu--social">
        
                                            
                                                            
      
      
      <li  class="c-menu__item">
                              <a href="https://www.facebook.com/CISA" class="c-menu__link--facebook c-menu__link js-top-level" aria-current="false">Facebook</a>
                        </li>
    
                                            
                                                            
      
      
      <li  class="c-menu__item">
                              <a href="https://twitter.com/CISAgov" class="c-menu__link--twitter c-menu__link js-top-level" aria-current="false">Twitter</a>
                        </li>
    
                                            
                                                            
      
      
      <li  class="c-menu__item">
                              <a href="https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency" class="c-menu__link--linkedin c-menu__link js-top-level" aria-current="false">LinkedIn</a>
                        </li>
    
                                            
                                                            
      
      
      <li  class="c-menu__item">
                              <a href="https://www.youtube.com/@cisagov" class="c-menu__link--youtube c-menu__link js-top-level" aria-current="false">YouTube</a>
                        </li>
    
                                            
                                                            
      
      
      <li  class="c-menu__item">
                              <a href="https://www.instagram.com/cisagov" class="c-menu__link--instagram c-menu__link js-top-level" aria-current="false">Instagram</a>
                        </li>
    
                                            
                                                            
      
      
      <li  class="c-menu__item">
                              <a href="/subscribe-updates-cisa" class="c-menu__link--rss c-menu__link js-top-level" aria-current="false">RSS</a>
                        </li>
        </ul>
  

                    <div class="usa-footer__contact-info">
            <span>CISA Central</span>
            <a href="tel:1-844-Say-CISA">1-844-Say-CISA</a>
            <a href="mailto:SayCISA@cisa.dhs.gov">SayCISA@cisa.dhs.gov</a>
          </div>
        </div>
      </div>
    </div>
  </div>
    <div class="usa-footer__lower">
    <div class="l-constrain">
      <div class="usa-footer__lower-row">
        <div class="usa-footer__lower-left">
          
<div  class="c-dhs-logo">
  <div class="c-dhs-logo__seal">DHS Seal</div>
  <div class="c-dhs-logo__content">
    <div class="c-dhs-logo__url">CISA.gov</div>
    <div class="c-dhs-logo__text">An official website of the U.S. Department of Homeland Security</div>
  </div>
</div>                      


                                <ul  class="c-menu c-menu--footer">
        
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/about" class="c-menu__link js-top-level" title="About CISA" aria-current="false" data-drupal-link-system-path="node/6944">About CISA</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://www.dhs.gov/performance-financial-reports" class="c-menu__link js-top-level" title="Budget and Performance" aria-current="false">Budget and Performance</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://www.dhs.gov" title="Department of Homeland Security" class="c-menu__link js-top-level" aria-current="false">DHS.gov</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/oedia" title="Equal Opportunity &amp; Accessibility" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/21462">Equal Opportunity &amp; Accessibility</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://www.dhs.gov/foia" class="c-menu__link js-top-level" title="FOIA Requests" aria-current="false">FOIA Requests</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/no-fear-act" title="No FEAR Act Reporting" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/21494">No FEAR Act</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://www.oig.dhs.gov/" class="c-menu__link js-top-level" title="Office of Inspector General" aria-current="false">Office of Inspector General</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/privacy-policy" class="c-menu__link js-top-level" title="Privacy Policy" aria-current="false" data-drupal-link-system-path="node/16115">Privacy Policy</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138" title="Subscribe to Email Updates" class="c-menu__link js-top-level" aria-current="false">Subscribe</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://www.whitehouse.gov/" class="c-menu__link js-top-level" title="The White House" aria-current="false">The White House</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://www.usa.gov/" class="c-menu__link js-top-level" title="USA.gov" aria-current="false">USA.gov</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/forms/feedback" title="Website Feedback" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="forms/feedback">Website Feedback</a>
                        </li>
        </ul>
  

                  </div>
        <div class="usa-footer__lower-right">
          <iframe
            src="https://www.dhs.gov/ntas/"
            name="National Terrorism Advisory System"
            title="National Terrorism Advisory System"
            width="170"
            height="180"
            scrolling="no"
            frameborder="0"
            seamless border="0"
          ></iframe>
        </div>
      </div>
    </div>
  </div>
</footer>

  

</div>

  </div>

    
        <script src="/profiles/cisad8_gov/themes/custom/gesso/dist/js/common.js?sn7rxr"></script>
<script src="/profiles/cisad8_gov/themes/custom/gesso/dist/js/uswds-init.es6.js?sn7rxr"></script>
<script src="/profiles/cisad8_gov/themes/custom/gesso/dist/js/uswds.es6.js?sn7rxr"></script>
<script src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=DHS&amp;subagency=CISA&amp;yt=true" id="_fed_an_ua_tag"></script>
<script src="/modules/contrib/extlink/js/extlink.js?v=10.3.6"></script>
<script src="/modules/contrib/ckeditor_accordion/js/accordion.frontend.min.js?sn7rxr"></script>
<script src="/modules/contrib/responsive_tables_filter/js/tablesaw.min.js?v=1.x"></script>
<script src="/modules/contrib/responsive_tables_filter/js/tablesaw-init.js?v=1.x"></script>
<script src="/modules/contrib/responsive_tables_filter/js/Drupal/ajaxComplete.js?v=1.x"></script>
<script src="/modules/contrib/responsive_tables_filter/js/customizations.js?v=1.x"></script>
<script src="/profiles/cisad8_gov/themes/custom/gesso/dist/js/file.es6.js?sn7rxr"></script>

  </body>
</html>
