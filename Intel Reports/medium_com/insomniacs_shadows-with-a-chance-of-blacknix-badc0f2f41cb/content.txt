<!doctype html><html lang="en"><head><title data-rh="true">Shadows with a chance of BlackNix | by asuna amawaka | insomniacs | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2020-05-06T17:17:16.419Z"/><meta data-rh="true" name="title" content="Shadows with a chance of BlackNix | by asuna amawaka | insomniacs | Medium"/><meta data-rh="true" property="og:title" content="Shadows with a chance of BlackNix"/><meta data-rh="true" property="al:android:url" content="medium://p/badc0f2f41cb"/><meta data-rh="true" property="al:ios:url" content="medium://p/badc0f2f41cb"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="In the last post, I did an analysis of a set of BBSRAT samples that are characterized by unique mutexes (cc5d64b344700e403e2sse, cc5d6b4700e403e2sse, cc5d6b4700032eSS) and calls back to a known…"/><meta data-rh="true" property="og:description" content="A long post on analysis of a variant of BlackNix RATs, which are delivered by a dropper with mutex strings associated with Winnti Group."/><meta data-rh="true" property="og:url" content="https://medium.com/insomniacs/shadows-with-a-chance-of-blacknix-badc0f2f41cb"/><meta data-rh="true" property="al:web:url" content="https://medium.com/insomniacs/shadows-with-a-chance-of-blacknix-badc0f2f41cb"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:602/1*0mWk9dYBhPU8kS7wrC9Cbg.png"/><meta data-rh="true" property="article:author" content="https://medium.com/@asuna.amawaka"/><meta data-rh="true" name="author" content="asuna amawaka"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Shadows with a chance of BlackNix"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/badc0f2f41cb"/><meta data-rh="true" property="twitter:description" content="A long post on analysis of a variant of BlackNix RATs, which are delivered by a dropper with mutex strings associated with Winnti Group."/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:602/1*0mWk9dYBhPU8kS7wrC9Cbg.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="13 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@asuna.amawaka"/><link data-rh="true" rel="canonical" href="https://medium.com/insomniacs/shadows-with-a-chance-of-blacknix-badc0f2f41cb"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/badc0f2f41cb"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*0mWk9dYBhPU8kS7wrC9Cbg.png"],"url":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Fshadows-with-a-chance-of-blacknix-badc0f2f41cb","dateCreated":"2020-05-06T17:17:16.419Z","datePublished":"2020-05-06T17:17:16.419Z","dateModified":"2021-12-14T11:01:09.976Z","headline":"Shadows with a chance of BlackNix - insomniacs - Medium","name":"Shadows with a chance of BlackNix - insomniacs - Medium","description":"In the last post, I did an analysis of a set of BBSRAT samples that are characterized by unique mutexes (cc5d64b344700e403e2sse, cc5d6b4700e403e2sse, cc5d6b4700032eSS) and calls back to a known…","identifier":"badc0f2f41cb","author":{"@type":"Person","name":"asuna amawaka","url":"https:\u002F\u002Fmedium.com\u002F@asuna.amawaka"},"creator":["asuna amawaka"],"publisher":{"@type":"Organization","name":"insomniacs","url":"https:\u002F\u002Fmedium.com\u002Finsomniacs","logo":{"@type":"ImageObject","width":60,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:120\u002F1*IvMGfHVzEtZei5I-JouCvw.jpeg"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Fshadows-with-a-chance-of-blacknix-badc0f2f41cb"}</script><style type="text/css" data-fela-rehydration="575" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="575" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="575" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:rgba(26, 137, 23, 1)}.es{border-color:rgba(26, 137, 23, 1)}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:rgba(26, 137, 23, 1)}.ez:disabled:hover{border-color:rgba(26, 137, 23, 1)}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-left:-12px}.ii{width:28px}.ij{height:28px}.ik{z-index:1}.il{width:24px}.im{margin-bottom:2px}.in{flex-wrap:nowrap}.io{font-size:16px}.ip{line-height:24px}.ir{margin:0 8px}.is{display:inline}.it{color:rgba(26, 137, 23, 1)}.iu{fill:rgba(26, 137, 23, 1)}.ix{flex:0 0 auto}.ja{flex-wrap:wrap}.jd{white-space:pre-wrap}.je{margin-right:4px}.jf{overflow:hidden}.jg{max-height:20px}.jh{text-overflow:ellipsis}.ji{display:-webkit-box}.jj{-webkit-line-clamp:1}.jk{-webkit-box-orient:vertical}.jl{word-break:break-all}.jn{padding-left:8px}.jo{padding-right:8px}.kp> *{flex-shrink:0}.kq{overflow-x:scroll}.kr::-webkit-scrollbar{display:none}.ks{scrollbar-width:none}.kt{-ms-overflow-style:none}.ku{width:74px}.kv{flex-direction:row}.kw{z-index:2}.kz{-webkit-user-select:none}.la{border:0}.lb{fill:rgba(117, 117, 117, 1)}.le{outline:0}.lf{user-select:none}.lg> svg{pointer-events:none}.lp{cursor:progress}.lq{opacity:1}.lr{padding:4px 0}.lu{margin-top:0px}.lv{width:16px}.lx{display:inline-flex}.md{max-width:100%}.me{padding:8px 2px}.mf svg{color:#6B6B6B}.mw{line-height:1.58}.mx{letter-spacing:-0.004em}.my{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nt{margin-bottom:-0.46em}.nu{font-style:italic}.nv{margin-left:auto}.nw{margin-right:auto}.nx{max-width:602px}.od{clear:both}.oe{height:auto}.of{max-width:172px}.og{max-width:998px}.oi{cursor:zoom-in}.oj{z-index:auto}.ol{box-shadow:inset 3px 0 0 0 #242424}.om{padding-left:23px}.on{margin-left:-20px}.oo{max-width:435px}.op{max-width:791px}.oq{max-width:839px}.or{margin-top:10px}.os{max-width:728px}.ov{max-width:853px}.ow{max-width:739px}.ox{max-width:649px}.oy{max-width:492px}.oz{max-width:391px}.pa{max-width:729px}.pb{max-width:726px}.pc{max-width:773px}.pd{max-width:821px}.pe{max-width:1032px}.pf{max-width:980px}.pg{max-width:730px}.ph{max-width:759px}.pi{max-width:860px}.pj{max-width:483px}.pk{max-width:855px}.pl{max-width:1020px}.pm{max-width:562px}.pn{max-width:727px}.po{max-width:733px}.pp{max-width:719px}.pq{max-width:731px}.pr{max-width:470px}.ps{max-width:396px}.pt{max-width:814px}.pu{max-width:825px}.pv{max-width:407px}.pw{max-width:802px}.px{text-decoration:underline}.qd{box-shadow:inset 0 0 0 1px #F2F2F2}.qe{padding:0px}.qf{padding:16px 20px}.qg{flex:1 1 auto}.qi{max-height:40px}.qj{-webkit-line-clamp:2}.qk{margin-top:8px}.ql{margin-top:12px}.qm{width:160px}.qn{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*TZbAWWWB82XEIz-W)}.qo{background-origin:border-box}.qp{background-size:cover}.qq{height:167px}.qr{background-position:50% 50%}.qs{margin-bottom:26px}.qt{margin-top:6px}.qu{margin-right:8px}.qv{padding:8px 16px}.qw{border-radius:100px}.qx{transition:background 300ms ease}.qz{white-space:nowrap}.ra{border-top:none}.rb{margin-bottom:14px}.rc{height:52px}.rd{max-height:52px}.re{box-sizing:content-box}.rf{position:static}.rh{max-width:155px}.rn{margin-right:20px}.rt{height:0px}.ru{margin-bottom:40px}.rv{margin-bottom:48px}.sj{border-radius:2px}.sl{height:64px}.sm{width:64px}.sn{align-self:flex-end}.st{padding-right:4px}.su{font-weight:500}.th{margin-top:16px}.ti{color:rgba(255, 255, 255, 1)}.tj{fill:rgba(255, 255, 255, 1)}.tk{background:rgba(25, 25, 25, 1)}.tl{border-color:rgba(25, 25, 25, 1)}.to:disabled{opacity:0.1}.tp:disabled:hover{background:rgba(25, 25, 25, 1)}.tq:disabled:hover{border-color:rgba(25, 25, 25, 1)}.tr{margin-bottom:54px}.um{gap:18px}.un{fill:rgba(61, 61, 61, 1)}.uz{border-bottom:solid 1px #E5E5E5}.va{margin-top:72px}.vb{padding:24px 0}.vc{margin-bottom:0px}.vd{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:rgba(15, 115, 12, 1)}.eu:hover{border-color:rgba(15, 115, 12, 1)}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.iq:hover{text-decoration:underline}.iv:hover:not(:disabled){color:rgba(15, 115, 12, 1)}.iw:hover:not(:disabled){fill:rgba(15, 115, 12, 1)}.ld:hover{fill:rgba(8, 8, 8, 1)}.ls:hover{fill:#000000}.lt:hover p{color:#000000}.lw:hover{color:#000000}.mg:hover svg{color:#000000}.qy:hover{background-color:#F2F2F2}.sk:hover{background-color:none}.tm:hover{background:#000000}.tn:hover{border-color:#242424}.uo:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.lc:focus{fill:rgba(8, 8, 8, 1)}.mh:focus svg{color:#000000}.ok:focus{transform:scale(1.01)}.lh:active{border-style:none}</style><style type="text/css" data-fela-rehydration="575" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.kb{border-top:solid 1px #F2F2F2}.kc{border-bottom:solid 1px #F2F2F2}.kd{margin:32px 0 0}.ke{padding:3px 8px}.kn> *{margin-right:24px}.ko> :last-child{margin-right:0}.lo{margin-top:0px}.mc{margin:0}.np{font-size:20px}.nq{margin-top:2.14em}.nr{line-height:32px}.ns{letter-spacing:-0.003em}.oc{margin-top:56px}.qc{margin-top:32px}.rm{display:inline-block}.rs{margin-bottom:104px}.rw{flex-direction:row}.rz{margin-bottom:0}.sa{margin-right:20px}.so{max-width:500px}.tf{line-height:24px}.tg{letter-spacing:0}.tw{margin-bottom:72px}.uj{font-size:24px}.uk{line-height:30px}.ul{letter-spacing:-0.016em}.ut{margin:40px 0 0}.uy{padding-top:72px}</style><style type="text/css" data-fela-rehydration="575" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ln{margin-top:0px}.ot{margin-left:auto}.ou{text-align:center}.rl{display:inline-block}</style><style type="text/css" data-fela-rehydration="575" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lm{margin-top:0px}.rk{display:inline-block}</style><style type="text/css" data-fela-rehydration="575" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lk{margin-top:0px}.ll{margin-right:0px}.qh{padding:10px 12px 10px}.rj{display:inline-block}</style><style type="text/css" data-fela-rehydration="575" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.iy{flex-direction:column}.jb{margin-bottom:2px}.jp{margin:24px -24px 0}.jq{padding:0}.kf> *{margin-right:8px}.kg> :last-child{margin-right:24px}.kx{margin-left:0px}.li{margin-top:0px}.lj{margin-right:0px}.ly{margin:0}.mi{border:1px solid #F2F2F2}.mj{border-radius:99em}.mk{padding:0px 16px 0px 12px}.ml{height:38px}.mm{align-items:center}.mo svg{margin-right:8px}.mz{font-size:18px}.na{margin-top:1.56em}.nb{line-height:28px}.nc{letter-spacing:-0.003em}.ny{margin-top:40px}.py{margin-top:24px}.ri{display:inline-block}.ro{margin-bottom:96px}.sh{margin-bottom:20px}.si{margin-right:0}.ss{max-width:100%}.sv{font-size:24px}.sw{line-height:30px}.sx{letter-spacing:-0.016em}.ts{margin-bottom:64px}.tx{font-size:20px}.ty{line-height:24px}.tz{letter-spacing:0}.up{margin:32px 0 0}.uu{padding-top:48px}.mn:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="575" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jx{border-top:solid 1px #F2F2F2}.jy{border-bottom:solid 1px #F2F2F2}.jz{margin:32px 0 0}.ka{padding:3px 8px}.kl> *{margin-right:24px}.km> :last-child{margin-right:0}.mb{margin:0}.nl{font-size:20px}.nm{margin-top:2.14em}.nn{line-height:32px}.no{letter-spacing:-0.003em}.ob{margin-top:56px}.qb{margin-top:32px}.rr{margin-bottom:104px}.rx{flex-direction:row}.sb{margin-bottom:0}.sc{margin-right:20px}.sp{max-width:500px}.td{line-height:24px}.te{letter-spacing:0}.tv{margin-bottom:72px}.ug{font-size:24px}.uh{line-height:30px}.ui{letter-spacing:-0.016em}.us{margin:40px 0 0}.ux{padding-top:72px}</style><style type="text/css" data-fela-rehydration="575" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jt{border-top:solid 1px #F2F2F2}.ju{border-bottom:solid 1px #F2F2F2}.jv{margin:32px 0 0}.jw{padding:3px 8px}.kj> *{margin-right:24px}.kk> :last-child{margin-right:0}.ma{margin:0}.nh{font-size:20px}.ni{margin-top:2.14em}.nj{line-height:32px}.nk{letter-spacing:-0.003em}.oa{margin-top:56px}.qa{margin-top:32px}.rq{margin-bottom:104px}.ry{flex-direction:row}.sd{margin-bottom:0}.se{margin-right:20px}.sq{max-width:500px}.tb{line-height:24px}.tc{letter-spacing:0}.tu{margin-bottom:72px}.ud{font-size:24px}.ue{line-height:30px}.uf{letter-spacing:-0.016em}.ur{margin:40px 0 0}.uw{padding-top:72px}</style><style type="text/css" data-fela-rehydration="575" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iz{flex-direction:column}.jc{margin-bottom:2px}.jr{margin:24px 0 0}.js{padding:0}.kh> *{margin-right:8px}.ki> :last-child{margin-right:8px}.ky{margin-left:0px}.lz{margin:0}.mp{border:1px solid #F2F2F2}.mq{border-radius:99em}.mr{padding:0px 16px 0px 12px}.ms{height:38px}.mt{align-items:center}.mv svg{margin-right:8px}.nd{font-size:18px}.ne{margin-top:1.56em}.nf{line-height:28px}.ng{letter-spacing:-0.003em}.nz{margin-top:40px}.pz{margin-top:24px}.rp{margin-bottom:96px}.sf{margin-bottom:20px}.sg{margin-right:0}.sr{max-width:100%}.sy{font-size:24px}.sz{line-height:30px}.ta{letter-spacing:-0.016em}.tt{margin-bottom:64px}.ua{font-size:20px}.ub{line-height:24px}.uc{letter-spacing:0}.uq{margin:32px 0 0}.uv{padding-top:48px}.mu:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="575" data-fela-type="RULE" media="print">.rg{display:none}</style><style type="text/css" data-fela-rehydration="575" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jm{max-height:none}</style><style type="text/css" data-fela-rehydration="575" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.oh{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbadc0f2f41cb&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fshadows-with-a-chance-of-blacknix-badc0f2f41cb&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---top_nav_layout_nav----------------------------------"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=---top_nav_layout_nav----------------------------------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fshadows-with-a-chance-of-blacknix-badc0f2f41cb&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="4b18" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle"><strong class="al">Shadows with a chance of BlackNix</strong></h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/@asuna.amawaka?source=post_page---byline--badc0f2f41cb--------------------------------"><div class="l ib ic by id ie"><div class="l fj"><img alt="asuna amawaka" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/2*La4u414Rn4EMK1D8bYBRag.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div><div class="ih ab fj"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/insomniacs?source=post_page---byline--badc0f2f41cb--------------------------------" rel="noopener follow"><div class="l ii ij by id ik"><div class="l fj"><img alt="insomniacs" class="l fd by br il cx" src="https://miro.medium.com/v2/resize:fill:48:48/1*IvMGfHVzEtZei5I-JouCvw.jpeg" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="if by l br il fs n ig ft"></div></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="im ab q"><div class="ab q in"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b io ip bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" data-testid="authorName" rel="noopener follow" href="/@asuna.amawaka?source=post_page---byline--badc0f2f41cb--------------------------------">asuna amawaka</a></p></div></div></div><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b io ip du"><span><a class="it iu ah ai aj ak al am an ao ap aq ar ex iv iw" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fddd44ddb6480&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fshadows-with-a-chance-of-blacknix-badc0f2f41cb&amp;user=asuna+amawaka&amp;userId=ddd44ddb6480&amp;source=post_page-ddd44ddb6480--byline--badc0f2f41cb---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l ix"><span class="bf b bg z du"><div class="ab cn iy iz ja"><div class="jb jc ab"><div class="bf b bg z du ab jd"><span class="je l ix">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" data-testid="publicationName" href="https://medium.com/insomniacs?source=post_page---byline--badc0f2f41cb--------------------------------" rel="noopener follow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">insomniacs</p></a></div></div></div><div class="h k"><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span></div></div><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">13 min read</span><div class="jn jo l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">May 6, 2020</span></div></span></div></span></div></div></div><div class="ab cp jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke"><div class="h k w fg fh q"><div class="ku l"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Finsomniacs%2Fbadc0f2f41cb&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fshadows-with-a-chance-of-blacknix-badc0f2f41cb&amp;user=asuna+amawaka&amp;userId=ddd44ddb6480&amp;source=---header_actions--badc0f2f41cb---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q kf kg kh ki kj kk kl km kn ko kp kq kr ks kt"><div class="lv k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbadc0f2f41cb&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fshadows-with-a-chance-of-blacknix-badc0f2f41cb&amp;source=---header_actions--badc0f2f41cb---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lx cn"><div class="l ae"><div class="ab cb"><div class="ly lz ma mb mc md ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="d49d" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">In the last post, I did an analysis of a set of <em class="nu">BBSRAT </em>samples that are characterized by unique mutexes (cc5d64b344700e403e2sse, cc5d6b4700e403e2sse, cc5d6b4700032eSS) and calls back to a known <strong class="my gv">Winnti Group</strong> C2 (bot[.]googlerenewals[.]net). In this post, I’m going to continue on analysis of samples related to the abovementioned mutexes.</p><p id="2a15" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">When I started on this analysis journey, I was hoping to find more <em class="nu">BBSRAT </em>samples. However, the results I arrived at deviated from expectations, and instead I found a set of dropper malware that used the same mutexes as those found in the <em class="nu">BBSRAT </em>samples I analyzed. The final payload dropped by these droppers is the <em class="nu">BlackNix RAT</em>. Pivoting from the C2 called from this<em class="nu"> BlackNix RAT</em>, more<em class="nu"> BlackNix RAT</em>s were found on VirusTotal. I was unable to find any technical blogs on the <em class="nu">BlackNix RAT</em>, and hence, here I am.</p><p id="ca69" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The following diagram is a sort of a “signpost” for this writing.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw nx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*MHd5y30gF8bs6Mp92tUkTw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*MHd5y30gF8bs6Mp92tUkTw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*MHd5y30gF8bs6Mp92tUkTw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*MHd5y30gF8bs6Mp92tUkTw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*MHd5y30gF8bs6Mp92tUkTw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*MHd5y30gF8bs6Mp92tUkTw.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*MHd5y30gF8bs6Mp92tUkTw.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*MHd5y30gF8bs6Mp92tUkTw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*MHd5y30gF8bs6Mp92tUkTw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*MHd5y30gF8bs6Mp92tUkTw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*MHd5y30gF8bs6Mp92tUkTw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*MHd5y30gF8bs6Mp92tUkTw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*MHd5y30gF8bs6Mp92tUkTw.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*MHd5y30gF8bs6Mp92tUkTw.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oe c" width="602" height="330" loading="eager" role="presentation"/></picture></div></figure><p id="a3b6" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Let’s dip into the first dropper!</p><p id="e475" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Project1.exe</strong></p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw of"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*QwHURhL4Pa6y0U5Yk1PcSw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*QwHURhL4Pa6y0U5Yk1PcSw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*QwHURhL4Pa6y0U5Yk1PcSw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*QwHURhL4Pa6y0U5Yk1PcSw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*QwHURhL4Pa6y0U5Yk1PcSw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*QwHURhL4Pa6y0U5Yk1PcSw.png 1100w, https://miro.medium.com/v2/resize:fit:344/format:webp/1*QwHURhL4Pa6y0U5Yk1PcSw.png 344w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 172px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*QwHURhL4Pa6y0U5Yk1PcSw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*QwHURhL4Pa6y0U5Yk1PcSw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*QwHURhL4Pa6y0U5Yk1PcSw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*QwHURhL4Pa6y0U5Yk1PcSw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*QwHURhL4Pa6y0U5Yk1PcSw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*QwHURhL4Pa6y0U5Yk1PcSw.png 1100w, https://miro.medium.com/v2/resize:fit:344/1*QwHURhL4Pa6y0U5Yk1PcSw.png 344w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 172px"/><img alt="" class="bh md oe c" width="172" height="61" loading="lazy" role="presentation"/></picture></div></figure><p id="6a98" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The following files are likely from the same source code: daaa061c88b197fa92d9648306e79875e3a24f392550dacaabd22e5fdba53ebf<br/>75dc821013fe92ef93cefa47d3fe83ad5ce90658e8ef01fcdb0b11652397abec</p><p id="a1d7" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Judging from the executables’ icon, it looks like the samples are written with Borland Delphi 7, and sadly the executables’ compilation timestamps are 1992–06–19 22:22:17 (a well-known bug in Delphi 4–2006). I didn’t really look into which versions are affected by the compilation time bug, because that’s beside the point. The samples’ compilation time can still be deduced with the timestamp within the executables’ resources. (Thanks to Adam’s old post on this[1])</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw nx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*aKeivcG29TIJEm8CJcQZtw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*aKeivcG29TIJEm8CJcQZtw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*aKeivcG29TIJEm8CJcQZtw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*aKeivcG29TIJEm8CJcQZtw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*aKeivcG29TIJEm8CJcQZtw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*aKeivcG29TIJEm8CJcQZtw.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*aKeivcG29TIJEm8CJcQZtw.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*aKeivcG29TIJEm8CJcQZtw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*aKeivcG29TIJEm8CJcQZtw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*aKeivcG29TIJEm8CJcQZtw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*aKeivcG29TIJEm8CJcQZtw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*aKeivcG29TIJEm8CJcQZtw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*aKeivcG29TIJEm8CJcQZtw.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*aKeivcG29TIJEm8CJcQZtw.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oe c" width="602" height="210" loading="lazy" role="presentation"/></picture></div></figure><p id="01e1" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">This dropper will drop 2 files system.exe and systemm.exe into %USERPROFILE%\Pictures, execute them and write a diskshadow.exe to C:\ProgramData\Microsoft\DeviceSync\.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw og"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lt0Tm8Q_L4pVnxhjDHQeLw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lt0Tm8Q_L4pVnxhjDHQeLw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lt0Tm8Q_L4pVnxhjDHQeLw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lt0Tm8Q_L4pVnxhjDHQeLw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lt0Tm8Q_L4pVnxhjDHQeLw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lt0Tm8Q_L4pVnxhjDHQeLw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lt0Tm8Q_L4pVnxhjDHQeLw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*lt0Tm8Q_L4pVnxhjDHQeLw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lt0Tm8Q_L4pVnxhjDHQeLw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lt0Tm8Q_L4pVnxhjDHQeLw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lt0Tm8Q_L4pVnxhjDHQeLw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lt0Tm8Q_L4pVnxhjDHQeLw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lt0Tm8Q_L4pVnxhjDHQeLw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*lt0Tm8Q_L4pVnxhjDHQeLw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="244" loading="lazy" role="presentation"/></picture></div></div></figure><p id="5c11" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><em class="nu">system.exe, systemm.exe</em><br/>SHA256: AEB61477C3F4F2D76AF0DC97B19B01F73C8ADA1FCE91D66E8B0E489E2E807430</p><p id="9316" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Execution of system.exe creates a service to execute itself within the context of the service.</p><blockquote class="ol om on"><p id="d621" class="mw mx nu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">C:\Windows\System32\sc.exe create SESSRV binpath= “cmd /c \”C:\Users\asuna\Pictures\system.exe\””</p><p id="4392" class="mw mx nu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">C:\Windows\System32\net.exe start SESSRV</p></blockquote><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw oo"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Ti5rjzmPD_icyvaL0jPhKQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Ti5rjzmPD_icyvaL0jPhKQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Ti5rjzmPD_icyvaL0jPhKQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Ti5rjzmPD_icyvaL0jPhKQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Ti5rjzmPD_icyvaL0jPhKQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Ti5rjzmPD_icyvaL0jPhKQ.png 1100w, https://miro.medium.com/v2/resize:fit:870/format:webp/1*Ti5rjzmPD_icyvaL0jPhKQ.png 870w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 435px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Ti5rjzmPD_icyvaL0jPhKQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Ti5rjzmPD_icyvaL0jPhKQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Ti5rjzmPD_icyvaL0jPhKQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Ti5rjzmPD_icyvaL0jPhKQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Ti5rjzmPD_icyvaL0jPhKQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Ti5rjzmPD_icyvaL0jPhKQ.png 1100w, https://miro.medium.com/v2/resize:fit:870/1*Ti5rjzmPD_icyvaL0jPhKQ.png 870w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 435px"/><img alt="" class="bh md oe c" width="435" height="454" loading="lazy" role="presentation"/></picture></div></figure><p id="04cf" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The mutexes are set within the execution of system.exe and systemm.exe.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw op"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Y2FGZ3dM6i9TvHfuQmSWiQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Y2FGZ3dM6i9TvHfuQmSWiQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Y2FGZ3dM6i9TvHfuQmSWiQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Y2FGZ3dM6i9TvHfuQmSWiQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Y2FGZ3dM6i9TvHfuQmSWiQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Y2FGZ3dM6i9TvHfuQmSWiQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y2FGZ3dM6i9TvHfuQmSWiQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Y2FGZ3dM6i9TvHfuQmSWiQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Y2FGZ3dM6i9TvHfuQmSWiQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Y2FGZ3dM6i9TvHfuQmSWiQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Y2FGZ3dM6i9TvHfuQmSWiQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Y2FGZ3dM6i9TvHfuQmSWiQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Y2FGZ3dM6i9TvHfuQmSWiQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Y2FGZ3dM6i9TvHfuQmSWiQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="411" loading="lazy" role="presentation"/></picture></div></div></figure><p id="91a9" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">systemm.exe attempts to copy diskshadow.exe to a network location \\TSCLIENT\%userprofile%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\. The sample also attempts to locate and copy a 1.jpg.lnk within the same directory as diskshadow.exe, but this file was not created by the previous dropper.</p><p id="fe51" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">In gist, the sample’s job is to copy the payload diskshadow.exe to a host that is connected to the current victim via RDP and set persistency to run at startup. This is possibly a tool meant for lateral movement within the victim network. The same technique is also found in the execution of the <em class="nu">BBSRAT </em>samples analyzed previously.</p><p id="7e72" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The following screen captures referenced one of the <em class="nu">BBSRAT </em>trinity files, lockdown.dll (MD5: 166D28FF69019D9991EECBD26DC1E266):</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw oq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*SKrUDSx3z8fPQWvQAzvX-g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*SKrUDSx3z8fPQWvQAzvX-g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*SKrUDSx3z8fPQWvQAzvX-g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*SKrUDSx3z8fPQWvQAzvX-g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*SKrUDSx3z8fPQWvQAzvX-g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*SKrUDSx3z8fPQWvQAzvX-g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SKrUDSx3z8fPQWvQAzvX-g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*SKrUDSx3z8fPQWvQAzvX-g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*SKrUDSx3z8fPQWvQAzvX-g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*SKrUDSx3z8fPQWvQAzvX-g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*SKrUDSx3z8fPQWvQAzvX-g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*SKrUDSx3z8fPQWvQAzvX-g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*SKrUDSx3z8fPQWvQAzvX-g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*SKrUDSx3z8fPQWvQAzvX-g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="317" loading="lazy" role="presentation"/></picture></div></div><figcaption class="or ff os nv nw ot ou bf b bg z du">Copy file to network location. Left: system.exe; Right: lockdown.dll</figcaption></figure><p id="907e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The mutexes come into play with the same “usage” as what was seen in the <em class="nu">BBSRAT </em>samples as well.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw ov"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*YTPYqJUa6vKi-gGtkuSfGg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*YTPYqJUa6vKi-gGtkuSfGg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*YTPYqJUa6vKi-gGtkuSfGg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*YTPYqJUa6vKi-gGtkuSfGg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*YTPYqJUa6vKi-gGtkuSfGg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*YTPYqJUa6vKi-gGtkuSfGg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YTPYqJUa6vKi-gGtkuSfGg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*YTPYqJUa6vKi-gGtkuSfGg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*YTPYqJUa6vKi-gGtkuSfGg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*YTPYqJUa6vKi-gGtkuSfGg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*YTPYqJUa6vKi-gGtkuSfGg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*YTPYqJUa6vKi-gGtkuSfGg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*YTPYqJUa6vKi-gGtkuSfGg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*YTPYqJUa6vKi-gGtkuSfGg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="307" loading="lazy" role="presentation"/></picture></div></div><figcaption class="or ff os nv nw ot ou bf b bg z du">One of the places where mutex is set. Left: system.exe; Right: lockdown.dll</figcaption></figure><p id="a608" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Given that even the sleep counter is identical, I would suspect that the two executables might share the same “base code” (or perhaps copied from the same “reference code”). The proximity of their compilation time also suggests that perhaps the same author is behind both executables.</p><p id="820d" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">System.exe: 13 May 2018 19:34:27<br/>Lockdown.dll: 6 May 2018 17:59:24</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw ow"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*UWsrdwWUjqi1mslaSbdDSQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*UWsrdwWUjqi1mslaSbdDSQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*UWsrdwWUjqi1mslaSbdDSQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*UWsrdwWUjqi1mslaSbdDSQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*UWsrdwWUjqi1mslaSbdDSQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*UWsrdwWUjqi1mslaSbdDSQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UWsrdwWUjqi1mslaSbdDSQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*UWsrdwWUjqi1mslaSbdDSQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*UWsrdwWUjqi1mslaSbdDSQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*UWsrdwWUjqi1mslaSbdDSQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*UWsrdwWUjqi1mslaSbdDSQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*UWsrdwWUjqi1mslaSbdDSQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*UWsrdwWUjqi1mslaSbdDSQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*UWsrdwWUjqi1mslaSbdDSQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="332" loading="lazy" role="presentation"/></picture></div></div><figcaption class="or ff os nv nw ot ou bf b bg z du">Same sleep counter. Left: system.exe; Right: lockdown.dll</figcaption></figure><p id="f8d9" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Enough of the dropper, let’s look at the actual evil payload now.</p><p id="6a37" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Diskshadow.exe</strong></p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw ox"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*kUK0Z6e9JjrPslUsOdHvcw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*kUK0Z6e9JjrPslUsOdHvcw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*kUK0Z6e9JjrPslUsOdHvcw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*kUK0Z6e9JjrPslUsOdHvcw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*kUK0Z6e9JjrPslUsOdHvcw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kUK0Z6e9JjrPslUsOdHvcw.png 1100w, https://miro.medium.com/v2/resize:fit:1298/format:webp/1*kUK0Z6e9JjrPslUsOdHvcw.png 1298w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 649px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*kUK0Z6e9JjrPslUsOdHvcw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*kUK0Z6e9JjrPslUsOdHvcw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*kUK0Z6e9JjrPslUsOdHvcw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*kUK0Z6e9JjrPslUsOdHvcw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*kUK0Z6e9JjrPslUsOdHvcw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*kUK0Z6e9JjrPslUsOdHvcw.png 1100w, https://miro.medium.com/v2/resize:fit:1298/1*kUK0Z6e9JjrPslUsOdHvcw.png 1298w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 649px"/><img alt="" class="bh md oe c" width="649" height="217" loading="lazy" role="presentation"/></picture></div><figcaption class="or ff os nv nw ot ou bf b bg z du">UPX section names</figcaption></figure><p id="a2a3" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">With just one look at it, we’d know it’s UPX-packed. So let’s unpack it quickly.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw oy"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*zVgQTOqSpfSUHxnbOYcN7A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*zVgQTOqSpfSUHxnbOYcN7A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*zVgQTOqSpfSUHxnbOYcN7A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*zVgQTOqSpfSUHxnbOYcN7A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*zVgQTOqSpfSUHxnbOYcN7A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*zVgQTOqSpfSUHxnbOYcN7A.png 1100w, https://miro.medium.com/v2/resize:fit:984/format:webp/1*zVgQTOqSpfSUHxnbOYcN7A.png 984w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 492px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*zVgQTOqSpfSUHxnbOYcN7A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*zVgQTOqSpfSUHxnbOYcN7A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*zVgQTOqSpfSUHxnbOYcN7A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*zVgQTOqSpfSUHxnbOYcN7A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*zVgQTOqSpfSUHxnbOYcN7A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*zVgQTOqSpfSUHxnbOYcN7A.png 1100w, https://miro.medium.com/v2/resize:fit:984/1*zVgQTOqSpfSUHxnbOYcN7A.png 984w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 492px"/><img alt="" class="bh md oe c" width="492" height="145" loading="lazy" role="presentation"/></picture></div></figure><p id="8678" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">After unpack:</p><p id="a053" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">MD5: 40835ED7C92F33F7F377D4472228CB65<br/>SHA1: 033E97D4AC3AE3CEC00A206F2AD5CCC922DBD326<br/>SHA256: C5BAB78FCA3DB0CE5FFFF5838A5A4A93D930E715DED1CBD8A5B3CAF0CDCE803C</p><p id="8dfb" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">With the assistance of Procmon, we can see that the binary will drop 2 files, intel.exe and inte.exe into the C:\intel directory. I located the code responsible for creating the files (refer to screen capture below). The binary also sets 2 persistency mechanisms. Note the presence of Simplified Chinese words within the name of the registry key — 更新计划程序 (translates to “ Update Schedule Program”). This is not the only place where Simplified Chinese words are observed.</p><blockquote class="ol om on"><p id="0fd3" class="mw mx nu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">regsetval sz HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run “intel更新计划程序” “c:\intel\inte.exe”’,0</p><p id="bf1d" class="mw mx nu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">shortcut “c:\intel\inte.exe” “~$folder.startup$” “Windows Calculator”</p></blockquote><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw nx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*j1Tz6GjZCgKBHb6pny5Exw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*j1Tz6GjZCgKBHb6pny5Exw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*j1Tz6GjZCgKBHb6pny5Exw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*j1Tz6GjZCgKBHb6pny5Exw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*j1Tz6GjZCgKBHb6pny5Exw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*j1Tz6GjZCgKBHb6pny5Exw.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*j1Tz6GjZCgKBHb6pny5Exw.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*j1Tz6GjZCgKBHb6pny5Exw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*j1Tz6GjZCgKBHb6pny5Exw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*j1Tz6GjZCgKBHb6pny5Exw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*j1Tz6GjZCgKBHb6pny5Exw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*j1Tz6GjZCgKBHb6pny5Exw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*j1Tz6GjZCgKBHb6pny5Exw.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*j1Tz6GjZCgKBHb6pny5Exw.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oe c" width="602" height="498" loading="lazy" role="presentation"/></picture></div><figcaption class="or ff os nv nw ot ou bf b bg z du">Set persistency</figcaption></figure><p id="375f" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The two files dropped are:</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw oz"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Mn1qitvEz1-7fD3IrkQFxQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Mn1qitvEz1-7fD3IrkQFxQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Mn1qitvEz1-7fD3IrkQFxQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Mn1qitvEz1-7fD3IrkQFxQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Mn1qitvEz1-7fD3IrkQFxQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Mn1qitvEz1-7fD3IrkQFxQ.png 1100w, https://miro.medium.com/v2/resize:fit:782/format:webp/1*Mn1qitvEz1-7fD3IrkQFxQ.png 782w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 391px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Mn1qitvEz1-7fD3IrkQFxQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Mn1qitvEz1-7fD3IrkQFxQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Mn1qitvEz1-7fD3IrkQFxQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Mn1qitvEz1-7fD3IrkQFxQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Mn1qitvEz1-7fD3IrkQFxQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Mn1qitvEz1-7fD3IrkQFxQ.png 1100w, https://miro.medium.com/v2/resize:fit:782/1*Mn1qitvEz1-7fD3IrkQFxQ.png 782w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 391px"/><img alt="" class="bh md oe c" width="391" height="66" loading="lazy" role="presentation"/></picture></div></figure><p id="b3c1" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><em class="nu">intel.exe </em><br/>SHA256: 12459A5E9AFDB2DBFF685C8C4E916BB15B34745D56EF5F778DF99416D2749261<br/>This is the NirCmd executable from Nirsoft. NirCmd is a small command-line utility that allows you to do some useful tasks without displaying any user interface.</p><p id="d59e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><em class="nu">inte.exe<br/></em>SHA256: F46520C2284E20C42AFA6E9B90E380735BFDF29817828369D5F1270A887E6979<br/>This is the actual <em class="nu">BlackNix RAT</em>, which is the meat that we want to analyze.</p><p id="4a11" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Both diskshadow.exe and inte.exe are written in Borland Delphi and their compilation datetime stamps are as follow:</p><blockquote class="ol om on"><p id="e4ce" class="mw mx nu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">File: C:\ProgramData\Microsoft\DeviceSync\diskshadow.exe<br/>PE Comp.: 1992–06–19 22:22:17 2A425E19, 708992537<br/>.rsrc comp.: 2018–10–22 22:50:06 4D56B643, 1297528387</p><p id="738d" class="mw mx nu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">File: C:\Intel\inte.exe<br/>PE Comp.: 1992–06–19 22:22:17 2A425E19, 708992537<br/>.rsrc comp.: 2018–10–22 22:49:20 4D56B62A, 1297528362</p></blockquote><p id="7c98" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Judging from the compilation datetimes, they might be the output of a generator. Here, I could also make a guess at the chronological logic of when the files are prepared.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw nx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0mWk9dYBhPU8kS7wrC9Cbg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0mWk9dYBhPU8kS7wrC9Cbg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0mWk9dYBhPU8kS7wrC9Cbg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0mWk9dYBhPU8kS7wrC9Cbg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0mWk9dYBhPU8kS7wrC9Cbg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0mWk9dYBhPU8kS7wrC9Cbg.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*0mWk9dYBhPU8kS7wrC9Cbg.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*0mWk9dYBhPU8kS7wrC9Cbg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0mWk9dYBhPU8kS7wrC9Cbg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0mWk9dYBhPU8kS7wrC9Cbg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0mWk9dYBhPU8kS7wrC9Cbg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0mWk9dYBhPU8kS7wrC9Cbg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0mWk9dYBhPU8kS7wrC9Cbg.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*0mWk9dYBhPU8kS7wrC9Cbg.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oe c" width="602" height="263" loading="lazy" role="presentation"/></picture></div></figure><p id="0fd4" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">inte.exe</strong></p><p id="4151" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">As with my usual style, I will start with a quick look at strings to try to guess the behaviour of the sample, before diving into dynamic and static analysis. Fortunately, the sample contains many helpful and descriptive strings that can help us deduce the features that this RAT provides, including Keylogger, FileManager, ProcessManager etc. Pretty typical RAT stuff.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw pa"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*UP3O-n6o2dkDJRdrt6Nb7A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*UP3O-n6o2dkDJRdrt6Nb7A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*UP3O-n6o2dkDJRdrt6Nb7A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*UP3O-n6o2dkDJRdrt6Nb7A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*UP3O-n6o2dkDJRdrt6Nb7A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*UP3O-n6o2dkDJRdrt6Nb7A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UP3O-n6o2dkDJRdrt6Nb7A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*UP3O-n6o2dkDJRdrt6Nb7A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*UP3O-n6o2dkDJRdrt6Nb7A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*UP3O-n6o2dkDJRdrt6Nb7A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*UP3O-n6o2dkDJRdrt6Nb7A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*UP3O-n6o2dkDJRdrt6Nb7A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*UP3O-n6o2dkDJRdrt6Nb7A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*UP3O-n6o2dkDJRdrt6Nb7A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="521" loading="lazy" role="presentation"/></picture></div></div></figure><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw pb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*54nU-Y5v27AdKTyXKtA-Ig.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*54nU-Y5v27AdKTyXKtA-Ig.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*54nU-Y5v27AdKTyXKtA-Ig.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*54nU-Y5v27AdKTyXKtA-Ig.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*54nU-Y5v27AdKTyXKtA-Ig.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*54nU-Y5v27AdKTyXKtA-Ig.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*54nU-Y5v27AdKTyXKtA-Ig.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*54nU-Y5v27AdKTyXKtA-Ig.png 640w, https://miro.medium.com/v2/resize:fit:720/1*54nU-Y5v27AdKTyXKtA-Ig.png 720w, https://miro.medium.com/v2/resize:fit:750/1*54nU-Y5v27AdKTyXKtA-Ig.png 750w, https://miro.medium.com/v2/resize:fit:786/1*54nU-Y5v27AdKTyXKtA-Ig.png 786w, https://miro.medium.com/v2/resize:fit:828/1*54nU-Y5v27AdKTyXKtA-Ig.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*54nU-Y5v27AdKTyXKtA-Ig.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*54nU-Y5v27AdKTyXKtA-Ig.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="777" loading="lazy" role="presentation"/></picture></div></div></figure><p id="d5bb" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><em class="nu">A YARA rule hit</em></p><p id="1c4f" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The sample happened to match James_inthe_box’s YARA rule[2] on <em class="nu">BlackNix RAT</em>:</p><blockquote class="ol om on"><p id="ec20" class="mw mx nu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">rule BlacknixRAT_bin{</p><p id="7d3d" class="mw mx nu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">meta:<br/>description = “BlacknixRAT”<br/>author = “James_inthe_box”<br/>reference = “https://app.any.run/tasks/e3d845db-09b5-462d-8290-cbb4bb4a505f/&quot;<br/>date = “2019/02”<br/>maltype = “RAT”</p><p id="bb55" class="mw mx nu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">strings:<br/>$string1 = “[Random-Number-Here]”<br/>$string2 = “ScreenCapture”<br/>$string3 = “TScreenSpy”<br/>$string4 = “KeyLogger”<br/>$string5 = “RemoteShell”</p><p id="d212" class="mw mx nu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">condition:<br/>uint16(0) == 0x5A4D and all of ($string*) and filesize &lt; 2000KB</p><p id="c470" class="mw mx nu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">}</p></blockquote><p id="d610" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Based on the strings seen above, the strings that matched the YARA rule did not look unique enough to confirm that this is indeed a <em class="nu">BlackNix </em>RAT. James_inthe_box also provided a snort rule:</p><blockquote class="ol om on"><p id="5c1e" class="mw mx nu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">alert tcp any any -&gt; any 80 (msg:”Blacknix RAT Detected”; flow:established,to_server; content:”|32|”; depth:1; content:”|7c 78 01 6d 8e|”; within:10; reference:url,https://app.any.run/tasks/e3d845db-09b5-462d-8290-cbb4bb4a505f/; classtype:trojan-activity; sid:20166298; rev:1; metadata:created_at 2019_07_18;</p></blockquote><p id="d2f0" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Let’s see what we have in the network data.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw nx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*hqEZjCv8wNRbeZoGJmTPfQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*hqEZjCv8wNRbeZoGJmTPfQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*hqEZjCv8wNRbeZoGJmTPfQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*hqEZjCv8wNRbeZoGJmTPfQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*hqEZjCv8wNRbeZoGJmTPfQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*hqEZjCv8wNRbeZoGJmTPfQ.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*hqEZjCv8wNRbeZoGJmTPfQ.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*hqEZjCv8wNRbeZoGJmTPfQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*hqEZjCv8wNRbeZoGJmTPfQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*hqEZjCv8wNRbeZoGJmTPfQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*hqEZjCv8wNRbeZoGJmTPfQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*hqEZjCv8wNRbeZoGJmTPfQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*hqEZjCv8wNRbeZoGJmTPfQ.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*hqEZjCv8wNRbeZoGJmTPfQ.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oe c" width="602" height="283" loading="lazy" role="presentation"/></picture></div></figure><p id="7d16" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Yup, I see a 7C 78 01 but that’s not an exact match with the pattern in the snort rule. Hang on a second.. 78 01 looks like the ZLIB magic header. There we go!</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw pc"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZzM0Of6IZS8dt653T9Dx0A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZzM0Of6IZS8dt653T9Dx0A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZzM0Of6IZS8dt653T9Dx0A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZzM0Of6IZS8dt653T9Dx0A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZzM0Of6IZS8dt653T9Dx0A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZzM0Of6IZS8dt653T9Dx0A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZzM0Of6IZS8dt653T9Dx0A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ZzM0Of6IZS8dt653T9Dx0A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZzM0Of6IZS8dt653T9Dx0A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZzM0Of6IZS8dt653T9Dx0A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZzM0Of6IZS8dt653T9Dx0A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZzM0Of6IZS8dt653T9Dx0A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZzM0Of6IZS8dt653T9Dx0A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ZzM0Of6IZS8dt653T9Dx0A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="291" loading="lazy" role="presentation"/></picture></div></div></figure><p id="d1bf" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">I noticed some weird characters, which could be indicative of Unicode (maybe Chinese…?). Let’s try.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw pd"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*J0fQBtkbSm8-gEc8ESkWmw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*J0fQBtkbSm8-gEc8ESkWmw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*J0fQBtkbSm8-gEc8ESkWmw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*J0fQBtkbSm8-gEc8ESkWmw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*J0fQBtkbSm8-gEc8ESkWmw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*J0fQBtkbSm8-gEc8ESkWmw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J0fQBtkbSm8-gEc8ESkWmw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*J0fQBtkbSm8-gEc8ESkWmw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*J0fQBtkbSm8-gEc8ESkWmw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*J0fQBtkbSm8-gEc8ESkWmw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*J0fQBtkbSm8-gEc8ESkWmw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*J0fQBtkbSm8-gEc8ESkWmw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*J0fQBtkbSm8-gEc8ESkWmw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*J0fQBtkbSm8-gEc8ESkWmw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="337" loading="lazy" role="presentation"/></picture></div></div></figure><p id="5580" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Indeed! 初始 is translated to mean Initial Start, and “2核2808” might mean 2 Cores (probably referring to the CPU cores). I’ll step through the code that forms up this data in abit. Now, let us try to confirm if this callback belongs to <em class="nu">BlackNix </em>family.</p><p id="0e49" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The YARA and snort rules mentioned above referenced a sample (SHA256: A4DA694DED531EC60CA5A242C554B6A7062E12FF633D34656C4CA9DF86E42DD5). Let’s sidetrack and see what this sample does.</p><p id="ed6c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">This sample is packed with VMProtect, so to save time, I’m just going to execute it and see what happens. Upon execution, a new file phpalpha.exe is created in C:\Intel\ExtremeGraphics\CUI\Resource. Turns out the file has the same hash as the parent binary.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw pe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JuiZrJ2kAsMyLE_cli5e-A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JuiZrJ2kAsMyLE_cli5e-A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JuiZrJ2kAsMyLE_cli5e-A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JuiZrJ2kAsMyLE_cli5e-A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JuiZrJ2kAsMyLE_cli5e-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JuiZrJ2kAsMyLE_cli5e-A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JuiZrJ2kAsMyLE_cli5e-A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*JuiZrJ2kAsMyLE_cli5e-A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JuiZrJ2kAsMyLE_cli5e-A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JuiZrJ2kAsMyLE_cli5e-A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JuiZrJ2kAsMyLE_cli5e-A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JuiZrJ2kAsMyLE_cli5e-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JuiZrJ2kAsMyLE_cli5e-A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*JuiZrJ2kAsMyLE_cli5e-A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="226" loading="lazy" role="presentation"/></picture></div></div></figure><p id="63b2" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The network callback looks like this:</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw pf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*YAn016rFAcUCtlRMbk7mzQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*YAn016rFAcUCtlRMbk7mzQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*YAn016rFAcUCtlRMbk7mzQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*YAn016rFAcUCtlRMbk7mzQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*YAn016rFAcUCtlRMbk7mzQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*YAn016rFAcUCtlRMbk7mzQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YAn016rFAcUCtlRMbk7mzQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*YAn016rFAcUCtlRMbk7mzQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*YAn016rFAcUCtlRMbk7mzQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*YAn016rFAcUCtlRMbk7mzQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*YAn016rFAcUCtlRMbk7mzQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*YAn016rFAcUCtlRMbk7mzQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*YAn016rFAcUCtlRMbk7mzQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*YAn016rFAcUCtlRMbk7mzQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="251" loading="lazy" role="presentation"/></picture></div></div></figure><p id="f3a7" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">We already know that’s a ZLIB header, so let’s use CyberChef to view the inflated data:</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw pg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*sYM9RE7pwwOOko3kQ0Obqg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*sYM9RE7pwwOOko3kQ0Obqg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*sYM9RE7pwwOOko3kQ0Obqg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*sYM9RE7pwwOOko3kQ0Obqg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*sYM9RE7pwwOOko3kQ0Obqg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*sYM9RE7pwwOOko3kQ0Obqg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sYM9RE7pwwOOko3kQ0Obqg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*sYM9RE7pwwOOko3kQ0Obqg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*sYM9RE7pwwOOko3kQ0Obqg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*sYM9RE7pwwOOko3kQ0Obqg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*sYM9RE7pwwOOko3kQ0Obqg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*sYM9RE7pwwOOko3kQ0Obqg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*sYM9RE7pwwOOko3kQ0Obqg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*sYM9RE7pwwOOko3kQ0Obqg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="356" loading="lazy" role="presentation"/></picture></div></div></figure><p id="d3b0" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Interesting. The data structure and keywords are identical. Now I can say that the sample (SHA256: A4DA694DED531EC60CA5A242C554B6A7062E12FF633D34656C4CA9DF86E42DD5) and our sample (inte.exe, SHA256: F46520C2284E20C42AFA6E9B90E380735BFDF29817828369D5F1270A887E6979) belong to the same family. Is it really <em class="nu">BlackNix </em>though?</p><p id="cb74" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><em class="nu">With the C2, everything is easier</em></p><p id="b65b" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">With some help from Google search, I found a copy of a <em class="nu">BlackNix </em>C2 component :D</p><p id="22fb" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The C2 executable comes with the ability to generate the “server” component. This naming convention is common in RATs, where the malware client is typically referred to as the “server”, and the C2 is the “client”.</p><p id="8382" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The following is one of the default profiles loaded with the C2:</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw ph"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*bqFfQBtY3q8JRD6C3B58rQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*bqFfQBtY3q8JRD6C3B58rQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*bqFfQBtY3q8JRD6C3B58rQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*bqFfQBtY3q8JRD6C3B58rQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*bqFfQBtY3q8JRD6C3B58rQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*bqFfQBtY3q8JRD6C3B58rQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bqFfQBtY3q8JRD6C3B58rQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*bqFfQBtY3q8JRD6C3B58rQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*bqFfQBtY3q8JRD6C3B58rQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*bqFfQBtY3q8JRD6C3B58rQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*bqFfQBtY3q8JRD6C3B58rQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*bqFfQBtY3q8JRD6C3B58rQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*bqFfQBtY3q8JRD6C3B58rQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*bqFfQBtY3q8JRD6C3B58rQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="504" loading="lazy" role="presentation"/></picture></div></div></figure><p id="a0a8" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">For the ease of testing, I changed some of the values when generating our test binary. The generator even comes with the option of UPX-packing the generated binary if the user wishes.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw pi"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*P45RQDAjTnaOcusNc0cBQA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*P45RQDAjTnaOcusNc0cBQA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*P45RQDAjTnaOcusNc0cBQA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*P45RQDAjTnaOcusNc0cBQA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*P45RQDAjTnaOcusNc0cBQA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*P45RQDAjTnaOcusNc0cBQA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P45RQDAjTnaOcusNc0cBQA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*P45RQDAjTnaOcusNc0cBQA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*P45RQDAjTnaOcusNc0cBQA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*P45RQDAjTnaOcusNc0cBQA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*P45RQDAjTnaOcusNc0cBQA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*P45RQDAjTnaOcusNc0cBQA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*P45RQDAjTnaOcusNc0cBQA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*P45RQDAjTnaOcusNc0cBQA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="349" loading="lazy" role="presentation"/></picture></div></div></figure><p id="5a24" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Inspecting the strings within the generated binary, we can quickly identify some familiar keywords.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw nx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*uPrOdqOpKvVFgLPdBEMmVg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*uPrOdqOpKvVFgLPdBEMmVg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*uPrOdqOpKvVFgLPdBEMmVg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*uPrOdqOpKvVFgLPdBEMmVg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*uPrOdqOpKvVFgLPdBEMmVg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*uPrOdqOpKvVFgLPdBEMmVg.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*uPrOdqOpKvVFgLPdBEMmVg.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*uPrOdqOpKvVFgLPdBEMmVg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*uPrOdqOpKvVFgLPdBEMmVg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*uPrOdqOpKvVFgLPdBEMmVg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*uPrOdqOpKvVFgLPdBEMmVg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*uPrOdqOpKvVFgLPdBEMmVg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*uPrOdqOpKvVFgLPdBEMmVg.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*uPrOdqOpKvVFgLPdBEMmVg.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oe c" width="602" height="364" loading="lazy" role="presentation"/></picture></div></figure><p id="86c9" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">I’ve written a quick script to read the strings from the default settings. This will come useful later, when comparing these strings across different samples.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw op"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Ouuav4Qi9HuniM3IY5RK7g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Ouuav4Qi9HuniM3IY5RK7g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Ouuav4Qi9HuniM3IY5RK7g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Ouuav4Qi9HuniM3IY5RK7g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Ouuav4Qi9HuniM3IY5RK7g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Ouuav4Qi9HuniM3IY5RK7g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ouuav4Qi9HuniM3IY5RK7g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Ouuav4Qi9HuniM3IY5RK7g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Ouuav4Qi9HuniM3IY5RK7g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Ouuav4Qi9HuniM3IY5RK7g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Ouuav4Qi9HuniM3IY5RK7g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Ouuav4Qi9HuniM3IY5RK7g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Ouuav4Qi9HuniM3IY5RK7g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Ouuav4Qi9HuniM3IY5RK7g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="450" loading="lazy" role="presentation"/></picture></div></div></figure><p id="e894" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Here’s the output of running the script:</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw pj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*NRXMEXBj-L4U4LR7KyFBhg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*NRXMEXBj-L4U4LR7KyFBhg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*NRXMEXBj-L4U4LR7KyFBhg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*NRXMEXBj-L4U4LR7KyFBhg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*NRXMEXBj-L4U4LR7KyFBhg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*NRXMEXBj-L4U4LR7KyFBhg.png 1100w, https://miro.medium.com/v2/resize:fit:966/format:webp/1*NRXMEXBj-L4U4LR7KyFBhg.png 966w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 483px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*NRXMEXBj-L4U4LR7KyFBhg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*NRXMEXBj-L4U4LR7KyFBhg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*NRXMEXBj-L4U4LR7KyFBhg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*NRXMEXBj-L4U4LR7KyFBhg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*NRXMEXBj-L4U4LR7KyFBhg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*NRXMEXBj-L4U4LR7KyFBhg.png 1100w, https://miro.medium.com/v2/resize:fit:966/1*NRXMEXBj-L4U4LR7KyFBhg.png 966w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 483px"/><img alt="" class="bh md oe c" width="483" height="256" loading="lazy" role="presentation"/></picture></div></figure><p id="705f" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">It appears that these SETTINGS strings have nothing to do with the configuration set when generating the binary. The default connection password within the C2 is “admin” and notice that even if I changed the password when generating the binary, the new password does not get inserted into this SETTINGS data. These may be part of a “stub” that comes with the C2 executable and inserted into every generated binary. I think this may be a helpful piece of information when trying to identify if a set of <em class="nu">BlackNix RAT</em>s is communicating with the same C2 executable (or at least the same version).</p><p id="037f" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Take a look at the network communications.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw pk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*nHruYjx5aljRm5UMDW8fQQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*nHruYjx5aljRm5UMDW8fQQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*nHruYjx5aljRm5UMDW8fQQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*nHruYjx5aljRm5UMDW8fQQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*nHruYjx5aljRm5UMDW8fQQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*nHruYjx5aljRm5UMDW8fQQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nHruYjx5aljRm5UMDW8fQQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*nHruYjx5aljRm5UMDW8fQQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*nHruYjx5aljRm5UMDW8fQQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*nHruYjx5aljRm5UMDW8fQQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*nHruYjx5aljRm5UMDW8fQQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*nHruYjx5aljRm5UMDW8fQQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*nHruYjx5aljRm5UMDW8fQQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*nHruYjx5aljRm5UMDW8fQQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="213" loading="lazy" role="presentation"/></picture></div></div></figure><p id="8a3b" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">First thing that I noticed was the difference in the way the “Processor” information is being formatted. Remember there were some Chinese words (2核2808) that I thought refers to Processor Cores? In the data sent from this test binary, the processor information was simply a “2808” (referring to 2808 Mhz, which is indeed the setup of my VM).</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw pl"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JRCe3PoU0fA8CPMEsMYduQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JRCe3PoU0fA8CPMEsMYduQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JRCe3PoU0fA8CPMEsMYduQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JRCe3PoU0fA8CPMEsMYduQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JRCe3PoU0fA8CPMEsMYduQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JRCe3PoU0fA8CPMEsMYduQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JRCe3PoU0fA8CPMEsMYduQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*JRCe3PoU0fA8CPMEsMYduQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JRCe3PoU0fA8CPMEsMYduQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JRCe3PoU0fA8CPMEsMYduQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JRCe3PoU0fA8CPMEsMYduQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JRCe3PoU0fA8CPMEsMYduQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JRCe3PoU0fA8CPMEsMYduQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*JRCe3PoU0fA8CPMEsMYduQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="159" loading="lazy" role="presentation"/></picture></div></div><figcaption class="or ff os nv nw ot ou bf b bg z du">Connected victim on C2 dashboard</figcaption></figure><p id="766b" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Let’s get back to the sample we have at hand.</p><p id="a51d" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">I did an in-depth analysis of how the first beacon’s data structure is formed within inte.exe.</p><p id="c150" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Earlier I mentioned some SETTINGS strings. These are the strings that are populated into a data structure and some of these values are later copied into the first beacon data.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw nx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*p6GBS5q2LN1fYjUEIjn5GA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*p6GBS5q2LN1fYjUEIjn5GA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*p6GBS5q2LN1fYjUEIjn5GA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*p6GBS5q2LN1fYjUEIjn5GA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*p6GBS5q2LN1fYjUEIjn5GA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*p6GBS5q2LN1fYjUEIjn5GA.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*p6GBS5q2LN1fYjUEIjn5GA.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*p6GBS5q2LN1fYjUEIjn5GA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*p6GBS5q2LN1fYjUEIjn5GA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*p6GBS5q2LN1fYjUEIjn5GA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*p6GBS5q2LN1fYjUEIjn5GA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*p6GBS5q2LN1fYjUEIjn5GA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*p6GBS5q2LN1fYjUEIjn5GA.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*p6GBS5q2LN1fYjUEIjn5GA.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oe c" width="602" height="680" loading="lazy" role="presentation"/></picture></div><figcaption class="or ff os nv nw ot ou bf b bg z du">Reading strings from SETTINGS</figcaption></figure><p id="7d59" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Let’s compare the default SETTINGS strings found in the generated <em class="nu">BlackNix </em>binary and inte.exe.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw pm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*vEpGjGUd9LijktzYXiNqVw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*vEpGjGUd9LijktzYXiNqVw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*vEpGjGUd9LijktzYXiNqVw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*vEpGjGUd9LijktzYXiNqVw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*vEpGjGUd9LijktzYXiNqVw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*vEpGjGUd9LijktzYXiNqVw.png 1100w, https://miro.medium.com/v2/resize:fit:1124/format:webp/1*vEpGjGUd9LijktzYXiNqVw.png 1124w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 562px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*vEpGjGUd9LijktzYXiNqVw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*vEpGjGUd9LijktzYXiNqVw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*vEpGjGUd9LijktzYXiNqVw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*vEpGjGUd9LijktzYXiNqVw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*vEpGjGUd9LijktzYXiNqVw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*vEpGjGUd9LijktzYXiNqVw.png 1100w, https://miro.medium.com/v2/resize:fit:1124/1*vEpGjGUd9LijktzYXiNqVw.png 1124w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 562px"/><img alt="" class="bh md oe c" width="562" height="478" loading="lazy" role="presentation"/></picture></div></figure><p id="84fe" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The following code is responsible for building the structure to be sent in the first beacon:</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw pn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ClTl9NK43Prvv7NG58aHUg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ClTl9NK43Prvv7NG58aHUg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ClTl9NK43Prvv7NG58aHUg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ClTl9NK43Prvv7NG58aHUg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ClTl9NK43Prvv7NG58aHUg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ClTl9NK43Prvv7NG58aHUg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ClTl9NK43Prvv7NG58aHUg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ClTl9NK43Prvv7NG58aHUg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ClTl9NK43Prvv7NG58aHUg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ClTl9NK43Prvv7NG58aHUg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ClTl9NK43Prvv7NG58aHUg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ClTl9NK43Prvv7NG58aHUg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ClTl9NK43Prvv7NG58aHUg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ClTl9NK43Prvv7NG58aHUg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="804" loading="lazy" role="presentation"/></picture></div></div></figure><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw po"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZwyWtcNJOvpPEn67zlzepQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZwyWtcNJOvpPEn67zlzepQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZwyWtcNJOvpPEn67zlzepQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZwyWtcNJOvpPEn67zlzepQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZwyWtcNJOvpPEn67zlzepQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZwyWtcNJOvpPEn67zlzepQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZwyWtcNJOvpPEn67zlzepQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ZwyWtcNJOvpPEn67zlzepQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZwyWtcNJOvpPEn67zlzepQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZwyWtcNJOvpPEn67zlzepQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZwyWtcNJOvpPEn67zlzepQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZwyWtcNJOvpPEn67zlzepQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZwyWtcNJOvpPEn67zlzepQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ZwyWtcNJOvpPEn67zlzepQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="828" loading="lazy" role="presentation"/></picture></div></div></figure><p id="b15a" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The following is the deduced first beacon’s data structure sent from the inte.exe to its C2.</p><blockquote class="ol om on"><p id="4d9b" class="mw mx nu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">OnConnect|Default 初始|Username|Username|Computer Name|IP Address|Hardcoded Space|Locale|Is Machine Idle?|Locale|Language|Account Privilege|Processor|Memory|Foreground Window Text|OS|Default False|Default False|%Root%|%Desktop%|%MyDocuments%|%AppData%|Locale|Server authentication password|ProdID, InstallDate|</p></blockquote><p id="9c6a" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Now we can play spot-the-differences. We can guess what each of these fields mean by looking at what can be seen on the dashboard, without reverse engineering the binary.</p><p id="f321" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The following is the deduced first beacon’s data structure sent from the test <em class="nu">BlackNix </em>binary.</p><blockquote class="ol om on"><p id="4570" class="mw mx nu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">OnConnect|Assigned Group|Assigned Name|Username|Computer Name|IP Address|Webcam Installed?|C2 Version|?|Locale|Language|Account Privilege|Processor|Memory|OS|True/False?|True/False?|%Root%|%Desktop%|%MyDocuments%|%AppData%|Locale|Server authentication password|?|</p></blockquote><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw pp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*DHauffknFC2NLfpPGyuaQw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*DHauffknFC2NLfpPGyuaQw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*DHauffknFC2NLfpPGyuaQw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*DHauffknFC2NLfpPGyuaQw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*DHauffknFC2NLfpPGyuaQw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*DHauffknFC2NLfpPGyuaQw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DHauffknFC2NLfpPGyuaQw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*DHauffknFC2NLfpPGyuaQw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*DHauffknFC2NLfpPGyuaQw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*DHauffknFC2NLfpPGyuaQw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*DHauffknFC2NLfpPGyuaQw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*DHauffknFC2NLfpPGyuaQw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*DHauffknFC2NLfpPGyuaQw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*DHauffknFC2NLfpPGyuaQw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="641" loading="lazy" role="presentation"/></picture></div></div><figcaption class="or ff os nv nw ot ou bf b bg z du">Comparison of fields within data structure sent to C2</figcaption></figure><p id="803e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><em class="nu">Yes! inte.exe is a BlackNix RAT, but has a different/modified C2 component?</em></p><p id="97c0" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">What I did above proved that the inte.exe sample is indeed a <em class="nu">BlackNix RAT</em>, judging from the highly similar data structure within the initial beacon and the similarities found within the executables. However, since some fields in the communicated data are interpreted differently, I’m guessing there is a customised C2 that the adversary is using. I am not even able to tell the version number of the C2 from the sample, perhaps it is not important for the adversary. However, the SETTINGS strings found within the samples could be a way for us to differentiate variants.</p><p id="22f8" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">So far, I’ve walked through the analysis of this set of files:</p><p id="25de" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">· <strong class="my gv">1st level droppers</strong> (Project1.exe)<br/>daaa061c88b197fa92d9648306e79875e3a24f392550dacaabd22e5fdba53ebf <br/>75dc821013fe92ef93cefa47d3fe83ad5ce90658e8ef01fcdb0b11652397abec</p><p id="2714" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">· <strong class="my gv">2nd level droppers </strong>(diskshadow.exe)<br/>f0311ede2dd5e752411bf181626e3cdb36737affe67ddeb8af028d0c44355886<br/>c5bab78fca3db0ce5ffff5838a5a4a93d930e715ded1cbd8a5b3caf0cdce803c</p><p id="9eed" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">· <strong class="my gv"><em class="nu">BlackNix RAT</em> </strong>(inte.exe)<br/>f46520c2284e20c42afa6e9b90e380735bfdf29817828369d5f1270a887e6979</p><p id="8f3f" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">I’ve verified that the sample inte.exe is indeed a <em class="nu">BlackNix RAT </em>and communicates with a custom <em class="nu">BlackNix</em> C2 at IP address 112.213.107[.]134.</p><p id="a818" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Related to this IP address, other possible <em class="nu">BlackNix RAT </em>samples were found on VirusTotal:</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw pa"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*OSo2hEzrBoNKbC5QNVuuyw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*OSo2hEzrBoNKbC5QNVuuyw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*OSo2hEzrBoNKbC5QNVuuyw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*OSo2hEzrBoNKbC5QNVuuyw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*OSo2hEzrBoNKbC5QNVuuyw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*OSo2hEzrBoNKbC5QNVuuyw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OSo2hEzrBoNKbC5QNVuuyw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*OSo2hEzrBoNKbC5QNVuuyw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*OSo2hEzrBoNKbC5QNVuuyw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*OSo2hEzrBoNKbC5QNVuuyw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*OSo2hEzrBoNKbC5QNVuuyw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*OSo2hEzrBoNKbC5QNVuuyw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*OSo2hEzrBoNKbC5QNVuuyw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*OSo2hEzrBoNKbC5QNVuuyw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="127" loading="lazy" role="presentation"/></picture></div></div></figure><p id="1ffc" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">In addition, one other <em class="nu">BlackNix RAT</em> samples were mentioned by james_inthe_box[2]. Based on SSDEEP similarity, another sample was found.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw pq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*x8Tl67RVQEn6sefeRF-iRw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*x8Tl67RVQEn6sefeRF-iRw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*x8Tl67RVQEn6sefeRF-iRw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*x8Tl67RVQEn6sefeRF-iRw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*x8Tl67RVQEn6sefeRF-iRw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*x8Tl67RVQEn6sefeRF-iRw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x8Tl67RVQEn6sefeRF-iRw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*x8Tl67RVQEn6sefeRF-iRw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*x8Tl67RVQEn6sefeRF-iRw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*x8Tl67RVQEn6sefeRF-iRw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*x8Tl67RVQEn6sefeRF-iRw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*x8Tl67RVQEn6sefeRF-iRw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*x8Tl67RVQEn6sefeRF-iRw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*x8Tl67RVQEn6sefeRF-iRw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="88" loading="lazy" role="presentation"/></picture></div></div></figure><p id="9e2e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Next, we shall see if all these samples send data in the same structure as what we have analyzed previously. If they do, then perhaps these are all related in some way and are not “wild” <em class="nu">BlackNix RAT</em>s.</p><p id="4cc0" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Set 1 binaries</strong></p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw pr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lcxi6mUKivKnUP2KKJyWFA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lcxi6mUKivKnUP2KKJyWFA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lcxi6mUKivKnUP2KKJyWFA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lcxi6mUKivKnUP2KKJyWFA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lcxi6mUKivKnUP2KKJyWFA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lcxi6mUKivKnUP2KKJyWFA.png 1100w, https://miro.medium.com/v2/resize:fit:940/format:webp/1*lcxi6mUKivKnUP2KKJyWFA.png 940w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 470px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*lcxi6mUKivKnUP2KKJyWFA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lcxi6mUKivKnUP2KKJyWFA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lcxi6mUKivKnUP2KKJyWFA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lcxi6mUKivKnUP2KKJyWFA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lcxi6mUKivKnUP2KKJyWFA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lcxi6mUKivKnUP2KKJyWFA.png 1100w, https://miro.medium.com/v2/resize:fit:940/1*lcxi6mUKivKnUP2KKJyWFA.png 940w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 470px"/><img alt="" class="bh md oe c" width="470" height="176" loading="lazy" role="presentation"/></picture></div></figure><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw ps"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*hQTMTEduq3VEknBWh0KdoQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*hQTMTEduq3VEknBWh0KdoQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*hQTMTEduq3VEknBWh0KdoQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*hQTMTEduq3VEknBWh0KdoQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*hQTMTEduq3VEknBWh0KdoQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*hQTMTEduq3VEknBWh0KdoQ.png 1100w, https://miro.medium.com/v2/resize:fit:792/format:webp/1*hQTMTEduq3VEknBWh0KdoQ.png 792w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 396px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*hQTMTEduq3VEknBWh0KdoQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*hQTMTEduq3VEknBWh0KdoQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*hQTMTEduq3VEknBWh0KdoQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*hQTMTEduq3VEknBWh0KdoQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*hQTMTEduq3VEknBWh0KdoQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*hQTMTEduq3VEknBWh0KdoQ.png 1100w, https://miro.medium.com/v2/resize:fit:792/1*hQTMTEduq3VEknBWh0KdoQ.png 792w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 396px"/><img alt="" class="bh md oe c" width="396" height="169" loading="lazy" role="presentation"/></picture></div></figure><p id="57e9" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Execution of these binaries will result in errors. Upon closer look, the errors happen because some part of the binary seems to be corrupted. Whether this is a deliberate “disarm” attempt or due to a bug, I can’t tell.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw pi"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*YpJx4MGVFPw-clGNUVopeQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*YpJx4MGVFPw-clGNUVopeQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*YpJx4MGVFPw-clGNUVopeQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*YpJx4MGVFPw-clGNUVopeQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*YpJx4MGVFPw-clGNUVopeQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*YpJx4MGVFPw-clGNUVopeQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YpJx4MGVFPw-clGNUVopeQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*YpJx4MGVFPw-clGNUVopeQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*YpJx4MGVFPw-clGNUVopeQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*YpJx4MGVFPw-clGNUVopeQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*YpJx4MGVFPw-clGNUVopeQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*YpJx4MGVFPw-clGNUVopeQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*YpJx4MGVFPw-clGNUVopeQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*YpJx4MGVFPw-clGNUVopeQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="373" loading="lazy" role="presentation"/></picture></div></div><figcaption class="or ff os nv nw ot ou bf b bg z du">Cause of error at address 0x4CDE53</figcaption></figure><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw pt"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*KIjkVRM9GSr0KcdWYxTAgA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*KIjkVRM9GSr0KcdWYxTAgA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*KIjkVRM9GSr0KcdWYxTAgA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*KIjkVRM9GSr0KcdWYxTAgA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*KIjkVRM9GSr0KcdWYxTAgA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*KIjkVRM9GSr0KcdWYxTAgA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KIjkVRM9GSr0KcdWYxTAgA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*KIjkVRM9GSr0KcdWYxTAgA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*KIjkVRM9GSr0KcdWYxTAgA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*KIjkVRM9GSr0KcdWYxTAgA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*KIjkVRM9GSr0KcdWYxTAgA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*KIjkVRM9GSr0KcdWYxTAgA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*KIjkVRM9GSr0KcdWYxTAgA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*KIjkVRM9GSr0KcdWYxTAgA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="227" loading="lazy" role="presentation"/></picture></div></div><figcaption class="or ff os nv nw ot ou bf b bg z du">Cause of error at address 0x4CE084</figcaption></figure><p id="f30b" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Just patch the areas with the corresponding bytes from inte.exe to fix the problems. The following screenshots show highlighted areas after patching.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw nx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*IF_jfnSaCuZPLDJwt0KiOw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*IF_jfnSaCuZPLDJwt0KiOw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*IF_jfnSaCuZPLDJwt0KiOw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*IF_jfnSaCuZPLDJwt0KiOw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*IF_jfnSaCuZPLDJwt0KiOw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*IF_jfnSaCuZPLDJwt0KiOw.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*IF_jfnSaCuZPLDJwt0KiOw.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*IF_jfnSaCuZPLDJwt0KiOw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*IF_jfnSaCuZPLDJwt0KiOw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*IF_jfnSaCuZPLDJwt0KiOw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*IF_jfnSaCuZPLDJwt0KiOw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*IF_jfnSaCuZPLDJwt0KiOw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*IF_jfnSaCuZPLDJwt0KiOw.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*IF_jfnSaCuZPLDJwt0KiOw.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oe c" width="602" height="144" loading="lazy" role="presentation"/></picture></div><figcaption class="or ff os nv nw ot ou bf b bg z du">Patch to solve error at 0x4CDE53</figcaption></figure><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw nx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*HJP6-a8Cr10BGjWaSbK3BQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*HJP6-a8Cr10BGjWaSbK3BQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*HJP6-a8Cr10BGjWaSbK3BQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*HJP6-a8Cr10BGjWaSbK3BQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*HJP6-a8Cr10BGjWaSbK3BQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*HJP6-a8Cr10BGjWaSbK3BQ.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*HJP6-a8Cr10BGjWaSbK3BQ.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*HJP6-a8Cr10BGjWaSbK3BQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*HJP6-a8Cr10BGjWaSbK3BQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*HJP6-a8Cr10BGjWaSbK3BQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*HJP6-a8Cr10BGjWaSbK3BQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*HJP6-a8Cr10BGjWaSbK3BQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*HJP6-a8Cr10BGjWaSbK3BQ.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*HJP6-a8Cr10BGjWaSbK3BQ.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oe c" width="602" height="113" loading="lazy" role="presentation"/></picture></div><figcaption class="or ff os nv nw ot ou bf b bg z du">Patch to solve error at 0x4CE084</figcaption></figure><p id="fa48" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">From the network packet, it looks like the data structures are identical to what we saw in inte.exe. This is verified with a comparison of the function that is responsible for building the structure. This is not surprising, as they all call back to the same IP address.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw pu"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*IVHohT96H4wmACPhrEyDbQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*IVHohT96H4wmACPhrEyDbQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*IVHohT96H4wmACPhrEyDbQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*IVHohT96H4wmACPhrEyDbQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*IVHohT96H4wmACPhrEyDbQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*IVHohT96H4wmACPhrEyDbQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IVHohT96H4wmACPhrEyDbQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*IVHohT96H4wmACPhrEyDbQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*IVHohT96H4wmACPhrEyDbQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*IVHohT96H4wmACPhrEyDbQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*IVHohT96H4wmACPhrEyDbQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*IVHohT96H4wmACPhrEyDbQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*IVHohT96H4wmACPhrEyDbQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*IVHohT96H4wmACPhrEyDbQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="189" loading="lazy" role="presentation"/></picture></div></div></figure><p id="a56c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Set 2 binaries</strong></p><p id="9be5" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">These binaries are different, because they are VMProtect-packed, which means that I cannot simply throw them into IDA Pro and hope to do function comparisons.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw pv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*WW6AWGrzRYi9X6N1BfYeoQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*WW6AWGrzRYi9X6N1BfYeoQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*WW6AWGrzRYi9X6N1BfYeoQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*WW6AWGrzRYi9X6N1BfYeoQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*WW6AWGrzRYi9X6N1BfYeoQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*WW6AWGrzRYi9X6N1BfYeoQ.png 1100w, https://miro.medium.com/v2/resize:fit:814/format:webp/1*WW6AWGrzRYi9X6N1BfYeoQ.png 814w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 407px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*WW6AWGrzRYi9X6N1BfYeoQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*WW6AWGrzRYi9X6N1BfYeoQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*WW6AWGrzRYi9X6N1BfYeoQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*WW6AWGrzRYi9X6N1BfYeoQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*WW6AWGrzRYi9X6N1BfYeoQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*WW6AWGrzRYi9X6N1BfYeoQ.png 1100w, https://miro.medium.com/v2/resize:fit:814/1*WW6AWGrzRYi9X6N1BfYeoQ.png 814w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 407px"/><img alt="" class="bh md oe c" width="407" height="523" loading="lazy" role="presentation"/></picture></div></figure><p id="eb68" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Execution of these binaries require them to be executed with administrator privileges, as they will spawn a svchost.exe process for injection. Knowing this behaviour, we can dump the unpacked executable from memory at the moment where the injection happens. A breakpoint at ntdll.dll’s NtWriteVirtualMemory will do the trick.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw pw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*XDQkSIxJMZjjrkupCBF65Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*XDQkSIxJMZjjrkupCBF65Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*XDQkSIxJMZjjrkupCBF65Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*XDQkSIxJMZjjrkupCBF65Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*XDQkSIxJMZjjrkupCBF65Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*XDQkSIxJMZjjrkupCBF65Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XDQkSIxJMZjjrkupCBF65Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*XDQkSIxJMZjjrkupCBF65Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*XDQkSIxJMZjjrkupCBF65Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*XDQkSIxJMZjjrkupCBF65Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*XDQkSIxJMZjjrkupCBF65Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*XDQkSIxJMZjjrkupCBF65Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*XDQkSIxJMZjjrkupCBF65Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*XDQkSIxJMZjjrkupCBF65Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="338" loading="lazy" role="presentation"/></picture></div></div></figure><blockquote class="ol om on"><p id="1b12" class="mw mx nu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">NtWriteVirtualMemory(<br/>IN HANDLE ProcessHandle,<br/>IN PVOID BaseAddress,<br/>IN PVOID Buffer,<br/>IN ULONG NumberOfBytesToWrite,<br/>OUT PULONG NumberOfBytesWritten OPTIONAL );</p></blockquote><p id="ec73" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The idea is to watch for a call to NtWriteVirtualMemory with a handle to svchost.exe, and let it run till all the sections have been copied. We would know it’s done when NtResumeThread is called.</p><p id="f428" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">After dumping the executable from memory, we would have to fix the section headers’ raw addresses before we can use IDA Pro to look at it. I’ve mentioned how to do this with CFF explorer in one of my earlier posts.</p><p id="da40" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">A quick look at strings within this dumped file reveals the tell-tale<em class="nu"> BlackNix </em>strings:</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div class="nv nw nx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*kd0PG86lG8jBtjqHq1iN2Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*kd0PG86lG8jBtjqHq1iN2Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*kd0PG86lG8jBtjqHq1iN2Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*kd0PG86lG8jBtjqHq1iN2Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*kd0PG86lG8jBtjqHq1iN2Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kd0PG86lG8jBtjqHq1iN2Q.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*kd0PG86lG8jBtjqHq1iN2Q.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*kd0PG86lG8jBtjqHq1iN2Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*kd0PG86lG8jBtjqHq1iN2Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*kd0PG86lG8jBtjqHq1iN2Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*kd0PG86lG8jBtjqHq1iN2Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*kd0PG86lG8jBtjqHq1iN2Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*kd0PG86lG8jBtjqHq1iN2Q.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*kd0PG86lG8jBtjqHq1iN2Q.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md oe c" width="602" height="621" loading="lazy" role="presentation"/></picture></div></figure><p id="e794" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The SETTINGS strings looks identical to what was seen in inte.exe, including the Chinese words 初始 and the server password ‘root’. The function that is responsible for reading the SETTINGS strings and building the callback data structure is identical to inte.exe’s as well (and hence the callback data structure is also the same).</p><p id="3607" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">I am certain that we are looking at the same variant of <em class="nu">BlackNix RAT </em>here.</p><figure class="ny nz oa ob oc od nv nw paragraph-image"><div role="button" tabindex="0" class="oh oi fj oj bh ok"><div class="nv nw pu"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*MtPWS4n2rCrOK9FheHjzvQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*MtPWS4n2rCrOK9FheHjzvQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*MtPWS4n2rCrOK9FheHjzvQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*MtPWS4n2rCrOK9FheHjzvQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*MtPWS4n2rCrOK9FheHjzvQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*MtPWS4n2rCrOK9FheHjzvQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MtPWS4n2rCrOK9FheHjzvQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*MtPWS4n2rCrOK9FheHjzvQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*MtPWS4n2rCrOK9FheHjzvQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*MtPWS4n2rCrOK9FheHjzvQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*MtPWS4n2rCrOK9FheHjzvQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*MtPWS4n2rCrOK9FheHjzvQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*MtPWS4n2rCrOK9FheHjzvQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*MtPWS4n2rCrOK9FheHjzvQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md oe c" width="700" height="682" loading="lazy" role="presentation"/></picture></div></div></figure><p id="79aa" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">So, they are all the same BlackNix variant. Now what?</strong></p><p id="5e09" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">This journey started from some unique mutexes found in a malware (one <em class="nu">BBSRAT</em>) that calls back to one of known <strong class="my gv">Winnti Group</strong>’s infrastructure. The same set of mutexes, some overlaps in code logic (in the naming of files and lateral movement using RDP shared drives), as well as close time proximity in compilation timestamps, suggested relationship between that one <em class="nu">BBSRAT</em> and the set of <em class="nu">BlackNix RAT</em>s (Project1.exe).</p><p id="1dbe" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">In addition to the mutexes, I noticed other similarities in Project1.exe’s execution and the <em class="nu">Trochilus RAT</em> dropper csres.exe described in Trend Micro’s Uncovering DRBControl report[3], specifically in the names of the files and service created and path to malicious binary:<br/>- system.exe<br/>- SESSRV<br/>- c:\ProgramData\Microsoft\DeviceSync</p><p id="d680" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">I get reminded of my earlier speculation that system.exe is a generic tool used to deliver/spread the payload (be it <em class="nu">BlackNix </em>or <em class="nu">Trochilus RAT</em>). I’ll never know for sure till I get my hands on some more samples ;)</p><p id="657f" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Last Words</strong></p><p id="f290" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Is <strong class="my gv">Winnti Group</strong> also behind the set of <em class="nu">BlackNix RAT</em>s that were under scrutiny in this post? There might be a good chance this is true. However, one other interesting finding that I came across was that the C2 domain msdnsoft[.]lang32[.]com as well as the corresponding binary (SHA256: 873dfa94f924d59ceff4efb277fef5a251d7b648605c5239fc2ac0885ba32bd5) were linked to an adversary group named “Lang32” by QiAnXin Technology[4]. This adversary group is said to target victims in Southeast Asia. Perhaps I should look into the tools used by this group as well…</p><p id="4666" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">But that’s a different long story for another time, that’s it for now!</p><p id="fae3" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">References:</p><p id="f0d4" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">[1]: <a class="af px" href="http://www.hexacorn.com/blog/2014/12/05/the-not-so-boring-land-of-borland-executables-part-1/" rel="noopener ugc nofollow" target="_blank">http://www.hexacorn.com/blog/2014/12/05/the-not-so-boring-land-of-borland-executables-part-1/</a><br/>[2]: <a class="af px" href="https://twitter.com/james_inthe_box/status/1151972438692921344" rel="noopener ugc nofollow" target="_blank">https://twitter.com/james_inthe_box/status/1151972438692921344</a><br/>[3]: “Operation DRBControl: Uncovering a Cyberespionage Campaign Targeting Gambling Companies in Southeast Asia”, Trend Micro, 18 Feb 2020<br/>[4]: <a class="af px" href="https://www.secrss.com/articles/12463" rel="noopener ugc nofollow" target="_blank">https://www.secrss.com/articles/12463</a></p><p id="14ec" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">~~</p><div class="py pz qa qb qc qd"><a href="https://twitter.com/AsunaAmawaka?source=post_page-----badc0f2f41cb--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qe ab ix"><div class="qf ab co cb qg qh"><h2 class="bf gv io z jf qi jh ji qj jk jm gt bk">Asuna</h2><div class="qk l"><h3 class="bf b io z jf qi jh ji qj jk jm du">The latest Tweets from Asuna (@AsunaAmawaka). [Malware Analyst]. Binary World</h3></div><div class="ql l"><p class="bf b dv z jf qi jh ji qj jk jm du">twitter.com</p></div></div><div class="qm l"><div class="qn l qo qp qq qm qr md qd"></div></div></div></a></div><p id="e133" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Drop me a DM if you would like to share findings or samples ;)</p></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="qs qt ab ja"><div class="qk ab"><a class="qu ay am ao" rel="noopener follow" href="/tag/reverse-engineering?source=post_page-----badc0f2f41cb--------------------------------"><div class="qv fj cx qw ge qx qy bf b bg z bk qz">Reverse Engineering</div></a></div><div class="qk ab"><a class="qu ay am ao" rel="noopener follow" href="/tag/malware-analysis?source=post_page-----badc0f2f41cb--------------------------------"><div class="qv fj cx qw ge qx qy bf b bg z bk qz">Malware Analysis</div></a></div><div class="qk ab"><a class="qu ay am ao" rel="noopener follow" href="/tag/blacknix-rat?source=post_page-----badc0f2f41cb--------------------------------"><div class="qv fj cx qw ge qx qy bf b bg z bk qz">Blacknix Rat</div></a></div><div class="qk ab"><a class="qu ay am ao" rel="noopener follow" href="/tag/winnti-group?source=post_page-----badc0f2f41cb--------------------------------"><div class="qv fj cx qw ge qx qy bf b bg z bk qz">Winnti Group</div></a></div></div></div></div><div class="l"></div><footer class="ra rb rc rd re ab q rf ik c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp rg"><div class="ab q kv"><div class="rh l"><span class="l ri rj rk e d"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Finsomniacs%2Fbadc0f2f41cb&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fshadows-with-a-chance-of-blacknix-badc0f2f41cb&amp;user=asuna+amawaka&amp;userId=ddd44ddb6480&amp;source=---footer_actions--badc0f2f41cb---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span><span class="l h g f rl rm"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Finsomniacs%2Fbadc0f2f41cb&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fshadows-with-a-chance-of-blacknix-badc0f2f41cb&amp;user=asuna+amawaka&amp;userId=ddd44ddb6480&amp;source=---footer_actions--badc0f2f41cb---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="rn l ix"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbadc0f2f41cb&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Fshadows-with-a-chance-of-blacknix-badc0f2f41cb&amp;source=---footer_actions--badc0f2f41cb---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="rn l ix"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="ro rp rq rr rs l"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="rt bh r ru"></div><div class="rv l"><div class="ab rw rx ry iz iy"><div class="rz sa sb sc sd se sf sg sh si ab cp"><div class="h k"><a href="https://medium.com/insomniacs?source=post_page---post_publication_info--badc0f2f41cb--------------------------------" rel="noopener follow"><div class="fj ab"><img alt="insomniacs" class="sj ib ic cx" src="https://miro.medium.com/v2/resize:fill:96:96/1*IvMGfHVzEtZei5I-JouCvw.jpeg" width="48" height="48" loading="lazy"/><div class="sj l ic ib fs n fr sk"></div></div></a></div><div class="j i d"><a href="https://medium.com/insomniacs?source=post_page---post_publication_info--badc0f2f41cb--------------------------------" rel="noopener follow"><div class="fj ab"><img alt="insomniacs" class="sj sm sl cx" src="https://miro.medium.com/v2/resize:fill:128:128/1*IvMGfHVzEtZei5I-JouCvw.jpeg" width="64" height="64" loading="lazy"/><div class="sj l sl sm fs n fr sk"></div></div></a></div><div class="j i d sn ix"><div class="ab"></div></div></div><div class="ab co qg"><div class="so sp sq sr ss l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" href="https://medium.com/insomniacs?source=post_page---post_publication_info--badc0f2f41cb--------------------------------" rel="noopener follow"><h2 class="pw-author-name bf su sv sw sx sy sz ta nh tb tc nl td te np tf tg bk"><span class="gn st">Published in <!-- -->insomniacs</span></h2></a><div class="qk ab ia"><div class="l ix"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/insomniacs/followers?source=post_page---post_publication_info--badc0f2f41cb--------------------------------">60 Followers</a></span></div><div class="bf b bg z du ab jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/insomniacs/analysis-walkthrough-apt32s-79828cc5-8979-43c0-9299-8e155b397281-dll-32da9d336ca0?source=post_page---post_publication_info--badc0f2f41cb--------------------------------">Last published <span>Jun 23, 2022</span></a></div></div><div class="th l"><p class="bf b bg z bk"><span class="gn">reverse engineering away those sleepless nights</span></p></div></div></div><div class="h k"><div class="ab"></div></div></div></div><div class="ab rw rx ry iz iy"><div class="rz sa sb sc sd se sf sg sh si ab cp"><div class="h k"><a tabindex="0" rel="noopener follow" href="/@asuna.amawaka?source=post_page---post_author_info--badc0f2f41cb--------------------------------"><div class="l fj"><img alt="asuna amawaka" class="l fd by ic ib cx" src="https://miro.medium.com/v2/resize:fill:96:96/2*La4u414Rn4EMK1D8bYBRag.png" width="48" height="48" loading="lazy"/><div class="fr by l ic ib fs n ay sk"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/@asuna.amawaka?source=post_page---post_author_info--badc0f2f41cb--------------------------------"><div class="l fj"><img alt="asuna amawaka" class="l fd by sl sm cx" src="https://miro.medium.com/v2/resize:fill:128:128/2*La4u414Rn4EMK1D8bYBRag.png" width="64" height="64" loading="lazy"/><div class="fr by l sl sm fs n ay sk"></div></div></a></div><div class="j i d sn ix"><div class="ab"><span><button class="bf b bg z ti qv tj tk tl tm tn ev ew to tp tq fa fb fc fd bm fe ff">Follow</button></span></div></div></div><div class="ab co qg"><div class="so sp sq sr ss l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@asuna.amawaka?source=post_page---post_author_info--badc0f2f41cb--------------------------------"><h2 class="pw-author-name bf su sv sw sx sy sz ta nh tb tc nl td te np tf tg bk"><span class="gn st">Written by <!-- -->asuna amawaka</span></h2></a><div class="qk ab ia"><div class="l ix"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/@asuna.amawaka/followers?source=post_page---post_author_info--badc0f2f41cb--------------------------------">28 Followers</a></span></div><div class="bf b bg z du ab jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/@asuna.amawaka/following?source=post_page---post_author_info--badc0f2f41cb--------------------------------">1 Following</a></div></div><div class="th l"></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z ti qv tj tk tl tm tn ev ew to tp tq fa fb fc fd bm fe ff">Follow</button></span></div></div></div></div></div></div><div class="tr l"><div class="rt bh r ts tt tu tv tw"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab q cp"><h2 class="bf su tx ty tz ua ub uc ud ue uf ug uh ui uj uk ul bk">No responses yet</h2><div class="ab um"><div><div class="bm" aria-hidden="false"><a class="un uo" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--badc0f2f41cb--------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="up uq ur us ut l"></div></div></div></div><div class="uu uv uw ux uy l bx"><div class="h k j"><div class="rt bh uz va"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="vb ab kv ja"><div class="vc vd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----badc0f2f41cb--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="vc vd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----badc0f2f41cb--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="vc vd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----badc0f2f41cb--------------------------------"><p class="bf b dv z du">About</p></a></div><div class="vc vd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----badc0f2f41cb--------------------------------"><p class="bf b dv z du">Careers</p></a></div><div class="vc vd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----badc0f2f41cb--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="vc vd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----badc0f2f41cb--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="vc vd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----badc0f2f41cb--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="vc vd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----badc0f2f41cb--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="vc vd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----badc0f2f41cb--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----badc0f2f41cb--------------------------------"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241216-164309-0d4958d8a6"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-badc0f2f41cb","user-ddd44ddb6480","collection-8dea5b1882ca"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"ae22badb-a9ca-4db6-bb76-bbef3700f2ed","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-de838029e40468cb637175a29532226f-3479fb0fabd4b3c7-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Fshadows-with-a-chance-of-blacknix-badc0f2f41cb","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20241216-164309-0d4958d8a6","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241216-164309-0d4958d8a6","commit":"0d4958d8a6e728d0bc7ba6245eaad002411a6eb7"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"insomniacs\"})":{"__ref":"Collection:8dea5b1882ca"},"postResult({\"id\":\"badc0f2f41cb\"})":{"__ref":"Post:badc0f2f41cb"}},"ImageMetadata:":{"__typename":"ImageMetadata","id":""},"Collection:8dea5b1882ca":{"__typename":"Collection","id":"8dea5b1882ca","favicon":{"__ref":"ImageMetadata:"},"customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFFFFFFF","point":0},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.1},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.2},{"__typename":"ColorPoint","color":"#FFD1E7D1","point":0.6},{"__typename":"ColorPoint","color":"#FFA3D0A2","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF1A8917","point":0},{"__typename":"ColorPoint","color":"#FF11800E","point":0.1},{"__typename":"ColorPoint","color":"#FF0F730C","point":0.2},{"__typename":"ColorPoint","color":"#FF095407","point":1}]},"tintBackgroundSpectrum":null},"domain":null,"slug":"insomniacs","googleAnalyticsId":null,"name":"insomniacs","subscriberCount":60,"description":"reverse engineering away those sleepless nights","avatar":{"__ref":"ImageMetadata:1*IvMGfHVzEtZei5I-JouCvw.jpeg"},"latestPostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__ref":"Post:32da9d336ca0"}]},"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:8dea5b1882ca-viewerId:lo_063d147192f8"},"twitterUsername":null,"facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*IvMGfHVzEtZei5I-JouCvw.jpeg"}},"ImageMetadata:1*IvMGfHVzEtZei5I-JouCvw.jpeg":{"__typename":"ImageMetadata","id":"1*IvMGfHVzEtZei5I-JouCvw.jpeg","originalWidth":1200,"originalHeight":1200},"User:ddd44ddb6480":{"__typename":"User","id":"ddd44ddb6480","customDomainState":null,"hasSubdomain":false,"username":"asuna.amawaka","linkedAccounts":{"__ref":"LinkedAccounts:ddd44ddb6480"},"isSuspended":false,"name":"asuna amawaka","imageId":"2*La4u414Rn4EMK1D8bYBRag.png","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":28,"followingCount":0,"collectionFollowingCount":1},"bio":"","membership":null,"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:ddd44ddb6480-viewerId:lo_063d147192f8"},"twitterScreenName":""},"Post:32da9d336ca0":{"__typename":"Post","id":"32da9d336ca0","firstPublishedAt":1656002664270,"creator":{"__ref":"User:ddd44ddb6480"},"collection":{"__ref":"Collection:8dea5b1882ca"},"isSeries":false,"mediumUrl":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Fanalysis-walkthrough-apt32s-79828cc5-8979-43c0-9299-8e155b397281-dll-32da9d336ca0","sequence":null,"uniqueSlug":"analysis-walkthrough-apt32s-79828cc5-8979-43c0-9299-8e155b397281-dll-32da9d336ca0"},"LinkedAccounts:ddd44ddb6480":{"__typename":"LinkedAccounts","mastodon":null,"id":"ddd44ddb6480"},"Paragraph:2e246c81e704_0":{"__typename":"Paragraph","id":"2e246c81e704_0","name":"4b18","type":"H3","href":null,"layout":null,"metadata":null,"text":"Shadows with a chance of BlackNix","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_1":{"__typename":"Paragraph","id":"2e246c81e704_1","name":"d49d","type":"P","href":null,"layout":null,"metadata":null,"text":"In the last post, I did an analysis of a set of BBSRAT samples that are characterized by unique mutexes (cc5d64b344700e403e2sse, cc5d6b4700e403e2sse, cc5d6b4700032eSS) and calls back to a known Winnti Group C2 (bot[.]googlerenewals[.]net). In this post, I’m going to continue on analysis of samples related to the abovementioned mutexes.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":194,"end":206,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":48,"end":55,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_2":{"__typename":"Paragraph","id":"2e246c81e704_2","name":"2a15","type":"P","href":null,"layout":null,"metadata":null,"text":"When I started on this analysis journey, I was hoping to find more BBSRAT samples. However, the results I arrived at deviated from expectations, and instead I found a set of dropper malware that used the same mutexes as those found in the BBSRAT samples I analyzed. The final payload dropped by these droppers is the BlackNix RAT. Pivoting from the C2 called from this BlackNix RAT, more BlackNix RATs were found on VirusTotal. I was unable to find any technical blogs on the BlackNix RAT, and hence, here I am.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":67,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":239,"end":246,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":317,"end":329,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":368,"end":381,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":387,"end":400,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":476,"end":488,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_3":{"__typename":"Paragraph","id":"2e246c81e704_3","name":"ca69","type":"P","href":null,"layout":null,"metadata":null,"text":"The following diagram is a sort of a “signpost” for this writing.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*MHd5y30gF8bs6Mp92tUkTw.png":{"__typename":"ImageMetadata","id":"1*MHd5y30gF8bs6Mp92tUkTw.png","originalHeight":330,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_4":{"__typename":"Paragraph","id":"2e246c81e704_4","name":"3b15","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*MHd5y30gF8bs6Mp92tUkTw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_5":{"__typename":"Paragraph","id":"2e246c81e704_5","name":"a3b6","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s dip into the first dropper!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_6":{"__typename":"Paragraph","id":"2e246c81e704_6","name":"e475","type":"P","href":null,"layout":null,"metadata":null,"text":"Project1.exe","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*QwHURhL4Pa6y0U5Yk1PcSw.png":{"__typename":"ImageMetadata","id":"1*QwHURhL4Pa6y0U5Yk1PcSw.png","originalHeight":61,"originalWidth":172,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_7":{"__typename":"Paragraph","id":"2e246c81e704_7","name":"a88e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*QwHURhL4Pa6y0U5Yk1PcSw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_8":{"__typename":"Paragraph","id":"2e246c81e704_8","name":"6a98","type":"P","href":null,"layout":null,"metadata":null,"text":"The following files are likely from the same source code: daaa061c88b197fa92d9648306e79875e3a24f392550dacaabd22e5fdba53ebf\n75dc821013fe92ef93cefa47d3fe83ad5ce90658e8ef01fcdb0b11652397abec","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_9":{"__typename":"Paragraph","id":"2e246c81e704_9","name":"a1d7","type":"P","href":null,"layout":null,"metadata":null,"text":"Judging from the executables’ icon, it looks like the samples are written with Borland Delphi 7, and sadly the executables’ compilation timestamps are 1992–06–19 22:22:17 (a well-known bug in Delphi 4–2006). I didn’t really look into which versions are affected by the compilation time bug, because that’s beside the point. The samples’ compilation time can still be deduced with the timestamp within the executables’ resources. (Thanks to Adam’s old post on this[1])","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*aKeivcG29TIJEm8CJcQZtw.png":{"__typename":"ImageMetadata","id":"1*aKeivcG29TIJEm8CJcQZtw.png","originalHeight":210,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_10":{"__typename":"Paragraph","id":"2e246c81e704_10","name":"4e62","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*aKeivcG29TIJEm8CJcQZtw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_11":{"__typename":"Paragraph","id":"2e246c81e704_11","name":"01e1","type":"P","href":null,"layout":null,"metadata":null,"text":"This dropper will drop 2 files system.exe and systemm.exe into %USERPROFILE%\\Pictures, execute them and write a diskshadow.exe to C:\\ProgramData\\Microsoft\\DeviceSync\\.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*lt0Tm8Q_L4pVnxhjDHQeLw.png":{"__typename":"ImageMetadata","id":"1*lt0Tm8Q_L4pVnxhjDHQeLw.png","originalHeight":347,"originalWidth":998,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_12":{"__typename":"Paragraph","id":"2e246c81e704_12","name":"6a24","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*lt0Tm8Q_L4pVnxhjDHQeLw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_13":{"__typename":"Paragraph","id":"2e246c81e704_13","name":"5c11","type":"P","href":null,"layout":null,"metadata":null,"text":"system.exe, systemm.exe\nSHA256: AEB61477C3F4F2D76AF0DC97B19B01F73C8ADA1FCE91D66E8B0E489E2E807430","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_14":{"__typename":"Paragraph","id":"2e246c81e704_14","name":"9316","type":"P","href":null,"layout":null,"metadata":null,"text":"Execution of system.exe creates a service to execute itself within the context of the service.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_15":{"__typename":"Paragraph","id":"2e246c81e704_15","name":"d621","type":"BQ","href":null,"layout":null,"metadata":null,"text":"C:\\Windows\\System32\\sc.exe create SESSRV binpath= “cmd \u002Fc \\”C:\\Users\\asuna\\Pictures\\system.exe\\””","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_16":{"__typename":"Paragraph","id":"2e246c81e704_16","name":"4392","type":"BQ","href":null,"layout":null,"metadata":null,"text":"C:\\Windows\\System32\\net.exe start SESSRV","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Ti5rjzmPD_icyvaL0jPhKQ.png":{"__typename":"ImageMetadata","id":"1*Ti5rjzmPD_icyvaL0jPhKQ.png","originalHeight":454,"originalWidth":435,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_17":{"__typename":"Paragraph","id":"2e246c81e704_17","name":"85be","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Ti5rjzmPD_icyvaL0jPhKQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_18":{"__typename":"Paragraph","id":"2e246c81e704_18","name":"04cf","type":"P","href":null,"layout":null,"metadata":null,"text":"The mutexes are set within the execution of system.exe and systemm.exe.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Y2FGZ3dM6i9TvHfuQmSWiQ.png":{"__typename":"ImageMetadata","id":"1*Y2FGZ3dM6i9TvHfuQmSWiQ.png","originalHeight":464,"originalWidth":791,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_19":{"__typename":"Paragraph","id":"2e246c81e704_19","name":"53b1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Y2FGZ3dM6i9TvHfuQmSWiQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_20":{"__typename":"Paragraph","id":"2e246c81e704_20","name":"91a9","type":"P","href":null,"layout":null,"metadata":null,"text":"systemm.exe attempts to copy diskshadow.exe to a network location \\\\TSCLIENT\\%userprofile%\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\. The sample also attempts to locate and copy a 1.jpg.lnk within the same directory as diskshadow.exe, but this file was not created by the previous dropper.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_21":{"__typename":"Paragraph","id":"2e246c81e704_21","name":"fe51","type":"P","href":null,"layout":null,"metadata":null,"text":"In gist, the sample’s job is to copy the payload diskshadow.exe to a host that is connected to the current victim via RDP and set persistency to run at startup. This is possibly a tool meant for lateral movement within the victim network. The same technique is also found in the execution of the BBSRAT samples analyzed previously.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":296,"end":303,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_22":{"__typename":"Paragraph","id":"2e246c81e704_22","name":"7e72","type":"P","href":null,"layout":null,"metadata":null,"text":"The following screen captures referenced one of the BBSRAT trinity files, lockdown.dll (MD5: 166D28FF69019D9991EECBD26DC1E266):","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":52,"end":59,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*SKrUDSx3z8fPQWvQAzvX-g.png":{"__typename":"ImageMetadata","id":"1*SKrUDSx3z8fPQWvQAzvX-g.png","originalHeight":379,"originalWidth":839,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_23":{"__typename":"Paragraph","id":"2e246c81e704_23","name":"9bff","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*SKrUDSx3z8fPQWvQAzvX-g.png"},"text":"Copy file to network location. Left: system.exe; Right: lockdown.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_24":{"__typename":"Paragraph","id":"2e246c81e704_24","name":"907e","type":"P","href":null,"layout":null,"metadata":null,"text":"The mutexes come into play with the same “usage” as what was seen in the BBSRAT samples as well.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":73,"end":80,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*YTPYqJUa6vKi-gGtkuSfGg.png":{"__typename":"ImageMetadata","id":"1*YTPYqJUa6vKi-gGtkuSfGg.png","originalHeight":373,"originalWidth":853,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_25":{"__typename":"Paragraph","id":"2e246c81e704_25","name":"5d61","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*YTPYqJUa6vKi-gGtkuSfGg.png"},"text":"One of the places where mutex is set. Left: system.exe; Right: lockdown.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_26":{"__typename":"Paragraph","id":"2e246c81e704_26","name":"a608","type":"P","href":null,"layout":null,"metadata":null,"text":"Given that even the sleep counter is identical, I would suspect that the two executables might share the same “base code” (or perhaps copied from the same “reference code”). The proximity of their compilation time also suggests that perhaps the same author is behind both executables.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_27":{"__typename":"Paragraph","id":"2e246c81e704_27","name":"820d","type":"P","href":null,"layout":null,"metadata":null,"text":"System.exe: 13 May 2018 19:34:27\nLockdown.dll: 6 May 2018 17:59:24","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*UWsrdwWUjqi1mslaSbdDSQ.png":{"__typename":"ImageMetadata","id":"1*UWsrdwWUjqi1mslaSbdDSQ.png","originalHeight":350,"originalWidth":739,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_28":{"__typename":"Paragraph","id":"2e246c81e704_28","name":"c887","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*UWsrdwWUjqi1mslaSbdDSQ.png"},"text":"Same sleep counter. Left: system.exe; Right: lockdown.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_29":{"__typename":"Paragraph","id":"2e246c81e704_29","name":"f8d9","type":"P","href":null,"layout":null,"metadata":null,"text":"Enough of the dropper, let’s look at the actual evil payload now.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_30":{"__typename":"Paragraph","id":"2e246c81e704_30","name":"6a37","type":"P","href":null,"layout":null,"metadata":null,"text":"Diskshadow.exe","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*kUK0Z6e9JjrPslUsOdHvcw.png":{"__typename":"ImageMetadata","id":"1*kUK0Z6e9JjrPslUsOdHvcw.png","originalHeight":217,"originalWidth":649,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_31":{"__typename":"Paragraph","id":"2e246c81e704_31","name":"1768","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*kUK0Z6e9JjrPslUsOdHvcw.png"},"text":"UPX section names","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_32":{"__typename":"Paragraph","id":"2e246c81e704_32","name":"a2a3","type":"P","href":null,"layout":null,"metadata":null,"text":"With just one look at it, we’d know it’s UPX-packed. So let’s unpack it quickly.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*zVgQTOqSpfSUHxnbOYcN7A.png":{"__typename":"ImageMetadata","id":"1*zVgQTOqSpfSUHxnbOYcN7A.png","originalHeight":145,"originalWidth":492,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_33":{"__typename":"Paragraph","id":"2e246c81e704_33","name":"563a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*zVgQTOqSpfSUHxnbOYcN7A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_34":{"__typename":"Paragraph","id":"2e246c81e704_34","name":"8678","type":"P","href":null,"layout":null,"metadata":null,"text":"After unpack:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_35":{"__typename":"Paragraph","id":"2e246c81e704_35","name":"a053","type":"P","href":null,"layout":null,"metadata":null,"text":"MD5: 40835ED7C92F33F7F377D4472228CB65\nSHA1: 033E97D4AC3AE3CEC00A206F2AD5CCC922DBD326\nSHA256: C5BAB78FCA3DB0CE5FFFF5838A5A4A93D930E715DED1CBD8A5B3CAF0CDCE803C","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_36":{"__typename":"Paragraph","id":"2e246c81e704_36","name":"8dfb","type":"P","href":null,"layout":null,"metadata":null,"text":"With the assistance of Procmon, we can see that the binary will drop 2 files, intel.exe and inte.exe into the C:\\intel directory. I located the code responsible for creating the files (refer to screen capture below). The binary also sets 2 persistency mechanisms. Note the presence of Simplified Chinese words within the name of the registry key — 更新计划程序 (translates to “ Update Schedule Program”). This is not the only place where Simplified Chinese words are observed.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_37":{"__typename":"Paragraph","id":"2e246c81e704_37","name":"0fd3","type":"BQ","href":null,"layout":null,"metadata":null,"text":"regsetval sz HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run “intel更新计划程序” “c:\\intel\\inte.exe”’,0","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_38":{"__typename":"Paragraph","id":"2e246c81e704_38","name":"bf1d","type":"BQ","href":null,"layout":null,"metadata":null,"text":"shortcut “c:\\intel\\inte.exe” “~$folder.startup$” “Windows Calculator”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*j1Tz6GjZCgKBHb6pny5Exw.png":{"__typename":"ImageMetadata","id":"1*j1Tz6GjZCgKBHb6pny5Exw.png","originalHeight":498,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_39":{"__typename":"Paragraph","id":"2e246c81e704_39","name":"25fe","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*j1Tz6GjZCgKBHb6pny5Exw.png"},"text":"Set persistency","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_40":{"__typename":"Paragraph","id":"2e246c81e704_40","name":"375f","type":"P","href":null,"layout":null,"metadata":null,"text":"The two files dropped are:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Mn1qitvEz1-7fD3IrkQFxQ.png":{"__typename":"ImageMetadata","id":"1*Mn1qitvEz1-7fD3IrkQFxQ.png","originalHeight":66,"originalWidth":391,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_41":{"__typename":"Paragraph","id":"2e246c81e704_41","name":"219a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Mn1qitvEz1-7fD3IrkQFxQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_42":{"__typename":"Paragraph","id":"2e246c81e704_42","name":"b3c1","type":"P","href":null,"layout":null,"metadata":null,"text":"intel.exe \nSHA256: 12459A5E9AFDB2DBFF685C8C4E916BB15B34745D56EF5F778DF99416D2749261\nThis is the NirCmd executable from Nirsoft. NirCmd is a small command-line utility that allows you to do some useful tasks without displaying any user interface.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_43":{"__typename":"Paragraph","id":"2e246c81e704_43","name":"d59e","type":"P","href":null,"layout":null,"metadata":null,"text":"inte.exe\nSHA256: F46520C2284E20C42AFA6E9B90E380735BFDF29817828369D5F1270A887E6979\nThis is the actual BlackNix RAT, which is the meat that we want to analyze.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":101,"end":113,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_44":{"__typename":"Paragraph","id":"2e246c81e704_44","name":"4a11","type":"P","href":null,"layout":null,"metadata":null,"text":"Both diskshadow.exe and inte.exe are written in Borland Delphi and their compilation datetime stamps are as follow:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_45":{"__typename":"Paragraph","id":"2e246c81e704_45","name":"e4ce","type":"BQ","href":null,"layout":null,"metadata":null,"text":"File: C:\\ProgramData\\Microsoft\\DeviceSync\\diskshadow.exe\nPE Comp.: 1992–06–19 22:22:17 2A425E19, 708992537\n.rsrc comp.: 2018–10–22 22:50:06 4D56B643, 1297528387","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_46":{"__typename":"Paragraph","id":"2e246c81e704_46","name":"738d","type":"BQ","href":null,"layout":null,"metadata":null,"text":"File: C:\\Intel\\inte.exe\nPE Comp.: 1992–06–19 22:22:17 2A425E19, 708992537\n.rsrc comp.: 2018–10–22 22:49:20 4D56B62A, 1297528362","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_47":{"__typename":"Paragraph","id":"2e246c81e704_47","name":"7c98","type":"P","href":null,"layout":null,"metadata":null,"text":"Judging from the compilation datetimes, they might be the output of a generator. Here, I could also make a guess at the chronological logic of when the files are prepared.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*0mWk9dYBhPU8kS7wrC9Cbg.png":{"__typename":"ImageMetadata","id":"1*0mWk9dYBhPU8kS7wrC9Cbg.png","originalHeight":263,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_48":{"__typename":"Paragraph","id":"2e246c81e704_48","name":"6c79","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*0mWk9dYBhPU8kS7wrC9Cbg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_49":{"__typename":"Paragraph","id":"2e246c81e704_49","name":"0fd4","type":"P","href":null,"layout":null,"metadata":null,"text":"inte.exe","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_50":{"__typename":"Paragraph","id":"2e246c81e704_50","name":"4151","type":"P","href":null,"layout":null,"metadata":null,"text":"As with my usual style, I will start with a quick look at strings to try to guess the behaviour of the sample, before diving into dynamic and static analysis. Fortunately, the sample contains many helpful and descriptive strings that can help us deduce the features that this RAT provides, including Keylogger, FileManager, ProcessManager etc. Pretty typical RAT stuff.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*UP3O-n6o2dkDJRdrt6Nb7A.png":{"__typename":"ImageMetadata","id":"1*UP3O-n6o2dkDJRdrt6Nb7A.png","originalHeight":542,"originalWidth":729,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_51":{"__typename":"Paragraph","id":"2e246c81e704_51","name":"5443","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*UP3O-n6o2dkDJRdrt6Nb7A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*54nU-Y5v27AdKTyXKtA-Ig.png":{"__typename":"ImageMetadata","id":"1*54nU-Y5v27AdKTyXKtA-Ig.png","originalHeight":805,"originalWidth":726,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_52":{"__typename":"Paragraph","id":"2e246c81e704_52","name":"52a6","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*54nU-Y5v27AdKTyXKtA-Ig.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_53":{"__typename":"Paragraph","id":"2e246c81e704_53","name":"d5bb","type":"P","href":null,"layout":null,"metadata":null,"text":"A YARA rule hit","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_54":{"__typename":"Paragraph","id":"2e246c81e704_54","name":"1c4f","type":"P","href":null,"layout":null,"metadata":null,"text":"The sample happened to match James_inthe_box’s YARA rule[2] on BlackNix RAT:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":63,"end":75,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_55":{"__typename":"Paragraph","id":"2e246c81e704_55","name":"ec20","type":"BQ","href":null,"layout":null,"metadata":null,"text":"rule BlacknixRAT_bin{","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_56":{"__typename":"Paragraph","id":"2e246c81e704_56","name":"7d3d","type":"BQ","href":null,"layout":null,"metadata":null,"text":"meta:\ndescription = “BlacknixRAT”\nauthor = “James_inthe_box”\nreference = “https:\u002F\u002Fapp.any.run\u002Ftasks\u002Fe3d845db-09b5-462d-8290-cbb4bb4a505f\u002F\"\ndate = “2019\u002F02”\nmaltype = “RAT”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_57":{"__typename":"Paragraph","id":"2e246c81e704_57","name":"bb55","type":"BQ","href":null,"layout":null,"metadata":null,"text":"strings:\n$string1 = “[Random-Number-Here]”\n$string2 = “ScreenCapture”\n$string3 = “TScreenSpy”\n$string4 = “KeyLogger”\n$string5 = “RemoteShell”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_58":{"__typename":"Paragraph","id":"2e246c81e704_58","name":"d212","type":"BQ","href":null,"layout":null,"metadata":null,"text":"condition:\nuint16(0) == 0x5A4D and all of ($string*) and filesize \u003C 2000KB","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_59":{"__typename":"Paragraph","id":"2e246c81e704_59","name":"c470","type":"BQ","href":null,"layout":null,"metadata":null,"text":"}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_60":{"__typename":"Paragraph","id":"2e246c81e704_60","name":"d610","type":"P","href":null,"layout":null,"metadata":null,"text":"Based on the strings seen above, the strings that matched the YARA rule did not look unique enough to confirm that this is indeed a BlackNix RAT. James_inthe_box also provided a snort rule:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":132,"end":141,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_61":{"__typename":"Paragraph","id":"2e246c81e704_61","name":"5c1e","type":"BQ","href":null,"layout":null,"metadata":null,"text":"alert tcp any any -\u003E any 80 (msg:”Blacknix RAT Detected”; flow:established,to_server; content:”|32|”; depth:1; content:”|7c 78 01 6d 8e|”; within:10; reference:url,https:\u002F\u002Fapp.any.run\u002Ftasks\u002Fe3d845db-09b5-462d-8290-cbb4bb4a505f\u002F; classtype:trojan-activity; sid:20166298; rev:1; metadata:created_at 2019_07_18;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_62":{"__typename":"Paragraph","id":"2e246c81e704_62","name":"d2f0","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s see what we have in the network data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*hqEZjCv8wNRbeZoGJmTPfQ.png":{"__typename":"ImageMetadata","id":"1*hqEZjCv8wNRbeZoGJmTPfQ.png","originalHeight":283,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_63":{"__typename":"Paragraph","id":"2e246c81e704_63","name":"69a8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*hqEZjCv8wNRbeZoGJmTPfQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_64":{"__typename":"Paragraph","id":"2e246c81e704_64","name":"7d16","type":"P","href":null,"layout":null,"metadata":null,"text":"Yup, I see a 7C 78 01 but that’s not an exact match with the pattern in the snort rule. Hang on a second.. 78 01 looks like the ZLIB magic header. There we go!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ZzM0Of6IZS8dt653T9Dx0A.png":{"__typename":"ImageMetadata","id":"1*ZzM0Of6IZS8dt653T9Dx0A.png","originalHeight":321,"originalWidth":773,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_65":{"__typename":"Paragraph","id":"2e246c81e704_65","name":"23f0","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZzM0Of6IZS8dt653T9Dx0A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_66":{"__typename":"Paragraph","id":"2e246c81e704_66","name":"d1bf","type":"P","href":null,"layout":null,"metadata":null,"text":"I noticed some weird characters, which could be indicative of Unicode (maybe Chinese…?). Let’s try.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*J0fQBtkbSm8-gEc8ESkWmw.png":{"__typename":"ImageMetadata","id":"1*J0fQBtkbSm8-gEc8ESkWmw.png","originalHeight":395,"originalWidth":821,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_67":{"__typename":"Paragraph","id":"2e246c81e704_67","name":"0d01","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*J0fQBtkbSm8-gEc8ESkWmw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_68":{"__typename":"Paragraph","id":"2e246c81e704_68","name":"5580","type":"P","href":null,"layout":null,"metadata":null,"text":"Indeed! 初始 is translated to mean Initial Start, and “2核2808” might mean 2 Cores (probably referring to the CPU cores). I’ll step through the code that forms up this data in abit. Now, let us try to confirm if this callback belongs to BlackNix family.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":234,"end":243,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_69":{"__typename":"Paragraph","id":"2e246c81e704_69","name":"0e49","type":"P","href":null,"layout":null,"metadata":null,"text":"The YARA and snort rules mentioned above referenced a sample (SHA256: A4DA694DED531EC60CA5A242C554B6A7062E12FF633D34656C4CA9DF86E42DD5). Let’s sidetrack and see what this sample does.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_70":{"__typename":"Paragraph","id":"2e246c81e704_70","name":"ed6c","type":"P","href":null,"layout":null,"metadata":null,"text":"This sample is packed with VMProtect, so to save time, I’m just going to execute it and see what happens. Upon execution, a new file phpalpha.exe is created in C:\\Intel\\ExtremeGraphics\\CUI\\Resource. Turns out the file has the same hash as the parent binary.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*JuiZrJ2kAsMyLE_cli5e-A.png":{"__typename":"ImageMetadata","id":"1*JuiZrJ2kAsMyLE_cli5e-A.png","originalHeight":332,"originalWidth":1032,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_71":{"__typename":"Paragraph","id":"2e246c81e704_71","name":"c33f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*JuiZrJ2kAsMyLE_cli5e-A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_72":{"__typename":"Paragraph","id":"2e246c81e704_72","name":"63b2","type":"P","href":null,"layout":null,"metadata":null,"text":"The network callback looks like this:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*YAn016rFAcUCtlRMbk7mzQ.png":{"__typename":"ImageMetadata","id":"1*YAn016rFAcUCtlRMbk7mzQ.png","originalHeight":351,"originalWidth":980,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_73":{"__typename":"Paragraph","id":"2e246c81e704_73","name":"be26","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*YAn016rFAcUCtlRMbk7mzQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_74":{"__typename":"Paragraph","id":"2e246c81e704_74","name":"f3a7","type":"P","href":null,"layout":null,"metadata":null,"text":"We already know that’s a ZLIB header, so let’s use CyberChef to view the inflated data:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*sYM9RE7pwwOOko3kQ0Obqg.png":{"__typename":"ImageMetadata","id":"1*sYM9RE7pwwOOko3kQ0Obqg.png","originalHeight":371,"originalWidth":730,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_75":{"__typename":"Paragraph","id":"2e246c81e704_75","name":"20f3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*sYM9RE7pwwOOko3kQ0Obqg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_76":{"__typename":"Paragraph","id":"2e246c81e704_76","name":"d3b0","type":"P","href":null,"layout":null,"metadata":null,"text":"Interesting. The data structure and keywords are identical. Now I can say that the sample (SHA256: A4DA694DED531EC60CA5A242C554B6A7062E12FF633D34656C4CA9DF86E42DD5) and our sample (inte.exe, SHA256: F46520C2284E20C42AFA6E9B90E380735BFDF29817828369D5F1270A887E6979) belong to the same family. Is it really BlackNix though?","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":305,"end":314,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_77":{"__typename":"Paragraph","id":"2e246c81e704_77","name":"cb74","type":"P","href":null,"layout":null,"metadata":null,"text":"With the C2, everything is easier","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_78":{"__typename":"Paragraph","id":"2e246c81e704_78","name":"b65b","type":"P","href":null,"layout":null,"metadata":null,"text":"With some help from Google search, I found a copy of a BlackNix C2 component :D","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":55,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_79":{"__typename":"Paragraph","id":"2e246c81e704_79","name":"22fb","type":"P","href":null,"layout":null,"metadata":null,"text":"The C2 executable comes with the ability to generate the “server” component. This naming convention is common in RATs, where the malware client is typically referred to as the “server”, and the C2 is the “client”.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_80":{"__typename":"Paragraph","id":"2e246c81e704_80","name":"8382","type":"P","href":null,"layout":null,"metadata":null,"text":"The following is one of the default profiles loaded with the C2:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*bqFfQBtY3q8JRD6C3B58rQ.png":{"__typename":"ImageMetadata","id":"1*bqFfQBtY3q8JRD6C3B58rQ.png","originalHeight":546,"originalWidth":759,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_81":{"__typename":"Paragraph","id":"2e246c81e704_81","name":"ccc3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*bqFfQBtY3q8JRD6C3B58rQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_82":{"__typename":"Paragraph","id":"2e246c81e704_82","name":"a0a8","type":"P","href":null,"layout":null,"metadata":null,"text":"For the ease of testing, I changed some of the values when generating our test binary. The generator even comes with the option of UPX-packing the generated binary if the user wishes.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*P45RQDAjTnaOcusNc0cBQA.png":{"__typename":"ImageMetadata","id":"1*P45RQDAjTnaOcusNc0cBQA.png","originalHeight":428,"originalWidth":860,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_83":{"__typename":"Paragraph","id":"2e246c81e704_83","name":"7f60","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*P45RQDAjTnaOcusNc0cBQA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_84":{"__typename":"Paragraph","id":"2e246c81e704_84","name":"5a24","type":"P","href":null,"layout":null,"metadata":null,"text":"Inspecting the strings within the generated binary, we can quickly identify some familiar keywords.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*uPrOdqOpKvVFgLPdBEMmVg.png":{"__typename":"ImageMetadata","id":"1*uPrOdqOpKvVFgLPdBEMmVg.png","originalHeight":364,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_85":{"__typename":"Paragraph","id":"2e246c81e704_85","name":"bfaa","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*uPrOdqOpKvVFgLPdBEMmVg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_86":{"__typename":"Paragraph","id":"2e246c81e704_86","name":"86c9","type":"P","href":null,"layout":null,"metadata":null,"text":"I’ve written a quick script to read the strings from the default settings. This will come useful later, when comparing these strings across different samples.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Ouuav4Qi9HuniM3IY5RK7g.png":{"__typename":"ImageMetadata","id":"1*Ouuav4Qi9HuniM3IY5RK7g.png","originalHeight":508,"originalWidth":791,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_87":{"__typename":"Paragraph","id":"2e246c81e704_87","name":"ec5a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Ouuav4Qi9HuniM3IY5RK7g.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_88":{"__typename":"Paragraph","id":"2e246c81e704_88","name":"e894","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s the output of running the script:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*NRXMEXBj-L4U4LR7KyFBhg.png":{"__typename":"ImageMetadata","id":"1*NRXMEXBj-L4U4LR7KyFBhg.png","originalHeight":256,"originalWidth":483,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_89":{"__typename":"Paragraph","id":"2e246c81e704_89","name":"e5c5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*NRXMEXBj-L4U4LR7KyFBhg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_90":{"__typename":"Paragraph","id":"2e246c81e704_90","name":"705f","type":"P","href":null,"layout":null,"metadata":null,"text":"It appears that these SETTINGS strings have nothing to do with the configuration set when generating the binary. The default connection password within the C2 is “admin” and notice that even if I changed the password when generating the binary, the new password does not get inserted into this SETTINGS data. These may be part of a “stub” that comes with the C2 executable and inserted into every generated binary. I think this may be a helpful piece of information when trying to identify if a set of BlackNix RATs is communicating with the same C2 executable (or at least the same version).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":502,"end":514,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_91":{"__typename":"Paragraph","id":"2e246c81e704_91","name":"037f","type":"P","href":null,"layout":null,"metadata":null,"text":"Take a look at the network communications.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*nHruYjx5aljRm5UMDW8fQQ.png":{"__typename":"ImageMetadata","id":"1*nHruYjx5aljRm5UMDW8fQQ.png","originalHeight":260,"originalWidth":855,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_92":{"__typename":"Paragraph","id":"2e246c81e704_92","name":"47a0","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*nHruYjx5aljRm5UMDW8fQQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_93":{"__typename":"Paragraph","id":"2e246c81e704_93","name":"8a3b","type":"P","href":null,"layout":null,"metadata":null,"text":"First thing that I noticed was the difference in the way the “Processor” information is being formatted. Remember there were some Chinese words (2核2808) that I thought refers to Processor Cores? In the data sent from this test binary, the processor information was simply a “2808” (referring to 2808 Mhz, which is indeed the setup of my VM).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*JRCe3PoU0fA8CPMEsMYduQ.png":{"__typename":"ImageMetadata","id":"1*JRCe3PoU0fA8CPMEsMYduQ.png","originalHeight":231,"originalWidth":1020,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_94":{"__typename":"Paragraph","id":"2e246c81e704_94","name":"b0df","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*JRCe3PoU0fA8CPMEsMYduQ.png"},"text":"Connected victim on C2 dashboard","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_95":{"__typename":"Paragraph","id":"2e246c81e704_95","name":"766b","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s get back to the sample we have at hand.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_96":{"__typename":"Paragraph","id":"2e246c81e704_96","name":"a51d","type":"P","href":null,"layout":null,"metadata":null,"text":"I did an in-depth analysis of how the first beacon’s data structure is formed within inte.exe.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_97":{"__typename":"Paragraph","id":"2e246c81e704_97","name":"c150","type":"P","href":null,"layout":null,"metadata":null,"text":"Earlier I mentioned some SETTINGS strings. These are the strings that are populated into a data structure and some of these values are later copied into the first beacon data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*p6GBS5q2LN1fYjUEIjn5GA.png":{"__typename":"ImageMetadata","id":"1*p6GBS5q2LN1fYjUEIjn5GA.png","originalHeight":680,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_98":{"__typename":"Paragraph","id":"2e246c81e704_98","name":"410e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*p6GBS5q2LN1fYjUEIjn5GA.png"},"text":"Reading strings from SETTINGS","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_99":{"__typename":"Paragraph","id":"2e246c81e704_99","name":"7d59","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s compare the default SETTINGS strings found in the generated BlackNix binary and inte.exe.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":66,"end":75,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*vEpGjGUd9LijktzYXiNqVw.png":{"__typename":"ImageMetadata","id":"1*vEpGjGUd9LijktzYXiNqVw.png","originalHeight":478,"originalWidth":562,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_100":{"__typename":"Paragraph","id":"2e246c81e704_100","name":"8239","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*vEpGjGUd9LijktzYXiNqVw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_101":{"__typename":"Paragraph","id":"2e246c81e704_101","name":"84fe","type":"P","href":null,"layout":null,"metadata":null,"text":"The following code is responsible for building the structure to be sent in the first beacon:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ClTl9NK43Prvv7NG58aHUg.png":{"__typename":"ImageMetadata","id":"1*ClTl9NK43Prvv7NG58aHUg.png","originalHeight":834,"originalWidth":727,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_102":{"__typename":"Paragraph","id":"2e246c81e704_102","name":"f16d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ClTl9NK43Prvv7NG58aHUg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ZwyWtcNJOvpPEn67zlzepQ.png":{"__typename":"ImageMetadata","id":"1*ZwyWtcNJOvpPEn67zlzepQ.png","originalHeight":867,"originalWidth":733,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_103":{"__typename":"Paragraph","id":"2e246c81e704_103","name":"6496","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZwyWtcNJOvpPEn67zlzepQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_104":{"__typename":"Paragraph","id":"2e246c81e704_104","name":"b15a","type":"P","href":null,"layout":null,"metadata":null,"text":"The following is the deduced first beacon’s data structure sent from the inte.exe to its C2.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_105":{"__typename":"Paragraph","id":"2e246c81e704_105","name":"4d9b","type":"BQ","href":null,"layout":null,"metadata":null,"text":"OnConnect|Default 初始|Username|Username|Computer Name|IP Address|Hardcoded Space|Locale|Is Machine Idle?|Locale|Language|Account Privilege|Processor|Memory|Foreground Window Text|OS|Default False|Default False|%Root%|%Desktop%|%MyDocuments%|%AppData%|Locale|Server authentication password|ProdID, InstallDate|","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_106":{"__typename":"Paragraph","id":"2e246c81e704_106","name":"9c6a","type":"P","href":null,"layout":null,"metadata":null,"text":"Now we can play spot-the-differences. We can guess what each of these fields mean by looking at what can be seen on the dashboard, without reverse engineering the binary.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_107":{"__typename":"Paragraph","id":"2e246c81e704_107","name":"f321","type":"P","href":null,"layout":null,"metadata":null,"text":"The following is the deduced first beacon’s data structure sent from the test BlackNix binary.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":78,"end":87,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_108":{"__typename":"Paragraph","id":"2e246c81e704_108","name":"4570","type":"BQ","href":null,"layout":null,"metadata":null,"text":"OnConnect|Assigned Group|Assigned Name|Username|Computer Name|IP Address|Webcam Installed?|C2 Version|?|Locale|Language|Account Privilege|Processor|Memory|OS|True\u002FFalse?|True\u002FFalse?|%Root%|%Desktop%|%MyDocuments%|%AppData%|Locale|Server authentication password|?|","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*DHauffknFC2NLfpPGyuaQw.png":{"__typename":"ImageMetadata","id":"1*DHauffknFC2NLfpPGyuaQw.png","originalHeight":658,"originalWidth":719,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_109":{"__typename":"Paragraph","id":"2e246c81e704_109","name":"abed","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*DHauffknFC2NLfpPGyuaQw.png"},"text":"Comparison of fields within data structure sent to C2","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_110":{"__typename":"Paragraph","id":"2e246c81e704_110","name":"803e","type":"P","href":null,"layout":null,"metadata":null,"text":"Yes! inte.exe is a BlackNix RAT, but has a different\u002Fmodified C2 component?","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":75,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_111":{"__typename":"Paragraph","id":"2e246c81e704_111","name":"97c0","type":"P","href":null,"layout":null,"metadata":null,"text":"What I did above proved that the inte.exe sample is indeed a BlackNix RAT, judging from the highly similar data structure within the initial beacon and the similarities found within the executables. However, since some fields in the communicated data are interpreted differently, I’m guessing there is a customised C2 that the adversary is using. I am not even able to tell the version number of the C2 from the sample, perhaps it is not important for the adversary. However, the SETTINGS strings found within the samples could be a way for us to differentiate variants.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":61,"end":73,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_112":{"__typename":"Paragraph","id":"2e246c81e704_112","name":"22f8","type":"P","href":null,"layout":null,"metadata":null,"text":"So far, I’ve walked through the analysis of this set of files:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_113":{"__typename":"Paragraph","id":"2e246c81e704_113","name":"25de","type":"P","href":null,"layout":null,"metadata":null,"text":"· 1st level droppers (Project1.exe)\ndaaa061c88b197fa92d9648306e79875e3a24f392550dacaabd22e5fdba53ebf \n75dc821013fe92ef93cefa47d3fe83ad5ce90658e8ef01fcdb0b11652397abec","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":2,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_114":{"__typename":"Paragraph","id":"2e246c81e704_114","name":"2714","type":"P","href":null,"layout":null,"metadata":null,"text":"· 2nd level droppers (diskshadow.exe)\nf0311ede2dd5e752411bf181626e3cdb36737affe67ddeb8af028d0c44355886\nc5bab78fca3db0ce5ffff5838a5a4a93d930e715ded1cbd8a5b3caf0cdce803c","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":2,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_115":{"__typename":"Paragraph","id":"2e246c81e704_115","name":"9eed","type":"P","href":null,"layout":null,"metadata":null,"text":"· BlackNix RAT (inte.exe)\nf46520c2284e20c42afa6e9b90e380735bfdf29817828369d5f1270a887e6979","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":2,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":2,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_116":{"__typename":"Paragraph","id":"2e246c81e704_116","name":"8f3f","type":"P","href":null,"layout":null,"metadata":null,"text":"I’ve verified that the sample inte.exe is indeed a BlackNix RAT and communicates with a custom BlackNix C2 at IP address 112.213.107[.]134.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":51,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":95,"end":103,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_117":{"__typename":"Paragraph","id":"2e246c81e704_117","name":"a818","type":"P","href":null,"layout":null,"metadata":null,"text":"Related to this IP address, other possible BlackNix RAT samples were found on VirusTotal:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":43,"end":56,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*OSo2hEzrBoNKbC5QNVuuyw.png":{"__typename":"ImageMetadata","id":"1*OSo2hEzrBoNKbC5QNVuuyw.png","originalHeight":132,"originalWidth":729,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_118":{"__typename":"Paragraph","id":"2e246c81e704_118","name":"b6d7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*OSo2hEzrBoNKbC5QNVuuyw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_119":{"__typename":"Paragraph","id":"2e246c81e704_119","name":"1ffc","type":"P","href":null,"layout":null,"metadata":null,"text":"In addition, one other BlackNix RAT samples were mentioned by james_inthe_box[2]. Based on SSDEEP similarity, another sample was found.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":23,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*x8Tl67RVQEn6sefeRF-iRw.png":{"__typename":"ImageMetadata","id":"1*x8Tl67RVQEn6sefeRF-iRw.png","originalHeight":91,"originalWidth":731,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_120":{"__typename":"Paragraph","id":"2e246c81e704_120","name":"b6af","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*x8Tl67RVQEn6sefeRF-iRw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_121":{"__typename":"Paragraph","id":"2e246c81e704_121","name":"9e2e","type":"P","href":null,"layout":null,"metadata":null,"text":"Next, we shall see if all these samples send data in the same structure as what we have analyzed previously. If they do, then perhaps these are all related in some way and are not “wild” BlackNix RATs.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":187,"end":199,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_122":{"__typename":"Paragraph","id":"2e246c81e704_122","name":"4cc0","type":"P","href":null,"layout":null,"metadata":null,"text":"Set 1 binaries","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*lcxi6mUKivKnUP2KKJyWFA.png":{"__typename":"ImageMetadata","id":"1*lcxi6mUKivKnUP2KKJyWFA.png","originalHeight":176,"originalWidth":470,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_123":{"__typename":"Paragraph","id":"2e246c81e704_123","name":"769a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*lcxi6mUKivKnUP2KKJyWFA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*hQTMTEduq3VEknBWh0KdoQ.png":{"__typename":"ImageMetadata","id":"1*hQTMTEduq3VEknBWh0KdoQ.png","originalHeight":169,"originalWidth":396,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_124":{"__typename":"Paragraph","id":"2e246c81e704_124","name":"a6dc","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*hQTMTEduq3VEknBWh0KdoQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_125":{"__typename":"Paragraph","id":"2e246c81e704_125","name":"57e9","type":"P","href":null,"layout":null,"metadata":null,"text":"Execution of these binaries will result in errors. Upon closer look, the errors happen because some part of the binary seems to be corrupted. Whether this is a deliberate “disarm” attempt or due to a bug, I can’t tell.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*YpJx4MGVFPw-clGNUVopeQ.png":{"__typename":"ImageMetadata","id":"1*YpJx4MGVFPw-clGNUVopeQ.png","originalHeight":458,"originalWidth":860,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_126":{"__typename":"Paragraph","id":"2e246c81e704_126","name":"5188","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*YpJx4MGVFPw-clGNUVopeQ.png"},"text":"Cause of error at address 0x4CDE53","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*KIjkVRM9GSr0KcdWYxTAgA.png":{"__typename":"ImageMetadata","id":"1*KIjkVRM9GSr0KcdWYxTAgA.png","originalHeight":263,"originalWidth":814,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_127":{"__typename":"Paragraph","id":"2e246c81e704_127","name":"1a59","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*KIjkVRM9GSr0KcdWYxTAgA.png"},"text":"Cause of error at address 0x4CE084","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_128":{"__typename":"Paragraph","id":"2e246c81e704_128","name":"f30b","type":"P","href":null,"layout":null,"metadata":null,"text":"Just patch the areas with the corresponding bytes from inte.exe to fix the problems. The following screenshots show highlighted areas after patching.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*IF_jfnSaCuZPLDJwt0KiOw.png":{"__typename":"ImageMetadata","id":"1*IF_jfnSaCuZPLDJwt0KiOw.png","originalHeight":144,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_129":{"__typename":"Paragraph","id":"2e246c81e704_129","name":"6e14","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*IF_jfnSaCuZPLDJwt0KiOw.png"},"text":"Patch to solve error at 0x4CDE53","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*HJP6-a8Cr10BGjWaSbK3BQ.png":{"__typename":"ImageMetadata","id":"1*HJP6-a8Cr10BGjWaSbK3BQ.png","originalHeight":113,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_130":{"__typename":"Paragraph","id":"2e246c81e704_130","name":"2c93","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*HJP6-a8Cr10BGjWaSbK3BQ.png"},"text":"Patch to solve error at 0x4CE084","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_131":{"__typename":"Paragraph","id":"2e246c81e704_131","name":"fa48","type":"P","href":null,"layout":null,"metadata":null,"text":"From the network packet, it looks like the data structures are identical to what we saw in inte.exe. This is verified with a comparison of the function that is responsible for building the structure. This is not surprising, as they all call back to the same IP address.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*IVHohT96H4wmACPhrEyDbQ.png":{"__typename":"ImageMetadata","id":"1*IVHohT96H4wmACPhrEyDbQ.png","originalHeight":222,"originalWidth":825,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_132":{"__typename":"Paragraph","id":"2e246c81e704_132","name":"1f08","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*IVHohT96H4wmACPhrEyDbQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_133":{"__typename":"Paragraph","id":"2e246c81e704_133","name":"a56c","type":"P","href":null,"layout":null,"metadata":null,"text":"Set 2 binaries","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_134":{"__typename":"Paragraph","id":"2e246c81e704_134","name":"9be5","type":"P","href":null,"layout":null,"metadata":null,"text":"These binaries are different, because they are VMProtect-packed, which means that I cannot simply throw them into IDA Pro and hope to do function comparisons.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*WW6AWGrzRYi9X6N1BfYeoQ.png":{"__typename":"ImageMetadata","id":"1*WW6AWGrzRYi9X6N1BfYeoQ.png","originalHeight":523,"originalWidth":407,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_135":{"__typename":"Paragraph","id":"2e246c81e704_135","name":"008d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*WW6AWGrzRYi9X6N1BfYeoQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_136":{"__typename":"Paragraph","id":"2e246c81e704_136","name":"eb68","type":"P","href":null,"layout":null,"metadata":null,"text":"Execution of these binaries require them to be executed with administrator privileges, as they will spawn a svchost.exe process for injection. Knowing this behaviour, we can dump the unpacked executable from memory at the moment where the injection happens. A breakpoint at ntdll.dll’s NtWriteVirtualMemory will do the trick.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*XDQkSIxJMZjjrkupCBF65Q.png":{"__typename":"ImageMetadata","id":"1*XDQkSIxJMZjjrkupCBF65Q.png","originalHeight":387,"originalWidth":802,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_137":{"__typename":"Paragraph","id":"2e246c81e704_137","name":"48f4","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*XDQkSIxJMZjjrkupCBF65Q.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_138":{"__typename":"Paragraph","id":"2e246c81e704_138","name":"1b12","type":"BQ","href":null,"layout":null,"metadata":null,"text":"NtWriteVirtualMemory(\nIN HANDLE ProcessHandle,\nIN PVOID BaseAddress,\nIN PVOID Buffer,\nIN ULONG NumberOfBytesToWrite,\nOUT PULONG NumberOfBytesWritten OPTIONAL );","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_139":{"__typename":"Paragraph","id":"2e246c81e704_139","name":"ec73","type":"P","href":null,"layout":null,"metadata":null,"text":"The idea is to watch for a call to NtWriteVirtualMemory with a handle to svchost.exe, and let it run till all the sections have been copied. We would know it’s done when NtResumeThread is called.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_140":{"__typename":"Paragraph","id":"2e246c81e704_140","name":"f428","type":"P","href":null,"layout":null,"metadata":null,"text":"After dumping the executable from memory, we would have to fix the section headers’ raw addresses before we can use IDA Pro to look at it. I’ve mentioned how to do this with CFF explorer in one of my earlier posts.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_141":{"__typename":"Paragraph","id":"2e246c81e704_141","name":"da40","type":"P","href":null,"layout":null,"metadata":null,"text":"A quick look at strings within this dumped file reveals the tell-tale BlackNix strings:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":69,"end":79,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*kd0PG86lG8jBtjqHq1iN2Q.png":{"__typename":"ImageMetadata","id":"1*kd0PG86lG8jBtjqHq1iN2Q.png","originalHeight":621,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_142":{"__typename":"Paragraph","id":"2e246c81e704_142","name":"e28b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*kd0PG86lG8jBtjqHq1iN2Q.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_143":{"__typename":"Paragraph","id":"2e246c81e704_143","name":"e794","type":"P","href":null,"layout":null,"metadata":null,"text":"The SETTINGS strings looks identical to what was seen in inte.exe, including the Chinese words 初始 and the server password ‘root’. The function that is responsible for reading the SETTINGS strings and building the callback data structure is identical to inte.exe’s as well (and hence the callback data structure is also the same).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_144":{"__typename":"Paragraph","id":"2e246c81e704_144","name":"3607","type":"P","href":null,"layout":null,"metadata":null,"text":"I am certain that we are looking at the same variant of BlackNix RAT here.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":56,"end":69,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*MtPWS4n2rCrOK9FheHjzvQ.png":{"__typename":"ImageMetadata","id":"1*MtPWS4n2rCrOK9FheHjzvQ.png","originalHeight":803,"originalWidth":825,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:2e246c81e704_145":{"__typename":"Paragraph","id":"2e246c81e704_145","name":"e96f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*MtPWS4n2rCrOK9FheHjzvQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_146":{"__typename":"Paragraph","id":"2e246c81e704_146","name":"79aa","type":"P","href":null,"layout":null,"metadata":null,"text":"So, they are all the same BlackNix variant. Now what?","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":53,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_147":{"__typename":"Paragraph","id":"2e246c81e704_147","name":"5e09","type":"P","href":null,"layout":null,"metadata":null,"text":"This journey started from some unique mutexes found in a malware (one BBSRAT) that calls back to one of known Winnti Group’s infrastructure. The same set of mutexes, some overlaps in code logic (in the naming of files and lateral movement using RDP shared drives), as well as close time proximity in compilation timestamps, suggested relationship between that one BBSRAT and the set of BlackNix RATs (Project1.exe).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":110,"end":122,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":70,"end":76,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":364,"end":370,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":386,"end":398,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_148":{"__typename":"Paragraph","id":"2e246c81e704_148","name":"1dbe","type":"P","href":null,"layout":null,"metadata":null,"text":"In addition to the mutexes, I noticed other similarities in Project1.exe’s execution and the Trochilus RAT dropper csres.exe described in Trend Micro’s Uncovering DRBControl report[3], specifically in the names of the files and service created and path to malicious binary:\n- system.exe\n- SESSRV\n- c:\\ProgramData\\Microsoft\\DeviceSync","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":93,"end":106,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_149":{"__typename":"Paragraph","id":"2e246c81e704_149","name":"d680","type":"P","href":null,"layout":null,"metadata":null,"text":"I get reminded of my earlier speculation that system.exe is a generic tool used to deliver\u002Fspread the payload (be it BlackNix or Trochilus RAT). I’ll never know for sure till I get my hands on some more samples ;)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":117,"end":126,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":129,"end":142,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_150":{"__typename":"Paragraph","id":"2e246c81e704_150","name":"657f","type":"P","href":null,"layout":null,"metadata":null,"text":"Last Words","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_151":{"__typename":"Paragraph","id":"2e246c81e704_151","name":"f290","type":"P","href":null,"layout":null,"metadata":null,"text":"Is Winnti Group also behind the set of BlackNix RATs that were under scrutiny in this post? There might be a good chance this is true. However, one other interesting finding that I came across was that the C2 domain msdnsoft[.]lang32[.]com as well as the corresponding binary (SHA256: 873dfa94f924d59ceff4efb277fef5a251d7b648605c5239fc2ac0885ba32bd5) were linked to an adversary group named “Lang32” by QiAnXin Technology[4]. This adversary group is said to target victims in Southeast Asia. Perhaps I should look into the tools used by this group as well…","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":3,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":39,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_152":{"__typename":"Paragraph","id":"2e246c81e704_152","name":"4666","type":"P","href":null,"layout":null,"metadata":null,"text":"But that’s a different long story for another time, that’s it for now!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_153":{"__typename":"Paragraph","id":"2e246c81e704_153","name":"fae3","type":"P","href":null,"layout":null,"metadata":null,"text":"References:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_154":{"__typename":"Paragraph","id":"2e246c81e704_154","name":"f0d4","type":"P","href":null,"layout":null,"metadata":null,"text":"[1]: http:\u002F\u002Fwww.hexacorn.com\u002Fblog\u002F2014\u002F12\u002F05\u002Fthe-not-so-boring-land-of-borland-executables-part-1\u002F\n[2]: https:\u002F\u002Ftwitter.com\u002Fjames_inthe_box\u002Fstatus\u002F1151972438692921344\n[3]: “Operation DRBControl: Uncovering a Cyberespionage Campaign Targeting Gambling Companies in Southeast Asia”, Trend Micro, 18 Feb 2020\n[4]: https:\u002F\u002Fwww.secrss.com\u002Farticles\u002F12463","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":5,"end":98,"href":"http:\u002F\u002Fwww.hexacorn.com\u002Fblog\u002F2014\u002F12\u002F05\u002Fthe-not-so-boring-land-of-borland-executables-part-1\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":104,"end":166,"href":"https:\u002F\u002Ftwitter.com\u002Fjames_inthe_box\u002Fstatus\u002F1151972438692921344","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":311,"end":348,"href":"https:\u002F\u002Fwww.secrss.com\u002Farticles\u002F12463","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_155":{"__typename":"Paragraph","id":"2e246c81e704_155","name":"14ec","type":"P","href":null,"layout":null,"metadata":null,"text":"~~","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:2e246c81e704_156":{"__typename":"Paragraph","id":"2e246c81e704_156","name":"8c0b","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Asuna\nThe latest Tweets from Asuna (@AsunaAmawaka). [Malware Analyst]. Binary Worldtwitter.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":94,"href":"https:\u002F\u002Ftwitter.com\u002FAsunaAmawaka","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":6,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Ftwitter.com\u002FAsunaAmawaka","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*TZbAWWWB82XEIz-W"}},"Paragraph:2e246c81e704_157":{"__typename":"Paragraph","id":"2e246c81e704_157","name":"e133","type":"P","href":null,"layout":null,"metadata":null,"text":"Drop me a DM if you would like to share findings or samples ;)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:8dea5b1882ca-viewerId:lo_063d147192f8":{"__typename":"CollectionViewerEdge","id":"collectionId:8dea5b1882ca-viewerId:lo_063d147192f8","isEditor":false,"isMuting":false},"UserViewerEdge:userId:ddd44ddb6480-viewerId:lo_063d147192f8":{"__typename":"UserViewerEdge","id":"userId:ddd44ddb6480-viewerId:lo_063d147192f8","isMuting":false},"PostViewerEdge:postId:badc0f2f41cb-viewerId:lo_063d147192f8":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:badc0f2f41cb-viewerId:lo_063d147192f8"},"Tag:reverse-engineering":{"__typename":"Tag","id":"reverse-engineering","displayTitle":"Reverse Engineering","normalizedTagSlug":"reverse-engineering"},"Tag:malware-analysis":{"__typename":"Tag","id":"malware-analysis","displayTitle":"Malware Analysis","normalizedTagSlug":"malware-analysis"},"Tag:blacknix-rat":{"__typename":"Tag","id":"blacknix-rat","displayTitle":"Blacknix Rat","normalizedTagSlug":"blacknix-rat"},"Tag:winnti-group":{"__typename":"Tag","id":"winnti-group","displayTitle":"Winnti Group","normalizedTagSlug":"winnti-group"},"Post:badc0f2f41cb":{"__typename":"Post","id":"badc0f2f41cb","collection":{"__ref":"Collection:8dea5b1882ca"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"88f9","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:2e246c81e704_0"},{"__ref":"Paragraph:2e246c81e704_1"},{"__ref":"Paragraph:2e246c81e704_2"},{"__ref":"Paragraph:2e246c81e704_3"},{"__ref":"Paragraph:2e246c81e704_4"},{"__ref":"Paragraph:2e246c81e704_5"},{"__ref":"Paragraph:2e246c81e704_6"},{"__ref":"Paragraph:2e246c81e704_7"},{"__ref":"Paragraph:2e246c81e704_8"},{"__ref":"Paragraph:2e246c81e704_9"},{"__ref":"Paragraph:2e246c81e704_10"},{"__ref":"Paragraph:2e246c81e704_11"},{"__ref":"Paragraph:2e246c81e704_12"},{"__ref":"Paragraph:2e246c81e704_13"},{"__ref":"Paragraph:2e246c81e704_14"},{"__ref":"Paragraph:2e246c81e704_15"},{"__ref":"Paragraph:2e246c81e704_16"},{"__ref":"Paragraph:2e246c81e704_17"},{"__ref":"Paragraph:2e246c81e704_18"},{"__ref":"Paragraph:2e246c81e704_19"},{"__ref":"Paragraph:2e246c81e704_20"},{"__ref":"Paragraph:2e246c81e704_21"},{"__ref":"Paragraph:2e246c81e704_22"},{"__ref":"Paragraph:2e246c81e704_23"},{"__ref":"Paragraph:2e246c81e704_24"},{"__ref":"Paragraph:2e246c81e704_25"},{"__ref":"Paragraph:2e246c81e704_26"},{"__ref":"Paragraph:2e246c81e704_27"},{"__ref":"Paragraph:2e246c81e704_28"},{"__ref":"Paragraph:2e246c81e704_29"},{"__ref":"Paragraph:2e246c81e704_30"},{"__ref":"Paragraph:2e246c81e704_31"},{"__ref":"Paragraph:2e246c81e704_32"},{"__ref":"Paragraph:2e246c81e704_33"},{"__ref":"Paragraph:2e246c81e704_34"},{"__ref":"Paragraph:2e246c81e704_35"},{"__ref":"Paragraph:2e246c81e704_36"},{"__ref":"Paragraph:2e246c81e704_37"},{"__ref":"Paragraph:2e246c81e704_38"},{"__ref":"Paragraph:2e246c81e704_39"},{"__ref":"Paragraph:2e246c81e704_40"},{"__ref":"Paragraph:2e246c81e704_41"},{"__ref":"Paragraph:2e246c81e704_42"},{"__ref":"Paragraph:2e246c81e704_43"},{"__ref":"Paragraph:2e246c81e704_44"},{"__ref":"Paragraph:2e246c81e704_45"},{"__ref":"Paragraph:2e246c81e704_46"},{"__ref":"Paragraph:2e246c81e704_47"},{"__ref":"Paragraph:2e246c81e704_48"},{"__ref":"Paragraph:2e246c81e704_49"},{"__ref":"Paragraph:2e246c81e704_50"},{"__ref":"Paragraph:2e246c81e704_51"},{"__ref":"Paragraph:2e246c81e704_52"},{"__ref":"Paragraph:2e246c81e704_53"},{"__ref":"Paragraph:2e246c81e704_54"},{"__ref":"Paragraph:2e246c81e704_55"},{"__ref":"Paragraph:2e246c81e704_56"},{"__ref":"Paragraph:2e246c81e704_57"},{"__ref":"Paragraph:2e246c81e704_58"},{"__ref":"Paragraph:2e246c81e704_59"},{"__ref":"Paragraph:2e246c81e704_60"},{"__ref":"Paragraph:2e246c81e704_61"},{"__ref":"Paragraph:2e246c81e704_62"},{"__ref":"Paragraph:2e246c81e704_63"},{"__ref":"Paragraph:2e246c81e704_64"},{"__ref":"Paragraph:2e246c81e704_65"},{"__ref":"Paragraph:2e246c81e704_66"},{"__ref":"Paragraph:2e246c81e704_67"},{"__ref":"Paragraph:2e246c81e704_68"},{"__ref":"Paragraph:2e246c81e704_69"},{"__ref":"Paragraph:2e246c81e704_70"},{"__ref":"Paragraph:2e246c81e704_71"},{"__ref":"Paragraph:2e246c81e704_72"},{"__ref":"Paragraph:2e246c81e704_73"},{"__ref":"Paragraph:2e246c81e704_74"},{"__ref":"Paragraph:2e246c81e704_75"},{"__ref":"Paragraph:2e246c81e704_76"},{"__ref":"Paragraph:2e246c81e704_77"},{"__ref":"Paragraph:2e246c81e704_78"},{"__ref":"Paragraph:2e246c81e704_79"},{"__ref":"Paragraph:2e246c81e704_80"},{"__ref":"Paragraph:2e246c81e704_81"},{"__ref":"Paragraph:2e246c81e704_82"},{"__ref":"Paragraph:2e246c81e704_83"},{"__ref":"Paragraph:2e246c81e704_84"},{"__ref":"Paragraph:2e246c81e704_85"},{"__ref":"Paragraph:2e246c81e704_86"},{"__ref":"Paragraph:2e246c81e704_87"},{"__ref":"Paragraph:2e246c81e704_88"},{"__ref":"Paragraph:2e246c81e704_89"},{"__ref":"Paragraph:2e246c81e704_90"},{"__ref":"Paragraph:2e246c81e704_91"},{"__ref":"Paragraph:2e246c81e704_92"},{"__ref":"Paragraph:2e246c81e704_93"},{"__ref":"Paragraph:2e246c81e704_94"},{"__ref":"Paragraph:2e246c81e704_95"},{"__ref":"Paragraph:2e246c81e704_96"},{"__ref":"Paragraph:2e246c81e704_97"},{"__ref":"Paragraph:2e246c81e704_98"},{"__ref":"Paragraph:2e246c81e704_99"},{"__ref":"Paragraph:2e246c81e704_100"},{"__ref":"Paragraph:2e246c81e704_101"},{"__ref":"Paragraph:2e246c81e704_102"},{"__ref":"Paragraph:2e246c81e704_103"},{"__ref":"Paragraph:2e246c81e704_104"},{"__ref":"Paragraph:2e246c81e704_105"},{"__ref":"Paragraph:2e246c81e704_106"},{"__ref":"Paragraph:2e246c81e704_107"},{"__ref":"Paragraph:2e246c81e704_108"},{"__ref":"Paragraph:2e246c81e704_109"},{"__ref":"Paragraph:2e246c81e704_110"},{"__ref":"Paragraph:2e246c81e704_111"},{"__ref":"Paragraph:2e246c81e704_112"},{"__ref":"Paragraph:2e246c81e704_113"},{"__ref":"Paragraph:2e246c81e704_114"},{"__ref":"Paragraph:2e246c81e704_115"},{"__ref":"Paragraph:2e246c81e704_116"},{"__ref":"Paragraph:2e246c81e704_117"},{"__ref":"Paragraph:2e246c81e704_118"},{"__ref":"Paragraph:2e246c81e704_119"},{"__ref":"Paragraph:2e246c81e704_120"},{"__ref":"Paragraph:2e246c81e704_121"},{"__ref":"Paragraph:2e246c81e704_122"},{"__ref":"Paragraph:2e246c81e704_123"},{"__ref":"Paragraph:2e246c81e704_124"},{"__ref":"Paragraph:2e246c81e704_125"},{"__ref":"Paragraph:2e246c81e704_126"},{"__ref":"Paragraph:2e246c81e704_127"},{"__ref":"Paragraph:2e246c81e704_128"},{"__ref":"Paragraph:2e246c81e704_129"},{"__ref":"Paragraph:2e246c81e704_130"},{"__ref":"Paragraph:2e246c81e704_131"},{"__ref":"Paragraph:2e246c81e704_132"},{"__ref":"Paragraph:2e246c81e704_133"},{"__ref":"Paragraph:2e246c81e704_134"},{"__ref":"Paragraph:2e246c81e704_135"},{"__ref":"Paragraph:2e246c81e704_136"},{"__ref":"Paragraph:2e246c81e704_137"},{"__ref":"Paragraph:2e246c81e704_138"},{"__ref":"Paragraph:2e246c81e704_139"},{"__ref":"Paragraph:2e246c81e704_140"},{"__ref":"Paragraph:2e246c81e704_141"},{"__ref":"Paragraph:2e246c81e704_142"},{"__ref":"Paragraph:2e246c81e704_143"},{"__ref":"Paragraph:2e246c81e704_144"},{"__ref":"Paragraph:2e246c81e704_145"},{"__ref":"Paragraph:2e246c81e704_146"},{"__ref":"Paragraph:2e246c81e704_147"},{"__ref":"Paragraph:2e246c81e704_148"},{"__ref":"Paragraph:2e246c81e704_149"},{"__ref":"Paragraph:2e246c81e704_150"},{"__ref":"Paragraph:2e246c81e704_151"},{"__ref":"Paragraph:2e246c81e704_152"},{"__ref":"Paragraph:2e246c81e704_153"},{"__ref":"Paragraph:2e246c81e704_154"},{"__ref":"Paragraph:2e246c81e704_155"},{"__ref":"Paragraph:2e246c81e704_156"},{"__ref":"Paragraph:2e246c81e704_157"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:ddd44ddb6480"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Fshadows-with-a-chance-of-blacknix-badc0f2f41cb","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isPublished":true,"latestPublishedVersion":"2e246c81e704","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":0,"allowResponses":true,"isLimitedState":false,"title":"Shadows with a chance of BlackNix","isSeries":false,"sequence":null,"uniqueSlug":"shadows-with-a-chance-of-blacknix-badc0f2f41cb","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1588785436419,"readingTime":12.775471698113208,"previewContent":{"__typename":"PreviewContent","subtitle":"A long post on analysis of a variant of BlackNix RATs, which are delivered by a dropper with mutex strings associated with Winnti Group."},"previewImage":{"__ref":"ImageMetadata:1*0mWk9dYBhPU8kS7wrC9Cbg.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1588785436419,"updatedAt":1639479669976,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:badc0f2f41cb-viewerId:lo_063d147192f8"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:reverse-engineering"},{"__ref":"Tag:malware-analysis"},{"__ref":"Tag:blacknix-rat"},{"__ref":"Tag:winnti-group"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":2564,"layerCake":0,"responsesLocked":false}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.48bdf878.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.872afbe3.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9120.5df29668.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.a4e221ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.933c1c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.73cb8339.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9898.d9e26c5e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4863.28ab43f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6589.247b1d02.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.0f82ef97.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.8aa8d357.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.2a5e2d95.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.1c286b32.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.60bcefe8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.0350840b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.73a57633.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5794.9e8ff5dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.7749bc66.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.2dc8b1c6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.6565ad5f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.d5e0c2f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.7ad7ca92.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.5a11f4da.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8f3c9ef3ebb4caf6',t:'MTczNDQ5ODM1OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8f3c9ef3ebb4caf6","version":"2024.10.5","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>