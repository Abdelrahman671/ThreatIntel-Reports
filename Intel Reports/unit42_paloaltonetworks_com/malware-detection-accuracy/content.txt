<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">
    <link rel="preconnect" href="https://www.paloaltonetworks.com">
    <link rel="preconnect" href="https://cdn.cookielaw.org">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	    <!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
var main_site_url = 'https://www.paloaltonetworks.com';
var maindomain_lang = 'https://www.paloaltonetworks.com';
function getParameterByName(name, url) {
		if(url == null){
		  url = window.location.href;
		}
	    name = name.replace(/[\[\]]/g, '\\$&');
	    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
		results = regex.exec(url);
	    if (!results) return null;
	    if (!results[2]) return '';
	    return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	var container_q = getParameterByName('container');
	var d_lang = 'en';	
	if(container_q != '' && container_q != null){	    
	    sessionStorage.setItem('container',container_q);
	    	    location.href = 'https://unit42.paloaltonetworks.com/malware-detection-accuracy';
	}
</script>

<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css"></noscript>
  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/malware-detection-accuracy/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/malware-detection-accuracy/" />
<link rel="alternate" hreflang="x-default" href="https://unit42.paloaltonetworks.com/malware-detection-accuracy/" />

	<!-- This site is optimized with the Yoast SEO Premium plugin v23.1 (Yoast SEO v23.1) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Machine Learning Versus Memory Resident Evil</title>
	<meta name="description" content="Malware detection accuracy through memory detection and other tools highlights how to counter increasingly evasive malware types." />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/malware-detection-accuracy/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Machine Learning Versus Memory Resident Evil" />
	<meta property="og:description" content="Malware detection accuracy through memory detection and other tools highlights how to counter increasingly evasive malware types." />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/malware-detection-accuracy/" />
	<meta property="og:site_name" content="Unit 42" />
	<meta property="article:published_time" content="2023-01-31T14:00:26+00:00" />
	<meta property="article:modified_time" content="2024-06-07T19:23:27+00:00" />
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/02_Security-Technology_Category_1920x900.jpg" />
	<meta property="og:image:width" content="1920" />
	<meta property="og:image:height" content="900" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="Akshata Rao, Esmid Idrizovic, Sujit Rokka Chhetri, Bob Jung, Mark Lim" />
	<meta name="twitter:card" content="summary_large_image" />
	<!-- / Yoast SEO Premium plugin. -->


<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Feed" href="https://unit42.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Comments Feed" href="https://unit42.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Machine Learning Versus Memory Resident Evil Comments Feed" href="https://unit42.paloaltonetworks.com/malware-detection-accuracy/feed/" />
<script type="text/javascript">
var globalConfig = {};
var webData = {};
webData.channel = "unit42";
webData.property = "unit42.paloaltonetworks.com";
webData.language = "en_us";
webData.pageType = "blogs";
webData.pageName = "unit42:malware-detection-accuracy";
webData.pageURL = "https://unit42.paloaltonetworks.com/malware-detection-accuracy";
webData.article_title = "Machine Learning Versus Memory Resident Evil";
webData.author = "Akshata Rao,Esmid Idrizovic,Sujit Rokka Chhetri,Bob Jung,Mark Lim";
webData.published_time = "2023-01-31T06:00:26-08:00";
webData.description = "Malware detection accuracy through memory detection and other tools highlights how to counter increasingly evasive malware types.";
webData.keywords = "Security Technology,Threat Research,AI,Evasive Malware,Guloader,Machine Learning,memory detection,Sandbox evasion";
webData.resourceAssetID = "d553c53a48684119b3f0838bde258de3";
</script>
<script type="text/javascript">
var globalConfig = {};
globalConfig.buildName = "UniqueResourceAssetsID_DEC022022";
</script>
<meta property="og:likes" content="10"/>
<meta property="og:readtime" content="12"/>
<meta property="og:views" content="65,088"/>
<meta property="og:date_created" content="January 31, 2023 at 6:00 AM"/>
<meta property="og:post_length" content="3159"/>
<meta property="og:category" content="Security Technology"/>
<meta property="og:category" content="Threat Research"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/security-technology/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-research/"/>
<meta property="og:author" content="Akshata Rao"/>
<meta property="og:author" content="Esmid Idrizovic"/>
<meta property="og:author" content="Sujit Rokka Chhetri"/>
<meta property="og:author" content="Bob Jung"/>
<meta property="og:author" content="Mark Lim"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/esmid-idrizovic/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/bob-jung/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/mark-lim/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta name="post_tags" content="AI,Evasive Malware,Guloader,Machine Learning,memory detection,Sandbox evasion"/>
<meta property="og:post_image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/01/Malware-r3d2.png"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Machine Learning Versus Memory Resident Evil","name":"Machine Learning Versus Memory Resident Evil","description":"Malware detection accuracy through memory detection and other tools highlights how to counter increasingly evasive malware types.","url":"https:\/\/unit42.paloaltonetworks.com\/malware-detection-accuracy\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/malware-detection-accuracy\/","datePublished":"January 31, 2023","articleBody":"Executive Summary\r\nUnit 42 researchers discuss a machine learning pipeline we\u2019ve built around memory-based artifacts from our hypervisor-based sandbox, which is part of Advanced WildFire. This alternative approach is one we\u2019ve come up with to boost detection accuracy against malware using a variety of different evasion techniques.\r\n\r\nAs we discussed in our first two posts in this series, malware authors are routinely refining their shenanigans to make strategies like static analysis and sandboxing ineffective. The continual development and permutation of techniques like packing methodologies and sandbox evasions create a continual cat and mouse game that is difficult to stay on top of for any detection team.\r\n\r\nTo make matters worse, popular detection techniques such as structural analysis, static signatures and many types of dynamic analysis do not fare well against the ever-increasing complexity we encounter in the more prevalent malware families.\r\n\r\n\r\n\r\nRelated Unit 42 Topics\r\nSandbox,\u00a0evasive malware, machine learning, AI, memory detection\r\n\r\n\r\n\r\nStatically Armored and Full of Evasions\r\nMalware authors increasingly employ evasion techniques such as obfuscation, packing and execution of dynamically injected shellcode in process memory. Using cues from the file structure for malware detection might not always succeed. Packing techniques modify the file structure sufficiently to eliminate these clues. Thus, machine learning models trained on this class of features alone would not effectively detect such samples.\r\n\r\nAnother popular alternative to this detection method is to use a machine learning model that predicts maliciousness based on the malware\u2019s execution traces inside a sandbox. However, as detailed in our previous post in this series, sandbox evasions are extremely prevalent and payloads will often choose not to execute based on any number of clues that would point to a sample being emulated.\r\n\r\nMalware can also inadvertently or intentionally corrupt the sandbox environment, overwrite log files or prevent successful analysis for any number of reasons due to the low-level tricks it is playing. This means that training our machine learning models on the execution logs is also not going to be enough to catch these evasive types of malware.\r\nGuLoader Encrypted With NSIS Crypter\r\nIn this post, we will analyze one GuLoader downloader that has been encrypted with an Nullsoft Scriptable Install System (NSIS) crypter. NSIS is an open source system to create Windows installers.\r\n\r\n\r\n\r\nHash\r\ncc6860e4ee37795693ac0ffe0516a63b9e29afe9af0bd859796f8ebaac5b6a8c\r\n\r\n\r\n\r\nWhy Static Analysis Isn\u2019t Going To Help\r\nThe GuLoader malware is encrypted, and it is also delivered through a NSIS installer file that is not ideal for static analysis because the file contents must be unpacked first. Once it\u2019s unpacked, we are still left with encrypted data and one NSIS script. The script itself also dynamically decrypts some parts of the code, which is another factor that makes it harder to detect.\r\n\r\nHowever, there are not many structural clues that would identify this as possible malware. Thus, a machine learning model trained on the Portable Executable (PE) file structure would not be effective in differentiating the file from other benign files.\r\nNSIS Script and Extracting GuLoader Shellcode\r\nTo extract the NSIS script, we have to use an older version of 7-Zip, version 15.05. This version of 7-Zip is able to unpack the script, where newer versions have removed the functionality to unpack NSIS scripts. Once we have extracted the file contents and the NSIS script (shown in Figure 1), we can start analyzing the script and see how the GuLoader sample is being executed.\r\n\r\n[caption id=\"attachment_126886\" align=\"aligncenter\" width=\"600\"] Figure 1. The NSIS script.[\/caption]\r\n\r\nIf we scroll down the script, we quickly notice that the files are being copied into a newly created folder named %APPDATA%\\Farvelade\\Skaermfeltet. Though it\u2019s not clear why, the file paths used seem to be in Danish. After the copying activity, we have regular installation logic in the script, but there is one interesting function named func_30.\r\n\r\nBefore this function is called, the string $INSTDIR\\Filterposerne\\Malkekvg.Nat is copied into a string variable named $4, as shown in Figures 2 and 3. The function func_30 reads data from the Programmeludviklinger210.Kon file and builds up code, which it will call immediately after the character Z has been seen.\r\n\r\nNSIS gives developers the ability to call any exported function from a Windows DLL, and it also allows developers to save the results directly in NSIS registers\/stack. This functionality allows malware authors to dynamically call Windows API functions on runtime and makes static analysis harder because it must be evaluated before being analyzed.\r\n\r\n[caption id=\"attachment_126859\" align=\"aligncenter\" width=\"900\"] Figure 2. Calling function func_30.[\/caption]\r\n\r\n[caption id=\"attachment_126861\" align=\"aligncenter\" width=\"600\"] Figure 3. Decoding NSIS code.[\/caption]\r\n\r\nTo decode the dynamic code, we can write a short Python script that reproduces the behavior and extracts the Windows API calls:\r\nwith open('Programmeludviklinger210.Kon', 'rb') as f:\r\n    buf = f.read()\r\n\r\ndecoded = b''\r\noffset = 3551\r\n\r\nwhile offset &lt; len(buf):\r\n    if buf[offset] == ord('Z'):\r\n        print(decoded.decode('utf-8'))\r\n        decoded = b''\r\n    else:\r\n        decoded += buf[offset].to_bytes(1, byteorder='little')\r\n    offset += 507\r\nFigure 4 shows the decoded data that results from the script above.\r\n\r\n[caption id=\"attachment_126863\" align=\"aligncenter\" width=\"900\"] Figure 4. Decoded Windows API calls.[\/caption]\r\n\r\nThe decoded functions together read a shellcode from another file from the NSIS archive, and they execute it using the EnumWindows function. If we had to write this process in pseudo code, it would look something like this:\r\nint r5, r3;\r\nvoid* r3;\r\nchar* r4 = \"$INSTDIR\\\\Filterposerne\\\\Malkekvg.Nat\"\r\nr5 = kernel32::CreateFileA(r4 , 0x80000000, 0, 0, 4, 0x80, 0)\r\nr3 = kernel32::SetFilePointer(r5, 6078, 0,0)\r\nr1 = kernel32::VirtualAlloc(0, 0x101000, 0x3000, 0x40)\r\nr3 = kernel32::ReadFile(r5, r1, 0x101000,0, 0)\r\nuser32::EnumWindows(r1 ,0)\r\nTo make the remaining analysis easier, we are going to generate one PE with the shellcode. To generate the executable, we can either use a tool like Cerbero Profiler or LIEF Python library.\r\n\r\nIn this case, we have used the LIEF library to build a new executable. All we have to do is to add a new section with the contents of file Malkekvg.Nat and set the entry point to be at the correct offset. Once we get that, we should be able to open our shellcode in IDA Pro (shown in Figure 5) and see that it contains valid x86 instructions.\r\nfrom lief import PE\r\n\r\nwith open('Malkekvg.Nat', 'rb') as f:\r\n    buf = f.read()\r\n\r\npe = PE.Binary('', PE.PE_TYPE.PE32)\r\nsection = PE.Section('.text')\r\nsection.content = bytearray(buf)\r\nsection.virtual_address = 0x1000\r\npe.add_section(section, PE.SECTION_TYPES.TEXT)\r\n\r\npe.optional_header.addressof_entrypoint = section.virtual_address + 6078\r\npe.optional_header.subsystem = PE.SUBSYSTEM.WINDOWS_GUI\r\n\r\nbuilder = PE.Builder(pe)\r\nbuilder.build()\r\nbuilder.write('nsis_guloader_shellcode.exe')\r\n[caption id=\"attachment_126865\" align=\"aligncenter\" width=\"900\"] Figure 5. Generated PE file at entry point in IDA Pro.[\/caption]\r\nAnalysis of the Shellcode\r\nNow that we have the first stage of the shellcode inside a PE file we can run it in dynamic analysis and see what happens. The first thing that we will see is that it detects virtual machines and stops its execution after showing a message box. This text is decrypted on runtime using a 4-byte XOR key.\r\n\r\n[caption id=\"attachment_126888\" align=\"aligncenter\" width=\"300\"] Figure 6. The sample can\u2019t be executed in a virtual environment.[\/caption]\r\n\r\nIf we open the file in IDA Pro and follow the code a little, we should be able to see the large function for decrypting the first stage. While the function graph overview looks large, it\u2019s still easy to identify junk code.\r\n\r\nThe code that is doing the decryption can be seen below in Figure 7. In Figure 8 we can see the final call that jumps to the second stage. At this point, we can dump the second stage into another executable for decryption.\r\n\r\nWe can dump the executable directly from memory, but we must make sure to patch the entry point to point to the correct address (which is 0x404328 in this example).\r\n\r\n[caption id=\"attachment_126869\" align=\"aligncenter\" width=\"900\"] Figure 7. Shellcode decryption of first stage.[\/caption]\r\n\r\n[caption id=\"attachment_126871\" align=\"aligncenter\" width=\"900\"] Figure 8. Call to the next stage.[\/caption]\r\n\r\nThe second stage uses many anti-analysis techniques, which would be too long to describe here and are described elsewhere, so we won\u2019t go too much detail. Here are a few of the anti-analysis techniques mentioned:\r\n\r\n \tMemory scan for known sandbox strings\r\n \tHypervisor checks\r\n \tTime measuring\r\n \tInstruction hammering\r\n\r\nTo get the final payload that is being downloaded by GuLoader, we would have to either manually bypass all these checks, run it inside a sandbox that is immune to all of these techniques, or run it on a bare-metal sandbox.\r\nExtracting Payload Information\r\nTo get the payload information (including all the strings) without analyzing the second stage, we can use a little trick that has been described by Spamhaus. GuLoader uses simple XOR encryption for encrypting its strings, which includes the payload URL.\r\n\r\nAll we need is the encryption key to decrypt everything. The good news is that the key resides somewhere inside the second stage.\r\n\r\nTo decrypt the strings, we can use brute-force on a pattern that we already know exists inside the second stage. The result of that XOR operation would be our key. The only limitation to this is that the pattern must be large enough so that we are able to fully decrypt the payload URL. For example, a good pattern might be the user-agent string, which is set by default to Mozilla\/5.0 (Windows NT 10.0; WOW64; Trident\/7.0; rv:11.0) like Gecko.\r\n\r\nTo quickly find the decryption key automatically, we have to encrypt a short pattern first (e.g., first 8 bytes of the user-agent string) and search if that result is somewhere in the file. If it is somewhere in the file, then we can continue and encrypt the remaining pattern to get the full encryption key.\r\n\r\nAt the end of this blog, we have attached the Python script that is able to find the encryption key from the payload by the method described above. Once we run the script on any dumped second stage GuLoader payload, we should be able to see a few strings and the payload URL.\r\n\r\nGuLoader sometimes includes 7 to 8 random characters in front of the payload URL, which it replaces on runtime with either http:\/\/ or https:\/\/. The distinction of whether http or https is used is made by the fourth character from that random pattern.\r\nUsing key for decryption: 38d45279998ce6f1d737dc8dcebaf88e4964ee5d2aabccc033cf4526b27ab2309bf33c429a95a7490aff0a4dceabbde720aa98e99290e97c4b5f48e1\r\n..\r\n\r\n0x1457b: Mozilla\/5.0 (Windows NT 10.0; WOW64; Trident\/7.0; rv:11.0) like Gecko\r\n0x147af: Msi.dll\r\n0x14827: user32\r\n0x14845: advapi32\r\n0x1485e: shell32\r\n0x14c91: windir=\r\n0x14e91: mshtml.dll\r\n0x14fc0: isidMedozd.com.ar\/wp-includes\/nHMoYlbGLWls101.qxd\r\n0x150a3: \\system32\\\r\n0x15176: \\syswow64\\\r\n0x15459: Startup key\r\n0x154e0: Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\r\n0x15ea8: C:\\Program Files\\qga\\qga.exe\r\n0x15f21: C:\\Program Files\\Qemu-ga\\qemu-ga.exe\r\n..\r\nPayload URL: http:\/\/ozd[.]com[.]ar\/wp-includes\/nHMoYlbGLWls101.qxd\r\nIn this sample, the payload URL was http:\/\/ozd[.]com[.]ar\/wp-includes\/nHMoYlbGLWls101.qxd and the payload was still online at the time of this analysis.\r\n\r\nThe final downloaded payload is from the FormBook malware family, and it had the SHA256 value of fa0b6404535c2b3953e2b571608729d15fb78435949037f13f05d1f5c1758173.\r\nHow Can Machine Learning Detect This?\r\nIn a previous blog post, we detailed several types of observable artifacts that we can extract from memory during a live sandbox run. We\u2019ve found that the data from memory analysis is extremely powerful when combined with machine learning for the detection of malware with multiple evasion techniques.\r\n\r\nThe following section describes our strategy for taking all these observations about what was modified in memory at runtime and combining them with machine learning at scale for malware detection. The algorithm can find patterns automatically, and it can identify commonalities that indicate when malware is attempting to hide its footprints in memory, dynamically allocating and executing shell code, or using unpacking.\r\n\r\nIn this GuLoader sample, right off the bat, a human analyst would identify that there are a few unique function pointers. We would also notice that the malware has changed the page permissions of multiple pages in its own process memory to writable and executable. Our machine learning model is able to automatically perform these activities, taking the features extracted from the various memory artifacts to detect the GuLoader sample.\r\n\r\nAs we discussed earlier in this blog series, the automated analysis platform we\u2019ve created for Advanced WildFire will automatically extract all of these memory-based artifacts in a performant way. This means that all of the information related to dynamically resolved function pointers, permissions changes and unpacked executables can be utilized either in our manually curated detection logic or additionally for our machine learning pipelines.\r\nDetection Using Machine Learning\r\nFigure 9 shows a high level view of how we created a machine learning model pipeline trained on custom features extracted from the aforementioned memory-based artifacts. The features we chose were fashioned to retain the most useful information from the verbose artifacts.\r\n\r\nWe also included malware execution traces as an extra source of information and built an ensemble model to detect the malicious samples. As shown in Figure 9 below, various custom features are automatically extracted from the four memory artifacts and malware execution traces, and they are passed to a classification model for detecting malicious samples. Furthermore, we have built an ensemble model that is trained on memory artifacts and execution trace based features to boost its performance.\r\n\r\n[caption id=\"attachment_126873\" align=\"aligncenter\" width=\"900\"] Figure 9. Machine learning model architecture.[\/caption]\r\nFeature Engineering\r\nWe\u2019ve experimented with the efficacy of raw values from the different feature sources versus custom features for the purposes of model accuracy. Using custom features built using domain knowledge enables us to reduce noise and minimize the number of features overall, thus helping avoid the curse of dimensionality.\r\n\r\nAt the same time, using raw values as features allows us to quickly adapt to newer malware trends that might use changing attack tactics and techniques. We have utilized deep learning to extract features from the logs involving extracted memory-based artifacts and combine that with custom features. Our experiments show that the models work best with a combination of the two approaches.\r\nModel Selection\r\nWhen it comes to model selection, there are a few factors that we have to consider:\r\n\r\n \tSmall model size allows for scaling up the machine learning service to accommodate the ever growing number of samples to process.\r\n \tAccount for the absence of certain feature sources, (e.g., execution traces) in case of errors encountered.\r\n \tModel predictions should be interpretable so we can identify the causal features in the case of disruptive false positives.\r\n \tThe model should attempt to retain as much information as possible from the samples it has trained on.\r\n\r\nA gradient-boosted trees model trained on domain-specific features and custom features extracted from raw data satisfies many of the aforementioned criteria.\r\nTraining the Machine Learning Model\r\n[caption id=\"attachment_126875\" align=\"aligncenter\" width=\"900\"] Figure 10. Machine learning training pipeline.[\/caption]\r\n\r\nThe file samples are processed by a streaming pipeline to save memory artifacts and other malware attributes to a feature store. The feature extraction stage uses a combination of streaming and batch processing PySpark jobs to generate the final feature vector used for training the model.\r\n\r\nThe ground truth labels come from a separate pipeline that assigns labels to the samples based on malware characteristics and researcher inputs. The pipeline generates non-overlapping training and evaluation datasets by using the sample first seen time and hashes.\r\n\r\nOnce the machine learning model is trained and satisfies the predefined evaluation checks, including expected improvement over the currently active model, it\u2019s pushed to the production machine learning service.\r\nInterpreting Model Predictions\r\nIt\u2019s crucial to understand the machine learning model\u2019s predictions in order to identify the limitations and the capabilities of the model. Machine learning is prone to false positives, as it\u2019s heavily dependent on the quality and variety of the training data, as well as the ability to generalize on a changing landscape of files to predict on. Thus, having the ability to identify the causal features for a prediction can be very helpful.\r\n\r\nWe use two methodologies to assist with this process.\r\nInterpreting Shapley Values\r\nShapley Additive Explanations (SHAP) is a game-theoretical approach used to explain the output of any machine learning model. The SHAP values explain the influence of each feature on the actual prediction for an input feature vector as opposed to the baseline prediction. In Figure 11, the features in red, from right to left, are the topmost features that push the model towards a malicious prediction. The features in blue, from left to right, indicate the topmost features that reduce the probability of the prediction being malware.\r\n\r\n[caption id=\"attachment_126877\" align=\"aligncenter\" width=\"900\"] Figure 11. Force plot of SHAP values for GuLoader sample.[\/caption]\r\n\r\nIn the figure above, we have plotted the force plot for the top seven features with significant SHAP values and their corresponding raw feature values. Our machine learning model was able to detect GuLoader due to the presence of these top features. These features correspond to several specific dynamically resolved API pointers and their relative locations in memory, as well as the relative types of memory page permission changes that were made by the sample.\r\nFinding Similar Samples Through Clustering\r\nAnother approach to understanding the model\u2019s predictions is to identify similar samples in the training dataset. We use density based scan (DBScan) as a clustering technique, shown in Figure 12, as it allows for outliers and different shaped clusters.\r\n\r\n[caption id=\"attachment_126879\" align=\"aligncenter\" width=\"355\"] Figure 12. DBSCAN based clustering.[\/caption]\r\n\r\nThis approach also expands its use beyond model interpretation to find similar samples that belong to the same malware family or APT group. Using DBScan we can find out the cluster where the GuLoader sample resides and extract samples. Furthermore, we can also extract samples which are similar to it in feature space.\r\nConclusion\r\nThe GuLoader family is an excellent example of malware to detect with our machine learning model, because its use of sandbox evasions and static armoring makes it hard for traditional defenses to detect using structural cues and execution logs alone.\r\n\r\nWith Advanced WildFire, we introduce a hypervisor-based sandbox that can stealthily observe the memory of GuLoader during execution to parse meaningful memory resident artifacts and information useful for our machine learning detection pipeline. This allows us to accurately detect the malicious behavior using features extracted from the observed memory-based artifacts.\r\n\r\nPalo Alto Networks customers receive protections from threats such as those discussed in this post with Advanced WildFire.\r\nIndicators of Compromise\r\ncc6860e4ee37795693ac0ffe0516a63b9e29afe9af0bd859796f8ebaac5b6a8c\r\nfa0b6404535c2b3953e2b571608729d15fb78435949037f13f05d1f5c1758173 (Final payload)\r\nAdditional Resources\r\nThreat Assessment: GandCrab and REvil Ransomware\r\nSHAP Documentation\r\nGuLoader Strings Decryptor","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2024\/06\/02_Security-Technology_Category_1920x900-300x300.jpg","width":300,"height":300},"speakable":{"@type":"SpeakableSpecification","xPath":["\/html\/head\/title","\/html\/head\/meta[@name='description']\/@content"]},"author":[{"@type":"Person","name":"Akshata Rao"},{"@type":"Person","name":"Esmid Idrizovic"},{"@type":"Person","name":"Sujit Rokka Chhetri"},{"@type":"Person","name":"Bob Jung"},{"@type":"Person","name":"Mark Lim"}]}</script><link rel='stylesheet' id='crayon-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' media='all' />
<style id='co-authors-plus-coauthors-style-inline-css'>
.wp-block-co-authors-plus-coauthors.is-layout-flow [class*=wp-block-co-authors-plus]{display:inline}

</style>
<style id='co-authors-plus-avatar-style-inline-css'>
.wp-block-co-authors-plus-avatar :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-avatar :where(img){vertical-align:middle}.wp-block-co-authors-plus-avatar:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-avatar.aligncenter{display:table;margin-inline:auto}

</style>
<style id='co-authors-plus-image-style-inline-css'>
.wp-block-co-authors-plus-image{margin-bottom:0}.wp-block-co-authors-plus-image :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-image :where(img){vertical-align:middle}.wp-block-co-authors-plus-image:is(.alignfull,.alignwide) :where(img){width:100%}.wp-block-co-authors-plus-image:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-image.aligncenter{display:table;margin-inline:auto}

</style>
<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='post-views-counter-frontend-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.min.css?ver=1.4.7' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.min.css?ver=1' media='all' />
<link rel='stylesheet' id='unit42-v6-style-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/style.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-head-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/head-styles.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v5-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-plugin-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/plugin.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main-redesign.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='like-dislike-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/css/ldc-lite.css?ver=1.0.0' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script id="crayon_js-js-extra">
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" id="crayon_js-js"></script>
<script id="post-views-counter-frontend-js-before">
var pvcArgsFrontend = {"mode":"js","postID":126856,"requestURL":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","nonce":"c3b9727a80","dataStorage":"cookies","multisite":false,"path":"\/","domain":""};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/js/frontend.min.js?ver=1.4.7" id="post-views-counter-frontend-js"></script>
<script id="wpml-xdomain-data-js-extra">
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en","_nonce":"d123c4ca65"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.6.12" id="wpml-xdomain-data-js" defer data-wp-strategy="defer"></script>
<link rel="https://api.w.org/" href="https://unit42.paloaltonetworks.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://unit42.paloaltonetworks.com/wp-json/wp/v2/posts/126856" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=126856' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fmalware-detection-accuracy%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fmalware-detection-accuracy%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.6.12 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
			padding-top:0px;
			padding-bottom:0px;
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>      <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="32x32" />
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<meta name="msapplication-TileImage" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<script>var $ = jQuery;</script>

    <script type="text/javascript">
    ;(function(win, doc, style, timeout) {
    var STYLE_ID = 'at-body-style';
    function getParent() {
    return doc.getElementsByTagName('head')[0];
    }
    function addStyle(parent, id, def) {
        if (!parent) {
        return;
        }
        var style = doc.createElement('style');
        style.id = id;
        style.innerHTML = def;
        parent.appendChild(style);
    }
    function removeStyle(parent, id) {
        if (!parent) {
            return;
        }
        var style = doc.getElementById(id);
        if (!style) {
            return;
        }
        parent.removeChild(style);
    }
    addStyle(getParent(), STYLE_ID, style);
    setTimeout(function() {
    removeStyle(getParent(), STYLE_ID);
    }, timeout);
    }(window, document, "body {visibility:hidden !important}", 3000));
    </script>

            <script src="https://assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
            <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>


<script type="text/javascript">
var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
if(isIE11){
    var polyfill = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/scripts/polyfill.min.js';
    document.write('<script type="text/javascript" src="'+polyfill+'">\x3C/script>');
}
    /**
 * String.prototype.replaceAll() polyfill
 * https://gomakethings.com/how-to-replace-a-section-of-a-string-with-another-one-with-vanilla-js/
 * @author Chris Ferdinandi
 * @license MIT
 */
if (!String.prototype.replaceAll) {
	String.prototype.replaceAll = function(str, newStr){
		// If a regex pattern
		if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {
			return this.replace(str, newStr);
		}
		// If a string
		return this.replace(new RegExp(str, 'g'), newStr);
	};
}

    /*! lozad.js - v1.16.0 - 2020-09-06 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});

</script>

<!-- <script src="https://www.google.com/recaptcha/api.js"></script>  -->

<!--  End: Scripts Migrated From Unit42-v5 -->

</head>
<body class="post-template-default single single-post postid-126856 single-format-standard no-sidebar">
<header class="haeder py-15 position-relative z-index-2" style="display: none;">
  <div class="container px-sm-30 px-35">
    <div class="row">
        <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                        <a href="https://www.paloaltonetworks.com/">
                <img src="/wp-content/uploads/2021/07/PANW_Parent.png" width="140px" alt="Logo" />
            </a>
        </div>
      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo"  width="150" height="35"/>
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search" aria-label="search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required aria-label="Inner Search">
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10"  style="display: none!important;">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-119884" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-119884"><a target="_blank" rel="noopener" href="https://www.paloaltonetworks.com/unit42">Security Consulting</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
<li id="menu-item-121229" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-121229"><a href="https://start.paloaltonetworks.com/contact-unit42.html"><b style="color:#C84727">Under Attack?</b></a></li>
</ul>  </div>
</nav>
<div class="panClean pan-template-home" id="main-nav-menu-cont" style="display:none;">
    <div class="cleanHeader mainNavigationComp baseComponent parbase">
        <div class="productNav2021Component dark default" id="PAN_2021_NAV_ASYNC">
        </div>
  </div>
<div class="cleanTopHtml htmlComp baseComponent parbase"><div class="base-component-spacer spacer-none  "></div>
</div>
</div>
<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
	function getCookie(cname) {
	 	var name = cname + "=";
  		var decodedCookie = decodeURIComponent(document.cookie);
		var ca = decodedCookie.split(';');
  		for(var i = 0; i <ca.length; i++) {
    			var c = ca[i];
    			while (c.charAt(0) == ' ') {
     				 c = c.substring(1);
    			}
    			if (c.indexOf(name) == 0) {
    				 return c.substring(name.length, c.length);
    			}
  		}
  		return "";
	}

	var referer = "";//sessionStorage.container;
	var pcontainer = sessionStorage.getItem("container");
	var searchResultsPagePath = "";
	if(((pcontainer) && pcontainer.indexOf('Prisma')!=-1)){
	    referer = 'Prisma' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Cortex')!=-1)){
	    referer = 'Cortex' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Sase')!=-1)){
	    referer = 'Sase' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Unit')!=-1)){
	    referer = 'Unit' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Ngfw')!=-1)){
	    referer = 'Ngfw' ;
	}
        var fromRef = document.referrer;
        var nContainer = getCookie("navContainer");
        if(nContainer){//If user is coming from main site, we need to reset the container		
		if(fromRef  && fromRef.indexOf("prismacloud.io")!=-1){
                        referer = 'Prisma' ;
                        sessionStorage.setItem("container","Prisma");
                } else if(fromRef.indexOf("paloaltonetworks.com")!=-1 || fromRef.indexOf("paloaltonetworks.jp")!=-1 ){
                        if(nContainer.indexOf('Prisma') != -1){
                            referer = 'Prisma' ;
                            sessionStorage.setItem("container","Prisma");
                        }
                        if(nContainer.indexOf('Cortex') != -1){
                            referer = 'Cortex' ;
                            sessionStorage.setItem("container","Cortex");
                        }
			if(nContainer.indexOf('Sase') != -1){
                            referer = 'Sase' ;
                            sessionStorage.setItem("container","Sase");
                        }
			if(nContainer.indexOf('Unit') != -1){
                            referer = 'Unit' ;
                            sessionStorage.setItem("container","Unit");
                        }
			if(nContainer.indexOf('Ngfw') != -1){
                            referer = 'Ngfw' ;
                            sessionStorage.setItem("container","Ngfw");
                        }
			document.cookie = 'navContainer=; path=/; domain=.paloaltonetworks.com; expires=' + new Date(0).toUTCString();
		}
	}
if(referer != "Prisma" && referer != "Cortex" && referer != "Sase" && referer != "Unit" && referer != "Ngfw") {
    referer = 'Unit' ;
    sessionStorage.setItem("container","Unit");
}
function callMainSitePrismaNavHTML(){
    
    var referrer_domain = 'https://www.paloaltonetworks.com';
    sessionStorage.setItem("domain",referrer_domain);
    if(referer == 'Prisma'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/prismasearch";
        }
    if(referer == 'Cortex'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderCortex.cortexRenderer.html';	
        searchResultsPagePath = referrer_domain+"/search/cortexsearch";	
    }
    if(referer == 'Sase'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderSase.saseRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/sasesearch";
    }
    if(referer == 'Unit'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/unit-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/content/pan/en_US/search/unit42search";
		    }
    if(referer == 'Ngfw'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/ngfw-cdss-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/search/ngfwcdsssearch";
    }
    httpGet(menu_url,'menu_html');
    document.getElementById('main-nav-menu-cont').removeAttribute("style");
}
function addStyle(styles) {            
    /* Create style document */
    var css = document.createElement('style');
    css.type = 'text/css';

    if (css.styleSheet) 
        css.styleSheet.cssText = styles;
    else 
        css.appendChild(document.createTextNode(styles));

    /* Append style to the tag name */
    document.getElementsByTagName("head")[0].appendChild(css);
}
function httpGet(theUrl,req_type) {
    if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            if(req_type == 'menu_html'){
            var nav_text = xmlhttp.responseText.replaceAll('https://static.cloud.coveo.com/searchui/v2.9159/js/CoveoJsSearch.Lazy.min.js', '');
            nav_text = nav_text.replaceAll('src="/', 'src="'+maindomain_lang+'/');
            nav_text = nav_text.replaceAll("'/content", "'"+maindomain_lang+"/content");
                        
            document.getElementById("PAN_2021_NAV_ASYNC").innerHTML = nav_text.replaceAll('href="/', 'href="'+maindomain_lang+'/');

            var lozad_back = document.getElementsByClassName('lozad-background');
            Array.prototype.forEach.call(lozad_back, function(el) {
            // Do stuff here
            var el_back_img_path = el.getAttribute('data-background-image');
            var first_pos = el_back_img_path.indexOf("'");
            var last_pos = el_back_img_path.indexOf("'",first_pos+1);
            el_back_img_path = el_back_img_path.substring(first_pos+1,last_pos);
            el.setAttribute("data-background-image",main_site_url+el_back_img_path);
            });
            }
            if(req_type == 'head_inline_css'){
            addStyle(xmlhttp.responseText);
            }
        }
    }
    xmlhttp.open("GET", theUrl, true );
    xmlhttp.send();    
}    
    
if(referer == 'Prisma' || referer == 'Cortex' || referer == 'Sase' || referer == 'Unit' || referer == 'Ngfw'){
    const article = document.querySelector('#PAN_2021_NAV_ASYNC');
    if(referer == 'Prisma'){
        article.dataset.type = 'prisma';
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    else if(referer == 'Cortex'){
        article.dataset.type = 'cortex';
    }
    else if(referer == 'Sase'){
        article.dataset.type = 'sase';
    }
    else if(referer == 'Unit'){
        article.dataset.type = 'unit';
    }
    else if(referer == 'Ngfw'){
        article.dataset.type = 'ngfw';
    }
    //set class to default
    if(referer == 'Unit' || referer == 'Ngfw'){
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    callMainSitePrismaNavHTML();        
}
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->



<main class="main">
    <section class="section section--article">
        <div class="pa article-banner" style="background-image:url('https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/02_Security-Technology_Category_1920x900.jpg')">
          <div class="l-container"> 
            <div class="l-breadcrumbs"> 
              <ul> <li> <a href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:breadcrumb:Threat Research">Threat Research Center</a></li><li><a href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" title="Threat Research" data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:breadcrumb:Threat Research">Threat Research</a></li><li class="is-current"><a href="https://unit42.paloaltonetworks.com/category/security-technology/" role="link" title="Security Technology" data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:breadcrumb:Security Technology">Security Technology</a></li> </ul>
            </div>            <div class="ab__title">
              <a class="card-category" href="https://unit42.paloaltonetworks.com/category/security-technology/" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:Security Technology"><span class="ab-title__pre">Security Technology</span></a> 
              <h1>Machine Learning Versus Memory Resident Evil</h1>
              <div class="ab__video">
              <span class="duration"> 
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-clock.svg" alt="Clock Icon"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 12</span> <span class="rt-label rt-postfix"></span></span> min read              </span>
                              </div>          
              <div class="ab-lc__wrapper">
                <span class="ab-title__pre">Related Products</span><div class="ab__link-cards"><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/advanced-wildfire/" style="--card-color: #ffcb06" role="link" title="Advanced WildFire" data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:Advanced WildFire"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Advanced WildFire icon">Advanced WildFire</a></div>              </div>
            </div>
          </div>
          <div class="ab__footer">
            <div class="l-container">
              <div class="ab__footer-wrapper">
                <ul class="ab__features" role="list">
                  <li role="listitem">
				 <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-profile-grey.svg" alt="Profile Icon">
					 <div class="ab__text"><span>By:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:Akshata Rao" href="https://unit42.paloaltonetworks.com/author/akshata-rao/">Akshata Rao</a></li><li><a data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:Esmid Idrizovic" href="https://unit42.paloaltonetworks.com/author/esmid-idrizovic/">Esmid Idrizovic</a></li><li><a data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:Sujit Rokka Chhetri" href="https://unit42.paloaltonetworks.com/author/sujit-rokka-chhetri/">Sujit Rokka Chhetri</a></li><li><a data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:Bob Jung" href="https://unit42.paloaltonetworks.com/author/bob-jung/">Bob Jung</a></li><li><a data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:Mark Lim" href="https://unit42.paloaltonetworks.com/author/mark-lim/">Mark Lim</a></li></ul></div></li>                  <li role="listitem">
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-calendar-grey.svg" alt="Published Icon">
			<div class="ab__text"><span>Published:</span>31 January, 2023 at 6:00 AM PST</div></li>					<li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-category.svg" alt="Tags Icon"><div class="ab__text"><span>Categories:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:Security Technology" href="https://unit42.paloaltonetworks.com/category/security-technology/">Security Technology</a></li><li><a data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:Threat Research" href="https://unit42.paloaltonetworks.com/category/threat-research/">Threat Research</a></li></ul></div>
		</li>                  <li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-tags-grey.svg" alt="Tags Icon"><div class="ab__text"><span>Tags:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:AI" href="https://unit42.paloaltonetworks.com/tag/ai/">AI</a></li><li><a data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:Evasive Malware" href="https://unit42.paloaltonetworks.com/tag/evasive-malware/">Evasive Malware</a></li><li><a data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:Guloader" href="https://unit42.paloaltonetworks.com/tag/guloader/">Guloader</a></li><li><a data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:Machine Learning" href="https://unit42.paloaltonetworks.com/tag/machine-learning/">Machine Learning</a></li><li><a data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:memory detection" href="https://unit42.paloaltonetworks.com/tag/memory-detection/">Memory detection</a></li><li><a data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:Sandbox evasion" href="https://unit42.paloaltonetworks.com/tag/sandbox-evasion/">Sandbox evasion</a></li></ul></div>
		</li>                </ul>
                <div class="ab__options">
                  <ul role="list">
                                        <li role="listitem"><a href="https://unit42.paloaltonetworks.com/malware-detection-accuracy/?pdf=download&#038;lg=en&#038;_wpnonce=dcff69efdc" role="link" target="_blank"  title="Click here to download" data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:pdfdownload"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-download.svg" alt="Download Icon"></a></li>
                    <li role="listitem"><a href="https://unit42.paloaltonetworks.com/malware-detection-accuracy/?pdf=print&#038;lg=en&#038;_wpnonce=dcff69efdc" target="_blank" role="link" title="Click here to print" data-page-track="true" data-page-track-value="malware-detection-accuracy:hero:pdfprint"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-print.svg" alt="Print Icon"></a></li>
                  </ul>
                  
	<div class="ab__share" id="shareDropdown" role="button" aria-expanded="false">
	<a href="#" role="link" title="Click here to share" data-page-track="true" data-page-track-value="malware-detection-accuracy:share" class="">Share<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"></a><ul class="share-dropdown" role="menu">
				<li role="menuitem">
					<a href="#" class="copy-url" id="copyUrl" data-url="https://unit42.paloaltonetworks.com/malware-detection-accuracy/" role="link" title="Copy link" data-page-track="true" data-page-track-value="malware-detection-accuracy:share:link"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-share-link.svg" alt="Link Icon"></a>
				</li>
				<li role="menuitem">
					<a href="mailto:?subject=Machine%20Learning%20Versus%20Memory%20Resident%20Evil&#038;body=Check%20out%20this%20article%20https%3A%2F%2Funit42.paloaltonetworks.com%2Fmalware-detection-accuracy%2F" role="link" title="Share in email" data-page-track="true" data-page-track-value="malware-detection-accuracy:share:email"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-sms.svg" alt="Link Email"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fmalware-detection-accuracy%2F" target="_blank" role="link" title="Share in Facebook" data-page-track="true" data-page-track-value="malware-detection-accuracy:share:facebook"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-fb-share.svg" alt="Facebook Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fmalware-detection-accuracy%2F&#038;title=Machine%20Learning%20Versus%20Memory%20Resident%20Evil" target="_blank" role="link" title="Share in LinkedIn" data-page-track="true" data-page-track-value="malware-detection-accuracy:share:linkedin"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-linkedin-share.svg" alt="LinkedIn Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fmalware-detection-accuracy%2F&#038;text=Machine%20Learning%20Versus%20Memory%20Resident%20Evil" target="_blank" role="link" title="Share in Twitter" data-page-track="true" data-page-track-value="malware-detection-accuracy:share:twitter"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-twitter-share.svg" alt="Twitter Icon"></a>
				</li>
				<li role="menuitem">
					<a href="//www.reddit.com/submit?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fmalware-detection-accuracy%2F" target="_blank" role="link" title="Share in Reddit" data-page-track="true" data-page-track-value="malware-detection-accuracy:share:reddit"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-reddit-share.svg" alt="Reddit Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://mastodon.social/share?text=Machine%20Learning%20Versus%20Memory%20Resident%20Evil%20https%3A%2F%2Funit42.paloaltonetworks.com%2Fmalware-detection-accuracy%2F" target="_blank" role="link" title="Share in Mastodon" data-page-track="true" data-page-track-value="malware-detection-accuracy:share:mastodon"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-mastodon-share.svg" alt="Mastodon Icon"></a>
				</li>
	  </ul>
    </div>                </div>
              </div>
            </div>
          </div>
        </div>
      </section> 
    <section class="section blog-contents"> 
      <div class="pa blog-editor">
        <div class="l-container">
          <div class="be__wrapper">
            <div class="be__contents">
              <div class="be__contents-wrapper">
                <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/malware-detection-accuracy/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><h2><a id="post-126856-_z79yymbcl6rh"></a>Executive Summary</h2>
<p>Unit 42 researchers discuss a machine learning pipeline we’ve built around memory-based artifacts from our hypervisor-based sandbox, which is part of Advanced WildFire. This alternative approach is one we’ve come up with to boost detection accuracy against malware using a variety of different evasion techniques.</p>
<p>As we discussed in <a href="https://unit42.paloaltonetworks.com/tag/memory-detection/">our first two posts</a> in this series, malware authors are routinely refining their shenanigans to make strategies like static analysis and sandboxing ineffective. The continual development and permutation of techniques like packing methodologies and sandbox evasions create a continual cat and mouse game that is difficult to stay on top of for any detection team.</p>
<p>To make matters worse, popular detection techniques such as structural analysis, static signatures and many types of dynamic analysis do not fare well against the ever-increasing complexity we encounter in the more prevalent malware families.</p>
<table style="width: 100%;">
<thead>
<tr>
<td style="width: 35%;"><b>Related Unit 42 Topics</b></td>
<td style="width: 100%;"><a href="https://unit42.paloaltonetworks.com/tag/sandbox/"><span style="font-weight: 400;">Sandbox</span></a><span style="font-weight: 400;">,</span><span style="font-weight: 400;"> </span><a href="https://unit42.paloaltonetworks.com/tag/evasive-malware/"><span style="font-weight: 400;">evasive malware</span></a><span style="font-weight: 400;">, </span><a href="https://unit42.paloaltonetworks.com/tag/machine-learning/"><span style="font-weight: 400;">machine learning</span></a><span style="font-weight: 400;">, </span><a href="https://unit42.paloaltonetworks.com/tag/ai/"><span style="font-weight: 400;">AI</span></a><span style="font-weight: 400;">, </span><a href="https://unit42.paloaltonetworks.com/tag/memory-detection/"><span style="font-weight: 400;">memory detection</span></a></td>
</tr>
</thead>
</table>
<h2><a id="post-126856-_e3aliopza7nu"></a>Statically Armored and Full of Evasions</h2>
<p>Malware authors increasingly employ evasion techniques such as obfuscation, packing and execution of dynamically injected shellcode in process memory. Using cues from the file structure for malware detection might not always succeed. Packing techniques modify the file structure sufficiently to eliminate these clues. Thus, machine learning models trained on this class of features alone would not effectively detect such samples.</p>
<p>Another popular alternative to this detection method is to use a machine learning model that predicts maliciousness based on the malware’s execution traces inside a sandbox. However, as detailed in <a href="https://unit42.paloaltonetworks.com/sandbox-evasion-memory-detection/" target="_blank" rel="noopener">our previous post in this series</a>, sandbox evasions are extremely prevalent and payloads will often choose not to execute based on any number of clues that would point to a sample being emulated.</p>
<p>Malware can also inadvertently or intentionally corrupt the sandbox environment, overwrite log files or prevent successful analysis for any number of reasons due to the <a href="https://unit42.paloaltonetworks.com/single-bit-trap-flag-intel-cpu/" target="_blank" rel="noopener">low-level tricks</a> it is playing. This means that training our machine learning models on the execution logs is also not going to be enough to catch these evasive types of malware.</p>
<h2><a id="post-126856-_6juyw5ml537l"></a>GuLoader Encrypted With NSIS Crypter</h2>
<p>In this post, we will analyze one GuLoader downloader that has been encrypted with an Nullsoft Scriptable Install System (NSIS) crypter. NSIS is an open source system to create Windows installers.</p>
<table style="width: 95%;">
<tbody>
<tr>
<td style="width: 11.7211%;"><b>Hash</b></td>
<td style="width: 87.092%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">cc6860e4ee37795693ac0ffe0516a63b9e29afe9af0bd859796f8ebaac5b6a8c</span></td>
</tr>
</tbody>
</table>
<h3><a id="post-126856-_xypli3b9mzob"></a>Why Static Analysis Isn’t Going To Help</h3>
<p>The GuLoader malware is encrypted, and it is also delivered through a NSIS installer file that is not ideal for static analysis because the file contents must be unpacked first. Once it’s unpacked, we are still left with encrypted data and one NSIS script. The script itself also dynamically decrypts some parts of the code, which is another factor that makes it harder to detect.</p>
<p>However, there are not many structural clues that would identify this as possible malware. Thus, a machine learning model trained on the Portable Executable (PE) file structure would not be effective in differentiating the file from other benign files.</p>
<h3><a id="post-126856-_y9nyq1u72m3c"></a>NSIS Script and Extracting GuLoader Shellcode</h3>
<p>To extract the NSIS script, we have to use an older version of 7-Zip, version 15.05. This version of 7-Zip is able to unpack the script, where newer versions have removed the functionality to unpack NSIS scripts. Once we have extracted the file contents and the NSIS script (shown in Figure 1), we can start analyzing the script and see how the GuLoader sample is being executed.</p>
<figure id="attachment_126886" aria-describedby="caption-attachment-126886" style="width: 600px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-126886" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/01/ML-AWS-F1.png" alt="Image 1 is a screenshot of many lines of code the NSIS script, prepared to analyze." width="600" height="790" /><figcaption id="caption-attachment-126886" class="wp-caption-text">Figure 1. The NSIS script.</figcaption></figure>
<p>If we scroll down the script, we quickly notice that the files are being copied into a newly created folder named <span style="font-family: 'courier new', courier, monospace;">%APPDATA%\Farvelade\Skaermfeltet</span>. Though it’s not clear why, the file paths used seem to be in Danish. After the copying activity, we have regular installation logic in the script, but there is one interesting function named <span style="font-family: 'courier new', courier, monospace;">func_30</span>.</p>
<p>Before this function is called, the string <span style="font-family: 'courier new', courier, monospace;">$INSTDIR\Filterposerne\Malkekvg.Nat</span> is copied into a string variable named <span style="font-family: 'courier new', courier, monospace;">$4</span>, as shown in Figures 2 and 3. The function <span style="font-family: 'courier new', courier, monospace;">func_30</span> reads data from the <span style="font-family: 'courier new', courier, monospace;">Programmeludviklinger210.Kon</span> file and builds up code, which it will call immediately after the character <span style="font-family: 'courier new', courier, monospace;">Z</span> has been seen.</p>
<p>NSIS gives developers the ability to call any exported function from a Windows DLL, and it also allows developers to save the results directly in NSIS registers/stack. This functionality allows malware authors to dynamically call Windows API functions on runtime and makes static analysis harder because it must be evaluated before being analyzed.</p>
<figure id="attachment_126859" aria-describedby="caption-attachment-126859" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-126859" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/01/word-image-126856-2.png" alt="Image 2 is a screenshot of a few lines of code of the NSIS script as it calls function func_30." width="900" height="368" /><figcaption id="caption-attachment-126859" class="wp-caption-text">Figure 2. Calling function func_30.</figcaption></figure>
<figure id="attachment_126861" aria-describedby="caption-attachment-126861" style="width: 600px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-126861" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/01/word-image-126856-3.png" alt="Image 3 is a screenshot of many lines of code showing the NSIS code as it is decoded." width="600" height="597" /><figcaption id="caption-attachment-126861" class="wp-caption-text">Figure 3. Decoding NSIS code.</figcaption></figure>
<p>To decode the dynamic code, we can write a short Python script that reproduces the behavior and extracts the Windows API calls:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6719b5362fb2f732889839" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
with open('Programmeludviklinger210.Kon', 'rb') as f:
    buf = f.read()

decoded = b''
offset = 3551

while offset &lt; len(buf):
    if buf[offset] == ord('Z'):
        print(decoded.decode('utf-8'))
        decoded = b''
    else:
        decoded += buf[offset].to_bytes(1, byteorder='little')
    offset += 507</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6719b5362fb2f732889839-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb2f732889839-2">2</div><div class="crayon-num" data-line="crayon-6719b5362fb2f732889839-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb2f732889839-4">4</div><div class="crayon-num" data-line="crayon-6719b5362fb2f732889839-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb2f732889839-6">6</div><div class="crayon-num" data-line="crayon-6719b5362fb2f732889839-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb2f732889839-8">8</div><div class="crayon-num" data-line="crayon-6719b5362fb2f732889839-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb2f732889839-10">10</div><div class="crayon-num" data-line="crayon-6719b5362fb2f732889839-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb2f732889839-12">12</div><div class="crayon-num" data-line="crayon-6719b5362fb2f732889839-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6719b5362fb2f732889839-1"><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">'Programmeludviklinger210.Kon'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'rb'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">f</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb2f732889839-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">buf</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">f</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6719b5362fb2f732889839-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb2f732889839-4"><span class="crayon-i">decoded</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">b</span><span class="crayon-s">''</span></div><div class="crayon-line" id="crayon-6719b5362fb2f732889839-5"><span class="crayon-i">offset</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">3551</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb2f732889839-6">&nbsp;</div><div class="crayon-line" id="crayon-6719b5362fb2f732889839-7"><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-i">offset</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-i">buf</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb2f732889839-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">buf</span><span class="crayon-sy">[</span><span class="crayon-i">offset</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-s">'Z'</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-6719b5362fb2f732889839-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-i">decoded</span><span class="crayon-sy">.</span><span class="crayon-e">decode</span><span class="crayon-sy">(</span><span class="crayon-s">'utf-8'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb2f732889839-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">decoded</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">b</span><span class="crayon-s">''</span></div><div class="crayon-line" id="crayon-6719b5362fb2f732889839-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb2f732889839-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">decoded</span><span class="crayon-h"> </span>+=<span class="crayon-h"> </span><span class="crayon-i">buf</span><span class="crayon-sy">[</span><span class="crayon-i">offset</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">to_bytes</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">byteorder</span>=<span class="crayon-s">'little'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6719b5362fb2f732889839-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">offset</span><span class="crayon-h"> </span>+=<span class="crayon-h"> </span><span class="crayon-cn">507</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Figure 4 shows the decoded data that results from the script above.</p>
<figure id="attachment_126863" aria-describedby="caption-attachment-126863" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-126863" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/01/word-image-126856-4.png" alt="Image 4 is a screenshot of a few lines of code showing the decoded Windows API calls." width="900" height="147" /><figcaption id="caption-attachment-126863" class="wp-caption-text">Figure 4. Decoded Windows API calls.</figcaption></figure>
<p>The decoded functions together read a shellcode from another file from the NSIS archive, and they execute it using the <span style="font-family: 'courier new', courier, monospace;">EnumWindows</span> function. If we had to write this process in pseudo code, it would look something like this:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6719b5362fb35111113685" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
int r5, r3;
void* r3;
char* r4 = "$INSTDIR\\Filterposerne\\Malkekvg.Nat"
r5 = kernel32::CreateFileA(r4 , 0x80000000, 0, 0, 4, 0x80, 0)
r3 = kernel32::SetFilePointer(r5, 6078, 0,0)
r1 = kernel32::VirtualAlloc(0, 0x101000, 0x3000, 0x40)
r3 = kernel32::ReadFile(r5, r1, 0x101000,0, 0)
user32::EnumWindows(r1 ,0)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6719b5362fb35111113685-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb35111113685-2">2</div><div class="crayon-num" data-line="crayon-6719b5362fb35111113685-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb35111113685-4">4</div><div class="crayon-num" data-line="crayon-6719b5362fb35111113685-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb35111113685-6">6</div><div class="crayon-num" data-line="crayon-6719b5362fb35111113685-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb35111113685-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6719b5362fb35111113685-1"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-i">r5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">r3</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb35111113685-2"><span class="crayon-t">void</span>*<span class="crayon-h"> </span><span class="crayon-i">r3</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-6719b5362fb35111113685-3"><span class="crayon-t">char</span>*<span class="crayon-h"> </span><span class="crayon-i">r4</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">"$INSTDIR\\Filterposerne\\Malkekvg.Nat"</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb35111113685-4"><span class="crayon-i">r5</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">kernel32</span><span class="crayon-sy">:</span><span class="crayon-sy">:</span><span class="crayon-e">CreateFileA</span><span class="crayon-sy">(</span><span class="crayon-i">r4</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x80000000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6719b5362fb35111113685-5"><span class="crayon-i">r3</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">kernel32</span><span class="crayon-sy">:</span><span class="crayon-sy">:</span><span class="crayon-e">SetFilePointer</span><span class="crayon-sy">(</span><span class="crayon-i">r5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">6078</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb35111113685-6"><span class="crayon-i">r1</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">kernel32</span><span class="crayon-sy">:</span><span class="crayon-sy">:</span><span class="crayon-e">VirtualAlloc</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x101000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x3000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x40</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6719b5362fb35111113685-7"><span class="crayon-i">r3</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">kernel32</span><span class="crayon-sy">:</span><span class="crayon-sy">:</span><span class="crayon-e">ReadFile</span><span class="crayon-sy">(</span><span class="crayon-i">r5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">r1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x101000</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb35111113685-8"><span class="crayon-i">user32</span><span class="crayon-sy">:</span><span class="crayon-sy">:</span><span class="crayon-e">EnumWindows</span><span class="crayon-sy">(</span><span class="crayon-i">r1</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>To make the remaining analysis easier, we are going to generate one PE with the shellcode. To generate the executable, we can either use a tool like <a href="https://cerbero.io/" target="_blank" rel="noopener">Cerbero Profiler</a> or <a href="https://github.com/lief-project/LIEF" target="_blank" rel="noopener">LIEF</a> Python library.</p>
<p>In this case, we have used the LIEF library to build a new executable. All we have to do is to add a new section with the contents of file <span style="font-family: 'courier new', courier, monospace;">Malkekvg.Nat</span> and set the entry point to be at the correct offset. Once we get that, we should be able to open our shellcode in <a href="https://hex-rays.com/ida-pro/" target="_blank" rel="noopener">IDA Pro</a> (shown in Figure 5) and see that it contains valid x86 instructions.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6719b5362fb37655675774" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from lief import PE

with open('Malkekvg.Nat', 'rb') as f:
    buf = f.read()

pe = PE.Binary('', PE.PE_TYPE.PE32)
section = PE.Section('.text')
section.content = bytearray(buf)
section.virtual_address = 0x1000
pe.add_section(section, PE.SECTION_TYPES.TEXT)

pe.optional_header.addressof_entrypoint = section.virtual_address + 6078
pe.optional_header.subsystem = PE.SUBSYSTEM.WINDOWS_GUI

builder = PE.Builder(pe)
builder.build()
builder.write('nsis_guloader_shellcode.exe')</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6719b5362fb37655675774-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb37655675774-2">2</div><div class="crayon-num" data-line="crayon-6719b5362fb37655675774-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb37655675774-4">4</div><div class="crayon-num" data-line="crayon-6719b5362fb37655675774-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb37655675774-6">6</div><div class="crayon-num" data-line="crayon-6719b5362fb37655675774-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb37655675774-8">8</div><div class="crayon-num" data-line="crayon-6719b5362fb37655675774-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb37655675774-10">10</div><div class="crayon-num" data-line="crayon-6719b5362fb37655675774-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb37655675774-12">12</div><div class="crayon-num" data-line="crayon-6719b5362fb37655675774-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb37655675774-14">14</div><div class="crayon-num" data-line="crayon-6719b5362fb37655675774-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb37655675774-16">16</div><div class="crayon-num" data-line="crayon-6719b5362fb37655675774-17">17</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6719b5362fb37655675774-1"><span class="crayon-e">from </span><span class="crayon-e">lief </span><span class="crayon-e">import </span><span class="crayon-e">PE</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb37655675774-2">&nbsp;</div><div class="crayon-line" id="crayon-6719b5362fb37655675774-3"><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">'Malkekvg.Nat'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'rb'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">f</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb37655675774-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">buf</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">f</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6719b5362fb37655675774-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb37655675774-6"><span class="crayon-i">pe</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">PE</span><span class="crayon-sy">.</span><span class="crayon-e">Binary</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">PE</span><span class="crayon-sy">.</span><span class="crayon-i">PE_TYPE</span><span class="crayon-sy">.</span><span class="crayon-i">PE32</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6719b5362fb37655675774-7"><span class="crayon-i">section</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">PE</span><span class="crayon-sy">.</span><span class="crayon-e">Section</span><span class="crayon-sy">(</span><span class="crayon-s">'.text'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb37655675774-8"><span class="crayon-i">section</span><span class="crayon-sy">.</span><span class="crayon-i">content</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">bytearray</span><span class="crayon-sy">(</span><span class="crayon-i">buf</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6719b5362fb37655675774-9"><span class="crayon-i">section</span><span class="crayon-sy">.</span><span class="crayon-i">virtual_address</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x1000</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb37655675774-10"><span class="crayon-i">pe</span><span class="crayon-sy">.</span><span class="crayon-e">add_section</span><span class="crayon-sy">(</span><span class="crayon-i">section</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">PE</span><span class="crayon-sy">.</span><span class="crayon-i">SECTION_TYPES</span><span class="crayon-sy">.</span><span class="crayon-i">TEXT</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6719b5362fb37655675774-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb37655675774-12"><span class="crayon-i">pe</span><span class="crayon-sy">.</span><span class="crayon-i">optional_header</span><span class="crayon-sy">.</span><span class="crayon-i">addressof_entrypoint</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">section</span><span class="crayon-sy">.</span><span class="crayon-i">virtual_address</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">6078</span></div><div class="crayon-line" id="crayon-6719b5362fb37655675774-13"><span class="crayon-i">pe</span><span class="crayon-sy">.</span><span class="crayon-i">optional_header</span><span class="crayon-sy">.</span><span class="crayon-i">subsystem</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">PE</span><span class="crayon-sy">.</span><span class="crayon-i">SUBSYSTEM</span><span class="crayon-sy">.</span><span class="crayon-e">WINDOWS_GUI</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb37655675774-14">&nbsp;</div><div class="crayon-line" id="crayon-6719b5362fb37655675774-15"><span class="crayon-i">builder</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">PE</span><span class="crayon-sy">.</span><span class="crayon-e">Builder</span><span class="crayon-sy">(</span><span class="crayon-i">pe</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb37655675774-16"><span class="crayon-i">builder</span><span class="crayon-sy">.</span><span class="crayon-e">build</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6719b5362fb37655675774-17"><span class="crayon-i">builder</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-s">'nsis_guloader_shellcode.exe'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><figure id="attachment_126865" aria-describedby="caption-attachment-126865" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-126865" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/01/word-image-126856-5.png" alt="Image 5 is a screenshot of many lines of code showing the generated PE file at entry point in IDA Pro. Highlighted is “loc_4027E9.”" width="900" height="340" /><figcaption id="caption-attachment-126865" class="wp-caption-text">Figure 5. Generated PE file at entry point in IDA Pro.</figcaption></figure></p>
<h3><a id="post-126856-_hrq7463qdchi"></a>Analysis of the Shellcode</h3>
<p>Now that we have the first stage of the shellcode inside a PE file we can run it in dynamic analysis and see what happens. The first thing that we will see is that it detects virtual machines and stops its execution after showing a message box. This text is decrypted on runtime using a 4-byte XOR key.</p>
<figure id="attachment_126888" aria-describedby="caption-attachment-126888" style="width: 300px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-126888" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/01/ML-AWS-F6.png" alt="Image 6 is a screenshot of a Windows popup notification with the message “This program cannot be run under virtual environment or debugging software !” " width="300" height="118" /><figcaption id="caption-attachment-126888" class="wp-caption-text">Figure 6. The sample can’t be executed in a virtual environment.</figcaption></figure>
<p><img decoding="async" width="1" height="1" class="wp-image-126867" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/01/word-image-126856-6.png" />If we open the file in IDA Pro and follow the code a little, we should be able to see the large function for decrypting the first stage. While the function graph overview looks large, it’s still easy to identify junk code.</p>
<p>The code that is doing the decryption can be seen below in Figure 7. In Figure 8 we can see the final call that jumps to the second stage. At this point, we can dump the second stage into another executable for decryption.</p>
<p>We can dump the executable directly from memory, but we must make sure to patch the entry point to point to the correct address (which is <span style="font-family: 'courier new', courier, monospace;">0x404328</span> in this example).</p>
<figure id="attachment_126869" aria-describedby="caption-attachment-126869" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-126869" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/01/word-image-126856-7.png" alt="Image 7 is is a screenshot of many lines of code showing the first stage of shellcode. Highlighted is “decryption_start.”" width="900" height="122" /><figcaption id="caption-attachment-126869" class="wp-caption-text">Figure 7. Shellcode decryption of first stage.</figcaption></figure>
<figure id="attachment_126871" aria-describedby="caption-attachment-126871" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-126871" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/01/word-image-126856-8.png" alt="Image 8 is a screenshot of a few lines of code showing the second stage of anti-analysis techniques. " width="900" height="71" /><figcaption id="caption-attachment-126871" class="wp-caption-text">Figure 8. Call to the next stage.</figcaption></figure>
<p>The second stage uses many anti-analysis techniques, which would be too long to describe here and are described elsewhere, so we won’t go too much detail. Here are a few of the anti-analysis techniques mentioned:</p>
<ul>
<li>Memory scan for known sandbox strings</li>
<li>Hypervisor checks</li>
<li>Time measuring</li>
<li>Instruction hammering</li>
</ul>
<p>To get the final payload that is being downloaded by GuLoader, we would have to either manually bypass all these checks, run it inside a sandbox that is immune to all of these techniques, or run it on a bare-metal sandbox.</p>
<h3><a id="post-126856-_yeznnvl28v05"></a>Extracting Payload Information</h3>
<p>To get the payload information (including all the strings) without analyzing the second stage, we can use a little trick that has been <a href="https://www.spamhaus.com/resource-center/dissecting-the-new-shellcode-based-variant-of-guloader-cloudeye/" target="_blank" rel="noopener">described by Spamhaus</a>. GuLoader uses simple XOR encryption for encrypting its strings, which includes the payload URL.</p>
<p>All we need is the encryption key to decrypt everything. The good news is that the key resides somewhere inside the second stage.</p>
<p>To decrypt the strings, we can use brute-force on a pattern that we already know exists inside the second stage. The result of that XOR operation would be our key. The only limitation to this is that the pattern must be large enough so that we are able to fully decrypt the payload URL. For example, a good pattern might be the user-agent string, which is set by default to Mozilla/5.0 (<span style="font-family: 'courier new', courier, monospace;">Windows NT 10.0; WOW64; Trident/7.0; rv:11.0</span>) like Gecko.</p>
<p>To quickly find the decryption key automatically, we have to encrypt a short pattern first (e.g., first 8 bytes of the user-agent string) and search if that result is somewhere in the file. If it is somewhere in the file, then we can continue and encrypt the remaining pattern to get the full encryption key.</p>
<p>At the end of this blog, we have attached the Python script that is able to find the encryption key from the payload by the method described above. Once we run the script on any dumped second stage GuLoader payload, we should be able to see a few strings and the payload URL.</p>
<p>GuLoader sometimes includes 7 to 8 random characters in front of the payload URL, which it replaces on runtime with either <span style="font-family: 'courier new', courier, monospace;">http://</span> or <span style="font-family: 'courier new', courier, monospace;">https://</span>. The distinction of whether <span style="font-family: 'courier new', courier, monospace;">http</span> or <span style="font-family: 'courier new', courier, monospace;">https</span> is used is made by the fourth character from that random pattern.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6719b5362fb38419734517" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Using key for decryption: 38d45279998ce6f1d737dc8dcebaf88e4964ee5d2aabccc033cf4526b27ab2309bf33c429a95a7490aff0a4dceabbde720aa98e99290e97c4b5f48e1
..

0x1457b: Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko
0x147af: Msi.dll
0x14827: user32
0x14845: advapi32
0x1485e: shell32
0x14c91: windir=
0x14e91: mshtml.dll
0x14fc0: isidMedozd.com.ar/wp-includes/nHMoYlbGLWls101.qxd
0x150a3: \system32\
0x15176: \syswow64\
0x15459: Startup key
0x154e0: Software\Microsoft\Windows\CurrentVersion\RunOnce
0x15ea8: C:\Program Files\qga\qga.exe
0x15f21: C:\Program Files\Qemu-ga\qemu-ga.exe
..
Payload URL: http://ozd[.]com[.]ar/wp-includes/nHMoYlbGLWls101.qxd</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6719b5362fb38419734517-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb38419734517-2">2</div><div class="crayon-num" data-line="crayon-6719b5362fb38419734517-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb38419734517-4">4</div><div class="crayon-num" data-line="crayon-6719b5362fb38419734517-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb38419734517-6">6</div><div class="crayon-num" data-line="crayon-6719b5362fb38419734517-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb38419734517-8">8</div><div class="crayon-num" data-line="crayon-6719b5362fb38419734517-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb38419734517-10">10</div><div class="crayon-num" data-line="crayon-6719b5362fb38419734517-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb38419734517-12">12</div><div class="crayon-num" data-line="crayon-6719b5362fb38419734517-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb38419734517-14">14</div><div class="crayon-num" data-line="crayon-6719b5362fb38419734517-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb38419734517-16">16</div><div class="crayon-num" data-line="crayon-6719b5362fb38419734517-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b5362fb38419734517-18">18</div><div class="crayon-num" data-line="crayon-6719b5362fb38419734517-19">19</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6719b5362fb38419734517-1"><span class="crayon-e">Using </span><span class="crayon-e">key </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">decryption</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">38d45279998ce6f1d737dc8dcebaf88e4964ee5d2aabccc033cf4526b27ab2309bf33c429a95a7490aff0a4dceabbde720aa98e99290e97c4b5f48e1</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb38419734517-2"><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-6719b5362fb38419734517-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb38419734517-4"><span class="crayon-cn">0x1457b</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span>/<span class="crayon-cn">5.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-h"> </span><span class="crayon-cn">10.0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">WOW64</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">Trident</span>/<span class="crayon-cn">7.0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">rv</span><span class="crayon-sy">:</span><span class="crayon-cn">11.0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">like </span><span class="crayon-i">Gecko</span></div><div class="crayon-line" id="crayon-6719b5362fb38419734517-5"><span class="crayon-cn">0x147af</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Msi</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb38419734517-6"><span class="crayon-cn">0x14827</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">user32</span></div><div class="crayon-line" id="crayon-6719b5362fb38419734517-7"><span class="crayon-cn">0x14845</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">advapi32</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb38419734517-8"><span class="crayon-cn">0x1485e</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">shell32</span></div><div class="crayon-line" id="crayon-6719b5362fb38419734517-9"><span class="crayon-cn">0x14c91</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">windir</span>=</div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb38419734517-10"><span class="crayon-cn">0x14e91</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">mshtml</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span></div><div class="crayon-line" id="crayon-6719b5362fb38419734517-11"><span class="crayon-cn">0x14fc0</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">isidMedozd</span><span class="crayon-sy">.</span><span class="crayon-i">com</span><span class="crayon-sy">.</span><span class="crayon-i">ar</span>/<span class="crayon-i">wp</span>-<span class="crayon-i">includes</span>/<span class="crayon-i">nHMoYlbGLWls101</span><span class="crayon-sy">.</span><span class="crayon-i">qxd</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb38419734517-12"><span class="crayon-cn">0x150a3</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-sy">\</span><span class="crayon-i">system32</span><span class="crayon-sy">\</span></div><div class="crayon-line" id="crayon-6719b5362fb38419734517-13"><span class="crayon-cn">0x15176</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-sy">\</span><span class="crayon-i">syswow64</span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb38419734517-14"><span class="crayon-cn">0x15459</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-e">Startup </span><span class="crayon-i">key</span></div><div class="crayon-line" id="crayon-6719b5362fb38419734517-15"><span class="crayon-cn">0x154e0</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-i">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-i">Windows</span><span class="crayon-sy">\</span><span class="crayon-i">CurrentVersion</span><span class="crayon-sy">\</span><span class="crayon-i">RunOnce</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb38419734517-16"><span class="crayon-cn">0x15ea8</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">C</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-e">Program </span><span class="crayon-i">Files</span><span class="crayon-sy">\</span><span class="crayon-i">qga</span><span class="crayon-sy">\</span><span class="crayon-i">qga</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line" id="crayon-6719b5362fb38419734517-17"><span class="crayon-cn">0x15f21</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">C</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-e">Program </span><span class="crayon-i">Files</span><span class="crayon-sy">\</span><span class="crayon-i">Qemu</span>-<span class="crayon-i">ga</span><span class="crayon-sy">\</span><span class="crayon-i">qemu</span>-<span class="crayon-i">ga</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b5362fb38419734517-18"><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-6719b5362fb38419734517-19"><span class="crayon-e">Payload </span><span class="crayon-i">URL</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">http</span><span class="crayon-sy">:</span><span class="crayon-c">//ozd[.]com[.]ar/wp-includes/nHMoYlbGLWls101.qxd</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>In this sample, the payload URL was <span style="font-family: 'courier new', courier, monospace;">http://ozd[.]com[.]ar/wp-includes/nHMoYlbGLWls101.qxd</span> and the payload was still online at the time of this analysis.</p>
<p>The final downloaded payload is from the FormBook malware family, and it had the SHA256 value of <span style="font-family: 'courier new', courier, monospace;">fa0b6404535c2b3953e2b571608729d15fb78435949037f13f05d1f5c1758173</span>.</p>
<h3><a id="post-126856-_ulcas1q25phs"></a>How Can Machine Learning Detect This?</h3>
<p>In <a href="https://unit42.paloaltonetworks.com/sandbox-evasion-memory-detection/" target="_blank" rel="noopener">a previous blog post</a>, we detailed several types of observable artifacts that we can extract from memory during a live sandbox run. We’ve found that the data from memory analysis is extremely powerful when combined with machine learning for the detection of malware with multiple evasion techniques.</p>
<p>The following section describes our strategy for taking all these observations about what was modified in memory at runtime and combining them with machine learning at scale for malware detection. The algorithm can find patterns automatically, and it can identify commonalities that indicate when malware is attempting to hide its footprints in memory, dynamically allocating and executing shell code, or using unpacking.</p>
<p>In this GuLoader sample, right off the bat, a human analyst would identify that there are a few unique function pointers. We would also notice that the malware has changed the page permissions of multiple pages in its own process memory to writable and executable. Our machine learning model is able to automatically perform these activities, taking the features extracted from the various memory artifacts to detect the GuLoader sample.</p>
<p>As we <a href="https://unit42.paloaltonetworks.com/cobalt-strike-memory-analysis/" target="_blank" rel="noopener">discussed earlier in this blog series</a>, the automated analysis platform we’ve created for Advanced WildFire will automatically extract all of these memory-based artifacts in a performant way. This means that all of the information related to dynamically resolved function pointers, permissions changes and unpacked executables can be utilized either in our manually curated detection logic or additionally for our machine learning pipelines.</p>
<h3><a id="post-126856-_vxxwigp7lb4s"></a>Detection Using Machine Learning</h3>
<p>Figure 9 shows a high level view of how we created a machine learning model pipeline trained on custom features extracted from the aforementioned memory-based artifacts. The features we chose were fashioned to retain the most useful information from the verbose artifacts.</p>
<p>We also included malware execution traces as an extra source of information and built an ensemble model to detect the malicious samples. As shown in Figure 9 below, various custom features are automatically extracted from the four memory artifacts and malware execution traces, and they are passed to a classification model for detecting malicious samples. Furthermore, we have built an ensemble model that is trained on memory artifacts and execution trace based features to boost its performance.</p>
<figure id="attachment_126873" aria-describedby="caption-attachment-126873" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-126873" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/01/word-image-126856-9.png" alt="Image 9 is an image of a diagram showing machine learning model architecture. It shows the group of memory artifacts and execution traces then lead to custom feature extraction, feature vector creation, and from the ensemble of the memory model and execution trace model, predict sample maliciousness. " width="900" height="524" /><figcaption id="caption-attachment-126873" class="wp-caption-text">Figure 9. Machine learning model architecture.</figcaption></figure>
<h4><a id="post-126856-_yby6b7ryhicp"></a>Feature Engineering</h4>
<p>We’ve experimented with the efficacy of raw values from the different feature sources versus custom features for the purposes of model accuracy. Using custom features built using domain knowledge enables us to reduce noise and minimize the number of features overall, thus helping avoid the curse of dimensionality.</p>
<p>At the same time, using raw values as features allows us to quickly adapt to newer malware trends that might use changing attack tactics and techniques. We have utilized deep learning to extract features from the logs involving extracted memory-based artifacts and combine that with custom features. Our experiments show that the models work best with a combination of the two approaches.</p>
<h4><a id="post-126856-_d8x7ku9troyw"></a>Model Selection</h4>
<p>When it comes to model selection, there are a few factors that we have to consider:</p>
<ul>
<li>Small model size allows for scaling up the machine learning service to accommodate the ever growing number of samples to process.</li>
<li>Account for the absence of certain feature sources, (e.g., execution traces) in case of errors encountered.</li>
<li>Model predictions should be interpretable so we can identify the causal features in the case of disruptive false positives.</li>
<li>The model should attempt to retain as much information as possible from the samples it has trained on.</li>
</ul>
<p>A gradient-boosted trees model trained on domain-specific features and custom features extracted from raw data satisfies many of the aforementioned criteria.</p>
<h4><a id="post-126856-_mjutmq48slmp"></a>Training the Machine Learning Model</h4>
<figure id="attachment_126875" aria-describedby="caption-attachment-126875" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-126875" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/01/word-image-126856-10.png" alt="Image 10 is a diagram of the machine learning training pipeline. It starts with the file sample and ends with the machine learning service." width="900" height="320" /><figcaption id="caption-attachment-126875" class="wp-caption-text">Figure 10. Machine learning training pipeline.</figcaption></figure>
<p>The file samples are processed by a streaming pipeline to save memory artifacts and other malware attributes to a feature store. The feature extraction stage uses a combination of streaming and batch processing PySpark jobs to generate the final feature vector used for training the model.</p>
<p>The ground truth labels come from a separate pipeline that assigns labels to the samples based on malware characteristics and researcher inputs. The pipeline generates non-overlapping training and evaluation datasets by using the sample first seen time and hashes.</p>
<p>Once the machine learning model is trained and satisfies the predefined evaluation checks, including expected improvement over the currently active model, it’s pushed to the production machine learning service.</p>
<h4><a id="post-126856-_6j1s65uk43f7"></a>Interpreting Model Predictions</h4>
<p>It’s crucial to understand the machine learning model’s predictions in order to identify the limitations and the capabilities of the model. Machine learning is prone to false positives, as it’s heavily dependent on the quality and variety of the training data, as well as the ability to generalize on a changing landscape of files to predict on. Thus, having the ability to identify the causal features for a prediction can be very helpful.</p>
<p>We use two methodologies to assist with this process.</p>
<h5><a id="post-126856-_p5b4b9eor1ir"></a>Interpreting Shapley Values</h5>
<p>Shapley Additive Explanations (SHAP) is a game-theoretical approach used to explain the output of any machine learning model. The SHAP values explain the influence of each feature on the actual prediction for an input feature vector as opposed to the baseline prediction. In Figure 11, the features in <span style="color: #ff0000;">red</span>, from right to left, are the topmost features that push the model towards a malicious prediction. The features in <span style="color: #0000ff;">blue</span>, from left to right, indicate the topmost features that reduce the probability of the prediction being malware.</p>
<figure id="attachment_126877" aria-describedby="caption-attachment-126877" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-126877" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/01/word-image-126856-11.png" alt="Image 11 is a red and blue force plot displaying SHAP values for the GuLoader sample. The red features are what pushes a model towards malicious prediction. The blue features indicate what reduces the probability of the prediction being malware. " width="900" height="300" /><figcaption id="caption-attachment-126877" class="wp-caption-text">Figure 11. Force plot of SHAP values for GuLoader sample.</figcaption></figure>
<p>In the figure above, we have plotted the force plot for the top seven features with significant SHAP values and their corresponding raw feature values. Our machine learning model was able to detect GuLoader due to the presence of these top features. These features correspond to several specific dynamically resolved API pointers and their relative locations in memory, as well as the relative types of memory page permission changes that were made by the sample.</p>
<h5><a id="post-126856-_4p0dx3ou9c1k"></a>Finding Similar Samples Through Clustering</h5>
<p>Another approach to understanding the model’s predictions is to identify similar samples in the training dataset. We use density based scan (DBScan) as a clustering technique, shown in Figure 12, as it allows for outliers and different shaped clusters.</p>
<figure id="attachment_126879" aria-describedby="caption-attachment-126879" style="width: 355px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-126879" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/01/word-image-126856-12.png" alt="Image 12 is a data cluster identifying three colors: red, blue, and green. Outliers are grey and there are only a few. This figure was made with DBSCAN. " width="355" height="300" /><figcaption id="caption-attachment-126879" class="wp-caption-text">Figure 12. DBSCAN based clustering.</figcaption></figure>
<p>This approach also expands its use beyond model interpretation to find similar samples that belong to the same malware family or APT group. Using DBScan we can find out the cluster where the GuLoader sample resides and extract samples. Furthermore, we can also extract samples which are similar to it in feature space.</p>
<h2><a id="post-126856-_ajjltcy3xx9t"></a>Conclusion</h2>
<p>The GuLoader family is an excellent example of malware to detect with our machine learning model, because its use of sandbox evasions and static armoring makes it hard for traditional defenses to detect using structural cues and execution logs alone.</p>
<p>With Advanced WildFire, we introduce a hypervisor-based sandbox that can stealthily observe the memory of GuLoader during execution to parse meaningful memory resident artifacts and information useful for our machine learning detection pipeline. This allows us to accurately detect the malicious behavior using features extracted from the observed memory-based artifacts.</p>
<p>Palo Alto Networks customers receive protections from threats such as those discussed in this post with <a href="https://www.paloaltonetworks.com/network-security/advanced-wildfire">Advanced WildFire</a>.</p>
<h2><a id="post-126856-_7yvu9raj5yjj"></a>Indicators of Compromise</h2>
<p><span style="font-family: 'courier new', courier, monospace;">cc6860e4ee37795693ac0ffe0516a63b9e29afe9af0bd859796f8ebaac5b6a8c</span><br />
<span style="font-family: 'courier new', courier, monospace;">fa0b6404535c2b3953e2b571608729d15fb78435949037f13f05d1f5c1758173</span> <span style="color: #ff0000;">(Final payload)</span></p>
<h2><a id="post-126856-_ucz5a3fx1by5"></a>Additional Resources</h2>
<p><a href="https://unit42.paloaltonetworks.com/ransomware-threat-assessments/7/">Threat Assessment: GandCrab and REvil Ransomware</a><br />
<a href="https://shap.readthedocs.io/en/latest/index.html">SHAP Documentation</a><br />
<a href="https://github.com/pan-unit42/iocs/blob/master/decrypt_guloader.py" target="_blank" rel="noopener">GuLoader Strings Decryptor</a></p>
      
              </div>
              <!--<span class="post__date">Updated 7 June, 2024 at 12:23 PM PDT</span>-->
              <button class="l-btn back-to-top" id="backToTop" data-page-track="true" data-page-track-value="malware-detection-accuracy:back to top">Back to top</button>
              
			<div class="be__tags-wrapper"> 
				<h3>Tags</h3><ul role="list"><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/ai/" role="link" title="AI" data-page-track="true" data-page-track-value="malware-detection-accuracy:tags:AI">AI</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/evasive-malware/" role="link" title="Evasive Malware" data-page-track="true" data-page-track-value="malware-detection-accuracy:tags:Evasive Malware">Evasive Malware</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/guloader/" role="link" title="Guloader" data-page-track="true" data-page-track-value="malware-detection-accuracy:tags:Guloader">Guloader</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/machine-learning/" role="link" title="Machine Learning" data-page-track="true" data-page-track-value="malware-detection-accuracy:tags:Machine Learning">Machine Learning</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/memory-detection/" role="link" title="memory detection" data-page-track="true" data-page-track-value="malware-detection-accuracy:tags:memory detection">Memory detection</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/sandbox-evasion/" role="link" title="Sandbox evasion" data-page-track="true" data-page-track-value="malware-detection-accuracy:tags:Sandbox evasion">Sandbox evasion</a></li></ul>
			</div> 
              <div class="be__post-nav">
    <a class="prev" href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="malware-detection-accuracy:article-nav:Threat Research Center"> 
        <span>Threat Research Center</span>
    </a>
            <a class="next" href="https://unit42.paloaltonetworks.com/kubernetes-privilege-escalation/" role="link" title="Mitigating RBAC-Based Privilege Escalation in Popular Kubernetes Platforms" data-page-track="true" data-page-track-value="malware-detection-accuracy:article-nav:Mitigating RBAC-Based Privilege Escalation in Popular Kubernetes Platforms"> 
            <span>Next: Mitigating RBAC-Based Privilege Escalation in Popular Kubernetes Platforms</span>
        </a>
    </div>
 
            </div>
            <div class="be__nav">
            <div class="be__nav-wrapper">
      <div class="be-table-of-contents" data-toc-track="malware-detection-accuracy:sidebar:table-of-contents">
      <div class="be-title__wrapper">
        <h3>Table of Contents</h3>
      </div> 
            <ul>
        <li></li>
      </ul>
    </div>
   
        <div class="be-related-articles">
        <h3>Related Articles</h3>
        <ul> 
                        <li>
                  <a href="https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="malware-detection-accuracy:sidebar:related-articles:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning">
                      Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/profiling-detecting-malicious-dns-traffic/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="malware-detection-accuracy:sidebar:related-articles:Autoencoder Is All You Need: Profiling and Detecting Malicious DNS Traffic">
                      Autoencoder Is All You Need: Profiling and Detecting Malicious DNS Traffic                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/accelerating-malware-analysis/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="malware-detection-accuracy:sidebar:related-articles:Accelerating Analysis When It Matters">
                      Accelerating Analysis When It Matters                  </a>
              </li>
                      </ul>
      </div>
      </div> 
            </div>
          </div>
        </div>
          <div class="pa related-threat">
    <div class="l-container">
            <h2>Related Security Technology Resources</h2>
      <div class="blog-slider" id="blogSlider"> 
                    <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="303" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/AI-Threat-Report-Header-Image-Revision-786x303.jpg" class="attachment-medium size-medium" alt="A pictorial representation of AI threats. Looking over the shoulder of a man in the cockpit of a vessel in space, the window looks out on an Earth-like planet." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/AI-Threat-Report-Header-Image-Revision-786x303.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/AI-Threat-Report-Header-Image-Revision-1816x700.jpg 1816w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/AI-Threat-Report-Header-Image-Revision-768x296.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/AI-Threat-Report-Header-Image-Revision-1536x592.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/AI-Threat-Report-Header-Image-Revision.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/trend-reports/" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Unit 42 Looks Toward the Threat Frontier: Preparing for Emerging AI Risks:Trend Reports"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-report-white-1.svg" alt=" category icon">Trend Reports</span></a>                  <a href="https://unit42.paloaltonetworks.com/prepare-for-emerging-ai-risks-unit-42-threat-frontier/" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Unit 42 Looks Toward the Threat Frontier: Preparing for Emerging AI Risks">
                    <h4 class="post-title">Unit 42 Looks Toward the Threat Frontier: Preparing for Emerging AI Risks</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/genai/" title="GenAI" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Unit 42 Looks Toward the Threat Frontier: Preparing for Emerging AI Risks:GenAI">GenAI</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/prepare-for-emerging-ai-risks-unit-42-threat-frontier/" title="Unit 42 Looks Toward the Threat Frontier: Preparing for Emerging AI Risks" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Unit 42 Looks Toward the Threat Frontier: Preparing for Emerging AI Risks:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/12_Security-Technology_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of attack surface management. Close-up of a person wearing glasses with computer code reflections on the lenses." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/12_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/12_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/12_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/12_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/12_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/trend-reports/" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Unit 42 Attack Surface Threat Research: Over 23% of Internet-Connected Exposures Involve Critical IT and Security Infrastructure:Trend Reports"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-report-white-1.svg" alt=" category icon">Trend Reports</span></a>                  <a href="https://unit42.paloaltonetworks.com/2024-unit-42-attack-surface-threat-research-internet-connected-exposures/" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Unit 42 Attack Surface Threat Research: Over 23% of Internet-Connected Exposures Involve Critical IT and Security Infrastructure">
                    <h4 class="post-title">Unit 42 Attack Surface Threat Research: Over 23% of Internet-Connected Exposures Involve Critical IT and Security Infrastructure</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/attack-analysis/" title="attack analysis" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Unit 42 Attack Surface Threat Research: Over 23% of Internet-Connected Exposures Involve Critical IT and Security Infrastructure:attack analysis">Attack analysis</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/media/" title="media" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Unit 42 Attack Surface Threat Research: Over 23% of Internet-Connected Exposures Involve Critical IT and Security Infrastructure:media">Media</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/attack-surface-management/" title="attack surface management" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Unit 42 Attack Surface Threat Research: Over 23% of Internet-Connected Exposures Involve Critical IT and Security Infrastructure:attack surface management">Attack surface management</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/2024-unit-42-attack-surface-threat-research-internet-connected-exposures/" title="Unit 42 Attack Surface Threat Research: Over 23% of Internet-Connected Exposures Involve Critical IT and Security Infrastructure" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Unit 42 Attack Surface Threat Research: Over 23% of Internet-Connected Exposures Involve Critical IT and Security Infrastructure:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/09_Security-Technology_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="A close-up view of a data center with racks of servers featuring glowing blue lights. The focus is on the intricate details of the server equipment illuminated by LED lights, highlighting the advanced technology and connectivity of modern data infrastructure." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/09_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/09_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/09_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/09_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/09_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:The Contrastive Credibility Propagation Algorithm in Action: Improving ML-powered Data Loss Prevention:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/contrastive-credibility-propagation/" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:The Contrastive Credibility Propagation Algorithm in Action: Improving ML-powered Data Loss Prevention">
                    <h4 class="post-title">The Contrastive Credibility Propagation Algorithm in Action: Improving ML-powered Data Loss Prevention</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/machine-learning/" title="Machine Learning" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:The Contrastive Credibility Propagation Algorithm in Action: Improving ML-powered Data Loss Prevention:Machine Learning">Machine Learning</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/contrastive-credibility-propagation/" title="The Contrastive Credibility Propagation Algorithm in Action: Improving ML-powered Data Loss Prevention" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:The Contrastive Credibility Propagation Algorithm in Action: Improving ML-powered Data Loss Prevention:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/02_DNS_Overview_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Conceptual illustration of a digital data center with glowing blue networks and holographic clouds above server racks, representing cloud computing infrastructure and data storage." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/02_DNS_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/02_DNS_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/02_DNS_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/02_DNS_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/02_DNS_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Leveraging DNS Tunneling for Tracking and Scanning:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/three-dns-tunneling-campaigns/" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Leveraging DNS Tunneling for Tracking and Scanning">
                    <h4 class="post-title">Leveraging DNS Tunneling for Tracking and Scanning</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/dns-tunneling/" title="DNS tunneling" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Leveraging DNS Tunneling for Tracking and Scanning:DNS tunneling">DNS tunneling</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/scanning/" title="scanning" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Leveraging DNS Tunneling for Tracking and Scanning:scanning">Scanning</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/tracking/" title="tracking" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Leveraging DNS Tunneling for Tracking and Scanning:tracking">Tracking</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/three-dns-tunneling-campaigns/" title="Leveraging DNS Tunneling for Tracking and Scanning" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Leveraging DNS Tunneling for Tracking and Scanning:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Digital illustration of a cloud composed of binary code floating above a network of dynamic, glowing data streams, symbolizing cloud computing and data connectivity." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Cloud_cybersecurity_research_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Cloud_cybersecurity_research_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Cloud_cybersecurity_research_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Cloud_cybersecurity_research_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Navigating the Cloud: Exploring Lateral Movement Techniques:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Navigating the Cloud: Exploring Lateral Movement Techniques">
                    <h4 class="post-title">Navigating the Cloud: Exploring Lateral Movement Techniques</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/aws/" title="AWS" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Navigating the Cloud: Exploring Lateral Movement Techniques:AWS">AWS</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/azure/" title="Azure" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Navigating the Cloud: Exploring Lateral Movement Techniques:Azure">Azure</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/containers/" title="Containers" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Navigating the Cloud: Exploring Lateral Movement Techniques:Containers">Containers</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/" title="Navigating the Cloud: Exploring Lateral Movement Techniques" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Navigating the Cloud: Exploring Lateral Movement Techniques:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Malware_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="A laptop on a desk displaying a vibrant graphical interface with a circular red pattern, possibly representing cybersecurity or data analysis. The laptop is illuminated by the screen’s glow in a dimly lit room, which also shows a blurred background suggesting a secondary monitor and small desk objects." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Intruders in the Library: Exploring DLL Hijacking:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/dll-hijacking-techniques/" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Intruders in the Library: Exploring DLL Hijacking">
                    <h4 class="post-title">Intruders in the Library: Exploring DLL Hijacking</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/asyncrat/" title="AsyncRAT" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Intruders in the Library: Exploring DLL Hijacking:AsyncRAT">AsyncRAT</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/cloaked-ursa/" title="Cloaked Ursa" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Intruders in the Library: Exploring DLL Hijacking:Cloaked Ursa">Cloaked Ursa</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/dll/" title="DLL" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Intruders in the Library: Exploring DLL Hijacking:DLL">DLL</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/dll-hijacking-techniques/" title="Intruders in the Library: Exploring DLL Hijacking" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Intruders in the Library: Exploring DLL Hijacking:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Security-Technology_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Two people in business attire sit in an office environment, working in front of multiple monitors at each station. The screens display charts and data." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Teasing the Secrets From Threat Actors: Malware Configuration Parsing at Scale:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/teasing-secrets-malware-configuration-parsing/" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Teasing the Secrets From Threat Actors: Malware Configuration Parsing at Scale">
                    <h4 class="post-title">Teasing the Secrets From Threat Actors: Malware Configuration Parsing at Scale</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/icedid/" title="IcedID" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Teasing the Secrets From Threat Actors: Malware Configuration Parsing at Scale:IcedID">IcedID</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/memory-detection/" title="memory detection" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Teasing the Secrets From Threat Actors: Malware Configuration Parsing at Scale:memory detection">Memory detection</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/teasing-secrets-malware-configuration-parsing/" title="Teasing the Secrets From Threat Actors: Malware Configuration Parsing at Scale" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Teasing the Secrets From Threat Actors: Malware Configuration Parsing at Scale:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Security-Technology_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Two people in business attire sit in an office environment, working in front of multiple monitors at each station. The screens display charts and data." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Tailoring Sandbox Techniques to Hidden Threats:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/tailoring-sandbox-techniques/" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Tailoring Sandbox Techniques to Hidden Threats">
                    <h4 class="post-title">Tailoring Sandbox Techniques to Hidden Threats</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/memory-detection/" title="memory detection" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Tailoring Sandbox Techniques to Hidden Threats:memory detection">Memory detection</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/sandbox-evasion/" title="Sandbox evasion" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Tailoring Sandbox Techniques to Hidden Threats:Sandbox evasion">Sandbox evasion</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/wireshark/" title="Wireshark" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Tailoring Sandbox Techniques to Hidden Threats:Wireshark">Wireshark</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/tailoring-sandbox-techniques/" title="Tailoring Sandbox Techniques to Hidden Threats" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Tailoring Sandbox Techniques to Hidden Threats:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                          <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Illustration of a futuristic city with glowing orange and blue lights, surrounded by clouds and digital elements, conveying a high-tech, cybernetic theme." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Mitigating RBAC-Based Privilege Escalation in Popular Kubernetes Platforms:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/kubernetes-privilege-escalation/" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Mitigating RBAC-Based Privilege Escalation in Popular Kubernetes Platforms">
                    <h4 class="post-title">Mitigating RBAC-Based Privilege Escalation in Popular Kubernetes Platforms</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/container-escape/" title="container escape" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Mitigating RBAC-Based Privilege Escalation in Popular Kubernetes Platforms:container escape">Container escape</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/containers/" title="Containers" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Mitigating RBAC-Based Privilege Escalation in Popular Kubernetes Platforms:Containers">Containers</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/kubernetes/" title="Kubernetes" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Mitigating RBAC-Based Privilege Escalation in Popular Kubernetes Platforms:Kubernetes">Kubernetes</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/kubernetes-privilege-escalation/" title="Mitigating RBAC-Based Privilege Escalation in Popular Kubernetes Platforms" role="link" data-page-track="true" data-page-track-value="malware-detection-accuracy:related-resources:Mitigating RBAC-Based Privilege Escalation in Popular Kubernetes Platforms:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                    </div>
    </div>
    <div class="l-container bs__controls">
      <div class="bs__progress"><span></span></div>
      <div class="bs__navigation"> 
        <ul>
          <li> 
            <button id="prevButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
          <li> 
            <button id="nextButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
        </ul>
      </div>
    </div>
  </div>
 
        <div class="be-enlarge-modal" id="enlargedModal">
          <div class="be-enlarge-modal__wrapper"> 
            <figure> 
              <button class="close__modal" id="closeModal"> 
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button"></button>
              <img class="be__enlarged-image" id="enlargedImage" src="" alt="Enlarged Image">
              <figcaption> </figcaption>
            </figure>
          </div>
        </div>

      </div>
    </section>
  </main>
<!--  Start: Footer subscription form -->
<div class="newsletter">
      <div class="l-container">
        <div class="newsletter__wrapper">
          <div class="image__wrapper"> 
            <picture>
			              	 <source media="(max-width:400px)" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-mobile.webp">
			  			               	 <source media="(max-width:949px)" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-tab.webp">
			  			  			  	<img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/Revitalized_newsletter-Image-desktop-copy-1.webp" alt="Newsletter">
			              </picture>
          </div>
          <div class="content__wrapper"> 
		    							<span class="pre-title"> 
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/palo-alto-logo-small.svg" alt="UNIT 42 Small Logo">
				Get updates from Unit 42			</span>
						           	 <h2>Peace of mind comes from staying ahead of threats. Contact us today.</h2>
			            <form action="https://www.paloaltonetworks.com/apps/pan/public/formsubmithandler.submitform.json" method="post" novalidate class="subscribe-form" name="Unit42_Subscribe" id="unit42footerSubscription_form">
              <input type="hidden" name="emailFormMask" value="">
              <input type="hidden" value="1086" name="formid">
              <input type="hidden" value="531-OCS-018" name="munchkinId">
              <input type="hidden" value="2141" name="lpId">
              <input type="hidden" value="1203" name="programId">
              <input type="hidden" value="1086" name="formVid">
              <input type="hidden" name="mkto_optinunit42" value="true">
              <input type="hidden" name="mkto_opt-in" value="true">
              <div class="form-group"> 
                <label for="newsletter-email"  id="newsletter-email-label">Your Email</label>
                <input type="emal" placeholder="Your Email" name="Email"  class="subscribe-field" id="newsletter-email" aria-labelledby="newsletter-email-label">
                <p class="error-mail mb-15 text-danger" style="color: #dc3545"></p>
				<p>Subscribe for email updates to all Unit 42 threat research.<br />By submitting this form, you agree to our <a title="Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use" data-page-track="true" data-page-track-value="Get updates from Unit 42:Terms of Use">Terms of Use</a> and acknowledge our <a title="Privacy Statement" href="https://www.paloaltonetworks.com/legal-notices/privacy" data-page-track="true" data-page-track-value="Get updates from Unit 42:Privacy Statement">Privacy Statement.</a></p>
                <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6Lc5EhgTAAAAAJa-DzE7EeWABasWg4LKv-R3ao6o"></div>
                <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Invalid captcha!</p>
                <button class="l-btn is-disabled" data-page-track="true" data-page-track-value="footer:Get updates from Unit 42:Subscribe" id="unit42footerSubscription_form_button"> 
					Subscribe					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow"  class="arrow">
					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-loader.svg" alt="loader" class="loader">
			   </button>
				<div class="form-success-message"></div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

<script>

(function($) {
	// Migrated from the unit42-v5 + Modifications
	var subscribeSuccess = false;
	var email = document.getElementById('newsletter-email');
	var subscription_form = document.getElementById('unit42footerSubscription_form');
	var subscription_form_button = document.getElementById('unit42footerSubscription_form_button');
	window.captchaComplete = function() {
		subscribeSuccess = true;
		if ($(mail).val() != '' && isEmail($(mail).val())) {
			$(subscription_form_button).removeClass('is-disabled');
		}
		setTimeout(function() {
			$(email).focus();
			$('.g-recaptcha iframe').attr('tabindex', '-1');
		}, 100)
	}
	window.captchaExpires = function() {
		subscribeSuccess = false;
		$(subscription_form_button).addClass('is-disabled', true);
	} 
	$(subscription_form).submit(function(e) {
		e.preventDefault();
		e.stopImmediatePropagation();
		updateEmailMask();
		var success = true;
		var form = $(this);
		var mail = form.find('input[name="Email"]');
		
		if (mail.val() === '') {
			mail.addClass('has-error');
			showError(1);
			success = false;	
		}  else if (!isEmail(mail.val())){
			showError(2);
			success = false;
		}
		else {
			mail.removeClass('has-error');
			$('.error-mail').addClass('d-none');
		}

		if (!subscribeSuccess) {
			$('.error-recaptcha').removeClass('d-none');
		} else {
			$('.error-recaptcha').addClass('d-none');
		}

		if (success && subscribeSuccess) {
			$.ajax({
				type: 'POST',
				url: form.attr('action'),
				data: form.serialize(),
				beforeSend: function() {
                 form.find('button').addClass('is-loading');
    			},
				success: function(msg) {
					form.find('.form-success-message').html('<p class="success-message">You have been successfully subscribed</p>');
					form.find('button').removeClass('is-loading');
					$(email).val('');
					clearError();
				},
				error: function(jqXHR, textStatus, errorThrown) {
					$(subscription_form_button).addClass('is-disabled', true);
					form.find('button').removeClass('is-loading');
					
				}
			});
		}
		return false;
	});
	function showError(error_type){
		if(error_type == 1) {
			$('.error-mail').text("Please enter the email address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		} else if(error_type == 2){
			$('.error-mail').text("Please provide a valid e-mail address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		}	
		$(subscription_form_button).removeClass('is-loading');
	}
	function clearError(){
		$('.error-mail').text("").removeClass('error-show');;
		$(subscription_form_button).removeClass('is-loading');
		$(subscription_form_button).removeClass('is-disabled');
	}
	
	$(email).on('input', function (event) { 
		var email = $(this).val();
		if (isEmail(email) ) {			
			clearError();
		} else if(email == ""){
			clearError();
		} else{
			showError(2);			  
		}
    });

	function isEmail(email) {
		var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
		return re.test(String(email).toLowerCase());
	}
	
	var captcha_loaded = false;
         if(!captcha_loaded){
            // recaptcha on foucs call
            $(document).on('change paste keyup', '#newsletter-email', function () {
               if($('.g-recaptcha').hasClass('d-none')){
                $('.g-recaptcha').removeClass('d-none');
               }
               if(!captcha_loaded ){
                  captcha_loaded  = true;
                  // trigger loading api.js (recaptcha.js) script
                  var head = document.getElementsByTagName('head')[0];
                  var script = document.createElement('script');
                  script.type = 'text/javascript';
                  script.src = 'https://www.google.com/recaptcha/api.js?hl=en_US';
                  head.appendChild(script);
               }
            });
        }
	
	function updateEmailMask() {
		var email = $("#unit42footerSubscription_form input[name='Email']").val();
		if (email && email.trim() != '') {
			var maskedEmail = maskEmailAddress(email);
			$("#unit42footerSubscription_form input[name='emailFormMask']").val(maskedEmail);
		}
	}

	function maskEmailAddress (emailAddress) {
		function mask(str) {
			var strLen = str.length;
			if (strLen > 4) {
				return str.substr(0, 1) + str.substr(1, strLen - 1).replace(/\w/g, '*') + str.substr(-1,1);
			}
			return str.replace(/\w/g, '*');
		}
		return emailAddress.replace(/([\w.]+)@([\w.]+)(\.[\w.]+)/g, function (m, p1, p2, p3) {
			return mask(p1) + '@' + mask(p2) + p3;
		});

		return emailAddress;
	}

}(jQuery));
//# sourceMappingURL=main.js.map
	
</script>
<!--  End: Footer subscription form -->

<footer class="footer"> 
  <div class="footer-menu">
    <div class="l-container">
      <div class="footer-menu__wrapper">
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Products and services</h3>
                                <div class="nav-column__wrapper"> 
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security"   role="link" title="Network Security Platform" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform">Network Security Platform</a>
						</li>    
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/security-subscriptions"   role="link" title="CLOUD DELIVERED SECURITY SERVICES" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES">CLOUD DELIVERED SECURITY SERVICES</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-threat-prevention" target=_blank  role="link" title="Advanced Threat Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention">Advanced Threat Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-dns-security"   role="link" title="DNS Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security">DNS Security</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-data-loss-prevention"   role="link" title="Data Loss Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention">Data Loss Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-iot-security"   role="link" title="IoT Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security">IoT Security</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall"   role="link" title="Next-Generation Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls">Next-Generation Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall-hardware"   role="link" title="Hardware Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls">Hardware Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/strata-cloud-manager"   role="link" title="Strata Cloud Manager" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager">Strata Cloud Manager</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/sase"   role="link" title="SECURE ACCESS SERVICE EDGE" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE">SECURE ACCESS SERVICE EDGE</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/access"   role="link" title="Prisma Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access">Prisma Access</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/sd-wan"   role="link" title="Prisma SD-WAN" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN">Prisma SD-WAN</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/adem"   role="link" title="Autonomous Digital Experience Management" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management">Autonomous Digital Experience Management</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/next-gen-casb"   role="link" title="Cloud Access Security Broker" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker">Cloud Access Security Broker</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/ztna"   role="link" title="Zero Trust Network Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker:Zero Trust Network Access">Zero Trust Network Access</a>
						</li>    
					        
					</ul>
				</nav>
						         
            </div>
            <div class="nav-column">
                          													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/prisma/whyprisma"   role="link" title="Code to Cloud Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform">Code to Cloud Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/prisma/cloud"   role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud">Prisma Cloud</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/content/pan/en_US/prisma/cloud/cloud-native-application-protection-platform"   role="link" title="Cloud-Native Application Protection Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud:Cloud-Native Application Protection Platform">Cloud-Native Application Protection Platform</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/cortex" target=_blank  role="link" title="AI-Driven Security Operations Platform" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform">AI-Driven Security Operations Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xdr"   role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR">Cortex XDR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsoar"   role="link" title="Cortex XSOAR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR">Cortex XSOAR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse"   role="link" title="Cortex Xpanse" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse">Cortex Xpanse</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam"   role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM">Cortex XSIAM</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse/attack-surface-management"   role="link" title="External Attack Surface Protection" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection">External Attack Surface Protection</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/security-operations-automation"   role="link" title="Security Automation" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation">Security Automation</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/detection-and-response"   role="link" title="Threat Prevention, Detection &amp; Response" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation:Threat Prevention, Detection &amp; Response">Threat Prevention, Detection &amp; Response</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/unit42"   role="link" title="Threat Intel and Incident Response Services" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services">Threat Intel and Incident Response Services</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/assess"   role="link" title="Proactive Assessments" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments">Proactive Assessments</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/respond"   role="link" title="Incident Response" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response">Incident Response</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/transform"   role="link" title="Transform Your Security Strategy" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy">Transform Your Security Strategy</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/threat-intelligence-partners"   role="link" title="Discover Threat Intelligence" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy:Discover Threat Intelligence">Discover Threat Intelligence</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Company</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us"   role="link" title="About Us" data-page-track="true" data-page-track-value="footer:Company:About Us">About Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://jobs.paloaltonetworks.com/en/"   role="link" title="Careers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers">Careers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/contact-sales"   role="link" title="Contact Us" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us">Contact Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/corporate-responsibility"   role="link" title="Corporate Responsibility" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility">Corporate Responsibility</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/customers"   role="link" title="Customers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers">Customers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://investors.paloaltonetworks.com/" target=_blank  role="link" title="Investor Relations" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations">Investor Relations</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/locations"   role="link" title="Location" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location">Location</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/newsroom"   role="link" title="Newsroom" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location:Newsroom">Newsroom</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Popular links</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/blog/"   role="link" title="Blog" data-page-track="true" data-page-track-value="footer:Popular links:Blog">Blog</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/communities"   role="link" title="Communities" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities">Communities</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/resources"   role="link" title="Content Library" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library">Content Library</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cyberpedia"   role="link" title="Cyberpedia" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia">Cyberpedia</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://events.paloaltonetworks.com/"   role="link" title="Event Center" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center">Event Center</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://start.paloaltonetworks.com/preference-center"   role="link" title="Manage Email Preferences" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences">Manage Email Preferences</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/products/products-a-z"   role="link" title="Products A-Z" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z">Products A-Z</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/legal-notices/trust-center/tech-certs"   role="link" title="Product Certifications" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications">Product Certifications</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/security-disclosure"   role="link" title="Report a Vulnerability" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability">Report a Vulnerability</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sitemap"   role="link" title="Sitemap" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap">Sitemap</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://docs.paloaltonetworks.com/"   role="link" title="Tech Docs" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs">Tech Docs</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://unit42.paloaltonetworks.com/"   role="link" title="Unit 42" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42">Unit 42</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://panwedd.exterro.net/portal/dsar.htm?target=panwedd" target=_blank  role="link" title="Do Not Sell or Share My Personal Information" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42:Do Not Sell or Share My Personal Information">Do Not Sell or Share My Personal Information</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer-bottom"> 
    <div class="l-container"> 
              <div class="footer-logo">
          <a href="https://www.paloaltonetworks.com/" role="link" title="Footer Nav" data-page-track="true" data-page-track-value="footer:logo:Palo Alto Networks">
            <img width="245" height="46" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/palo-alto-footer-logo.svg" class="attachment-medium size-medium" alt="" decoding="async" loading="lazy" />          </a>
        </div>
            <div class="footer-bottom__wrapper"> 
        <div class="footer-bottom-nav">
                                              <nav>
                <ul class="footer-menu-nav__list"> 
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/privacy"   role="link" title="Privacy" data-page-track="true" data-page-track-value="footer:bottom-menu:Privacy">Privacy</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/trust-center"   role="link" title="Trust Center" data-page-track="true" data-page-track-value="footer:bottom-menu:Trust Center">Trust Center</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use"   role="link" title="Terms of Use" data-page-track="true" data-page-track-value="footer:bottom-menu:Terms of Use">Terms of Use</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal"   role="link" title="Documents" data-page-track="true" data-page-track-value="footer:bottom-menu:Documents">Documents</a>
                  </li>    
                        
                </ul>
              </nav>
                                            <br/><span class="copyright">Copyright © 2024 Palo Alto Networks. All Rights Reserved</span>
                  </div>
        <div class="footer-bottom-social"> 
          <ul> 
			<li>
			<a href="https://www.youtube.com/user/paloaltonetworks" target="_blank" role="link" title="YouTube" data-page-track="true" data-page-track-value="footer:social:Youtube">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/youtube-black.svg" alt="YouTube">
			</a>
		</li>
				<li> 
			<a href="https://twitter.com/Unit42_Intel" target="_blank" role="link" title="X" data-page-track="true" data-page-track-value="footer:social::Twitter">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/x-icon-black.svg" alt="Twitter">
			</a>
		</li>
				<li> 
			<a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank" role="link" title="Facebook" data-page-track="true" data-page-track-value="footer:social:Facebook">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/Facebook_Icon.svg" alt="Facebook">
			</a>
		</li>
				<li> 
			<a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank" role="link" title="LinkedIn" data-page-track="true" data-page-track-value="footer:social:LinkedIn">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/LinkedIn_Icon.svg" alt="LinkedIn">
			</a>
		</li>
	                <li> 
			<a href="https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/" role="link" title="Podcast" data-page-track="true" data-page-track-value="footer:social:Podcast">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/Podcast.svg" alt="Podcast">
			</a>
		</li>
</ul>          
	<div class="pa language-dropdown">
			<div class="language-dropdown__wrapper"> 
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/globe-icon.svg" alt="Globe icon">
			<span id="selectedLanguage">EN</span>
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"><ul><li class="title">Select your language</li>
					<li class="selected" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:en" href="https://unit42.paloaltonetworks.com/malware-detection-accuracy/">USA (ENGLISH)</a>
					</li>
					<li class="non-active" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:ja" href="https://unit42.paloaltonetworks.jp/malware-detection-accuracy/">JAPAN (日本語)</a>
					</li></ul>        </div>
      </div>
    </div>
  </div>
</footer>
<div class="dd-overlay">
</div>
<!--  Start: video modal -->
<div class="modal video__modal" id="videoModal" tabindex="-1">
        <div class="modal__video-wrapper">
          <button class="modal__play-btn is-minimized is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
          <button class="modal__minimize-btn is-minimized">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
          </button>
          <button class="modal__close"> 
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button">
          </button>
          <video class="modal__video" id="customVideo">
            <source src="" type="video/mp4">Your browser does not support the video tag.
          </video>
          <div class="modal__post-details" tabindex="-1">       
              <h3>Default Heading</h3>
              <a class="l-btn" href="#" title="Right Arrow Icon" role="link" data-page-track="true" data-page-track-value="overview:explore reports:View all reports">Read the article
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow">
              </a>
          </div>
          <div class="modal__video-controls">
            <div class="modal__video-seekbar input__wrapper"><span></span>
              <label class="is-hidden" for="modalSeekBar">Seekbar</label>
              <input class="custom-range" id="modalSeekBar" type="range" min="0" max="100" value="1">
              <p class="modal__remaining-time"></p>
            </div>
            <button class="modal__play-btn is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
            <div class="modal__volume-controls">
              <div class="modal__volume__wrapper">
                <button tabindex="0">
                  <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-volume.svg" alt="Volume">
                </button>
                <div class="modal__volume-seekbar"><span></span>
                  <label class="is-hidden" for="volumeBar">Volume</label>
                  <input class="volume__bar" id="volumeBar" type="range" min="0" max="1" step="0.1" value="0.7">
                </div>
              </div>
              <button class="modal__minimize-btn" id="minimizeBtn">
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
              </button>
            </div>
          </div>
        </div>
      </div><!--  End: video modal -->

    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		var like_nonce = jQuery('#_wpnonce').val();
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type+"&ul_nonce="+like_nonce,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=6.6.1' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/js/script.js?ver=1.0.0" id="unit42-v6-navigation-js"></script>

<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
observer_lozad.observe();

window.PAN_Clean_Util = {
        isIE: false
};

(function () {
   // INP Util Fix
    function yieldToMain(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
   window.PAN_Clean_Util.yieldToMain = yieldToMain
})();

if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
  var Coveo_organizationId = "paloaltonetworksintranet";        
  var techDocsPagePath = "https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25";
  var languageFromPath="en_US";
  window.Granite = window.Granite || {};
  Granite.I18n = (function() {
  var self = {};
  self.setLocale = function(locale) { };
  self.get = function(text, snippets, note) {
    var out = "";
    if(text){
      if(text ==="coveo.clear"){
        out = "Clear";
      }else if(text ==="coveo.noresultsfound"){
        out = "No results found for this search term.";
      }
    }
    return out;
  };
  return self
  }());
}

  var main_site_critical_top = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.js';
  var main_site_defered = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/defered.min.js';
  var main_site_criticalTopBase = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopBase.min.js';
  var main_site_criticalTopProductNav = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.js';
window.PAN_MainNavAsyncUrl = maindomain_lang+"/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html";

function loadScript(url, defer){
    var script1 = document.createElement('script');
    script1.setAttribute('type', 'text/javascript');
    script1.setAttribute('src',url);
    if(defer == true){
        script1.setAttribute('defer','defer');
    }
    document.head.appendChild(script1);
}
function loadScript1(url, callback){

    var script = document.createElement("script")
    script.type = "text/javascript";
    if (script.readyState){  //IE
        script.onreadystatechange = function(){
            if (script.readyState == "loaded" || script.readyState == "complete"){
                script.onreadystatechange = null;
                callback();
            }
        };
    } else {  //Others
        script.onload = function(){
            callback();
        };
    }
    script.src = url;
    document.getElementsByTagName("head")[0].appendChild(script);
}
if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
	if(referer == "Unit"){
    setTimeout(function(){
      loadScript(main_site_criticalTopBase, false);
      loadScript1(main_site_criticalTopProductNav, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
	else{
    setTimeout(function(){
      loadScript1(main_site_critical_top, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
}

$(document).ready(function () {
    setTimeout(function(){
      $('.article-banner .ab__options ul li a').each(function(){
          	$(this).attr('target', "_blank");
      });
    }, 4000);
});
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->

</body>
</html>
