<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">
    <link rel="preconnect" href="https://www.paloaltonetworks.com">
    <link rel="preconnect" href="https://cdn.cookielaw.org">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	    <!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
var main_site_url = 'https://www.paloaltonetworks.com';
var maindomain_lang = 'https://www.paloaltonetworks.com';
function getParameterByName(name, url) {
		if(url == null){
		  url = window.location.href;
		}
	    name = name.replace(/[\[\]]/g, '\\$&');
	    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
		results = regex.exec(url);
	    if (!results) return null;
	    if (!results[2]) return '';
	    return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	var container_q = getParameterByName('container');
	var d_lang = 'en';	
	if(container_q != '' && container_q != null){	    
	    sessionStorage.setItem('container',container_q);
	    	    location.href = 'https://unit42.paloaltonetworks.com/privilege-escalation-llm-model-exfil-vertex-ai';
	}
</script>

<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css"></noscript>
  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/privilege-escalation-llm-model-exfil-vertex-ai/" />
<link rel="alternate" hreflang="x-default" href="https://unit42.paloaltonetworks.com/privilege-escalation-llm-model-exfil-vertex-ai/" />

	<!-- This site is optimized with the Yoast SEO Premium plugin v23.7 (Yoast SEO v23.7) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>ModeLeak: Privilege Escalation to LLM Model Exfiltration in Vertex AI</title>
	<meta name="description" content="New research reveals two vulnerabilities in Google&#039;s Vertex AI that may lead to privilege escalation or data theft through custom jobs or malicious models. New research reveals two vulnerabilities in Google&#039;s Vertex AI that may lead to privilege escalation or data theft through custom jobs or malicious models." />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/privilege-escalation-llm-model-exfil-vertex-ai/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="ModeLeak: Privilege Escalation to LLM Model Exfiltration in Vertex AI" />
	<meta property="og:description" content="New research reveals two vulnerabilities in Google&#039;s Vertex AI that may lead to privilege escalation or data theft through custom jobs or malicious models. New research reveals two vulnerabilities in Google&#039;s Vertex AI that may lead to privilege escalation or data theft through custom jobs or malicious models." />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/privilege-escalation-llm-model-exfil-vertex-ai/" />
	<meta property="og:site_name" content="Unit 42" />
	<meta property="article:published_time" content="2024-11-12T11:00:11+00:00" />
	<meta property="article:modified_time" content="2024-11-13T14:29:46+00:00" />
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/13_Cloud_cybersecurity_research_Overview_1920x900.jpg" />
	<meta property="og:image:width" content="1920" />
	<meta property="og:image:height" content="900" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="Ofir Balassiano, Ofir Shaty" />
	<meta name="twitter:card" content="summary_large_image" />
	<!-- / Yoast SEO Premium plugin. -->


<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Feed" href="https://unit42.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Comments Feed" href="https://unit42.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; ModeLeak: Privilege Escalation to LLM Model Exfiltration in Vertex AI Comments Feed" href="https://unit42.paloaltonetworks.com/privilege-escalation-llm-model-exfil-vertex-ai/feed/" />
<script type="text/javascript">
var globalConfig = {};
var webData = {};
webData.channel = "unit42";
webData.property = "unit42.paloaltonetworks.com";
webData.language = "en_us";
webData.pageType = "blogs";
webData.pageName = "unit42:privilege-escalation-llm-model-exfil-vertex-ai";
webData.pageURL = "https://unit42.paloaltonetworks.com/privilege-escalation-llm-model-exfil-vertex-ai";
webData.article_title = "ModeLeak: Privilege Escalation to LLM Model Exfiltration in Vertex AI";
webData.author = "Ofir Balassiano,Ofir Shaty";
webData.published_time = "2024-11-12T03:00:11-08:00";
webData.description = "%%excerpt%% New research reveals two vulnerabilities in Google&#039;s Vertex AI that may lead to privilege escalation or data theft through custom jobs or malicious models.";
webData.keywords = "Cloud Cybersecurity Research,Threat Research,data exfiltration,Google Cloud,Kubernetes,LLM,poisoned model,privilege escalation,Vertex AI";
webData.resourceAssetID = "a8728a800599da469166f197df6989bc";
</script>
<script type="text/javascript">
var globalConfig = {};
globalConfig.buildName = "UniqueResourceAssetsID_DEC022022";
</script>
<meta property="og:likes" content="0"/>
<meta property="og:readtime" content="15"/>
<meta property="og:views" content="2,163"/>
<meta property="og:date_created" content="November 12, 2024 at 3:00 AM"/>
<meta property="og:post_length" content="3687"/>
<meta property="og:category" content="Cloud Cybersecurity Research"/>
<meta property="og:category" content="Threat Research"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/cloud-cybersecurity-research/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-research/"/>
<meta property="og:author" content="Ofir Balassiano"/>
<meta property="og:author" content="Ofir Shaty"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta name="post_tags" content="data exfiltration,Google Cloud,Kubernetes,LLM,poisoned model,privilege escalation,Vertex AI"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"ModeLeak: Privilege Escalation to LLM Model Exfiltration in Vertex AI","name":"ModeLeak: Privilege Escalation to LLM Model Exfiltration in Vertex AI","description":"New research reveals two vulnerabilities in Google's Vertex AI that may lead to privilege escalation or data theft  through custom jobs or malicious models.","url":"https:\/\/unit42.paloaltonetworks.com\/privilege-escalation-llm-model-exfil-vertex-ai\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/privilege-escalation-llm-model-exfil-vertex-ai\/","datePublished":"November 12, 2024","articleBody":"Executive Summary\r\nIn the race to gain a competitive edge, organizations are increasingly training artificial intelligence (AI) models on sensitive data. But what if a seemingly harmless AI model became a gateway for attackers?\r\n\r\nA malicious actor could upload a poisoned model to a public repository, and without realizing it, your team could deploy it in your environment. Once active, that model could exfiltrate your sensitive machine learning (ML) models and fine-tuned large language model (LLM) adapters. With access to these adapters, attackers could replicate your custom tuning and optimizations, exposing sensitive information embedded in fine-tuning patterns.\r\n\r\nPalo Alto Networks researchers recently uncovered two vulnerabilities in Google's Vertex AI platform. These vulnerabilities could have allowed attackers to escalate privileges and exfiltrate models.\r\n\r\nWe have shared these findings with our partners at Google, and they have since implemented fixes to eliminate these specific issues for Vertex AI on the Google Cloud Platform (GCP). Read on to understand how these vulnerabilities worked and how you can protect your environment from similar threats.\r\n\r\nIn this article, we outline our steps to discover two vulnerabilities in the Vertex AI platform:\r\n\r\n \tPrivilege escalation via custom jobs\r\nBy exploiting custom job permissions, we were able to escalate our privileges and gain unauthorized access to all data services in the project.\r\n \tModel exfiltration via malicious model\r\nDeploying a poisoned model in Vertex AI led to the exfiltration of all other fine-tuned models, posing a serious proprietary and sensitive data exfiltration attack risk.\r\n\r\nOur examination of the first vulnerability ended with a classic privilege escalation, but the second vulnerability represents a much more interesting \u201cmodel-to-model\u201d infection scenario that required an in-depth exploration.\r\n\r\nFigure 1 shows a diagram demonstrating the two vulnerabilities.\r\n\r\n[caption id=\"attachment_137469\" align=\"alignnone\" width=\"1400\"] Figure 1. A diagram demonstrating the two vulnerabilities.[\/caption]\r\n\r\nPalo Alto Networks customers are better protected from the threats discussed in this article through our Prisma Cloud offerings.\r\n\r\nIf you think you might have been compromised or have an urgent matter, contact the Unit 42 Incident Response team.\r\n\r\n\r\n\r\nRelated Unit 42 Topics\r\nCloud Cybersecurity Research, Privilege Escalation\r\n\r\n\r\n\r\nPrivilege Escalation Through Custom Code Injection\r\nThe first vulnerability we found is a privilege escalation through custom code injection. To properly explain this method, we must first understand model tuning in Vertex AI Pipelines.\r\nBackground: Understanding Model Tuning with Vertex AI Pipelines\r\nVertex AI is a comprehensive platform for developing, training and deploying ML and AI models. A key feature of this platform is Vertex AI Pipelines, which allow users to tune their models using custom jobs, also referred to as custom training jobs.\r\n\r\nThese custom jobs are essentially code that runs within the pipeline and can modify models in various ways. While this flexibility is valuable, it also opens the door to potential exploitation.\r\n\r\nOur research focused on how attackers could abuse custom jobs. By manipulating the custom job pipeline, we discovered a privilege escalation path that allowed us to access resources far beyond the intended scope.\r\n\r\n[caption id=\"attachment_137471\" align=\"alignnone\" width=\"1400\"] Figure 2. Tuning of Vertex AI model flow diagram.[\/caption]\r\n\r\nIn Figure 2, tuning a Vertex AI model (ML or LLM) happens in a remote tenant project that is dedicated to the source project (step 1). The tuning process uses custom jobs defined in Vertex AI Pipelines, which are run on a different tenant project (step 2).\r\n\r\nWhen the tuning process is complete, a new tuned model is created in the model registry in the origin project (step 3). At this point, we deploy our model in a third different tenant project (step 4).\r\nAttack Flow of the Privilege Escalation Vulnerability\r\nWhen running, a custom job executes within a tenant project under a service agent identity. By default, service agents have excessive permissions to many services in the source project, such as all the source project's Cloud Storage and BigQuery datasets. With the service agent\u2019s identity, we could list, read and even export data from buckets and datasets we should never have been able to access.\r\nDelving Deeper: Injecting Custom Code\r\nFor a custom job to run specific code, we could either inject commands into the container spec JSON configuration or create an image that opens a reverse shell. In our case, we created a custom image as a backdoor, allowing us to gain access to the environment. Figure 3 below shows the commands we used to create this custom image.\r\n\r\n[caption id=\"attachment_137372\" align=\"alignnone\" width=\"800\"] Figure 3. Creating an image to run custom code.[\/caption]\r\n\r\nWith this custom job running in a tenant-project, we discovered that our identity was the following:\r\nservice-&lt;PROJECT_NUMBER&gt;@gcp-sa-aiplatform-cc.iam.gserviceaccount[.]com\r\nThis service agent is the AI Platform Custom Code Service Agent. With the service agent acting in this role, we could perform the following activities:\r\n\r\n \tAccessing the metadata service\r\n \tAcquiring the service credentials\r\n \tExtracting the user-data script\r\n\r\nThis account had extensive permissions, including the following:\r\n\r\n \tThe ability to list all service accounts\r\n \tCreating, deleting, reading and writing all storage buckets\r\n \tAccessing all BigQuery tables\r\n\r\nFigure 4 lists the specific permissions that our service agent had in the source project during our testing.\r\n\r\n[caption id=\"attachment_137374\" align=\"alignnone\" width=\"900\"] Figure 4. Service agent permissions granted in the source project.[\/caption]\r\n\r\nThe user-data script gave us visibility into the virtual machine (VM) creation and provided us with metadata on GCP internal Artifactory repositories.\r\n\r\nWe used the metadata to access the internal GCP repositories and downloaded images that we didn\u2019t have permissions for with our original service account. Although we gained access to restricted internal GCP repositories, we could not understand the extent of the vulnerability that we discovered, since permissions on the repository are granted at the repository level.\r\n\r\nThis is a classic privilege escalation that with the single permission of aiplatform.customJobs.create gives us the ability to access additional resources in the origin project. This is the first vulnerability we found in the Vertex AI platform. Figure 5 presents a flow diagram on privilege escalation through exploiting this vulnerability with custom jobs.\r\n\r\n[caption id=\"attachment_137376\" align=\"alignnone\" width=\"900\"] Figure 5. Flow diagram for privilege escalation through custom jobs.[\/caption]\r\nModel Exfiltration Attack via Malicious Model Deployment\r\nThis section explores the second vulnerability we discovered in Vertex AI. We demonstrate how deploying a malicious model could lead to severe consequences, including the exfiltration of other models within the environment.\r\n\r\nImagine a malicious actor uploading a poisoned model to a public model repository. Unaware of the threat, a data scientist within your organization imports and deploys this model in Vertex AI. Once deployed, the malicious model can exfiltrate every other ML and LLM model in the project, including sensitive fine-tuned models, putting your organization\u2019s most critical assets at risk.\r\n\r\nWe enacted this scenario by deploying a poisoned model in a Vertex AI environment we deployed for testing. During our test, we gained access to the custom-online-prediction service account, allowing us to view and steal other AI and ML models from our test project.\r\nAttack Flow of the Model Exfiltration Attack\r\nThe attack flow consists of two steps. First, we deployed a poisoned model in a tenant project, which gave us access to restricted GCP repositories and sensitive model data. In the second step, we used the poisoned model to exfiltrate proprietary AI models, including fine-tuned LLM adapters.\r\nDelving Deeper: Preparing a Malicious Vertex Model\r\nBefore we dive into preparing a model and discussing vertex platforms, let's cover some basics in Vertex.\r\n\r\nIn our previous section discussing \u200b\u200bmodel tuning with Vertex AI Pipelines, we outlined the flow of tuning a model. To create a malicious model, we start with an \u201cinnocent\u201d model. When we finish the training process, we will see the new model in the Vertex AI Model Registry.\r\n\r\nThe Vertex AI Model Registry contains all the imported or trained models. This allows several functions in the GCP console, such as deploying to an endpoint. Figure 6 shows that one of these functions is an export feature to export the model to a storage bucket.\r\n\r\n[caption id=\"attachment_137378\" align=\"alignnone\" width=\"762\"] Figure 6. Screenshot of GCP console showing option to export a Vertex AI model.[\/caption]\r\n\r\nExporting the model shown in Figure 6 reveals the model is built from vectors and runs a specified image. Below, Figure 7 identifies the specific image of the exported model in the environment.json file.\r\n\r\n[caption id=\"attachment_137437\" align=\"alignnone\" width=\"786\"] Figure 7. Exported model file structure and environment.json file content.[\/caption]\r\n\r\nBy altering the image in the model, we could customize it to create a reverse shell, then we imported our new modified model to the model registry. Deploying this altered model to an endpoint will trigger the reverse shell, allowing us to navigate the tenant project of our test environment.\r\n\r\nAfter gaining a shell, we found that we were operating as the custom-online-prediction service-account in this environment, as shown below in Figure 8.\r\n\r\n[caption id=\"attachment_137382\" align=\"alignnone\" width=\"558\"] Figure 8. The custom-online-prediction service-account attached to the machine, gathered from the gcloud API.[\/caption]\r\n\r\nUsing this method, we did not have permission to use cloudresourcemanager.projects.getIamPolicy, so we could not list our permissions in the tenant project. However, we could use cloudresourcemanager.projects.testIamPermissions to enumerate our permissions in the tenant project. Although the permissions of this service account are read-only, this level of access can yield significant power with just a bit of imagination, as we will illustrate.\r\n\r\nFigure 9 shows the results from listing all the resources in this project, enumerating three Kubernetes clusters.\r\n\r\n[caption id=\"attachment_137384\" align=\"alignnone\" width=\"900\"] Figure 9. Cluster enumeration for prediction tenant project.[\/caption]\r\n\r\nOf the three Kubernetes clusters in this project, our malicious model runs on the third cluster, which is a deployment process for an endpoint. We will review the first two clusters later, but for now, let's examine the third.\r\n\r\nTo run kubectl commands on these clusters to retrieve information on pods and namespaces, we needed appropriate privileges. We achieved this by executing the get-cluster-credentials command in GCP, using the name of the cluster that we gathered in the previous enumeration step from Figure 9. Figure 10 below shows the results.\r\n\r\n[caption id=\"attachment_137386\" align=\"alignnone\" width=\"772\"] Figure 10. Fetching credentials for a running cluster.[\/caption]\r\n\r\nWith these credentials, we could use kubectl to explore the cluster, listing namespaces, pods, containers and service accounts. This step enabled us to move from the GCP realm into Kubernetes. This lateral movement was possible because permissions between GCP and GKE were linked through IAM Workload Identity Federation.\r\n\r\nWe found ourselves operating within a newly created cluster, where our namespace name was prediction as shown below in Figure 11.\r\n\r\n[caption id=\"attachment_137388\" align=\"alignnone\" width=\"500\"] Figure 11. List of namespaces gathered using the kubectl command that includes our newly created cluster.[\/caption]\r\n\r\nReturning to GCP, we listed the service accounts. By analyzing the IAM permissions of the GCP service account, we noticed the Kubernetes service accounts attached to it. Figure 12 shows this list revealing the service account for our newly created prediction cluster.\r\n\r\n[caption id=\"attachment_137448\" align=\"alignnone\" width=\"786\"] Figure 12. List of service accounts in the prediction tenant project.[\/caption]\r\n\r\nIn the default namespace of our cluster, only the default service account was present. However, based on the information we gathered, we inferred that our GCP service account had access to other Kubernetes clusters as well. By inspecting the pod details and examining the images, we confirmed that we were running inside a container within a pod in the prediction namespace, most likely in the context of prediction\/default-serving. Figure 13 below illustrates this.\r\n\r\n[caption id=\"attachment_137392\" align=\"alignnone\" width=\"900\"] Figure 13. The permission binding of the custom-online-prediction GCP service account and Kubernetes service accounts.[\/caption]\r\n\r\nNow that we had determined our identity, the next question was to determine what we could do.\r\n\r\nWe tried to create, delete, update, attach, execute and more, but we failed with no permissions. However, we could enumerate all the clusters, which gave us a great deal of information and increased our playground to try more attack vectors.\r\n\r\nWith our read-only permissions, we could list the pods in our newly created prediction cluster using the list pods command. Figure 14 shows two specific entries from this output.\r\n\r\n[caption id=\"attachment_137394\" align=\"alignnone\" width=\"900\"] Figure 14. Two entries from the JSON output of list pods command.[\/caption]\r\n\r\nFigure 14 shows the following two pods in our prediction namespace:\r\n\r\n \tpredictor-resource-pool-3882551479537500160-867655f99c-2dhhc\r\n \tpredictor-resource-pool-7628701944579620864-ccc8d8b94-f2chw\r\n\r\nBoth pods have containers using images from a repository located in our tenant project. Those images are:\r\n\r\n \tus-central1-docker.pkg.dev\/s154574aecb0c9653-tp\/dm-2118255330398830592-pipeline-6604364906047209472\/lala:latest\r\n \tus-central1-docker.pkg.dev\/s154574aecb0c9653-tp\/dm-1402464464623632384-pipeline-1229318750780522496\/lala:latest\r\n\r\nEach of the two image entries above show lala:latest at the end of each name, indicating these are our own malicious images. It\u2019s worth noting, our malicious images were stored in different repositories, representing distinct versions of the same image.\r\n\r\nFor each new deployment, GCP automatically uploads the image into a dedicated repository within the tenant project. Although we were running in the context of our own deployment (dm-2118255330398830592-pipeline-6604364906047209472), we now had visibility into other deployments that existed within the cluster.\r\nExtracting the Model Images\r\nWhile we could view our newly created image within the Kubernetes cluster, the question remained, could we extract or pull it? We had confirmed the image's existence by inspecting it in the Kubernetes context. However, to retrieve more detailed information about the image, we used GCP commands to describe it as shown below in Figure 15.\r\n\r\n[caption id=\"attachment_137439\" align=\"alignnone\" width=\"786\"] Figure 15. Describe the image in GCP to extract the digest.[\/caption]\r\n\r\nThis step revealed a critical piece of information. While the image name ends with lala:latest, we could not successfully use the string latest in our command because that is not a valid version identifier. Instead, our attempt returned the image digest, which serves as a unique identifier for the image version.\r\n\r\nWith the digest, we could theoretically pull the image, but the process wasn\u2019t straightforward. We lacked the permissions to create a new container, and since the Docker socket wasn\u2019t mounted to our container, we could not use Docker to pull the images.\r\n\r\nInstead, we used crictl, a lightweight container runtime interface (CRI) tool combined with our GCP service account authentication token. This allowed us to pull images from outside the container using the permissions of the online-prediction service account.\r\n\r\nBy setting the authentication token of the online-prediction service account as an environment variable, we were able to pull the images using the commands shown in Figure 16.\r\n\r\n[caption id=\"attachment_137398\" align=\"alignnone\" width=\"900\"] Figure 16. Using crictl commands to pull the images.[\/caption]\r\n\r\nAfter pulling these images, we could list the results as shown below in Figure 17.\r\n\r\n[caption id=\"attachment_137443\" align=\"alignnone\" width=\"786\"] Figure 17. The model images after being pulled to a remote environment.[\/caption]\r\n\r\nOnce pulled, we exported the images into .tar files using ctr, allowing us to move and load them elsewhere.\r\nSwitching Context: Exploring Other Clusters\r\nNow that we had gathered information from the first cluster, it was time to explore the other clusters we had discovered earlier. Since we had access to the get-cluster-credentials command and our GCP service account was bound to the clusters via IAM Workload Identity Federation, we switched context to cluster 2 as shown below in Figure 18.\r\n\r\n[caption id=\"attachment_137402\" align=\"alignnone\" width=\"900\"] Figure 18. Kubectl get-context command.[\/caption]\r\n\r\nNow we are operating in the context of cluster 2. Figure 19 shows the cluster 2 namespaces.\r\n\r\n[caption id=\"attachment_137404\" align=\"alignnone\" width=\"225\"] Figure 19. Cluster 2 namespaces.[\/caption]\r\n\r\nIn this cluster, the prediction namespace was no longer present. We began by enumerating the pods and containers. Much of the cluster was composed of default Kubernetes resources, and we found images with prediction-server in the name stored in our tenant project\u2019s repository, like Figure 20 shows:\r\n\r\n \tus-central1-docker.pkg.dev\/s154574aecb0c9653-tp\/ucaip-deployed-model-1558744649349201920\/prediction-server:20231117_1325\r\n\r\n[caption id=\"attachment_137406\" align=\"alignnone\" width=\"900\"] Figure 20. The prediction server (model endpoint) deployed to cluster 2.[\/caption]\r\n\r\nIn cluster 2, we identified one such image. Pivoting on that, we found two additional images in cluster 1 with the same production-server string in the name:\r\n\r\n \tus-central1-docker.pkg.dev\/s154574aecb0c9653-tp\/ucaip-deployed-model-1932543418420953088\/prediction-server:20231117_1325\r\n \tus-central1-docker.pkg.dev\/s154574aecb0c9653-tp\/ucaip-deployed-model-6762636426589765632\/prediction-server:20231117_1325\r\n\r\nThese images represent other deployments that other teams created in our project. Surprisingly with the same method previously described, we could download those images from other clusters. In fact, we had access to download images of all deployed models in the project.\r\nVertex AI Fine-Tuned Adapter Layer Extraction\r\nAs the above method was effective for ML model images, we also wanted to access LLM-based Vertex AI models. While ML models can be exported from GCP as we just demonstrated, LLM models have more restrictions in GCP. For example, Figure 21 shows a screenshot of a GCP panel with an LLM model where the export function is grayed out.\r\n\r\n[caption id=\"attachment_137408\" align=\"alignnone\" width=\"900\"] Figure 21. An example for a tuned LLM model where the export function is grayed out.[\/caption]\r\n\r\nWhen creating a fine-tuned LLM model, GCP adds a fine-tuning layer called an adapter. This adapter layer is the additional weights created by the fine-tuning data.\r\n\r\nBy listing all the buckets in our tenant project, we discovered that all deployed models were uploaded there. Since our GCP service account had viewer permissions, not only could we list these buckets, but we could copy them. Within the buckets, we uncovered a directory structure resembling that of ML models. Figures 22 and 23 show that these bucket identifiers all start with the string caip.\r\n\r\n[caption id=\"attachment_137410\" align=\"alignnone\" width=\"469\"] Figure 22. List of Cloud Storage buckets in the prediction tenant project.[\/caption]\r\n\r\n[caption id=\"attachment_137412\" align=\"alignnone\" width=\"900\"] Figure 23. Directory structure of the caip Cloud Storage buckets pulled to a local environment.[\/caption]\r\n\r\nFigure 23 highlights two strings of numbers in the bucket path that act as a deployed model ID for each bucket. We could use this information to trace these buckets back to the original model ID in our source project model registry.\r\n\r\nUsing the first example in Figure 23 of 3091243956143390720, we traced this bucket back to our source project model registry as illustrated below in Figures 24, 25 and 26.\r\n\r\nIn Figure 24, our search revealed an endpoint with the same ID string as the deployed model ID from the first bucket listed in Figure 23. Directly below that is an associated model ID.\r\n\r\n[caption id=\"attachment_137414\" align=\"alignnone\" width=\"709\"] Figure 24. Finding an endpoint with the same ID string as the first deployed model ID in Figure 23.[\/caption]\r\n\r\nIn Figure 25, we pivot on that same deployed model ID to find yet another associated model ID.\r\n\r\n[caption id=\"attachment_137416\" align=\"alignnone\" width=\"900\"] Figure 25. Pivoting on the same deployed model ID to find another associated model ID.[\/caption]\r\n\r\nFigure 26 shows these same associated model IDs were present when we checked our source project.\r\n\r\n[caption id=\"attachment_137418\" align=\"alignnone\" width=\"537\"] Figure 26. The model IDs in the source project.[\/caption]\r\nImpact\r\nWe found out that we had all the ML models that have been deployed to endpoints. So at the beginning, we had all the images of the models, and now we also had all the ML models.\r\n\r\nEven more alarmingly, we discovered adapter files within these buckets as Figure 27 below shows. These adapter files are critical components of the fine-tuning process for LLM models, and they contain the weights that directly alter the behavior of the base model.\r\n\r\nAlthough the name of the example in Figure 27 is adapter.txt, the content is not readable text. However, the content of these adapter files contains weights representing highly sensitive, proprietary data, which makes them an invaluable target for attackers.\r\n\r\n[caption id=\"attachment_137445\" align=\"alignnone\" width=\"786\"] Figure 27. Example of an adapter file for a fine-tuned LLM from an exported bucket.[\/caption]\r\n\r\nIn summary, by deploying a malicious model, we were able to access resources in the tenant projects that allowed us to view and export all models deployed across the project. This includes both ML and LLM models, along with their fine-tuned adapters.\r\n\r\nThis method presents a clear risk for a model-to-model infection scenario. For example, your team could unknowingly deploy a malicious model uploaded to a public repository. Once active, it could exfiltrate all ML and fine-tuned LLM models in the project, putting your most sensitive assets at risk.\r\n\r\nThe flow diagram in Figure 28 shows an example of this model infection attack using the following steps:\r\n\r\n \tPoisoned model is prepared and uploaded to a public repository\r\n \tData engineer downloads and imports the model\r\n \tThe model is deployed, granting access to the attacker\r\n \tThe attacker downloads the model images\r\n \tThe attacker downloads the trained models and LLM adapter layers\r\n\r\n[caption id=\"attachment_137422\" align=\"alignnone\" width=\"900\"] Figure 28. Poisoned model leads to intellectual property exfiltration.[\/caption]\r\nConclusion\r\nThis research highlights how a single malicious model deployment could compromise an entire AI environment. An attacker could use even one unverified model deployed on a production system to exfiltrate sensitive data, leading to severe model exfiltration attacks.\r\n\r\nThe permissions required to deploy a model might seem harmless, but in reality, that single permission could grant access to all other models in a vulnerable project. Only a very few individuals should have the permission to deploy new models in a project containing sensitive or production models without strict oversight.\r\n\r\nTo protect against such risks, we must implement strict controls on model deployments. A fundamental security practice is to ensure an organization's development or test environments are separate from its live production environment. This separation reduces the risk of an attacker accessing potentially insecure models before they are fully vetted. Whether it comes from an internal team or a third-party repository, validating every model before deployment is vital.\r\n\r\nThis highlights the critical need for Prisma Cloud AI Security Posture Management (AI-SPM) to help ensure robust oversight of AI pipelines.\r\n\r\nIf you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call:\r\n\r\n \tNorth America Toll-Free: 866.486.4842 (866.4.UNIT42)\r\n \tEMEA: +31.20.299.3130\r\n \tAPAC: +65.6983.8730\r\n \tJapan: +81.50.1790.0200\r\n\r\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about the Cyber Threat Alliance.","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2024\/11\/13_Cloud_cybersecurity_research_Overview_1920x900-300x300.jpg","width":300,"height":300},"speakable":{"@type":"SpeakableSpecification","xPath":["\/html\/head\/title","\/html\/head\/meta[@name='description']\/@content"]},"author":[{"@type":"Person","name":"Ofir Balassiano"},{"@type":"Person","name":"Ofir Shaty"}]}</script><link rel='stylesheet' id='crayon-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<style id='co-authors-plus-coauthors-style-inline-css'>
.wp-block-co-authors-plus-coauthors.is-layout-flow [class*=wp-block-co-authors-plus]{display:inline}

</style>
<style id='co-authors-plus-avatar-style-inline-css'>
.wp-block-co-authors-plus-avatar :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-avatar :where(img){vertical-align:middle}.wp-block-co-authors-plus-avatar:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-avatar.aligncenter{display:table;margin-inline:auto}

</style>
<style id='co-authors-plus-image-style-inline-css'>
.wp-block-co-authors-plus-image{margin-bottom:0}.wp-block-co-authors-plus-image :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-image :where(img){vertical-align:middle}.wp-block-co-authors-plus-image:is(.alignfull,.alignwide) :where(img){width:100%}.wp-block-co-authors-plus-image:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-image.aligncenter{display:table;margin-inline:auto}

</style>
<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='post-views-counter-frontend-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.min.css?ver=1.4.7' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.min.css?ver=1' media='all' />
<link rel='stylesheet' id='unit42-v6-style-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/style.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-head-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/head-styles.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v5-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-plugin-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/plugin.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main-redesign.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='like-dislike-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/css/ldc-lite.css?ver=1.0.0' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script id="crayon_js-js-extra">
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" id="crayon_js-js"></script>
<script id="post-views-counter-frontend-js-before">
var pvcArgsFrontend = {"mode":"js","postID":137365,"requestURL":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","nonce":"bf674892a5","dataStorage":"cookies","multisite":false,"path":"\/","domain":""};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/js/frontend.min.js?ver=1.4.7" id="post-views-counter-frontend-js"></script>
<script id="wpml-xdomain-data-js-extra">
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en","_nonce":"c586132c28"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.6.13" id="wpml-xdomain-data-js" defer data-wp-strategy="defer"></script>
<link rel="https://api.w.org/" href="https://unit42.paloaltonetworks.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://unit42.paloaltonetworks.com/wp-json/wp/v2/posts/137365" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.2" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=137365' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fprivilege-escalation-llm-model-exfil-vertex-ai%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fprivilege-escalation-llm-model-exfil-vertex-ai%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.6.13 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
			padding-top:0px;
			padding-bottom:0px;
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>      <link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="32x32" />
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<meta name="msapplication-TileImage" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<script>var $ = jQuery;</script>

    <script type="text/javascript">
    ;(function(win, doc, style, timeout) {
    var STYLE_ID = 'at-body-style';
    function getParent() {
    return doc.getElementsByTagName('head')[0];
    }
    function addStyle(parent, id, def) {
        if (!parent) {
        return;
        }
        var style = doc.createElement('style');
        style.id = id;
        style.innerHTML = def;
        parent.appendChild(style);
    }
    function removeStyle(parent, id) {
        if (!parent) {
            return;
        }
        var style = doc.getElementById(id);
        if (!style) {
            return;
        }
        parent.removeChild(style);
    }
    addStyle(getParent(), STYLE_ID, style);
    setTimeout(function() {
    removeStyle(getParent(), STYLE_ID);
    }, timeout);
    }(window, document, "body {visibility:hidden !important}", 3000));
    </script>

            <script src="https://assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
            <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>


<script type="text/javascript">
var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
if(isIE11){
    var polyfill = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/scripts/polyfill.min.js';
    document.write('<script type="text/javascript" src="'+polyfill+'">\x3C/script>');
}
    /**
 * String.prototype.replaceAll() polyfill
 * https://gomakethings.com/how-to-replace-a-section-of-a-string-with-another-one-with-vanilla-js/
 * @author Chris Ferdinandi
 * @license MIT
 */
if (!String.prototype.replaceAll) {
	String.prototype.replaceAll = function(str, newStr){
		// If a regex pattern
		if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {
			return this.replace(str, newStr);
		}
		// If a string
		return this.replace(new RegExp(str, 'g'), newStr);
	};
}

    /*! lozad.js - v1.16.0 - 2020-09-06 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});

</script>

<!-- <script src="https://www.google.com/recaptcha/api.js"></script>  -->

<!--  End: Scripts Migrated From Unit42-v5 -->

</head>
<body class="post-template-default single single-post postid-137365 single-format-standard no-sidebar">
<header class="haeder py-15 position-relative z-index-2" style="display: none;">
  <div class="container px-sm-30 px-35">
    <div class="row">
        <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                        <a href="https://www.paloaltonetworks.com/">
                <img src="/wp-content/uploads/2021/07/PANW_Parent.png" width="140px" alt="Logo" />
            </a>
        </div>
      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo"  width="150" height="35"/>
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search" aria-label="search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required aria-label="Inner Search">
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10"  style="display: none!important;">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-119884" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-119884"><a target="_blank" rel="noopener" href="https://www.paloaltonetworks.com/unit42">Security Consulting</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
<li id="menu-item-121229" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-121229"><a href="https://start.paloaltonetworks.com/contact-unit42.html"><b style="color:#C84727">Under Attack?</b></a></li>
</ul>  </div>
</nav>
<div class="panClean pan-template-home" id="main-nav-menu-cont" style="display:none;">
    <div class="cleanHeader mainNavigationComp baseComponent parbase">
        <div class="productNav2021Component dark default" id="PAN_2021_NAV_ASYNC">
        </div>
  </div>
<div class="cleanTopHtml htmlComp baseComponent parbase"><div class="base-component-spacer spacer-none  "></div>
</div>
</div>
<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
	function getCookie(cname) {
	 	var name = cname + "=";
  		var decodedCookie = decodeURIComponent(document.cookie);
		var ca = decodedCookie.split(';');
  		for(var i = 0; i <ca.length; i++) {
    			var c = ca[i];
    			while (c.charAt(0) == ' ') {
     				 c = c.substring(1);
    			}
    			if (c.indexOf(name) == 0) {
    				 return c.substring(name.length, c.length);
    			}
  		}
  		return "";
	}

	var referer = "";//sessionStorage.container;
	var pcontainer = sessionStorage.getItem("container");
	var searchResultsPagePath = "";
	if(((pcontainer) && pcontainer.indexOf('Prisma')!=-1)){
	    referer = 'Prisma' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Cortex')!=-1)){
	    referer = 'Cortex' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Sase')!=-1)){
	    referer = 'Sase' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Unit')!=-1)){
	    referer = 'Unit' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Ngfw')!=-1)){
	    referer = 'Ngfw' ;
	}
        var fromRef = document.referrer;
        var nContainer = getCookie("navContainer");
        if(nContainer){//If user is coming from main site, we need to reset the container		
		if(fromRef  && fromRef.indexOf("prismacloud.io")!=-1){
                        referer = 'Prisma' ;
                        sessionStorage.setItem("container","Prisma");
                } else if(fromRef.indexOf("paloaltonetworks.com")!=-1 || fromRef.indexOf("paloaltonetworks.jp")!=-1 ){
                        if(nContainer.indexOf('Prisma') != -1){
                            referer = 'Prisma' ;
                            sessionStorage.setItem("container","Prisma");
                        }
                        if(nContainer.indexOf('Cortex') != -1){
                            referer = 'Cortex' ;
                            sessionStorage.setItem("container","Cortex");
                        }
			if(nContainer.indexOf('Sase') != -1){
                            referer = 'Sase' ;
                            sessionStorage.setItem("container","Sase");
                        }
			if(nContainer.indexOf('Unit') != -1){
                            referer = 'Unit' ;
                            sessionStorage.setItem("container","Unit");
                        }
			if(nContainer.indexOf('Ngfw') != -1){
                            referer = 'Ngfw' ;
                            sessionStorage.setItem("container","Ngfw");
                        }
			document.cookie = 'navContainer=; path=/; domain=.paloaltonetworks.com; expires=' + new Date(0).toUTCString();
		}
	}
if(referer != "Prisma" && referer != "Cortex" && referer != "Sase" && referer != "Unit" && referer != "Ngfw") {
    referer = 'Unit' ;
    sessionStorage.setItem("container","Unit");
}
function callMainSitePrismaNavHTML(){
    
    var referrer_domain = 'https://www.paloaltonetworks.com';
    sessionStorage.setItem("domain",referrer_domain);
    if(referer == 'Prisma'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/prismasearch";
        }
    if(referer == 'Cortex'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderCortex.cortexRenderer.html';	
        searchResultsPagePath = referrer_domain+"/search/cortexsearch";	
    }
    if(referer == 'Sase'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderSase.saseRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/sasesearch";
    }
    if(referer == 'Unit'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/unit-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/content/pan/en_US/search/unit42search";
		    }
    if(referer == 'Ngfw'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/ngfw-cdss-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/search/ngfwcdsssearch";
    }
    httpGet(menu_url,'menu_html');
    document.getElementById('main-nav-menu-cont').removeAttribute("style");
}
function addStyle(styles) {            
    /* Create style document */
    var css = document.createElement('style');
    css.type = 'text/css';

    if (css.styleSheet) 
        css.styleSheet.cssText = styles;
    else 
        css.appendChild(document.createTextNode(styles));

    /* Append style to the tag name */
    document.getElementsByTagName("head")[0].appendChild(css);
}
function httpGet(theUrl,req_type) {
    if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            if(req_type == 'menu_html'){
            var nav_text = xmlhttp.responseText.replaceAll('https://static.cloud.coveo.com/searchui/v2.9159/js/CoveoJsSearch.Lazy.min.js', '');
            nav_text = nav_text.replaceAll('src="/', 'src="'+maindomain_lang+'/');
            nav_text = nav_text.replaceAll("'/content", "'"+maindomain_lang+"/content");
                        
            document.getElementById("PAN_2021_NAV_ASYNC").innerHTML = nav_text.replaceAll('href="/', 'href="'+maindomain_lang+'/');

            var lozad_back = document.getElementsByClassName('lozad-background');
            Array.prototype.forEach.call(lozad_back, function(el) {
            // Do stuff here
            var el_back_img_path = el.getAttribute('data-background-image');
            var first_pos = el_back_img_path.indexOf("'");
            var last_pos = el_back_img_path.indexOf("'",first_pos+1);
            el_back_img_path = el_back_img_path.substring(first_pos+1,last_pos);
            el.setAttribute("data-background-image",main_site_url+el_back_img_path);
            });
            }
            if(req_type == 'head_inline_css'){
            addStyle(xmlhttp.responseText);
            }
        }
    }
    xmlhttp.open("GET", theUrl, true );
    xmlhttp.send();    
}    
    
if(referer == 'Prisma' || referer == 'Cortex' || referer == 'Sase' || referer == 'Unit' || referer == 'Ngfw'){
    const article = document.querySelector('#PAN_2021_NAV_ASYNC');
    if(referer == 'Prisma'){
        article.dataset.type = 'prisma';
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    else if(referer == 'Cortex'){
        article.dataset.type = 'cortex';
    }
    else if(referer == 'Sase'){
        article.dataset.type = 'sase';
    }
    else if(referer == 'Unit'){
        article.dataset.type = 'unit';
    }
    else if(referer == 'Ngfw'){
        article.dataset.type = 'ngfw';
    }
    //set class to default
    if(referer == 'Unit' || referer == 'Ngfw'){
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    callMainSitePrismaNavHTML();        
}
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->



<main class="main">
    <section class="section section--article">
        <div class="pa article-banner" style="background-image:url('https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/13_Cloud_cybersecurity_research_Overview_1920x900.jpg')">
          <div class="l-container"> 
            <div class="l-breadcrumbs"> 
              <ul> <li> <a href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:hero:breadcrumb:Threat Research">Threat Research Center</a></li><li><a href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" title="Threat Research" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:hero:breadcrumb:Threat Research">Threat Research</a></li><li class="is-current"><a href="https://unit42.paloaltonetworks.com/category/cloud-cybersecurity-research/" role="link" title="Cloud Cybersecurity Research" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:hero:breadcrumb:Cloud Cybersecurity Research">Cloud Cybersecurity Research</a></li> </ul>
            </div>            <div class="ab__title">
              <a class="card-category" href="https://unit42.paloaltonetworks.com/category/cloud-cybersecurity-research/" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:hero:Cloud Cybersecurity Research"><span class="ab-title__pre">Cloud Cybersecurity Research</span></a> 
              <h1>ModeLeak: Privilege Escalation to LLM Model Exfiltration in Vertex AI</h1>
              <div class="ab__video">
              <span class="duration"> 
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-clock.svg" alt="Clock Icon"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 15</span> <span class="rt-label rt-postfix"></span></span> min read              </span>
                              </div>          
              <div class="ab-lc__wrapper">
                <span class="ab-title__pre">Related Products</span><div class="ab__link-cards"><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/code-to-cloud-platform/" style="--card-color: #00c0e8" role="link" title="Code to Cloud Platform" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:hero:Code to Cloud Platform"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/prisma_RGB_logo_Icon_Color.png" alt="Code to Cloud Platform icon">Code to Cloud Platform</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/prisma-cloud/" style="--card-color: #00c0e8" role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:hero:Prisma Cloud"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/prisma_RGB_logo_Icon_Color.png" alt="Prisma Cloud icon">Prisma Cloud</a></div>              </div>
            </div>
          </div>
          <div class="ab__footer">
            <div class="l-container">
              <div class="ab__footer-wrapper">
                <ul class="ab__features" role="list">
                  <li role="listitem">
				 <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-profile-grey.svg" alt="Profile Icon">
					 <div class="ab__text"><span>By:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:hero:Ofir Balassiano" href="https://unit42.paloaltonetworks.com/author/ofir-balassiano/">Ofir Balassiano</a></li><li><a data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:hero:Ofir Shaty" href="https://unit42.paloaltonetworks.com/author/ofir-shaty/">Ofir Shaty</a></li></ul></div></li>                  <li role="listitem">
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-calendar-grey.svg" alt="Published Icon">
			<div class="ab__text"><span>Published:</span>November 12, 2024</div></li>					<li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-category.svg" alt="Tags Icon"><div class="ab__text"><span>Categories:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:hero:Cloud Cybersecurity Research" href="https://unit42.paloaltonetworks.com/category/cloud-cybersecurity-research/">Cloud Cybersecurity Research</a></li><li><a data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:hero:Threat Research" href="https://unit42.paloaltonetworks.com/category/threat-research/">Threat Research</a></li></ul></div>
		</li>                  <li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-tags-grey.svg" alt="Tags Icon"><div class="ab__text"><span>Tags:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:hero:data exfiltration" href="https://unit42.paloaltonetworks.com/tag/data-exfiltration/">Data exfiltration</a></li><li><a data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:hero:Google Cloud" href="https://unit42.paloaltonetworks.com/tag/google-cloud/">Google Cloud</a></li><li><a data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:hero:Kubernetes" href="https://unit42.paloaltonetworks.com/tag/kubernetes/">Kubernetes</a></li><li><a data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:hero:LLM" href="https://unit42.paloaltonetworks.com/tag/llm/">LLM</a></li><li><a data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:hero:poisoned model" href="https://unit42.paloaltonetworks.com/tag/poisoned-model/">Poisoned model</a></li><li><a data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:hero:privilege escalation" href="https://unit42.paloaltonetworks.com/tag/privilege-escalation/">Privilege escalation</a></li><li><a data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:hero:Vertex AI" href="https://unit42.paloaltonetworks.com/tag/vertex-ai/">Vertex AI</a></li></ul></div>
		</li>                </ul>
                <div class="ab__options">
                  <ul role="list">
                                        <li role="listitem"><a href="https://unit42.paloaltonetworks.com/privilege-escalation-llm-model-exfil-vertex-ai/?pdf=download&#038;lg=en&#038;_wpnonce=27a36cfbff" role="link" target="_blank"  title="Click here to download" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:hero:pdfdownload"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-download.svg" alt="Download Icon"></a></li>
                    <li role="listitem"><a href="https://unit42.paloaltonetworks.com/privilege-escalation-llm-model-exfil-vertex-ai/?pdf=print&#038;lg=en&#038;_wpnonce=27a36cfbff" target="_blank" role="link" title="Click here to print" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:hero:pdfprint"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-print.svg" alt="Print Icon"></a></li>
                  </ul>
                  
	<div class="ab__share" id="shareDropdown" role="button" aria-expanded="false">
	<a href="#" role="link" title="Click here to share" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:share" class="">Share<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"></a><ul class="share-dropdown" role="menu">
				<li role="menuitem">
					<a href="#" class="copy-url" id="copyUrl" data-url="https://unit42.paloaltonetworks.com/privilege-escalation-llm-model-exfil-vertex-ai/" role="link" title="Copy link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:share:link"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-share-link.svg" alt="Link Icon"></a>
				</li>
				<li role="menuitem">
					<a href="mailto:?subject=ModeLeak:%20Privilege%20Escalation%20to%20LLM%20Model%20Exfiltration%20in%20Vertex%20AI&#038;body=Check%20out%20this%20article%20https%3A%2F%2Funit42.paloaltonetworks.com%2Fprivilege-escalation-llm-model-exfil-vertex-ai%2F" role="link" title="Share in email" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:share:email"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-sms.svg" alt="Link Email"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fprivilege-escalation-llm-model-exfil-vertex-ai%2F" target="_blank" role="link" title="Share in Facebook" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:share:facebook"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-fb-share.svg" alt="Facebook Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fprivilege-escalation-llm-model-exfil-vertex-ai%2F&#038;title=ModeLeak:%20Privilege%20Escalation%20to%20LLM%20Model%20Exfiltration%20in%20Vertex%20AI" target="_blank" role="link" title="Share in LinkedIn" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:share:linkedin"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-linkedin-share.svg" alt="LinkedIn Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fprivilege-escalation-llm-model-exfil-vertex-ai%2F&#038;text=ModeLeak:%20Privilege%20Escalation%20to%20LLM%20Model%20Exfiltration%20in%20Vertex%20AI" target="_blank" role="link" title="Share in Twitter" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:share:twitter"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-twitter-share.svg" alt="Twitter Icon"></a>
				</li>
				<li role="menuitem">
					<a href="//www.reddit.com/submit?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fprivilege-escalation-llm-model-exfil-vertex-ai%2F" target="_blank" role="link" title="Share in Reddit" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:share:reddit"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-reddit-share.svg" alt="Reddit Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://mastodon.social/share?text=ModeLeak:%20Privilege%20Escalation%20to%20LLM%20Model%20Exfiltration%20in%20Vertex%20AI%20https%3A%2F%2Funit42.paloaltonetworks.com%2Fprivilege-escalation-llm-model-exfil-vertex-ai%2F" target="_blank" role="link" title="Share in Mastodon" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:share:mastodon"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-mastodon-share.svg" alt="Mastodon Icon"></a>
				</li>
	  </ul>
    </div>                </div>
              </div>
            </div>
          </div>
        </div>
      </section> 
    <section class="section blog-contents"> 
      <div class="pa blog-editor">
        <div class="l-container">
          <div class="be__wrapper">
            <div class="be__contents">
              <div class="be__contents-wrapper">
                <h2><a id="post-137365-_4lt92rr5muov"></a>Executive Summary</h2>
<p>In the race to gain a competitive edge, organizations are increasingly training artificial intelligence (AI) models on sensitive data. But what if a seemingly harmless AI model became a gateway for attackers?</p>
<p>A malicious actor could upload a poisoned model to a public repository, and without realizing it, your team could deploy it in your environment. Once active, that model could exfiltrate your sensitive machine learning (ML) models and fine-tuned large language model (LLM) adapters. With access to these adapters, attackers could replicate your custom tuning and optimizations, exposing sensitive information embedded in fine-tuning patterns.</p>
<p>Palo Alto Networks researchers recently uncovered two vulnerabilities in Google's Vertex AI platform. These vulnerabilities could have allowed attackers to escalate privileges and exfiltrate models.</p>
<p>We have shared these findings with our partners at Google, and they have since implemented fixes to eliminate these specific issues for Vertex AI on the Google Cloud Platform (GCP). Read on to understand how these vulnerabilities worked and how you can protect your environment from similar threats.</p>
<p>In this article, we outline our steps to discover two vulnerabilities in the Vertex AI platform:</p>
<ul>
<li><strong>Privilege escalation via custom jobs</strong><br />
By exploiting custom job permissions, we were able to escalate our privileges and gain unauthorized access to all data services in the project.</li>
<li><strong>Model exfiltration via malicious model</strong><br />
Deploying a poisoned model in Vertex AI led to the exfiltration of all other fine-tuned models, posing a serious proprietary and sensitive data exfiltration attack risk.</li>
</ul>
<p>Our examination of the first vulnerability ended with a classic privilege escalation, but the second vulnerability represents a much more interesting “model-to-model” infection scenario that required an in-depth exploration.</p>
<p>Figure 1 shows a diagram demonstrating the two vulnerabilities.</p>
<figure id="attachment_137469" aria-describedby="caption-attachment-137469" style="width: 1400px" class="wp-caption alignnone"><img  class="wp-image-137469 size-full lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Tuning-of-Vertex-AI-model-_Vulnerability-12.png" alt="Diagram showing a cybersecurity threat involving AI models. The vulnerability 1 at the top shows an attacker creating a custom job through a fake service agent that leads to privilege escalation, branching into the customer source project and the Google internal artifact registry. The second vulnerability on the bottom shows a malicious model in a public repository." width="1400" height="1588" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Tuning-of-Vertex-AI-model-_Vulnerability-12.png 1400w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Tuning-of-Vertex-AI-model-_Vulnerability-12-388x440.png 388w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Tuning-of-Vertex-AI-model-_Vulnerability-12-617x700.png 617w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Tuning-of-Vertex-AI-model-_Vulnerability-12-768x871.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Tuning-of-Vertex-AI-model-_Vulnerability-12-1354x1536.png 1354w" sizes="(max-width: 1400px) 100vw, 1400px" /><figcaption id="caption-attachment-137469" class="wp-caption-text">Figure 1. A diagram demonstrating the two vulnerabilities.</figcaption></figure>
<p>Palo Alto Networks customers are better protected from the threats discussed in this article through our <a href="https://www.paloaltonetworks.com/prisma/cloud" target="_blank" rel="noopener">Prisma Cloud</a> offerings.</p>
<p>If you think you might have been compromised or have an urgent matter, contact the <a href="https://start.paloaltonetworks.com/contact-unit42.html" target="_blank" rel="noopener">Unit 42 Incident Response team</a>.</p>
<table style="width: 100%;">
<thead>
<tr>
<td style="width: 35%;"><b>Related Unit 42 Topics</b></td>
<td style="width: 100%;"><a href="https://unit42.paloaltonetworks.com/category/cloud-cybersecurity-research/" target="_blank" rel="noopener"><b>Cloud Cybersecurity Research</b></a>, <strong><a href="https://unit42.paloaltonetworks.com/tag/privilege-escalation/" target="_blank" rel="noopener">Privilege Escalation</a></strong></td>
</tr>
</thead>
</table>
<h2><a id="post-137365-_bnv7uai97g8z"></a><strong>Privilege Escalation </strong>T<strong>hrough Custom Code Injection</strong></h2>
<p>The first vulnerability we found is a privilege escalation through custom code injection. To properly explain this method, we must first understand model tuning in <a href="https://cloud.google.com/vertex-ai/docs/pipelines/introduction" target="_blank" rel="noopener">Vertex AI Pipelines</a>.</p>
<h3><a id="post-137365-_hoi3bh461eiw"></a>Background: Understanding Model Tuning with Vertex AI Pipelines</h3>
<p>Vertex AI is a comprehensive platform for developing, training and deploying ML and AI models. A key feature of this platform is Vertex AI Pipelines, which allow users to tune their models using <a href="https://cloud.google.com/vertex-ai/docs/training/create-custom-job" target="_blank" rel="noopener">custom jobs, also referred to as custom training jobs</a>.</p>
<p>These custom jobs are essentially code that runs within the pipeline and can modify models in various ways. While this flexibility is valuable, it also opens the door to potential exploitation.</p>
<p>Our research focused on how attackers could abuse custom jobs. By manipulating the custom job pipeline, we discovered a privilege escalation path that allowed us to access resources far beyond the intended scope.</p>
<figure id="attachment_137471" aria-describedby="caption-attachment-137471" style="width: 1400px" class="wp-caption alignnone"><img  class="wp-image-137471 size-full lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Tuning-of-Vertex-AI-model-diagram_General-view.png" alt="Flowchart showing a data processing pipeline for a project. It includes steps labeled 'Customer GCP Source Project,' 'Pipeline Job,' 'Custom Job,' 'Fine-tuned AI Model,' and 'Prediction Server.' Each step is connected sequentially with arrows indicating the flow of data processing from left to right." width="1400" height="376" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Tuning-of-Vertex-AI-model-diagram_General-view.png 1400w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Tuning-of-Vertex-AI-model-diagram_General-view-786x211.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Tuning-of-Vertex-AI-model-diagram_General-view-768x206.png 768w" sizes="(max-width: 1400px) 100vw, 1400px" /><figcaption id="caption-attachment-137471" class="wp-caption-text">Figure 2. Tuning of Vertex AI model flow diagram.</figcaption></figure>
<p>In Figure 2, tuning a Vertex AI model (ML or LLM) happens in a remote tenant project that is dedicated to the source project (step 1). The tuning process uses custom jobs defined in Vertex AI Pipelines, which are run on a different tenant project (step 2).</p>
<p>When the tuning process is complete, a new tuned model is created in the model registry in the origin project (step 3). At this point, we deploy our model in a third different tenant project (step 4).</p>
<h3><a id="post-137365-_orjivhtzv8fm"></a>Attack Flow of the Privilege Escalation Vulnerability</h3>
<p>When running, a custom job executes within a tenant project under a <a href="https://cloud.google.com/iam/docs/service-agents" target="_blank" rel="noopener">service agent</a> identity. By default, service agents have excessive permissions to many services in the source project, such as all the source project's <a href="https://cloud.google.com/storage/docs" target="_blank" rel="noopener">Cloud Storage</a> and <a href="https://cloud.google.com/bigquery/docs/introduction" target="_blank" rel="noopener">BigQuery</a> datasets. With the service agent’s identity, we could list, read and even export data from buckets and datasets we should never have been able to access.</p>
<h3><a id="post-137365-_s8jw693ig6vt"></a>Delving Deeper: Injecting Custom Code</h3>
<p>For a custom job to run specific code, we could either inject commands into the <a href="https://cloud.google.com/vertex-ai/docs/reference/rest/v1/CustomJobSpec#ContainerSpec" target="_blank" rel="noopener">container spec JSON</a> configuration or create an image that opens a reverse shell. In our case, we created a custom image as a backdoor, allowing us to gain access to the environment. Figure 3 below shows the commands we used to create this custom image.</p>
<figure id="attachment_137372" aria-describedby="caption-attachment-137372" style="width: 800px" class="wp-caption alignnone"><img  class="wp-image-137372 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-757748-137365-3.png" alt="A screenshot of a command line interface showing code for creating a custom job in Google Cloud AI, with parameters for region, display name, project name, worker pool specifications, and container image specified." width="800" height="204" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-757748-137365-3.png 1754w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-757748-137365-3-786x201.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-757748-137365-3-768x196.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-757748-137365-3-1536x392.png 1536w" sizes="(max-width: 800px) 100vw, 800px" /><figcaption id="caption-attachment-137372" class="wp-caption-text">Figure 3. Creating an image to run custom code.</figcaption></figure>
<p>With this custom job running in a tenant-project, we discovered that our identity was the following:</p>
<p style="padding-left: 40px;"><span style="font-family: 'courier new', courier, monospace;">service-&lt;PROJECT_NUMBER&gt;@gcp-sa-aiplatform-cc.iam.gserviceaccount[.]com</span></p>
<p>This service agent is the <a href="https://cloud.google.com/iam/docs/service-agents#ai-platform-custom-code-service-agent" target="_blank" rel="noopener">AI Platform Custom Code Service Agent</a>. With the service agent acting in this role, we could perform the following activities:</p>
<ul>
<li>Accessing the metadata service</li>
<li>Acquiring the service credentials</li>
<li>Extracting the <span style="font-family: 'courier new', courier, monospace;">user-data</span> script</li>
</ul>
<p>This account had extensive permissions, including the following:</p>
<ul>
<li>The ability to list all service accounts</li>
<li>Creating, deleting, reading and writing all storage buckets</li>
<li>Accessing all BigQuery tables</li>
</ul>
<p>Figure 4 lists the <a href="https://cloud.google.com/iam/docs/understanding-roles#aiplatform.customCodeServiceAgent" target="_blank" rel="noopener">specific permissions</a> that our service agent had in the source project during our testing.</p>
<figure id="attachment_137374" aria-describedby="caption-attachment-137374" style="width: 900px" class="wp-caption alignnone"><img  class="wp-image-137374 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-760957-137365-4.png" alt="A text-based image displaying a list of various Google Cloud service permissions such as bigquery.datasets.create, storage.buckets.list, and iam.serviceAccounts.getAccessToken, arranged in two columns." width="900" height="439" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-760957-137365-4.png 1678w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-760957-137365-4-786x383.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-760957-137365-4-1436x700.png 1436w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-760957-137365-4-768x374.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-760957-137365-4-1536x749.png 1536w" sizes="(max-width: 900px) 100vw, 900px" /><figcaption id="caption-attachment-137374" class="wp-caption-text">Figure 4. Service agent permissions granted in the source project.</figcaption></figure>
<p>The user-data script gave us visibility into the virtual machine (VM) creation and provided us with metadata on GCP internal <a href="https://www.google.com/url?q=https://cloud.google.com/artifact-registry/docs&amp;sa=D&amp;source=docs&amp;ust=1730933894252820&amp;usg=AOvVaw3vtpJ38XaLUm8S9Kf3zf6z" target="_blank" rel="noopener">Artifactory repositories</a>.</p>
<p>We used the metadata to access the internal GCP repositories and downloaded images that we didn’t have permissions for with our original service account. Although we gained access to restricted internal GCP repositories, we could not understand the extent of the vulnerability that we discovered, since permissions on the repository are granted at the repository level.</p>
<p>This is a classic privilege escalation that with the single permission of <span style="font-family: 'courier new', courier, monospace;">aiplatform.customJobs.create</span> gives us the ability to access additional resources in the origin project. This is the first vulnerability we found in the Vertex AI platform. Figure 5 presents a flow diagram on privilege escalation through exploiting this vulnerability with custom jobs.</p>
<figure id="attachment_137376" aria-describedby="caption-attachment-137376" style="width: 900px" class="wp-caption alignnone"><img  class="wp-image-137376 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-765149-137365-5.jpeg" alt="Flowchart showing a data processing pipeline for a project. It includes steps labeled 'Customer GCP Source Project,' 'Pipeline Job,' 'Custom Job,' 'Fine-tuned AI Model,' and 'Prediction Server.' Each step is connected sequentially with arrows indicating the flow of data processing from left to right. " width="900" height="271" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-765149-137365-5.jpeg 1400w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-765149-137365-5-786x237.jpeg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-765149-137365-5-768x231.jpeg 768w" sizes="(max-width: 900px) 100vw, 900px" /><figcaption id="caption-attachment-137376" class="wp-caption-text">Figure 5. Flow diagram for privilege escalation through custom jobs.</figcaption></figure>
<h2><a id="post-137365-_patolwe204ea"></a>Model Exfiltration Attack via Malicious Model Deployment</h2>
<p>This section explores the second vulnerability we discovered in Vertex AI. We demonstrate how deploying a malicious model could lead to severe consequences, including the exfiltration of other models within the environment.</p>
<p>Imagine a malicious actor uploading a poisoned model to a public model repository. Unaware of the threat, a data scientist within your organization imports and deploys this model in Vertex AI. Once deployed, the malicious model can exfiltrate every other ML and LLM model in the project, including sensitive fine-tuned models, putting your organization’s most critical assets at risk.</p>
<p>We enacted this scenario by deploying a poisoned model in a Vertex AI environment we deployed for testing. During our test, we gained access to the <span style="font-family: 'courier new', courier, monospace;">custom-online-prediction</span> service account, allowing us to view and steal other AI and ML models from our test project.</p>
<h3><a id="post-137365-_jhgbklfyxcdr"></a>Attack Flow of the Model Exfiltration Attack</h3>
<p>The attack flow consists of two steps. First, we deployed a poisoned model in a tenant project, which gave us access to restricted GCP repositories and sensitive model data. In the second step, we used the poisoned model to exfiltrate proprietary AI models, including fine-tuned LLM adapters.</p>
<h3><a id="post-137365-_imipfkdhgy9z"></a>Delving Deeper: Preparing a Malicious Vertex Model</h3>
<p>Before we dive into preparing a model and discussing vertex platforms, let's cover some basics in Vertex.</p>
<p>In our <a href="#post-137365-_hoi3bh461eiw">previous section</a> discussing ​​model tuning with Vertex AI Pipelines, we outlined the flow of tuning a model. To create a malicious model, we start with an “innocent” model. When we finish the training process, we will see the new model in the <a href="https://cloud.google.com/vertex-ai/docs/model-registry/introduction" target="_blank" rel="noopener">Vertex AI Model Registry</a>.</p>
<p>The Vertex AI Model Registry contains all the imported or trained models. This allows several functions in the GCP console, such as deploying to an endpoint. Figure 6 shows that one of these functions is an export feature to export the model to a storage bucket.</p>
<figure id="attachment_137378" aria-describedby="caption-attachment-137378" style="width: 762px" class="wp-caption alignnone"><img  class="wp-image-137378 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-767916-137365-6.png" alt="Screenshot of a computer interface titled 'fraud-dataset', showing tabs like VIEW DATASET and EXPORT. Below, EVALUATE, DEPLOY &amp; TEST, BATCH PREDICT, VERSION DETAILS, LINEAGE are equally listed. It displays a section titled 'Pointwise evaluations' with a list of evaluations including one named 'untitled_266311820116622245' marked as 'Succeeded' created on December 8, 2023." width="762" height="328" /><figcaption id="caption-attachment-137378" class="wp-caption-text">Figure 6. Screenshot of GCP console showing option to export a Vertex AI model.</figcaption></figure>
<p>Exporting the model shown in Figure 6 reveals the model is built from <a href="https://cloud.google.com/vertex-ai/docs/vector-search/overview#terminology" target="_blank" rel="noopener">vectors</a> and runs a specified image. Below, Figure 7 identifies the specific image of the exported model in the <span style="font-family: 'courier new', courier, monospace;">environment.json</span> file.</p>
<figure id="attachment_137437" aria-describedby="caption-attachment-137437" style="width: 786px" class="wp-caption alignnone"><img  class="wp-image-137437 size-medium lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_7-786x360.png" alt="Two stacked screenshots displaying a directory structure and code file names in Visual Studio Code editor, involving files like &quot;saved_model.pb,&quot; &quot;variables.data-00000-of-00001,&quot; and &quot;environment.json&quot; in a development environment setup." width="786" height="360" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_7-786x360.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_7-1528x700.png 1528w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_7-768x352.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_7-1536x704.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_7.png 1956w" sizes="(max-width: 786px) 100vw, 786px" /><figcaption id="caption-attachment-137437" class="wp-caption-text">Figure 7. Exported model file structure and <span style="font-family: 'courier new', courier, monospace;">environment.json</span> file content.</figcaption></figure>
<p>By altering the image in the model, we could customize it to create a reverse shell, then we imported our new modified model to the model registry. Deploying this altered model to an endpoint will trigger the reverse shell, allowing us to navigate the tenant project of our test environment.</p>
<p>After gaining a shell, we found that we were operating as the <span style="font-family: 'courier new', courier, monospace;">custom-online-prediction</span> service-account in this environment, as shown below in Figure 8.</p>
<figure id="attachment_137382" aria-describedby="caption-attachment-137382" style="width: 558px" class="wp-caption alignnone"><img  class="wp-image-137382 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-773025-137365-8.png" alt="Screenshot showing a list of active Google Cloud authenticated accounts, with one account listed." width="558" height="84" /><figcaption id="caption-attachment-137382" class="wp-caption-text">Figure 8. The <span style="font-family: 'courier new', courier, monospace;">custom-online-prediction</span> service-account attached to the machine, gathered from the gcloud API.</figcaption></figure>
<p>Using this method, we did not have permission to use <span style="font-family: 'courier new', courier, monospace;">cloudresourcemanager.projects.getIamPolicy</span>, so we could not list our permissions in the tenant project. However, we could use <span style="font-family: 'courier new', courier, monospace;">cloudresourcemanager.projects.testIamPermissions</span> to enumerate our permissions in the tenant project. Although the permissions of this service account are read-only, this level of access can yield significant power with just a bit of imagination, as we will illustrate.</p>
<p>Figure 9 shows the results from listing all the resources in this project, enumerating three Kubernetes clusters.</p>
<figure id="attachment_137384" aria-describedby="caption-attachment-137384" style="width: 900px" class="wp-caption alignnone"><img  class="wp-image-137384 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-775367-137365-9.png" alt="Screenshot of gcloud container cluster lists including location, IP addresses, machine type and more." width="900" height="94" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-775367-137365-9.png 1008w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-775367-137365-9-786x82.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-775367-137365-9-768x80.png 768w" sizes="(max-width: 900px) 100vw, 900px" /><figcaption id="caption-attachment-137384" class="wp-caption-text">Figure 9. Cluster enumeration for prediction tenant project.</figcaption></figure>
<p>Of the three Kubernetes clusters in this project, our malicious model runs on the third cluster, which is a deployment process for an endpoint. We will review the first two clusters later, but for now, let's examine the third.</p>
<p>To run <a href="https://kubernetes.io/docs/reference/kubectl/" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">kubectl</span></a> commands on these clusters to retrieve information on pods and namespaces, we needed appropriate privileges. We achieved this by executing the <span style="font-family: 'courier new', courier, monospace;">get-cluster-credentials</span> command in GCP, using the name of the cluster that we gathered in the previous enumeration step from Figure 9. Figure 10 below shows the results.</p>
<figure id="attachment_137386" aria-describedby="caption-attachment-137386" style="width: 772px" class="wp-caption alignnone"><img  class="wp-image-137386 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-777859-137365-10.png" alt="A screenshot of a few lines of code in a terminal window. White text on a black background. " width="772" height="49" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-777859-137365-10.png 772w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-777859-137365-10-768x49.png 768w" sizes="(max-width: 772px) 100vw, 772px" /><figcaption id="caption-attachment-137386" class="wp-caption-text">Figure 10. Fetching credentials for a running cluster.</figcaption></figure>
<p>With these credentials, we could use kubectl to explore the cluster, listing namespaces, pods, containers and service accounts. This step enabled us to move from the GCP realm into Kubernetes. This lateral movement was possible because permissions between GCP and GKE were linked through <a href="https://cloud.google.com/kubernetes-engine/docs/concepts/workload-identity" target="_blank" rel="noopener">IAM Workload Identity Federation</a>.</p>
<p>We found ourselves operating within a newly created cluster, where our namespace name was <span style="font-family: 'courier new', courier, monospace;">prediction</span> as shown below in Figure 11.</p>
<figure id="attachment_137388" aria-describedby="caption-attachment-137388" style="width: 500px" class="wp-caption alignnone"><img  class="wp-image-137388 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-780525-137365-11.png" alt="A screenshot of a computer terminal displaying a list of namespaces in Kubernetes with their status and age. Namespaces listed include ai-connector-system, argo-system, default, gmp-public, istio-system, kube-node-lease, kube-public, prediction, vertex-logging, and vertex-metrics, all marked as active." width="500" height="334" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-780525-137365-11.png 1364w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-780525-137365-11-658x440.png 658w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-780525-137365-11-1047x700.png 1047w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-780525-137365-11-768x514.png 768w" sizes="(max-width: 500px) 100vw, 500px" /><figcaption id="caption-attachment-137388" class="wp-caption-text">Figure 11. List of namespaces gathered using the <span style="font-family: 'courier new', courier, monospace;">kubectl</span> command that includes our newly created cluster.</figcaption></figure>
<p>Returning to GCP, we listed the service accounts. By analyzing the IAM permissions of the GCP service account, we noticed the Kubernetes service accounts attached to it. Figure 12 shows this list revealing the service account for our newly created <span style="font-family: 'courier new', courier, monospace;">prediction</span> cluster.</p>
<figure id="attachment_137448" aria-describedby="caption-attachment-137448" style="width: 786px" class="wp-caption alignnone"><img  class="wp-image-137448 size-medium lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/f12-786x131.png" alt="Image showing a list of account details with various names and statuses in white text on a black background. One line is highlighted in red." width="786" height="131" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/f12-786x131.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/f12-1920x319.png 1920w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/f12-768x128.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/f12-1536x255.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/f12-2048x340.png 2048w" sizes="(max-width: 786px) 100vw, 786px" /><figcaption id="caption-attachment-137448" class="wp-caption-text">Figure 12. List of service accounts in the prediction tenant project.</figcaption></figure>
<p>In the default namespace of our cluster, only the default service account was present. However, based on the information we gathered, we inferred that our GCP service account had access to other Kubernetes clusters as well. By inspecting the pod details and examining the images, we confirmed that we were running inside a container within a pod in the prediction namespace, most likely in the context of <span style="font-family: 'courier new', courier, monospace;">prediction/default-serving</span>. Figure 13 below illustrates this.</p>
<figure id="attachment_137392" aria-describedby="caption-attachment-137392" style="width: 900px" class="wp-caption alignnone"><img  class="wp-image-137392 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-786447-137365-13.png" alt="Screenshot of a computer screen displaying lines of code related to Google Cloud services, with a specific focus on a section highlighted in red." width="900" height="157" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-786447-137365-13.png 2048w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-786447-137365-13-786x137.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-786447-137365-13-1920x336.png 1920w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-786447-137365-13-768x134.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-786447-137365-13-1536x269.png 1536w" sizes="(max-width: 900px) 100vw, 900px" /><figcaption id="caption-attachment-137392" class="wp-caption-text">Figure 13. The permission binding of the <span style="font-family: 'courier new', courier, monospace;">custom-online-prediction</span> GCP service account and Kubernetes service accounts.</figcaption></figure>
<p>Now that we had determined our identity, the next question was to determine what we could do.</p>
<p>We tried to create, delete, update, attach, execute and more, but we failed with no permissions. However, we could enumerate all the clusters, which gave us a great deal of information and increased our playground to try more attack vectors.</p>
<p>With our read-only permissions, we could list the pods in our newly created <span style="font-family: 'courier new', courier, monospace;">prediction</span> cluster using the <span style="font-family: 'courier new', courier, monospace;">list pods</span> command. Figure 14 shows two specific entries from this output.</p>
<figure id="attachment_137394" aria-describedby="caption-attachment-137394" style="width: 900px" class="wp-caption alignnone"><img  class="wp-image-137394 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-789550-137365-14.png" alt="Image displaying code snippets with JSON format data, includes references to image resources hosted on cloud servers." width="900" height="218" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-789550-137365-14.png 2048w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-789550-137365-14-786x191.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-789550-137365-14-1920x466.png 1920w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-789550-137365-14-768x186.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-789550-137365-14-1536x373.png 1536w" sizes="(max-width: 900px) 100vw, 900px" /><figcaption id="caption-attachment-137394" class="wp-caption-text">Figure 14. Two entries from the JSON output of <span style="font-family: 'courier new', courier, monospace;">list pods</span> command.</figcaption></figure>
<p>Figure 14 shows the following two pods in our prediction namespace:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">predictor-resource-pool-3882551479537500160-867655f99c-2dhhc</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">predictor-resource-pool-7628701944579620864-ccc8d8b94-f2chw</span></li>
</ul>
<p>Both pods have containers using images from a repository located in our tenant project. Those images are:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">us-central1-docker.pkg.dev/s154574aecb0c9653-tp/dm-2118255330398830592-pipeline-6604364906047209472/lala:latest</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">us-central1-docker.pkg.dev/s154574aecb0c9653-tp/dm-1402464464623632384-pipeline-1229318750780522496/lala:latest</span></li>
</ul>
<p>Each of the two image entries above show <span style="font-family: 'courier new', courier, monospace;">lala:latest</span> at the end of each name, indicating these are our own malicious images. It’s worth noting, our malicious images were stored in different repositories, representing distinct versions of the same image.</p>
<p>For each new deployment, GCP automatically uploads the image into a dedicated repository within the tenant project. Although we were running in the context of our own deployment (<span style="font-family: 'courier new', courier, monospace;">dm-2118255330398830592-pipeline-6604364906047209472</span>), we now had visibility into other deployments that existed within the cluster.</p>
<h4><a id="post-137365-_lyjawmpz8m9r"></a>Extracting the Model Images</h4>
<p>While we could view our newly created image within the Kubernetes cluster, the question remained, could we extract or pull it? We had confirmed the image's existence by inspecting it in the Kubernetes context. However, to retrieve more detailed information about the image, we used GCP commands to describe it as shown below in Figure 15.</p>
<figure id="attachment_137439" aria-describedby="caption-attachment-137439" style="width: 786px" class="wp-caption alignnone"><img  class="wp-image-137439 size-medium lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_15-786x89.png" alt="Screenshot of a code snippet displaying a URL address along with other code content, highlighted to show a specific segment focusing on a token parameter." width="786" height="89" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_15-786x89.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_15-1920x218.png 1920w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_15-768x87.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_15-1536x175.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_15.png 1952w" sizes="(max-width: 786px) 100vw, 786px" /><figcaption id="caption-attachment-137439" class="wp-caption-text">Figure 15. Describe the image in GCP to extract the digest.</figcaption></figure>
<p>This step revealed a critical piece of information. While the image name ends with <span style="font-family: 'courier new', courier, monospace;">lala:latest</span>, we could not successfully use the string <span style="font-family: 'courier new', courier, monospace;">latest</span> in our command because that is not a valid version identifier. Instead, our attempt returned the <a href="https://cloud.google.com/kubernetes-engine/docs/concepts/about-container-images" target="_blank" rel="noopener">image digest</a>, which serves as a unique identifier for the image version.</p>
<p>With the digest, we could theoretically pull the image, but the process wasn’t straightforward. We lacked the permissions to create a new container, and since the Docker socket wasn’t mounted to our container, we could not use Docker to pull the images.</p>
<p>Instead, we used <span style="font-family: 'courier new', courier, monospace;">crictl</span>, a lightweight container runtime interface (CRI) tool combined with our GCP service account authentication token. This allowed us to pull images from outside the container using the permissions of the <span style="font-family: 'courier new', courier, monospace;">online-prediction</span> service account.</p>
<p>By setting the authentication token of the <span style="font-family: 'courier new', courier, monospace;">online-prediction</span> service account as an environment variable, we were able to pull the images using the commands shown in Figure 16.</p>
<figure id="attachment_137398" aria-describedby="caption-attachment-137398" style="width: 900px" class="wp-caption alignnone"><img  class="wp-image-137398 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-795693-137365-16.png" alt="Text showing commands entered in a terminal for pulling Docker images using Credential ID with specific pipeline numbers and alphanumeric codes." width="900" height="261" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-795693-137365-16.png 1788w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-795693-137365-16-786x228.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-795693-137365-16-768x222.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-795693-137365-16-1536x445.png 1536w" sizes="(max-width: 900px) 100vw, 900px" /><figcaption id="caption-attachment-137398" class="wp-caption-text">Figure 16. Using <span style="font-family: 'courier new', courier, monospace;">crictl</span> commands to pull the images.</figcaption></figure>
<p>After pulling these images, we could list the results as shown below in Figure 17.</p>
<figure id="attachment_137443" aria-describedby="caption-attachment-137443" style="width: 786px" class="wp-caption alignnone"><img  class="wp-image-137443 size-medium lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_17_-1-786x116.png" alt="A screenshot displaying multiple lines of computer code with URLs." width="786" height="116" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_17_-1-786x116.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_17_-1-1920x284.png 1920w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_17_-1-768x114.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_17_-1-1536x227.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_17_-1-2048x303.png 2048w" sizes="(max-width: 786px) 100vw, 786px" /><figcaption id="caption-attachment-137443" class="wp-caption-text">Figure 17. The model images after being pulled to a remote environment.</figcaption></figure>
<p>Once pulled, we exported the images into <span style="font-family: 'courier new', courier, monospace;">.tar</span> files using <span style="font-family: 'courier new', courier, monospace;"><a href="https://labs.iximiuz.com/courses/containerd-cli/ctr/image-management#what-is-ctr" target="_blank" rel="noopener">ctr</a></span>, allowing us to move and load them elsewhere.</p>
<h3><a id="post-137365-_yrr7g3onkbru"></a>Switching Context: Exploring Other Clusters</h3>
<p>Now that we had gathered information from the first cluster, it was time to explore the other clusters we had discovered earlier. Since we had access to the <span style="font-family: 'courier new', courier, monospace;">get-cluster-credentials</span> command and our GCP service account was bound to the clusters via IAM Workload Identity Federation, we switched context to cluster 2 as shown below in Figure 18.</p>
<figure id="attachment_137402" aria-describedby="caption-attachment-137402" style="width: 900px" class="wp-caption alignnone"><img  class="wp-image-137402 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-801482-137365-18.png" alt="A screenshot of three sections of code, all white text on a black background. They are grouped from left to right as Name, Cluster and AUTHINFO. " width="900" height="83" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-801482-137365-18.png 1133w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-801482-137365-18-786x73.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-801482-137365-18-768x71.png 768w" sizes="(max-width: 900px) 100vw, 900px" /><figcaption id="caption-attachment-137402" class="wp-caption-text">Figure 18. Kubectl <span style="font-family: 'courier new', courier, monospace;">get-context</span> command.</figcaption></figure>
<p>Now we are operating in the context of cluster 2. Figure 19 shows the cluster 2 namespaces.</p>
<figure id="attachment_137404" aria-describedby="caption-attachment-137404" style="width: 225px" class="wp-caption alignnone"><img  class="wp-image-137404 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-804073-137365-19.png" alt="Terminal screen displaying output from the command 'kubectl get namespaces', showing namespaces named custom, gmp-public, gmp-system, kube-node-lease, and kube-system among others, all listed as Active and having an age of 85d." width="225" height="175" /><figcaption id="caption-attachment-137404" class="wp-caption-text">Figure 19. Cluster 2 namespaces.</figcaption></figure>
<p>In this cluster, the <span style="font-family: 'courier new', courier, monospace;">prediction</span> namespace was no longer present. We began by enumerating the pods and containers. Much of the cluster was composed of default Kubernetes resources, and we found images with <span style="font-family: 'courier new', courier, monospace;">prediction-server</span> in the name stored in our tenant project’s repository, like Figure 20 shows:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">us-central1-docker.pkg.dev/s154574aecb0c9653-tp/ucaip-deployed-model-1558744649349201920/prediction-server:20231117_1325</span></li>
</ul>
<figure id="attachment_137406" aria-describedby="caption-attachment-137406" style="width: 900px" class="wp-caption alignnone"><img  class="wp-image-137406 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-806704-137365-20.png" alt="Text highlighted in red indicating the prediction server. " width="900" height="46" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-806704-137365-20.png 1564w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-806704-137365-20-786x40.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-806704-137365-20-768x39.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-806704-137365-20-1536x79.png 1536w" sizes="(max-width: 900px) 100vw, 900px" /><figcaption id="caption-attachment-137406" class="wp-caption-text">Figure 20. The <span style="font-family: 'courier new', courier, monospace;">prediction</span> server (model endpoint) deployed to cluster 2.</figcaption></figure>
<p>In cluster 2, we identified one such image. Pivoting on that, we found two additional images in cluster 1 with the same production-server string in the name:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">us-central1-docker.pkg.dev/s154574aecb0c9653-tp/ucaip-deployed-model-1932543418420953088/prediction-server:20231117_1325</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">us-central1-docker.pkg.dev/s154574aecb0c9653-tp/ucaip-deployed-model-6762636426589765632/prediction-server:20231117_1325</span></li>
</ul>
<p>These images represent other deployments that other teams created in our project<strong>. </strong>Surprisingly with the same method previously described, we could download those images from other clusters. In fact, we had access to download images of all deployed models in the project.</p>
<h3><a id="post-137365-_wpcspl4holgk"></a>Vertex AI Fine-Tuned Adapter Layer Extraction</h3>
<p>As the above method was effective for ML model images, we also wanted to access LLM-based Vertex AI models. While ML models can be exported from GCP as we just demonstrated, LLM models have more restrictions in GCP. For example, Figure 21 shows a screenshot of a GCP panel with an LLM model where the export function is grayed out.</p>
<figure id="attachment_137408" aria-describedby="caption-attachment-137408" style="width: 900px" class="wp-caption alignnone"><img  class="wp-image-137408 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-809506-137365-21.png" alt="Screenshot of a web interface showing details of a model named 'food-3' in a platform, with the creation time, model ID, region, and encryption status displayed. The interface includes tabs such as Evaluate, Deploy &amp; Test, Batch Predict, and Version Details. A red arrow points to EXPORT. " width="900" height="641" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-809506-137365-21.png 1154w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-809506-137365-21-618x440.png 618w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-809506-137365-21-983x700.png 983w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-809506-137365-21-768x547.png 768w" sizes="(max-width: 900px) 100vw, 900px" /><figcaption id="caption-attachment-137408" class="wp-caption-text">Figure 21. An example for a tuned LLM model where the export function is grayed out.</figcaption></figure>
<p>When creating a fine-tuned LLM model, GCP adds a fine-tuning layer called an adapter. This adapter layer is the additional weights created by the fine-tuning data.</p>
<p>By listing all the buckets in our tenant project, we discovered that all deployed models were uploaded there. Since our GCP service account had viewer permissions, not only could we list these buckets, but we could copy them. Within the buckets, we uncovered a directory structure resembling that of ML models. Figures 22 and 23 show that these bucket identifiers all start with the string <span style="font-family: 'courier new', courier, monospace;">caip</span>.</p>
<figure id="attachment_137410" aria-describedby="caption-attachment-137410" style="width: 469px" class="wp-caption alignnone"><img  class="wp-image-137410 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-812391-137365-22.png" alt="Screenshot of a computer screen displaying a directory structure in a command-line interface. The structure includes various files and folders, such as assets, variables, and models, related to predictive data analytics, within the Azure cloud computing service." width="469" height="134" /><figcaption id="caption-attachment-137410" class="wp-caption-text">Figure 22. List of Cloud Storage buckets in the <span style="font-family: 'courier new', courier, monospace;">prediction</span> tenant project.</figcaption></figure>
<figure id="attachment_137412" aria-describedby="caption-attachment-137412" style="width: 900px" class="wp-caption alignnone"><img  class="wp-image-137412 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-814864-137365-23.png" alt="Computer screen displaying a directory structure with various files and folders. The files are organized hierarchically, typical in software development environments. Some lines are underlined in red. " width="900" height="515" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-814864-137365-23.png 1012w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-814864-137365-23-769x440.png 769w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-814864-137365-23-768x439.png 768w" sizes="(max-width: 900px) 100vw, 900px" /><figcaption id="caption-attachment-137412" class="wp-caption-text">Figure 23. Directory structure of the <span style="font-family: 'courier new', courier, monospace;">caip</span> Cloud Storage buckets pulled to a local environment.</figcaption></figure>
<p>Figure 23 highlights two strings of numbers in the bucket path that act as a deployed model ID for each bucket. We could use this information to trace these buckets back to the original model ID in our source project model registry.</p>
<p>Using the first example in Figure 23 of <span style="font-family: 'courier new', courier, monospace;">3091243956143390720</span>, we traced this bucket back to our source project model registry as illustrated below in Figures 24, 25 and 26.</p>
<p>In Figure 24, our search revealed an endpoint with the same ID string as the deployed model ID from the first bucket listed in Figure 23. Directly below that is an associated model ID.</p>
<figure id="attachment_137414" aria-describedby="caption-attachment-137414" style="width: 709px" class="wp-caption alignnone"><img  class="wp-image-137414 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-817493-137365-24.png" alt="Screenshot of a computer interface displaying information about a deployed machine learning model, including various technical details like model IDs, machine types, endpoints, and deployment status. The background is black. The deployed Model ID and the Model ID are highlighted by red arrows. " width="709" height="449" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-817493-137365-24.png 709w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-817493-137365-24-695x440.png 695w" sizes="(max-width: 709px) 100vw, 709px" /><figcaption id="caption-attachment-137414" class="wp-caption-text">Figure 24. Finding an endpoint with the same ID string as the first deployed model ID in Figure 23.</figcaption></figure>
<p>In Figure 25, we pivot on that same deployed model ID to find yet another associated model ID.</p>
<figure id="attachment_137416" aria-describedby="caption-attachment-137416" style="width: 900px" class="wp-caption alignnone"><img  class="wp-image-137416 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-819978-137365-25.png" alt="Screenshot of a computer interface displaying information about a deployed machine learning model, including various technical details like model IDs, machine types, endpoints, and deployment status. The background is black. The deployed Model ID and the Model ID are highlighted by red arrows. " width="900" height="517" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-819978-137365-25.png 1476w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-819978-137365-25-766x440.png 766w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-819978-137365-25-1218x700.png 1218w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-819978-137365-25-768x441.png 768w" sizes="(max-width: 900px) 100vw, 900px" /><figcaption id="caption-attachment-137416" class="wp-caption-text">Figure 25. Pivoting on the same deployed model ID to find another associated model ID.</figcaption></figure>
<p>Figure 26 shows these same associated model IDs were present when we checked our source project.</p>
<figure id="attachment_137418" aria-describedby="caption-attachment-137418" style="width: 537px" class="wp-caption alignnone"><img  class="wp-image-137418 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-823452-137365-26.png" alt="A computer screen displaying a list of model names and IDs in a command line interface, featuring names such as &quot;cmb-final-down&quot;, &quot;rcme-ll-model-server-ai&quot;, and &quot;final-turnado-stage&quot;. Two lines are highlighted in red boxes. " width="537" height="326" /><figcaption id="caption-attachment-137418" class="wp-caption-text">Figure 26. The model IDs in the source project.</figcaption></figure>
<h2><a id="post-137365-_tber557evgdv"></a>Impact</h2>
<p>We found out that we had all the ML models that have been deployed to endpoints. So at the beginning, we had all the images of the models, and now we also had all the ML models.</p>
<p>Even more alarmingly, we discovered adapter files within these buckets as Figure 27 below shows. These adapter files are critical components of the fine-tuning process for LLM models, and they contain the weights that directly alter the behavior of the base model.</p>
<p>Although the name of the example in Figure 27 is <span style="font-family: 'courier new', courier, monospace;">adapter.txt</span>, the content is not readable text. However, the content of these adapter files contains weights representing highly sensitive, proprietary data, which makes them an invaluable target for attackers.</p>
<figure id="attachment_137445" aria-describedby="caption-attachment-137445" style="width: 786px" class="wp-caption alignnone"><img  class="size-medium wp-image-137445 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_27-786x115.png" alt="Screenshot showing a selected file named in a directory listing within a software interface." width="786" height="115" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_27-786x115.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_27-1920x282.png 1920w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_27-768x113.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_27-1536x225.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/Figure_27-2048x301.png 2048w" sizes="(max-width: 786px) 100vw, 786px" /><figcaption id="caption-attachment-137445" class="wp-caption-text">Figure 27. Example of an adapter file for a fine-tuned LLM from an exported bucket.</figcaption></figure>
<p>In summary, by deploying a malicious model, we were able to access resources in the tenant projects that allowed us to view and export all models deployed across the project. This includes both ML and LLM models, along with their fine-tuned adapters.</p>
<p>This method presents a clear risk for a model-to-model infection scenario. For example, your team could unknowingly deploy a malicious model uploaded to a public repository. Once active, it could exfiltrate all ML and fine-tuned LLM models in the project, putting your most sensitive assets at risk.</p>
<p>The flow diagram in Figure 28 shows an example of this model infection attack using the following steps:</p>
<ol>
<li>Poisoned model is prepared and uploaded to a public repository</li>
<li>Data engineer downloads and imports the model</li>
<li>The model is deployed, granting access to the attacker</li>
<li>The attacker downloads the model images</li>
<li>The attacker downloads the trained models and LLM adapter layers</li>
</ol>
<figure id="attachment_137422" aria-describedby="caption-attachment-137422" style="width: 900px" class="wp-caption alignnone"><img  class="wp-image-137422 lozad"  data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-828345-137365-28.jpeg" alt="Attack chain diagram. From a public repository, the malicious model is imported into the GCP Vertex AI platform where the model is then deployed. " width="900" height="573" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-828345-137365-28.jpeg 1155w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-828345-137365-28-691x440.jpeg 691w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-828345-137365-28-1100x700.jpeg 1100w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/11/word-image-828345-137365-28-768x489.jpeg 768w" sizes="(max-width: 900px) 100vw, 900px" /><figcaption id="caption-attachment-137422" class="wp-caption-text">Figure 28. Poisoned model leads to intellectual property exfiltration.</figcaption></figure>
<h2><a id="post-137365-_kg00bzx5l2sj"></a><strong>Conclusion</strong></h2>
<p>This research highlights how a single malicious model deployment could compromise an entire AI environment. An attacker could use even one unverified model deployed on a production system to exfiltrate sensitive data, leading to severe model exfiltration attacks.</p>
<p>The permissions required to deploy a model might seem harmless, but in reality, that single permission could grant access to all other models in a vulnerable project. Only a very few individuals should have the permission to deploy new models in a project containing sensitive or production models without strict oversight.</p>
<p>To protect against such risks, we must implement strict controls on model deployments. A fundamental security practice is to ensure an organization's development or test environments are separate from its live production environment. This separation reduces the risk of an attacker accessing potentially insecure models before they are fully vetted. Whether it comes from an internal team or a third-party repository, validating every model before deployment is vital.</p>
<p>This highlights the critical need for <a href="https://www.paloaltonetworks.com/prisma/cloud/ai-spm" target="_blank" rel="noopener">Prisma Cloud AI Security Posture Management</a> (AI-SPM) to help ensure robust oversight of AI pipelines.</p>
<p>If you think you may have been compromised or have an urgent matter, get in touch with the<a href="https://start.paloaltonetworks.com/contact-unit42.html" target="_blank" rel="noopener"> Unit 42 Incident Response team</a> or call:</p>
<ul>
<li>North America Toll-Free: 866.486.4842 (866.4.UNIT42)</li>
<li>EMEA: +31.20.299.3130</li>
<li>APAC: +65.6983.8730</li>
<li>Japan: +81.50.1790.0200</li>
</ul>
<p>Palo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about the <a href="https://www.cyberthreatalliance.org" target="_blank" rel="noopener">Cyber Threat Alliance</a>.</p>
      
              </div>
              <!--<span class="post__date">Updated 13 November, 2024 at 6:29 AM PST</span>-->
              <button class="l-btn back-to-top" id="backToTop" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:back to top">Back to top</button>
              
			<div class="be__tags-wrapper"> 
				<h3>Tags</h3><ul role="list"><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/data-exfiltration/" role="link" title="data exfiltration" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:tags:data exfiltration">Data exfiltration</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/google-cloud/" role="link" title="Google Cloud" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:tags:Google Cloud">Google Cloud</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/kubernetes/" role="link" title="Kubernetes" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:tags:Kubernetes">Kubernetes</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/llm/" role="link" title="LLM" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:tags:LLM">LLM</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/poisoned-model/" role="link" title="poisoned model" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:tags:poisoned model">Poisoned model</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/privilege-escalation/" role="link" title="privilege escalation" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:tags:privilege escalation">Privilege escalation</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/vertex-ai/" role="link" title="Vertex AI" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:tags:Vertex AI">Vertex AI</a></li></ul>
			</div> 
              <div class="be__post-nav">
    <a class="prev" href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:article-nav:Threat Research Center"> 
        <span>Threat Research Center</span>
    </a>
            <a class="next" href="https://unit42.paloaltonetworks.com/silent-skimmer-latest-campaign/" role="link" title="Silent Skimmer Gets Loud (Again)" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:article-nav:Silent Skimmer Gets Loud (Again)"> 
            <span>Next: Silent Skimmer Gets Loud (Again)</span>
        </a>
    </div>
 
            </div>
            <div class="be__nav">
            <div class="be__nav-wrapper">
      <div class="be-table-of-contents" data-toc-track="privilege-escalation-llm-model-exfil-vertex-ai:sidebar:table-of-contents">
      <div class="be-title__wrapper">
        <h3>Table of Contents</h3>
      </div> 
            <ul>
        <li></li>
      </ul>
    </div>
   
        <div class="be-related-articles">
        <h3>Related Articles</h3>
        <ul> 
                        <li>
                  <a href="https://unit42.paloaltonetworks.com/edr-bypass-extortion-attempt-thwarted/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:sidebar:related-articles:TA Phone Home: EDR Evasion Testing Reveals Extortion Actor&#039;s Toolkit">
                      TA Phone Home: EDR Evasion Testing Reveals Extortion Actor&#039;s Toolkit                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/jailbreak-llms-through-camouflage-distraction/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:sidebar:related-articles:Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction">
                      Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/prepare-for-emerging-ai-risks-unit-42-threat-frontier/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:sidebar:related-articles:Unit 42 Looks Toward the Threat Frontier: Preparing for Emerging AI Risks">
                      Unit 42 Looks Toward the Threat Frontier: Preparing for Emerging AI Risks                  </a>
              </li>
                      </ul>
      </div>
      </div> 
            </div>
          </div>
        </div>
          <div class="pa related-threat">
    <div class="l-container">
            <h2>Related Cloud Cybersecurity Research Resources</h2>
      <div class="blog-slider" id="blogSlider"> 
                              <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Ransomware_Category_1920x900-786x368.jpg" class="lozad" alt="A pictorial representation of ShinyHunters ransomware. An image showing a laptop with security and financial graphics displayed on the screen, surrounded by stacks of coins and a credit card, set against a dark background illuminated by neon lights." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Ransomware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Ransomware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Ransomware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Ransomware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Ransomware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware:Threat Actor Groups"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                        <span class="post-pub-date"><time datetime="2024-08-23T10:00:21+00:00">August 23, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/shinyhunters-ransomware-extortion/" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware">
                    <h4 class="post-title">Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/mitre/" title="MITRE" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware:MITRE">MITRE</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/extortion/" title="Extortion" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware:Extortion">Extortion</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/container/" title="Container" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware:Container">Container</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/shinyhunters-ransomware-extortion/" title="Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Bling Libra’s Tactical Evolution: The Threat Actor Group Behind ShinyHunters Ransomware:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/02_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg" class="lozad" alt="Pictorial representation of an extortion operation in the cloud. Vibrant digital artwork depicting a futuristic cityscape with glowing neon roads weaving through clouds, set against a backdrop of skyscrapers and a vivid sky." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/02_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/02_Cloud_cybersecurity_research_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/02_Cloud_cybersecurity_research_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/02_Cloud_cybersecurity_research_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/02_Cloud_cybersecurity_research_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-08-15T10:00:09+00:00">August 15, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments">
                    <h4 class="post-title">Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/credential-theft/" title="credential theft" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments:credential theft">Credential theft</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/extortion/" title="Extortion" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments:Extortion">Extortion</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/mitre/" title="MITRE" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments:MITRE">MITRE</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/large-scale-cloud-extortion-operation/" title="Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Leaked Environment Variables Allow Large-Scale Extortion Operation in Cloud Environments:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Security-Technology_Category_1920x900-786x368.jpg" class="lozad" alt="A pictorial representation of compromised GitHub repositories. A woman focuses intently on a computer in front of her. Overlaid across the screen are lines of code, suggesting a security technology focus." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-08-13T10:00:36+00:00">August 13, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/github-repo-artifacts-leak-tokens/" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts">
                    <h4 class="post-title">ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/artifacts/" title="artifacts" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts:artifacts">Artifacts</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/aws/" title="AWS" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts:AWS">AWS</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/github/" title="GitHub" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts:GitHub">GitHub</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/github-repo-artifacts-leak-tokens/" title="ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:ArtiPACKED: Hacking Giants Through a Race Condition in GitHub Actions Artifacts:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg" class="lozad" alt="Illustration of a futuristic city with glowing orange and blue lights, surrounded by clouds and digital elements, conveying a high-tech, cybernetic theme." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Cloud_cybersecurity_research_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Container Breakouts: Escape Techniques in Cloud Environments:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-07-18T10:00:41+00:00">July 18, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/container-escape-techniques/" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Container Breakouts: Escape Techniques in Cloud Environments">
                    <h4 class="post-title">Container Breakouts: Escape Techniques in Cloud Environments</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/containers/" title="Containers" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Container Breakouts: Escape Techniques in Cloud Environments:Containers">Containers</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/docker/" title="Docker" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Container Breakouts: Escape Techniques in Cloud Environments:Docker">Docker</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/container-escape/" title="container escape" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Container Breakouts: Escape Techniques in Cloud Environments:container escape">Container escape</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/container-escape-techniques/" title="Container Breakouts: Escape Techniques in Cloud Environments" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Container Breakouts: Escape Techniques in Cloud Environments:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Vulnerabilities_1920x900-786x368.jpg" class="lozad" alt="Abstract illustration of a network sppread like a spiderweb, connecting covering the globe and symbolizing data or communication links." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Vulnerabilities_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Vulnerabilities_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Vulnerabilities_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Vulnerabilities_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Vulnerabilities_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/top-cyberthreats/" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability:High Profile Threats"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/top-threats.svg" alt=" category icon">High Profile Threats</span></a>                        <span class="post-pub-date"><time datetime="2024-07-02T18:28:47+00:00">July 2, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/threat-brief-cve-2024-6387-openssh/" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability">
                    <h4 class="post-title">Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/openssh/" title="OpenSSH" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability:OpenSSH">OpenSSH</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/remote-code-execution/" title="Remote Code Execution" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability:Remote Code Execution">Remote Code Execution</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/ssh/" title="SSH" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability:SSH">SSH</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/threat-brief-cve-2024-6387-openssh/" title="Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42-cloud-attacks-786x368.jpg" class="lozad" alt="" decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42-cloud-attacks-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42-cloud-attacks-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42-cloud-attacks-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42-cloud-attacks-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42-cloud-attacks.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Attack Paths Into VMs in the Cloud:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-06-18T10:00:23+00:00">June 18, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Attack Paths Into VMs in the Cloud">
                    <h4 class="post-title">Attack Paths Into VMs in the Cloud</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/aws/" title="AWS" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Attack Paths Into VMs in the Cloud:AWS">AWS</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/iaas/" title="IaaS" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Attack Paths Into VMs in the Cloud:IaaS">IaaS</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/virtual-machines/" title="virtual machines" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Attack Paths Into VMs in the Cloud:virtual machines">Virtual machines</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/cloud-virtual-machine-attack-vectors/" title="Attack Paths Into VMs in the Cloud" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Attack Paths Into VMs in the Cloud:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg" class="lozad" alt="Futuristic illustration with glowing neon lights and advanced technology motifs, depicting cloud computing and data flow through interconnected networks. The scene is highlighted by hovering digital clouds and dynamic, illuminated linear structures, set in a dramatic, blue and orange color scheme." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Cloud_cybersecurity_research_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Cloud_cybersecurity_research_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Cloud_cybersecurity_research_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/03_Cloud_cybersecurity_research_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Muddled Libra’s Evolution to the Cloud:Threat Actor Groups"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                        <span class="post-pub-date"><time datetime="2024-04-09T18:00:08+00:00">April 9, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Muddled Libra’s Evolution to the Cloud">
                    <h4 class="post-title">Muddled Libra’s Evolution to the Cloud</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/microsoft-azure/" title="Microsoft Azure" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Muddled Libra’s Evolution to the Cloud:Microsoft Azure">Microsoft Azure</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/muddled-libra/" title="Muddled Libra" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Muddled Libra’s Evolution to the Cloud:Muddled Libra">Muddled Libra</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/muddled-libra-evolution-to-cloud/" title="Muddled Libra’s Evolution to the Cloud" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Muddled Libra’s Evolution to the Cloud:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/05_Vulnerabilities_1920x900-786x368.jpg" class="lozad" alt="Close-up side profile of a Black woman wearing glasses, focused intently on something out of frame." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/05_Vulnerabilities_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/05_Vulnerabilities_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/05_Vulnerabilities_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/05_Vulnerabilities_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/05_Vulnerabilities_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/top-cyberthreats/" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094):High Profile Threats"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/top-threats.svg" alt=" category icon">High Profile Threats</span></a>                        <span class="post-pub-date"><time datetime="2024-03-31T02:15:55+00:00">March 30, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/threat-brief-xz-utils-cve-2024-3094/" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094)">
                    <h4 class="post-title">Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094)</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/cve-2024-3094/" title="CVE-2024-3094" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094):CVE-2024-3094">CVE-2024-3094</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/linux/" title="Linux" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094):Linux">Linux</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/xz-utils/" title="XZ Utils" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094):XZ Utils">XZ Utils</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/threat-brief-xz-utils-cve-2024-3094/" title="Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094)" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Threat Brief: Vulnerability in XZ Utils Data Compression Library Impacting Multiple Linux Distributions (CVE-2024-3094):read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg" class="lozad" alt="Digital illustration of a cloud composed of binary code floating above a network of dynamic, glowing data streams, symbolizing cloud computing and data connectivity." decoding="async" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Cloud_cybersecurity_research_Overview_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Cloud_cybersecurity_research_Overview_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Cloud_cybersecurity_research_Overview_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Cloud_cybersecurity_research_Overview_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Cloud_cybersecurity_research_Overview_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Navigating the Cloud: Exploring Lateral Movement Techniques:Threat Research"><span class=""><img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                        <span class="post-pub-date"><time datetime="2024-02-28T11:00:52+00:00">February 28, 2024</time></span>
                  <a href="https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Navigating the Cloud: Exploring Lateral Movement Techniques">
                    <h4 class="post-title">Navigating the Cloud: Exploring Lateral Movement Techniques</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/aws/" title="AWS" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Navigating the Cloud: Exploring Lateral Movement Techniques:AWS">AWS</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/azure/" title="Azure" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Navigating the Cloud: Exploring Lateral Movement Techniques:Azure">Azure</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/containers/" title="Containers" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Navigating the Cloud: Exploring Lateral Movement Techniques:Containers">Containers</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/cloud-lateral-movement-techniques/" title="Navigating the Cloud: Exploring Lateral Movement Techniques" role="link" data-page-track="true" data-page-track-value="privilege-escalation-llm-model-exfil-vertex-ai:related-resources:Navigating the Cloud: Exploring Lateral Movement Techniques:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                    </div>
    </div>
    <div class="l-container bs__controls">
      <div class="bs__progress"><span></span></div>
      <div class="bs__navigation"> 
        <ul>
          <li> 
            <button id="prevButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
          <li> 
            <button id="nextButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
        </ul>
      </div>
    </div>
  </div>
 
        <div class="be-enlarge-modal" id="enlargedModal">
          <div class="be-enlarge-modal__wrapper"> 
            <figure> 
              <button class="close__modal" id="closeModal"> 
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button"></button>
              <img class="be__enlarged-image" id="enlargedImage" src="" alt="Enlarged Image">
              <figcaption> </figcaption>
            </figure>
          </div>
        </div>

      </div>
    </section>
  </main>
<!--  Start: Footer subscription form -->
<div class="newsletter">
      <div class="l-container">
        <div class="newsletter__wrapper">
          <div class="image__wrapper"> 
            <picture>
			                 <source class="lozad" media="(max-width:400px)" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-mobile.webp">
			  			                  <source class="lozad" media="(max-width:949px)" data-srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-tab.webp">
			  			  			  	<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/Revitalized_newsletter-Image-desktop-copy-1.webp" alt="Newsletter">
			              </picture>
          </div>
          <div class="content__wrapper"> 
		    							<span class="pre-title"> 
				<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/palo-alto-logo-small.svg" alt="UNIT 42 Small Logo">
				Get updates from Unit 42			</span>
						           	 <h2>Peace of mind comes from staying ahead of threats. Contact us today.</h2>
			            <form action="https://www.paloaltonetworks.com/apps/pan/public/formsubmithandler.submitform.json" method="post" novalidate class="subscribe-form" name="Unit42_Subscribe" id="unit42footerSubscription_form">
              <input type="hidden" name="emailFormMask" value="">
              <input type="hidden" value="1086" name="formid">
              <input type="hidden" value="531-OCS-018" name="munchkinId">
              <input type="hidden" value="2141" name="lpId">
              <input type="hidden" value="1203" name="programId">
              <input type="hidden" value="1086" name="formVid">
              <input type="hidden" name="mkto_optinunit42" value="true">
              <input type="hidden" name="mkto_opt-in" value="true">
              <div class="form-group"> 
                <label for="newsletter-email"  id="newsletter-email-label">Your Email</label>
                <input type="emal" placeholder="Your Email" name="Email"  class="subscribe-field" id="newsletter-email" aria-labelledby="newsletter-email-label">
                <p class="error-mail mb-15 text-danger" style="color: #dc3545"></p>
				<p>Subscribe for email updates to all Unit 42 threat research.<br />By submitting this form, you agree to our <a title="Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use" data-page-track="true" data-page-track-value="Get updates from Unit 42:Terms of Use">Terms of Use</a> and acknowledge our <a title="Privacy Statement" href="https://www.paloaltonetworks.com/legal-notices/privacy" data-page-track="true" data-page-track-value="Get updates from Unit 42:Privacy Statement">Privacy Statement.</a></p>
                <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6Lc5EhgTAAAAAJa-DzE7EeWABasWg4LKv-R3ao6o"></div>
                <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Invalid captcha!</p>
                <button class="l-btn is-disabled" data-page-track="true" data-page-track-value="footer:Get updates from Unit 42:Subscribe" id="unit42footerSubscription_form_button"> 
					Subscribe					<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow"  class="arrow">
					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-loader.svg" alt="loader" class="loader">
			   </button>
				<div class="form-success-message"></div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

<script>

(function($) {
	// Migrated from the unit42-v5 + Modifications
	var subscribeSuccess = false;
	var email = document.getElementById('newsletter-email');
	var subscription_form = document.getElementById('unit42footerSubscription_form');
	var subscription_form_button = document.getElementById('unit42footerSubscription_form_button');
	window.captchaComplete = function() {
		subscribeSuccess = true;
		if ($(mail).val() != '' && isEmail($(mail).val())) {
			$(subscription_form_button).removeClass('is-disabled');
		}
		setTimeout(function() {
			$(email).focus();
			$('.g-recaptcha iframe').attr('tabindex', '-1');
		}, 100)
	}
	window.captchaExpires = function() {
		subscribeSuccess = false;
		$(subscription_form_button).addClass('is-disabled', true);
	} 
	$(subscription_form).submit(function(e) {
		e.preventDefault();
		e.stopImmediatePropagation();
		updateEmailMask();
		var success = true;
		var form = $(this);
		var mail = form.find('input[name="Email"]');
		
		if (mail.val() === '') {
			mail.addClass('has-error');
			showError(1);
			success = false;	
		}  else if (!isEmail(mail.val())){
			showError(2);
			success = false;
		}
		else {
			mail.removeClass('has-error');
			$('.error-mail').addClass('d-none');
		}

		if (!subscribeSuccess) {
			$('.error-recaptcha').removeClass('d-none');
		} else {
			$('.error-recaptcha').addClass('d-none');
		}

		if (success && subscribeSuccess) {
			$.ajax({
				type: 'POST',
				url: form.attr('action'),
				data: form.serialize(),
				beforeSend: function() {
                 form.find('button').addClass('is-loading');
    			},
				success: function(msg) {
					form.find('.form-success-message').html('<p class="success-message">You have been successfully subscribed</p>');
					form.find('button').removeClass('is-loading');
					$(email).val('');
					clearError();
				},
				error: function(jqXHR, textStatus, errorThrown) {
					$(subscription_form_button).addClass('is-disabled', true);
					form.find('button').removeClass('is-loading');
					
				}
			});
		}
		return false;
	});
	function showError(error_type){
		if(error_type == 1) {
			$('.error-mail').text("Please enter the email address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		} else if(error_type == 2){
			$('.error-mail').text("Please provide a valid e-mail address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		}	
		$(subscription_form_button).removeClass('is-loading');
	}
	function clearError(){
		$('.error-mail').text("").removeClass('error-show');;
		$(subscription_form_button).removeClass('is-loading');
		$(subscription_form_button).removeClass('is-disabled');
	}
	
	$(email).on('input', function (event) { 
		var email = $(this).val();
		if (isEmail(email) ) {			
			clearError();
		} else if(email == ""){
			clearError();
		} else{
			showError(2);			  
		}
    });

	function isEmail(email) {
		var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
		return re.test(String(email).toLowerCase());
	}
	
	var captcha_loaded = false;
         if(!captcha_loaded){
            // recaptcha on foucs call
            $(document).on('change paste keyup', '#newsletter-email', function () {
               if($('.g-recaptcha').hasClass('d-none')){
                $('.g-recaptcha').removeClass('d-none');
               }
               if(!captcha_loaded ){
                  captcha_loaded  = true;
                  // trigger loading api.js (recaptcha.js) script
                  var head = document.getElementsByTagName('head')[0];
                  var script = document.createElement('script');
                  script.type = 'text/javascript';
                  script.src = 'https://www.google.com/recaptcha/api.js?hl=en_US';
                  head.appendChild(script);
               }
            });
        }
	
	function updateEmailMask() {
		var email = $("#unit42footerSubscription_form input[name='Email']").val();
		if (email && email.trim() != '') {
			var maskedEmail = maskEmailAddress(email);
			$("#unit42footerSubscription_form input[name='emailFormMask']").val(maskedEmail);
		}
	}

	function maskEmailAddress (emailAddress) {
		function mask(str) {
			var strLen = str.length;
			if (strLen > 4) {
				return str.substr(0, 1) + str.substr(1, strLen - 1).replace(/\w/g, '*') + str.substr(-1,1);
			}
			return str.replace(/\w/g, '*');
		}
		return emailAddress.replace(/([\w.]+)@([\w.]+)(\.[\w.]+)/g, function (m, p1, p2, p3) {
			return mask(p1) + '@' + mask(p2) + p3;
		});

		return emailAddress;
	}

}(jQuery));
//# sourceMappingURL=main.js.map
	
</script>
<!--  End: Footer subscription form -->

<footer class="footer"> 
  <div class="footer-menu">
    <div class="l-container">
      <div class="footer-menu__wrapper">
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Products and services</h3>
                                <div class="nav-column__wrapper"> 
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security"   role="link" title="Network Security Platform" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform">Network Security Platform</a>
						</li>    
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/security-subscriptions"   role="link" title="CLOUD DELIVERED SECURITY SERVICES" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES">CLOUD DELIVERED SECURITY SERVICES</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-threat-prevention" target=_blank  role="link" title="Advanced Threat Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention">Advanced Threat Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-dns-security"   role="link" title="DNS Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security">DNS Security</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-data-loss-prevention"   role="link" title="Data Loss Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention">Data Loss Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-iot-security"   role="link" title="IoT Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security">IoT Security</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall"   role="link" title="Next-Generation Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls">Next-Generation Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall-hardware"   role="link" title="Hardware Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls">Hardware Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/strata-cloud-manager"   role="link" title="Strata Cloud Manager" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager">Strata Cloud Manager</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/sase"   role="link" title="SECURE ACCESS SERVICE EDGE" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE">SECURE ACCESS SERVICE EDGE</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/access"   role="link" title="Prisma Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access">Prisma Access</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/sd-wan"   role="link" title="Prisma SD-WAN" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN">Prisma SD-WAN</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/adem"   role="link" title="Autonomous Digital Experience Management" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management">Autonomous Digital Experience Management</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/next-gen-casb"   role="link" title="Cloud Access Security Broker" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker">Cloud Access Security Broker</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/ztna"   role="link" title="Zero Trust Network Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker:Zero Trust Network Access">Zero Trust Network Access</a>
						</li>    
					        
					</ul>
				</nav>
						         
            </div>
            <div class="nav-column">
                          													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/prisma/whyprisma"   role="link" title="Code to Cloud Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform">Code to Cloud Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/prisma/cloud"   role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud">Prisma Cloud</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/content/pan/en_US/prisma/cloud/cloud-native-application-protection-platform"   role="link" title="Cloud-Native Application Protection Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud:Cloud-Native Application Protection Platform">Cloud-Native Application Protection Platform</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/cortex" target=_blank  role="link" title="AI-Driven Security Operations Platform" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform">AI-Driven Security Operations Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xdr"   role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR">Cortex XDR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsoar"   role="link" title="Cortex XSOAR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR">Cortex XSOAR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse"   role="link" title="Cortex Xpanse" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse">Cortex Xpanse</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam"   role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM">Cortex XSIAM</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse/attack-surface-management"   role="link" title="External Attack Surface Protection" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection">External Attack Surface Protection</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/security-operations-automation"   role="link" title="Security Automation" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation">Security Automation</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/detection-and-response"   role="link" title="Threat Prevention, Detection &amp; Response" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation:Threat Prevention, Detection &amp; Response">Threat Prevention, Detection &amp; Response</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/unit42"   role="link" title="Threat Intel and Incident Response Services" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services">Threat Intel and Incident Response Services</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/assess"   role="link" title="Proactive Assessments" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments">Proactive Assessments</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/respond"   role="link" title="Incident Response" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response">Incident Response</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/transform"   role="link" title="Transform Your Security Strategy" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy">Transform Your Security Strategy</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/threat-intelligence-partners"   role="link" title="Discover Threat Intelligence" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy:Discover Threat Intelligence">Discover Threat Intelligence</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Company</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us"   role="link" title="About Us" data-page-track="true" data-page-track-value="footer:Company:About Us">About Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://jobs.paloaltonetworks.com/en/"   role="link" title="Careers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers">Careers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/contact-sales"   role="link" title="Contact Us" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us">Contact Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/corporate-responsibility"   role="link" title="Corporate Responsibility" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility">Corporate Responsibility</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/customers"   role="link" title="Customers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers">Customers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://investors.paloaltonetworks.com/" target=_blank  role="link" title="Investor Relations" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations">Investor Relations</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/locations"   role="link" title="Location" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location">Location</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/newsroom"   role="link" title="Newsroom" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location:Newsroom">Newsroom</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Popular links</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/blog/"   role="link" title="Blog" data-page-track="true" data-page-track-value="footer:Popular links:Blog">Blog</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/communities"   role="link" title="Communities" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities">Communities</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/resources"   role="link" title="Content Library" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library">Content Library</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cyberpedia"   role="link" title="Cyberpedia" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia">Cyberpedia</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://events.paloaltonetworks.com/"   role="link" title="Event Center" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center">Event Center</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://start.paloaltonetworks.com/preference-center"   role="link" title="Manage Email Preferences" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences">Manage Email Preferences</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/products/products-a-z"   role="link" title="Products A-Z" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z">Products A-Z</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/legal-notices/trust-center/tech-certs"   role="link" title="Product Certifications" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications">Product Certifications</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/security-disclosure"   role="link" title="Report a Vulnerability" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability">Report a Vulnerability</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sitemap"   role="link" title="Sitemap" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap">Sitemap</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://docs.paloaltonetworks.com/"   role="link" title="Tech Docs" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs">Tech Docs</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://unit42.paloaltonetworks.com/"   role="link" title="Unit 42" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42">Unit 42</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://panwedd.exterro.net/portal/dsar.htm?target=panwedd" target=_blank  role="link" title="Do Not Sell or Share My Personal Information" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42:Do Not Sell or Share My Personal Information">Do Not Sell or Share My Personal Information</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer-bottom"> 
    <div class="l-container"> 
              <div class="footer-logo">
          <a href="https://www.paloaltonetworks.com/" role="link" title="Footer Nav" data-page-track="true" data-page-track-value="footer:logo:Palo Alto Networks">
            <img width="245" height="46" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/palo-alto-footer-logo.svg" class="attachment-medium size-medium" alt="" decoding="async" loading="lazy" />          </a>
        </div>
            <div class="footer-bottom__wrapper"> 
        <div class="footer-bottom-nav">
                                              <nav>
                <ul class="footer-menu-nav__list"> 
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/privacy"   role="link" title="Privacy" data-page-track="true" data-page-track-value="footer:bottom-menu:Privacy">Privacy</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/trust-center"   role="link" title="Trust Center" data-page-track="true" data-page-track-value="footer:bottom-menu:Trust Center">Trust Center</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use"   role="link" title="Terms of Use" data-page-track="true" data-page-track-value="footer:bottom-menu:Terms of Use">Terms of Use</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal"   role="link" title="Documents" data-page-track="true" data-page-track-value="footer:bottom-menu:Documents">Documents</a>
                  </li>    
                        
                </ul>
              </nav>
                                            <br/><span class="copyright">Copyright © 2024 Palo Alto Networks. All Rights Reserved</span>
                  </div>
        <div class="footer-bottom-social"> 
          <ul> 
			<li>
			<a href="https://www.youtube.com/user/paloaltonetworks" target="_blank" role="link" title="YouTube" data-page-track="true" data-page-track-value="footer:social:Youtube">
				<img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/youtube-black.svg" alt="YouTube">
			</a>
		</li>
				<li> 
			<a href="https://twitter.com/Unit42_Intel" target="_blank" role="link" title="X" data-page-track="true" data-page-track-value="footer:social::Twitter">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/x-icon-black.svg" alt="Twitter">
			</a>
		</li>
				<li> 
			<a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank" role="link" title="Facebook" data-page-track="true" data-page-track-value="footer:social:Facebook">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/Facebook_Icon.svg" alt="Facebook">
			</a>
		</li>
				<li> 
			<a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank" role="link" title="LinkedIn" data-page-track="true" data-page-track-value="footer:social:LinkedIn">
				<img  class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/LinkedIn_Icon.svg" alt="LinkedIn">
			</a>
		</li>
	                <li> 
			<a href="https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/" role="link" title="Podcast" data-page-track="true" data-page-track-value="footer:social:Podcast">
                            <img class="lozad" data-src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/Podcast.svg" alt="Podcast">
			</a>
		</li>
</ul>          
	<div class="pa language-dropdown">
			<div class="language-dropdown__wrapper"> 
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/globe-icon.svg" alt="Globe icon">
			<span id="selectedLanguage">EN</span>
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"><ul><li class="title">Select your language</li>
					<li class="selected" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:en" href="https://unit42.paloaltonetworks.com/privilege-escalation-llm-model-exfil-vertex-ai/">USA (ENGLISH)</a>
					</li></ul>        </div>
      </div>
    </div>
  </div>
</footer>
<div class="dd-overlay">
</div>
<!--  Start: video modal -->
<div class="modal video__modal" id="videoModal" tabindex="-1">
        <div class="modal__video-wrapper">
          <button class="modal__play-btn is-minimized is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
          <button class="modal__minimize-btn is-minimized">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
          </button>
          <button class="modal__close"> 
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button">
          </button>
          <video class="modal__video" id="customVideo">
            <source src="" type="video/mp4">Your browser does not support the video tag.
          </video>
          <div class="modal__post-details" tabindex="-1">       
              <h3>Default Heading</h3>
              <a class="l-btn" href="#" title="Right Arrow Icon" role="link" data-page-track="true" data-page-track-value="overview:explore reports:View all reports">Read the article
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow">
              </a>
          </div>
          <div class="modal__video-controls">
            <div class="modal__video-seekbar input__wrapper"><span></span>
              <label class="is-hidden" for="modalSeekBar">Seekbar</label>
              <input class="custom-range" id="modalSeekBar" type="range" min="0" max="100" value="1">
              <p class="modal__remaining-time"></p>
            </div>
            <button class="modal__play-btn is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
            <div class="modal__volume-controls">
              <div class="modal__volume__wrapper">
                <button tabindex="0">
                  <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-volume.svg" alt="Volume">
                </button>
                <div class="modal__volume-seekbar"><span></span>
                  <label class="is-hidden" for="volumeBar">Volume</label>
                  <input class="volume__bar" id="volumeBar" type="range" min="0" max="1" step="0.1" value="0.7">
                </div>
              </div>
              <button class="modal__minimize-btn" id="minimizeBtn">
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
              </button>
            </div>
          </div>
        </div>
      </div><!--  End: video modal -->

    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		var like_nonce = jQuery('#_wpnonce').val();
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type+"&ul_nonce="+like_nonce,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=6.6.2' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/js/script.js?ver=1.0.0" id="unit42-v6-navigation-js"></script>

<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
observer_lozad.observe();

window.PAN_Clean_Util = {
        isIE: false
};

(function () {
   // INP Util Fix
    function yieldToMain(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
   window.PAN_Clean_Util.yieldToMain = yieldToMain
})();

if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
  var Coveo_organizationId = "paloaltonetworksintranet";        
  var techDocsPagePath = "https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25";
  var languageFromPath="en_US";
  window.Granite = window.Granite || {};
  Granite.I18n = (function() {
  var self = {};
  self.setLocale = function(locale) { };
  self.get = function(text, snippets, note) {
    var out = "";
    if(text){
      if(text ==="coveo.clear"){
        out = "Clear";
      }else if(text ==="coveo.noresultsfound"){
        out = "No results found for this search term.";
      }
    }
    return out;
  };
  return self
  }());
}

  var main_site_critical_top = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.js';
  var main_site_defered = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/defered.min.js';
  var main_site_criticalTopBase = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopBase.min.js';
  var main_site_criticalTopProductNav = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.js';
window.PAN_MainNavAsyncUrl = maindomain_lang+"/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html";

function loadScript(url, defer){
    var script1 = document.createElement('script');
    script1.setAttribute('type', 'text/javascript');
    script1.setAttribute('src',url);
    if(defer == true){
        script1.setAttribute('defer','defer');
    }
    document.head.appendChild(script1);
}
function loadScript1(url, callback){

    var script = document.createElement("script")
    script.type = "text/javascript";
    if (script.readyState){  //IE
        script.onreadystatechange = function(){
            if (script.readyState == "loaded" || script.readyState == "complete"){
                script.onreadystatechange = null;
                callback();
            }
        };
    } else {  //Others
        script.onload = function(){
            callback();
        };
    }
    script.src = url;
    document.getElementsByTagName("head")[0].appendChild(script);
}
if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
	if(referer == "Unit"){
    setTimeout(function(){
      loadScript(main_site_criticalTopBase, false);
      loadScript1(main_site_criticalTopProductNav, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
	else{
    setTimeout(function(){
      loadScript1(main_site_critical_top, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
}

$(document).ready(function () {
    setTimeout(function(){
      $('.article-banner .ab__options ul li a').each(function(){
          	$(this).attr('target', "_blank");
      });
    }, 4000);
});
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->

</body>
</html>
