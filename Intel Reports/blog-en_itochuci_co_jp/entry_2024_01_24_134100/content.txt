<!DOCTYPE html>
<html
  lang="ja"

data-admin-domain="//blog.hatena.ne.jp"
data-admin-origin="https://blog.hatena.ne.jp"
data-author="itochuci"
data-avail-langs="ja en"
data-blog="itochuci-en.hatenadiary.jp"
data-blog-host="itochuci-en.hatenadiary.jp"
data-blog-is-public="1"
data-blog-name=" Researcher Blog - ITOCHU Cyber &amp; Intelligence Inc. "
data-blog-owner="itochuci"
data-blog-show-ads=""
data-blog-show-sleeping-ads=""
data-blog-uri="https://blog-en.itochuci.co.jp/"
data-blog-uuid="820878482971077572"
data-blogs-uri-base="https://blog-en.itochuci.co.jp"
data-brand="devblog"
data-data-layer="{&quot;hatenablog&quot;:{&quot;admin&quot;:{},&quot;analytics&quot;:{&quot;brand_property_id&quot;:&quot;&quot;,&quot;measurement_id&quot;:&quot;&quot;,&quot;non_sampling_property_id&quot;:&quot;&quot;,&quot;property_id&quot;:&quot;&quot;,&quot;separated_property_id&quot;:&quot;UA-29716941-23&quot;},&quot;blog&quot;:{&quot;blog_id&quot;:&quot;820878482971077572&quot;,&quot;content_seems_japanese&quot;:&quot;true&quot;,&quot;disable_ads&quot;:&quot;custom_domain&quot;,&quot;enable_ads&quot;:&quot;false&quot;,&quot;enable_keyword_link&quot;:&quot;false&quot;,&quot;entry_show_footer_related_entries&quot;:&quot;false&quot;,&quot;force_pc_view&quot;:&quot;true&quot;,&quot;is_public&quot;:&quot;true&quot;,&quot;is_responsive_view&quot;:&quot;false&quot;,&quot;is_sleeping&quot;:&quot;true&quot;,&quot;lang&quot;:&quot;ja&quot;,&quot;name&quot;:&quot; Researcher Blog - ITOCHU Cyber &amp; Intelligence Inc. &quot;,&quot;owner_name&quot;:&quot;itochuci&quot;,&quot;uri&quot;:&quot;https://blog-en.itochuci.co.jp/&quot;},&quot;brand&quot;:&quot;devblog&quot;,&quot;page_id&quot;:&quot;entry&quot;,&quot;permalink_entry&quot;:{&quot;author_name&quot;:&quot;ici-blog&quot;,&quot;categories&quot;:&quot;&quot;,&quot;character_count&quot;:18502,&quot;date&quot;:&quot;2024-01-24&quot;,&quot;entry_id&quot;:&quot;6801883189077328782&quot;,&quot;first_category&quot;:&quot;&quot;,&quot;hour&quot;:&quot;13&quot;,&quot;title&quot;:&quot;The Endless Struggle Against APT10: Insights from LODEINFO v0.6.6 - v0.7.3 Analysis&quot;,&quot;uri&quot;:&quot;https://blog-en.itochuci.co.jp/entry/2024/01/24/134100&quot;},&quot;pro&quot;:&quot;pro&quot;,&quot;router_type&quot;:&quot;blogs&quot;}}"
data-device="pc"
data-dont-recommend-pro="false"
data-global-domain="https://hatena.blog"
data-globalheader-color="b"
data-globalheader-type="pc"
data-has-touch-view="1"
data-help-url="https://help.hatenablog.com"
data-hide-header="1"
data-no-suggest-touch-view="1"
data-page="entry"
data-parts-domain="https://hatenablog-parts.com"
data-plus-available="1"
data-pro="true"
data-router-type="blogs"
data-sentry-dsn="https://03a33e4781a24cf2885099fed222b56d@sentry.io/1195218"
data-sentry-environment="production"
data-sentry-sample-rate="0.1"
data-static-domain="https://cdn.blog.st-hatena.com"
data-version="6fa44cc191e4c8dbcb011e13d2e9bb"




  data-initial-state="{}"

  >
  <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">

  
    
  

  

  


  
  <meta name="Hatena::Bookmark" content="nocomment"/>


  <meta name="robots" content="max-image-preview:large" />


  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=7; IE=9; IE=10; IE=11" />
  <title>The Endless Struggle Against APT10: Insights from LODEINFO v0.6.6 - v0.7.3 Analysis -  Researcher Blog - ITOCHU Cyber &amp; Intelligence Inc. </title>

  
  <link rel="canonical" href="https://blog-en.itochuci.co.jp/entry/2024/01/24/134100"/>



  

<meta itemprop="name" content="The Endless Struggle Against APT10: Insights from LODEINFO v0.6.6 - v0.7.3 Analysis -  Researcher Blog - ITOCHU Cyber &amp; Intelligence Inc. "/>

  <meta itemprop="image" content="https://cdn.image.st-hatena.com/image/scale/cd7aa7c4a65ed8c14d9b15c9f12421cd93acb339/backend=imagemagick;height=1300;version=1;width=1300/https%3A%2F%2Fcdn-ak.f.st-hatena.com%2Fimages%2Ffotolife%2Fi%2Fici-blog%2F20240122%2F20240122134753.png"/>


  <meta property="og:title" content="The Endless Struggle Against APT10: Insights from LODEINFO v0.6.6 - v0.7.3 Analysis -  Researcher Blog - ITOCHU Cyber &amp; Intelligence Inc. "/>
<meta property="og:type" content="article"/>
  <meta property="og:url" content="https://blog-en.itochuci.co.jp/entry/2024/01/24/134100"/>

  <meta property="og:image" content="https://cdn.image.st-hatena.com/image/scale/cd7aa7c4a65ed8c14d9b15c9f12421cd93acb339/backend=imagemagick;height=1300;version=1;width=1300/https%3A%2F%2Fcdn-ak.f.st-hatena.com%2Fimages%2Ffotolife%2Fi%2Fici-blog%2F20240122%2F20240122134753.png"/>

<meta property="og:image:alt" content="The Endless Struggle Against APT10: Insights from LODEINFO v0.6.6 - v0.7.3 Analysis -  Researcher Blog - ITOCHU Cyber &amp; Intelligence Inc. "/>
    <meta property="og:description" content="What is the LODEINFO malware? Analysis of LODEINFO The infection flow Update of the Downloader Shellcode Remote Template Injection Maldoc VBA code embedded in Maldoc Microsoft Office language check The Downloader Shellcode Fake PEM file decryption Deployment of LODEINFO Backdoor Shellcode loaded int…" />
<meta property="og:site_name" content=" Researcher Blog - ITOCHU Cyber &amp; Intelligence Inc. "/>

  <meta property="article:published_time" content="1706071260" />

      <meta name="twitter:card"  content="summary_large_image" />
    <meta name="twitter:image" content="https://cdn.image.st-hatena.com/image/scale/cd7aa7c4a65ed8c14d9b15c9f12421cd93acb339/backend=imagemagick;height=1300;version=1;width=1300/https%3A%2F%2Fcdn-ak.f.st-hatena.com%2Fimages%2Ffotolife%2Fi%2Fici-blog%2F20240122%2F20240122134753.png" />  <meta name="twitter:title" content="The Endless Struggle Against APT10: Insights from LODEINFO v0.6.6 - v0.7.3 Analysis -  Researcher Blog - ITOCHU Cyber &amp; Intelligence Inc. " />    <meta name="twitter:description" content="What is the LODEINFO malware? Analysis of LODEINFO The infection flow Update of the Downloader Shellcode Remote Template Injection Maldoc VBA code embedded in M…" />  <meta name="twitter:app:name:iphone" content="はてなブログアプリ" />
  <meta name="twitter:app:id:iphone" content="583299321" />
  <meta name="twitter:app:url:iphone" content="hatenablog:///open?uri=https%3A%2F%2Fblog-en.itochuci.co.jp%2Fentry%2F2024%2F01%2F24%2F134100" />
  
    <meta name="description" content="What is the LODEINFO malware? Analysis of LODEINFO The infection flow Update of the Downloader Shellcode Remote Template Injection Maldoc VBA code embedded in Maldoc Microsoft Office language check The Downloader Shellcode Fake PEM file decryption Deployment of LODEINFO Backdoor Shellcode loaded int…" />


  
<script
  id="embed-gtm-data-layer-loader"
  data-data-layer-page-specific="{&quot;hatenablog&quot;:{&quot;blogs_permalink&quot;:{&quot;has_related_entries_with_elasticsearch&quot;:&quot;false&quot;,&quot;entry_afc_issued&quot;:&quot;false&quot;,&quot;blog_afc_issued&quot;:&quot;false&quot;,&quot;is_author_pro&quot;:&quot;true&quot;,&quot;is_blog_sleeping&quot;:&quot;true&quot;}}}"
>
(function() {
  function loadDataLayer(elem, attrName) {
    if (!elem) { return {}; }
    var json = elem.getAttribute(attrName);
    if (!json) { return {}; }
    return JSON.parse(json);
  }

  var globalVariables = loadDataLayer(
    document.documentElement,
    'data-data-layer'
  );
  var pageSpecificVariables = loadDataLayer(
    document.getElementById('embed-gtm-data-layer-loader'),
    'data-data-layer-page-specific'
  );

  var variables = [globalVariables, pageSpecificVariables];

  if (!window.dataLayer) {
    window.dataLayer = [];
  }

  for (var i = 0; i < variables.length; i++) {
    window.dataLayer.push(variables[i]);
  }
})();
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-P4CXTW');</script>
<!-- End Google Tag Manager -->








  <link rel="shortcut icon" href="https://blog-en.itochuci.co.jp/icon/favicon">
<link rel="apple-touch-icon" href="https://blog-en.itochuci.co.jp/icon/touch">
<link rel="icon" sizes="192x192" href="https://blog-en.itochuci.co.jp/icon/link">

  

<link rel="alternate" type="application/atom+xml" title="Atom" href="https://blog-en.itochuci.co.jp/feed"/>
<link rel="alternate" type="application/rss+xml" title="RSS2.0" href="https://blog-en.itochuci.co.jp/rss"/>

  <link rel="alternate" type="application/json+oembed" href="https://hatena.blog/oembed?url=https%3A%2F%2Fblog-en.itochuci.co.jp%2Fentry%2F2024%2F01%2F24%2F134100&amp;format=json" title="oEmbed Profile of The Endless Struggle Against APT10: Insights from LODEINFO v0.6.6 - v0.7.3 Analysis"/>
<link rel="alternate" type="text/xml+oembed" href="https://hatena.blog/oembed?url=https%3A%2F%2Fblog-en.itochuci.co.jp%2Fentry%2F2024%2F01%2F24%2F134100&amp;format=xml" title="oEmbed Profile of The Endless Struggle Against APT10: Insights from LODEINFO v0.6.6 - v0.7.3 Analysis"/>
  
  <link rel="author" href="http://www.hatena.ne.jp/ici-blog/">

  

  


  
    
<link rel="stylesheet" type="text/css" href="https://cdn.blog.st-hatena.com/css/blog.css?version=6fa44cc191e4c8dbcb011e13d2e9bb"/>

    
  <link rel="stylesheet" type="text/css" href="https://usercss.blog.st-hatena.com/blog_style/820878482971077572/97a1f918b0c901a79ef86df61b5c66d2babd5a09"/>
  
  

  

  
<script> </script>

  
<style>
  div#google_afc_user,
  div.google-afc-user-container,
  div.google_afc_image,
  div.google_afc_blocklink {
      display: block !important;
  }
</style>


  

  
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","dateModified":"2024-01-24T15:10:46+09:00","datePublished":"2024-01-24T13:41:00+09:00","headline":"The Endless Struggle Against APT10: Insights from LODEINFO v0.6.6 - v0.7.3 Analysis","image":["https://cdn-ak.f.st-hatena.com/images/fotolife/i/ici-blog/20240122/20240122134753.png"]}</script>

  

  <meta name="viewport" content="width=device-width,initial-scale=1">

<!-- Google Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter+Tight:ital,wght@0,300;0,400;0,700;1,200;1,500;1,700&family=Noto+Sans+JP:wght@400;600&display=swap" rel="stylesheet">

<!-- CDN -->
<link rel="stylesheet"  href="https://blog-cdn.itochuci.co.jp/lib.css"/>
</head>

  <body class="page-entry enable-top-editarea enable-bottom-editarea globalheader-off globalheader-ng-enabled">
    

<div id="globalheader-container"
  data-brand="hatenablog"
  style="display: none"
  >
  <iframe id="globalheader" height="37" frameborder="0" allowTransparency="true"></iframe>
</div>


  
  
  

  <div id="container">
    <div id="container-inner">
      <header id="blog-title" data-brand="hatenablog">
  <div id="blog-title-inner" >
    <div id="blog-title-content">
      <h1 id="title"><a href="https://blog-en.itochuci.co.jp/"> Researcher Blog - ITOCHU Cyber &amp; Intelligence Inc. </a></h1>
      
    </div>
  </div>
</header>

      
  <div id="top-editarea">
    <div class="header">
  <div class="headerInner">
    <div class="headerTitle"><a class="headerTitle_link" href="/">
      <span class="headerTitle_bold">Researcher Blog</span><br>
      <span class="headerTitle_italic">ITOCHU</span>
      <span class="headerTitle_bold">Cyber &amp; Intelligence Inc.</span>
    </a></div>
    <nav class="headerNav">
      <ul class="headerNav_list">
        <li class="headerNav_listNode"><a href="/" class="headerNav_listNode_link">Top</a></li>
        <li class="headerNav_listNode"><a href="https://www.itochuci.co.jp/#company" class="headerNav_listNode_link">About Us</a></li>
        <li class="headerNav_listNode"><a href="https://www.itochuci.co.jp/#news" class="headerNav_listNode_link">News</a></li>
      </ul>
    </nav>
  </div>
</div>
  </div>


      
      




<div id="content" class="hfeed"
  
  >
  <div id="content-inner">
    <div id="wrapper">
      <div id="main">
        <div id="main-inner">
          

          



          
  
  <!-- google_ad_section_start -->
  <!-- rakuten_ad_target_begin -->
  
  
  

  

  
    
      
        <article class="entry hentry test-hentry js-entry-article date-first autopagerize_page_element chars-18800 words-3000 mode-markdown entry-odd" id="entry-6801883189077328782" data-keyword-campaign="" data-uuid="6801883189077328782" data-publication-type="entry">
  <div class="entry-inner">
    <header class="entry-header">
  
    <div class="date entry-date first">
    <a href="https://blog-en.itochuci.co.jp/archive/2024/01/24" rel="nofollow">
      <time datetime="2024-01-24T04:41:00Z" title="2024-01-24T04:41:00Z">
        <span class="date-year">2024</span><span class="hyphen">-</span><span class="date-month">01</span><span class="hyphen">-</span><span class="date-day">24</span>
      </time>
    </a>
      </div>
  <h1 class="entry-title">
  <a href="https://blog-en.itochuci.co.jp/entry/2024/01/24/134100" class="entry-title-link bookmark">The Endless Struggle Against APT10: Insights from LODEINFO v0.6.6 - v0.7.3 Analysis</a>
</h1>

  
  


  

  

</header>

    


    <div class="entry-content hatenablog-entry">
  
    <ul class="table-of-contents">
    <li><a href="#What-is-the-LODEINFO-malware">What is the LODEINFO malware?</a></li>
    <li><a href="#Analysis-of-LODEINFO">Analysis of LODEINFO</a><ul>
            <li><a href="#The-infection-flow">The infection flow</a><ul>
                    <li><a href="#Update-of-the-Downloader-Shellcode">Update of the Downloader Shellcode</a></li>
                    <li><a href="#Remote-Template-Injection">Remote Template Injection</a></li>
                </ul>
            </li>
            <li><a href="#Maldoc">Maldoc</a><ul>
                    <li><a href="#VBA-code-embedded-in-Maldoc">VBA code embedded in Maldoc</a></li>
                    <li><a href="#Microsoft-Office-language-check">Microsoft Office language check</a></li>
                </ul>
            </li>
            <li><a href="#The-Downloader-Shellcode">The Downloader Shellcode</a><ul>
                    <li><a href="#Fake-PEM-file-decryption">Fake PEM file decryption</a></li>
                    <li><a href="#Deployment-of-LODEINFO-Backdoor-Shellcode-loaded-into-Memory">Deployment of LODEINFO Backdoor Shellcode loaded into Memory</a></li>
                    <li><a href="#Similarities-with-the-known-downloader-DOWNIISSA">Similarities with the known downloader DOWNIISSA</a></li>
                </ul>
            </li>
            <li><a href="#LODEINFO-Backdoor-Shellcode">LODEINFO Backdoor Shellcode</a></li>
        </ul>
    </li>
    <li><a href="#Attacker-infrastructure">Attacker infrastructure</a></li>
    <li><a href="#Summary">Summary</a></li>
    <li><a href="#IoCs">IoCs</a></li>
</ul>

<p><strong>This post is also available in: <a href="https://blog.itochuci.co.jp/entry/2024/01/24/134047">日本語</a></strong><br></p>

<h1 id="What-is-the-LODEINFO-malware">What is the LODEINFO malware?</h1>

<p>LODEINFO is a fileless malware that has been observed in campaigns that start with spear-phishing emails since December 2019. The infection is known to occur when a user opens a malicious Word file (hereafter Maldoc) attached to the spear-phishing email. (Excel files were also abused in the early days.)</p>

<p>According to information released by security vendors, APT campaigns using LODEINFO target Japanese media, diplomacy, public institutions, defense industries, and think tanks. It is also suggested that the infamous APT group called APT10 is involved given the similarities in their methods and malwares.</p>

<blockquote><p><strong>LODEINFO malware: published information up to 2022</strong>
<br>• <a href="https://hitcon.org/2021/agenda/6d88317b-4d90-4249-ba87-d81c80a21382/APT10%20HUNTER%20RISE%20ver3.0%20Repel%20new%20malware%20LODEINFO%20DOWNJPIT%20and%20LilimRAT.pdf">APT10 HUNTER RISE ver3.0: Repel new malware LODEINFO, DOWNJPIT and LilimRAT</a>
<br>• <a href="https://securelist.com/apt10-tracking-down-lodeinfo-2022-part-i/107742/">APT10: Tracking down LODEINFO 2022, part I</a>
<br>• <a href="https://www.welivesecurity.com/2022/12/14/unmasking-mirrorface-operation-liberalface-targeting-japanese-political-entities/">Unmasking MirrorFace: Operation LiberalFace targeting Japanese political entities</a>
<br>• <a href="https://jsac.jpcert.or.jp/archive/2023/pdf/JSAC2023_1_6_minakawa-saika-kubokawa_jp.pdf">Fighting to LODEINFO: Investigation for Continuous Cyberespionage Based on Open Source</a>
<br>• <a href="https://blogs.jpcert.or.jp/ja/2020/02/LODEINFO.html">LODEINFO, a malware targeting organizations in Japan</a>
<br>• <a href="https://blogs.jpcert.or.jp/ja/2020/06/LODEINFO-2.html">The evolution of LODEINFO malware</a></p></blockquote>

<p>Attacks using LODEINFO have continued in 2023, with multiple versions of the malware being discovered. The malware is still being actively developed, as evidenced by the frequency of its version updates.
<figure class="figure-image figure-image-fotolife" title="図1. LODEINFOの変遷"><span itemscope itemtype="http://schema.org/Photograph"><img src="https://cdn-ak.f.st-hatena.com/images/fotolife/i/ici-blog/20240122/20240122134419.png" width="767" height="194" loading="lazy" title="" class="hatena-fotolife" itemprop="image"></span><figcaption>Figure 1. Evolution of LODEINFO</figcaption></figure></p>

<p>For information on version updates prior to September 2022, please refer to the following article:
<br><a href="https://securelist.com/apt10-tracking-down-lodeinfo-2022-part-ii/107745/">APT10: Tracking down LODEINFO 2022, part II</a></p>

<p>We analyzed each version of the LODEINFO malware and identified changes.</p>

<p>Based on our analysis, the malware has been updated with new features, as well as changes to the anti-analysis (analysis avoidance) techniques and the implementation of new features. This suggests that the attackers are focusing on concealing their Tactics, Techniques, and Procedures (TTPs), including malware.</p>

<p>Due to the limited information on the detection, it is likely to expect that the detection of LODEINFO is becoming difficult. In 2023, only a limited number of LODEINFO samples  were discovered, and the results of their investigation and analysis were not widely made public.</p>

<p>As of the publication of this post (January 24, 2024), we have observed a new version of LODEINFO, v0.7.3. In this article, we will detail the updates made to LODEINFO that have been observed from the end of 2022 to January 2024, including v0.7.3.</p>

<h1 id="Analysis-of-LODEINFO">Analysis of LODEINFO</h1>

<h2 id="The-infection-flow">The infection flow</h2>

<p>The following is the infection flow of LODEINFO that was observed in 2023. It shows some changes from the previous versions.</p>

<h3 id="Update-of-the-Downloader-Shellcode">Update of the Downloader Shellcode</h3>

<p>The initial infection path  is the same as previous versions. The Infection starts from malicious Word document (Maldoc), LODEINFO is eventually injected into memory leading infection.</p>

<p>In 2023, the VBA code in this Maldoc was updated. Specifically, VBA code that embedded Downloader Shellcodes  for both 32-bit and 64-bit was added, and the appropriate shellcode is selected depending on the target environment.</p>

<p>The adoption of 64-bit architecture in Windows OS is a challenge for many organizations, and LODEINFO is also likely to have changed to adapt to 64-bit architecture.</p>

<p><figure class="figure-image figure-image-fotolife" title="図2. LODEINFO v0.6.8から実装された新たな感染フロー"><span itemscope itemtype="http://schema.org/Photograph"><img src="https://cdn-ak.f.st-hatena.com/images/fotolife/i/ici-blog/20240122/20240122134753.png" width="785" height="445" loading="lazy" title="" class="hatena-fotolife" itemprop="image"></span><figcaption>Figure 2. New infection flow implemented since LODEINFO v0.6.8</figcaption></figure></p>

<p>The changes in the infection flow were implemented from v0.6.8 to v0.7.1 observed in 2023 or the later versions.</p>

<h3 id="Remote-Template-Injection">Remote Template Injection</h3>

<p>In LODEINFO v0.6.9, we have also observed more complex cases that use Remote Template Injection in the infection flow described above.</p>

<blockquote><p><strong>What is Remote Template Injection?</strong>
<br>Microsoft Word has a "template" feature that allows users to create files based on templates created by other users. When a Word file that a template inserted is opened, the template is downloaded from the local or remote machine.
<br>Using the above "template" feature, an attacker can host a Word template file (.dotm) containing malicious Macros on their server and have the malicious template be retrieved and executed from the attacker's server every time the victim opens a Word file that contains the template.</p></blockquote>

<p>A Word file using Remote Template Injection is opened, it downloads and reads the template from the attacker's C2 server.</p>

<p>The downloaded template is malware that is equivalent to the Maldoc mentioned above, and it contains VBA code with the Downloader Shellcode embedded. This eventually calls the LODEINFO main body. The following is an image of the infection flow with Remote Template Injection added.</p>

<p><figure class="figure-image figure-image-fotolife" title="図3. Remote Template Injectionが追加された感染フロー"><span itemscope itemtype="http://schema.org/Photograph"><img src="https://cdn-ak.f.st-hatena.com/images/fotolife/i/ici-blog/20240122/20240122135212.png" width="758" height="441" loading="lazy" title="" class="hatena-fotolife" itemprop="image"></span><figcaption>Figure 3. Infection flow with Remote Template Injection added</figcaption></figure></p>

<p>The attached Word file itself only reads the template, making it difficult to detect as malicious activity. This technique is likely intended to evade detection by security products.</p>

<p>To further analyze the structure of the Word file using Remote Template Injection, we can check the contents of the <code>\word\_rels\settings.xml.rels</code> file in the word file. This will show that the file is designed to read the template file <code>https://45.76.222[.]130/template.dotm</code>.</p>

<p><figure class="figure-image figure-image-fotolife" title="図4. Remote Template Injectionを用いたWordファイルの構造"><span itemscope itemtype="http://schema.org/Photograph"><img src="https://cdn-ak.f.st-hatena.com/images/fotolife/i/ici-blog/20240122/20240122135908.png" width="843" height="497" loading="lazy" title="" class="hatena-fotolife" itemprop="image"></span><figcaption>Figure 4. Word file’s structure that uses Remote Template Injection</figcaption></figure></p>

<h2 id="Maldoc">Maldoc</h2>

<p>Next, we will introduce the VBA included in Maldoc.</p>

<h3 id="VBA-code-embedded-in-Maldoc">VBA code embedded in Maldoc</h3>

<p>The VBA code embedded in Maldoc contains both 64-bit and 32-bit Downloader Shellcodes.</p>

<p><figure class="figure-image figure-image-fotolife" title="図5. Maldocに埋め込まれたVBAコードの一部"><span itemscope itemtype="http://schema.org/Photograph"><img src="https://cdn-ak.f.st-hatena.com/images/fotolife/i/ici-blog/20240122/20240122140128.png" width="1113" height="630" loading="lazy" title="" class="hatena-fotolife" itemprop="image"></span><figcaption>Figure 5. Part of the VBA code embedded in Maldoc</figcaption></figure></p>

<p>The Macro first checks the OS architecture of the target device and then executes the Downloader Shellcode that matches that architecture.</p>

<p>Each Downloader Shellcode is encoded using Base64 and separated as many split parts. This is thought to be a technique to evade detection by security products.</p>

<p>When the Macro is executed, after the split parts are reassembled, the Shellcode decoded using Base64 is injected into memory.</p>

<p><figure class="figure-image figure-image-fotolife" title="図6. Base64 エンコードされ分割された Shellcode を再構成"><span itemscope itemtype="http://schema.org/Photograph"><img src="https://cdn-ak.f.st-hatena.com/images/fotolife/i/ici-blog/20240123/20240123092230.png" width="1054" height="997" loading="lazy" title="" class="hatena-fotolife" itemprop="image"></span><figcaption>Figure 6. Reassemble the Base64-encoded and split Shellcode</figcaption></figure></p>

<h3 id="Microsoft-Office-language-check">Microsoft Office language check</h3>

<p>The code to check the language settings of Microsoft Office was deployed in the v0.7.0 Maldoc. The sample we confirmed checks whether the Office setting is  Japanese or not. This is thought to be created to operate only in the target language environment.</p>

<p><figure class="figure-image figure-image-fotolife" title="図7. VBAマクロに含まれるOffice製品の言語設定を確認するコード"><span itemscope itemtype="http://schema.org/Photograph"><img src="https://cdn-ak.f.st-hatena.com/images/fotolife/i/ici-blog/20240122/20240122140837.png" width="789" height="246" loading="lazy" title="" class="hatena-fotolife" itemprop="image"></span><figcaptionFigure 7. Code to check the language settings of Office included in the VBA Macro.</figcaption></figure></p>

<p>Interestingly, this feature was removed by the attacker in v0.7.1. In addition, the filename of the Maldoc itself has been changed from Japanese to English. From this, we believe that v0.7.1 was likely used to attack environments in languages other than Japanese.</p>

<h2 id="The-Downloader-Shellcode">The Downloader Shellcode</h2>

<p>The Downloader Shellcode used in LODEINFO v0.7.1 is a malware that downloads and decrypts a file disguised as a PEM file (hereinafter referred to as Fake PEM) from the C2 server, and finally creates files to infect with LODEINFO.</p>

<p>The Shellcode itself is a very simple downloader, so we will share the analysis results of the process of decrypting data from the Fake PEM file.</p>

<blockquote><p><strong>What is a PEM file?</strong>
<br>An abbreviation for Privacy Enhanced Mail file.
<br>One of the file formats for keys and certificates used in public key infrastructure (PKI). Originally created to improve the security of email, it is now the standard for internet security.
<br>PEM files are used in the settings of web servers, email servers, and secure communication protocols (such as HTTPS).</p></blockquote>

<h3 id="Fake-PEM-file-decryption">Fake PEM file decryption</h3>

<p>The Downloader Shellcode downloads the Fake PEM file from the C2 server. The file is then decrypted using the following steps:</p>

<ol>
<li>The header and footer of the Fake PEM file are removed.</li>
<li>The data from step 1 is decoded using Base64.</li>
<li>The first 3 bytes of the data decoded in step 2 are removed.</li>
<li>An HMAC is generated using the SHA1 hash algorithm from the password hardcoded in the Download Shellcode.</li>
<li>The HMAC generated in step 4 is used as the key for AES, and the data from step 3 is decrypted using AES.</li>
<li>The data decrypted in step 5 is further decoded using a single-byte XOR key.</li>
</ol>


<blockquote><p><strong>What is HMAC (Hash-based Message Authentication Code)?</strong>
<br>A code and technique for ensuring the integrity and authenticity of a message using a one-way hash function. It is widely used in secure communications where it is necessary to verify the sender of the data or that the data has not been tampered with in transit.</p></blockquote>

<p>The passwords were  hardcoded in the samples we investigated in the following format. If this password is not available, even if the Fake PEM file is successfully obtained, it is extremely difficult to decrypt the subsequent data.</p>

<p><figure class="figure-image figure-image-fotolife" title="Figure 8. Hardcoded passwords required to decrypt the Fake PEM file"><span itemscope itemtype="http://schema.org/Photograph"><img src="https://cdn-ak.f.st-hatena.com/images/fotolife/i/ici-blog/20240123/20240123110003.png" width="970" height="875" loading="lazy" title="" class="hatena-fotolife" itemprop="image"></span><figcaption>Figure 8. Hardcoded passwords required to decrypt the Fake PEM file</figcaption></figure></p>

<h3 id="Deployment-of-LODEINFO-Backdoor-Shellcode-loaded-into-Memory">Deployment of LODEINFO Backdoor Shellcode loaded into Memory</h3>

<p>The data decrypted in step 6 is designed with a unique data structure. Objects such as the malicious <code>Frau.dll</code> are embedded in it for use in the next step. We will explain the details of the structure.</p>

<p><figure class="figure-image figure-image-fotolife" title="図9. Fake PEMファイルから復元されたデータの構造"><span itemscope itemtype="http://schema.org/Photograph"><img src="https://cdn-ak.f.st-hatena.com/images/fotolife/i/ici-blog/20240122/20240122143334.png" width="813" height="308" loading="lazy" title="" class="hatena-fotolife" itemprop="image"></span><figcaption>Figure 9. Structure of the data restored from the Fake PEM file</figcaption></figure></p>

<p>The restored data contains the following multiple objects:</p>

<ul>
<li><code>Elze.exe</code></li>
<li><code>Frau.dll</code></li>
<li><code>Elze.exe_bak</code></li>
</ul>


<p>Each object is created in a file by the Downloader Shellcode and installed on the infected endpoint. Then, <code>Elze.exe</code> is executed. <code>Elze.exe</code> itself is a legitimate file, but it loads the malicious <code>Frau.dll</code> using DLL side-loading. <code>Frau.dll</code> is a very simple malware that loads the LODEINFO Backdoor Shellcode as a payload into memory.</p>

<p>However, in v0.6.6, v0.6.8, and v0.6.9, obfuscation is further strengthened by using Control-Flow  Flattening (CFF) and Junk code. As you can see in the figure below, the left side of the program flow is very complex. The code on the right side of the figure is the part of corresponding code, but most of the code is filled with CFF (<span style="color: #f9ce1d">yellow</span>) and Junk code (<span style="color: #999999">gray</span>), and only a small amount of malicious code (white) is actually used. This also suggests that the attacker is focusing on obstructing analysis.</p>

<p><figure class="figure-image figure-image-fotolife" title="図10. CFFとJunk codeによって難読化されているプログラムフローとコードの例"><span itemscope itemtype="http://schema.org/Photograph"><img src="https://cdn-ak.f.st-hatena.com/images/fotolife/i/ici-blog/20240122/20240122143654.png" width="1199" height="603" loading="lazy" title="" class="hatena-fotolife" itemprop="image"></span><figcaption>Figure 10. Example of a program flow and code obfuscated by CFF and Junk code.</figcaption></figure></p>

<p>Finally, the <code>Elze.exe_bak</code> file, which is data with the LODEINFO Backdoor Shellcode encoded with a single-byte XOR, is read by <code>Frau.dll</code> and decoded as a payload.</p>

<blockquote><p><strong>What is Control-Flow Flattening?</strong>
<br>A technique for making the structure of a program difficult to understand.
<br>Simple processing is replaced with conditional branching and looping, so the processing that flows vertically in the control flow becomes arranged horizontally by conditional branching and looping. As the control flow becomes flat, the program processing flow becomes complicated and difficult to analyze.<br><br><span itemscope itemtype="http://schema.org/Photograph"><img src="https://cdn-ak.f.st-hatena.com/images/fotolife/i/ici-blog/20240122/20240122144234.png" width="606" height="305" loading="lazy" title="" class="hatena-fotolife" itemprop="image"></span>
<a href="https://news.sophos.com/en-us/2022/05/04/attacking-emotets-control-flow-flattening/">Attacking Emotet’s Control Flow Flattening – Sophos News</a></p></blockquote>

<h3 id="Similarities-with-the-known-downloader-DOWNIISSA">Similarities with the known downloader DOWNIISSA</h3>

<p>By conducting a detailed analysis, we confirmed that the Downloader Shellcode we found and the known downloader DOWNIISSA have three similarities.</p>

<p>However, we believe that DOWNIISSA and the Downloader Shellcode we analyzed are from different malware families based on their structure.</p>

<p>Similarities:</p>

<ol>
<li>Self-patching mechanism to hide malicious code</li>
<li>Encoding method for C2 server information</li>
<li>Structure of the data decrypted from the Fake PEM file</li>
</ol>


<blockquote><p><strong>Reference</strong>
<br><a href="https://securelist.com/apt10-tracking-down-lodeinfo-2022-part-i/107742/">APT10: Tracking down LODEINFO 2022, part I</a></p></blockquote>

<p><strong>Similarities 1: Self-patching mechanism to hide malicious code</strong></p>

<p>The first similarity is the patching mechanism to decode the Shellcode itself.</p>

<p>DOWNIISSA, reported in 2022, had a process to patch the Shellcode itself when the Shellcode was executed. The newly found Downloader Shellcode also has a self-patching mechanism.</p>

<p><figure class="figure-image figure-image-fotolife" title="図11. Downloader Shellcodeのセルフパッチ 処理"><span itemscope itemtype="http://schema.org/Photograph"><img src="https://cdn-ak.f.st-hatena.com/images/fotolife/i/ici-blog/20240122/20240122144916.png" width="1000" height="351" loading="lazy" title="" class="hatena-fotolife" itemprop="image"></span><figcaption>Figure 11. The self-patching mechanism in Downloader Shellcode</figcaption></figure></p>

<p>Although it is similar in DOWNIISA that it performs self-patching within the Shellcode, there are also clear differences. DOWNIISSA used Base64, but the current Downloader Shellcode uses XOR decoding. The XOR key is used one by one, increasing from 0x00 to 0xFF.</p>

<p><strong>Similarities 2: Encoding method for the C2 server information</strong></p>

<p>The second similarity is that the encoding method of the C2 server information embedded in the Shellcode is the same. The Downloader Shellcode contains two C2 server addresses, which are encoded with a single-byte XOR. The embedding method is also very similar, not only the encoding method.</p>

<p><figure class="figure-image figure-image-fotolife" title="図12. Downloader Shellcodeに埋め込まれたC2サーバ情報とFake PEMファイル"><span itemscope itemtype="http://schema.org/Photograph"><img src="https://cdn-ak.f.st-hatena.com/images/fotolife/i/ici-blog/20240122/20240122145400.png" width="1153" height="567" loading="lazy" title="" class="hatena-fotolife" itemprop="image"></span><figcaption>Figure 12. C2 server information and the Fake PEM file embedded in the Downloader Shellcode</figcaption></figure></p>

<p><strong>Similarities 3: Structure of the data decrypted from the Fake PEM file</strong></p>

<p>As mentioned above, the structure of the data decrypted from the Fake PEM file is a unique structure, and it has been confirmed that it adopts the same data structure as which decrypted by DOWNIISA.</p>

<h2 id="LODEINFO-Backdoor-Shellcode">LODEINFO Backdoor Shellcode</h2>

<p>LODEINFO Backdoor Shellcode is a fileless malware that allows attackers to remotely access and operate infected hosts. The following features were the same as the published information.</p>

<ul>
<li>The C2 server address uses a unique data structure.</li>
<li>A mechanism that refers to the address of the embedded data is characteristic.</li>
<li>The Backdoor Command ID is hidden using 2-bytes XOR.</li>
<li>The structure and encryption of the communication data with the C2 server are very complex, as shown in the figure below.</li>
<li>The above encryption uses the Vigenere cipher multiple times.</li>
</ul>


<p><figure class="figure-image figure-image-fotolife" title="図13. C2サーバとの通信時に使用する独自のデータ構造と暗号の概略図"><span itemscope itemtype="http://schema.org/Photograph"><img src="https://cdn-ak.f.st-hatena.com/images/fotolife/i/ici-blog/20240122/20240122145653.png" width="1200" height="438" loading="lazy" title="" class="hatena-fotolife" itemprop="image"></span><figcaption>Figure 13. Overview of the unique data structure and encryption used for communication with the C2 server</figcaption></figure></p>

<p>Our analysis of multiple LODEINFO samples found in 2023 revealed the following differences from previously published information:</p>

<ol>
<li>Change in the hash calculation algorithm for obtaining API function names</li>
<li>Addition of backdoor commands</li>
</ol>


<p><strong>Change 1: Change in the hash calculation algorithm for obtaining API function names</strong></p>

<p>The v0.7.0 version uses a new hash calculation algorithm compared to v0.6.9. This change makes it impossible to match signatures using the same rules as previous samples.</p>

<p>The hash calculation algorithm is used by malware to calculate the hash of API function names and resolve function addresses. The hash calculation logic includes a hard-coded XOR key that is different for each sample. This key is used for XOR decoding, so the hash values embedded in each sample are different.</p>

<p><figure class="figure-image figure-image-fotolife" title="図14. ハッシュ計算アルゴリズムの変更"><span itemscope itemtype="http://schema.org/Photograph"><img src="https://cdn-ak.f.st-hatena.com/images/fotolife/i/ici-blog/20240122/20240122145825.png" width="1200" height="781" loading="lazy" title="" class="hatena-fotolife" itemprop="image"></span><figcaption>Figure 14. Change in the hash calculation algorithm </figcaption></figure></p>

<p><strong>Change 2: Additions to backdoor commands</strong></p>

<p>LODEINFO implements the following backdoor commands to control infected hosts:</p>

<p>The number of backdoor commands was reduced to 11 in v0.6.5, but v0.7.1 restored 6 commands and added the new <code>runas</code> command, bringing the total to 18.</p>

<p>Additionally, four commands (<code>keylog</code>, <code>ps</code>, <code>pkill</code>, <code>autorun</code>) that were removed in v0.7.2 and v0.7.3 have been restored.
Furthermore, the content of the <code>config</code> command, which previously displayed "Not Available," has also been implemented.</p>

<table>
<thead>
<tr>
<th style="text-align:left;">Command</th>
<th style="text-align:left;">Descriptions</th>
<th style="text-align:left;">v0.6.5</th>
<th style="text-align:left;">v0.7.1</th>
<th style="text-align:left;">v0.7.2, v0.7.3</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">command</td>
<td style="text-align:left;">List the embedded backdoor commands.</td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;">ls</td>
<td style="text-align:left;">Get a list of files.</td>
<td style="text-align:left;"><span style="color: #999999">Removed</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;">rm</td>
<td style="text-align:left;">Delete a file.</td>
<td style="text-align:left;"><span style="color: #999999">Removed</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;">mv</td>
<td style="text-align:left;">Move a file.</td>
<td style="text-align:left;"><span style="color: #999999">Removed</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;">cp</td>
<td style="text-align:left;">Copy a file.</td>
<td style="text-align:left;"><span style="color: #999999">Removed</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;">cat</td>
<td style="text-align:left;">Upload a file to C2.</td>
<td style="text-align:left;"><span style="color: #999999">Removed</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;">mkdir</td>
<td style="text-align:left;">Create a directory.</td>
<td style="text-align:left;"><span style="color: #999999">Removed</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;">send</td>
<td style="text-align:left;">Download a file from C2.</td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;">recv</td>
<td style="text-align:left;">Upload a file to C2.</td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;">memory</td>
<td style="text-align:left;">Inject Shellcode into memory.</td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;">kill</td>
<td style="text-align:left;">Kill a process by process ID.</td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;">cd</td>
<td style="text-align:left;">Change directory.</td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;">ver</td>
<td style="text-align:left;">Send malware and system information. This includes the current OS version, malware version, process ID, path of the executable file, system username, current directory, C2 and Mutec  names.</td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;">print</td>
<td style="text-align:left;">Take a screenshot of the desktop.</td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;">ransom</td>
<td style="text-align:left;">Encrypt files using a generated AES key, and simultaneously encrypt that AES key using a hardcoded RSA key.</td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;">comc</td>
<td style="text-align:left;">Execute a command using WMI.</td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;"><span style="color: #ff5252">config</span></td>
<td style="text-align:left;">Write settings to the registry (implemented in <span style="color: #ff5252">v0.7.2</span>, this function only returned "Not Available." prior to v0.7.1).</td>
<td style="text-align:left;"><span style="color: #f9ce1d">Not Available</span></td>
<td style="text-align:left;"><span style="color: #f9ce1d">Not Available</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;"><span style="color: #ff5252">runas</span></td>
<td style="text-align:left;">Run a command as a specific user (implemented in <span style="color: #ff5252">v0.7.1</span>).</td>
<td style="text-align:left;">N/A</td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;">keylog</td>
<td style="text-align:left;">Save the keystrokes, date and time, and name of the active window from the suspect endpoint. Use single-byte XOR encryption, and the file is saved to %temp%%hostname%.tmp.</td>
<td style="text-align:left;"><span style="color: #999999">Removed</span></td>
<td style="text-align:left;"><span style="color: #999999">Removed</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;">ps</td>
<td style="text-align:left;">List processes.</td>
<td style="text-align:left;"><span style="color: #999999">Removed</span></td>
<td style="text-align:left;"><span style="color: #999999">Removed</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;">pkill</td>
<td style="text-align:left;">Kill a process.</td>
<td style="text-align:left;"><span style="color: #999999">Removed</span></td>
<td style="text-align:left;"><span style="color: #999999">Removed</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
<tr>
<td style="text-align:left;">autorun</td>
<td style="text-align:left;">Set and remove persistence.</td>
<td style="text-align:left;"><span style="color: #999999">Removed</span></td>
<td style="text-align:left;"><span style="color: #999999">Removed</span></td>
<td style="text-align:left;"><span style="color: #00cccc">Enable</span></td>
</tr>
</tbody>
</table>


<h1 id="Attacker-infrastructure">Attacker infrastructure</h1>

<p>Based on the analysis results of LODEINFO presented so far, we will introduce the characteristics of the communication destinations obtained from each sample.</p>

<p>The trend of the attacker's infrastructure that we observed in 2023 is consistent across versions, and the trend of attackers preferring to use AS-CHOOPA continues.</p>

<p><figure class="figure-image figure-image-fotolife" title="図15. LODEINFOの攻撃者インフラ"><span itemscope itemtype="http://schema.org/Photograph"><img src="https://cdn-ak.f.st-hatena.com/images/fotolife/i/ici-blog/20240122/20240122171356.png" width="1200" height="717" loading="lazy" title="" class="hatena-fotolife" itemprop="image"></span><figcaption>Figure 15. LODEINFO attacker infrastructure.</figcaption></figure></p>

<h1 id="Summary">Summary</h1>

<p>In 2023, multiple versions of LODEINFO were also observed, and v0.7.3 was observed in January 2024. It is important to continue to be careful, as there is a high possibility that various new features and detection evasion techniques will be incorporated in the future.</p>

<p>As a countermeasure, since both the Downloader Shellcode and the Backdoor Shellcode of LODEINFO are fileless malware, it is essential to introduce a product  that can scan and detect malware in memory in order to detect it.
Based on our research results to date, we are not only introducing products  that can scan in memory, but we are also taking various measures that are specialized for LODEINFO. We will continue to expand our research and countermeasures in the future.</p>

<p>We hope to continue to exchange information on the threat of LODEINFO  with the CERTs in organizations that are exposed to the cybersecurity threat and need the analysis.</p>

<p>Finally, two presentations on LODEINFO are scheduled for JSAC2024.</p>

<p>Although the application for participation has ended, some materials will be released later, so please use them to obtain the latest information.</p>

<h1 id="IoCs">IoCs</h1>

<p>MD5 of samples:
<br>69dd7fd355d79db0325816569ae2129a - Maldoc
<br>E82d98bae599cd172bb194adbdc76873 – zip file of above Maldoc
<br>D1a925ddb6d0defc94afb5996ed148bd - Maldoc
<br>9598b2af9dd1493dd213dbca56912af4 - Maldoc
<br>2a9012499d15145b5f63700c05adc426 - Loader module
<br>508aed3687c146c68ad16326568431ab - Loader module
<br>60dea5b5f889f37f5a9196e040bce0eb – BLOB:encrypted LODEINFO v0.6.9
<br>3d910e8ab29362ae36de73c6b70a7e09 – BLOB:encrypted LODEINFO v0.7.1
<br>290c5f33a4f4735e386b8193b1abdcf9 – Artifact:unique data structure for malware set</p>

<p>C2s:
<br>167.179.106[.]224
<br>167.179.77[.]72
<br>172.104.112[.]218
<br>202.182.116[.]25
<br>45.76.197[.]236
<br>45.76.222[.]130
<br>45.77.183[.]161</p>

    




    

  
</div>

    
  <footer class="entry-footer">
    
    <div class="entry-tags-wrapper">
  <div class="entry-tags">
      <span class="entry-tag">
        <a href="https://d.hatena.ne.jp/keyword/APT" class="entry-tag-link">
          
          
          <span class="entry-tag-icon">#</span><span class="entry-tag-label">APT</span>
        </a>
      </span>
    
      <span class="entry-tag">
        <a href="https://d.hatena.ne.jp/keyword/Targeted%20Attack" class="entry-tag-link">
          
          
          <span class="entry-tag-icon">#</span><span class="entry-tag-label">Targeted Attack</span>
        </a>
      </span>
    
      <span class="entry-tag">
        <a href="https://d.hatena.ne.jp/keyword/Blue%20Team" class="entry-tag-link">
          
          
          <span class="entry-tag-icon">#</span><span class="entry-tag-label">Blue Team</span>
        </a>
      </span>
    
      <span class="entry-tag">
        <a href="https://d.hatena.ne.jp/keyword/LODEINFO" class="entry-tag-link">
          
          
          <span class="entry-tag-icon">#</span><span class="entry-tag-label">LODEINFO</span>
        </a>
      </span>
    
      <span class="entry-tag">
        <a href="https://d.hatena.ne.jp/keyword/DOWNIISSA" class="entry-tag-link">
          
          
          <span class="entry-tag-icon">#</span><span class="entry-tag-label">DOWNIISSA</span>
        </a>
      </span>
    
      <span class="entry-tag">
        <a href="https://d.hatena.ne.jp/keyword/Malware%20Analysis" class="entry-tag-link">
          
          
          <span class="entry-tag-icon">#</span><span class="entry-tag-label">Malware Analysis</span>
        </a>
      </span>
      </div>
</div>

    <p class="entry-footer-section track-inview-by-gtm" data-gtm-track-json="{&quot;area&quot;: &quot;finish_reading&quot;}">
  <span class="author vcard"><span class="fn" data-load-nickname="1" data-user-name="ici-blog" >ici-blog</span></span>
  <span class="entry-footer-time"><a href="https://blog-en.itochuci.co.jp/entry/2024/01/24/134100"><time data-relative datetime="2024-01-24T04:41:00Z" title="2024-01-24T04:41:00Z" class="updated">2024-01-24 13:41</time></a></span>
  
  
  
</p>

    

    
<div class="social-buttons">
  
  
  
    <div class="social-button-item">
      <div class="fb-share-button" data-layout="box_count" data-href="https://blog-en.itochuci.co.jp/entry/2024/01/24/134100"></div>
    </div>
  
  
    <div class="social-button-item">
      <a
          class="entry-share-button entry-share-button-twitter test-share-button-twitter"
          href="https://x.com/intent/tweet?hashtags=APT&amp;hashtags=Targeted+Attack&amp;hashtags=Blue+Team&amp;hashtags=LODEINFO&amp;hashtags=DOWNIISSA&amp;hashtags=Malware+Analysis&amp;text=The+Endless+Struggle+Against+APT10%3A+Insights+from+LODEINFO+v0.6.6+-+v0.7.3+Analysis+-++Researcher+Blog+-+ITOCHU+Cyber+%26+Intelligence+Inc.+&amp;url=https%3A%2F%2Fblog-en.itochuci.co.jp%2Fentry%2F2024%2F01%2F24%2F134100"
          title="X（Twitter）で投稿する"
        ></a>
    </div>
  
  
  
  
  
  
</div>

    

    <div class="customized-footer">
      

        

        
        

      
    </div>
    
  <div class="comment-box js-comment-box">
    
    <ul class="comment js-comment">
      <li class="read-more-comments" style="display: none;"><a>もっと読む</a></li>
    </ul>
    
      <a class="leave-comment-title js-leave-comment-title">コメントを書く</a>
    
  </div>

  </footer>

  </div>
</article>

      
      
    
  

  
  <!-- rakuten_ad_target_end -->
  <!-- google_ad_section_end -->
  
  
  
  <div class="pager pager-permalink permalink">
    
      
      <span class="pager-prev">
        <a href="https://blog-en.itochuci.co.jp/entry/2024/05/15/170016" rel="prev">
          <span class="pager-arrow">&laquo; </span>
          Unraveling the Shinigami&#39;s prank hidden…
        </a>
      </span>
    
    
      
      <span class="pager-next">
        <a href="https://blog-en.itochuci.co.jp/entry/2023/10/06/173200" rel="next">
          Sequel: Gifts from Tropical Pirates - W…
          <span class="pager-arrow"> &raquo;</span>
        </a>
      </span>
    
  </div>


  



        </div>
      </div>

      <aside id="box1">
  <div id="box1-inner">
  </div>
</aside>

    </div><!-- #wrapper -->

    
<aside id="box2">
  
  <div id="box2-inner">
    
      
<div class="hatena-module hatena-module-html">
    <div class="hatena-module-title">Subscribe</div>
  <div class="hatena-module-body">
    <a href="https://blog.hatena.ne.jp/itochuci/itochuci-en.hatenadiary.com/subscribe?utm_campaign=subscribe_blog&amp;utm_source=blogs_topright_button&amp;utm_medium=button">Subscribe</a>
  </div>
</div>

    
      <div class="hatena-module hatena-module-recent-entries ">
  <div class="hatena-module-title">
    <a href="https://blog-en.itochuci.co.jp/archive">
      Recent Articles
    </a>
  </div>
  <div class="hatena-module-body">
    <ul class="recent-entries hatena-urllist urllist-with-thumbnails">
  
  
    
    <li class="urllist-item recent-entries-item">
      <div class="urllist-item-inner recent-entries-item-inner">
        
          
                      <a class="urllist-image-link recent-entries-image-link" href="https://blog-en.itochuci.co.jp/entry/2024/05/23/090000">
  <img alt="Malware Transmutation! - Unveiling the Hidden Traces of BloodAlchemy" src="https://cdn.image.st-hatena.com/image/square/f98bdf02c4a30022135bd4c48bdefec10566409e/backend=imagemagick;height=80;version=1;width=80/https%3A%2F%2Fcdn-ak.f.st-hatena.com%2Fimages%2Ffotolife%2Fi%2Fici-blog%2F20240517%2F20240517132148.png" class="urllist-image recent-entries-image" title="Malware Transmutation! - Unveiling the Hidden Traces of BloodAlchemy" width="80" height="80" loading="lazy">
</a>
            <div class="urllist-date-link recent-entries-date-link">
  <a href="https://blog-en.itochuci.co.jp/archive/2024/05/23" rel="nofollow">
    <time datetime="2024-05-23T00:00:00Z" title="2024-05-23T00:00:00Z">
      2024-05-23
    </time>
  </a>
</div>

          <a href="https://blog-en.itochuci.co.jp/entry/2024/05/23/090000" class="urllist-title-link recent-entries-title-link  urllist-title recent-entries-title">Malware Transmutation! - Unveiling the Hidden Traces of BloodAlchemy</a>


          
          

                </div>
    </li>
  
    
    <li class="urllist-item recent-entries-item">
      <div class="urllist-item-inner recent-entries-item-inner">
        
          
                      <a class="urllist-image-link recent-entries-image-link" href="https://blog-en.itochuci.co.jp/entry/2024/05/15/170016">
  <img alt="Unraveling the Shinigami&#39;s prank hidden in spam emails" src="https://cdn.image.st-hatena.com/image/square/178de3e4ca24ace00bf0eaf48b6f21a0faba1571/backend=imagemagick;height=80;version=1;width=80/https%3A%2F%2Fcdn-ak.f.st-hatena.com%2Fimages%2Ffotolife%2Fi%2Fici-blog%2F20240415%2F20240415100218.png" class="urllist-image recent-entries-image" title="Unraveling the Shinigami&#39;s prank hidden in spam emails" width="80" height="80" loading="lazy">
</a>
            <div class="urllist-date-link recent-entries-date-link">
  <a href="https://blog-en.itochuci.co.jp/archive/2024/05/15" rel="nofollow">
    <time datetime="2024-05-15T08:00:16Z" title="2024-05-15T08:00:16Z">
      2024-05-15
    </time>
  </a>
</div>

          <a href="https://blog-en.itochuci.co.jp/entry/2024/05/15/170016" class="urllist-title-link recent-entries-title-link  urllist-title recent-entries-title">Unraveling the Shinigami&#39;s prank hidden in spam emails</a>


          
          

                </div>
    </li>
  
    
    <li class="urllist-item recent-entries-item">
      <div class="urllist-item-inner recent-entries-item-inner">
        
          
                      <a class="urllist-image-link recent-entries-image-link" href="https://blog-en.itochuci.co.jp/entry/2024/01/24/134100">
  <img alt="The Endless Struggle Against APT10: Insights from LODEINFO v0.6.6 - v0.7.3 Analysis" src="https://cdn.image.st-hatena.com/image/square/d66338f9cb1a449df75d33fbc0a1041d571846c7/backend=imagemagick;height=80;version=1;width=80/https%3A%2F%2Fcdn-ak.f.st-hatena.com%2Fimages%2Ffotolife%2Fi%2Fici-blog%2F20240122%2F20240122134753.png" class="urllist-image recent-entries-image" title="The Endless Struggle Against APT10: Insights from LODEINFO v0.6.6 - v0.7.3 Analysis" width="80" height="80" loading="lazy">
</a>
            <div class="urllist-date-link recent-entries-date-link">
  <a href="https://blog-en.itochuci.co.jp/archive/2024/01/24" rel="nofollow">
    <time datetime="2024-01-24T04:41:00Z" title="2024-01-24T04:41:00Z">
      2024-01-24
    </time>
  </a>
</div>

          <a href="https://blog-en.itochuci.co.jp/entry/2024/01/24/134100" class="urllist-title-link recent-entries-title-link  urllist-title recent-entries-title">The Endless Struggle Against APT10: Insights from LODEINFO v0.6.6 - v0.7.3 Analysis</a>


          
          

                </div>
    </li>
  
    
    <li class="urllist-item recent-entries-item">
      <div class="urllist-item-inner recent-entries-item-inner">
        
          
                      <a class="urllist-image-link recent-entries-image-link" href="https://blog-en.itochuci.co.jp/entry/2023/10/06/173200">
  <img alt="Sequel: Gifts from Tropical Pirates - Who is the Sender? Look for the Attacker Group" src="https://cdn.image.st-hatena.com/image/square/caef3171bbe570917b38002822224f118c0ce549/backend=imagemagick;height=80;version=1;width=80/https%3A%2F%2Fcdn-ak.f.st-hatena.com%2Fimages%2Ffotolife%2Fi%2Fici-blog%2F20231005%2F20231005214749.png" class="urllist-image recent-entries-image" title="Sequel: Gifts from Tropical Pirates - Who is the Sender? Look for the Attacker Group" width="80" height="80" loading="lazy">
</a>
            <div class="urllist-date-link recent-entries-date-link">
  <a href="https://blog-en.itochuci.co.jp/archive/2023/10/06" rel="nofollow">
    <time datetime="2023-10-06T08:32:00Z" title="2023-10-06T08:32:00Z">
      2023-10-06
    </time>
  </a>
</div>

          <a href="https://blog-en.itochuci.co.jp/entry/2023/10/06/173200" class="urllist-title-link recent-entries-title-link  urllist-title recent-entries-title">Sequel: Gifts from Tropical Pirates - Who is the Sender? Look for the Attacker Group</a>


          
          

                </div>
    </li>
  
    
    <li class="urllist-item recent-entries-item">
      <div class="urllist-item-inner recent-entries-item-inner">
        
          
                      <a class="urllist-image-link recent-entries-image-link" href="https://blog-en.itochuci.co.jp/entry/2023/09/28/171001">
  <img alt="Gifts from Tropical Pirates -New Dangerous Weapons Hidden in Email and Malware" src="https://cdn.image.st-hatena.com/image/square/a9cafc4ba2ffeef6f806f4ad04649cb3f5a5cc47/backend=imagemagick;height=80;version=1;width=80/https%3A%2F%2Fcdn-ak.f.st-hatena.com%2Fimages%2Ffotolife%2Fi%2Fici-iida%2F20230928%2F20230928111159.png" class="urllist-image recent-entries-image" title="Gifts from Tropical Pirates -New Dangerous Weapons Hidden in Email and Malware" width="80" height="80" loading="lazy">
</a>
            <div class="urllist-date-link recent-entries-date-link">
  <a href="https://blog-en.itochuci.co.jp/archive/2023/09/28" rel="nofollow">
    <time datetime="2023-09-28T08:10:01Z" title="2023-09-28T08:10:01Z">
      2023-09-28
    </time>
  </a>
</div>

          <a href="https://blog-en.itochuci.co.jp/entry/2023/09/28/171001" class="urllist-title-link recent-entries-title-link  urllist-title recent-entries-title">Gifts from Tropical Pirates -New Dangerous Weapons Hidden in Email and Malware</a>


          
          

                </div>
    </li>
  
</ul>

      </div>
</div>

    
      <div class="hatena-module hatena-module-search-box">
  <div class="hatena-module-title">
    Search
  </div>
  <div class="hatena-module-body">
    <form class="search-form" role="search" action="https://blog-en.itochuci.co.jp/search" method="get">
  <input type="text" name="q" class="search-module-input" value="" placeholder="記事を検索" required>
  <input type="submit" value="検索" class="search-module-button" />
</form>

  </div>
</div>

    
      

<div class="hatena-module hatena-module-category">
  <div class="hatena-module-title">
    Categories
  </div>
  <div class="hatena-module-body">
    <ul class="hatena-urllist">
      
    </ul>
  </div>
</div>

    
      

<div class="hatena-module hatena-module-archive" data-archive-type="default" data-archive-url="https://blog-en.itochuci.co.jp/archive">
  <div class="hatena-module-title">
    <a href="https://blog-en.itochuci.co.jp/archive">Archive</a>
  </div>
  <div class="hatena-module-body">
    
      
        <ul class="hatena-urllist">
          
            <li class="archive-module-year archive-module-year-hidden" data-year="2024">
              <div class="archive-module-button">
                <span class="archive-module-hide-button">▼</span>
                <span class="archive-module-show-button">▶</span>
              </div>
              <a href="https://blog-en.itochuci.co.jp/archive/2024" class="archive-module-year-title archive-module-year-2024">
                2024
              </a>
              <ul class="archive-module-months">
                
                  <li class="archive-module-month">
                    <a href="https://blog-en.itochuci.co.jp/archive/2024/05" class="archive-module-month-title archive-module-month-2024-5">
                      2024 / 5
                    </a>
                  </li>
                
                  <li class="archive-module-month">
                    <a href="https://blog-en.itochuci.co.jp/archive/2024/01" class="archive-module-month-title archive-module-month-2024-1">
                      2024 / 1
                    </a>
                  </li>
                
              </ul>
            </li>
          
            <li class="archive-module-year archive-module-year-hidden" data-year="2023">
              <div class="archive-module-button">
                <span class="archive-module-hide-button">▼</span>
                <span class="archive-module-show-button">▶</span>
              </div>
              <a href="https://blog-en.itochuci.co.jp/archive/2023" class="archive-module-year-title archive-module-year-2023">
                2023
              </a>
              <ul class="archive-module-months">
                
                  <li class="archive-module-month">
                    <a href="https://blog-en.itochuci.co.jp/archive/2023/10" class="archive-module-month-title archive-module-month-2023-10">
                      2023 / 10
                    </a>
                  </li>
                
                  <li class="archive-module-month">
                    <a href="https://blog-en.itochuci.co.jp/archive/2023/09" class="archive-module-month-title archive-module-month-2023-9">
                      2023 / 9
                    </a>
                  </li>
                
              </ul>
            </li>
          
        </ul>
      
    
  </div>
</div>

    
      <div class="hatena-module hatena-module-recent-entries  hatena-module-custom-mv">
  <div class="hatena-module-title">
    <a href="https://blog-en.itochuci.co.jp/archive">
      MV
    </a>
  </div>
  <div class="hatena-module-body">
    <ul class="recent-entries hatena-urllist urllist-with-thumbnails">
  
  
    
    <li class="urllist-item recent-entries-item">
      <div class="urllist-item-inner recent-entries-item-inner">
        
          <div class="mvNode js-mvNode swiper-slide">
  <a class="mvNode_img" href="https://blog-en.itochuci.co.jp/entry/2024/05/23/090000"><img src="https://cdn.image.st-hatena.com/image/square/94cafee4262e9ecb0bb384fc6358c5e83ad6fe1f/backend=imagemagick;height=482;version=1;width=856/https%3A%2F%2Fcdn-ak.f.st-hatena.com%2Fimages%2Ffotolife%2Fi%2Fici-blog%2F20240517%2F20240517132148.png" alt="Malware Transmutation! - Unveiling the Hidden Traces of BloodAlchemy"></a>
  <div class="mvNode_inner">
    <div class="mvNode_info">
      <p class="mvNode_date">2024-05-23</p>
      <p class="mvNode_category">
</p>
    </div>
    <a class="mvNode_title" href="https://blog-en.itochuci.co.jp/entry/2024/05/23/090000">Malware Transmutation! - Unveiling the Hidden Traces of BloodAlchemy</a>
  </div>
</div>
              </div>
    </li>
  
    
    <li class="urllist-item recent-entries-item">
      <div class="urllist-item-inner recent-entries-item-inner">
        
          <div class="mvNode js-mvNode swiper-slide">
  <a class="mvNode_img" href="https://blog-en.itochuci.co.jp/entry/2024/05/15/170016"><img src="https://cdn.image.st-hatena.com/image/square/61dd35af85dfdcbe91bc10271be8fbde0c234a6a/backend=imagemagick;height=482;version=1;width=856/https%3A%2F%2Fcdn-ak.f.st-hatena.com%2Fimages%2Ffotolife%2Fi%2Fici-blog%2F20240415%2F20240415100218.png" alt="Unraveling the Shinigami&#39;s prank hidden in spam emails"></a>
  <div class="mvNode_inner">
    <div class="mvNode_info">
      <p class="mvNode_date">2024-05-15</p>
      <p class="mvNode_category">
</p>
    </div>
    <a class="mvNode_title" href="https://blog-en.itochuci.co.jp/entry/2024/05/15/170016">Unraveling the Shinigami&#39;s prank hidden in spam emails</a>
  </div>
</div>
              </div>
    </li>
  
    
    <li class="urllist-item recent-entries-item">
      <div class="urllist-item-inner recent-entries-item-inner">
        
          <div class="mvNode js-mvNode swiper-slide">
  <a class="mvNode_img" href="https://blog-en.itochuci.co.jp/entry/2024/01/24/134100"><img src="https://cdn.image.st-hatena.com/image/square/556b161b9cb84ef76911cb8bb214b35de500df3a/backend=imagemagick;height=482;version=1;width=856/https%3A%2F%2Fcdn-ak.f.st-hatena.com%2Fimages%2Ffotolife%2Fi%2Fici-blog%2F20240122%2F20240122134753.png" alt="The Endless Struggle Against APT10: Insights from LODEINFO v0.6.6 - v0.7.3 Analysis"></a>
  <div class="mvNode_inner">
    <div class="mvNode_info">
      <p class="mvNode_date">2024-01-24</p>
      <p class="mvNode_category">
</p>
    </div>
    <a class="mvNode_title" href="https://blog-en.itochuci.co.jp/entry/2024/01/24/134100">The Endless Struggle Against APT10: Insights from LODEINFO v0.6.6 - v0.7.3 Analysis</a>
  </div>
</div>
              </div>
    </li>
  
    
    <li class="urllist-item recent-entries-item">
      <div class="urllist-item-inner recent-entries-item-inner">
        
          <div class="mvNode js-mvNode swiper-slide">
  <a class="mvNode_img" href="https://blog-en.itochuci.co.jp/entry/2023/10/06/173200"><img src="https://cdn.image.st-hatena.com/image/square/c760d1a07d0f84ef3728122f4d6da476fd50cd31/backend=imagemagick;height=482;version=1;width=856/https%3A%2F%2Fcdn-ak.f.st-hatena.com%2Fimages%2Ffotolife%2Fi%2Fici-blog%2F20231005%2F20231005214749.png" alt="Sequel: Gifts from Tropical Pirates - Who is the Sender? Look for the Attacker Group"></a>
  <div class="mvNode_inner">
    <div class="mvNode_info">
      <p class="mvNode_date">2023-10-06</p>
      <p class="mvNode_category">
</p>
    </div>
    <a class="mvNode_title" href="https://blog-en.itochuci.co.jp/entry/2023/10/06/173200">Sequel: Gifts from Tropical Pirates - Who is the Sender? Look for the Attacker Group</a>
  </div>
</div>
              </div>
    </li>
  
</ul>

      </div>
</div>

    
      
<div class="hatena-module hatena-module-html hatena-module-custom-hotTopic">
    <div class="hatena-module-title">Trending Articles</div>
  <div class="hatena-module-body">
    <div class="hotTopic_wrapper js-hotTopic_wrapper swiper">
  <ul class="hotTopic swiper-wrapper">
    <li class="hotTopic_node swiper-slide">
      <a href="/" class="entry-thumb-link">
        <div class="entry-thumb" style="background-image: url('');">
        </div>
      </a>
    </li>
    <li class="hotTopic_node swiper-slide">
      <a href="/" class="entry-thumb-link">
        <div class="entry-thumb" style="background-image: url('');">
        </div>
      </a>
    </li>
    <li class="hotTopic_node swiper-slide">
      <a href="/" class="entry-thumb-link">
        <div class="entry-thumb" style="background-image: url('');">
        </div>
      </a>
    </li>
  </ul>
</div>
<div class="hotTopic-pagination-wrapper"><div class="hotTopic-pagination"></div></div>
  </div>
</div>

    
    
  </div>
</aside>


  </div>
</div>




      

      
  <div id="bottom-editarea">
    <div class="footer"><p class="footerCopy">©︎ITOCHU Cyber &amp; Intelligence Inc.</p></div>

<script src="https://blog-cdn.itochuci.co.jp/lib.js"></script>
<script src="https://blog-cdn.itochuci.co.jp/script.js"></script>

  </div>


    </div>
  </div>
  

  

  

  
    <div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/ja_JP/sdk.js#xfbml=1&appId=719729204785177&version=v17.0";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

  
  

<div class="quote-box">
  <div class="tooltip-quote tooltip-quote-stock">
    <i class="blogicon-quote" title="引用をストック"></i>
  </div>
  <div class="tooltip-quote tooltip-quote-tweet js-tooltip-quote-tweet">
    <a class="js-tweet-quote" target="_blank" data-track-name="quote-tweet" data-track-once>
      <img src="https://cdn.blog.st-hatena.com/images/admin/quote/quote-x-icon.svg?version=6fa44cc191e4c8dbcb011e13d2e9bb" title="引用して投稿する" >
    </a>
  </div>
</div>

<div class="quote-stock-panel" id="quote-stock-message-box" style="position: absolute; z-index: 3000">
  <div class="message-box" id="quote-stock-succeeded-message" style="display: none">
    <p>引用をストックしました</p>
    <button class="btn btn-primary" id="quote-stock-show-editor-button" data-track-name="curation-quote-edit-button">ストック一覧を見る</button>
    <button class="btn quote-stock-close-message-button">閉じる</button>
  </div>

  <div class="message-box" id="quote-login-required-message" style="display: none">
    <p>引用するにはまずログインしてください</p>
    <button class="btn btn-primary" id="quote-login-button">ログイン</button>
    <button class="btn quote-stock-close-message-button">閉じる</button>
  </div>

  <div class="error-box" id="quote-stock-failed-message" style="display: none">
    <p>引用をストックできませんでした。再度お試しください</p>
    <button class="btn quote-stock-close-message-button">閉じる</button>
  </div>

  <div class="error-box" id="unstockable-quote-message-box" style="display: none; position: absolute; z-index: 3000;">
    <p>限定公開記事のため引用できません。</p>
  </div>
</div>

<script type="x-underscore-template" id="js-requote-button-template">
  <div class="requote-button js-requote-button">
    <button class="requote-button-btn tipsy-top" title="引用する"><i class="blogicon-quote"></i></button>
  </div>
</script>



  
  <div id="hidden-subscribe-button" style="display: none;">
    <div class="hatena-follow-button-box btn-subscribe js-hatena-follow-button-box"
  
  >

  <a href="#" class="hatena-follow-button js-hatena-follow-button">
    <span class="subscribing">
      <span class="foreground">読者です</span>
      <span class="background">読者をやめる</span>
    </span>
    <span class="unsubscribing" data-track-name="profile-widget-subscribe-button" data-track-once>
      <span class="foreground">読者になる</span>
      <span class="background">読者になる</span>
    </span>
  </a>
  <div class="subscription-count-box js-subscription-count-box">
    <i></i>
    <u></u>
    <span class="subscription-count js-subscription-count">
    </span>
  </div>
</div>

  </div>

  



    


  <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<script src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>


<script type="text/javascript" src="https://cdn.blog.st-hatena.com/js/external/jquery.min.js?v=1.12.4&amp;version=6fa44cc191e4c8dbcb011e13d2e9bb"></script>







<script src="https://cdn.blog.st-hatena.com/js/texts-ja.js?version=6fa44cc191e4c8dbcb011e13d2e9bb"></script>



  <script id="vendors-js" data-env="production" src="https://cdn.blog.st-hatena.com/js/vendors.js?version=6fa44cc191e4c8dbcb011e13d2e9bb" crossorigin="anonymous"></script>

<script id="hatenablog-js" data-env="production" src="https://cdn.blog.st-hatena.com/js/hatenablog.js?version=6fa44cc191e4c8dbcb011e13d2e9bb" crossorigin="anonymous" data-page-id="entry"></script>


  <script>Hatena.Diary.GlobalHeader.init()</script>







    

    





  </body>
</html>

