<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">
    <link rel="preconnect" href="https://www.paloaltonetworks.com">
    <link rel="preconnect" href="https://cdn.cookielaw.org">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	    <!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
var main_site_url = 'https://www.paloaltonetworks.com';
var maindomain_lang = 'https://www.paloaltonetworks.com';
function getParameterByName(name, url) {
		if(url == null){
		  url = window.location.href;
		}
	    name = name.replace(/[\[\]]/g, '\\$&');
	    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
		results = regex.exec(url);
	    if (!results) return null;
	    if (!results[2]) return '';
	    return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	var container_q = getParameterByName('container');
	var d_lang = 'en';	
	if(container_q != '' && container_q != null){	    
	    sessionStorage.setItem('container',container_q);
	    	    location.href = 'https://unit42.paloaltonetworks.com/global-protect-vpn-spoof-distributes-wikiloader';
	}
</script>

<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css"></noscript>
  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/global-protect-vpn-spoof-distributes-wikiloader/" />
<link rel="alternate" hreflang="x-default" href="https://unit42.paloaltonetworks.com/global-protect-vpn-spoof-distributes-wikiloader/" />

	<!-- This site is optimized with the Yoast SEO Premium plugin v23.1 (Yoast SEO v23.1) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant</title>
	<meta name="description" content="Unit 42 discusses WikiLoader malware spoofing GlobalProtect VPN, detailing evasion techniques, malicious URLs, and mitigation strategies. Unit 42 discusses WikiLoader malware spoofing GlobalProtect VPN, detailing evasion techniques, malicious URLs, and mitigation strategies." />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/global-protect-vpn-spoof-distributes-wikiloader/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant" />
	<meta property="og:description" content="Unit 42 discusses WikiLoader malware spoofing GlobalProtect VPN, detailing evasion techniques, malicious URLs, and mitigation strategies. Unit 42 discusses WikiLoader malware spoofing GlobalProtect VPN, detailing evasion techniques, malicious URLs, and mitigation strategies." />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/global-protect-vpn-spoof-distributes-wikiloader/" />
	<meta property="og:site_name" content="Unit 42" />
	<meta property="article:published_time" content="2024-09-02T10:00:38+00:00" />
	<meta property="article:modified_time" content="2024-09-10T13:44:53+00:00" />
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900.jpg" />
	<meta property="og:image:width" content="1920" />
	<meta property="og:image:height" content="900" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="Mark Lim, Tom Marsden" />
	<meta name="twitter:card" content="summary_large_image" />
	<!-- / Yoast SEO Premium plugin. -->


<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Feed" href="https://unit42.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Comments Feed" href="https://unit42.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant Comments Feed" href="https://unit42.paloaltonetworks.com/global-protect-vpn-spoof-distributes-wikiloader/feed/" />
<script type="text/javascript">
var globalConfig = {};
var webData = {};
webData.channel = "unit42";
webData.property = "unit42.paloaltonetworks.com";
webData.language = "en_us";
webData.pageType = "blogs";
webData.pageName = "unit42:global-protect-vpn-spoof-distributes-wikiloader";
webData.pageURL = "https://unit42.paloaltonetworks.com/global-protect-vpn-spoof-distributes-wikiloader";
webData.article_title = "Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant";
webData.author = "Mark Lim,Tom Marsden";
webData.published_time = "2024-09-02T03:00:38-07:00";
webData.description = "%%excerpt%% Unit 42 discusses WikiLoader malware spoofing GlobalProtect VPN, detailing evasion techniques, malicious URLs, and mitigation strategies.";
webData.keywords = "Malware,Threat Research,DLL Sideloading,Emotet,Evasion,Loader as a service,malvertising,SEO poisoning,Spoof,WailingCrab,WikiLoader";
webData.resourceAssetID = "db95de3bc1bccb3725f74dc95e40873b";
</script>
<script type="text/javascript">
var globalConfig = {};
globalConfig.buildName = "UniqueResourceAssetsID_DEC022022";
</script>
<meta property="og:likes" content="0"/>
<meta property="og:readtime" content="12"/>
<meta property="og:views" content="8,987"/>
<meta property="og:date_created" content="September 2, 2024 at 3:00 AM"/>
<meta property="og:post_length" content="3992"/>
<meta property="og:category" content="Malware"/>
<meta property="og:category" content="Threat Research"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/malware/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-research/"/>
<meta property="og:author" content="Mark Lim"/>
<meta property="og:author" content="Tom Marsden"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/mark-lim/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta name="post_tags" content="DLL Sideloading,Emotet,Evasion,Loader as a service,malvertising,SEO poisoning,Spoof,WailingCrab,WikiLoader"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant","name":"Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant","description":"Unit 42 discusses WikiLoader malware spoofing GlobalProtect VPN, detailing evasion techniques, malicious URLs, and mitigation strategies.","url":"https:\/\/unit42.paloaltonetworks.com\/global-protect-vpn-spoof-distributes-wikiloader\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/global-protect-vpn-spoof-distributes-wikiloader\/","datePublished":"September 2, 2024","articleBody":"Executive Summary\r\nThe Unit 42 Managed Threat Hunting team (MTH) identified a variant of WikiLoader loader for rent (aka WailingCrab) being delivered via SEO poisoning and spoofing our GlobalProtect VPN software. Analysis conducted by the Advanced WildFire reverse engineering team has uncovered the latest evasion techniques for WikiLoader, providing new insights into its evolution.\r\n\r\nWe provide multiple XQL queries for Cortex to hunt for this WikiLoader campaign. We also provide hashes that identify samples found in the wild as well as command and control (C2) URLs extracted from the original sample that spoofed GlobalProtect.\r\n\r\nPalo Alto Networks customers are better protected from the threats discussed in this article through detection mechanisms available from the following products:\r\n\r\n \tCortex XDR and XSIAM\r\n \tNext-Generation Firewall with Cloud-Delivered Security Services\r\n \tAdvanced WildFire\r\n \tAdvanced DNS Security\r\n \tAdvanced URL Filtering\r\n \tThe Prisma Cloud Cloud Security Agent (CSA)\r\n\r\nAdditionally, Google has confirmed that all sites mentioned in this article are known to Safe Browsing. Any user that visits these sites will receive a warning of potential security risks.\r\n\r\n\r\n\r\nRelated Unit 42 Topics\r\nMalvertising, DLL Sideloading\r\n\r\n\r\n\r\nOverview of Tradecraft Used by WikiLoader in Campaigns Spoofing GlobalProtect\r\nWikiLoader is a multistage malware loader that adversaries developed with consideration toward evasion. Our industry partners have documented this threat well. As such, we\u2019ll focus on the specific tradecraft we observed related to campaigns spoofing GlobalProtect, anti-analysis techniques employed by the loader and resources for threat hunters.\r\n\r\nProofpoint has reported WikiLoader has been active since at least late 2022. They also noted that phishing was initially the primary means of delivery. Its operators used compromised WordPress sites and public MQ Telemetry Transport (MQTT) brokers for C2.\r\n\r\nWe have not observed the follow-on payloads from complete WikiLoader infections. However, Proofpoint reported attackers used the threat to deliver banking Trojans such as Danabot and Ursnif\/Gozi to organizations based in Italy.\r\n\r\nIn June 2024, we observed a WikiLoader campaign leveraging GlobalProtect themed SEO poisoning, rather than using previously documented phishing tactics. SEO poisoning is the process of getting an attacker-controlled site on the front page of search engine results for a legitimate product through purchasing advertisements or improving page rank.\r\n\r\nAttackers commonly use SEO poisoning as an initial access vector to trick people into visiting a page that spoofs the legitimate search result to deliver malware rather than the searched-for product. This campaign\u2019s delivery infrastructure leveraged cloned websites relabeled as GlobalProtect along with cloud-based Git repositories.\r\n\r\nUnit 42 primarily observed WikiLoader affecting the U.S. higher education and transportation sectors. However, the use of SEO poisoning for delivery almost certainly broadens the scope of possible victims as compared to phishing.\r\n\r\nWikiLoader is a loader for rent, which is suspected to be leveraged by at least two initial access brokers (IABs). Attribution for this specific campaign requires further research. However, we do make the following observations.\r\n\r\n \tCampaigns leveraging WikiLoader and spoofing GlobalProtect have shown reasonable regard for evasion\r\n \tThe threat operators show an awareness of simple techniques that, when executed well, make machine and signature-based detection of such threats difficult\r\n\r\nSuch OPSEC considerations include:\r\n\r\n \tUsing the MQTT internet of things (IoT) event queue protocol for C2\r\n \tTyposquatting and spoofing download pages modified to deliver WikiLoader throughout the life of a campaign\r\n \tUsing legitimate sites running vulnerable, third-party WordPress plugins as C2 infrastructure\r\n \tUsing cloud-hosted Git solutions to host malicious content\r\n \tUsing legitimate, signed binaries for sideloading WikiLoader\r\n \tUsing common file names associated with security tooling, where allowlistings in security products would reduce detection and response efficacy\r\n \tEmbedding payloads in seemingly benign file names and types\r\n \tHiding attributes for all files except the file that receives user interaction\r\n \tEncrypting shellcode that is stored in separate binaries from the WikiLoader executables\r\n \tDecrypting keys for shellcode that operators stored in the C2 servers\r\n \tPerforming multiple anti-analysis checks\r\n \tDisplaying fake error messages on execution\r\n\r\nFigure 1 provides a summary of the infection chain.\r\n\r\n[caption id=\"attachment_136557\" align=\"alignnone\" width=\"785\"] Figure 1. Attack diagram from the delivery through WikiLoader backdoor Execution. Source: Inspired by attack flow detailed in AhnLab blog, \"'Totally Unexpected' Package Malware Using Modified Notepad++ Plug-in (WikiLoader).\"[\/caption]\r\nDelivery and Execution\r\nThe following section details the execution of WikiLoader as delivered through GlobalProtect-based SEO poisoning.\r\n\r\nThe advertisements we observed linked to multiple fake sites serving spoofed GlobalProtect installers. Figure 2 shows a malicious advertisement that attackers used to lure victims to a spoofed GlobalProtect download page.\r\n\r\n[caption id=\"attachment_136559\" align=\"alignnone\" width=\"782\"] Figure 2. Google ad linked to the websites to download spoofed GlobalProtect.[\/caption]\r\n\r\n The first site is a clone of a legitimate business that fetches the malicious payload upon download shown in Figure 3. Bitbucket took the site offline when we notified them of it.\r\n\r\n[caption id=\"attachment_136561\" align=\"alignnone\" width=\"784\"] Figure 3. A cloned website that directs users to download the spoofed GlobalProtect installer hosted on Bitbucket.[\/caption]\r\n\r\n The second site shown in Figure 4 is a site that spoofs the GlobalProtect client download page.\r\n\r\n&nbsp;\r\n\r\n[caption id=\"attachment_136563\" align=\"alignnone\" width=\"786\"] Figure 4. A cloned GlobalProtect page that directs users to download spoofed GlobalProtect installers.[\/caption]\r\n\r\nUpon download, Cortex XDR shows the following information associated with Chrome where the sample is enriched with Mark of the Web (MotW) data as shown in Figure 5. MotW is a security feature in Windows that adds metadata to files downloaded from the internet to indicate a potentially unsafe source. Analysts can use this information to assist in understanding the source of a file, and where someone may have been browsing before downloading the file.\r\n\r\n[caption id=\"attachment_136565\" align=\"alignnone\" width=\"786\"] Figure 5. File write and read of the GlobalProtect64.zip file enriched with MotW data streams indicating one of the download URLs in the File Origin text area.[\/caption]\r\n\r\nFigure 6 shows how the sample appears to the victim. The sample only shows a single file in the folder.\r\n\r\n[caption id=\"attachment_136567\" align=\"alignnone\" width=\"786\"] Figure 6. The contents of GlobalProtect64.zip following extraction as viewed by a user.[\/caption]\r\n\r\nFigure 7 shows that when viewing all the hidden files and folders, there are more than 400 files.\r\n\r\n[caption id=\"attachment_136569\" align=\"alignnone\" width=\"601\"] Figure 7. The contents of GlobalProtect64.zip following extraction, showing hidden items.[\/caption]\r\n\r\nFigure 8 shows what we see when viewing all files in the archive and checking the signer. GlobalProtect64.exe is a renamed copy of a legitimate share trading application that attackers used to sideload the first WikiLoader component.\r\n\r\n[caption id=\"attachment_136571\" align=\"alignnone\" width=\"786\"] Figure 8. A screenshot of Cortex XDR showing a copy of the trading platform renamed as GlobalProtect64.exe being abused to sideload the first WikiLoader loader component (i4jinst.dll) upon execution.[\/caption]\r\n\r\nFigure 9 shows that upon execution of GlobalProtect64.exe, the threat loads the first WikiLoader component i4jinst.dll, located inside the directory .install4j.\r\n\r\n[caption id=\"attachment_136573\" align=\"alignnone\" width=\"1920\"] Figure 9. A screenshot of Cortex XDR events associated with spoofed GlobalProtect64.exe.[\/caption]\r\n\r\n The i4jinst.dll Load Image event causes the malicious module to be loaded into the binary spoofing GlobalProtect64.exe. Once loaded, i4jinst.dll reads the first stage encrypted shellcode from certificate.pem. It then decrypts the shellcode and injects it into explorer.exe.\r\n\r\n This includes the following discrete actions:\r\n\r\n \tThe decrypted certificate.pem contains the first stage shellcode that is executed\r\n \tThe shellcode loads C:\\Windows\\System32\\BingMaps.dll\r\n \tThe function GetBingMapsFactory is then overwritten with another shellcode decrypted from certificate.pem\r\n \tThe overwritten shellcode then carries out thread injection into the explorer.exe process\r\n\r\n At this point in the infection chain, Cortex\u2019s shellcode prevention raised alerts as shown in Figure 10.\r\n\r\n[caption id=\"attachment_136575\" align=\"alignnone\" width=\"786\"] Figure 10. Cortex shellcode protection prevents the injection from the malicious process into explorer.exe.[\/caption]\r\n\r\nIf unprevented, the injected code in explorer.exe will contact a compromised site running WordPress CMS as a C2 server for the WikiLoader backdoor. It will then establish persistence and communicate with MQTT brokers for tasking.\r\n\r\nThe injected code will load license_us_EN.html. In the GlobalProtect spoofing campaign, license_us_EN.html is a renamed copy of the AdInsight.exe Microsoft Sysinternals binary. License_us_EN.html will side load the WikiLoader backdoor downloaded from the C2 server.\r\n\r\nUpon establishing persistence, AdInsight.exe (renamed to license_us_EN.html) will be renamed again to a random filename. This file will be written into a randomly named folder in ProgramData along with a randomly named file with the extension .pem and the WikiLoader backdoor as a .dll. This process is shown in Figure 11.\r\n\r\n[caption id=\"attachment_136577\" align=\"alignnone\" width=\"786\"] Figure 11. Files contained in a randomly named directory when WikiLoader writes persistence components to disk.[\/caption]\r\n\r\nIn testing environments where shellcode protection was disabled, Cortex XDR still generated an analytic behavioral indicator of compromise (BIOC) detection for the unusual creation of a scheduled task created by explorer.exe following the shellcode injection.\r\n\r\nIn summary, the infection chain is as follows:\r\n\r\n \tMalicious behaviors begin when the victim launches GlobalProtect64.exe and this file then loads i4jinst.dll (located inside .install4j)\r\n \tOnce loaded, i4jinst.dll will read and decrypt the contents of the file certificate.pem\r\n \tThe decrypted certificate.pem contains the first stage shellcode that the threat executes\r\n \tThe shellcode loads C:\\Windows\\System32\\BingMaps.dll\r\n \tThe function GetBingMapsFactory is then overwritten with another shellcode decrypted from certificate.pem\r\n \tThe overwritten shellcode then carries out thread injection into the explorer.exe process\r\n \tThe injected code in the explorer.exe process will contact the C2 server for the WikiLoader backdoor\r\n \tIf persisting, the threat will write license_us_EN.html and another file with extension .pem to a randomly named folder in ProgramData along with the WikiLoader backdoor as a .dll\r\n \tThe threat will establish persistence via a scheduled task to execute the renamed license_us_EN.html\r\n \tThe injected code will read and execute a hidden PE file from license_us_EN.html\r\n \tLicense_us_EN.html will side load the WikiLoader backdoor downloaded from the C2 server\r\n \tThe backdoor will decrypt the shellcode encrypted in the randomly named file with extension .pem. The decryption key is the name of the folder where the backdoor is located.\r\n\r\nWe have added additional protections to Cortex, and we share a collection of hunting rules written in XQL at the end of this post.\r\nHighlighting WikiLoader Anti-Analysis and Defense Evasion\r\nThe following are some unique tricks that this sample of WikiLoader used.\r\nFake Error Message\r\nAs the spoofed GlobalProtect installer is not an actual installer, the authors of WikiLoader needed another trick to fool victims. The threat shows a fake error message when it completes infection of the victim machine. This prevents the victim from wondering why GlobalProtect is not installed.\r\n\r\nFigure 12 shows the fake error message generated by the sample.\r\n\r\n[caption id=\"attachment_136579\" align=\"alignnone\" width=\"394\"] Figure 12. Fake error message displayed when the sample completes infection[\/caption]\r\nRenamed Legitimate Software Used for Side-Loading Backdoor\r\nAttackers renamed the Microsoft Sysinternals tool ADInsight.exe to license_us_EN.html, and hid it inside the spoofed GlobalProtect installer. ADInsight.exe is used to side load the WikiLoader backdoor. Figure 13 shows the contents of license_us_EN.html.\r\n\r\n[caption id=\"attachment_136581\" align=\"alignnone\" width=\"853\"] Figure 13. Hex dump of license_us_EN.html showing it is a PE file.[\/caption]\r\nChecks for Analysis Environments\r\nThe sample checks the running processes in the victim machine against a list of hashes of software commonly used by malware analysts. As most malware analysts would be using a virtualized environment to analyze malware samples, the WikiLoader sample will terminate if it finds processes related to virtual machine software.\r\n\r\nTo hide the list of processes that WikiLoader is looking for, the malware uses a 32-bit hashing routine similar to those used by Emotet back in 2021. Figure 14 shows the hashing routine used by this WikiLoader sample.\r\n\r\n[caption id=\"attachment_136583\" align=\"alignnone\" width=\"920\"] Figure 14. Hashing routine used to obfuscate the analysis processes from above.[\/caption]\r\nFolder Name as Decryption Key for the Backdoor\r\nThe backdoor is encrypted using the CryptUnprotectData API. This sample of WikiLoader used the folder name (RamDQ) as the decryption key for its backdoor.\r\n\r\nFigure 15 shows the folder named RamDQ, which contained the encrypted backdoor 1FoWZv.pem and the executables (s2VT3.exe and version.dll) required to decrypt and execute the backdoor.\r\n\r\n[caption id=\"attachment_136585\" align=\"alignnone\" width=\"1195\"] Figure 15. Screenshot showing CryptUnprotectData being passed the folder name, ultimately to be used to decrypt the shellcode in 1FoWZv.pem.[\/caption]\r\nConclusion\r\nFinancially motivated threat actors will continue to use WikiLoader as a loader for rent in a variety of campaigns where they require a robust, stealthy Windows loader that pays reasonable attention to OPSEC.\r\n\r\nWhat remains to be seen is why threat actors have shifted from phishing to SEO poisoning to deliver WikiLoader. One hypothesis is that another initial access broker (IAB) has begun to work with WikiLoader to operationalize its delivery through SEO poisoning in recent months. Alternatively, groups that are publicly tracked using WikiLoader could have shifted to SEO poisoning from phishing after an improvement in endpoint security controls or industry reporting disrupted their operations.\r\n\r\nWhile SEO poisoning is not a new technique, it continues to be an effective way to deliver a loader to an endpoint. Spoofing trusted security software is likely to assist in bypassing endpoint controls at organizations that rely on filename based allow listing.\r\n\r\nThe combination of spoofed, compromised and legitimate infrastructure leveraged by WikiLoader campaigns reinforces the malware authors attention to building an operationally secure and robust loader, with multiple C2 configurations. The authors suspect that we will likely see continued WikiLoader use throughout 2024 and beyond.\r\n\r\nRegardless of the anti-analysis and EDR evasion techniques employed by WikiLoader, the procedures employed can be identified using many common endpoint threat hunting methods. We share a selection of four queries in our appendix that organizations can use to hunt for WikiLoader with high fidelity in endpoint data. The queries can be expanded in scope with minimal changes from XQL users to cast a wider net, or narrow in on threats that may be more applicable to an organization\u2019s environment.\r\n\r\nGoogle has confirmed that all sites mentioned in this article are known to Safe Browsing. Any user that visits these sites will receive a warning of potential security risks.\r\nPalo Alto Networks Protection and Mitigation\r\nPalo Alto Networks customers are better protected from the threats discussed above through the following products:\r\n\r\n \tNext-Generation Firewall with Cloud-Delivered Security Services, including Advanced WildFire, detect the files mentioned within this report as malicious. Additionally Advanced URL Filtering and Advanced DNS Security identify known URLs and domains associated with this activity as malicious.\r\n \tCortex XDR customers are better protected against the sideloads and shellcode injection attempts mentioned in the article. Cortex XDR detects and prevents these malware activities based on Behavioral Threat Protection, AI-driven local analysis, analytics profiles and other security engines across Windows, Linux and Mac systems.\r\n \tPrisma Cloud can detect known WikiLoader binaries executed from within cloud environments through the Cloud Security Agent (CSA).\r\n\r\nIf you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call:\r\n\r\n \tNorth America Toll-Free: 866.486.4842 (866.4.UNIT42)\r\n \tEMEA: +31.20.299.3130\r\n \tAPAC: +65.6983.8730\r\n \tJapan: +81.50.1790.0200\r\n\r\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about the Cyber Threat Alliance.\r\nXQL Hunting Queries\r\nExplorer.exe communicating with MQTT brokers\r\n\/\/ Description: Communication to known MQTT broker services from explorer.exe. Observed samples have communicated with MQTT brokers over over plaintext or encrypted TCP ports, not using websockets. Typically these are TCP 1883,8883,8884\r\n\r\nconfig case_sensitive = false\r\n\r\n| dataset=xdr_data\r\n\r\n| filter event_type = ENUM.STORY\r\n\r\n| filter dst_action_external_hostname in (\"broker.emqx.io\",\"broker-cn.emqx.io\",\"mqtt.eclipseprojects.io\",\"test.mosquitto.org\",\"broker.hivemq.com\",\"*mqtt.one\",\"*iotbind.com\") and actor_process_image_name = \"explorer.exe\" and action_remote_port not in (53,80,443)\r\n\r\n| fields _time, agent_hostname, agent_ip_addresses, actor_effective_username, actor_process_image_name, actor_process_image_path, dst_action_external_hostname, action_remote_port, action_remote_ip\r\nCommon DLL sideload targets (step 8 in infection chain)\r\n\/\/ Description: Processes that have have written 2 PEs, one must be a .exe, and the\r\n\r\n\/\/ other a .dll with a name commonly abused for search order hijacking.\r\n\r\nconfig case_sensitive = false\r\n\r\n| dataset = xdr_data\r\n\r\n\/\/ Get DLL and Exe writes excluding users and program files directories.\r\n\r\n| filter event_type = ENUM.FILE and event_sub_type in (ENUM.FILE_WRITE, ENUM.FILE_CREATE_NEW) and action_file_extension IN (\"dll\",\"exe\") and action_file_path !~= \"C\\:\\\\(?:Users|Program\\sFiles(\\s\\(x86\\))?)\\\\.*\"\r\n\r\n\/\/ Collate the file writes by the actor (writing) process\r\n\r\n| comp count_distinct(action_file_path) as cnt_pe_written, count_distinct(action_file_extension) as cnt_pe_extensions, count_distinct(action_file_signature_status) as cnt_pe_sig_status, values(action_file_path) as pe_written, values(action_file_signature_status) as action_file_signature_status, values(action_file_signature_vendor) as action_file_signature_vendor, values(action_file_signature_product) as action_file_signature_product, values(actor_effective_username) as username, values(action_file_sha256) as action_file_sha256, values(_time) as time, values(actor_process_command_line) as command_line, values(action_file_name) as pe_written_name, values(agent_hostname) as agent_hostname by actor_process_instance_id\r\n\r\n\/\/ Filter out those that have only written 1 Exe and 1 DLL, with a DLL using a known abused name\r\n\r\n| filter cnt_pe_written=2 and cnt_pe_extensions=2 and pe_written_name ~= \"^(?:vcruntime140|vcruntime|oci|version|msfte|secur32|nw|rw32core|iphlpapi|wininet)\\.dll\"\r\n\r\n| filter pe_written_name not in (\"*cortex-xdr-payload*\",\"*xdrhealth.exe*\",\"*winpty-agent.exe*\")\r\nProcesses executing as GlobalProtect without a parsed Palo Alto Networks certificate.\r\n\/\/ Description: A signed process starts with GlobalProtect or PanGP in the image name, but is not signed by a known Palo Alto Networks certificate.\r\n\r\nconfig case_sensitive = false\r\n\r\n| dataset=xdr_data\r\n\r\n| filter event_type IN (ENUM.PROCESS) and event_sub_type = ENUM.PROCESS_START\r\n\r\n| filter (action_process_image_name contains \"GlobalProtect\" or action_process_image_name contains \"PanGP\") and action_process_signature_vendor not in (\"Palo Alto Networks\",\"Palo Alto Networks (Netherlands) B.V.\",\"Developer ID Application: Palo Alto Networks (PXPZ95SK77)\",\"Palo Alto Networks, Inc\") and action_process_signature_status=ENUM.SIGNED\r\n\r\n| fields _time, agent_hostname, actor_effective_username, action_process_image_path , action_process_image_command_line , action_process_image_sha256, action_process_signature_status, action_process_signature_vendor, action_process_signature_product, action_process_image_sha256, actor_process_image_path , os_actor_process_command_line, causality_actor_process_command_line\r\nReview ZIP files with GlobalProtect naming that have Mark of the Web applied for suspicious download sources\r\n\/\/ Description: Delivery via .zip files is common, display those that were downloaded with Mark of the Web data.\r\n\r\nconfig case_sensitive = false\r\n\r\n| dataset=xdr_data\r\n\r\n| filter event_type=ENUM.FILE and event_sub_type IN (ENUM.FILE_OPEN, ENUM.FILE_CREATE_NEW)\r\n\r\n| filter action_file_extension=\"zip\" and action_file_path ~= \"Downloads|Appdata\" and action_file_name contains \"GlobalProtect\" and not action_file_name contains \"GlobalProtectLogs\"\r\n\r\n| fields _time, event_sub_type, agent_hostname, actor_effective_username, action_file_name, action_file_path, action_file_web_mark, action_file_sha256 , actor_process_image_name, actor_process_image_sha256\r\nIndicators of Compromise\r\nThese indicators were active throughout June 2024.\r\n\r\nDelivery URLs\r\n\r\n \tURL: hxxps:\/\/globalprotect[.]securedownload[.]today\/GlobalProtect64.zip\r\n\r\nDescription: URL serving archive impersonating GlobalProtect.\r\n\r\n \tURL: hxxps:\/\/globalprojectvpn[.]com\r\n\r\nDescription: Fake GlobalProtect site that delivers fake GlobalProtect64.zip\r\n\r\n \tURL: hxxps:\/\/globalprojectvpn[.]com\r\n\r\nDescription: Fake GlobalProtect site that pulled from a Bitbucket project to deliver fake GlobalProtect64.zip\r\n\r\n \tURL: hxxps:\/\/bitbucket[.]org\/bitprotect\/globalproject\/src\/main\/\r\n\r\nDescription: Bitbucket project that hosted fake GlobalProtect64.zip\r\n\r\nWikiLoader C2 URLs\r\n\r\n \thxxps:\/\/carniceriamartinezadria.com\/wp-content\/themes\/twentytwentyfour\/rleoec.php?id=1\r\n \thxxps:\/\/jlholgado.com\/wp-content\/themes\/twentytwentyfour\/zca2ck.php?id=1\r\n \thxxps:\/\/elpgtextil.com\/wp-content\/themes\/twentytwentyfour\/44snwx.php?id=1\r\n \thxxps:\/\/arbeitsschutz-mmk.de\/plugins\/search\/contacts\/chrndi.php?id=1\r\n \thxxps:\/\/www.estudioemm.com\/wp-content\/themes\/twentytwelve\/d4kih3.php?id=1\r\n\r\nDescription: C2 providing the decryption key to the payload of the WikiLoader sample\r\n\r\nSHA-256 hashes for WikiLoader shellcode loader DLLs\r\n\r\n \td4eb9a4ee389f03c402e553724015af8d5b85835828bd66b1b45131b6837802f\r\n \t534c989d110ece8c429d2ded913933b961710726d8655b858474bc31dfed25c3\r\n \ta001642046a6e99ab2b412d96020a243a221e3819eaac94ab3251fad7d20614b\r\n \tc6c250e1cd6d5477b46871ffe17deac248d723ad45687fc54ae4fc5e3f45d91c\r\n \tf1a49cea454bac3e78ac765b247b65d00c896d84de2028892b00d4310453c665\r\n \t2ab449666cf006125075e3ded8053cdfd318e4772d4145f0fa861f1d42cb2b08\r\n \t1d6f76acecff63fb373b5774a3cb34b87266a4a4bbb8e3a0757d107187d280ee\r\n \tb412b2c190b8406392406d9a8e3abce91c9014950bcf835eb7d9b50d0f128cb0\r\n \t66735d0178badf035be0e142f4fb8e23d860bfc9bbdc3e12ad1f2764de91ee9b\r\n \tedec55f87e535f869119db44e4e7302081f53dbf33a27aaf905430cedc5a78b9\r\n \t148b29123bb0c28614858460d7a10707469fecebd6a9ff1da98a0c76a89a9819\r\n \t0de42118dd0cd861bea13de097457ccb407aae901b14e0bec59b0abe660cdf1f\r\n \t5576ab87eb11ca4d2944bc1c2c6a8c349e18c7ded583c1ba9bd99eff9d8ac4d7\r\n \t551da6814a01a280afe90aa6bb238f499d98ad496c0d8472a1705540a6f422da\r\n \t4f573ab13882efa234a79483d305b3001cb09c0a166ff94c925844b860162415\r\n \t4f2079cd2e228a2777df45ae00714c8679531fd8ad82a66b5c1b10e800771f18\r\n \t2add886330db1480da7314ee38428ca79af04f8c461c3bbbd68e202bb5f4c415\r\n \t76d1a876c90ec16f44685f795e64ab84bd2d3f5a91db659c9879b3461ee104f9\r\n \t6aa4a830aa8d89b629fe87d3d3e986042215b5bcd670417933fca854b6dd58d9\r\n \t1c1d739f0282bfd9367e29ca81c61ed4a731e5150a836d0371e5e9d0121c9dfd\r\n \t69a94bbed366bfd917dfd8fb6e5fd7ba52e2dbf338edd0c259654981060943c8\r\n \t9a48f32e00877a4335206c7da45a94ca8bd46648d3a0bc88e0789dabf8139024\r\n \tc3280452e7c96253b215342f2fac14634591adf68f88bcf7dc920d5f28022cd6\r\n \t0c44a46f1c8e46fe6b6f83ec249c95301aca1bc4765cee7bdadd021bbfd2ff66\r\n \t2b8b3f5b692f716116a1468b8d7b273baf7a6cef0726e831cd307d2f2c7452ec\r\n \te07787caf52dd3e7dd0da600dbd1d909f3799dcebcdc60d101baf3ea17ef1e32\r\n \t50810e4696dd075ca23349e3e1c3a87fc7b46ab89f4b1eb093a5cfb74f84cc51\r\n \t912cc2a3592b3b7835205d275cbf92bb66effc99cbd5cc338a223888de1b0d35\r\n \tf04715827e5453b33ba6fae8475b8c45150b27cc1361441648c46d13025283d2\r\n \te693652763141522621f9fcd80efb30cefa363f8bd9bdc65e5ffbf9fb8d76d3b\r\n \t8d5e185d53e81e90646d684dff7cb399973e3cde6d833e6f7431074f4362139a\r\n \tec59616b1c80951d6597d4f25a9c031be0391151dc1073a5bece466473f0bdfe\r\n \te7e674218a7d93595e33a092f4f519a65499651a398ca350f5a50e135e64fa41\r\n \t78f6f94aaa72e41d64e4dc309a3553399db2b4cd0edae5653ca4b6e7839e1215\r\n \tabce298ebb4ac7bc1a5167179875afc88e7e99475bf681953e8b964237b7d7ed\r\n \t82ec4e1a6ddf6eeb4030d6dd698f4576d0445d4d5722d5c60b0cc74ac501bb85\r\n \t0d495a94e29faa4dfded29253322be1b2c534a56c078bea1ad8f1dc1fd23b742\r\n\r\nSHA-256 hashes for WikiLoader backdoor \r\n\r\n \t4044a0d7a0ed7f66efc2bd13616ec63a5722fc7a73a28fe3bda513f60ef24dd9\r\n \tc9eaaa6aee55704ce651c8b4cde7949cfa9711e05a136fa15f234d1bb2ea994c\r\n\r\n\r\nAdditional Resources\r\n\r\n \tThreat Actors Target the Middle East Using Fake Palo Alto GlobalProtect Tool \u2013 Trend Micro\r\n \tX thread on spoof of GlobalProtext\u2013 @malwrhunterteam, X\r\n \tProtection Highlight: WikiLoader Returns \u2013 Broadcom\r\n \t20mb zip drop via discord \u2013\u00a0 @pr0xylife, X\r\n \tStealthy WailingCrab Malware misuses MQTT Messaging Protocol \u2013 Security Intelligence, IBM\r\n\r\nUpdated Sept. 4, 2024, at 1:20 p.m. PT to include clarifying language from Google.","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2024\/08\/04_Malware_Category_1920x900-300x300.jpg","width":300,"height":300},"speakable":{"@type":"SpeakableSpecification","xPath":["\/html\/head\/title","\/html\/head\/meta[@name='description']\/@content"]},"author":[{"@type":"Person","name":"Mark Lim"},{"@type":"Person","name":"Tom Marsden"}]}</script><link rel='stylesheet' id='crayon-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' media='all' />
<style id='co-authors-plus-coauthors-style-inline-css'>
.wp-block-co-authors-plus-coauthors.is-layout-flow [class*=wp-block-co-authors-plus]{display:inline}

</style>
<style id='co-authors-plus-avatar-style-inline-css'>
.wp-block-co-authors-plus-avatar :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-avatar :where(img){vertical-align:middle}.wp-block-co-authors-plus-avatar:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-avatar.aligncenter{display:table;margin-inline:auto}

</style>
<style id='co-authors-plus-image-style-inline-css'>
.wp-block-co-authors-plus-image{margin-bottom:0}.wp-block-co-authors-plus-image :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-image :where(img){vertical-align:middle}.wp-block-co-authors-plus-image:is(.alignfull,.alignwide) :where(img){width:100%}.wp-block-co-authors-plus-image:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-image.aligncenter{display:table;margin-inline:auto}

</style>
<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='post-views-counter-frontend-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.min.css?ver=1.4.7' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.min.css?ver=1' media='all' />
<link rel='stylesheet' id='unit42-v6-style-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/style.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-head-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/head-styles.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v5-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-plugin-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/plugin.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main-redesign.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='like-dislike-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/css/ldc-lite.css?ver=1.0.0' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script id="crayon_js-js-extra">
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" id="crayon_js-js"></script>
<script id="post-views-counter-frontend-js-before">
var pvcArgsFrontend = {"mode":"js","postID":136552,"requestURL":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","nonce":"c3b9727a80","dataStorage":"cookies","multisite":false,"path":"\/","domain":""};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/js/frontend.min.js?ver=1.4.7" id="post-views-counter-frontend-js"></script>
<script id="wpml-xdomain-data-js-extra">
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en","_nonce":"d123c4ca65"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.6.12" id="wpml-xdomain-data-js" defer data-wp-strategy="defer"></script>
<link rel="https://api.w.org/" href="https://unit42.paloaltonetworks.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://unit42.paloaltonetworks.com/wp-json/wp/v2/posts/136552" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=136552' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fglobal-protect-vpn-spoof-distributes-wikiloader%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fglobal-protect-vpn-spoof-distributes-wikiloader%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.6.12 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
			padding-top:0px;
			padding-bottom:0px;
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>      <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="32x32" />
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<meta name="msapplication-TileImage" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<script>var $ = jQuery;</script>

    <script type="text/javascript">
    ;(function(win, doc, style, timeout) {
    var STYLE_ID = 'at-body-style';
    function getParent() {
    return doc.getElementsByTagName('head')[0];
    }
    function addStyle(parent, id, def) {
        if (!parent) {
        return;
        }
        var style = doc.createElement('style');
        style.id = id;
        style.innerHTML = def;
        parent.appendChild(style);
    }
    function removeStyle(parent, id) {
        if (!parent) {
            return;
        }
        var style = doc.getElementById(id);
        if (!style) {
            return;
        }
        parent.removeChild(style);
    }
    addStyle(getParent(), STYLE_ID, style);
    setTimeout(function() {
    removeStyle(getParent(), STYLE_ID);
    }, timeout);
    }(window, document, "body {visibility:hidden !important}", 3000));
    </script>

            <script src="https://assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
            <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>


<script type="text/javascript">
var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
if(isIE11){
    var polyfill = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/scripts/polyfill.min.js';
    document.write('<script type="text/javascript" src="'+polyfill+'">\x3C/script>');
}
    /**
 * String.prototype.replaceAll() polyfill
 * https://gomakethings.com/how-to-replace-a-section-of-a-string-with-another-one-with-vanilla-js/
 * @author Chris Ferdinandi
 * @license MIT
 */
if (!String.prototype.replaceAll) {
	String.prototype.replaceAll = function(str, newStr){
		// If a regex pattern
		if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {
			return this.replace(str, newStr);
		}
		// If a string
		return this.replace(new RegExp(str, 'g'), newStr);
	};
}

    /*! lozad.js - v1.16.0 - 2020-09-06 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});

</script>

<!-- <script src="https://www.google.com/recaptcha/api.js"></script>  -->

<!--  End: Scripts Migrated From Unit42-v5 -->

</head>
<body class="post-template-default single single-post postid-136552 single-format-standard no-sidebar">
<header class="haeder py-15 position-relative z-index-2" style="display: none;">
  <div class="container px-sm-30 px-35">
    <div class="row">
        <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                        <a href="https://www.paloaltonetworks.com/">
                <img src="/wp-content/uploads/2021/07/PANW_Parent.png" width="140px" alt="Logo" />
            </a>
        </div>
      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo"  width="150" height="35"/>
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search" aria-label="search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required aria-label="Inner Search">
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10"  style="display: none!important;">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-119884" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-119884"><a target="_blank" rel="noopener" href="https://www.paloaltonetworks.com/unit42">Security Consulting</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
<li id="menu-item-121229" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-121229"><a href="https://start.paloaltonetworks.com/contact-unit42.html"><b style="color:#C84727">Under Attack?</b></a></li>
</ul>  </div>
</nav>
<div class="panClean pan-template-home" id="main-nav-menu-cont" style="display:none;">
    <div class="cleanHeader mainNavigationComp baseComponent parbase">
        <div class="productNav2021Component dark default" id="PAN_2021_NAV_ASYNC">
        </div>
  </div>
<div class="cleanTopHtml htmlComp baseComponent parbase"><div class="base-component-spacer spacer-none  "></div>
</div>
</div>
<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
	function getCookie(cname) {
	 	var name = cname + "=";
  		var decodedCookie = decodeURIComponent(document.cookie);
		var ca = decodedCookie.split(';');
  		for(var i = 0; i <ca.length; i++) {
    			var c = ca[i];
    			while (c.charAt(0) == ' ') {
     				 c = c.substring(1);
    			}
    			if (c.indexOf(name) == 0) {
    				 return c.substring(name.length, c.length);
    			}
  		}
  		return "";
	}

	var referer = "";//sessionStorage.container;
	var pcontainer = sessionStorage.getItem("container");
	var searchResultsPagePath = "";
	if(((pcontainer) && pcontainer.indexOf('Prisma')!=-1)){
	    referer = 'Prisma' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Cortex')!=-1)){
	    referer = 'Cortex' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Sase')!=-1)){
	    referer = 'Sase' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Unit')!=-1)){
	    referer = 'Unit' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Ngfw')!=-1)){
	    referer = 'Ngfw' ;
	}
        var fromRef = document.referrer;
        var nContainer = getCookie("navContainer");
        if(nContainer){//If user is coming from main site, we need to reset the container		
		if(fromRef  && fromRef.indexOf("prismacloud.io")!=-1){
                        referer = 'Prisma' ;
                        sessionStorage.setItem("container","Prisma");
                } else if(fromRef.indexOf("paloaltonetworks.com")!=-1 || fromRef.indexOf("paloaltonetworks.jp")!=-1 ){
                        if(nContainer.indexOf('Prisma') != -1){
                            referer = 'Prisma' ;
                            sessionStorage.setItem("container","Prisma");
                        }
                        if(nContainer.indexOf('Cortex') != -1){
                            referer = 'Cortex' ;
                            sessionStorage.setItem("container","Cortex");
                        }
			if(nContainer.indexOf('Sase') != -1){
                            referer = 'Sase' ;
                            sessionStorage.setItem("container","Sase");
                        }
			if(nContainer.indexOf('Unit') != -1){
                            referer = 'Unit' ;
                            sessionStorage.setItem("container","Unit");
                        }
			if(nContainer.indexOf('Ngfw') != -1){
                            referer = 'Ngfw' ;
                            sessionStorage.setItem("container","Ngfw");
                        }
			document.cookie = 'navContainer=; path=/; domain=.paloaltonetworks.com; expires=' + new Date(0).toUTCString();
		}
	}
if(referer != "Prisma" && referer != "Cortex" && referer != "Sase" && referer != "Unit" && referer != "Ngfw") {
    referer = 'Unit' ;
    sessionStorage.setItem("container","Unit");
}
function callMainSitePrismaNavHTML(){
    
    var referrer_domain = 'https://www.paloaltonetworks.com';
    sessionStorage.setItem("domain",referrer_domain);
    if(referer == 'Prisma'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/prismasearch";
        }
    if(referer == 'Cortex'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderCortex.cortexRenderer.html';	
        searchResultsPagePath = referrer_domain+"/search/cortexsearch";	
    }
    if(referer == 'Sase'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderSase.saseRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/sasesearch";
    }
    if(referer == 'Unit'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/unit-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/content/pan/en_US/search/unit42search";
		    }
    if(referer == 'Ngfw'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/ngfw-cdss-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/search/ngfwcdsssearch";
    }
    httpGet(menu_url,'menu_html');
    document.getElementById('main-nav-menu-cont').removeAttribute("style");
}
function addStyle(styles) {            
    /* Create style document */
    var css = document.createElement('style');
    css.type = 'text/css';

    if (css.styleSheet) 
        css.styleSheet.cssText = styles;
    else 
        css.appendChild(document.createTextNode(styles));

    /* Append style to the tag name */
    document.getElementsByTagName("head")[0].appendChild(css);
}
function httpGet(theUrl,req_type) {
    if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            if(req_type == 'menu_html'){
            var nav_text = xmlhttp.responseText.replaceAll('https://static.cloud.coveo.com/searchui/v2.9159/js/CoveoJsSearch.Lazy.min.js', '');
            nav_text = nav_text.replaceAll('src="/', 'src="'+maindomain_lang+'/');
            nav_text = nav_text.replaceAll("'/content", "'"+maindomain_lang+"/content");
                        
            document.getElementById("PAN_2021_NAV_ASYNC").innerHTML = nav_text.replaceAll('href="/', 'href="'+maindomain_lang+'/');

            var lozad_back = document.getElementsByClassName('lozad-background');
            Array.prototype.forEach.call(lozad_back, function(el) {
            // Do stuff here
            var el_back_img_path = el.getAttribute('data-background-image');
            var first_pos = el_back_img_path.indexOf("'");
            var last_pos = el_back_img_path.indexOf("'",first_pos+1);
            el_back_img_path = el_back_img_path.substring(first_pos+1,last_pos);
            el.setAttribute("data-background-image",main_site_url+el_back_img_path);
            });
            }
            if(req_type == 'head_inline_css'){
            addStyle(xmlhttp.responseText);
            }
        }
    }
    xmlhttp.open("GET", theUrl, true );
    xmlhttp.send();    
}    
    
if(referer == 'Prisma' || referer == 'Cortex' || referer == 'Sase' || referer == 'Unit' || referer == 'Ngfw'){
    const article = document.querySelector('#PAN_2021_NAV_ASYNC');
    if(referer == 'Prisma'){
        article.dataset.type = 'prisma';
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    else if(referer == 'Cortex'){
        article.dataset.type = 'cortex';
    }
    else if(referer == 'Sase'){
        article.dataset.type = 'sase';
    }
    else if(referer == 'Unit'){
        article.dataset.type = 'unit';
    }
    else if(referer == 'Ngfw'){
        article.dataset.type = 'ngfw';
    }
    //set class to default
    if(referer == 'Unit' || referer == 'Ngfw'){
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    callMainSitePrismaNavHTML();        
}
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->



<main class="main">
    <section class="section section--article">
        <div class="pa article-banner" style="background-image:url('https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900.jpg')">
          <div class="l-container"> 
            <div class="l-breadcrumbs"> 
              <ul> <li> <a href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:breadcrumb:Threat Research">Threat Research Center</a></li><li><a href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" title="Threat Research" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:breadcrumb:Threat Research">Threat Research</a></li><li class="is-current"><a href="https://unit42.paloaltonetworks.com/category/malware/" role="link" title="Malware" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:breadcrumb:Malware">Malware</a></li> </ul>
            </div>            <div class="ab__title">
              <a class="card-category" href="https://unit42.paloaltonetworks.com/category/malware/" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:Malware"><span class="ab-title__pre">Malware</span></a> 
              <h1>Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant</h1>
              <div class="ab__video">
              <span class="duration"> 
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-clock.svg" alt="Clock Icon"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 12</span> <span class="rt-label rt-postfix"></span></span> min read              </span>
                              </div>          
              <div class="ab-lc__wrapper">
                <span class="ab-title__pre">Related Products</span><div class="ab__link-cards"><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/advanced-dns-security/" style="--card-color: #ffcb06" role="link" title="Advanced DNS Security" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:Advanced DNS Security"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Advanced DNS Security icon">Advanced DNS Security</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/advanced-url-filtering/" style="--card-color: #ffcb06" role="link" title="Advanced URL Filtering" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:Advanced URL Filtering"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Advanced URL Filtering icon">Advanced URL Filtering</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/advanced-wildfire/" style="--card-color: #ffcb06" role="link" title="Advanced WildFire" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:Advanced WildFire"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Advanced WildFire icon">Advanced WildFire</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cloud-delivered-security-services/" style="--card-color: #ffcb06" role="link" title="Cloud-Delivered Security Services" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:Cloud-Delivered Security Services"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Cloud-Delivered Security Services icon">Cloud-Delivered Security Services</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/code-to-cloud-platform/" style="--card-color: #00c0e8" role="link" title="Code to Cloud Platform" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:Code to Cloud Platform"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/prisma_RGB_logo_Icon_Color.png" alt="Code to Cloud Platform icon">Code to Cloud Platform</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex/" style="--card-color: #00cc66" role="link" title="Cortex" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:Cortex"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex icon">Cortex</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex-xdr/" style="--card-color: #00cc66" role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:Cortex XDR"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex XDR icon">Cortex XDR</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/managed-threat-hunting/" style="--card-color: #c94727" role="link" title="Managed Threat Hunting" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:Managed Threat Hunting"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42_RGB_logo_Icon_Color.png" alt="Managed Threat Hunting icon">Managed Threat Hunting</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/prisma-cloud/" style="--card-color: #00c0e8" role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:Prisma Cloud"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/prisma_RGB_logo_Icon_Color.png" alt="Prisma Cloud icon">Prisma Cloud</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/unit-42-incident-response/" style="--card-color: #c94727" role="link" title="Unit 42 Incident Response" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:Unit 42 Incident Response"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/unit42_RGB_logo_Icon_Color.png" alt="Unit 42 Incident Response icon">Unit 42 Incident Response</a></div>              </div>
            </div>
          </div>
          <div class="ab__footer">
            <div class="l-container">
              <div class="ab__footer-wrapper">
                <ul class="ab__features" role="list">
                  <li role="listitem">
				 <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-profile-grey.svg" alt="Profile Icon">
					 <div class="ab__text"><span>By:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:Mark Lim" href="https://unit42.paloaltonetworks.com/author/mark-lim/">Mark Lim</a></li><li><a data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:Tom Marsden" href="https://unit42.paloaltonetworks.com/author/tom-marsden/">Tom Marsden</a></li></ul></div></li>                  <li role="listitem">
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-calendar-grey.svg" alt="Published Icon">
			<div class="ab__text"><span>Published:</span>2 September, 2024 at 3:00 AM PDT</div></li>					<li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-category.svg" alt="Tags Icon"><div class="ab__text"><span>Categories:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:Malware" href="https://unit42.paloaltonetworks.com/category/malware/">Malware</a></li><li><a data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:Threat Research" href="https://unit42.paloaltonetworks.com/category/threat-research/">Threat Research</a></li></ul></div>
		</li>                  <li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-tags-grey.svg" alt="Tags Icon"><div class="ab__text"><span>Tags:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:DLL Sideloading" href="https://unit42.paloaltonetworks.com/tag/dll-sideloading/">DLL Sideloading</a></li><li><a data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:Emotet" href="https://unit42.paloaltonetworks.com/tag/emotet/">Emotet</a></li><li><a data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:Evasion" href="https://unit42.paloaltonetworks.com/tag/evasion/">Evasion</a></li><li><a data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:Loader as a service" href="https://unit42.paloaltonetworks.com/tag/loader-as-a-service/">Loader as a service</a></li><li><a data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:malvertising" href="https://unit42.paloaltonetworks.com/tag/malvertising/">Malvertising</a></li><li><a data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:SEO poisoning" href="https://unit42.paloaltonetworks.com/tag/seo-poisoning/">SEO poisoning</a></li><li><a data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:Spoof" href="https://unit42.paloaltonetworks.com/tag/spoof/">Spoof</a></li><li><a data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:WailingCrab" href="https://unit42.paloaltonetworks.com/tag/wailingcrab/">WailingCrab</a></li><li><a data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:WikiLoader" href="https://unit42.paloaltonetworks.com/tag/wikiloader/">WikiLoader</a></li></ul></div>
		</li>                </ul>
                <div class="ab__options">
                  <ul role="list">
                                        <li role="listitem"><a href="https://unit42.paloaltonetworks.com/global-protect-vpn-spoof-distributes-wikiloader/?pdf=download&#038;lg=en&#038;_wpnonce=dcff69efdc" role="link" target="_blank"  title="Click here to download" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:pdfdownload"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-download.svg" alt="Download Icon"></a></li>
                    <li role="listitem"><a href="https://unit42.paloaltonetworks.com/global-protect-vpn-spoof-distributes-wikiloader/?pdf=print&#038;lg=en&#038;_wpnonce=dcff69efdc" target="_blank" role="link" title="Click here to print" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:hero:pdfprint"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-print.svg" alt="Print Icon"></a></li>
                  </ul>
                  
	<div class="ab__share" id="shareDropdown" role="button" aria-expanded="false">
	<a href="#" role="link" title="Click here to share" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:share" class="">Share<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"></a><ul class="share-dropdown" role="menu">
				<li role="menuitem">
					<a href="#" class="copy-url" id="copyUrl" data-url="https://unit42.paloaltonetworks.com/global-protect-vpn-spoof-distributes-wikiloader/" role="link" title="Copy link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:share:link"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-share-link.svg" alt="Link Icon"></a>
				</li>
				<li role="menuitem">
					<a href="mailto:?subject=Spoofed%20GlobalProtect%20Used%20to%20Deliver%20Unique%20WikiLoader%20Variant&#038;body=Check%20out%20this%20article%20https%3A%2F%2Funit42.paloaltonetworks.com%2Fglobal-protect-vpn-spoof-distributes-wikiloader%2F" role="link" title="Share in email" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:share:email"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-sms.svg" alt="Link Email"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fglobal-protect-vpn-spoof-distributes-wikiloader%2F" target="_blank" role="link" title="Share in Facebook" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:share:facebook"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-fb-share.svg" alt="Facebook Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fglobal-protect-vpn-spoof-distributes-wikiloader%2F&#038;title=Spoofed%20GlobalProtect%20Used%20to%20Deliver%20Unique%20WikiLoader%20Variant" target="_blank" role="link" title="Share in LinkedIn" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:share:linkedin"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-linkedin-share.svg" alt="LinkedIn Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fglobal-protect-vpn-spoof-distributes-wikiloader%2F&#038;text=Spoofed%20GlobalProtect%20Used%20to%20Deliver%20Unique%20WikiLoader%20Variant" target="_blank" role="link" title="Share in Twitter" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:share:twitter"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-twitter-share.svg" alt="Twitter Icon"></a>
				</li>
				<li role="menuitem">
					<a href="//www.reddit.com/submit?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fglobal-protect-vpn-spoof-distributes-wikiloader%2F" target="_blank" role="link" title="Share in Reddit" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:share:reddit"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-reddit-share.svg" alt="Reddit Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://mastodon.social/share?text=Spoofed%20GlobalProtect%20Used%20to%20Deliver%20Unique%20WikiLoader%20Variant%20https%3A%2F%2Funit42.paloaltonetworks.com%2Fglobal-protect-vpn-spoof-distributes-wikiloader%2F" target="_blank" role="link" title="Share in Mastodon" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:share:mastodon"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-mastodon-share.svg" alt="Mastodon Icon"></a>
				</li>
	  </ul>
    </div>                </div>
              </div>
            </div>
          </div>
        </div>
      </section> 
    <section class="section blog-contents"> 
      <div class="pa blog-editor">
        <div class="l-container">
          <div class="be__wrapper">
            <div class="be__contents">
              <div class="be__contents-wrapper">
                <h2><a id="post-136552-_4lt92rr5muov"></a>Executive Summary</h2>
<p>The Unit 42 Managed Threat Hunting team (MTH) identified a variant of WikiLoader loader for rent (aka WailingCrab) being delivered via SEO poisoning and spoofing our <a href="https://www.paloaltonetworks.de/resources/datasheets/globalprotect-datasheet" target="_blank" rel="noopener">GlobalProtect VPN</a> software. Analysis conducted by the Advanced WildFire reverse engineering team has uncovered the latest evasion techniques for WikiLoader, providing new insights into its evolution.</p>
<p>We provide multiple XQL queries for Cortex to hunt for this WikiLoader campaign. We also provide hashes that identify samples found in the wild as well as command and control (C2) URLs extracted from the original sample that spoofed GlobalProtect.</p>
<p>Palo Alto Networks customers are better protected from the threats discussed in this article through detection mechanisms available from the following products:</p>
<ul>
<li><a href="https://www.paloaltonetworks.com/cortex/cortex-xdr" target="_blank" rel="noopener">Cortex XDR</a> and <a href="https://docs-cortex.paloaltonetworks.com/p/XSIAM" target="_blank" rel="noopener">XSIAM</a></li>
<li><a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall" target="_blank" rel="noopener">Next-Generation Firewall</a> with <a href="https://www.paloaltonetworks.com/network-security/security-subscriptions" target="_blank" rel="noopener">Cloud-Delivered Security Services</a></li>
<li><a href="https://www.paloaltonetworks.com/network-security/advanced-wildfire" target="_blank" rel="noopener">Advanced WildFire</a></li>
<li><a href="https://www.paloaltonetworks.com/network-security/dns-security" target="_blank" rel="noopener">Advanced DNS Security</a></li>
<li><a href="https://www.paloaltonetworks.com/network-security/advanced-url-filtering" target="_blank" rel="noopener">Advanced URL Filtering</a></li>
<li>The Prisma Cloud <a href="https://docs-cortex.paloaltonetworks.com/r/Cortex-XDR/Cortex-XDR-Pro-Administrator-Guide/Pairing-Prisma-Cloud-Compute-with-Cortex-XDR" target="_blank" rel="noopener">Cloud Security Agent (CSA)</a></li>
</ul>
<p>Additionally, Google has confirmed that all sites mentioned in this article are known to Safe Browsing. Any user that visits these sites will receive a warning of potential security risks.</p>
<table style="width: 100%; height: 24px;">
<thead>
<tr style="height: 24px;">
<td style="width: 35%; height: 24px;"><b>Related Unit 42 Topics</b></td>
<td style="width: 100%; height: 24px;"><a href="https://unit42.paloaltonetworks.com/tag/malvertising/" target="_blank" rel="noopener"><b>Malvertising</b></a>, <a href="https://unit42.paloaltonetworks.com/tag/dll-sideloading/" target="_blank" rel="noopener"><b>DLL Sideloading</b></a></td>
</tr>
</thead>
</table>
<h2><a id="post-136552-_lyq4dihdfo1"></a>Overview of Tradecraft Used by WikiLoader in Campaigns Spoofing GlobalProtect</h2>
<p>WikiLoader is a multistage malware loader that adversaries developed with consideration toward evasion. Our industry partners have documented this threat well. As such, we’ll focus on the specific tradecraft we observed related to campaigns spoofing GlobalProtect, anti-analysis techniques employed by the loader and resources for threat hunters.</p>
<p><a href="https://www.proofpoint.com/au/blog/threat-insight/out-sandbox-wikiloader-digs-sophisticated-evasion" target="_blank" rel="noopener">Proofpoint has reported</a> WikiLoader has been active since at least late 2022. They also noted that phishing was initially the primary means of delivery. Its operators used compromised WordPress sites and public MQ Telemetry Transport (MQTT) brokers for C2.</p>
<p>We have not observed the follow-on payloads from complete WikiLoader infections. However, <a href="https://www.proofpoint.com/au/blog/threat-insight/out-sandbox-wikiloader-digs-sophisticated-evasion" target="_blank" rel="noopener">Proofpoint reported attackers used the threat to deliver banking Trojans</a> such as Danabot and Ursnif/Gozi to organizations based in Italy.</p>
<p>In June 2024, we observed a WikiLoader campaign leveraging GlobalProtect themed SEO poisoning, rather than using previously documented phishing tactics. SEO poisoning is the process of getting an attacker-controlled site on the front page of search engine results for a legitimate product through purchasing advertisements or improving page rank.</p>
<p>Attackers commonly use SEO poisoning as an initial access vector to trick people into visiting a page that spoofs the legitimate search result to deliver malware rather than the searched-for product. This campaign’s delivery infrastructure leveraged cloned websites relabeled as GlobalProtect along with cloud-based Git repositories.</p>
<p>Unit 42 primarily observed WikiLoader affecting the U.S. higher education and transportation sectors. However, the use of SEO poisoning for delivery almost certainly broadens the scope of possible victims as compared to phishing.</p>
<p>WikiLoader is a loader for rent, which is suspected to be leveraged by at least two initial access brokers (IABs). Attribution for this specific campaign requires further research. However, we do make the following observations.</p>
<ul>
<li>Campaigns leveraging WikiLoader and spoofing GlobalProtect have shown reasonable regard for evasion</li>
<li>The threat operators show an awareness of simple techniques that, when executed well, make machine and signature-based detection of such threats difficult</li>
</ul>
<p>Such OPSEC considerations include:</p>
<ul>
<li>Using the MQTT internet of things (IoT) event queue protocol for C2</li>
<li>Typosquatting and spoofing download pages modified to deliver WikiLoader throughout the life of a campaign</li>
<li>Using legitimate sites running vulnerable, third-party WordPress plugins as C2 infrastructure</li>
<li>Using cloud-hosted Git solutions to host malicious content</li>
<li>Using legitimate, signed binaries for sideloading WikiLoader</li>
<li>Using common file names associated with security tooling, where allowlistings in security products would reduce detection and response efficacy</li>
<li>Embedding payloads in seemingly benign file names and types</li>
<li>Hiding attributes for all files except the file that receives user interaction</li>
<li>Encrypting shellcode that is stored in separate binaries from the WikiLoader executables</li>
<li>Decrypting keys for shellcode that operators stored in the C2 servers</li>
<li>Performing multiple anti-analysis checks</li>
<li>Displaying fake error messages on execution</li>
</ul>
<p>Figure 1 provides a summary of the infection chain.</p>
<h2></h2>
<figure id="attachment_136557" aria-describedby="caption-attachment-136557" style="width: 785px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136557" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-619451-136552-1.png" alt="Flowchart diagram illustrating a cybersecurity attack involving several steps including fetching protection settings, exploiting software, scheduling tasks, and encrypting data using known entities like GlobalProtect and Windows system directories. The chart details the use of VPN, DLL hijacking, and disk write operations, and includes various file names and application icons related to the attack process." width="785" height="887" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-619451-136552-1.png 785w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-619451-136552-1-389x440.png 389w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-619451-136552-1-620x700.png 620w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-619451-136552-1-768x868.png 768w" sizes="(max-width: 785px) 100vw, 785px" /><figcaption id="caption-attachment-136557" class="wp-caption-text">Figure 1. Attack diagram from the delivery through WikiLoader backdoor Execution. Source: Inspired by attack flow detailed in AhnLab blog, "'<a href="https://asec.ahnlab.com/en/64106/" target="_blank" rel="noopener">Totally Unexpected' Package Malware Using Modified Notepad++ Plug-in (WikiLoader)</a>."</figcaption></figure>
<h2><a id="post-136552-_p6o9n0lackwh"></a>Delivery and Execution</h2>
<p>The following section details the execution of WikiLoader as delivered through GlobalProtect-based SEO poisoning.</p>
<p>The advertisements we observed linked to multiple fake sites serving spoofed GlobalProtect installers. Figure 2 shows a malicious advertisement that attackers used to lure victims to a spoofed GlobalProtect download page.</p>
<figure id="attachment_136559" aria-describedby="caption-attachment-136559" style="width: 782px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136559 size-medium" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-622646-136552-2-782x440.jpeg" alt="A screenshot of a Google search results page for &quot;global protect download&quot;. The page shows links and information related to downloading the GlobalProtect app from Palo Alto Networks on the Google Play Store and instructions for installation on various devices." width="782" height="440" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-622646-136552-2-782x440.jpeg 782w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-622646-136552-2-1244x700.jpeg 1244w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-622646-136552-2-768x432.jpeg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-622646-136552-2-1536x864.jpeg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-622646-136552-2.jpeg 1920w" sizes="(max-width: 782px) 100vw, 782px" /><figcaption id="caption-attachment-136559" class="wp-caption-text">Figure 2. Google ad linked to the websites to download spoofed GlobalProtect.</figcaption></figure>
<p><a id="post-136552-_gjdgxs"></a> The first site is a clone of a legitimate business that fetches the malicious payload upon download shown in Figure 3. Bitbucket took the site offline when we notified them of it.</p>
<figure id="attachment_136561" aria-describedby="caption-attachment-136561" style="width: 784px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136561 size-medium" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-626037-136552-3-784x440.png" alt="Screenshot of the GlobalProtect download page on a website with redacted information, featuring an 'Install on Windows' button." width="784" height="440" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-626037-136552-3-784x440.png 784w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-626037-136552-3-1248x700.png 1248w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-626037-136552-3-768x431.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-626037-136552-3-1536x862.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-626037-136552-3.png 2048w" sizes="(max-width: 784px) 100vw, 784px" /><figcaption id="caption-attachment-136561" class="wp-caption-text">Figure 3. A cloned website that directs users to download the spoofed GlobalProtect installer hosted on Bitbucket.</figcaption></figure>
<p><a id="post-136552-_t9zp31djzbuy"></a> The second site shown in Figure 4 is a site that spoofs the GlobalProtect client download page.</p>
<p>&nbsp;</p>
<figure id="attachment_136563" aria-describedby="caption-attachment-136563" style="width: 786px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136563 size-medium" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-630703-136552-4-786x440.png" alt="Screenshot of a computer screen displaying a cloned GlobalProtect Portal by Palo Alto Networks with a notification for downloading the GlobalProtect Agent for Windows 64-bit." width="786" height="440" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-630703-136552-4-786x440.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-630703-136552-4-1249x700.png 1249w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-630703-136552-4-768x431.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-630703-136552-4-1536x861.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-630703-136552-4.png 2048w" sizes="(max-width: 786px) 100vw, 786px" /><figcaption id="caption-attachment-136563" class="wp-caption-text">Figure 4. A cloned GlobalProtect page that directs users to download spoofed GlobalProtect installers.</figcaption></figure>
<p>Upon download, Cortex XDR shows the following information associated with Chrome where the sample is enriched with Mark of the Web (MotW) data as shown in Figure 5. MotW is a security feature in Windows that adds metadata to files downloaded from the internet to indicate a potentially unsafe source. Analysts can use this information to assist in <a href="https://learn.microsoft.com/en-us/microsoft-365-apps/security/internet-macros-blocked#mark-of-the-web-and-zones" target="_blank" rel="noopener">understanding the source of a file</a>, and where someone may have been browsing before downloading the file.</p>
<figure id="attachment_136565" aria-describedby="caption-attachment-136565" style="width: 786px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136565 size-medium" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-635671-136552-5-786x408.png" alt="A screenshot of the Cortex XDR interface showing details of a file named &quot;GlobalProtect64.zip&quot; including its download path, SHA256 hash, timestamp from July 2024, and file origin URL." width="786" height="408" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-635671-136552-5-786x408.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-635671-136552-5-1350x700.png 1350w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-635671-136552-5-768x398.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-635671-136552-5-1536x796.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-635671-136552-5.png 1728w" sizes="(max-width: 786px) 100vw, 786px" /><figcaption id="caption-attachment-136565" class="wp-caption-text">Figure 5. File write and read of the <span style="font-family: 'courier new', courier, monospace;">GlobalProtect64.zip</span> file enriched with MotW data streams indicating one of the download URLs in the <span style="font-family: 'courier new', courier, monospace;">File Origin</span> text area.</figcaption></figure>
<p>Figure 6 shows how the sample appears to the victim. The sample only shows a single file in the folder.</p>
<figure id="attachment_136567" aria-describedby="caption-attachment-136567" style="width: 786px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136567" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-638838-136552-6-786x268.png" alt="Screenshot of a computer screen showing the GlobalProtect64.exe selected in a file explorer window on a Windows operating system." width="786" height="268" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-638838-136552-6-786x268.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-638838-136552-6-768x262.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-638838-136552-6.png 1026w" sizes="(max-width: 786px) 100vw, 786px" /><figcaption id="caption-attachment-136567" class="wp-caption-text">Figure 6. The contents of <span style="font-family: 'courier new', courier, monospace;">GlobalProtect64.zip</span> following extraction as viewed by a user.</figcaption></figure>
<p>Figure 7 shows that when viewing all the hidden files and folders, there are more than 400 files.</p>
<figure id="attachment_136569" aria-describedby="caption-attachment-136569" style="width: 601px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136569 size-medium" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-641287-136552-7-601x440.png" alt="Screenshot of a computer's file explorer window open with folders and files visible. The window is titled &quot;GlobalProtect64&quot; and displays various files like 'cert', 'install4j' among others. Several file icons such as folders, text files, and application files are shown." width="601" height="440" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-641287-136552-7-601x440.png 601w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-641287-136552-7-956x700.png 956w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-641287-136552-7-768x562.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-641287-136552-7.png 986w" sizes="(max-width: 601px) 100vw, 601px" /><figcaption id="caption-attachment-136569" class="wp-caption-text">Figure 7. The contents of <span style="font-family: 'courier new', courier, monospace;">GlobalProtect64.zip</span> following extraction, showing hidden items.</figcaption></figure>
<p>Figure 8 shows what we see when viewing all files in the archive and checking the signer. <span style="font-family: 'courier new', courier, monospace;">GlobalProtect64.exe</span> is a renamed copy of a legitimate share trading application that attackers used to sideload the first WikiLoader component.</p>
<figure id="attachment_136571" aria-describedby="caption-attachment-136571" style="width: 786px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136571 size-medium" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-644584-136552-8-786x339.png" alt="A screenshot of the Cortex XDR interface. The layout displays two cable icons, a global network graphic, file paths, user information, signature details, and a section titled Process Information. The background is dark with text and graphics in white and red. Some of the information is redacted." width="786" height="339" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-644584-136552-8-786x339.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-644584-136552-8-1622x700.png 1622w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-644584-136552-8-768x332.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-644584-136552-8-1536x663.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-644584-136552-8.png 2048w" sizes="(max-width: 786px) 100vw, 786px" /><figcaption id="caption-attachment-136571" class="wp-caption-text">Figure 8. A screenshot of Cortex XDR showing a copy of the trading platform renamed as <span style="font-family: 'courier new', courier, monospace;">GlobalProtect64.exe</span> being abused to sideload the first WikiLoader loader component (<span style="font-family: 'courier new', courier, monospace;">i4jinst.dll</span>) upon execution.</figcaption></figure>
<p>Figure 9 shows that upon execution of <span style="font-family: 'courier new', courier, monospace;">GlobalProtect64.exe</span>, the threat loads the first WikiLoader component <span style="font-family: 'courier new', courier, monospace;">i4jinst.dll</span>, located inside the directory <span style="font-family: 'courier new', courier, monospace;">.install4j</span>.</p>
<figure id="attachment_136573" aria-describedby="caption-attachment-136573" style="width: 1920px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136573 size-large" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-648232-136552-9-1920x249.png" alt="Data table displaying various rows. Some entries are redacted. Two lines are highlighted in a red box." width="1920" height="249" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-648232-136552-9-1920x249.png 1920w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-648232-136552-9-786x102.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-648232-136552-9-768x100.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-648232-136552-9-1536x200.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-648232-136552-9.png 2048w" sizes="(max-width: 1920px) 100vw, 1920px" /><figcaption id="caption-attachment-136573" class="wp-caption-text">Figure 9. A screenshot of Cortex XDR events associated with spoofed <span style="font-family: 'courier new', courier, monospace;">GlobalProtect64.exe</span>.</figcaption></figure>
<p><a id="post-136552-_gryogn3efiao"></a> The <span style="font-family: 'courier new', courier, monospace;">i4jinst.dll</span> Load Image event causes the malicious module to be loaded into the binary spoofing <span style="font-family: 'courier new', courier, monospace;">GlobalProtect64.exe</span>. Once loaded, <span style="font-family: 'courier new', courier, monospace;">i4jinst.dll</span> reads the first stage encrypted shellcode from <span style="font-family: 'courier new', courier, monospace;">certificate.pem</span>. It then decrypts the shellcode and injects it into <span style="font-family: 'courier new', courier, monospace;">explorer.exe</span>.</p>
<p><a id="post-136552-_tdw97g4jgzp"></a> This includes the following discrete actions:</p>
<ol>
<li>The decrypted <span style="font-family: 'courier new', courier, monospace;">certificate.pem</span> contains the first stage shellcode that is executed</li>
<li>The shellcode loads <span style="font-family: 'courier new', courier, monospace;">C:\Windows\System32\BingMaps.dll</span></li>
<li>The function <span style="font-family: 'courier new', courier, monospace;">GetBingMapsFactory</span> is then overwritten with another shellcode decrypted from <span style="font-family: 'courier new', courier, monospace;">certificate.pem</span></li>
<li>The overwritten shellcode then carries out thread injection into the <span style="font-family: 'courier new', courier, monospace;">explorer.exe</span> process</li>
</ol>
<p><a id="post-136552-_vhv9lzi4xobx"></a> At this point in the infection chain, Cortex’s shellcode prevention raised alerts as shown in Figure 10.</p>
<figure id="attachment_136575" aria-describedby="caption-attachment-136575" style="width: 786px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136575 size-medium" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-650873-136552-10-786x310.png" alt="Cortex XDR network security diagram featuring two nodes connected by a line that includes an alert icon indicating a blocked high severity malware try. Additional details include timestamps, source information, category as malware, and action taken as prevented (blocked)." width="786" height="310" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-650873-136552-10-786x310.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-650873-136552-10-1772x700.png 1772w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-650873-136552-10-768x303.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-650873-136552-10-1536x607.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-650873-136552-10.png 2048w" sizes="(max-width: 786px) 100vw, 786px" /><figcaption id="caption-attachment-136575" class="wp-caption-text">Figure 10. Cortex shellcode protection prevents the injection from the malicious process into <span style="font-family: 'courier new', courier, monospace;">explorer.exe</span>.</figcaption></figure>
<p>If unprevented, the injected code in <span style="font-family: 'courier new', courier, monospace;">explorer.exe</span> will contact a compromised site running WordPress CMS as a C2 server for the WikiLoader backdoor. It will then establish persistence and communicate with MQTT brokers for tasking.</p>
<p>The injected code will load <span style="font-family: 'courier new', courier, monospace;">license_us_EN.html</span>. In the GlobalProtect spoofing campaign, <span style="font-family: 'courier new', courier, monospace;">license_us_EN.html</span> is a renamed copy of the <span style="font-family: 'courier new', courier, monospace;">AdInsight.exe</span> Microsoft Sysinternals binary. <span style="font-family: 'courier new', courier, monospace;">License_us_EN.html</span> will side load the WikiLoader backdoor downloaded from the C2 server.</p>
<p>Upon establishing persistence, <span style="font-family: 'courier new', courier, monospace;">AdInsight.exe</span> (renamed to <span style="font-family: 'courier new', courier, monospace;">license_us_EN.html</span>) will be renamed again to a random filename. This file will be written into a randomly named folder in <span style="font-family: 'courier new', courier, monospace;">ProgramData</span> along with a randomly named file with the extension <span style="font-family: 'courier new', courier, monospace;">.pem</span> and the WikiLoader backdoor as a <span style="font-family: 'courier new', courier, monospace;">.dll</span>. This process is shown in Figure 11.</p>
<figure id="attachment_136577" aria-describedby="caption-attachment-136577" style="width: 786px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136577 size-medium" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-654236-136552-11-786x192.png" alt="Screenshot of a file explorer window on a computer showing the contents of the &quot;RamDQ&quot; folder inside the &quot;ProgramData&quot; directory on drive C. The folder contains three files with details such as file type, date modified, and size displayed." width="786" height="192" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-654236-136552-11-786x192.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-654236-136552-11-1920x468.png 1920w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-654236-136552-11-768x187.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-654236-136552-11-1536x374.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-654236-136552-11.png 2048w" sizes="(max-width: 786px) 100vw, 786px" /><figcaption id="caption-attachment-136577" class="wp-caption-text">Figure 11. Files contained in a randomly named directory when WikiLoader writes persistence components to disk.</figcaption></figure>
<p>In testing environments where shellcode protection was disabled, Cortex XDR still generated an analytic behavioral indicator of compromise (BIOC) detection for the unusual creation of a scheduled task created by <span style="font-family: 'courier new', courier, monospace;">explorer.exe</span> following the shellcode injection.</p>
<p>In summary, the infection chain is as follows:</p>
<ol>
<li>Malicious behaviors begin when the victim launches <span style="font-family: 'courier new', courier, monospace;">GlobalProtect64.exe</span> and this file then loads <span style="font-family: 'courier new', courier, monospace;">i4jinst.dll</span> (located inside <span style="font-family: 'courier new', courier, monospace;">.install4j</span>)</li>
<li>Once loaded, <span style="font-family: 'courier new', courier, monospace;">i4jinst.dll</span> will read and decrypt the contents of the file <span style="font-family: 'courier new', courier, monospace;">certificate.pem</span></li>
<li>The decrypted <span style="font-family: 'courier new', courier, monospace;">certificate.pem</span> contains the first stage shellcode that the threat executes</li>
<li>The shellcode loads <span style="font-family: 'courier new', courier, monospace;">C:\Windows\System32\BingMaps.dll</span></li>
<li>The function <span style="font-family: 'courier new', courier, monospace;">GetBingMapsFactory</span> is then overwritten with another shellcode decrypted from <span style="font-family: 'courier new', courier, monospace;">certificate.pem</span></li>
<li>The overwritten shellcode then carries out thread injection into the <span style="font-family: 'courier new', courier, monospace;">explorer.exe</span> process</li>
<li>The injected code in the <span style="font-family: 'courier new', courier, monospace;">explorer.exe</span> process will contact the C2 server for the WikiLoader backdoor</li>
<li>If persisting, the threat will write <span style="font-family: 'courier new', courier, monospace;">license_us_EN.html</span> and another file with extension <span style="font-family: 'courier new', courier, monospace;">.pem</span> to a randomly named folder in <span style="font-family: 'courier new', courier, monospace;">ProgramData</span> along with the WikiLoader backdoor as a <span style="font-family: 'courier new', courier, monospace;">.dll</span></li>
<li>The threat will establish persistence via a scheduled task to execute the renamed <span style="font-family: 'courier new', courier, monospace;">license_us_EN.html</span></li>
<li>The injected code will read and execute a hidden PE file from <span style="font-family: 'courier new', courier, monospace;">license_us_EN.html</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">License_us_EN.html</span> will side load the WikiLoader backdoor downloaded from the C2 server</li>
<li>The backdoor will decrypt the shellcode encrypted in the randomly named file with <span style="font-family: 'courier new', courier, monospace;">extension .pem</span>. The decryption key is the name of the folder where the backdoor is located.</li>
</ol>
<p>We have added additional protections to Cortex, and we share a collection of hunting rules written in XQL at the end of this post.</p>
<h2><a id="post-136552-_i8pu67e5m9u8"></a>Highlighting WikiLoader Anti-Analysis and Defense Evasion</h2>
<p>The following are some unique tricks that this sample of WikiLoader used.</p>
<h3><a id="post-136552-_6vljhbrkfjm7"></a>Fake Error Message</h3>
<p>As the spoofed GlobalProtect installer is not an actual installer, the authors of WikiLoader needed another trick to fool victims. The threat shows a fake error message when it completes infection of the victim machine. This prevents the victim from wondering why GlobalProtect is not installed.</p>
<p>Figure 12 shows the fake error message generated by the sample.</p>
<figure id="attachment_136579" aria-describedby="caption-attachment-136579" style="width: 394px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136579" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-657270-136552-12.png" alt="Error message on a computer screen indicating that the program can't start because &quot;msvcr140.dll&quot; is missing and suggests installing runtime libraries to fix the problem. There is an &quot;OK&quot; button available to close the message." width="394" height="155" /><figcaption id="caption-attachment-136579" class="wp-caption-text">Figure 12. Fake error message displayed when the sample completes infection</figcaption></figure>
<h3><a id="post-136552-_eaj9mldjju2s"></a>Renamed Legitimate Software Used for Side-Loading Backdoor</h3>
<p>Attackers renamed the Microsoft Sysinternals tool <span style="font-family: 'courier new', courier, monospace;">ADInsight.exe</span> to <span style="font-family: 'courier new', courier, monospace;">license_us_EN.html</span>, and hid it inside the spoofed GlobalProtect installer. <span style="font-family: 'courier new', courier, monospace;">ADInsight.exe is</span> used to side load the WikiLoader backdoor. Figure 13 shows the contents of <span style="font-family: 'courier new', courier, monospace;">license_us_EN.html</span>.</p>
<figure id="attachment_136581" aria-describedby="caption-attachment-136581" style="width: 853px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136581 size-large" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-659894-136552-13-853x700.png" alt="Screenshot of a computer screen displaying a hexadecimal view of files. The selected file is Selected is license_us_EN.html. Also in view is &quot;GlobalProtect64.exe&quot; and &quot;launcher.jar&quot;, with decoded text showing HTML and programming code elements. " width="853" height="700" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-659894-136552-13-853x700.png 853w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-659894-136552-13-536x440.png 536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-659894-136552-13-768x630.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-659894-136552-13.png 1272w" sizes="(max-width: 853px) 100vw, 853px" /><figcaption id="caption-attachment-136581" class="wp-caption-text">Figure 13. Hex dump of <span style="font-family: 'courier new', courier, monospace;">license_us_EN.html</span> showing it is a PE file.</figcaption></figure>
<h3><a id="post-136552-_wohn4vmquiax"></a>Checks for Analysis Environments</h3>
<p>The sample checks the running processes in the victim machine against a list of hashes of software commonly used by malware analysts. As most malware analysts would be using a virtualized environment to analyze malware samples, the WikiLoader sample will terminate if it finds processes related to virtual machine software.</p>
<p>To hide the list of processes that WikiLoader is looking for, the malware uses a 32-bit hashing routine similar to those used by Emotet back in 2021. Figure 14 shows the hashing routine used by this WikiLoader sample.</p>
<figure id="attachment_136583" aria-describedby="caption-attachment-136583" style="width: 920px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136583" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-663452-136552-14.png" alt="A screenshot of a computer screen displaying assembly language code in an IDE environment. The code includes various operations such as MOV, XOR, and JMP among others, with hexadecimal values and register names." width="920" height="683" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-663452-136552-14.png 920w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-663452-136552-14-593x440.png 593w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-663452-136552-14-768x570.png 768w" sizes="(max-width: 920px) 100vw, 920px" /><figcaption id="caption-attachment-136583" class="wp-caption-text">Figure 14. Hashing routine used to obfuscate the analysis processes from above.</figcaption></figure>
<h3><a id="post-136552-_cojy2ywjbct8"></a>Folder Name as Decryption Key for the Backdoor</h3>
<p>The backdoor is encrypted using the <span style="font-family: 'courier new', courier, monospace;">CryptUnprotectData</span> API. This sample of WikiLoader used the folder name (<span style="font-family: 'courier new', courier, monospace;">RamDQ</span>) as the decryption key for its backdoor.</p>
<p>Figure 15 shows the folder named <span style="font-family: 'courier new', courier, monospace;">RamDQ</span>, which contained the encrypted backdoor <span style="font-family: 'courier new', courier, monospace;">1FoWZv.pem</span> and the executables (<span style="font-family: 'courier new', courier, monospace;">s2VT3.exe</span> and <span style="font-family: 'courier new', courier, monospace;">version.dll</span>) required to decrypt and execute the backdoor.</p>
<figure id="attachment_136585" aria-describedby="caption-attachment-136585" style="width: 1195px" class="wp-caption alignnone"><img decoding="async" class="wp-image-136585 size-full" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-666116-136552-15.png" alt="Screenshot of a computer interface with several open windows, including a code editor with Python script, command prompt, and file explorer showing files related to JavaScript. Some of the information is redacted. " width="1195" height="393" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-666116-136552-15.png 1195w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-666116-136552-15-786x258.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/word-image-666116-136552-15-768x253.png 768w" sizes="(max-width: 1195px) 100vw, 1195px" /><figcaption id="caption-attachment-136585" class="wp-caption-text">Figure 15. Screenshot showing <span style="font-family: 'courier new', courier, monospace;">CryptUnprotectData</span> being passed the folder name, ultimately to be used to decrypt the shellcode in <span style="font-family: 'courier new', courier, monospace;">1FoWZv.pem</span>.</figcaption></figure>
<h2><a id="post-136552-_2an8ryq91inv"></a>Conclusion</h2>
<p>Financially motivated threat actors will continue to use WikiLoader as a loader for rent in a variety of campaigns where they require a robust, stealthy Windows loader that pays reasonable attention to OPSEC.</p>
<p>What remains to be seen is why threat actors have shifted from phishing to SEO poisoning to deliver WikiLoader. One hypothesis is that another initial access broker (IAB) has begun to work with WikiLoader to operationalize its delivery through SEO poisoning in recent months. Alternatively, groups that are publicly tracked using WikiLoader could have shifted to SEO poisoning from phishing after an improvement in endpoint security controls or industry reporting disrupted their operations.</p>
<p>While SEO poisoning is not a new technique, it continues to be an effective way to deliver a loader to an endpoint. Spoofing trusted security software is likely to assist in bypassing endpoint controls at organizations that rely on filename based allow listing.</p>
<p>The combination of spoofed, compromised and legitimate infrastructure leveraged by WikiLoader campaigns reinforces the malware authors attention to building an operationally secure and robust loader, with multiple C2 configurations. The authors suspect that we will likely see continued WikiLoader use throughout 2024 and beyond.</p>
<p>Regardless of the anti-analysis and EDR evasion techniques employed by WikiLoader, the procedures employed can be identified using many common endpoint threat hunting methods. We share a selection of four queries in our appendix that organizations can use to hunt for WikiLoader with high fidelity in endpoint data. The queries can be expanded in scope with minimal changes from XQL users to cast a wider net, or narrow in on threats that may be more applicable to an organization’s environment.</p>
<p>Google has confirmed that all sites mentioned in this article are known to Safe Browsing. Any user that visits these sites will receive a warning of potential security risks.</p>
<h3><a id="post-136552-_lsbythhc3nz9"></a>Palo Alto Networks Protection and Mitigation</h3>
<p>Palo Alto Networks customers are better protected from the threats discussed above through the following products:</p>
<ul>
<li><a href="https://docs.paloaltonetworks.com/ngfw" target="_blank" rel="noopener">Next-Generation Firewall</a> with <a href="https://docs.paloaltonetworks.com/cdss" target="_blank" rel="noopener">Cloud-Delivered Security Services</a>, including <a href="https://docs.paloaltonetworks.com/wildfire" target="_blank" rel="noopener">Advanced WildFire</a>, detect the files mentioned within this report as malicious. Additionally <a href="https://docs.paloaltonetworks.com/advanced-url-filtering/administration" target="_blank" rel="noopener">Advanced URL Filtering</a> and <a href="https://docs.paloaltonetworks.com/dns-security" target="_blank" rel="noopener">Advanced DNS Security</a> identify known URLs and domains associated with this activity as malicious.</li>
<li><a href="https://docs-cortex.paloaltonetworks.com/p/XDR" target="_blank" rel="noopener">Cortex XDR</a> customers are better protected against the sideloads and shellcode injection attempts mentioned in the article. Cortex XDR detects and prevents these malware activities based on <a href="https://docs-cortex.paloaltonetworks.com/r/Cortex-XDR/Cortex-XDR-Prevent-Administrator-Guide/Endpoint-Protection" target="_blank" rel="noopener">Behavioral Threat Protection</a>, AI-driven local analysis, analytics profiles and other security engines across Windows, Linux and Mac systems.</li>
<li>Prisma Cloud can detect known WikiLoader binaries executed from within cloud environments through the <a href="https://docs-cortex.paloaltonetworks.com/r/Cortex-XDR/Cortex-XDR-Pro-Administrator-Guide/Pairing-Prisma-Cloud-Compute-with-Cortex-XDR" target="_blank" rel="noopener">Cloud Security Agent (CSA)</a>.</li>
</ul>
<p>If you think you may have been compromised or have an urgent matter, get in touch with the<a href="https://start.paloaltonetworks.com/contact-unit42.html" target="_blank" rel="noopener"> Unit 42 Incident Response team</a> or call:</p>
<ul>
<li>North America Toll-Free: 866.486.4842 (866.4.UNIT42)</li>
<li>EMEA: +31.20.299.3130</li>
<li>APAC: +65.6983.8730</li>
<li>Japan: +81.50.1790.0200</li>
</ul>
<p>Palo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about the <a href="https://www.cyberthreatalliance.org" target="_blank" rel="noopener">Cyber Threat Alliance</a>.</p>
<h2><a id="post-136552-_o9mz3pitmrax"></a>XQL Hunting Queries</h2>
<p><span style="font-family: 'courier new', courier, monospace;">Explorer.exe</span> communicating with MQTT brokers</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6719b4d97e452398379465" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
// Description: Communication to known MQTT broker services from explorer.exe. Observed samples have communicated with MQTT brokers over over plaintext or encrypted TCP ports, not using websockets. Typically these are TCP 1883,8883,8884

config case_sensitive = false

| dataset=xdr_data

| filter event_type = ENUM.STORY

| filter dst_action_external_hostname in ("broker.emqx.io","broker-cn.emqx.io","mqtt.eclipseprojects.io","test.mosquitto.org","broker.hivemq.com","*mqtt.one","*iotbind.com") and actor_process_image_name = "explorer.exe" and action_remote_port not in (53,80,443)

| fields _time, agent_hostname, agent_ip_addresses, actor_effective_username, actor_process_image_name, actor_process_image_path, dst_action_external_hostname, action_remote_port, action_remote_ip</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6719b4d97e452398379465-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e452398379465-2">2</div><div class="crayon-num" data-line="crayon-6719b4d97e452398379465-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e452398379465-4">4</div><div class="crayon-num" data-line="crayon-6719b4d97e452398379465-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e452398379465-6">6</div><div class="crayon-num" data-line="crayon-6719b4d97e452398379465-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e452398379465-8">8</div><div class="crayon-num" data-line="crayon-6719b4d97e452398379465-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e452398379465-10">10</div><div class="crayon-num" data-line="crayon-6719b4d97e452398379465-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6719b4d97e452398379465-1"><span class="crayon-c">// Description: Communication to known MQTT broker services from explorer.exe. Observed samples have communicated with MQTT brokers over over plaintext or encrypted TCP ports, not using websockets. Typically these are TCP 1883,8883,8884</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e452398379465-2">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e452398379465-3"><span class="crayon-e">config </span><span class="crayon-i">case_sensitive</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">false</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e452398379465-4">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e452398379465-5"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-i">dataset</span>=<span class="crayon-i">xdr_data</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e452398379465-6">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e452398379465-7"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-i">event_type</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">ENUM</span><span class="crayon-sy">.</span><span class="crayon-i">STORY</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e452398379465-8">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e452398379465-9"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-e">dst_action_external_hostname </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"broker.emqx.io"</span><span class="crayon-sy">,</span><span class="crayon-s">"broker-cn.emqx.io"</span><span class="crayon-sy">,</span><span class="crayon-s">"mqtt.eclipseprojects.io"</span><span class="crayon-sy">,</span><span class="crayon-s">"test.mosquitto.org"</span><span class="crayon-sy">,</span><span class="crayon-s">"broker.hivemq.com"</span><span class="crayon-sy">,</span><span class="crayon-s">"*mqtt.one"</span><span class="crayon-sy">,</span><span class="crayon-s">"*iotbind.com"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-i">actor_process_image_name</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">"explorer.exe"</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-e">action_remote_port </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">53</span><span class="crayon-sy">,</span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-cn">443</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e452398379465-10">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e452398379465-11"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">fields </span><span class="crayon-i">_time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">agent_hostname</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">agent_ip_addresses</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">actor_effective_username</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">actor_process_image_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">actor_process_image_path</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">dst_action_external_hostname</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action_remote_port</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action_remote_ip</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Common DLL sideload targets (step 8 in infection chain)</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6719b4d97e45d056114208" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
// Description: Processes that have have written 2 PEs, one must be a .exe, and the

// other a .dll with a name commonly abused for search order hijacking.

config case_sensitive = false

| dataset = xdr_data

// Get DLL and Exe writes excluding users and program files directories.

| filter event_type = ENUM.FILE and event_sub_type in (ENUM.FILE_WRITE, ENUM.FILE_CREATE_NEW) and action_file_extension IN ("dll","exe") and action_file_path !~= "C\:\\(?:Users|Program\sFiles(\s\(x86\))?)\\.*"

// Collate the file writes by the actor (writing) process

| comp count_distinct(action_file_path) as cnt_pe_written, count_distinct(action_file_extension) as cnt_pe_extensions, count_distinct(action_file_signature_status) as cnt_pe_sig_status, values(action_file_path) as pe_written, values(action_file_signature_status) as action_file_signature_status, values(action_file_signature_vendor) as action_file_signature_vendor, values(action_file_signature_product) as action_file_signature_product, values(actor_effective_username) as username, values(action_file_sha256) as action_file_sha256, values(_time) as time, values(actor_process_command_line) as command_line, values(action_file_name) as pe_written_name, values(agent_hostname) as agent_hostname by actor_process_instance_id

// Filter out those that have only written 1 Exe and 1 DLL, with a DLL using a known abused name

| filter cnt_pe_written=2 and cnt_pe_extensions=2 and pe_written_name ~= "^(?:vcruntime140|vcruntime|oci|version|msfte|secur32|nw|rw32core|iphlpapi|wininet)\.dll"

| filter pe_written_name not in ("*cortex-xdr-payload*","*xdrhealth.exe*","*winpty-agent.exe*")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6719b4d97e45d056114208-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e45d056114208-2">2</div><div class="crayon-num" data-line="crayon-6719b4d97e45d056114208-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e45d056114208-4">4</div><div class="crayon-num" data-line="crayon-6719b4d97e45d056114208-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e45d056114208-6">6</div><div class="crayon-num" data-line="crayon-6719b4d97e45d056114208-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e45d056114208-8">8</div><div class="crayon-num" data-line="crayon-6719b4d97e45d056114208-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e45d056114208-10">10</div><div class="crayon-num" data-line="crayon-6719b4d97e45d056114208-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e45d056114208-12">12</div><div class="crayon-num" data-line="crayon-6719b4d97e45d056114208-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e45d056114208-14">14</div><div class="crayon-num" data-line="crayon-6719b4d97e45d056114208-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e45d056114208-16">16</div><div class="crayon-num" data-line="crayon-6719b4d97e45d056114208-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e45d056114208-18">18</div><div class="crayon-num" data-line="crayon-6719b4d97e45d056114208-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e45d056114208-20">20</div><div class="crayon-num" data-line="crayon-6719b4d97e45d056114208-21">21</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6719b4d97e45d056114208-1"><span class="crayon-c">// Description: Processes that have have written 2 PEs, one must be a .exe, and the</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e45d056114208-2">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e45d056114208-3"><span class="crayon-c">// other a .dll with a name commonly abused for search order hijacking.</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e45d056114208-4">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e45d056114208-5"><span class="crayon-e">config </span><span class="crayon-i">case_sensitive</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">false</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e45d056114208-6">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e45d056114208-7"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-i">dataset</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">xdr_data</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e45d056114208-8">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e45d056114208-9"><span class="crayon-c">// Get DLL and Exe writes excluding users and program files directories.</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e45d056114208-10">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e45d056114208-11"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-i">event_type</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">ENUM</span><span class="crayon-sy">.</span><span class="crayon-e">FILE </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-e">event_sub_type </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">ENUM</span><span class="crayon-sy">.</span><span class="crayon-i">FILE_WRITE</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">ENUM</span><span class="crayon-sy">.</span><span class="crayon-i">FILE_CREATE_NEW</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-e">action_file_extension </span><span class="crayon-st">IN</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"dll"</span><span class="crayon-sy">,</span><span class="crayon-s">"exe"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-i">action_file_path</span><span class="crayon-h"> </span><span class="crayon-sy">!</span><span class="crayon-sy">~</span>=<span class="crayon-h"> </span><span class="crayon-s">"C\:\<span class="crayon-sy">\</span><span class="crayon-sy">(</span><span class="crayon-sy">?</span><span class="crayon-sy">:</span><span class="crayon-i">Users</span><span class="crayon-sy">|</span><span class="crayon-i">Program</span><span class="crayon-sy">\</span><span class="crayon-e">sFiles</span><span class="crayon-sy">(</span><span class="crayon-sy">\</span><span class="crayon-i">s</span><span class="crayon-sy">\</span><span class="crayon-sy">(</span><span class="crayon-i">x86</span><span class="crayon-sy">\</span><span class="crayon-sy">)</span>)?)\\.*"</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e45d056114208-12">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e45d056114208-13"><span class="crayon-c">// Collate the file writes by the actor (writing) process</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e45d056114208-14">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e45d056114208-15"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">comp </span><span class="crayon-e">count_distinct</span><span class="crayon-sy">(</span><span class="crayon-i">action_file_path</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">cnt_pe_written</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">count_distinct</span><span class="crayon-sy">(</span><span class="crayon-i">action_file_extension</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">cnt_pe_extensions</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">count_distinct</span><span class="crayon-sy">(</span><span class="crayon-i">action_file_signature_status</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">cnt_pe_sig_status</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">values</span><span class="crayon-sy">(</span><span class="crayon-i">action_file_path</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">pe_written</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">values</span><span class="crayon-sy">(</span><span class="crayon-i">action_file_signature_status</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">action_file_signature_status</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">values</span><span class="crayon-sy">(</span><span class="crayon-i">action_file_signature_vendor</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">action_file_signature_vendor</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">values</span><span class="crayon-sy">(</span><span class="crayon-i">action_file_signature_product</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">action_file_signature_product</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">values</span><span class="crayon-sy">(</span><span class="crayon-i">actor_effective_username</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">username</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">values</span><span class="crayon-sy">(</span><span class="crayon-i">action_file_sha256</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">action_file_sha256</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">values</span><span class="crayon-sy">(</span><span class="crayon-i">_time</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">values</span><span class="crayon-sy">(</span><span class="crayon-i">actor_process_command_line</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">command_line</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">values</span><span class="crayon-sy">(</span><span class="crayon-i">action_file_name</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">pe_written_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">values</span><span class="crayon-sy">(</span><span class="crayon-i">agent_hostname</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">agent_hostname </span><span class="crayon-e">by </span><span class="crayon-i">actor_process_instance_id</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e45d056114208-16">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e45d056114208-17"><span class="crayon-c">// Filter out those that have only written 1 Exe and 1 DLL, with a DLL using a known abused name</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e45d056114208-18">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e45d056114208-19"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-i">cnt_pe_written</span>=<span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-i">cnt_pe_extensions</span>=<span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-i">pe_written_name</span><span class="crayon-h"> </span><span class="crayon-sy">~</span>=<span class="crayon-h"> </span><span class="crayon-s">"^(?:vcruntime140|vcruntime|oci|version|msfte|secur32|nw|rw32core|iphlpapi|wininet)\.dll"</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e45d056114208-20">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e45d056114208-21"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-e">pe_written_name </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"*cortex-xdr-payload*"</span><span class="crayon-sy">,</span><span class="crayon-s">"*xdrhealth.exe*"</span><span class="crayon-sy">,</span><span class="crayon-s">"*winpty-agent.exe*"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0022 seconds] -->
<p>Processes executing as GlobalProtect without a parsed Palo Alto Networks certificate.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6719b4d97e45f369770227" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
// Description: A signed process starts with GlobalProtect or PanGP in the image name, but is not signed by a known Palo Alto Networks certificate.

config case_sensitive = false

| dataset=xdr_data

| filter event_type IN (ENUM.PROCESS) and event_sub_type = ENUM.PROCESS_START

| filter (action_process_image_name contains "GlobalProtect" or action_process_image_name contains "PanGP") and action_process_signature_vendor not in ("Palo Alto Networks","Palo Alto Networks (Netherlands) B.V.","Developer ID Application: Palo Alto Networks (PXPZ95SK77)","Palo Alto Networks, Inc") and action_process_signature_status=ENUM.SIGNED

| fields _time, agent_hostname, actor_effective_username, action_process_image_path , action_process_image_command_line , action_process_image_sha256, action_process_signature_status, action_process_signature_vendor, action_process_signature_product, action_process_image_sha256, actor_process_image_path , os_actor_process_command_line, causality_actor_process_command_line</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6719b4d97e45f369770227-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e45f369770227-2">2</div><div class="crayon-num" data-line="crayon-6719b4d97e45f369770227-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e45f369770227-4">4</div><div class="crayon-num" data-line="crayon-6719b4d97e45f369770227-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e45f369770227-6">6</div><div class="crayon-num" data-line="crayon-6719b4d97e45f369770227-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e45f369770227-8">8</div><div class="crayon-num" data-line="crayon-6719b4d97e45f369770227-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e45f369770227-10">10</div><div class="crayon-num" data-line="crayon-6719b4d97e45f369770227-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6719b4d97e45f369770227-1"><span class="crayon-c">// Description: A signed process starts with GlobalProtect or PanGP in the image name, but is not signed by a known Palo Alto Networks certificate.</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e45f369770227-2">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e45f369770227-3"><span class="crayon-e">config </span><span class="crayon-i">case_sensitive</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">false</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e45f369770227-4">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e45f369770227-5"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-i">dataset</span>=<span class="crayon-i">xdr_data</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e45f369770227-6">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e45f369770227-7"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-e">event_type </span><span class="crayon-st">IN</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">ENUM</span><span class="crayon-sy">.</span><span class="crayon-i">PROCESS</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-i">event_sub_type</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">ENUM</span><span class="crayon-sy">.</span><span class="crayon-i">PROCESS_START</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e45f369770227-8">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e45f369770227-9"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">action_process_image_name </span><span class="crayon-i">contains</span><span class="crayon-h"> </span><span class="crayon-s">"GlobalProtect"</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-e">action_process_image_name </span><span class="crayon-i">contains</span><span class="crayon-h"> </span><span class="crayon-s">"PanGP"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-e">action_process_signature_vendor </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"Palo Alto Networks"</span><span class="crayon-sy">,</span><span class="crayon-s">"Palo Alto Networks (Netherlands) B.V."</span><span class="crayon-sy">,</span><span class="crayon-s">"Developer ID Application: Palo Alto Networks (PXPZ95SK77)"</span><span class="crayon-sy">,</span><span class="crayon-s">"Palo Alto Networks, Inc"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-i">action_process_signature_status</span>=<span class="crayon-t">ENUM</span><span class="crayon-sy">.</span><span class="crayon-t">SIGNED</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e45f369770227-10">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e45f369770227-11"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">fields </span><span class="crayon-i">_time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">agent_hostname</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">actor_effective_username</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action_process_image_path</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action_process_image_command_line</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action_process_image_sha256</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action_process_signature_status</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action_process_signature_vendor</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action_process_signature_product</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action_process_image_sha256</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">actor_process_image_path</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">os_actor_process_command_line</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">causality_actor_process_command_line</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Review ZIP files with GlobalProtect naming that have Mark of the Web applied for suspicious download sources</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6719b4d97e460441500604" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
// Description: Delivery via .zip files is common, display those that were downloaded with Mark of the Web data.

config case_sensitive = false

| dataset=xdr_data

| filter event_type=ENUM.FILE and event_sub_type IN (ENUM.FILE_OPEN, ENUM.FILE_CREATE_NEW)

| filter action_file_extension="zip" and action_file_path ~= "Downloads|Appdata" and action_file_name contains "GlobalProtect" and not action_file_name contains "GlobalProtectLogs"

| fields _time, event_sub_type, agent_hostname, actor_effective_username, action_file_name, action_file_path, action_file_web_mark, action_file_sha256 , actor_process_image_name, actor_process_image_sha256</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6719b4d97e460441500604-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e460441500604-2">2</div><div class="crayon-num" data-line="crayon-6719b4d97e460441500604-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e460441500604-4">4</div><div class="crayon-num" data-line="crayon-6719b4d97e460441500604-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e460441500604-6">6</div><div class="crayon-num" data-line="crayon-6719b4d97e460441500604-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e460441500604-8">8</div><div class="crayon-num" data-line="crayon-6719b4d97e460441500604-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b4d97e460441500604-10">10</div><div class="crayon-num" data-line="crayon-6719b4d97e460441500604-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6719b4d97e460441500604-1"><span class="crayon-c">// Description: Delivery via .zip files is common, display those that were downloaded with Mark of the Web data.</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e460441500604-2">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e460441500604-3"><span class="crayon-e">config </span><span class="crayon-i">case_sensitive</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">false</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e460441500604-4">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e460441500604-5"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-i">dataset</span>=<span class="crayon-i">xdr_data</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e460441500604-6">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e460441500604-7"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-i">event_type</span>=<span class="crayon-t">ENUM</span><span class="crayon-sy">.</span><span class="crayon-e">FILE </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-e">event_sub_type </span><span class="crayon-st">IN</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">ENUM</span><span class="crayon-sy">.</span><span class="crayon-i">FILE_OPEN</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">ENUM</span><span class="crayon-sy">.</span><span class="crayon-i">FILE_CREATE_NEW</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e460441500604-8">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e460441500604-9"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">filter </span><span class="crayon-i">action_file_extension</span>=<span class="crayon-s">"zip"</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-i">action_file_path</span><span class="crayon-h"> </span><span class="crayon-sy">~</span>=<span class="crayon-h"> </span><span class="crayon-s">"Downloads|Appdata"</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-e">action_file_name </span><span class="crayon-i">contains</span><span class="crayon-h"> </span><span class="crayon-s">"GlobalProtect"</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">action_file_name </span><span class="crayon-i">contains</span><span class="crayon-h"> </span><span class="crayon-s">"GlobalProtectLogs"</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b4d97e460441500604-10">&nbsp;</div><div class="crayon-line" id="crayon-6719b4d97e460441500604-11"><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">fields </span><span class="crayon-i">_time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">event_sub_type</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">agent_hostname</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">actor_effective_username</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action_file_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action_file_path</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action_file_web_mark</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">action_file_sha256</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">actor_process_image_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">actor_process_image_sha256</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<h2><a id="post-136552-_v8176g40kstn"></a>Indicators of Compromise</h2>
<p>These indicators were active throughout June 2024.</p>
<p><strong>Delivery URLs</strong></p>
<ul>
<li>URL: <span style="font-family: 'courier new', courier, monospace;">hxxps://globalprotect[.]securedownload[.]today/GlobalProtect64.zip</span></li>
</ul>
<p>Description: URL serving archive impersonating GlobalProtect.</p>
<ul>
<li>URL: <span style="font-family: 'courier new', courier, monospace;">hxxps://globalprojectvpn[.]com</span></li>
</ul>
<p>Description: Fake GlobalProtect site that delivers fake <span style="font-family: 'courier new', courier, monospace;">GlobalProtect64.zip</span></p>
<ul>
<li>URL: <span style="font-family: 'courier new', courier, monospace;">hxxps://globalprojectvpn[.]com</span></li>
</ul>
<p>Description: Fake GlobalProtect site that pulled from a Bitbucket project to deliver fake <span style="font-family: 'courier new', courier, monospace;">GlobalProtect64.zip</span></p>
<ul>
<li>URL: <span style="font-family: 'courier new', courier, monospace;">hxxps://bitbucket[.]org/bitprotect/globalproject/src/main/</span></li>
</ul>
<p>Description: Bitbucket project that hosted fake <span style="font-family: 'courier new', courier, monospace;">GlobalProtect64.zip</span></p>
<p><strong>WikiLoader C2 URLs</strong></p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">hxxps://carniceriamartinezadria.com/wp-content/themes/twentytwentyfour/rleoec.php?id=1</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">hxxps://jlholgado.com/wp-content/themes/twentytwentyfour/zca2ck.php?id=1</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">hxxps://elpgtextil.com/wp-content/themes/twentytwentyfour/44snwx.php?id=1</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">hxxps://arbeitsschutz-mmk.de/plugins/search/contacts/chrndi.php?id=1</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">hxxps://www.estudioemm.com/wp-content/themes/twentytwelve/d4kih3.php?id=1</span></li>
</ul>
<p>Description: C2 providing the decryption key to the payload of the WikiLoader sample</p>
<p><strong>SHA-256 hashes for WikiLoader shellcode loader DLLs</strong></p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">d4eb9a4ee389f03c402e553724015af8d5b85835828bd66b1b45131b6837802f</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">534c989d110ece8c429d2ded913933b961710726d8655b858474bc31dfed25c3</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">a001642046a6e99ab2b412d96020a243a221e3819eaac94ab3251fad7d20614b</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">c6c250e1cd6d5477b46871ffe17deac248d723ad45687fc54ae4fc5e3f45d91c</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">f1a49cea454bac3e78ac765b247b65d00c896d84de2028892b00d4310453c665</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">2ab449666cf006125075e3ded8053cdfd318e4772d4145f0fa861f1d42cb2b08</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">1d6f76acecff63fb373b5774a3cb34b87266a4a4bbb8e3a0757d107187d280ee</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">b412b2c190b8406392406d9a8e3abce91c9014950bcf835eb7d9b50d0f128cb0</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">66735d0178badf035be0e142f4fb8e23d860bfc9bbdc3e12ad1f2764de91ee9b</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">edec55f87e535f869119db44e4e7302081f53dbf33a27aaf905430cedc5a78b9</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">148b29123bb0c28614858460d7a10707469fecebd6a9ff1da98a0c76a89a9819</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">0de42118dd0cd861bea13de097457ccb407aae901b14e0bec59b0abe660cdf1f</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">5576ab87eb11ca4d2944bc1c2c6a8c349e18c7ded583c1ba9bd99eff9d8ac4d7</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">551da6814a01a280afe90aa6bb238f499d98ad496c0d8472a1705540a6f422da</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">4f573ab13882efa234a79483d305b3001cb09c0a166ff94c925844b860162415</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">4f2079cd2e228a2777df45ae00714c8679531fd8ad82a66b5c1b10e800771f18</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">2add886330db1480da7314ee38428ca79af04f8c461c3bbbd68e202bb5f4c415</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">76d1a876c90ec16f44685f795e64ab84bd2d3f5a91db659c9879b3461ee104f9</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">6aa4a830aa8d89b629fe87d3d3e986042215b5bcd670417933fca854b6dd58d9</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">1c1d739f0282bfd9367e29ca81c61ed4a731e5150a836d0371e5e9d0121c9dfd</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">69a94bbed366bfd917dfd8fb6e5fd7ba52e2dbf338edd0c259654981060943c8</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">9a48f32e00877a4335206c7da45a94ca8bd46648d3a0bc88e0789dabf8139024</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">c3280452e7c96253b215342f2fac14634591adf68f88bcf7dc920d5f28022cd6</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">0c44a46f1c8e46fe6b6f83ec249c95301aca1bc4765cee7bdadd021bbfd2ff66</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">2b8b3f5b692f716116a1468b8d7b273baf7a6cef0726e831cd307d2f2c7452ec</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">e07787caf52dd3e7dd0da600dbd1d909f3799dcebcdc60d101baf3ea17ef1e32</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">50810e4696dd075ca23349e3e1c3a87fc7b46ab89f4b1eb093a5cfb74f84cc51</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">912cc2a3592b3b7835205d275cbf92bb66effc99cbd5cc338a223888de1b0d35</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">f04715827e5453b33ba6fae8475b8c45150b27cc1361441648c46d13025283d2</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">e693652763141522621f9fcd80efb30cefa363f8bd9bdc65e5ffbf9fb8d76d3b</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">8d5e185d53e81e90646d684dff7cb399973e3cde6d833e6f7431074f4362139a</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">ec59616b1c80951d6597d4f25a9c031be0391151dc1073a5bece466473f0bdfe</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">e7e674218a7d93595e33a092f4f519a65499651a398ca350f5a50e135e64fa41</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">78f6f94aaa72e41d64e4dc309a3553399db2b4cd0edae5653ca4b6e7839e1215</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">abce298ebb4ac7bc1a5167179875afc88e7e99475bf681953e8b964237b7d7ed</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">82ec4e1a6ddf6eeb4030d6dd698f4576d0445d4d5722d5c60b0cc74ac501bb85</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">0d495a94e29faa4dfded29253322be1b2c534a56c078bea1ad8f1dc1fd23b742</span></li>
</ul>
<p><strong>SHA-256 hashes for WikiLoader backdoor </strong></p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">4044a0d7a0ed7f66efc2bd13616ec63a5722fc7a73a28fe3bda513f60ef24dd9</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">c9eaaa6aee55704ce651c8b4cde7949cfa9711e05a136fa15f234d1bb2ea994c</span></li>
</ul>
<h2><a id="post-136552-_h2tzk9ecn51y"></a><br />
Additional Resources</h2>
<ul>
<li><a href="https://www.trendmicro.com/en_us/research/24/h/threat-actors-target-middle-east-using-fake-tool.html" target="_blank" rel="noopener">Threat Actors Target the Middle East Using Fake Palo Alto GlobalProtect Tool</a> – Trend Micro</li>
<li><a href="https://x.com/malwrhunterteam/status/1818161627612525035" target="_blank" rel="noopener">X thread on spoof of GlobalProtext</a>– @malwrhunterteam, X</li>
<li><a href="https://www.broadcom.com/support/security-center/protection-bulletin/protection-highlight-wikiloader-returns" target="_blank" rel="noopener">Protection Highlight: WikiLoader Returns</a> – Broadcom</li>
<li><a href="https://x.com/pr0xylife/status/1712749465637929370" target="_blank" rel="noopener">20mb zip drop via discord</a> –  @pr0xylife, X</li>
<li><a href="https://securityintelligence.com/x-force/wailingcrab-malware-misues-mqtt-messaging-protocol/" target="_blank" rel="noopener">Stealthy WailingCrab Malware misuses MQTT Messaging Protocol</a> – Security Intelligence, IBM</li>
</ul>
<p class="p1"><i>Updated Sept. 4, 2024, at 1:20 p.m. PT to include clarifying language from Google.</i></p>
      
              </div>
              <!--<span class="post__date">Updated 10 September, 2024 at 6:44 AM PDT</span>-->
              <button class="l-btn back-to-top" id="backToTop" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:back to top">Back to top</button>
              
			<div class="be__tags-wrapper"> 
				<h3>Tags</h3><ul role="list"><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/dll-sideloading/" role="link" title="DLL Sideloading" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:tags:DLL Sideloading">DLL Sideloading</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/emotet/" role="link" title="Emotet" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:tags:Emotet">Emotet</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/evasion/" role="link" title="Evasion" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:tags:Evasion">Evasion</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/loader-as-a-service/" role="link" title="Loader as a service" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:tags:Loader as a service">Loader as a service</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/malvertising/" role="link" title="malvertising" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:tags:malvertising">Malvertising</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/seo-poisoning/" role="link" title="SEO poisoning" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:tags:SEO poisoning">SEO poisoning</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/spoof/" role="link" title="Spoof" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:tags:Spoof">Spoof</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/wailingcrab/" role="link" title="WailingCrab" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:tags:WailingCrab">WailingCrab</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/wikiloader/" role="link" title="WikiLoader" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:tags:WikiLoader">WikiLoader</a></li></ul>
			</div> 
              <div class="be__post-nav">
    <a class="prev" href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:article-nav:Threat Research Center"> 
        <span>Threat Research Center</span>
    </a>
            <a class="next" href="https://unit42.paloaltonetworks.com/tracking-newly-released-top-level-domains/" role="link" title="TLD Tracker: Exploring Newly Released Top-Level Domains" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:article-nav:TLD Tracker: Exploring Newly Released Top-Level Domains"> 
            <span>Next: TLD Tracker: Exploring Newly Released Top-Level Domains</span>
        </a>
    </div>
 
            </div>
            <div class="be__nav">
            <div class="be__nav-wrapper">
      <div class="be-table-of-contents" data-toc-track="global-protect-vpn-spoof-distributes-wikiloader:sidebar:table-of-contents">
      <div class="be-title__wrapper">
        <h3>Table of Contents</h3>
      </div> 
            <ul>
        <li></li>
      </ul>
    </div>
   
        <div class="be-related-articles">
        <h3>Related Articles</h3>
        <ul> 
                        <li>
                  <a href="https://unit42.paloaltonetworks.com/stately-taurus-abuses-vscode-southeast-asian-espionage/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:sidebar:related-articles:Chinese APT Abuses VSCode to Target Government in Asia">
                      Chinese APT Abuses VSCode to Target Government in Asia                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/darkgate-malware-uses-excel-files/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:sidebar:related-articles:DarkGate: Dancing the Samba With Alluring Excel Files">
                      DarkGate: Dancing the Samba With Alluring Excel Files                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/javascript-malware-gootloader/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:sidebar:related-articles:Dissecting GootLoader With Node.js">
                      Dissecting GootLoader With Node.js                  </a>
              </li>
                      </ul>
      </div>
      </div> 
            </div>
          </div>
        </div>
          <div class="pa related-threat">
    <div class="l-container">
            <h2>Related Malware Resources</h2>
      <div class="blog-slider" id="blogSlider"> 
                    <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of a campaign like Contagious Interview. Digital graphic of a glowing globe with network connections and data streams, symbolizing global connectivity and technology advancements." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/north-korean-threat-actors-lure-tech-job-seekers-as-fake-recruiters/" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware">
                    <h4 class="post-title">Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:North Korea">North Korea</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/social-engineering/" title="social engineering" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:social engineering">Social engineering</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/python/" title="Python" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:Python">Python</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/north-korean-threat-actors-lure-tech-job-seekers-as-fake-recruiters/" title="Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider"  data-card-link="https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/" data-video-cta-tracking="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:card:video-modal:Read the article" data-video-title="Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning">
              <div class="card-media has-video" data-video="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922.jpg">
                              <figure>
                <img width="718" height="440" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-718x440.jpg" class="attachment-medium size-medium" alt="A pictorial representation of machine learning detecting vulnerability scanning. A Black man using a tablet with a background of illuminated city buildings at night." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-718x440.jpg 718w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-1143x700.jpg 1143w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-768x470.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922.jpg 1505w" sizes="(max-width: 718px) 100vw, 718px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning">
                    <h4 class="post-title">Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/machine-learning/" title="Machine Learning" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:Machine Learning">Machine Learning</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/" title="Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of keylogger malware like KLogEXE and FPSpy. Person working on a laptop with lines of code displayed on the screen, with a blurred effect indicating motion or activity, surrounded by a vivid blue and red lighting." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/kimsuky-new-keylogger-backdoor-variant/" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy">
                    <h4 class="post-title">Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/mitre/" title="MITRE" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:MITRE">MITRE</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/keylogger/" title="Keylogger" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:Keylogger">Keylogger</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:North Korea">North Korea</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/kimsuky-new-keylogger-backdoor-variant/" title="Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of SnipBot. Digital abstract background featuring binary code and technology symbols with a blue glow in the shape of a skull." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/snipbot-romcom-malware-variant/" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Inside SnipBot: The Latest RomCom Malware Variant">
                    <h4 class="post-title">Inside SnipBot: The Latest RomCom Malware Variant</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/backdoor/" title="backdoor" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:backdoor">Backdoor</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/romcom/" title="RomCom" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:RomCom">RomCom</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/snipbot-romcom-malware-variant/" title="Inside SnipBot: The Latest RomCom Malware Variant" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="A pictorial representation of a red team tool like Splinter. A digital illustration showing a 3D brain model surrounded by rising data columns on a circuit board, representing advanced artificial intelligence technology." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/analysis-pentest-tool-splinter/" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool">
                    <h4 class="post-title">Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/red-teaming-tool/" title="red teaming tool" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:red teaming tool">Red teaming tool</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/pentest-tool/" title="pentest tool" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:pentest tool">Pentest tool</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/analysis-pentest-tool-splinter/" title="Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-786x368.png" class="attachment-medium size-medium" alt="Pictorial representation of APT groups from North Korea. The silhouette of two fish and the Pisces constellation inside an orange abstract planet, surrounded by two larger blue fish. Abstract, stylized cosmic setting with vibrant blue and purple shapes, representing space and distant planetary bodies." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/gleaming-pisces-applejeus-poolrat-and-pondrat/" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors">
                    <h4 class="post-title">Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/python/" title="Python" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:Python">Python</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/cryptocurrency/" title="Cryptocurrency" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:Cryptocurrency">Cryptocurrency</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:North Korea">North Korea</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/gleaming-pisces-applejeus-poolrat-and-pondrat/" title="Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-786x368.png" class="attachment-medium size-medium" alt="Illustrative image featuring two fish and the Pisces constellation superimposed on a stylized, abstract background with flowing purple waves and a starry night sky." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/top-cyberthreats/" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Threat Assessment: North Korean Threat Groups:High Profile Threats"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/top-threats.svg" alt=" category icon">High Profile Threats</span></a>                  <a href="https://unit42.paloaltonetworks.com/threat-assessment-north-korean-threat-groups-2024/" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Threat Assessment: North Korean Threat Groups">
                    <h4 class="post-title">Threat Assessment: North Korean Threat Groups</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Threat Assessment: North Korean Threat Groups:North Korea">North Korea</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/remote-access-trojan/" title="Remote Access Trojan" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Threat Assessment: North Korean Threat Groups:Remote Access Trojan">Remote Access Trojan</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/finance/" title="Finance" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Threat Assessment: North Korean Threat Groups:Finance">Finance</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/threat-assessment-north-korean-threat-groups-2024/" title="Threat Assessment: North Korean Threat Groups" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Threat Assessment: North Korean Threat Groups:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-786x368.png" class="attachment-medium size-medium" alt="Pictorial representation of Stately Taurus&#039; updated TTPs. Illustration of a bull&#039;s head and the Taurus constellation inside a stylized orange moon, set against the profile of a much larger bull&#039;s head. Shooting stars are on the dark background." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/stately-taurus-abuses-vscode-southeast-asian-espionage/" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Chinese APT Abuses VSCode to Target Government in Asia">
                    <h4 class="post-title">Chinese APT Abuses VSCode to Target Government in Asia</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/dll-sideloading/" title="DLL Sideloading" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:DLL Sideloading">DLL Sideloading</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/advanced-persistent-threat/" title="Advanced Persistent Threat" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:Advanced Persistent Threat">Advanced Persistent Threat</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/china/" title="China" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:China">China</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/stately-taurus-abuses-vscode-southeast-asian-espionage/" title="Chinese APT Abuses VSCode to Target Government in Asia" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                          <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-786x368.png" class="attachment-medium size-medium" alt="Pictorial representation of APT Fighting Ursa. The silhouette of a bear and the Ursa constellation inside an orange abstract planet. Abstract, stylized cosmic setting with vibrant blue and purple claw marks, representing space and distant planetary bodies." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Fighting Ursa Luring Targets With Car for Sale:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/fighting-ursa-car-for-sale-phishing-lure/" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Fighting Ursa Luring Targets With Car for Sale">
                    <h4 class="post-title">Fighting Ursa Luring Targets With Car for Sale</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/advanced-persistent-threat/" title="Advanced Persistent Threat" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Fighting Ursa Luring Targets With Car for Sale:Advanced Persistent Threat">Advanced Persistent Threat</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/apt28/" title="APT28" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Fighting Ursa Luring Targets With Car for Sale:APT28">APT28</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/fancy-bear/" title="Fancy Bear" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Fighting Ursa Luring Targets With Car for Sale:Fancy Bear">Fancy Bear</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/fighting-ursa-car-for-sale-phishing-lure/" title="Fighting Ursa Luring Targets With Car for Sale" role="link" data-page-track="true" data-page-track-value="global-protect-vpn-spoof-distributes-wikiloader:related-resources:Fighting Ursa Luring Targets With Car for Sale:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                    </div>
    </div>
    <div class="l-container bs__controls">
      <div class="bs__progress"><span></span></div>
      <div class="bs__navigation"> 
        <ul>
          <li> 
            <button id="prevButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
          <li> 
            <button id="nextButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
        </ul>
      </div>
    </div>
  </div>
 
        <div class="be-enlarge-modal" id="enlargedModal">
          <div class="be-enlarge-modal__wrapper"> 
            <figure> 
              <button class="close__modal" id="closeModal"> 
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button"></button>
              <img class="be__enlarged-image" id="enlargedImage" src="" alt="Enlarged Image">
              <figcaption> </figcaption>
            </figure>
          </div>
        </div>

      </div>
    </section>
  </main>
<!--  Start: Footer subscription form -->
<div class="newsletter">
      <div class="l-container">
        <div class="newsletter__wrapper">
          <div class="image__wrapper"> 
            <picture>
			              	 <source media="(max-width:400px)" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-mobile.webp">
			  			               	 <source media="(max-width:949px)" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-tab.webp">
			  			  			  	<img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/Revitalized_newsletter-Image-desktop-copy-1.webp" alt="Newsletter">
			              </picture>
          </div>
          <div class="content__wrapper"> 
		    							<span class="pre-title"> 
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/palo-alto-logo-small.svg" alt="UNIT 42 Small Logo">
				Get updates from Unit 42			</span>
						           	 <h2>Peace of mind comes from staying ahead of threats. Contact us today.</h2>
			            <form action="https://www.paloaltonetworks.com/apps/pan/public/formsubmithandler.submitform.json" method="post" novalidate class="subscribe-form" name="Unit42_Subscribe" id="unit42footerSubscription_form">
              <input type="hidden" name="emailFormMask" value="">
              <input type="hidden" value="1086" name="formid">
              <input type="hidden" value="531-OCS-018" name="munchkinId">
              <input type="hidden" value="2141" name="lpId">
              <input type="hidden" value="1203" name="programId">
              <input type="hidden" value="1086" name="formVid">
              <input type="hidden" name="mkto_optinunit42" value="true">
              <input type="hidden" name="mkto_opt-in" value="true">
              <div class="form-group"> 
                <label for="newsletter-email"  id="newsletter-email-label">Your Email</label>
                <input type="emal" placeholder="Your Email" name="Email"  class="subscribe-field" id="newsletter-email" aria-labelledby="newsletter-email-label">
                <p class="error-mail mb-15 text-danger" style="color: #dc3545"></p>
				<p>Subscribe for email updates to all Unit 42 threat research.<br />By submitting this form, you agree to our <a title="Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use" data-page-track="true" data-page-track-value="Get updates from Unit 42:Terms of Use">Terms of Use</a> and acknowledge our <a title="Privacy Statement" href="https://www.paloaltonetworks.com/legal-notices/privacy" data-page-track="true" data-page-track-value="Get updates from Unit 42:Privacy Statement">Privacy Statement.</a></p>
                <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6Lc5EhgTAAAAAJa-DzE7EeWABasWg4LKv-R3ao6o"></div>
                <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Invalid captcha!</p>
                <button class="l-btn is-disabled" data-page-track="true" data-page-track-value="footer:Get updates from Unit 42:Subscribe" id="unit42footerSubscription_form_button"> 
					Subscribe					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow"  class="arrow">
					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-loader.svg" alt="loader" class="loader">
			   </button>
				<div class="form-success-message"></div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

<script>

(function($) {
	// Migrated from the unit42-v5 + Modifications
	var subscribeSuccess = false;
	var email = document.getElementById('newsletter-email');
	var subscription_form = document.getElementById('unit42footerSubscription_form');
	var subscription_form_button = document.getElementById('unit42footerSubscription_form_button');
	window.captchaComplete = function() {
		subscribeSuccess = true;
		if ($(mail).val() != '' && isEmail($(mail).val())) {
			$(subscription_form_button).removeClass('is-disabled');
		}
		setTimeout(function() {
			$(email).focus();
			$('.g-recaptcha iframe').attr('tabindex', '-1');
		}, 100)
	}
	window.captchaExpires = function() {
		subscribeSuccess = false;
		$(subscription_form_button).addClass('is-disabled', true);
	} 
	$(subscription_form).submit(function(e) {
		e.preventDefault();
		e.stopImmediatePropagation();
		updateEmailMask();
		var success = true;
		var form = $(this);
		var mail = form.find('input[name="Email"]');
		
		if (mail.val() === '') {
			mail.addClass('has-error');
			showError(1);
			success = false;	
		}  else if (!isEmail(mail.val())){
			showError(2);
			success = false;
		}
		else {
			mail.removeClass('has-error');
			$('.error-mail').addClass('d-none');
		}

		if (!subscribeSuccess) {
			$('.error-recaptcha').removeClass('d-none');
		} else {
			$('.error-recaptcha').addClass('d-none');
		}

		if (success && subscribeSuccess) {
			$.ajax({
				type: 'POST',
				url: form.attr('action'),
				data: form.serialize(),
				beforeSend: function() {
                 form.find('button').addClass('is-loading');
    			},
				success: function(msg) {
					form.find('.form-success-message').html('<p class="success-message">You have been successfully subscribed</p>');
					form.find('button').removeClass('is-loading');
					$(email).val('');
					clearError();
				},
				error: function(jqXHR, textStatus, errorThrown) {
					$(subscription_form_button).addClass('is-disabled', true);
					form.find('button').removeClass('is-loading');
					
				}
			});
		}
		return false;
	});
	function showError(error_type){
		if(error_type == 1) {
			$('.error-mail').text("Please enter the email address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		} else if(error_type == 2){
			$('.error-mail').text("Please provide a valid e-mail address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		}	
		$(subscription_form_button).removeClass('is-loading');
	}
	function clearError(){
		$('.error-mail').text("").removeClass('error-show');;
		$(subscription_form_button).removeClass('is-loading');
		$(subscription_form_button).removeClass('is-disabled');
	}
	
	$(email).on('input', function (event) { 
		var email = $(this).val();
		if (isEmail(email) ) {			
			clearError();
		} else if(email == ""){
			clearError();
		} else{
			showError(2);			  
		}
    });

	function isEmail(email) {
		var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
		return re.test(String(email).toLowerCase());
	}
	
	var captcha_loaded = false;
         if(!captcha_loaded){
            // recaptcha on foucs call
            $(document).on('change paste keyup', '#newsletter-email', function () {
               if($('.g-recaptcha').hasClass('d-none')){
                $('.g-recaptcha').removeClass('d-none');
               }
               if(!captcha_loaded ){
                  captcha_loaded  = true;
                  // trigger loading api.js (recaptcha.js) script
                  var head = document.getElementsByTagName('head')[0];
                  var script = document.createElement('script');
                  script.type = 'text/javascript';
                  script.src = 'https://www.google.com/recaptcha/api.js?hl=en_US';
                  head.appendChild(script);
               }
            });
        }
	
	function updateEmailMask() {
		var email = $("#unit42footerSubscription_form input[name='Email']").val();
		if (email && email.trim() != '') {
			var maskedEmail = maskEmailAddress(email);
			$("#unit42footerSubscription_form input[name='emailFormMask']").val(maskedEmail);
		}
	}

	function maskEmailAddress (emailAddress) {
		function mask(str) {
			var strLen = str.length;
			if (strLen > 4) {
				return str.substr(0, 1) + str.substr(1, strLen - 1).replace(/\w/g, '*') + str.substr(-1,1);
			}
			return str.replace(/\w/g, '*');
		}
		return emailAddress.replace(/([\w.]+)@([\w.]+)(\.[\w.]+)/g, function (m, p1, p2, p3) {
			return mask(p1) + '@' + mask(p2) + p3;
		});

		return emailAddress;
	}

}(jQuery));
//# sourceMappingURL=main.js.map
	
</script>
<!--  End: Footer subscription form -->

<footer class="footer"> 
  <div class="footer-menu">
    <div class="l-container">
      <div class="footer-menu__wrapper">
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Products and services</h3>
                                <div class="nav-column__wrapper"> 
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security"   role="link" title="Network Security Platform" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform">Network Security Platform</a>
						</li>    
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/security-subscriptions"   role="link" title="CLOUD DELIVERED SECURITY SERVICES" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES">CLOUD DELIVERED SECURITY SERVICES</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-threat-prevention" target=_blank  role="link" title="Advanced Threat Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention">Advanced Threat Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-dns-security"   role="link" title="DNS Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security">DNS Security</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-data-loss-prevention"   role="link" title="Data Loss Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention">Data Loss Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-iot-security"   role="link" title="IoT Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security">IoT Security</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall"   role="link" title="Next-Generation Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls">Next-Generation Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall-hardware"   role="link" title="Hardware Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls">Hardware Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/strata-cloud-manager"   role="link" title="Strata Cloud Manager" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager">Strata Cloud Manager</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/sase"   role="link" title="SECURE ACCESS SERVICE EDGE" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE">SECURE ACCESS SERVICE EDGE</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/access"   role="link" title="Prisma Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access">Prisma Access</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/sd-wan"   role="link" title="Prisma SD-WAN" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN">Prisma SD-WAN</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/adem"   role="link" title="Autonomous Digital Experience Management" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management">Autonomous Digital Experience Management</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/next-gen-casb"   role="link" title="Cloud Access Security Broker" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker">Cloud Access Security Broker</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/ztna"   role="link" title="Zero Trust Network Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker:Zero Trust Network Access">Zero Trust Network Access</a>
						</li>    
					        
					</ul>
				</nav>
						         
            </div>
            <div class="nav-column">
                          													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/prisma/whyprisma"   role="link" title="Code to Cloud Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform">Code to Cloud Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/prisma/cloud"   role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud">Prisma Cloud</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/content/pan/en_US/prisma/cloud/cloud-native-application-protection-platform"   role="link" title="Cloud-Native Application Protection Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud:Cloud-Native Application Protection Platform">Cloud-Native Application Protection Platform</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/cortex" target=_blank  role="link" title="AI-Driven Security Operations Platform" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform">AI-Driven Security Operations Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xdr"   role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR">Cortex XDR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsoar"   role="link" title="Cortex XSOAR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR">Cortex XSOAR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse"   role="link" title="Cortex Xpanse" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse">Cortex Xpanse</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam"   role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM">Cortex XSIAM</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse/attack-surface-management"   role="link" title="External Attack Surface Protection" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection">External Attack Surface Protection</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/security-operations-automation"   role="link" title="Security Automation" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation">Security Automation</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/detection-and-response"   role="link" title="Threat Prevention, Detection &amp; Response" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation:Threat Prevention, Detection &amp; Response">Threat Prevention, Detection &amp; Response</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/unit42"   role="link" title="Threat Intel and Incident Response Services" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services">Threat Intel and Incident Response Services</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/assess"   role="link" title="Proactive Assessments" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments">Proactive Assessments</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/respond"   role="link" title="Incident Response" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response">Incident Response</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/transform"   role="link" title="Transform Your Security Strategy" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy">Transform Your Security Strategy</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/threat-intelligence-partners"   role="link" title="Discover Threat Intelligence" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy:Discover Threat Intelligence">Discover Threat Intelligence</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Company</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us"   role="link" title="About Us" data-page-track="true" data-page-track-value="footer:Company:About Us">About Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://jobs.paloaltonetworks.com/en/"   role="link" title="Careers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers">Careers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/contact-sales"   role="link" title="Contact Us" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us">Contact Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/corporate-responsibility"   role="link" title="Corporate Responsibility" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility">Corporate Responsibility</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/customers"   role="link" title="Customers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers">Customers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://investors.paloaltonetworks.com/" target=_blank  role="link" title="Investor Relations" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations">Investor Relations</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/locations"   role="link" title="Location" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location">Location</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/newsroom"   role="link" title="Newsroom" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location:Newsroom">Newsroom</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Popular links</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/blog/"   role="link" title="Blog" data-page-track="true" data-page-track-value="footer:Popular links:Blog">Blog</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/communities"   role="link" title="Communities" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities">Communities</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/resources"   role="link" title="Content Library" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library">Content Library</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cyberpedia"   role="link" title="Cyberpedia" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia">Cyberpedia</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://events.paloaltonetworks.com/"   role="link" title="Event Center" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center">Event Center</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://start.paloaltonetworks.com/preference-center"   role="link" title="Manage Email Preferences" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences">Manage Email Preferences</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/products/products-a-z"   role="link" title="Products A-Z" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z">Products A-Z</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/legal-notices/trust-center/tech-certs"   role="link" title="Product Certifications" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications">Product Certifications</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/security-disclosure"   role="link" title="Report a Vulnerability" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability">Report a Vulnerability</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sitemap"   role="link" title="Sitemap" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap">Sitemap</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://docs.paloaltonetworks.com/"   role="link" title="Tech Docs" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs">Tech Docs</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://unit42.paloaltonetworks.com/"   role="link" title="Unit 42" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42">Unit 42</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://panwedd.exterro.net/portal/dsar.htm?target=panwedd" target=_blank  role="link" title="Do Not Sell or Share My Personal Information" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42:Do Not Sell or Share My Personal Information">Do Not Sell or Share My Personal Information</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer-bottom"> 
    <div class="l-container"> 
              <div class="footer-logo">
          <a href="https://www.paloaltonetworks.com/" role="link" title="Footer Nav" data-page-track="true" data-page-track-value="footer:logo:Palo Alto Networks">
            <img width="245" height="46" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/palo-alto-footer-logo.svg" class="attachment-medium size-medium" alt="" decoding="async" loading="lazy" />          </a>
        </div>
            <div class="footer-bottom__wrapper"> 
        <div class="footer-bottom-nav">
                                              <nav>
                <ul class="footer-menu-nav__list"> 
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/privacy"   role="link" title="Privacy" data-page-track="true" data-page-track-value="footer:bottom-menu:Privacy">Privacy</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/trust-center"   role="link" title="Trust Center" data-page-track="true" data-page-track-value="footer:bottom-menu:Trust Center">Trust Center</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use"   role="link" title="Terms of Use" data-page-track="true" data-page-track-value="footer:bottom-menu:Terms of Use">Terms of Use</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal"   role="link" title="Documents" data-page-track="true" data-page-track-value="footer:bottom-menu:Documents">Documents</a>
                  </li>    
                        
                </ul>
              </nav>
                                            <br/><span class="copyright">Copyright © 2024 Palo Alto Networks. All Rights Reserved</span>
                  </div>
        <div class="footer-bottom-social"> 
          <ul> 
			<li>
			<a href="https://www.youtube.com/user/paloaltonetworks" target="_blank" role="link" title="YouTube" data-page-track="true" data-page-track-value="footer:social:Youtube">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/youtube-black.svg" alt="YouTube">
			</a>
		</li>
				<li> 
			<a href="https://twitter.com/Unit42_Intel" target="_blank" role="link" title="X" data-page-track="true" data-page-track-value="footer:social::Twitter">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/x-icon-black.svg" alt="Twitter">
			</a>
		</li>
				<li> 
			<a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank" role="link" title="Facebook" data-page-track="true" data-page-track-value="footer:social:Facebook">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/Facebook_Icon.svg" alt="Facebook">
			</a>
		</li>
				<li> 
			<a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank" role="link" title="LinkedIn" data-page-track="true" data-page-track-value="footer:social:LinkedIn">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/LinkedIn_Icon.svg" alt="LinkedIn">
			</a>
		</li>
	                <li> 
			<a href="https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/" role="link" title="Podcast" data-page-track="true" data-page-track-value="footer:social:Podcast">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/Podcast.svg" alt="Podcast">
			</a>
		</li>
</ul>          
	<div class="pa language-dropdown">
			<div class="language-dropdown__wrapper"> 
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/globe-icon.svg" alt="Globe icon">
			<span id="selectedLanguage">EN</span>
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"><ul><li class="title">Select your language</li>
					<li class="selected" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:en" href="https://unit42.paloaltonetworks.com/global-protect-vpn-spoof-distributes-wikiloader/">USA (ENGLISH)</a>
					</li></ul>        </div>
      </div>
    </div>
  </div>
</footer>
<div class="dd-overlay">
</div>
<!--  Start: video modal -->
<div class="modal video__modal" id="videoModal" tabindex="-1">
        <div class="modal__video-wrapper">
          <button class="modal__play-btn is-minimized is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
          <button class="modal__minimize-btn is-minimized">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
          </button>
          <button class="modal__close"> 
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button">
          </button>
          <video class="modal__video" id="customVideo">
            <source src="" type="video/mp4">Your browser does not support the video tag.
          </video>
          <div class="modal__post-details" tabindex="-1">       
              <h3>Default Heading</h3>
              <a class="l-btn" href="#" title="Right Arrow Icon" role="link" data-page-track="true" data-page-track-value="overview:explore reports:View all reports">Read the article
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow">
              </a>
          </div>
          <div class="modal__video-controls">
            <div class="modal__video-seekbar input__wrapper"><span></span>
              <label class="is-hidden" for="modalSeekBar">Seekbar</label>
              <input class="custom-range" id="modalSeekBar" type="range" min="0" max="100" value="1">
              <p class="modal__remaining-time"></p>
            </div>
            <button class="modal__play-btn is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
            <div class="modal__volume-controls">
              <div class="modal__volume__wrapper">
                <button tabindex="0">
                  <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-volume.svg" alt="Volume">
                </button>
                <div class="modal__volume-seekbar"><span></span>
                  <label class="is-hidden" for="volumeBar">Volume</label>
                  <input class="volume__bar" id="volumeBar" type="range" min="0" max="1" step="0.1" value="0.7">
                </div>
              </div>
              <button class="modal__minimize-btn" id="minimizeBtn">
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
              </button>
            </div>
          </div>
        </div>
      </div><!--  End: video modal -->

    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		var like_nonce = jQuery('#_wpnonce').val();
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type+"&ul_nonce="+like_nonce,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=6.6.1' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/js/script.js?ver=1.0.0" id="unit42-v6-navigation-js"></script>

<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
observer_lozad.observe();

window.PAN_Clean_Util = {
        isIE: false
};

(function () {
   // INP Util Fix
    function yieldToMain(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
   window.PAN_Clean_Util.yieldToMain = yieldToMain
})();

if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
  var Coveo_organizationId = "paloaltonetworksintranet";        
  var techDocsPagePath = "https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25";
  var languageFromPath="en_US";
  window.Granite = window.Granite || {};
  Granite.I18n = (function() {
  var self = {};
  self.setLocale = function(locale) { };
  self.get = function(text, snippets, note) {
    var out = "";
    if(text){
      if(text ==="coveo.clear"){
        out = "Clear";
      }else if(text ==="coveo.noresultsfound"){
        out = "No results found for this search term.";
      }
    }
    return out;
  };
  return self
  }());
}

  var main_site_critical_top = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.js';
  var main_site_defered = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/defered.min.js';
  var main_site_criticalTopBase = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopBase.min.js';
  var main_site_criticalTopProductNav = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.js';
window.PAN_MainNavAsyncUrl = maindomain_lang+"/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html";

function loadScript(url, defer){
    var script1 = document.createElement('script');
    script1.setAttribute('type', 'text/javascript');
    script1.setAttribute('src',url);
    if(defer == true){
        script1.setAttribute('defer','defer');
    }
    document.head.appendChild(script1);
}
function loadScript1(url, callback){

    var script = document.createElement("script")
    script.type = "text/javascript";
    if (script.readyState){  //IE
        script.onreadystatechange = function(){
            if (script.readyState == "loaded" || script.readyState == "complete"){
                script.onreadystatechange = null;
                callback();
            }
        };
    } else {  //Others
        script.onload = function(){
            callback();
        };
    }
    script.src = url;
    document.getElementsByTagName("head")[0].appendChild(script);
}
if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
	if(referer == "Unit"){
    setTimeout(function(){
      loadScript(main_site_criticalTopBase, false);
      loadScript1(main_site_criticalTopProductNav, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
	else{
    setTimeout(function(){
      loadScript1(main_site_critical_top, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
}

$(document).ready(function () {
    setTimeout(function(){
      $('.article-banner .ab__options ul li a').each(function(){
          	$(this).attr('target', "_blank");
      });
    }, 4000);
});
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->

</body>
</html>
