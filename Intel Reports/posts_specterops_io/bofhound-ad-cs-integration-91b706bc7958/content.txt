<!doctype html><html lang="en"><head><title data-rh="true">BOFHound: AD CS Integration. TL;DR: BOFHound can now parse Active… | by Matt Creel | Oct, 2024 | Posts By SpecterOps Team Members</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2024-10-30T14:51:15.474Z"/><meta data-rh="true" name="title" content="BOFHound: AD CS Integration. TL;DR: BOFHound can now parse Active… | by Matt Creel | Oct, 2024 | Posts By SpecterOps Team Members"/><meta data-rh="true" property="og:title" content="BOFHound: AD CS Integration"/><meta data-rh="true" property="al:android:url" content="medium://p/91b706bc7958"/><meta data-rh="true" property="al:ios:url" content="medium://p/91b706bc7958"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="My last BOFHound-related post covered the support and usage strategies for Beacon object files (BOFs) enabling the manual collection of data required for BloodHound’s AdminTo and HasSession edges…"/><meta data-rh="true" property="og:description" content="TL;DR: BOFHound can now parse Active Directory Certificate Services (AD CS) objects, manually queried from LDAP, for review and attack path…"/><meta data-rh="true" property="og:url" content="https://posts.specterops.io/bofhound-ad-cs-integration-91b706bc7958"/><meta data-rh="true" property="al:web:url" content="https://posts.specterops.io/bofhound-ad-cs-integration-91b706bc7958"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/da:true/resize:fit:1200/0*dDQKQkvp-Ib2iukJ"/><meta data-rh="true" property="article:author" content="https://medium.com/@Tw1sm"/><meta data-rh="true" name="author" content="Matt Creel"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="BOFHound: AD CS Integration"/><meta data-rh="true" name="twitter:site" content="@specterops"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/91b706bc7958"/><meta data-rh="true" property="twitter:description" content="TL;DR: BOFHound can now parse Active Directory Certificate Services (AD CS) objects, manually queried from LDAP, for review and attack path…"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/da:true/resize:fit:1200/0*dDQKQkvp-Ib2iukJ"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="11 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/resize:fill:256:256/1*D-FDlfkqivRBQZoESrwtqw.png"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@Tw1sm"/><link data-rh="true" rel="canonical" href="https://posts.specterops.io/bofhound-ad-cs-integration-91b706bc7958"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/91b706bc7958"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fda:true\u002Fresize:fit:1200\u002F0*dDQKQkvp-Ib2iukJ"],"url":"https:\u002F\u002Fposts.specterops.io\u002Fbofhound-ad-cs-integration-91b706bc7958","dateCreated":"2024-10-30T14:16:12.678Z","datePublished":"2024-10-30T14:16:12.678Z","dateModified":"2024-11-14T07:23:07.330Z","headline":"BOFHound: AD CS Integration - Posts By SpecterOps Team Members","name":"BOFHound: AD CS Integration - Posts By SpecterOps Team Members","description":"My last BOFHound-related post covered the support and usage strategies for Beacon object files (BOFs) enabling the manual collection of data required for BloodHound’s AdminTo and HasSession edges…","identifier":"91b706bc7958","author":{"@type":"Person","name":"Matt Creel","url":"https:\u002F\u002Fposts.specterops.io\u002F@Tw1sm"},"creator":["Matt Creel"],"publisher":{"@type":"Organization","name":"Posts By SpecterOps Team Members","url":"posts.specterops.io","logo":{"@type":"ImageObject","width":149,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:298\u002F1*s-5BWBr8XsgtIU5azKNhZQ.jpeg"}},"mainEntityOfPage":"https:\u002F\u002Fposts.specterops.io\u002Fbofhound-ad-cs-integration-91b706bc7958"}</script><style type="text/css" data-fela-rehydration="550" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="550" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:rgba(128, 128, 183, 1)}.es{border-color:rgba(128, 128, 183, 1)}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:rgba(128, 128, 183, 1)}.ez:disabled:hover{border-color:rgba(128, 128, 183, 1)}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-left:-12px}.ii{width:28px}.ij{height:28px}.ik{z-index:1}.il{width:24px}.im{margin-bottom:2px}.in{flex-wrap:nowrap}.io{font-size:16px}.ip{line-height:24px}.ir{margin:0 8px}.is{display:inline}.it{color:rgba(128, 128, 183, 1)}.iu{fill:rgba(128, 128, 183, 1)}.ix{flex:0 0 auto}.ja{flex-wrap:wrap}.jd{white-space:pre-wrap}.je{margin-right:4px}.jf{overflow:hidden}.jg{max-height:20px}.jh{text-overflow:ellipsis}.ji{display:-webkit-box}.jj{-webkit-line-clamp:1}.jk{-webkit-box-orient:vertical}.jl{word-break:break-all}.jn{padding-left:8px}.jo{padding-right:8px}.kp> *{flex-shrink:0}.kq{overflow-x:scroll}.kr::-webkit-scrollbar{display:none}.ks{scrollbar-width:none}.kt{-ms-overflow-style:none}.ku{width:74px}.kv{flex-direction:row}.kw{z-index:2}.kz{-webkit-user-select:none}.la{border:0}.lb{fill:rgba(117, 117, 117, 1)}.le{outline:0}.lf{user-select:none}.lg> svg{pointer-events:none}.lp{cursor:progress}.lq{opacity:1}.lr{padding:4px 0}.lu{margin-top:0px}.lv{width:16px}.lx{display:inline-flex}.md{max-width:100%}.me{padding:8px 2px}.mf svg{color:#6B6B6B}.mw{box-shadow:inset 3px 0 0 0 #242424}.mx{padding-left:23px}.my{margin-left:-20px}.mz{line-height:1.58}.na{letter-spacing:-0.004em}.nb{font-style:italic}.nc{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nx{margin-bottom:-0.46em}.ny{text-decoration:underline}.nz{line-height:1.12}.oa{letter-spacing:-0.022em}.ob{font-weight:600}.ow{margin-bottom:-0.28em}.pc{line-height:1.18}.pq{margin-bottom:-0.31em}.pr{list-style-type:disc}.ps{margin-left:30px}.pt{padding-left:0px}.pz{margin-left:auto}.qa{margin-right:auto}.qb{max-width:1570px}.qh{clear:both}.qj{cursor:zoom-in}.qk{z-index:auto}.qm{height:auto}.qn{margin-top:10px}.qo{max-width:728px}.qr{max-width:845px}.qs{padding:2px 4px}.qt{font-size:75%}.qu> strong{font-family:inherit}.qv{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.rb{max-width:1600px}.rc{padding-top:5px}.rd{padding-bottom:5px}.re{max-width:1330px}.rf{overflow-x:auto}.rg{padding:32px}.rh{border:1px solid #E5E5E5}.ri{line-height:1.4}.rj{margin-top:-0.2em}.rk{margin-bottom:-0.2em}.rl{white-space:pre}.rm{min-width:fit-content}.rn{margin:auto}.ro{padding-bottom:100%}.rp{height:0}.rq{max-width:1370px}.rr{max-width:1518px}.rs{max-width:1550px}.rt{max-width:733px}.ru{max-width:1286px}.rv{max-width:825px}.rw{max-width:760px}.rx{border-top:none}.sd{height:52px}.se{max-height:52px}.sf{box-sizing:content-box}.sg{position:static}.si{max-width:155px}.so{margin-right:20px}.su{align-items:flex-end}.sv{width:76px}.sw{height:76px}.sx{border:2px solid #F9F9F9}.sy{height:72px}.sz{width:72px}.ta{margin-left:-16px}.tb{width:36px}.tc{height:36px}.td{padding:8px 16px}.te{stroke:#F2F2F2}.tf{color:#F2F2F2}.tg{fill:#F2F2F2}.th{background:#F2F2F2}.ti{border-color:#F2F2F2}.to{font-weight:500}.tp{font-size:24px}.tq{line-height:30px}.tr{letter-spacing:-0.016em}.ts{margin-top:8px}.tt{margin-top:16px}.tu{height:0px}.tv{border-bottom:solid 1px #E5E5E5}.ub{margin-top:72px}.uc{padding:24px 0}.ud{margin-bottom:0px}.ue{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:rgba(110, 110, 154, 1)}.eu:hover{border-color:rgba(110, 110, 154, 1)}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.iq:hover{text-decoration:underline}.iv:hover:not(:disabled){color:rgba(110, 110, 154, 1)}.iw:hover:not(:disabled){fill:rgba(110, 110, 154, 1)}.ld:hover{fill:rgba(8, 8, 8, 1)}.ls:hover{fill:#000000}.lt:hover p{color:#000000}.lw:hover{color:#000000}.mg:hover svg{color:#000000}.tj:hover{background:#F2F2F2}.tk:hover{border-color:#F2F2F2}.tl:hover{cursor:wait}.tm:hover{color:#F2F2F2}.tn:hover{fill:#F2F2F2}.bd:focus-within path{fill:#242424}.lc:focus{fill:rgba(8, 8, 8, 1)}.mh:focus svg{color:#000000}.ql:focus{transform:scale(1.01)}.lh:active{border-style:none}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.kb{border-top:solid 1px #F2F2F2}.kc{border-bottom:solid 1px #F2F2F2}.kd{margin:32px 0 0}.ke{padding:3px 8px}.kn> *{margin-right:24px}.ko> :last-child{margin-right:0}.lo{margin-top:0px}.mc{margin:0}.nt{font-size:20px}.nu{margin-top:2.14em}.nv{line-height:32px}.nw{letter-spacing:-0.003em}.os{font-size:24px}.ot{margin-top:1.95em}.ou{line-height:30px}.ov{letter-spacing:-0.016em}.pb{margin-top:0.94em}.pn{margin-top:1.72em}.po{line-height:24px}.pp{letter-spacing:0}.py{margin-top:1.14em}.qg{margin-top:56px}.ra{max-width:1192px}.sc{margin-bottom:88px}.sn{display:inline-block}.st{padding-top:72px}.ua{margin-top:40px}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ln{margin-top:0px}.qp{margin-left:auto}.qq{text-align:center}.sm{display:inline-block}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lm{margin-top:0px}.sl{display:inline-block}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lk{margin-top:0px}.ll{margin-right:0px}.sk{display:inline-block}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.iy{flex-direction:column}.jb{margin-bottom:2px}.jp{margin:24px -24px 0}.jq{padding:0}.kf> *{margin-right:8px}.kg> :last-child{margin-right:24px}.kx{margin-left:0px}.li{margin-top:0px}.lj{margin-right:0px}.ly{margin:0}.mi{border:1px solid #F2F2F2}.mj{border-radius:99em}.mk{padding:0px 16px 0px 12px}.ml{height:38px}.mm{align-items:center}.mo svg{margin-right:8px}.nd{font-size:18px}.ne{margin-top:1.56em}.nf{line-height:28px}.ng{letter-spacing:-0.003em}.oc{font-size:20px}.od{margin-top:1.2em}.oe{line-height:24px}.of{letter-spacing:0}.ox{margin-top:0.67em}.pd{font-size:16px}.pe{margin-top:1.23em}.pu{margin-top:1.34em}.qc{margin-top:40px}.qw{max-width:100%}.ry{margin-bottom:80px}.sj{display:inline-block}.sp{padding-top:48px}.tw{margin-top:32px}.mn:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jx{border-top:solid 1px #F2F2F2}.jy{border-bottom:solid 1px #F2F2F2}.jz{margin:32px 0 0}.ka{padding:3px 8px}.kl> *{margin-right:24px}.km> :last-child{margin-right:0}.mb{margin:0}.np{font-size:20px}.nq{margin-top:2.14em}.nr{line-height:32px}.ns{letter-spacing:-0.003em}.oo{font-size:24px}.op{margin-top:1.95em}.oq{line-height:30px}.or{letter-spacing:-0.016em}.pa{margin-top:0.94em}.pk{margin-top:1.72em}.pl{line-height:24px}.pm{letter-spacing:0}.px{margin-top:1.14em}.qf{margin-top:56px}.qz{max-width:1192px}.sb{margin-bottom:88px}.ss{padding-top:72px}.tz{margin-top:40px}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jt{border-top:solid 1px #F2F2F2}.ju{border-bottom:solid 1px #F2F2F2}.jv{margin:32px 0 0}.jw{padding:3px 8px}.kj> *{margin-right:24px}.kk> :last-child{margin-right:0}.ma{margin:0}.nl{font-size:20px}.nm{margin-top:2.14em}.nn{line-height:32px}.no{letter-spacing:-0.003em}.ok{font-size:24px}.ol{margin-top:1.95em}.om{line-height:30px}.on{letter-spacing:-0.016em}.oz{margin-top:0.94em}.ph{margin-top:1.72em}.pi{line-height:24px}.pj{letter-spacing:0}.pw{margin-top:1.14em}.qe{margin-top:56px}.qy{max-width:100%}.sa{margin-bottom:88px}.sr{padding-top:72px}.ty{margin-top:40px}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iz{flex-direction:column}.jc{margin-bottom:2px}.jr{margin:24px 0 0}.js{padding:0}.kh> *{margin-right:8px}.ki> :last-child{margin-right:8px}.ky{margin-left:0px}.lz{margin:0}.mp{border:1px solid #F2F2F2}.mq{border-radius:99em}.mr{padding:0px 16px 0px 12px}.ms{height:38px}.mt{align-items:center}.mv svg{margin-right:8px}.nh{font-size:18px}.ni{margin-top:1.56em}.nj{line-height:28px}.nk{letter-spacing:-0.003em}.og{font-size:20px}.oh{margin-top:1.2em}.oi{line-height:24px}.oj{letter-spacing:0}.oy{margin-top:0.67em}.pf{font-size:16px}.pg{margin-top:1.23em}.pv{margin-top:1.34em}.qd{margin-top:40px}.qx{max-width:100%}.rz{margin-bottom:80px}.sq{padding-top:48px}.tx{margin-top:32px}.mu:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="print">.sh{display:none}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jm{max-height:none}</style><style type="text/css" data-fela-rehydration="550" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.qi{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F91b706bc7958&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fbofhound-ad-cs-integration-91b706bc7958&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fbofhound-ad-cs-integration-91b706bc7958&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fbofhound-ad-cs-integration-91b706bc7958&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fbofhound-ad-cs-integration-91b706bc7958&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="4a78" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">BOFHound: AD CS Integration</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@Tw1sm?source=post_page---byline--91b706bc7958--------------------------------" rel="noopener follow"><div class="l ib ic by id ie"><div class="l fj"><img alt="Matt Creel" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/1*6EFikqGheJt57CGRXLXuVg.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div><div class="ih ab fj"><div><div class="bm" aria-hidden="false"><a href="https://posts.specterops.io/?source=post_page---byline--91b706bc7958--------------------------------" rel="noopener  ugc nofollow"><div class="l ii ij by id ik"><div class="l fj"><img alt="Posts By SpecterOps Team Members" class="l fd by br il cx" src="https://miro.medium.com/v2/resize:fill:48:48/1*D-FDlfkqivRBQZoESrwtqw.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="if by l br il fs n ig ft"></div></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="im ab q"><div class="ab q in"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b io ip bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" data-testid="authorName" href="https://medium.com/@Tw1sm?source=post_page---byline--91b706bc7958--------------------------------" rel="noopener follow">Matt Creel</a></p></div></div></div><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b io ip du"><span><a class="it iu ah ai aj ak al am an ao ap aq ar ex iv iw" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F16791c25ae8&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fbofhound-ad-cs-integration-91b706bc7958&amp;user=Matt+Creel&amp;userId=16791c25ae8&amp;source=post_page-16791c25ae8--byline--91b706bc7958---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l ix"><span class="bf b bg z du"><div class="ab cn iy iz ja"><div class="jb jc ab"><div class="bf b bg z du ab jd"><span class="je l ix">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" data-testid="publicationName" href="https://posts.specterops.io/?source=post_page---byline--91b706bc7958--------------------------------" rel="noopener  ugc nofollow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">Posts By SpecterOps Team Members</p></a></div></div></div><div class="h k"><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span></div></div><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">11 min read</span><div class="jn jo l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Oct 30, 2024</span></div></span></div></span></div></div></div><div class="ab cp jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke"><div class="h k w fg fh q"><div class="ku l"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2F91b706bc7958&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fbofhound-ad-cs-integration-91b706bc7958&amp;user=Matt+Creel&amp;userId=16791c25ae8&amp;source=---header_actions--91b706bc7958---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q kf kg kh ki kj kk kl km kn ko kp kq kr ks kt"><div class="lv k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F91b706bc7958&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fbofhound-ad-cs-integration-91b706bc7958&amp;source=---header_actions--91b706bc7958---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lx cn"><div class="l ae"><div class="ab cb"><div class="ly lz ma mb mc md ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><blockquote class="mw mx my"><p id="b71a" class="mz na nb nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">TL;DR: <a class="af ny" href="https://github.com/coffeegist/bofhound" rel="noopener ugc nofollow" target="_blank">BOFHound</a> can now parse Active Directory Certificate Services (AD CS) objects, manually queried from LDAP, for review and attack path mapping within BloodHound Community Edition (BHCE).</p></blockquote><h1 id="85e6" class="nz oa gu bf ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow bk">Background</h1><p id="712d" class="pw-post-body-paragraph mz na gu nc b nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt pb nv nw nx gn bk">My <a class="af ny" rel="noopener ugc nofollow" target="_blank" href="/bofhound-session-integration-7b88b6f18423">last</a> BOFHound-related post covered the support and usage strategies for Beacon object files (BOFs) enabling the manual collection of data required for BloodHound’s AdminTo and HasSession edges, among others. This brief post will cover the addition of AD CS object parsing (shoutout to GitHub user <a class="af ny" href="https://github.com/P-aLu" rel="noopener ugc nofollow" target="_blank">P-aLu</a> for collaborating on the update) and some queries to get you started.</p><p id="c2f4" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">But first, to clear up some misconceptions…</p><h2 id="5611" class="pc oa gu bf ob pd pe dy of pf pg ea oj nl ph pi pj np pk pl pm nt pn po pp pq bk">BOFHound is not a BOF!</h2><p id="e874" class="pw-post-body-paragraph mz na gu nc b nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt pb nv nw nx gn bk">Surprised and/or confused? Somewhat angry? Yes, this is the most common misconception I hear about the tool. BOFHound is not a BOF implementation of SharpHound; rather, it is a <em class="nb">Python script </em>that runs completely offline from your target network. I repeat — it is neither a BOF, nor a tool that actively enumerates a target Active Directory (AD) network. If this is not news to you, enlightened reader, consider skipping ahead to <a class="af ny" href="#cea8" rel="noopener ugc nofollow"><em class="nb">The Good Stuff</em></a>.</p><h2 id="e495" class="pc oa gu bf ob pd pe dy of pf pg ea oj nl ph pi pj np pk pl pm nt pn po pp pq bk">So What Does BOFHound Do (and Why on Earth Did You Name It That)?</h2><p id="a8cd" class="pw-post-body-paragraph mz na gu nc b nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt pb nv nw nx gn bk">BOFHound was born from repeated red team engagements in a large AD network where the blue team would flag SharpHound and other “loud” methods of LDAP enumeration. (In this environment, “loud” meant an <a class="af ny" href="https://github.com/SpecterOps/presentations/blob/main/SO-CON%202024/Matt%20Creel%20%26%20Adam%20Brown%20-%20Manually%20Enumerating%20AD%20Attack%20Paths%20with%20BOFHound/Matt%20Creel%20and%20Adam%20Brown%20-%20Manually%20Enumerating%20AD%20Attack%20Paths%20With%20BOFHound%20-%20SO-CON%202024.pdf" rel="noopener ugc nofollow" target="_blank">expensive LDAP query</a> — a query that returned a number of results over a threshold the client had determined to be indicative of attacker reconnaissance.) The team I worked with at the time adjusted by primarily relying on the ldapsearch BOF, part of TrustedSec’s <a class="af ny" href="https://github.com/trustedsec/CS-Situational-Awareness-BOF" rel="noopener ugc nofollow" target="_blank">situational awareness</a> collection, for LDAP reconnaissance. This had two main benefits:</p><ul class=""><li id="d758" class="mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx pr ps pt bk">It grants the operator full control over the LDAP query filter, meaning discretion can be used to avoid static query strings tied to common offensive tools and leveraged in detections [<a class="af ny" href="https://techcommunity.microsoft.com/t5/microsoft-defender-for-endpoint/hunting-for-reconnaissance-activities-using-ldap-search-filters/ba-p/824726" rel="noopener ugc nofollow" target="_blank">1</a>, <a class="af ny" href="https://falconforce.nl/falconfriday-detecting-active-directory-data-collection-0xff21/" rel="noopener ugc nofollow" target="_blank">2</a>]</li><li id="002e" class="mz na gu nc b nd pu nf ng nh pv nj nk nl pw nn no np px nr ns nt py nv nw nx pr ps pt bk">The operator can specify a limit on the result count, so that the query returns no more than N entries; this is helpful when consciously avoiding expensive queries (result pools can also be narrowed with search scope, targeted query filters, or through a search base)</li></ul><p id="4b78" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">Here are some downsides to solely relying on this approach for LDAP enumeration:</p><ul class=""><li id="fdf6" class="mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx pr ps pt bk">Queries only return text-based results (i.e., there is no visualization or BloodHound-like graph that many operators prefer)</li><li id="5e14" class="mz na gu nc b nd pu nf ng nh pv nj nk nl pw nn no np px nr ns nt py nv nw nx pr ps pt bk">Identifying ACL abuses is essentially impossible with this approach alone</li><li id="834e" class="mz na gu nc b nd pu nf ng nh pv nj nk nl pw nn no np px nr ns nt py nv nw nx pr ps pt bk">Trying to keep track of and organize relationships between objects, like group memberships (let alone nested memberships), by hand in text/Excel files is difficult</li></ul><p id="e9df" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">The bigger the target environment is, the more these problems are amplified. These also all sound like problems that BloodHound was originally created to solve. Is there any way we could maintain the granular control the ldapsearch BOF offers us over enumeration and still be able to use BloodHound?</p><p id="533a" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">Enter BOFHound. It aims to serve this very niche need by reading LDAP objects from your ldapsearch results in C2 logs, processing them, and producing BloodHound JSON files.</p><blockquote class="mw mx my"><p id="21e1" class="mz na nb nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">Thus the name BOFHound — read output from the ldapsearch BOF in log files and make it BloodHound-usable. LogHound just doesn’t have the same ring to it, does it?</p></blockquote><p id="e0ab" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">This allows for ACL relationships to be parsed (from base64 encoded nTSecurityDescriptor attributes) and for your operators to continue visualizing nodes and relationships in the BloodHound UI where they are happy.</p><p id="170e" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">Now you might be wondering “BloodHound collects <em class="nb">all</em> data [that we frequently care for] in an AD environment, so how can this work with partial data obtained from manual queries?” Well, it’s simple; the BloodHound UI will only show you what you have enumerated via manual queries and parsed with BOFHound. In other words, it will be incomplete data and, if you’re using this approach, you’re likely fine with that. We can target specific information we want to populate the graph with, such as objects related to our objectives, objects that have privileges we want to compromise, or objects that often make easy targets (i.e., <a class="af ny" rel="noopener ugc nofollow" target="_blank" href="/certified-pre-owned-d95910965cd2">AD CS</a>, <a class="af ny" href="https://github.com/subat0mik/Misconfiguration-Manager" rel="noopener ugc nofollow" target="_blank">SCCM</a>).</p><p id="daa1" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">But BloodHound will actually show you <em class="nb">a little more</em> than only what you’ve queried. Object ACLs return references (SIDs) to other objects in the environment that are granted some permission over the object you queried. When you parse these ACLs without an object tied to the SID, they are represented in the graph by nodes with SIDs for names or question mark icons. For example, if I query <strong class="nc gv">only</strong> the domain object, run it through BOFHound, upload the result to BloodHound, and check the <em class="nb">Inbound Object Control</em> on the domain object, we’ll see this.</p><figure class="qc qd qe qf qg qh pz qa paragraph-image"><div role="button" tabindex="0" class="qi qj fj qk bh ql"><div class="pz qa qb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*dDQKQkvp-Ib2iukJ 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*dDQKQkvp-Ib2iukJ 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*dDQKQkvp-Ib2iukJ 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*dDQKQkvp-Ib2iukJ 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*dDQKQkvp-Ib2iukJ 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*dDQKQkvp-Ib2iukJ 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dDQKQkvp-Ib2iukJ 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*dDQKQkvp-Ib2iukJ 640w, https://miro.medium.com/v2/resize:fit:720/0*dDQKQkvp-Ib2iukJ 720w, https://miro.medium.com/v2/resize:fit:750/0*dDQKQkvp-Ib2iukJ 750w, https://miro.medium.com/v2/resize:fit:786/0*dDQKQkvp-Ib2iukJ 786w, https://miro.medium.com/v2/resize:fit:828/0*dDQKQkvp-Ib2iukJ 828w, https://miro.medium.com/v2/resize:fit:1100/0*dDQKQkvp-Ib2iukJ 1100w, https://miro.medium.com/v2/resize:fit:1400/0*dDQKQkvp-Ib2iukJ 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md qm c" width="700" height="437" loading="lazy" role="presentation"/></picture></div></div><figcaption class="qn ff qo pz qa qp qq bf b bg z du">Parsing Single Object Reveals the Presence of Many More</figcaption></figure><p id="246f" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">I’ve only queried the domain object, but I also now know that these six other objects exist. Knowing their SIDs provides a means to query those objects that might be of interest. As I query them and rerun BOFHound, we can slowly fill in that picture and expand it, essentially providing a way to identify objects of interest, and work backwards from them.</p><h2 id="3bc2" class="pc oa gu bf ob pd pe dy of pf pg ea oj nl ph pi pj np pk pl pm nt pn po pp pq bk">The Fog of War</h2><p id="a3fe" class="pw-post-body-paragraph mz na gu nc b nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt pb nv nw nx gn bk">A while back, I was talking with <a class="af ny" href="https://x.com/jaredcatkinson" rel="noopener ugc nofollow" target="_blank">Jared Atkinson</a> about BOFHound and these very misconceptions when he made a very apt analogy: clearing the fog of war. In games like <em class="nb">Civilization </em>or <em class="nb">Age of Empires</em>, you start surrounded by the “fog of war,” representing the world you know exists, but otherwise know nothing about. As you scout around, you reveal more of the map, pushing back the fog of war, and gaining more information about the game’s world.</p><p id="316f" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">An unsophisticated player may just send their scouts out to chart the entire map as fast as possible. This could end up being advantageous, but it could also backfire by increasing the probability of encounters the player is unprepared for (i.e., a hostile faction). A sophisticated player may choose to scout areas as it’s advantageous to them, or when they’re prepared to deal with potentially hostile discoveries.</p><figure class="qc qd qe qf qg qh pz qa paragraph-image"><div role="button" tabindex="0" class="qi qj fj qk bh ql"><div class="pz qa qr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*SZFZzd5Um6H4IgS1632jbg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*SZFZzd5Um6H4IgS1632jbg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*SZFZzd5Um6H4IgS1632jbg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*SZFZzd5Um6H4IgS1632jbg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*SZFZzd5Um6H4IgS1632jbg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*SZFZzd5Um6H4IgS1632jbg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SZFZzd5Um6H4IgS1632jbg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*SZFZzd5Um6H4IgS1632jbg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*SZFZzd5Um6H4IgS1632jbg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*SZFZzd5Um6H4IgS1632jbg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*SZFZzd5Um6H4IgS1632jbg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*SZFZzd5Um6H4IgS1632jbg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*SZFZzd5Um6H4IgS1632jbg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*SZFZzd5Um6H4IgS1632jbg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md qm c" width="700" height="419" loading="lazy" role="presentation"/></picture></div></div><figcaption class="qn ff qo pz qa qp qq bf b bg z du">Brb, Building a Scout</figcaption></figure><p id="6cea" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">As a prospective BOFHound user, the fog of war is the great unknown AD environment: objects, relationships, attack paths, etc. Immediately trying to chart the entire map is like trying query every AD object at once (i.e., <code class="cx qs qt qu qv b">(objectClass=*)</code>, running SharpHound); very beneficial data to have if successful, but you’re at high risk of revealing your presence to the hostile blue team. BOFHound is supposed to aid you in taking the careful, “sophisticated player” approach. Each time you manually run a batch of LDAP queries and parse/process with BOFHound, you clear a bit more of the fog and incrementally learn more about the environment you’re in. It is an iterative process (query → parse → query, etc.) until you feel you have sufficient information to take additional action or move on.</p><p id="9231" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">I think it goes without saying, but this approach is quite niche. If you do not care about being detected performing LDAP reconnaissance or know/think an alert will not fire for something like running SharpHound or ADExplorer, then you <em class="nb">should</em> run them. Having a more complete dataset will always allow you to spend your time more efficiently. I use this methodology described with BOFHound a handful of times a year, when I care about being stealthy; you really have no need for this in your playbook otherwise.</p><p id="232d" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">I hope this detour helped clear up some of the self-inflicted misconceptions around BOFHound’s purpose, intended usage, and name. This took up way more space than I initially intended (and became a bit rant-y), but now we can get into the AD CS updates.</p><h1 id="cea8" class="nz oa gu bf ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow bk">The Good Stuff</h1><p id="b7a1" class="pw-post-body-paragraph mz na gu nc b nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt pb nv nw nx gn bk">In addition to the AD CS support, I recently added parsing support for <a class="af ny" href="https://github.com/HavocFramework/Havoc" rel="noopener ugc nofollow" target="_blank">Havoc</a> log files. The rest of this blog will use the ldapsearch BOF via Havoc to demo one method of AD CS enumeration. While you’re probably not rolling out Havoc on your red team assessments, I realized only supporting log parsing for commercial C2s might otherwise turn users away from testing BOFHound in a lab. Havoc ships with an outdated version (as of 10/22/2024) of the ldapsearch BOF (needs updated for AD CS querying), but that can be easily remedied by copying the <a class="af ny" href="https://github.com/trustedsec/CS-Situational-Awareness-BOF/tree/master/SA/ldapsearch" rel="noopener ugc nofollow" target="_blank">latest BOFs</a> over to <code class="cx qs qt qu qv b">havoc/client/Modules/SituationalAwareness/ObjectFiles/</code>and updating the <code class="cx qs qt qu qv b">ldapsearch_parse_params()</code> function within <code class="cx qs qt qu qv b">hacov/client/Moduels/SituationalAwareness/SituationalAwareness.py</code> to the definition in this <a class="af ny" href="https://gist.github.com/Tw1sm/15c0eac8fc0f4c794ab8081b63da6c84" rel="noopener ugc nofollow" target="_blank">gist</a>.</p><p id="e37b" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">On past assessments, I’ve typically leveraged one of the various <code class="cx qs qt qu qv b">adcs_enum</code> BOFs included in <a class="af ny" href="https://github.com/trustedsec/CS-Situational-Awareness-BOF" rel="noopener ugc nofollow" target="_blank">situational awareness</a> collection for AD CS enumeration and config analysis. These work great and I’ve used them to identify vulnerable templates and AD CS ESC paths during real-world engagements. Why bother switching enumeration playbooks? Manually analyzing a wall of certificate config text can work, but it can also be error prone, especially when it comes to trying to unroll group memberships for permissions like enrollment rights.</p></div></div><div class="qh"><div class="ab cb"><div class="ly qw lz qx ma qy cf qz cg ra ci bh"><figure class="qc qd qe qf qg qh rc rd paragraph-image"><div role="button" tabindex="0" class="qi qj fj qk bh ql"><div class="pz qa rb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*OlTG1vG8BDqHzbw0 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*OlTG1vG8BDqHzbw0 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*OlTG1vG8BDqHzbw0 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*OlTG1vG8BDqHzbw0 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*OlTG1vG8BDqHzbw0 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*OlTG1vG8BDqHzbw0 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/0*OlTG1vG8BDqHzbw0 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*OlTG1vG8BDqHzbw0 640w, https://miro.medium.com/v2/resize:fit:720/0*OlTG1vG8BDqHzbw0 720w, https://miro.medium.com/v2/resize:fit:750/0*OlTG1vG8BDqHzbw0 750w, https://miro.medium.com/v2/resize:fit:786/0*OlTG1vG8BDqHzbw0 786w, https://miro.medium.com/v2/resize:fit:828/0*OlTG1vG8BDqHzbw0 828w, https://miro.medium.com/v2/resize:fit:1100/0*OlTG1vG8BDqHzbw0 1100w, https://miro.medium.com/v2/resize:fit:2000/0*OlTG1vG8BDqHzbw0 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qm c" width="1000" height="557" loading="eager" role="presentation"/></picture></div></div><figcaption class="qn ff qo pz qa qp qq bf b bg z du">Trusty Old Text Wall of Certificate Configs</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="519a" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">While it’s still all too common to find paths like ESC1 with groups such as <em class="nb">Domain Users</em>, <em class="nb">Domain Computers</em>, and <em class="nb">Authenticated Users</em> jumping out when checking enrollment rights, unrolling nested rights (like the path below) isn’t always so straightforward when reviewing these config dumps.</p><figure class="qc qd qe qf qg qh pz qa paragraph-image"><div role="button" tabindex="0" class="qi qj fj qk bh ql"><div class="pz qa re"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*vYK50CrvIdZ1Uvt4 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*vYK50CrvIdZ1Uvt4 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*vYK50CrvIdZ1Uvt4 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*vYK50CrvIdZ1Uvt4 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*vYK50CrvIdZ1Uvt4 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*vYK50CrvIdZ1Uvt4 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vYK50CrvIdZ1Uvt4 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*vYK50CrvIdZ1Uvt4 640w, https://miro.medium.com/v2/resize:fit:720/0*vYK50CrvIdZ1Uvt4 720w, https://miro.medium.com/v2/resize:fit:750/0*vYK50CrvIdZ1Uvt4 750w, https://miro.medium.com/v2/resize:fit:786/0*vYK50CrvIdZ1Uvt4 786w, https://miro.medium.com/v2/resize:fit:828/0*vYK50CrvIdZ1Uvt4 828w, https://miro.medium.com/v2/resize:fit:1100/0*vYK50CrvIdZ1Uvt4 1100w, https://miro.medium.com/v2/resize:fit:1400/0*vYK50CrvIdZ1Uvt4 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md qm c" width="700" height="806" loading="eager" role="presentation"/></picture></div></div><figcaption class="qn ff qo pz qa qp qq bf b bg z du">ESC1 Path Through Nested Group Membership</figcaption></figure><p id="726c" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">The question the remainder of the blog tries to answer — <em class="nb">can we piece together this same picture without burning the red team by running SharpHound? </em>My coworker <a class="af ny" href="https://x.com/Jonas_B_K" rel="noopener ugc nofollow" target="_blank">Jonas Bülow Knudsen</a> released a very informative <a class="af ny" href="https://medium.com/specter-ops-posts/adcs-attack-paths-in-bloodhound-part-1-799f3d3b03cf" rel="noopener">blog</a> about AD CS attack paths in BloodHound when they were introduced and his blog details the types of LDAP objects relied upon for mapping AD CS relationships. In short, there are six “new” types of objects we care about:</p><ul class=""><li id="ca2b" class="mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx pr ps pt bk">Enterprise CAs</li><li id="0045" class="mz na gu nc b nd pu nf ng nh pv nj nk nl pw nn no np px nr ns nt py nv nw nx pr ps pt bk">AIACAs</li><li id="7529" class="mz na gu nc b nd pu nf ng nh pv nj nk nl pw nn no np px nr ns nt py nv nw nx pr ps pt bk">Root CAs</li><li id="dc2f" class="mz na gu nc b nd pu nf ng nh pv nj nk nl pw nn no np px nr ns nt py nv nw nx pr ps pt bk">NTAuth Stores</li><li id="32bd" class="mz na gu nc b nd pu nf ng nh pv nj nk nl pw nn no np px nr ns nt py nv nw nx pr ps pt bk">Certificate Templates</li><li id="a952" class="mz na gu nc b nd pu nf ng nh pv nj nk nl pw nn no np px nr ns nt py nv nw nx pr ps pt bk">Issuance Policies</li></ul><p id="66c9" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">If we query these objects (and the domain object), we can graph out the attack paths. There’s no “right” way to do this with ldapsearch, but a basic approach is a sequence of queries based on object class. All the target objects are nested in the <em class="nb">Configuration</em> naming context — technically we could query them all at once with <code class="cx qs qt qu qv b">(objectClass=*)</code>and a search base of <code class="cx qs qt qu qv b">CN=Cofiguration,DC=domain,DC=local</code>. However, if you’re interested in this manual approach in the first place, you may not be interested in that sort of wide-ranging query 😉.</p><p id="0ab7" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">Here’s a sample query transcript to get you started:</p><pre class="qc qd qe qf qg rf qv rg bp rh bb bk"><span id="608e" class="ri oa gu qv b bg rj rk l rl rm"># Query the domain object<br/>ldapsearch (objectclass=domain) *,ntsecuritydescriptor<br/><br/># Query Enterprise CAs<br/>ldapsearch (objectclass=pKIEnrollmentService) *,ntsecuritydescriptor 0 3 &quot;&quot; &quot;CN=Configuration,DC=domain,DC=local&quot;<br/><br/># Query AIACAs, Root CAs and NTAuth Stores<br/>ldapsearch (objectclass=certificationAuthority) *,ntsecuritydescriptor 0 3 &quot;&quot; &quot;CN=Configuration,DC=domain,DC=local&quot;<br/><br/># Query Certificate Templates<br/>ldapsearch (objectclass=pKICertificateTemplate) *,ntsecuritydescriptor 0 3 &quot;&quot; &quot;CN=Configuration,DC=domain,DC=local&quot;<br/><br/># Query Issuance Policies<br/>ldapsearch (objectclass=msPKI-Enterprise-Oid) *,ntsecuritydescriptor 0 3 &quot;&quot; &quot;CN=Configuration,DC=domain,DC=local&quot;</span></pre><p id="dd4f" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">If you’re new to the ldapsearch BOF (or even just its recent argument updates), here’s a quick breakdown of its positional arguments. Consider this query from the examples: <code class="cx qs qt qu qv b">ldapsearch (objectclass=pKIEnrollmentService) *,ntsecuritydescriptor 0 3 &quot;&quot; &quot;CN=Configuration,DC=essos,DC=local&quot;</code> — what does this mean?</p><figure class="qc qd qe qf qg qh"><div class="rn jf l fj"><div class="ro rp l"></div></div><figcaption class="qn ff qo pz qa qp qq bf b bg z du">Brief Breakdown of an ldapsearch Command</figcaption></figure><p id="e523" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">Here’s an example of one transcript query performed with the ldapsearch BOF via Havoc. I’m doing this enumeration across a domain trust in my lab (<a class="af ny" href="https://github.com/Orange-Cyberdefense/GOAD" rel="noopener ugc nofollow" target="_blank">GOAD</a>, from <code class="cx qs qt qu qv b">sevenkingdoms.local</code> to <code class="cx qs qt qu qv b">essos.local</code>), hence the explicit definition of domain controller to query and search base (even for objects in the default naming context).</p></div></div><div class="qh"><div class="ab cb"><div class="ly qw lz qx ma qy cf qz cg ra ci bh"><figure class="qc qd qe qf qg qh rc rd paragraph-image"><div role="button" tabindex="0" class="qi qj fj qk bh ql"><div class="pz qa rb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*48mMIhjqNR3s0Aal 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*48mMIhjqNR3s0Aal 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*48mMIhjqNR3s0Aal 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*48mMIhjqNR3s0Aal 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*48mMIhjqNR3s0Aal 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*48mMIhjqNR3s0Aal 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/0*48mMIhjqNR3s0Aal 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*48mMIhjqNR3s0Aal 640w, https://miro.medium.com/v2/resize:fit:720/0*48mMIhjqNR3s0Aal 720w, https://miro.medium.com/v2/resize:fit:750/0*48mMIhjqNR3s0Aal 750w, https://miro.medium.com/v2/resize:fit:786/0*48mMIhjqNR3s0Aal 786w, https://miro.medium.com/v2/resize:fit:828/0*48mMIhjqNR3s0Aal 828w, https://miro.medium.com/v2/resize:fit:1100/0*48mMIhjqNR3s0Aal 1100w, https://miro.medium.com/v2/resize:fit:2000/0*48mMIhjqNR3s0Aal 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qm c" width="1000" height="472" loading="eager" role="presentation"/></picture></div></div><figcaption class="qn ff qo pz qa qp qq bf b bg z du">Query for AIACAs, NTAuth Stores, and Root CAs</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="91b9" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">After running each of the queries in the sample transcript, we can parse that minimal dataset from the Havoc loot logs with BOFHound.</p><pre class="qc qd qe qf qg rf qv rg bp rh bb bk"><span id="aaf4" class="ri oa gu qv b bg rj rk l rl rm">bofhound -i /opt/havoc/data/loot --parser havoc --zip</span></pre><figure class="qc qd qe qf qg qh pz qa paragraph-image"><div role="button" tabindex="0" class="qi qj fj qk bh ql"><div class="pz qa rq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*tD6wbdMCOkG7gxY_ 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*tD6wbdMCOkG7gxY_ 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*tD6wbdMCOkG7gxY_ 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*tD6wbdMCOkG7gxY_ 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*tD6wbdMCOkG7gxY_ 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*tD6wbdMCOkG7gxY_ 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tD6wbdMCOkG7gxY_ 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*tD6wbdMCOkG7gxY_ 640w, https://miro.medium.com/v2/resize:fit:720/0*tD6wbdMCOkG7gxY_ 720w, https://miro.medium.com/v2/resize:fit:750/0*tD6wbdMCOkG7gxY_ 750w, https://miro.medium.com/v2/resize:fit:786/0*tD6wbdMCOkG7gxY_ 786w, https://miro.medium.com/v2/resize:fit:828/0*tD6wbdMCOkG7gxY_ 828w, https://miro.medium.com/v2/resize:fit:1100/0*tD6wbdMCOkG7gxY_ 1100w, https://miro.medium.com/v2/resize:fit:1400/0*tD6wbdMCOkG7gxY_ 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md qm c" width="700" height="539" loading="eager" role="presentation"/></picture></div></div><figcaption class="qn ff qo pz qa qp qq bf b bg z du">BOFHound Parsing the Log Data</figcaption></figure><p id="591a" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">After the data has been parsed, we can load up BHCE and upload the output archive.</p><pre class="qc qd qe qf qg rf qv rg bp rh bb bk"><span id="900d" class="ri oa gu qv b bg rj rk l rl rm">curl -L https://ghst.ly/getbhce &gt; docker-compose.yml<br/>sudo docker compose pull<br/>sudo docker compose up</span></pre><p id="6470" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">In the UI, we can use some of the prebuilt queries to help us find common misconfigurations and escalation paths. I’ll start with the prebuilt <em class="nb">Enrollment rights on ESC1 certificate templates </em>query, which will limit the templates I view to just those that meet ESC1 requirements.</p><figure class="qc qd qe qf qg qh pz qa paragraph-image"><div role="button" tabindex="0" class="qi qj fj qk bh ql"><div class="pz qa rr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*K-gurdvci5HEwPT5 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*K-gurdvci5HEwPT5 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*K-gurdvci5HEwPT5 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*K-gurdvci5HEwPT5 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*K-gurdvci5HEwPT5 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*K-gurdvci5HEwPT5 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*K-gurdvci5HEwPT5 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*K-gurdvci5HEwPT5 640w, https://miro.medium.com/v2/resize:fit:720/0*K-gurdvci5HEwPT5 720w, https://miro.medium.com/v2/resize:fit:750/0*K-gurdvci5HEwPT5 750w, https://miro.medium.com/v2/resize:fit:786/0*K-gurdvci5HEwPT5 786w, https://miro.medium.com/v2/resize:fit:828/0*K-gurdvci5HEwPT5 828w, https://miro.medium.com/v2/resize:fit:1100/0*K-gurdvci5HEwPT5 1100w, https://miro.medium.com/v2/resize:fit:1400/0*K-gurdvci5HEwPT5 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md qm c" width="700" height="602" loading="lazy" role="presentation"/></picture></div></div><figcaption class="qn ff qo pz qa qp qq bf b bg z du">Prebuilt AD CS Queries</figcaption></figure><p id="b29e" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">Here’s what those results look like with the objects we queried in the lab. We know the SIDs ending in 519 and 512 are <em class="nb">Enterprise Admins</em> and <em class="nb">Domain Admins</em>, but we’ve got an unknown object with a resource ID (RID) of “1602”.</p></div></div><div class="qh"><div class="ab cb"><div class="ly qw lz qx ma qy cf qz cg ra ci bh"><figure class="qc qd qe qf qg qh rc rd paragraph-image"><div role="button" tabindex="0" class="qi qj fj qk bh ql"><div class="pz qa rs"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Ibwa9CcEtzSMop0Y 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*Ibwa9CcEtzSMop0Y 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*Ibwa9CcEtzSMop0Y 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*Ibwa9CcEtzSMop0Y 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*Ibwa9CcEtzSMop0Y 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Ibwa9CcEtzSMop0Y 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/0*Ibwa9CcEtzSMop0Y 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*Ibwa9CcEtzSMop0Y 640w, https://miro.medium.com/v2/resize:fit:720/0*Ibwa9CcEtzSMop0Y 720w, https://miro.medium.com/v2/resize:fit:750/0*Ibwa9CcEtzSMop0Y 750w, https://miro.medium.com/v2/resize:fit:786/0*Ibwa9CcEtzSMop0Y 786w, https://miro.medium.com/v2/resize:fit:828/0*Ibwa9CcEtzSMop0Y 828w, https://miro.medium.com/v2/resize:fit:1100/0*Ibwa9CcEtzSMop0Y 1100w, https://miro.medium.com/v2/resize:fit:2000/0*Ibwa9CcEtzSMop0Y 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qm c" width="1000" height="182" loading="eager" role="presentation"/></picture></div></div><figcaption class="qn ff qo pz qa qp qq bf b bg z du">The “Fog of War” — Unknown Objects in the Graph</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="386d" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">If we issue an LDAP query for that mystery SID, we can determine that it’s a group (think back to the original attack path screenshot we’re working towards).</p><pre class="qc qd qe qf qg rf qv rg bp rh bb bk"><span id="4eb7" class="ri oa gu qv b bg rj rk l rl rm">ldapsearch (objectSid=S-1–5–21–2301939034–812057587–2058894929–1602) *,ntsecuritydescriptor</span></pre></div></div><div class="qh"><div class="ab cb"><div class="ly qw lz qx ma qy cf qz cg ra ci bh"><figure class="qc qd qe qf qg qh rc rd paragraph-image"><div role="button" tabindex="0" class="qi qj fj qk bh ql"><div class="pz qa rb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*ZOoCUa1ZNwcw1i1J 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*ZOoCUa1ZNwcw1i1J 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*ZOoCUa1ZNwcw1i1J 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*ZOoCUa1ZNwcw1i1J 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*ZOoCUa1ZNwcw1i1J 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*ZOoCUa1ZNwcw1i1J 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/0*ZOoCUa1ZNwcw1i1J 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*ZOoCUa1ZNwcw1i1J 640w, https://miro.medium.com/v2/resize:fit:720/0*ZOoCUa1ZNwcw1i1J 720w, https://miro.medium.com/v2/resize:fit:750/0*ZOoCUa1ZNwcw1i1J 750w, https://miro.medium.com/v2/resize:fit:786/0*ZOoCUa1ZNwcw1i1J 786w, https://miro.medium.com/v2/resize:fit:828/0*ZOoCUa1ZNwcw1i1J 828w, https://miro.medium.com/v2/resize:fit:1100/0*ZOoCUa1ZNwcw1i1J 1100w, https://miro.medium.com/v2/resize:fit:2000/0*ZOoCUa1ZNwcw1i1J 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qm c" width="1000" height="382" loading="eager" role="presentation"/></picture></div></div><figcaption class="qn ff qo pz qa qp qq bf b bg z du">Query the Unknown BloodHound Node</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="05bc" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">That returned properties for the group granted enrollment rights, including its distinguished name, which we can use to unroll the group members.</p><figure class="qc qd qe qf qg qh pz qa paragraph-image"><div role="button" tabindex="0" class="qi qj fj qk bh ql"><div class="pz qa rt"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*WZf5PJj2ckDPCxtp 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*WZf5PJj2ckDPCxtp 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*WZf5PJj2ckDPCxtp 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*WZf5PJj2ckDPCxtp 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*WZf5PJj2ckDPCxtp 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*WZf5PJj2ckDPCxtp 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WZf5PJj2ckDPCxtp 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*WZf5PJj2ckDPCxtp 640w, https://miro.medium.com/v2/resize:fit:720/0*WZf5PJj2ckDPCxtp 720w, https://miro.medium.com/v2/resize:fit:750/0*WZf5PJj2ckDPCxtp 750w, https://miro.medium.com/v2/resize:fit:786/0*WZf5PJj2ckDPCxtp 786w, https://miro.medium.com/v2/resize:fit:828/0*WZf5PJj2ckDPCxtp 828w, https://miro.medium.com/v2/resize:fit:1100/0*WZf5PJj2ckDPCxtp 1100w, https://miro.medium.com/v2/resize:fit:1400/0*WZf5PJj2ckDPCxtp 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md qm c" width="700" height="325" loading="eager" role="presentation"/></picture></div></div><figcaption class="qn ff qo pz qa qp qq bf b bg z du">Just One More Turn</figcaption></figure><p id="a08d" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">To unroll the group’s members (return first and Nth degree members) we can take the group’s distinguished name and issue an LDAP query using the <em class="nb">LDAP_MATCHING_RULE_TRANSITIVE_EVAL</em> <a class="af ny" href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/4e638665-f466-4597-93c4-12f2ebfabab5" rel="noopener ugc nofollow" target="_blank">matching rule</a>.</p><pre class="qc qd qe qf qg rf qv rg bp rh bb bk"><span id="433d" class="ri oa gu qv b bg rj rk l rl rm">ldapsearch (memberOf:1.2.840.113556.1.4.1941:=CN=Nested1,CN=Users,DC=essos,DC=local) *,ntsecuritydescriptor</span></pre></div></div><div class="qh"><div class="ab cb"><div class="ly qw lz qx ma qy cf qz cg ra ci bh"><figure class="qc qd qe qf qg qh rc rd paragraph-image"><div role="button" tabindex="0" class="qi qj fj qk bh ql"><div class="pz qa rb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*gIvsjYylJ_qHfL-s 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*gIvsjYylJ_qHfL-s 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*gIvsjYylJ_qHfL-s 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*gIvsjYylJ_qHfL-s 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*gIvsjYylJ_qHfL-s 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*gIvsjYylJ_qHfL-s 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/0*gIvsjYylJ_qHfL-s 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*gIvsjYylJ_qHfL-s 640w, https://miro.medium.com/v2/resize:fit:720/0*gIvsjYylJ_qHfL-s 720w, https://miro.medium.com/v2/resize:fit:750/0*gIvsjYylJ_qHfL-s 750w, https://miro.medium.com/v2/resize:fit:786/0*gIvsjYylJ_qHfL-s 786w, https://miro.medium.com/v2/resize:fit:828/0*gIvsjYylJ_qHfL-s 828w, https://miro.medium.com/v2/resize:fit:1100/0*gIvsjYylJ_qHfL-s 1100w, https://miro.medium.com/v2/resize:fit:2000/0*gIvsjYylJ_qHfL-s 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qm c" width="1000" height="458" loading="eager" role="presentation"/></picture></div></div><figcaption class="qn ff qo pz qa qp qq bf b bg z du">Unroll Group Membership</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="8bc9" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">That query returns two results in the lab, though only one can be seen in the screenshot. However, if you look closely at the user object returned, you’ll notice the <code class="cx qs qt qu qv b">memberOf</code> attribute doesn’t contain the <em class="nb">Nested1</em> group from our query filter (meaning the object must be a Nth degree member).</p><p id="5b32" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">Now we rerun BOFHound, same as we did before.</p><pre class="qc qd qe qf qg rf qv rg bp rh bb bk"><span id="298d" class="ri oa gu qv b bg rj rk l rl rm">bofhound -i /opt/havoc/data/loot --parser havoc --zip</span></pre><p id="172b" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">After we ingest the data again, rerunning the same ESC1 enrollment rights query shows the previously unknown SID with enrollment rights belonged to the <em class="nb">Nested1</em> group.</p></div></div><div class="qh"><div class="ab cb"><div class="ly qw lz qx ma qy cf qz cg ra ci bh"><figure class="qc qd qe qf qg qh rc rd paragraph-image"><div role="button" tabindex="0" class="qi qj fj qk bh ql"><div class="pz qa rb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*4tWnO5XpX0pgQFHO 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*4tWnO5XpX0pgQFHO 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*4tWnO5XpX0pgQFHO 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*4tWnO5XpX0pgQFHO 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*4tWnO5XpX0pgQFHO 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*4tWnO5XpX0pgQFHO 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/0*4tWnO5XpX0pgQFHO 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*4tWnO5XpX0pgQFHO 640w, https://miro.medium.com/v2/resize:fit:720/0*4tWnO5XpX0pgQFHO 720w, https://miro.medium.com/v2/resize:fit:750/0*4tWnO5XpX0pgQFHO 750w, https://miro.medium.com/v2/resize:fit:786/0*4tWnO5XpX0pgQFHO 786w, https://miro.medium.com/v2/resize:fit:828/0*4tWnO5XpX0pgQFHO 828w, https://miro.medium.com/v2/resize:fit:1100/0*4tWnO5XpX0pgQFHO 1100w, https://miro.medium.com/v2/resize:fit:2000/0*4tWnO5XpX0pgQFHO 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qm c" width="1000" height="232" loading="eager" role="presentation"/></picture></div></div><figcaption class="qn ff qo pz qa qp qq bf b bg z du">Slowly Clearing the Fog of War</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="f895" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">This prebuilt query doesn’t unroll the group members, though. If we click the <code class="cx qs qt qu qv b">ESC1@ESSOS.LOCAL</code> object to bring up the properties pane on the right side, we can click the <em class="nb">Inbound Object Control</em> section to unroll enrollment rights (and potentially other ACL-based abuses).</p></div></div><div class="qh"><div class="ab cb"><div class="ly qw lz qx ma qy cf qz cg ra ci bh"><figure class="qc qd qe qf qg qh rc rd paragraph-image"><div role="button" tabindex="0" class="qi qj fj qk bh ql"><div class="pz qa ru"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*7Y6aCqR9UqdmBe_x 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*7Y6aCqR9UqdmBe_x 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*7Y6aCqR9UqdmBe_x 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*7Y6aCqR9UqdmBe_x 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*7Y6aCqR9UqdmBe_x 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*7Y6aCqR9UqdmBe_x 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/0*7Y6aCqR9UqdmBe_x 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*7Y6aCqR9UqdmBe_x 640w, https://miro.medium.com/v2/resize:fit:720/0*7Y6aCqR9UqdmBe_x 720w, https://miro.medium.com/v2/resize:fit:750/0*7Y6aCqR9UqdmBe_x 750w, https://miro.medium.com/v2/resize:fit:786/0*7Y6aCqR9UqdmBe_x 786w, https://miro.medium.com/v2/resize:fit:828/0*7Y6aCqR9UqdmBe_x 828w, https://miro.medium.com/v2/resize:fit:1100/0*7Y6aCqR9UqdmBe_x 1100w, https://miro.medium.com/v2/resize:fit:2000/0*7Y6aCqR9UqdmBe_x 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md qm c" width="1000" height="316" loading="eager" role="presentation"/></picture></div></div><figcaption class="qn ff qo pz qa qp qq bf b bg z du">The Unrolled Enrollment Rights Leading to ESC1</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="e6bb" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">This reveals the path we initially examined, showing a way to perform ESC1 through nested enrollment rights. Should we return to BloodHound’s pathfinding tab and search for paths starting at <code class="cx qs qt qu qv b">MISSANDEI@ESSOS.LOCAL</code> and ending at <code class="cx qs qt qu qv b">ESSOS.LOCAL</code>, we now have all the data necessary to map the attack path shown at the beginning of this section (if you’re following along in GOAD, your pathfinding might surface a shorter <code class="cx qs qt qu qv b">ASCSESC3</code> path that you have to filter out).</p><figure class="qc qd qe qf qg qh pz qa paragraph-image"><div role="button" tabindex="0" class="qi qj fj qk bh ql"><div class="pz qa rv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*bmRtAVvKgDE2zIJo 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*bmRtAVvKgDE2zIJo 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*bmRtAVvKgDE2zIJo 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*bmRtAVvKgDE2zIJo 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*bmRtAVvKgDE2zIJo 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*bmRtAVvKgDE2zIJo 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bmRtAVvKgDE2zIJo 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*bmRtAVvKgDE2zIJo 640w, https://miro.medium.com/v2/resize:fit:720/0*bmRtAVvKgDE2zIJo 720w, https://miro.medium.com/v2/resize:fit:750/0*bmRtAVvKgDE2zIJo 750w, https://miro.medium.com/v2/resize:fit:786/0*bmRtAVvKgDE2zIJo 786w, https://miro.medium.com/v2/resize:fit:828/0*bmRtAVvKgDE2zIJo 828w, https://miro.medium.com/v2/resize:fit:1100/0*bmRtAVvKgDE2zIJo 1100w, https://miro.medium.com/v2/resize:fit:1400/0*bmRtAVvKgDE2zIJo 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md qm c" width="700" height="470" loading="eager" role="presentation"/></picture></div></div><figcaption class="qn ff qo pz qa qp qq bf b bg z du">Assessment Debrief</figcaption></figure><p id="84d9" class="pw-post-body-paragraph mz na gu nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gn bk">BloodHound currently supports edges for ESC1, ESC3, ESC4 and ESC13. You can quickly query any escalation path abusing one of them with:</p><pre class="qc qd qe qf qg rf qv rg bp rh bb bk"><span id="d46f" class="ri oa gu qv b bg rj rk l rl rm">MATCH p=()-[:ADCSESC1|ADCSESC3|ADCSESC4|ADCSESC13]-&gt;()<br/>RETURN p</span></pre><figure class="qc qd qe qf qg qh pz qa paragraph-image"><div role="button" tabindex="0" class="qi qj fj qk bh ql"><div class="pz qa rw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ontyPzOXwsYUeHkbX8QYUA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ontyPzOXwsYUeHkbX8QYUA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ontyPzOXwsYUeHkbX8QYUA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ontyPzOXwsYUeHkbX8QYUA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ontyPzOXwsYUeHkbX8QYUA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ontyPzOXwsYUeHkbX8QYUA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ontyPzOXwsYUeHkbX8QYUA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ontyPzOXwsYUeHkbX8QYUA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ontyPzOXwsYUeHkbX8QYUA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ontyPzOXwsYUeHkbX8QYUA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ontyPzOXwsYUeHkbX8QYUA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ontyPzOXwsYUeHkbX8QYUA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ontyPzOXwsYUeHkbX8QYUA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ontyPzOXwsYUeHkbX8QYUA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md qm c" width="700" height="752" loading="lazy" role="presentation"/></picture></div></div><figcaption class="qn ff qo pz qa qp qq bf b bg z du">ADCSESC1, ADCSESC3, ADCSESC4 Edges from GOAD “Misconfigurations”</figcaption></figure><h1 id="65f0" class="nz oa gu bf ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow bk">Is Anything Missing?</h1><p id="2f38" class="pw-post-body-paragraph mz na gu nc b nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt pb nv nw nx gn bk">The <code class="cx qs qt qu qv b">ManageCA</code> and <code class="cx qs qt qu qv b">ManageCertificates</code> edges from BloodHound are not currently implemented in BOFHound. These relationships require reading values from the registry on CAs, which would require some other “collector” and parser (something akin to how BOFHound supports <code class="cx qs qt qu qv b">AdminTo</code> and <code class="cx qs qt qu qv b">HasSession</code> edges). These relationships are not currently relied on for any ESC attacks that BHCE supports, but will be if or when BloodHound gains ESC7 support.</p><h1 id="0de8" class="nz oa gu bf ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow bk">Conclusion</h1><p id="d572" class="pw-post-body-paragraph mz na gu nc b nd ox nf ng nh oy nj nk nl oz nn no np pa nr ns nt pb nv nw nx gn bk">This post served to clear up some common misconceptions about BOFHound, introduce the ability to parse AD CS objects, and provide a starting point for querying relevant LDAP objects. I hope that the added support for Havoc makes it easier to follow along with this post in a lab and give BOFHound a try. If you encounter any bugs, please feel free to open an issue on <a class="af ny" href="https://github.com/coffeegist/bofhound/issues" rel="noopener ugc nofollow" target="_blank">GitHub</a> or shoot me a message in the BloodHoundGang Slack (<a class="af ny" href="https://bloodhoundhq.slack.com/team/U02T6NDRAM8" rel="noopener ugc nofollow" target="_blank">@Tw1sm</a>).</p></div></div></div></div></section></div></div></article></div><div class="l"></div><footer class="rx ry rz sa sb sc sd se sf ab q sg ik c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp sh"><div class="ab q kv"><div class="si l"><span class="l sj sk sl e d"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2F91b706bc7958&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fbofhound-ad-cs-integration-91b706bc7958&amp;user=Matt+Creel&amp;userId=16791c25ae8&amp;source=---footer_actions--91b706bc7958---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span><span class="l h g f sm sn"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2F91b706bc7958&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fbofhound-ad-cs-integration-91b706bc7958&amp;user=Matt+Creel&amp;userId=16791c25ae8&amp;source=---footer_actions--91b706bc7958---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="so l ix"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F91b706bc7958&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fbofhound-ad-cs-integration-91b706bc7958&amp;source=---footer_actions--91b706bc7958---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="so l ix"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="sp sq sr ss st l bx"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="cl ab su cp"><div class="ab ia"><a href="https://medium.com/@Tw1sm?source=post_page---post_author_info--91b706bc7958--------------------------------" rel="noopener follow"><div class="l sv sw by sx ie"><div class="l fj"><img alt="Matt Creel" class="l fd by sy sz cx" src="https://miro.medium.com/v2/resize:fill:144:144/1*6EFikqGheJt57CGRXLXuVg.png" width="72" height="72" loading="lazy"/><div class="if by l sy sz fs n ig ft"></div></div></div></a><div class="ta ab fj"><div><div class="bm" aria-hidden="false"><a href="https://posts.specterops.io/?source=post_page---post_author_info--91b706bc7958--------------------------------" rel="noopener follow"><div class="l tb tc by sx ik"><div class="l fj"><img alt="Posts By SpecterOps Team Members" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*D-FDlfkqivRBQZoESrwtqw.png" width="32" height="32" loading="lazy"/><div class="if by l bz ca fs n ig ft"></div></div></div></a></div></div></div></div><div class="j i d"><div class="ab"><span><a class="bf b bg z ep td eq er es et eu ev ew ex ey ez fa au fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F16791c25ae8&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fbofhound-ad-cs-integration-91b706bc7958&amp;user=Matt+Creel&amp;userId=16791c25ae8&amp;source=post_page-16791c25ae8--post_author_info--91b706bc7958---------------------follow_profile-----------" rel="noopener follow">Follow</a></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F55f456d7c203&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fbofhound-ad-cs-integration-91b706bc7958&amp;newsletterV3=16791c25ae8&amp;newsletterV3Id=55f456d7c203&amp;user=Matt+Creel&amp;userId=16791c25ae8&amp;source=---post_author_info--91b706bc7958---------------------subscribe_user-----------" rel="noopener follow"><button class="bf b bg z tf am tg th ti tj tk tl tm tn ew ex ey ez fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="te tc tb"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab cn cp"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" href="https://medium.com/@Tw1sm?source=post_page---post_author_info--91b706bc7958--------------------------------" rel="noopener follow"><h2 class="pw-author-name bf to tp tq tr bk"><span class="gn jo">Written by <!-- -->Matt Creel</span></h2></a></div><div class="ts ab"><div class="l ix"><span class="pw-follower-count bf b bg z bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" href="https://medium.com/@Tw1sm/followers?source=post_page---post_author_info--91b706bc7958--------------------------------" rel="noopener follow">22 Followers</a></span></div><div class="bf b bg z jf jg jh ab jj jk jl jm du jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><span class="l ix">Writer for </span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" href="https://posts.specterops.io/?source=post_page---post_author_info--91b706bc7958--------------------------------" rel="noopener follow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">Posts By SpecterOps Team Members</p></a></div></div></div></div><div class="tt l"><p class="bf b bg z bk"><span class="gn">Adversary Simulation Consultant</span></p></div></div><div class="h k"><div class="ab"><span><a class="bf b bg z ep td eq er es et eu ev ew ex ey ez fa au fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F16791c25ae8&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fbofhound-ad-cs-integration-91b706bc7958&amp;user=Matt+Creel&amp;userId=16791c25ae8&amp;source=post_page-16791c25ae8--post_author_info--91b706bc7958---------------------follow_profile-----------" rel="noopener follow">Follow</a></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F55f456d7c203&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fbofhound-ad-cs-integration-91b706bc7958&amp;newsletterV3=16791c25ae8&amp;newsletterV3Id=55f456d7c203&amp;user=Matt+Creel&amp;userId=16791c25ae8&amp;source=---post_author_info--91b706bc7958---------------------subscribe_user-----------" rel="noopener follow"><button class="bf b bg z tf am tg th ti tj tk tl tm tn ew ex ey ez fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="te tc tb"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="tu bh tv tw tx ty tz ua"></div></div></div><div class="h k j"><div class="tu bh tv ub"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="uc ab kv ja"><div class="ud ue l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----91b706bc7958--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="ud ue l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----91b706bc7958--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="ud ue l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----91b706bc7958--------------------------------" rel="noopener follow"><p class="bf b dv z du">About</p></a></div><div class="ud ue l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----91b706bc7958--------------------------------" rel="noopener follow"><p class="bf b dv z du">Careers</p></a></div><div class="ud ue l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----91b706bc7958--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="ud ue l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----91b706bc7958--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="ud ue l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----91b706bc7958--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="ud ue l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----91b706bc7958--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="ud ue l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----91b706bc7958--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="ud l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----91b706bc7958--------------------------------" rel="noopener follow"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241115-155738-3ffc2a7892"</script><script>window.__GRAPHQL_URI__ = "https://posts.specterops.io/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"This request is not using the cache middleware worker","group":"disabled","tags":["group-edgeCachePosts","post-91b706bc7958","user-16791c25ae8","collection-f05f8696e3cc"],"serverVariantState":"","middlewareEnabled":false,"cacheStatus":"DYNAMIC","shouldUseCache":false,"vary":[],"lohpSummerUpsellEnabled":false,"publicationHierarchyEnabledWeb":false,"postBottomResponsesEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"COLLECTION","id":"f05f8696e3cc","explicit":true},"viewerIsBot":false},"debug":{"requestId":"262b0bb9-0b89-4f7f-b114-86f87c9fdc8e","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-db5558e0498628beba1a68383020942a-2a4a7ad6e234c337-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fposts.specterops.io\u002Fbofhound-ad-cs-integration-91b706bc7958","host":"posts.specterops.io","hostname":"posts.specterops.io","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"?source=rss----f05f8696e3cc---4"},"config":{"nodeEnv":"production","version":"main-20241115-155738-3ffc2a7892","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241115-155738-3ffc2a7892","commit":"3ffc2a7892176395d293f7b91b213ac10b2c9963"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","variantFlags":[{"__typename":"VariantFlag","name":"enable_entities_to_follow_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members_username_selection","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_maim_the_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_avatar_upload","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_topic_portals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium2_kbfd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_widget","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_diversification_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_import","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_abandoned_cart_promotion_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_auto_follow_on_subscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"num_post_bottom_responses_to_show","valueType":{"__typename":"VariantFlagNumber","value":1}},{"__typename":"VariantFlag","name":"enable_lo_homepage","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_premium_tier_badge","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_billing_frequency_on_step2","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"reader_fair_distribution_non_qp","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"enable_ios_autorefresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_programming","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_dynamic_programming_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_iceland_forced_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_members_only_audio","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_switch_plan_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"onboarding_tags_from_top_views","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_bayesian_average_pub_search","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_explicit_signals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_archive_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recirc_model","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_eventstats_event_processing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pill_based_home_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_country_expansion","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"goliath_externalsearch_enable_comment_deindexation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recaptcha_enterprise","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_update_topic_portals_wtf","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"can_send_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_conversion_model_v2","valueType":{"__typename":"VariantFlagString","value":"group_2"}},{"__typename":"VariantFlag","name":"price_smoke_test_yearly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_braintree_apple_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_boost_nia_v01","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_newsletter_lo_flow_custom_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"enable_android_dynamic_aspirational_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_intrinsic_automatic_actions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_rating_prompt_stories_read_threshold","valueType":{"__typename":"VariantFlagNumber","value":2}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_manage_membership_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_create_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_premium_plan","valueType":{"__typename":"VariantFlagString","value":"4a442ace1476"}},{"__typename":"VariantFlag","name":"can_receive_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_pub_follower_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_explicit_signals_updated_post_previews","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_easy_resubscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_response_markup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_lists_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_syntax_highlight","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sprig","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"rex_generator_max_candidates","valueType":{"__typename":"VariantFlagNumber","value":1000}},{"__typename":"VariantFlag","name":"android_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_monthly_premium_plan","valueType":{"__typename":"VariantFlagString","value":"12a660186432"}},{"__typename":"VariantFlag","name":"enable_simplified_digest_v2_b","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_group_gifting","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_reading_history","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_c","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_first_story","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pre_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_trial_membership","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_stripe_customers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_home_post_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards_byline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"redefined_top_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_social_share_sheet","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_bg_post_post","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_legacy_feed_in_iceland","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_new_push_notification_endpoint","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_see_pronouns","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_aspiriational","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_monthly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_miro_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_creator_welcome_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound-source-serif-pro"}},{"__typename":"VariantFlag","name":"enable_conversion_ranker_v2","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_all_recs_surfaces","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"mobile_custom_app_icon","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_two_hour_refresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_continue_this_thread","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reengagement_notification_duration","valueType":{"__typename":"VariantFlagNumber","value":3}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"enable_braintree_client","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"textshots_userid","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_braintree_google_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recommended_publishers_query","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_aggregator_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_in_app_free_trial","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_verifications_service","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_automod","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_seamless_social_sharing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_partner_program_enrollment","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_configure_pronouns","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_update_explore_wtf","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"skip_fs_cache_user_vals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tag_recs","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ranker_v10","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"ios_iceland_nux","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_remove_twitter_onboarding_step","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_user_follows","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_verified_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_editor_new_publishing_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_image_sharer","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_validate_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_display_paywall_after_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_verified_book_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cache_less_following_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_deprecate_legacy_providers_v3","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_updated_pub_recs_ui","valueType":{"__typename":"VariantFlagBoolean","value":true}}],"viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"posts.specterops.io\"})":{"__ref":"Collection:f05f8696e3cc"},"postResult({\"id\":\"91b706bc7958\"})":{"__ref":"Post:91b706bc7958"}},"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png":{"__typename":"ImageMetadata","id":"1*D-FDlfkqivRBQZoESrwtqw.png"},"Collection:f05f8696e3cc":{"__typename":"Collection","id":"f05f8696e3cc","favicon":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFF3F1FF","point":0},{"__typename":"ColorPoint","color":"#FFF1EFFF","point":0.1},{"__typename":"ColorPoint","color":"#FFEEEDFF","point":0.2},{"__typename":"ColorPoint","color":"#FFECEBFF","point":0.3},{"__typename":"ColorPoint","color":"#FFEAE9FF","point":0.4},{"__typename":"ColorPoint","color":"#FFE8E7FF","point":0.5},{"__typename":"ColorPoint","color":"#FFE5E4FF","point":0.6},{"__typename":"ColorPoint","color":"#FFE3E2FF","point":0.7},{"__typename":"ColorPoint","color":"#FFE1E0FF","point":0.8},{"__typename":"ColorPoint","color":"#FFDEDEFF","point":0.9},{"__typename":"ColorPoint","color":"#FFDCDCFF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF8080B7","point":0},{"__typename":"ColorPoint","color":"#FF7777A8","point":0.1},{"__typename":"ColorPoint","color":"#FF6E6E9A","point":0.2},{"__typename":"ColorPoint","color":"#FF65658B","point":0.3},{"__typename":"ColorPoint","color":"#FF5C5B7D","point":0.4},{"__typename":"ColorPoint","color":"#FF52526E","point":0.5},{"__typename":"ColorPoint","color":"#FF484860","point":0.6},{"__typename":"ColorPoint","color":"#FF3D3D51","point":0.7},{"__typename":"ColorPoint","color":"#FF323241","point":0.8},{"__typename":"ColorPoint","color":"#FF262632","point":0.9},{"__typename":"ColorPoint","color":"#FF191921","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF1E184B","colorPoints":[{"__typename":"ColorPoint","color":"#FF1E184B","point":0},{"__typename":"ColorPoint","color":"#FF3A3866","point":0.1},{"__typename":"ColorPoint","color":"#FF54537D","point":0.2},{"__typename":"ColorPoint","color":"#FF6C6C93","point":0.3},{"__typename":"ColorPoint","color":"#FF8383A6","point":0.4},{"__typename":"ColorPoint","color":"#FF9999B9","point":0.5},{"__typename":"ColorPoint","color":"#FFAEAECA","point":0.6},{"__typename":"ColorPoint","color":"#FFC3C2DB","point":0.7},{"__typename":"ColorPoint","color":"#FFD8D6EB","point":0.8},{"__typename":"ColorPoint","color":"#FFEBEAFA","point":0.9},{"__typename":"ColorPoint","color":"#FFFFFDFF","point":1}]}},"domain":"posts.specterops.io","slug":"specter-ops-posts","googleAnalyticsId":"UA-102239211-2","editors":[{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:74ad66811b78"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:70f84c574024"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:f4ab382d41"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:1bb43103a9a9"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:b9c2df322eaf"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:b206c297df42"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:d59f95c1ed1c"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:6e849bed7683"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:9bef3c9a8b49"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:10eca8f7a844"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:d248a36145f8"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:2562fc45d9a9"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:645ffcef8682"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:a041d7ac11fe"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:507d73de7b97"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:e7dfc7678b59"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:ff850017e32a"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:4d7214ceeaf8"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:760e415ea3c9"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:f95d89c4ba81"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:59a56792287a"}}],"name":"Posts By SpecterOps Team Members","avatar":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"description":"Posts from SpecterOps team members on various topics relating information security","subscriberCount":4748,"latestPostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__ref":"Post:9ed71d38d546"}]},"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_698dd3bc823c"},"twitterUsername":"specterops","facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*s-5BWBr8XsgtIU5azKNhZQ.jpeg"}},"User:74ad66811b78":{"__typename":"User","id":"74ad66811b78"},"User:70f84c574024":{"__typename":"User","id":"70f84c574024"},"User:f4ab382d41":{"__typename":"User","id":"f4ab382d41"},"User:1bb43103a9a9":{"__typename":"User","id":"1bb43103a9a9"},"User:b9c2df322eaf":{"__typename":"User","id":"b9c2df322eaf"},"User:b206c297df42":{"__typename":"User","id":"b206c297df42"},"User:d59f95c1ed1c":{"__typename":"User","id":"d59f95c1ed1c"},"User:6e849bed7683":{"__typename":"User","id":"6e849bed7683"},"User:9bef3c9a8b49":{"__typename":"User","id":"9bef3c9a8b49"},"User:10eca8f7a844":{"__typename":"User","id":"10eca8f7a844"},"User:d248a36145f8":{"__typename":"User","id":"d248a36145f8"},"User:2562fc45d9a9":{"__typename":"User","id":"2562fc45d9a9"},"User:645ffcef8682":{"__typename":"User","id":"645ffcef8682"},"User:a041d7ac11fe":{"__typename":"User","id":"a041d7ac11fe"},"User:507d73de7b97":{"__typename":"User","id":"507d73de7b97"},"User:e7dfc7678b59":{"__typename":"User","id":"e7dfc7678b59"},"User:ff850017e32a":{"__typename":"User","id":"ff850017e32a"},"User:4d7214ceeaf8":{"__typename":"User","id":"4d7214ceeaf8"},"User:760e415ea3c9":{"__typename":"User","id":"760e415ea3c9"},"User:f95d89c4ba81":{"__typename":"User","id":"f95d89c4ba81"},"User:59a56792287a":{"__typename":"User","id":"59a56792287a"},"User:1cf7ed8b7054":{"__typename":"User","id":"1cf7ed8b7054","customDomainState":null,"hasSubdomain":false,"username":"Mayyhem"},"Post:9ed71d38d546":{"__typename":"Post","id":"9ed71d38d546","firstPublishedAt":1730409894212,"creator":{"__ref":"User:1cf7ed8b7054"},"collection":{"__ref":"Collection:f05f8696e3cc"},"isSeries":false,"mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fmaestro-9ed71d38d546","sequence":null,"uniqueSlug":"maestro-9ed71d38d546"},"LinkedAccounts:16791c25ae8":{"__typename":"LinkedAccounts","mastodon":null,"id":"16791c25ae8"},"UserViewerEdge:userId:16791c25ae8-viewerId:lo_698dd3bc823c":{"__typename":"UserViewerEdge","id":"userId:16791c25ae8-viewerId:lo_698dd3bc823c","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:55f456d7c203":{"__typename":"NewsletterV3","id":"55f456d7c203","type":"NEWSLETTER_TYPE_AUTHOR","slug":"16791c25ae8","name":"16791c25ae8","collection":null,"user":{"__ref":"User:16791c25ae8"}},"User:16791c25ae8":{"__typename":"User","id":"16791c25ae8","name":"Matt Creel","username":"Tw1sm","newsletterV3":{"__ref":"NewsletterV3:55f456d7c203"},"linkedAccounts":{"__ref":"LinkedAccounts:16791c25ae8"},"isSuspended":false,"imageId":"1*6EFikqGheJt57CGRXLXuVg.png","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":22,"followingCount":1,"collectionFollowingCount":0},"customDomainState":null,"hasSubdomain":false,"bio":"Adversary Simulation Consultant","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:16791c25ae8-viewerId:lo_698dd3bc823c"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"membership":null,"allowNotes":true,"twitterScreenName":""},"Paragraph:c97fb37466e6_0":{"__typename":"Paragraph","id":"c97fb37466e6_0","name":"4a78","type":"H3","href":null,"layout":null,"metadata":null,"text":"BOFHound: AD CS Integration","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_1":{"__typename":"Paragraph","id":"c97fb37466e6_1","name":"b71a","type":"BQ","href":null,"layout":null,"metadata":null,"text":"TL;DR: BOFHound can now parse Active Directory Certificate Services (AD CS) objects, manually queried from LDAP, for review and attack path mapping within BloodHound Community Edition (BHCE).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":7,"end":15,"href":"https:\u002F\u002Fgithub.com\u002Fcoffeegist\u002Fbofhound","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_2":{"__typename":"Paragraph","id":"c97fb37466e6_2","name":"85e6","type":"H3","href":null,"layout":null,"metadata":null,"text":"Background","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_3":{"__typename":"Paragraph","id":"c97fb37466e6_3","name":"712d","type":"P","href":null,"layout":null,"metadata":null,"text":"My last BOFHound-related post covered the support and usage strategies for Beacon object files (BOFs) enabling the manual collection of data required for BloodHound’s AdminTo and HasSession edges, among others. This brief post will cover the addition of AD CS object parsing (shoutout to GitHub user P-aLu for collaborating on the update) and some queries to get you started.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":3,"end":7,"href":"https:\u002F\u002Fposts.specterops.io\u002Fbofhound-session-integration-7b88b6f18423","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":300,"end":305,"href":"https:\u002F\u002Fgithub.com\u002FP-aLu","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_4":{"__typename":"Paragraph","id":"c97fb37466e6_4","name":"c2f4","type":"P","href":null,"layout":null,"metadata":null,"text":"But first, to clear up some misconceptions…","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_5":{"__typename":"Paragraph","id":"c97fb37466e6_5","name":"5611","type":"H4","href":null,"layout":null,"metadata":null,"text":"BOFHound is not a BOF!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_6":{"__typename":"Paragraph","id":"c97fb37466e6_6","name":"e874","type":"P","href":null,"layout":null,"metadata":null,"text":"Surprised and\u002For confused? Somewhat angry? Yes, this is the most common misconception I hear about the tool. BOFHound is not a BOF implementation of SharpHound; rather, it is a Python script that runs completely offline from your target network. I repeat — it is neither a BOF, nor a tool that actively enumerates a target Active Directory (AD) network. If this is not news to you, enlightened reader, consider skipping ahead to The Good Stuff.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":429,"end":443,"href":"#cea8","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":177,"end":191,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":429,"end":443,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_7":{"__typename":"Paragraph","id":"c97fb37466e6_7","name":"e495","type":"H4","href":null,"layout":null,"metadata":null,"text":"So What Does BOFHound Do (and Why on Earth Did You Name It That)?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_8":{"__typename":"Paragraph","id":"c97fb37466e6_8","name":"a8cd","type":"P","href":null,"layout":null,"metadata":null,"text":"BOFHound was born from repeated red team engagements in a large AD network where the blue team would flag SharpHound and other “loud” methods of LDAP enumeration. (In this environment, “loud” meant an expensive LDAP query — a query that returned a number of results over a threshold the client had determined to be indicative of attacker reconnaissance.) The team I worked with at the time adjusted by primarily relying on the ldapsearch BOF, part of TrustedSec’s situational awareness collection, for LDAP reconnaissance. This had two main benefits:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":201,"end":221,"href":"https:\u002F\u002Fgithub.com\u002FSpecterOps\u002Fpresentations\u002Fblob\u002Fmain\u002FSO-CON%202024\u002FMatt%20Creel%20%26%20Adam%20Brown%20-%20Manually%20Enumerating%20AD%20Attack%20Paths%20with%20BOFHound\u002FMatt%20Creel%20and%20Adam%20Brown%20-%20Manually%20Enumerating%20AD%20Attack%20Paths%20With%20BOFHound%20-%20SO-CON%202024.pdf","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":464,"end":485,"href":"https:\u002F\u002Fgithub.com\u002Ftrustedsec\u002FCS-Situational-Awareness-BOF","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_9":{"__typename":"Paragraph","id":"c97fb37466e6_9","name":"d758","type":"ULI","href":null,"layout":null,"metadata":null,"text":"It grants the operator full control over the LDAP query filter, meaning discretion can be used to avoid static query strings tied to common offensive tools and leveraged in detections [1, 2]","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":185,"end":186,"href":"https:\u002F\u002Ftechcommunity.microsoft.com\u002Ft5\u002Fmicrosoft-defender-for-endpoint\u002Fhunting-for-reconnaissance-activities-using-ldap-search-filters\u002Fba-p\u002F824726","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":188,"end":189,"href":"https:\u002F\u002Ffalconforce.nl\u002Ffalconfriday-detecting-active-directory-data-collection-0xff21\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_10":{"__typename":"Paragraph","id":"c97fb37466e6_10","name":"002e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The operator can specify a limit on the result count, so that the query returns no more than N entries; this is helpful when consciously avoiding expensive queries (result pools can also be narrowed with search scope, targeted query filters, or through a search base)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_11":{"__typename":"Paragraph","id":"c97fb37466e6_11","name":"4b78","type":"P","href":null,"layout":null,"metadata":null,"text":"Here are some downsides to solely relying on this approach for LDAP enumeration:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_12":{"__typename":"Paragraph","id":"c97fb37466e6_12","name":"fdf6","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Queries only return text-based results (i.e., there is no visualization or BloodHound-like graph that many operators prefer)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_13":{"__typename":"Paragraph","id":"c97fb37466e6_13","name":"5e14","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Identifying ACL abuses is essentially impossible with this approach alone","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_14":{"__typename":"Paragraph","id":"c97fb37466e6_14","name":"834e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Trying to keep track of and organize relationships between objects, like group memberships (let alone nested memberships), by hand in text\u002FExcel files is difficult","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_15":{"__typename":"Paragraph","id":"c97fb37466e6_15","name":"e9df","type":"P","href":null,"layout":null,"metadata":null,"text":"The bigger the target environment is, the more these problems are amplified. These also all sound like problems that BloodHound was originally created to solve. Is there any way we could maintain the granular control the ldapsearch BOF offers us over enumeration and still be able to use BloodHound?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_16":{"__typename":"Paragraph","id":"c97fb37466e6_16","name":"533a","type":"P","href":null,"layout":null,"metadata":null,"text":"Enter BOFHound. It aims to serve this very niche need by reading LDAP objects from your ldapsearch results in C2 logs, processing them, and producing BloodHound JSON files.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_17":{"__typename":"Paragraph","id":"c97fb37466e6_17","name":"21e1","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Thus the name BOFHound — read output from the ldapsearch BOF in log files and make it BloodHound-usable. LogHound just doesn’t have the same ring to it, does it?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_18":{"__typename":"Paragraph","id":"c97fb37466e6_18","name":"e0ab","type":"P","href":null,"layout":null,"metadata":null,"text":"This allows for ACL relationships to be parsed (from base64 encoded nTSecurityDescriptor attributes) and for your operators to continue visualizing nodes and relationships in the BloodHound UI where they are happy.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_19":{"__typename":"Paragraph","id":"c97fb37466e6_19","name":"170e","type":"P","href":null,"layout":null,"metadata":null,"text":"Now you might be wondering “BloodHound collects all data [that we frequently care for] in an AD environment, so how can this work with partial data obtained from manual queries?” Well, it’s simple; the BloodHound UI will only show you what you have enumerated via manual queries and parsed with BOFHound. In other words, it will be incomplete data and, if you’re using this approach, you’re likely fine with that. We can target specific information we want to populate the graph with, such as objects related to our objectives, objects that have privileges we want to compromise, or objects that often make easy targets (i.e., AD CS, SCCM).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":627,"end":632,"href":"https:\u002F\u002Fposts.specterops.io\u002Fcertified-pre-owned-d95910965cd2","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":634,"end":638,"href":"https:\u002F\u002Fgithub.com\u002Fsubat0mik\u002FMisconfiguration-Manager","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":48,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_20":{"__typename":"Paragraph","id":"c97fb37466e6_20","name":"daa1","type":"P","href":null,"layout":null,"metadata":null,"text":"But BloodHound will actually show you a little more than only what you’ve queried. Object ACLs return references (SIDs) to other objects in the environment that are granted some permission over the object you queried. When you parse these ACLs without an object tied to the SID, they are represented in the graph by nodes with SIDs for names or question mark icons. For example, if I query only the domain object, run it through BOFHound, upload the result to BloodHound, and check the Inbound Object Control on the domain object, we’ll see this.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":390,"end":394,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":38,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":486,"end":508,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*dDQKQkvp-Ib2iukJ":{"__typename":"ImageMetadata","id":"0*dDQKQkvp-Ib2iukJ","originalHeight":978,"originalWidth":1570,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c97fb37466e6_21":{"__typename":"Paragraph","id":"c97fb37466e6_21","name":"fbfa","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*dDQKQkvp-Ib2iukJ"},"text":"Parsing Single Object Reveals the Presence of Many More","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_22":{"__typename":"Paragraph","id":"c97fb37466e6_22","name":"246f","type":"P","href":null,"layout":null,"metadata":null,"text":"I’ve only queried the domain object, but I also now know that these six other objects exist. Knowing their SIDs provides a means to query those objects that might be of interest. As I query them and rerun BOFHound, we can slowly fill in that picture and expand it, essentially providing a way to identify objects of interest, and work backwards from them.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_23":{"__typename":"Paragraph","id":"c97fb37466e6_23","name":"3bc2","type":"H4","href":null,"layout":null,"metadata":null,"text":"The Fog of War","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_24":{"__typename":"Paragraph","id":"c97fb37466e6_24","name":"a3fe","type":"P","href":null,"layout":null,"metadata":null,"text":"A while back, I was talking with Jared Atkinson about BOFHound and these very misconceptions when he made a very apt analogy: clearing the fog of war. In games like Civilization or Age of Empires, you start surrounded by the “fog of war,” representing the world you know exists, but otherwise know nothing about. As you scout around, you reveal more of the map, pushing back the fog of war, and gaining more information about the game’s world.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":33,"end":47,"href":"https:\u002F\u002Fx.com\u002Fjaredcatkinson","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":165,"end":178,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":181,"end":195,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_25":{"__typename":"Paragraph","id":"c97fb37466e6_25","name":"316f","type":"P","href":null,"layout":null,"metadata":null,"text":"An unsophisticated player may just send their scouts out to chart the entire map as fast as possible. This could end up being advantageous, but it could also backfire by increasing the probability of encounters the player is unprepared for (i.e., a hostile faction). A sophisticated player may choose to scout areas as it’s advantageous to them, or when they’re prepared to deal with potentially hostile discoveries.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*SZFZzd5Um6H4IgS1632jbg.png":{"__typename":"ImageMetadata","id":"1*SZFZzd5Um6H4IgS1632jbg.png","originalHeight":505,"originalWidth":845,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c97fb37466e6_26":{"__typename":"Paragraph","id":"c97fb37466e6_26","name":"9bf7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*SZFZzd5Um6H4IgS1632jbg.png"},"text":"Brb, Building a Scout","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_27":{"__typename":"Paragraph","id":"c97fb37466e6_27","name":"6cea","type":"P","href":null,"layout":null,"metadata":null,"text":"As a prospective BOFHound user, the fog of war is the great unknown AD environment: objects, relationships, attack paths, etc. Immediately trying to chart the entire map is like trying query every AD object at once (i.e., (objectClass=*), running SharpHound); very beneficial data to have if successful, but you’re at high risk of revealing your presence to the hostile blue team. BOFHound is supposed to aid you in taking the careful, “sophisticated player” approach. Each time you manually run a batch of LDAP queries and parse\u002Fprocess with BOFHound, you clear a bit more of the fog and incrementally learn more about the environment you’re in. It is an iterative process (query → parse → query, etc.) until you feel you have sufficient information to take additional action or move on.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":222,"end":237,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_28":{"__typename":"Paragraph","id":"c97fb37466e6_28","name":"9231","type":"P","href":null,"layout":null,"metadata":null,"text":"I think it goes without saying, but this approach is quite niche. If you do not care about being detected performing LDAP reconnaissance or know\u002Fthink an alert will not fire for something like running SharpHound or ADExplorer, then you should run them. Having a more complete dataset will always allow you to spend your time more efficiently. I use this methodology described with BOFHound a handful of times a year, when I care about being stealthy; you really have no need for this in your playbook otherwise.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":236,"end":242,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_29":{"__typename":"Paragraph","id":"c97fb37466e6_29","name":"232d","type":"P","href":null,"layout":null,"metadata":null,"text":"I hope this detour helped clear up some of the self-inflicted misconceptions around BOFHound’s purpose, intended usage, and name. This took up way more space than I initially intended (and became a bit rant-y), but now we can get into the AD CS updates.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_30":{"__typename":"Paragraph","id":"c97fb37466e6_30","name":"cea8","type":"H3","href":null,"layout":null,"metadata":null,"text":"The Good Stuff","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_31":{"__typename":"Paragraph","id":"c97fb37466e6_31","name":"b7a1","type":"P","href":null,"layout":null,"metadata":null,"text":"In addition to the AD CS support, I recently added parsing support for Havoc log files. The rest of this blog will use the ldapsearch BOF via Havoc to demo one method of AD CS enumeration. While you’re probably not rolling out Havoc on your red team assessments, I realized only supporting log parsing for commercial C2s might otherwise turn users away from testing BOFHound in a lab. Havoc ships with an outdated version (as of 10\u002F22\u002F2024) of the ldapsearch BOF (needs updated for AD CS querying), but that can be easily remedied by copying the latest BOFs over to havoc\u002Fclient\u002FModules\u002FSituationalAwareness\u002FObjectFiles\u002Fand updating the ldapsearch_parse_params() function within hacov\u002Fclient\u002FModuels\u002FSituationalAwareness\u002FSituationalAwareness.py to the definition in this gist.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":566,"end":620,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":637,"end":662,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":679,"end":744,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":71,"end":76,"href":"https:\u002F\u002Fgithub.com\u002FHavocFramework\u002FHavoc","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":546,"end":557,"href":"https:\u002F\u002Fgithub.com\u002Ftrustedsec\u002FCS-Situational-Awareness-BOF\u002Ftree\u002Fmaster\u002FSA\u002Fldapsearch","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":771,"end":775,"href":"https:\u002F\u002Fgist.github.com\u002FTw1sm\u002F15c0eac8fc0f4c794ab8081b63da6c84","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_32":{"__typename":"Paragraph","id":"c97fb37466e6_32","name":"e37b","type":"P","href":null,"layout":null,"metadata":null,"text":"On past assessments, I’ve typically leveraged one of the various adcs_enum BOFs included in situational awareness collection for AD CS enumeration and config analysis. These work great and I’ve used them to identify vulnerable templates and AD CS ESC paths during real-world engagements. Why bother switching enumeration playbooks? Manually analyzing a wall of certificate config text can work, but it can also be error prone, especially when it comes to trying to unroll group memberships for permissions like enrollment rights.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":65,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":92,"end":113,"href":"https:\u002F\u002Fgithub.com\u002Ftrustedsec\u002FCS-Situational-Awareness-BOF","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*OlTG1vG8BDqHzbw0":{"__typename":"ImageMetadata","id":"0*OlTG1vG8BDqHzbw0","originalHeight":891,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c97fb37466e6_33":{"__typename":"Paragraph","id":"c97fb37466e6_33","name":"1b35","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:0*OlTG1vG8BDqHzbw0"},"text":"Trusty Old Text Wall of Certificate Configs","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_34":{"__typename":"Paragraph","id":"c97fb37466e6_34","name":"519a","type":"P","href":null,"layout":null,"metadata":null,"text":"While it’s still all too common to find paths like ESC1 with groups such as Domain Users, Domain Computers, and Authenticated Users jumping out when checking enrollment rights, unrolling nested rights (like the path below) isn’t always so straightforward when reviewing these config dumps.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":76,"end":88,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":90,"end":106,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":112,"end":131,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*vYK50CrvIdZ1Uvt4":{"__typename":"ImageMetadata","id":"0*vYK50CrvIdZ1Uvt4","originalHeight":1530,"originalWidth":1330,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c97fb37466e6_35":{"__typename":"Paragraph","id":"c97fb37466e6_35","name":"c7e5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*vYK50CrvIdZ1Uvt4"},"text":"ESC1 Path Through Nested Group Membership","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_36":{"__typename":"Paragraph","id":"c97fb37466e6_36","name":"726c","type":"P","href":null,"layout":null,"metadata":null,"text":"The question the remainder of the blog tries to answer — can we piece together this same picture without burning the red team by running SharpHound? My coworker Jonas Bülow Knudsen released a very informative blog about AD CS attack paths in BloodHound when they were introduced and his blog details the types of LDAP objects relied upon for mapping AD CS relationships. In short, there are six “new” types of objects we care about:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":161,"end":180,"href":"https:\u002F\u002Fx.com\u002FJonas_B_K","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":209,"end":213,"href":"https:\u002F\u002Fmedium.com\u002Fspecter-ops-posts\u002Fadcs-attack-paths-in-bloodhound-part-1-799f3d3b03cf","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":57,"end":149,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_37":{"__typename":"Paragraph","id":"c97fb37466e6_37","name":"ca2b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Enterprise CAs","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_38":{"__typename":"Paragraph","id":"c97fb37466e6_38","name":"0045","type":"ULI","href":null,"layout":null,"metadata":null,"text":"AIACAs","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_39":{"__typename":"Paragraph","id":"c97fb37466e6_39","name":"7529","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Root CAs","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_40":{"__typename":"Paragraph","id":"c97fb37466e6_40","name":"dc2f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"NTAuth Stores","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_41":{"__typename":"Paragraph","id":"c97fb37466e6_41","name":"32bd","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Certificate Templates","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_42":{"__typename":"Paragraph","id":"c97fb37466e6_42","name":"a952","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Issuance Policies","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_43":{"__typename":"Paragraph","id":"c97fb37466e6_43","name":"66c9","type":"P","href":null,"layout":null,"metadata":null,"text":"If we query these objects (and the domain object), we can graph out the attack paths. There’s no “right” way to do this with ldapsearch, but a basic approach is a sequence of queries based on object class. All the target objects are nested in the Configuration naming context — technically we could query them all at once with (objectClass=*)and a search base of CN=Cofiguration,DC=domain,DC=local. However, if you’re interested in this manual approach in the first place, you may not be interested in that sort of wide-ranging query 😉.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":327,"end":342,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":363,"end":397,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":247,"end":260,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_44":{"__typename":"Paragraph","id":"c97fb37466e6_44","name":"0ab7","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s a sample query transcript to get you started:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_45":{"__typename":"Paragraph","id":"c97fb37466e6_45","name":"608e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Query the domain object\nldapsearch (objectclass=domain) *,ntsecuritydescriptor\n\n# Query Enterprise CAs\nldapsearch (objectclass=pKIEnrollmentService) *,ntsecuritydescriptor 0 3 \"\" \"CN=Configuration,DC=domain,DC=local\"\n\n# Query AIACAs, Root CAs and NTAuth Stores\nldapsearch (objectclass=certificationAuthority) *,ntsecuritydescriptor 0 3 \"\" \"CN=Configuration,DC=domain,DC=local\"\n\n# Query Certificate Templates\nldapsearch (objectclass=pKICertificateTemplate) *,ntsecuritydescriptor 0 3 \"\" \"CN=Configuration,DC=domain,DC=local\"\n\n# Query Issuance Policies\nldapsearch (objectclass=msPKI-Enterprise-Oid) *,ntsecuritydescriptor 0 3 \"\" \"CN=Configuration,DC=domain,DC=local\"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_46":{"__typename":"Paragraph","id":"c97fb37466e6_46","name":"dd4f","type":"P","href":null,"layout":null,"metadata":null,"text":"If you’re new to the ldapsearch BOF (or even just its recent argument updates), here’s a quick breakdown of its positional arguments. Consider this query from the examples: ldapsearch (objectclass=pKIEnrollmentService) *,ntsecuritydescriptor 0 3 \"\" \"CN=Configuration,DC=essos,DC=local\" — what does this mean?","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":173,"end":285,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:095f6961612f6b8e24622c1c90fbdbeb":{"__typename":"MediaResource","id":"095f6961612f6b8e24622c1c90fbdbeb","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"ldapsearch-example.csv"},"Paragraph:c97fb37466e6_47":{"__typename":"Paragraph","id":"c97fb37466e6_47","name":"0011","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"Brief Breakdown of an ldapsearch Command","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:095f6961612f6b8e24622c1c90fbdbeb"}},"mixtapeMetadata":null},"Paragraph:c97fb37466e6_48":{"__typename":"Paragraph","id":"c97fb37466e6_48","name":"e523","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s an example of one transcript query performed with the ldapsearch BOF via Havoc. I’m doing this enumeration across a domain trust in my lab (GOAD, from sevenkingdoms.local to essos.local), hence the explicit definition of domain controller to query and search base (even for objects in the default naming context).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":158,"end":177,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":181,"end":192,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":147,"end":151,"href":"https:\u002F\u002Fgithub.com\u002FOrange-Cyberdefense\u002FGOAD","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*48mMIhjqNR3s0Aal":{"__typename":"ImageMetadata","id":"0*48mMIhjqNR3s0Aal","originalHeight":755,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c97fb37466e6_49":{"__typename":"Paragraph","id":"c97fb37466e6_49","name":"1e51","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:0*48mMIhjqNR3s0Aal"},"text":"Query for AIACAs, NTAuth Stores, and Root CAs","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_50":{"__typename":"Paragraph","id":"c97fb37466e6_50","name":"91b9","type":"P","href":null,"layout":null,"metadata":null,"text":"After running each of the queries in the sample transcript, we can parse that minimal dataset from the Havoc loot logs with BOFHound.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_51":{"__typename":"Paragraph","id":"c97fb37466e6_51","name":"aaf4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"bofhound -i \u002Fopt\u002Fhavoc\u002Fdata\u002Floot --parser havoc --zip","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*tD6wbdMCOkG7gxY_":{"__typename":"ImageMetadata","id":"0*tD6wbdMCOkG7gxY_","originalHeight":1053,"originalWidth":1370,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c97fb37466e6_52":{"__typename":"Paragraph","id":"c97fb37466e6_52","name":"7d14","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*tD6wbdMCOkG7gxY_"},"text":"BOFHound Parsing the Log Data","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_53":{"__typename":"Paragraph","id":"c97fb37466e6_53","name":"591a","type":"P","href":null,"layout":null,"metadata":null,"text":"After the data has been parsed, we can load up BHCE and upload the output archive.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_54":{"__typename":"Paragraph","id":"c97fb37466e6_54","name":"900d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"curl -L https:\u002F\u002Fghst.ly\u002Fgetbhce \u003E docker-compose.yml\nsudo docker compose pull\nsudo docker compose up","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_55":{"__typename":"Paragraph","id":"c97fb37466e6_55","name":"6470","type":"P","href":null,"layout":null,"metadata":null,"text":"In the UI, we can use some of the prebuilt queries to help us find common misconfigurations and escalation paths. I’ll start with the prebuilt Enrollment rights on ESC1 certificate templates query, which will limit the templates I view to just those that meet ESC1 requirements.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":143,"end":191,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*K-gurdvci5HEwPT5":{"__typename":"ImageMetadata","id":"0*K-gurdvci5HEwPT5","originalHeight":1304,"originalWidth":1518,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c97fb37466e6_56":{"__typename":"Paragraph","id":"c97fb37466e6_56","name":"f47f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*K-gurdvci5HEwPT5"},"text":"Prebuilt AD CS Queries","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_57":{"__typename":"Paragraph","id":"c97fb37466e6_57","name":"b29e","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s what those results look like with the objects we queried in the lab. We know the SIDs ending in 519 and 512 are Enterprise Admins and Domain Admins, but we’ve got an unknown object with a resource ID (RID) of “1602”.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":119,"end":136,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":141,"end":154,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*Ibwa9CcEtzSMop0Y":{"__typename":"ImageMetadata","id":"0*Ibwa9CcEtzSMop0Y","originalHeight":282,"originalWidth":1550,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c97fb37466e6_58":{"__typename":"Paragraph","id":"c97fb37466e6_58","name":"d7c4","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:0*Ibwa9CcEtzSMop0Y"},"text":"The “Fog of War” — Unknown Objects in the Graph","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_59":{"__typename":"Paragraph","id":"c97fb37466e6_59","name":"386d","type":"P","href":null,"layout":null,"metadata":null,"text":"If we issue an LDAP query for that mystery SID, we can determine that it’s a group (think back to the original attack path screenshot we’re working towards).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_60":{"__typename":"Paragraph","id":"c97fb37466e6_60","name":"4eb7","type":"PRE","href":null,"layout":null,"metadata":null,"text":"ldapsearch (objectSid=S-1–5–21–2301939034–812057587–2058894929–1602) *,ntsecuritydescriptor","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*ZOoCUa1ZNwcw1i1J":{"__typename":"ImageMetadata","id":"0*ZOoCUa1ZNwcw1i1J","originalHeight":610,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c97fb37466e6_61":{"__typename":"Paragraph","id":"c97fb37466e6_61","name":"0f90","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:0*ZOoCUa1ZNwcw1i1J"},"text":"Query the Unknown BloodHound Node","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_62":{"__typename":"Paragraph","id":"c97fb37466e6_62","name":"05bc","type":"P","href":null,"layout":null,"metadata":null,"text":"That returned properties for the group granted enrollment rights, including its distinguished name, which we can use to unroll the group members.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*WZf5PJj2ckDPCxtp":{"__typename":"ImageMetadata","id":"0*WZf5PJj2ckDPCxtp","originalHeight":340,"originalWidth":733,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c97fb37466e6_63":{"__typename":"Paragraph","id":"c97fb37466e6_63","name":"739d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*WZf5PJj2ckDPCxtp"},"text":"Just One More Turn","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_64":{"__typename":"Paragraph","id":"c97fb37466e6_64","name":"a08d","type":"P","href":null,"layout":null,"metadata":null,"text":"To unroll the group’s members (return first and Nth degree members) we can take the group’s distinguished name and issue an LDAP query using the LDAP_MATCHING_RULE_TRANSITIVE_EVAL matching rule.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":180,"end":193,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fopenspecs\u002Fwindows_protocols\u002Fms-adts\u002F4e638665-f466-4597-93c4-12f2ebfabab5","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":145,"end":179,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_65":{"__typename":"Paragraph","id":"c97fb37466e6_65","name":"433d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"ldapsearch (memberOf:1.2.840.113556.1.4.1941:=CN=Nested1,CN=Users,DC=essos,DC=local) *,ntsecuritydescriptor","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*gIvsjYylJ_qHfL-s":{"__typename":"ImageMetadata","id":"0*gIvsjYylJ_qHfL-s","originalHeight":732,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c97fb37466e6_66":{"__typename":"Paragraph","id":"c97fb37466e6_66","name":"a73a","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:0*gIvsjYylJ_qHfL-s"},"text":"Unroll Group Membership","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_67":{"__typename":"Paragraph","id":"c97fb37466e6_67","name":"8bc9","type":"P","href":null,"layout":null,"metadata":null,"text":"That query returns two results in the lab, though only one can be seen in the screenshot. However, if you look closely at the user object returned, you’ll notice the memberOf attribute doesn’t contain the Nested1 group from our query filter (meaning the object must be a Nth degree member).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":166,"end":174,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":205,"end":212,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_68":{"__typename":"Paragraph","id":"c97fb37466e6_68","name":"5b32","type":"P","href":null,"layout":null,"metadata":null,"text":"Now we rerun BOFHound, same as we did before.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_69":{"__typename":"Paragraph","id":"c97fb37466e6_69","name":"298d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"bofhound -i \u002Fopt\u002Fhavoc\u002Fdata\u002Floot --parser havoc --zip","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_70":{"__typename":"Paragraph","id":"c97fb37466e6_70","name":"172b","type":"P","href":null,"layout":null,"metadata":null,"text":"After we ingest the data again, rerunning the same ESC1 enrollment rights query shows the previously unknown SID with enrollment rights belonged to the Nested1 group.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":152,"end":159,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*4tWnO5XpX0pgQFHO":{"__typename":"ImageMetadata","id":"0*4tWnO5XpX0pgQFHO","originalHeight":370,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c97fb37466e6_71":{"__typename":"Paragraph","id":"c97fb37466e6_71","name":"7396","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:0*4tWnO5XpX0pgQFHO"},"text":"Slowly Clearing the Fog of War","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_72":{"__typename":"Paragraph","id":"c97fb37466e6_72","name":"f895","type":"P","href":null,"layout":null,"metadata":null,"text":"This prebuilt query doesn’t unroll the group members, though. If we click the ESC1@ESSOS.LOCAL object to bring up the properties pane on the right side, we can click the Inbound Object Control section to unroll enrollment rights (and potentially other ACL-based abuses).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":78,"end":94,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":170,"end":192,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*7Y6aCqR9UqdmBe_x":{"__typename":"ImageMetadata","id":"0*7Y6aCqR9UqdmBe_x","originalHeight":406,"originalWidth":1286,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c97fb37466e6_73":{"__typename":"Paragraph","id":"c97fb37466e6_73","name":"5adf","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:0*7Y6aCqR9UqdmBe_x"},"text":"The Unrolled Enrollment Rights Leading to ESC1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_74":{"__typename":"Paragraph","id":"c97fb37466e6_74","name":"e6bb","type":"P","href":null,"layout":null,"metadata":null,"text":"This reveals the path we initially examined, showing a way to perform ESC1 through nested enrollment rights. Should we return to BloodHound’s pathfinding tab and search for paths starting at MISSANDEI@ESSOS.LOCAL and ending at ESSOS.LOCAL, we now have all the data necessary to map the attack path shown at the beginning of this section (if you’re following along in GOAD, your pathfinding might surface a shorter ASCSESC3 path that you have to filter out).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":191,"end":212,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":227,"end":238,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":414,"end":422,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*bmRtAVvKgDE2zIJo":{"__typename":"ImageMetadata","id":"0*bmRtAVvKgDE2zIJo","originalHeight":553,"originalWidth":825,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c97fb37466e6_75":{"__typename":"Paragraph","id":"c97fb37466e6_75","name":"dcee","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*bmRtAVvKgDE2zIJo"},"text":"Assessment Debrief","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_76":{"__typename":"Paragraph","id":"c97fb37466e6_76","name":"84d9","type":"P","href":null,"layout":null,"metadata":null,"text":"BloodHound currently supports edges for ESC1, ESC3, ESC4 and ESC13. You can quickly query any escalation path abusing one of them with:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_77":{"__typename":"Paragraph","id":"c97fb37466e6_77","name":"d46f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MATCH p=()-[:ADCSESC1|ADCSESC3|ADCSESC4|ADCSESC13]-\u003E()\nRETURN p","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ontyPzOXwsYUeHkbX8QYUA.png":{"__typename":"ImageMetadata","id":"1*ontyPzOXwsYUeHkbX8QYUA.png","originalHeight":816,"originalWidth":760,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c97fb37466e6_78":{"__typename":"Paragraph","id":"c97fb37466e6_78","name":"a4e2","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ontyPzOXwsYUeHkbX8QYUA.png"},"text":"ADCSESC1, ADCSESC3, ADCSESC4 Edges from GOAD “Misconfigurations”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_79":{"__typename":"Paragraph","id":"c97fb37466e6_79","name":"65f0","type":"H3","href":null,"layout":null,"metadata":null,"text":"Is Anything Missing?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_80":{"__typename":"Paragraph","id":"c97fb37466e6_80","name":"2f38","type":"P","href":null,"layout":null,"metadata":null,"text":"The ManageCA and ManageCertificates edges from BloodHound are not currently implemented in BOFHound. These relationships require reading values from the registry on CAs, which would require some other “collector” and parser (something akin to how BOFHound supports AdminTo and HasSession edges). These relationships are not currently relied on for any ESC attacks that BHCE supports, but will be if or when BloodHound gains ESC7 support.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":17,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":265,"end":272,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":277,"end":287,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_81":{"__typename":"Paragraph","id":"c97fb37466e6_81","name":"0de8","type":"H3","href":null,"layout":null,"metadata":null,"text":"Conclusion","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c97fb37466e6_82":{"__typename":"Paragraph","id":"c97fb37466e6_82","name":"d572","type":"P","href":null,"layout":null,"metadata":null,"text":"This post served to clear up some common misconceptions about BOFHound, introduce the ability to parse AD CS objects, and provide a starting point for querying relevant LDAP objects. I hope that the added support for Havoc makes it easier to follow along with this post in a lab and give BOFHound a try. If you encounter any bugs, please feel free to open an issue on GitHub or shoot me a message in the BloodHoundGang Slack (@Tw1sm).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":368,"end":374,"href":"https:\u002F\u002Fgithub.com\u002Fcoffeegist\u002Fbofhound\u002Fissues","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":426,"end":432,"href":"https:\u002F\u002Fbloodhoundhq.slack.com\u002Fteam\u002FU02T6NDRAM8","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_698dd3bc823c":{"__typename":"CollectionViewerEdge","id":"collectionId:f05f8696e3cc-viewerId:lo_698dd3bc823c","isEditor":false,"isMuting":false},"ImageMetadata:1*s-5BWBr8XsgtIU5azKNhZQ.jpeg":{"__typename":"ImageMetadata","id":"1*s-5BWBr8XsgtIU5azKNhZQ.jpeg","originalWidth":2000,"originalHeight":805},"PostViewerEdge:postId:91b706bc7958-viewerId:lo_698dd3bc823c":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:91b706bc7958-viewerId:lo_698dd3bc823c"},"Post:91b706bc7958":{"__typename":"Post","id":"91b706bc7958","collection":{"__ref":"Collection:f05f8696e3cc"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"54f0","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:c97fb37466e6_0"},{"__ref":"Paragraph:c97fb37466e6_1"},{"__ref":"Paragraph:c97fb37466e6_2"},{"__ref":"Paragraph:c97fb37466e6_3"},{"__ref":"Paragraph:c97fb37466e6_4"},{"__ref":"Paragraph:c97fb37466e6_5"},{"__ref":"Paragraph:c97fb37466e6_6"},{"__ref":"Paragraph:c97fb37466e6_7"},{"__ref":"Paragraph:c97fb37466e6_8"},{"__ref":"Paragraph:c97fb37466e6_9"},{"__ref":"Paragraph:c97fb37466e6_10"},{"__ref":"Paragraph:c97fb37466e6_11"},{"__ref":"Paragraph:c97fb37466e6_12"},{"__ref":"Paragraph:c97fb37466e6_13"},{"__ref":"Paragraph:c97fb37466e6_14"},{"__ref":"Paragraph:c97fb37466e6_15"},{"__ref":"Paragraph:c97fb37466e6_16"},{"__ref":"Paragraph:c97fb37466e6_17"},{"__ref":"Paragraph:c97fb37466e6_18"},{"__ref":"Paragraph:c97fb37466e6_19"},{"__ref":"Paragraph:c97fb37466e6_20"},{"__ref":"Paragraph:c97fb37466e6_21"},{"__ref":"Paragraph:c97fb37466e6_22"},{"__ref":"Paragraph:c97fb37466e6_23"},{"__ref":"Paragraph:c97fb37466e6_24"},{"__ref":"Paragraph:c97fb37466e6_25"},{"__ref":"Paragraph:c97fb37466e6_26"},{"__ref":"Paragraph:c97fb37466e6_27"},{"__ref":"Paragraph:c97fb37466e6_28"},{"__ref":"Paragraph:c97fb37466e6_29"},{"__ref":"Paragraph:c97fb37466e6_30"},{"__ref":"Paragraph:c97fb37466e6_31"},{"__ref":"Paragraph:c97fb37466e6_32"},{"__ref":"Paragraph:c97fb37466e6_33"},{"__ref":"Paragraph:c97fb37466e6_34"},{"__ref":"Paragraph:c97fb37466e6_35"},{"__ref":"Paragraph:c97fb37466e6_36"},{"__ref":"Paragraph:c97fb37466e6_37"},{"__ref":"Paragraph:c97fb37466e6_38"},{"__ref":"Paragraph:c97fb37466e6_39"},{"__ref":"Paragraph:c97fb37466e6_40"},{"__ref":"Paragraph:c97fb37466e6_41"},{"__ref":"Paragraph:c97fb37466e6_42"},{"__ref":"Paragraph:c97fb37466e6_43"},{"__ref":"Paragraph:c97fb37466e6_44"},{"__ref":"Paragraph:c97fb37466e6_45"},{"__ref":"Paragraph:c97fb37466e6_46"},{"__ref":"Paragraph:c97fb37466e6_47"},{"__ref":"Paragraph:c97fb37466e6_48"},{"__ref":"Paragraph:c97fb37466e6_49"},{"__ref":"Paragraph:c97fb37466e6_50"},{"__ref":"Paragraph:c97fb37466e6_51"},{"__ref":"Paragraph:c97fb37466e6_52"},{"__ref":"Paragraph:c97fb37466e6_53"},{"__ref":"Paragraph:c97fb37466e6_54"},{"__ref":"Paragraph:c97fb37466e6_55"},{"__ref":"Paragraph:c97fb37466e6_56"},{"__ref":"Paragraph:c97fb37466e6_57"},{"__ref":"Paragraph:c97fb37466e6_58"},{"__ref":"Paragraph:c97fb37466e6_59"},{"__ref":"Paragraph:c97fb37466e6_60"},{"__ref":"Paragraph:c97fb37466e6_61"},{"__ref":"Paragraph:c97fb37466e6_62"},{"__ref":"Paragraph:c97fb37466e6_63"},{"__ref":"Paragraph:c97fb37466e6_64"},{"__ref":"Paragraph:c97fb37466e6_65"},{"__ref":"Paragraph:c97fb37466e6_66"},{"__ref":"Paragraph:c97fb37466e6_67"},{"__ref":"Paragraph:c97fb37466e6_68"},{"__ref":"Paragraph:c97fb37466e6_69"},{"__ref":"Paragraph:c97fb37466e6_70"},{"__ref":"Paragraph:c97fb37466e6_71"},{"__ref":"Paragraph:c97fb37466e6_72"},{"__ref":"Paragraph:c97fb37466e6_73"},{"__ref":"Paragraph:c97fb37466e6_74"},{"__ref":"Paragraph:c97fb37466e6_75"},{"__ref":"Paragraph:c97fb37466e6_76"},{"__ref":"Paragraph:c97fb37466e6_77"},{"__ref":"Paragraph:c97fb37466e6_78"},{"__ref":"Paragraph:c97fb37466e6_79"},{"__ref":"Paragraph:c97fb37466e6_80"},{"__ref":"Paragraph:c97fb37466e6_81"},{"__ref":"Paragraph:c97fb37466e6_82"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:16791c25ae8"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fbofhound-ad-cs-integration-91b706bc7958","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"programming"}],"isPublished":true,"latestPublishedVersion":"c97fb37466e6","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":3,"allowResponses":true,"isLimitedState":false,"title":"BOFHound: AD CS Integration","isSeries":false,"sequence":null,"uniqueSlug":"bofhound-ad-cs-integration-91b706bc7958","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1730299875474,"readingTime":10.666037735849057,"previewContent":{"__typename":"PreviewContent","subtitle":"TL;DR: BOFHound can now parse Active Directory Certificate Services (AD CS) objects, manually queried from LDAP, for review and attack path…"},"previewImage":{"__ref":"ImageMetadata:0*dDQKQkvp-Ib2iukJ"},"isShortform":false,"seoTitle":"","firstPublishedAt":1730297772678,"updatedAt":1731568987330,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:91b706bc7958-viewerId:lo_698dd3bc823c"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":2429,"layerCake":6,"responsesLocked":false}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.343cd682.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.504c4d2c.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9120.5df29668.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1386.90da86c2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.5b3eb23a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/719.fd316d3b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6349.b071a958.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1443.a8a73f48.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3735.afb7e926.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.4f29140a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.08de95de.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7346.72622eb9.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.2a5e2d95.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.ca7937c2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.d195c6f1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.21ff89d3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.e27cfbf2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2961.00a48598.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.138a844a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.6b7ab30f.chunk.js"></script><script>window.main();</script></body></html>