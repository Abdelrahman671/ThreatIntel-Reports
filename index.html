<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Threat Intel Tools Overview</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        /* Background and font color settings */
        body {
            font-family: Consolas, monospace;
            background-color: #0d1b2a; /* Dark blue background */
            color: #a7c957; /* Light green text */
        }
        
        /* Card styling */
        .card {
            background-color: #1b263b; /* Slightly lighter dark blue */
            color: #a7c957;
            border: 1px solid #2f4f4f; /* Dark border for separation */
        }
        
        /* Form control styling */
        .form-control {
            background-color: #04151f; /* Dark background for input */
            color: #a7c957;
            border: 1px solid #4f772d; /* Green border for input */
        }
        
        /* Button styling */
        .btn-custom {
            background-color: #4f772d; /* Green button background */
            color: #0d1b2a; /* Dark blue text */
        }
        .btn-custom:hover {
            background-color: #abdf32; /* Lighter green on hover */
            color: #0d1b2a;
        }
        
        /* Alert styling */
        .alert-info {
            background-color: #1b263b; /* Dark blue alert background */
            color: #a7c957; /* Light green text */
            border: 1px solid #2f4f4f;
        }
        
        /* Link styling */
        a.text-primary {
            color: #a7c957; /* Light green links */
            text-decoration: none;
            font-weight: bold;
        }
        a.text-primary:hover {
            color: #90a955; /* Slightly lighter green on hover */
            text-decoration: none;
        }
        
        /* Background for light elements */
        .bg-light {
            background-color: #1b263b !important;
            color: #a7c957;
        }

        /* Mention card styling */
        .mention-card {
            padding: 5px;
            margin-bottom: 8px;
            background-color: #1b263b;
            color: #a7c957;
            border: 1px solid #2f4f4f; /* Dark border */
            text-align: left;
        }

        /* Mention body styling */
        .mention-body {
            padding: 5px;
            margin-bottom: 5px;
            text-align: left;
            font-size: 14px;
            overflow-wrap: break-word;
            white-space: pre-wrap;
            background-color: #04151f;
            color: #a7c957;
            border-left: 3px solid #4f772d; /* Green accent line */
            margin: 0;
        }

        /* Card body padding */
        .card-body {
            padding: 5px !important;
        }

        /* GitHub logo styling */
        .github-logo {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 32px;
            height: 32px;
            background-color: white;
            border-radius: 50%;
            padding: 4px;
        }

        /* Custom scrollbar styling for dark theme */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #003049;
        }
        ::-webkit-scrollbar-thumb {
            background: #555;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #444;
        }
    </style>
</head>
<body>
    <a href="https://github.com/mthcht/ThreatIntel-Reports" target="_blank">
        <img src="https://upload.wikimedia.org/wikipedia/commons/9/91/Octicons-mark-github.svg" alt="GitHub" class="github-logo">
    </a>    
    <div class="title-container text-center mb-4">
        <h1 class="title">Threat Intelligence Reports</h1>
<div class="report-count" style="font-size: 0.9rem; color: #90a955;">Total Reports: 9835</div>
    </div>
    <div class="container mt-5">
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">Search for a Keyword</h5>
                <input id="search-bar" type="text" class="form-control" placeholder="Search for a keyword...">
            </div>
        </div>
        <div class="row" id="keyword-list">
            <!-- Keywords will be dynamically inserted here -->
        </div>
        <div id="mentions-container">
            <!-- Mentions will be dynamically inserted here -->
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        $(document).ready(function() {
            // Mapping of keywords to their corresponding JSON files
            const keywordToFileMap = {
    "action1": [
        "action1.json"
    ],
    "adfind": [
        "adfind.json"
    ],
    "akira": [
        "Akira.json"
    ],
    "anydesk": [
        "anydesk.json"
    ],
    "apt28": [
        "APT28.json"
    ],
    "apt29": [
        "APT29.json"
    ],
    "bcdedit": [
        "bcdedit.json"
    ],
    "blackcat": [
        "BlackCat.json"
    ],
    "blacksuit": [
        "BlackSuit.json"
    ],
    "bruteratel": [
        "bruteratel.json"
    ],
    "chisel": [
        "chisel.json"
    ],
    "cobaltstrike": [
        "cobaltstrike.json"
    ],
    "edrsandblast": [
        "EDRSandBlast.json"
    ],
    "evilginx": [
        "evilginx.json"
    ],
    "fin6": [
        "FIN6.json"
    ],
    "fin7": [
        "FIN7.json"
    ],
    "gosecretsdump": [
        "gosecretsdump.json"
    ],
    "impacket": [
        "Impacket.json"
    ],
    "ligolo": [
        "ligolo.json"
    ],
    "lockbit": [
        "LockBit.json"
    ],
    "menupass": [
        "MenuPass.json"
    ],
    "metasploit": [
        "Metasploit.json"
    ],
    "mimikatz": [
        "Mimikatz.json"
    ],
    "muddywater": [
        "MuddyWater.json"
    ],
    "powersploit": [
        "PowerSploit.json"
    ],
    "procdump": [
        "ProcDump.json"
    ],
    "psexec": [
        "psexec.json"
    ],
    "rclone": [
        "rclone.json"
    ],
    "rubeus": [
        "Rubeus.json"
    ],
    "screenconnect": [
        "screenconnect.json"
    ],
    "sharpchromium": [
        "SharpChromium.json"
    ],
    "sharpdpapi": [
        "SharpDPAPI.json"
    ],
    "sharphound": [
        "SharpHound.json"
    ],
    "sharpview": [
        "SharpView.json"
    ],
    "simplehelp": [
        "SimpleHelp.json"
    ],
    "sliver": [
        "Sliver.json"
    ],
    "splashtop": [
        "SplashTop.json"
    ],
    "teamviewer": [
        "teamviewer.json"
    ],
    "ultravnc": [
        "UltraVNC.json"
    ],
    "xworm": [
        "XWorm.json"
    ]
};

            const keywordListContainer = $('#keyword-list');
            const searchInput = $('#search-bar');
            const mentionsContainer = $('#mentions-container');

            // Store the list of all keywords
            let allKeywords = Object.keys(keywordToFileMap);

            // Function to render keyword buttons
            function renderKeywordButtons(keywords) {
                keywordListContainer.empty();
                keywords.forEach(keyword => {
                    const keywordElement = $(`
                        <div class="col-md-3 mb-3">
                            <button class="btn btn-custom w-100 keyword-item">${keyword}</button>
                        </div>
                    `);
                    keywordElement.on('click', () => {
                        displayMentions(keyword);
                    });
                    keywordListContainer.append(keywordElement);
                });
            }

            // Function to display mentions for the selected keyword
            function displayMentions(keyword) {
                mentionsContainer.empty();

                const jsonFiles = keywordToFileMap[keyword];
                if (!jsonFiles || jsonFiles.length === 0) {
                    console.error(`No JSON files found for keyword: ${keyword}`);
                    return;
                }

                const mentions = [];

                // Fetch mentions from the associated JSON file(s)
                const promises = jsonFiles.map(file => fetch(`search_results/${file}`)
                    .then(response => response.json())
                    .then(data => mentions.push(...data))
                    .catch(error => console.error(`Error loading ${file}:`, error))
                );

                Promise.all(promises).then(() => {
                    const groupedByUrl = mentions.reduce((acc, mention) => {
                        const url = mention.original_link.replace('[Link to the article](', '').replace(')', '');
                        if (!acc[url]) {
                            acc[url] = [];
                        }
                        acc[url].push(mention);
                        return acc;
                    }, {});

                    const totalLinks = Object.keys(groupedByUrl).length;
                    mentionsContainer.append(`
                        <div class="alert alert-info text-center" role="alert">
                            Threat Intel Reports for <strong>${keyword}</strong>: <strong>${totalLinks}</strong>
                        </div>
                    `);

                    Object.keys(groupedByUrl).forEach(url => {
                        const mentionElement = $(`
                            <div class="mention-card text-start" style="padding: 0;">
                                <div class="card-body p-0 text-start" style="text-align: left;">
                                    <a href="${url}" target="_blank" class="d-block mb-1" style="font-weight: bold; color: #a7c957; text-decoration: none;">${url}</a>
                                </div>
                            </div>
                        `);
                        groupedByUrl[url].forEach(mention => {
                            mentionElement.append(`
                                <div class="mention-body"><strong><span style="color: #4f772d;">Line ${mention.line_number}</span></strong>: ${$('<div>').text(mention.context).html()}</div>
                            `);
                        });
                        mentionsContainer.append(mentionElement);
                    });
                });
            }

            // Handle search functionality
            searchInput.on('input', () => {
                const query = searchInput.val().toLowerCase();

                if (query === "") {
                    renderKeywordButtons(allKeywords); // Show all keywords if search is cleared
                } else {
                    const filteredKeywords = allKeywords.filter(keyword => keyword.toLowerCase().includes(query));
                    renderKeywordButtons(filteredKeywords);
                }
            });

            // Initial rendering of keyword buttons
            renderKeywordButtons(allKeywords);
        });
    </script>
</body>
</html>
