<!doctype html>
<html lang="en">
<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	        <meta charset="UTF-8"><script type="text/javascript">(window.NREUM||(NREUM={})).init={privacy:{cookies_enabled:true},ajax:{deny_list:["bam.nr-data.net"]}};(window.NREUM||(NREUM={})).loader_config={licenseKey:"NRJS-51878192dd15f231213",applicationID:"732197726"};;/*! For license information please see nr-loader-rum-1.285.0.min.js.LICENSE.txt */
(()=>{var e,t,r={8122:(e,t,r)=>{"use strict";r.d(t,{a:()=>i});var n=r(944);function i(e,t){try{if(!e||"object"!=typeof e)return(0,n.R)(3);if(!t||"object"!=typeof t)return(0,n.R)(4);const r=Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyDescriptors(t)),o=0===Object.keys(r).length?e:r;for(let a in o)if(void 0!==e[a])try{if(null===e[a]){r[a]=null;continue}Array.isArray(e[a])&&Array.isArray(t[a])?r[a]=Array.from(new Set([...e[a],...t[a]])):"object"==typeof e[a]&&"object"==typeof t[a]?r[a]=i(e[a],t[a]):r[a]=e[a]}catch(e){(0,n.R)(1,e)}return r}catch(e){(0,n.R)(2,e)}}},2555:(e,t,r)=>{"use strict";r.d(t,{Vp:()=>c,fn:()=>s,x1:()=>u});var n=r(384),i=r(8122);const o={beacon:n.NT.beacon,errorBeacon:n.NT.errorBeacon,licenseKey:void 0,applicationID:void 0,sa:void 0,queueTime:void 0,applicationTime:void 0,ttGuid:void 0,user:void 0,account:void 0,product:void 0,extra:void 0,jsAttributes:{},userAttributes:void 0,atts:void 0,transactionName:void 0,tNamePlain:void 0},a={};function s(e){try{const t=c(e);return!!t.licenseKey&&!!t.errorBeacon&&!!t.applicationID}catch(e){return!1}}function c(e){if(!e)throw new Error("All info objects require an agent identifier!");if(!a[e])throw new Error("Info for ".concat(e," was never set"));return a[e]}function u(e,t){if(!e)throw new Error("All info objects require an agent identifier!");a[e]=(0,i.a)(t,o);const r=(0,n.nY)(e);r&&(r.info=a[e])}},5217:(e,t,r)=>{"use strict";r.d(t,{D0:()=>m,gD:()=>v,xN:()=>h});r(860).K7.genericEvents;const n="experimental.marks",i="experimental.measures",o="experimental.resources",a=e=>{if(!e||"string"!=typeof e)return!1;try{document.createDocumentFragment().querySelector(e)}catch{return!1}return!0};var s=r(2614),c=r(944),u=r(384),l=r(8122);const d="[data-nr-mask]",f=()=>{const e={feature_flags:[],experimental:{marks:!1,measures:!1,resources:!1},mask_selector:"*",block_selector:"[data-nr-block]",mask_input_options:{color:!1,date:!1,"datetime-local":!1,email:!1,month:!1,number:!1,range:!1,search:!1,tel:!1,text:!1,time:!1,url:!1,week:!1,textarea:!1,select:!1,password:!0}};return{ajax:{deny_list:void 0,block_internal:!0,enabled:!0,autoStart:!0},distributed_tracing:{enabled:void 0,exclude_newrelic_header:void 0,cors_use_newrelic_header:void 0,cors_use_tracecontext_headers:void 0,allowed_origins:void 0},get feature_flags(){return e.feature_flags},set feature_flags(t){e.feature_flags=t},generic_events:{enabled:!0,autoStart:!0},harvest:{interval:30},jserrors:{enabled:!0,autoStart:!0},logging:{enabled:!0,autoStart:!0},metrics:{enabled:!0,autoStart:!0},obfuscate:void 0,page_action:{enabled:!0},page_view_event:{enabled:!0,autoStart:!0},page_view_timing:{enabled:!0,autoStart:!0},performance:{get capture_marks(){return e.feature_flags.includes(n)||e.experimental.marks},set capture_marks(t){e.experimental.marks=t},get capture_measures(){return e.feature_flags.includes(i)||e.experimental.measures},set capture_measures(t){e.experimental.measures=t},capture_detail:!0,resources:{get enabled(){return e.feature_flags.includes(o)||e.experimental.resources},set enabled(t){e.experimental.resources=t},asset_types:[],first_party_domains:[],ignore_newrelic:!0}},privacy:{cookies_enabled:!0},proxy:{assets:void 0,beacon:void 0},session:{expiresMs:s.wk,inactiveMs:s.BB},session_replay:{autoStart:!0,enabled:!1,preload:!1,sampling_rate:10,error_sampling_rate:100,collect_fonts:!1,inline_images:!1,fix_stylesheets:!0,mask_all_inputs:!0,get mask_text_selector(){return e.mask_selector},set mask_text_selector(t){a(t)?e.mask_selector="".concat(t,",").concat(d):""===t||null===t?e.mask_selector=d:(0,c.R)(5,t)},get block_class(){return"nr-block"},get ignore_class(){return"nr-ignore"},get mask_text_class(){return"nr-mask"},get block_selector(){return e.block_selector},set block_selector(t){a(t)?e.block_selector+=",".concat(t):""!==t&&(0,c.R)(6,t)},get mask_input_options(){return e.mask_input_options},set mask_input_options(t){t&&"object"==typeof t?e.mask_input_options={...t,password:!0}:(0,c.R)(7,t)}},session_trace:{enabled:!0,autoStart:!0},soft_navigations:{enabled:!0,autoStart:!0},spa:{enabled:!0,autoStart:!0},ssl:void 0,user_actions:{enabled:!0,elementAttributes:["id","className","tagName","type"]}}},g={},p="All configuration objects require an agent identifier!";function m(e){if(!e)throw new Error(p);if(!g[e])throw new Error("Configuration for ".concat(e," was never set"));return g[e]}function h(e,t){if(!e)throw new Error(p);g[e]=(0,l.a)(t,f());const r=(0,u.nY)(e);r&&(r.init=g[e])}function v(e,t){if(!e)throw new Error(p);var r=m(e);if(r){for(var n=t.split("."),i=0;i<n.length-1;i++)if("object"!=typeof(r=r[n[i]]))return;r=r[n[n.length-1]]}return r}},3371:(e,t,r)=>{"use strict";r.d(t,{V:()=>f,f:()=>d});var n=r(8122),i=r(384),o=r(6154),a=r(9324);let s=0;const c={buildEnv:a.F3,distMethod:a.Xs,version:a.xv,originTime:o.WN},u={customTransaction:void 0,disabled:!1,isolatedBacklog:!1,loaderType:void 0,maxBytes:3e4,onerror:void 0,ptid:void 0,releaseIds:{},appMetadata:{},session:void 0,denyList:void 0,timeKeeper:void 0,obfuscator:void 0,harvester:void 0},l={};function d(e){if(!e)throw new Error("All runtime objects require an agent identifier!");if(!l[e])throw new Error("Runtime for ".concat(e," was never set"));return l[e]}function f(e,t){if(!e)throw new Error("All runtime objects require an agent identifier!");l[e]={...(0,n.a)(t,u),...c},Object.hasOwnProperty.call(l[e],"harvestCount")||Object.defineProperty(l[e],"harvestCount",{get:()=>++s});const r=(0,i.nY)(e);r&&(r.runtime=l[e])}},9324:(e,t,r)=>{"use strict";r.d(t,{F3:()=>i,Xs:()=>o,xv:()=>n});const n="1.285.0",i="PROD",o="CDN"},6154:(e,t,r)=>{"use strict";r.d(t,{OF:()=>c,RI:()=>i,WN:()=>l,bv:()=>o,gm:()=>a,mw:()=>s,sb:()=>u});var n=r(1863);const i="undefined"!=typeof window&&!!window.document,o="undefined"!=typeof WorkerGlobalScope&&("undefined"!=typeof self&&self instanceof WorkerGlobalScope&&self.navigator instanceof WorkerNavigator||"undefined"!=typeof globalThis&&globalThis instanceof WorkerGlobalScope&&globalThis.navigator instanceof WorkerNavigator),a=i?window:"undefined"!=typeof WorkerGlobalScope&&("undefined"!=typeof self&&self instanceof WorkerGlobalScope&&self||"undefined"!=typeof globalThis&&globalThis instanceof WorkerGlobalScope&&globalThis),s=Boolean("hidden"===a?.document?.visibilityState),c=/iPad|iPhone|iPod/.test(a.navigator?.userAgent),u=c&&"undefined"==typeof SharedWorker,l=((()=>{const e=a.navigator?.userAgent?.match(/Firefox[/\s](\d+\.\d+)/);Array.isArray(e)&&e.length>=2&&e[1]})(),Date.now()-(0,n.t)())},3241:(e,t,r)=>{"use strict";r.d(t,{W:()=>o});var n=r(6154);const i="newrelic";function o(e={}){try{n.gm.dispatchEvent(new CustomEvent(i,{detail:e}))}catch(e){}}},1687:(e,t,r)=>{"use strict";r.d(t,{Ak:()=>c,Ze:()=>d,x3:()=>u});var n=r(7836),i=r(3606),o=r(860),a=r(2646);const s={};function c(e,t){const r={staged:!1,priority:o.P3[t]||0};l(e),s[e].get(t)||s[e].set(t,r)}function u(e,t){e&&s[e]&&(s[e].get(t)&&s[e].delete(t),g(e,t,!1),s[e].size&&f(e))}function l(e){if(!e)throw new Error("agentIdentifier required");s[e]||(s[e]=new Map)}function d(e="",t="feature",r=!1){if(l(e),!e||!s[e].get(t)||r)return g(e,t);s[e].get(t).staged=!0,f(e)}function f(e){const t=Array.from(s[e]);t.every((([e,t])=>t.staged))&&(t.sort(((e,t)=>e[1].priority-t[1].priority)),t.forEach((([t])=>{s[e].delete(t),g(e,t)})))}function g(e,t,r=!0){const o=e?n.ee.get(e):n.ee,s=i.i.handlers;if(!o.aborted&&o.backlog&&s){if(r){const e=o.backlog[t],r=s[t];if(r){for(let t=0;e&&t<e.length;++t)p(e[t],r);Object.entries(r).forEach((([e,t])=>{Object.values(t||{}).forEach((t=>{t[0]?.on&&t[0]?.context()instanceof a.y&&t[0].on(e,t[1])}))}))}}o.isolatedBacklog||delete s[t],o.backlog[t]=null,o.emit("drain-"+t,[])}}function p(e,t){var r=e[1];Object.values(t[r]||{}).forEach((t=>{var r=e[0];if(t[0]===r){var n=t[1],i=e[3],o=e[2];n.apply(i,o)}}))}},7836:(e,t,r)=>{"use strict";r.d(t,{P:()=>c,ee:()=>u});var n=r(384),i=r(8990),o=r(3371),a=r(2646),s=r(5607);const c="nr@context:".concat(s.W),u=function e(t,r){var n={},s={},l={},d=!1;try{d=16===r.length&&(0,o.f)(r).isolatedBacklog}catch(e){}var f={on:p,addEventListener:p,removeEventListener:function(e,t){var r=n[e];if(!r)return;for(var i=0;i<r.length;i++)r[i]===t&&r.splice(i,1)},emit:function(e,r,n,i,o){!1!==o&&(o=!0);if(u.aborted&&!i)return;t&&o&&t.emit(e,r,n);for(var a=g(n),c=m(e),l=c.length,d=0;d<l;d++)c[d].apply(a,r);var p=v()[s[e]];p&&p.push([f,e,r,a]);return a},get:h,listeners:m,context:g,buffer:function(e,t){const r=v();if(t=t||"feature",f.aborted)return;Object.entries(e||{}).forEach((([e,n])=>{s[n]=t,t in r||(r[t]=[])}))},abort:function(){f._aborted=!0,Object.keys(f.backlog).forEach((e=>{delete f.backlog[e]}))},isBuffering:function(e){return!!v()[s[e]]},debugId:r,backlog:d?{}:t&&"object"==typeof t.backlog?t.backlog:{},isolatedBacklog:d};return Object.defineProperty(f,"aborted",{get:()=>{let e=f._aborted||!1;return e||(t&&(e=t.aborted),e)}}),f;function g(e){return e&&e instanceof a.y?e:e?(0,i.I)(e,c,(()=>new a.y(c))):new a.y(c)}function p(e,t){n[e]=m(e).concat(t)}function m(e){return n[e]||[]}function h(t){return l[t]=l[t]||e(f,t)}function v(){return f.backlog}}(void 0,"globalEE"),l=(0,n.Zm)();l.ee||(l.ee=u)},2646:(e,t,r)=>{"use strict";r.d(t,{y:()=>n});class n{constructor(e){this.contextId=e}}},9908:(e,t,r)=>{"use strict";r.d(t,{d:()=>n,p:()=>i});var n=r(7836).ee.get("handle");function i(e,t,r,i,o){o?(o.buffer([e],i),o.emit(e,t,r)):(n.buffer([e],i),n.emit(e,t,r))}},3606:(e,t,r)=>{"use strict";r.d(t,{i:()=>o});var n=r(9908);o.on=a;var i=o.handlers={};function o(e,t,r,o){a(o||n.d,i,e,t,r)}function a(e,t,r,i,o){o||(o="feature"),e||(e=n.d);var a=t[o]=t[o]||{};(a[r]=a[r]||[]).push([e,i])}},3878:(e,t,r)=>{"use strict";function n(e,t){return{capture:e,passive:!1,signal:t}}function i(e,t,r=!1,i){window.addEventListener(e,t,n(r,i))}function o(e,t,r=!1,i){document.addEventListener(e,t,n(r,i))}r.d(t,{DD:()=>o,jT:()=>n,sp:()=>i})},5607:(e,t,r)=>{"use strict";r.d(t,{W:()=>n});const n=(0,r(9566).bz)()},9566:(e,t,r)=>{"use strict";r.d(t,{LA:()=>s,bz:()=>a});var n=r(6154);const i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";function o(e,t){return e?15&e[t]:16*Math.random()|0}function a(){const e=n.gm?.crypto||n.gm?.msCrypto;let t,r=0;return e&&e.getRandomValues&&(t=e.getRandomValues(new Uint8Array(30))),i.split("").map((e=>"x"===e?o(t,r++).toString(16):"y"===e?(3&o()|8).toString(16):e)).join("")}function s(e){const t=n.gm?.crypto||n.gm?.msCrypto;let r,i=0;t&&t.getRandomValues&&(r=t.getRandomValues(new Uint8Array(e)));const a=[];for(var s=0;s<e;s++)a.push(o(r,i++).toString(16));return a.join("")}},2614:(e,t,r)=>{"use strict";r.d(t,{BB:()=>a,H3:()=>n,g:()=>u,iL:()=>c,tS:()=>s,uh:()=>i,wk:()=>o});const n="NRBA",i="SESSION",o=144e5,a=18e5,s={STARTED:"session-started",PAUSE:"session-pause",RESET:"session-reset",RESUME:"session-resume",UPDATE:"session-update"},c={SAME_TAB:"same-tab",CROSS_TAB:"cross-tab"},u={OFF:0,FULL:1,ERROR:2}},1863:(e,t,r)=>{"use strict";function n(){return Math.floor(performance.now())}r.d(t,{t:()=>n})},944:(e,t,r)=>{"use strict";function n(e,t){"function"==typeof console.debug&&console.debug("New Relic Warning: https://github.com/newrelic/newrelic-browser-agent/blob/main/docs/warning-codes.md#".concat(e),t)}r.d(t,{R:()=>n})},5701:(e,t,r)=>{"use strict";r.d(t,{B:()=>a,t:()=>s});var n=r(7836),i=r(3241);const o=new Set,a={};function s(e,t){const r=n.ee.get(t);a[t]??={},e&&"object"==typeof e&&(o.has(t)||(r.emit("rumresp",[e]),a[t]=e,o.add(t),(0,i.W)({agentIdentifier:t,loaded:!0,type:"lifecycle",name:"load",feature:void 0,data:e})))}},8990:(e,t,r)=>{"use strict";r.d(t,{I:()=>i});var n=Object.prototype.hasOwnProperty;function i(e,t,r){if(n.call(e,t))return e[t];var i=r();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:i,writable:!0,enumerable:!1}),i}catch(e){}return e[t]=i,i}},6389:(e,t,r)=>{"use strict";function n(e,t=500,r={}){const n=r?.leading||!1;let i;return(...r)=>{n&&void 0===i&&(e.apply(this,r),i=setTimeout((()=>{i=clearTimeout(i)}),t)),n||(clearTimeout(i),i=setTimeout((()=>{e.apply(this,r)}),t))}}function i(e){let t=!1;return(...r)=>{t||(t=!0,e.apply(this,r))}}r.d(t,{J:()=>i,s:()=>n})},5289:(e,t,r)=>{"use strict";r.d(t,{GG:()=>o,sB:()=>a});var n=r(3878);function i(){return"undefined"==typeof document||"complete"===document.readyState}function o(e,t){if(i())return e();(0,n.sp)("load",e,t)}function a(e){if(i())return e();(0,n.DD)("DOMContentLoaded",e)}},384:(e,t,r)=>{"use strict";r.d(t,{NT:()=>o,US:()=>l,Zm:()=>a,bQ:()=>c,dV:()=>s,nY:()=>u,pV:()=>d});var n=r(6154),i=r(1863);const o={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net"};function a(){return n.gm.NREUM||(n.gm.NREUM={}),void 0===n.gm.newrelic&&(n.gm.newrelic=n.gm.NREUM),n.gm.NREUM}function s(){let e=a();return e.o||(e.o={ST:n.gm.setTimeout,SI:n.gm.setImmediate,CT:n.gm.clearTimeout,XHR:n.gm.XMLHttpRequest,REQ:n.gm.Request,EV:n.gm.Event,PR:n.gm.Promise,MO:n.gm.MutationObserver,FETCH:n.gm.fetch,WS:n.gm.WebSocket}),e}function c(e,t){let r=a();r.initializedAgents??={},t.initializedAt={ms:(0,i.t)(),date:new Date},r.initializedAgents[e]=t}function u(e){let t=a();return t.initializedAgents?.[e]}function l(e,t){a()[e]=t}function d(){return function(){let e=a();const t=e.info||{};e.info={beacon:o.beacon,errorBeacon:o.errorBeacon,...t}}(),function(){let e=a();const t=e.init||{};e.init={...t}}(),s(),function(){let e=a();const t=e.loader_config||{};e.loader_config={...t}}(),a()}},2843:(e,t,r)=>{"use strict";r.d(t,{u:()=>i});var n=r(3878);function i(e,t=!1,r,i){(0,n.DD)("visibilitychange",(function(){if(t)return void("hidden"===document.visibilityState&&e());e(document.visibilityState)}),r,i)}},3434:(e,t,r)=>{"use strict";r.d(t,{Jt:()=>o,YM:()=>c});var n=r(7836),i=r(5607);const o="nr@original:".concat(i.W);var a=Object.prototype.hasOwnProperty,s=!1;function c(e,t){return e||(e=n.ee),r.inPlace=function(e,t,n,i,o){n||(n="");const a="-"===n.charAt(0);for(let s=0;s<t.length;s++){const c=t[s],u=e[c];l(u)||(e[c]=r(u,a?c+n:n,i,c,o))}},r.flag=o,r;function r(t,r,n,s,c){return l(t)?t:(r||(r=""),nrWrapper[o]=t,function(e,t,r){if(Object.defineProperty&&Object.keys)try{return Object.keys(e).forEach((function(r){Object.defineProperty(t,r,{get:function(){return e[r]},set:function(t){return e[r]=t,t}})})),t}catch(e){u([e],r)}for(var n in e)a.call(e,n)&&(t[n]=e[n])}(t,nrWrapper,e),nrWrapper);function nrWrapper(){var o,a,l,d;try{a=this,o=[...arguments],l="function"==typeof n?n(o,a):n||{}}catch(t){u([t,"",[o,a,s],l],e)}i(r+"start",[o,a,s],l,c);try{return d=t.apply(a,o)}catch(e){throw i(r+"err",[o,a,e],l,c),e}finally{i(r+"end",[o,a,d],l,c)}}}function i(r,n,i,o){if(!s||t){var a=s;s=!0;try{e.emit(r,n,i,t,o)}catch(t){u([t,r,n,i],e)}s=a}}}function u(e,t){t||(t=n.ee);try{t.emit("internal-error",e)}catch(e){}}function l(e){return!(e&&"function"==typeof e&&e.apply&&!e[o])}},993:(e,t,r)=>{"use strict";r.d(t,{A$:()=>o,ET:()=>a,p_:()=>i});var n=r(860);const i={ERROR:"ERROR",WARN:"WARN",INFO:"INFO",DEBUG:"DEBUG",TRACE:"TRACE"},o={OFF:0,ERROR:1,WARN:2,INFO:3,DEBUG:4,TRACE:5},a="log";n.K7.logging},8154:(e,t,r)=>{"use strict";r.d(t,{z_:()=>o,XG:()=>s,TZ:()=>n,rs:()=>i,xV:()=>a});r(6154),r(9566),r(384);const n=r(860).K7.metrics,i="sm",o="cm",a="storeSupportabilityMetrics",s="storeEventMetrics"},6630:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});const n=r(860).K7.pageViewEvent},782:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});const n=r(860).K7.pageViewTiming},6344:(e,t,r)=>{"use strict";r.d(t,{G4:()=>i});var n=r(2614);r(860).K7.sessionReplay;const i={RECORD:"recordReplay",PAUSE:"pauseReplay",REPLAY_RUNNING:"replayRunning",ERROR_DURING_REPLAY:"errorDuringReplay"};n.g.ERROR,n.g.FULL,n.g.OFF},4234:(e,t,r)=>{"use strict";r.d(t,{W:()=>o});var n=r(7836),i=r(1687);class o{constructor(e,t){this.agentIdentifier=e,this.ee=n.ee.get(e),this.featureName=t,this.blocked=!1}deregisterDrain(){(0,i.x3)(this.agentIdentifier,this.featureName)}}},7603:(e,t,r)=>{"use strict";r.d(t,{j:()=>V});var n=r(860),i=r(2555),o=r(3371),a=r(9908),s=r(7836),c=r(1687),u=r(5289),l=r(6154),d=r(944),f=r(8154),g=r(384),p=r(6344);const m=["setErrorHandler","finished","addToTrace","addRelease","recordCustomEvent","addPageAction","setCurrentRouteName","setPageViewName","setCustomAttribute","interaction","noticeError","setUserId","setApplicationVersion","start",p.G4.RECORD,p.G4.PAUSE,"log","wrapLogger"],h=["setErrorHandler","finished","addToTrace","addRelease"];var v=r(1863),b=r(2614),y=r(993);var w=r(2646),R=r(3434);const A=new Map;function E(e,t,r,n){if("object"!=typeof t||!t||"string"!=typeof r||!r||"function"!=typeof t[r])return(0,d.R)(29);const i=function(e){return(e||s.ee).get("logger")}(e),o=(0,R.YM)(i),a=new w.y(s.P);a.level=n.level,a.customAttributes=n.customAttributes;const c=t[r]?.[R.Jt]||t[r];return A.set(c,a),o.inPlace(t,[r],"wrap-logger-",(()=>A.get(c))),i}var _=r(3241),x=r(5701);function N(){const e=(0,g.pV)();m.forEach((t=>{e[t]=(...r)=>function(t,...r){let n=[];return Object.values(e.initializedAgents).forEach((e=>{e&&e.api?e.exposed&&e.api[t]&&n.push(e.api[t](...r)):(0,d.R)(38,t)})),n.length>1?n:n[0]}(t,...r)}))}const k={};function I(e,t,g=!1){t||(0,c.Ak)(e,"api");const m={};var w=s.ee.get(e),R=w.get("tracer");k[e]=b.g.OFF,w.on(p.G4.REPLAY_RUNNING,(t=>{k[e]=t}));var A="api-",N=A+"ixn-";function I(t,r,n,o){const a=(0,i.Vp)(e);return null===r?delete a.jsAttributes[t]:(0,i.x1)(e,{...a,jsAttributes:{...a.jsAttributes,[t]:r}}),S(A,n,!0,o||null===r?"session":void 0)(t,r)}function T(){}m.log=function(e,{customAttributes:t={},level:r=y.p_.INFO}={}){(0,a.p)(f.xV,["API/log/called"],void 0,n.K7.metrics,w),function(e,t,r={},i=y.p_.INFO){(0,a.p)(f.xV,["API/logging/".concat(i.toLowerCase(),"/called")],void 0,n.K7.metrics,e),(0,a.p)(y.ET,[(0,v.t)(),t,r,i],void 0,n.K7.logging,e)}(w,e,t,r)},m.wrapLogger=(e,t,{customAttributes:r={},level:i=y.p_.INFO}={})=>{(0,a.p)(f.xV,["API/wrapLogger/called"],void 0,n.K7.metrics,w),E(w,e,t,{customAttributes:r,level:i})},h.forEach((e=>{m[e]=S(A,e,!0,"api")})),m.addPageAction=S(A,"addPageAction",!0,n.K7.genericEvents),m.recordCustomEvent=S(A,"recordCustomEvent",!0,n.K7.genericEvents),m.setPageViewName=function(t,r){if("string"==typeof t)return"/"!==t.charAt(0)&&(t="/"+t),(0,o.f)(e).customTransaction=(r||"http://custom.transaction")+t,S(A,"setPageViewName",!0)()},m.setCustomAttribute=function(e,t,r=!1){if("string"==typeof e){if(["string","number","boolean"].includes(typeof t)||null===t)return I(e,t,"setCustomAttribute",r);(0,d.R)(40,typeof t)}else(0,d.R)(39,typeof e)},m.setUserId=function(e){if("string"==typeof e||null===e)return I("enduser.id",e,"setUserId",!0);(0,d.R)(41,typeof e)},m.setApplicationVersion=function(e){if("string"==typeof e||null===e)return I("application.version",e,"setApplicationVersion",!1);(0,d.R)(42,typeof e)},m.start=()=>{try{(0,a.p)(f.xV,["API/start/called"],void 0,n.K7.metrics,w),w.emit("manual-start-all")}catch(e){(0,d.R)(23,e)}},m[p.G4.RECORD]=function(){(0,a.p)(f.xV,["API/recordReplay/called"],void 0,n.K7.metrics,w),(0,a.p)(p.G4.RECORD,[],void 0,n.K7.sessionReplay,w)},m[p.G4.PAUSE]=function(){(0,a.p)(f.xV,["API/pauseReplay/called"],void 0,n.K7.metrics,w),(0,a.p)(p.G4.PAUSE,[],void 0,n.K7.sessionReplay,w)},m.interaction=function(e){return(new T).get("object"==typeof e?e:{})};const j=T.prototype={createTracer:function(e,t){var r={},i=this,o="function"==typeof t;return(0,a.p)(f.xV,["API/createTracer/called"],void 0,n.K7.metrics,w),g||(0,a.p)(N+"tracer",[(0,v.t)(),e,r],i,n.K7.spa,w),function(){if(R.emit((o?"":"no-")+"fn-start",[(0,v.t)(),i,o],r),o)try{return t.apply(this,arguments)}catch(e){const t="string"==typeof e?new Error(e):e;throw R.emit("fn-err",[arguments,this,t],r),t}finally{R.emit("fn-end",[(0,v.t)()],r)}}}};function S(t,r,i,o){return function(){return(0,a.p)(f.xV,["API/"+r+"/called"],void 0,n.K7.metrics,w),(0,_.W)({agentIdentifier:e,loaded:!!x.B?.[e],type:"data",name:"api",feature:t+r,data:{notSpa:i,bufferGroup:o}}),o&&(0,a.p)(t+r,[i?(0,v.t)():performance.now(),...arguments],i?null:this,o,w),i?void 0:this}}function O(){r.e(296).then(r.bind(r,8778)).then((({setAPI:t})=>{t(e),(0,c.Ze)(e,"api")})).catch((e=>{(0,d.R)(27,e),w.abort()}))}return["actionText","setName","setAttribute","save","ignore","onEnd","getContext","end","get"].forEach((e=>{j[e]=S(N,e,void 0,g?n.K7.softNav:n.K7.spa)})),m.setCurrentRouteName=g?S(N,"routeName",void 0,n.K7.softNav):S(A,"routeName",!0,n.K7.spa),m.noticeError=function(t,r){"string"==typeof t&&(t=new Error(t)),(0,a.p)(f.xV,["API/noticeError/called"],void 0,n.K7.metrics,w),(0,a.p)("err",[t,(0,v.t)(),!1,r,!!k[e]],void 0,n.K7.jserrors,w)},l.RI?(0,u.GG)((()=>O()),!0):O(),m}var T=r(5217),j=r(8122);const S={accountID:void 0,trustKey:void 0,agentID:void 0,licenseKey:void 0,applicationID:void 0,xpid:void 0},O={};const P=e=>{const t=e.startsWith("http");e+="/",r.p=t?e:"https://"+e};let K=!1;function V(e,t={},r,n){let{init:a,info:c,loader_config:u,runtime:d={},exposed:f=!0}=t;d.loaderType=r;const p=(0,g.pV)();c||(a=p.init,c=p.info,u=p.loader_config),(0,T.xN)(e.agentIdentifier,a||{}),function(e,t){if(!e)throw new Error("All loader-config objects require an agent identifier!");O[e]=(0,j.a)(t,S);const r=(0,g.nY)(e);r&&(r.loader_config=O[e])}(e.agentIdentifier,u||{}),c.jsAttributes??={},l.bv&&(c.jsAttributes.isWorker=!0),(0,i.x1)(e.agentIdentifier,c);const m=(0,T.D0)(e.agentIdentifier),h=[c.beacon,c.errorBeacon];K||(m.proxy.assets&&(P(m.proxy.assets),h.push(m.proxy.assets)),m.proxy.beacon&&h.push(m.proxy.beacon),N(),(0,g.US)("activatedFeatures",x.B),e.runSoftNavOverSpa&&=!0===m.soft_navigations.enabled&&m.feature_flags.includes("soft_nav")),d.denyList=[...m.ajax.deny_list||[],...m.ajax.block_internal?h:[]],d.ptid=e.agentIdentifier,(0,o.V)(e.agentIdentifier,d),e.ee=s.ee.get(e.agentIdentifier),void 0===e.api&&(e.api=I(e.agentIdentifier,n,e.runSoftNavOverSpa)),void 0===e.exposed&&(e.exposed=f),K||(0,_.W)({agentIdentifier:e.agentIdentifier,loaded:!!x.B?.[e.agentIdentifier],type:"lifecycle",name:"initialize",feature:void 0,data:{init:m,info:c,loader_config:u,runtime:d}}),K=!0}},8374:(e,t,r)=>{r.nc=(()=>{try{return document?.currentScript?.nonce}catch(e){}return""})()},860:(e,t,r)=>{"use strict";r.d(t,{$J:()=>l,K7:()=>c,P3:()=>u,XX:()=>i,Yy:()=>s,df:()=>o,qY:()=>n,v4:()=>a});const n="events",i="jserrors",o="browser/blobs",a="rum",s="browser/logs",c={ajax:"ajax",genericEvents:"generic_events",jserrors:i,logging:"logging",metrics:"metrics",pageAction:"page_action",pageViewEvent:"page_view_event",pageViewTiming:"page_view_timing",sessionReplay:"session_replay",sessionTrace:"session_trace",softNav:"soft_navigations",spa:"spa"},u={[c.pageViewEvent]:1,[c.pageViewTiming]:2,[c.metrics]:3,[c.jserrors]:4,[c.spa]:5,[c.ajax]:6,[c.sessionTrace]:7,[c.softNav]:8,[c.sessionReplay]:9,[c.logging]:10,[c.genericEvents]:11},l={[c.pageViewEvent]:a,[c.pageViewTiming]:n,[c.ajax]:n,[c.spa]:n,[c.softNav]:n,[c.metrics]:i,[c.jserrors]:i,[c.sessionTrace]:o,[c.sessionReplay]:o,[c.logging]:s,[c.genericEvents]:"ins"}}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var o=n[e]={exports:{}};return r[e](o,o.exports,i),o.exports}i.m=r,i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,r)=>(i.f[r](e,t),t)),[])),i.u=e=>"nr-rum-1.285.0.min.js",i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="NRBA-1.285.0.PROD:",i.l=(r,n,o,a)=>{if(e[r])e[r].push(n);else{var s,c;if(void 0!==o)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var d=u[l];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+o){s=d;break}}if(!s){c=!0;var f={296:"sha512-Aa+vt/G+VUnXF5imJD27xfBbG00pJRbxEVq24dgn/KfPYsDLKETEMkS7ezrIti3e/7t6va9a0PBrFlxSB0FCeA=="};(s=document.createElement("script")).charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",t+o),s.src=r,0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous"),f[a]&&(s.integrity=f[a])}e[r]=[n];var g=(t,n)=>{s.onerror=s.onload=null,clearTimeout(p);var i=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((e=>e(n))),t)return t(n)},p=setTimeout(g.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=g.bind(null,s.onerror),s.onload=g.bind(null,s.onload),c&&document.head.appendChild(s)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="https://js-agent.newrelic.com/",(()=>{var e={374:0,840:0};i.f.j=(t,r)=>{var n=i.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var o=new Promise(((r,i)=>n=e[t]=[r,i]));r.push(n[2]=o);var a=i.p+i.u(t),s=new Error;i.l(a,(r=>{if(i.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var o=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,n[1](s)}}),"chunk-"+t,t)}};var t=(t,r)=>{var n,o,[a,s,c]=r,u=0;if(a.some((t=>0!==e[t]))){for(n in s)i.o(s,n)&&(i.m[n]=s[n]);if(c)c(i)}for(t&&t(r);u<a.length;u++)o=a[u],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=self["webpackChunk:NRBA-1.285.0.PROD"]=self["webpackChunk:NRBA-1.285.0.PROD"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";i(8374);var e=i(944),t=i(6344),r=i(9566);class n{agentIdentifier;constructor(){this.agentIdentifier=(0,r.LA)(16)}#e(t,...r){if("function"==typeof this.api?.[t])return this.api[t](...r);(0,e.R)(35,t)}addPageAction(e,t){return this.#e("addPageAction",e,t)}recordCustomEvent(e,t){return this.#e("recordCustomEvent",e,t)}setPageViewName(e,t){return this.#e("setPageViewName",e,t)}setCustomAttribute(e,t,r){return this.#e("setCustomAttribute",e,t,r)}noticeError(e,t){return this.#e("noticeError",e,t)}setUserId(e){return this.#e("setUserId",e)}setApplicationVersion(e){return this.#e("setApplicationVersion",e)}setErrorHandler(e){return this.#e("setErrorHandler",e)}addRelease(e,t){return this.#e("addRelease",e,t)}log(e,t){return this.#e("log",e,t)}}class o extends n{#e(t,...r){if("function"==typeof this.api?.[t])return this.api[t](...r);(0,e.R)(35,t)}start(){return this.#e("start")}finished(e){return this.#e("finished",e)}recordReplay(){return this.#e(t.G4.RECORD)}pauseReplay(){return this.#e(t.G4.PAUSE)}addToTrace(e){return this.#e("addToTrace",e)}setCurrentRouteName(e){return this.#e("setCurrentRouteName",e)}interaction(){return this.#e("interaction")}wrapLogger(e,t,r){return this.#e("wrapLogger",e,t,r)}}var a=i(860),s=i(5217);const c=Object.values(a.K7);function u(e){const t={};return c.forEach((r=>{t[r]=function(e,t){return!0===(0,s.gD)(t,"".concat(e,".enabled"))}(r,e)})),t}var l=i(7603);var d=i(1687),f=i(4234),g=i(5289),p=i(6154),m=i(384);const h=e=>p.RI&&!0===(0,s.gD)(e,"privacy.cookies_enabled");function v(e){return!!(0,m.dV)().o.MO&&h(e)&&!0===(0,s.gD)(e,"session_trace.enabled")}var b=i(6389);class y extends f.W{constructor(e,t,r=!0){super(e.agentIdentifier,t),this.auto=r,this.abortHandler=void 0,this.featAggregate=void 0,this.onAggregateImported=void 0,!1===e.init[this.featureName].autoStart&&(this.auto=!1),this.auto?(0,d.Ak)(e.agentIdentifier,t):this.ee.on("manual-start-all",(0,b.J)((()=>{(0,d.Ak)(e.agentIdentifier,this.featureName),this.auto=!0,this.importAggregator(e)})))}importAggregator(t,r={}){if(this.featAggregate||!this.auto)return;let n;this.onAggregateImported=new Promise((e=>{n=e}));const o=async()=>{let o;try{if(h(this.agentIdentifier)){const{setupAgentSession:e}=await i.e(296).then(i.bind(i,3861));o=e(t)}}catch(t){(0,e.R)(20,t),this.ee.emit("internal-error",[t]),this.featureName===a.K7.sessionReplay&&this.abortHandler?.()}try{if(!this.#t(this.featureName,o))return(0,d.Ze)(this.agentIdentifier,this.featureName),void n(!1);const{lazyFeatureLoader:e}=await i.e(296).then(i.bind(i,6103)),{Aggregate:a}=await e(this.featureName,"aggregate");this.featAggregate=new a(t,r),t.runtime.harvester.initializedAggregates.push(this.featAggregate),n(!0)}catch(t){(0,e.R)(34,t),this.abortHandler?.(),(0,d.Ze)(this.agentIdentifier,this.featureName,!0),n(!1),this.ee&&this.ee.abort()}};p.RI?(0,g.GG)((()=>o()),!0):o()}#t(e,t){switch(e){case a.K7.sessionReplay:return v(this.agentIdentifier)&&!!t;case a.K7.sessionTrace:return!!t;default:return!0}}}var w=i(6630);class R extends y{static featureName=w.T;constructor(e,t=!0){super(e,w.T,t),this.importAggregator(e)}}var A=i(9908),E=i(2843),_=i(3878),x=i(782),N=i(1863);class k extends y{static featureName=x.T;constructor(e,t=!0){super(e,x.T,t),p.RI&&((0,E.u)((()=>(0,A.p)("docHidden",[(0,N.t)()],void 0,x.T,this.ee)),!0),(0,_.sp)("pagehide",(()=>(0,A.p)("winPagehide",[(0,N.t)()],void 0,x.T,this.ee))),this.importAggregator(e))}}var I=i(8154);class T extends y{static featureName=I.TZ;constructor(e,t=!0){super(e,I.TZ,t),p.RI&&document.addEventListener("securitypolicyviolation",(e=>{(0,A.p)(I.xV,["Generic/CSPViolation/Detected"],void 0,this.featureName,this.ee)})),this.importAggregator(e)}}new class extends o{constructor(t){super(),p.gm?(this.features={},(0,m.bQ)(this.agentIdentifier,this),this.desiredFeatures=new Set(t.features||[]),this.desiredFeatures.add(R),this.runSoftNavOverSpa=[...this.desiredFeatures].some((e=>e.featureName===a.K7.softNav)),(0,l.j)(this,t,t.loaderType||"agent"),this.run()):(0,e.R)(21)}get config(){return{info:this.info,init:this.init,loader_config:this.loader_config,runtime:this.runtime}}run(){try{const t=u(this.agentIdentifier),r=[...this.desiredFeatures];r.sort(((e,t)=>a.P3[e.featureName]-a.P3[t.featureName])),r.forEach((r=>{if(!t[r.featureName]&&r.featureName!==a.K7.pageViewEvent)return;if(this.runSoftNavOverSpa&&r.featureName===a.K7.spa)return;if(!this.runSoftNavOverSpa&&r.featureName===a.K7.softNav)return;const n=function(e){switch(e){case a.K7.ajax:return[a.K7.jserrors];case a.K7.sessionTrace:return[a.K7.ajax,a.K7.pageViewEvent];case a.K7.sessionReplay:return[a.K7.sessionTrace];case a.K7.pageViewTiming:return[a.K7.pageViewEvent];default:return[]}}(r.featureName).filter((e=>!(e in this.features)));n.length>0&&(0,e.R)(36,{targetFeature:r.featureName,missingDependencies:n}),this.features[r.featureName]=new r(this)}))}catch(t){(0,e.R)(22,t);for(const e in this.features)this.features[e].abortHandler?.();const r=(0,m.Zm)();delete r.initializedAgents[this.agentIdentifier]?.api,delete r.initializedAgents[this.agentIdentifier]?.features,delete this.sharedAggregator;return r.ee.get(this.agentIdentifier).abort(),!1}}}({features:[R,k,T],loaderType:"lite"})})()})();</script>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="profile" href="https://gmpg.org/xfn/11">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        
	<!-- This site is optimized with the Yoast SEO Premium plugin v24.5 (Yoast SEO v24.5) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Hidden Bee: Let&#039;s go down the rabbit hole | Malwarebytes Labs</title>
	<link rel="canonical" href="https://www.malwarebytes.com/blog/news/2019/05/hidden-bee-lets-go-down-the-rabbit-hole" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Hidden Bee: Let&#039;s go down the rabbit hole | Malwarebytes Labs" />
	<meta property="og:description" content="Some time ago, we discussed the interesting malware, Hidden Bee. It is a Chinese miner, composed of userland components, as well..." />
	<meta property="og:url" content="https://www.malwarebytes.com/blog/news/2019/05/hidden-bee-lets-go-down-the-rabbit-hole" />
	<meta property="og:site_name" content="Malwarebytes" />
	<meta property="article:publisher" content="https://www.facebook.com/Malwarebytes" />
	<meta property="article:published_time" content="2019-05-30T17:00:00+00:00" />
	<meta property="og:image" content="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/shutterstock_665631382.jpg" />
	<meta name="author" content="hasherezade" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:title" content="Hidden Bee: Let&#039;s go down the rabbit hole | Malwarebytes Labs" />
	<meta name="twitter:image" content="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/shutterstock_665631382.jpg" />
	<meta name="twitter:creator" content="@hasherezade" />
	<meta name="twitter:site" content="@malwarebytes" />
	<meta name="twitter:label1" content="Written by" />
	<meta name="twitter:data1" content="hasherezade" />
	<meta name="twitter:label2" content="Est. reading time" />
	<meta name="twitter:data2" content="17 minutes" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://www.malwarebytes.com/blog/news/2019/05/hidden-bee-lets-go-down-the-rabbit-hole#article","isPartOf":{"@id":"https://www.malwarebytes.com/blog/news/2019/05/hidden-bee-lets-go-down-the-rabbit-hole"},"author":{"name":"hasherezade","@id":"https://www.malwarebytes.com/#/schema/person/a47a5d3fccd5d03449a4ff9fa55b7a12"},"headline":"Hidden Bee: Let&#8217;s go down the rabbit hole","datePublished":"2019-05-30T17:00:00+00:00","mainEntityOfPage":{"@id":"https://www.malwarebytes.com/blog/news/2019/05/hidden-bee-lets-go-down-the-rabbit-hole"},"wordCount":3352,"commentCount":0,"publisher":{"@id":"https://www.malwarebytes.com/#organization"},"image":{"@id":"https://www.malwarebytes.com/blog/news/2019/05/hidden-bee-lets-go-down-the-rabbit-hole#primaryimage"},"thumbnailUrl":"https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/shutterstock_665631382.jpg","keywords":["exploit kits","exploits","hidden bee","loader","mellifera","reverse engineering","security research","Underminer","Underminer EK"],"articleSection":["News","Threats"],"inLanguage":"en","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://www.malwarebytes.com/blog/news/2019/05/hidden-bee-lets-go-down-the-rabbit-hole#respond"]}]},{"@type":"WebPage","@id":"https://www.malwarebytes.com/blog/news/2019/05/hidden-bee-lets-go-down-the-rabbit-hole","url":"https://www.malwarebytes.com/blog/news/2019/05/hidden-bee-lets-go-down-the-rabbit-hole","name":"Hidden Bee: Let's go down the rabbit hole | Malwarebytes Labs","isPartOf":{"@id":"https://www.malwarebytes.com/#website"},"primaryImageOfPage":{"@id":"https://www.malwarebytes.com/blog/news/2019/05/hidden-bee-lets-go-down-the-rabbit-hole#primaryimage"},"image":{"@id":"https://www.malwarebytes.com/blog/news/2019/05/hidden-bee-lets-go-down-the-rabbit-hole#primaryimage"},"thumbnailUrl":"https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/shutterstock_665631382.jpg","datePublished":"2019-05-30T17:00:00+00:00","breadcrumb":{"@id":"https://www.malwarebytes.com/blog/news/2019/05/hidden-bee-lets-go-down-the-rabbit-hole#breadcrumb"},"inLanguage":"en","potentialAction":[{"@type":"ReadAction","target":["https://www.malwarebytes.com/blog/news/2019/05/hidden-bee-lets-go-down-the-rabbit-hole"]}]},{"@type":"ImageObject","inLanguage":"en","@id":"https://www.malwarebytes.com/blog/news/2019/05/hidden-bee-lets-go-down-the-rabbit-hole#primaryimage","url":"https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/shutterstock_665631382.jpg","contentUrl":"https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/shutterstock_665631382.jpg","width":800,"height":400,"caption":"Hidden Bee: Let's go down the rabbit hole"},{"@type":"BreadcrumbList","@id":"https://www.malwarebytes.com/blog/news/2019/05/hidden-bee-lets-go-down-the-rabbit-hole#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://www.malwarebytes.com/"},{"@type":"ListItem","position":2,"name":"Hidden Bee: Let&#8217;s go down the rabbit hole"}]},{"@type":"WebSite","@id":"https://www.malwarebytes.com/#website","url":"https://www.malwarebytes.com/","name":"Malwarebytes","description":"Cyber Security Software &amp; Anti-Malware","publisher":{"@id":"https://www.malwarebytes.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.malwarebytes.com/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"en"},{"@type":"Organization","@id":"https://www.malwarebytes.com/#organization","name":"Malwarebytes","url":"https://www.malwarebytes.com/","logo":{"@type":"ImageObject","inLanguage":"en","@id":"https://www.malwarebytes.com/#/schema/logo/image/","url":"https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/11/Malwarebytes-logo.png","contentUrl":"https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/11/Malwarebytes-logo.png","width":1200,"height":675,"caption":"Malwarebytes"},"image":{"@id":"https://www.malwarebytes.com/#/schema/logo/image/"},"sameAs":["https://www.facebook.com/Malwarebytes","https://x.com/malwarebytes"]},{"@type":"Person","@id":"https://www.malwarebytes.com/#/schema/person/a47a5d3fccd5d03449a4ff9fa55b7a12","name":"hasherezade","image":{"@type":"ImageObject","inLanguage":"en","@id":"https://www.malwarebytes.com/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/968ef5e76c149013991d9371fc5d37a5?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/968ef5e76c149013991d9371fc5d37a5?s=96&d=mm&r=g","caption":"hasherezade"},"description":"Unpacks malware with as much joy as a kid unpacking candies.","sameAs":["https://x.com/hasherezade"],"jobTitle":"Malware Intelligence Analyst","url":"https://www.malwarebytes.com/blog/authors/hasherezade"}]}</script>
	<meta name="googlebot" content="index, follow" />
	<!-- / Yoast SEO Premium plugin. -->


<link rel='dns-prefetch' href='//stats.wp.com' />
            <!-- Start VWO Async SmartCode -->
            <link rel="preconnect" href="https://dev.visualwebsiteoptimizer.com" />
            <script type='text/javascript' id='vwoCode'>
            window._vwo_code || (function() {
            var account_id=622914,
            version=2.1,
            settings_tolerance=5000,
            hide_element='body',
            hide_element_style = 'opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;transition:none !important;',
            /* DO NOT EDIT BELOW THIS LINE */
            f=false,w=window,d=document,v=d.querySelector('#vwoCode'),cK='_vwo_'+account_id+'_settings',cc={};try{var c=JSON.parse(localStorage.getItem('_vwo_'+account_id+'_config'));cc=c&&typeof c==='object'?c:{}}catch(e){}var stT=cc.stT==='session'?w.sessionStorage:w.localStorage;code={nonce:v&&v.nonce,use_existing_jquery:function(){return typeof use_existing_jquery!=='undefined'?use_existing_jquery:undefined},library_tolerance:function(){return typeof library_tolerance!=='undefined'?library_tolerance:undefined},settings_tolerance:function(){return cc.sT||settings_tolerance},hide_element_style:function(){return'{'+(cc.hES||hide_element_style)+'}'},hide_element:function(){if(performance.getEntriesByName('first-contentful-paint')[0]){return''}return typeof cc.hE==='string'?cc.hE:hide_element},getVersion:function(){return version},finish:function(e){if(!f){f=true;var t=d.getElementById('_vis_opt_path_hides');if(t)t.parentNode.removeChild(t);if(e)(new Image).src='https://dev.visualwebsiteoptimizer.com/ee.gif?a='+account_id+e}},finished:function(){return f},addScript:function(e){var t=d.createElement('script');t.type='text/javascript';if(e.src){t.src=e.src}else{t.text=e.text}v&&t.setAttribute('nonce',v.nonce);d.getElementsByTagName('head')[0].appendChild(t)},load:function(e,t){var n=this.getSettings(),i=d.createElement('script'),r=this;t=t||{};if(n){i.textContent=n;d.getElementsByTagName('head')[0].appendChild(i);if(!w.VWO||VWO.caE){stT.removeItem(cK);r.load(e)}}else{var o=new XMLHttpRequest;o.open('GET',e,true);o.withCredentials=!t.dSC;o.responseType=t.responseType||'text';o.onload=function(){if(t.onloadCb){return t.onloadCb(o,e)}if(o.status===200||o.status===304){_vwo_code.addScript({text:o.responseText})}else{_vwo_code.finish('&e=loading_failure:'+e)}};o.onerror=function(){if(t.onerrorCb){return t.onerrorCb(e)}_vwo_code.finish('&e=loading_failure:'+e)};o.send()}},getSettings:function(){try{var e=stT.getItem(cK);if(!e){return}e=JSON.parse(e);if(Date.now()>e.e){stT.removeItem(cK);return}return e.s}catch(e){return}},init:function(){if(d.URL.indexOf('__vwo_disable__')>-1)return;var e=this.settings_tolerance();w._vwo_settings_timer=setTimeout(function(){_vwo_code.finish();stT.removeItem(cK)},e);var t;if(this.hide_element()!=='body'){t=d.createElement('style');var n=this.hide_element(),i=n?n+this.hide_element_style():'',r=d.getElementsByTagName('head')[0];t.setAttribute('id','_vis_opt_path_hides');v&&t.setAttribute('nonce',v.nonce);t.setAttribute('type','text/css');if(t.styleSheet)t.styleSheet.cssText=i;else t.appendChild(d.createTextNode(i));r.appendChild(t)}else{t=d.getElementsByTagName('head')[0];var i=d.createElement('div');i.style.cssText='z-index: 2147483647 !important;position: fixed !important;left: 0 !important;top: 0 !important;width: 100% !important;height: 100% !important;background: white !important;';i.setAttribute('id','_vis_opt_path_hides');i.classList.add('_vis_hide_layer');t.parentNode.insertBefore(i,t.nextSibling)}var o=window._vis_opt_url||d.URL,s='https://dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(o)+'&vn='+version;if(w.location.search.indexOf('_vwo_xhr')!==-1){this.addScript({src:s})}else{this.load(s+'&x=true')}}};w._vwo_code=code;code.init();})();
            </script>
            <!-- End VWO Async SmartCode -->
            <link rel="pingback" href="https://www.malwarebytes.com/xmlrpc.php"><link rel="preload" href="/wp-content/themes/malwarebytes/assets/build/fonts/RobotoSerif-Medium.a8a104b1.woff2" as="font">
<link rel="preload" href="/wp-content/themes/malwarebytes/assets/build/fonts/RobotoSerif-Medium.00ec4109.woff" as="font">
<link rel="preload" href="/wp-content/themes/malwarebytes/assets/build/fonts/RobotoSerif-Light.725d86a1.woff2" as="font">
<link rel="preload" href="/wp-content/themes/malwarebytes/assets/build/fonts/RobotoSerif-Light.bbcf9d54.woff" as="font">
<link rel="preload" href="/wp-content/themes/malwarebytes/assets/build/fonts/Roboto-Regular.b009a76a.woff2" as="font">
<link rel="preload" href="/wp-content/themes/malwarebytes/assets/build/fonts/Roboto-Regular.f1e2a767.woff" as="font">
<link rel="preload" href="/wp-content/themes/malwarebytes/assets/build/fonts/Roboto-Bold.227c9319.woff2" as="font">
<link rel="preload" href="/wp-content/themes/malwarebytes/assets/build/fonts/Roboto-Bold.77ecb942.woff" as="font">
<link rel="preload" href="/wp-content/themes/malwarebytes/assets/build/fonts/Roboto-Black.2e8becfc.woff2" as="font">
<link rel="preload" href="/wp-content/themes/malwarebytes/assets/build/fonts/Roboto-Black.f5677eb2.woff" as="font">
<link rel="preload" href="/wp-content/themes/malwarebytes/assets/build/images/shape-challenger-2.307bef30.png" as="image">
<link rel="preload" href="/wp-content/themes/malwarebytes/assets/build/images/ajax-loader.6f9ac78c.gif" as="image">
<link rel="preload" href="/wp-content/themes/malwarebytes/assets/build/images/app-play.5ed26b30.png" as="image">
<link rel="preload" href="/wp-content/themes/malwarebytes/assets/build/images/app-store.0d6e625d.png" as="image">
<style id='wp-block-library-inline-css'>
:root{--wp-admin-theme-color:#007cba;--wp-admin-theme-color--rgb:0,124,186;--wp-admin-theme-color-darker-10:#006ba1;--wp-admin-theme-color-darker-10--rgb:0,107,161;--wp-admin-theme-color-darker-20:#005a87;--wp-admin-theme-color-darker-20--rgb:0,90,135;--wp-admin-border-width-focus:2px;--wp-block-synced-color:#7a00df;--wp-block-synced-color--rgb:122,0,223;--wp-bound-block-color:var(--wp-block-synced-color)}@media (min-resolution:192dpi){:root{--wp-admin-border-width-focus:1.5px}}.wp-element-button{cursor:pointer}:root{--wp--preset--font-size--normal:16px;--wp--preset--font-size--huge:42px}:root .has-very-light-gray-background-color{background-color:#eee}:root .has-very-dark-gray-background-color{background-color:#313131}:root .has-very-light-gray-color{color:#eee}:root .has-very-dark-gray-color{color:#313131}:root .has-vivid-green-cyan-to-vivid-cyan-blue-gradient-background{background:linear-gradient(135deg,#00d084,#0693e3)}:root .has-purple-crush-gradient-background{background:linear-gradient(135deg,#34e2e4,#4721fb 50%,#ab1dfe)}:root .has-hazy-dawn-gradient-background{background:linear-gradient(135deg,#faaca8,#dad0ec)}:root .has-subdued-olive-gradient-background{background:linear-gradient(135deg,#fafae1,#67a671)}:root .has-atomic-cream-gradient-background{background:linear-gradient(135deg,#fdd79a,#004a59)}:root .has-nightshade-gradient-background{background:linear-gradient(135deg,#330968,#31cdcf)}:root .has-midnight-gradient-background{background:linear-gradient(135deg,#020381,#2874fc)}.has-regular-font-size{font-size:1em}.has-larger-font-size{font-size:2.625em}.has-normal-font-size{font-size:var(--wp--preset--font-size--normal)}.has-huge-font-size{font-size:var(--wp--preset--font-size--huge)}.has-text-align-center{text-align:center}.has-text-align-left{text-align:left}.has-text-align-right{text-align:right}#end-resizable-editor-section{display:none}.aligncenter{clear:both}.items-justified-left{justify-content:flex-start}.items-justified-center{justify-content:center}.items-justified-right{justify-content:flex-end}.items-justified-space-between{justify-content:space-between}.screen-reader-text{border:0;clip:rect(1px,1px,1px,1px);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;word-wrap:normal!important}.screen-reader-text:focus{background-color:#ddd;clip:auto!important;clip-path:none;color:#444;display:block;font-size:1em;height:auto;left:5px;line-height:normal;padding:15px 23px 14px;text-decoration:none;top:5px;width:auto;z-index:100000}html :where(.has-border-color){border-style:solid}html :where([style*=border-top-color]){border-top-style:solid}html :where([style*=border-right-color]){border-right-style:solid}html :where([style*=border-bottom-color]){border-bottom-style:solid}html :where([style*=border-left-color]){border-left-style:solid}html :where([style*=border-width]){border-style:solid}html :where([style*=border-top-width]){border-top-style:solid}html :where([style*=border-right-width]){border-right-style:solid}html :where([style*=border-bottom-width]){border-bottom-style:solid}html :where([style*=border-left-width]){border-left-style:solid}html :where(img[class*=wp-image-]){height:auto;max-width:100%}:where(figure){margin:0 0 1em}html :where(.is-position-sticky){--wp-admin--admin-bar--position-offset:var(--wp-admin--admin-bar--height,0px)}@media screen and (max-width:600px){html :where(.is-position-sticky){--wp-admin--admin-bar--position-offset:0px}}
</style>
<style id='wp-block-heading-inline-css'>
h1.has-background,h2.has-background,h3.has-background,h4.has-background,h5.has-background,h6.has-background{padding:1.25em 2.375em}h1.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h1.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h2.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h2.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h3.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h3.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h4.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h4.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h5.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h5.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h6.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h6.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]){rotate:180deg}
</style>
<style id='wp-block-image-inline-css'>
.wp-block-image a{display:inline-block}.wp-block-image img{box-sizing:border-box;height:auto;max-width:100%;vertical-align:bottom}@media (prefers-reduced-motion:no-preference){.wp-block-image img.hide{visibility:hidden}.wp-block-image img.show{animation:show-content-image .4s}}.wp-block-image[style*=border-radius] img,.wp-block-image[style*=border-radius]>a{border-radius:inherit}.wp-block-image.has-custom-border img{box-sizing:border-box}.wp-block-image.aligncenter{text-align:center}.wp-block-image.alignfull a,.wp-block-image.alignwide a{width:100%}.wp-block-image.alignfull img,.wp-block-image.alignwide img{height:auto;width:100%}.wp-block-image .aligncenter,.wp-block-image .alignleft,.wp-block-image .alignright,.wp-block-image.aligncenter,.wp-block-image.alignleft,.wp-block-image.alignright{display:table}.wp-block-image .aligncenter>figcaption,.wp-block-image .alignleft>figcaption,.wp-block-image .alignright>figcaption,.wp-block-image.aligncenter>figcaption,.wp-block-image.alignleft>figcaption,.wp-block-image.alignright>figcaption{caption-side:bottom;display:table-caption}.wp-block-image .alignleft{float:left;margin:.5em 1em .5em 0}.wp-block-image .alignright{float:right;margin:.5em 0 .5em 1em}.wp-block-image .aligncenter{margin-left:auto;margin-right:auto}.wp-block-image :where(figcaption){margin-bottom:1em;margin-top:.5em}.wp-block-image.is-style-circle-mask img{border-radius:9999px}@supports ((-webkit-mask-image:none) or (mask-image:none)) or (-webkit-mask-image:none){.wp-block-image.is-style-circle-mask img{border-radius:0;-webkit-mask-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="50"/></svg>');mask-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="50"/></svg>');mask-mode:alpha;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:contain;mask-size:contain}}:root :where(.wp-block-image.is-style-rounded img,.wp-block-image .is-style-rounded img){border-radius:9999px}.wp-block-image figure{margin:0}.wp-lightbox-container{display:flex;flex-direction:column;position:relative}.wp-lightbox-container img{cursor:zoom-in}.wp-lightbox-container img:hover+button{opacity:1}.wp-lightbox-container button{align-items:center;-webkit-backdrop-filter:blur(16px) saturate(180%);backdrop-filter:blur(16px) saturate(180%);background-color:#5a5a5a40;border:none;border-radius:4px;cursor:zoom-in;display:flex;height:20px;justify-content:center;opacity:0;padding:0;position:absolute;right:16px;text-align:center;top:16px;transition:opacity .2s ease;width:20px;z-index:100}.wp-lightbox-container button:focus-visible{outline:3px auto #5a5a5a40;outline:3px auto -webkit-focus-ring-color;outline-offset:3px}.wp-lightbox-container button:hover{cursor:pointer;opacity:1}.wp-lightbox-container button:focus{opacity:1}.wp-lightbox-container button:focus,.wp-lightbox-container button:hover,.wp-lightbox-container button:not(:hover):not(:active):not(.has-background){background-color:#5a5a5a40;border:none}.wp-lightbox-overlay{box-sizing:border-box;cursor:zoom-out;height:100vh;left:0;overflow:hidden;position:fixed;top:0;visibility:hidden;width:100%;z-index:100000}.wp-lightbox-overlay .close-button{align-items:center;cursor:pointer;display:flex;justify-content:center;min-height:40px;min-width:40px;padding:0;position:absolute;right:calc(env(safe-area-inset-right) + 16px);top:calc(env(safe-area-inset-top) + 16px);z-index:5000000}.wp-lightbox-overlay .close-button:focus,.wp-lightbox-overlay .close-button:hover,.wp-lightbox-overlay .close-button:not(:hover):not(:active):not(.has-background){background:none;border:none}.wp-lightbox-overlay .lightbox-image-container{height:var(--wp--lightbox-container-height);left:50%;overflow:hidden;position:absolute;top:50%;transform:translate(-50%,-50%);transform-origin:top left;width:var(--wp--lightbox-container-width);z-index:9999999999}.wp-lightbox-overlay .wp-block-image{align-items:center;box-sizing:border-box;display:flex;height:100%;justify-content:center;margin:0;position:relative;transform-origin:0 0;width:100%;z-index:3000000}.wp-lightbox-overlay .wp-block-image img{height:var(--wp--lightbox-image-height);min-height:var(--wp--lightbox-image-height);min-width:var(--wp--lightbox-image-width);width:var(--wp--lightbox-image-width)}.wp-lightbox-overlay .wp-block-image figcaption{display:none}.wp-lightbox-overlay button{background:none;border:none}.wp-lightbox-overlay .scrim{background-color:#fff;height:100%;opacity:.9;position:absolute;width:100%;z-index:2000000}.wp-lightbox-overlay.active{animation:turn-on-visibility .25s both;visibility:visible}.wp-lightbox-overlay.active img{animation:turn-on-visibility .35s both}.wp-lightbox-overlay.show-closing-animation:not(.active){animation:turn-off-visibility .35s both}.wp-lightbox-overlay.show-closing-animation:not(.active) img{animation:turn-off-visibility .25s both}@media (prefers-reduced-motion:no-preference){.wp-lightbox-overlay.zoom.active{animation:none;opacity:1;visibility:visible}.wp-lightbox-overlay.zoom.active .lightbox-image-container{animation:lightbox-zoom-in .4s}.wp-lightbox-overlay.zoom.active .lightbox-image-container img{animation:none}.wp-lightbox-overlay.zoom.active .scrim{animation:turn-on-visibility .4s forwards}.wp-lightbox-overlay.zoom.show-closing-animation:not(.active){animation:none}.wp-lightbox-overlay.zoom.show-closing-animation:not(.active) .lightbox-image-container{animation:lightbox-zoom-out .4s}.wp-lightbox-overlay.zoom.show-closing-animation:not(.active) .lightbox-image-container img{animation:none}.wp-lightbox-overlay.zoom.show-closing-animation:not(.active) .scrim{animation:turn-off-visibility .4s forwards}}@keyframes show-content-image{0%{visibility:hidden}99%{visibility:hidden}to{visibility:visible}}@keyframes turn-on-visibility{0%{opacity:0}to{opacity:1}}@keyframes turn-off-visibility{0%{opacity:1;visibility:visible}99%{opacity:0;visibility:visible}to{opacity:0;visibility:hidden}}@keyframes lightbox-zoom-in{0%{transform:translate(calc((-100vw + var(--wp--lightbox-scrollbar-width))/2 + var(--wp--lightbox-initial-left-position)),calc(-50vh + var(--wp--lightbox-initial-top-position))) scale(var(--wp--lightbox-scale))}to{transform:translate(-50%,-50%) scale(1)}}@keyframes lightbox-zoom-out{0%{transform:translate(-50%,-50%) scale(1);visibility:visible}99%{visibility:visible}to{transform:translate(calc((-100vw + var(--wp--lightbox-scrollbar-width))/2 + var(--wp--lightbox-initial-left-position)),calc(-50vh + var(--wp--lightbox-initial-top-position))) scale(var(--wp--lightbox-scale));visibility:hidden}}
</style>
<style id='wp-block-image-theme-inline-css'>
:root :where(.wp-block-image figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme :root :where(.wp-block-image figcaption){color:#ffffffa6}.wp-block-image{margin:0 0 1em}
</style>
<style id='wp-block-list-inline-css'>
ol,ul{box-sizing:border-box}:root :where(.wp-block-list.has-background){padding:1.25em 2.375em}
</style>
<style id='wp-block-embed-inline-css'>
.wp-block-embed.alignleft,.wp-block-embed.alignright,.wp-block[data-align=left]>[data-type="core/embed"],.wp-block[data-align=right]>[data-type="core/embed"]{max-width:360px;width:100%}.wp-block-embed.alignleft .wp-block-embed__wrapper,.wp-block-embed.alignright .wp-block-embed__wrapper,.wp-block[data-align=left]>[data-type="core/embed"] .wp-block-embed__wrapper,.wp-block[data-align=right]>[data-type="core/embed"] .wp-block-embed__wrapper{min-width:280px}.wp-block-cover .wp-block-embed{min-height:240px;min-width:320px}.wp-block-embed{overflow-wrap:break-word}.wp-block-embed :where(figcaption){margin-bottom:1em;margin-top:.5em}.wp-block-embed iframe{max-width:100%}.wp-block-embed__wrapper{position:relative}.wp-embed-responsive .wp-has-aspect-ratio .wp-block-embed__wrapper:before{content:"";display:block;padding-top:50%}.wp-embed-responsive .wp-has-aspect-ratio iframe{bottom:0;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.wp-embed-responsive .wp-embed-aspect-21-9 .wp-block-embed__wrapper:before{padding-top:42.85%}.wp-embed-responsive .wp-embed-aspect-18-9 .wp-block-embed__wrapper:before{padding-top:50%}.wp-embed-responsive .wp-embed-aspect-16-9 .wp-block-embed__wrapper:before{padding-top:56.25%}.wp-embed-responsive .wp-embed-aspect-4-3 .wp-block-embed__wrapper:before{padding-top:75%}.wp-embed-responsive .wp-embed-aspect-1-1 .wp-block-embed__wrapper:before{padding-top:100%}.wp-embed-responsive .wp-embed-aspect-9-16 .wp-block-embed__wrapper:before{padding-top:177.77%}.wp-embed-responsive .wp-embed-aspect-1-2 .wp-block-embed__wrapper:before{padding-top:200%}
</style>
<style id='wp-block-embed-theme-inline-css'>
.wp-block-embed :where(figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-embed :where(figcaption){color:#ffffffa6}.wp-block-embed{margin:0 0 1em}
</style>
<style id='wp-block-paragraph-inline-css'>
.is-small-text{font-size:.875em}.is-regular-text{font-size:1em}.is-large-text{font-size:2.25em}.is-larger-text{font-size:3em}.has-drop-cap:not(:focus):first-letter{float:left;font-size:8.4em;font-style:normal;font-weight:100;line-height:.68;margin:.05em .1em 0 0;text-transform:uppercase}body.rtl .has-drop-cap:not(:focus):first-letter{float:none;margin-left:.1em}p.has-drop-cap.has-background{overflow:hidden}:root :where(p.has-background){padding:1.25em 2.375em}:where(p.has-text-color:not(.has-link-color)) a{color:inherit}p.has-text-align-left[style*="writing-mode:vertical-lr"],p.has-text-align-right[style*="writing-mode:vertical-rl"]{rotate:180deg}
</style>
<style id='wp-block-preformatted-inline-css'>
.wp-block-preformatted{box-sizing:border-box;white-space:pre-wrap}:where(.wp-block-preformatted.has-background){padding:1.25em 2.375em}
</style>
<link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href='https://www.malwarebytes.com/_static/??-eJyFjEEKwzAMBD9URyTE5BT6FtdVhECRRaxg+vua9NJDobdlZ2ehWchFHdXB5CTWCoTF00HorNQM7HwIZ8j1i4RPOeysQwc3+HHTkKQ4PLn6JW9HH4Se/hnJDKq/BCsotrBJosu57+u4zNM8xhinN81IROQ=' type='text/css' media='all' />
<noscript><link rel='stylesheet' href='https://www.malwarebytes.com/_static/??-eJyFjEEKwzAMBD9URyTE5BT6FtdVhECRRaxg+vua9NJDobdlZ2ehWchFHdXB5CTWCoTF00HorNQM7HwIZ8j1i4RPOeysQwc3+HHTkKQ4PLn6JW9HH4Se/hnJDKq/BCsotrBJosu57+u4zNM8xhinN81IROQ='>
</noscript><style id='custom-flag-handle-inline-css'>
.weglot-flags.flag-0.en>a:before,.weglot-flags.flag-0.en>span:before {background-image: url(https://cdn.weglot.com/flags/rectangle_mat/us.svg); }.weglot-flags.flag-1.en>a:before,.weglot-flags.flag-1.en>span:before {background-image: url(https://cdn.weglot.com/flags/shiny/us.svg); }.weglot-flags.flag-2.en>a:before,.weglot-flags.flag-2.en>span:before {background-image: url(https://cdn.weglot.com/flags/square/us.svg); }.weglot-flags.flag-3.en>a:before,.weglot-flags.flag-3.en>span:before {background-image: url(https://cdn.weglot.com/flags/circle/us.svg); }
</style>
<link rel='stylesheet' id='base-fonts-style-css' href='https://www.malwarebytes.com/wp-content/themes/malwarebytes/assets/build/base-fonts.css?ver=1742425296' media='all' />
<link rel='stylesheet' id='base-blog-style-css' href='https://www.malwarebytes.com/wp-content/themes/malwarebytes/assets/build/base-blog.css?ver=1742425296' media='all' />
<link rel='stylesheet' id='base-css-css' href='https://www.malwarebytes.com/wp-content/themes/malwarebytes/assets/build/base.css?ver=1.0' media='all' />
<link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href='https://www.malwarebytes.com/wp-content/themes/malwarebytes/assets/library/css/font-awesome.min.css?m=1742415553g' type='text/css' media='all' />
<noscript><link rel='stylesheet' href='https://www.malwarebytes.com/wp-content/themes/malwarebytes/assets/library/css/font-awesome.min.css?m=1742415553g'>
</noscript><style id='kadence-blocks-global-variables-inline-css'>
:root {--global-kb-font-size-sm:clamp(0.8rem, 0.73rem + 0.217vw, 0.9rem);--global-kb-font-size-md:clamp(1.1rem, 0.995rem + 0.326vw, 1.25rem);--global-kb-font-size-lg:clamp(1.75rem, 1.576rem + 0.543vw, 2rem);--global-kb-font-size-xl:clamp(2.25rem, 1.728rem + 1.63vw, 3rem);--global-kb-font-size-xxl:clamp(2.5rem, 1.456rem + 3.26vw, 4rem);--global-kb-font-size-xxxl:clamp(2.75rem, 0.489rem + 7.065vw, 6rem);}:root {--global-palette1: #3182CE;--global-palette2: #2B6CB0;--global-palette3: #1A202C;--global-palette4: #2D3748;--global-palette5: #4A5568;--global-palette6: #718096;--global-palette7: #EDF2F7;--global-palette8: #F7FAFC;--global-palette9: #ffffff;}
</style>
<script type="text/javascript" src="https://www.malwarebytes.com/wp-content/plugins/weglot/dist/front-js.js?m=1742415552g" ></script><link rel="https://api.w.org/" href="https://www.malwarebytes.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://www.malwarebytes.com/wp-json/wp/v2/posts/65729" /><link rel='shortlink' href='https://www.malwarebytes.com/?p=65729' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://www.malwarebytes.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.malwarebytes.com%2Fblog%2Fnews%2F2019%2F05%2Fhidden-bee-lets-go-down-the-rabbit-hole" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://www.malwarebytes.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.malwarebytes.com%2Fblog%2Fnews%2F2019%2F05%2Fhidden-bee-lets-go-down-the-rabbit-hole&#038;format=xml" />
	<style>img#wpstats{display:none}</style>
		
<script type="application/json" id="weglot-data">{"website":"https:\/\/www.malwarebytes.com","uid":"d49bb2be6f","project_slug":"figs","language_from":"en","language_from_custom_flag":"us","language_from_custom_name":null,"excluded_paths":[{"type":"CONTAIN","value":"\/accessibility","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"\/accessibility"},{"type":"CONTAIN","value":"\/beta","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"\/beta"},{"type":"CONTAIN","value":"\/blog","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"\/blog"},{"type":"CONTAIN","value":"\/academy","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"\/academy"},{"type":"CONTAIN","value":"\/copyright","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"\/copyright"},{"type":"CONTAIN","value":"\/eula","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"\/eula"},{"type":"CONTAIN","value":"\/gdpr-commitment","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"\/gdpr\\-commitment"},{"type":"CONTAIN","value":"\/impressum","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":["es","fr","it","nl","pl","ru","br"],"regex":"\/impressum"},{"type":"CONTAIN","value":"\/jp","language_button_displayed":true,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"\/jp"},{"type":"CONTAIN","value":"\/legal","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"\/legal"},{"type":"CONTAIN","value":"\/lp\/sem","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"\/lp\/sem"},{"type":"CONTAIN","value":"\/secure","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"\/secure"},{"type":"CONTAIN","value":"\/tos","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"\/tos"},{"type":"CONTAIN","value":"yandex_2591bba93ba202da.html","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"yandex_2591bba93ba202da\\.html"},{"type":"START_WITH","value":"\/robots.txt","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/robots\\.txt"},{"type":"START_WITH","value":"\/cybersecurity\/business","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/cybersecurity\/business"},{"type":"START_WITH","value":"\/business","language_button_displayed":false,"exclusion_behavior":"NOT_TRANSLATED","excluded_languages":[],"regex":"^\/business"},{"type":"START_WITH","value":"\/resources","language_button_displayed":false,"exclusion_behavior":"NOT_TRANSLATED","excluded_languages":[],"regex":"^\/resources"},{"type":"END_WITH","value":"\/privacy\/ccpa","language_button_displayed":false,"exclusion_behavior":"NOT_TRANSLATED","excluded_languages":[],"regex":"\/privacy\/ccpa$"},{"type":"MATCH_REGEX","value":"^\\\/digital-footprint\\\/?$","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\\\/digital-footprint\\\/?$"},{"type":"START_WITH","value":"\/jobs","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/jobs"},{"type":"START_WITH","value":"\/press","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/press"},{"type":"START_WITH","value":"\/techbench\/licensing","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/techbench\/licensing"},{"type":"START_WITH","value":"\/author","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/author"},{"type":"START_WITH","value":"\/pdf","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/pdf"},{"type":"START_WITH","value":"\/api","language_button_displayed":false,"exclusion_behavior":"NOT_TRANSLATED","excluded_languages":[],"regex":"^\/api"},{"type":"START_WITH","value":"\/support\/thirdpartynotices","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/support\/thirdpartynotices"},{"type":"START_WITH","value":"\/wp-json\/wp\/v2\/posts","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/wp\\-json\/wp\/v2\/posts"},{"type":"START_WITH","value":"\/wp-json\/wp\/v2\/categories","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/wp\\-json\/wp\/v2\/categories"},{"type":"START_WITH","value":"\/wp-json\/wp\/v2\/detection-type","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/wp\\-json\/wp\/v2\/detection\\-type"},{"type":"START_WITH","value":"\/wp-json\/wp\/v2\/taxonomies","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/wp\\-json\/wp\/v2\/taxonomies"},{"type":"START_WITH","value":"\/wp-json\/wp\/v2\/threat-type","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/wp\\-json\/wp\/v2\/threat\\-type"},{"type":"START_WITH","value":"\/wp-json\/wp\/v2\/pages","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/wp\\-json\/wp\/v2\/pages"},{"type":"START_WITH","value":"\/personal-data-remover","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/personal\\-data\\-remover"},{"type":"START_WITH","value":"\/wp-json\/oembed\/1.0\/embed","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/wp\\-json\/oembed\/1\\.0\/embed"},{"type":"START_WITH","value":"\/glossary","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/glossary"},{"type":"START_WITH","value":"\/resource","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/resource"},{"type":"START_WITH","value":"\/page\/","language_button_displayed":false,"exclusion_behavior":"NOT_TRANSLATED","excluded_languages":[],"regex":"^\/page\/"},{"type":"START_WITH","value":"\/wp-json\/wp\/v2\/detections\/","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/wp\\-json\/wp\/v2\/detections\/"},{"type":"START_WITH","value":"\/search\/","language_button_displayed":false,"exclusion_behavior":"NOT_TRANSLATED","excluded_languages":[],"regex":"^\/search\/"},{"type":"IS_EXACTLY","value":"\/privacy\/data-subject-access-request-form","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/privacy\/data\\-subject\\-access\\-request\\-form$"},{"type":"IS_EXACTLY","value":"\/privacy\/ccpa","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/privacy\/ccpa$"},{"type":"IS_EXACTLY","value":"\/privacy\/policy-for-browser-guard","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/privacy\/policy\\-for\\-browser\\-guard$"},{"type":"START_WITH","value":"\/wp-json\/wp\/v2\/glossary","language_button_displayed":false,"exclusion_behavior":"REDIRECT","excluded_languages":[],"regex":"^\/wp\\-json\/wp\/v2\/glossary"}],"excluded_blocks":[{"value":".mwb-product-info_product-price","description":"Product Pricing"},{"value":".mwb-product-info_product-price_purchase-price","description":"Product Purchase Price"},{"value":".mwb-product-info_product-price_list-price","description":"Product List Price"},{"value":"span[data-component=\"mwb-product-info_product-price\"]","description":"variables"}],"custom_settings":{"button_style":{"is_dropdown":true,"with_flags":true,"flag_type":"rectangle_mat","with_name":true,"full_name":true,"custom_css":""},"wp_user_version":"4.3.1","translate_email":false,"translate_search":false,"translate_amp":false,"switchers":[{"templates":{"name":"default","hash":"2235a3ca93d6ea941d131f6fcb4f5ed7fd2f4ec8"},"location":[],"style":{"with_flags":true,"flag_type":"rectangle_mat","with_name":true,"full_name":true,"is_dropdown":true}}]},"pending_translation_enabled":false,"curl_ssl_check_enabled":true,"custom_css":null,"languages":[{"language_to":"de","custom_code":null,"custom_name":null,"custom_local_name":null,"provider":null,"enabled":true,"automatic_translation_enabled":true,"deleted_at":null,"connect_host_destination":null,"custom_flag":null},{"language_to":"es","custom_code":null,"custom_name":null,"custom_local_name":null,"provider":null,"enabled":true,"automatic_translation_enabled":true,"deleted_at":null,"connect_host_destination":null,"custom_flag":null},{"language_to":"fr","custom_code":null,"custom_name":null,"custom_local_name":null,"provider":null,"enabled":true,"automatic_translation_enabled":true,"deleted_at":null,"connect_host_destination":null,"custom_flag":null},{"language_to":"it","custom_code":null,"custom_name":null,"custom_local_name":null,"provider":null,"enabled":true,"automatic_translation_enabled":true,"deleted_at":null,"connect_host_destination":null,"custom_flag":null},{"language_to":"nl","custom_code":null,"custom_name":null,"custom_local_name":null,"provider":null,"enabled":true,"automatic_translation_enabled":true,"deleted_at":null,"connect_host_destination":null,"custom_flag":null},{"language_to":"pl","custom_code":null,"custom_name":null,"custom_local_name":null,"provider":null,"enabled":true,"automatic_translation_enabled":true,"deleted_at":null,"connect_host_destination":null,"custom_flag":null},{"language_to":"pt","custom_code":null,"custom_name":null,"custom_local_name":null,"provider":null,"enabled":true,"automatic_translation_enabled":true,"deleted_at":null,"connect_host_destination":null,"custom_flag":null},{"language_to":"br","custom_code":null,"custom_name":null,"custom_local_name":null,"provider":null,"enabled":true,"automatic_translation_enabled":true,"deleted_at":null,"connect_host_destination":null,"custom_flag":null},{"language_to":"ru","custom_code":null,"custom_name":null,"custom_local_name":null,"provider":null,"enabled":true,"automatic_translation_enabled":true,"deleted_at":null,"connect_host_destination":null,"custom_flag":null}],"organization_slug":"w-85925e1a76","current_language":"en","switcher_links":{"en":"https:\/\/www.malwarebytes.com\/blog\/news\/2019\/05\/hidden-bee-lets-go-down-the-rabbit-hole?wg-choose-original=true","de":"https:\/\/www.malwarebytes.com\/de\/blog\/news\/2019\/05\/hidden-bee-lets-go-down-the-rabbit-hole?wg-choose-original=false","es":"https:\/\/www.malwarebytes.com\/es\/blog\/news\/2019\/05\/hidden-bee-lets-go-down-the-rabbit-hole?wg-choose-original=false","fr":"https:\/\/www.malwarebytes.com\/fr\/blog\/news\/2019\/05\/hidden-bee-lets-go-down-the-rabbit-hole?wg-choose-original=false","it":"https:\/\/www.malwarebytes.com\/it\/blog\/news\/2019\/05\/hidden-bee-lets-go-down-the-rabbit-hole?wg-choose-original=false","nl":"https:\/\/www.malwarebytes.com\/nl\/blog\/news\/2019\/05\/hidden-bee-lets-go-down-the-rabbit-hole?wg-choose-original=false","pl":"https:\/\/www.malwarebytes.com\/pl\/blog\/news\/2019\/05\/hidden-bee-lets-go-down-the-rabbit-hole?wg-choose-original=false","pt":"https:\/\/www.malwarebytes.com\/pt\/blog\/news\/2019\/05\/hidden-bee-lets-go-down-the-rabbit-hole?wg-choose-original=false","br":"https:\/\/www.malwarebytes.com\/pt-br\/blog\/news\/2019\/05\/hidden-bee-lets-go-down-the-rabbit-hole?wg-choose-original=false","ru":"https:\/\/www.malwarebytes.com\/ru\/blog\/news\/2019\/05\/hidden-bee-lets-go-down-the-rabbit-hole?wg-choose-original=false"},"original_path":"\/blog\/news\/2019\/05\/hidden-bee-lets-go-down-the-rabbit-hole"}</script><link rel="icon" href="https://www.malwarebytes.com/wp-content/uploads/sites/2/2025/01/malwarebytes-favicon-apple-touch-icon.png?w=32" sizes="32x32" />
<link rel="icon" href="https://www.malwarebytes.com/wp-content/uploads/sites/2/2025/01/malwarebytes-favicon-apple-touch-icon.png?w=180" sizes="192x192" />
<link rel="apple-touch-icon" href="https://www.malwarebytes.com/wp-content/uploads/sites/2/2025/01/malwarebytes-favicon-apple-touch-icon.png?w=180" />
<meta name="msapplication-TileImage" content="https://www.malwarebytes.com/wp-content/uploads/sites/2/2025/01/malwarebytes-favicon-apple-touch-icon.png?w=180" />
		<style id="wp-custom-css">
			@media (min-width: 1150px) {
	.site-header.mb-header-pricing .site-header__nav ul.primary-menu > li:not(:nth-child(3)) .megamenu-wrap {
  	transform: translate(-42%, -200%);
	}
	.site-header.mb-header-pricing .site-header__nav ul.primary-menu > li:not(:nth-child(3)).active .megamenu-wrap {
  	transform: translate(-42%, 0);
	}
}		</style>
		        <meta name="facebook-domain-verification" content="cmdpjevu8l4zya3vzr1p6f00v21uty" />
        <!-- GTM -->
        <script type="text/javascript">(function (w, d, s, l, i) {
                w[l] = w[l] || []; w[l].push({
                    'gtm.start':
                        new Date().getTime(), event: 'gtm.js'
                }); var f = d.getElementsByTagName(s)[0],
                    j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
            })(window, document, 'script', 'dataLayer', 'GTM-MKSKW3');
        </script>
        <!-- End GTM -->
                <script>
            (function () {
                let plausibleDataDomain = 'dev-www.malwarebytes.com';
                if (location.href.indexOf('https://www.malwarebytes.com') === 0 || location.href.indexOf('https://malwarebytes.go-vip.net') === 0) {
                    plausibleDataDomain = 'w.malwarebytes.com,malwarebytes.com';
                } else if (location.href.indexOf('https://preprod-www.malwarebytes.com') === 0) {
                    plausibleDataDomain = 'staging-www.malwarebytes.com';
                }
                let script = document.createElement('script');
                script.defer = true;
                script.src = 'https://plausible.io/js/script.js';
                script.dataset.domain = plausibleDataDomain;
                document.head.appendChild(script);
            })();
        </script>
        
<body class="post-template-default single single-post postid-65729 single-format-standard wp-custom-logo">
<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#primary">Skip to content</a>

	<header id="masthead" class="site-header mb-header-blog">
		<div class="container">
			<div class="site-header__top">
				<!-- Search -->
						<div class="site-header-searchbox">
						<button class="searchbox-nav" aria-label="Search in MalwareBytes">Search</button>
			<div class="search-modal">
				<label>Search Malwarebytes.com</label>
				<div class="custom-search-form">
					<form role="search" method="get" class="search-form" action="https://www.malwarebytes.com/">
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="search-field" placeholder="Type to search..." value="" name="s" />
	</label>
	<input type="submit" class="search-submit" value="Search" />
</form>
				</div>
			</div>
		</div>
						<!-- Search -->
				<ul id="secondary-menu" class="secondary-menu u-flex-center"><li id="menu-item-2914" class="signin-items menu-item menu-item-type-custom menu-item-object-custom menu-item-2914"><a href="https://my.malwarebytes.com/en/login" id="cta-en-us-utilbar-my_malwarebytes_com_en_login-click">Sign In</a></li>
</ul>			</div>
			<div class="site-header__bottom u-flex-columns">
				<div class="site-header__branding u-flex-column u-flex-col-lg-3 u-flex-col-9">
					<a href="https://www.malwarebytes.com/blog" rel="home" id="cta-navbar-company-logo-en-blog">
						<svg width="183" height="24" viewBox="0 0 183 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.225 20.116c.072 0 .072 0 0 0 .215 0 .286-.148.286-.296s-.071-.222-.214-.296h-.215c-2.717-.592-4.863-3.106-4.863-6.064A6.55 6.55 0 0 1 5.22 9.984c.072-.148.287-.222.43-.074l4.362 4.585c.071.074.143.074.214.074.072 0 .143 0 .215-.074l4.434-4.511c.143-.148.286-.148.429 0 .643.961 1 2.145 1 3.476a6.351 6.351 0 0 1-1.5 4.141s-.072.074-.072.148v.074c0 .148.143.222.214.222 0 0 .072 0 .143-.074 5.793-2.588 5.578-8.505 5.578-8.505 0-3.402-1.573-6.508-4.005-8.43-.143-.075-.286-.075-.357 0l-5.793 5.99c-.143.148-.286.148-.357 0l-5.793-5.99c-.071-.075-.286-.149-.357 0C1.573 2.957 0 6.063 0 9.465c0 5.547 4.076 10.058 9.225 10.65Z" fill="#0D3ECC"/><path d="m160.975 18.045-5.292-13.238-5.292 13.312h1.431l1.001-2.662h3.432l-2.789-1.701 2.217-5.62 2.861 7.543h-2.503l5.006 2.366h-.072Z" fill="#3D3D3D"/><path d="M90.32 5.99 90.25.222c0-.148-.144-.222-.287-.222L88.39.222c-.143 0-.215.148-.215.222v17.083c0 .148.072.222.143.222 1.36.296 3.075.444 4.148.444 4.505 0 5.149-2.219 5.149-4.66V9.097c0-2.588-1.144-3.92-3.504-3.92-1.573-.073-3.004.445-3.79.814Zm5.364 2.959v4.659c0 1.7-.5 2.81-3.003 2.81-.859 0-1.645-.074-2.432-.148h-.071V7.913c.715-.37 2.216-.961 3.36-.961 1.502 0 2.146.591 2.146 1.997Zm4.648-3.55h-1.501c-.143 0-.286.148-.215.296l3.79 12.054c0 .074.143.148.215.148h.429c.143 0 .286.148.215.296l-1.502 4.511c-.072.148.071.296.214.296h1.431c.071 0 .143-.074.214-.148l1.645-4.881L109.2 5.695c.072-.148-.071-.296-.214-.296h-1.502c-.072 0-.143.074-.215.148l-3.146 10.205c-.072.222-.358.222-.429 0l-3.147-10.205c0-.074-.143-.148-.215-.148Zm18.665 4.437v3.772c0 3.106 1.502 4.585 4.792 4.585 1.43 0 2.932-.222 4.076-.666.143 0 .143-.148.143-.296l-.215-1.183c0-.148-.143-.222-.286-.148-1.358.37-2.503.518-3.575.518-2.503 0-2.932-.961-2.932-2.81v-.888c0-.148.071-.222.214-.222h6.865c.143 0 .215-.074.215-.221V9.91c0-3.18-1.502-4.733-4.505-4.733-3.147-.074-4.792 1.553-4.792 4.659ZM121 9.614c0-1.923.858-2.81 2.717-2.81s2.646.813 2.646 2.81v.888c0 .147-.071.221-.214.221h-4.935c-.143 0-.214-.074-.214-.221v-.888Zm13.158 1.183c-2.074-.517-2.145-.813-2.145-2.218 0-1.183.286-1.627 2.074-1.627.858 0 2.073.148 3.075.296.143 0 .286-.074.286-.222l.143-1.257c0-.148-.072-.222-.143-.222-.93-.222-2.074-.37-3.218-.37-3.004 0-4.148.887-4.148 3.328 0 2.588.286 3.254 3.289 3.993 2.432.592 2.575.74 2.575 2.145 0 1.331-.286 1.775-2.289 1.775-.929 0-2.216-.148-3.218-.444-.143 0-.286.074-.286.148l-.214 1.183c0 .148.071.222.143.296 1.001.37 2.503.592 3.647.592 3.504 0 4.148-1.183 4.148-3.624 0-2.662-.429-2.958-3.719-3.772ZM41.692 17.75 39.547 5.546c0-.148.071-.296.214-.296h2.432c.143 0 .214.074.214.148l1.287 7.321c0 .222.358.296.43 0l2.145-7.395c0-.074.143-.148.214-.148h2.86c.072 0 .144.074.215.148l2.074 7.395a.222.222 0 0 0 .43 0L53.348 5.4c0-.148.143-.148.214-.148h2.432c.143 0 .214.148.214.296L54.063 17.75c0 .148-.143.148-.215.148H50.63c-.071 0-.143-.074-.214-.148l-2.36-8.135a.222.222 0 0 0-.43 0l-2.36 8.135c0 .074-.142.148-.214.148h-3.218c0 .074-.143 0-.143-.148Zm-3.504-2.146c-1.073 0-1.43-.517-1.43-1.922V.96c0-.148-.143-.221-.286-.221l-2.575.37c-.143 0-.214.147-.214.221v12.721c0 2.885 1.716 4.142 3.933 4.142.214 0 1.072 0 1.43-.074.143 0 .215-.148.215-.222V15.9c0-.148-.143-.222-.215-.222-.286-.074-.643-.074-.858-.074ZM75.16 8.061c-1.073.518-1.93 1.035-3.004 1.701-.071 0-.143.148-.143.222v7.765c0 .148-.071.222-.214.222h-2.646c-.143 0-.215-.074-.215-.222V5.99c0-.148.072-.221.143-.221l2.217-.37c.143 0 .215.074.286.148l.143.813c0 .148.215.222.358.148.644-.444 1.788-1.11 2.646-1.405.143-.074.286.074.286.222l.286 2.44c0 .148 0 .222-.143.296Zm40.691 8.357c-1.216 0-1.287-.592-1.287-1.48V7.323c0-.148.071-.222.214-.222h2.861c.143 0 .214-.074.214-.222l.143-1.257c0-.148-.071-.296-.214-.296h-3.004c-.143 0-.214-.074-.214-.222V2.219c0-.148-.144-.222-.287-.222l-1.573.222c-.143 0-.214.148-.214.222v2.736c0 .148-.072.222-.215.222h-1.716c-.143 0-.215.074-.215.222v1.257c0 .148.072.222.215.222h1.716c.143 0 .215.074.215.222v7.987c0 1.996.858 2.81 3.003 2.81.501 0 .93-.074 1.43-.148.143 0 .143-.148.143-.222v-1.183c0-.148-.143-.222-.286-.222-.286.074-.572.074-.929.074ZM84.028 5.473c-.644-.296-1.502-.444-2.503-.444-1.145 0-2.146.222-2.86.592-1.646.813-2.218 2.514-2.218 4.363v3.328c0 2.958 1.287 4.807 4.935 4.88h.858c1.001 0 2.002-.147 3.003-.295.143 0 .215-.148.215-.296v-.148l-.286-1.7c-.93.073-1.716.147-2.646.147-2.217 0-2.932-.665-2.932-2.07v-1.036h6.579c.143 0 .215-.074.215-.222v-2.514c-.072-1.997-.573-3.772-2.36-4.585Zm-.43 5.029c0 .147-.071.221-.214.221h-3.862V9.614c0-1.183.5-1.997 2.003-1.997h.5c1.144.148 1.573.962 1.573 1.997v.888Zm-57.71-5.399c-1.073 0-2.217.074-3.218.222-.143 0-.215.148-.143.296l.286 1.922c0 .148.143.222.214.222 1.001-.148 1.645-.148 2.646-.148 2.217 0 2.932.666 2.932 2.071v.814c0 .147-.071.221-.214.221h-2.86c-2.504 0-3.934 1.332-3.934 3.698 0 2.219 1.645 3.772 4.076 3.772 1.573 0 2.146-.222 2.646-.74.143-.148.358 0 .358.148v.148c0 .148.071.222.214.222h2.432c.143 0 .214-.074.214-.222V9.69c0-3.107-2.074-4.586-5.65-4.586Zm2.646 8.135c0 1.553-1.073 2.662-2.646 2.662-1.288 0-1.931-.517-1.931-1.553 0-1.109.643-1.553 1.93-1.553h2.432c.143 0 .215.074.215.222v.222Zm32.681-8.135c-1.073 0-2.217.074-3.218.222-.143 0-.215.148-.143.296l.286 1.922c0 .148.143.222.214.222C59.356 7.617 60 7.617 61 7.617c2.217 0 2.932.666 2.932 2.071v.814c0 .147-.071.221-.214.221h-2.86c-2.504 0-3.934 1.332-3.934 3.698 0 2.219 1.645 3.772 4.076 3.772 1.574 0 2.146-.222 2.646-.74.143-.148.358 0 .358.148v.148c0 .148.072.222.215.222h2.503c.143 0 .214-.074.214-.222V9.69c0-3.107-2.145-4.586-5.721-4.586Zm2.646 8.135c0 1.553-1.073 2.662-2.646 2.662-1.287 0-1.93-.517-1.93-1.553 0-1.109.643-1.553 1.93-1.553h2.431c.143 0 .215.074.215.222v.222Z" fill="#0D3ECC"/><path d="M177.352 18.119c-1.574 0-3.29-.37-4.935-1.035l.358-1.332c1.502.518 3.146.888 4.505.888 1.931 0 3.075-.814 3.075-1.923 0-.961-.572-1.479-3.361-2.588-3.146-1.184-4.219-2.071-4.219-3.994 0-2.07 1.645-2.958 4.577-2.958 1.287 0 3.075.222 4.291.665l-.287 1.332c-1.215-.296-2.646-.518-3.933-.518-2.145 0-3.003.37-3.003 1.48 0 1.182.786 1.626 3.647 2.735 3.146 1.258 3.933 1.997 3.933 3.772.072 2.07-1.788 3.476-4.648 3.476Zm-27.676-.074h-5.363c-.715 0-1.144-.296-1.359-.518-.429-.517-.429-1.109-.429-1.33V5.102h1.287v11.241c0 .074 0 .222.072.296.071.074.286.148.357.148h5.364l.071 1.257Zm21.812-3.624c0-1.553-.715-2.81-2.217-3.402.929-.517 1.645-1.479 1.645-2.81 0-1.923-1.431-3.032-3.934-3.032h-5.005v11.019c0 .148 0 .814.429 1.331.214.296.643.518 1.358.518h3.79c2.718-.074 3.934-1.7 3.934-3.624Zm-8.153-7.987h3.647c1.788 0 2.646.592 2.646 1.923s-.858 2.219-2.503 2.219h-3.79V6.434Zm4.863 10.28h-4.434c-.143 0-.286 0-.357-.148-.072-.074-.072-.296-.072-.296v-4.437h4.219c1.788 0 2.646 1.11 2.575 2.514-.072 1.258-.715 2.145-1.931 2.367Z" fill="#3D3D3D"/></svg>
					</a>
				</div>
				<div class="site-header__bottom-right u-flex-column u-flex-col-lg-9 u-flex-col-3">
					<button class="menu-toggle" aria-label="Menu" aria-controls="primary-menu" aria-expanded="false">
						<span class="menu-toggle-bar menu-toggle-bar1"></span>
						<span class="menu-toggle-bar menu-toggle-bar2"></span>
						<span class="menu-toggle-bar menu-toggle-bar3"></span>
					</button>
					<div class="site-header__nav">
						<nav id="site-navigation" class="main-navigation">
							<ul id="primary-menu" class="primary-menu u-flex-center"><li id="menu-item-2906" class="personal-menu-class menu-item menu-item-type-custom menu-item-object-custom menu-item-2906 menu-item-has-megamenu"><a href="#" id="cta-en-us-navbar-personal-click">Personal</a><div class="megamenu-wrap">
<div class="wp-block-columns is-layout-flex wp-container-core-columns-is-layout-1 wp-block-columns-is-layout-flex" style="padding-bottom:0">
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style="flex-basis:31%">
<p>&lt; Products</p>



<div class="wp-block-group alignfull is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-1 wp-block-group-is-layout-flex">
<div class="wp-block-malware-bytes-menu-links menu-links layout-1 has-item-border" id="menu-links-4ed3bf9a-9621-4f6d-8aba-9a5850ee5951"><div class="menu-links__item"><div class="menu-links__title" style="color:#0d3ecc"><strong>Device Protection &amp; Antivirus</strong></div><ul><li><a id="cta-en-us-navbar-personal-malwarebytes-premium-click" href="https://www.malwarebytes.com/premium">Premium Security Antivirus</a></li><li><a href="https://www.malwarebytes.com/mobile">Mobile Security for Android &amp; iOS</a></li></ul></div></div>
</div>
</div>



<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style="flex-basis:31%">
<div class="wp-block-group alignfull is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-2 wp-block-group-is-layout-flex">
<div class="wp-block-malware-bytes-menu-links menu-links layout-1 has-item-border" id="menu-links-4ed3bf9a-9621-4f6d-8aba-9a5850ee5951"><div class="menu-links__item"><div class="menu-links__title" style="color:#0d3ecc"><strong>Identity Protection</strong></div><ul><li><a id="cta-en-us-navbar-_identity_theft_protection-click" href="https://www.malwarebytes.com/identity-theft-protection">Identity Theft Protection</a></li><li><a id="cta-en-us-navbar-personal-data-remover-click" href="https://www.malwarebytes.com/personal-data-remover">Personal Data Remover</a></li><li><a id="cta-en-us-navbar-digital-footprint-scanner-click" href="https://www.malwarebytes.com/digital-footprint">Digital Footprint Scanner</a></li></ul></div><div class="menu-links__item"><div class="menu-links__title" style="color:#0d3ecc"><strong>Privacy Protection</strong></div><ul><li><a id="cta-en-us-navbar-_vpn-click" href="https://www.malwarebytes.com/vpn" data-type="link" data-id="https://www.malwarebytes.com/vpn">Privacy VPN</a></li><li><a id="cta-en-us-navbar-_browserguard-click" href="https://www.malwarebytes.com/browserguard">Browser Guard</a></li><li><a id="cta-en-us-navbar-_adwcleaner-click" href="https://www.malwarebytes.com/adwcleaner">AdwCleaner</a></li></ul></div></div>
</div>
</div>



<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style="flex-basis:31%">
<div class="wp-block-group alignfull flex-direction-row is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-3 wp-block-group-is-layout-flex">
<div class="wp-block-malware-bytes-menu-links menu-links layout-1 has-item-border" id="menu-links-d24ba127-7e50-44f9-8919-360f85d19902" style="background-color:#ffffff"><div class="menu-links__item"><p class="menu-links__desc" style="color:#135e96"><span data-fontsize="18" class="qubely-custom-font" style="font-size: 18px;"><span data="#191919" class="qubely-text-has-color" style="color: #191919;">Have a current computer infection?</span></span></p><div class="menu-links__cta" style="color:#135e96"><a id="cta-en-us-navbar-clean-your-device-now-click" href="https://www.malwarebytes.com/solutions/virus-scanner" data-type="link" data-id="https://www.malwarebytes.com/solutions/virus-scanner"><strong>Free Virus Scan</strong></a></div></div><div class="menu-links__item"><p class="menu-links__desc" style="color:#135e96"><span data="#191919" class="qubely-text-has-color" style="color: #191919;"><span data-fontsize="18" class="qubely-custom-font" style="font-size: 18px;">Try our antivirus with a free, full-featured 14-day trial</span></span></p><div class="menu-links__cta" style="color:#135e96"><a id="cta-en-us-navbar-download-now-click" href="https://www.malwarebytes.com/getprotection"><strong>Free Antivirus</strong></a></div></div><div class="menu-links__item"><p class="menu-links__desc" style="color:#135e96"><span data="#191919" class="qubely-text-has-color" style="color: #191919;"><span data-fontsize="18" class="qubely-custom-font" style="font-size: 18px;">Find the right cyberprotection for you</span></span></p><div class="menu-links__cta" style="color:#135e96"><a id="cta-en-us-navbar-see-our-plans-click" href="https://www.malwarebytes.com/pricing"><strong>Compare plans and pricing</strong></a></div></div></div>
</div>
</div>
</div>
</div></li>
<li id="menu-item-2907" class="business-menu-class menu-item menu-item-type-custom menu-item-object-custom menu-item-2907 menu-item-has-megamenu"><a href="#" id="cta-en-us-navbar-business-click">Business</a><div class="megamenu-wrap">
<div class="wp-block-columns is-layout-flex wp-container-core-columns-is-layout-2 wp-block-columns-is-layout-flex">
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style="flex-basis:25%"></div>



<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style="flex-basis:35%">
<p>&lt; Business</p>



<div class="wp-block-malware-bytes-menu-links menu-links layout-1 has-item-border" id="menu-links-f01e317a-5669-417c-ae3d-5bae36e32f8c"><div class="menu-links__item"><div class="menu-links__title" style="color:#0D3ECC"><strong><a id="cta-en-us-navbar-business-teams-click" href="https://www.malwarebytes.com/teams">Teams</a></strong></div><div class="menu-links__subtitle">Protect small &amp; home offices &#8211; no IT expertise needed</div></div><div class="menu-links__item"><div class="menu-links__title" style="color:#0D3ECC"><strong><a href="https://www.threatdown.com/?utm_campaign=mwb-referral&amp;utm_source=malwarebytes.com&amp;utm_medium=referral&amp;utm_content=cta-mb-nav-threatdown">ThreatDown</a></strong></div><div class="menu-links__subtitle">Award-winning endpoint security for small and medium businesses</div></div></div>
</div>
</div>
</div></li>
<li id="menu-item-2908" class="pricing-menu-class menu-item menu-item-type-custom menu-item-object-custom menu-item-2908 menu-item-has-megamenu"><a href="#" id="cta-en-us-navbar-pricing-click">Pricing</a><div class="megamenu-wrap">
<div class="wp-block-columns is-layout-flex wp-container-core-columns-is-layout-3 wp-block-columns-is-layout-flex">
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow"></div>



<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow">
<p>&lt; Pricing</p>



<div class="wp-block-malware-bytes-menu-links menu-links layout-1 has-item-border" id="menu-links-8b91929a-d4ec-4127-b3f4-08b5703b82f6"><div class="menu-links__item"><div class="menu-links__title"><a id="cta-en-us-navbar-pricing-personal-pricing-click" href="https://www.malwarebytes.com/pricing" data-type="page" data-id="3844">Personalpricing</a></div><p class="menu-links__desc">Protect your personal devices and data</p></div><div class="menu-links__item"><div class="menu-links__title"><a id="cta-en-us-navbar-pricing-small-office-home-office-pricing-click" href="https://www.malwarebytes.com/pricing/teams" data-type="link" data-id="https://www.malwarebytes.com/pricing/teams">Smallor home office pricing</a></div><p class="menu-links__desc">Protect your team&#8217;s devices and data &#8211; no IT skills needed</p></div><div class="menu-links__item"><div class="menu-links__title"><a id="cta-en-us-navbar-pricing-business-pricing-click" href="https://www.threatdown.com/pricing/?utm_campaign=mwb-referral&amp;utm_source=malwarebytes.com&amp;utm_medium=referral&amp;utm_content=cat-en-us-navbar-pricing-business-pricing-click" data-type="page" data-id="124">Corporate pricing</a></div><p class="menu-links__desc">Explore award-winning endpoint security for your business</p></div></div>
</div>



<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow"></div>
</div>
</div></li>
<li id="menu-item-2909" class="partners-menu-class menu-item menu-item-type-custom menu-item-object-custom menu-item-2909 menu-item-has-megamenu"><a href="#" id="cta-en-us-navbar-partners-click">Partners</a><div class="megamenu-wrap">
<div class="wp-block-columns is-layout-flex wp-container-core-columns-is-layout-4 wp-block-columns-is-layout-flex">
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow"></div>



<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style="flex-basis:30%">
<p>&lt; Partners</p>



<div class="wp-block-malware-bytes-menu-links menu-links layout-1 has-item-border" id="menu-links-e13d480b-8377-4493-b67e-2fa03815fbb5"><div class="menu-links__item"><div class="menu-links__title"><br><a id="cta-navbar-partners-explore-partnerships-en-test" href="https://www.malwarebytes.com/partners">Malwarebytes</a></div><ul><li><a id="cta-navbar-partners-affiliate-partner-en-test" href="https://www.malwarebytes.com/affiliates" data-type="link" data-id="https://www.malwarebytes.com/affiliates">Affiliate partner</a></li><li><a id="cta-navbar-partners-computer-repair-en-test" href="https://www.malwarebytes.com/techbench">Computer repair</a><br></li></ul></div><div class="menu-links__item"><div class="menu-links__title"><a id="cta-navbar-partners-explore-threatdown-en-test" href="https://www.threatdown.com/partner-program/?utm_campaign=mwb-referral&amp;utm_source=malwarebytes.com&amp;utm_medium=referral&amp;utm_content=cta-navbar-partners-explore-partnerships-en-test" target="_blank" rel="noreferrer noopener">ThreatDown: Malwarebytes for Business</a></div><ul><li><a id="cta-navbar-partners-solution-providers-en-test" href="https://www.threatdown.com/partner-program/partner-reseller/?utm_campaign=mwb-referral&amp;utm_source=malwarebytes.com&amp;utm_medium=referral&amp;utm_content=cta-navbar-partners-solution-providers-en-test" target="_blank" rel="noreferrer noopener">Resellers</a></li><li><a id="cta-navbar-partners-managed-service-providers-en-test" href="https://www.threatdown.com/partner-program/msp/?utm_campaign=mwb-referral&amp;utm_source=malwarebytes.com&amp;utm_medium=referral&amp;utm_content=cta-navbar-partners-managed-service-providers-en-test" data-type="page" data-id="3311" target="_blank" rel="noreferrer noopener">Managed Service Providers (MSP/ISS)</a></li></ul></div></div>
</div>



<div class="wp-block-column has-white-background-color has-background is-layout-flow wp-block-column-is-layout-flow" style="flex-basis:34%"></div>
</div>
</div></li>
<li id="menu-item-2910" class="resources-menu-class menu-item menu-item-type-custom menu-item-object-custom menu-item-2910 menu-item-has-megamenu"><a href="#" id="cta-en-us-navbar-resources-click">Resources</a><div class="megamenu-wrap">
<div class="wp-block-columns is-layout-flex wp-container-core-columns-is-layout-5 wp-block-columns-is-layout-flex" style="padding-right:var(--wp--preset--spacing--80);padding-left:0">
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style="flex-basis:33.33%"></div>



<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style="flex-basis:34.48%">
<p>&lt; Resources</p>



<div class="wp-block-malware-bytes-menu-links menu-links layout-1 has-item-border" id="menu-links-d6a9ae27-5550-4478-b20f-6394817e1ef7"><div class="menu-links__item"><div class="menu-links__title"><a id="cta-en-us-navbar-_resources-learn-cybcersecurity-click" href="https://www.malwarebytes.com/blog" data-type="link" data-id="https://www.malwarebytes.com/blog"><img decoding="async" class="wp-image-151872" style="width: NaNpx;" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/07/mwb-labs-159px.svg" alt="Malwarebytes Labs"></a></div><ul><li><a id="cta-en-us-navbar-_antivirus-click" href="https://www.malwarebytes.com/glossary">Security terms glossary</a></li><li><a id="cta-en-us-navbar-_malware-click" href="https://www.malwarebytes.com/blog/threats">Threat Center</a></li><li><a href="https://www.malwarebytes.com/blog">Cybersecurity News</a></li></ul></div><div class="menu-links__item"><ul><li><a id="cta-en-us-navbar-_glossary-click" href="https://www.malwarebytes.com/company">About Malwarebytes</a></li><li><a id="cta-en-us-navbar-_blog_threats-click" href="https://www.malwarebytes.com/press/">Press</a></li><li><a href="https://www.malwarebytes.com/jobs">Careers</a></li></ul></div></div>
</div>



<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style="flex-basis:32.19%">
<p></p>



<div class="wp-block-malware-bytes-menu-links menu-links layout-1 has-item-border" id="menu-links-0a8428cf-74da-4b5d-a0ed-6cf810a8b368"><div class="menu-links__item"><div class="menu-links__title"><a id="cta-en-us-navbar-_resources-business-click" href="https://www.malwarebytes.com/cybersecurity">Cybersecurity Resource Center</a></div><ul><li><a id="cta-en-us-navbar-_resources-click" href="https://www.malwarebytes.com/cybersecurity/basics/antivirus">Antivirus</a></li><li><a href="https://www.malwarebytes.com/malware">Malware</a></li><li><a id="cta-en-us-navbar-_resources_casestudies-click" href="https://www.malwarebytes.com/ransomware">Ransomware</a></li><li><a href="https://www.malwarebytes.com/phishing">Phishing</a></li><li><a href="https://www.malwarebytes.com/cybersecurity">See all articles</a></li></ul></div></div>
</div>
</div>
</div></li>
<li id="menu-item-2911" class="support-menu-class menu-item menu-item-type-custom menu-item-object-custom menu-item-2911 menu-item-has-megamenu"><a href="#" id="cta-en-us-navbar-support-click">Support</a><div class="megamenu-wrap">
<div class="wp-block-columns is-layout-flex wp-container-core-columns-is-layout-6 wp-block-columns-is-layout-flex">
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style="flex-basis:30%"></div>



<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style="flex-basis:30%"></div>



<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style="flex-basis:35%">
<p>&lt; Support</p>



<div class="wp-block-malware-bytes-menu-links menu-links layout-1 has-item-border" id="menu-links-8b91929a-d4ec-4127-b3f4-08b5703b82f6"><div class="menu-links__item"><div class="menu-links__title"><a id="cta-navbar-support-personal-click" href="https://support.malwarebytes.com/hc/en-us" data-type="page" data-id="3844">Malwarebytes Personal Support</a></div><p class="menu-links__desc">Malwarebytes and Teams Customers</p></div><div class="menu-links__item"><div class="menu-links__title"><a id="cta-navbar-support-Threatdown-business-click" href="https://support.threatdown.com/hc/en-us/?utm_campaign=mwb-referral&amp;utm_source=malwarebytes.com&amp;utm_medium=referral&amp;utm_content=cta-navbar-support-Threatdown-business-click" data-type="page" data-id="406">ThreatDown Business Support</a></div><p class="menu-links__desc">Nebula and Oneview Customers</p></div><div class="menu-links__item"><div class="menu-links__title"><a id="cta-navbar-support-community-forums-click" href="https://forums.malwarebytes.com/" data-type="page" data-id="124">Community Forums</a></div></div></div>
</div>
</div>
</div></li>
</ul>						</nav><!-- #site-navigation -->
						<div class="site-header__actions">
							<a href="#" id="cta-navbar-freedownload-main-en-test" class="mb-free-download-btn btn-main btn-primary-yellow u-text-transform-upper" aria-label="Free Download">Free Download</a>
						</div>
													<ul id="secondary-menu-mob" class="secondary-menu u-flex-direction-column u-display-none@min-1150"></ul>
													<!-- Search HTML Mobile -->
								<div class="site-header-searchbox">
						<button class="searchbox-nav-mobile" aria-label="Search in MalwareBytes">Search</button>
						<button class="searchbox-nav" aria-label="Search in MalwareBytes">Search</button>
			<div class="search-modal">
				<label>Search Malwarebytes.com</label>
				<div class="custom-search-form">
					<form role="search" method="get" class="search-form" action="https://www.malwarebytes.com/">
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="search-field" placeholder="Type to search..." value="" name="s" />
	</label>
	<input type="submit" class="search-submit" value="Search" />
</form>
				</div>
			</div>
		</div>
								<!-- Search -->
					</div>
				</div>
			</div>
		</div>
	</header><!-- #masthead -->

	<main id="primary" class="site-main has-default-container blog-page">
				<div class="wp-block-malware-bytes-inner-header">
			<div class="labs-sub-nav">
				<div class="container">
					<div class="labs-sub-nav__row">
						<div class="labs-sub-nav__colum left">
							<form role="search" method="get" class="search-form" action="https://www.malwarebytes.com/blog/">
								<div class="labs-sub-nav__searchbar-wrap">
									<input class="labs-sub-nav__search-input" type="text" name="s" placeholder="Search Labs">
									<button class="labs-sub-nav__search-button" id="cta-labs-rightrail-search-submit-en" aria-label="Search in Malwarebytes">
										<svg xmlns="http://www.w3.org/2000/svg" width="35px" height="35px" viewBox="0 0 24 24" fill="none">
											<g clip-path="url(#clip0_15_152)">
											<rect width="24" height="24" fill="none"></rect>
											<circle cx="10.5" cy="10.5" r="6.5" stroke="#0d3ecc" stroke-linejoin="round"></circle>
											<path d="M19.6464 20.3536C19.8417 20.5488 20.1583 20.5488 20.3536 20.3536C20.5488 20.1583 20.5488 19.8417 20.3536 19.6464L19.6464 20.3536ZM20.3536 19.6464L15.3536 14.6464L14.6464 15.3536L19.6464 20.3536L20.3536 19.6464Z" fill="#0d3ecc"></path>
											</g>
											<defs>
											<clipPath id="clip0_15_152">
												<rect width="24" height="24" fill="#0d3ecc"></rect>
											</clipPath>
											</defs>
										</svg>
									</button>
								</div>
							</form>
						</div>
						<div class="labs-sub-nav__colum right">							
							<div class="subscribe-rss-wrp">
																	<a class="subscribe-btn" href="https://www.malwarebytes.com/newsletter?email=&#038;source=labs" aria-label="Subscribe To Malwarebytes">SUBSCRIBE</a>
																									<a href="https://www.malwarebytes.com/blog/feed/index.xml" target="_blank" aria-label="Feed Link">
										<svg xmlns="http://www.w3.org/2000/svg" fill="#337ab7" width="25px" height="25px" viewBox="0 0 32 32" version="1.1">
											<title>rss</title>
											<path d="M9.565 26.319c0-2.161-1.752-3.913-3.912-3.913s-3.913 1.752-3.913 3.913c0 2.161 1.752 3.913 3.913 3.913s3.912-1.752 3.912-3.913zM20.651 30.231h-5.543c0-7.383-5.985-13.368-13.368-13.368v-5.543c10.444 0 18.911 8.467 18.911 18.911v0zM24.563 30.231c0-12.605-10.218-22.823-22.823-22.823v-5.706c15.756 0 28.529 12.773 28.529 28.529h-5.706z"></path>
										</svg>
									</a>
															</div>							
							<div class="social-wrp">
																	<a class="facebook-icon" href="https://www.facebook.com/Malwarebytes/" aria-label="Facebook Link" target="_blank">
									<svg fill="#4a4a4a" width="30px" height="30px" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M21.95 5.005l-3.306-.004c-3.206 0-5.277 2.124-5.277 5.415v2.495H10.05v4.515h3.317l-.004 9.575h4.641l.004-9.575h3.806l-.003-4.514h-3.803v-2.117c0-1.018.241-1.533 1.566-1.533l2.366-.001.01-4.256z"/></svg>
									</a>
																									<a class="twitter-icon" href="https://twitter.com/malwarebytes" aria-label="Twitter Link" target="_blank">
									<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 31.143 25.261">
										<path id="Path_36" data-name="Path 36" d="M47.862,27.261c11.765,0,18.167-9.689,18.167-18.167V8.229a14.064,14.064,0,0,0,3.114-3.287A14.363,14.363,0,0,1,65.51,5.979a6.732,6.732,0,0,0,2.768-3.46A15.87,15.87,0,0,1,64.3,4.076,6.179,6.179,0,0,0,59.627,2a6.5,6.5,0,0,0-6.4,6.4A3.373,3.373,0,0,0,53.4,9.786,17.888,17.888,0,0,1,40.249,3.038a6.626,6.626,0,0,0-.865,3.287,6.874,6.874,0,0,0,2.768,5.364,5.833,5.833,0,0,1-2.941-.865h0A6.323,6.323,0,0,0,44.4,17.053a5.334,5.334,0,0,1-1.73.173,2.944,2.944,0,0,1-1.211-.173,6.555,6.555,0,0,0,6.056,4.5,13.063,13.063,0,0,1-7.959,2.768A4.79,4.79,0,0,1,38,24.146a16.331,16.331,0,0,0,9.862,3.114" transform="translate(-38 -2)" fill="#4a4a4a" fill-rule="evenodd"/>
										</svg>
									</a>
																									<a class="linkedin-icon" href="https://www.linkedin.com/company/malwarebytes" aria-label="LinkedIn Link" target="_blank">
									<svg fill="#4a4a4a"  version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  width="20px"
										height="20px" viewBox="0 0 512 512" xml:space="preserve">
										<g id="7935ec95c421cee6d86eb22ecd125aef">
										<path style="display: inline; fill-rule: evenodd; clip-rule: evenodd;" d="M116.504,500.219V170.654H6.975v329.564H116.504
												L116.504,500.219z M61.751,125.674c38.183,0,61.968-25.328,61.968-56.953c-0.722-32.328-23.785-56.941-61.252-56.941
												C24.994,11.781,0.5,36.394,0.5,68.722c0,31.625,23.772,56.953,60.53,56.953H61.751L61.751,125.674z M177.124,500.219
												c0,0,1.437-298.643,0-329.564H286.67v47.794h-0.727c14.404-22.49,40.354-55.533,99.44-55.533
												c72.085,0,126.116,47.103,126.116,148.333v188.971H401.971V323.912c0-44.301-15.848-74.531-55.497-74.531
												c-30.254,0-48.284,20.38-56.202,40.08c-2.897,7.012-3.602,16.861-3.602,26.711v184.047H177.124L177.124,500.219z">
										</path>
										</g>
										</svg>
									</a>
															</div>
						</div>
					</div>
				</div>
			</div>
		</div>
				<div class="container">
			<div class="u-flex-columns">
				<div class="u-flex-column u-flex-col-lg-8">
					
<article id="post-65729" class="post-65729 post type-post status-publish format-standard has-post-thumbnail hentry category-news category-threats tag-exploit-kits tag-exploits tag-hidden-bee tag-loader tag-mellifera tag-reverse-engineering tag-security-research tag-underminer tag-underminer-ek">
	<div class="malwarebytes-post-article u-margin-t50 u-margin-b50 u-margin-t50@max-767 u-margin-b50@max-767 u-bg-white">

		
			<div class="post-thumbnail">
				<img width="800" height="400" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/shutterstock_665631382.jpg?w=800" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="Hidden Bee: Let&#039;s go down the rabbit hole" decoding="async" fetchpriority="high" srcset="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/shutterstock_665631382.jpg 800w, https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/shutterstock_665631382.jpg?resize=300,150 300w, https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/shutterstock_665631382.jpg?resize=768,384 768w" sizes="(max-width: 800px) 100vw, 800px" />			</div><!-- .post-thumbnail -->

		
		<header class="entry-header blog-head">			
							<div class="blog-list__category">
											<a href="https://www.malwarebytes.com/blog/category/news">News</a>
						 | 						<a href="https://www.malwarebytes.com/blog/category/threats">Threats</a>
										</div>
				<h1 class="entry-title u-margin-b10">Hidden Bee: Let&#8217;s go down the rabbit hole</h1>				<div class="entry-meta">
					<span class="posted-on">Posted: May 31, 2019</span>
					<span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://www.malwarebytes.com/blog/authors/hasherezade">hasherezade</a></span></span>				</div><!-- .entry-meta -->
					</header><!-- .entry-header -->

		<div class="entry-content">
			<p>Some time ago, we discussed the interesting malware, <a rel="noreferrer noopener" aria-label="Hidden Bee (opens in a new tab)" href="/blog/threat-analysis/2018/08/reversing-malware-in-a-custom-format-hidden-bee-elements/" target="_blank">Hidden Bee</a>. It is a Chinese miner, composed of userland components, as well as of a bootkit part. One of its unique features is a custom format used for some of the high-level elements (this format was featured in <a href="https://www.youtube.com/watch?v=0ndK-Az0RO4" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">my recent presentation at SAS</a>).</p>    <p>Recently, we stumbled upon a new sample of Hidden Bee. As it turns out, its authors decided to redesign some elements, as well as the used formats. In this post, we will take a deep dive in the functionality of the loader and the included changes.</p>    <h3 class="wp-block-heading">Sample</h3>    <p><a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://www.virustotal.com/#/file/fd9edb6d9ac9674e797e51b3767e45a2eb23343c2ce88e64ef20d26f641064af/detection" target="_blank">831d0b55ebeb5e9ae19732e18041aa54</a> &#8211; shared by <a href="https://twitter.com/james_inthe_box/status/1117526091101396992?s=21" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">@James_inthe_box</a></p>    <h3 class="wp-block-heading">Overview</h3>    <p>The Hidden Bee runs silently&mdash;only increased processor usage can hint that the system is infected. More can be revealed with the help of tools inspecting the memory of running processes.</p>    <p>Initially, the main sample installs itself as a Windows service:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/added_service.png" class="wp-image-38532" alt="" width="816" height="180"/></figure>     <p>However, once the next component is downloaded, this service is removed.</p>    <p>The payloads are injected into several applications, such as svchost.exe, msdtc.exe, dllhost.exe, and WmiPrvSE.exe.</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/injected2.png" class="wp-image-38517" alt="" width="800" height="106"/></figure>     <p>If we scan the system with <a href="https://github.com/hasherezade/hollows_hunter" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">hollows_hunter</a>, we can see that there are some implants in the memory of those processes:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/scanned_list.png" class="wp-image-38689" alt="" width="554" height="245"/></figure>     <p>Indeed, if we take a look inside each process&#8217; memory (with the help of Process Hacker), we can see atypical executable elements:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/malware_modules_implanted.png" class="wp-image-38684" alt="" width="840" height="297"/></figure>     <p>Some of them are lacking typical PE headers, for example:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/malware_module1.png" class="wp-image-38685" alt="" width="605" height="194"/></figure>     <p>But in addition to this, we can also find PE files implanted at unusual addresses in the memory:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/pe_files_injected.png" class="wp-image-38520" alt="" width="610" height="297"/></figure>     <p>Those manually-loaded PE files turned out to be legitimate DLLs: <a href="https://www.virustotal.com/#/file/bc0d5b5d63cf39bf2da62271f7ff8615bfd550a803a72ea70204746e03bfdfd2/details" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">OpenCL.dll</a> and <a rel="noreferrer noopener" aria-label="cudart32_80.dll (opens in a new tab)" href="https://www.virustotal.com/#/file/88931308f09fb89222a5a84e5ad9b6074f43db5dbc0f0f6321c5b58691dff2df/details" target="_blank">cudart32_80.dll</a> (NVIDIA CUDA Runtime, Version 8.0.61 ). CUDA is a technology belonging to NVidia graphic cards. So, their presence suggests that the malware uses GPU in order to boost the mining performance.</p>    <p>When we inspect the memory even closer, we see within the executable implants there are some strings referencing LUA components:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/lua_references-1.png" class="wp-image-38686" alt="" width="609" height="314"/></figure>     <p>Those strings are typical for the Hidden Bee miner, and they were also mentioned in <a rel="noreferrer noopener" aria-label="the previous reports (opens in a new tab)" href="https://www.freebuf.com/column/174581.html" target="_blank">the previous reports</a>.</p>    <p>We can also see the strings referencing the mining activity, i.e. the Cryptonight miner.</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/list.png" class="wp-image-38687" alt="" width="582" height="534"/></figure>     <p>List of modules:</p>   <pre class="wp-block-preformatted wp-block-preformatted">bin/i386/coredll.bin<br><a rel="noreferrer noopener" aria-label="dispatcher.lua (opens in a new tab)" href="https://gist.github.com/malwarezone/b83a5db804aa2379f4a4647aab18f771#file-dispatcher-lua" target="_blank">dispatcher.lua</a><br>bin/i386/ocl_detect.bin<br>bin/i386/cuda_detect.bin<br>bin/amd64/coredll.bin<br>bin/amd64/algo_cn_ocl.bin<br>lib/amd64/cudart64_80.dll<br>src/cryptonight.cl<br>src/cryptonight_r.cl<br>bin/i386/algo_cn_ocl.bin<br><a href="https://gist.github.com/malwarezone/b83a5db804aa2379f4a4647aab18f771#file-config-lua" target="_blank" rel="noreferrer noopener" aria-label="config.lua (opens in a new tab)">config.lua</a><br>lib/i386/cudart32_80.dll<br>src/CryptonightR.cu<br>bin/i386/algo_cn.bin<br>bin/amd64/precomp.bin<br>bin/amd64/ocl_detect.bin<br>bin/amd64/cuda_detect.bin<br>lib/amd64/opencl.dll<br>lib/i386/opencl.dll<br>bin/amd64/algo_cn.bin<br>bin/i386/precomp.bin</pre>   <p>And we can even retrieve the miner configuration:</p>    <figure class="wp-block-embed"> https://gist.github.com/malwarezone/b83a5db804aa2379f4a4647aab18f771#file-config-lua </figure>    <h3 class="wp-block-heading">Inside</h3>    <p>Hidden Bee has a long chain of components that finally lead to loading of the miner. On the way, we will find a variety of customized formats: data packages, executables, and filesystems. The filesystems are going to be mounted in the memory of the malware, and additional plugins and configuration are retrieved from there. Hidden Bee communicates with the C&amp;C to retrieve the modules&mdash;on the way also using its own TCP-based protocol.</p>    <p>The first part of the loading process is described by the following diagram:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><a href="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/retrieve_plugins.png"><img loading="lazy" decoding="async" class="wp-image-38885" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/retrieve_plugins.png" alt="" width="758" height="606"></a></figure>    <p>At the beginning, we can see the list of the plugins that are going to be loaded: <a rel="noreferrer noopener" aria-label="cloudcompute.api (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=62a44aace15cb728f1f5f96a1c2a4a37" target="_blank">cloudcompute.api</a>, <a rel="noreferrer noopener" aria-label="deepfreeze.api (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=95a2387f103608f6eebcc64a01aefece" target="_blank">deepfreeze.api,</a> and <a rel="noreferrer noopener" aria-label="netscan.api (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=4b2d33b818f53377620ac159e9f8a613" target="_blank">netscan.api</a>. Those names are being appended to the root path of the modules.</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/rootpath.png" class="wp-image-38679" alt="" width="385" height="122"/></figure>     <p>Each module is fetched from the mounted filesystem and loaded:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/load_plugin.png" class="wp-image-38886" alt="" width="821" height="290"/></figure>     <p>Consecutive modules are loaded one after another in the same executable memory area. After the module is loaded, its header is erased. It is a common technique used in order to make dumping of the payload from the memory more difficult.</p>    <p>The cloudcompute.api is a plugin that will load the miner. More about the plugins will be explained in the next section of this post.</p>    <p>Reading its code, we find out that the SPUTNIK modules are filesystems that can be mounted and dismounted on demand. This module will be communicating with others with the help of a named pipe. It will be receiving commands and executing appropriate handlers.</p>    <p>Initialization of the commands&#8217; parser:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_setup_commands.png" class="wp-image-38657" alt="" width="371" height="343"/></figure>     <p>The function setting up the commands: For each name, a handler is registered. (This is probably the Lua dispatcher, first described <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://www.freebuf.com/column/175106.html" target="_blank">here</a>.)</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/setup_commands-1.png" class="wp-image-38962" alt="" width="442" height="443"/></figure>     <p> When plugins are run, we can see some additional child processes created by the process running the coredll (in the analyzed case it is inside rundll32):</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/plugin_running.png" class="wp-image-38680" alt="" width="570" height="74"/></figure>     <p>Also it triggers a firewall alert, which means the malware requested to open some ports (triggered by netscan.api plugin):</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/open_ports.png" class="wp-image-38963" alt="" width="538" height="385"/></figure>     <p>We can see that it started listening on one TCP and one UDP port:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/socket.png" class="wp-image-38682" alt="" width="432" height="169"/></figure>     <h3 class="wp-block-heading">The plugins</h3>    <p>As mentioned in the previous section, the SPUTNIK filesystem contains three plugins: <a rel="noreferrer noopener" href="https://malshare.com/sample.php?action=detail&amp;hash=62a44aace15cb728f1f5f96a1c2a4a37" target="_blank">cloudcompute.api</a>, <a rel="noreferrer noopener" href="https://malshare.com/sample.php?action=detail&amp;hash=95a2387f103608f6eebcc64a01aefece" target="_blank">deepfreeze.api</a>, and <a rel="noreferrer noopener" href="https://malshare.com/sample.php?action=detail&amp;hash=4b2d33b818f53377620ac159e9f8a613" target="_blank">netscan.api</a>. If we convert them to PE, we can see that all of them import an unknown DLL: mpsi.dll. When we see the filled import table, we find out that the addresses have been filled redirecting to the functions from the previous NS module:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/mpsi_imports-1.png" class="wp-image-38891" alt="" width="486" height="270"/></figure>     <p>So we can conclude that the previous element is the mpsi.dll. Although its export table has been destroyed, the functions are fetched by the custom loader and filled in the import tables of the loaded plugins.</p>    <p>First the cloudcompute.api is run.</p>    <p>This plugin retrieves from the filesystem a file named &#8220;/etc/ccmain.json&#8221; that contains the list of URLs:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/next_part_addresses.png" class="wp-image-38887" alt="" width="535" height="386"/></figure>     <p>Those are addresses from which another set of modules is going to be downloaded:</p>   <pre class="wp-block-preformatted">["sstp://news.onetouchauthentication.online:443/mlf_plug.zip.sig","sstp://news.onetouchauthentication.club:443/mlf_plug.zip.sig","sstp://news.onetouchauthentication.icu:443/mlf_plug.zip.sig","sstp://news.onetouchauthentication.xyz:443/mlf_plug.zip.sig"]</pre>   <p>It also retrieves another component from the SPUTNIK filesystem: /bin/i386/ccmain.bin. This time, it is an executable in NE format (version converted to PE is available here: <a rel="noreferrer noopener" aria-label="367db629beedf528adaa021bdb7c12de (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=367db629beedf528adaa021bdb7c12de" target="_blank">367db629beedf528adaa021bdb7c12de</a>)</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/load_ccmain.png" class="wp-image-38892" alt="" width="600" height="309"/></figure>     <p>This is the component that is injected into msdtc.exe.</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/implanted_in_msdtc.png" class="wp-image-38893" alt="" width="621" height="295"/></figure>     <p>The configuration is also copied into the remote process and is used to retrieve an additional package from the C&amp;C:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_download_modules.png" class="wp-image-38894" alt="" width="524" height="496"/></figure>     <p>This is the plugin responsible for downloading and deploying the Mellifera Miner: core component of the Hidden Bee.</p>    <p>Next, the netscan.api loads module /bin/i386/kernelbase.bin (converted to PE: <a href="https://malshare.com/sample.php?action=detail&amp;hash=d7516ad354a3be2299759cd21e161a04" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">d7516ad354a3be2299759cd21e161a04</a>)</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/load_kernelbase.png" class="wp-image-38895" alt="" width="629" height="262"/></figure>     <h3 class="wp-block-heading">The miner in APT-style</h3>    <p>Hidden Bee is an eclectic malware. Although it is a commodity malware used for cryptocurrency mining, its design reminds us of espionage platforms used by APTs. Going through all its components is exhausting, but also fascinating. The authors are highly professional, not only as individuals but also as a team, because the design is consistent in all its complexity.</p>    <h3 class="wp-block-heading">Appendix</h3>    <p><a href="https://github.com/hasherezade/hidden_bee_tools" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">https://github.com/hasherezade/hidden_bee_tools</a> &#8211; helper tools for parsing and converting Hidden Bee custom formats</p>    <p><a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://www.bleepingcomputer.com/news/security/new-underminer-exploit-kit-discovered-pushing-bootkits-and-coinminers/" target="_blank">https://www.bleepingcomputer.com/news/security/new-underminer-exploit-kit-discovered-pushing-bootkits-and-coinminers/</a></p>    <p>Articles about the previous version (in Chinese):  </p>    <ul class="wp-block-list"><li><a href="https://www.freebuf.com/column/174581.html" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">https://www.freebuf.com/column/174581.html</a></li><li><a rel="noreferrer noopener" aria-label="https://www.freebuf.com/column/175106.html (opens in a new tab)" href="https://www.freebuf.com/column/175106.html" target="_blank">https://www.freebuf.com/column/175106.html</a></li></ul>    <p>Our first encounter with the Hidden Bee:</p>    <p><a href="https://www.malwarebytes.com/blog/threat-analysis/2018/07/hidden-bee-miner-delivered-via-improved-drive-by-download-toolkit/" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">/blog/threat-analysis/2018/07/hidden-bee-miner-delivered-via-improved-drive-by-download-toolkit/</a><br></p>                        
    <figure class="wp-block-image aligncenter size-full is-resized"><a href="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/custom_import_table1.png"><img loading="lazy" decoding="async" class="wp-image-38572" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/custom_import_table1.png" alt="" width="803" height="156"></a></figure>    <p>This custom format can also be converted back to the PE format with the help of a dedicated converter, available <a rel="noreferrer noopener" aria-label="here (opens in a new tab)" href="https://github.com/hasherezade/bee_parser/tree/master/bee_lvl2_converter" target="_blank">here</a>.</p>    <h4 class="wp-block-heading" id="mce_27">Third stage: core.sdb</h4>    <p>The core.sdb module converted to PE format is available here: <a href="https://malshare.com/sample.php?action=detail&amp;hash=a17645fac4bcb5253f36a654ea369bf9" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">a17645fac4bcb5253f36a654ea369bf9</a>.</p>    <p>The interesting part is that the external loader does not complete the full loading process of the module. It only copies the sections. But the rest of the module loading, such as applying relocations and filling imports, is done internally in the core.sdb. </p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/coresdb_at_ep_.png" class="wp-image-38549" alt="" width="281" height="139"/></figure>     <p>The previous component was supposed to pass to the core.sdb an additional buffer with the data about the installed service: the name and the path. During its execution, core.sdb will look up this data. If found, it will delete the previously-created service, and the initial file that started the infection:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/removing_the_service.png" class="wp-image-38948" alt="" width="473" height="630"/></figure>     <p>Getting rid of the previous persistence method suggests that it will be replaced by some different technique. Knowing previous editions of Hidden Bee, we can suspect that it may be a bootkit.</p>    <p>After locking the mutex in a format GlobalSC_{%08lx-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x}, the module proceeds to download another component. But before it goes to download, first, a few things are checked.</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/can_continue.png" class="wp-image-38552" alt="" width="693" height="442"/></figure>     <p>First of all, there is a defensive check if any of the known debuggers or sniffers are running. If so, the function quits. </p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/blacklisted_names.png" class="wp-image-38577" alt="" width="639" height="228"/></figure>     <p>Also, there is a check if the application can open a file &#8216;??NPF-{0179AC45-C226-48e3-A205-DCA79C824051}&#8217;.</p>    <p>If all the checks pass, the function proceeds and queries the following URL, where GET variables contain the system fingerprint:</p>    <p><code></code></p>    <p>The hash (sz=) is an MD5 generated from VolumeIDs. Then follows the (os=) identifying version of the operating system, and the identifier of the architecture (ar=), where 0 means 32 bit, 1 means 64bit.</p>    <p>The content downloaded from this URL (starting from a magic DWORD 0xFEEDFACE &#8211; <a rel="noreferrer noopener" aria-label="79e851622ac5298198c04034465017c0 (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=79e851622ac5298198c04034465017c0" target="_blank">79e851622ac5298198c04034465017c0</a>) contains the encrypted package (in !rbx format), and a shellcode that will be used to unpack it. The shellcode is loaded to the current process and then executed.</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/load_shellcode-1.png" class="wp-image-38946" alt="" width="588" height="294"/></figure>     <p>The shellcode&#8217;s start function uses three parameters: pointer to the functions in the previous module (core sdb), pointer to the buffer with encrypted data, size of the encrypted data.</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/calling_the_shellcode.png" class="wp-image-38947" alt="" width="581" height="274"/></figure>     <h4 class="wp-block-heading" id="mce_27">Fourth stage: the shellcode decrypting !rbx</h4>    <p>The beginning of the loaded shellcode:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/shellcode_bgn.png" class="wp-image-38942" alt="" width="397" height="206"/></figure>     <p>The shellcode does not fill any imports by itself. Instead, it fully relies on the functions from core.sdb module, to which it passes the pointer. It makes use of the following function: malloc, mecpy, memfree, VirtualAlloc. </p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/calling_via_coresdb.png" class="wp-image-38589" alt="" width="554" height="216"/></figure>     <p>Its role is to reveal another part. It comes in an encrypted package starting from a marker !rbx. The decryption function is called just at the beginning:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/decrypt_rbx.png" class="wp-image-38583" alt="" width="418" height="209"/></figure>     <p>First, the function checks the !rbx marker and the checksum at the beginning of the encrypted buffer:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/checking_the_marker.png" class="wp-image-38584" alt="" width="549" height="443"/></figure>     <p>It is decrypted with the help of RC4 algorithm, and then decompressed.</p>    <p>After decryption, the markers at the beginning of the buffer are checked. The expected format must start from predefined magic DWORDs: 0xCAFEBABE,0, 0xBABECAFE:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/check_format.png" class="wp-image-38943" alt="" width="590" height="517"/></figure>     <p><strong>The !rbx package format</strong></p>    <p>The !rbx is also a custom format with a consistent structure. </p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/copy_afer_rbx_hdr.png" class="wp-image-38590" alt="" width="616" height="140"/></figure>    <pre class="wp-block-preformatted wp-block-preformatted">DWORD magic; // "!rbx"<br>DWORD checksum;<br>DWORD content_size;<br>BYTE rc4_key[16];<br>DWORD out_size;<br>BYTE content[];</pre>   <p><strong>The custom file system (BABECAFE)</strong></p>    <p> <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=a93c90a210aed61255dc34102335af8d" target="_blank">The full decrypted content</a> has a consistent structure, reminiscent of a file system. According to the previous reports, earlier versions of Hidden Bee used to adapt the ROMS filesystem, adding few modifications. They called their customized version &#8220;Mixed ROM FS&#8221;. Now it seems that their customization process has progressed. Also the keywords suggesting ROMFS cannot be found. The headers starts from the markers in the form of three DWORDS: { 0xCAFEBABE, 0, 0xBABECAFE }.</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/checkibng_babecafe_format.png" class="wp-image-38588" alt="" width="461" height="325"/></figure>     <p>The layout of BABECAFE FS:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/babecafe_fs-1.png" class="wp-image-38592" alt="" width="750" height="489"/></figure>     <p>We notice that it differs at many points from <a rel="noreferrer noopener" aria-label="ROM FS (opens in a new tab)" href="http://lxr.linux.no/#linux+v4.15.14/Documentation/filesystems/romfs.txt" target="_blank">ROM FS</a>, from which it evolved.</p>    <p>The structure contains the following files:</p>    <p>/bin/amd64/coredll.bin<br> /bin/i386/coredll.bin<br> /bin/i386/preload<br> /bin/amd64/preload<br> /pkg/sputnik.spk<br> /installer/com_x86.dll (<a href="https://www.virustotal.com/#/file/04d62f3c9ab18370184a5aad9717434b5a8f71abadb92fcbc00b04d7dfa49a7d/details" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">6177bc527853fe0f648efd17534dd28b</a>)<br> /installer/com_x64.dll<br> /pkg/plugins.spk</p>    <p>The files /pkg/sputnik.spk and /pkg/plugins.spk are both compressed packages in a custom !rsi format.</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/rsi_package_bgn.png" class="wp-image-38628" alt="" width="613" height="102"/></figure>     <p>Each of the spk packages contain another custom filesystem, identified by the keyword SPUTNIK (possibly the extension &#8216;spk&#8217; is derived from the  SPUTNIK format). They will be unpacked during the next steps of the execution.</p>    <p>Unpacked plugins.spk: <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=4c01273fb77550132c42737912cbeb36" target="_blank">4c01273fb77550132c42737912cbeb36</a><br>Unpacked sputnik.spk: <a href="https://malshare.com/sample.php?action=detail&amp;hash=36f3247dad5ec73ed49c83e04b120523" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">36f3247dad5ec73ed49c83e04b120523</a>.</p>    <p><strong>Selecting and running modules</strong></p>    <p>Some executables stored in the filesystem are in two version: 32 and 64 bit. Only the modules relevant to the current architecture are loaded. So, in the analyzed case, the loader chooses first: /bin/i386/preload (shellcode) and /bin/i386/coredll.bin (a module in NS custom format). The names are hardcoded in the loader within the loading shellcode:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/loading_modules.png" class="wp-image-38585" alt="" width="622" height="573"/></figure>     <p>After the proper elements are fetched (preload and coredll.bin), they are copied together into a newly-allocated memory area. The coredll.bin is copied just after preload. Then, the preload module is called: </p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/call_preload.png" class="wp-image-38586" alt="" width="439" height="98"/></figure>     <p>The preload is position-independent, and its execution starts from the beginning of the page. </p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_enter_preload.png" class="wp-image-38602" alt="" width="537" height="261"/></figure>     <p>The only role of this shellcode is to prepare and run the coredll.bin. So, it contains a custom loader for the NS format that allocates another memory area and loads the NS file there.</p>    <h4 class="wp-block-heading" id="mce_27">Fifth stage: preload and coredll </h4>    <p>After loading coredll, preload redirects the execution there. <br></p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/coredll_ep.png" class="wp-image-38603" alt="" width="562" height="378"/></figure>     <p>The coredll patches a function inside the NTDLL&mdash; KiUserExceptionDispatcher&mdash;redirecting one of the inner calls to its own code:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/patched_kiuserdispatch.png" class="wp-image-38604" alt="" width="822" height="143"/></figure>     <p>Depending on which process the coredll was injected into, it can take one of a few paths of execution.</p>    <p>If it is running for the first time, it will try to inject itself again&mdash;this time into rundll32. For the purpose of the injection, it will again unpack the original !rbx package and use its original copy stored there.</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_unpack_rbx-1.png" class="wp-image-38606" alt="" width="327" height="146"/></figure>     <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/checking_magic.png" class="wp-image-38607" alt="" width="325" height="166"/></figure>     <p>Then it will choose the modules depending on the bitness of the rundll32: </p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/create_rundll32_suspended.png" class="wp-image-38617" alt="" width="620" height="324"/></figure>     <p>It selects the pair of modules (preload/coredll.bin) appropriate for the architecture, either from the directory amd64 or from i386:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/choose_modules.png" class="wp-image-38608" alt="" width="769" height="614"/></figure>     <p>If the injection failed, it makes another attempt, this time trying to inject into dllhost:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/try_inject.png" class="wp-image-38609" alt="" width="580" height="352"/></figure>     <p>Each time it uses the same, hardcoded parameter (<code>/Processid: {...}</code>) that is passed to the created process:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/with_processid.png" class="wp-image-38610" alt="" width="653" height="286"/></figure>     <p>The thread context of the target process is modified, and then the thread is resumed, running the injected content:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/injected_to_rundll32.png" class="wp-image-38611" alt="" width="529" height="46"/></figure>     <p>Now, when we look inside the memory of rundll32, we can find the preload and coredll being mapped:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/rundll32_injected_preload.png" class="wp-image-38612" alt="" width="589" height="190"/></figure>     <p>Inside the injected part, the execution follows a similar path: preload loads the coredll and redirects to its Entry Point. But then, another path of execution is taken.</p>    <p>The parameter passed to the coredll decides which round of execution it is. On the second round, another injection is made: this time to dllhost.exe. And finally, it proceeds to the final round, when other modules are unpacked from the BABECAFE filesystem.</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_unpack_spk.png" class="wp-image-38613" alt="" width="673" height="613"/></figure>     <p>The unpacking function first searches by name for two more modules: sputnik.spk and plugins.spk. They are both in the mysterious !rsi format, which reminds us of !rbx, but has a slightly different structure.</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/find_sputnik_and_plugins.png" class="wp-image-38614" alt="" width="475" height="465"/></figure>     <p>Entering the function unpacking the first !rsi package:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_unpack_rsi.png" class="wp-image-38616" alt="" width="522" height="300"/></figure>     <p>The function unpacking the !rsi format is structured similarly to the !rbx unpacking. It also starts from checking the keyword:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/check_rsi_keyword.png" class="wp-image-38619" alt="" width="545" height="174"/></figure>     <p>As mentioned before, both !rsi packages are used to store filesystems marked with the keyword &#8220;SPUTNIK&#8221;. It is another custom filesystem invented by the Hidden Bee authors that contain additional modules.  </p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/check_sputnik_keyword.png" class="wp-image-38941" alt="" width="334" height="117"/></figure>     <p>Unpacking the sputnik.spk resulted in getting the following SPUTNIK module: <a href="https://malshare.com/sample.php?action=detail&amp;hash=455738924b7665e1c15e30cf73c9c377" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">455738924b7665e1c15e30cf73c9c377</a></p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/check_sputnik_format.png" class="wp-image-38615" alt="" width="544" height="298"/></figure>     <p>It is worth noting that the unpacked filesystem has inside of it four executables: two pairs consisting of NS and PE, appropriately 32 and 64 bit. In the currently-analyzed setup, 32 bit versions are deployed. </p>    <p>The NS module will be the next to be run. First, it is loaded by the current executable, and then the execution is redirected there. Interestingly, both !rsi modules are passed as arguments to the entry point of the new module. (They will be used later to retrieve more components.)</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/call_another.png" class="wp-image-38882" alt="" width="559" height="313"/></figure>     <h4 class="wp-block-heading" id="mce_29">Sixth stage: mpsi.dll (unpacked from SPUTNIK)</h4>    <p>Entering into the NS module starts another layer of the malware:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/call_ns_ep.png" class="wp-image-38881" alt="" width="680" height="415"/></figure>     <p>The analyzed module, converted to PE is available here: <a href="https://malshare.com/sample.php?action=detail&amp;hash=455738924b7665e1c15e30cf73c9c377" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">537523ee256824e371d0bc16298b3849</a> </p>    <p>This module is responsible for loading plugins. It will also create a named pipe through which it is will communicate with other modules. It sets up the commands that are going to be executed on demand. </p>    <p>This is how the beginning of the main function looks:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/start_main.png" class="wp-image-38884" alt="" width="586" height="341"/></figure>     <p>Like in previous cases, it starts from finishing to load itself (relocations and imports). Then, it patches the function in NTDLL. This is a common prolog in many HiddenBee modules.</p>    <p>Then, we have another phase of loading elements from the supplied packages. The path that will be taken depends on the runtime arguments. If the function received both !rsi packages, it will start by parsing one of them, retrieving loading submodules.<br></p>    <p>First, the SPUTNIK filesystem must be unpacked from the !rsi package:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/unpack_and_mount_plugins.png" class="wp-image-38678" alt="" width="537" height="430"/></figure>     <p>After being unpacked, it is mounted. The filesystems are mounted internally in the memory: A global structure is filled with pointers to appropriate elements of the filesystem.</p>   <!-- wp:image --> <!-- wp:image {"align":"center","width":758,"height":606,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><a href="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/retrieve_plugins.png"><img loading="lazy" decoding="async" class="wp-image-38885" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/retrieve_plugins.png" alt="" width="758" height="606"></a></figure> <!-- /wp:image -->   <!-- wp:paragraph --><p>At the beginning, we can see the list of the plugins that are going to be loaded: <a rel="noreferrer noopener" aria-label="cloudcompute.api (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=62a44aace15cb728f1f5f96a1c2a4a37" target="_blank">cloudcompute.api</a>, <a rel="noreferrer noopener" aria-label="deepfreeze.api (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=95a2387f103608f6eebcc64a01aefece" target="_blank">deepfreeze.api,</a> and <a rel="noreferrer noopener" aria-label="netscan.api (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=4b2d33b818f53377620ac159e9f8a613" target="_blank">netscan.api</a>. Those names are being appended to the root path of the modules.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":385,"height":122,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/rootpath.png" class="wp-image-38679" alt="" width="385" height="122"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Each module is fetched from the mounted filesystem and loaded:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":821,"height":290,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/load_plugin.png" class="wp-image-38886" alt="" width="821" height="290"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Consecutive modules are loaded one after another in the same executable memory area. After the module is loaded, its header is erased. It is a common technique used in order to make dumping of the payload from the memory more difficult.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The cloudcompute.api is a plugin that will load the miner. More about the plugins will be explained in the next section of this post.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Reading its code, we find out that the SPUTNIK modules are filesystems that can be mounted and dismounted on demand. This module will be communicating with others with the help of a named pipe. It will be receiving commands and executing appropriate handlers.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Initialization of the commands&#8217; parser:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":371,"height":343,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_setup_commands.png" class="wp-image-38657" alt="" width="371" height="343"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The function setting up the commands: For each name, a handler is registered. (This is probably the Lua dispatcher, first described <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://www.freebuf.com/column/175106.html" target="_blank">here</a>.)</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":442,"height":443,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/setup_commands-1.png" class="wp-image-38962" alt="" width="442" height="443"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p> When plugins are run, we can see some additional child processes created by the process running the coredll (in the analyzed case it is inside rundll32):</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":570,"height":74,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/plugin_running.png" class="wp-image-38680" alt="" width="570" height="74"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Also it triggers a firewall alert, which means the malware requested to open some ports (triggered by netscan.api plugin):</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":538,"height":385,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/open_ports.png" class="wp-image-38963" alt="" width="538" height="385"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>We can see that it started listening on one TCP and one UDP port:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":432,"height":169,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/socket.png" class="wp-image-38682" alt="" width="432" height="169"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:heading {"level":3} --><h3>The plugins</h3><!-- /wp:heading -->    <!-- wp:paragraph --><p>As mentioned in the previous section, the SPUTNIK filesystem contains three plugins: <a rel="noreferrer noopener" href="https://malshare.com/sample.php?action=detail&amp;hash=62a44aace15cb728f1f5f96a1c2a4a37" target="_blank">cloudcompute.api</a>, <a rel="noreferrer noopener" href="https://malshare.com/sample.php?action=detail&amp;hash=95a2387f103608f6eebcc64a01aefece" target="_blank">deepfreeze.api</a>, and <a rel="noreferrer noopener" href="https://malshare.com/sample.php?action=detail&amp;hash=4b2d33b818f53377620ac159e9f8a613" target="_blank">netscan.api</a>. If we convert them to PE, we can see that all of them import an unknown DLL: mpsi.dll. When we see the filled import table, we find out that the addresses have been filled redirecting to the functions from the previous NS module:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":486,"height":270,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/mpsi_imports-1.png" class="wp-image-38891" alt="" width="486" height="270"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>So we can conclude that the previous element is the mpsi.dll. Although its export table has been destroyed, the functions are fetched by the custom loader and filled in the import tables of the loaded plugins.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>First the cloudcompute.api is run.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>This plugin retrieves from the filesystem a file named &#8220;/etc/ccmain.json&#8221; that contains the list of URLs:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":535,"height":386,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/next_part_addresses.png" class="wp-image-38887" alt="" width="535" height="386"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Those are addresses from which another set of modules is going to be downloaded:</p><!-- /wp:paragraph -->   <!-- wp:preformatted --><pre class="wp-block-preformatted">["sstp://news.onetouchauthentication.online:443/mlf_plug.zip.sig","sstp://news.onetouchauthentication.club:443/mlf_plug.zip.sig","sstp://news.onetouchauthentication.icu:443/mlf_plug.zip.sig","sstp://news.onetouchauthentication.xyz:443/mlf_plug.zip.sig"]</pre><!-- /wp:preformatted -->   <!-- wp:paragraph --><p>It also retrieves another component from the SPUTNIK filesystem: /bin/i386/ccmain.bin. This time, it is an executable in NE format (version converted to PE is available here: <a rel="noreferrer noopener" aria-label="367db629beedf528adaa021bdb7c12de (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=367db629beedf528adaa021bdb7c12de" target="_blank">367db629beedf528adaa021bdb7c12de</a>)</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":600,"height":309,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/load_ccmain.png" class="wp-image-38892" alt="" width="600" height="309"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>This is the component that is injected into msdtc.exe.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":621,"height":295,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/implanted_in_msdtc.png" class="wp-image-38893" alt="" width="621" height="295"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The configuration is also copied into the remote process and is used to retrieve an additional package from the C&amp;C:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":524,"height":496,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_download_modules.png" class="wp-image-38894" alt="" width="524" height="496"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>This is the plugin responsible for downloading and deploying the Mellifera Miner: core component of the Hidden Bee.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Next, the netscan.api loads module /bin/i386/kernelbase.bin (converted to PE: <a href="https://malshare.com/sample.php?action=detail&amp;hash=d7516ad354a3be2299759cd21e161a04" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">d7516ad354a3be2299759cd21e161a04</a>)</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":629,"height":262,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/load_kernelbase.png" class="wp-image-38895" alt="" width="629" height="262"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:heading {"level":3} --><h3>The miner in APT-style</h3><!-- /wp:heading -->    <!-- wp:paragraph --><p>Hidden Bee is an eclectic malware. Although it is a commodity malware used for cryptocurrency mining, its design reminds us of espionage platforms used by APTs. Going through all its components is exhausting, but also fascinating. The authors are highly professional, not only as individuals but also as a team, because the design is consistent in all its complexity.</p><!-- /wp:paragraph -->    <!-- wp:heading {"level":3} --><h3>Appendix</h3><!-- /wp:heading -->    <!-- wp:paragraph --><p><a href="https://github.com/hasherezade/hidden_bee_tools" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">https://github.com/hasherezade/hidden_bee_tools</a> &#8211; helper tools for parsing and converting Hidden Bee custom formats</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p><a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://www.bleepingcomputer.com/news/security/new-underminer-exploit-kit-discovered-pushing-bootkits-and-coinminers/" target="_blank">https://www.bleepingcomputer.com/news/security/new-underminer-exploit-kit-discovered-pushing-bootkits-and-coinminers/</a></p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Articles about the previous version (in Chinese):  </p><!-- /wp:paragraph -->    <!-- wp:list --><ul><!-- wp:list-item --><li><a href="https://www.freebuf.com/column/174581.html" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">https://www.freebuf.com/column/174581.html</a></li><!-- /wp:list-item --><!-- wp:list-item --><li><a rel="noreferrer noopener" aria-label="https://www.freebuf.com/column/175106.html (opens in a new tab)" href="https://www.freebuf.com/column/175106.html" target="_blank">https://www.freebuf.com/column/175106.html</a></li><!-- /wp:list-item --></ul><!-- /wp:list -->    <!-- wp:paragraph --><p>Our first encounter with the Hidden Bee:</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p><a href="https://www.malwarebytes.com/blog/threat-analysis/2018/07/hidden-bee-miner-delivered-via-improved-drive-by-download-toolkit/" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">/blog/threat-analysis/2018/07/hidden-bee-miner-delivered-via-improved-drive-by-download-toolkit/</a><br></p><!-- /wp:paragraph -->                        
    <figure class="wp-block-image aligncenter size-full is-resized"><a href="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/core_sdb.png"><img loading="lazy" decoding="async" class="wp-image-38919" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/core_sdb.png" alt="" width="769" height="494"></a></figure>    <p>We can see that the changes in the PE headers are bigger and more lossy&mdash;only minimalist information is maintained. Only few Data Directories are left. Also the sections table is shrunk: Each section header contains only four out of nine fields that are in the original PE. </p>    <p>Additionally, the format allows to pass a runtime argument from the loader to the payload via header: The pointer is saved into an additional field (marked &#8220;Filled Data&#8221; on the picture).</p>    <p>Not only is the PE header shrunk. Similar customization is done on the Import Table:</p>   <!-- wp:image --> <!-- wp:image {"align":"center","width":803,"height":156,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><a href="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/custom_import_table1.png"><img loading="lazy" decoding="async" class="wp-image-38572" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/custom_import_table1.png" alt="" width="803" height="156"></a></figure> <!-- /wp:image -->   <!-- wp:paragraph --><p>This custom format can also be converted back to the PE format with the help of a dedicated converter, available <a rel="noreferrer noopener" aria-label="here (opens in a new tab)" href="https://github.com/hasherezade/bee_parser/tree/master/bee_lvl2_converter" target="_blank">here</a>.</p><!-- /wp:paragraph -->    <!-- wp:heading {"level":4} --><h4 id="mce_27">Third stage: core.sdb</h4><!-- /wp:heading -->    <!-- wp:paragraph --><p>The core.sdb module converted to PE format is available here: <a href="https://malshare.com/sample.php?action=detail&amp;hash=a17645fac4bcb5253f36a654ea369bf9" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">a17645fac4bcb5253f36a654ea369bf9</a>.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The interesting part is that the external loader does not complete the full loading process of the module. It only copies the sections. But the rest of the module loading, such as applying relocations and filling imports, is done internally in the core.sdb. </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":281,"height":139,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/coresdb_at_ep_.png" class="wp-image-38549" alt="" width="281" height="139"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The previous component was supposed to pass to the core.sdb an additional buffer with the data about the installed service: the name and the path. During its execution, core.sdb will look up this data. If found, it will delete the previously-created service, and the initial file that started the infection:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":473,"height":630,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/removing_the_service.png" class="wp-image-38948" alt="" width="473" height="630"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Getting rid of the previous persistence method suggests that it will be replaced by some different technique. Knowing previous editions of Hidden Bee, we can suspect that it may be a bootkit.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>After locking the mutex in a format GlobalSC_{%08lx-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x}, the module proceeds to download another component. But before it goes to download, first, a few things are checked.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":693,"height":442,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/can_continue.png" class="wp-image-38552" alt="" width="693" height="442"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>First of all, there is a defensive check if any of the known debuggers or sniffers are running. If so, the function quits. </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":639,"height":228,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/blacklisted_names.png" class="wp-image-38577" alt="" width="639" height="228"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Also, there is a check if the application can open a file &#8216;??NPF-{0179AC45-C226-48e3-A205-DCA79C824051}&#8217;.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>If all the checks pass, the function proceeds and queries the following URL, where GET variables contain the system fingerprint:</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p><code></code></p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The hash (sz=) is an MD5 generated from VolumeIDs. Then follows the (os=) identifying version of the operating system, and the identifier of the architecture (ar=), where 0 means 32 bit, 1 means 64bit.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The content downloaded from this URL (starting from a magic DWORD 0xFEEDFACE &#8211; <a rel="noreferrer noopener" aria-label="79e851622ac5298198c04034465017c0 (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=79e851622ac5298198c04034465017c0" target="_blank">79e851622ac5298198c04034465017c0</a>) contains the encrypted package (in !rbx format), and a shellcode that will be used to unpack it. The shellcode is loaded to the current process and then executed.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":588,"height":294,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/load_shellcode-1.png" class="wp-image-38946" alt="" width="588" height="294"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The shellcode&#8217;s start function uses three parameters: pointer to the functions in the previous module (core sdb), pointer to the buffer with encrypted data, size of the encrypted data.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":581,"height":274,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/calling_the_shellcode.png" class="wp-image-38947" alt="" width="581" height="274"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:heading {"level":4} --><h4 id="mce_27">Fourth stage: the shellcode decrypting !rbx</h4><!-- /wp:heading -->    <!-- wp:paragraph --><p>The beginning of the loaded shellcode:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":397,"height":206,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/shellcode_bgn.png" class="wp-image-38942" alt="" width="397" height="206"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The shellcode does not fill any imports by itself. Instead, it fully relies on the functions from core.sdb module, to which it passes the pointer. It makes use of the following function: malloc, mecpy, memfree, VirtualAlloc. </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":554,"height":216,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/calling_via_coresdb.png" class="wp-image-38589" alt="" width="554" height="216"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Its role is to reveal another part. It comes in an encrypted package starting from a marker !rbx. The decryption function is called just at the beginning:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":418,"height":209,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/decrypt_rbx.png" class="wp-image-38583" alt="" width="418" height="209"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>First, the function checks the !rbx marker and the checksum at the beginning of the encrypted buffer:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":549,"height":443,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/checking_the_marker.png" class="wp-image-38584" alt="" width="549" height="443"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>It is decrypted with the help of RC4 algorithm, and then decompressed.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>After decryption, the markers at the beginning of the buffer are checked. The expected format must start from predefined magic DWORDs: 0xCAFEBABE,0, 0xBABECAFE:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":590,"height":517,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/check_format.png" class="wp-image-38943" alt="" width="590" height="517"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p><strong>The !rbx package format</strong></p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The !rbx is also a custom format with a consistent structure. </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":616,"height":140,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/copy_afer_rbx_hdr.png" class="wp-image-38590" alt="" width="616" height="140"/></figure> <!-- /wp:image --> <!-- /wp:image -->  <!-- wp:preformatted {"className": "wp-block-preformatted"} --><pre class="wp-block-preformatted wp-block-preformatted">DWORD magic; // "!rbx"<br>DWORD checksum;<br>DWORD content_size;<br>BYTE rc4_key[16];<br>DWORD out_size;<br>BYTE content[];</pre><!-- /wp:preformatted -->   <!-- wp:paragraph --><p><strong>The custom file system (BABECAFE)</strong></p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p> <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=a93c90a210aed61255dc34102335af8d" target="_blank">The full decrypted content</a> has a consistent structure, reminiscent of a file system. According to the previous reports, earlier versions of Hidden Bee used to adapt the ROMS filesystem, adding few modifications. They called their customized version &#8220;Mixed ROM FS&#8221;. Now it seems that their customization process has progressed. Also the keywords suggesting ROMFS cannot be found. The headers starts from the markers in the form of three DWORDS: { 0xCAFEBABE, 0, 0xBABECAFE }.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":461,"height":325,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/checkibng_babecafe_format.png" class="wp-image-38588" alt="" width="461" height="325"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The layout of BABECAFE FS:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":750,"height":489,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/babecafe_fs-1.png" class="wp-image-38592" alt="" width="750" height="489"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>We notice that it differs at many points from <a rel="noreferrer noopener" aria-label="ROM FS (opens in a new tab)" href="http://lxr.linux.no/#linux+v4.15.14/Documentation/filesystems/romfs.txt" target="_blank">ROM FS</a>, from which it evolved.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The structure contains the following files:</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>/bin/amd64/coredll.bin<br> /bin/i386/coredll.bin<br> /bin/i386/preload<br> /bin/amd64/preload<br> /pkg/sputnik.spk<br> /installer/com_x86.dll (<a href="https://www.virustotal.com/#/file/04d62f3c9ab18370184a5aad9717434b5a8f71abadb92fcbc00b04d7dfa49a7d/details" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">6177bc527853fe0f648efd17534dd28b</a>)<br> /installer/com_x64.dll<br> /pkg/plugins.spk</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The files /pkg/sputnik.spk and /pkg/plugins.spk are both compressed packages in a custom !rsi format.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":613,"height":102,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/rsi_package_bgn.png" class="wp-image-38628" alt="" width="613" height="102"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Each of the spk packages contain another custom filesystem, identified by the keyword SPUTNIK (possibly the extension &#8216;spk&#8217; is derived from the  SPUTNIK format). They will be unpacked during the next steps of the execution.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Unpacked plugins.spk: <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=4c01273fb77550132c42737912cbeb36" target="_blank">4c01273fb77550132c42737912cbeb36</a><br>Unpacked sputnik.spk: <a href="https://malshare.com/sample.php?action=detail&amp;hash=36f3247dad5ec73ed49c83e04b120523" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">36f3247dad5ec73ed49c83e04b120523</a>.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p><strong>Selecting and running modules</strong></p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Some executables stored in the filesystem are in two version: 32 and 64 bit. Only the modules relevant to the current architecture are loaded. So, in the analyzed case, the loader chooses first: /bin/i386/preload (shellcode) and /bin/i386/coredll.bin (a module in NS custom format). The names are hardcoded in the loader within the loading shellcode:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":622,"height":573,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/loading_modules.png" class="wp-image-38585" alt="" width="622" height="573"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>After the proper elements are fetched (preload and coredll.bin), they are copied together into a newly-allocated memory area. The coredll.bin is copied just after preload. Then, the preload module is called: </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":439,"height":98,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/call_preload.png" class="wp-image-38586" alt="" width="439" height="98"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The preload is position-independent, and its execution starts from the beginning of the page. </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":537,"height":261,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_enter_preload.png" class="wp-image-38602" alt="" width="537" height="261"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The only role of this shellcode is to prepare and run the coredll.bin. So, it contains a custom loader for the NS format that allocates another memory area and loads the NS file there.</p><!-- /wp:paragraph -->    <!-- wp:heading {"level":4} --><h4 id="mce_27">Fifth stage: preload and coredll </h4><!-- /wp:heading -->    <!-- wp:paragraph --><p>After loading coredll, preload redirects the execution there. <br></p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":562,"height":378,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/coredll_ep.png" class="wp-image-38603" alt="" width="562" height="378"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The coredll patches a function inside the NTDLL&mdash; KiUserExceptionDispatcher&mdash;redirecting one of the inner calls to its own code:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":822,"height":143,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/patched_kiuserdispatch.png" class="wp-image-38604" alt="" width="822" height="143"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Depending on which process the coredll was injected into, it can take one of a few paths of execution.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>If it is running for the first time, it will try to inject itself again&mdash;this time into rundll32. For the purpose of the injection, it will again unpack the original !rbx package and use its original copy stored there.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":327,"height":146,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_unpack_rbx-1.png" class="wp-image-38606" alt="" width="327" height="146"/></figure> <!-- /wp:image --> <!-- /wp:image -->  <!-- wp:image --> <!-- wp:image {"align":"center","width":325,"height":166,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/checking_magic.png" class="wp-image-38607" alt="" width="325" height="166"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Then it will choose the modules depending on the bitness of the rundll32: </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":620,"height":324,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/create_rundll32_suspended.png" class="wp-image-38617" alt="" width="620" height="324"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>It selects the pair of modules (preload/coredll.bin) appropriate for the architecture, either from the directory amd64 or from i386:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":769,"height":614,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/choose_modules.png" class="wp-image-38608" alt="" width="769" height="614"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>If the injection failed, it makes another attempt, this time trying to inject into dllhost:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":580,"height":352,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/try_inject.png" class="wp-image-38609" alt="" width="580" height="352"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Each time it uses the same, hardcoded parameter (<code>/Processid: {...}</code>) that is passed to the created process:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":653,"height":286,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/with_processid.png" class="wp-image-38610" alt="" width="653" height="286"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The thread context of the target process is modified, and then the thread is resumed, running the injected content:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":529,"height":46,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/injected_to_rundll32.png" class="wp-image-38611" alt="" width="529" height="46"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Now, when we look inside the memory of rundll32, we can find the preload and coredll being mapped:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":589,"height":190,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/rundll32_injected_preload.png" class="wp-image-38612" alt="" width="589" height="190"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Inside the injected part, the execution follows a similar path: preload loads the coredll and redirects to its Entry Point. But then, another path of execution is taken.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The parameter passed to the coredll decides which round of execution it is. On the second round, another injection is made: this time to dllhost.exe. And finally, it proceeds to the final round, when other modules are unpacked from the BABECAFE filesystem.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":673,"height":613,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_unpack_spk.png" class="wp-image-38613" alt="" width="673" height="613"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The unpacking function first searches by name for two more modules: sputnik.spk and plugins.spk. They are both in the mysterious !rsi format, which reminds us of !rbx, but has a slightly different structure.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":475,"height":465,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/find_sputnik_and_plugins.png" class="wp-image-38614" alt="" width="475" height="465"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Entering the function unpacking the first !rsi package:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":522,"height":300,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_unpack_rsi.png" class="wp-image-38616" alt="" width="522" height="300"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The function unpacking the !rsi format is structured similarly to the !rbx unpacking. It also starts from checking the keyword:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":545,"height":174,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/check_rsi_keyword.png" class="wp-image-38619" alt="" width="545" height="174"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>As mentioned before, both !rsi packages are used to store filesystems marked with the keyword &#8220;SPUTNIK&#8221;. It is another custom filesystem invented by the Hidden Bee authors that contain additional modules.  </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":334,"height":117,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/check_sputnik_keyword.png" class="wp-image-38941" alt="" width="334" height="117"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Unpacking the sputnik.spk resulted in getting the following SPUTNIK module: <a href="https://malshare.com/sample.php?action=detail&amp;hash=455738924b7665e1c15e30cf73c9c377" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">455738924b7665e1c15e30cf73c9c377</a></p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":544,"height":298,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/check_sputnik_format.png" class="wp-image-38615" alt="" width="544" height="298"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>It is worth noting that the unpacked filesystem has inside of it four executables: two pairs consisting of NS and PE, appropriately 32 and 64 bit. In the currently-analyzed setup, 32 bit versions are deployed. </p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The NS module will be the next to be run. First, it is loaded by the current executable, and then the execution is redirected there. Interestingly, both !rsi modules are passed as arguments to the entry point of the new module. (They will be used later to retrieve more components.)</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":559,"height":313,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/call_another.png" class="wp-image-38882" alt="" width="559" height="313"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:heading {"level":4} --><h4 id="mce_29">Sixth stage: mpsi.dll (unpacked from SPUTNIK)</h4><!-- /wp:heading -->    <!-- wp:paragraph --><p>Entering into the NS module starts another layer of the malware:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":680,"height":415,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/call_ns_ep.png" class="wp-image-38881" alt="" width="680" height="415"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The analyzed module, converted to PE is available here: <a href="https://malshare.com/sample.php?action=detail&amp;hash=455738924b7665e1c15e30cf73c9c377" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">537523ee256824e371d0bc16298b3849</a> </p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>This module is responsible for loading plugins. It will also create a named pipe through which it is will communicate with other modules. It sets up the commands that are going to be executed on demand. </p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>This is how the beginning of the main function looks:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":586,"height":341,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/start_main.png" class="wp-image-38884" alt="" width="586" height="341"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Like in previous cases, it starts from finishing to load itself (relocations and imports). Then, it patches the function in NTDLL. This is a common prolog in many HiddenBee modules.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Then, we have another phase of loading elements from the supplied packages. The path that will be taken depends on the runtime arguments. If the function received both !rsi packages, it will start by parsing one of them, retrieving loading submodules.<br></p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>First, the SPUTNIK filesystem must be unpacked from the !rsi package:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":537,"height":430,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/unpack_and_mount_plugins.png" class="wp-image-38678" alt="" width="537" height="430"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>After being unpacked, it is mounted. The filesystems are mounted internally in the memory: A global structure is filled with pointers to appropriate elements of the filesystem.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":758,"height":606,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><a href="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/retrieve_plugins.png"><img loading="lazy" decoding="async" class="wp-image-38885" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/retrieve_plugins.png" alt="" width="758" height="606"></a></figure> <!-- /wp:image -->   <!-- wp:paragraph --><p>At the beginning, we can see the list of the plugins that are going to be loaded: <a rel="noreferrer noopener" aria-label="cloudcompute.api (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=62a44aace15cb728f1f5f96a1c2a4a37" target="_blank">cloudcompute.api</a>, <a rel="noreferrer noopener" aria-label="deepfreeze.api (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=95a2387f103608f6eebcc64a01aefece" target="_blank">deepfreeze.api,</a> and <a rel="noreferrer noopener" aria-label="netscan.api (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=4b2d33b818f53377620ac159e9f8a613" target="_blank">netscan.api</a>. Those names are being appended to the root path of the modules.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":385,"height":122,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/rootpath.png" class="wp-image-38679" alt="" width="385" height="122"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Each module is fetched from the mounted filesystem and loaded:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":821,"height":290,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/load_plugin.png" class="wp-image-38886" alt="" width="821" height="290"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Consecutive modules are loaded one after another in the same executable memory area. After the module is loaded, its header is erased. It is a common technique used in order to make dumping of the payload from the memory more difficult.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The cloudcompute.api is a plugin that will load the miner. More about the plugins will be explained in the next section of this post.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Reading its code, we find out that the SPUTNIK modules are filesystems that can be mounted and dismounted on demand. This module will be communicating with others with the help of a named pipe. It will be receiving commands and executing appropriate handlers.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Initialization of the commands&#8217; parser:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":371,"height":343,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_setup_commands.png" class="wp-image-38657" alt="" width="371" height="343"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The function setting up the commands: For each name, a handler is registered. (This is probably the Lua dispatcher, first described <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://www.freebuf.com/column/175106.html" target="_blank">here</a>.)</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":442,"height":443,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/setup_commands-1.png" class="wp-image-38962" alt="" width="442" height="443"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p> When plugins are run, we can see some additional child processes created by the process running the coredll (in the analyzed case it is inside rundll32):</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":570,"height":74,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/plugin_running.png" class="wp-image-38680" alt="" width="570" height="74"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Also it triggers a firewall alert, which means the malware requested to open some ports (triggered by netscan.api plugin):</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":538,"height":385,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/open_ports.png" class="wp-image-38963" alt="" width="538" height="385"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>We can see that it started listening on one TCP and one UDP port:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":432,"height":169,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/socket.png" class="wp-image-38682" alt="" width="432" height="169"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:heading {"level":3} --><h3>The plugins</h3><!-- /wp:heading -->    <!-- wp:paragraph --><p>As mentioned in the previous section, the SPUTNIK filesystem contains three plugins: <a rel="noreferrer noopener" href="https://malshare.com/sample.php?action=detail&amp;hash=62a44aace15cb728f1f5f96a1c2a4a37" target="_blank">cloudcompute.api</a>, <a rel="noreferrer noopener" href="https://malshare.com/sample.php?action=detail&amp;hash=95a2387f103608f6eebcc64a01aefece" target="_blank">deepfreeze.api</a>, and <a rel="noreferrer noopener" href="https://malshare.com/sample.php?action=detail&amp;hash=4b2d33b818f53377620ac159e9f8a613" target="_blank">netscan.api</a>. If we convert them to PE, we can see that all of them import an unknown DLL: mpsi.dll. When we see the filled import table, we find out that the addresses have been filled redirecting to the functions from the previous NS module:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":486,"height":270,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/mpsi_imports-1.png" class="wp-image-38891" alt="" width="486" height="270"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>So we can conclude that the previous element is the mpsi.dll. Although its export table has been destroyed, the functions are fetched by the custom loader and filled in the import tables of the loaded plugins.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>First the cloudcompute.api is run.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>This plugin retrieves from the filesystem a file named &#8220;/etc/ccmain.json&#8221; that contains the list of URLs:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":535,"height":386,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/next_part_addresses.png" class="wp-image-38887" alt="" width="535" height="386"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Those are addresses from which another set of modules is going to be downloaded:</p><!-- /wp:paragraph -->   <!-- wp:preformatted --><pre class="wp-block-preformatted">["sstp://news.onetouchauthentication.online:443/mlf_plug.zip.sig","sstp://news.onetouchauthentication.club:443/mlf_plug.zip.sig","sstp://news.onetouchauthentication.icu:443/mlf_plug.zip.sig","sstp://news.onetouchauthentication.xyz:443/mlf_plug.zip.sig"]</pre><!-- /wp:preformatted -->   <!-- wp:paragraph --><p>It also retrieves another component from the SPUTNIK filesystem: /bin/i386/ccmain.bin. This time, it is an executable in NE format (version converted to PE is available here: <a rel="noreferrer noopener" aria-label="367db629beedf528adaa021bdb7c12de (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=367db629beedf528adaa021bdb7c12de" target="_blank">367db629beedf528adaa021bdb7c12de</a>)</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":600,"height":309,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/load_ccmain.png" class="wp-image-38892" alt="" width="600" height="309"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>This is the component that is injected into msdtc.exe.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":621,"height":295,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/implanted_in_msdtc.png" class="wp-image-38893" alt="" width="621" height="295"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The configuration is also copied into the remote process and is used to retrieve an additional package from the C&amp;C:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":524,"height":496,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_download_modules.png" class="wp-image-38894" alt="" width="524" height="496"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>This is the plugin responsible for downloading and deploying the Mellifera Miner: core component of the Hidden Bee.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Next, the netscan.api loads module /bin/i386/kernelbase.bin (converted to PE: <a href="https://malshare.com/sample.php?action=detail&amp;hash=d7516ad354a3be2299759cd21e161a04" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">d7516ad354a3be2299759cd21e161a04</a>)</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":629,"height":262,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/load_kernelbase.png" class="wp-image-38895" alt="" width="629" height="262"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:heading {"level":3} --><h3>The miner in APT-style</h3><!-- /wp:heading -->    <!-- wp:paragraph --><p>Hidden Bee is an eclectic malware. Although it is a commodity malware used for cryptocurrency mining, its design reminds us of espionage platforms used by APTs. Going through all its components is exhausting, but also fascinating. The authors are highly professional, not only as individuals but also as a team, because the design is consistent in all its complexity.</p><!-- /wp:paragraph -->    <!-- wp:heading {"level":3} --><h3>Appendix</h3><!-- /wp:heading -->    <!-- wp:paragraph --><p><a href="https://github.com/hasherezade/hidden_bee_tools" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">https://github.com/hasherezade/hidden_bee_tools</a> &#8211; helper tools for parsing and converting Hidden Bee custom formats</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p><a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://www.bleepingcomputer.com/news/security/new-underminer-exploit-kit-discovered-pushing-bootkits-and-coinminers/" target="_blank">https://www.bleepingcomputer.com/news/security/new-underminer-exploit-kit-discovered-pushing-bootkits-and-coinminers/</a></p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Articles about the previous version (in Chinese):  </p><!-- /wp:paragraph -->    <!-- wp:list --><ul><!-- wp:list-item --><li><a href="https://www.freebuf.com/column/174581.html" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">https://www.freebuf.com/column/174581.html</a></li><!-- /wp:list-item --><!-- wp:list-item --><li><a rel="noreferrer noopener" aria-label="https://www.freebuf.com/column/175106.html (opens in a new tab)" href="https://www.freebuf.com/column/175106.html" target="_blank">https://www.freebuf.com/column/175106.html</a></li><!-- /wp:list-item --></ul><!-- /wp:list -->    <!-- wp:paragraph --><p>Our first encounter with the Hidden Bee:</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p><a href="https://www.malwarebytes.com/blog/threat-analysis/2018/07/hidden-bee-miner-delivered-via-improved-drive-by-download-toolkit/" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">/blog/threat-analysis/2018/07/hidden-bee-miner-delivered-via-improved-drive-by-download-toolkit/</a><br></p><!-- /wp:paragraph -->                        
    <figure class="wp-block-image aligncenter size-full is-resized"><a href="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/bee_plugins-1.png"><img loading="lazy" decoding="async" class="wp-image-38910" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/bee_plugins-1.png" alt="" width="628" height="584"></a></figure>    <p>Starting the analysis from the loader, we will go down to the plugins, showing the inner workings of each element taking part in the loading process.</p>    <h3 class="wp-block-heading">The loader</h3>    <p>In contrast to most of the malware that we see nowadays, the loader is not packed by any crypter. According the header, it was compiled in November 2018.</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/04/compile_time.png" class="wp-image-38191" alt="" width="684" height="150"/></figure>     <p>While in the former edition the modules in the custom formats were dropped as separate files, this time the next stage is unpacked from inside the loader.</p>    <p> The loader is not obfuscated. Once we load it with typical tools (IDA), we can clearly see how the new format is loaded.</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/04/to_load_custom.png" class="wp-image-38187" alt="" width="306" height="123"/></figure>     <p>Section .shared contains the configuration:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/section_shared.png" class="wp-image-38533" alt="" width="881" height="539"/></figure>     <p>The configuration is decrypted with the help of XTEA algorithm.</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/decrypt_config.png" class="wp-image-38534" alt="" width="330" height="342"/></figure>     <p>The decrypted configuration must start from the magic WORD &#8220;pZ.&#8221; It contains the C&amp;C and the name under which the service will be installed:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/decrypted_config.png" class="wp-image-38535" alt="" width="450" height="261"/></figure>     <h4 class="wp-block-heading">Unscrambling the NE format</h4>    <p>The NE format <a href="https://www.freebuf.com/column/174581.html" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">was seen before</a>, in former editions of Hidden Bee. It is just a scrambled version of the PE. By observing which fields have been misplaced, we can easily reconstruct the original PE.</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/unpack_from_loader.png" class="wp-image-38522" alt="" width="628" height="409"/></figure>     <p>NE is one of the two similar formats being used by this malware. Another similar one starts from a DWORD 0x0EF1FAB9 and is used to further load components. Both of them have an analogical structure that comes from slightly modified PE format:</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/04/reconstruct_pe-1.png" class="wp-image-38213" alt="" width="706" height="320"/></figure>     <p>Header:  </p>   <pre class="wp-block-preformatted wp-block-preformatted">WORD magic; // 'NE'<br>WORD pe_offset;<br>WORD machine_id; </pre>   <p>The conversion back to PE format is trivial: It is enough to add the erased magic numbers: MZ and PE, and to move displaced fields to their original offsets. The tool that automatically does the mentioned conversion is available <a href="https://github.com/hasherezade/bee_parser/tree/master/bee_lvl2_converter" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">here</a>. </p>    <p>In the previous edition, the parts of Hidden Bee with analogical functionality were delivered in a different, more complex <a rel="noreferrer noopener" aria-label="another proprietary format used for the loader (opens in a new tab)" href="/blog/threat-analysis/2018/08/reversing-malware-in-a-custom-format-hidden-bee-elements/" target="_blank">proprietary format</a>  than the one currently being analyzed.</p>    <h4 class="wp-block-heading" id="mce_31">Second stage: a downloader (in NE format)</h4>    <p>As a result of the conversion, we get the following PE: (<a href="https://www.virustotal.com/#/file/3a1c218de4d653dff06a68cfc12b958766dcb869450c9dd06928be819beb365c/details" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">fddfd292eaf33a490224ebe5371d3275</a>). This module is a downloader of the next stage. The interesting thing is that the subsystem of this module is set as a driver, however, it is not loaded like a typical driver. The custom loader loads it into a user space just like any typical userland component.</p>    <p>The function at the module&#8217;s Entry Point is called with three parameters. The first is a path of the main module. Then, the parameters from the configuration are passed. Example:</p>   <pre class="wp-block-preformatted">0012FE9C     00601A34  UNICODE ""C:UserstesterDesktopnew_bee.exe""<br>0012FEA0     00407104  UNICODE "NAPCUYWKOxywEgrO"<br>0012FEA4     00407004  UNICODE "118.41.45.124:9000"</pre>   <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/call_module_ep.png" class="wp-image-38541" alt="" width="725" height="172"/></figure>     <p>The execution of the module can take one of the two paths. The first one is meant for adding persistence: The module installs itself as a service.</p>    <p>If the module detects that it is already running as a service, it takes the second path. In such a case, it proceeds to download the next module from the server. The next module is packed as as Cabinet file.</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_unpack_cabinet.png" class="wp-image-38538" alt="" width="611" height="534"/></figure>     <p>It is first unpacked into a file named &#8220;core.sdb&#8221;. The unpacked module is in a customized format based on PE. This time, the format has a different signature: &#8220;NS&#8221; and it is different from the aforementioned &#8220;NE&#8221; format (detailed explanation will be given further).</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/unpacked_NS_file.png" class="wp-image-38540" alt="" width="600" height="227"/></figure>     <p>It is loaded by the proprietary loader.</p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/check_ns_sign.png" class="wp-image-38539" alt="" width="307" height="115"/></figure>     <p>The loader enumerates all the executables in a directory: <code>%Systemroot%Microsoft.NET</code> and selects the ones with the compatible bitness (in the analyzed case it was selecting 32bit PEs). Once it finds a suitable PE, it runs it and injects the payload there. The injected code is run by adding its entry point to APC queue. </p>    <figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/created_process.png" class="wp-image-38548" alt="" width="692" height="38"/></figure>     <p>In case it failed to find the suitable executable in that directory, it performs the injection into dllhost.exe instead.</p>    <h4 class="wp-block-heading" id="mce_22">Unscrambling the NS format</h4>    <p>As mentioned before, the core.sdb is in yet another format named NS. It is also a customized PE, however, this time the conversion is more complex than the NE format because more structures are customized. It looks like a next step in the evolution of the NE format.</p>   <!-- wp:image --> <!-- wp:image {"align":"center","width":769,"height":494,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><a href="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/core_sdb.png"><img loading="lazy" decoding="async" class="wp-image-38919" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/core_sdb.png" alt="" width="769" height="494"></a></figure> <!-- /wp:image -->   <!-- wp:paragraph --><p>We can see that the changes in the PE headers are bigger and more lossy&mdash;only minimalist information is maintained. Only few Data Directories are left. Also the sections table is shrunk: Each section header contains only four out of nine fields that are in the original PE. </p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Additionally, the format allows to pass a runtime argument from the loader to the payload via header: The pointer is saved into an additional field (marked &#8220;Filled Data&#8221; on the picture).</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Not only is the PE header shrunk. Similar customization is done on the Import Table:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":803,"height":156,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><a href="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/custom_import_table1.png"><img loading="lazy" decoding="async" class="wp-image-38572" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/custom_import_table1.png" alt="" width="803" height="156"></a></figure> <!-- /wp:image -->   <!-- wp:paragraph --><p>This custom format can also be converted back to the PE format with the help of a dedicated converter, available <a rel="noreferrer noopener" aria-label="here (opens in a new tab)" href="https://github.com/hasherezade/bee_parser/tree/master/bee_lvl2_converter" target="_blank">here</a>.</p><!-- /wp:paragraph -->    <!-- wp:heading {"level":4} --><h4 id="mce_27">Third stage: core.sdb</h4><!-- /wp:heading -->    <!-- wp:paragraph --><p>The core.sdb module converted to PE format is available here: <a href="https://malshare.com/sample.php?action=detail&amp;hash=a17645fac4bcb5253f36a654ea369bf9" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">a17645fac4bcb5253f36a654ea369bf9</a>.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The interesting part is that the external loader does not complete the full loading process of the module. It only copies the sections. But the rest of the module loading, such as applying relocations and filling imports, is done internally in the core.sdb. </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":281,"height":139,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/coresdb_at_ep_.png" class="wp-image-38549" alt="" width="281" height="139"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The previous component was supposed to pass to the core.sdb an additional buffer with the data about the installed service: the name and the path. During its execution, core.sdb will look up this data. If found, it will delete the previously-created service, and the initial file that started the infection:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":473,"height":630,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/removing_the_service.png" class="wp-image-38948" alt="" width="473" height="630"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Getting rid of the previous persistence method suggests that it will be replaced by some different technique. Knowing previous editions of Hidden Bee, we can suspect that it may be a bootkit.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>After locking the mutex in a format GlobalSC_{%08lx-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x}, the module proceeds to download another component. But before it goes to download, first, a few things are checked.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":693,"height":442,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/can_continue.png" class="wp-image-38552" alt="" width="693" height="442"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>First of all, there is a defensive check if any of the known debuggers or sniffers are running. If so, the function quits. </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":639,"height":228,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/blacklisted_names.png" class="wp-image-38577" alt="" width="639" height="228"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Also, there is a check if the application can open a file &#8216;??NPF-{0179AC45-C226-48e3-A205-DCA79C824051}&#8217;.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>If all the checks pass, the function proceeds and queries the following URL, where GET variables contain the system fingerprint:</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p><code></code></p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The hash (sz=) is an MD5 generated from VolumeIDs. Then follows the (os=) identifying version of the operating system, and the identifier of the architecture (ar=), where 0 means 32 bit, 1 means 64bit.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The content downloaded from this URL (starting from a magic DWORD 0xFEEDFACE &#8211; <a rel="noreferrer noopener" aria-label="79e851622ac5298198c04034465017c0 (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=79e851622ac5298198c04034465017c0" target="_blank">79e851622ac5298198c04034465017c0</a>) contains the encrypted package (in !rbx format), and a shellcode that will be used to unpack it. The shellcode is loaded to the current process and then executed.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":588,"height":294,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/load_shellcode-1.png" class="wp-image-38946" alt="" width="588" height="294"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The shellcode&#8217;s start function uses three parameters: pointer to the functions in the previous module (core sdb), pointer to the buffer with encrypted data, size of the encrypted data.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":581,"height":274,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/calling_the_shellcode.png" class="wp-image-38947" alt="" width="581" height="274"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:heading {"level":4} --><h4 id="mce_27">Fourth stage: the shellcode decrypting !rbx</h4><!-- /wp:heading -->    <!-- wp:paragraph --><p>The beginning of the loaded shellcode:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":397,"height":206,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/shellcode_bgn.png" class="wp-image-38942" alt="" width="397" height="206"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The shellcode does not fill any imports by itself. Instead, it fully relies on the functions from core.sdb module, to which it passes the pointer. It makes use of the following function: malloc, mecpy, memfree, VirtualAlloc. </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":554,"height":216,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/calling_via_coresdb.png" class="wp-image-38589" alt="" width="554" height="216"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Its role is to reveal another part. It comes in an encrypted package starting from a marker !rbx. The decryption function is called just at the beginning:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":418,"height":209,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/decrypt_rbx.png" class="wp-image-38583" alt="" width="418" height="209"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>First, the function checks the !rbx marker and the checksum at the beginning of the encrypted buffer:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":549,"height":443,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/checking_the_marker.png" class="wp-image-38584" alt="" width="549" height="443"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>It is decrypted with the help of RC4 algorithm, and then decompressed.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>After decryption, the markers at the beginning of the buffer are checked. The expected format must start from predefined magic DWORDs: 0xCAFEBABE,0, 0xBABECAFE:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":590,"height":517,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/check_format.png" class="wp-image-38943" alt="" width="590" height="517"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p><strong>The !rbx package format</strong></p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The !rbx is also a custom format with a consistent structure. </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":616,"height":140,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/copy_afer_rbx_hdr.png" class="wp-image-38590" alt="" width="616" height="140"/></figure> <!-- /wp:image --> <!-- /wp:image -->  <!-- wp:preformatted {"className": "wp-block-preformatted"} --><pre class="wp-block-preformatted wp-block-preformatted">DWORD magic; // "!rbx"<br>DWORD checksum;<br>DWORD content_size;<br>BYTE rc4_key[16];<br>DWORD out_size;<br>BYTE content[];</pre><!-- /wp:preformatted -->   <!-- wp:paragraph --><p><strong>The custom file system (BABECAFE)</strong></p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p> <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=a93c90a210aed61255dc34102335af8d" target="_blank">The full decrypted content</a> has a consistent structure, reminiscent of a file system. According to the previous reports, earlier versions of Hidden Bee used to adapt the ROMS filesystem, adding few modifications. They called their customized version &#8220;Mixed ROM FS&#8221;. Now it seems that their customization process has progressed. Also the keywords suggesting ROMFS cannot be found. The headers starts from the markers in the form of three DWORDS: { 0xCAFEBABE, 0, 0xBABECAFE }.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":461,"height":325,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/checkibng_babecafe_format.png" class="wp-image-38588" alt="" width="461" height="325"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The layout of BABECAFE FS:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":750,"height":489,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/babecafe_fs-1.png" class="wp-image-38592" alt="" width="750" height="489"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>We notice that it differs at many points from <a rel="noreferrer noopener" aria-label="ROM FS (opens in a new tab)" href="http://lxr.linux.no/#linux+v4.15.14/Documentation/filesystems/romfs.txt" target="_blank">ROM FS</a>, from which it evolved.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The structure contains the following files:</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>/bin/amd64/coredll.bin<br> /bin/i386/coredll.bin<br> /bin/i386/preload<br> /bin/amd64/preload<br> /pkg/sputnik.spk<br> /installer/com_x86.dll (<a href="https://www.virustotal.com/#/file/04d62f3c9ab18370184a5aad9717434b5a8f71abadb92fcbc00b04d7dfa49a7d/details" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">6177bc527853fe0f648efd17534dd28b</a>)<br> /installer/com_x64.dll<br> /pkg/plugins.spk</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The files /pkg/sputnik.spk and /pkg/plugins.spk are both compressed packages in a custom !rsi format.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":613,"height":102,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/rsi_package_bgn.png" class="wp-image-38628" alt="" width="613" height="102"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Each of the spk packages contain another custom filesystem, identified by the keyword SPUTNIK (possibly the extension &#8216;spk&#8217; is derived from the  SPUTNIK format). They will be unpacked during the next steps of the execution.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Unpacked plugins.spk: <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=4c01273fb77550132c42737912cbeb36" target="_blank">4c01273fb77550132c42737912cbeb36</a><br>Unpacked sputnik.spk: <a href="https://malshare.com/sample.php?action=detail&amp;hash=36f3247dad5ec73ed49c83e04b120523" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">36f3247dad5ec73ed49c83e04b120523</a>.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p><strong>Selecting and running modules</strong></p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Some executables stored in the filesystem are in two version: 32 and 64 bit. Only the modules relevant to the current architecture are loaded. So, in the analyzed case, the loader chooses first: /bin/i386/preload (shellcode) and /bin/i386/coredll.bin (a module in NS custom format). The names are hardcoded in the loader within the loading shellcode:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":622,"height":573,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/loading_modules.png" class="wp-image-38585" alt="" width="622" height="573"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>After the proper elements are fetched (preload and coredll.bin), they are copied together into a newly-allocated memory area. The coredll.bin is copied just after preload. Then, the preload module is called: </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":439,"height":98,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/call_preload.png" class="wp-image-38586" alt="" width="439" height="98"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The preload is position-independent, and its execution starts from the beginning of the page. </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":537,"height":261,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_enter_preload.png" class="wp-image-38602" alt="" width="537" height="261"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The only role of this shellcode is to prepare and run the coredll.bin. So, it contains a custom loader for the NS format that allocates another memory area and loads the NS file there.</p><!-- /wp:paragraph -->    <!-- wp:heading {"level":4} --><h4 id="mce_27">Fifth stage: preload and coredll </h4><!-- /wp:heading -->    <!-- wp:paragraph --><p>After loading coredll, preload redirects the execution there. <br></p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":562,"height":378,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/coredll_ep.png" class="wp-image-38603" alt="" width="562" height="378"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The coredll patches a function inside the NTDLL&mdash; KiUserExceptionDispatcher&mdash;redirecting one of the inner calls to its own code:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":822,"height":143,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/patched_kiuserdispatch.png" class="wp-image-38604" alt="" width="822" height="143"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Depending on which process the coredll was injected into, it can take one of a few paths of execution.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>If it is running for the first time, it will try to inject itself again&mdash;this time into rundll32. For the purpose of the injection, it will again unpack the original !rbx package and use its original copy stored there.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":327,"height":146,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_unpack_rbx-1.png" class="wp-image-38606" alt="" width="327" height="146"/></figure> <!-- /wp:image --> <!-- /wp:image -->  <!-- wp:image --> <!-- wp:image {"align":"center","width":325,"height":166,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/checking_magic.png" class="wp-image-38607" alt="" width="325" height="166"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Then it will choose the modules depending on the bitness of the rundll32: </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":620,"height":324,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/create_rundll32_suspended.png" class="wp-image-38617" alt="" width="620" height="324"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>It selects the pair of modules (preload/coredll.bin) appropriate for the architecture, either from the directory amd64 or from i386:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":769,"height":614,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/choose_modules.png" class="wp-image-38608" alt="" width="769" height="614"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>If the injection failed, it makes another attempt, this time trying to inject into dllhost:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":580,"height":352,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/try_inject.png" class="wp-image-38609" alt="" width="580" height="352"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Each time it uses the same, hardcoded parameter (<code>/Processid: {...}</code>) that is passed to the created process:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":653,"height":286,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/with_processid.png" class="wp-image-38610" alt="" width="653" height="286"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The thread context of the target process is modified, and then the thread is resumed, running the injected content:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":529,"height":46,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/injected_to_rundll32.png" class="wp-image-38611" alt="" width="529" height="46"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Now, when we look inside the memory of rundll32, we can find the preload and coredll being mapped:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":589,"height":190,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/rundll32_injected_preload.png" class="wp-image-38612" alt="" width="589" height="190"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Inside the injected part, the execution follows a similar path: preload loads the coredll and redirects to its Entry Point. But then, another path of execution is taken.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The parameter passed to the coredll decides which round of execution it is. On the second round, another injection is made: this time to dllhost.exe. And finally, it proceeds to the final round, when other modules are unpacked from the BABECAFE filesystem.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":673,"height":613,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_unpack_spk.png" class="wp-image-38613" alt="" width="673" height="613"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The unpacking function first searches by name for two more modules: sputnik.spk and plugins.spk. They are both in the mysterious !rsi format, which reminds us of !rbx, but has a slightly different structure.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":475,"height":465,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/find_sputnik_and_plugins.png" class="wp-image-38614" alt="" width="475" height="465"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Entering the function unpacking the first !rsi package:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":522,"height":300,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_unpack_rsi.png" class="wp-image-38616" alt="" width="522" height="300"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The function unpacking the !rsi format is structured similarly to the !rbx unpacking. It also starts from checking the keyword:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":545,"height":174,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/check_rsi_keyword.png" class="wp-image-38619" alt="" width="545" height="174"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>As mentioned before, both !rsi packages are used to store filesystems marked with the keyword &#8220;SPUTNIK&#8221;. It is another custom filesystem invented by the Hidden Bee authors that contain additional modules.  </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":334,"height":117,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/check_sputnik_keyword.png" class="wp-image-38941" alt="" width="334" height="117"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Unpacking the sputnik.spk resulted in getting the following SPUTNIK module: <a href="https://malshare.com/sample.php?action=detail&amp;hash=455738924b7665e1c15e30cf73c9c377" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">455738924b7665e1c15e30cf73c9c377</a></p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":544,"height":298,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/check_sputnik_format.png" class="wp-image-38615" alt="" width="544" height="298"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>It is worth noting that the unpacked filesystem has inside of it four executables: two pairs consisting of NS and PE, appropriately 32 and 64 bit. In the currently-analyzed setup, 32 bit versions are deployed. </p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The NS module will be the next to be run. First, it is loaded by the current executable, and then the execution is redirected there. Interestingly, both !rsi modules are passed as arguments to the entry point of the new module. (They will be used later to retrieve more components.)</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":559,"height":313,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/call_another.png" class="wp-image-38882" alt="" width="559" height="313"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:heading {"level":4} --><h4 id="mce_29">Sixth stage: mpsi.dll (unpacked from SPUTNIK)</h4><!-- /wp:heading -->    <!-- wp:paragraph --><p>Entering into the NS module starts another layer of the malware:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":680,"height":415,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/call_ns_ep.png" class="wp-image-38881" alt="" width="680" height="415"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The analyzed module, converted to PE is available here: <a href="https://malshare.com/sample.php?action=detail&amp;hash=455738924b7665e1c15e30cf73c9c377" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">537523ee256824e371d0bc16298b3849</a> </p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>This module is responsible for loading plugins. It will also create a named pipe through which it is will communicate with other modules. It sets up the commands that are going to be executed on demand. </p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>This is how the beginning of the main function looks:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":586,"height":341,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/start_main.png" class="wp-image-38884" alt="" width="586" height="341"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Like in previous cases, it starts from finishing to load itself (relocations and imports). Then, it patches the function in NTDLL. This is a common prolog in many HiddenBee modules.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Then, we have another phase of loading elements from the supplied packages. The path that will be taken depends on the runtime arguments. If the function received both !rsi packages, it will start by parsing one of them, retrieving loading submodules.<br></p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>First, the SPUTNIK filesystem must be unpacked from the !rsi package:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":537,"height":430,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/unpack_and_mount_plugins.png" class="wp-image-38678" alt="" width="537" height="430"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>After being unpacked, it is mounted. The filesystems are mounted internally in the memory: A global structure is filled with pointers to appropriate elements of the filesystem.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":758,"height":606,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><a href="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/retrieve_plugins.png"><img loading="lazy" decoding="async" class="wp-image-38885" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/retrieve_plugins.png" alt="" width="758" height="606"></a></figure> <!-- /wp:image -->   <!-- wp:paragraph --><p>At the beginning, we can see the list of the plugins that are going to be loaded: <a rel="noreferrer noopener" aria-label="cloudcompute.api (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=62a44aace15cb728f1f5f96a1c2a4a37" target="_blank">cloudcompute.api</a>, <a rel="noreferrer noopener" aria-label="deepfreeze.api (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=95a2387f103608f6eebcc64a01aefece" target="_blank">deepfreeze.api,</a> and <a rel="noreferrer noopener" aria-label="netscan.api (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=4b2d33b818f53377620ac159e9f8a613" target="_blank">netscan.api</a>. Those names are being appended to the root path of the modules.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":385,"height":122,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/rootpath.png" class="wp-image-38679" alt="" width="385" height="122"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Each module is fetched from the mounted filesystem and loaded:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":821,"height":290,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/load_plugin.png" class="wp-image-38886" alt="" width="821" height="290"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Consecutive modules are loaded one after another in the same executable memory area. After the module is loaded, its header is erased. It is a common technique used in order to make dumping of the payload from the memory more difficult.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The cloudcompute.api is a plugin that will load the miner. More about the plugins will be explained in the next section of this post.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Reading its code, we find out that the SPUTNIK modules are filesystems that can be mounted and dismounted on demand. This module will be communicating with others with the help of a named pipe. It will be receiving commands and executing appropriate handlers.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Initialization of the commands&#8217; parser:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":371,"height":343,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_setup_commands.png" class="wp-image-38657" alt="" width="371" height="343"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The function setting up the commands: For each name, a handler is registered. (This is probably the Lua dispatcher, first described <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://www.freebuf.com/column/175106.html" target="_blank">here</a>.)</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":442,"height":443,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/setup_commands-1.png" class="wp-image-38962" alt="" width="442" height="443"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p> When plugins are run, we can see some additional child processes created by the process running the coredll (in the analyzed case it is inside rundll32):</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":570,"height":74,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/plugin_running.png" class="wp-image-38680" alt="" width="570" height="74"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Also it triggers a firewall alert, which means the malware requested to open some ports (triggered by netscan.api plugin):</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":538,"height":385,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/open_ports.png" class="wp-image-38963" alt="" width="538" height="385"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>We can see that it started listening on one TCP and one UDP port:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":432,"height":169,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/socket.png" class="wp-image-38682" alt="" width="432" height="169"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:heading {"level":3} --><h3>The plugins</h3><!-- /wp:heading -->    <!-- wp:paragraph --><p>As mentioned in the previous section, the SPUTNIK filesystem contains three plugins: <a rel="noreferrer noopener" href="https://malshare.com/sample.php?action=detail&amp;hash=62a44aace15cb728f1f5f96a1c2a4a37" target="_blank">cloudcompute.api</a>, <a rel="noreferrer noopener" href="https://malshare.com/sample.php?action=detail&amp;hash=95a2387f103608f6eebcc64a01aefece" target="_blank">deepfreeze.api</a>, and <a rel="noreferrer noopener" href="https://malshare.com/sample.php?action=detail&amp;hash=4b2d33b818f53377620ac159e9f8a613" target="_blank">netscan.api</a>. If we convert them to PE, we can see that all of them import an unknown DLL: mpsi.dll. When we see the filled import table, we find out that the addresses have been filled redirecting to the functions from the previous NS module:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":486,"height":270,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/mpsi_imports-1.png" class="wp-image-38891" alt="" width="486" height="270"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>So we can conclude that the previous element is the mpsi.dll. Although its export table has been destroyed, the functions are fetched by the custom loader and filled in the import tables of the loaded plugins.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>First the cloudcompute.api is run.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>This plugin retrieves from the filesystem a file named &#8220;/etc/ccmain.json&#8221; that contains the list of URLs:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":535,"height":386,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/next_part_addresses.png" class="wp-image-38887" alt="" width="535" height="386"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Those are addresses from which another set of modules is going to be downloaded:</p><!-- /wp:paragraph -->   <!-- wp:preformatted --><pre class="wp-block-preformatted">["sstp://news.onetouchauthentication.online:443/mlf_plug.zip.sig","sstp://news.onetouchauthentication.club:443/mlf_plug.zip.sig","sstp://news.onetouchauthentication.icu:443/mlf_plug.zip.sig","sstp://news.onetouchauthentication.xyz:443/mlf_plug.zip.sig"]</pre><!-- /wp:preformatted -->   <!-- wp:paragraph --><p>It also retrieves another component from the SPUTNIK filesystem: /bin/i386/ccmain.bin. This time, it is an executable in NE format (version converted to PE is available here: <a rel="noreferrer noopener" aria-label="367db629beedf528adaa021bdb7c12de (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=367db629beedf528adaa021bdb7c12de" target="_blank">367db629beedf528adaa021bdb7c12de</a>)</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":600,"height":309,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/load_ccmain.png" class="wp-image-38892" alt="" width="600" height="309"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>This is the component that is injected into msdtc.exe.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":621,"height":295,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/implanted_in_msdtc.png" class="wp-image-38893" alt="" width="621" height="295"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The configuration is also copied into the remote process and is used to retrieve an additional package from the C&amp;C:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":524,"height":496,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_download_modules.png" class="wp-image-38894" alt="" width="524" height="496"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>This is the plugin responsible for downloading and deploying the Mellifera Miner: core component of the Hidden Bee.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Next, the netscan.api loads module /bin/i386/kernelbase.bin (converted to PE: <a href="https://malshare.com/sample.php?action=detail&amp;hash=d7516ad354a3be2299759cd21e161a04" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">d7516ad354a3be2299759cd21e161a04</a>)</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":629,"height":262,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/load_kernelbase.png" class="wp-image-38895" alt="" width="629" height="262"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:heading {"level":3} --><h3>The miner in APT-style</h3><!-- /wp:heading -->    <!-- wp:paragraph --><p>Hidden Bee is an eclectic malware. Although it is a commodity malware used for cryptocurrency mining, its design reminds us of espionage platforms used by APTs. Going through all its components is exhausting, but also fascinating. The authors are highly professional, not only as individuals but also as a team, because the design is consistent in all its complexity.</p><!-- /wp:paragraph -->    <!-- wp:heading {"level":3} --><h3>Appendix</h3><!-- /wp:heading -->    <!-- wp:paragraph --><p><a href="https://github.com/hasherezade/hidden_bee_tools" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">https://github.com/hasherezade/hidden_bee_tools</a> &#8211; helper tools for parsing and converting Hidden Bee custom formats</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p><a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://www.bleepingcomputer.com/news/security/new-underminer-exploit-kit-discovered-pushing-bootkits-and-coinminers/" target="_blank">https://www.bleepingcomputer.com/news/security/new-underminer-exploit-kit-discovered-pushing-bootkits-and-coinminers/</a></p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Articles about the previous version (in Chinese):  </p><!-- /wp:paragraph -->    <!-- wp:list --><ul><!-- wp:list-item --><li><a href="https://www.freebuf.com/column/174581.html" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">https://www.freebuf.com/column/174581.html</a></li><!-- /wp:list-item --><!-- wp:list-item --><li><a rel="noreferrer noopener" aria-label="https://www.freebuf.com/column/175106.html (opens in a new tab)" href="https://www.freebuf.com/column/175106.html" target="_blank">https://www.freebuf.com/column/175106.html</a></li><!-- /wp:list-item --></ul><!-- /wp:list -->    <!-- wp:paragraph --><p>Our first encounter with the Hidden Bee:</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p><a href="https://www.malwarebytes.com/blog/threat-analysis/2018/07/hidden-bee-miner-delivered-via-improved-drive-by-download-toolkit/" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">/blog/threat-analysis/2018/07/hidden-bee-miner-delivered-via-improved-drive-by-download-toolkit/</a><br></p><!-- /wp:paragraph -->                        
    <figure class="wp-block-image aligncenter size-full is-resized"><a href="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/hidden_bee_loader-2.png"><img loading="lazy" decoding="async" class="wp-image-38969" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/hidden_bee_loader-2.png" alt="" width="681" height="739"></a></figure>    <p>Each of the .spk packages contains a custom &#8216;SPUTNIK&#8217; filesystem, containing more executable modules.</p>   <!-- wp:image --> <!-- wp:image {"align":"center","width":628,"height":584,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><a href="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/bee_plugins-1.png"><img loading="lazy" decoding="async" class="wp-image-38910" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/bee_plugins-1.png" alt="" width="628" height="584"></a></figure> <!-- /wp:image -->   <!-- wp:paragraph --><p>Starting the analysis from the loader, we will go down to the plugins, showing the inner workings of each element taking part in the loading process.</p><!-- /wp:paragraph -->    <!-- wp:heading {"level":3} --><h3>The loader</h3><!-- /wp:heading -->    <!-- wp:paragraph --><p>In contrast to most of the malware that we see nowadays, the loader is not packed by any crypter. According the header, it was compiled in November 2018.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":684,"height":150,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/04/compile_time.png" class="wp-image-38191" alt="" width="684" height="150"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>While in the former edition the modules in the custom formats were dropped as separate files, this time the next stage is unpacked from inside the loader.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p> The loader is not obfuscated. Once we load it with typical tools (IDA), we can clearly see how the new format is loaded.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":306,"height":123,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/04/to_load_custom.png" class="wp-image-38187" alt="" width="306" height="123"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Section .shared contains the configuration:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":881,"height":539,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/section_shared.png" class="wp-image-38533" alt="" width="881" height="539"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The configuration is decrypted with the help of XTEA algorithm.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":330,"height":342,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/decrypt_config.png" class="wp-image-38534" alt="" width="330" height="342"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The decrypted configuration must start from the magic WORD &#8220;pZ.&#8221; It contains the C&amp;C and the name under which the service will be installed:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":450,"height":261,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/decrypted_config.png" class="wp-image-38535" alt="" width="450" height="261"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:heading {"level":4} --><h4>Unscrambling the NE format</h4><!-- /wp:heading -->    <!-- wp:paragraph --><p>The NE format <a href="https://www.freebuf.com/column/174581.html" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">was seen before</a>, in former editions of Hidden Bee. It is just a scrambled version of the PE. By observing which fields have been misplaced, we can easily reconstruct the original PE.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":628,"height":409,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/unpack_from_loader.png" class="wp-image-38522" alt="" width="628" height="409"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>NE is one of the two similar formats being used by this malware. Another similar one starts from a DWORD 0x0EF1FAB9 and is used to further load components. Both of them have an analogical structure that comes from slightly modified PE format:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":706,"height":320,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/04/reconstruct_pe-1.png" class="wp-image-38213" alt="" width="706" height="320"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Header:  </p><!-- /wp:paragraph -->   <!-- wp:preformatted {"className": "wp-block-preformatted"} --><pre class="wp-block-preformatted wp-block-preformatted">WORD magic; // 'NE'<br>WORD pe_offset;<br>WORD machine_id; </pre><!-- /wp:preformatted -->   <!-- wp:paragraph --><p>The conversion back to PE format is trivial: It is enough to add the erased magic numbers: MZ and PE, and to move displaced fields to their original offsets. The tool that automatically does the mentioned conversion is available <a href="https://github.com/hasherezade/bee_parser/tree/master/bee_lvl2_converter" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">here</a>. </p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>In the previous edition, the parts of Hidden Bee with analogical functionality were delivered in a different, more complex <a rel="noreferrer noopener" aria-label="another proprietary format used for the loader (opens in a new tab)" href="/blog/threat-analysis/2018/08/reversing-malware-in-a-custom-format-hidden-bee-elements/" target="_blank">proprietary format</a>  than the one currently being analyzed.</p><!-- /wp:paragraph -->    <!-- wp:heading {"level":4} --><h4 id="mce_31">Second stage: a downloader (in NE format)</h4><!-- /wp:heading -->    <!-- wp:paragraph --><p>As a result of the conversion, we get the following PE: (<a href="https://www.virustotal.com/#/file/3a1c218de4d653dff06a68cfc12b958766dcb869450c9dd06928be819beb365c/details" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">fddfd292eaf33a490224ebe5371d3275</a>). This module is a downloader of the next stage. The interesting thing is that the subsystem of this module is set as a driver, however, it is not loaded like a typical driver. The custom loader loads it into a user space just like any typical userland component.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The function at the module&#8217;s Entry Point is called with three parameters. The first is a path of the main module. Then, the parameters from the configuration are passed. Example:</p><!-- /wp:paragraph -->   <!-- wp:preformatted --><pre class="wp-block-preformatted">0012FE9C     00601A34  UNICODE ""C:UserstesterDesktopnew_bee.exe""<br>0012FEA0     00407104  UNICODE "NAPCUYWKOxywEgrO"<br>0012FEA4     00407004  UNICODE "118.41.45.124:9000"</pre><!-- /wp:preformatted -->  <!-- wp:image --> <!-- wp:image {"align":"center","width":725,"height":172,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/call_module_ep.png" class="wp-image-38541" alt="" width="725" height="172"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The execution of the module can take one of the two paths. The first one is meant for adding persistence: The module installs itself as a service.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>If the module detects that it is already running as a service, it takes the second path. In such a case, it proceeds to download the next module from the server. The next module is packed as as Cabinet file.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":611,"height":534,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_unpack_cabinet.png" class="wp-image-38538" alt="" width="611" height="534"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>It is first unpacked into a file named &#8220;core.sdb&#8221;. The unpacked module is in a customized format based on PE. This time, the format has a different signature: &#8220;NS&#8221; and it is different from the aforementioned &#8220;NE&#8221; format (detailed explanation will be given further).</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":600,"height":227,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/unpacked_NS_file.png" class="wp-image-38540" alt="" width="600" height="227"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>It is loaded by the proprietary loader.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":307,"height":115,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/check_ns_sign.png" class="wp-image-38539" alt="" width="307" height="115"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The loader enumerates all the executables in a directory: <code>%Systemroot%Microsoft.NET</code> and selects the ones with the compatible bitness (in the analyzed case it was selecting 32bit PEs). Once it finds a suitable PE, it runs it and injects the payload there. The injected code is run by adding its entry point to APC queue. </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":692,"height":38,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/created_process.png" class="wp-image-38548" alt="" width="692" height="38"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>In case it failed to find the suitable executable in that directory, it performs the injection into dllhost.exe instead.</p><!-- /wp:paragraph -->    <!-- wp:heading {"level":4} --><h4 id="mce_22">Unscrambling the NS format</h4><!-- /wp:heading -->    <!-- wp:paragraph --><p>As mentioned before, the core.sdb is in yet another format named NS. It is also a customized PE, however, this time the conversion is more complex than the NE format because more structures are customized. It looks like a next step in the evolution of the NE format.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":769,"height":494,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><a href="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/core_sdb.png"><img loading="lazy" decoding="async" class="wp-image-38919" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/core_sdb.png" alt="" width="769" height="494"></a></figure> <!-- /wp:image -->   <!-- wp:paragraph --><p>We can see that the changes in the PE headers are bigger and more lossy&mdash;only minimalist information is maintained. Only few Data Directories are left. Also the sections table is shrunk: Each section header contains only four out of nine fields that are in the original PE. </p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Additionally, the format allows to pass a runtime argument from the loader to the payload via header: The pointer is saved into an additional field (marked &#8220;Filled Data&#8221; on the picture).</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Not only is the PE header shrunk. Similar customization is done on the Import Table:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":803,"height":156,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><a href="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/custom_import_table1.png"><img loading="lazy" decoding="async" class="wp-image-38572" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/custom_import_table1.png" alt="" width="803" height="156"></a></figure> <!-- /wp:image -->   <!-- wp:paragraph --><p>This custom format can also be converted back to the PE format with the help of a dedicated converter, available <a rel="noreferrer noopener" aria-label="here (opens in a new tab)" href="https://github.com/hasherezade/bee_parser/tree/master/bee_lvl2_converter" target="_blank">here</a>.</p><!-- /wp:paragraph -->    <!-- wp:heading {"level":4} --><h4 id="mce_27">Third stage: core.sdb</h4><!-- /wp:heading -->    <!-- wp:paragraph --><p>The core.sdb module converted to PE format is available here: <a href="https://malshare.com/sample.php?action=detail&amp;hash=a17645fac4bcb5253f36a654ea369bf9" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">a17645fac4bcb5253f36a654ea369bf9</a>.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The interesting part is that the external loader does not complete the full loading process of the module. It only copies the sections. But the rest of the module loading, such as applying relocations and filling imports, is done internally in the core.sdb. </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":281,"height":139,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/coresdb_at_ep_.png" class="wp-image-38549" alt="" width="281" height="139"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The previous component was supposed to pass to the core.sdb an additional buffer with the data about the installed service: the name and the path. During its execution, core.sdb will look up this data. If found, it will delete the previously-created service, and the initial file that started the infection:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":473,"height":630,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/removing_the_service.png" class="wp-image-38948" alt="" width="473" height="630"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Getting rid of the previous persistence method suggests that it will be replaced by some different technique. Knowing previous editions of Hidden Bee, we can suspect that it may be a bootkit.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>After locking the mutex in a format GlobalSC_{%08lx-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x}, the module proceeds to download another component. But before it goes to download, first, a few things are checked.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":693,"height":442,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/can_continue.png" class="wp-image-38552" alt="" width="693" height="442"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>First of all, there is a defensive check if any of the known debuggers or sniffers are running. If so, the function quits. </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":639,"height":228,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/blacklisted_names.png" class="wp-image-38577" alt="" width="639" height="228"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Also, there is a check if the application can open a file &#8216;??NPF-{0179AC45-C226-48e3-A205-DCA79C824051}&#8217;.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>If all the checks pass, the function proceeds and queries the following URL, where GET variables contain the system fingerprint:</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p><code></code></p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The hash (sz=) is an MD5 generated from VolumeIDs. Then follows the (os=) identifying version of the operating system, and the identifier of the architecture (ar=), where 0 means 32 bit, 1 means 64bit.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The content downloaded from this URL (starting from a magic DWORD 0xFEEDFACE &#8211; <a rel="noreferrer noopener" aria-label="79e851622ac5298198c04034465017c0 (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=79e851622ac5298198c04034465017c0" target="_blank">79e851622ac5298198c04034465017c0</a>) contains the encrypted package (in !rbx format), and a shellcode that will be used to unpack it. The shellcode is loaded to the current process and then executed.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":588,"height":294,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/load_shellcode-1.png" class="wp-image-38946" alt="" width="588" height="294"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The shellcode&#8217;s start function uses three parameters: pointer to the functions in the previous module (core sdb), pointer to the buffer with encrypted data, size of the encrypted data.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":581,"height":274,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/calling_the_shellcode.png" class="wp-image-38947" alt="" width="581" height="274"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:heading {"level":4} --><h4 id="mce_27">Fourth stage: the shellcode decrypting !rbx</h4><!-- /wp:heading -->    <!-- wp:paragraph --><p>The beginning of the loaded shellcode:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":397,"height":206,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/shellcode_bgn.png" class="wp-image-38942" alt="" width="397" height="206"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The shellcode does not fill any imports by itself. Instead, it fully relies on the functions from core.sdb module, to which it passes the pointer. It makes use of the following function: malloc, mecpy, memfree, VirtualAlloc. </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":554,"height":216,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/calling_via_coresdb.png" class="wp-image-38589" alt="" width="554" height="216"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Its role is to reveal another part. It comes in an encrypted package starting from a marker !rbx. The decryption function is called just at the beginning:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":418,"height":209,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/decrypt_rbx.png" class="wp-image-38583" alt="" width="418" height="209"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>First, the function checks the !rbx marker and the checksum at the beginning of the encrypted buffer:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":549,"height":443,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/checking_the_marker.png" class="wp-image-38584" alt="" width="549" height="443"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>It is decrypted with the help of RC4 algorithm, and then decompressed.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>After decryption, the markers at the beginning of the buffer are checked. The expected format must start from predefined magic DWORDs: 0xCAFEBABE,0, 0xBABECAFE:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":590,"height":517,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/check_format.png" class="wp-image-38943" alt="" width="590" height="517"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p><strong>The !rbx package format</strong></p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The !rbx is also a custom format with a consistent structure. </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":616,"height":140,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/copy_afer_rbx_hdr.png" class="wp-image-38590" alt="" width="616" height="140"/></figure> <!-- /wp:image --> <!-- /wp:image -->  <!-- wp:preformatted {"className": "wp-block-preformatted"} --><pre class="wp-block-preformatted wp-block-preformatted">DWORD magic; // "!rbx"<br>DWORD checksum;<br>DWORD content_size;<br>BYTE rc4_key[16];<br>DWORD out_size;<br>BYTE content[];</pre><!-- /wp:preformatted -->   <!-- wp:paragraph --><p><strong>The custom file system (BABECAFE)</strong></p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p> <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=a93c90a210aed61255dc34102335af8d" target="_blank">The full decrypted content</a> has a consistent structure, reminiscent of a file system. According to the previous reports, earlier versions of Hidden Bee used to adapt the ROMS filesystem, adding few modifications. They called their customized version &#8220;Mixed ROM FS&#8221;. Now it seems that their customization process has progressed. Also the keywords suggesting ROMFS cannot be found. The headers starts from the markers in the form of three DWORDS: { 0xCAFEBABE, 0, 0xBABECAFE }.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":461,"height":325,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/checkibng_babecafe_format.png" class="wp-image-38588" alt="" width="461" height="325"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The layout of BABECAFE FS:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":750,"height":489,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/babecafe_fs-1.png" class="wp-image-38592" alt="" width="750" height="489"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>We notice that it differs at many points from <a rel="noreferrer noopener" aria-label="ROM FS (opens in a new tab)" href="http://lxr.linux.no/#linux+v4.15.14/Documentation/filesystems/romfs.txt" target="_blank">ROM FS</a>, from which it evolved.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The structure contains the following files:</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>/bin/amd64/coredll.bin<br> /bin/i386/coredll.bin<br> /bin/i386/preload<br> /bin/amd64/preload<br> /pkg/sputnik.spk<br> /installer/com_x86.dll (<a href="https://www.virustotal.com/#/file/04d62f3c9ab18370184a5aad9717434b5a8f71abadb92fcbc00b04d7dfa49a7d/details" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">6177bc527853fe0f648efd17534dd28b</a>)<br> /installer/com_x64.dll<br> /pkg/plugins.spk</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The files /pkg/sputnik.spk and /pkg/plugins.spk are both compressed packages in a custom !rsi format.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":613,"height":102,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/rsi_package_bgn.png" class="wp-image-38628" alt="" width="613" height="102"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Each of the spk packages contain another custom filesystem, identified by the keyword SPUTNIK (possibly the extension &#8216;spk&#8217; is derived from the  SPUTNIK format). They will be unpacked during the next steps of the execution.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Unpacked plugins.spk: <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=4c01273fb77550132c42737912cbeb36" target="_blank">4c01273fb77550132c42737912cbeb36</a><br>Unpacked sputnik.spk: <a href="https://malshare.com/sample.php?action=detail&amp;hash=36f3247dad5ec73ed49c83e04b120523" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">36f3247dad5ec73ed49c83e04b120523</a>.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p><strong>Selecting and running modules</strong></p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Some executables stored in the filesystem are in two version: 32 and 64 bit. Only the modules relevant to the current architecture are loaded. So, in the analyzed case, the loader chooses first: /bin/i386/preload (shellcode) and /bin/i386/coredll.bin (a module in NS custom format). The names are hardcoded in the loader within the loading shellcode:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":622,"height":573,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/loading_modules.png" class="wp-image-38585" alt="" width="622" height="573"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>After the proper elements are fetched (preload and coredll.bin), they are copied together into a newly-allocated memory area. The coredll.bin is copied just after preload. Then, the preload module is called: </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":439,"height":98,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/call_preload.png" class="wp-image-38586" alt="" width="439" height="98"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The preload is position-independent, and its execution starts from the beginning of the page. </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":537,"height":261,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_enter_preload.png" class="wp-image-38602" alt="" width="537" height="261"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The only role of this shellcode is to prepare and run the coredll.bin. So, it contains a custom loader for the NS format that allocates another memory area and loads the NS file there.</p><!-- /wp:paragraph -->    <!-- wp:heading {"level":4} --><h4 id="mce_27">Fifth stage: preload and coredll </h4><!-- /wp:heading -->    <!-- wp:paragraph --><p>After loading coredll, preload redirects the execution there. <br></p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":562,"height":378,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/coredll_ep.png" class="wp-image-38603" alt="" width="562" height="378"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The coredll patches a function inside the NTDLL&mdash; KiUserExceptionDispatcher&mdash;redirecting one of the inner calls to its own code:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":822,"height":143,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/patched_kiuserdispatch.png" class="wp-image-38604" alt="" width="822" height="143"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Depending on which process the coredll was injected into, it can take one of a few paths of execution.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>If it is running for the first time, it will try to inject itself again&mdash;this time into rundll32. For the purpose of the injection, it will again unpack the original !rbx package and use its original copy stored there.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":327,"height":146,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_unpack_rbx-1.png" class="wp-image-38606" alt="" width="327" height="146"/></figure> <!-- /wp:image --> <!-- /wp:image -->  <!-- wp:image --> <!-- wp:image {"align":"center","width":325,"height":166,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/checking_magic.png" class="wp-image-38607" alt="" width="325" height="166"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Then it will choose the modules depending on the bitness of the rundll32: </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":620,"height":324,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/create_rundll32_suspended.png" class="wp-image-38617" alt="" width="620" height="324"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>It selects the pair of modules (preload/coredll.bin) appropriate for the architecture, either from the directory amd64 or from i386:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":769,"height":614,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/choose_modules.png" class="wp-image-38608" alt="" width="769" height="614"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>If the injection failed, it makes another attempt, this time trying to inject into dllhost:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":580,"height":352,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/try_inject.png" class="wp-image-38609" alt="" width="580" height="352"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Each time it uses the same, hardcoded parameter (<code>/Processid: {...}</code>) that is passed to the created process:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":653,"height":286,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/with_processid.png" class="wp-image-38610" alt="" width="653" height="286"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The thread context of the target process is modified, and then the thread is resumed, running the injected content:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":529,"height":46,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/injected_to_rundll32.png" class="wp-image-38611" alt="" width="529" height="46"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Now, when we look inside the memory of rundll32, we can find the preload and coredll being mapped:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":589,"height":190,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/rundll32_injected_preload.png" class="wp-image-38612" alt="" width="589" height="190"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Inside the injected part, the execution follows a similar path: preload loads the coredll and redirects to its Entry Point. But then, another path of execution is taken.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The parameter passed to the coredll decides which round of execution it is. On the second round, another injection is made: this time to dllhost.exe. And finally, it proceeds to the final round, when other modules are unpacked from the BABECAFE filesystem.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":673,"height":613,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_unpack_spk.png" class="wp-image-38613" alt="" width="673" height="613"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The unpacking function first searches by name for two more modules: sputnik.spk and plugins.spk. They are both in the mysterious !rsi format, which reminds us of !rbx, but has a slightly different structure.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":475,"height":465,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/find_sputnik_and_plugins.png" class="wp-image-38614" alt="" width="475" height="465"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Entering the function unpacking the first !rsi package:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":522,"height":300,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_unpack_rsi.png" class="wp-image-38616" alt="" width="522" height="300"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The function unpacking the !rsi format is structured similarly to the !rbx unpacking. It also starts from checking the keyword:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":545,"height":174,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/check_rsi_keyword.png" class="wp-image-38619" alt="" width="545" height="174"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>As mentioned before, both !rsi packages are used to store filesystems marked with the keyword &#8220;SPUTNIK&#8221;. It is another custom filesystem invented by the Hidden Bee authors that contain additional modules.  </p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":334,"height":117,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/check_sputnik_keyword.png" class="wp-image-38941" alt="" width="334" height="117"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Unpacking the sputnik.spk resulted in getting the following SPUTNIK module: <a href="https://malshare.com/sample.php?action=detail&amp;hash=455738924b7665e1c15e30cf73c9c377" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">455738924b7665e1c15e30cf73c9c377</a></p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":544,"height":298,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/check_sputnik_format.png" class="wp-image-38615" alt="" width="544" height="298"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>It is worth noting that the unpacked filesystem has inside of it four executables: two pairs consisting of NS and PE, appropriately 32 and 64 bit. In the currently-analyzed setup, 32 bit versions are deployed. </p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The NS module will be the next to be run. First, it is loaded by the current executable, and then the execution is redirected there. Interestingly, both !rsi modules are passed as arguments to the entry point of the new module. (They will be used later to retrieve more components.)</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":559,"height":313,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/call_another.png" class="wp-image-38882" alt="" width="559" height="313"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:heading {"level":4} --><h4 id="mce_29">Sixth stage: mpsi.dll (unpacked from SPUTNIK)</h4><!-- /wp:heading -->    <!-- wp:paragraph --><p>Entering into the NS module starts another layer of the malware:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":680,"height":415,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/call_ns_ep.png" class="wp-image-38881" alt="" width="680" height="415"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The analyzed module, converted to PE is available here: <a href="https://malshare.com/sample.php?action=detail&amp;hash=455738924b7665e1c15e30cf73c9c377" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">537523ee256824e371d0bc16298b3849</a> </p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>This module is responsible for loading plugins. It will also create a named pipe through which it is will communicate with other modules. It sets up the commands that are going to be executed on demand. </p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>This is how the beginning of the main function looks:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":586,"height":341,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/start_main.png" class="wp-image-38884" alt="" width="586" height="341"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Like in previous cases, it starts from finishing to load itself (relocations and imports). Then, it patches the function in NTDLL. This is a common prolog in many HiddenBee modules.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Then, we have another phase of loading elements from the supplied packages. The path that will be taken depends on the runtime arguments. If the function received both !rsi packages, it will start by parsing one of them, retrieving loading submodules.<br></p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>First, the SPUTNIK filesystem must be unpacked from the !rsi package:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":537,"height":430,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/unpack_and_mount_plugins.png" class="wp-image-38678" alt="" width="537" height="430"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>After being unpacked, it is mounted. The filesystems are mounted internally in the memory: A global structure is filled with pointers to appropriate elements of the filesystem.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":758,"height":606,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><a href="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/retrieve_plugins.png"><img loading="lazy" decoding="async" class="wp-image-38885" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/retrieve_plugins.png" alt="" width="758" height="606"></a></figure> <!-- /wp:image -->   <!-- wp:paragraph --><p>At the beginning, we can see the list of the plugins that are going to be loaded: <a rel="noreferrer noopener" aria-label="cloudcompute.api (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=62a44aace15cb728f1f5f96a1c2a4a37" target="_blank">cloudcompute.api</a>, <a rel="noreferrer noopener" aria-label="deepfreeze.api (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=95a2387f103608f6eebcc64a01aefece" target="_blank">deepfreeze.api,</a> and <a rel="noreferrer noopener" aria-label="netscan.api (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=4b2d33b818f53377620ac159e9f8a613" target="_blank">netscan.api</a>. Those names are being appended to the root path of the modules.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":385,"height":122,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/rootpath.png" class="wp-image-38679" alt="" width="385" height="122"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Each module is fetched from the mounted filesystem and loaded:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":821,"height":290,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/load_plugin.png" class="wp-image-38886" alt="" width="821" height="290"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Consecutive modules are loaded one after another in the same executable memory area. After the module is loaded, its header is erased. It is a common technique used in order to make dumping of the payload from the memory more difficult.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>The cloudcompute.api is a plugin that will load the miner. More about the plugins will be explained in the next section of this post.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Reading its code, we find out that the SPUTNIK modules are filesystems that can be mounted and dismounted on demand. This module will be communicating with others with the help of a named pipe. It will be receiving commands and executing appropriate handlers.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Initialization of the commands&#8217; parser:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":371,"height":343,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_setup_commands.png" class="wp-image-38657" alt="" width="371" height="343"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The function setting up the commands: For each name, a handler is registered. (This is probably the Lua dispatcher, first described <a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://www.freebuf.com/column/175106.html" target="_blank">here</a>.)</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":442,"height":443,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/setup_commands-1.png" class="wp-image-38962" alt="" width="442" height="443"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p> When plugins are run, we can see some additional child processes created by the process running the coredll (in the analyzed case it is inside rundll32):</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":570,"height":74,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/plugin_running.png" class="wp-image-38680" alt="" width="570" height="74"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Also it triggers a firewall alert, which means the malware requested to open some ports (triggered by netscan.api plugin):</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":538,"height":385,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/open_ports.png" class="wp-image-38963" alt="" width="538" height="385"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>We can see that it started listening on one TCP and one UDP port:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":432,"height":169,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/socket.png" class="wp-image-38682" alt="" width="432" height="169"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:heading {"level":3} --><h3>The plugins</h3><!-- /wp:heading -->    <!-- wp:paragraph --><p>As mentioned in the previous section, the SPUTNIK filesystem contains three plugins: <a rel="noreferrer noopener" href="https://malshare.com/sample.php?action=detail&amp;hash=62a44aace15cb728f1f5f96a1c2a4a37" target="_blank">cloudcompute.api</a>, <a rel="noreferrer noopener" href="https://malshare.com/sample.php?action=detail&amp;hash=95a2387f103608f6eebcc64a01aefece" target="_blank">deepfreeze.api</a>, and <a rel="noreferrer noopener" href="https://malshare.com/sample.php?action=detail&amp;hash=4b2d33b818f53377620ac159e9f8a613" target="_blank">netscan.api</a>. If we convert them to PE, we can see that all of them import an unknown DLL: mpsi.dll. When we see the filled import table, we find out that the addresses have been filled redirecting to the functions from the previous NS module:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":486,"height":270,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/mpsi_imports-1.png" class="wp-image-38891" alt="" width="486" height="270"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>So we can conclude that the previous element is the mpsi.dll. Although its export table has been destroyed, the functions are fetched by the custom loader and filled in the import tables of the loaded plugins.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>First the cloudcompute.api is run.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>This plugin retrieves from the filesystem a file named &#8220;/etc/ccmain.json&#8221; that contains the list of URLs:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":535,"height":386,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/next_part_addresses.png" class="wp-image-38887" alt="" width="535" height="386"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>Those are addresses from which another set of modules is going to be downloaded:</p><!-- /wp:paragraph -->   <!-- wp:preformatted --><pre class="wp-block-preformatted">["sstp://news.onetouchauthentication.online:443/mlf_plug.zip.sig","sstp://news.onetouchauthentication.club:443/mlf_plug.zip.sig","sstp://news.onetouchauthentication.icu:443/mlf_plug.zip.sig","sstp://news.onetouchauthentication.xyz:443/mlf_plug.zip.sig"]</pre><!-- /wp:preformatted -->   <!-- wp:paragraph --><p>It also retrieves another component from the SPUTNIK filesystem: /bin/i386/ccmain.bin. This time, it is an executable in NE format (version converted to PE is available here: <a rel="noreferrer noopener" aria-label="367db629beedf528adaa021bdb7c12de (opens in a new tab)" href="https://malshare.com/sample.php?action=detail&amp;hash=367db629beedf528adaa021bdb7c12de" target="_blank">367db629beedf528adaa021bdb7c12de</a>)</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":600,"height":309,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/load_ccmain.png" class="wp-image-38892" alt="" width="600" height="309"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>This is the component that is injected into msdtc.exe.</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":621,"height":295,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/implanted_in_msdtc.png" class="wp-image-38893" alt="" width="621" height="295"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>The configuration is also copied into the remote process and is used to retrieve an additional package from the C&amp;C:</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":524,"height":496,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/to_download_modules.png" class="wp-image-38894" alt="" width="524" height="496"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:paragraph --><p>This is the plugin responsible for downloading and deploying the Mellifera Miner: core component of the Hidden Bee.</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Next, the netscan.api loads module /bin/i386/kernelbase.bin (converted to PE: <a href="https://malshare.com/sample.php?action=detail&amp;hash=d7516ad354a3be2299759cd21e161a04" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">d7516ad354a3be2299759cd21e161a04</a>)</p><!-- /wp:paragraph -->   <!-- wp:image --> <!-- wp:image {"align":"center","width":629,"height":262,"sizeSlug":"full","linkDestination":"none","className":"is-resized"} --><figure class="wp-block-image aligncenter size-full is-resized"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2019/05/load_kernelbase.png" class="wp-image-38895" alt="" width="629" height="262"/></figure> <!-- /wp:image --> <!-- /wp:image -->   <!-- wp:heading {"level":3} --><h3>The miner in APT-style</h3><!-- /wp:heading -->    <!-- wp:paragraph --><p>Hidden Bee is an eclectic malware. Although it is a commodity malware used for cryptocurrency mining, its design reminds us of espionage platforms used by APTs. Going through all its components is exhausting, but also fascinating. The authors are highly professional, not only as individuals but also as a team, because the design is consistent in all its complexity.</p><!-- /wp:paragraph -->    <!-- wp:heading {"level":3} --><h3>Appendix</h3><!-- /wp:heading -->    <!-- wp:paragraph --><p><a href="https://github.com/hasherezade/hidden_bee_tools" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">https://github.com/hasherezade/hidden_bee_tools</a> &#8211; helper tools for parsing and converting Hidden Bee custom formats</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p><a rel="noreferrer noopener" aria-label=" (opens in a new tab)" href="https://www.bleepingcomputer.com/news/security/new-underminer-exploit-kit-discovered-pushing-bootkits-and-coinminers/" target="_blank">https://www.bleepingcomputer.com/news/security/new-underminer-exploit-kit-discovered-pushing-bootkits-and-coinminers/</a></p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p>Articles about the previous version (in Chinese):  </p><!-- /wp:paragraph -->    <!-- wp:list --><ul><!-- wp:list-item --><li><a href="https://www.freebuf.com/column/174581.html" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">https://www.freebuf.com/column/174581.html</a></li><!-- /wp:list-item --><!-- wp:list-item --><li><a rel="noreferrer noopener" aria-label="https://www.freebuf.com/column/175106.html (opens in a new tab)" href="https://www.freebuf.com/column/175106.html" target="_blank">https://www.freebuf.com/column/175106.html</a></li><!-- /wp:list-item --></ul><!-- /wp:list -->    <!-- wp:paragraph --><p>Our first encounter with the Hidden Bee:</p><!-- /wp:paragraph -->    <!-- wp:paragraph --><p><a href="https://www.malwarebytes.com/blog/threat-analysis/2018/07/hidden-bee-miner-delivered-via-improved-drive-by-download-toolkit/" target="_blank" rel="noreferrer noopener" aria-label=" (opens in a new tab)">/blog/threat-analysis/2018/07/hidden-bee-miner-delivered-via-improved-drive-by-download-toolkit/</a><br></p><!-- /wp:paragraph -->                        
		</div><!-- .entry-content -->
	</div>
</article><!-- #post-65729 -->
						<div class="share-section">
							<p><strong>SHARE THIS ARTICLE</strong></p>
							<a class="socicon-facebook" target="_blank" href="http://www.facebook.com/sharer.php?u=https://www.malwarebytes.com/blog/news/2019/05/hidden-bee-lets-go-down-the-rabbit-hole" aria-label="Share this post on Facebook">
							<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="-5 0 20 20" version="1.1">
								<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
									<g transform="translate(-385.000000, -7399.000000)" fill="#414042">
									<g transform="translate(56.000000, 160.000000)">
										<path d="M335.821282,7259 L335.821282,7250 L338.553693,7250 L339,7246 L335.821282,7246 L335.821282,7244.052 C335.821282,7243.022 335.847593,7242 337.286884,7242 L338.744689,7242 L338.744689,7239.14 C338.744689,7239.097 337.492497,7239 336.225687,7239 C333.580004,7239 331.923407,7240.657 331.923407,7243.7 L331.923407,7246 L329,7246 L329,7250 L331.923407,7250 L331.923407,7259 L335.821282,7259 Z" id="facebook-[#176]">
								</path>
								</g>
								</g>
								</g>
							</svg>
							</a>
							<a class="socicon-twitter" target="_blank" href="https://twitter.com/intent/tweet?text=Hidden+Bee%3A+Let%26%238217%3Bs+go+down+the+rabbit+hole+https%3A%2F%2Fwww.malwarebytes.com%2Fblog%2Fnews%2F2019%2F05%2Fhidden-bee-lets-go-down-the-rabbit-hole&amp;via=Malwarebytes" aria-label="Share this post on Twitter">
							<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 -2 20 20" version="1.1">
								<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
									<g transform="translate(-60.000000, -7521.000000)" fill="#414042">
									<g transform="translate(56.000000, 160.000000)">
										<path d="M10.29,7377 C17.837,7377 21.965,7370.84365 21.965,7365.50546 C21.965,7365.33021 21.965,7365.15595 21.953,7364.98267 C22.756,7364.41163 23.449,7363.70276 24,7362.8915 C23.252,7363.21837 22.457,7363.433 21.644,7363.52751 C22.5,7363.02244 23.141,7362.2289 23.448,7361.2926 C22.642,7361.76321 21.761,7362.095 20.842,7362.27321 C19.288,7360.64674 16.689,7360.56798 15.036,7362.09796 C13.971,7363.08447 13.518,7364.55538 13.849,7365.95835 C10.55,7365.79492 7.476,7364.261 5.392,7361.73762 C4.303,7363.58363 4.86,7365.94457 6.663,7367.12996 C6.01,7367.11125 5.371,7366.93797 4.8,7366.62489 L4.8,7366.67608 C4.801,7368.5989 6.178,7370.2549 8.092,7370.63591 C7.488,7370.79836 6.854,7370.82199 6.24,7370.70483 C6.777,7372.35099 8.318,7373.47829 10.073,7373.51078 C8.62,7374.63513 6.825,7375.24554 4.977,7375.24358 C4.651,7375.24259 4.325,7375.22388 4,7375.18549 C5.877,7376.37088 8.06,7377 10.29,7376.99705" id="twitter-[#154]">
								</path></g></g></g>
							</svg>
							</a>
							<a class="socicon-linkedin" target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.malwarebytes.com/blog/news/2019/05/hidden-bee-lets-go-down-the-rabbit-hole&amp;summary=&amp;source=" aria-label="Share this post on LinkedIn">
							<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#414042" version="1.1" width="24px" height="24px" viewBox="0 0 512 512" xml:space="preserve">
								<g>
								<path style="display: inline; fill-rule: evenodd; clip-rule: evenodd;" d="M116.504,500.219V170.654H6.975v329.564H116.504   L116.504,500.219z M61.751,125.674c38.183,0,61.968-25.328,61.968-56.953c-0.722-32.328-23.785-56.941-61.252-56.941   C24.994,11.781,0.5,36.394,0.5,68.722c0,31.625,23.772,56.953,60.53,56.953H61.751L61.751,125.674z M177.124,500.219   c0,0,1.437-298.643,0-329.564H286.67v47.794h-0.727c14.404-22.49,40.354-55.533,99.44-55.533   c72.085,0,126.116,47.103,126.116,148.333v188.971H401.971V323.912c0-44.301-15.848-74.531-55.497-74.531   c-30.254,0-48.284,20.38-56.202,40.08c-2.897,7.012-3.602,16.861-3.602,26.711v184.047H177.124L177.124,500.219z">
								</path>
								</g>
								</svg>
							</a>
						</div>
						<div id="disqus_thread"></div>
													<div class="related-articles-wrap">
								<h4>RELATED ARTICLES</h4>
								<div class="related-articles-main">
																				<div class="related-article">
												<div class="large-card">
													<div class="thumb">
														<a href="https://www.malwarebytes.com/blog/news/2025/03/personal-data-revealed-in-released-jfk-files">
															<img width="150" height="150" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2024/04/Social_Security_Number.jpg?w=150&amp;h=150&amp;crop=1" class="attachment-thumbnail size-thumbnail wp-post-image" alt="change social security number" loading="lazy" />														</a>
													</div>
													<div class="blog-info">
																													<div class="blog-list__category">
																																	<a href="https://www.malwarebytes.com/blog/category/news">News</a>
																	 | 																	<a href="https://www.malwarebytes.com/blog/category/privacy">Privacy</a>
																																</div>
																													<h2><a href="https://www.malwarebytes.com/blog/news/2025/03/personal-data-revealed-in-released-jfk-files">Personal data revealed in released JFK files</a></h2>
													</div>
													</div>
													<p class="blog-excerpt">March 21, 2025 - The release of the JFK assassination records also resulted in the leak of hundreds of Social Security Numbers</p>
													<div class="blog-action">
														<a class="continue-read" href="https://www.malwarebytes.com/blog/news/2025/03/personal-data-revealed-in-released-jfk-files">CONTINUE READING</a>
														<a class="num-comments" href="https://www.malwarebytes.com/blog/news/2025/03/personal-data-revealed-in-released-jfk-files#disqus_thread" data-disqus-identifier="160793"> 0 Comments</a>
													</div>
											</div>
																						<div class="related-article">
												<div class="large-card">
													<div class="thumb">
														<a href="https://www.malwarebytes.com/blog/cybercrime/2025/03/semrush-impersonation-scam-hits-google-ads">
															<img width="150" height="150" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2025/03/Screenshot-2025-03-19-at-6.21.41PM.png?w=150&amp;h=150&amp;crop=1" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Semrush impersonation scam hits Google Ads" loading="lazy" />														</a>
													</div>
													<div class="blog-info">
																													<div class="blog-list__category">
																																	<a href="https://www.malwarebytes.com/blog/category/cybercrime">Cybercrime</a>
																																</div>
																													<h2><a href="https://www.malwarebytes.com/blog/cybercrime/2025/03/semrush-impersonation-scam-hits-google-ads">Semrush impersonation scam hits Google Ads</a></h2>
													</div>
													</div>
													<p class="blog-excerpt">March 20, 2025 - The phishing campaign for valuable Google accounts continues with a new twist, going after the customers of a Sass platform.</p>
													<div class="blog-action">
														<a class="continue-read" href="https://www.malwarebytes.com/blog/cybercrime/2025/03/semrush-impersonation-scam-hits-google-ads">CONTINUE READING</a>
														<a class="num-comments" href="https://www.malwarebytes.com/blog/cybercrime/2025/03/semrush-impersonation-scam-hits-google-ads#disqus_thread" data-disqus-identifier="152493"> 0 Comments</a>
													</div>
											</div>
																						<div class="related-article">
												<div class="large-card">
													<div class="thumb">
														<a href="https://www.malwarebytes.com/blog/news/2025/03/targeted-spyware-and-why-its-a-concern-to-us">
															<img width="150" height="150" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2025/03/spying_eye.jpg?w=150&amp;h=150&amp;crop=1" class="attachment-thumbnail size-thumbnail wp-post-image" alt="CitizenLab keeps an eye out for us" loading="lazy" />														</a>
													</div>
													<div class="blog-info">
																													<div class="blog-list__category">
																																	<a href="https://www.malwarebytes.com/blog/category/news">News</a>
																	 | 																	<a href="https://www.malwarebytes.com/blog/category/privacy">Privacy</a>
																																</div>
																													<h2><a href="https://www.malwarebytes.com/blog/news/2025/03/targeted-spyware-and-why-its-a-concern-to-us">Targeted spyware and why it&#8217;s a concern to us</a></h2>
													</div>
													</div>
													<p class="blog-excerpt">March 20, 2025 - Experts are warning about the proliferating market for targeted spyware and espionage. Why should we be concerned?</p>
													<div class="blog-action">
														<a class="continue-read" href="https://www.malwarebytes.com/blog/news/2025/03/targeted-spyware-and-why-its-a-concern-to-us">CONTINUE READING</a>
														<a class="num-comments" href="https://www.malwarebytes.com/blog/news/2025/03/targeted-spyware-and-why-its-a-concern-to-us#disqus_thread" data-disqus-identifier="159803"> 0 Comments</a>
													</div>
											</div>
																						<div class="related-article">
												<div class="large-card">
													<div class="thumb">
														<a href="https://www.malwarebytes.com/blog/scams/2025/03/the-free-money-trap-how-scammers-exploit-financial-anxiety">
															<img width="150" height="150" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2025/03/rolled-up-money-1.png?w=150&amp;h=150&amp;crop=1" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Rolled up US dollar bills" loading="lazy" />														</a>
													</div>
													<div class="blog-info">
																													<div class="blog-list__category">
																																	<a href="https://www.malwarebytes.com/blog/category/personal">Personal</a>
																	 | 																	<a href="https://www.malwarebytes.com/blog/category/scams">Scams</a>
																																</div>
																													<h2><a href="https://www.malwarebytes.com/blog/scams/2025/03/the-free-money-trap-how-scammers-exploit-financial-anxiety">The &#8220;free money&#8221; trap: How scammers exploit financial anxiety</a></h2>
													</div>
													</div>
													<p class="blog-excerpt">March 19, 2025 - With financial stressat an all-time high, people aredesperately seeking relief. Sadly, scammers know this all too well.</p>
													<div class="blog-action">
														<a class="continue-read" href="https://www.malwarebytes.com/blog/scams/2025/03/the-free-money-trap-how-scammers-exploit-financial-anxiety">CONTINUE READING</a>
														<a class="num-comments" href="https://www.malwarebytes.com/blog/scams/2025/03/the-free-money-trap-how-scammers-exploit-financial-anxiety#disqus_thread" data-disqus-identifier="158441"> 0 Comments</a>
													</div>
											</div>
																						<div class="related-article">
												<div class="large-card">
													<div class="thumb">
														<a href="https://www.malwarebytes.com/blog/news/2025/03/sperm-bank-breach-deposits-data-into-hands-of-cybercriminals">
															<img width="150" height="150" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2025/03/sample_header.jpg?w=150&amp;h=150&amp;crop=1" class="attachment-thumbnail size-thumbnail wp-post-image" alt="sperm bank information" loading="lazy" />														</a>
													</div>
													<div class="blog-info">
																													<div class="blog-list__category">
																																	<a href="https://www.malwarebytes.com/blog/category/news">News</a>
																	 | 																	<a href="https://www.malwarebytes.com/blog/category/privacy">Privacy</a>
																																</div>
																													<h2><a href="https://www.malwarebytes.com/blog/news/2025/03/sperm-bank-breach-deposits-data-into-hands-of-cybercriminals">Sperm bank breach deposits data into hands of cybercriminals</a></h2>
													</div>
													</div>
													<p class="blog-excerpt">March 19, 2025 - Sperm donor giant California Cryobank has announced it has suffered a data breach that exposed customers&#039; personal information.</p>
													<div class="blog-action">
														<a class="continue-read" href="https://www.malwarebytes.com/blog/news/2025/03/sperm-bank-breach-deposits-data-into-hands-of-cybercriminals">CONTINUE READING</a>
														<a class="num-comments" href="https://www.malwarebytes.com/blog/news/2025/03/sperm-bank-breach-deposits-data-into-hands-of-cybercriminals#disqus_thread" data-disqus-identifier="158428"> 0 Comments</a>
													</div>
											</div>
																			</div>								
							</div>
											</div>
				<div class="u-flex-column u-flex-col-lg-4">
					<div class="malwarebytes-sidebar u-margin-t50@max-767 u-margin-t50 u-margin-b20">
						<div id="right-rail">
														<div class="author-card blog-author">
								<div class="heading">
									<p>ABOUT THE AUTHOR</p>
								</div>
								<div class="card-inner">
									<div class="author-img">
										<a class="author-img" href="https://www.malwarebytes.com/blog/authors/hasherezade">
																							<img alt="hasherezade" src="https://secure.gravatar.com/userimage/34895611/56a7488edd8201874201d462661b7263?size=400" srcset="https://secure.gravatar.com/userimage/34895611/56a7488edd8201874201d462661b7263?size=400" class="avatar avatar-150 photo" height="150" width="150" loading="lazy">
																					</a>
									</div>
									<div class="content">
										<p class="details">
											<span class="name"><a href="https://www.malwarebytes.com/blog/authors/hasherezade">hasherezade</a></span>
																							<a class="social socicon-twitter" target="_blank" href="https://twitter.com/hasherezade">
													<img src="https://www.malwarebytes.com/wp-content/themes/malwarebytes/assets/src/images/twitter-blue.svg" alt="twitter-icon">
												</a>
																						</p>							
																					<span class="title">Malware Intelligence Analyst</span>
																						<p class="desc">Unpacks malware with as much joy as a kid unpacking candies.</p>
																				</div>
								</div>
							</div>							
						</div>
					</div>
				</div>
			</div>
		</div>
		
<div class="wp-block-group alignfull labs-links-block has-background has-global-padding is-layout-constrained wp-container-core-group-is-layout-4 wp-block-group-is-layout-constrained" style="border-style:none;border-width:0px;background-color:#f7fbff;padding-top:var(--wp--preset--spacing--60);padding-right:var(--wp--preset--spacing--70);padding-bottom:var(--wp--preset--spacing--60);padding-left:var(--wp--preset--spacing--70)">
<div class="wp-block-columns is-layout-flex wp-container-core-columns-is-layout-7 wp-block-columns-is-layout-flex" style="margin-top:0;margin-bottom:0;padding-top:0;padding-right:0;padding-bottom:0;padding-left:0">
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow">
<figure class="wp-block-image aligncenter size-large"><a href="https://www.malwarebytes.com/blog/authors"><img loading="lazy" decoding="async" width="58" height="58" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/08/Screenshot-2023-08-24-at-6.14.19-PM.png?w=58" alt="Contributors icon" class="wp-image-11363"/></a></figure>



<p class="has-text-align-center"><a href="https://www.malwarebytes.com/blog/authors">Contributors</a></p>
</div>



<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow">
<figure class="wp-block-image aligncenter size-large"><a href="https://www.malwarebytes.com/blog/threats"><img loading="lazy" decoding="async" width="56" height="57" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/08/Screenshot-2023-08-24-at-6.14.55-PM.png?w=56" alt="Threat Center icon" class="wp-image-11362"/></a></figure>



<p class="has-text-align-center"><a href="https://www.malwarebytes.com/blog/threats">Threat Center</a></p>
</div>



<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow">
<figure class="wp-block-image aligncenter size-large"><a href="https://www.malwarebytes.com/blog/podcast"><img loading="lazy" decoding="async" width="56" height="57" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/08/Screenshot-2023-08-24-at-6.15.19-PM.png?w=56" alt="Podcasts icon" class="wp-image-11361"/></a></figure>



<p class="has-text-align-center"><a href="https://www.malwarebytes.com/blog/category/podcast">Podcast</a></p>
</div>



<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow">
<figure class="wp-block-image aligncenter size-large"><a href="https://www.malwarebytes.com/glossary"><img loading="lazy" decoding="async" width="56" height="57" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/08/Screenshot-2023-08-24-at-6.15.36-PM.png?w=56" alt="Glossary icon" class="wp-image-11360"/></a></figure>



<p class="has-text-align-center"><a href="https://www.malwarebytes.com/glossary">Glossary</a></p>
</div>



<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow">
<figure class="wp-block-image aligncenter size-large"><a href="https://www.malwarebytes.com/blog/tech-support-scams"><img loading="lazy" decoding="async" width="56" height="57" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/08/Screenshot-2023-08-24-at-6.15.51-PM.png?w=56" alt="Scams icon" class="wp-image-11359"/></a></figure>



<p class="has-text-align-center"><a href="https://www.malwarebytes.com/blog/news/2016/05/tech-support-scams">Scams</a></p>
</div>
</div>
</div>
	</main><!-- #main -->
		<script>
		var disqus_config = function () {			
			this.page.url = 'https://www.malwarebytes.com/blog/news/2019/05/hidden-bee-lets-go-down-the-rabbit-hole';
			this.page.identifier = '230169';
		};

		(function() {
			var d = document, s = d.createElement('script');			
			s.src = 'https://malwarebytesunpacked.disqus.com/embed.js';

			s.setAttribute('data-timestamp', +new Date());
			(d.head || d.body).appendChild(s);
		})();
	</script>

<span id="kadence-conversion-end-of-content"></span>
	<footer id="colophon" class="site-footer">
		
		<div class="site-footer__top">
			<div class="container">

								<div class="site-footer__info">
											<a class="footer-logo" href="https://www.malwarebytes.com/" rel="home" id="cta-navbar-footer-company-logo-en">
							<img width="1240" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/07/footer-logo-1.svg" class="attachment-full size-full" alt="MalwareBytes-Footer-Logo" width="150" height="46" decoding="async" loading="lazy" />						</a>
										<p class="site-footer__description">
					Cyberprotection for every one.					</p>
				</div>
				
				<div class="site-footer__row u-flex-columns">
											<div class="u-flex-column u-flex-col-lg-2 u-flex-col-sm-6">
							
<p style="font-style:normal;font-weight:500">COMPUTER SECURITY</p>
<div class="menu-footer-computer-security-container"><ul id="menu-footer-computer-security" class="menu"><li id="menu-item-119904" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-119904"><a href="https://www.malwarebytes.com/rootkit" id="cta-mb-footer-rootkit-scanner">Rootkit Scanner</a></li>
<li id="menu-item-119905" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-119905"><a href="https://www.malwarebytes.com/solutions/trojan-scanner" id="cta-mb-footer-trojan-scanner">Trojan Scanner</a></li>
<li id="menu-item-119906" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-119906"><a href="https://www.malwarebytes.com/solutions/free-antivirus" id="cta-mb-footer-free-antivirus">Free Antivirus</a></li>
<li id="menu-item-119907" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-119907"><a href="https://www.malwarebytes.com/solutions/virus-scanner" id="cta-mb-footer-virus-scan">Free Virus Scan</a></li>
<li id="menu-item-119908" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-119908"><a href="https://www.malwarebytes.com/premium" id="cta-mb-footer-premium-protection">Premium protection</a></li>
</ul></div>
<p style="font-style:normal;font-weight:500">MOBILE SECURITY</p>

<div class="wp-block-group has-global-padding is-layout-constrained wp-block-group-is-layout-constrained" style="padding-bottom:var(--wp--preset--spacing--40)"><div class="widget widget_nav_menu"><div class="menu-footer-android-security-container"><ul id="menu-footer-android-security" class="menu"><li id="menu-item-119910" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-119910"><a href="https://www.malwarebytes.com/android-antivirus" id="cta-mb-footer-android-security">Antivirus for Android</a></li>
</ul></div></div>


<figure class="wp-block-image size-large"><a href="https://go.onelink.me/app/516cebeb"><img loading="lazy" decoding="async" width="135" height="40" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/08/google_play_store_button.png?w=135" alt="google play store" class="wp-image-6309"/></a></figure>
</div>

<div class="wp-block-group has-global-padding is-layout-constrained wp-block-group-is-layout-constrained"><div class="widget widget_nav_menu"><div class="menu-footer-ios-security-container"><ul id="menu-footer-ios-security" class="menu"><li id="menu-item-119913" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-119913"><a href="https://www.malwarebytes.com/ios" id="cta-mb-footer-ios-security">iOS Security and Spam Blocker</a></li>
</ul></div></div>


<figure class="wp-block-image size-large"><a href="https://apps.apple.com/US/app/id1327105431?mt=8"><img loading="lazy" decoding="async" width="120" height="40" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/08/apple_app_store_button_dark.png?w=120" alt="apple store icon" class="wp-image-6313"/></a></figure>
</div>
						</div>
																<div class="u-flex-column u-flex-col-lg-2 u-flex-col-sm-6">
							
<p style="font-style:normal;font-weight:500">PRIVACY PROTECTION</p>
<div class="menu-footer-privacy-protection-container"><ul id="menu-footer-privacy-protection" class="menu"><li id="menu-item-124415" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-124415"><a href="https://www.malwarebytes.com/vpn" id="cta-mb-footer-privacy-vpn">Privacy VPN (Virtual Private Network)</a></li>
<li id="menu-item-120239" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-120239"><a href="https://www.malwarebytes.com/digital-footprint" id="cta-mb-footer-digital-footprint-scan">Digital Footprint Scan</a></li>
<li id="menu-item-119923" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-119923"><a href="https://www.malwarebytes.com/solutions/dark-web-monitoring" id="cta-mb-footer-dark-web-monitoring">Dark Web Monitoring</a></li>
<li id="menu-item-119924" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-119924"><a href="https://www.malwarebytes.com/adwcleaner" id="cta-mb-footer-adware-removal-adwcleaner">Adware Removal</a></li>
<li id="menu-item-119925" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-119925"><a href="https://www.malwarebytes.com/browserguard" id="cta-mb-footer-adblocker-browserguard">Ad Blocker</a></li>
</ul></div>
<p style="font-style:normal;font-weight:500">IDENTITY PROTECTION</p>
<div class="menu-footer-identity-protection-container"><ul id="menu-footer-identity-protection" class="menu"><li id="menu-item-120211" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-120211"><a href="https://www.malwarebytes.com/identity-theft-protection" id="cta-mb-footer-identity-monitoring-alerts">Identity Monitoring &#038; Alerts</a></li>
<li id="menu-item-120212" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-120212"><a href="https://www.malwarebytes.com/identity-theft-protection" id="cta-mb-footer-credit-monitoring-reporting">Credit Monitoring &#038; Reporting</a></li>
<li id="menu-item-120213" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-120213"><a href="https://www.malwarebytes.com/identity-theft-protection" id="cta-mb-footer-identity-recovery-resolution">Identity Recovery &#038; Resolution</a></li>
<li id="menu-item-120214" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-120214"><a href="https://www.malwarebytes.com/identity-theft-protection" id="cta-mb-footer-identity-theft-insurance">ID Theft Insurance</a></li>
<li id="menu-item-120215" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-120215"><a href="https://www.malwarebytes.com/personal-data-remover" id="cta-mb-footer-personal-data-remover-pdr">Personal Data Remover</a></li>
</ul></div>						</div>
																<div class="u-flex-column u-flex-col-lg-2 u-flex-col-sm-6">
							
<p style="font-style:normal;font-weight:500">LEARN ABOUT CYBERSECURITY</p>
<div class="menu-footer-learn-about-cybersecurity-container"><ul id="menu-footer-learn-about-cybersecurity" class="menu"><li id="menu-item-120251" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-120251"><a href="https://www.malwarebytes.com/blog">Blog</a></li>
<li id="menu-item-120244" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-120244"><a href="https://www.malwarebytes.com/social-engineering">Social Engineering</a></li>
<li id="menu-item-120220" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-120220"><a href="https://www.malwarebytes.com/phishing">Phishing</a></li>
<li id="menu-item-120221" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-120221"><a href="https://www.malwarebytes.com/solutions/ransomware-protection">Ransomware</a></li>
<li id="menu-item-120246" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-120246"><a href="https://www.malwarebytes.com/malware">Malware</a></li>
<li id="menu-item-120222" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-120222"><a href="https://www.malwarebytes.com/cybersecurity/basics/antivirus">Antivirus</a></li>
<li id="menu-item-120223" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-120223"><a href="https://www.malwarebytes.com/what-is-vpn">What is a VPN?</a></li>
<li id="menu-item-120224" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-120224"><a href="https://www.malwarebytes.com/doxxing">Doxxing</a></li>
</ul></div>
<p style="font-style:normal;font-weight:500">PARTNER WITH MALWAREBYTES</p>
<div class="menu-footer-partner-with-mb-container"><ul id="menu-footer-partner-with-mb" class="menu"><li id="menu-item-120226" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-120226"><a href="https://www.malwarebytes.com/techbench" id="cta-mb-footer-computer-repair-techbench">Computer Repair</a></li>
<li id="menu-item-120227" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-120227"><a href="https://www.malwarebytes.com/affiliates" id="cta-mb-footer-affiliates">Affiliates</a></li>
</ul></div>
<p style="font-style:normal;font-weight:500">ADDRESS</p>

<p class="address-text address-global">One Albert Quay<br>2nd Floor<br>Cork T12 X8N6<br>Ireland</p>

<p class="address-text address-usa-ca hidden">2445 Augustine Drive<br>Suite 550<br>Santa Clara, CA<br>USA, 95054</p>
						</div>
																<div class="site-footer__col u-flex-column u-flex-col-lg-2 u-flex-col-sm-6">
							
<p style="font-style:normal;font-weight:500">ABOUT MALWAREBYTES</p>
<div class="menu-footer-about-mb-container"><ul id="menu-footer-about-mb" class="menu"><li id="menu-item-120230" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-120230"><a href="https://www.malwarebytes.com/jobs" id="cta-mb-footer-careers">Careers</a></li>
<li id="menu-item-120231" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-120231"><a href="https://www.malwarebytes.com/press/" id="cta-mb-footer-press">News and Press</a></li>
<li id="menu-item-120232" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-120232"><a href="https://www.malwarebytes.com/secure" id="cta-mb-footer-vulnerability-discolsure">Vulnerability Disclosure</a></li>
<li id="menu-item-120233" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-120233"><a href="https://forums.malwarebytes.com/forum/122-false-positives" id="cta-mb-footer-false-positive">Report a False Positive</a></li>
<li id="menu-item-120234" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-120234"><a href="https://forums.malwarebytes.com/" id="cta-mb-footer-forums">Forums</a></li>
</ul></div>
<p style="font-style:normal;font-weight:500">GET HELP</p>
<div class="menu-footer-get-help-container"><ul id="menu-footer-get-help" class="menu"><li id="menu-item-120236" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-120236"><a href="https://support.malwarebytes.com/hc/en-us">Help Center</a></li>
<li id="menu-item-120237" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-120237"><a href="https://my.malwarebytes.com">Sign in to MyAccount</a></li>
</ul></div>
<div class="wp-block-group has-background has-global-padding is-layout-constrained wp-container-core-group-is-layout-8 wp-block-group-is-layout-constrained" style="background-color:#ffffff12;padding-top:var(--wp--preset--spacing--20);padding-right:var(--wp--preset--spacing--20);padding-bottom:var(--wp--preset--spacing--20);padding-left:var(--wp--preset--spacing--20)">
<figure class="wp-block-image size-large"><a href="https://www.threatdown.com/?utm_campaign=mwb-referral&amp;utm_source=malwarebytes.com&amp;utm_medium=referral&amp;utm_content=cta-mb-footer-threatdown-logo"><img loading="lazy" decoding="async" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/11/ThreatDown_Horizontal_Reverse-2-2.svg?w=1024" width="156" height="37" alt="Threatdown powered by Malwarebytes logo" class="wp-image-98222"/></a></figure>


<div class="widget widget_nav_menu"><div class="menu-footer-threatdown-container"><ul id="menu-footer-threatdown" class="menu"><li id="menu-item-120248" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-120248"><a href="https://www.threatdown.com/?utm_campaign=mwb-referral&#038;utm_source=malwarebytes.com&#038;utm_medium=referral&#038;utm_content=cta-mb-footer-threatdown-endpoint-solution" id="cta-mb-footer-threatdown-endpoint-security-solution">Business Endpoint Security Solutions</a></li>
<li id="menu-item-120249" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-120249"><a href="https://www.threatdown.com/partner-program/msp/?utm_campaign=mwb-referral&#038;utm_source=malwarebytes.com&#038;utm_medium=referral&#038;utm_content=cta-en-us-footer-partner-msp" id="https://www.threatdown.com/partner-program/msp/">Managed Service Provider (MSP) Program</a></li>
</ul></div></div></div>
						</div>
										<div class="site-footer__connect u-flex-column u-flex-col-lg-4">
													<ul class="site-footer__social-icons u-flex-center">
																		<li>
											<a href="https://twitter.com/malwarebytes" id="cta-footer-social-twitter-en" class="social socicon-twitter" target="_blank" rel="noopener">
												<img width="1240" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2024/01/x-logo.svg?w=1240" class="attachment-social-icon-image size-social-icon-image" alt="Twitter icon" width="30" height="20" decoding="async" loading="lazy" />												<span class="screen-reader-text">Twitter</span>
											</a>
										</li>
																			<li>
											<a href="https://www.facebook.com/Malwarebytes" id="cta-footer-social-facebook-en" class="social socicon-facebook" target="_blank" rel="noopener">
												<img width="1240" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/07/icon-facebook.svg?w=1240" class="attachment-social-icon-image size-social-icon-image" alt="Icon facebook" width="30" height="20" decoding="async" loading="lazy" />												<span class="screen-reader-text">Facebook</span>
											</a>
										</li>
																			<li>
											<a href="https://www.linkedin.com/company/malwarebytes" id="cta-footer-social-linkedin-en" class="social socicon-linkedin" target="_blank" rel="noopener">
												<img width="1240" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/07/icon-linkedin.svg?w=1240" class="attachment-social-icon-image size-social-icon-image" alt="Icon Linkedin" width="30" height="20" decoding="async" loading="lazy" />												<span class="screen-reader-text">LinkedIn</span>
											</a>
										</li>
																			<li>
											<a href="https://www.youtube.com/user/Malwarebytes" id="cta-footer-social-youtube-en" class="social socicon-youtube" target="_blank" rel="noopener">
												<img width="1240" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/07/icon-youtube.svg?w=1240" class="attachment-social-icon-image size-social-icon-image" alt="Icon youtube" width="30" height="20" decoding="async" loading="lazy" />												<span class="screen-reader-text">Youtube</span>
											</a>
										</li>
																			<li>
											<a href="https://www.instagram.com/malwarebytesofficial" id="cta-footer-social-instagram-en" class="social socicon-instagram-v2" target="_blank" rel="noopener">
												<img width="1240" src="https://www.malwarebytes.com/wp-content/uploads/sites/2/2023/07/icon-instagram.svg?w=1240" class="attachment-social-icon-image size-social-icon-image" alt="Icon instagram" width="30" height="20" decoding="async" loading="lazy" />												<span class="screen-reader-text">Instagram</span>
											</a>
										</li>
																</ul>
													<div class="site-footer__newsletter">
															<h2>Cybersecurity info you cant live without</h2>
																						<p>Want to stay informed on the latest news in cybersecurity? Sign up for our newsletter and learn how to protect your computer from threats.</p>
															<form action="https://www.malwarebytes.com/newsletter/" class="newsletter-form">
								<div class="newsletter-form__inline">
									<label>Email Address</label>
									<input type="email" name="email" id="cta-footer-newsletter-input-email-en" placeholder="Email Address" required class="newsletter-form__email">
									<input type="hidden" class="newsletter-form__pageurl" value="https://www.malwarebytes.com/blog/news/2019/05/hidden-bee-lets-go-down-the-rabbit-hole">
									<input name="source" type="hidden" value="">
									<input type="submit" value="Sign Up" class="newsletter-form__btn" id="cta-footer-newsletter-subscribe-email-en">
								</div>
								<div class="newsletter-form__validate hidden">
									<span></span>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="site-footer__bottom">
			<div class="container">
				<div class="u-flex-columns">
					<!--Weglot 4.3.1--><aside data-wg-notranslate="" class="country-selector weglot-dropdown close_outside_click closed weglot-shortcode wg-" tabindex="0" aria-expanded="false" aria-label="Language selected: English"><ul role="none"></ul></aside>
					<div class="u-flex-column u-flex-col-lg-9 site-footer__bottom-right">
						<ul id="menu-footer-bottom-menu" class="footer-bottom-menu u-flex-center"><li id="menu-item-2936" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2936"><a href="https://www.malwarebytes.com/legal" id="cta-en-us-footernavigation-legal-_legal-click">Legal</a></li>
<li id="menu-item-2937" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2937"><a href="https://www.malwarebytes.com/legal/privacy-policy" id="cta-en-us-footernavigation-legal-_legal_privacy_policy-click">Privacy</a></li>
<li id="menu-item-2940" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2940"><a href="https://www.malwarebytes.com/tos" id="cta-en-us-footernavigation-legal-_tos-click">Terms of Service</a></li>
<li id="menu-item-2938" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2938"><a href="https://www.malwarebytes.com/accessibility" id="cta-en-us-footernavigation-legal-_accessibility-click">Accessibility</a></li>
<li id="menu-item-116900" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-116900"><a href="https://www.malwarebytes.com/impressum">Imprint</a></li>
</ul>						<p class="site-footer__copyright">
						 2025 All Rights Reserved						</p>
					</div>
				</div>
			</div>
		</div>
	</footer><!-- #colophon -->
</div><!-- #page -->
	<script id="dsq-count-scr" src="https://malwarebytesunpacked.disqus.com/count.js" async></script>
				<script>
				(function(){let request = new XMLHttpRequest();
					let url = 'ht' + 'tps:' + '//' + 'api.weglot.com/' + 'pageviews?api_key=' + 'wg_ab7feeaf115f3476db3eec82a65b414c4';
					let data = JSON.stringify({
							url: location.protocol + '//' + location.host + location.pathname,
							language: document.getElementsByTagName('html')[0].getAttribute('lang'),
							browser_language: (navigator.language || navigator.userLanguage)
						}
					);
					request.open('POST', url, true);
					request.send(data);
				})();
			</script>
				<script>!function(t){"use strict";t.loadCSS||(t.loadCSS=function(){});var e=loadCSS.relpreload={};if(e.support=function(){var e;try{e=t.document.createElement("link").relList.supports("preload")}catch(t){e=!1}return function(){return e}}(),e.bindMediaToggle=function(t){function e(){t.media=a}var a=t.media||"all";t.addEventListener?t.addEventListener("load",e):t.attachEvent&&t.attachEvent("onload",e),setTimeout(function(){t.rel="stylesheet",t.media="only x"}),setTimeout(e,3e3)},e.poly=function(){if(!e.support())for(var a=t.document.getElementsByTagName("link"),n=0;n<a.length;n++){var o=a[n];"preload"!==o.rel||"style"!==o.getAttribute("as")||o.getAttribute("data-loadcss")||(o.setAttribute("data-loadcss",!0),e.bindMediaToggle(o))}},!e.support()){e.poly();var a=t.setInterval(e.poly,500);t.addEventListener?t.addEventListener("load",function(){e.poly(),t.clearInterval(a)}):t.attachEvent&&t.attachEvent("onload",function(){e.poly(),t.clearInterval(a)})}"undefined"!=typeof exports?exports.loadCSS=loadCSS:t.loadCSS=loadCSS}("undefined"!=typeof global?global:this);</script>
		<script type='text/javascript' id='rocket-browser-checker-js-after'>"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var MdBrowserCompatibilityChecker=function(){function MdBrowserCompatibilityChecker(options){_classCallCheck(this,MdBrowserCompatibilityChecker),this.passiveSupported=!1,this._checkPassiveOption(this),this.options=!!this.passiveSupported&&options}return _createClass(MdBrowserCompatibilityChecker,[{key:"_checkPassiveOption",value:function(self){try{var options={get passive(){return!(self.passiveSupported=!0)}};window.addEventListener("test",null,options),window.removeEventListener("test",null,options)}catch(err){self.passiveSupported=!1}}},{key:"initRequestIdleCallback",value:function(){!1 in window&&(window.requestIdleCallback=function(cb){var start=Date.now();return setTimeout(function(){cb({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-start))}})},1)}),!1 in window&&(window.cancelIdleCallback=function(id){return clearTimeout(id)})}},{key:"isDataSaverModeOn",value:function(){return"connection"in navigator&&!0===navigator.connection.saveData}},{key:"supportsLinkPrefetch",value:function(){var elem=document.createElement("link");return elem.relList&&elem.relList.supports&&elem.relList.supports("prefetch")&&window.IntersectionObserver&&"isIntersecting"in IntersectionObserverEntry.prototype}},{key:"isSlowConnection",value:function(){return"connection"in navigator&&"effectiveType"in navigator.connection&&("2g"===navigator.connection.effectiveType||"slow-2g"===navigator.connection.effectiveType)}}]),MdBrowserCompatibilityChecker}();</script>
		<script type="text/javascript" id="rocket-delay-js-js-after">(function() {"use strict";var e=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}();function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var t=function(){function r(e,t){n(this,r),this.attrName="data-mdlazyloadscript",this.browser=t,this.options=this.browser.options,this.triggerEvents=e,this.userEventListener=this.triggerListener.bind(this)}return e(r,[{key:"init",value:function(){this._addEventListener(this)}},{key:"reset",value:function(){this._removeEventListener(this)}},{key:"_addEventListener",value:function(t){this.triggerEvents.forEach(function(e){return window.addEventListener(e,t.userEventListener,t.options)})}},{key:"_removeEventListener",value:function(t){this.triggerEvents.forEach(function(e){return window.removeEventListener(e,t.userEventListener,t.options)})}},{key:"_loadScriptSrc",value:function(){var r=this,e=document.querySelectorAll("script["+this.attrName+"]");0!==e.length&&Array.prototype.slice.call(e).forEach(function(e){var t=e.getAttribute(r.attrName);e.setAttribute("src",t),e.removeAttribute(r.attrName)}),this.reset()}},{key:"triggerListener",value:function(){this._loadScriptSrc(),this._removeEventListener(this)}}],[{key:"run",value:function(){MdBrowserCompatibilityChecker&&new r(["keydown","mouseover","touchmove","touchstart"],new MdBrowserCompatibilityChecker({passive:!0})).init()}}]),r}();t.run();}());</script>
				<script>
		document.addEventListener("DOMContentLoaded",function(){let lazyFrames=document.querySelectorAll("iframe[data-src]");if("IntersectionObserver" in window){let lazyFrameObserver=new IntersectionObserver(function(entries,observer){entries.forEach(function(entry){if(entry.isIntersecting){let lazyFrame=entry.target;lazyFrame.src=lazyFrame.dataset.src;lazyFrameObserver.unobserve(lazyFrame)}})});lazyFrames.forEach(function(lazyFrame){lazyFrameObserver.observe(lazyFrame)})}else{lazyFrames.forEach(function(lazyFrame){lazyFrame.src=lazyFrame.dataset.src})}})
		</script>
		<style id='malware-bytes-menu-links-style-inline-css'>
.menu-links .menu-links__title,.menu-links h2{color:#0d3ecc;font-size:18px;line-height:26px;font-weight:500;margin-top:0;word-wrap:normal;word-break:normal}.menu-links .menu-links__title a,.menu-links h2 a{text-decoration:none}.menu-links .menu-links__subtitle,.menu-links h3{font-size:16px;line-height:20px;color:#082882;margin:0 0 10px;font-weight:500;letter-spacing:.2px}.menu-links ul{margin:0;padding:0;list-style-type:none}.menu-links ul li{font-weight:400;font-size:15.75px;color:#191919;margin:15px 0}.menu-links ul li img{vertical-align:middle;margin:0 3px}.menu-links ul li a{color:#191919}.menu-links ul li a:hover{color:#0d3ecc;font-weight:600;letter-spacing:-0.25px}.menu-links .menu-links__desc{margin:0 0 5px;font-size:15.25px;line-height:20px;color:#082882}.menu-links .menu-links__desc a{text-decoration:none}.menu-links .menu-links__desc img{vertical-align:middle;margin:0 3px}.menu-links.layout-2 .menu-links__desc a{font-weight:500}.menu-links .menu-links__cta a{padding-right:44px;color:#0d3ecc;font-weight:500;font-size:18px;transition:.25s ease-in-out;background:rgba(0,0,0,0) url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDQwIDE2IiBmaWxsPSIjMGQzZWNjIj4KICAgIDxwYXRoCiAgICAgICAgZD0iTTM3LjE5MDE4MjMsNi42NTMxMjEwMyBMMi42MTEzOTgwOSw2LjUyMTIzMjM2IEw4LjIzMzM4OTc2LDEuMjIyNDY4MzMgQzguNTMwMTk2NjQsMC45NDI5NTk4MzYgOC41MzAxOTY2NCwwLjQ4OTMxNTMyNSA4LjIzMzM4OTc2LDAuMjA5ODA2ODI3IEM3LjkzNjU4Mjg3LC0wLjA2OTkzNTYwOSA3LjQ1NTc1NzE0LC0wLjA2OTkzNTYwOSA3LjE1ODk1NTMyLDAuMjA5ODA2ODI3IEwwLjMyMjU5MDE5MSw2LjY1MzEyMTAzIEMwLjEyNzkzMzgyNyw2Ljc4Mjc5NDQ1IDAsNi45OTU1NzMyNCAwLDcuMjM3MzY5OTQgQzAsNy4yNDEwNDEzNCAwLjAwMTA4NDAxMzI3LDcuMjQ0NDUwMTUgMC4wMDExNDQ3OTkwNiw3LjI0ODEyMTU1IEMwLjAwMTA1MzYyMDM3LDcuMjU1OTYwODcgMC4wMDM0MDQwMDQyOCw3LjI2MzM2MDk2IDAuMDAzNjE2NzU0NTQsNy4yNzEyMDAyOCBDMC4wMDcxNDIzMzA0LDcuMzQxMjI0MjEgMC4wMjE2MDkzNDg2LDcuNDA4MDM5ODQgMC4wNDQ5NTEwOTIyLDcuNDcxMzg5MzggQzAuMDU4NjQ4MTU3LDcuNTExNjAyODkgMC4wNzgzNDI3NTMyLDcuNTQ3ODgyNDIgMC4wOTk3Njk3NDQ0LDcuNTg1NzYxMzIgQzAuMTE4OTY3OTIzLDcuNjE3OTMwMjIgMC4xNDAyNDI5NSw3LjY0ODM4MDM5IDAuMTY0MjYzNDY4LDcuNjc3MjU5ODMgQzAuMTg1NjYwMDY3LDcuNzA0MDk1ODkgMC4xOTY2NjIyOTUsNy43MzU1OTY0IDAuMjIyNjAyNjMxLDcuNzYwMDE2NjkgTDcuMjA5MTU5MzEsMTQuMzQ0ODkyMiBDNy4zNTc1NjI3NiwxNC40ODQ3NjM0IDcuNTUxOTcwOTEsMTQuNTU0Njk2NiA3Ljc0NjM3OTA3LDE0LjU1NDY5NjYgQzcuOTQwNzg3MjIsMTQuNTU0Njk2NiA4LjEzNTE5NTM4LDE0LjQ4NDc2MzQgOC4yODM1OTg4MiwxNC4zNDQ4OTIyIEM4LjU4MDQwNTcsMTQuMDY1MTQ5OCA4LjU4MDQwNTcsMTMuNjExOTY4MyA4LjI4MzU5ODgyLDEzLjMzMjIzMDcgTDIuNTc2NzcwNDUsNy45NTM1MDc1MiBMMzcuMTkwMTgyMyw3Ljk1MzUwNzUyIEMzNy42MDk2NjUsNy45NTM1MDc1MiAzOCw3LjY3Mjk0NzQ5IDM4LDcuMjc3MzQ4MzIgQzM4LDYuODgxNzQ5MTQgMzcuNjA5NjY1LDYuNjUzMTIxMDMgMzcuMTkwMTgyMyw2LjY1MzEyMTAzIFoiCiAgICAgICAgaWQ9IlBhdGgxIiBzdHJva2Utd2lkdGg9IjAuNSIgZmlsbC1ydWxlPSJub256ZXJvIgogICAgICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE5LjAwMDAwMCwgNy4yNzczNDgpIHNjYWxlKC0xLCAxKSB0cmFuc2xhdGUoLTIwLjAwMDAwMCwgLTcuMjc3MzQ4KSI+CiAgICA8L3BhdGg+Cjwvc3ZnPg==) right 6px center no-repeat;background-size:30px;text-decoration:none}.menu-links .menu-links__cta a:hover{background-position:right 0 center}.menu-links.has-item-border .menu-links__item:not(:first-child){margin:10px 0 0;padding:10px 0 0;border-top:1px solid #d3d9e9}.menu-links.has-item-border .menu-links__item .menu-links__title+.menu-links__cta{margin-top:32px}.menu-links.layout-1.has-item-border .menu-links__item:not(:first-child){margin:20px 0 0;padding:20px 0 0}.menu-links.layout-2.has-item-border .menu-links__item:not(:first-child){margin:20px 0 0;padding:20px 0 0}.menu-links.layout-3 .menu-links__item:not(:first-child){margin:20px 0 0;padding:20px 0 0}.menu-links.layout-3.has-item-border .menu-links__item:not(:first-child){margin:25px 0 0;padding:25px 0 0}.menu-links.with-svg .menu-links__item{margin:20px 0 0;padding:20px 0 20px;border-top:1px solid #d3d9e9}.menu-links.with-svg .menu-links__desc a{font-weight:500}.menu-links.with-svg .menu-links__desc a svg{vertical-align:middle;margin:0 3px}@media (max-width: 1149px){.menu-links .menu-links__title,.menu-links h2{font-size:18px}}

</style>
<style id='wp-block-group-inline-css'>
.wp-block-group{box-sizing:border-box}:where(.wp-block-group.wp-block-group-is-layout-constrained){position:relative}
</style>
<style id='wp-block-group-theme-inline-css'>
:where(.wp-block-group.has-background){padding:1.25em 2.375em}
</style>
<style id='wp-block-columns-inline-css'>
.wp-block-columns{align-items:normal!important;box-sizing:border-box;display:flex;flex-wrap:wrap!important}@media (min-width:782px){.wp-block-columns{flex-wrap:nowrap!important}}.wp-block-columns.are-vertically-aligned-top{align-items:flex-start}.wp-block-columns.are-vertically-aligned-center{align-items:center}.wp-block-columns.are-vertically-aligned-bottom{align-items:flex-end}@media (max-width:781px){.wp-block-columns:not(.is-not-stacked-on-mobile)>.wp-block-column{flex-basis:100%!important}}@media (min-width:782px){.wp-block-columns:not(.is-not-stacked-on-mobile)>.wp-block-column{flex-basis:0;flex-grow:1}.wp-block-columns:not(.is-not-stacked-on-mobile)>.wp-block-column[style*=flex-basis]{flex-grow:0}}.wp-block-columns.is-not-stacked-on-mobile{flex-wrap:nowrap!important}.wp-block-columns.is-not-stacked-on-mobile>.wp-block-column{flex-basis:0;flex-grow:1}.wp-block-columns.is-not-stacked-on-mobile>.wp-block-column[style*=flex-basis]{flex-grow:0}:where(.wp-block-columns){margin-bottom:1.75em}:where(.wp-block-columns.has-background){padding:1.25em 2.375em}.wp-block-column{flex-grow:1;min-width:0;overflow-wrap:break-word;word-break:break-word}.wp-block-column.is-vertically-aligned-top{align-self:flex-start}.wp-block-column.is-vertically-aligned-center{align-self:center}.wp-block-column.is-vertically-aligned-bottom{align-self:flex-end}.wp-block-column.is-vertically-aligned-stretch{align-self:stretch}.wp-block-column.is-vertically-aligned-bottom,.wp-block-column.is-vertically-aligned-center,.wp-block-column.is-vertically-aligned-top{width:100%}
</style>
<style id='malware-bytes-inner-header-style-inline-css'>
.labs-sub-nav{padding:15px 0;background-color:#f1f8ff}.labs-sub-nav__row{display:flex;justify-content:space-between}.labs-sub-nav__colum.left{width:50%}.labs-sub-nav__colum.left .search-form{background-color:rgba(0,0,0,0)}.labs-sub-nav__colum.right{display:flex;flex-wrap:wrap;align-items:center}.labs-sub-nav__colum.right .subscribe-rss-wrp{display:flex;padding:0 12px;align-items:center}.labs-sub-nav__colum.right .subscribe-rss-wrp .subscribe-btn{border-radius:4px;background-color:#0d3ecc;color:#fff;height:50px;display:inline-block;padding:14px;font-weight:500;text-decoration:none;margin-right:15px}.labs-sub-nav__colum.right .subscribe-rss-wrp a{display:inline-block}.labs-sub-nav__colum.right .social-wrp{display:flex;padding:0 12px;gap:20px;align-items:center}.labs-sub-nav__colum.right .social-wrp a{display:block}.labs-sub-nav__searchbar-wrap{position:relative;width:100%;background-color:rgba(0,0,0,0)}.labs-sub-nav__search-input[type=text]{border:none;background-color:#fff;height:48px;width:100%;padding-left:20px;padding-right:62px;font-weight:700;max-width:277px}.labs-sub-nav__search-button{position:absolute;right:20px;top:0px;margin:0;border:none;cursor:pointer;border-radius:26px;background-color:rgba(0,0,0,0);width:75px;display:flex;justify-content:center;align-items:center;height:48px}@media (min-width: 992px){.labs-sub-nav__colum.left{width:33.3333333333%}}@media (max-width: 1149px){.labs-sub-nav{margin-top:30px}}@media (max-width: 767px){.labs-sub-nav{margin-bottom:30px}.labs-sub-nav__row{flex-wrap:wrap}.labs-sub-nav__colum.left{width:100%;margin-bottom:10px}.labs-sub-nav__colum.right .subscribe-rss-wrp{padding:0}.labs-sub-nav__colum.right .social-wrp{gap:15px}.labs-sub-nav__search-input[type=text]{max-width:100%}.labs-sub-nav__search-button{right:10px}}

</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--blue: #0D3ECC;--wp--preset--color--navy-blue: #1C284C;--wp--preset--color--secondary-black: #191919;--wp--preset--color--dark-blue: #082882;--wp--preset--color--sky-blue: #009DEB;--wp--preset--color--baby-blue: #8DCFFD;--wp--preset--color--yellow: #EFC148;--wp--preset--color--pink: #E74488;--wp--preset--color--ruby: #A02A5C;--wp--preset--color--charcoal: #3D3D3D;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:root { --wp--style--global--content-size: 1200px;--wp--style--global--wide-size: 1200px; }:where(body) { margin: 0; }.wp-site-blocks { padding-top: var(--wp--style--root--padding-top); padding-bottom: var(--wp--style--root--padding-bottom); }.has-global-padding { padding-right: var(--wp--style--root--padding-right); padding-left: var(--wp--style--root--padding-left); }.has-global-padding > .alignfull { margin-right: calc(var(--wp--style--root--padding-right) * -1); margin-left: calc(var(--wp--style--root--padding-left) * -1); }.has-global-padding :where(:not(.alignfull.is-layout-flow) > .has-global-padding:not(.wp-block-block, .alignfull)) { padding-right: 0; padding-left: 0; }.has-global-padding :where(:not(.alignfull.is-layout-flow) > .has-global-padding:not(.wp-block-block, .alignfull)) > .alignfull { margin-left: 0; margin-right: 0; }.wp-site-blocks > .alignleft { float: left; margin-right: 2em; }.wp-site-blocks > .alignright { float: right; margin-left: 2em; }.wp-site-blocks > .aligncenter { justify-content: center; margin-left: auto; margin-right: auto; }:where(.wp-site-blocks) > * { margin-block-start: 24px; margin-block-end: 0; }:where(.wp-site-blocks) > :first-child { margin-block-start: 0; }:where(.wp-site-blocks) > :last-child { margin-block-end: 0; }:root { --wp--style--block-gap: 24px; }:root :where(.is-layout-flow) > :first-child{margin-block-start: 0;}:root :where(.is-layout-flow) > :last-child{margin-block-end: 0;}:root :where(.is-layout-flow) > *{margin-block-start: 24px;margin-block-end: 0;}:root :where(.is-layout-constrained) > :first-child{margin-block-start: 0;}:root :where(.is-layout-constrained) > :last-child{margin-block-end: 0;}:root :where(.is-layout-constrained) > *{margin-block-start: 24px;margin-block-end: 0;}:root :where(.is-layout-flex){gap: 24px;}:root :where(.is-layout-grid){gap: 24px;}.is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}.is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}.is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}.is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}.is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}.is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}.is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}.is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}body{--wp--style--root--padding-top: 0px;--wp--style--root--padding-right: 0px;--wp--style--root--padding-bottom: 0px;--wp--style--root--padding-left: 0px;}a:where(:not(.wp-element-button)){text-decoration: underline;}:root :where(.wp-element-button, .wp-block-button__link){background-color: #32373c;border-width: 0;color: #fff;font-family: inherit;font-size: inherit;line-height: inherit;padding: calc(0.667em + 2px) calc(1.333em + 2px);text-decoration: none;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-blue-color{color: var(--wp--preset--color--blue) !important;}.has-navy-blue-color{color: var(--wp--preset--color--navy-blue) !important;}.has-secondary-black-color{color: var(--wp--preset--color--secondary-black) !important;}.has-dark-blue-color{color: var(--wp--preset--color--dark-blue) !important;}.has-sky-blue-color{color: var(--wp--preset--color--sky-blue) !important;}.has-baby-blue-color{color: var(--wp--preset--color--baby-blue) !important;}.has-yellow-color{color: var(--wp--preset--color--yellow) !important;}.has-pink-color{color: var(--wp--preset--color--pink) !important;}.has-ruby-color{color: var(--wp--preset--color--ruby) !important;}.has-charcoal-color{color: var(--wp--preset--color--charcoal) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-blue-background-color{background-color: var(--wp--preset--color--blue) !important;}.has-navy-blue-background-color{background-color: var(--wp--preset--color--navy-blue) !important;}.has-secondary-black-background-color{background-color: var(--wp--preset--color--secondary-black) !important;}.has-dark-blue-background-color{background-color: var(--wp--preset--color--dark-blue) !important;}.has-sky-blue-background-color{background-color: var(--wp--preset--color--sky-blue) !important;}.has-baby-blue-background-color{background-color: var(--wp--preset--color--baby-blue) !important;}.has-yellow-background-color{background-color: var(--wp--preset--color--yellow) !important;}.has-pink-background-color{background-color: var(--wp--preset--color--pink) !important;}.has-ruby-background-color{background-color: var(--wp--preset--color--ruby) !important;}.has-charcoal-background-color{background-color: var(--wp--preset--color--charcoal) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-blue-border-color{border-color: var(--wp--preset--color--blue) !important;}.has-navy-blue-border-color{border-color: var(--wp--preset--color--navy-blue) !important;}.has-secondary-black-border-color{border-color: var(--wp--preset--color--secondary-black) !important;}.has-dark-blue-border-color{border-color: var(--wp--preset--color--dark-blue) !important;}.has-sky-blue-border-color{border-color: var(--wp--preset--color--sky-blue) !important;}.has-baby-blue-border-color{border-color: var(--wp--preset--color--baby-blue) !important;}.has-yellow-border-color{border-color: var(--wp--preset--color--yellow) !important;}.has-pink-border-color{border-color: var(--wp--preset--color--pink) !important;}.has-ruby-border-color{border-color: var(--wp--preset--color--ruby) !important;}.has-charcoal-border-color{border-color: var(--wp--preset--color--charcoal) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<style id='core-block-supports-inline-css'>
.wp-container-core-group-is-layout-1{flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-2{flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-3{flex-direction:column;align-items:stretch;}.wp-container-core-columns-is-layout-1{flex-wrap:nowrap;}.wp-container-core-columns-is-layout-2{flex-wrap:nowrap;}.wp-container-core-columns-is-layout-3{flex-wrap:nowrap;}.wp-container-core-columns-is-layout-4{flex-wrap:nowrap;}.wp-container-core-columns-is-layout-5{flex-wrap:nowrap;}.wp-container-core-columns-is-layout-6{flex-wrap:nowrap;}.wp-container-core-columns-is-layout-7{flex-wrap:nowrap;}.wp-container-core-group-is-layout-4 > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width:900px;margin-left:auto !important;margin-right:auto !important;}.wp-container-core-group-is-layout-4 > .alignwide{max-width:900px;}.wp-container-core-group-is-layout-4 .alignfull{max-width:none;}.wp-container-core-group-is-layout-4 > .alignfull{margin-right:calc(var(--wp--preset--spacing--70) * -1);margin-left:calc(var(--wp--preset--spacing--70) * -1);}
</style>
<script src="https://www.malwarebytes.com/wp-includes/js/jquery/jquery.min.js?ver=1.0" id="jquery-js"></script>
<script id="geot-js-js-extra">
var geot = {"ajax_url":"https:\/\/www.malwarebytes.com\/wp-admin\/admin-ajax.php","ajax":"","pid":"65729","is_archive":"","is_search":"","is_singular":"1","is_front_page":"","is_category":"","is_page":"","is_single":"1","disable_remove_on_singular":"","is_builder":"","has_geo_posts":"1","dropdown_search":"","dropdown_redirect":"","elementor_popup":"1","hide_class":"","hide_override_class":"","remove_class":"","remove_override_class":"","disable_console":"","geoloc_enable":"by_ip","geoloc_force":"","geoloc_fail":"Geolocation is not supported by this browser","geot_cookies_duration":"999"};
</script>
<script id="main-js-js-extra">
var siteConfig = {"ajaxUrl":"https:\/\/www.malwarebytes.com\/wp-admin\/admin-ajax.php","ajax_nonce":"155960d511","pwnedAPI":"https:\/\/www.malwarebytes.com\/wp-json\/wp\/v2\/api\/aws\/have-i-been-pwned\/","eventAPI":"https:\/\/www.malwarebytes.com\/wp-json\/wp\/v2\/api\/analytics\/event\/","newsletterAPI":"https:\/\/www.malwarebytes.com\/wp-json\/wp\/v2\/api\/iterable\/newsletter\/","newsletterSuccess":"https:\/\/www.malwarebytes.com\/en\/thank_you\/","newsletterError":"https:\/\/www.malwarebytes.com\/en\/newsletter_error\/","homeURL":"https:\/\/www.malwarebytes.com","request":"blog\/news\/2019\/05\/hidden-bee-lets-go-down-the-rabbit-hole"};
var global_variables = {"when":"7\/3\/2023 2:14:31 PM","site":{"language":"en","country":"us","origin":"https:\/\/www.malwarebytes.com","phoneNumbers":{"US":{"view":"+1-800-520-2796","call":"18005202796"},"GB":{"view":"+44 (800) 368-8486","call":"448003688486"},"FR":{"view":"+33 (800) 909-009","call":"33800909009"},"ES":{"view":"+34 (900) 823-509","call":"34900823509"},"DE":{"view":"+49 (800) 723-4800","call":"498007234800"},"IT":{"view":"+39 (800) 972-511","call":"39800972511"},"SG":{"view":"+65 6813-2150","call":"6568132150"},"AU":{"view":"1800-745-824","call":"1800745824"},"NZ":{"view":"0800-446-541","call":"0800446541"}},"endpoints":{"carts":{"lira":"https:\/\/ecom.malwarebytes.com","onepay":"https:\/\/buy.malwarebytes.com"}},"downloadLinks":{"vpn":{"mac":"https:\/\/downloads.malwarebytes.com\/file\/mbprivacy-mac","windows":"https:\/\/downloads.malwarebytes.com\/file\/mbprivacy-online","ios":"https:\/\/apps.apple.com\/us\/app\/malwarebytes-privacy-vpn\/id1504101226","android":"https:\/\/play.google.com\/store\/apps\/details?id=org.malwarebytes.harpocrates"},"free":{"mac":"https:\/\/www.malwarebytes.com\/mac-download","windows":"https:\/\/www.malwarebytes.com\/mwb-download\/thankyou","ios":"https:\/\/apps.apple.com\/US\/app\/id1327105431?mt=8","android":"https:\/\/play.google.com\/store\/apps\/details?id=org.malwarebytes.antimalware"}},"apiHostname":"https:\/\/www-api.malwarebytes.com","liraCartLinkEndpoint":"https:\/\/ecom.malwarebytes.com"}};
</script>
<script type="text/javascript" src="https://www.malwarebytes.com/_static/??-eJyVjEkOwjAMRS9Ea4YCYoE4SxKs4Mhxo9pRVE5PBBvEjuX7w4NWhjCLoRgUrpFEIeJsboloJLEVKNUzBUhfxfDJxqQb+EeQSUCRMRg9cez0a7AHZuw7x80t6Ffr4FTRFHwlvvfmfbrl6+487Y/bw3Q5pRdZQ0nU"  defer></script><script defer src="https://www.malwarebytes.com/wp-content/themes/malwarebytes/assets/build/main-vwo-personalization-threatdown.js?ver=1.4" id="vwo-personalization-threatdown-js"></script>
<script type="text/javascript" src="https://www.malwarebytes.com/_static/??-eJyVjMENwjAMABciWEQFxAMxi5ua4jaxq9hVBNOTFfo86e6gbSGpOImDf6iQQcHcsNL49Q5oRm5gNcFiQElLoZoIdufMzt1IqivTebETHHptVE0FM//QWaWrdSVnmUPCsiHPYgem4855gnclCpM2yYpTr1/lebkPcYjX+LgtfzNKWUM="  defer></script><script id="jetpack-stats-js-before">
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"227197325\",\"post\":\"65729\",\"tz\":\"-7\",\"srv\":\"www.malwarebytes.com\",\"hp\":\"vip\",\"j\":\"1:14.4.1\"}") ]);
_stq.push([ "clickTrackerInit", "227197325", "65729" ]);
</script>
<script defer src="https://stats.wp.com/e-202512.js" id="jetpack-stats-js" defer data-wp-strategy="defer"></script>
		<script type="text/javascript" id="flying-scripts">const loadScriptsTimer = setTimeout(loadScripts,5* 1000
			)
			;const userInteractionEvents = ["mouseover", "keydown", "touchstart", "touchmove", "wheel"];
			userInteractionEvents.forEach(function (event) {
				window.addEventListener(event, triggerScriptLoader, {passive: !0})
			});

			function triggerScriptLoader() {
				loadScripts();
				clearTimeout(loadScriptsTimer);
				userInteractionEvents.forEach(function (event) {
					window.removeEventListener(event, triggerScriptLoader, {passive: !0})
				})
			}

			function loadScripts() {
				document.querySelectorAll("script[data-type='lazy']").forEach(function (elem) {
					elem.setAttribute("src", elem.getAttribute("data-src"))
				})
			}</script>
		<!--Weglot 4.3.1--><aside data-wg-notranslate="" class="country-selector weglot-dropdown close_outside_click closed weglot-default wg-" tabindex="0" aria-expanded="false" aria-label="Language selected: English"><ul role="none"></ul></aside> <script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"NRJS-51878192dd15f231213","applicationID":"732197726","transactionName":"ZgNQMkpUVkYDBRVQXF9JcwVMXFdbTRUIV1RdAx8WV0ZM","queueTime":0,"applicationTime":772,"atts":"SkRHRAJORRlAB0MDSEwb","errorBeacon":"bam.nr-data.net","agent":""}</script></body>
</html>
