<!doctype html><!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en" > <![endif]--><!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en" >        <![endif]--><!--[if IE 8]>    <html class="no-js lt-ie9" lang="en" >               <![endif]--><!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]--><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="Cybereason Nocturnus">
    <meta name="description" content="Cybereason discovered a new toolset developed by Iranian APT Phosphorus which revealed a connection to Memento ransomware and includes the newly discovered PowerLess Backdoor that evades detection by running PowerShell in a .NET context...">
    <meta name="generator" content="HubSpot">
    <title>PowerLess Trojan: Iranian APT Phosphorus Adds New PowerShell Backdoor for Espionage</title>
    <link rel="shortcut icon" href="https://www.cybereason.com/hubfs/cr-favicon-1.png">
    
<meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:description" content="Cybereason discovered a new toolset developed by Iranian APT Phosphorus which revealed a connection to Memento ransomware and includes the newly discovered PowerLess Backdoor that evades detection by running PowerShell in a .NET context...">
    <meta property="og:title" content="PowerLess Trojan: Iranian APT Phosphorus Adds New PowerShell Backdoor for Espionage">
    <meta name="twitter:description" content="Cybereason discovered a new toolset developed by Iranian APT Phosphorus which revealed a connection to Memento ransomware and includes the newly discovered PowerLess Backdoor that evades detection by running PowerShell in a .NET context...">
    <meta name="twitter:title" content="PowerLess Trojan: Iranian APT Phosphorus Adds New PowerShell Backdoor for Espionage">

    

    
    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>

<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41681847227/1644941386203/module_41681847227_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41682410610/1644941443237/module_41682410610_CR_-_Malicious_Life_Network_--_Main_Hero.min.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/1642017327438/module_48386556055_CR_-_HTML_PopUp_Window_--_IOCs.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/43300360745/1724042214535/module_43300360745_CR_-_Malicious_Life_Network_--_Related_Posts.min.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/1669911113479/module_86933076631_CR_-_Sticky_CTA_Bar.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/34473990280/1704383554067/module_34473990280_CR_-_Footer_Full__en_US.min.css">
    

    
<!--  Added by GoogleTagManager integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;



var hsLoadGtm = function loadGtm() {
    if(window._hsGtmLoadOnce) {
      return;
    }

    if (useGoogleConsentModeV2) {

      gtag('set','developer_id.dZTQ1Zm',true);

      gtag('consent', 'default', {
      'ad_storage': 'denied',
      'analytics_storage': 'denied',
      'ad_user_data': 'denied',
      'ad_personalization': 'denied',
      'wait_for_update': waitForUpdateMillis
      });

      _hsp.push(['useGoogleConsentModeV2'])
    }

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TJVVB7C');

    window._hsGtmLoadOnce = true;
};

_hsp.push(['addPrivacyConsentListener', function(consent){
  if(consent.allowed || (consent.categories && consent.categories.analytics)){
    hsLoadGtm();
  }
}]);

</script>

<!-- /Added by GoogleTagManager integration -->


<script src="https://use.typekit.net/vyv2ljd.js"></script>
<script>try{Typekit.load({ async: false });}catch(e){}</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link rel="preload" href="/hubfs/__dam/fonts/ionicons.eot" as="font" type="font/otf" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/criteria/Criteria-CF-Regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/criteria/Criteria-CF-Medium.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/peristyle/Peristyle-Black.woff2" as="font" type="font/woff2" crossorigin>
<link rel="amphtml" href="https://www.cybereason.com/blog/research/powerless-trojan-iranian-apt-phosphorus-adds-new-powershell-backdoor-for-espionage?hs_amp=true">

<meta property="og:image" content="https://www.cybereason.com/hubfs/powerless.png">

<meta name="twitter:image" content="https://www.cybereason.com/hubfs/powerless.png">


<meta property="og:url" content="https://www.cybereason.com/blog/research/powerless-trojan-iranian-apt-phosphorus-adds-new-powershell-backdoor-for-espionage">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@cr_nocturnus">

<link rel="canonical" href="https://www.cybereason.com/blog/research/powerless-trojan-iranian-apt-phosphorus-adds-new-powershell-backdoor-for-espionage">

<meta property="og:type" content="article">
<link rel="alternate" type="application/rss+xml" href="https://www.cybereason.com/blog/rss.xml">
<meta name="twitter:domain" content="www.cybereason.com">
<script src="//platform.linkedin.com/in.js" type="text/javascript">
    lang: en_US
</script>

<meta http-equiv="content-language" content="en">
<link rel="stylesheet" href="//7052064.fs1.hubspotusercontent-na1.net/hub/7052064/hub_generated/template_assets/1729622897632/hubspot/hubspot_default/shared/responsive/layout.min.css">


<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/34470223313/1696396395659/__CR_Web_Platform/CSS/cr-master__cta.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/34470477360/1710134689941/__CR_Web_Platform/CSS/cr-master__main.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/35275979682/1642096258129/__CR_Web_Platform/CSS/ionicons.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42760289143/1724041950600/__CR_Web_Platform/CSS/cr-mln__build.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/34470224480/1635957556830/__CR_Web_Platform/CSS/bulma/cr-framework__bulma-columns.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/35291999472/1696396871390/__CR_Web_Platform/CSS/bulma/cr-framework__bulma.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42363645447/1635957556555/__CR_Web_Platform/CSS/hamburger-animation.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42507091846/1635957557027/__CR_Web_Platform/CSS/animate.min.css">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap" rel="stylesheet">
<script src="/hubfs/dam/plugins/marker-animation.js"></script>
<script>
$(document).ready(function() {
  $('.highlight').markerAnimation({
    "color":'var(--cr-yellow)',
    "font_weight":'normal',
    "background-size": '200% 1.2em'
  });
});
</script>

    <style>
.cr-mln__blog-post .container-is-blog.cr-mln__blog-post--body .column:nth-of-type(2) img {
    background: #FFFFFF;
    border: 1px solid #CCCCCC;
    border-radius: 5px 5px 5px 5px;
    padding: 10px;
} 
</style>

</head>
<body class="   hs-content-id-64092072775 hs-blog-post hs-blog-id-5272851739" style="">
<!--  Added by GoogleTagManager integration -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJVVB7C" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<!-- /Added by GoogleTagManager integration -->

    <div class="header-container-wrapper">
    <div class="header-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433790649568" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section id="cr-malicious-life-network__tier-one-header" class="position-flex">
  <div class="#">
    <div id="logo"><a href="https://www.cybereason.com"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-logo-inline--primary-black.png"></a></div>
    <div id="back-to">
      <a href="https://www.cybereason.com">Back to <span>Cybereason.com</span></a>
    </div>
    <!-- Hamburger Menu -->
    <button class="hamburger hamburger--collapse" type="button">
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="cr-mln__hamburger-menu--overlay">
      <ul>
        <li><a href="https://www.cybereason.com/blog/all"><span class="underline">All Posts</span></a></li>
        <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
        <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
        <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
        <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
        <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
        <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
      </ul>
      <div class="subscribe">
        <a href="#blog-subscribe">Subscribe</a>
      </div>
    </div>
    <!-- -->
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget mln-homepage" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433785464566" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section class="cr-malicious-life-network__hero-main base">
  <div class="container-is-blog columns hero-content page-center">
    <div class="column is-5-fullhd is-5-desktop is-12-touch">
      <a href="/blog"><img class="cr-mln-logo" src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-malicious-life-logo-v2.png"></a>
    </div>
    <div class="column is-7-fullhd is-7-desktop is-hidden-mobile is-hidden-tablet-only">
      <div class="cr-mln__search-subscribe">
        <div class="cr-mln__search">
          <a href="#cr-search-modal" class="search-btn"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/cr-blog-icon--search-dark-gray.png" alt="Search"></a>
        </div>
        <div class="cr-mln__subscribe">
          <a class="btn-subscribe" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>
      <div class="cr-mln__category-nav">
        <ul>
          <li><a href="/blog/category/all"><span class="underline">All</span></a></li>
          <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
          <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
          <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
          <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
          <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
          <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
        </ul>
      </div>
    </div>
  </div>
      <!-- MOBILE Search and Subscribe -->
      <div class="container-is-blog columns is-gapless is-hidden-desktop cr-mln__search-subscribe--mobile">
        <div class="column">
          <a class="search-btn">Search</a>
        </div>
        <div class="column">
          <a class="#" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>

      <!-- END MOBILE Search and Subscribe -->
  
  <!-- SEARCH Modal Wrap -->

  <div id="cr-search-modal">
        <!--THIS IS IMPORTANT! to close the modal, the class name has to match the name given on the ID -->
        <div id="btn-close-modal" class="close-cr-search-modal"> 
            X
        </div>

        <div class="modal-content">
            <div class="container columns">
              <div class="column">
                <div class="cr-search-modal__search-bar">
                  <h3>Search</h3>
                  <form action="/hs-search-results">
                    <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search...">
                    <input type="hidden" name="type" value="BLOG_POST">
                    <input type="hidden" name="type" value="LISTING_PAGE">
                    <button type="submit" class="arrow"></button>
                  </form>
                  
                </div>

              </div>
          </div>
        </div>
    </div>
  <!-- END Search Modal Wrap -->

</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end header -->
</div><!--end header wrapper -->

<div class="body-container-wrapper">
    <div class="body-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-blog_content " style="" data-widget-type="blog_content" data-x="0" data-w="12">







<div class="cr-mln__blog-post">
  <div class="container-is-blog columns is-multiline page-center">

    <div class="column is-8-fullhd is-8-desktop is-offset-2-fullhd is-offset-2-desktop is-10-tablet is-offset-1-tablet">
      <div class="featured-image"><img src="https://www.cybereason.com/hubfs/powerless.png" alt=""></div>
      <h1><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">PowerLess Trojan: Iranian APT Phosphorus Adds New PowerShell Backdoor for Espionage</span></h1>
      <div class="cr-mln__post-author-share">
      <div id="hubspot-author_data" class="hubspot-editable cr-mln__post-meta" data-hubspot-form-id="author_data" data-hubspot-name="Blog Author">
        
          <span class="descriptor">Written By</span>
          <p><span class="author">Cybereason Nocturnus</span></p>
         
      </div>
    </div>
     
    </div>
    
    <!-- Sticky Author and Social Box -->
    
    <!-- END Sticky Author and Social Box -->
      <div class="container-is-blog columns is-multiline page-center cr-mln__blog-post--body">
        
        <div class="column is-7-fullhd is-7-desktop is-10-tablet is-10-mobile is-offset-1-fullhd is-offset-1-desktop is-offset-1-tablet is-offset-1-mobile">
          <span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p>Over the past months, the <a href="/blog/authors/cybereason-nocturnus" rel="noopener" target="_blank"><span>Cybereason Nocturnus Team</span></a> observed an uptick in the activity of the Iranian attributed group dubbed Phosphorus (AKA Charming Kitten, APT35), known for previously attacking <a href="https://threatpost.com/charming-kitten-pounces-on-researchers/165129/" rel="noopener" target="_blank"><span>medical research organizations</span></a> in the US and Israel in late 2020, and for targeting <a href="https://www.clearskysec.com/wp-content/uploads/2019/09/The-Kittens-Are-Back-in-Town-Charming-Kitten-Sep-2019.pdf" rel="noopener" target="_blank"><span>academic researchers</span></a> from the US, France, and the Middle East region back in 2019.</p>
<!--more-->
<p>They have also <a href="https://www.clearskysec.com/wp-content/uploads/2019/10/The-Kittens-Are-Back-in-Town-2-1.pdf" rel="noopener" target="_blank"><span>previously targeted</span></a> human rights activists, the media sector, and interfered with the US presidential elections.</p>
<p>Towards the end of 2021, multiple attacks were carried out exploiting the notorious Microsoft Exchange Server vulnerabilities chained together and referred to as <a href="/blog/threat-alert-microsoft-exchange-proxyshell-exploits-and-lockfile-ransomware" rel="noopener" target="_blank"><span>ProxyShell</span></a>, which ultimately enabled multiple threat actors to deploy malware on their targets’ networks. There have been <a href="https://www.microsoft.com/security/blog/2021/11/16/evolving-trends-in-iranian-threat-actor-activity-mstic-presentation-at-cyberwarcon-2021/" rel="noopener" target="_blank"><span>several</span></a> <a href="https://thedfirreport.com/2021/11/15/exchange-exploit-leads-to-domain-wide-ransomware/" rel="noopener" target="_blank"><span>reports</span></a> detailing the exploitation of these vulnerabilities by Iranian state sponsored threat actors, among them the Phosphorus APT group carrying out ransomware attacks.&nbsp;</p>
<p>Cybereason researchers recently discovered a new set of tools which were developed by the Phosphorus group and incorporated into their arsenal, including a novel PowerShell backdoor dubbed <em>PowerLess Backdoor</em>. Our research also highlights a stealthy technique used by the group to avoid PowerShell detection by running the PowerShell Backdoor in a .NET context rather than spawning the PowerShell process.</p>
<p>In addition, several interesting connections were found between the Phosphorus group and the <a href="https://news.sophos.com/en-us/2021/11/18/new-ransomware-actor-uses-password-protected-archives-to-bypass-encryption-protection/" rel="noopener" target="_blank"><span>Memento Ransomware</span></a> that first emerged in late 2021. (Related Iranian APT research: <a href="/blog/strifewater-rat-iranian-apt-moses-staff-adds-new-trojan-to-ransomware-operations" style="font-style: italic;" rel="noopener" target="_blank">StrifeWater RAT: Iranian APT Moses Staff Adds New Trojan to Ransomware Operations</a>).</p>
<h2 style="font-size: 30px;">Key Findings</h2>
<ul>
<li aria-level="1"><strong>Novel PowerShell Backdoor:</strong> A novel and previously undocumented PowerShell backdoor related to the Phosphorus group was discovered by the Cybereason Nocturnus Team and dubbed <em>PowerLess Backdoor</em>. It supports downloading additional payloads, such as a keylogger and an info stealer.</li>
</ul>
<ul>
<li aria-level="1"><strong>Evasive PowerShell Execution:</strong> The PowerShell code runs in the context of a .NET application, thus not launching “powershell.exe” which enables it to evade security products.</li>
</ul>
<ul>
<li aria-level="1"><strong>Modular Malware:</strong> The toolset analyzed includes extremely modular, multi-staged malware that decrypts and deploys additional payloads in several stages for the sake of both stealth and efficacy.</li>
</ul>
<ul>
<li aria-level="1"><strong>Highly Active Infrastructure:</strong> At the time of writing this report, some of the IOCs remained active delivering new payloads.</li>
</ul>
<ul>
<li aria-level="1"><strong>Wide Range of Open Source Tools:</strong> A lot of the activity observed involved a variety of publicly available tools, such as cryptography libraries, weaponizing them for payloads and communication encryption.</li>
</ul>
<ul>
<li aria-level="1"><strong>Shared IOCs with Memento Ransomware:</strong> One of the IP addresses serves a domain which is being used as command and control (C2) for the recently discovered <a href="https://www.sophos.com/en-us/press-office/press-releases/2021/11/sophos-discovers-new-memento-ransomware.aspx" rel="noopener" target="_blank"><span>Memento Ransomware</span></a>.&nbsp;</li>
</ul>
<ul>
<li aria-level="1"><strong>Phosphorus Threat Group:</strong> The Phosphorus Threat Group was previously spotted attacking research facilities in multiple regions such as the US, Europe and the Middle East. The group is known to be behind multiple cyber espionage and offensive cyber attacks, operating in the interest of the Iranian regime, leveraging cyberwarfare in accordance with Iran’s geopolitical interests.&nbsp;</li>
<li aria-level="1"><strong>Use of Publicly Available Exploits:</strong> The Phosphorus Group was first seen exploiting the ProxyShell vulnerability, and later on the <a href="/blog/cybereason-releases-vaccine-to-prevent-exploitation-of-apache-log4shell-vulnerability-cve-2021-44228" rel="noopener" target="_blank"><span>Log4j vulnerability</span></a> as well, utilizing fresh exploits in the wild.</li>
</ul>
<h2 style="font-size: 30px;">A Glimpse into Phosphorus Updated Arsenal</h2>
<p>Following up on both public and non-public intelligence that is available to Cybereason in regard to the Phosphorus threat actor, the Cybereason Nocturnus Team was able to identify a new toolset that includes a novel backdoor, malware loaders, a browser info stealer, and a keylogger.</p>
<p>It is worth noting that some of the more recent methods that were observed in attacks attributed to the Phosphorus group included open-source tools such as the famous <a href="https://github.com/DavidXanatos/DiskCryptor" rel="noopener" target="_blank"><span>DiskCryptor</span></a> library and also BitLocker, along with the <a href="https://github.com/fatedier/frp" rel="noopener" target="_blank"><span>Fast Reverse Proxy</span></a> which is used for RDP proxying.</p>
<p>The following sections will detail the discovery process and analysis of the newly identified tools.&nbsp;</p>
<h3 style="font-size: 24px;"><span style="color: #434343;">Pivoting from a Previously Known Arsenal</span></h3>
<p>The journey to the discovery of the new toolset started with threat intelligence efforts that included pivoting on an IP address (162.55.136[.]20) that was already attributed to Iranian threat actors by multiple sources, including <a href="https://www.cisa.gov/uscert/ncas/alerts/aa21-321a" rel="noopener" target="_blank"><span>US CERT</span></a>.&nbsp;</p>
<p>While examining different files that were downloaded from this IP address, we stumbled upon a file named “<a href="https://www.virustotal.com/gui/file/a4c908859d78973a94581ea010b10b9a83d25cbafe0c0704dc67ff43c05f0040" rel="noopener" target="_blank"><span>WindowsProcesses.exe</span></a>”:&nbsp;</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image1-Jan-18-2022-06-39-52-05-PM.png?width=702&amp;name=image1-Jan-18-2022-06-39-52-05-PM.png" alt="image1-Jan-18-2022-06-39-52-05-PM" width="702" loading="lazy" style="width: 702px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image1-Jan-18-2022-06-39-52-05-PM.png?width=351&amp;name=image1-Jan-18-2022-06-39-52-05-PM.png 351w, https://www.cybereason.com/hs-fs/hubfs/image1-Jan-18-2022-06-39-52-05-PM.png?width=702&amp;name=image1-Jan-18-2022-06-39-52-05-PM.png 702w, https://www.cybereason.com/hs-fs/hubfs/image1-Jan-18-2022-06-39-52-05-PM.png?width=1053&amp;name=image1-Jan-18-2022-06-39-52-05-PM.png 1053w, https://www.cybereason.com/hs-fs/hubfs/image1-Jan-18-2022-06-39-52-05-PM.png?width=1404&amp;name=image1-Jan-18-2022-06-39-52-05-PM.png 1404w, https://www.cybereason.com/hs-fs/hubfs/image1-Jan-18-2022-06-39-52-05-PM.png?width=1755&amp;name=image1-Jan-18-2022-06-39-52-05-PM.png 1755w, https://www.cybereason.com/hs-fs/hubfs/image1-Jan-18-2022-06-39-52-05-PM.png?width=2106&amp;name=image1-Jan-18-2022-06-39-52-05-PM.png 2106w" sizes="(max-width: 702px) 100vw, 702px"><span style="font-size: 16px;"><em><span style="color: #666666;">WindowsProcesses.exe hosted on the abovementioned IP</span></em></span></p>
<p>The file seems to have only been detected by 35/68 antivirus vendors, according to VirusTotal:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image9-Jan-18-2022-06-40-52-18-PM.png?width=873&amp;name=image9-Jan-18-2022-06-40-52-18-PM.png" alt="image9-Jan-18-2022-06-40-52-18-PM" width="873" loading="lazy" style="width: 873px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image9-Jan-18-2022-06-40-52-18-PM.png?width=437&amp;name=image9-Jan-18-2022-06-40-52-18-PM.png 437w, https://www.cybereason.com/hs-fs/hubfs/image9-Jan-18-2022-06-40-52-18-PM.png?width=873&amp;name=image9-Jan-18-2022-06-40-52-18-PM.png 873w, https://www.cybereason.com/hs-fs/hubfs/image9-Jan-18-2022-06-40-52-18-PM.png?width=1310&amp;name=image9-Jan-18-2022-06-40-52-18-PM.png 1310w, https://www.cybereason.com/hs-fs/hubfs/image9-Jan-18-2022-06-40-52-18-PM.png?width=1746&amp;name=image9-Jan-18-2022-06-40-52-18-PM.png 1746w, https://www.cybereason.com/hs-fs/hubfs/image9-Jan-18-2022-06-40-52-18-PM.png?width=2183&amp;name=image9-Jan-18-2022-06-40-52-18-PM.png 2183w, https://www.cybereason.com/hs-fs/hubfs/image9-Jan-18-2022-06-40-52-18-PM.png?width=2619&amp;name=image9-Jan-18-2022-06-40-52-18-PM.png 2619w" sizes="(max-width: 873px) 100vw, 873px"><span style="font-size: 16px;"><em><span style="color: #666666;">WindowsProcesses.exe details as seen in VirusTotal</span></em></span></p>
<h4 style="font-size: 20px;"><span style="color: #666666;">Analysis of WindowsProcesses.exe</span></h4>
<p>This file, entitled “WindowsProcesses.exe” is a 64-bit executable loader whose sole purpose is to resolve relevant DLLs and load another file from the “%windir%\Temp” path entitled “dll.dll”:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image2-Jan-18-2022-06-41-31-59-PM.png?width=866&amp;name=image2-Jan-18-2022-06-41-31-59-PM.png" alt="image2-Jan-18-2022-06-41-31-59-PM" width="866" loading="lazy" style="width: 866px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image2-Jan-18-2022-06-41-31-59-PM.png?width=433&amp;name=image2-Jan-18-2022-06-41-31-59-PM.png 433w, https://www.cybereason.com/hs-fs/hubfs/image2-Jan-18-2022-06-41-31-59-PM.png?width=866&amp;name=image2-Jan-18-2022-06-41-31-59-PM.png 866w, https://www.cybereason.com/hs-fs/hubfs/image2-Jan-18-2022-06-41-31-59-PM.png?width=1299&amp;name=image2-Jan-18-2022-06-41-31-59-PM.png 1299w, https://www.cybereason.com/hs-fs/hubfs/image2-Jan-18-2022-06-41-31-59-PM.png?width=1732&amp;name=image2-Jan-18-2022-06-41-31-59-PM.png 1732w, https://www.cybereason.com/hs-fs/hubfs/image2-Jan-18-2022-06-41-31-59-PM.png?width=2165&amp;name=image2-Jan-18-2022-06-41-31-59-PM.png 2165w, https://www.cybereason.com/hs-fs/hubfs/image2-Jan-18-2022-06-41-31-59-PM.png?width=2598&amp;name=image2-Jan-18-2022-06-41-31-59-PM.png 2598w" sizes="(max-width: 866px) 100vw, 866px"><span style="font-size: 16px;"><em><span style="color: #666666;">WindowsProcesses and related modules execution diagram</span></em></span></p>
<p>Once the relevant DLLs (mostly related to .NET runtime libraries) and API calls are resolved, dll.dll is executed:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image29-3.png?width=775&amp;name=image29-3.png" alt="image29-3" width="775" loading="lazy" style="width: 775px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image29-3.png?width=388&amp;name=image29-3.png 388w, https://www.cybereason.com/hs-fs/hubfs/image29-3.png?width=775&amp;name=image29-3.png 775w, https://www.cybereason.com/hs-fs/hubfs/image29-3.png?width=1163&amp;name=image29-3.png 1163w, https://www.cybereason.com/hs-fs/hubfs/image29-3.png?width=1550&amp;name=image29-3.png 1550w, https://www.cybereason.com/hs-fs/hubfs/image29-3.png?width=1938&amp;name=image29-3.png 1938w, https://www.cybereason.com/hs-fs/hubfs/image29-3.png?width=2325&amp;name=image29-3.png 2325w" sizes="(max-width: 775px) 100vw, 775px"><span style="font-size: 16px;"><em><span style="color: #666666;">The main code of WindowsProcesses.exe</span></em></span></p>
<p>By the looks of it, the authors could have been inspired by a code snippet found publicly available <a href="https://gist.github.com/farzinenddo/bb1f1ecb56aa9326abc7b47fc99e588e" rel="noopener" target="_blank"><span>on GitHub,</span></a> which facilitates running PowerShell with CLR in native runtime. The snippet is named “Powerless”, and the authors seem to have kept that naming convention, as shown in the PDB path of the binary:&nbsp;</p>
<p><em>C:\\Users\\pugna\\Desktop\\126\\V1\\</em><strong><em>PowerLessCLR</em></strong><em>\\x64\\Release\\</em><strong><em>PowerLessCLR</em></strong><em>.pdb</em></p>
<h5 style="font-size: 18px; font-weight: bold;"><span style="color: #666666;">Analysis of dll.dll</span></h5>
<p>Dll.dll is a simple .NET AES decryptor that uses a hardcoded key “()*&amp;3dCfabE2/123” to decode another file named “upc” to ultimately execute PowerShell code from the decrypted object:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/image23-Jan-18-2022-06-45-44-09-PM.png?width=804&amp;name=image23-Jan-18-2022-06-45-44-09-PM.png" alt="image23-Jan-18-2022-06-45-44-09-PM" width="804" loading="lazy" style="width: 804px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image23-Jan-18-2022-06-45-44-09-PM.png?width=402&amp;name=image23-Jan-18-2022-06-45-44-09-PM.png 402w, https://www.cybereason.com/hs-fs/hubfs/image23-Jan-18-2022-06-45-44-09-PM.png?width=804&amp;name=image23-Jan-18-2022-06-45-44-09-PM.png 804w, https://www.cybereason.com/hs-fs/hubfs/image23-Jan-18-2022-06-45-44-09-PM.png?width=1206&amp;name=image23-Jan-18-2022-06-45-44-09-PM.png 1206w, https://www.cybereason.com/hs-fs/hubfs/image23-Jan-18-2022-06-45-44-09-PM.png?width=1608&amp;name=image23-Jan-18-2022-06-45-44-09-PM.png 1608w, https://www.cybereason.com/hs-fs/hubfs/image23-Jan-18-2022-06-45-44-09-PM.png?width=2010&amp;name=image23-Jan-18-2022-06-45-44-09-PM.png 2010w, https://www.cybereason.com/hs-fs/hubfs/image23-Jan-18-2022-06-45-44-09-PM.png?width=2412&amp;name=image23-Jan-18-2022-06-45-44-09-PM.png 2412w" sizes="(max-width: 804px) 100vw, 804px"></p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image26-4.png?width=811&amp;name=image26-4.png" alt="image26-4" width="811" loading="lazy" style="width: 811px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image26-4.png?width=406&amp;name=image26-4.png 406w, https://www.cybereason.com/hs-fs/hubfs/image26-4.png?width=811&amp;name=image26-4.png 811w, https://www.cybereason.com/hs-fs/hubfs/image26-4.png?width=1217&amp;name=image26-4.png 1217w, https://www.cybereason.com/hs-fs/hubfs/image26-4.png?width=1622&amp;name=image26-4.png 1622w, https://www.cybereason.com/hs-fs/hubfs/image26-4.png?width=2028&amp;name=image26-4.png 2028w, https://www.cybereason.com/hs-fs/hubfs/image26-4.png?width=2433&amp;name=image26-4.png 2433w" sizes="(max-width: 811px) 100vw, 811px"><span style="font-size: 16px;"><em><span style="color: #666666;">The code of dll.dll</span></em></span></p>
<h5 style="font-size: 18px; font-weight: bold;"><span style="color: #666666;">upc</span></h5>
<p>The upc encrypted BLOB is decrypted using dll.dll, and contains multiple encryption layers that all are decrypted in stages using base64 and AES ECB decryption.</p>
<p>The keys that are being used for decryption are as follows:</p>
<ul>
<li aria-level="1">()*&amp;3dCfabE2/123</li>
<li aria-level="1">0123654789mkiujn</li>
<li aria-level="1">25sL(*14@#SDFcgd</li>
</ul>
<p>Prior to decrypting the PowerShell backdoor, an intermediate stage takes place when the victim’s machine is assigned a unique identifier which is sent to the C2, which downloads an additional configuration:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image12-Jan-18-2022-06-48-28-42-PM.png?width=800&amp;name=image12-Jan-18-2022-06-48-28-42-PM.png" alt="image12-Jan-18-2022-06-48-28-42-PM" width="800" loading="lazy" style="width: 800px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image12-Jan-18-2022-06-48-28-42-PM.png?width=400&amp;name=image12-Jan-18-2022-06-48-28-42-PM.png 400w, https://www.cybereason.com/hs-fs/hubfs/image12-Jan-18-2022-06-48-28-42-PM.png?width=800&amp;name=image12-Jan-18-2022-06-48-28-42-PM.png 800w, https://www.cybereason.com/hs-fs/hubfs/image12-Jan-18-2022-06-48-28-42-PM.png?width=1200&amp;name=image12-Jan-18-2022-06-48-28-42-PM.png 1200w, https://www.cybereason.com/hs-fs/hubfs/image12-Jan-18-2022-06-48-28-42-PM.png?width=1600&amp;name=image12-Jan-18-2022-06-48-28-42-PM.png 1600w, https://www.cybereason.com/hs-fs/hubfs/image12-Jan-18-2022-06-48-28-42-PM.png?width=2000&amp;name=image12-Jan-18-2022-06-48-28-42-PM.png 2000w, https://www.cybereason.com/hs-fs/hubfs/image12-Jan-18-2022-06-48-28-42-PM.png?width=2400&amp;name=image12-Jan-18-2022-06-48-28-42-PM.png 2400w" sizes="(max-width: 800px) 100vw, 800px"><span style="font-size: 16px;"><em><span style="color: #666666;">The intermediate stage during the PowerLess backdoor decryption</span></em></span></p>
<h5 style="font-weight: bold; font-size: 18px;"><span style="color: #666666;">Analysis of the PowerLess Backdoor</span></h5>
<p>After all the AES encrypted layers are decrypted, the PowerLess backdoor is executed:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image10-Jan-18-2022-06-49-16-90-PM.png?width=886&amp;name=image10-Jan-18-2022-06-49-16-90-PM.png" alt="image10-Jan-18-2022-06-49-16-90-PM" width="886" loading="lazy" style="width: 886px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image10-Jan-18-2022-06-49-16-90-PM.png?width=443&amp;name=image10-Jan-18-2022-06-49-16-90-PM.png 443w, https://www.cybereason.com/hs-fs/hubfs/image10-Jan-18-2022-06-49-16-90-PM.png?width=886&amp;name=image10-Jan-18-2022-06-49-16-90-PM.png 886w, https://www.cybereason.com/hs-fs/hubfs/image10-Jan-18-2022-06-49-16-90-PM.png?width=1329&amp;name=image10-Jan-18-2022-06-49-16-90-PM.png 1329w, https://www.cybereason.com/hs-fs/hubfs/image10-Jan-18-2022-06-49-16-90-PM.png?width=1772&amp;name=image10-Jan-18-2022-06-49-16-90-PM.png 1772w, https://www.cybereason.com/hs-fs/hubfs/image10-Jan-18-2022-06-49-16-90-PM.png?width=2215&amp;name=image10-Jan-18-2022-06-49-16-90-PM.png 2215w, https://www.cybereason.com/hs-fs/hubfs/image10-Jan-18-2022-06-49-16-90-PM.png?width=2658&amp;name=image10-Jan-18-2022-06-49-16-90-PM.png 2658w" sizes="(max-width: 886px) 100vw, 886px"><span style="font-size: 16px;"><em><span style="color: #666666;">PowerLess backdoor command parsing code segment</span></em></span></p>
<p>The PowerLess backdoor is equipped with the following capabilities:</p>
<ul>
<li aria-level="1">Downloading and executing additional malware and files</li>
<ul>
<li aria-level="2">Additional modules:</li>
<ul>
<li aria-level="3"><a href="https://www.virustotal.com/gui/file/ac9ed12685f0094de0897ff72b6c457ff4fb8f8750cf1fedccd59c8976eb4f24" rel="noopener" target="_blank"><span>Browsers info stealer</span></a></li>
<li aria-level="3"><a href="https://www.virustotal.com/gui/file/3f9fb115afd2da19d3a231791dbe3c6f615c9908b7d12376ef8b097ebdfec6e9" rel="noopener" target="_blank">Keylogger module</a></li>
</ul>
</ul>
<li aria-level="1">Encrypted channel with the C2</li>
<li aria-level="1">Executing arbitrary commands</li>
<li aria-level="1">Killing processes</li>
<li aria-level="1">Stealing browser data</li>
<li aria-level="1">Keylogging</li>
</ul>
<p>It is worth mentioning that the backdoor is being run within a .NET context, so therefore it does not spawn “powershell.exe”. This behavior can be interpreted as an attempt to evade certain PowerShell detections, although PowerShell logs are being saved on the machine:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image14-Jan-18-2022-06-50-10-09-PM.png?width=817&amp;name=image14-Jan-18-2022-06-50-10-09-PM.png" alt="image14-Jan-18-2022-06-50-10-09-PM" width="817" loading="lazy" style="width: 817px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image14-Jan-18-2022-06-50-10-09-PM.png?width=409&amp;name=image14-Jan-18-2022-06-50-10-09-PM.png 409w, https://www.cybereason.com/hs-fs/hubfs/image14-Jan-18-2022-06-50-10-09-PM.png?width=817&amp;name=image14-Jan-18-2022-06-50-10-09-PM.png 817w, https://www.cybereason.com/hs-fs/hubfs/image14-Jan-18-2022-06-50-10-09-PM.png?width=1226&amp;name=image14-Jan-18-2022-06-50-10-09-PM.png 1226w, https://www.cybereason.com/hs-fs/hubfs/image14-Jan-18-2022-06-50-10-09-PM.png?width=1634&amp;name=image14-Jan-18-2022-06-50-10-09-PM.png 1634w, https://www.cybereason.com/hs-fs/hubfs/image14-Jan-18-2022-06-50-10-09-PM.png?width=2043&amp;name=image14-Jan-18-2022-06-50-10-09-PM.png 2043w, https://www.cybereason.com/hs-fs/hubfs/image14-Jan-18-2022-06-50-10-09-PM.png?width=2451&amp;name=image14-Jan-18-2022-06-50-10-09-PM.png 2451w" sizes="(max-width: 817px) 100vw, 817px"></p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image28-Jan-18-2022-06-51-20-81-PM.png?width=811&amp;name=image28-Jan-18-2022-06-51-20-81-PM.png" alt="image28-Jan-18-2022-06-51-20-81-PM" width="811" loading="lazy" style="width: 811px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image28-Jan-18-2022-06-51-20-81-PM.png?width=406&amp;name=image28-Jan-18-2022-06-51-20-81-PM.png 406w, https://www.cybereason.com/hs-fs/hubfs/image28-Jan-18-2022-06-51-20-81-PM.png?width=811&amp;name=image28-Jan-18-2022-06-51-20-81-PM.png 811w, https://www.cybereason.com/hs-fs/hubfs/image28-Jan-18-2022-06-51-20-81-PM.png?width=1217&amp;name=image28-Jan-18-2022-06-51-20-81-PM.png 1217w, https://www.cybereason.com/hs-fs/hubfs/image28-Jan-18-2022-06-51-20-81-PM.png?width=1622&amp;name=image28-Jan-18-2022-06-51-20-81-PM.png 1622w, https://www.cybereason.com/hs-fs/hubfs/image28-Jan-18-2022-06-51-20-81-PM.png?width=2028&amp;name=image28-Jan-18-2022-06-51-20-81-PM.png 2028w, https://www.cybereason.com/hs-fs/hubfs/image28-Jan-18-2022-06-51-20-81-PM.png?width=2433&amp;name=image28-Jan-18-2022-06-51-20-81-PM.png 2433w" sizes="(max-width: 811px) 100vw, 811px"><span style="font-size: 16px;"><em><span style="color: #666666;">Windows Processes and the malicious loaded module “dll.dll” as seen in the Cybereason XDR Platform</span></em></span></p>
<p>Oddly enough, there is a part of the code in the PowerLess Backdoor, that do spawn a powershell.exe process, when the request to kill a process is received from the C2:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image16-Jan-18-2022-06-52-29-45-PM.png?width=812&amp;name=image16-Jan-18-2022-06-52-29-45-PM.png" alt="image16-Jan-18-2022-06-52-29-45-PM" width="812" loading="lazy" style="width: 812px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image16-Jan-18-2022-06-52-29-45-PM.png?width=406&amp;name=image16-Jan-18-2022-06-52-29-45-PM.png 406w, https://www.cybereason.com/hs-fs/hubfs/image16-Jan-18-2022-06-52-29-45-PM.png?width=812&amp;name=image16-Jan-18-2022-06-52-29-45-PM.png 812w, https://www.cybereason.com/hs-fs/hubfs/image16-Jan-18-2022-06-52-29-45-PM.png?width=1218&amp;name=image16-Jan-18-2022-06-52-29-45-PM.png 1218w, https://www.cybereason.com/hs-fs/hubfs/image16-Jan-18-2022-06-52-29-45-PM.png?width=1624&amp;name=image16-Jan-18-2022-06-52-29-45-PM.png 1624w, https://www.cybereason.com/hs-fs/hubfs/image16-Jan-18-2022-06-52-29-45-PM.png?width=2030&amp;name=image16-Jan-18-2022-06-52-29-45-PM.png 2030w, https://www.cybereason.com/hs-fs/hubfs/image16-Jan-18-2022-06-52-29-45-PM.png?width=2436&amp;name=image16-Jan-18-2022-06-52-29-45-PM.png 2436w" sizes="(max-width: 812px) 100vw, 812px"><span style="font-size: 16px;"><em><span style="color: #666666;">A part of the PowerLess Backdoor that spawns powershell.exe</span></em></span></p>
<p>It can be assumed that the native language of the backdoor’s authors is likely not English given the abundance of typos and grammatical mistakes found in the code:&nbsp;</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image22-Jan-18-2022-06-52-57-35-PM.png?width=821&amp;name=image22-Jan-18-2022-06-52-57-35-PM.png" alt="image22-Jan-18-2022-06-52-57-35-PM" width="821" loading="lazy" style="width: 821px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image22-Jan-18-2022-06-52-57-35-PM.png?width=411&amp;name=image22-Jan-18-2022-06-52-57-35-PM.png 411w, https://www.cybereason.com/hs-fs/hubfs/image22-Jan-18-2022-06-52-57-35-PM.png?width=821&amp;name=image22-Jan-18-2022-06-52-57-35-PM.png 821w, https://www.cybereason.com/hs-fs/hubfs/image22-Jan-18-2022-06-52-57-35-PM.png?width=1232&amp;name=image22-Jan-18-2022-06-52-57-35-PM.png 1232w, https://www.cybereason.com/hs-fs/hubfs/image22-Jan-18-2022-06-52-57-35-PM.png?width=1642&amp;name=image22-Jan-18-2022-06-52-57-35-PM.png 1642w, https://www.cybereason.com/hs-fs/hubfs/image22-Jan-18-2022-06-52-57-35-PM.png?width=2053&amp;name=image22-Jan-18-2022-06-52-57-35-PM.png 2053w, https://www.cybereason.com/hs-fs/hubfs/image22-Jan-18-2022-06-52-57-35-PM.png?width=2463&amp;name=image22-Jan-18-2022-06-52-57-35-PM.png 2463w" sizes="(max-width: 821px) 100vw, 821px"><span style="font-size: 16px;"><em><span style="color: #666666;">PowerLess backdoor logging</span></em></span></p>
<h6 style="font-size: 18px; font-weight: bold;"><em><span style="color: #666666;">Keylogger</span></em></h6>
<p>One of the modules downloaded by the PowerLess backdoor is a keylogger that is written in .NET. It’s core functionality is quite simple, consisting of hooks and the logging of the user’s keystrokes:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image4-Jan-18-2022-06-54-11-35-PM.png?width=799&amp;name=image4-Jan-18-2022-06-54-11-35-PM.png" alt="image4-Jan-18-2022-06-54-11-35-PM" width="799" loading="lazy" style="width: 799px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image4-Jan-18-2022-06-54-11-35-PM.png?width=400&amp;name=image4-Jan-18-2022-06-54-11-35-PM.png 400w, https://www.cybereason.com/hs-fs/hubfs/image4-Jan-18-2022-06-54-11-35-PM.png?width=799&amp;name=image4-Jan-18-2022-06-54-11-35-PM.png 799w, https://www.cybereason.com/hs-fs/hubfs/image4-Jan-18-2022-06-54-11-35-PM.png?width=1199&amp;name=image4-Jan-18-2022-06-54-11-35-PM.png 1199w, https://www.cybereason.com/hs-fs/hubfs/image4-Jan-18-2022-06-54-11-35-PM.png?width=1598&amp;name=image4-Jan-18-2022-06-54-11-35-PM.png 1598w, https://www.cybereason.com/hs-fs/hubfs/image4-Jan-18-2022-06-54-11-35-PM.png?width=1998&amp;name=image4-Jan-18-2022-06-54-11-35-PM.png 1998w, https://www.cybereason.com/hs-fs/hubfs/image4-Jan-18-2022-06-54-11-35-PM.png?width=2397&amp;name=image4-Jan-18-2022-06-54-11-35-PM.png 2397w" sizes="(max-width: 799px) 100vw, 799px"><span style="font-size: 16px;"><em><span style="color: #666666;">Partial code</span><span style="color: #666666;"> from the keylogger module</span></em></span></p>
<p>The logs are being stored in the following path: "C:\\Windows\\Temp\\Report.06E17A5A-7325-4325-8E5D-E172EBA7FC5BK":</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image17-Jan-18-2022-06-55-04-03-PM.png?width=792&amp;name=image17-Jan-18-2022-06-55-04-03-PM.png" alt="image17-Jan-18-2022-06-55-04-03-PM" width="792" loading="lazy" style="width: 792px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image17-Jan-18-2022-06-55-04-03-PM.png?width=396&amp;name=image17-Jan-18-2022-06-55-04-03-PM.png 396w, https://www.cybereason.com/hs-fs/hubfs/image17-Jan-18-2022-06-55-04-03-PM.png?width=792&amp;name=image17-Jan-18-2022-06-55-04-03-PM.png 792w, https://www.cybereason.com/hs-fs/hubfs/image17-Jan-18-2022-06-55-04-03-PM.png?width=1188&amp;name=image17-Jan-18-2022-06-55-04-03-PM.png 1188w, https://www.cybereason.com/hs-fs/hubfs/image17-Jan-18-2022-06-55-04-03-PM.png?width=1584&amp;name=image17-Jan-18-2022-06-55-04-03-PM.png 1584w, https://www.cybereason.com/hs-fs/hubfs/image17-Jan-18-2022-06-55-04-03-PM.png?width=1980&amp;name=image17-Jan-18-2022-06-55-04-03-PM.png 1980w, https://www.cybereason.com/hs-fs/hubfs/image17-Jan-18-2022-06-55-04-03-PM.png?width=2376&amp;name=image17-Jan-18-2022-06-55-04-03-PM.png 2376w" sizes="(max-width: 792px) 100vw, 792px"><span style="font-size: 16px;"><em>Logs path of the keylogger module</em></span></p>
<h6 style="font-size: 18px; font-weight: bold;"><em><span style="color: #666666;">Stealer</span></em></h6>
<p>Another module is a browser info stealer, which is also written in .NET, and includes the <a href="https://www.bouncycastle.org/" rel="noopener" target="_blank"><span>BouncyCastle</span></a> crypto library. It also uses an SQLite data reader object for Chrome and Edge browser database files. In the staging phase, the data is encrypted and written in JSON format for exfiltration:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image15-Jan-18-2022-06-56-15-93-PM.png?width=1139&amp;name=image15-Jan-18-2022-06-56-15-93-PM.png" alt="image15-Jan-18-2022-06-56-15-93-PM" width="1139" loading="lazy" style="width: 1139px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image15-Jan-18-2022-06-56-15-93-PM.png?width=570&amp;name=image15-Jan-18-2022-06-56-15-93-PM.png 570w, https://www.cybereason.com/hs-fs/hubfs/image15-Jan-18-2022-06-56-15-93-PM.png?width=1139&amp;name=image15-Jan-18-2022-06-56-15-93-PM.png 1139w, https://www.cybereason.com/hs-fs/hubfs/image15-Jan-18-2022-06-56-15-93-PM.png?width=1709&amp;name=image15-Jan-18-2022-06-56-15-93-PM.png 1709w, https://www.cybereason.com/hs-fs/hubfs/image15-Jan-18-2022-06-56-15-93-PM.png?width=2278&amp;name=image15-Jan-18-2022-06-56-15-93-PM.png 2278w, https://www.cybereason.com/hs-fs/hubfs/image15-Jan-18-2022-06-56-15-93-PM.png?width=2848&amp;name=image15-Jan-18-2022-06-56-15-93-PM.png 2848w, https://www.cybereason.com/hs-fs/hubfs/image15-Jan-18-2022-06-56-15-93-PM.png?width=3417&amp;name=image15-Jan-18-2022-06-56-15-93-PM.png 3417w" sizes="(max-width: 1139px) 100vw, 1139px"><span style="font-size: 16px;"><em><span style="color: #666666;">Partial</span><span style="color: #666666;"> code from the info stealer module</span></em></span></p>
<p>The logs are being stored in the following path: “C:\\Windows\\Temp\\cup.tmp”:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image18-Jan-18-2022-06-57-18-37-PM.png?width=786&amp;name=image18-Jan-18-2022-06-57-18-37-PM.png" alt="image18-Jan-18-2022-06-57-18-37-PM" width="786" loading="lazy" style="width: 786px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image18-Jan-18-2022-06-57-18-37-PM.png?width=393&amp;name=image18-Jan-18-2022-06-57-18-37-PM.png 393w, https://www.cybereason.com/hs-fs/hubfs/image18-Jan-18-2022-06-57-18-37-PM.png?width=786&amp;name=image18-Jan-18-2022-06-57-18-37-PM.png 786w, https://www.cybereason.com/hs-fs/hubfs/image18-Jan-18-2022-06-57-18-37-PM.png?width=1179&amp;name=image18-Jan-18-2022-06-57-18-37-PM.png 1179w, https://www.cybereason.com/hs-fs/hubfs/image18-Jan-18-2022-06-57-18-37-PM.png?width=1572&amp;name=image18-Jan-18-2022-06-57-18-37-PM.png 1572w, https://www.cybereason.com/hs-fs/hubfs/image18-Jan-18-2022-06-57-18-37-PM.png?width=1965&amp;name=image18-Jan-18-2022-06-57-18-37-PM.png 1965w, https://www.cybereason.com/hs-fs/hubfs/image18-Jan-18-2022-06-57-18-37-PM.png?width=2358&amp;name=image18-Jan-18-2022-06-57-18-37-PM.png 2358w" sizes="(max-width: 786px) 100vw, 786px"><span style="font-size: 16px;"><em>Logs path of the stealer module</em></span></p>
<h4 style="font-size: 20px;"><span style="color: #666666;">Additional Tools Potentially Related to Phosphorus</span></h4>
<p>In addition to the newly discovered PowerLess Backdoor, other tools were identified by the Nocturnus Team which are suspected to originate from the same developer. However, at this point in time there isn't enough evidence to conclusively tie these tools to Phosphorus with a high level of confidence.&nbsp;</p>
<p>Looking at the PE info of “WindowsProcesses.exe”, the below PDB path is present: “<em>C:\Users\pugna\Desktop\126\V1\PowerLessCLR\x64\Release\PowerLessCLR.pdb</em>”:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image20-Jan-18-2022-06-58-07-01-PM.png?width=788&amp;name=image20-Jan-18-2022-06-58-07-01-PM.png" alt="image20-Jan-18-2022-06-58-07-01-PM" width="788" loading="lazy" style="width: 788px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image20-Jan-18-2022-06-58-07-01-PM.png?width=394&amp;name=image20-Jan-18-2022-06-58-07-01-PM.png 394w, https://www.cybereason.com/hs-fs/hubfs/image20-Jan-18-2022-06-58-07-01-PM.png?width=788&amp;name=image20-Jan-18-2022-06-58-07-01-PM.png 788w, https://www.cybereason.com/hs-fs/hubfs/image20-Jan-18-2022-06-58-07-01-PM.png?width=1182&amp;name=image20-Jan-18-2022-06-58-07-01-PM.png 1182w, https://www.cybereason.com/hs-fs/hubfs/image20-Jan-18-2022-06-58-07-01-PM.png?width=1576&amp;name=image20-Jan-18-2022-06-58-07-01-PM.png 1576w, https://www.cybereason.com/hs-fs/hubfs/image20-Jan-18-2022-06-58-07-01-PM.png?width=1970&amp;name=image20-Jan-18-2022-06-58-07-01-PM.png 1970w, https://www.cybereason.com/hs-fs/hubfs/image20-Jan-18-2022-06-58-07-01-PM.png?width=2364&amp;name=image20-Jan-18-2022-06-58-07-01-PM.png 2364w" sizes="(max-width: 788px) 100vw, 788px"><span style="font-size: 16px;"><em><span style="color: #666666;">The PDB path from WindowsProcesses.exe</span></em></span></p>
<p>Searching for the prefix “C:\Users\pugna” returns other unidentified tools:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image21-Jan-18-2022-06-59-18-67-PM.png?width=1431&amp;name=image21-Jan-18-2022-06-59-18-67-PM.png" alt="image21-Jan-18-2022-06-59-18-67-PM" width="1431" loading="lazy" style="width: 1431px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image21-Jan-18-2022-06-59-18-67-PM.png?width=716&amp;name=image21-Jan-18-2022-06-59-18-67-PM.png 716w, https://www.cybereason.com/hs-fs/hubfs/image21-Jan-18-2022-06-59-18-67-PM.png?width=1431&amp;name=image21-Jan-18-2022-06-59-18-67-PM.png 1431w, https://www.cybereason.com/hs-fs/hubfs/image21-Jan-18-2022-06-59-18-67-PM.png?width=2147&amp;name=image21-Jan-18-2022-06-59-18-67-PM.png 2147w, https://www.cybereason.com/hs-fs/hubfs/image21-Jan-18-2022-06-59-18-67-PM.png?width=2862&amp;name=image21-Jan-18-2022-06-59-18-67-PM.png 2862w, https://www.cybereason.com/hs-fs/hubfs/image21-Jan-18-2022-06-59-18-67-PM.png?width=3578&amp;name=image21-Jan-18-2022-06-59-18-67-PM.png 3578w, https://www.cybereason.com/hs-fs/hubfs/image21-Jan-18-2022-06-59-18-67-PM.png?width=4293&amp;name=image21-Jan-18-2022-06-59-18-67-PM.png 4293w" sizes="(max-width: 1431px) 100vw, 1431px"><span style="font-size: 16px;"><em><span style="color: #666666;">Artifacts found in VirusTotal with the search “C:\Users\pugna”</span></em></span></p>
<h5 style="font-size: 18px; font-weight: bold;"><em><span style="color: #666666;">Chromium F</span></em></h5>
<p>“Chromium F.exe” is yet another .NET browser info stealer. Although the code is different, by the functionality it is similar to the abovementioned info stealer module, leading us to assess that it might be an earlier variant:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image19-Jan-18-2022-07-00-06-07-PM.png?width=1284&amp;name=image19-Jan-18-2022-07-00-06-07-PM.png" alt="image19-Jan-18-2022-07-00-06-07-PM" width="1284" loading="lazy" style="width: 1284px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image19-Jan-18-2022-07-00-06-07-PM.png?width=642&amp;name=image19-Jan-18-2022-07-00-06-07-PM.png 642w, https://www.cybereason.com/hs-fs/hubfs/image19-Jan-18-2022-07-00-06-07-PM.png?width=1284&amp;name=image19-Jan-18-2022-07-00-06-07-PM.png 1284w, https://www.cybereason.com/hs-fs/hubfs/image19-Jan-18-2022-07-00-06-07-PM.png?width=1926&amp;name=image19-Jan-18-2022-07-00-06-07-PM.png 1926w, https://www.cybereason.com/hs-fs/hubfs/image19-Jan-18-2022-07-00-06-07-PM.png?width=2568&amp;name=image19-Jan-18-2022-07-00-06-07-PM.png 2568w, https://www.cybereason.com/hs-fs/hubfs/image19-Jan-18-2022-07-00-06-07-PM.png?width=3210&amp;name=image19-Jan-18-2022-07-00-06-07-PM.png 3210w, https://www.cybereason.com/hs-fs/hubfs/image19-Jan-18-2022-07-00-06-07-PM.png?width=3852&amp;name=image19-Jan-18-2022-07-00-06-07-PM.png 3852w" sizes="(max-width: 1284px) 100vw, 1284px"><span style="font-size: 16px;"><em><span style="color: #666666;">Code segment from Chromium F.exe</span></em></span></p>
<h5 style="font-size: 18px; font-weight: bold;"><em><span style="color: #666666;">Sou.exe - Audio Recorder</span></em></h5>
<p>“Sou.exe” is another .NET file, but this time it’s an audio recorder which uses the <a href="https://github.com/naudio/NAudio"><span>NAudio</span></a> open source library:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image6-Jan-18-2022-07-03-07-31-PM.png?width=791&amp;name=image6-Jan-18-2022-07-03-07-31-PM.png" alt="image6-Jan-18-2022-07-03-07-31-PM" width="791" loading="lazy" style="width: 791px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image6-Jan-18-2022-07-03-07-31-PM.png?width=396&amp;name=image6-Jan-18-2022-07-03-07-31-PM.png 396w, https://www.cybereason.com/hs-fs/hubfs/image6-Jan-18-2022-07-03-07-31-PM.png?width=791&amp;name=image6-Jan-18-2022-07-03-07-31-PM.png 791w, https://www.cybereason.com/hs-fs/hubfs/image6-Jan-18-2022-07-03-07-31-PM.png?width=1187&amp;name=image6-Jan-18-2022-07-03-07-31-PM.png 1187w, https://www.cybereason.com/hs-fs/hubfs/image6-Jan-18-2022-07-03-07-31-PM.png?width=1582&amp;name=image6-Jan-18-2022-07-03-07-31-PM.png 1582w, https://www.cybereason.com/hs-fs/hubfs/image6-Jan-18-2022-07-03-07-31-PM.png?width=1978&amp;name=image6-Jan-18-2022-07-03-07-31-PM.png 1978w, https://www.cybereason.com/hs-fs/hubfs/image6-Jan-18-2022-07-03-07-31-PM.png?width=2373&amp;name=image6-Jan-18-2022-07-03-07-31-PM.png 2373w" sizes="(max-width: 791px) 100vw, 791px"><span style="font-size: 16px;"><em><span style="color: #666666;">Code segment from Sou.exe</span></em></span></p>
<h5 style="font-size: 18px; font-weight: bold;"><em><span style="color: #666666;">A New Locker in the Making?&nbsp;</span></em></h5>
<p>One of the more recent tools that was allegedly from the same developer is what appears to be an <a href="https://www.virustotal.com/gui/file/014e73d083df4a5816bd838d03a1b38e1438914154fe0bb7d988d05df0407b84" rel="noopener" target="_blank"><span>unfinished Ransomware</span></a> variant. It is also written in .NET and at this point doesn’t do anything except locking the target’s screen. As can be seen, the fields like the ransom amount and attacker’s email are yet to be set. Although unfinished, it is worth mentioning that the sample was uploaded from Iran via web, and it might imply yet another step in the direction of this threat actor towards ransomware:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image3-Jan-19-2022-08-20-16-82-PM.png?width=790&amp;name=image3-Jan-19-2022-08-20-16-82-PM.png" alt="image3-Jan-19-2022-08-20-16-82-PM" width="790" loading="lazy" style="width: 790px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image3-Jan-19-2022-08-20-16-82-PM.png?width=395&amp;name=image3-Jan-19-2022-08-20-16-82-PM.png 395w, https://www.cybereason.com/hs-fs/hubfs/image3-Jan-19-2022-08-20-16-82-PM.png?width=790&amp;name=image3-Jan-19-2022-08-20-16-82-PM.png 790w, https://www.cybereason.com/hs-fs/hubfs/image3-Jan-19-2022-08-20-16-82-PM.png?width=1185&amp;name=image3-Jan-19-2022-08-20-16-82-PM.png 1185w, https://www.cybereason.com/hs-fs/hubfs/image3-Jan-19-2022-08-20-16-82-PM.png?width=1580&amp;name=image3-Jan-19-2022-08-20-16-82-PM.png 1580w, https://www.cybereason.com/hs-fs/hubfs/image3-Jan-19-2022-08-20-16-82-PM.png?width=1975&amp;name=image3-Jan-19-2022-08-20-16-82-PM.png 1975w, https://www.cybereason.com/hs-fs/hubfs/image3-Jan-19-2022-08-20-16-82-PM.png?width=2370&amp;name=image3-Jan-19-2022-08-20-16-82-PM.png 2370w" sizes="(max-width: 790px) 100vw, 790px"><span style="font-size: 16px;"><em><span style="color: #666666;">Unfinished ransomware sample uploaded to VirusTotal from Iran</span></em></span></p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image24-Jan-18-2022-07-04-56-80-PM.png?width=792&amp;name=image24-Jan-18-2022-07-04-56-80-PM.png" alt="image24-Jan-18-2022-07-04-56-80-PM" width="792" loading="lazy" style="width: 792px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image24-Jan-18-2022-07-04-56-80-PM.png?width=396&amp;name=image24-Jan-18-2022-07-04-56-80-PM.png 396w, https://www.cybereason.com/hs-fs/hubfs/image24-Jan-18-2022-07-04-56-80-PM.png?width=792&amp;name=image24-Jan-18-2022-07-04-56-80-PM.png 792w, https://www.cybereason.com/hs-fs/hubfs/image24-Jan-18-2022-07-04-56-80-PM.png?width=1188&amp;name=image24-Jan-18-2022-07-04-56-80-PM.png 1188w, https://www.cybereason.com/hs-fs/hubfs/image24-Jan-18-2022-07-04-56-80-PM.png?width=1584&amp;name=image24-Jan-18-2022-07-04-56-80-PM.png 1584w, https://www.cybereason.com/hs-fs/hubfs/image24-Jan-18-2022-07-04-56-80-PM.png?width=1980&amp;name=image24-Jan-18-2022-07-04-56-80-PM.png 1980w, https://www.cybereason.com/hs-fs/hubfs/image24-Jan-18-2022-07-04-56-80-PM.png?width=2376&amp;name=image24-Jan-18-2022-07-04-56-80-PM.png 2376w" sizes="(max-width: 792px) 100vw, 792px"><span style="font-size: 16px;"><em><span style="color: #666666;">The unfinished ransomware locker screen</span></em></span></p>
<p style="font-size: 18px; font-weight: bold;"><span style="color: #666666;">Analysis of FRP Loaders</span><span style="color: #666666;"></span></p>
<h6 style="font-size: 18px;"><em><span style="color: #666666;">Java Multi Platform Loader</span></em></h6>
<p>One of the more active IPs that was <a href="https://thedfirreport.com/2021/11/15/exchange-exploit-leads-to-domain-wide-ransomware/" rel="noopener" target="_blank"><span>reported</span></a> in the ProxyShell attacks was 148.251.71[.]182. In addition, another <a href="https://research.checkpoint.com/2022/apt35-exploits-log4j-vulnerability-to-distribute-new-modular-powershell-toolkit/" rel="noopener" target="_blank"><span>recent report</span></a> mentions this IP address as part of an active exploitation of the <a href="https://www.dynatrace.com/news/blog/what-is-log4shell/" rel="noopener" target="_blank"><span>Log4j vulnerability</span></a>:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image13-Jan-18-2022-07-05-53-63-PM.png?width=809&amp;name=image13-Jan-18-2022-07-05-53-63-PM.png" alt="image13-Jan-18-2022-07-05-53-63-PM" width="809" loading="lazy" style="width: 809px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image13-Jan-18-2022-07-05-53-63-PM.png?width=405&amp;name=image13-Jan-18-2022-07-05-53-63-PM.png 405w, https://www.cybereason.com/hs-fs/hubfs/image13-Jan-18-2022-07-05-53-63-PM.png?width=809&amp;name=image13-Jan-18-2022-07-05-53-63-PM.png 809w, https://www.cybereason.com/hs-fs/hubfs/image13-Jan-18-2022-07-05-53-63-PM.png?width=1214&amp;name=image13-Jan-18-2022-07-05-53-63-PM.png 1214w, https://www.cybereason.com/hs-fs/hubfs/image13-Jan-18-2022-07-05-53-63-PM.png?width=1618&amp;name=image13-Jan-18-2022-07-05-53-63-PM.png 1618w, https://www.cybereason.com/hs-fs/hubfs/image13-Jan-18-2022-07-05-53-63-PM.png?width=2023&amp;name=image13-Jan-18-2022-07-05-53-63-PM.png 2023w, https://www.cybereason.com/hs-fs/hubfs/image13-Jan-18-2022-07-05-53-63-PM.png?width=2427&amp;name=image13-Jan-18-2022-07-05-53-63-PM.png 2427w" sizes="(max-width: 809px) 100vw, 809px"><span style="font-size: 16px;"><em><span style="color: #666666;">Files found on the IP address 148.251.71[.]182</span></em></span></p>
<p>The “symantec” and “update” themed files all serve the FRP again. The “RCE” links, on the other hand, serve a Java loader that distinguishes the victim machine’s operating system and drops the appropriate version of FRP:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image25-Jan-18-2022-07-06-48-96-PM.png?width=1988&amp;name=image25-Jan-18-2022-07-06-48-96-PM.png" alt="image25-Jan-18-2022-07-06-48-96-PM" width="1988" loading="lazy" style="width: 1988px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image25-Jan-18-2022-07-06-48-96-PM.png?width=994&amp;name=image25-Jan-18-2022-07-06-48-96-PM.png 994w, https://www.cybereason.com/hs-fs/hubfs/image25-Jan-18-2022-07-06-48-96-PM.png?width=1988&amp;name=image25-Jan-18-2022-07-06-48-96-PM.png 1988w, https://www.cybereason.com/hs-fs/hubfs/image25-Jan-18-2022-07-06-48-96-PM.png?width=2982&amp;name=image25-Jan-18-2022-07-06-48-96-PM.png 2982w, https://www.cybereason.com/hs-fs/hubfs/image25-Jan-18-2022-07-06-48-96-PM.png?width=3976&amp;name=image25-Jan-18-2022-07-06-48-96-PM.png 3976w, https://www.cybereason.com/hs-fs/hubfs/image25-Jan-18-2022-07-06-48-96-PM.png?width=4970&amp;name=image25-Jan-18-2022-07-06-48-96-PM.png 4970w, https://www.cybereason.com/hs-fs/hubfs/image25-Jan-18-2022-07-06-48-96-PM.png?width=5964&amp;name=image25-Jan-18-2022-07-06-48-96-PM.png 5964w" sizes="(max-width: 1988px) 100vw, 1988px"><span style="font-size: 16px;"><em><span style="color: #666666;">The Java RCE class</span></em></span></p>
<p>There are two slightly different variations of the loader, but eventually they check for the file separator of the OS, which is “/” in case it’s Linux or “\” in Windows, and then downloads the payload and creates persistence:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image5-Jan-18-2022-07-07-32-13-PM.png?width=1999&amp;name=image5-Jan-18-2022-07-07-32-13-PM.png" alt="image5-Jan-18-2022-07-07-32-13-PM" width="1999" loading="lazy" style="width: 1999px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image5-Jan-18-2022-07-07-32-13-PM.png?width=1000&amp;name=image5-Jan-18-2022-07-07-32-13-PM.png 1000w, https://www.cybereason.com/hs-fs/hubfs/image5-Jan-18-2022-07-07-32-13-PM.png?width=1999&amp;name=image5-Jan-18-2022-07-07-32-13-PM.png 1999w, https://www.cybereason.com/hs-fs/hubfs/image5-Jan-18-2022-07-07-32-13-PM.png?width=2999&amp;name=image5-Jan-18-2022-07-07-32-13-PM.png 2999w, https://www.cybereason.com/hs-fs/hubfs/image5-Jan-18-2022-07-07-32-13-PM.png?width=3998&amp;name=image5-Jan-18-2022-07-07-32-13-PM.png 3998w, https://www.cybereason.com/hs-fs/hubfs/image5-Jan-18-2022-07-07-32-13-PM.png?width=4998&amp;name=image5-Jan-18-2022-07-07-32-13-PM.png 4998w, https://www.cybereason.com/hs-fs/hubfs/image5-Jan-18-2022-07-07-32-13-PM.png?width=5997&amp;name=image5-Jan-18-2022-07-07-32-13-PM.png 5997w" sizes="(max-width: 1999px) 100vw, 1999px"><span style="font-size: 16px;"><em><span style="color: #666666;">Content of the malicious Java class</span></em></span></p>
<h6 style="font-size: 18px; font-weight: normal;"><em><span style="color: #666666;">Powershell to Exe Downloader</span></em></h6>
<p>Another loader which eventually delivers FRP is PowerShell code converted to an executable by the “Ps1 To Exe” freeware that is available for <a href="https://m.majorgeeks.com/files/details/ps1_to_exe.html" rel="noopener" target="_blank"><span>download</span></a> on public forums, where less technical people can successfully use it:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image8-Jan-18-2022-07-08-06-33-PM.png?width=813&amp;name=image8-Jan-18-2022-07-08-06-33-PM.png" alt="image8-Jan-18-2022-07-08-06-33-PM" width="813" loading="lazy" style="width: 813px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image8-Jan-18-2022-07-08-06-33-PM.png?width=407&amp;name=image8-Jan-18-2022-07-08-06-33-PM.png 407w, https://www.cybereason.com/hs-fs/hubfs/image8-Jan-18-2022-07-08-06-33-PM.png?width=813&amp;name=image8-Jan-18-2022-07-08-06-33-PM.png 813w, https://www.cybereason.com/hs-fs/hubfs/image8-Jan-18-2022-07-08-06-33-PM.png?width=1220&amp;name=image8-Jan-18-2022-07-08-06-33-PM.png 1220w, https://www.cybereason.com/hs-fs/hubfs/image8-Jan-18-2022-07-08-06-33-PM.png?width=1626&amp;name=image8-Jan-18-2022-07-08-06-33-PM.png 1626w, https://www.cybereason.com/hs-fs/hubfs/image8-Jan-18-2022-07-08-06-33-PM.png?width=2033&amp;name=image8-Jan-18-2022-07-08-06-33-PM.png 2033w, https://www.cybereason.com/hs-fs/hubfs/image8-Jan-18-2022-07-08-06-33-PM.png?width=2439&amp;name=image8-Jan-18-2022-07-08-06-33-PM.png 2439w" sizes="(max-width: 813px) 100vw, 813px"><span style="font-size: 16px;"><em><span style="color: #666666;">Information about one of the FRP loaders&nbsp;</span></em></span></p>
<p>Finally, the loader creates a scheduled task for FRP, of course while being dependent on the OS type.</p>
<p>A full process tree of a real time attack that exploits the ProxyShell vulnerability and deployment of the FRP modules, can be seen below:&nbsp;</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image27-Jan-18-2022-07-09-10-16-PM.png?width=1491&amp;name=image27-Jan-18-2022-07-09-10-16-PM.png" alt="image27-Jan-18-2022-07-09-10-16-PM" width="1491" loading="lazy" style="width: 1491px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image27-Jan-18-2022-07-09-10-16-PM.png?width=746&amp;name=image27-Jan-18-2022-07-09-10-16-PM.png 746w, https://www.cybereason.com/hs-fs/hubfs/image27-Jan-18-2022-07-09-10-16-PM.png?width=1491&amp;name=image27-Jan-18-2022-07-09-10-16-PM.png 1491w, https://www.cybereason.com/hs-fs/hubfs/image27-Jan-18-2022-07-09-10-16-PM.png?width=2237&amp;name=image27-Jan-18-2022-07-09-10-16-PM.png 2237w, https://www.cybereason.com/hs-fs/hubfs/image27-Jan-18-2022-07-09-10-16-PM.png?width=2982&amp;name=image27-Jan-18-2022-07-09-10-16-PM.png 2982w, https://www.cybereason.com/hs-fs/hubfs/image27-Jan-18-2022-07-09-10-16-PM.png?width=3728&amp;name=image27-Jan-18-2022-07-09-10-16-PM.png 3728w, https://www.cybereason.com/hs-fs/hubfs/image27-Jan-18-2022-07-09-10-16-PM.png?width=4473&amp;name=image27-Jan-18-2022-07-09-10-16-PM.png 4473w" sizes="(max-width: 1491px) 100vw, 1491px"><span style="font-size: 16px;"><em><span style="color: #666666;">A real time FRP staging and execution as seen in the Cybereason XDR Platform</span></em></span></p>
<p>Once the attackers exploited the vulnerable Microsoft Exchange Server, they downloaded the FRP module, ran multiple reconnaissance commands, created persistence, dumped credentials using a known LOLBIN technique (<a href="https://lolbas-project.github.io/lolbas/Libraries/comsvcs/" rel="noopener" target="_blank"><span>Comsvcs.dll</span></a>), and attempted to move laterally, as can be seen in the above Cybereason XDR Platform image.&nbsp;</p>
<h2 style="text-align: left; font-size: 30px;">The Memento Ransomware Connection</h2>
<p>Another IP that appears in US CERT’s list is 91.214.124[.]143. Searching it in VirusTotal reveals other malicious files communicating with it, as well as unique URL directory patterns that reveal a potential connection to Memento Ransomware:</p>
<ul>
<li aria-level="1">The string “gsdhdDdfgA5sS” appears to be generated by the same script as the one listed in the <a href="https://github.com/sophoslabs/IoCs/blob/master/ransomware_memento.csv" rel="noopener" target="_blank"><span>Memento Ransomware IOCs</span></a>: “gadfTs55sghsSSS”.</li>
<li aria-level="1">The domain “google.onedriver-srv[.]ml” was previously resolved to the IP address 91.214.124[.]143 mentioned in the <a href="https://www.cisa.gov/uscert/ncas/alerts/aa21-321a" rel="noopener" target="_blank"><span>US CERT</span></a> alert about Iran state sponsored actors activity:</li>
</ul>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/image7-Jan-18-2022-07-09-48-95-PM.png?width=898&amp;name=image7-Jan-18-2022-07-09-48-95-PM.png" alt="image7-Jan-18-2022-07-09-48-95-PM" width="898" loading="lazy" style="width: 898px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image7-Jan-18-2022-07-09-48-95-PM.png?width=449&amp;name=image7-Jan-18-2022-07-09-48-95-PM.png 449w, https://www.cybereason.com/hs-fs/hubfs/image7-Jan-18-2022-07-09-48-95-PM.png?width=898&amp;name=image7-Jan-18-2022-07-09-48-95-PM.png 898w, https://www.cybereason.com/hs-fs/hubfs/image7-Jan-18-2022-07-09-48-95-PM.png?width=1347&amp;name=image7-Jan-18-2022-07-09-48-95-PM.png 1347w, https://www.cybereason.com/hs-fs/hubfs/image7-Jan-18-2022-07-09-48-95-PM.png?width=1796&amp;name=image7-Jan-18-2022-07-09-48-95-PM.png 1796w, https://www.cybereason.com/hs-fs/hubfs/image7-Jan-18-2022-07-09-48-95-PM.png?width=2245&amp;name=image7-Jan-18-2022-07-09-48-95-PM.png 2245w, https://www.cybereason.com/hs-fs/hubfs/image7-Jan-18-2022-07-09-48-95-PM.png?width=2694&amp;name=image7-Jan-18-2022-07-09-48-95-PM.png 2694w" sizes="(max-width: 898px) 100vw, 898px"><span style="font-size: 16px;"><em><span style="color: #666666;">Some of the Memento IOCs that are suspected to be related to Phosphorus</span></em></span></p>
<ul>
<li aria-level="1">The “Connector3.exe” naming convention: as mentioned above, Phosphorus has been observed using the FRP tool in many occasions. The file name that is used for FRP and reported by the US CERT is “Connector3.exe”. As can be seen below, the same name is being used to name a backdoor by Memento:</li>
</ul>
<p style="text-align: center; padding-left: 40px;"><img src="https://www.cybereason.com/hs-fs/hubfs/image11-Jan-18-2022-07-10-58-10-PM.png?width=805&amp;name=image11-Jan-18-2022-07-10-58-10-PM.png" alt="image11-Jan-18-2022-07-10-58-10-PM" width="805" loading="lazy" style="width: 805px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/image11-Jan-18-2022-07-10-58-10-PM.png?width=403&amp;name=image11-Jan-18-2022-07-10-58-10-PM.png 403w, https://www.cybereason.com/hs-fs/hubfs/image11-Jan-18-2022-07-10-58-10-PM.png?width=805&amp;name=image11-Jan-18-2022-07-10-58-10-PM.png 805w, https://www.cybereason.com/hs-fs/hubfs/image11-Jan-18-2022-07-10-58-10-PM.png?width=1208&amp;name=image11-Jan-18-2022-07-10-58-10-PM.png 1208w, https://www.cybereason.com/hs-fs/hubfs/image11-Jan-18-2022-07-10-58-10-PM.png?width=1610&amp;name=image11-Jan-18-2022-07-10-58-10-PM.png 1610w, https://www.cybereason.com/hs-fs/hubfs/image11-Jan-18-2022-07-10-58-10-PM.png?width=2013&amp;name=image11-Jan-18-2022-07-10-58-10-PM.png 2013w, https://www.cybereason.com/hs-fs/hubfs/image11-Jan-18-2022-07-10-58-10-PM.png?width=2415&amp;name=image11-Jan-18-2022-07-10-58-10-PM.png 2415w" sizes="(max-width: 805px) 100vw, 805px"><span style="font-size: 16px;"><em><span style="color: #666666;">FRP named “Connector3.exe” from US CERT report</span></em></span></p>
<ul>
<li aria-level="1">The activity of Phosphorus with regard to ProxyShell took place in about the same time frame as Memento. Iranian threat actors were also reported to be turning to ransomware during that period, which strengthens the hypothesis that Memento is operated by an Iranian threat actor.</li>
</ul>
<h2 style="font-size: 30px;">Conclusion</h2>
<p>In this report, the Cybereason Nocturnus Team detailed a previously undocumented PowerShell backdoor dubbed <em>PowerLess,</em> used by the Iranian APT Phosphorus in recent attacks. This research also provided further details regarding the group’s tools and techniques, including the use of publicly available tools and a combination of coding languages.&nbsp;</p>
<p>The extensive usage of open source tools that is assessed to demonstrate the intermediate coding skills of the attackers. The use of various programming languages also might point to a lack of specialization in any specific coding language. This research also highlights how important it is for threat intelligence analysts to “follow the breadcrumbs,” such as pivoting on known infrastructure or the PDB paths left by the attackers in this case, in order to pave the way for discovering additional tools and connections to other operations.&nbsp;</p>
<p>Finally, a connection between Phosphorus and the Memento ransomware was also found through mutual TTP patterns and attack infrastructure, strengthening the connection between this previously unattributed ransomware and the Phosphorus group.</p>
<p>The <a href="https://www.cybereason.com/platform/xdr"><span>Cybereason XDR Platform</span></a> detects and blocks the PowerLess Trojan and other advanced TTPs used in this operation. Cybereason is dedicated to teaming with defenders to end attacks on the endpoint, across enterprise, to everywhere the battle is taking place.</p>
<h2 style="font-size: 30px;">MITRE ATT&amp;CK BREAKDOWN</h2>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2;">
<tbody>
<tr>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><span style="font-size: 16px;"><strong><span style="color: #596a6f;">Reconnaissance</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><span style="font-size: 16px;"><strong><span style="color: #596a6f;">Execution</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><span style="font-size: 16px;"><strong><span style="color: #596a6f;">Persistence</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><span style="font-size: 16px;"><strong><span style="color: #596a6f;">Defense Evasion</span></strong></span></p>
</td>
</tr>
<tr>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center; font-size: 18px;"><span><a href="https://attack.mitre.org/techniques/T1592/" rel="noopener" target="_blank">Gather Victim Host Information</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><span><a href="https://attack.mitre.org/techniques/T1059/001/" rel="noopener" target="_blank">Command and Scripting Interpreter: PowerShell</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><a href="https://attack.mitre.org/techniques/T1547/001/" rel="noopener" target="_blank"><span>Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder</span></a></p>
<br><br></td>
<td style="border: 0.75pt solid #99acc2;"><br>
<p><a href="https://attack.mitre.org/techniques/T1036/" rel="noopener" target="_blank"><span>Masquerading</span></a></p>
</td>
</tr>
<tr>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><a href="https://attack.mitre.org/techniques/T1589/" rel="noopener" target="_blank"><span>Gather Victim Identity Information</span></a></p>
</td>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><a href="https://attack.mitre.org/techniques/T1203/" rel="noopener" target="_blank"><span>Exploitation for Client Execution</span></a></p>
<br><br></td>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><a href="https://attack.mitre.org/techniques/T1053/002/" rel="noopener" target="_blank"><span>Scheduled Task/Job: At (Windows)</span></a></p>
<br><br></td>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><a href="https://attack.mitre.org/techniques/T1562/004/" rel="noopener" target="_blank"><span>Impair Defenses: Disable or Modify System Firewall</span></a></p>
<br><br></td>
</tr>
<tr>
<td style="border: 0.75pt solid #99acc2;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><a href="https://attack.mitre.org/techniques/T1053/002/" rel="noopener" target="_blank"><span>Scheduled Task/Job: At (Windows)</span></a></p>
<br><br></td>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><a href="https://attack.mitre.org/techniques/T1053/001/" rel="noopener" target="_blank"><span>Scheduled Task/Job: At (Linux)</span></a></p>
<br><br></td>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><a href="https://attack.mitre.org/techniques/T1112/" rel="noopener" target="_blank"><span>Modify Registry</span></a></p>
</td>
</tr>
<tr>
<td style="border: 0.75pt solid #99acc2;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><a href="https://attack.mitre.org/techniques/T1053/001/" rel="noopener" target="_blank"><span>Scheduled Task/Job: At (Linux)</span></a></p>
<br><br></td>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><a href="https://attack.mitre.org/techniques/T1505/003/" rel="noopener" target="_blank"><span>Server Software Component: Web Shell</span></a></p>
<br><br></td>
<td style="border: 0.75pt solid #99acc2;">&nbsp;</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: 1px solid #99acc2;">
<tbody>
<tr>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><span style="font-size: 16px;"><strong><span style="color: #596a6f;">Discovery</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><span style="font-size: 16px;"><strong><span style="color: #596a6f;">Collection</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><span style="font-size: 16px;"><strong><span style="color: #596a6f;">Command and Control</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><span style="font-size: 16px;"><strong><span style="color: #596a6f;">Credential Access</span></strong></span></p>
</td>
</tr>
<tr>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><a href="https://attack.mitre.org/techniques/T1087/001/" rel="noopener" target="_blank"><span>Account Discovery: Local Account</span></a></p>
</td>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><a href="https://attack.mitre.org/techniques/T1560/" rel="noopener" target="_blank"><span>Archive Collected Data</span></a></p>
<br><br></td>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><a href="https://attack.mitre.org/techniques/T1071/001/" rel="noopener" target="_blank"><span>Application Layer Protocol: Web Protocols</span></a></p>
<br><br></td>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><a href="https://attack.mitre.org/techniques/T1003/" rel="noopener" target="_blank"><span>OS Credential Dumping</span></a></p>
</td>
</tr>
<tr>
<td style="border: 0.75pt solid #99acc2;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><a href="https://attack.mitre.org/techniques/T1123/" rel="noopener" target="_blank"><span>Audio Capture</span></a></p>
</td>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><a href="https://attack.mitre.org/techniques/T1132/001/" rel="noopener" target="_blank"><span>Data Encoding: Standard Encoding</span></a></p>
<br><br></td>
<td style="border: 0.75pt solid #99acc2;">&nbsp;</td>
</tr>
<tr>
<td style="border: 0.75pt solid #99acc2;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><a href="https://attack.mitre.org/techniques/T1056/001/" rel="noopener" target="_blank"><span>Input Capture: Keylogging</span></a></p>
</td>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><a href="https://attack.mitre.org/techniques/T1573/001/" rel="noopener" target="_blank"><span>Encrypted Channel: Symmetric Cryptography</span></a></p>
<br><br></td>
<td style="border: 0.75pt solid #99acc2;">&nbsp;</td>
</tr>
<tr>
<td style="border: 0.75pt solid #99acc2;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2;">
<p style="text-align: center;"><a href="https://attack.mitre.org/techniques/T1090/" rel="noopener" target="_blank"><span>Proxy</span></a></p>
</td>
<td style="border: 0.75pt solid #99acc2;">&nbsp;</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h2 style="font-size: 30px;">About the Researcher:</h2>
<p><span style="font-weight: bold;"><img class="no-border" src="https://www.cybereason.com/hs-fs/hubfs/Daniel-F-HS-1-1-1.png?width=179&amp;name=Daniel-F-HS-1-1-1.png" alt="Daniel-F-HS-1-1-1" width="179" loading="lazy" style="width: 179px; float: left; margin: 0px 7px 1px 0px;" srcset="https://www.cybereason.com/hs-fs/hubfs/Daniel-F-HS-1-1-1.png?width=90&amp;name=Daniel-F-HS-1-1-1.png 90w, https://www.cybereason.com/hs-fs/hubfs/Daniel-F-HS-1-1-1.png?width=179&amp;name=Daniel-F-HS-1-1-1.png 179w, https://www.cybereason.com/hs-fs/hubfs/Daniel-F-HS-1-1-1.png?width=269&amp;name=Daniel-F-HS-1-1-1.png 269w, https://www.cybereason.com/hs-fs/hubfs/Daniel-F-HS-1-1-1.png?width=358&amp;name=Daniel-F-HS-1-1-1.png 358w, https://www.cybereason.com/hs-fs/hubfs/Daniel-F-HS-1-1-1.png?width=448&amp;name=Daniel-F-HS-1-1-1.png 448w, https://www.cybereason.com/hs-fs/hubfs/Daniel-F-HS-1-1-1.png?width=537&amp;name=Daniel-F-HS-1-1-1.png 537w" sizes="(max-width: 179px) 100vw, 179px">DANIEL FRANK</span></p>
<p>Daniel Frank is a senior Malware Researcher at Cybereason. Prior to Cybereason, Frank was a Malware Researcher in F5 Networks and RSA Security. His core roles as a Malware Researcher include researching emerging threats, reverse-engineering malware and developing security-driven code. Frank has a BSc degree in information systems.</p></span>
          
          <!-- IOC PopUp Modal -->
          
          
            <div id="hs_cos_wrapper_module_162281712252340" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><!-- Button -->



<div class="cr-modal" id="iocs">
  <div class="cr-modal-overlay cr-modal-toggle"></div>
  <div class="cr-modal-wrapper cr-modal-transition">
    <div class="cr-modal-header">
      <button class="cr-modal-close cr-modal-toggle" id="ioc-close">X</button>
    </div>

    <div class="cr-modal-body">
      <div class="cr-modal-content">
        <h2 style="font-size: 36px; line-height: 1;">Indicators of Compromise | <span>PowerLess</span></h2>
<h3 style="font-size: 24px;"><strong><span style="color: #434343;">IPs</span></strong></h3>
<p>91.214.124[.]143&nbsp;</p>
<p>162.55.137[.]20</p>
<p>162.55.136[.]233</p>
<p>148.251.71[.]182</p>
<h3 style="font-size: 24px;"><strong><span style="color: #434343;">Files</span></strong></h3>
<p><strong>WindowsProcesses.exe</strong></p>
<p>679703e9859c20ab39d6be992aa7d979710d9ace</p>
<p><strong>dll.dll</strong></p>
<p>3fcec932530557ea3d1f38f06f477db4b0be5acb</p>
<p><strong>upc</strong></p>
<p>97c0e103700b9f2464000cb63e10b68a4305dd33</p>
<p><strong>Keylogger module</strong></p>
<p>4810c782a8fe964512f08db91e8107e9af29edab</p>
<p><strong>Stealer module</strong></p>
<p>3bfec62c094366844c3e4c0e257e01678f55ef5b</p>
<p><strong>Sou.exe</strong></p>
<p>0492b9ad7ae35ee1e0b6f53a6b7c2c75e9b5d427</p>
<p><strong>Chromium F.exe</strong></p>
<p>dd94382acb55e694ee38e1be7f5c0902be0e0d89</p>
<p><strong>Rsf.exe</strong></p>
<p>416291332a70407df5ff5d79072f5ad68cd802b9</p>
<p><strong>Java loaders</strong></p>
<p>026db4159e7e36e00fdcef1e29f73b40030a3572</p>
<p>dcf01d7641ec3fec213ab8335625a3554b943ac8</p>
<p>92ae97557e18ca810999fc05c18e3c6c75476444</p>
<p>eeebce1a4c3e05e21689acef000a5fcf0f17abc3</p>
<p><strong>task_update.exe</strong></p>
<p>32224892b670467e23874d7e8abd2ef92987a7e6</p>
<p>3a6431169073d61748829c31a9da29123dd61da8</p>
<h3 style="font-size: 24px;"><strong><span style="color: #434343;">PDBs</span></strong></h3>
<p>"C:\Users\pugna\Desktop\126\V1\PowerLessCLR\x64\Release\PowerLessCLR.pdb"</p>
<p>“C:\Users\pugna\Desktop\126\V1\slns\dll\dll\obj\Release\dll.pdb”</p>
<p>“C:\Users\pugna\Desktop\Sou\Sou\bin\x64\Release\s.pdb”</p>
<p>“C:\Users\pugna\Documents\Gatherer\Chromiom F\obj\Release\Chromiom F.pdb”</p>
<p>“C:\Users\pugna\Desktop\RS\rsf\rsf\obj\Debug\rsf.pdb”</p>
<p>“C:\Users\Injec\Desktop\myklg-without-mouse-with timee\myklg\obj\Release\myklg.pdb”</p>
<p>“C:\Users\Injec\Desktop\pro4-finaly\pro4\bin\Release\ILMerge\pro4.pdb”</p>
      </div>
    </div>
  </div>
</div></div>
          
          
          <!-- -->
          
          <!-- Social Share -->
          <div class="cr-blog-post__social-sharing">
            <span>Share</span>
            <div id="hs_cos_wrapper_module_161724375084957" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-social_sharing" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">






<div class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_social_sharing" data-hs-cos-general-type="widget" data-hs-cos-type="social_sharing">
  
	
  
    
    
    
			
		

    <a href="https://twitter.com/intent/tweet?original_referer=https://www.cybereason.com/blog/research/powerless-trojan-iranian-apt-phosphorus-adds-new-powershell-backdoor-for-espionage&amp;utm_medium=social&amp;utm_source=twitter&amp;url=https://www.cybereason.com/blog/research/powerless-trojan-iranian-apt-phosphorus-adds-new-powershell-backdoor-for-espionage&amp;utm_medium=social&amp;utm_source=twitter&amp;source=tweetbutton&amp;text=" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/twitter-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on twitter">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.facebook.com/share.php?u=https://www.cybereason.com/blog/research/powerless-trojan-iranian-apt-phosphorus-adds-new-powershell-backdoor-for-espionage&amp;utm_medium=social&amp;utm_source=facebook" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/facebook-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on facebook">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.cybereason.com/blog/research/powerless-trojan-iranian-apt-phosphorus-adds-new-powershell-backdoor-for-espionage&amp;utm_medium=social&amp;utm_source=linkedin" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/linkedin-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on linkedin">
    </a>
	

</div></div>
          </div> 
          
          
          <!-- CONDITIONAL Author Box Display -->
            <div class="container columns cr-mln__author-listing-single">
              
                <div class="column headshot is-3-full-hd is-3-desktop is-3-tablet is-12-mobile">
                  <img class="cr-speaker-headshot" src="https://www.cybereason.com/hubfs/CR_Owl_Web_Mono@3x%202.png" alt="Cybereason Nocturnus">
                </div>
              
              <div class="column is-9-full-hd is-9-desktop is-12-mobile">
                <span class="descriptor">About the Author</span>
                <h4>Cybereason Nocturnus</h4>
                
                  <a class="social" href="https://www.linkedin.com/company/cybereason" target="_blank">
                    <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/icon-social-gray-linkedin.png">
                  </a>
                
                
                  <a class="social" href="https://twitter.com/cr_nocturnus" target="_blank">
                    <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/icon-social-gray-twitter.svg">
                  </a>
                
                
                  <p>The Cybereason Nocturnus Team has brought the world’s brightest minds from the military, government intelligence, and enterprise security to uncover emerging threats across the globe. They specialize in analyzing new attack methodologies, reverse-engineering malware, and exposing unknown system vulnerabilities. The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks.</p>
                
                
                  <a class="cr-button cr-button__min" href="https://www.cybereason.com/blog/authors/cybereason-nocturnus">All Posts by Cybereason Nocturnus</a>
                
              </div>            
            </div>
          
        <!-- CONDITIONAL Post Type Choices -->
        
        <!-- Malicious Life Post -->
        
        
        <!-- CISO Stories -->
        
        <!-- Webinar -->
        
          
        <!-- CONDITIONAL Transcript -->
          
        
         <!-- Related Posts -->
        <div id="hs_cos_wrapper_module_1649342860525315" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<section class="cr-section related-posts__wrapper">
  <div class="container container-is-blog page-center">
     <h3>Related Posts</h3>
     <div class="columns is-multiline">
       
  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/research/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms"><img src="https://www.cybereason.com/hubfs/BLOG%20%20SOCIAL%20SET%20-%20News%20%281%29-1.png" alt="Operation GhostShell: Novel RAT Targets Global Aerospace and Telecoms Firms"></a>
    <h4><a href="https://www.cybereason.com/blog/research/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms"><span class="underline">Operation GhostShell: Novel RAT Targets Global Aerospace and Telecoms Firms</span></a></h4>
     <p>The highly-targeted attacks against aerospace and telecoms firms by new Iranian threat actor MalKamak includes newly discovered malware that evaded security tools since 2018 and abuses Dropbox services for command and control...</p>
   </div>
 </div>


  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/research/strifewater-rat-iranian-apt-moses-staff-adds-new-trojan-to-ransomware-operations"><img src="https://www.cybereason.com/hubfs/strifewater.png" alt="StrifeWater RAT: Iranian APT Moses Staff Adds New Trojan to Ransomware Operations"></a>
    <h4><a href="https://www.cybereason.com/blog/research/strifewater-rat-iranian-apt-moses-staff-adds-new-trojan-to-ransomware-operations"><span class="underline">StrifeWater RAT: Iranian APT Moses Staff Adds New Trojan to Ransomware Operations</span></a></h4>
     <p>Cybereason discovered an undocumented RAT dubbed StrifeWater attributed to Iranian APT Moses Staff who deploy destructive ransomware following network infiltration and the exfiltration of sensitive data...</p>
   </div>
 </div>



    </div>
  </div>
</section></div>
          
          
      </div>
        
        <!-- Sidebar -->

      <div class="column is-3-fullhd is-3-desktop is-12-mobile cr-malicious-life-network__sidebar">
        <div class="cr-ml-sidebar--group">
        <div class="top-stripe"></div>
        <div class="sidebar-block search-section">
          <form action="/hs-search-results">
            <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search">
            <input type="hidden" name="type" value="BLOG_POST">
            <input type="hidden" name="type" value="LISTING_PAGE">
            <button type="submit" class="arrow"></button>
          </form>
        </div>
        <div class="sidebar-block subscribe">
          <a href="#blog-subscribe">
            <h4>Subscribe</h4>
            <span>Never miss a blog.</span>
          </a>
        </div>

        <div class="sidebar-block recent-posts">
          <h4>Recent Posts</h4>
          
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/malicious-life-podcast-operation-snow-white-part-2" class="post-name"><span class="underline">Malicious Life Podcast: Operation Snow White, Part 2</span></a>
                       
                    </div>
                </div>
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/threat-analysis-beast-ransomware" class="post-name"><span class="underline">THREAT ANALYSIS: Beast Ransomware</span></a>
                       
                    </div>
                </div>
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/cuckoo-spear-pt2-threat-actor-arsenal" class="post-name"><span class="underline">CUCKOO SPEAR Part 2: Threat Actor Arsenal</span></a>
                       
                    </div>
                </div>
            
        </div>

        <div class="sidebar-block category-listing">
          <h4>Categories</h4>
          <ul>
            <li><a href="https://www.cybereason.com/blog/category/research">Research</a></li>
            <li><a href="https://www.cybereason.com/blog/category/podcasts">Podcasts</a></li>
            <li><a href="https://www.cybereason.com/blog/category/webinars">Webinars</a></li>
            <li><a href="https://www.cybereason.com/blog/category/resources">Resources</a></li>
            <li><a href="https://www.cybereason.com/blog/category/videos">Videos</a></li>
            <li><a href="https://www.cybereason.com/blog/category/news">News</a></li>
          </ul>

          <a class="rec-category__single--view-all" href="/blog/category/research">All Posts</a>
        </div>

        
      </div><!-- END .rec-categories__all -->
      
      
      
    </div>
       
    </div>
  </div>
</div></div>

</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="display: none;" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1616011887658867" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<section class="cr-section related-posts__wrapper">
  <div class="container container-is-blog page-center">
     <h3>Related Posts</h3>
     <div class="columns is-multiline">
       
  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/research/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms"><img src="https://www.cybereason.com/hubfs/BLOG%20%20SOCIAL%20SET%20-%20News%20%281%29-1.png" alt="Operation GhostShell: Novel RAT Targets Global Aerospace and Telecoms Firms"></a>
    <h4><a href="https://www.cybereason.com/blog/research/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms"><span class="underline">Operation GhostShell: Novel RAT Targets Global Aerospace and Telecoms Firms</span></a></h4>
     <p>The highly-targeted attacks against aerospace and telecoms firms by new Iranian threat actor MalKamak includes newly discovered malware that evaded security tools since 2018 and abuses Dropbox services for command and control...</p>
   </div>
 </div>


  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/research/strifewater-rat-iranian-apt-moses-staff-adds-new-trojan-to-ransomware-operations"><img src="https://www.cybereason.com/hubfs/strifewater.png" alt="StrifeWater RAT: Iranian APT Moses Staff Adds New Trojan to Ransomware Operations"></a>
    <h4><a href="https://www.cybereason.com/blog/research/strifewater-rat-iranian-apt-moses-staff-adds-new-trojan-to-ransomware-operations"><span class="underline">StrifeWater RAT: Iranian APT Moses Staff Adds New Trojan to Ransomware Operations</span></a></h4>
     <p>Cybereason discovered an undocumented RAT dubbed StrifeWater attributed to Iranian APT Moses Staff who deploy destructive ransomware following network infiltration and the exfiltration of sensitive data...</p>
   </div>
 </div>



    </div>
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-3 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_161767462015235" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-blog_subscribe" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-mln__blog-listing-page__subscribe-footer">
  <div class="container container-is-blog columns page-center">
    <div class="column is-8-fullhd is-8-desktop is-10-tablet is-12-mobile">
      <span class="tag">NEWSLETTER</span>
      <h3>Never miss a blog</h3>
      <p>Get the latest research, expert insights, and security industry news.</p>
      <a class="cr-button cr-mln__subscribe" href="#blog-subscribe">Subscribe</a>
    </div>
    <!--<div class="column is-5-fullhd is-5-desktop is-half-tablet is-12-mobile is-offset-1-fullhd is-offset-1-desktop">
      <div class="inputs-wrapper">
        
        
      </div>
    </div>-->
  </div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-4 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_166508001252918" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-sticky-cta-bar bg-black" id="sticky-bar">
  <div class="content">
    <span>Want to see the Cybereason Defense Platform in action?</span>
    <a class="cr-button cr-button__fill-yellow" href="https://www.cybereason.com/request-a-demo" target="_blank">Schedule a Demo</a>
  </div>
  <div class="close">X</div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end body -->
</div><!--end body wrapper -->

<div class="footer-container-wrapper">
    <div class="footer-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_16036762394194314" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><!-- FOOTER -->

<footer class="cr-section cr-footer cr-footer__full">
    <div class="container page-center">
      <div class="columns">
          <div class="column is-6-fullhd is-5-desktop cr-footer__col cr-footer__left">
            <div class="cr-footer__Left-logo">
              
                <a href="https://www.cybereason.com">
                  
                <img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-logo-inline--primary-white.png">
              </a>
            </div>
          </div>
          <div class="columns column is-6-fullhd is-6-desktop cr-footer__col cr-footer__right">
            <div class="cr-footer__links-list column">
              <h4>About</h4>
              <ul>
                <li><a href="https://www.cybereason.com/company/who-we-are">Who We Are</a>
                </li><li><a href="https://www.cybereason.com/company/careers">Careers</a>
          <!-- </li><li><a href="https://www.cybereason.com/company/leadership">Leadership</a> --->
                </li><li><a href="https://www.cybereason.com/company/contact-us">Contact</a>
              </li></ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Resources</h4>
              <ul>
                <li><a href="https://www.cybereason.com/blog">Blog</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/case-study">Case Studies</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/webinars">Webinars</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/white-papers">White Papers</a></li>
             </ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Platform</h4>
              <ul>
                
                <li><a href="https://www.cybereason.com/platform">Overview</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-prevention">Endpoint Protection</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-detection-response-edr">EDR</a></li>
                <li><a href="https://www.cybereason.com/platform/managed-detection-response-mdr">MDR</a></li>
              </ul>
            </div>
          </div>
      </div>
    </div>
  
    <div class="container page-center">
      <div class="columns cr-footer__bottom-bar">
        <div class="column">
          <p>©Cybereason 2024. All Rights Reserved.</p>
        </div>
        <div class="column bottom-bar__links">
          <ul>
            <li><a href="https://www.cybereason.com/terms-of-use">Terms of Use</a></li>
            <li><a href="https://www.cybereason.com/privacy-notice">Privacy Notice</a></li>
            <li><a href="https://www.cybereason.com/ccpa-privacy-request">Do Not Sell</a></li>
            <li><a href="https://www.cybereason.com/security">Security</a></li>
            <!--<li><a href="#">Cookie Policy</a></li>-->
          </ul>
        </div>

        <div class="column bottom-bar__social">
          <ul>
            <li><a class="facebook" href="https://www.facebook.com/Cybereason/"></a></li>
            <li><a class="twitter" href="https://twitter.com/cybereason"></a></li>
            <li><a class="youtube" href="https://www.youtube.com/channel/UCOm7AaB0HiNH4Phe66sK0Ew"></a></li>
            <li><a class="linkedin" href="https://www.linkedin.com/company/cybereason"></a></li>
            <li><a class="instagram" href="https://www.instagram.com/cybereason"></a></li>
          </ul>
        </div>
    </div>
  </div>

</footer></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end footer -->
</div><!--end footer wrapper -->

    
<!-- HubSpot performance collection script -->
<script defer src="https://static.hsappstatic.net/content-cwv-embed/static-1.1293/embed.js"></script>
<script src="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42507089303/1644440411417/__CR_Web_Platform/JS/animatedModal/animatedModal.min.js"></script>
<script>
var hsVars = hsVars || {}; hsVars['language'] = 'en';
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.53/bundles/project.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41681847227/1644941386128/module_41681847227_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41682410610/1644941443113/module_41682410610_CR_-_Malicious_Life_Network_--_Main_Hero.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/48386556055/1642017327401/module_48386556055_CR_-_HTML_PopUp_Window_--_IOCs.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/43300360745/1724042213858/module_43300360745_CR_-_Malicious_Life_Network_--_Related_Posts.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/86933076631/1669911113440/module_86933076631_CR_-_Sticky_CTA_Bar.min.js"></script>

<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "blog-post"]);
_hsq.push(["setCanonicalUrl", "https:\/\/www.cybereason.com\/blog\/research\/powerless-trojan-iranian-apt-phosphorus-adds-new-powershell-backdoor-for-espionage"]);
_hsq.push(["setPageId", "64092072775"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 64092072775,
    "legacyPageId": "64092072775",
    "contentFolderId": null,
    "contentGroupId": 5272851739,
    "abTestId": null,
    "languageVariantId": 64092072775,
    "languageCode": "en",
    
    
}]);
</script>

<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/3354902.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    render_id: "98ed7907-55f6-43fb-b58b-ab8d0ae320a7",
    ticks: 1729740447693,
    page_id: 64092072775,
    
    content_group_id: 5272851739,
    portal_id: 3354902,
    app_hs_base_url: "https://app.hubspot.com",
    cp_hs_base_url: "https://cp.hubspot.com",
    language: "en",
    analytics_page_type: "blog-post",
    scp_content_type: "",
    analytics_page_id: "64092072775",
    category_id: 3,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.354/js/index.js"></script>

<script>if ($('[id^="hs_form"]').length > 0) {
  var myInterval = setInterval(
  function() {
    var myFields = document.getElementsByClassName('hs-input');
    if (myFields.length > 0) {
      clearInterval(myInterval);
      for (var i = 0; i < myFields.length; i++) {
        var myField = myFields[i];
		var myTagName = myField.tagName.toLowerCase();
        if (myTagName == 'input' || myTagName == 'textarea') {
          if (myField.placeholder != null) {
            myField.placeholder = myField.placeholder.replace('*', '');
          }
        } else if (myTagName == 'select') {
          myField.options[0].innerHTML = myField.options[0].innerHTML.replace('*', '');
        }
      }
    }
  }, 100);
}
</script>

<div id="fb-root"></div>
  <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v3.0";
  fjs.parentNode.insertBefore(js, fjs);
 }(document, 'script', 'facebook-jssdk'));</script> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
 


    <script>
function sticky_relocate() {
  var window_top = $(window).scrollTop();
  var div_top = $('#sticky-anchor').offset().top;
  if (window_top > div_top) {
    $('#sticky').addClass('stick');
  } else {
    $('#sticky').removeClass('stick');
  }
}

$(function() {
  $(window).scroll(sticky_relocate);
  sticky_relocate();
});
</script>
    <!-- Generated by the HubSpot Template Builder - template version 1.03 -->

<script type="text/javascript" src="/_Incapsula_Resource?SWJIYLWA=719d34d31c8e3a6e6fffd425f7e032f3&ns=1&cb=1960563761" async></script></body></html>