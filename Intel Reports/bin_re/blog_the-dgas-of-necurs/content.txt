<!doctype html><html lang="en-US"><head><link href="/assets/fonts/Montserrat-VariableFont_wght.woff2" rel="preload" type="font/woff2" as="font" crossorigin=""><meta charset="utf-8"><meta content="IE=edge" http-equiv="X-UA-Compatible"><title>The DGAs of Necurs</title><meta content="Necurs is a malware that opens a backdoor on infected systems, see NECURS: The Malware That Breaks Your Security." name="description" property="og:description"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="en_US" property="og:locale"><meta content="./assets/img/front/necurs-800.jpeg" property="og:image"><meta content="website" property="og:type"><meta content="Binary Reverse Engineering Blog" property="og:site_name"><meta content="The DGAs of Necurs" property="og:title"><meta content="summary" name="twitter:card"><meta content="@viql" name="twitter:site"><meta content="@viql" name="twitter:creator"><meta content="The DGAs of Necurs" name="twitter:title"><meta content="Necurs is a malware that opens a backdoor on infected systems, see NECURS: The Malware That Breaks Your Security." name="twitter:description"><meta content="https://bin.re/assets/img/front/necurs-800.jpeg" name="twitter:image"><link href="/assets/css/common-ef2fe0.css" rel="stylesheet"><link href="feed.xml" rel="alternate" type="application/atom+xml" title="Atom feed for the Blog"><link href="/assets/css/blog-a83391.css" rel="stylesheet"><link href="/apple-touch-icon-60x60.png" rel="apple-touch-icon" sizes="60x60"><link href="/apple-touch-icon-76x76.png" rel="apple-touch-icon" sizes="76x76"><link href="/apple-touch-icon-120x120.png" rel="apple-touch-icon" sizes="120x120"><link href="/apple-touch-icon-152x152.png" rel="apple-touch-icon" sizes="152x152"><link href="/apple-touch-icon-180x180.png" rel="apple-touch-icon" sizes="180x180"><link href="/apple-touch-icon-192x192.png" rel="apple-touch-icon" sizes="192x192"><link href="/apple-touch-icon-512x512.png" rel="apple-touch-icon" sizes="512x512"><link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"><link href="/favicon-192x192.png" rel="icon" sizes="192x192" type="image/png"><link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"><link href="/favicon.ico" rel="shortcut icon"><noscript><style>img.lazyload {
          display: none;
        }</style></noscript><script defer src="/assets/js/all.min-a1c570.js"></script></head><body class="a b7"><div class="b"><div class="d"><div class="f e"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-close" xlink:href="/assets/svg/icons.svg#icon-close"></use></svg></div><div class="h"><ul class="i j sidebar"><li class="q r"><a href="/">Home</a></li><li class="q"><a href="/publications/">Publications</a></li><li class="q t"><span class="u">Projects<svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-angle-down" xlink:href="/assets/svg/icons.svg#icon-angle-down"></use></svg></span><ul class="v"><li><a href="/projects/risk-battle-outcomes/">Probability of Winning Battles in Risk</a></li><li><a href="/tag/project-euler/">Project Euler</a></li><li><a href="/projects/bazarbackdoor/">BazarBackdoor Tools</a></li></ul></li><li class="q t"><span class="u">Reverse Engineering<svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-angle-down" xlink:href="/assets/svg/icons.svg#icon-angle-down"></use></svg></span><ul class="v"><li><a href="/tag/malware-analysis/">Malware Analysis</a></li><li><a href="/projects/solutions-to-crackmes/">Solutions to Crackmes</a></li><li><a href="/projects/solutions-to-practical-reverse-engineering/">Solutions to "Practical Reverse Engineering"</a></li></ul></li></ul></div></div></div><div id="aw"><div class="w"><header class="y x"><nav class="z a0"><a href="/"><span class="a1"><!-- Generator: Adobe Illustrator 25.0.0, SVG Export Plug-In  --> <svg viewBox="0 0 86.4 20.21" height="20.21px" style="overflow:visible;enable-background:new 0 0 86.4 20.21;" version="1.1" width="86.4px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"><g><path class="a2" d="M28.56,5.13c-1.99,0-2.87-1.12-2.87-2.57c0-1.5,0.9-2.57,2.87-2.57c2.02,0,2.95,1.07,2.95,2.57
    C31.51,4.01,30.58,5.13,28.56,5.13z M25.96,19.94V6.47h5.22v13.46H25.96z"></path><path class="a2" d="M43.69,19.94v-7.92c0-1.23-0.27-1.91-1.59-1.91c-0.6,0-1.53,0.3-2.24,0.76v9.07H34.6V6.45h4.89l0.08,1.31
    l0.16,0.05c1.58-1.12,3.5-1.69,4.78-1.69c3.47,0,4.42,1.91,4.42,4.86v8.96H43.69z"></path><path class="a2" d="M54.33,20.15c-1.83,0-2.62-1.01-2.62-2.37c0-1.37,0.82-2.35,2.62-2.35c1.86,0,2.68,0.98,2.68,2.35
    C57,19.14,56.16,20.15,54.33,20.15z"></path><path class="a2" d="M65.14,9.23c1.58-1.69,3.85-3.17,5.49-3.17c0.63,0,0.79,0.49,0.79,1.09c0,1.45-0.87,4.29-1.58,5.3l-4.51-0.57
    v8.06h-5.21V6.45h5.16c0,0.66-0.14,2.08-0.25,2.7L65.14,9.23z"></path><path class="a2" d="M86.4,12.78v1.2h-8.63c0.03,1.72,1.07,2.4,3.03,2.4c1.34,0,3-0.35,4.34-0.76l0.98,3.2
    c-1.94,1.04-4.34,1.39-6.25,1.39c-5.9,0-7.32-3.33-7.32-6.99c0-3.41,1.58-7.13,7.07-7.13C85.74,6.09,86.4,9.78,86.4,12.78z
     M77.82,11.52h3.9c-0.03-1.31-0.41-2.29-1.83-2.29C78.4,9.23,77.93,10.32,77.82,11.52z"></path><path class="a2" d="M6.92,12.81"></path><path class="a2" d="M17.24,6.06c-0.79,0-2.43,0.29-3.87,1.3c0-0.14-0.06-2.69-0.06-3.07V0.27H8.12v9.28
    c2.71-0.69,4.54-1.87,5.24-2.18v3.06c-0.85,0.55-4.15,2.11-5.24,2.44v5.86c2.62,1.28,6.12,1.48,7.54,1.48
    c5.79,0,7.16-3.33,7.16-7.02C22.82,9.07,21.45,6.06,17.24,6.06z M15.41,16.6c-0.54,0-1.31-0.08-2.05-0.38v-5.79
    c0.66-0.33,1.45-0.65,2.16-0.65c1.01,0,2.1,0.35,2.1,3.47C17.63,16.14,16.59,16.6,15.41,16.6z"></path><path class="a2" d="M8.12,9.55c-1.03,0.23-2.56,0.51-3.66,0.23l0-3.09L0,11.57l4.51,4.88l0-3.13c1.38,0.17,2.69-0.23,3.61-0.45
    V9.55z"></path></g></svg></span></a><div class="a3"><button class="a2 a4" id="ax"><svg height="20px" version="1.1" width="20px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewport="0 0 20 20"><path class="a5" d="M2.28,15.89l1.57-1.61l1.24,1.24l-1.57,1.61L2.28,15.89z M8.86,19.33v-2.61h1.74v2.61H8.86z M9.73,4.35
	c1.46,0,2.71,0.52,3.75,1.55s1.55,2.28,1.55,3.75s-0.52,2.71-1.55,3.75c-1.03,1.03-2.28,1.55-3.75,1.55s-2.71-0.52-3.75-1.55
	s-1.55-2.28-1.55-3.75S4.95,6.93,5.98,5.9S8.26,4.35,9.73,4.35z M16.81,8.77h2.65v1.78h-2.65V8.77z M14.36,15.52l1.24-1.2l1.57,1.57
	l-1.24,1.24L14.36,15.52z M17.18,3.43l-1.57,1.57l-1.24-1.24l1.57-1.57L17.18,3.43z M10.6,0v2.61H8.86V0C8.86,0,10.6,0,10.6,0z
	 M2.65,8.77v1.78H0V8.77H2.65z M5.09,3.77L3.85,5.01L2.28,3.43l1.24-1.24L5.09,3.77z"></path><path class="a6" d="M14.18,14.19c3.31-3.31,3.31-8.67,0-11.97C13.06,1.1,11.7,0.36,10.26,0c2.2,2.88,1.98,7.01-0.65,9.65
	C6.99,12.26,2.88,12.49,0,10.33c0.37,1.41,1.1,2.76,2.21,3.87C5.52,17.5,10.88,17.5,14.18,14.19z M7.1,2.48H6.36l0.52,0.52
	L6.55,3.34L6.03,2.81v0.74H5.56V2.81L5.04,3.34L4.71,3.01l0.52-0.52H4.49V2.02h0.74L4.71,1.49l0.33-0.33l0.52,0.52V0.95h0.47v0.74
	l0.52-0.52l0.33,0.33L6.36,2.02H7.1V2.48z M0.94,3.94c0,0.26-0.21,0.47-0.47,0.47S0,4.2,0,3.94s0.21-0.47,0.47-0.47
	S0.94,3.68,0.94,3.94z M3.88,5.66c0,0.29-0.24,0.53-0.53,0.53S2.83,5.95,2.83,5.66c0-0.29,0.24-0.53,0.53-0.53S3.88,5.36,3.88,5.66z
	"></path></svg></button><ul class="i j a7"><li class="q"><a href="/">Home</a></li><li class="q"><a href="/publications/">Publications</a></li><li class="q t"><span class="u">Projects<svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-angle-down" xlink:href="/assets/svg/icons.svg#icon-angle-down"></use></svg></span><ul class="v"><li><a href="/projects/risk-battle-outcomes/">Probability of Winning Battles in Risk</a></li><li><a href="/tag/project-euler/">Project Euler</a></li><li><a href="/projects/bazarbackdoor/">BazarBackdoor Tools</a></li></ul></li><li class="q t r"><span class="u">Reverse Engineering<svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-angle-down" xlink:href="/assets/svg/icons.svg#icon-angle-down"></use></svg></span><ul class="v"><li><a href="/tag/malware-analysis/">Malware Analysis</a></li><li><a href="/projects/solutions-to-crackmes/">Solutions to Crackmes</a></li><li><a href="/projects/solutions-to-practical-reverse-engineering/">Solutions to "Practical Reverse Engineering"</a></li></ul></li></ul><div class="f a8 a9"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-bars" xlink:href="/assets/svg/icons.svg#icon-bars"></use></svg></div></div></nav></header><div class="b8"><noscript>&lt;img src="/assets/img/header/necurs-640.jpeg" class="-minfy-post__title-image"/&gt;</noscript><img alt="cover image for post 'The DGAs of Necurs'" class="lazyload b9" data-src="/assets/img/header/necurs-640.jpeg" data-srcset="/assets/img/header/necurs-640.webp 640w" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMDAiIGhlaWdodD0iMjMzIj48cGF0aCBmaWxsPSIjMzQ0NDRjIiBkPSJNMCAwaDMwMHYyMzNIMHoiLz48ZyBmaWxsLW9wYWNpdHk9Ii41IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSguNiAuNilzY2FsZSgxLjE3MTg4KSI+PGNpcmNsZSBjeD0iMTA5IiBjeT0iMyIgcj0iMjU1Ii8+PGVsbGlwc2UgY3g9IjEzNSIgY3k9IjEwMSIgZmlsbD0iIzQ2YTA5ZSIgcng9IjIxNSIgcnk9IjE5Ii8+PGVsbGlwc2UgY3g9Ijg4IiBjeT0iMTAiIHJ4PSIyNTUiIHJ5PSI3NCIvPjxlbGxpcHNlIGN4PSI4MSIgY3k9IjE3OSIgZmlsbD0iIzAwMDMwMCIgcng9IjIxOCIgcnk9IjU1Ii8+PGVsbGlwc2UgY3g9IjEwNyIgY3k9IjE1MCIgZmlsbD0iIzQ2YjhkOCIgcng9IjMyIiByeT0iNCIvPjxjaXJjbGUgcj0iMSIgdHJhbnNmb3JtPSJtYXRyaXgoLTUuMTY0ODYgMTM5LjU2IC0xMC41NTEwNCAtLjM5MDQ3IDI1MC4zIDExNykiLz48cGF0aCBkPSJNODYgOTJoMjh2MjBIODZ6Ii8+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgeD0iLS41IiB5PSItLjUiIGZpbGw9IiM3MmQ5ZDUiIHRyYW5zZm9ybT0ibWF0cml4KDE3Ljk4OTAzIC42MjgyIC0xLjIyMTQ4IDM0Ljk3ODY4IDQ2IDEwMikiLz48cGF0aCBmaWxsPSIjNjhjN2M2IiBkPSJNMTUwIDg0aDQydjIxaC00MnoiLz48ZWxsaXBzZSBjeD0iOTIiIGN5PSIxMzYiIGZpbGw9IiM0NGJkZTMiIHJ4PSIyMCIgcnk9IjQiLz48cGF0aCBmaWxsPSIjMDQwZDBkIiBkPSJNNDcgOTFoMzN2MjJINDd6Ii8+PGVsbGlwc2UgY3g9IjExIiBjeT0iMTA0IiBmaWxsPSIjMDAwMTAwIiByeD0iMTEiIHJ5PSIxOTgiLz48cGF0aCBkPSJNMTMwIDc4aDIwdjM0aC0yMHoiLz48cGF0aCBmaWxsPSIjYTBmZmZmIiBkPSJNMzkgOTloMjZ2N0gzOXoiLz48Y2lyY2xlIHI9IjEiIGZpbGw9IiMwMDE0MTgiIHRyYW5zZm9ybT0ibWF0cml4KC0xLjI3NzYgNzcuMDc3MTggLTMuNTU4NDQgLS4wNTg5OCAxNjAuNCAxMDEuNykiLz48cGF0aCBmaWxsPSIjYTZmZmZmIiBkPSJNODcgODRoMjd2N0g4N3oiLz48cGF0aCBmaWxsPSIjNGJjNmQ3IiBkPSJtMTY1IDcwLjggMjctMS43LTE2LTctMTEuNyAxLjZ6Ii8+PHBhdGggZmlsbD0iI2E4ZmZmZiIgZD0iTTg3IDExM2gyOXY2SDg3eiIvPjxwYXRoIGZpbGw9IiNhOWZmZmYiIGQ9Ik0yMTQgODRoMjZ2N2gtMjZ6Ii8+PGVsbGlwc2UgY3g9IjIxOSIgY3k9IjExNSIgZmlsbD0iI2E5ZmZmZiIgcng9IjE0IiByeT0iNCIvPjxwYXRoIGZpbGw9IiNhZmYiIGQ9Im0xMjIuOCA4OC44IDYgLjQtMS42IDI0LTYtLjR6Ii8+PHBhdGggZmlsbD0iIzAwMDcwMiIgZD0ibTE5My43IDg3LjctMjkgOS41IDM3LjQgMS4xIDUwLjItNTYuNXoiLz48cGF0aCBmaWxsPSIjOTZmZmZmIiBkPSJNMjMgODhoNnYzMWgtNnoiLz48cGF0aCBmaWxsPSIjMDAwOTBmIiBkPSJtMTk0LjEgMTI4LjMtMi40LTI4LjUgNTIuMiAxMS45LTc0LjYuNXoiLz48cGF0aCBmaWxsPSIjYTJmZmZmIiBkPSJNMTI5IDExMmgyMHY3aC0yMHoiLz48cGF0aCBmaWxsPSIjOTdmZmZmIiBkPSJNMTY0IDg0aDZ2MzVoLTZ6Ii8+PHBhdGggZmlsbD0iIzhmZiIgZD0iTTQwIDExMmgzMnY2SDQweiIvPjxwYXRoIGZpbGw9IiM5MmZmZmYiIGQ9Ik01MSA4NWgyMXY3SDUxeiIvPjxwYXRoIGZpbGw9IiM5NmZmZmYiIGQ9Im0yMTQgMTAxIDIzLTUtNyA3eiIvPjxlbGxpcHNlIGN4PSIyMjgiIGN5PSI5NSIgcng9IjE3IiByeT0iNCIvPjwvZz48L3N2Zz4="></div><main class="y aa"><article class="z ae ac ba"><div class="bb"><h1 class="bc">The DGAs of Necurs</h1></div><div class="bd"><ul class="i be"><li><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-calendar-o" xlink:href="/assets/svg/icons.svg#icon-calendar-o"></use></svg> <a href="https://bin.re/2015/02">February 20, 2015</a></li><li><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-book" xlink:href="/assets/svg/icons.svg#icon-book"></use></svg> <a href="/category/reverse-engineering">reverse engineering</a></li><li><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-tags" xlink:href="/assets/svg/icons.svg#icon-tags"></use></svg> <span class="bf"><a href="/tag/dga" class="bg">dga</a> <a href="/tag/malware-analysis" class="bg">malware analysis</a></span></li><li><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-comments-o" xlink:href="/assets/svg/icons.svg#icon-comments-o"></use></svg> <a href="#comments">1 comment</a></li></ul><div class="bh"><span class="bj">Table of Contents</span><ul class="i bk"><li><a href="#the-first-dga">The First DGA</a></li><li><a href="#connectivity-checks">Connectivity Checks</a></li><li><a href="#dga-caller">DGA Caller</a></li><li><a href="#the-heart-of-the-first-dga">The Heart of the First DGA</a></li><li><a href="#pseudorandom-number-generator">Pseudorandom Number Generator</a></li><li><a href="#comparison-with-facebook%27s-or-microsoft%27s-ip">Comparison with Facebook's or Microsoft's IP</a></li><li><a href="#summary">Summary</a></li><li><a href="#the-second-dga">The Second DGA</a></li><li><a href="#the-third-dga">The Third DGA</a></li><li><a href="#sequence-numbers">Sequence Numbers</a></li><li><a href="#dga-caller">DGA Caller</a></li><li><a href="#the-dga">The DGA</a></li><li><a href="#summary">Summary</a></li></ul><div><span class="bj">DGArchive</span><p>The DGA in this blog post has been implemented by the <a href="https://dgarchive.caad.fkie.fraunhofer.de/" class="bm">DGArchive</a> project.</p></div><div><span class="bj">Malpedia</span><p>For more information about the malware in this blog post see the <a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.necurs" class="bm">Malpedia entry on Necurs</a>.</p></div></div></div><div class="b6 bi"><p>Necurs is a malware that opens a backdoor on infected systems, see <a href="http://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/3133/necurs-the-malware-that-breaks-your-security">NECURS: The Malware That Breaks Your Security</a>. A broad analysis of the malware can be found in the three part series <a href="https://www.virusbtn.com/virusbulletin/archive/2014/04/vb201404-Necurs">The Curse of Necurs</a> by Peter Ferrie.</p><p>This post focuses exclusively on the network traffic of Necurs, in particular the used domains. Necurs features three different sets of hostnames that serve different purposes. Although all three sets reek of domain generation algorithm (DGA), only the first and last set are actually generated algorithmically. The following example traffic shows the different stages of the callback attempts with number 3, 4 and 6 marking the three malicious domains batches:</p><pre><code>1.----  13:09:39.635819000  facebook.com

    +-  13:09:39.638039000  0.pool.ntp.org
2.--|   13:09:39.998526000  1.pool.ntp.org
    +-  13:09:40.020627000  2.pool.ntp.org

    +-  13:09:40.027471000  sxotmrxwhddr.com
    |   13:09:40.028494000  btysiiquuc.com
3.--|   13:09:40.032591000  kfncxvayakmb.com
    +-  13:09:40.033539000  vmslcvvocseu.com

    +-  13:09:40.688199000  qcmbartuop.bit
    |   13:09:41.699491000  qcmbartuop.bit
4.--|   13:09:42.716128000  qcmbartuop.bit
    |   (... 16 times total)
    +-  13:16:32.364351000  qcmbartuop.bit

5.----  13:16:49.187559000  facebook.com

    +-  13:16:49.516477000  boymlujtgp.nu
    |   13:16:49.520651000  ybynentfsjvmsgtktcoog.im
    |   13:16:49.527701000  oiijxplrnmvgskxwaye.ru
6.--|   13:16:49.529669000  imgirmyddbsniuh.pw
    |   13:16:49.834913000  ultrttvbvjaanrj.jp
    |   (... 2048 total)
    +-  13:18:03.607552000  porgtemsbycy.ki
</code></pre><p>The following list gives a brief summary of the source and purpose of the domains. See the respective section for an in-depth analysis of the three DGA sets.</p><ol><li>Necurs starts by checking internet connectivity by resolving <em>facebook.com</em> or <em>microsoft.com</em>.</li><li>The malware then contacts three NTP pools to get the accurate date and time.</li><li>Next, four DGA domains are generated by the <a href="#the-first-dga"><strong>first dga</strong></a> with top level domain <em>.com</em>. The domains are unpredictable and can therefore not be sinkholed or used to identify Necurs samples when taken in isolation. The purpose of the domains is to detect simulated internet in lab environments</li><li>If the lab detection test passes, Necurs will try sixteen domains from a hard-coded list of pseudo-DGA domains, see <a href="#the-second-dga"><strong>second dga</strong></a>. Necurs will reuse domains if the list contains less than 16 domains. The analysed sample, for example, only has one hard-coded domain which will therefore be repeated 16 times. Necurs sleeps between 1 and 20 seconds after each failed connection attempt, which mounts up to about 5 minutes before the malware moves on to the next stage. The hard-coded domains are probably the main C&amp;C domains.</li><li>Another connectivity check to <em>facebook.com</em> or <em>microsoft.com</em> is made before Necurs resorts to the last DGA.</li><li>The <a href="#the-third-dga"><strong>third dga</strong></a> finally checks up to 2048 different domains. One special feature is the large list of 43 different top level domains, some of which are quite exotic. The DGA is time-dependent — the domains change every four days. The DGA is probably a backup in case the set of hard-coded domains no longer work.</li></ol><h2 id="the-first-dga">The First DGA</h2><h3 id="connectivity-checks">Connectivity Checks</h3><p>Necurs makes a connectivity check to either <em>facebook.com</em> or <em>microsoft.com</em> before the first set of DGA domains are tested:</p><p><noscript>&lt;img src="assets/conn_check.png" class=""/&gt;</noscript><img alt="connectivity check" class="lazyload" data-src="assets/conn_check.png" data-srcset="assets/conn_check-1x.webp 580w" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1ODAiIGhlaWdodD0iNjI1IiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjojTmFOTmFOTmFOIj48L3N2Zz4=" sizes="(max-width: 580px) 100vw, 580px"></p><p>The routine <code>random_int(0,1)</code> returns 0 or 1 (the implementation of <code>random_int</code> is discussed below). The malware aborts the callback attempt if it can’t resolve and contact the domain of Facebook or Microsoft as the case may be.</p><h3 id="dga-caller">DGA Caller</h3><p>Necurs then launches four threads that attempt to resolve domains generated by the first DGA:</p><p><noscript>&lt;img src="assets/dga1_loop.png" class=""/&gt;</noscript><img alt="dga1 loop" class="lazyload" data-src="assets/dga1_loop.png" data-srcset="assets/dga1_loop-1x.webp 537w" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MzciIGhlaWdodD0iNTk4IiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjojTmFOTmFOTmFOIj48L3N2Zz4=" sizes="(max-width: 537px) 100vw, 537px"></p><p>There is no delay between creating the threads, the four DNS queries happen at around the same time.</p><h3 id="the-heart-of-the-first-dga">The Heart of the First DGA</h3><p>Let’s see how the domains are generated by <code>dga1</code>:</p><p><noscript>&lt;img src="assets/dga1.jpg" class=""/&gt;</noscript><img alt="dga1" class="lazyload" data-src="assets/dga1.jpg" data-srcset="assets/dga1-1x.webp 486w" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0ODYiIGhlaWdodD0iMTc1OSIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6I05hTk5hTk5hTiI+PC9zdmc+" sizes="(max-width: 486px) 100vw, 486px"></p><p>This very simple algorithm first randomly determines the length of the second level domain to be between 10 and 15 characters. It then builds the domain by picking uniformly at random from all lowercase letters and appending the hard-coded top level domain <em>.com</em>. The DGA concludes with querying the resulting domain; the resolved IP, if there is any, is appended to the array <code>dga1_ips</code>.</p><h3 id="pseudorandom-number-generator">Pseudorandom Number Generator</h3><p>The connectivity check, as well as <code>dga1</code>, use <code>random_int</code> to generate random integers. The disassembly of this routine is:</p><p><noscript>&lt;img src="assets/random_int.png" class=""/&gt;</noscript><img alt="random_int" class="lazyload" data-src="assets/random_int.png" data-srcset="assets/random_int-1x.webp 622w" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MjIiIGhlaWdodD0iNzE0IiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjojTmFOTmFOTmFOIj48L3N2Zz4=" sizes="(max-width: 622px) 100vw, 622px"></p><p>This is just a mapping of the return value of <code>random_mwc</code> to the desired range:</p><pre><code>function random_int(lower, upper)
    if lower &gt; upper then
        return 0
    else
        return lower + random_mwc % (upper - lower + 1)
</code></pre><p>The routine <code>random_mwc</code> is an almost standard implementation of a lag-3 <a href="http://en.wikipedia.org/wiki/Multiply-with-carry">multiply-with-carry pseudorandom number generator</a> invented by George Marsaglia:</p><p><noscript>&lt;img src="assets/mwc.png" class=""/&gt;</noscript><img alt="mwc" class="lazyload" data-src="assets/mwc.png" data-srcset="assets/mwc-1x.webp 299w" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyOTkiIGhlaWdodD0iNTIyIiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjojTmFOTmFOTmFOIj48L3N2Zz4=" sizes="(max-width: 299px) 100vw, 299px"></p><p>The only difference is the addition of an <code>rdtsc</code> summand, which will add the current <a href="http://en.wikipedia.org/wiki/Time_Stamp_Counter">time stamp counter</a> to all generated numbers (not just the initial seed). The initial seed values and initial carry are:</p><pre><code>0040F048 rng3            dq  77465321
0040F04C c               dd     13579 
0040F050 rng2            dd 362436069    
0040F054 rng1            dd 123456789  
</code></pre><p>The choice of these values is <a href="https://github.com/afgaungoo/Facebull/blob/master/Import/Import/Initialise%20Network.cpp">pretty common</a>. Necurs never changed these values in its long existence according to the aforementioned article <a href="https://www.virusbtn.com/virusbulletin/archive/2014/04/vb201404-Necurs">“the curse of Necurs”</a>. This is the PRNG <code>random_mwc</code> in pseudo-code is:</p><pre><code>b = 2^(32)
a = 916905990
// Initial seeds and carry
rng1 = 123456789 
rng2 = 362436069
rng3 = 77465321
c = 13579

function random_mwc()
    t = a*rng1 + rdtsc() + c
    rng1 = rng2;
    rng2 = rng3;
    rng3 = t;
    c = (t // b) % b 
    return v1;
</code></pre><p>The addition of <code>rdtsc</code> makes this random number generator, and therefore also the first domain generation algorithm, virtually impossible to predict.</p><h3 id="comparison-with-facebooks-or-microsofts-ip">Comparison with Facebook’s or Microsoft’s IP</h3><p>Although the domains of <code>dga1</code> are unusable as callback targets, they still serve a purpose: If one of the DGA IPs matches the one of Facebook or Microsoft (resolved during connectivity checking), Necurs will abort the callback attempt:</p><p><noscript>&lt;img src="assets/inetsim_detect1.png" class=""/&gt;</noscript><img alt="" class="lazyload" data-src="assets/inetsim_detect1.png" data-srcset="assets/inetsim_detect1-1x.webp 786w,
assets/inetsim_detect1-640.webp 640w" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3ODYiIGhlaWdodD0iMjAyIiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjojTmFOTmFOTmFOIj48L3N2Zz4=" sizes="(max-width: 786px) 100vw, 786px"></p><p>The excessively long named routine <code>ip_of_mic_or_fac_equal_to_dga1_ips</code> compares the IP of Microsoft or Facebook to the IPs of <code>dga1</code> stored in array <code>dga1_ips</code>:</p><p><noscript>&lt;img src="assets/inetsim_detect2.png" class=""/&gt;</noscript><img alt="" class="lazyload" data-src="assets/inetsim_detect2.png" data-srcset="assets/inetsim_detect2-1x.webp 789w,
assets/inetsim_detect2-640.webp 640w" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3ODkiIGhlaWdodD0iNjk0IiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjojTmFOTmFOTmFOIj48L3N2Zz4=" sizes="(max-width: 789px) 100vw, 789px"></p><p>I suspect that Necurs tries to detect simulated internet services this way. Simulated Internet will typically return the same IP for all requested domains. The 4 DGA domains, however, are unpredictable and therefore non-existent. And even if the victim’s ISP uses DNS hijacking, the returned IPs will not match Facebook’s or Microsoft’s IP.</p><h3 id="summary">Summary</h3><p>The first DGA of Necurs generates four <em>.com</em> domains of 10 to 15 lower case letters. It tries to resolve all four domains in parallel. The modified MWC-PRNG makes the domains unusable as callback targets; instead they are probably used to detect simulated internet connections in a lab environment.</p><h2 id="the-second-dga">The Second DGA</h2><p>Necurs will continue without break with the second set of DGA domains in case the lab detection passed. The second set of DGA-like domains, for example <em>qcmbartuop.bit</em>, are not generated algorithmically but hard-coded. The following loop fetches 16 of those hard-coded domains and tries to contact them:</p><p><noscript>&lt;img src="assets/dga2_loop.png" class=""/&gt;</noscript><img alt="dga2 loop" class="lazyload" data-src="assets/dga2_loop.png" data-srcset="assets/dga2_loop-1x.webp 503w" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MDMiIGhlaWdodD0iOTA1IiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjojTmFOTmFOTmFOIj48L3N2Zz4=" sizes="(max-width: 503px) 100vw, 503px"></p><p>Necurs sleeps 1 to 20 seconds after each failed attempt, which sums up to a average total sleep time of about 5 minutes for all 16 attempts.</p><p>The relevant snippet of <code>get_hard-coded_domain</code> is:</p><p><noscript>&lt;img src="assets/dga2.png" class=""/&gt;</noscript><img alt="" class="lazyload" data-src="assets/dga2.png" data-srcset="assets/dga2-1x.webp 455w" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NTUiIGhlaWdodD0iMTYwIiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjojTmFOTmFOTmFOIj48L3N2Zz4=" sizes="(max-width: 455px) 100vw, 455px"></p><p>This returns the hard-coded domains one after another, starting over with the first domain if necessary.</p><p>From what I could gather from other reports, the hard-coded domains seem to mostly use the special <a href="http://en.wikipedia.org/wiki/.bit"><em>.bit</em> pseudo top level domain</a> served by the namecoin project. The domains are probably Necurs` main C&amp;C targets.</p><h2 id="the-third-dga">The Third DGA</h2><p>If the second set of domains also fails to produce a working C&amp;C server, Necurs tries one last set of domains.</p><h3 id="sequence-numbers">Sequence Numbers</h3><p>The third DGA starts by creating an array of 2048 sequence numbers 0 to 2047; these sequence numbers are then randomly permutated:</p><p><noscript>&lt;img src="assets/sequence_numbers.png" class=""/&gt;</noscript><img alt="" class="lazyload" data-src="assets/sequence_numbers.png" data-srcset="assets/sequence_numbers-1x.webp 791w,
assets/sequence_numbers-640.webp 640w" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3OTEiIGhlaWdodD0iODkwIiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjojTmFOTmFOTmFOIj48L3N2Zz4=" sizes="(max-width: 791px) 100vw, 791px"></p><p>The permutation routine randomizes the sequence numbers in place with the following algorithm:</p><pre><code>n = A.length
for i = 1 to n
    swap A[i] with A[Random(1,n)]
</code></pre><p>Although this randomizes the sequence numbers, it does not do it uniformly. A better implementation would call <code>Random(i,n)</code> instead of <code>Random(1,n)</code>, see for instance exercise 5.3-3 on page 129 of <a href="http://www.amazon.com/Introduction-Algorithms-3rd-Thomas-Cormen/dp/0262033844/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1424430552&amp;sr=1-1&amp;keywords=introduction+to+algorithms+third+edition">“Introduction to Algorithms”, 3rd edition</a>. Nevertheless, the sequence numbers are still random and unpredictable because of the call to <code>random_mwc</code> which includes the current tick count <a href="#pseudorandom-number-generator">see section above</a>.</p><h3 id="dga-caller-1">DGA Caller</h3><p>After the sequence numbers have been randomized, Necurs starts up 16 threads, each with 128 of the sequence numbers (referenced by <code>ecx</code>, indexed by <code>edi</code>):</p><p><noscript>&lt;img src="assets/dga3_loop.jpg" class=""/&gt;</noscript><img alt="" class="lazyload" data-src="assets/dga3_loop.jpg" data-srcset="assets/dga3_loop-1x.webp 751w" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3NTEiIGhlaWdodD0iNzM5IiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjojTmFOTmFOTmFOIj48L3N2Zz4=" sizes="(max-width: 751px) 100vw, 751px"></p><p>Each thread will call the routine to generates the domains for all 128 sequence numbers it got assigned to (unless a callback is successful beforehand):</p><p><noscript>&lt;img src="assets/dga3_call.png" class=""/&gt;</noscript><img alt="" class="lazyload" data-src="assets/dga3_call.png" data-srcset="assets/dga3_call-1x.webp 471w" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NzEiIGhlaWdodD0iMTgyIiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjojTmFOTmFOTmFOIj48L3N2Zz4=" sizes="(max-width: 471px) 100vw, 471px"></p><p><noscript>&lt;img src="assets/dga3_how_many.png" class=""/&gt;</noscript><img alt="" class="lazyload" data-src="assets/dga3_how_many.png" data-srcset="assets/dga3_how_many-1x.webp 577w" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NzciIGhlaWdodD0iMTI5IiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjojTmFOTmFOTmFOIj48L3N2Zz4=" sizes="(max-width: 577px) 100vw, 577px"></p><h3 id="the-dga">The DGA</h3><p>At the heart of the third DGA we find this long, but easy to understand algorithm:</p><p><noscript>&lt;img src="assets/dga3.jpg" class=""/&gt;</noscript><img alt="dga3" class="lazyload" data-src="assets/dga3.jpg" data-srcset="assets/dga3-1x.webp 864w,
assets/dga3-640.webp 640w" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NjQiIGhlaWdodD0iMzU4MSIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6I05hTk5hTk5hTiI+PC9zdmc+" sizes="(max-width: 864px) 100vw, 864px"></p><p>The first call to the routine fetches a hard-coded magic number from a rather complicated linked list and saves it as <code>magic_number</code>. For my sample, the hard-coded seed was 9.</p><p>Necurs then determines a length between 7 and 21 letters with multiple calls to <code>pseudo_random</code>, using the current date, the sequence number and the magic number as seeds. This will lead to a new set of domains every four days:</p><pre><code>    n = pseudo_random(date.year)
    n = pseudo_random(n + date.month + 43690)
    n = pseudo_random(n + (date.day&gt;&gt;2))
    n = pseudo_random(n + sequence_nr)
    n = pseudo_random(n + magic_nr)
    domain_length = mod64(n, 15) + 7
</code></pre><p>Next, Necurs picks the characters of the second level domain from from ‘a’ to ‘y’ (‘z’ is unreachable like for <a href="https://bin.re/blog/the-dga-of-ramnit/">Ramnit</a>):</p><pre><code>    domain = ""
    for i in range(domain_length):
        n = pseudo_random(n+i) 
        ch = mod64(n, 25) + ord('a') 
        domain += chr(ch)
        n += 0xABBEDF
        n = pseudo_random(n) 
</code></pre><p>Finally, one of 43 top level domains is chosen to finish the domain name:</p><pre><code>    tlds = ['tj','in','jp','tw','ac','cm','la','mn','so','sh','sc','nu','nf','mu',
    'ms','mx','ki','im','cx','cc','tv','bz','me','eu','de','ru','co','su','pw',
    'kz','sx','us','ug','ir','to','ga','com','net','org','biz','xxx','pro','bit']

    tld = tlds[mod64(n, 43)]
    domain += '.' + tld
    return domain
</code></pre><p>All picks are randomized with calls to <code>pseudo_random</code> which is:</p><p><noscript>&lt;img src="assets/pseudo_random.jpg" class=""/&gt;</noscript><img alt="dga3" class="lazyload" data-src="assets/pseudo_random.jpg" data-srcset="assets/pseudo_random-1x.webp 446w" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NDYiIGhlaWdodD0iMTM2NyIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6I05hTk5hTk5hTiI+PC9zdmc+" sizes="(max-width: 446px) 100vw, 446px"></p><p>This routine calculates:</p><pre><code>    def pseudo_random(value):
        loops = (value &amp; 0x7F) + 21
        for index in range(loops):
            value += ((value*7) ^ (value &lt;&lt; 15)) + 8*index - (value &gt;&gt; 5)
            value &amp;= ((1 &lt;&lt; 64) - 1)

        return value
</code></pre><h3 id="summary-1">Summary</h3><p>The third DGA, including the random number generator, boils down to this routine:</p><pre><code>import argparse
from datetime import datetime

def generate_necurs_domain(sequence_nr, magic_nr, date):
    def pseudo_random(value):
        loops = (value &amp; 0x7F) + 21
        for index in range(loops):
            value += ((value*7) ^ (value &lt;&lt; 15)) + 8*index - (value &gt;&gt; 5)
            value &amp;= ((1 &lt;&lt; 64) - 1)

        return value

    def mod64(nr1, nr2):
        return nr1 % nr2

    n = pseudo_random(date.year)
    n = pseudo_random(n + date.month + 43690)
    n = pseudo_random(n + (date.day&gt;&gt;2))
    n = pseudo_random(n + sequence_nr)
    n = pseudo_random(n + magic_nr)
    domain_length = mod64(n, 15) + 7

    domain = ""
    for i in range(domain_length):
        n = pseudo_random(n+i) 
        ch = mod64(n, 25) + ord('a') 
        domain += chr(ch)
        n += 0xABBEDF
        n = pseudo_random(n) 

    tlds = ['tj','in','jp','tw','ac','cm','la','mn','so','sh','sc','nu','nf','mu',
    'ms','mx','ki','im','cx','cc','tv','bz','me','eu','de','ru','co','su','pw',
    'kz','sx','us','ug','ir','to','ga','com','net','org','biz','xxx','pro','bit']

    tld = tlds[mod64(n, 43)]
    domain += '.' + tld
    return domain

if __name__=="__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument("-d", "--date", help="as YYYY-mm-dd")
    args = parser.parse_args()
    date_str = args.date
    if date_str:
        date = datetime.strptime(date_str, "%Y-%m-%d")
    else:
        date = datetime.now() 

    for sequence_nr in range(2048):
        print(generate_necurs_domain(sequence_nr, 9, date))
</code></pre><p>The characteristics of this DGA are:</p><table><thead><tr><th>property</th><th>value</th></tr></thead><tbody><tr><td>seed</td><td>magic number and current date (changing domains every four days)</td></tr><tr><td>domains per seed</td><td>2048</td></tr><tr><td>sequence</td><td>randomized (unpredictable, albeit not uniformly random)</td></tr><tr><td>wait time between domains</td><td>none, 16 parallel threads</td></tr><tr><td>top level domain</td><td>43 different tld, picked randomly</td></tr><tr><td>second level characters</td><td>lower case letters except ‘z’</td></tr><tr><td>second level domain length</td><td>7 to 21 letters</td></tr></tbody></table><p>The DGA likely serves as a fallback in case the hard-coded domains fail.</p><h2 id="comments">Archived Comments</h2><div><p><i><strong>Note: </strong>I removed the Disqus integration in an effort to cut down on bloat. The following comments were retrieved with the export functionality of Disqus. If you have comments, please reach out to me by Twitter or email.</i></p></div><div class="bt"><div class="thread"><div class="comment"><span class="author">Anon</span> <span class="date">Feb 25, 2015 14:50:36 UTC</span><div class="message"><p>Excellent clear analysis. Thanks for the code at the end too, it makes finding evidence of Necurs much easier.</p></div></div></div></div></div></article></main><footer><div><div class="y"><div class="z ae aj"><div class="ag ak al am"><h3>Links</h3><ul class="i an"><li><a href="http://www.twitter.com/viql" rel="me"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-twitter" xlink:href="/assets/svg/icons.svg#icon-twitter"></use></svg> Twitter</a></li><li><a href="http://www.github.com/baderj" rel="me"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-github" xlink:href="/assets/svg/icons.svg#icon-github"></use></svg> GitHub</a></li><li><a href="mailto:hello@bin.re" rel="me"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-envelope-o" xlink:href="/assets/svg/icons.svg#icon-envelope-o"></use></svg> Mail</a></li><li><a href="https://keybase.io/baderj" rel="me"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-keybase" xlink:href="/assets/svg/icons.svg#icon-keybase"></use></svg> Keybase</a></li><li><a href="/feed.xml" rel="me"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-feed" xlink:href="/assets/svg/icons.svg#icon-feed"></use></svg> RSS</a></li><li><a href="https://threatcat.ch" rel="me"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-threatcat" xlink:href="/assets/svg/icons.svg#icon-threatcat"></use></svg> Threatcat.ch</a></li><li><a href="https://infosec.exchange/@viql" rel="me"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-mastodon" xlink:href="/assets/svg/icons.svg#icon-mastodon"></use></svg> Mastodon</a></li><li><a href="https://rosti.bin.re" rel="me"><svg viewBox="0 0 35 32" class="g"><use href="/assets/svg/icons.svg#icon-rosti" xlink:href="/assets/svg/icons.svg#icon-rosti"></use></svg> Rösti</a></li></ul></div><div class="ag ak al am"><div><h3>Categories</h3><ul class="i"><li><a href="/category/reverse-engineering">reverse-engineering</a> <span class="ao">(81)</span></li><li><a href="/category/tutorial">tutorial</a> <span class="ao">(14)</span></li><li><a href="/category/project-euler">project-euler</a> <span class="ao">(13)</span></li><li><a href="/category/misc">misc</a> <span class="ao">(2)</span></li><li><a href="/category/visualization">visualization</a> <span class="ao">(2)</span></li></ul></div></div><div class="ag ak al am a7"><div><h3>Tags</h3><span class="ap"><a href="/tag/malware-analysis" class="aq">malware-analysis <span class="ao">(42)</span></a><a href="/tag/dga" class="aq">dga <span class="ao">(36)</span></a><a href="/tag/crackmes" class="aq">crackmes <span class="ao">(23)</span></a><a href="/tag/practical-reverse-engineering" class="aq">practical-reverse-engineering <span class="ao">(16)</span></a><a href="/tag/math" class="aq">math <span class="ao">(15)</span></a><a href="/tag/project-euler" class="aq">project-euler <span class="ao">(13)</span></a><a href="/tag/python" class="aq">python <span class="ao">(12)</span></a><a href="/tag/upatre" class="aq">upatre <span class="ao">(4)</span></a><a href="/tag/visualization" class="aq">visualization <span class="ao">(4)</span></a><a href="/tag/d3js" class="aq">d3js <span class="ao">(3)</span></a></span> <a href="/tag/" class="ar">show all</a></div></div><div class="ag ak al am as"><div class="at"><div><h3>Blog Archive</h3><span class="au"><a href="/2013">2013</a><span class="ao">(20)</span></span> <span class="au"><a href="/2014">2014</a><span class="ao">(46)</span></span> <span class="au"><a href="/2015">2015</a><span class="ao">(24)</span></span> <span class="au"><a href="/2016">2016</a><span class="ao">(6)</span></span> <span class="au"><a href="/2018">2018</a><span class="ao">(1)</span></span> <span class="au"><a href="/2019">2019</a><span class="ao">(2)</span></span> <span class="au"><a href="/2020">2020</a><span class="ao">(5)</span></span> <span class="au"><a href="/2021">2021</a><span class="ao">(3)</span></span> <span class="au"><a href="/2022">2022</a><span class="ao">(3)</span></span> <span class="au"><a href="/2023">2023</a><span class="ao">(2)</span></span></div></div></div></div></div><div class="y av"><div class="z"><div class="ag"><p>© 2012 - 2024 Johannes Bader, last updated March 27, 2024</p></div></div></div></div></footer></div></div></body></html>