<!doctype html><html lang="en"><head><title data-rh="true">Polyglot Files: a Hacker’s best friend | by Vickie Li | The Startup | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2019-10-03T11:36:37.881Z"/><meta data-rh="true" name="title" content="Polyglot Files: a Hacker’s best friend | by Vickie Li | The Startup | Medium"/><meta data-rh="true" property="og:title" content="Polyglot Files: a Hacker’s best friend"/><meta data-rh="true" property="al:android:url" content="medium://p/850bf812dd8a"/><meta data-rh="true" property="al:ios:url" content="medium://p/850bf812dd8a"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="Hello! Thanks for clicking on this blog post. Today, we’re gonna talk about a topic that has always fascinated me in the cybersecurity world: polyglot files! We’re going to take a look at what they…"/><meta data-rh="true" property="og:description" content="And how to hide PHP code in JPEG files"/><meta data-rh="true" property="og:url" content="https://medium.com/swlh/polyglot-files-a-hackers-best-friend-850bf812dd8a"/><meta data-rh="true" property="al:web:url" content="https://medium.com/swlh/polyglot-files-a-hackers-best-friend-850bf812dd8a"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/da:true/resize:fit:1200/0*62JsCxm-CAqQTkwF"/><meta data-rh="true" property="article:author" content="https://vickieli.medium.com"/><meta data-rh="true" name="author" content="Vickie Li"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Polyglot Files: a Hacker’s best friend"/><meta data-rh="true" name="twitter:site" content="@GrowthSupply"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/850bf812dd8a"/><meta data-rh="true" property="twitter:description" content="And how to hide PHP code in JPEG files"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/da:true/resize:fit:1200/0*62JsCxm-CAqQTkwF"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:creator" content="@vickieli7"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="5 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://vickieli.medium.com"/><link data-rh="true" rel="canonical" href="https://medium.com/swlh/polyglot-files-a-hackers-best-friend-850bf812dd8a"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/850bf812dd8a"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fda:true\u002Fresize:fit:1200\u002F0*62JsCxm-CAqQTkwF"],"url":"https:\u002F\u002Fmedium.com\u002Fswlh\u002Fpolyglot-files-a-hackers-best-friend-850bf812dd8a","dateCreated":"2019-10-02T22:22:55.931Z","datePublished":"2019-10-02T22:22:55.931Z","dateModified":"2023-10-28T14:54:14.074Z","headline":"Polyglot Files: a Hacker’s best friend - The Startup - Medium","name":"Polyglot Files: a Hacker’s best friend - The Startup - Medium","description":"Hello! Thanks for clicking on this blog post. Today, we’re gonna talk about a topic that has always fascinated me in the cybersecurity world: polyglot files! We’re going to take a look at what they…","identifier":"850bf812dd8a","author":{"@type":"Person","name":"Vickie Li","url":"https:\u002F\u002Fvickieli.medium.com"},"creator":["Vickie Li"],"publisher":{"@type":"Organization","name":"The Startup","url":"https:\u002F\u002Fmedium.com\u002Fswlh","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002Fswlh\u002Fpolyglot-files-a-hackers-best-friend-850bf812dd8a"}</script><style type="text/css" data-fela-rehydration="574" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="574" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:rgba(132, 133, 133, 1)}.es{border-color:rgba(132, 133, 133, 1)}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:rgba(132, 133, 133, 1)}.ez:disabled:hover{border-color:rgba(132, 133, 133, 1)}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-family:fell, Georgia, Cambria, "Times New Roman", Times, serif}.hq{margin-bottom:-0.27em}.hr{line-height:1.394}.im{align-items:baseline}.in{width:48px}.io{height:48px}.ip{border:2px solid rgba(255, 255, 255, 1)}.iq{z-index:0}.ir{box-shadow:none}.is{border:1px solid rgba(0, 0, 0, 0.05)}.it{margin-left:-12px}.iu{width:28px}.iv{height:28px}.iw{z-index:1}.ix{width:24px}.iy{margin-bottom:2px}.iz{flex-wrap:nowrap}.ja{font-size:16px}.jb{line-height:24px}.jd{margin:0 8px}.je{display:inline}.jf{color:rgba(132, 133, 133, 1)}.jg{fill:rgba(132, 133, 133, 1)}.jj{flex:0 0 auto}.jm{flex-wrap:wrap}.jp{white-space:pre-wrap}.jq{margin-right:4px}.jr{overflow:hidden}.js{max-height:20px}.jt{text-overflow:ellipsis}.ju{display:-webkit-box}.jv{-webkit-line-clamp:1}.jw{-webkit-box-orient:vertical}.jx{word-break:break-all}.jz{padding-left:8px}.ka{padding-right:8px}.lb> *{flex-shrink:0}.lc{overflow-x:scroll}.ld::-webkit-scrollbar{display:none}.le{scrollbar-width:none}.lf{-ms-overflow-style:none}.lg{width:74px}.lh{flex-direction:row}.li{z-index:2}.ll{-webkit-user-select:none}.lm{border:0}.ln{fill:rgba(117, 117, 117, 1)}.lq{outline:0}.lr{user-select:none}.ls> svg{pointer-events:none}.mb{cursor:progress}.mc{opacity:1}.md{padding:4px 0}.mg{margin-top:0px}.mh{width:16px}.mj{display:inline-flex}.mp{max-width:100%}.mq{padding:8px 2px}.mr svg{color:#6B6B6B}.ni{clear:both}.no{margin-left:auto}.np{margin-right:auto}.nq{max-width:6000px}.nw{padding-top:5px}.nx{padding-bottom:5px}.nz{cursor:zoom-in}.oa{z-index:auto}.oc{height:auto}.od{margin-top:10px}.oe{max-width:728px}.oh{text-decoration:underline}.oi{line-height:1.58}.oj{letter-spacing:-0.004em}.ok{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.pd{margin-bottom:-0.46em}.pe{line-height:1.12}.pf{letter-spacing:-0.022em}.pg{font-weight:600}.pz{margin-bottom:-0.28em}.qk{box-shadow:inset 0 0 0 1px #F2F2F2}.ql{padding:0px}.qm{padding:16px 20px}.qn{flex:1 1 auto}.qp{max-height:40px}.qq{-webkit-line-clamp:2}.qr{margin-top:8px}.qs{margin-top:12px}.qt{width:160px}.qu{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*FxgLGrex8oX1nmJg)}.qv{background-origin:border-box}.qw{background-size:cover}.qx{height:167px}.qy{background-position:50% 50%}.qz{line-height:1.18}.rn{margin-bottom:-0.31em}.ro{list-style-type:disc}.rp{margin-left:30px}.rq{padding-left:0px}.rr{font-weight:700}.rx{overflow-x:auto}.ry{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.rz{padding:20px}.sa{border-radius:0}.sb{background:#F2F2F2}.sc{margin-top:-0.09em}.sd{margin-bottom:-0.09em}.se{min-width:fit-content}.sf{padding:2px 4px}.sg{font-size:75%}.sh> strong{font-family:inherit}.si{list-style-type:decimal}.sj{margin-top:32px}.sk{margin-bottom:14px}.sl{padding-top:24px}.sm{padding-bottom:10px}.sn{background-color:#000000}.so{height:3px}.sp{width:3px}.sq{margin-right:20px}.sr{margin-bottom:26px}.ss{margin-top:6px}.st{margin-right:8px}.su{padding:8px 16px}.sv{border-radius:100px}.sw{transition:background 300ms ease}.sy{white-space:nowrap}.sz{border-top:none}.tf{height:52px}.tg{max-height:52px}.th{box-sizing:content-box}.ti{position:static}.tk{max-width:155px}.tv{align-items:flex-end}.tw{width:76px}.tx{height:76px}.ty{border:2px solid #F9F9F9}.tz{height:72px}.ua{width:72px}.ub{margin-left:-16px}.uc{width:36px}.ud{height:36px}.ue{stroke:#F2F2F2}.uf{color:#F2F2F2}.ug{fill:#F2F2F2}.uh{border-color:#F2F2F2}.un{font-weight:500}.uo{font-size:24px}.up{line-height:30px}.uq{letter-spacing:-0.016em}.ur{margin-top:16px}.us{height:0px}.ut{border-bottom:solid 1px #E5E5E5}.uz{margin-top:72px}.va{padding:24px 0}.vb{margin-bottom:0px}.vc{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:rgba(113, 114, 114, 1)}.eu:hover{border-color:rgba(113, 114, 114, 1)}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.jc:hover{text-decoration:underline}.jh:hover:not(:disabled){color:rgba(113, 114, 114, 1)}.ji:hover:not(:disabled){fill:rgba(113, 114, 114, 1)}.lp:hover{fill:rgba(8, 8, 8, 1)}.me:hover{fill:#000000}.mf:hover p{color:#000000}.mi:hover{color:#000000}.ms:hover svg{color:#000000}.sx:hover{background-color:#F2F2F2}.ui:hover{background:#F2F2F2}.uj:hover{border-color:#F2F2F2}.uk:hover{cursor:wait}.ul:hover{color:#F2F2F2}.um:hover{fill:#F2F2F2}.bd:focus-within path{fill:#242424}.lo:focus{fill:rgba(8, 8, 8, 1)}.mt:focus svg{color:#000000}.ob:focus{transform:scale(1.01)}.lt:active{border-style:none}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hm{font-size:42px}.hn{margin-top:1.19em}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.ie{font-size:22px}.if{margin-top:0.92em}.ig{line-height:28px}.il{align-items:center}.kn{border-top:solid 1px #F2F2F2}.ko{border-bottom:solid 1px #F2F2F2}.kp{margin:32px 0 0}.kq{padding:3px 8px}.kz> *{margin-right:24px}.la> :last-child{margin-right:0}.ma{margin-top:0px}.mo{margin:0}.nn{max-width:1192px}.nv{margin-top:56px}.oz{font-size:20px}.pa{margin-top:2.14em}.pb{line-height:32px}.pc{letter-spacing:-0.003em}.pv{font-size:24px}.pw{margin-top:1.95em}.px{line-height:30px}.py{letter-spacing:-0.016em}.qe{margin-top:0.94em}.qj{margin-top:32px}.rk{margin-top:1.72em}.rl{line-height:24px}.rm{letter-spacing:0}.rw{margin-top:1.14em}.te{margin-bottom:88px}.tp{display:inline-block}.tu{padding-top:72px}.uy{margin-top:40px}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.lz{margin-top:0px}.of{margin-left:auto}.og{text-align:center}.to{display:inline-block}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.ly{margin-top:0px}.tn{display:inline-block}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lw{margin-top:0px}.lx{margin-right:0px}.qo{padding:10px 12px 10px}.tm{display:inline-block}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{line-height:38px}.gz{letter-spacing:-0.014em}.hs{font-size:18px}.ht{margin-top:0.79em}.hu{line-height:24px}.ih{align-items:flex-start}.jk{flex-direction:column}.jn{margin-bottom:2px}.kb{margin:24px -24px 0}.kc{padding:0}.kr> *{margin-right:8px}.ks> :last-child{margin-right:24px}.lj{margin-left:0px}.lu{margin-top:0px}.lv{margin-right:0px}.mk{margin:0}.mu{border:1px solid #F2F2F2}.mv{border-radius:99em}.mw{padding:0px 16px 0px 12px}.mx{height:38px}.my{align-items:center}.na svg{margin-right:8px}.nj{max-width:100%}.nr{margin-top:40px}.ol{margin-top:1.56em}.om{line-height:28px}.on{letter-spacing:-0.003em}.ph{font-size:20px}.pi{margin-top:1.2em}.pj{letter-spacing:0}.qa{margin-top:0.67em}.qf{margin-top:24px}.ra{font-size:16px}.rb{margin-top:1.23em}.rs{margin-top:1.34em}.ta{margin-bottom:80px}.tl{display:inline-block}.tq{padding-top:48px}.uu{margin-top:32px}.mz:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hi{font-size:42px}.hj{margin-top:1.19em}.hk{line-height:52px}.hl{letter-spacing:-0.011em}.ib{font-size:22px}.ic{margin-top:0.92em}.id{line-height:28px}.ik{align-items:center}.kj{border-top:solid 1px #F2F2F2}.kk{border-bottom:solid 1px #F2F2F2}.kl{margin:32px 0 0}.km{padding:3px 8px}.kx> *{margin-right:24px}.ky> :last-child{margin-right:0}.mn{margin:0}.nm{max-width:1192px}.nu{margin-top:56px}.ov{font-size:20px}.ow{margin-top:2.14em}.ox{line-height:32px}.oy{letter-spacing:-0.003em}.pr{font-size:24px}.ps{margin-top:1.95em}.pt{line-height:30px}.pu{letter-spacing:-0.016em}.qd{margin-top:0.94em}.qi{margin-top:32px}.rh{margin-top:1.72em}.ri{line-height:24px}.rj{letter-spacing:0}.rv{margin-top:1.14em}.td{margin-bottom:88px}.tt{padding-top:72px}.ux{margin-top:40px}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.he{font-size:42px}.hf{margin-top:1.19em}.hg{line-height:52px}.hh{letter-spacing:-0.011em}.hy{font-size:22px}.hz{margin-top:0.92em}.ia{line-height:28px}.ij{align-items:center}.kf{border-top:solid 1px #F2F2F2}.kg{border-bottom:solid 1px #F2F2F2}.kh{margin:32px 0 0}.ki{padding:3px 8px}.kv> *{margin-right:24px}.kw> :last-child{margin-right:0}.mm{margin:0}.nl{max-width:100%}.nt{margin-top:56px}.or{font-size:20px}.os{margin-top:2.14em}.ot{line-height:32px}.ou{letter-spacing:-0.003em}.pn{font-size:24px}.po{margin-top:1.95em}.pp{line-height:30px}.pq{letter-spacing:-0.016em}.qc{margin-top:0.94em}.qh{margin-top:32px}.re{margin-top:1.72em}.rf{line-height:24px}.rg{letter-spacing:0}.ru{margin-top:1.14em}.tc{margin-bottom:88px}.ts{padding-top:72px}.uw{margin-top:40px}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.ha{font-size:32px}.hb{margin-top:1.01em}.hc{line-height:38px}.hd{letter-spacing:-0.014em}.hv{font-size:18px}.hw{margin-top:0.79em}.hx{line-height:24px}.ii{align-items:flex-start}.jl{flex-direction:column}.jo{margin-bottom:2px}.kd{margin:24px 0 0}.ke{padding:0}.kt> *{margin-right:8px}.ku> :last-child{margin-right:8px}.lk{margin-left:0px}.ml{margin:0}.nb{border:1px solid #F2F2F2}.nc{border-radius:99em}.nd{padding:0px 16px 0px 12px}.ne{height:38px}.nf{align-items:center}.nh svg{margin-right:8px}.nk{max-width:100%}.ns{margin-top:40px}.oo{margin-top:1.56em}.op{line-height:28px}.oq{letter-spacing:-0.003em}.pk{font-size:20px}.pl{margin-top:1.2em}.pm{letter-spacing:0}.qb{margin-top:0.67em}.qg{margin-top:24px}.rc{font-size:16px}.rd{margin-top:1.23em}.rt{margin-top:1.34em}.tb{margin-bottom:80px}.tr{padding-top:48px}.uv{margin-top:32px}.ng:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="print">.tj{display:none}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jy{max-height:none}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.ny{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F850bf812dd8a&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fswlh%2Fpolyglot-files-a-hackers-best-friend-850bf812dd8a&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---top_nav_layout_nav----------------------------------"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=---top_nav_layout_nav----------------------------------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fswlh%2Fpolyglot-files-a-hackers-best-friend-850bf812dd8a&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="de77" class="pw-post-title gs gt gu gv b gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq bk" data-testid="storyTitle">Polyglot Files: a Hacker’s best friend</h1></div><div><h2 id="1f28" class="pw-subtitle-paragraph hr gt gu bf b hs ht hu hv hw hx hy hz ia ib ic id ie if ig cq du">And how to hide PHP code in JPEG files</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="ih ii ij ik il ab"><div><div class="ab im"><a rel="noopener follow" href="/@vickieli?source=post_page-----850bf812dd8a--------------------------------"><div><div class="bm" aria-hidden="false"><div class="l in io by ip iq"><div class="l fj"><img alt="Vickie Li" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/2*pAMQ3POj0h1mZUA5za-6sg.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="ir by l dd de fs n is ft"></div></div></div></div></div></a><a href="https://medium.com/swlh?source=post_page-----850bf812dd8a--------------------------------" rel="noopener follow"><div class="it ab fj"><div><div class="bm" aria-hidden="false"><div class="l iu iv by ip iw"><div class="l fj"><img alt="The Startup" class="l fd by br ix cx" src="https://miro.medium.com/v2/resize:fill:48:48/1*pKOfOAOvx-fWzfITATgGRg.jpeg" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="ir by l br ix fs n is ft"></div></div></div></div></div></div></a></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="iy ab q"><div class="ab q iz"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ja jb bk"><a class="af ag ah ai aj ak al am an ao ap aq ar jc" data-testid="authorName" rel="noopener follow" href="/@vickieli?source=post_page-----850bf812dd8a--------------------------------">Vickie Li</a></p></div></div></div><span class="jd je" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b ja jb du"><span><a class="jf jg ah ai aj ak al am an ao ap aq ar ex jh ji" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F871f2599811b&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fswlh%2Fpolyglot-files-a-hackers-best-friend-850bf812dd8a&amp;user=Vickie+Li&amp;userId=871f2599811b&amp;source=post_page-871f2599811b----850bf812dd8a---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l jj"><span class="bf b bg z du"><div class="ab cn jk jl jm"><div class="jn jo ab"><div class="bf b bg z du ab jp"><span class="jq l jj">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar jc ab q" data-testid="publicationName" href="https://medium.com/swlh?source=post_page-----850bf812dd8a--------------------------------" rel="noopener follow"><p class="bf b bg z jr js jt ju jv jw jx jy bk">The Startup</p></a></div></div></div><div class="h k"><span class="jd je" aria-hidden="true"><span class="bf b bg z du">·</span></span></div></div><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">5 min read</span><div class="jz ka l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Oct 2, 2019</span></div></span></div></span></div></div></div><div class="ab cp kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq"><div class="h k w fg fh q"><div class="lg l"><div class="ab q lh li"><div class="pw-multi-vote-icon fj jq lj lk ll"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fswlh%2F850bf812dd8a&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fswlh%2Fpolyglot-files-a-hackers-best-friend-850bf812dd8a&amp;user=Vickie+Li&amp;userId=871f2599811b&amp;source=-----850bf812dd8a---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="lm ao ln lo lp lq am lr ls lt ll"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lu lv lw lx ly lz ma"><p class="bf b dv z du"><span class="mb">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao lm mc md ab q fk me mf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="mg"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q kr ks kt ku kv kw kx ky kz la lb lc ld le lf"><div class="mh k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F850bf812dd8a&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fswlh%2Fpolyglot-files-a-hackers-best-friend-850bf812dd8a&amp;source=-----850bf812dd8a---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du mi" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd mj cn"><div class="l ae"><div class="ab cb"><div class="mk ml mm mn mo mp ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al mq an ao ap ex mr ms mf mt mu mv mw mx s my mz na nb nc nd ne u nf ng nh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al mq an ao ap ex mr ms mf mt mu mv mw mx s my mz na nb nc nd ne u nf ng nh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div></div></div><div class="ni"><div class="ab cb"><div class="mk nj ml nk mm nl cf nm cg nn ci bh"><figure class="nr ns nt nu nv ni nw nx paragraph-image"><div role="button" tabindex="0" class="ny nz fj oa bh ob"><div class="no np nq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/0*62JsCxm-CAqQTkwF 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*62JsCxm-CAqQTkwF 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*62JsCxm-CAqQTkwF 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*62JsCxm-CAqQTkwF 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*62JsCxm-CAqQTkwF 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*62JsCxm-CAqQTkwF 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/0*62JsCxm-CAqQTkwF 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/0*62JsCxm-CAqQTkwF 640w, https://miro.medium.com/v2/resize:fit:720/0*62JsCxm-CAqQTkwF 720w, https://miro.medium.com/v2/resize:fit:750/0*62JsCxm-CAqQTkwF 750w, https://miro.medium.com/v2/resize:fit:786/0*62JsCxm-CAqQTkwF 786w, https://miro.medium.com/v2/resize:fit:828/0*62JsCxm-CAqQTkwF 828w, https://miro.medium.com/v2/resize:fit:1100/0*62JsCxm-CAqQTkwF 1100w, https://miro.medium.com/v2/resize:fit:2000/0*62JsCxm-CAqQTkwF 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh mp oc c" width="1000" height="667" loading="eager" role="presentation"/></picture></div></div><figcaption class="od ff oe no np of og bf b bg z du">Photo by <a class="af oh" href="https://unsplash.com/@cbarbalis?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Chris Barbalis</a> on <a class="af oh" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="4e24" class="pw-post-body-paragraph oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd gn bk">Hello! Thanks for clicking on this blog post. Today, we’re gonna talk about a topic that has always fascinated me in the cybersecurity world: polyglot files! We’re going to take a look at what they are, how they confuse applications, how they are used in an attack scenario.</p><h1 id="4560" class="pe pf gu bf pg ph pi hu pj pk pl hx pm pn po pp pq pr ps pt pu pv pw px py pz bk">What are polyglots?</h1><p id="2216" class="pw-post-body-paragraph oi oj gu ok b hs qa om on hv qb op oq or qc ot ou ov qd ox oy oz qe pb pc pd gn bk">Polyglots, in a security context, are files that are a valid form of multiple different file types. For example, a <a class="af oh" href="https://en.wikipedia.org/wiki/Gifar" rel="noopener ugc nofollow" target="_blank">GIFAR</a> is both a GIF and a RAR file. There are also files out there that can be both GIF and JS, both PPT and JS, etc.</p><p id="55d1" class="pw-post-body-paragraph oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd gn bk">Polyglot files are often used to bypass protection based on file types. Many applications that allow users to upload files only allow uploads of certain types, such as JPEG, GIF, DOC, so as to prevent users from uploading potentially dangerous files like JS files, PHP files or Phar files.</p><p id="9cf9" class="pw-post-body-paragraph oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd gn bk">One example of a polyglot file is a Phar-JPEG file. Phar files are used to carry out PHP object injection attacks:</p><div class="qf qg qh qi qj qk"><a rel="noopener follow" target="_blank" href="/@vickieli/diving-into-unserialize-phar-deserialization-98b1254380e9?source=post_page-----850bf812dd8a--------------------------------"><div class="ql ab jj"><div class="qm ab co cb qn qo"><h2 class="gv b ja z jr qp jt ju qq jw jy gt bk">Diving into unserialize(): phar deserialization</h2><div class="qr l"><h3 class="bf b ja z jr qp jt ju qq jw jy du">Exploiting PHP deserialization vulnerabilities without unserialize()</h3></div><div class="qs l"><p class="bf b dv z jr qp jt ju qq jw jy du">medium.com</p></div></div><div class="qt l"><div class="qu l qv qw qx qt qy mp qk"></div></div></div></a></div><p id="5385" class="pw-post-body-paragraph oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd gn bk">This type of attack can lead to RCE. However, it requires the attacker to be able to upload a readable Phar file, and Phar files are not often allowed by file upload functionalities. So a Phar-JPEG file allows the malicious upload to look like a harmless JPEG file to bypass upload restrictions, but still retain the capabilities of a Phar file.</p><h1 id="9646" class="pe pf gu bf pg ph pi hu pj pk pl hx pm pn po pp pq pr ps pt pu pv pw px py pz bk">File format specifications</h1><p id="76bd" class="pw-post-body-paragraph oi oj gu ok b hs qa om on hv qb op oq or qc ot ou ov qd ox oy oz qe pb pc pd gn bk">First, it is important to understand that different file types are simply chunks of bytes that follow a predefined structure.</p><h2 id="a783" class="qz pf gu bf pg ra rb dy pj rc rd ea pm or re rf rg ov rh ri rj oz rk rl rm rn bk">Phar archive format</h2><p id="6802" class="pw-post-body-paragraph oi oj gu ok b hs qa om on hv qb op oq or qc ot ou ov qd ox oy oz qe pb pc pd gn bk">For example, let’s look at the PHAR (PHp ARchive) format. For a Phar file to be valid, it needs to follow a certain structure: it contains a stub section, a manifest section and finally, a file content section.</p><ul class=""><li id="2c55" class="oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd ro rp rq bk">Stub: the stub is a chunk of PHP code which is executed when the file is accessed in an executable context. At a minimum, the stub must contain <strong class="ok rr">__HALT_COMPILER();</strong> at its conclusion. <strong class="ok rr">Otherwise, there are no restrictions on the contents of a Phar stub.</strong></li><li id="3945" class="oi oj gu ok b hs rs om on hv rt op oq or ru ot ou ov rv ox oy oz rw pb pc pd ro rp rq bk">Manifest: this section contains metadata about the archive and its contents.</li><li id="a4ac" class="oi oj gu ok b hs rs om on hv rt op oq or ru ot ou ov rv ox oy oz rw pb pc pd ro rp rq bk">File contents: this section contains the actual files in the archive.</li><li id="a827" class="oi oj gu ok b hs rs om on hv rt op oq or ru ot ou ov rv ox oy oz rw pb pc pd ro rp rq bk">Signature (optional): for verifying archive integrity.</li></ul><h2 id="a9db" class="qz pf gu bf pg ra rb dy pj rc rd ea pm or re rf rg ov rh ri rj oz rk rl rm rn bk">JPEG format</h2><p id="28a0" class="pw-post-body-paragraph oi oj gu ok b hs qa om on hv qb op oq or qc ot ou ov qd ox oy oz qe pb pc pd gn bk">On the other hand, JPEGs are structured very differently. (The complete specifications of JPEG images are beyond the scope of this article, but you can read about it <a class="af oh" href="https://en.wikipedia.org/wiki/JPEG_File_Interchange_Format#File_format_structure" rel="noopener ugc nofollow" target="_blank">here</a>.) But for the purposes of this article, keep in mind that:</p><ul class=""><li id="cff6" class="oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd ro rp rq bk">A header of a JPEG image looks like this:</li></ul><pre class="nr ns nt nu nv rx ry rz sa ay sb bk"><span id="6c42" class="qz pf gu ry b ja sc sd l jp se">typedef struct _JFIFHeader<br/>{<br/>  BYTE SOI[2];          /* 00h  Start of Image Marker     */<br/>  BYTE APP0[2];         /* 02h  Application Use Marker    */<br/>  BYTE Length[2];       /* 04h  Length of APP0 Field      */<br/>  BYTE Identifier[5];   /* 06h  &quot;JFIF&quot; (zero terminated) Id */<br/>  BYTE Version[2];      /* 07h  JFIF Format Revision      */<br/>  BYTE Units;           /* 09h  Units used for Resolution */<br/>  BYTE Xdensity[2];     /* 0Ah  Horizontal Resolution     */<br/>  BYTE Ydensity[2];     /* 0Ch  Vertical Resolution       */<br/>  BYTE XThumbnail;      /* 0Eh  Horizontal Pixel Count    */<br/>  BYTE YThumbnail;      /* 0Fh  Vertical Pixel Count      */<br/>} JFIFHEAD;</span></pre><ul class=""><li id="b896" class="oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd ro rp rq bk">JPEG files start with a “Start of Image (SOI)” marker which contains the bytes <code class="cx sf sg sh ry b">FF</code> <code class="cx sf sg sh ry b">D8</code> .</li><li id="0756" class="oi oj gu ok b hs rs om on hv rt op oq or ru ot ou ov rv ox oy oz rw pb pc pd ro rp rq bk">The application marker APP0 contains the bytes <code class="cx sf sg sh ry b">FF</code> <code class="cx sf sg sh ry b">E0</code> .</li><li id="f337" class="oi oj gu ok b hs rs om on hv rt op oq or ru ot ou ov rv ox oy oz rw pb pc pd ro rp rq bk">The length field is the size of the image.</li><li id="a853" class="oi oj gu ok b hs rs om on hv rt op oq or ru ot ou ov rv ox oy oz rw pb pc pd ro rp rq bk">The identifier field contains “JFIF” with a trailing NULL byte.</li><li id="afa3" class="oi oj gu ok b hs rs om on hv rt op oq or ru ot ou ov rv ox oy oz rw pb pc pd ro rp rq bk">The version field specifies the JFIF specification version.</li><li id="c8d6" class="oi oj gu ok b hs rs om on hv rt op oq or ru ot ou ov rv ox oy oz rw pb pc pd ro rp rq bk">And finally, JPEG files end with an “End of Image (EOI)” marker, <code class="cx sf sg sh ry b">FF</code> <code class="cx sf sg sh ry b">D9</code> .</li></ul><h1 id="0530" class="pe pf gu bf pg ph pi hu pj pk pl hx pm pn po pp pq pr ps pt pu pv pw px py pz bk">So… How do polyglots work?</h1><p id="20fe" class="pw-post-body-paragraph oi oj gu ok b hs qa om on hv qb op oq or qc ot ou ov qd ox oy oz qe pb pc pd gn bk">So, how exactly do polyglots fool the applications that process them? How does a Phar-JPEG appear as an image to an image processor and file upload security checker, yet still be able to be used as a Phar file?</p><p id="896f" class="pw-post-body-paragraph oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd gn bk">To understand why polyglots are possible, we have to look at how applications detect file types.</p><h2 id="76be" class="qz pf gu bf pg ra rb dy pj rc rd ea pm or re rf rg ov rh ri rj oz rk rl rm rn bk">How do applications determine file type?</h2><p id="6089" class="pw-post-body-paragraph oi oj gu ok b hs qa om on hv qb op oq or qc ot ou ov qd ox oy oz qe pb pc pd gn bk">An application can utilize several ways of checking the file type of a file: by looking at the file extension, by looking for specific magic bytes, and by validating certain file signatures.</p><ol class=""><li id="5f4e" class="oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd si rp rq bk"><strong class="ok rr">Extension based detection</strong></li></ol><p id="f284" class="pw-post-body-paragraph oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd gn bk">The simplest way to detect a file’s type is to look at its file extension, for example, <strong class="ok rr">puppies.jpeg</strong> is a JPEG file. However, this method of detection is not always reliable. Files can be renamed and files could come without an extension. So this method is often only one of many methods that applications use to validate file types.</p><p id="d195" class="pw-post-body-paragraph oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd gn bk"><strong class="ok rr">2. Magic bytes detection</strong></p><p id="fb4b" class="pw-post-body-paragraph oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd gn bk">For some file types, there are magic bytes at the start of the file that indicates that the file is of a certain format. Some forms of file type detection make use of this information. Some of these examples are:</p><ul class=""><li id="71fe" class="oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd ro rp rq bk">JPEG files begin with <code class="cx sf sg sh ry b">FF</code> <code class="cx sf sg sh ry b">D8</code> and end with <code class="cx sf sg sh ry b">FF</code> <code class="cx sf sg sh ry b">D9</code> .</li><li id="a2d6" class="oi oj gu ok b hs rs om on hv rt op oq or ru ot ou ov rv ox oy oz rw pb pc pd ro rp rq bk">PDF files start with “%PDF” (hex <code class="cx sf sg sh ry b">25</code> <code class="cx sf sg sh ry b">50</code> <code class="cx sf sg sh ry b">44</code> <code class="cx sf sg sh ry b">46</code>).</li></ul><p id="aaf5" class="pw-post-body-paragraph oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd gn bk"><strong class="ok rr">3. File signature validation</strong></p><p id="9987" class="pw-post-body-paragraph oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd gn bk">Still, some more sophisticated file validators will perform checks based on specific signatures of the file. For example, they might check if a JPEG file contains all the necessary header fields.</p><h2 id="1cbf" class="qz pf gu bf pg ra rb dy pj rc rd ea pm or re rf rg ov rh ri rj oz rk rl rm rn bk">How polyglots become two files</h2><p id="54b7" class="pw-post-body-paragraph oi oj gu ok b hs qa om on hv qb op oq or qc ot ou ov qd ox oy oz qe pb pc pd gn bk">Polyglots become polyglots when they pass all the validity checks for more than one file type. To an application that is looking for image files, it bears all the signatures of an image file. To another application that is looking for different indicators, it becomes something else and checks all the boxes as well.</p><p id="e91c" class="pw-post-body-paragraph oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd gn bk">For a Phar-JPEG file, it has to pass all the JPEG validity checks when it is uploaded, then still be used as a PHP archive when the attacker calls it to start a PHP object injection attack.</p><h1 id="125c" class="pe pf gu bf pg ph pi hu pj pk pl hx pm pn po pp pq pr ps pt pu pv pw px py pz bk">Constructing a Phar-JPEG</h1><p id="69cd" class="pw-post-body-paragraph oi oj gu ok b hs qa om on hv qb op oq or qc ot ou ov qd ox oy oz qe pb pc pd gn bk">A Phar-JPEG file is possible due to the flexibility in the Phar format’s specifications. Specifically, there are no restrictions to the <strong class="ok rr">stub</strong> section of a Phar besides that it must end with <strong class="ok rr">__HALT_COMPILER();</strong>.</p><p id="13c2" class="pw-post-body-paragraph oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd gn bk">This means that the stub section of the Phar can be used to inject dummy data in order to disguise the file as a JPEG. Let’s say we inject a valid JPEG image in the stub section of the Phar before <strong class="ok rr">__HALT_COMPILER();</strong>. Now the file looks something like this:</p><pre class="nr ns nt nu nv rx ry rz sa ay sb bk"><span id="d902" class="qz pf gu ry b ja sc sd l jp se">\xFF\xD8......................JPEG DATA.....................\xFF\xD9<br/>__HALT_COMPILER(); ............PHAR DATA............................</span></pre><p id="5b26" class="pw-post-body-paragraph oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd gn bk">To an image processor, the file is a JPEG image because it contains all the signatures of a valid JPEG file: a Start of Image marker, headers, and an End of Image marker. Most image processors will stop processing the file at this point and will not look beyond the JPEG.</p><p id="c22e" class="pw-post-body-paragraph oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd gn bk">But when used with a Phar stream wrapper <strong class="ok rr">phar://</strong>, the file seems like something entirely different: it looks like a file with a valid stub section, a valid manifest and some files in the contents section. Therefore, when operating on the file, PHP still performs an <strong class="ok rr">unserialize()</strong> operation on the Phar file’s metadata. The attacker thus achieves RCE through a successful PHP object injection.</p><p id="b54d" class="pw-post-body-paragraph oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd gn bk">Isn’t that super cool? :)</p></div></div></div><div class="ab cb sj sk sl sm" role="separator"><span class="sn by bm so sp sq"></span><span class="sn by bm so sp sq"></span><span class="sn by bm so sp"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="2c96" class="pw-post-body-paragraph oi oj gu ok b hs ol om on hv oo op oq or os ot ou ov ow ox oy oz pa pb pc pd gn bk">Note: Trying this on systems where you don’t have permission to test is illegal. If you’ve found a vulnerability, please disclose it responsibly to the vendor. Help make our Internet a safer place! And as always, thanks for reading!</p></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="sr ss ab jm"><div class="qr ab"><a class="st ay am ao" rel="noopener follow" href="/tag/hacking?source=post_page-----850bf812dd8a--------------------------------"><div class="su fj cx sv ge sw sx bf b bg z bk sy">Hacking</div></a></div><div class="qr ab"><a class="st ay am ao" rel="noopener follow" href="/tag/computer-science?source=post_page-----850bf812dd8a--------------------------------"><div class="su fj cx sv ge sw sx bf b bg z bk sy">Computer Science</div></a></div><div class="qr ab"><a class="st ay am ao" rel="noopener follow" href="/tag/cybersecurity?source=post_page-----850bf812dd8a--------------------------------"><div class="su fj cx sv ge sw sx bf b bg z bk sy">Cybersecurity</div></a></div><div class="qr ab"><a class="st ay am ao" rel="noopener follow" href="/tag/php?source=post_page-----850bf812dd8a--------------------------------"><div class="su fj cx sv ge sw sx bf b bg z bk sy">PHP</div></a></div><div class="qr ab"><a class="st ay am ao" rel="noopener follow" href="/tag/programming?source=post_page-----850bf812dd8a--------------------------------"><div class="su fj cx sv ge sw sx bf b bg z bk sy">Programming</div></a></div></div></div></div><div class="l"></div><footer class="sz ta tb tc td te tf tg th ab q ti iw c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp tj"><div class="ab q lh"><div class="tk l"><span class="l tl tm tn e d"><div class="ab q lh li"><div class="pw-multi-vote-icon fj jq lj lk ll"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fswlh%2F850bf812dd8a&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fswlh%2Fpolyglot-files-a-hackers-best-friend-850bf812dd8a&amp;user=Vickie+Li&amp;userId=871f2599811b&amp;source=-----850bf812dd8a---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="lm ao ln lo lp lq am lr ls lt ll"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lu lv lw lx ly lz ma"><p class="bf b dv z du"><span class="mb">--</span></p></div></div></span><span class="l h g f to tp"><div class="ab q lh li"><div class="pw-multi-vote-icon fj jq lj lk ll"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fswlh%2F850bf812dd8a&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fswlh%2Fpolyglot-files-a-hackers-best-friend-850bf812dd8a&amp;user=Vickie+Li&amp;userId=871f2599811b&amp;source=-----850bf812dd8a---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="lm ao ln lo lp lq am lr ls lt ll"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lu lv lw lx ly lz ma"><p class="bf b dv z du"><span class="mb">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao lm mc md ab q fk me mf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="mg"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="sq l jj"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F850bf812dd8a&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fswlh%2Fpolyglot-files-a-hackers-best-friend-850bf812dd8a&amp;source=--------------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du mi" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="sq l jj"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al mq an ao ap ex mr ms mf mt"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="tq tr ts tt tu l bx"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="cl ab tv cp"><div class="ab im"><a rel="noopener follow" href="/@vickieli?source=post_page-----850bf812dd8a--------------------------------"><div class="l tw tx by ty iq"><div class="l fj"><img alt="Vickie Li" class="l fd by tz ua cx" src="https://miro.medium.com/v2/resize:fill:144:144/2*pAMQ3POj0h1mZUA5za-6sg.png" width="72" height="72" loading="lazy"/><div class="ir by l tz ua fs n is ft"></div></div></div></a><a href="https://medium.com/swlh?source=post_page-----850bf812dd8a--------------------------------" rel="noopener follow"><div class="ub ab fj"><div><div class="bm" aria-hidden="false"><div class="l uc ud by ty iw"><div class="l fj"><img alt="The Startup" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*pKOfOAOvx-fWzfITATgGRg.jpeg" width="32" height="32" loading="lazy"/><div class="ir by l bz ca fs n is ft"></div></div></div></div></div></div></a></div><div class="j i d"><div class="ab"><span><button class="bf b bg z ep su eq er es et eu ev ew ex ey ez fa au fb fc fd bm fe ff">Follow</button></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8676a49f5370&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fswlh%2Fpolyglot-files-a-hackers-best-friend-850bf812dd8a&amp;newsletterV3=871f2599811b&amp;newsletterV3Id=8676a49f5370&amp;user=Vickie+Li&amp;userId=871f2599811b&amp;source=-----850bf812dd8a---------------------subscribe_user-----------"><button class="bf b bg z uf am ug sb uh ui uj uk ul um ew ex ey ez fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="ue ud uc"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab cn cp"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@vickieli?source=post_page-----850bf812dd8a--------------------------------"><h2 class="pw-author-name bf un uo up uq bk"><span class="gn ka">Written by <!-- -->Vickie Li</span></h2></a></div><div class="qr ab"><div class="l jj"><span class="pw-follower-count bf b bg z bk"><a class="af ag ah ai aj ak al am an ao ap aq ar jc" rel="noopener follow" href="/@vickieli/followers?source=post_page-----850bf812dd8a--------------------------------">18.2K Followers</a></span></div><div class="bf b bg z jr js jt ab jv jw jx jy du jp"><span class="jd l" aria-hidden="true"><span class="bf b bg z du">·</span></span><span class="l jj">Writer for </span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar jc ab q" href="https://medium.com/swlh?source=post_page-----850bf812dd8a--------------------------------" rel="noopener follow"><p class="bf b bg z jr js jt ju jv jw jx jy bk">The Startup</p></a></div></div></div></div><div class="ur l"><p class="bf b bg z bk">Professional investigator of nerdy stuff. Hacks and secures. Creates god awful infographics. <a class="af ag ah ai aj ak al am an ao ap aq ar oh go" href="https://twitter.com/vickieli7" rel="noopener  ugc nofollow">https://twitter.com/vickieli7</a></p></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z ep su eq er es et eu ev ew ex ey ez fa au fb fc fd bm fe ff">Follow</button></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F8676a49f5370&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fswlh%2Fpolyglot-files-a-hackers-best-friend-850bf812dd8a&amp;newsletterV3=871f2599811b&amp;newsletterV3Id=8676a49f5370&amp;user=Vickie+Li&amp;userId=871f2599811b&amp;source=-----850bf812dd8a---------------------subscribe_user-----------"><button class="bf b bg z uf am ug sb uh ui uj uk ul um ew ex ey ez fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="ue ud uc"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="us bh ut uu uv uw ux uy"></div></div></div><div class="h k j"><div class="us bh ut uz"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="va ab lh jm"><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----850bf812dd8a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----850bf812dd8a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----850bf812dd8a--------------------------------"><p class="bf b dv z du">About</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----850bf812dd8a--------------------------------"><p class="bf b dv z du">Careers</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----850bf812dd8a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----850bf812dd8a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----850bf812dd8a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----850bf812dd8a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----850bf812dd8a--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="vb l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----850bf812dd8a--------------------------------"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241017-182126-a0128a89d2"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-850bf812dd8a","user-871f2599811b","collection-f5af2b715248"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false,"publicationHierarchyEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"fb87c0c6-d488-42db-bf4b-21bed5c04451","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-766f9d1b5eea2620a3905d5f9e910703-cba8718278e908c6-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002Fswlh\u002Fpolyglot-files-a-hackers-best-friend-850bf812dd8a","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20241017-182126-a0128a89d2","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241017-182126-a0128a89d2","commit":"a0128a89d2d76bfa55b25492370b0bae4050224f"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"swlh\"})":{"__ref":"Collection:f5af2b715248"},"postResult({\"id\":\"850bf812dd8a\"})":{"__ref":"Post:850bf812dd8a"}},"ImageMetadata:":{"__typename":"ImageMetadata","id":"","originalWidth":0,"originalHeight":0},"Collection:f5af2b715248":{"__typename":"Collection","id":"f5af2b715248","favicon":{"__ref":"ImageMetadata:"},"customStyleSheet":{"__ref":"CustomStyleSheet:47e18467fd3d"},"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFF4F2F2","point":0},{"__typename":"ColorPoint","color":"#FFF2F0F0","point":0.1},{"__typename":"ColorPoint","color":"#FFF0EEEE","point":0.2},{"__typename":"ColorPoint","color":"#FFEEECEC","point":0.3},{"__typename":"ColorPoint","color":"#FFECEBEA","point":0.4},{"__typename":"ColorPoint","color":"#FFEAE9E8","point":0.5},{"__typename":"ColorPoint","color":"#FFE8E7E7","point":0.6},{"__typename":"ColorPoint","color":"#FFE6E5E5","point":0.7},{"__typename":"ColorPoint","color":"#FFE4E3E3","point":0.8},{"__typename":"ColorPoint","color":"#FFE2E1E1","point":0.9},{"__typename":"ColorPoint","color":"#FFE0DFDF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF848585","point":0},{"__typename":"ColorPoint","color":"#FF7B7B7B","point":0.1},{"__typename":"ColorPoint","color":"#FF717272","point":0.2},{"__typename":"ColorPoint","color":"#FF686868","point":0.3},{"__typename":"ColorPoint","color":"#FF5E5E5E","point":0.4},{"__typename":"ColorPoint","color":"#FF545454","point":0.5},{"__typename":"ColorPoint","color":"#FF494A4A","point":0.6},{"__typename":"ColorPoint","color":"#FF3F3F3F","point":0.7},{"__typename":"ColorPoint","color":"#FF333333","point":0.8},{"__typename":"ColorPoint","color":"#FF272727","point":0.9},{"__typename":"ColorPoint","color":"#FF1A1A1A","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFF9F9F9","colorPoints":[{"__typename":"ColorPoint","color":"#FFF9F9F9","point":0},{"__typename":"ColorPoint","color":"#FFE7E7E7","point":0.1},{"__typename":"ColorPoint","color":"#FFD4D4D4","point":0.2},{"__typename":"ColorPoint","color":"#FFC1C1C1","point":0.3},{"__typename":"ColorPoint","color":"#FFADADAE","point":0.4},{"__typename":"ColorPoint","color":"#FF989999","point":0.5},{"__typename":"ColorPoint","color":"#FF838484","point":0.6},{"__typename":"ColorPoint","color":"#FF6D6E6E","point":0.7},{"__typename":"ColorPoint","color":"#FF565757","point":0.8},{"__typename":"ColorPoint","color":"#FF3C3E3E","point":0.9},{"__typename":"ColorPoint","color":"#FF202122","point":1}]}},"googleAnalyticsId":null,"editors":[{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:d43c46db5b92"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:f0236d5369c"}}],"name":"The Startup","avatar":{"__ref":"ImageMetadata:1*pKOfOAOvx-fWzfITATgGRg.jpeg"},"domain":null,"slug":"swlh","description":"Get smarter at building your thing. Follow to join The Startup’s +8 million monthly readers & +772K followers.","subscriberCount":807334,"latestPostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__typename":"Post","title":"3 Powerful Business Lessons I Learned From Running Ultramarathons","latestPublishedAt":1729734101438}]},"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:f5af2b715248-viewerId:lo_928a5a5d6c81"},"twitterUsername":"GrowthSupply","facebookPageId":null,"logo":{"__ref":"ImageMetadata:"}},"CustomStyleSheet:47e18467fd3d":{"__typename":"CustomStyleSheet","id":"47e18467fd3d","global":{"__typename":"GlobalStyles","colorPalette":{"__typename":"StyleSheetColorPalette","primary":{"__typename":"ColorValue","colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFF4F2F2","point":0},{"__typename":"ColorPoint","color":"#FFF2F0F0","point":0.1},{"__typename":"ColorPoint","color":"#FFF0EEEE","point":0.2},{"__typename":"ColorPoint","color":"#FFEEECEC","point":0.3},{"__typename":"ColorPoint","color":"#FFECEBEA","point":0.4},{"__typename":"ColorPoint","color":"#FFEAE9E8","point":0.5},{"__typename":"ColorPoint","color":"#FFE8E7E7","point":0.6},{"__typename":"ColorPoint","color":"#FFE6E5E5","point":0.7},{"__typename":"ColorPoint","color":"#FFE4E3E3","point":0.8},{"__typename":"ColorPoint","color":"#FFE2E1E1","point":0.9},{"__typename":"ColorPoint","color":"#FFE0DFDF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF848585","point":0},{"__typename":"ColorPoint","color":"#FF7B7B7B","point":0.1},{"__typename":"ColorPoint","color":"#FF717272","point":0.2},{"__typename":"ColorPoint","color":"#FF686868","point":0.3},{"__typename":"ColorPoint","color":"#FF5E5E5E","point":0.4},{"__typename":"ColorPoint","color":"#FF545454","point":0.5},{"__typename":"ColorPoint","color":"#FF494A4A","point":0.6},{"__typename":"ColorPoint","color":"#FF3F3F3F","point":0.7},{"__typename":"ColorPoint","color":"#FF333333","point":0.8},{"__typename":"ColorPoint","color":"#FF272727","point":0.9},{"__typename":"ColorPoint","color":"#FF1A1A1A","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFF9F9F9","colorPoints":[{"__typename":"ColorPoint","color":"#FFF9F9F9","point":0},{"__typename":"ColorPoint","color":"#FFE7E7E7","point":0.1},{"__typename":"ColorPoint","color":"#FFD4D4D4","point":0.2},{"__typename":"ColorPoint","color":"#FFC1C1C1","point":0.3},{"__typename":"ColorPoint","color":"#FFADADAE","point":0.4},{"__typename":"ColorPoint","color":"#FF989999","point":0.5},{"__typename":"ColorPoint","color":"#FF838484","point":0.6},{"__typename":"ColorPoint","color":"#FF6D6E6E","point":0.7},{"__typename":"ColorPoint","color":"#FF565757","point":0.8},{"__typename":"ColorPoint","color":"#FF3C3E3E","point":0.9},{"__typename":"ColorPoint","color":"#FF202122","point":1}]}}},"background":null},"fonts":{"__typename":"StyleSheetFonts","font1":{"__typename":"StyleSheetFont","name":"SERIF_1"},"font2":{"__typename":"StyleSheetFont","name":"SANS_SERIF_1"},"font3":{"__typename":"StyleSheetFont","name":"SERIF_2"}}},"header":{"__typename":"HeaderStyles","backgroundImage":null}},"User:d43c46db5b92":{"__typename":"User","id":"d43c46db5b92"},"User:f0236d5369c":{"__typename":"User","id":"f0236d5369c"},"ImageMetadata:1*pKOfOAOvx-fWzfITATgGRg.jpeg":{"__typename":"ImageMetadata","id":"1*pKOfOAOvx-fWzfITATgGRg.jpeg"},"LinkedAccounts:871f2599811b":{"__typename":"LinkedAccounts","mastodon":null,"id":"871f2599811b"},"UserViewerEdge:userId:871f2599811b-viewerId:lo_928a5a5d6c81":{"__typename":"UserViewerEdge","id":"userId:871f2599811b-viewerId:lo_928a5a5d6c81","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:8676a49f5370":{"__typename":"NewsletterV3","id":"8676a49f5370","type":"NEWSLETTER_TYPE_AUTHOR","slug":"871f2599811b","name":"871f2599811b","collection":null,"user":{"__ref":"User:871f2599811b"}},"User:871f2599811b":{"__typename":"User","id":"871f2599811b","name":"Vickie Li","username":"vickieli","newsletterV3":{"__ref":"NewsletterV3:8676a49f5370"},"linkedAccounts":{"__ref":"LinkedAccounts:871f2599811b"},"isSuspended":false,"imageId":"2*pAMQ3POj0h1mZUA5za-6sg.png","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":18294},"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"vickieli.medium.com"}},"hasSubdomain":true,"bio":"Professional investigator of nerdy stuff. Hacks and secures. Creates god awful infographics. https:\u002F\u002Ftwitter.com\u002Fvickieli7","isPartnerProgramEnrolled":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:871f2599811b-viewerId:lo_928a5a5d6c81"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"userPostCounts({\"includeResponsesCount\":true})":null,"membership":null,"allowNotes":true,"twitterScreenName":"vickieli7"},"Topic:d4e7f4144ac5":{"__typename":"Topic","slug":"cybersecurity","id":"d4e7f4144ac5","name":"Cybersecurity"},"Paragraph:7898336cf3d2_0":{"__typename":"Paragraph","id":"7898336cf3d2_0","name":"de77","type":"H3","href":null,"layout":null,"metadata":null,"text":"Polyglot Files: a Hacker’s best friend","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_1":{"__typename":"Paragraph","id":"7898336cf3d2_1","name":"1f28","type":"H4","href":null,"layout":null,"metadata":null,"text":"And how to hide PHP code in JPEG files","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*62JsCxm-CAqQTkwF":{"__typename":"ImageMetadata","id":"0*62JsCxm-CAqQTkwF","originalHeight":4000,"originalWidth":6000,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:7898336cf3d2_2":{"__typename":"Paragraph","id":"7898336cf3d2_2","name":"40a2","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:0*62JsCxm-CAqQTkwF"},"text":"Photo by Chris Barbalis on Unsplash","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":9,"end":23,"href":"https:\u002F\u002Funsplash.com\u002F@cbarbalis?utm_source=medium&utm_medium=referral","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":27,"end":35,"href":"https:\u002F\u002Funsplash.com?utm_source=medium&utm_medium=referral","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_3":{"__typename":"Paragraph","id":"7898336cf3d2_3","name":"4e24","type":"P","href":null,"layout":null,"metadata":null,"text":"Hello! Thanks for clicking on this blog post. Today, we’re gonna talk about a topic that has always fascinated me in the cybersecurity world: polyglot files! We’re going to take a look at what they are, how they confuse applications, how they are used in an attack scenario.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_4":{"__typename":"Paragraph","id":"7898336cf3d2_4","name":"4560","type":"H3","href":null,"layout":null,"metadata":null,"text":"What are polyglots?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_5":{"__typename":"Paragraph","id":"7898336cf3d2_5","name":"2216","type":"P","href":null,"layout":null,"metadata":null,"text":"Polyglots, in a security context, are files that are a valid form of multiple different file types. For example, a GIFAR is both a GIF and a RAR file. There are also files out there that can be both GIF and JS, both PPT and JS, etc.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":115,"end":120,"href":"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FGifar","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_6":{"__typename":"Paragraph","id":"7898336cf3d2_6","name":"55d1","type":"P","href":null,"layout":null,"metadata":null,"text":"Polyglot files are often used to bypass protection based on file types. Many applications that allow users to upload files only allow uploads of certain types, such as JPEG, GIF, DOC, so as to prevent users from uploading potentially dangerous files like JS files, PHP files or Phar files.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_7":{"__typename":"Paragraph","id":"7898336cf3d2_7","name":"9cf9","type":"P","href":null,"layout":null,"metadata":null,"text":"One example of a polyglot file is a Phar-JPEG file. Phar files are used to carry out PHP object injection attacks:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_8":{"__typename":"Paragraph","id":"7898336cf3d2_8","name":"047a","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Diving into unserialize(): phar deserialization\nExploiting PHP deserialization vulnerabilities without unserialize()medium.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":126,"href":"https:\u002F\u002Fmedium.com\u002F@vickieli\u002Fdiving-into-unserialize-phar-deserialization-98b1254380e9","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":48,"end":116,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fmedium.com\u002F@vickieli\u002Fdiving-into-unserialize-phar-deserialization-98b1254380e9","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*FxgLGrex8oX1nmJg"}},"Paragraph:7898336cf3d2_9":{"__typename":"Paragraph","id":"7898336cf3d2_9","name":"5385","type":"P","href":null,"layout":null,"metadata":null,"text":"This type of attack can lead to RCE. However, it requires the attacker to be able to upload a readable Phar file, and Phar files are not often allowed by file upload functionalities. So a Phar-JPEG file allows the malicious upload to look like a harmless JPEG file to bypass upload restrictions, but still retain the capabilities of a Phar file.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_10":{"__typename":"Paragraph","id":"7898336cf3d2_10","name":"9646","type":"H3","href":null,"layout":null,"metadata":null,"text":"File format specifications","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_11":{"__typename":"Paragraph","id":"7898336cf3d2_11","name":"76bd","type":"P","href":null,"layout":null,"metadata":null,"text":"First, it is important to understand that different file types are simply chunks of bytes that follow a predefined structure.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_12":{"__typename":"Paragraph","id":"7898336cf3d2_12","name":"a783","type":"H4","href":null,"layout":null,"metadata":null,"text":"Phar archive format","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_13":{"__typename":"Paragraph","id":"7898336cf3d2_13","name":"6802","type":"P","href":null,"layout":null,"metadata":null,"text":"For example, let’s look at the PHAR (PHp ARchive) format. For a Phar file to be valid, it needs to follow a certain structure: it contains a stub section, a manifest section and finally, a file content section.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_14":{"__typename":"Paragraph","id":"7898336cf3d2_14","name":"2c55","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Stub: the stub is a chunk of PHP code which is executed when the file is accessed in an executable context. At a minimum, the stub must contain __HALT_COMPILER(); at its conclusion. Otherwise, there are no restrictions on the contents of a Phar stub.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":144,"end":162,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":182,"end":250,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_15":{"__typename":"Paragraph","id":"7898336cf3d2_15","name":"3945","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Manifest: this section contains metadata about the archive and its contents.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_16":{"__typename":"Paragraph","id":"7898336cf3d2_16","name":"a4ac","type":"ULI","href":null,"layout":null,"metadata":null,"text":"File contents: this section contains the actual files in the archive.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_17":{"__typename":"Paragraph","id":"7898336cf3d2_17","name":"a827","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Signature (optional): for verifying archive integrity.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_18":{"__typename":"Paragraph","id":"7898336cf3d2_18","name":"a9db","type":"H4","href":null,"layout":null,"metadata":null,"text":"JPEG format","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_19":{"__typename":"Paragraph","id":"7898336cf3d2_19","name":"28a0","type":"P","href":null,"layout":null,"metadata":null,"text":"On the other hand, JPEGs are structured very differently. (The complete specifications of JPEG images are beyond the scope of this article, but you can read about it here.) But for the purposes of this article, keep in mind that:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":166,"end":170,"href":"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FJPEG_File_Interchange_Format#File_format_structure","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_20":{"__typename":"Paragraph","id":"7898336cf3d2_20","name":"cff6","type":"ULI","href":null,"layout":null,"metadata":null,"text":"A header of a JPEG image looks like this:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_21":{"__typename":"Paragraph","id":"7898336cf3d2_21","name":"6c42","type":"PRE","href":null,"layout":null,"metadata":null,"text":"typedef struct _JFIFHeader\n{\n  BYTE SOI[2];          \u002F* 00h  Start of Image Marker     *\u002F\n  BYTE APP0[2];         \u002F* 02h  Application Use Marker    *\u002F\n  BYTE Length[2];       \u002F* 04h  Length of APP0 Field      *\u002F\n  BYTE Identifier[5];   \u002F* 06h  \"JFIF\" (zero terminated) Id *\u002F\n  BYTE Version[2];      \u002F* 07h  JFIF Format Revision      *\u002F\n  BYTE Units;           \u002F* 09h  Units used for Resolution *\u002F\n  BYTE Xdensity[2];     \u002F* 0Ah  Horizontal Resolution     *\u002F\n  BYTE Ydensity[2];     \u002F* 0Ch  Vertical Resolution       *\u002F\n  BYTE XThumbnail;      \u002F* 0Eh  Horizontal Pixel Count    *\u002F\n  BYTE YThumbnail;      \u002F* 0Fh  Vertical Pixel Count      *\u002F\n} JFIFHEAD;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_22":{"__typename":"Paragraph","id":"7898336cf3d2_22","name":"b896","type":"ULI","href":null,"layout":null,"metadata":null,"text":"JPEG files start with a “Start of Image (SOI)” marker which contains the bytes FF D8 .","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":79,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":82,"end":84,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_23":{"__typename":"Paragraph","id":"7898336cf3d2_23","name":"0756","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The application marker APP0 contains the bytes FF E0 .","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":47,"end":49,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":50,"end":52,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_24":{"__typename":"Paragraph","id":"7898336cf3d2_24","name":"f337","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The length field is the size of the image.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_25":{"__typename":"Paragraph","id":"7898336cf3d2_25","name":"a853","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The identifier field contains “JFIF” with a trailing NULL byte.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_26":{"__typename":"Paragraph","id":"7898336cf3d2_26","name":"afa3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The version field specifies the JFIF specification version.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_27":{"__typename":"Paragraph","id":"7898336cf3d2_27","name":"c8d6","type":"ULI","href":null,"layout":null,"metadata":null,"text":"And finally, JPEG files end with an “End of Image (EOI)” marker, FF D9 .","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":65,"end":67,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":68,"end":70,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_28":{"__typename":"Paragraph","id":"7898336cf3d2_28","name":"0530","type":"H3","href":null,"layout":null,"metadata":null,"text":"So… How do polyglots work?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_29":{"__typename":"Paragraph","id":"7898336cf3d2_29","name":"20fe","type":"P","href":null,"layout":null,"metadata":null,"text":"So, how exactly do polyglots fool the applications that process them? How does a Phar-JPEG appear as an image to an image processor and file upload security checker, yet still be able to be used as a Phar file?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_30":{"__typename":"Paragraph","id":"7898336cf3d2_30","name":"896f","type":"P","href":null,"layout":null,"metadata":null,"text":"To understand why polyglots are possible, we have to look at how applications detect file types.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_31":{"__typename":"Paragraph","id":"7898336cf3d2_31","name":"76be","type":"H4","href":null,"layout":null,"metadata":null,"text":"How do applications determine file type?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_32":{"__typename":"Paragraph","id":"7898336cf3d2_32","name":"6089","type":"P","href":null,"layout":null,"metadata":null,"text":"An application can utilize several ways of checking the file type of a file: by looking at the file extension, by looking for specific magic bytes, and by validating certain file signatures.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_33":{"__typename":"Paragraph","id":"7898336cf3d2_33","name":"5f4e","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Extension based detection","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_34":{"__typename":"Paragraph","id":"7898336cf3d2_34","name":"f284","type":"P","href":null,"layout":null,"metadata":null,"text":"The simplest way to detect a file’s type is to look at its file extension, for example, puppies.jpeg is a JPEG file. However, this method of detection is not always reliable. Files can be renamed and files could come without an extension. So this method is often only one of many methods that applications use to validate file types.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":88,"end":100,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_35":{"__typename":"Paragraph","id":"7898336cf3d2_35","name":"d195","type":"P","href":null,"layout":null,"metadata":null,"text":"2. Magic bytes detection","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_36":{"__typename":"Paragraph","id":"7898336cf3d2_36","name":"fb4b","type":"P","href":null,"layout":null,"metadata":null,"text":"For some file types, there are magic bytes at the start of the file that indicates that the file is of a certain format. Some forms of file type detection make use of this information. Some of these examples are:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_37":{"__typename":"Paragraph","id":"7898336cf3d2_37","name":"71fe","type":"ULI","href":null,"layout":null,"metadata":null,"text":"JPEG files begin with FF D8 and end with FF D9 .","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":22,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":25,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":41,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":44,"end":46,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_38":{"__typename":"Paragraph","id":"7898336cf3d2_38","name":"a2d6","type":"ULI","href":null,"layout":null,"metadata":null,"text":"PDF files start with “%PDF” (hex 25 50 44 46).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":33,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":36,"end":38,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":39,"end":41,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":42,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_39":{"__typename":"Paragraph","id":"7898336cf3d2_39","name":"aaf5","type":"P","href":null,"layout":null,"metadata":null,"text":"3. File signature validation","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_40":{"__typename":"Paragraph","id":"7898336cf3d2_40","name":"9987","type":"P","href":null,"layout":null,"metadata":null,"text":"Still, some more sophisticated file validators will perform checks based on specific signatures of the file. For example, they might check if a JPEG file contains all the necessary header fields.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_41":{"__typename":"Paragraph","id":"7898336cf3d2_41","name":"1cbf","type":"H4","href":null,"layout":null,"metadata":null,"text":"How polyglots become two files","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_42":{"__typename":"Paragraph","id":"7898336cf3d2_42","name":"54b7","type":"P","href":null,"layout":null,"metadata":null,"text":"Polyglots become polyglots when they pass all the validity checks for more than one file type. To an application that is looking for image files, it bears all the signatures of an image file. To another application that is looking for different indicators, it becomes something else and checks all the boxes as well.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_43":{"__typename":"Paragraph","id":"7898336cf3d2_43","name":"e91c","type":"P","href":null,"layout":null,"metadata":null,"text":"For a Phar-JPEG file, it has to pass all the JPEG validity checks when it is uploaded, then still be used as a PHP archive when the attacker calls it to start a PHP object injection attack.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_44":{"__typename":"Paragraph","id":"7898336cf3d2_44","name":"125c","type":"H3","href":null,"layout":null,"metadata":null,"text":"Constructing a Phar-JPEG","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_45":{"__typename":"Paragraph","id":"7898336cf3d2_45","name":"69cd","type":"P","href":null,"layout":null,"metadata":null,"text":"A Phar-JPEG file is possible due to the flexibility in the Phar format’s specifications. Specifically, there are no restrictions to the stub section of a Phar besides that it must end with __HALT_COMPILER();.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":136,"end":140,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":189,"end":207,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_46":{"__typename":"Paragraph","id":"7898336cf3d2_46","name":"13c2","type":"P","href":null,"layout":null,"metadata":null,"text":"This means that the stub section of the Phar can be used to inject dummy data in order to disguise the file as a JPEG. Let’s say we inject a valid JPEG image in the stub section of the Phar before __HALT_COMPILER();. Now the file looks something like this:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":197,"end":215,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_47":{"__typename":"Paragraph","id":"7898336cf3d2_47","name":"d902","type":"PRE","href":null,"layout":null,"metadata":null,"text":"\\xFF\\xD8......................JPEG DATA.....................\\xFF\\xD9\n__HALT_COMPILER(); ............PHAR DATA............................","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_48":{"__typename":"Paragraph","id":"7898336cf3d2_48","name":"5b26","type":"P","href":null,"layout":null,"metadata":null,"text":"To an image processor, the file is a JPEG image because it contains all the signatures of a valid JPEG file: a Start of Image marker, headers, and an End of Image marker. Most image processors will stop processing the file at this point and will not look beyond the JPEG.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_49":{"__typename":"Paragraph","id":"7898336cf3d2_49","name":"c22e","type":"P","href":null,"layout":null,"metadata":null,"text":"But when used with a Phar stream wrapper phar:\u002F\u002F, the file seems like something entirely different: it looks like a file with a valid stub section, a valid manifest and some files in the contents section. Therefore, when operating on the file, PHP still performs an unserialize() operation on the Phar file’s metadata. The attacker thus achieves RCE through a successful PHP object injection.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":41,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":266,"end":279,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_50":{"__typename":"Paragraph","id":"7898336cf3d2_50","name":"b54d","type":"P","href":null,"layout":null,"metadata":null,"text":"Isn’t that super cool? :)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:7898336cf3d2_51":{"__typename":"Paragraph","id":"7898336cf3d2_51","name":"2c96","type":"P","href":null,"layout":null,"metadata":null,"text":"Note: Trying this on systems where you don’t have permission to test is illegal. If you’ve found a vulnerability, please disclose it responsibly to the vendor. Help make our Internet a safer place! And as always, thanks for reading!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:f5af2b715248-viewerId:lo_928a5a5d6c81":{"__typename":"CollectionViewerEdge","id":"collectionId:f5af2b715248-viewerId:lo_928a5a5d6c81","isEditor":false,"isMuting":false},"PostViewerEdge:postId:850bf812dd8a-viewerId:lo_928a5a5d6c81":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:850bf812dd8a-viewerId:lo_928a5a5d6c81"},"Tag:hacking":{"__typename":"Tag","id":"hacking","displayTitle":"Hacking","normalizedTagSlug":"hacking"},"Tag:computer-science":{"__typename":"Tag","id":"computer-science","displayTitle":"Computer Science","normalizedTagSlug":"computer-science"},"Tag:cybersecurity":{"__typename":"Tag","id":"cybersecurity","displayTitle":"Cybersecurity","normalizedTagSlug":"cybersecurity"},"Tag:php":{"__typename":"Tag","id":"php","displayTitle":"PHP","normalizedTagSlug":"php"},"Tag:programming":{"__typename":"Tag","id":"programming","displayTitle":"Programming","normalizedTagSlug":"programming"},"Post:850bf812dd8a":{"__typename":"Post","id":"850bf812dd8a","collection":{"__ref":"Collection:f5af2b715248"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"70ec","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"e762","startIndex":51,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:7898336cf3d2_0"},{"__ref":"Paragraph:7898336cf3d2_1"},{"__ref":"Paragraph:7898336cf3d2_2"},{"__ref":"Paragraph:7898336cf3d2_3"},{"__ref":"Paragraph:7898336cf3d2_4"},{"__ref":"Paragraph:7898336cf3d2_5"},{"__ref":"Paragraph:7898336cf3d2_6"},{"__ref":"Paragraph:7898336cf3d2_7"},{"__ref":"Paragraph:7898336cf3d2_8"},{"__ref":"Paragraph:7898336cf3d2_9"},{"__ref":"Paragraph:7898336cf3d2_10"},{"__ref":"Paragraph:7898336cf3d2_11"},{"__ref":"Paragraph:7898336cf3d2_12"},{"__ref":"Paragraph:7898336cf3d2_13"},{"__ref":"Paragraph:7898336cf3d2_14"},{"__ref":"Paragraph:7898336cf3d2_15"},{"__ref":"Paragraph:7898336cf3d2_16"},{"__ref":"Paragraph:7898336cf3d2_17"},{"__ref":"Paragraph:7898336cf3d2_18"},{"__ref":"Paragraph:7898336cf3d2_19"},{"__ref":"Paragraph:7898336cf3d2_20"},{"__ref":"Paragraph:7898336cf3d2_21"},{"__ref":"Paragraph:7898336cf3d2_22"},{"__ref":"Paragraph:7898336cf3d2_23"},{"__ref":"Paragraph:7898336cf3d2_24"},{"__ref":"Paragraph:7898336cf3d2_25"},{"__ref":"Paragraph:7898336cf3d2_26"},{"__ref":"Paragraph:7898336cf3d2_27"},{"__ref":"Paragraph:7898336cf3d2_28"},{"__ref":"Paragraph:7898336cf3d2_29"},{"__ref":"Paragraph:7898336cf3d2_30"},{"__ref":"Paragraph:7898336cf3d2_31"},{"__ref":"Paragraph:7898336cf3d2_32"},{"__ref":"Paragraph:7898336cf3d2_33"},{"__ref":"Paragraph:7898336cf3d2_34"},{"__ref":"Paragraph:7898336cf3d2_35"},{"__ref":"Paragraph:7898336cf3d2_36"},{"__ref":"Paragraph:7898336cf3d2_37"},{"__ref":"Paragraph:7898336cf3d2_38"},{"__ref":"Paragraph:7898336cf3d2_39"},{"__ref":"Paragraph:7898336cf3d2_40"},{"__ref":"Paragraph:7898336cf3d2_41"},{"__ref":"Paragraph:7898336cf3d2_42"},{"__ref":"Paragraph:7898336cf3d2_43"},{"__ref":"Paragraph:7898336cf3d2_44"},{"__ref":"Paragraph:7898336cf3d2_45"},{"__ref":"Paragraph:7898336cf3d2_46"},{"__ref":"Paragraph:7898336cf3d2_47"},{"__ref":"Paragraph:7898336cf3d2_48"},{"__ref":"Paragraph:7898336cf3d2_49"},{"__ref":"Paragraph:7898336cf3d2_50"},{"__ref":"Paragraph:7898336cf3d2_51"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:871f2599811b"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fswlh\u002Fpolyglot-files-a-hackers-best-friend-850bf812dd8a","primaryTopic":{"__ref":"Topic:d4e7f4144ac5"},"topics":[{"__typename":"Topic","slug":"cybersecurity"},{"__typename":"Topic","slug":"programming"}],"isPublished":true,"latestPublishedVersion":"7898336cf3d2","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":882,"allowResponses":true,"isLimitedState":false,"title":"Polyglot Files: a Hacker’s best friend","isSeries":false,"sequence":null,"uniqueSlug":"polyglot-files-a-hackers-best-friend-850bf812dd8a","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1570102597881,"readingTime":4.769811320754717,"previewContent":{"__typename":"PreviewContent","subtitle":"And how to hide PHP code in JPEG files"},"previewImage":{"__ref":"ImageMetadata:0*62JsCxm-CAqQTkwF"},"isShortform":false,"seoTitle":"","firstPublishedAt":1570054975931,"updatedAt":1698504854074,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:850bf812dd8a-viewerId:lo_928a5a5d6c81"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:hacking"},{"__ref":"Tag:computer-science"},{"__ref":"Tag:cybersecurity"},{"__ref":"Tag:php"},{"__ref":"Tag:programming"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":1211,"layerCake":3}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.7e50e797.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.018e7ca9.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9120.5df29668.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1386.6a7a21a1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.84e4bd5c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/719.ae4dd3e0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6349.b071a958.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1443.598cb8b2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3735.8c38ede2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.d10c9ba0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.08de95de.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1781.db373833.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.0330d157.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.ca7937c2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.d195c6f1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.21ff89d3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.55c925ce.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2961.00a48598.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/230.4d7a2738.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.563d0db5.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8d764d4c8c4acaef',t:'MTcyOTczNDQ3OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body></html>